{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"index.html","title":"\u535a\u5ba2","text":"<p>\u5927\u5bb6\u597d\uff0c\u6211\u662f xliuqq.</p>"},{"location":"tags.html","title":"Tags","text":"<p>Following is a list of relevant tags:</p>"},{"location":"tags.html#tag:\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf","title":"\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf","text":"<ul> <li>            \u53ef\u9760\u3001\u53ef\u6269\u5c55\u3001\u53ef\u7ef4\u62a4\u7684\u5e94\u7528\u7cfb\u7edf          </li> <li>            \u590d\u5236          </li> <li>            \u6570\u636e\u5b58\u50a8\u4e0e\u68c0\u7d22          </li> <li>            \u6570\u636e\u6a21\u578b\u548c\u67e5\u8be2\u8bed\u8a00          </li> <li>            \u7f16\u7801\u4e0e\u6f14\u5316          </li> </ul>"},{"location":"tags.html#tag:\u8bba\u6587","title":"\u8bba\u6587","text":"<ul> <li>            go\u5e76\u53d1bugs          </li> </ul>"},{"location":"algorithmic_puzzles/index.html","title":"\u6982\u89c8","text":"<p>\u300a\u7b97\u6cd5\u8c1c\u9898\u300b Anany Levitin Maria Levitin \u8457\uff0c\u8d75\u52c7 \u5f90\u7ae0\u5b81 \u9ad8\u535a \u8bd1\uff0c2014\u5e743\u6708\u7b2c\u4e00\u7248\u3002</p>"},{"location":"algorithmic_puzzles/index.html#_2","title":"\u7b97\u6cd5\u8bbe\u8ba1\u7684\u82e5\u5e72\u7b56\u7565","text":"<p>\u7a77\u4e3e\u641c\u7d22\uff1a\u5c1d\u8bd5\u95ee\u9898\u7684\u6240\u6709\u7684\u53ef\u80fd\u89e3\uff0c\u76f4\u5230\u627e\u5230\u95ee\u9898\u7684\u89e3\u4e3a\u6b62\u3002</p> <p>\u56de\u6eaf\u6cd5\uff1a\u5bf9\u7a77\u4e3e\u641c\u7d22\u6240\u91c7\u53d6\u7684\u86ee\u529b\u505a\u6cd5\u7684\u4e00\u79cd\u6539\u8fdb\u3002</p> <ul> <li>\u6d89\u53ca\u4e00\u5b9a\u6570\u91cf\u7684\u9519\u8bef\u9009\u9879\u7684\u64a4\u9500\u52a8\u4f5c\uff08\u526a\u679d\uff09\uff0c\u51cf\u5c11\u540e\u7eed\u7684\u65e0\u7528\u641c\u7d22\uff1b</li> </ul> <p>\u51cf\u800c\u6cbb\u4e4b\uff1a\u5c06\u95ee\u9898\u51cf\u5c11\u4e3a\u4e00\u7cfb\u5217\u3001\u89c4\u6a21\u8d8a\u6765\u8d8a\u5c0f\u7684\u5b50\u95ee\u9898</p> <ul> <li>\u5982 1-100 \u731c\u6570\u5b57\uff1b</li> </ul> <p>\u5206\u800c\u6cbb\u4e4b\uff1a\u5c06\u95ee\u9898\u5206\u89e3\u4e3a\u82e5\u5e72\u4e2a\u8f83\u5c0f\u7684\u5b50\u95ee\u9898\uff08\u6700\u5c0f\u89c4\u6a21\u7684\u5b50\u95ee\u9898\u53ef\u4ee5\u89e3\u51b3\uff09\uff0c\u6700\u540e\u5c06\u5b50\u95ee\u9898\u7684\u89e3\u7ec4\u5408\u8d77\u6765\uff1b</p> <ul> <li>\u5982 \u5f52\u5e76\u6392\u5e8f\uff1b</li> <li>\u5206\u800c\u6cbb\u4e4b\uff0c\u6bcf\u6b21\u9700\u8981\u89e3\u51b3\u591a\u4e2a\u5b50\u95ee\u9898\uff0c\u800c\u51cf\u800c\u6cbb\u4e4b\u6bcf\u6b21\u4ec5\u9700\u89e3\u51b3\u4e00\u4e2a\uff1b</li> </ul> <p>\u53d8\u800c\u6cbb\u4e4b\uff1a\u5c06\u95ee\u9898\u4fee\u6539\u6216\u53d8\u6362\u6210\u53e6\u4e00\u4e2a\u95ee\u9898\uff08\u8be5\u95ee\u9898\u66f4\u5bb9\u6613\u6c42\u89e3\uff09\uff1b</p> <ul> <li>\u8c1c\u9762\u7b80\u5316\u3001\u8868\u793a\u53d8\u66f4\u3001\u95ee\u9898\u89c4\u7ea6</li> </ul> <p>\u8d2a\u5fc3\u6cd5\uff1a\u6bcf\u4e00\u6b65\u90fd\u9009\u62e9\u6700\u597d\u7684\u4e00\u4e2a\u9009\u62e9\uff0c\u5c40\u90e8\u6700\u4f18\u89e3\u4ea7\u751f\u5168\u5c40\u6700\u4f18\u89e3\uff1b</p> <ul> <li>\u96be\u70b9\u5728\u4e8e\u8bc1\u660e\u771f\u7684\u80fd\u4ea7\u751f\u6700\u4f18\u89e3</li> </ul> <p>\u8fed\u4ee3\u6539\u8fdb\uff1a\u4ece\u6613\u5f97\u7684\u4f30\u8ba1\u89e3\u51fa\u53d1\uff0c\u5e76\u91cd\u590d\u5730\u5e94\u7528\u540c\u6837\u7684\u7b80\u5355\u6b65\u9aa4\u4e0d\u65ad\u6539\u8fdb\u4f30\u8ba1\u89e3\uff1b</p> <ul> <li>\u5355\u53d8\u6027\uff08monovariant\uff09\uff0c\u4fdd\u8bc1\u5c40\u90e8\u6700\u4f18\u4e5f\u662f\u5168\u5c40\u6700\u4f18</li> </ul> <p>\u52a8\u6001\u89c4\u5212\uff1a\u6700\u4f18\u5b50\u7ed3\u6784\uff0c\u4ece\u5b50\u95ee\u9898\u7684\u6700\u4f18\u89e3\u6784\u9020\u51fa\u5168\u5c40\u6700\u4f18\u89e3</p>"},{"location":"books/index.html","title":"\u4e66\u7c4d\u548c\u4e91\u94fe\u63a5","text":"<ul> <li>2017\uff1a\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf\u8bbe\u8ba1(\u82f1\u6587\u7248)</li> <li>2018\uff1a\u8bbe\u8ba1\u5206\u5e03\u5f0f\u7cfb\u7edf\uff1a\u6a21\u5f0f\u4e0e\u8303\u5f0f(\u82f1\u6587\u7248)</li> <li>2023\uff1a\u7f16\u7a0b\u667a\u6167</li> </ul>"},{"location":"books/the_kollected_kode_vicious.html","title":"\u7f16\u7a0b\u667a\u6167-\u7f16\u7a0b\u9b3c\u624d\u7684\u7ecf\u9a8c\u548c\u601d\u8003","text":""},{"location":"books/the_kollected_kode_vicious.html#1","title":"1. \u624b\u5934\u7684\u4ee3\u7801","text":""},{"location":"books/the_kollected_kode_vicious.html#11","title":"1.1 \u8d44\u6e90\u7ba1\u7406","text":"<p>Q: \u5bf9\u4e8e\u4e00\u4e2a\u7279\u5b9a\u7684\u4efb\u52a1\uff0c\u4f7f\u7528\u591a\u5c11\u5185\u5b58\u662f\u5408\u9002\u7684\uff1f</p> <p>A: \u8f6f\u4ef6\u5de5\u7a0b\u662f\u5173\u4e8e\u6743\u8861\u7684\u7814\u7a76\u3002\u9488\u5bf9\u4e0d\u540c\u7684\u8bbe\u5907\uff0c\u4f7f\u7528\u4e0d\u540c\u7684\u7b56\u7565\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#12","title":"1.2 \u5927\u5185\u5b58","text":"<p>Q: \u81ea\u5df1\u7ba1\u7406\u5185\u5b58\u8fd8\u662f\u5783\u573e\u56de\u6536\u5668\uff1f</p> <p>A: \u5783\u573e\u56de\u6536\u4e4b\u524d\uff0c\u4f1a\u5fd8\u8bb0\u5220\u9664\u4e00\u4e2a\u5bf9\u8c61\uff1b\u5783\u573e\u56de\u6536\u4e4b\u540e\uff0c\u5fc5\u987b\u7ba1\u7406\u5bf9\u5bf9\u8c61\u7684\u5f15\u7528\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#13","title":"1.3 \u4ee3\u7801\u6392\u5217","text":"<p>\u5199\u5f97\u597d\u7684\u8f6f\u4ef6\u8981\u6309\u7167\u4fbf\u4e8e\u4ed6\u4eba\u4f7f\u7528\u7684\u65b9\u5f0f\u8fdb\u884c\u6392\u5217\u3002</p> <p>Q: \u5982\u4f55\u89e3\u51b3\u5e94\u7528\u7a0b\u5e8f\u7684\u7a0b\u5e8f\u5458\u7ed5\u8fc7\u5e93\u76f4\u63a5\u8ddf\u786c\u4ef6\u5bf9\u8bdd\uff1f</p> <p>A: \u627e\u51fa\u4ed6\u4eec\u4e3a\u4ec0\u4e48\u4f1a\u7ed5\u8fc7\u5b83\uff0c\u5e76\u5c1d\u8bd5\u6ee1\u8db3\u4ed6\u4eec\u7684\u9700\u6c42\uff0c\u5e93\u662f\u4e3a\u4ed6\u4eec\u670d\u52a1\u7684\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#14","title":"1.4 \u4ee3\u7801\u6ee5\u7528","text":"<p>\u4e00\u4e2a\u7a0b\u5e8f\u5458\u7684\u6269\u5c55\u5c31\u662f\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u5458\u7684\u6ee5\u7528\u3002</p> <p>Q: \u5e93\u88ab\u4e0d\u6309\u7167\u6240\u671f\u671b\u7684\u53bb\u4f7f\u7528\uff0c\u800c\u662f\u88ab\u6ee5\u7528\u3002</p> <p>A: \u5373\u4f7f\u5728\u8bf4\u660e\u4e2d\u6e05\u695a\u5730\u6807\u6ce8\u51fa\u5982\u4f55\u6b63\u786e\u4f7f\u7528\u6240\u7f16\u5199\u7684API\uff0c\u4f46\u8fd9\u4e9b\u8b66\u544a\u5c31\u50cf\u9ec4\u8272\u8b66\u793a\u5e26\uff0c\u4e0d\u80fd\u963b\u6b62\u4e71\u7a7f\u9a6c\u8def\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#15","title":"1.5 \u5d4c\u5957\u503e\u5411","text":"<p>Q: \u5728\u4e00\u4e2aC\u6587\u4ef6\u4e2d\u5305\u542b\u53e6\u4e00\u4e2aC\u6587\u4ef6\uff0c\u662f\u9519\u4e86\u8fd8\u662f\u4ec5\u4ec5\u4e0d\u6b63\u89c4\uff1f</p> <p>A: \u5982\u679c\u5728\u4e24\u4e2a\u5730\u65b9\u4f7f\u7528\u540c\u4e00\u6bb5\u4ee3\u7801\uff0c\u4e0d\u8981\u5728\u4e24\u4e2a\u5730\u65b9 #Include \u5b83\uff0c\u800c\u662f\u628a\u5b83\u5355\u72ec\u4f5c\u4e3a\u6a21\u5757\u6765\u6784\u5efa\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#16","title":"1.6 \u4ee4\u4eba\u7a92\u606f\u7684\u53d8\u5316","text":"<p>Q: \u5355\u6b21\u4ee3\u7801\u7b7e\u5165\u7684\u6700\u4f73\u89c4\u6a21\u5e94\u8be5\u591a\u5927\uff1f</p> <p>A: \u5982\u679c\u4f60\u66f4\u6539\u4e86\u4e00\u4e2a API\uff0c\u90a3\u4e48\u4e00\u6b21\u6027\u66f4\u65b0\u5b83\u548c\u5b83\u7684\u6240\u6709\u8c03\u7528\u65b9\u3002\u5982\u679c\u4f60\u4fee\u590d\u4e86\u4e09\u4e2abug\u5e76\u6dfb\u52a0\u4e86\u4e00\u4e2a\u529f\u80fd\uff0c\u5219\u9700\u8981\u8fdb\u884c\u56db\u6b21\u4e0d\u540c\u7684\u7b7e\u5165\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#17","title":"1.7 \u88ab\u8bc5\u5492\u7684\u4ee3\u7801","text":"<p>Q: \u662f\u5426\u53ef\u4ee5\u5728\u4ee3\u7801\u4e2d\u4f7f\u7528\u201d\u4e30\u5bcc\u7684\u9690\u55bb\u201c\uff1f</p> <p>A: \u5176\u4ed6\u4eba\u5458\u4e0d\u4ec5\u4f1a\u770b\u4ee3\u7801\uff0c\u4e5f\u4f1a\u770b\u7559\u4e0b\u7684\u6ce8\u91ca\u548c\u5176\u5b83\u4e1c\u897f\u3002\u56e0\u6b64\uff0c\u4e0d\u8981\u5728\u4ee3\u7801\u4e2d\u6dfb\u52a0 joke \u6216\u8005 *uck\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#18","title":"1.8 \u5f3a\u5236\u5f02\u5e38","text":"<p>Simple Testing Can Prevent Most Critical Failures: An Analysis of Production Failures in Distirbuted Data-Intensive Systems. 2016.</p> <ul> <li>\u5f02\u5e38\u5904\u7406\u80af\u5b9a\u662f\u9700\u8981\u7684\uff0c\u5bf9\u4e8e\u7f16\u5199\u5065\u58ee\u6027\u7684\u8f6f\u4ef6\uff1b\u8981\u4e48\u4e0d\u5904\u7406\uff0c\u8981\u4e48\u597d\u597d\u5904\u7406\u3002</li> </ul> <p>Q: \u4e3a\u4ec0\u4e4892%\u7684\u707e\u96be\u6027\u6545\u969c\u90fd\u662f\u7531\u4e8e\u672a\u80fd\u5904\u7406\u597d\u975e\u81f4\u547d\u9519\u8bef\u9020\u6210\u7684\uff1f</p> <p>A:  \u5bf9\u4e8e\u4f60\u8bd5\u56fe\u5f3a\u52a0\u7ed9\u522b\u4eba\u7684\u4e8b\u60c5\uff0c\u5982\u679c\u53ef\u80fd\u7684\u8bdd\uff0c\u4ed6\u4eec\u90fd\u4f1a\u52aa\u529b\u907f\u514d\u3002Java \u7f16\u8bd1\u5668\u8981\u6c42\u5f00\u53d1\u4eba\u5458\u6355\u83b7\u6240\u6709\u53d7\u68c0\u5f02\u5e38\uff0c\u4f46\u662f\u5728\u5904\u7406\u8fd9\u4e9b\u9519\u8bef\u65f6\u5f80\u5f80\u8349\u8349\u4e86\u4e8b\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#19","title":"1.9 \u4e00\u6bb5\u4e0d\u9519\u7684\u4ee3\u7801","text":"<p>Q: \u63a8\u8350\u9605\u8bfb IP\u9632\u706b\u5899\uff08IPFW\uff09\u4ee3\u7801</p> <p>A: \u91c7\u7528\u4f2f\u514b\u5229\u6570\u636e\u5305\u8fc7\u6ee4\u5668\uff08BPF\uff09\uff0c\u4f7f\u7528\u64cd\u4f5c\u7801\u548c\u72b6\u6001\u673a\u5bf9\u6570\u636e\u5305\u8fdb\u884c\u5206\u7c7b\uff1b\u590d\u7528\u5185\u6838\u7684\u8def\u7531\u8868\u4ee3\u7801\u6765\u5b58\u50a8\u5b83\u81ea\u5df1\u7684\u5730\u5740\u67e5\u8be2\u8868\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#110","title":"1.10 \u4e00\u4e9b\u6076\u81ed\u7684\u4e1c\u897f","text":"<p>Q: \u6e05\u6670\u3001\u7b80\u4ecb\u3001\u5199\u7684\u5f88\u597d\u7684 Linux \u4e2d\u7684 clocksoure.h\u3002</p> <p>A: \u7ed3\u6784\u5f88\u597d\u7531\u76f8\u4e92\u534f\u4f5c\u7684\u5c0f\u7ec4\u4ef6\u6784\u5efa\u800c\u6210\uff0c\u4e0d\u4f1a\u5f7c\u6b64\u63a5\u89e6\u6216\u8fdd\u53cd\u5206\u5c42\u89c4\u5219\uff1b\u4ee5\u6e05\u6670\u548c\u6574\u6d01\u7684\u98ce\u683c\u7f16\u5199\u5e76\u8bb0\u5f55\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#111","title":"1.11 \u65e5\u5fd7\u7cfb\u7edf","text":"<p>Q: \u5982\u4f55\u7f16\u5199\u6269\u5c55\u6027\u597d\u7684\u65e5\u5fd7\u7cfb\u7edf\uff1f</p> <p>A: 1) \u4efb\u4f55\u65e5\u5fd7\u8f93\u51fa\u7684\u7b2c\u4e00\u5217\u90fd\u5e94\u8be5\u65f6\u7cbe\u786e\u5230\u79d2\u7684\u65e5\u671f\u548c\u65f6\u95f4\uff0c\u66f4\u5bb9\u6613\u5199\u5206\u6790\u811a\u672c\uff1b2\uff09\u5728\u884c\u5c3e\u6dfb\u52a0\u65b0\u7684\u4fe1\u606f\u6216\u8005\u4f7f\u7528\u5168\u65b0\u7684\u4fe1\u606f\u884c\uff0c\u517c\u5bb9\u539f\u5148\u7684\u5904\u7406\u811a\u672c\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#112","title":"1.12 \u4e22\u5931","text":"<p>Q: \u6211\u4f3c\u4e4e\u6c38\u8fdc\u4e5f\u627e\u4e0d\u5230\u6211\u81ea\u5df1\u5199\u7684\u4ee3\u7801\uff0c\u8fd9\u4e0d\u662f\u6307\u7684\u662f\u6e90\u670d\u52a1\u5668\u4e0a\u7684\u5de5\u4f5c\u4ee3\u7801\uff0c\u800c\u662f\u4e2a\u4eba\u5199\u7684\u5176\u5b83\u7528\u9014\u7684\u4ee3\u7801\u3002</p> <p>A: \u79c1\u6709\u670d\u52a1\u5668/\u516c\u6709\u4e91\u76d8\uff0cCheck In \u81ea\u5df1\u5728\u4e4e\u7684\u4e00\u5207\u5185\u5bb9\uff0c\u5e76\u4f7f\u7528\u6b63\u786e\u7684\u76ee\u5f55\u540d\u53bb\u7ba1\u7406\u4ed6\u4eec\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#113","title":"1.13 \u590d\u5236","text":"<p>\u8f6f\u4ef6\u7531\u5e93\u548c\u51fd\u6570\u6784\u6210\uff0c\u5e94\u7528\u590d\u7528\u800c\u4e0d\u662f\u590d\u5236\u3002</p> <p>Q: \u590d\u5236\u5f15\u8d77\u7684\u95ee\u9898\uff1f</p> <p>A: bug \u4f1a\u88ab\u590d\u5236\uff0c\u4fee\u6539\u9700\u8981\u7ef4\u62a4\u591a\u5904\u4ee3\u7801\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#114","title":"1.14 \u4e94\u5927\u7f16\u7a0b\u95ee\u9898","text":"<ol> <li>\u7cdf\u7cd5\u7684\u6ce8\u91ca\uff1a\u65e0\u610f\u4e49\u7684\u6ce8\u91ca\u7b49\uff1b</li> <li>\u7a7a\u60ac else \u95ee\u9898\uff1b</li> <li>\u5e7b\u6570\uff1a\u9b54\u6cd5\u5e38\u91cf\uff1b</li> <li>\u602a\u91cc\u602a\u6c14\u7684\u4ee3\u7801\uff1a\u5982\u4e00\u5927\u6bb5\u6ce8\u91ca\u6389\u7684\u4ee3\u7801\uff1b</li> <li>\u5168\u5c40\u53d8\u91cf\u3002</li> </ol>"},{"location":"books/the_kollected_kode_vicious.html#115","title":"1.15 \u8bed\u8a00\u4e0a\u7684\u8ff7\u5931","text":"<p>Q: shell/python/c++ \u8be5\u7528\u4ec0\u4e48\u8bed\u8a00\u5b8c\u6210\u5de5\u4f5c\uff1f</p> <p>A: 1\uff09shell \u811a\u672c\u4e0d\u88ab\u7528\u4e8e\u8d85\u8fc7 100\u884c\u7684\u4ee3\u7801\uff1b2\uff09Python \u7528\u4e8e\u66ff\u6362\u6570\u767e\u4e2a\u7c7b\u4f3c\u7684\u3001\u66f2\u6298\u7684shell\u811a\u672c\uff1b3\uff09\u9605\u8bfb The Practice of Programming\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#116","title":"1.16 \u7b7e\u5165\u6ce8\u91ca","text":"<p>Q: \u591a\u5e74\u540e\uff0c\u5982\u4f55\u8bb0\u5f97\u88ab\u6ce8\u91ca\u4fee\u6539\u8fc7\u7684\u4ee3\u7801\u5728\u54ea\u4e2a\u7248\u672c\u5462\uff1f</p> <p>A: \u7b7e\u5165\u4ee3\u7801\u65f6\uff0c\u52a0\u4e0a\u9002\u5f53\u7684\u6ce8\u91ca\uff0c\u8fd9\u4e9b\u6ce8\u91ca\u53ef\u4ee5\u88ab\u68c0\u7d22\u3002\u7b7e\u5165\u6ce8\u91ca\u7684\u8981\u6c42\uff1a1\uff09BUG\uff1a\u95ee\u9898\u662f\u4ec0\u4e48\uff0c\u5982\u4f55\u4fee\u590d\u7684\uff1f2\uff09Feature: \u529f\u80fd\u662f\u4ec0\u4e48\uff0c\u5982\u4f55\u5de5\u4f5c\uff0c\u5982\u4f55\u4f7f\u7528\uff1f</p>"},{"location":"books/the_kollected_kode_vicious.html#2","title":"2. \u7f16\u7a0b\u96be\u9898","text":""},{"location":"books/the_kollected_kode_vicious.html#21","title":"2.1 \u65b9\u6cd5\u7684\u9882\u6b4c","text":"<p>\u5047\u8bbe\u662f\u89e3\u51b3\u95ee\u9898\u7684\u4e00\u79cd\u53ef\u68c0\u9a8c\u7684\u60f3\u6cd5\u3002</p> <p>Q: \u4f60\u600e\u4e48\u77e5\u9053\u8fd9\u4e2a\u5df2\u7ecf\u4fee\u590d\u4e86\uff1f\u8d28\u7591\u5bf9\u7cfb\u7edf\u6240\u505a\u7684\u6bcf\u4e00\u4e2a\u6539\u52a8\uff01</p> <p>A: \u89e3\u51b3\u4e00\u4e2a\u95ee\u9898\u65f6\uff0c\u4ee5\u79d1\u5b66\u65b9\u6cd5\u7684\u65b9\u5f0f\u53bb\u505a\u3002\u628a\u95ee\u9898\u51fa\u5728\u54ea\uff0c\u4f5c\u4e3a\u7406\u8bba\u5199\u4e0b\u6765\uff0c\u57fa\u4e8e\u7406\u8bba\u63d0\u51fa\u5047\u8bbe\uff0c\u5e76\u4fdd\u7559\u5df2\u8bc1\u5b9e\u548c\u5df2\u5426\u5b9a\u7684\u5047\u8bbe\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#22-c","title":"2.2 C++\u91cc\u7684\u201c+\u201d\u6709\u591a\u5c11","text":"<p>Q: \u4ec0\u4e48\u65f6\u5019\u4f7f\u7528 C\uff0c\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528 C++\uff1f</p> <p>A: 1\uff09C \u4e5f\u662f\u4e00\u79cd\u9762\u5411\u5bf9\u8c61\u7684\u8bed\u8a00\uff0c\u5982 Vnode \u6587\u4ef6\u7cfb\u7edf\uff1b2\uff09C++\u4ee3\u7801\u4e0d\u4e00\u5b9a\u4f1a\u6bd4C\u4e71\u3002\u6839\u636e1\uff09\u56e2\u961f\u7684\u6280\u672f\u6808\uff1b2\uff09\u8bed\u8a00\u7279\u6027\uff1b\u6765\u9009\u62e9\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#23","title":"2.3 \u65f6\u5c1a\u800c\u73b0\u4ee3\u7684\u4e8b\u52a1","text":"<p>Q: \u65b0\u7684\u8bed\u8a00\u65b0\u7684\u6280\u672f\uff0c\u5bf9\u4e8e\u4f7f\u7528\u8fd9\u4e9b\u7684\u4eba\u6709\u4ec0\u4e48\u5efa\u8bae\uff1f</p> <p>A: \u533a\u5206\u597d\u574f\u4ee3\u7801\u7684\u56e0\u7d20\u4e0e\u8bed\u8a00\u672c\u8eab\u51e0\u4e4e\u6ca1\u6709\u5173\u7cfb\u3002\u597d\u7684\u4ee3\u7801\u4f1a\u4f7f\u7528\u8bed\u8a00\u7684\u4e3b\u6d41\u8868\u8fbe\uff0c\u4ee5\u4fbf\u4e8e\u8ba9\u5176\u4ed6\u4eba\u7406\u89e3\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#24","title":"2.4 \u7f13\u5b58\u7f3a\u5931","text":"<p>Q: \u4e3a\u4e86\u8282\u7701\u6307\u4ee4\u4f7f\u5f97\u4ee3\u7801\u6df7\u4e71\uff1f</p> <p>A: \u6027\u80fd\u4f18\u5316\u4ee5 benchmark \u4e3a\u51c6\u3002\u73b0\u4ee3\u7f16\u8bd1\u5668\u4f1a\u8fdb\u884c\u5f88\u591a\u4f18\u5316\u3002\u53e6\u5916\u73b0\u4ee3CPU\u6700\u5b9d\u8d35\u7684\u8d44\u6e90\u4e0d\u662f\u6307\u4ee4\uff0c\u800c\u662f\u5904\u7406\u6570\u636e\u7684\u7f13\u5b58\u3002\u4e00\u6b21\u7f13\u5b58\u7684\u7f3a\u5931\uff0c\u4f1a\u5728\u4e00\u4e2a3GHz\u7684\u5904\u7406\u5668\u4e0a\u635f\u5931\u7ea6100\u4e2a\u5468\u671f\uff0c\u6bd4\u8bb8\u591a\u6307\u4ee4\u90fd\u8981\u6602\u8d35\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#25","title":"2.5 \u4ee3\u7801\u63a2\u7d22","text":"<p>Q: \u5982\u4f55\u5904\u7406\u5927\u578b\u7684\u3001\u4e0d\u719f\u6089\u7684\u6e90\u7801\u5e93\uff1f</p> <p>A: \u501f\u7528\u5404\u79cd\u5de5\u5177\u3002\u9664\u4e86linux \u547d\u4ee4\u884c\u5de5\u5177\uff0cIDE\u7f16\u8f91\u5668\u4e4b\u5916\uff0c\u8fd8\u6709 Global\uff08gtags/htags\uff09\uff0cctags\uff0ccscope\u7b49\u3002</p> <p>\u6027\u80fd\u5de5\u5177\uff1agprof, ktrace, dtrace\u3002\u5185\u5b58\u6cc4\u6f0f\uff1avalgrind\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#26","title":"2.6 \u8f93\u5165\u9a8c\u8bc1","text":"<p>Q: \u8f93\u5165\u9a8c\u8bc1\u7684\u76f8\u5173bug\uff0c\u5982CSRF/SQL\u6ce8\u5165\u7b49\uff0c\u89e3\u51b3\u4e00\u4e2a\u540c\u4ee3\u7801\u4f1a\u51fa\u73b0\u4e00\u4e9b\u5176\u5b83\u95ee\u9898\uff0c\u5982\u4f55\u89e3\u51b3\uff1f</p> <p>A: 1\uff09\u4e0d\u8981\u76f8\u4fe1\u4efb\u4f55\u4eba\uff1b2\uff09\u4e0d\u8981\u76f8\u4fe1\u81ea\u5df1\u3002\u5efa\u8bae\u4f7f\u7528\u767d\u540d\u5355\u800c\u4e0d\u662f\u9ed1\u540d\u5355\uff0c\u767d\u540d\u5355\u4f1a\u8fdb\u884c\u4e25\u683c\u9650\u5236\uff0c\u53ea\u5141\u8bb8\u7279\u5b9a\u7684\u5185\u5bb9\u3002</p>"},{"location":"books/the_kollected_kode_vicious.html#27","title":"2.7 \u4e0e\u6587\u6863\u6253\u4ea4\u9053","text":""},{"location":"books/data_intensive_system_book/index.html","title":"Index","text":""},{"location":"books/data_intensive_system_book/index.html#-","title":"- \u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf","text":""},{"location":"books/data_intensive_system_book/index.html#_1","title":"\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf\u8bbe\u8ba1","text":"<p>PDF-English: Data Intensive Application System Design</p> <p>\u53c2\u8003\u7684\u4e2d\u6587\u7ffb\u8bd1 Vonng/ddia </p> <p>I \u6570\u636e\u7cfb\u7edf\u7684\u57fa\u7840</p> <ul> <li> <p>\u7b2c\u4e00\u7ae0\uff1a\u53ef\u9760\u3001\u53ef\u6269\u5c55\u3001\u53ef\u7ef4\u62a4\u7684\u5e94\u7528\u7cfb\u7edf</p> </li> <li> <p>\u7b2c\u4e8c\u7ae0\uff1a\u6570\u636e\u6a21\u578b\u548c\u67e5\u8be2\u8bed\u8a00</p> </li> <li> <p>\u7b2c\u4e09\u7ae0\uff1a\u6570\u636e\u5b58\u50a8\u4e0e\u68c0\u7d22</p> </li> <li> <p>\u7b2c\u56db\u7ae0\uff1a\u7f16\u7801\u4e0e\u6f14\u5316</p> </li> </ul> <p>II \u5206\u5e03\u5f0f\u6570\u636e</p> <ul> <li>\u7b2c\u4e94\u7ae0\uff1a\u590d\u5236</li> <li>\u7b2c\u516d\u7ae0\uff1a\u5206\u533a</li> <li>\u7b2c\u4e03\u7ae0\uff1a\u4e8b\u52a1</li> <li>\u7b2c\u516b\u7ae0\uff1a\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u9ebb\u70e6</li> <li>\u7b2c\u4e5d\u7ae0\uff1a\u4e00\u81f4\u6027\u548c\u5171\u8bc6</li> </ul> <p>\u2162 \u884d\u751f\u6570\u636e</p> <ul> <li>\u7b2c\u5341\u7ae0\uff1a\u6279\u5904\u7406</li> <li>\u7b2c\u5341\u4e00\u7ae0\uff1a\u6d41\u5904\u7406</li> <li>\u7b2c\u5341\u4e8c\u7ae0\uff1a\u672a\u6765</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html","title":"\u7b2c\u5341\u7ae0\uff1a\u6279\u5904\u7406","text":"<p>\u4e09\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u7cfb\u7edf\uff1a</p> <ul> <li>\u670d\u52a1\uff08\u5728\u7ebf\u7cfb\u7edf\uff09\uff1a\u670d\u52a1\u7b49\u5f85\u5ba2\u6237\u7684\u8bf7\u6c42\u6216\u6307\u4ee4\u5230\u8fbe\u3002\u6bcf\u6536\u5230\u4e00\u4e2a\u4fbf\u4f1a\u8bd5\u56fe\u5c3d\u5feb\u5904\u7406\u5b83\u5e76\u53d1\u56de\u4e00\u4e2a\u54cd\u5e94\u3002</li> <li>\u54cd\u5e94\u65f6\u95f4\u901a\u5e38\u662f\u670d\u52a1\u6027\u80fd\u7684\u4e3b\u8981\u8861\u91cf\u6307\u6807\uff0c\u53ef\u7528\u6027\u901a\u5e38\u975e\u5e38\u91cd\u8981\u3002</li> <li>\u6279\u5904\u7406\u7cfb\u7edf\uff08\u79bb\u7ebf\u7cfb\u7edf\uff09\uff1a\u5927\u91cf\u7684\u8f93\u5165\u6570\u636e\uff0c\u8dd1\u4e00\u4e2a \u4f5c\u4e1a\uff08job\uff09 \u6765\u5904\u7406\u5b83\uff0c\u5e76\u751f\u6210\u4e00\u4e9b\u8f93\u51fa\u6570\u636e\u3002</li> <li>\u6027\u80fd\u8861\u91cf\u6807\u51c6\u901a\u5e38\u662f\u541e\u5410\u91cf\uff08\u5904\u7406\u7279\u5b9a\u5927\u5c0f\u7684\u8f93\u5165\u6240\u9700\u7684\u65f6\u95f4\uff09</li> <li>\u6d41\u5904\u7406\u7cfb\u7edf\uff08\u51c6\u5b9e\u65f6\u7cfb\u7edf\uff09\uff1a\u4ecb\u4e8e\u5728\u7ebf\u548c\u79bb\u7ebf\uff08\u6279\u5904\u7406\uff09\u4e4b\u95f4</li> <li>\u6d41\u5904\u7406\u6d88\u8d39\u8f93\u5165\u5e76\u4ea7\u751f\u8f93\u51fa\uff08\u5e76\u4e0d\u9700\u8981\u54cd\u5e94\u8bf7\u6c42\uff09\uff0c\u6d41\u5f0f\u4f5c\u4e1a\u5728\u4e8b\u4ef6\u53d1\u751f\u540e\u4e0d\u4e45\u5c31\u4f1a\u5bf9\u4e8b\u4ef6\u8fdb\u884c\u64cd\u4f5c\uff0c\u800c\u6279\u5904\u7406\u4f5c\u4e1a\u5219\u9700\u7b49\u5f85\u56fa\u5b9a\u7684\u4e00\u7ec4\u8f93\u5165\u6570\u636e\u3002\u6d41\u5904\u7406\u7cfb\u7edf\u6bd4\u8d77\u6279\u5904\u7406\u7cfb\u7edf\u5177\u6709\u66f4\u4f4e\u7684\u5ef6\u8fdf\u3002</li> </ul> <p>\u6279\u5904\u7406\u662f\u6784\u5efa\u53ef\u9760\u3001\u53ef\u4f38\u7f29\u548c\u53ef\u7ef4\u62a4\u5e94\u7528\u7a0b\u5e8f\u7684\u91cd\u8981\u7ec4\u6210\u90e8\u5206\u3002</p> <ul> <li>2004 \u5e74\u53d1\u5e03\u7684\u6279\u5904\u7406\u7b97\u6cd5 Map-Reduce\uff08\u53ef\u80fd\u88ab\u8fc7\u5206\u70ed\u60c5\u5730\uff09\u88ab\u79f0\u4e3a \u201c\u9020\u5c31 Google \u5927\u89c4\u6a21\u53ef\u4f38\u7f29\u6027\u7684\u7b97\u6cd5\u201d\u30102\u3011\u3002\u968f\u540e\u5728\u5404\u79cd\u5f00\u6e90\u6570\u636e\u7cfb\u7edf\u4e2d\u5f97\u5230\u5e94\u7528\uff0c\u5305\u62ec Hadoop\u3001CouchDB \u548c MongoDB\u3002</li> </ul> <p>\u4e0e\u591a\u5e74\u524d\u4e3a\u6570\u636e\u4ed3\u5e93\u5f00\u53d1\u7684\u5e76\u884c\u5904\u7406\u7cfb\u7edf\u30103,4\u3011\u76f8\u6bd4\uff0cMapReduce \u662f\u4e00\u4e2a\u76f8\u5f53\u4f4e\u7ea7\u522b\u7684\u7f16\u7a0b\u6a21\u578b\uff0c\u4f46\u5b83\u4f7f\u5f97\u5728\u5546\u7528\u786c\u4ef6\u4e0a\u80fd\u8fdb\u884c\u7684\u5904\u7406\u89c4\u6a21\u8fc8\u4e0a\u4e00\u4e2a\u65b0\u7684\u53f0\u9636\u3002</p> <p>\u867d\u7136 MapReduce \u7684\u91cd\u8981\u6027\u6b63\u5728\u4e0b\u964d\u30105\u3011\uff0c\u4f46\u5b83\u4ecd\u7136\u503c\u5f97\u53bb\u7406\u89e3\uff0c\u56e0\u4e3a\u5b83\u63cf\u7ed8\u4e86\u4e00\u5e45\u5173\u4e8e\u6279\u5904\u7406\u4e3a\u4ec0\u4e48\u6709\u7528\uff0c\u4ee5\u53ca\u5982\u4f55\u505a\u5230\u6709\u7528\u7684\u6e05\u6670\u56fe\u666f\u3002</p> <p>\u5b9e\u9645\u4e0a\uff0c\u6279\u5904\u7406\u662f\u4e00\u79cd\u975e\u5e38\u53e4\u8001\u7684\u8ba1\u7b97\u65b9\u5f0f\u3002Map-Reduce \u4e0e 1940 \u5e74\u4ee3\u548c 1950 \u5e74\u4ee3\u5e7f\u6cdb\u7528\u4e8e\u5546\u4e1a\u6570\u636e\u5904\u7406\u7684\u673a\u7535 IBM \u5361\u7247\u5206\u7c7b\u673a\u5668\u6709\u7740\u60ca\u4eba\u7684\u76f8\u4f3c\u4e4b\u5904\u30107\u3011\u3002\u5386\u53f2\u603b\u662f\u5728\u4e0d\u65ad\u91cd\u590d\u81ea\u5df1\u3002</p> <p>\u5206\u5e03\u5f0f\u6279\u5904\u7406\u6846\u67b6\u9700\u8981\u89e3\u51b3\u7684\u4e24\u4e2a\u4e3b\u8981\u95ee\u9898\u662f\uff1a</p> <ul> <li>\u5206\u533a\uff1a\u628a\u6240\u6709\u7684 \u76f8\u5173 \u6570\u636e\u653e\u5728\u540c\u4e00\u4e2a\u5730\u65b9\uff1b\u540e MapReduce \u65f6\u4ee3\u7684\u6570\u636e\u6d41\u5f15\u64ce\u82e5\u975e\u5fc5\u8981\u4f1a\u5c3d\u91cf\u907f\u514d\u6392\u5e8f\uff1b</li> <li>\u5bb9\u9519\uff1a\u6570\u636e\u6d41\u5f15\u64ce\u66f4\u591a\u5730\u5c06\u4e2d\u95f4\u72b6\u6001\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u66f4\u5c11\u5730\u7269\u5316\u4e2d\u95f4\u72b6\u6001\uff0c\u6545\u969c\u65f6\u91cd\u7b97\u66f4\u591a\u6570\u636e\uff1b</li> </ul> <p>\u8ba8\u8bba\u4e86\u51e0\u79cd MapReduce \u7684\u8fde\u63a5\u7b97\u6cd5\uff0c\u4e5f\u5728 MPP \u6570\u636e\u5e93\u548c\u6570\u636e\u6d41\u5f15\u64ce\u5185\u90e8\u4f7f\u7528\uff1a</p> <ul> <li>\u6392\u5e8f\u5408\u5e76\u8fde\u63a5\uff1a\u6bcf\u4e2a\u53c2\u4e0e\u8fde\u63a5\u7684\u8f93\u5165\u90fd\u901a\u8fc7\u4e00\u4e2a\u63d0\u53d6\u8fde\u63a5\u952e\u7684 Mapper\u3002\u901a\u8fc7\u5206\u533a\u3001\u6392\u5e8f\u548c\u5408\u5e76\uff0c\u5177\u6709\u76f8\u540c\u952e\u7684\u6240\u6709\u8bb0\u5f55\u6700\u7ec8\u90fd\u4f1a\u8fdb\u5165\u76f8\u540c\u7684 Reducer \u8c03\u7528\u3002</li> <li>\u5e7f\u64ad\u6563\u5217\u8fde\u63a5\uff1a\u4e3a\u8fde\u63a5\u8f93\u5165\u5927\u7aef\u7684\u6bcf\u4e2a\u5206\u533a\u542f\u52a8\u4e00\u4e2a Mapper\uff0c\u5c06\u8f93\u5165\u5c0f\u7aef\u7684\u6563\u5217\u8868\u52a0\u8f7d\u5230\u6bcf\u4e2a Mapper \u4e2d\uff0c\u7136\u540e\u626b\u63cf\u5927\u7aef\uff0c\u4e00\u6b21\u4e00\u6761\u8bb0\u5f55\uff0c\u5e76\u4e3a\u6bcf\u6761\u8bb0\u5f55\u67e5\u8be2\u6563\u5217\u8868\u3002</li> <li>\u5206\u533a\u6563\u5217\u8fde\u63a5\uff1a\u4e24\u4e2a\u8fde\u63a5\u8f93\u5165\u4ee5\u76f8\u540c\u7684\u65b9\u5f0f\u5206\u533a\uff0c\u5219\u53ef\u4ee5\u72ec\u7acb\u5730\u5bf9\u6bcf\u4e2a\u5206\u533a\u5e94\u7528\u6563\u5217\u8868\u65b9\u6cd5\u3002</li> </ul> <p>\u5206\u5e03\u5f0f\u6279\u5904\u7406\u5f15\u64ce\u6709\u4e00\u4e2a\u523b\u610f\u9650\u5236\u7684\u7f16\u7a0b\u6a21\u578b\uff1a\u56de\u8c03\u51fd\u6570\uff08\u6bd4\u5982 Mapper \u548c Reducer\uff09\u88ab\u5047\u5b9a\u662f\u65e0\u72b6\u6001\u7684,\u6ca1\u6709\u4efb\u4f55\u5916\u90e8\u53ef\u89c1\u7684\u526f\u4f5c\u7528\u3002\u9690\u85cf\u4e00\u4e9b\u56f0\u96be\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u95ee\u9898\uff1a</p> <ul> <li>\u5f53\u9047\u5230\u5d29\u6e83\u548c\u7f51\u7edc\u95ee\u9898\u65f6\uff0c\u4efb\u52a1\u53ef\u4ee5\u5b89\u5168\u5730\u91cd\u8bd5\uff0c\u4efb\u4f55\u5931\u8d25\u4efb\u52a1\u7684\u8f93\u51fa\u90fd\u88ab\u4e22\u5f03\u3002</li> </ul> <p>\u6279\u5904\u7406\u4f5c\u4e1a\u7684\u663e\u8457\u7279\u70b9\u662f\uff0c\u5b83\u8bfb\u53d6\u4e00\u4e9b\u8f93\u5165\u6570\u636e\u5e76\u4ea7\u751f\u4e00\u4e9b\u8f93\u51fa\u6570\u636e\uff0c\u4f46\u4e0d\u4fee\u6539\u8f93\u5165\u3002\u8f93\u5165\u6570\u636e\u662f \u6709\u754c\u7684\uff08bounded\uff09\uff0c\u4e00\u4e2a\u5de5\u4f5c\u5728\u505a\u5b8c\u540e\uff0c\u6700\u7ec8\u603b\u662f\u4f1a\u5b8c\u6210\u7684\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#unix","title":"\u4f7f\u7528Unix\u5de5\u5177\u7684\u6279\u5904\u7406","text":"<p>\u7b80\u5355\u7684\u4f8b\u5b50\uff1a\u4e00\u53f0 Web \u670d\u52a1\u5668\uff0c\u6bcf\u6b21\u5904\u7406\u8bf7\u6c42\u65f6\u90fd\u4f1a\u5728\u65e5\u5fd7\u6587\u4ef6\u4e2d\u9644\u52a0\u4e00\u884c\u3002\u5982\u4e0b\u662f nginx \u9ed8\u8ba4\u7684\u8bbf\u95ee\u65e5\u5fd7\u683c\u5f0f\uff1a</p> <pre><code>16.58.210.78 - - [27/Feb/2015:17:55:11 +0000] \"GET /css/typography.css HTTP/1.1\" 200 3377 \"http://martin.kleppmann.com/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.115 Safari/537.36\"\n</code></pre> <p>\u65e5\u5fd7\u683c\u5f0f\u7684\u5b9a\u4e49\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>$remote_addr - $remote_user [$time_local] \"$request\" $status $body_bytes_sent \"$http_referer\" \"$http_user_agent\"\n</code></pre>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_2","title":"\u7b80\u5355\u65e5\u5fd7\u5206\u6790","text":"<p>\u5728\u4f60\u7684\u7f51\u7ad9\u4e0a\u627e\u5230\u4e94\u4e2a\u6700\u53d7\u6b22\u8fce\u7684\u7f51\u9875\uff0c\u4f7f\u7528\u5982\u4e0b\u7684 unix \u547d\u4ee4<sup>1</sup>\uff1a</p> <pre><code>cat /var/log/nginx/access.log | #1\n  awk '{print $7}' | #2\n  sort             | #3\n  uniq -c          | #4\n  sort -r -n       | #5\n  head -n 5          #6\n</code></pre> <p>\u89e3\u91ca\u5982\u4e0b\uff1a</p> <ol> <li>\u8bfb\u53d6\u65e5\u5fd7\u6587\u4ef6\uff1b</li> <li>\u5c06\u6bcf\u4e00\u884c\u6309\u7a7a\u683c\u5206\u5272\u6210\u4e0d\u540c\u7684\u5b57\u6bb5\uff0c\u6bcf\u884c\u53ea\u8f93\u51fa\u7b2c\u4e03\u4e2a\u5b57\u6bb5\uff0c\u6070\u597d\u662f\u8bf7\u6c42\u7684 URL\uff1b</li> <li>\u6309\u5b57\u6bcd\u987a\u5e8f\u6392\u5217\u8bf7\u6c42\u7684 URL \u5217\u8868\uff0c\u88ab\u8bf7\u6c42\u591a\u6b21\u7684URL\u6392\u5e8f\u540e\u4f1a\u91cd\u590d\u51fa\u73b0\uff1b</li> <li><code>uniq</code> \u547d\u4ee4\u901a\u8fc7\u68c0\u67e5\u4e24\u4e2a\u76f8\u90bb\u7684\u884c\u662f\u5426\u76f8\u540c\u6765\u8fc7\u6ee4\u6389\u8f93\u5165\u4e2d\u7684\u91cd\u590d\u884c</li> <li><code>-c</code>\u8868\u793a\u8fd8\u8981\u8f93\u51fa\u4e00\u4e2a\u8ba1\u6570\u5668\uff1a\u6bcf\u4e2a\u4e0d\u540c\u7684 URL\uff0c\u8f93\u51fa\u8be5 URL \u7684\u6b21\u6570\u3002</li> <li>\u7b2c\u4e8c\u79cd\u6392\u5e8f\u6309\u6bcf\u884c\u8d77\u59cb\u5904\u7684\u6570\u5b57\uff08<code>-n</code>\uff09\u6392\u5e8f\uff0c\u8fd9\u662f URL \u7684\u8bf7\u6c42\u6b21\u6570\u3002\u7136\u540e\u9006\u5e8f\uff08<code>-r</code>\uff09\u8fd4\u56de\u7ed3\u679c\uff0c\u5927\u7684\u6570\u5b57\u5728\u524d\u3002</li> <li> <p>\u6700\u540e\uff0c\u53ea\u8f93\u51fa\u524d\u4e94\u884c\uff08<code>-n 5</code>\uff09\uff0c\u5e76\u4e22\u5f03\u5176\u4f59\u7684\u3002</p> </li> <li> <p>\u8be5\u7cfb\u5217\u547d\u4ee4\u7684\u8f93\u51fa\u5982\u4e0b\u6240\u793a\uff1a</p> </li> </ol> <pre><code>    4189 /favicon.ico\n    3631 /2013/05/24/improving-security-of-ssh-private-keys.html\n    2124 /2012/12/05/schema-evolution-in-avro-protocol-buffers-thrift.html\n    1369 /\n     915 /css/typography.css\n</code></pre> <p>\u5b83\u80fd\u5728\u51e0\u79d2\u949f\u5185\u5904\u7406\u51e0 GB \u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u5e76\u4e14\u4f60\u53ef\u4ee5\u6839\u636e\u9700\u8981\u8f7b\u677e\u4fee\u6539\u547d\u4ee4\u3002\u4f8b\u5982\uff0c\u5982\u679c\u8981\u4ece\u62a5\u544a\u4e2d\u7701\u7565 CSS \u6587\u4ef6\uff0c\u53ef\u4ee5\u5c06 awk \u53c2\u6570\u66f4\u6539\u4e3a <code>'$7 !~ /\\.css$/ {print $7}'</code>, \u5982\u679c\u60f3\u7edf\u8ba1\u6700\u591a\u7684\u5ba2\u6237\u7aef IP \u5730\u5740\uff0c\u53ef\u4ee5\u628a awk \u53c2\u6570\u6539\u4e3a <code>'{print $1}'</code>\uff0c\u7b49\u7b49\u3002</p> <p>\u4f7f\u7528 awk\u3001sed\u3001grep\u3001sort\u3001uniq \u548c xargs \u7684\u7ec4\u5408\uff0c\u53ef\u4ee5\u5728\u51e0\u5206\u949f\u5185\u5b8c\u6210\u8bb8\u591a\u6570\u636e\u5206\u6790\uff0c\u5e76\u4e14\u5b83\u4eec\u7684\u6027\u80fd\u76f8\u5f53\u7684\u597d\u30108\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_3","title":"\u547d\u4ee4\u94fe\u4e0e\u81ea\u5b9a\u4e49\u7a0b\u5e8f","text":"<p>\u9664\u4e86 Unix \u547d\u4ee4\u94fe\uff0c\u4f60\u8fd8\u53ef\u4ee5\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u7a0b\u5e8f\u6765\u505a\u540c\u6837\u7684\u4e8b\u60c5\u3002\u4f8b\u5982\uff0cRuby\u4ee3\u7801\uff1a</p> <pre><code>counts = Hash.new(0)         # 1\nFile.open('/var/log/nginx/access.log') do |file|\n    file.each do |line|\n        url = line.split[6]  # 2\n        counts[url] += 1     # 3\n    end\nend\n\ntop5 = counts.map{|url, count| [count, url] }.sort.reverse[0...5] # 4\ntop5.each{|count, url| puts \"#{count} #{url}\" }                   # 5\n</code></pre> <p>\u8fd9\u4e2a\u7a0b\u5e8f\u5e76\u4e0d\u50cf Unix \u7ba1\u9053\u90a3\u6837\u7b80\u6d01\uff0c\u4f46\u662f\u5b83\u7684\u53ef\u8bfb\u6027\u5f88\u5f3a\uff0c\u559c\u6b22\u54ea\u4e00\u79cd\u5c5e\u4e8e\u53e3\u5473\u7684\u95ee\u9898\u3002\u4f46\u4e24\u8005\u9664\u4e86\u8868\u9762\u4e0a\u7684\u5dee\u5f02\u4e4b\u5916\uff0c\u6267\u884c\u6d41\u7a0b\u4e5f\u6709\u5f88\u5927\u5dee\u5f02\uff0c\u5982\u679c\u4f60\u5728\u5927\u6587\u4ef6\u4e0a\u8fd0\u884c\u6b64\u5206\u6790\uff0c\u5219\u4f1a\u53d8\u5f97\u660e\u663e\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#vs","title":"\u6392\u5e8f VS \u5185\u5b58\u4e2d\u7684\u805a\u5408","text":"<p>\u5728\u6b64\u4f8b\u4e2d\uff0c\u4f5c\u4e1a\u7684 \u5de5\u4f5c\u96c6\uff08working set\uff0c\u5373\u4f5c\u4e1a\u9700\u8981\u968f\u673a\u8bbf\u95ee\u7684\u5185\u5b58\u5927\u5c0f\uff09\u4ec5\u53d6\u51b3\u4e8e\u4e0d\u540c URL \u7684\u6570\u91cf</p> <ul> <li>\u5982\u679c\u4f5c\u4e1a\u7684\u5de5\u4f5c\u96c6\u5927\u4e8e\u53ef\u7528\u5185\u5b58\uff0c\u5219\u6392\u5e8f\u65b9\u6cd5\u7684\u4f18\u70b9\u662f\u53ef\u4ee5\u9ad8\u6548\u5730\u4f7f\u7528\u78c1\u76d8\u3002</li> </ul> <p>\u5f52\u5e76\u6392\u5e8f\u5177\u6709\u5728\u78c1\u76d8\u4e0a\u8fd0\u884c\u826f\u597d\u7684\u987a\u5e8f\u8bbf\u95ee\u6a21\u5f0f\u3002</p> <ul> <li>\u6570\u636e\u5757\u53ef\u4ee5\u5728\u5185\u5b58\u4e2d\u6392\u5e8f\u5e76\u4f5c\u4e3a\u6bb5\u6587\u4ef6\u5199\u5165\u78c1\u76d8\uff0c\u7136\u540e\u591a\u4e2a\u6392\u5e8f\u597d\u7684\u6bb5\u53ef\u4ee5\u5408\u5e76\u4e3a\u4e00\u4e2a\u66f4\u5927\u7684\u6392\u5e8f\u6587\u4ef6\u3002</li> </ul> <p>GNU Coreutils\uff08Linux\uff09\u4e2d\u7684 <code>sort</code> \u7a0b\u5e8f\u901a\u8fc7\u6ea2\u51fa\u81f3\u78c1\u76d8\u7684\u65b9\u5f0f\u6765\u81ea\u52a8\u5e94\u5bf9\u5927\u4e8e\u5185\u5b58\u7684\u6570\u636e\u96c6\uff0c\u5e76\u80fd\u540c\u65f6\u4f7f\u7528\u591a\u4e2a CPU \u6838\u8fdb\u884c\u5e76\u884c\u6392\u5e8f\u30109\u3011\u3002</p> <ul> <li>\u4e4b\u524d\u770b\u5230\u7684\u7b80\u5355\u7684 Unix \u547d\u4ee4\u94fe\u5f88\u5bb9\u6613\u4f38\u7f29\u81f3\u5927\u6570\u636e\u96c6\uff0c\u4e14\u4e0d\u4f1a\u8017\u5c3d\u5185\u5b58\u3002\u74f6\u9888\u53ef\u80fd\u662f\u4ece\u78c1\u76d8\u8bfb\u53d6\u8f93\u5165\u6587\u4ef6\u7684\u901f\u5ea6\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#unix_1","title":"Unix\u54f2\u5b66","text":"<p>Unix \u7ba1\u9053\u7684\u53d1\u660e\u8005\u9053\u683c\u30fb\u9ea6\u514b\u7f57\u4f0a\uff08Doug McIlroy\uff09\u5728 1964 \u5e74\u9996\u5148\u63cf\u8ff0\u4e86\u8fd9\u79cd\u60c5\u51b5\u301011\u3011\uff1a</p> <ul> <li>\u9700\u8981\u4e00\u79cd\u7c7b\u4f3c\u56ed\u827a\u80f6\u7ba1\u7684\u65b9\u5f0f\u6765\u62fc\u63a5\u7a0b\u5e8f \u2014\u2014 \u5f53\u6211\u4eec\u9700\u8981\u5c06\u6d88\u606f\u4ece\u4e00\u4e2a\u7a0b\u5e8f\u4f20\u9012\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u65f6\uff0c\u76f4\u63a5\u63a5\u4e0a\u53bb\u5c31\u884c\u3002I/O \u5e94\u8be5\u4e5f\u6309\u7167\u8fd9\u79cd\u65b9\u5f0f\u8fdb\u884c\u3002</li> </ul> <p>\u901a\u8fc7\u7ba1\u9053\u8fde\u63a5\u7a0b\u5e8f\u7684\u60f3\u6cd5\u6210\u4e3a\u4e86\u73b0\u5728\u88ab\u79f0\u4e3a Unix \u54f2\u5b66 \u7684\u4e00\u90e8\u5206\uff0c\u8be5\u54f2\u5b66\u5728 1978 \u5e74\u8868\u8ff0\u5982\u4e0b\u301012,13\u3011\uff1a</p> <ul> <li>\u8ba9\u6bcf\u4e2a\u7a0b\u5e8f\u90fd\u505a\u597d\u4e00\u4ef6\u4e8b\u3002\u8981\u505a\u4e00\u4ef6\u65b0\u7684\u5de5\u4f5c\uff0c\u5199\u4e00\u4e2a\u65b0\u7a0b\u5e8f\uff0c\u800c\u4e0d\u662f\u901a\u8fc7\u6dfb\u52a0 \u201c\u529f\u80fd\u201d \u8ba9\u8001\u7a0b\u5e8f\u590d\u6742\u5316\u3002</li> <li>\u671f\u5f85\u6bcf\u4e2a\u7a0b\u5e8f\u7684\u8f93\u51fa\u6210\u4e3a\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u7684\u8f93\u5165\u3002\u4e0d\u8981\u5c06\u65e0\u5173\u4fe1\u606f\u6df7\u5165\u8f93\u51fa\u3002\u907f\u514d\u4f7f\u7528\u4e25\u683c\u7684\u5217\u6570\u636e\u6216\u4e8c\u8fdb\u5236\u8f93\u5165\u683c\u5f0f\u3002\u4e0d\u8981\u575a\u6301\u4ea4\u4e92\u5f0f\u8f93\u5165\u3002</li> <li>\u8bbe\u8ba1\u548c\u6784\u5efa\u8f6f\u4ef6\u65f6\uff0c\u5373\u4f7f\u662f\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e5f\u8ba9\u5b83\u4eec\u80fd\u591f\u5c3d\u65e9\u5730\u88ab\u8bd5\u7528\uff0c\u6700\u597d\u5728\u51e0\u5468\u5185\u5b8c\u6210\u3002\u4e0d\u8981\u72b9\u8c6b\uff0c\u6254\u6389\u7b28\u62d9\u7684\u90e8\u5206\uff0c\u91cd\u5efa\u5b83\u4eec\u3002</li> <li>\u4f18\u5148\u4f7f\u7528\u5de5\u5177\u6765\u51cf\u8f7b\u7f16\u7a0b\u4efb\u52a1\uff0c\u5373\u4f7f\u5fc5\u987b\u7ed5\u9053\u53bb\u7f16\u5199\u5de5\u5177\uff0c\u4e14\u5728\u7528\u5b8c\u540e\u5f88\u53ef\u80fd\u8981\u6254\u6389\u5927\u90e8\u5206\u3002</li> </ul> <p>\u8fd9\u79cd\u65b9\u6cd5 \u2014\u2014 \u81ea\u52a8\u5316\uff0c\u5feb\u901f\u539f\u578b\u8bbe\u8ba1\uff0c\u589e\u91cf\u5f0f\u8fed\u4ee3\uff0c\u5bf9\u5b9e\u9a8c\u53cb\u597d\uff0c\u5c06\u5927\u578b\u9879\u76ee\u5206\u89e3\u6210\u53ef\u7ba1\u7406\u7684\u5757 \u2014\u2014 \u542c\u8d77\u6765\u975e\u5e38\u50cf\u4eca\u5929\u7684\u654f\u6377\u5f00\u53d1\u548c DevOps \u8fd0\u52a8\u3002\u5947\u602a\u7684\u662f\uff0c\u56db\u5341\u5e74\u6765\u53d8\u5316\u4e0d\u5927\u3002</p> <p><code>sort</code> \u5de5\u5177\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u4f8b\u5b50\u3002\u53ef\u4ee5\u8bf4\u5b83\u6bd4\u5927\u591a\u6570\u7f16\u7a0b\u8bed\u8a00\u6807\u51c6\u5e93\u4e2d\u7684\u5b9e\u73b0\uff08\u5b83\u4eec\u4e0d\u4f1a\u5229\u7528\u78c1\u76d8\u6216\u4f7f\u7528\u591a\u7ebf\u7a0b\uff0c\u5373\u4f7f\u8fd9\u6837\u505a\u6709\u5f88\u5927\u597d\u5904\uff09\u8981\u66f4\u597d\u3002\u7136\u800c\uff0c\u5355\u72ec\u4f7f\u7528 <code>sort</code> \u51e0\u4e4e\u6ca1\u4ec0\u4e48\u7528\u3002\u5b83\u53ea\u80fd\u4e0e\u5176\u4ed6 Unix \u5de5\u5177\uff08\u5982 <code>uniq</code>\uff09\u7ed3\u5408\u4f7f\u7528\u3002</p> <p>Unix \u5982\u4f55\u5b9e\u73b0\u8fd9\u79cd\u8fd9\u4e9b\u5c0f\u7a0b\u5e8f\u95f4\u7684\u53ef\u7ec4\u5408\u6027\uff1f</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_4","title":"\u7edf\u4e00\u7684\u63a5\u53e3","text":"<p>\u5982\u679c\u4f60\u5e0c\u671b\u80fd\u591f\u5c06\u4efb\u4f55\u7a0b\u5e8f\u7684\u8f93\u51fa\u8fde\u63a5\u5230\u4efb\u4f55\u7a0b\u5e8f\u7684\u8f93\u5165\uff0c\u90a3\u610f\u5473\u7740\u6240\u6709\u7a0b\u5e8f\u5fc5\u987b\u4f7f\u7528\u76f8\u540c\u7684 I/O \u63a5\u53e3\u3002</p> <ul> <li>\u5728 Unix \u4e2d\uff0c\u8fd9\u79cd\u63a5\u53e3\u662f\u4e00\u4e2a \u6587\u4ef6\uff08file\uff0c\u66f4\u51c6\u786e\u5730\u8bf4\uff0c\u662f\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff09\u3002</li> </ul> <p>\u4e00\u4e2a\u6587\u4ef6\u53ea\u662f\u4e00\u4e32\u6709\u5e8f\u7684\u5b57\u8282\u5e8f\u5217\u3002\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u63a5\u53e3\u6765\u8868\u793a\u8bb8\u591a\u4e0d\u540c\u7684\u4e1c\u897f\uff1a</p> <ul> <li>\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u771f\u5b9e\u6587\u4ef6\uff0c\u5230\u53e6\u4e00\u4e2a\u8fdb\u7a0b\uff08Unix \u5957\u63a5\u5b57\uff0cstdin\uff0cstdout\uff09\u7684\u901a\u4fe1\u901a\u9053\uff0c\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\uff08\u6bd4\u5982 <code>/dev/audio</code> \u6216 <code>/dev/lp0</code>\uff09\uff0c\u8868\u793a TCP \u8fde\u63a5\u7684\u5957\u63a5\u5b57\uff0c\u7b49\u7b49\u3002</li> <li>\u5b9e\u9645\u4e0a\u80fd\u8ba9\u8fd9\u4e9b\u5dee\u5f02\u5de8\u5927\u7684\u4e1c\u897f\u5171\u4eab\u4e00\u4e2a\u7edf\u4e00\u7684\u63a5\u53e3\u662f\u975e\u5e38\u5389\u5bb3\u7684\uff0c\u8fd9\u4f7f\u5f97\u5b83\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u8fde\u63a5\u5728\u4e00\u8d77<sup>4</sup>\u3002</li> </ul> <p>\u8bb8\u591a\uff08\u4f46\u4e0d\u662f\u5168\u90e8\uff09Unix \u7a0b\u5e8f\u5c06\u8fd9\u4e2a\u5b57\u8282\u5e8f\u5217\u89c6\u4e3a ASCII \u6587\u672c\uff1a<code>awk</code>\u3001<code>sort</code>\u3001<code>uniq</code> \u548c <code>head</code></p> <ul> <li><code>\\n</code>\uff08\u6362\u884c\u7b26\uff0cASCII <code>0x0A</code>\uff09\u5b57\u7b26\u5206\u9694\u7684\u8bb0\u5f55\u5217\u8868\uff1b\u53ef\u4ee5\u7528\u5176\u5b83\u7684\u5206\u9694\u7b26\uff0c\u5982ASCII \u8bb0\u5f55\u5206\u9694\u7b26 <code>0x1E</code>\u301014\u3011\u3002\u6240\u6709\u8fd9\u4e9b\u7a0b\u5e8f\u90fd\u4f7f\u7528\u76f8\u540c\u7684\u8bb0\u5f55\u5206\u9694\u7b26\u5141\u8bb8\u5b83\u4eec\u4e92\u64cd\u4f5c\u3002</li> </ul> <p>\u6bcf\u6761\u8bb0\u5f55\uff08\u5373\u4e00\u884c\u8f93\u5165\uff09\u7684\u89e3\u6790\u5219\u66f4\u52a0\u6a21\u7cca\u3002</p> <ul> <li>Unix \u5de5\u5177\u901a\u5e38\u901a\u8fc7\u7a7a\u767d\u6216\u5236\u8868\u7b26\u5c06\u884c\u5206\u5272\u6210\u5b57\u6bb5\uff0c\u4f46\u4e5f\u4f7f\u7528 CSV\uff08\u9017\u53f7\u5206\u9694\uff09\uff0c\u7ba1\u9053\u5206\u9694\u548c\u5176\u4ed6\u7f16\u7801\u3002</li> <li>\u5373\u4f7f\u50cf <code>xargs</code> \u8fd9\u6837\u4e00\u4e2a\u76f8\u5f53\u7b80\u5355\u7684\u5de5\u5177\u4e5f\u6709\u516d\u4e2a\u547d\u4ee4\u884c\u9009\u9879\uff0c\u7528\u4e8e\u6307\u5b9a\u5982\u4f55\u89e3\u6790\u8f93\u5165\u3002</li> </ul> <p>ASCII \u6587\u672c\u7684\u7edf\u4e00\u63a5\u53e3\u5927\u591a\u6570\u65f6\u5019\u90fd\u80fd\u5de5\u4f5c\uff0c\u4f46\u5b83\u4e0d\u662f\u5f88\u4f18\u96c5\uff1a</p> <ul> <li>\u65e5\u5fd7\u5206\u6790\u793a\u4f8b\u4f7f\u7528 <code>{print $7}</code> \u6765\u63d0\u53d6\u7f51\u5740\uff0c\u8fd9\u6837\u53ef\u8bfb\u6027\u4e0d\u662f\u5f88\u597d\u3002\u5728\u7406\u60f3\u7684\u4e16\u754c\u4e2d\u53ef\u80fd\u662f <code>{print $request_url}</code> \u6216\u7c7b\u4f3c\u7684\u4e1c\u897f\u3002</li> </ul> <p>\u6ca1\u6709\u591a\u5c11\u8f6f\u4ef6\u80fd\u50cf Unix \u5de5\u5177\u4e00\u6837\u4ea4\u4e92\u7ec4\u5408\u7684\u8fd9\u4e48\u597d\uff1a\u4f60\u4e0d\u80fd\u901a\u8fc7\u81ea\u5b9a\u4e49\u5206\u6790\u5de5\u5177\u8f7b\u677e\u5730\u5c06\u7535\u5b50\u90ae\u4ef6\u5e10\u6237\u7684\u5185\u5bb9\u548c\u5728\u7ebf\u8d2d\u7269\u5386\u53f2\u8bb0\u5f55\u4ee5\u7ba1\u9053\u4f20\u9001\u81f3\u7535\u5b50\u8868\u683c\u4e2d\uff0c\u5e76\u5c06\u7ed3\u679c\u53d1\u5e03\u5230\u793e\u4ea4\u7f51\u7edc\u6216\u7ef4\u57fa\u3002\u4eca\u5929\uff0c\u50cf Unix \u5de5\u5177\u4e00\u6837\u6d41\u7545\u5730\u8fd0\u884c\u7a0b\u5e8f\u662f\u4e00\u79cd\u4f8b\u5916\uff0c\u800c\u4e0d\u662f\u89c4\u8303\u3002</p> <p>\u5373\u4f7f\u662f\u5177\u6709 \u76f8\u540c\u6570\u636e\u6a21\u578b \u7684\u6570\u636e\u5e93\uff0c\u5c06\u6570\u636e\u4ece\u4e00\u79cd\u6570\u636e\u5e93\u5bfc\u51fa\u518d\u5bfc\u5165\u5230\u53e6\u4e00\u79cd\u6570\u636e\u5e93\u4e5f\u5e76\u4e0d\u5bb9\u6613\u3002\u7f3a\u4e4f\u6574\u5408\u5bfc\u81f4\u4e86\u6570\u636e\u7684 \u5df4\u5c14\u5e72\u5316<sup>2</sup>\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_5","title":"\u903b\u8f91\u4e0e\u5e03\u7ebf\u76f8\u5206\u79bb","text":"<p>Unix \u5de5\u5177\u7684\u53e6\u4e00\u4e2a\u7279\u70b9\u662f\u4f7f\u7528\u6807\u51c6\u8f93\u5165\uff08<code>stdin</code>\uff09\u548c\u6807\u51c6\u8f93\u51fa\uff08<code>stdout</code>\uff09\u3002</p> <ul> <li>\u9ed8\u8ba4\uff1a\u6807\u51c6\u8f93\u5165\u6765\u81ea\u952e\u76d8\uff0c\u6807\u51c6\u8f93\u51fa\u6307\u5411\u5c4f\u5e55\uff1b\u4e5f\u53ef\u4ee5\u4ece\u6587\u4ef6\u8f93\u5165\u548c / \u6216\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u3002</li> </ul> <p>\u7ba1\u9053\u5141\u8bb8\u5c06\u4e00\u4e2a\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u51fa\u9644\u52a0\u5230\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u5165\uff08\u6709\u4e2a\u5c0f\u5185\u5b58\u7f13\u51b2\u533a\uff0c\u800c\u4e0d\u9700\u8981\u5c06\u6574\u4e2a\u4e2d\u95f4\u6570\u636e\u6d41\u5199\u5165\u78c1\u76d8\uff09\u3002</p> <p>\u5141\u8bb8 shell \u7528\u6237\u4ee5\u4efb\u4f55\u4ed6\u4eec\u60f3\u8981\u7684\u65b9\u5f0f\u8fde\u63a5\u8f93\u5165\u548c\u8f93\u51fa\uff1b\u8be5\u7a0b\u5e8f\u4e0d\u77e5\u9053\u6216\u4e0d\u5173\u5fc3\u8f93\u5165\u6765\u81ea\u54ea\u91cc\u4ee5\u53ca\u8f93\u51fa\u5230\u54ea\u91cc\u3002</p> <ul> <li>\u53ef\u4ee5\u8bf4\u8fd9\u662f\u4e00\u79cd \u677e\u8026\u5408\uff08loose coupling\uff09\uff0c\u665a\u671f\u7ed1\u5b9a\uff08late binding\uff09\u301015\u3011\u6216 \u63a7\u5236\u53cd\u8f6c\uff08inversion of control\uff09\u301016\u3011\u3002</li> </ul> <p>\u53ef\u4ee5\u7f16\u5199\u81ea\u5df1\u7684\u7a0b\u5e8f\uff0c\u5e76\u5c06\u5b83\u4eec\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u5de5\u5177\u7ec4\u5408\u5728\u4e00\u8d77\u3002\u4f60\u7684\u7a0b\u5e8f\u53ea\u9700\u8981\u4ece\u6807\u51c6\u8f93\u5165\u8bfb\u53d6\u8f93\u5165\uff0c\u5e76\u5c06\u8f93\u51fa\u5199\u5165\u6807\u51c6\u8f93\u51fa\uff0c\u5b83\u5c31\u53ef\u4ee5\u52a0\u5165\u6570\u636e\u5904\u7406\u7684\u7ba1\u9053\u4e2d\u3002</p> <p>\u4f46\u662f\uff0c\u4f7f\u7528 <code>stdin</code> \u548c <code>stdout</code> \u80fd\u505a\u7684\u4e8b\u60c5\u662f\u6709\u9650\u7684\u3002</p> <ul> <li>\u9700\u8981\u591a\u4e2a\u8f93\u5165\u6216\u8f93\u51fa\u7684\u7a0b\u5e8f\u867d\u7136\u53ef\u80fd\uff0c\u5374\u975e\u5e38\u68d8\u624b\uff1b\u6ca1\u6cd5\u5c06\u7a0b\u5e8f\u7684\u8f93\u51fa\u7ba1\u9053\u8fde\u63a5\u81f3\u7f51\u7edc\u8fde\u63a5\u4e2d\u301017,18\u3011<sup>5</sup>\uff1b</li> <li>\u5982\u679c\u7a0b\u5e8f\u76f4\u63a5\u6253\u5f00\u6587\u4ef6\u8fdb\u884c\u8bfb\u53d6\u548c\u5199\u5165\uff0c\u6216\u8005\u5c06\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u4f5c\u4e3a\u5b50\u8fdb\u7a0b\u542f\u52a8\uff0c\u6216\u8005\u6253\u5f00\u7f51\u7edc\u8fde\u63a5\uff0c\u90a3\u4e48 I/O \u7684\u5e03\u7ebf\u5c31\u53d6\u51b3\u4e8e\u7a0b\u5e8f\u672c\u8eab\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_6","title":"\u900f\u660e\u5ea6\u548c\u5b9e\u9a8c","text":"<p>\u4f7f Unix \u5de5\u5177\u5982\u6b64\u6210\u529f\u7684\u90e8\u5206\u539f\u56e0\u662f\uff0c\u5b83\u4eec\u4f7f\u67e5\u770b\u6b63\u5728\u53d1\u751f\u7684\u4e8b\u60c5\u53d8\u5f97\u975e\u5e38\u5bb9\u6613\uff1a</p> <ul> <li>Unix \u547d\u4ee4\u7684\u8f93\u5165\u6587\u4ef6\u901a\u5e38\u88ab\u89c6\u4e3a\u4e0d\u53ef\u53d8\u7684\u3002\u8fd9\u610f\u5473\u7740\u4f60\u53ef\u4ee5\u968f\u610f\u8fd0\u884c\u547d\u4ee4\uff0c\u5c1d\u8bd5\u5404\u79cd\u547d\u4ee4\u884c\u9009\u9879\uff0c\u800c\u4e0d\u4f1a\u635f\u574f\u8f93\u5165\u6587\u4ef6\u3002</li> <li>\u53ef\u4ee5\u5728\u4efb\u4f55\u65f6\u5019\u7ed3\u675f\u7ba1\u9053\uff0c\u5c06\u7ba1\u9053\u8f93\u51fa\u5230 <code>less</code>\uff0c\u7136\u540e\u67e5\u770b\u5b83\u662f\u5426\u5177\u6709\u9884\u671f\u7684\u5f62\u5f0f\u3002\u8fd9\u79cd\u68c0\u67e5\u80fd\u529b\u5bf9\u8c03\u8bd5\u975e\u5e38\u6709\u7528\u3002</li> <li>\u53ef\u4ee5\u5c06\u4e00\u4e2a\u6d41\u6c34\u7ebf\u9636\u6bb5\u7684\u8f93\u51fa\u5199\u5165\u6587\u4ef6\uff0c\u5e76\u5c06\u8be5\u6587\u4ef6\u7528\u4f5c\u4e0b\u4e00\u9636\u6bb5\u7684\u8f93\u5165\u3002\u8fd9\u4f7f\u4f60\u53ef\u4ee5\u91cd\u65b0\u542f\u52a8\u540e\u9762\u7684\u9636\u6bb5\uff0c\u800c\u65e0\u9700\u91cd\u65b0\u8fd0\u884c\u6574\u4e2a\u7ba1\u9053\u3002</li> </ul> <p>\u56e0\u6b64\uff0c\u4e0e\u5173\u7cfb\u6570\u636e\u5e93\u7684\u67e5\u8be2\u4f18\u5316\u5668\u76f8\u6bd4\uff0c\u5373\u4f7f Unix \u5de5\u5177\u975e\u5e38\u7b80\u5355\uff0c\u4f46\u4ecd\u7136\u975e\u5e38\u6709\u7528\uff0c\u7279\u522b\u662f\u5bf9\u4e8e\u5b9e\u9a8c\u800c\u8a00\u3002</p> <p>\u7136\u800c\uff0cUnix \u5de5\u5177\u7684\u6700\u5927\u5c40\u9650\u5728\u4e8e\u5b83\u4eec\u53ea\u80fd\u5728\u4e00\u53f0\u673a\u5668\u4e0a\u8fd0\u884c \u2014\u2014 \u800c Hadoop \u8fd9\u6837\u7684\u5de5\u5177\u5373\u5e94\u8fd0\u800c\u751f\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#mapreduce","title":"MapReduce\u548c\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf","text":"<p>\u4e00\u4e2a MapReduce \u4f5c\u4e1a\u53ef\u4ee5\u548c\u4e00\u4e2a Unix \u8fdb\u7a0b\u76f8\u7c7b\u6bd4\uff1a\u5b83\u63a5\u53d7\u4e00\u4e2a\u6216\u591a\u4e2a\u8f93\u5165\uff0c\u5e76\u4ea7\u751f\u4e00\u4e2a\u6216\u591a\u4e2a\u8f93\u51fa\u3002</p> <ul> <li>\u8fd0\u884c MapReduce \u4f5c\u4e1a\u901a\u5e38\u4e0d\u4f1a\u4fee\u6539\u8f93\u5165\uff0c\u9664\u4e86\u751f\u6210\u8f93\u51fa\u5916\u6ca1\u6709\u4efb\u4f55\u526f\u4f5c\u7528\u3002\u8f93\u51fa\u6587\u4ef6\u4ee5\u8fde\u7eed\u7684\u65b9\u5f0f\u4e00\u6b21\u6027\u5199\u5165\uff08\u4e00\u65e6\u5199\u5165\u6587\u4ef6\uff0c\u4e0d\u4f1a\u4fee\u6539\u4efb\u4f55\u73b0\u6709\u7684\u6587\u4ef6\u90e8\u5206\uff09\u3002</li> </ul> <p>MapReduce \u4f5c\u4e1a\u5728\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u4e0a\u8bfb\u5199\u6587\u4ef6\u3002\u5728 Hadoop \u7684 MapReduce \u5b9e\u73b0\u4e2d\uff0c\u8be5\u6587\u4ef6\u7cfb\u7edf\u88ab\u79f0\u4e3a HDFS\uff08Hadoop \u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\uff09\uff0c\u4e00\u4e2a Google \u6587\u4ef6\u7cfb\u7edf\uff08GFS\uff09\u7684\u5f00\u6e90\u5b9e\u73b0\u301019\u3011\u3002</p> <ul> <li>\u9664 HDFS \u5916\uff0c\u8fd8\u6709\u5404\u79cd\u5176\u4ed6\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\uff0c\u5982 GlusterFS \u548c Quantcast File System\uff08QFS\uff09\u301020\u3011</li> <li>Amazon S3\u3001Azure Blob \u5b58\u50a8\u548c OpenStack Swift\u301021\u3011\u7b49\u5bf9\u8c61\u5b58\u50a8\u670d\u52a1\u5728\u5f88\u591a\u65b9\u9762\u90fd\u662f\u76f8\u4f3c\u7684<sup>6</sup></li> </ul> <p>HDFS \u57fa\u4e8e \u65e0\u5171\u4eab \u539f\u5219\uff1a</p> <ul> <li>NAS/SAN \u7b49\u5171\u4eab\u78c1\u76d8\u5b58\u50a8\u7531\u96c6\u4e2d\u5f0f\u5b58\u50a8\u8bbe\u5907\u5b9e\u73b0\uff0c\u901a\u5e38\u4f7f\u7528\u5b9a\u5236\u786c\u4ef6\u548c\u4e13\u7528\u7f51\u7edc\u57fa\u7840\u8bbe\u65bd\uff08\u5982\u5149\u7ea4\u901a\u9053\uff09\uff1b</li> <li>\u65e0\u5171\u4eab\u65b9\u6cd5\u4e0d\u9700\u8981\u7279\u6b8a\u7684\u786c\u4ef6\uff0c\u53ea\u9700\u8981\u901a\u8fc7\u4f20\u7edf\u6570\u636e\u4e2d\u5fc3\u7f51\u7edc\u8fde\u63a5\u7684\u8ba1\u7b97\u673a\u3002</li> </ul> <p>HDFS \u5728\u6bcf\u53f0\u673a\u5668\u4e0a\u8fd0\u884c\u4e86\u4e00\u4e2a\u5b88\u62a4\u8fdb\u7a0b\uff08DataNode\uff09\uff0c\u5b83\u5bf9\u5916\u66b4\u9732\u7f51\u7edc\u670d\u52a1\uff0c\u5141\u8bb8\u5176\u4ed6\u8282\u70b9\u8bbf\u95ee\u5b58\u50a8\u5728\u8be5\u673a\u5668\u4e0a\u7684\u6587\u4ef6\uff08\u5047\u8bbe\u6570\u636e\u4e2d\u5fc3\u4e2d\u7684\u6bcf\u53f0\u901a\u7528\u8ba1\u7b97\u673a\u90fd\u6302\u8f7d\u7740\u4e00\u4e9b\u78c1\u76d8\uff09\u3002\u800c\u540d\u4e3a NameNode \u7684\u4e2d\u592e\u670d\u52a1\u5668\u4f1a\u8ddf\u8e2a\u54ea\u4e2a\u6587\u4ef6\u5757\u5b58\u50a8\u5728\u54ea\u53f0\u673a\u5668\u4e0a\u3002</p> <ul> <li>\u4e3a\u4e86\u5bb9\u5fcd\u673a\u5668\u548c\u78c1\u76d8\u6545\u969c\uff0c\u6587\u4ef6\u5757\u88ab\u590d\u5236\u5230\u591a\u53f0\u673a\u5668\u4e0a\uff1b</li> <li>\u591a\u4e2a\u673a\u5668\u4e0a\u7684\u76f8\u540c\u6570\u636e\u7684\u591a\u4e2a\u526f\u672c\uff0c\u6216\u8005 Reed-Solomon \u7801\u8fd9\u6837\u7684\u7ea0\u5220\u7801\u65b9\u6848\uff1b</li> <li>\u4e0e RAID \u76f8\u4f3c\uff0c\u540e\u8005\u53ef\u4ee5\u5728\u8fde\u63a5\u5230\u540c\u4e00\u53f0\u673a\u5668\u7684\u591a\u4e2a\u78c1\u76d8\u4e0a\u63d0\u4f9b\u5197\u4f59\uff1b\u533a\u522b\u5728\u4e8e\u5728\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u6587\u4ef6\u8bbf\u95ee\u548c\u590d\u5236\u662f\u5728\u4f20\u7edf\u7684\u6570\u636e\u4e2d\u5fc3\u7f51\u7edc\u4e0a\u5b8c\u6210\u7684\uff0c\u6ca1\u6709\u7279\u6b8a\u7684\u786c\u4ef6\u3002</li> </ul> <p>HDFS \u7684\u53ef\u4f38\u7f29\u6027\u5df2\u7ecf\u5f88\u4e0d\u9519\u4e86\uff1a\u5728\u64b0\u5199\u672c\u4e66\u65f6\uff0c\u6700\u5927\u7684 HDFS \u90e8\u7f72\u8fd0\u884c\u5728\u4e0a\u4e07\u53f0\u673a\u5668\u4e0a\uff0c\u603b\u5b58\u50a8\u5bb9\u91cf\u8fbe\u6570\u767e PB\u301023\u3011\u3002\u4f7f\u7528\u5546\u54c1\u786c\u4ef6\u548c\u5f00\u6e90\u8f6f\u4ef6\u7684 HDFS \u4e0a\u7684\u6570\u636e\u5b58\u50a8\u548c\u8bbf\u95ee\u6210\u672c\u8fdc\u4f4e\u4e8e\u5728\u4e13\u7528\u5b58\u50a8\u8bbe\u5907\u4e0a\u652f\u6301\u540c\u7b49\u5bb9\u91cf\u7684\u6210\u672c\u301024\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#mapreduce_1","title":"MapReduce\u4f5c\u4e1a\u6267\u884c","text":"<p>Web \u670d\u52a1\u5668\u65e5\u5fd7\u5206\u6790\u4e3a\u4f8b\u8fdb\u884c\u9610\u8ff0\uff0c\u4f5c\u4e3a\u4e00\u4e2a MapReduce \u4f5c\u4e1a\u6267\u884c\uff1a</p> <ul> <li>\u8bfb\u53d6\u4e00\u7ec4\u8f93\u5165\u6587\u4ef6\uff0c\u5e76\u5c06\u5176\u5206\u89e3\u6210 \u8bb0\u5f55\uff08records\uff09\u3002\u6bcf\u6761\u8bb0\u5f55\u90fd\u662f\u65e5\u5fd7\u4e2d\u7684\u4e00\u884c\uff08\u5373 <code>\\n</code> \u662f\u8bb0\u5f55\u5206\u9694\u7b26\uff09\u3002</li> <li>\u8c03\u7528 Mapper \u51fd\u6570\uff0c\u4ece\u6bcf\u6761\u8f93\u5165\u8bb0\u5f55\u4e2d\u63d0\u53d6\u4e00\u5bf9\u952e\u503c\u3002Mapper \u51fd\u6570\u662f <code>awk '{print $7}'</code></li> <li>\u6309\u952e\u6392\u5e8f\u6240\u6709\u7684\u952e\u503c\u5bf9\u3002\u7531\u7b2c\u4e00\u4e2a <code>sort</code> \u547d\u4ee4\u5b8c\u6210</li> <li>\u8c03\u7528 Reducer \u51fd\u6570\u904d\u5386\u6392\u5e8f\u540e\u7684\u952e\u503c\u5bf9\u3002\u7531 <code>uniq -c</code> \u547d\u4ee4\u5b9e\u73b0</li> </ul> <p>\u6b65\u9aa4 2\uff08Map\uff09\u548c 4\uff08Reduce\uff09\u662f\u4f60\u7f16\u5199\u81ea\u5b9a\u4e49\u6570\u636e\u5904\u7406\u4ee3\u7801\u7684\u5730\u65b9\u3002\u6b65\u9aa4 3 \u4e2d\u7684\u6392\u5e8f\u6b65\u9aa4\u9690\u542b\u5728 MapReduce \u4e2d\u3002Mapper \u7684\u8f93\u51fa\u59cb\u7ec8\u5728\u9001\u5f80 Reducer \u4e4b\u524d\u8fdb\u884c\u6392\u5e8f\u3002</p> <ul> <li><code>Mapper</code>\uff1aMapper \u4f1a\u5728\u6bcf\u6761\u8f93\u5165\u8bb0\u5f55\u4e0a\u8c03\u7528\u4e00\u6b21\uff0c\u5176\u5de5\u4f5c\u662f\u4ece\u8f93\u5165\u8bb0\u5f55\u4e2d\u63d0\u53d6\u952e\u503c\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\uff0c\u5b83\u53ef\u4ee5\u751f\u6210\u4efb\u610f\u6570\u91cf\u7684\u952e\u503c\u5bf9\uff08\u5305\u62ec None\uff09\u3002\u4e0d\u4f1a\u4fdd\u7559\u4ece\u4e00\u4e2a\u8f93\u5165\u8bb0\u5f55\u5230\u4e0b\u4e00\u4e2a\u8bb0\u5f55\u7684\u4efb\u4f55\u72b6\u6001\uff0c\u56e0\u6b64\u6bcf\u4e2a\u8bb0\u5f55\u90fd\u662f\u72ec\u7acb\u5904\u7406\u7684\u3002</li> <li><code>Reducer</code>\uff1a\u62c9\u53d6\u7531 Mapper \u751f\u6210\u7684\u952e\u503c\u5bf9\uff0c\u6536\u96c6\u5c5e\u4e8e\u540c\u4e00\u4e2a\u952e\u7684\u6240\u6709\u503c\uff0c\u5e76\u5728\u8fd9\u7ec4\u503c\u4e0a\u8fed\u4ee3\u8c03\u7528 Reducer\u3002Reducer \u53ef\u4ee5\u4ea7\u751f\u8f93\u51fa\u8bb0\u5f55\uff08\u4f8b\u5982\u76f8\u540c URL \u7684\u51fa\u73b0\u6b21\u6570\uff09\u3002</li> </ul> <p>\u5728\u7b2c 5 \u6b65\u4e2d\u6709\u7b2c\u4e8c\u4e2a <code>sort</code> \u547d\u4ee4\uff0c\u5b83\u6309\u8bf7\u6c42\u6570\u5bf9 URL \u8fdb\u884c\u6392\u5e8f\u3002\u5728 MapReduce \u4e2d\uff0c\u5982\u679c\u4f60\u9700\u8981\u7b2c\u4e8c\u4e2a\u6392\u5e8f\u9636\u6bb5\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u7f16\u5199\u7b2c\u4e8c\u4e2a MapReduce \u4f5c\u4e1a\u5e76\u5c06\u7b2c\u4e00\u4e2a\u4f5c\u4e1a\u7684\u8f93\u51fa\u7528\u4f5c\u7b2c\u4e8c\u4e2a\u4f5c\u4e1a\u7684\u8f93\u5165\u6765\u5b9e\u73b0\u5b83\u3002</p> <p>Mapper \u7684\u4f5c\u7528\u662f\u5c06\u6570 \u636e\u653e\u5165\u4e00\u4e2a\u9002\u5408\u6392\u5e8f\u7684\u8868\u5355\u4e2d\uff0c\u5e76\u4e14 Reducer \u7684\u4f5c\u7528\u662f\u5904\u7406\u5df2\u6392\u5e8f\u7684\u6570\u636e\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#mapreduce_2","title":"\u5206\u5e03\u5f0f\u6267\u884cMapReduce","text":"<p>MapReduce \u53ef\u4ee5\u5728\u591a\u53f0\u673a\u5668\u4e0a\u5e76\u884c\u6267\u884c\u8ba1\u7b97\uff0c\u800c\u65e0\u9700\u7f16\u5199\u4ee3\u7801\u6765\u663e\u5f0f\u5904\u7406\u5e76\u884c\u95ee\u9898\u3002</p> <ul> <li>Mapper \u548c Reducer \u4e00\u6b21\u53ea\u80fd\u5904\u7406\u4e00\u6761\u8bb0\u5f55\uff0c\u6846\u67b6\u53ef\u4ee5\u5904\u7406\u5728\u673a\u5668\u4e4b\u95f4\u79fb\u52a8\u6570\u636e\u7684\u590d\u6742\u6027\u3002</li> </ul> <p>\u5728\u5206\u5e03\u5f0f\u8ba1\u7b97\u4e2d\u53ef\u4ee5\u4f7f\u7528\u6807\u51c6\u7684 Unix \u5de5\u5177\u4f5c\u4e3a Mapper \u548c Reducer\u301025\u3011\uff0c\u66f4\u5e38\u89c1\u7684\u662f\u88ab\u5b9e\u73b0\u4e3a\u4f20\u7edf\u7f16\u7a0b\u8bed\u8a00\u7684\u51fd\u6570\u3002</p> <ul> <li>Hadoop MapReduce \u4e2d\uff0cMapper \u548c Reducer \u90fd\u662f\u5b9e\u73b0\u7279\u5b9a\u63a5\u53e3\u7684 Java \u7c7b\uff1b</li> <li>MongoDB \u548c CouchDB \u4e2d\uff0cMapper \u548c Reducer \u90fd\u662f JavaScript \u51fd\u6570\uff1b</li> </ul> <p>\u56fe 10-1 \u663e\u793a\u4e86 Hadoop MapReduce \u4f5c\u4e1a\u4e2d\u7684\u6570\u636e\u6d41\u3002</p> <ul> <li>\u5176\u5e76\u884c\u5316\u57fa\u4e8e\u5206\u533a\uff1a\u4f5c\u4e1a\u7684\u8f93\u5165\u901a\u5e38\u662f HDFS \u4e2d\u7684\u4e00\u4e2a\u76ee\u5f55\uff0c\u8f93\u5165\u76ee\u5f55\u4e2d\u7684\u6bcf\u4e2a\u6587\u4ef6\u6216\u6587\u4ef6\u5757\u90fd\u88ab\u8ba4\u4e3a\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u5206\u533a\uff0c\u53ef\u4ee5\u5355\u72ec\u5904\u7406 map \u4efb\u52a1\uff1b</li> <li>\u6bcf\u4e2a\u8f93\u5165\u6587\u4ef6\u7684\u5927\u5c0f\u901a\u5e38\u662f\u6570\u767e\u5146\u5b57\u8282\uff1bMapReduce \u8c03\u5ea6\u5668\uff08\u56fe\u4e2d\u672a\u663e\u793a\uff09\u8bd5\u56fe\u5728\u5176\u4e2d\u4e00\u53f0\u5b58\u50a8\u8f93\u5165\u6587\u4ef6\u526f\u672c\u7684\u673a\u5668\u4e0a\u8fd0\u884c\u6bcf\u4e2a Mapper\uff1b\u8be5\u539f\u5219\u79f0\u4e3a\u5c06\u8ba1\u7b97\u653e\u5728\u6570\u636e\u9644\u8fd1\u301027\u3011\uff1a\u5b83\u8282\u7701\u4e86\u901a\u8fc7\u7f51\u7edc\u590d\u5236\u8f93\u5165\u6587\u4ef6\u7684\u5f00\u9500\uff0c\u51cf\u5c11\u7f51\u7edc\u8d1f\u8f7d\u5e76\u589e\u52a0\u5c40\u90e8\u6027\u3002</li> </ul> <p></p> \u56fe 10-1 \u5177\u6709\u4e09\u4e2a Mapper \u548c\u4e09\u4e2a Reducer \u7684 MapReduce \u4efb\u52a1 <p>\u867d\u7136 Map \u4efb\u52a1\u7684\u6570\u91cf\u7531\u8f93\u5165\u6587\u4ef6\u5757\u7684\u6570\u91cf\u51b3\u5b9a\uff0c\u4f46 Reducer \u7684\u4efb\u52a1\u7684\u6570\u91cf\u662f\u7531\u4f5c\u4e1a\u4f5c\u8005\u914d\u7f6e\u7684\uff08\u5b83\u53ef\u4ee5\u4e0d\u540c\u4e8e Map \u4efb\u52a1\u7684\u6570\u91cf\uff09\u3002</p> <ul> <li>\u6846\u67b6\u4f7f\u7528\u952e\u7684\u6563\u5217\u503c\u6765\u786e\u5b9a\u54ea\u4e2a Reduce \u4efb\u52a1\u5e94\u8be5\u63a5\u6536\u5230\u7279\u5b9a\u7684\u952e\u503c\u5bf9\uff0c\u5177\u6709\u76f8\u540c\u952e\u7684\u6240\u6709\u952e\u503c\u5bf9\u6700\u7ec8\u843d\u5728\u76f8\u540c\u7684 Reducer \u5904\uff1b</li> </ul> <p>\u952e\u503c\u5bf9\u5fc5\u987b\u8fdb\u884c\u6392\u5e8f\uff0c\u4f46\u6570\u636e\u96c6\u53ef\u80fd\u592a\u5927\uff0c\u65e0\u6cd5\u5728\u5355\u53f0\u673a\u5668\u4e0a\u4f7f\u7528\u5e38\u89c4\u6392\u5e8f\u7b97\u6cd5\u8fdb\u884c\u6392\u5e8f\u3002</p> <ul> <li>\u6bcf\u4e2a Map \u4efb\u52a1\u90fd\u6309\u7167 Reducer \u5bf9\u8f93\u51fa\u8fdb\u884c\u5206\u533a\u3002\u6bcf\u4e2a\u5206\u533a\u90fd\u88ab\u5199\u5165 Mapper \u7a0b\u5e8f\u7684\u672c\u5730\u78c1\u76d8\u3002</li> </ul> <p>\u5f53 Mapper \u8bfb\u53d6\u5b8c\u8f93\u5165\u6587\u4ef6\uff0c\u5e76\u5199\u5b8c\u6392\u5e8f\u540e\u7684\u8f93\u51fa\u6587\u4ef6\uff0cMapReduce \u8c03\u5ea6\u5668\u5c31\u4f1a\u901a\u77e5 Reducer \u53ef\u4ee5\u4ece\u8be5 Mapper \u5f00\u59cb\u83b7\u53d6\u8f93\u51fa\u6587\u4ef6\u3002</p> <ul> <li>Reducer \u8fde\u63a5\u5230\u6bcf\u4e2a Mapper\uff0c\u5e76\u4e0b\u8f7d\u81ea\u5df1\u76f8\u5e94\u5206\u533a\u7684\u6709\u5e8f\u952e\u503c\u5bf9\u6587\u4ef6\u3002\u6309 Reducer \u5206\u533a\uff0c\u6392\u5e8f\uff0c\u4ece Mapper \u5411 Reducer \u590d\u5236\u5206\u533a\u6570\u636e\uff0c\u8fd9\u4e00\u6574\u4e2a\u8fc7\u7a0b\u88ab\u79f0\u4e3a \u6df7\u6d17\uff08shuffle\uff09\u30106\u3011\u3002</li> </ul> <p>Reduce \u4efb\u52a1\u4ece Mapper \u83b7\u53d6\u6587\u4ef6\uff0c\u5e76\u5c06\u5b83\u4eec\u5408\u5e76\u5728\u4e00\u8d77\uff0c\u5e76\u4fdd\u7559\u6709\u5e8f\u7279\u6027\u3002\u56e0\u6b64\uff0c\u5982\u679c\u4e0d\u540c\u7684 Mapper \u751f\u6210\u4e86\u952e\u76f8\u540c\u7684\u8bb0\u5f55\uff0c\u5219\u5728 Reducer \u7684\u8f93\u5165\u4e2d\uff0c\u8fd9\u4e9b\u8bb0\u5f55\u5c06\u4f1a\u76f8\u90bb\u3002</p> <ul> <li>Reducer \u8c03\u7528\u65f6\u4f1a\u6536\u5230\u4e00\u4e2a\u952e\uff0c\u548c\u4e00\u4e2a\u8fed\u4ee3\u5668\u4f5c\u4e3a\u53c2\u6570\uff0c\u8fed\u4ee3\u5668\u4f1a\u987a\u5e8f\u5730\u626b\u8fc7\u6240\u6709\u5177\u6709\u8be5\u952e\u7684\u8bb0\u5f55\uff08\u56e0\u4e3a\u5728\u67d0\u4e9b\u60c5\u51b5\u53ef\u80fd\u65e0\u6cd5\u5b8c\u5168\u653e\u5165\u5185\u5b58\u4e2d\uff09\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#mapreduce_3","title":"MapReduce\u5de5\u4f5c\u6d41","text":"<p>\u5355\u4e2a MapReduce \u4f5c\u4e1a\u53ef\u4ee5\u89e3\u51b3\u7684\u95ee\u9898\u8303\u56f4\u5f88\u6709\u9650\uff0c\u5c06 MapReduce \u4f5c\u4e1a\u94fe\u63a5\u6210\u4e3a \u5de5\u4f5c\u6d41\uff08workflow\uff09 \u4e2d\u662f\u6781\u4e3a\u5e38\u89c1\u3002</p> <ul> <li>Hadoop MapReduce \u6846\u67b6\u5bf9\u5de5\u4f5c\u6d41\u6ca1\u6709\u7279\u6b8a\u652f\u6301\uff0c\u6240\u4ee5\u8fd9\u4e2a\u94fe\u662f\u901a\u8fc7\u76ee\u5f55\u540d\u9690\u5f0f\u5b9e\u73b0\uff1b</li> <li>\u7b2c\u4e00\u4e2a\u4f5c\u4e1a\u5fc5\u987b\u5c06\u5176\u8f93\u51fa\u914d\u7f6e\u4e3a HDFS \u4e2d\u7684\u6307\u5b9a\u76ee\u5f55\uff0c\u7b2c\u4e8c\u4e2a\u4f5c\u4e1a\u5fc5\u987b\u5c06\u5176\u8f93\u5165\u914d\u7f6e\u4e3a\u4ece\u540c\u4e00\u4e2a\u76ee\u5f55\u3002</li> </ul> <p>\u88ab\u94fe\u63a5\u7684 MapReduce \u4f5c\u4e1a\u5e76\u6ca1\u6709\u90a3\u4e48\u50cf Unix \u547d\u4ee4\u7ba1\u9053\uff08\u5b83\u76f4\u63a5\u5c06\u4e00\u4e2a\u8fdb\u7a0b\u7684\u8f93\u51fa\u4f5c\u4e3a\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u7684\u8f93\u5165\uff0c\u4ec5\u7528\u4e00\u4e2a\u5f88\u5c0f\u7684\u5185\u5b58\u7f13\u51b2\u533a\uff09\uff0c\u66f4\u50cf\u662f\u4e00\u7cfb\u5217\u547d\u4ee4\u3002</p> <p>\u53ea\u6709\u5f53\u4f5c\u4e1a\u6210\u529f\u5b8c\u6210\u540e\uff0c\u6279\u5904\u7406\u4f5c\u4e1a\u7684\u8f93\u51fa\u624d\u4f1a\u88ab\u89c6\u4e3a\u6709\u6548\u7684\uff08MapReduce \u4f1a\u4e22\u5f03\u5931\u8d25\u4f5c\u4e1a\u7684\u90e8\u5206\u8f93\u51fa\uff09\u3002</p> <ul> <li>\u5de5\u4f5c\u6d41\u4e2d\u7684\u4e00\u9879\u4f5c\u4e1a\u53ea\u6709\u5728\u5148\u524d\u7684\u4f5c\u4e1a \u2014\u2014 \u5373\u751f\u4ea7\u5176\u8f93\u5165\u7684\u4f5c\u4e1a \u2014\u2014 \u6210\u529f\u5b8c\u6210\u540e\u624d\u80fd\u5f00\u59cb\uff1b</li> </ul> <p>\u5f88\u591a\u9488\u5bf9 Hadoop \u7684\u5de5\u4f5c\u6d41\u8c03\u5ea6\u5668\u88ab\u5f00\u53d1\u51fa\u6765\uff0c\u5305\u62ec Oozie\u3001Azkaban\u3001Luigi\u3001Airflow \u548c Pinball \u301028\u3011\u3002</p> <ul> <li>\u5728\u7ef4\u62a4\u5927\u91cf\u6279\u5904\u7406\u4f5c\u4e1a\u65f6\u975e\u5e38\u6709\u7528\uff1a\u6784\u5efa\u63a8\u8350\u7cfb\u7edf\u65f6\uff0c\u7531 50 \u5230 100 \u4e2a MapReduce \u4f5c\u4e1a\u7ec4\u6210\u7684\u5de5\u4f5c\u6d41\u662f\u5e38\u89c1\u7684\u301029\u3011\u3002</li> </ul> <p>Hadoop \u7684\u5404\u79cd\u9ad8\u7ea7\u5de5\u5177\uff08\u5982 Pig \u301030\u3011\u3001Hive \u301031\u3011\u3001Cascading \u301032\u3011\u3001Crunch \u301033\u3011\u548c FlumeJava \u301034\u3011\uff09\u4e5f\u80fd\u81ea\u52a8\u5e03\u7ebf\u7ec4\u88c5\u591a\u4e2a MapReduce \u9636\u6bb5\uff0c\u751f\u6210\u5408\u9002\u7684\u5de5\u4f5c\u6d41\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#reduce","title":"Reduce\u4fa7\u8fde\u63a5\u4e0e\u5206\u7ec4","text":"<p>\u5728\u8bb8\u591a\u6570\u636e\u96c6\u4e2d\uff0c\u4e00\u6761\u8bb0\u5f55\u4e0e\u53e6\u4e00\u6761\u8bb0\u5f55\u5b58\u5728\u5173\u8054\u662f\u5f88\u5e38\u89c1\u7684\uff1a</p> <ul> <li>\u5173\u7cfb\u6a21\u578b\u4e2d\u7684 \u5916\u952e\uff0c\u6587\u6863\u6a21\u578b\u4e2d\u7684 \u6587\u6863\u5f15\u7528 \u6216\u56fe\u6a21\u578b\u4e2d\u7684 \u8fb9\u3002</li> </ul> <p>\u975e\u89c4\u8303\u5316\u53ef\u4ee5\u51cf\u5c11\u5bf9\u8fde\u63a5\u7684\u9700\u6c42\uff0c\u4f46\u901a\u5e38\u65e0\u6cd5\u5c06\u5176\u5b8c\u5168\u79fb\u9664<sup>3</sup>\u3002</p> <p>\u5f53 MapReduce \u4f5c\u4e1a\u88ab\u8d4b\u4e88\u4e00\u7ec4\u6587\u4ef6\u4f5c\u4e3a\u8f93\u5165\u65f6\uff0c\u5b83\u8bfb\u53d6\u6240\u6709\u8fd9\u4e9b\u6587\u4ef6\u7684\u5168\u90e8\u5185\u5bb9\uff1b\u6570\u636e\u5e93\u4f1a\u5c06\u8fd9\u79cd\u64cd\u4f5c\u79f0\u4e3a \u5168\u8868\u626b\u63cf\u3002</p> <ul> <li>\u53ea\u60f3\u8bfb\u53d6\u5c11\u91cf\u7684\u8bb0\u5f55\uff0c\u5219\u5168\u8868\u626b\u63cf\u4e0e\u7d22\u5f15\u67e5\u8be2\u76f8\u6bd4\uff0c\u4ee3\u4ef7\u975e\u5e38\u9ad8\u6602\u3002</li> </ul> <p>\u5728\u6279\u5904\u7406\u7684\u8bed\u5883\u4e2d\u8ba8\u8bba\u8fde\u63a5\u65f6\uff0c\u6211\u4eec\u6307\u7684\u662f\u5728\u6570\u636e\u96c6\u4e2d\u89e3\u6790\u67d0\u79cd\u5173\u8054\u7684\u5168\u91cf\u5b58\u5728\u3002\u4f8b\u5982\u6211\u4eec\u5047\u8bbe\u4e00\u4e2a\u4f5c\u4e1a\u662f\u540c\u65f6\u5904\u7406\u6240\u6709\u7528\u6237\u7684\u6570\u636e\uff0c\u800c\u975e\u4ec5\u4ec5\u662f\u4e3a\u67d0\u4e2a\u7279\u5b9a\u7528\u6237\u67e5\u627e\u6570\u636e\uff08\u800c\u8fd9\u80fd\u901a\u8fc7\u7d22\u5f15\u66f4\u9ad8\u6548\u5730\u5b8c\u6210\uff09\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_7","title":"\u793a\u4f8b\uff1a\u7528\u6237\u6d3b\u52a8\u4e8b\u4ef6\u5206\u6790","text":"<p>\u56fe 10-2 \u7ed9\u51fa\u4e00\u4e2a\u6279\u5904\u7406\u4f5c\u4e1a\u4e2d\u8fde\u63a5\u7684\u5178\u578b\u4f8b\u5b50\u3002\u5de6\u4fa7\u662f\u4e8b\u4ef6\u65e5\u5fd7\uff0c\u63cf\u8ff0\u767b\u5f55\u7528\u6237\u5728\u7f51\u7ad9\u4e0a\u505a\u7684\u4e8b\u60c5\uff08\u79f0\u4e3a \u6d3b\u52a8\u4e8b\u4ef6\uff0c\u5373 activity events\uff0c\u6216 \u70b9\u51fb\u6d41\u6570\u636e\uff0c\u5373 clickstream data\uff09\uff0c\u53f3\u4fa7\u662f\u7528\u6237\u6570\u636e\u5e93\u3002</p> <ul> <li>\u53ef\u4ee5\u770b\u4f5c\u662f\u661f\u578b\u6a21\u5f0f\uff1a\u4e8b\u4ef6\u65e5\u5fd7\u662f\u4e8b\u5b9e\u8868\uff0c\u7528\u6237\u6570\u636e\u5e93\u662f\u5176\u4e2d\u7684\u4e00\u4e2a\u7ef4\u5ea6\u3002</li> </ul> <p></p> \u56fe 10-2 \u7528\u6237\u884c\u4e3a\u65e5\u5fd7\u4e0e\u7528\u6237\u6863\u6848\u7684\u8fde\u63a5 <p>\u5206\u6790\u4efb\u52a1\u53ef\u80fd\u9700\u8981\u5c06\u7528\u6237\u6d3b\u52a8\u4e0e\u7528\u6237\u6863\u6848\u4fe1\u606f\u76f8\u5173\u8054\uff1a\u5982\u786e\u5b9a\u54ea\u4e9b\u9875\u9762\u66f4\u53d7\u54ea\u4e9b\u5e74\u9f84\u6bb5\u7684\u7528\u6237\u6b22\u8fce\u3002\u56e0\u6b64\uff0c\u6d3b\u52a8\u4e8b\u4ef6\u9700\u8981\u4e0e\u7528\u6237\u6863\u6848\u6570\u636e\u5e93\u76f8\u8fde\u63a5\u3002</p> <ul> <li>\u6700\u7b80\u5355\u65b9\u6cd5\u662f\uff0c\u9010\u4e2a\u904d\u5386\u6d3b\u52a8\u4e8b\u4ef6\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u9047\u5230\u7684\u7528\u6237 ID \u67e5\u8be2\u7528\u6237\u6570\u636e\u5e93\uff08\u5728\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\uff09\uff1b</li> <li>\u6027\u80fd\u53ef\u80fd\u4f1a\u975e\u5e38\u5dee\uff1a\u5904\u7406\u541e\u5410\u91cf\u5c06\u53d7\u9650\u4e8e\u53d7\u6570\u636e\u5e93\u670d\u52a1\u5668\u7684\u5f80\u8fd4\u65f6\u95f4\uff0c\u672c\u5730\u7f13\u5b58\u7684\u6709\u6548\u6027\u5f88\u5927\u7a0b\u5ea6\u4e0a\u53d6\u51b3\u4e8e\u6570\u636e\u7684\u5206\u5e03\uff0c\u5e76\u884c\u8fd0\u884c\u5927\u91cf\u67e5\u8be2\u53ef\u80fd\u4f1a\u8f7b\u6613\u538b\u57ae\u6570\u636e\u5e93\u301035\u3011\u3002</li> <li>\u67e5\u8be2\u8fdc\u7a0b\u6570\u636e\u5e93\u610f\u5473\u7740\u6279\u5904\u7406\u4f5c\u4e1a\u53d8\u4e3a \u975e\u786e\u5b9a\u7684\uff08nondeterministic\uff09\uff0c\u56e0\u4e3a\u8fdc\u7a0b\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u53ef\u80fd\u4f1a\u6539\u53d8\u3002</li> <li>\u66f4\u597d\u7684\u65b9\u6cd5\u662f\u83b7\u53d6\u7528\u6237\u6570\u636e\u5e93\u7684\u526f\u672c\uff0c\u5e76\u5c06\u5b83\u548c\u7528\u6237\u884c\u4e3a\u65e5\u5fd7\u653e\u5165\u540c\u4e00\u4e2a\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_8","title":"\u6392\u5e8f\u5408\u5e76\u8fde\u63a5","text":"<p>\u5728\u56fe10-2 \u4e2d\uff0c\u952e\u5c31\u662f\u7528\u6237 ID\uff1a\u4e00\u7ec4 Mapper \u4f1a\u626b\u8fc7\u6d3b\u52a8\u4e8b\u4ef6\uff08\u63d0\u53d6\u7528\u6237 ID \u4f5c\u4e3a\u952e\uff0c\u6d3b\u52a8\u4e8b\u4ef6\u4f5c\u4e3a\u503c\uff09\uff0c\u800c\u53e6\u4e00\u7ec4 Mapper \u5c06\u4f1a\u626b\u8fc7\u7528\u6237\u6570\u636e\u5e93\uff08\u63d0\u53d6\u7528\u6237 ID \u4f5c\u4e3a\u952e\uff0c\u7528\u6237\u7684\u51fa\u751f\u65e5\u671f\u4f5c\u4e3a\u503c\uff09\u3002\u6d41\u7a0b\u5982\u4e0b\u56fe 10-3 \u6240\u793a\uff1a</p> <ul> <li>\u4e8c\u6b21\u6392\u5e8f\uff08secondary sort\uff09\u301026\u3011\uff1a\u4f7f Reducer \u603b\u80fd\u5148\u770b\u5230\u6765\u81ea\u7528\u6237\u6570\u636e\u5e93\u7684\u8bb0\u5f55\uff0c\u7d27\u63a5\u7740\u662f\u6309\u65f6\u95f4\u6233\u987a\u5e8f\u6392\u5e8f\u7684\u6d3b\u52a8\u4e8b\u4ef6\u3002</li> <li>\u7b2c\u4e00\u4e2a\u503c\u5e94\u8be5\u662f\u6765\u81ea\u7528\u6237\u6570\u636e\u5e93\u7684\u51fa\u751f\u65e5\u671f\u8bb0\u5f55\uff0c\u53ef\u4ee5\u5b58\u50a8\u5230\u5c40\u90e8\u53d8\u91cf\u4e2d\u3002Reducer \u4e00\u6b21\u5904\u7406\u4e00\u4e2a\u7279\u5b9a\u7528\u6237 ID \u7684\u6240\u6709\u8bb0\u5f55\uff0c\u56e0\u6b64\u4e00\u6b21\u53ea\u9700\u8981\u5c06\u4e00\u6761\u7528\u6237\u8bb0\u5f55\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u65e0\u9700\u7f51\u7edc\u8bf7\u6c42\uff1b</li> <li>\u8fd9\u4e2a\u7b97\u6cd5\u88ab\u79f0\u4e3a \u6392\u5e8f\u5408\u5e76\u8fde\u63a5\uff08sort-merge join\uff09\uff0c\u56e0\u4e3a Mapper \u7684\u8f93\u51fa\u662f\u6309\u952e\u6392\u5e8f\u7684\uff0c\u7136\u540e Reducer \u5c06\u6765\u81ea\u8fde\u63a5\u4e24\u4fa7\u7684\u6709\u5e8f\u8bb0\u5f55\u5217\u8868\u5408\u5e76\u5728\u4e00\u8d77\u3002</li> </ul> <p></p> \u56fe 10-3 \u5728\u7528\u6237 ID \u4e0a\u8fdb\u884c\u7684 Reduce \u7aef\u8fde\u63a5\u3002\u5982\u679c\u8f93\u5165\u6570\u636e\u96c6\u5206\u533a\u4e3a\u591a\u4e2a\u6587\u4ef6\uff0c\u5219\u6bcf\u4e2a\u5206\u533a\u90fd\u4f1a\u88ab\u591a\u4e2a Mapper \u5e76\u884c\u5904\u7406"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_9","title":"\u628a\u76f8\u5173\u6570\u636e\u653e\u5728\u4e00\u8d77","text":"<p>\u5728\u6392\u5e8f\u5408\u5e76\u8fde\u63a5\u4e2d\uff0cMapper \u548c\u6392\u5e8f\u8fc7\u7a0b\u786e\u4fdd\u4e86\u6240\u6709\u5bf9\u7279\u5b9a\u7528\u6237 ID \u6267\u884c\u8fde\u63a5\u64cd\u4f5c\u7684\u5fc5\u987b\u6570\u636e\u90fd\u88ab\u653e\u5728\u540c\u4e00\u4e2a\u5730\u65b9\uff1a</p> <ul> <li>\u5355\u6b21\u8c03\u7528 Reducer \u7684\u5730\u65b9\u3002\u9884\u5148\u6392\u597d\u4e86\u6240\u6709\u9700\u8981\u7684\u6570\u636e\uff0cReducer \u53ef\u4ee5\u662f\u76f8\u5f53\u7b80\u5355\u7684\u5355\u7ebf\u7a0b\u4ee3\u7801\uff0c\u80fd\u591f\u4ee5\u9ad8\u541e\u5410\u91cf\u548c\u4e0e\u4f4e\u5185\u5b58\u5f00\u9500\u626b\u8fc7\u8fd9\u4e9b\u8bb0\u5f55\u3002</li> </ul> <p>\u4f7f\u7528 MapReduce \u7f16\u7a0b\u6a21\u578b\uff0c\u80fd\u5c06\u8ba1\u7b97\u7684\u7269\u7406\u7f51\u7edc\u901a\u4fe1\u5c42\u9762\uff08\u4ece\u6b63\u786e\u7684\u673a\u5668\u83b7\u53d6\u6570\u636e\uff09\u4ece\u5e94\u7528\u903b\u8f91\u4e2d\u5265\u79bb\u51fa\u6765\uff08\u83b7\u53d6\u6570\u636e\u540e\u6267\u884c\u5904\u7406\uff09\u3002</p> <ul> <li>\u4e0e\u6570\u636e\u5e93\u7684\u5178\u578b\u7528\u6cd5\u5f62\u6210\u4e86\u9c9c\u660e\u5bf9\u6bd4\uff0c\u4ece\u6570\u636e\u5e93\u4e2d\u83b7\u53d6\u6570\u636e\u7684\u8bf7\u6c42\u7ecf\u5e38\u51fa\u73b0\u5728\u5e94\u7528\u4ee3\u7801\u5185\u90e8\u301036\u3011\u3002</li> <li>\u4e5f\u907f\u514d\u4e86\u8ba9\u5e94\u7528\u4ee3\u7801\u53bb\u62c5\u5fc3\u90e8\u5206\u6545\u969c\uff0c\u4f8b\u5982\u53e6\u4e00\u4e2a\u8282\u70b9\u7684\u5d29\u6e83\uff1aMapReduce \u5728\u4e0d\u5f71\u54cd\u5e94\u7528\u903b\u8f91\u7684\u60c5\u51b5\u4e0b\u80fd\u900f\u660e\u5730\u91cd\u8bd5\u5931\u8d25\u7684\u4efb\u52a1\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_10","title":"\u5206\u7ec4","text":"<p>\u628a\u76f8\u5173\u6570\u636e\u653e\u5728\u4e00\u8d77\u201d \u7684\u53e6\u4e00\u79cd\u5e38\u89c1\u6a21\u5f0f\u662f\uff0c\u6309\u67d0\u4e2a\u952e\u5bf9\u8bb0\u5f55\u5206\u7ec4\uff08\u5982 SQL \u4e2d\u7684 GROUP BY \u5b50\u53e5\uff09\u3002\u6240\u6709\u5e26\u6709\u76f8\u540c\u952e\u7684\u8bb0\u5f55\u6784\u6210\u4e00\u4e2a\u7ec4\uff0c\u800c\u4e0b\u4e00\u6b65\u5f80\u5f80\u662f\u5728\u6bcf\u4e2a\u7ec4\u5185\u8fdb\u884c\u67d0\u79cd\u805a\u5408\u64cd\u4f5c\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>\u7edf\u8ba1\u6bcf\u4e2a\u7ec4\u4e2d\u8bb0\u5f55\u7684\u6570\u91cf\uff08\u4f8b\u5982\u5728\u7edf\u8ba1 PV \u7684\u4f8b\u5b50\u4e2d\uff0c\u5728 SQL \u4e2d\u8868\u793a\u4e3a <code>COUNT(*)</code> \u805a\u5408\uff09</li> <li>\u5bf9\u67d0\u4e2a\u7279\u5b9a\u5b57\u6bb5\u6c42\u548c\uff08SQL \u4e2d\u7684 <code>SUM(fieldname)</code>\uff09</li> <li>\u6309\u67d0\u79cd\u5206\u7ea7\u51fd\u6570\u53d6\u51fa\u6392\u540d\u524d k \u6761\u8bb0\u5f55\u3002</li> </ul> <p>\u5728 MapReduce \u4e4b\u4e0a\u5b9e\u73b0\u5206\u7ec4\u548c\u8fde\u63a5\u770b\u4e0a\u53bb\u975e\u5e38\u76f8\u4f3c\u3002</p> <p>\u5206\u7ec4\u7684\u53e6\u4e00\u4e2a\u5e38\u89c1\u7528\u9014\u662f\u6574\u7406\u7279\u5b9a\u7528\u6237\u4f1a\u8bdd\u7684\u6240\u6709\u6d3b\u52a8\u4e8b\u4ef6\uff0c\u4ee5\u627e\u51fa\u7528\u6237\u8fdb\u884c\u7684\u4e00\u7cfb\u5217\u64cd\u4f5c\uff08\u79f0\u4e3a \u4f1a\u8bdd\u5316\uff08sessionization\uff09\u301037\u3011\uff09\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u79cd\u5206\u6790\u6765\u786e\u5b9a\u663e\u793a\u65b0\u7248\u7f51\u7ad9\u7684\u7528\u6237\u662f\u5426\u6bd4\u90a3\u4e9b\u663e\u793a\u65e7\u7248\u672c\u7684\u7528\u6237\u66f4\u6709\u8d2d\u4e70\u6b32\uff08A/B \u6d4b\u8bd5\uff09\uff0c\u6216\u8005\u8ba1\u7b97\u67d0\u4e2a\u8425\u9500\u6d3b\u52a8\u662f\u5426\u503c\u5f97\u3002</p> <p>\u5982\u679c\u4f60\u6709\u591a\u4e2a Web \u670d\u52a1\u5668\u5904\u7406\u7528\u6237\u8bf7\u6c42\uff0c\u5219\u7279\u5b9a\u7528\u6237\u7684\u6d3b\u52a8\u4e8b\u4ef6\u5f88\u53ef\u80fd\u5206\u6563\u5728\u5404\u4e2a\u4e0d\u540c\u7684\u670d\u52a1\u5668\u7684\u65e5\u5fd7\u6587\u4ef6\u4e2d\u3002</p> <ul> <li>\u4f7f\u7528\u4f1a\u8bdd cookie\uff0c\u7528\u6237 ID \u6216\u7c7b\u4f3c\u7684\u6807\u8bc6\u7b26\u4f5c\u4e3a\u5206\u7ec4\u952e\uff0c\u4ee5\u5c06\u7279\u5b9a\u7528\u6237\u7684\u6240\u6709\u6d3b\u52a8\u4e8b\u4ef6\u653e\u5728\u4e00\u8d77\u6765\u5b9e\u73b0\u4f1a\u8bdd\u5316\uff0c\u4e0e\u6b64\u540c\u65f6\uff0c\u4e0d\u540c\u7528\u6237\u7684\u4e8b\u4ef6\u4ecd\u7136\u6563\u5e03\u5728\u4e0d\u540c\u7684\u5206\u533a\u4e2d\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_11","title":"\u5904\u7406\u504f\u659c","text":"<p>\u5982\u679c\u5b58\u5728\u4e0e\u5355\u4e2a\u952e\u5173\u8054\u7684\u5927\u91cf\u6570\u636e\uff0c\u5219 \u201c\u5c06\u5177\u6709\u76f8\u540c\u952e\u7684\u6240\u6709\u8bb0\u5f55\u653e\u5230\u76f8\u540c\u7684\u4f4d\u7f6e\u201d \u8fd9\u79cd\u6a21\u5f0f\u5c31\u88ab\u7834\u574f\u4e86\u3002</p> <ul> <li>\u4e0d\u6210\u6bd4\u4f8b\u7684\u6d3b\u52a8\u6570\u636e\u5e93\u8bb0\u5f55\u88ab\u79f0\u4e3a \u5173\u952e\u5bf9\u8c61\uff08linchpin object\uff09\u301038\u3011\u6216 \u70ed\u952e\uff08hot key\uff09\u3002</li> </ul> <p>\u5728\u5355\u4e2a Reducer \u4e2d\u6536\u96c6\u4e0e\u67d0\u4e2a\u540d\u4eba\u76f8\u5173\u7684\u6240\u6709\u6d3b\u52a8\uff08\u4f8b\u5982\u4ed6\u4eec\u53d1\u5e03\u5185\u5bb9\u7684\u56de\u590d\uff09\u53ef\u80fd\u5bfc\u81f4\u4e25\u91cd\u7684 \u504f\u659c\uff08\u4e5f\u79f0\u4e3a \u70ed\u70b9\uff09\uff1a</p> <ul> <li>\u4e00\u4e2a Reducer \u5fc5\u987b\u6bd4\u5176\u4ed6 Reducer \u5904\u7406\u66f4\u591a\u7684\u8bb0\u5f55\uff0c\u6240\u6709\u540e\u7eed\u4f5c\u4e1a\u5fc5\u987b\u7b49\u5f85\u6700\u6162\u7684 Reducer \u624d\u80fd\u542f\u52a8\u3002</li> </ul> <p>\u5982\u679c\u8fde\u63a5\u7684\u8f93\u5165\u5b58\u5728\u70ed\u952e\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u7b97\u6cd5\u8fdb\u884c\u8865\u507f\uff1a</p> <ul> <li> <p>Pig \u4e2d\u7684 \u504f\u659c\u8fde\u63a5\uff08skewed join\uff09 \u65b9\u6cd5</p> </li> <li> <p>\u5148\u8fd0\u884c\u4e00\u4e2a\u62bd\u6837\u4f5c\u4e1a\uff08Sampling Job\uff09\u6765\u786e\u5b9a\u54ea\u4e9b\u952e\u662f\u70ed\u952e\u301039\u3011\u3002</p> </li> <li> <p>Mapper \u4f1a\u5c06\u70ed\u952e\u7684\u5173\u8054\u8bb0\u5f55 \u968f\u673a \u53d1\u9001\u5230\u51e0\u4e2a Reducer \u4e4b\u4e00\u3002\u5bf9\u4e8e\u53e6\u5916\u4e00\u4fa7\u7684\u8fde\u63a5\u8f93\u5165\uff0c\u4e0e\u70ed\u952e\u76f8\u5173\u7684\u8bb0\u5f55\u9700\u8981\u88ab\u590d\u5236\u5230 \u6240\u6709 \u5904\u7406\u8be5\u952e\u7684 Reducer \u4e0a\u301040\u3011\u3002</p> </li> <li> <p>Hive \u7684\u504f\u659c\u8fde\u63a5\u4f18\u5316\u91c7\u53d6\u4e86\u53e6\u4e00\u79cd\u65b9\u6cd5\u3002</p> </li> <li> <p>\u5728\u8868\u683c\u5143\u6570\u636e\u4e2d\u663e\u5f0f\u6307\u5b9a\u70ed\u952e\uff0c\u5e76\u5c06\u4e0e\u8fd9\u4e9b\u952e\u76f8\u5173\u7684\u8bb0\u5f55\u5355\u72ec\u5b58\u653e\uff0c\u4e0e\u5176\u5b83\u6587\u4ef6\u5206\u5f00\u3002\u5f53\u5728\u8be5\u8868\u4e0a\u6267\u884c\u8fde\u63a5\u65f6\uff0c\u5bf9\u4e8e\u70ed\u952e\uff0c\u5b83\u4f1a\u4f7f\u7528 Map \u7aef\u8fde\u63a5\u3002</p> </li> </ul> <p>\u5f53\u6309\u7167\u70ed\u952e\u8fdb\u884c\u5206\u7ec4\u5e76\u805a\u5408\u65f6\uff0c\u53ef\u4ee5\u5c06\u5206\u7ec4\u5206\u4e24\u4e2a\u9636\u6bb5\u8fdb\u884c\u3002</p> <ul> <li>\u7b2c\u4e00\u4e2a MapReduce \u9636\u6bb5\u5c06\u8bb0\u5f55\u53d1\u9001\u5230\u968f\u673a Reducer\uff0c\u4ee5\u4fbf\u6bcf\u4e2a Reducer \u53ea\u5bf9\u70ed\u952e\u7684\u5b50\u96c6\u6267\u884c\u5206\u7ec4\uff0c\u4e3a\u6bcf\u4e2a\u952e\u8f93\u51fa\u4e00\u4e2a\u66f4\u7d27\u51d1\u7684\u4e2d\u95f4\u805a\u5408\u7ed3\u679c\u3002</li> <li>\u7b2c\u4e8c\u4e2a MapReduce \u4f5c\u4e1a\u5c06\u6240\u6709\u6765\u81ea\u7b2c\u4e00\u9636\u6bb5 Reducer \u7684\u4e2d\u95f4\u805a\u5408\u7ed3\u679c\u5408\u5e76\u4e3a\u6bcf\u4e2a\u952e\u4e00\u4e2a\u503c\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#map","title":"Map\u4fa7\u8fde\u63a5","text":"<p>\u4e0a\u4e00\u8282\u63cf\u8ff0\u7684\u8fde\u63a5\u7b97\u6cd5\u5728 Reducer \u4e2d\u6267\u884c\u5b9e\u9645\u7684\u8fde\u63a5\u903b\u8f91\uff0c\u56e0\u6b64\u88ab\u79f0\u4e3a Reduce \u4fa7\u8fde\u63a5\u3002</p> <ul> <li>\u4f18\u70b9\u662f\u4e0d\u9700\u8981\u5bf9\u8f93\u5165\u6570\u636e\u505a\u4efb\u4f55\u5047\u8bbe\uff1a\u65e0\u8bba\u5176\u5c5e\u6027\u548c\u7ed3\u6784\u5982\u4f55\uff0cMapper \u90fd\u53ef\u4ee5\u5bf9\u5176\u9884\u5904\u7406\u4ee5\u5907\u8fde\u63a5\u3002</li> <li>\u7f3a\u70b9\u662f\uff0c\u6392\u5e8f\uff0c\u590d\u5236\u81f3 Reducer\uff0c\u4ee5\u53ca\u5408\u5e76 Reducer \u8f93\u5165\uff0c\u6240\u6709\u8fd9\u4e9b\u64cd\u4f5c\u53ef\u80fd\u5f00\u9500\u5de8\u5927\u301037\u3011\u3002</li> </ul> <p>\u5982\u679c\u80fd \u5bf9\u8f93\u5165\u6570\u636e\u4f5c\u51fa\u67d0\u4e9b\u5047\u8bbe\uff0c\u5219\u901a\u8fc7\u4f7f\u7528\u6240\u8c13\u7684 Map \u4fa7\u8fde\u63a5\u6765\u52a0\u5feb\u8fde\u63a5\u901f\u5ea6\u662f\u53ef\u884c\u7684\u3002\u3002</p> <ul> <li>\u4f7f\u7528\u4e86\u4e00\u4e2a\u88c1\u51cf\u6389 Reducer \u4e0e\u6392\u5e8f\u7684 MapReduce \u4f5c\u4e1a\uff0c\u6bcf\u4e2a Mapper \u53ea\u662f\u7b80\u5355\u5730\u4ece\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u8bfb\u53d6\u4e00\u4e2a\u8f93\u5165\u6587\u4ef6\u5757\uff0c\u7136\u540e\u5c06\u8f93\u51fa\u6587\u4ef6\u5199\u5165\u6587\u4ef6\u7cfb\u7edf\uff0c\u4ec5\u6b64\u800c\u5df2\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_12","title":"\u5e7f\u64ad\u6563\u5217\u8fde\u63a5","text":"<p>\u9002\u7528\u4e8e\u6267\u884c Map \u7aef\u8fde\u63a5\u7684\u6700\u7b80\u5355\u573a\u666f\u662f\u5927\u6570\u636e\u96c6\u4e0e\u5c0f\u6570\u636e\u96c6\u8fde\u63a5\u7684\u60c5\u51b5\u3002</p> <ul> <li>\u5c0f\u6570\u636e\u96c6\u9700\u8981\u8db3\u591f\u5c0f\uff0c\u4ee5\u4fbf\u53ef\u4ee5\u5c06\u5176\u5168\u90e8\u52a0\u8f7d\u5230\u6bcf\u4e2a Mapper \u7684\u5185\u5b58\u4e2d\u3002</li> </ul> <p>\u5e7f\u64ad\u6563\u5217\u8fde\u63a5\uff08broadcast hash join\uff09\uff1a</p> <ul> <li>\u6bcf\u4e2a\u8fde\u63a5\u8f83\u5927\u8f93\u5165\u7aef\u5206\u533a\u7684 Mapper \u90fd\u4f1a\u5c06\u8f83\u5c0f\u8f93\u5165\u7aef\u6570\u636e\u96c6\u6574\u4e2a\u8bfb\u5165\u5185\u5b58\u4e2d\uff1b\u6563\u5217 \u4e00\u8bcd\u53cd\u6620\u4e86\u5b83\u4f7f\u7528\u4e00\u4e2a\u6563\u5217\u8868\u3002</li> <li>Pig\uff08\u540d\u4e3a \u201c\u590d\u5236\u94fe\u63a5\uff08replicated join\uff09\u201d\uff09\uff0cHive\uff08\u201cMapJoin\u201d\uff09\uff0cCascading \u548c Crunch \u652f\u6301\u8fd9\u79cd\u8fde\u63a5\u3002\u5b83\u4e5f\u88ab\u8bf8\u5982 Impala \u7684\u6570\u636e\u4ed3\u5e93\u67e5\u8be2\u5f15\u64ce\u4f7f\u7528\u301041\u3011\u3002</li> </ul> <p>\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u5c06\u8f83\u5c0f\u8f93\u5165\u5b58\u50a8\u5728\u672c\u5730\u78c1\u76d8\u4e0a\u7684\u53ea\u8bfb\u7d22\u5f15\u4e2d\u301042\u3011\u3002</p> <ul> <li>\u7d22\u5f15\u4e2d\u7ecf\u5e38\u4f7f\u7528\u7684\u90e8\u5206\u5c06\u4fdd\u7559\u5728\u64cd\u4f5c\u7cfb\u7edf\u7684\u9875\u9762\u7f13\u5b58\u4e2d\uff0c\u63d0\u4f9b\u4e0e\u5185\u5b58\u6563\u5217\u8868\u51e0\u4e4e\u4e00\u6837\u5feb\u7684\u968f\u673a\u67e5\u627e\u6027\u80fd\uff0c\u4f46\u5b9e\u9645\u4e0a\u5e76\u4e0d\u9700\u8981\u6570\u636e\u96c6\u80fd\u653e\u5165\u5185\u5b58\u4e2d\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_13","title":"\u5206\u533a\u6563\u5217\u8fde\u63a5","text":"<p>\u5982\u679c Map \u4fa7\u8fde\u63a5\u7684\u8f93\u5165\u4ee5\u76f8\u540c\u7684\u65b9\u5f0f\u8fdb\u884c\u5206\u533a\uff0c\u5219\u6563\u5217\u8fde\u63a5\u65b9\u6cd5\u53ef\u4ee5\u72ec\u7acb\u5e94\u7528\u4e8e\u6bcf\u4e2a\u5206\u533a\u3002</p> <ul> <li>\u8fde\u63a5\u4e24\u7aef\u8f93\u5165\u6709\u76f8\u540c\u7684\u5206\u533a\u6570\uff0c\u4e14\u4e24\u4fa7\u7684\u8bb0\u5f55\u90fd\u662f\u4f7f\u7528\u76f8\u540c\u7684\u952e\u4e0e\u76f8\u540c\u7684\u54c8\u5e0c\u51fd\u6570\u505a\u5206\u533a\u65f6\u3002</li> <li>\u5982\u56fe 10-2\u4e2d\u6839\u636e\u7528\u6237 ID \u7684\u6700\u540e\u4e00\u4f4d\u5341\u8fdb\u5236\u6570\u5b57\u6765\u5bf9\u6d3b\u52a8\u4e8b\u4ef6\u548c\u7528\u6237\u6570\u636e\u5e93\u8fdb\u884c\u5206\u533a\uff08\u56e0\u6b64\u8fde\u63a5\u4e24\u4fa7\u5404\u6709 10 \u4e2a\u5206\u533a\u3002</li> </ul> <p>\u5206\u533a\u6563\u5217\u8fde\u63a5\u5728 Hive \u4e2d\u79f0\u4e3a Map \u4fa7\u6876\u8fde\u63a5\uff08bucketed map joins\uff09\u301037\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#map_1","title":"Map\u4fa7\u5408\u5e76\u8fde\u63a5","text":"<p>\u5982\u679c\u8f93\u5165\u6570\u636e\u96c6\u4e0d\u4ec5\u4ee5\u76f8\u540c\u7684\u65b9\u5f0f\u8fdb\u884c\u5206\u533a\uff0c\u800c\u4e14\u8fd8\u57fa\u4e8e\u76f8\u540c\u7684\u952e\u8fdb\u884c \u6392\u5e8f\uff0c\u5219\u53ef\u9002\u7528\u53e6\u4e00\u79cd Map \u4fa7\u8fde\u63a5\u7684\u53d8\u4f53\u3002</p> <ul> <li>\u8f93\u5165\u662f\u5426\u5c0f\u5230\u80fd\u653e\u5165\u5185\u5b58\u5e76\u4e0d\u91cd\u8981\uff0c\u56e0\u4e3a\u8fd9\u65f6\u5019 Mapper \u540c\u6837\u53ef\u4ee5\u6267\u884c\u5f52\u5e76\u64cd\u4f5c\uff1a\u6309\u952e\u9012\u589e\u7684\u987a\u5e8f\u4f9d\u6b21\u8bfb\u53d6\u4e24\u4e2a\u8f93\u5165\u6587\u4ef6\uff0c\u5c06\u5177\u6709\u76f8\u540c\u952e\u7684\u8bb0\u5f55\u914d\u5bf9\u3002</li> </ul> <p>\u5982\u679c\u80fd\u8fdb\u884c Map \u4fa7\u5408\u5e76\u8fde\u63a5\uff0c\u8fd9\u901a\u5e38\u610f\u5473\u7740\u524d\u4e00\u4e2a MapReduce \u4f5c\u4e1a\u53ef\u80fd\u4e00\u5f00\u59cb\u5c31\u5df2\u7ecf\u628a\u8f93\u5165\u6570\u636e\u505a\u4e86\u5206\u533a\u5e76\u8fdb\u884c\u4e86\u6392\u5e8f\u3002</p> <ul> <li>\u539f\u5219\u4e0a\u8fd9\u4e2a\u8fde\u63a5\u5c31\u53ef\u4ee5\u5728\u524d\u4e00\u4e2a\u4f5c\u4e1a\u7684 Reduce \u9636\u6bb5\u8fdb\u884c\u3002</li> <li>\u4f7f\u7528\u72ec\u7acb\u7684\u4ec5 Map \u4f5c\u4e1a\u6709\u65f6\u4e5f\u662f\u5408\u9002\u7684\uff0c\u4f8b\u5982\uff0c\u5206\u597d\u533a\u4e14\u6392\u597d\u5e8f\u7684\u4e2d\u95f4\u6570\u636e\u96c6\u53ef\u80fd\u8fd8\u4f1a\u7528\u4e8e\u5176\u4ed6\u76ee\u7684\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#mapreducemap","title":"MapReduce\u5de5\u4f5c\u6d41\u4e0eMap\u4fa7\u8fde\u63a5","text":"<p>\u5f53\u4e0b\u6e38\u4f5c\u4e1a\u4f7f\u7528 MapReduce \u8fde\u63a5\u7684\u8f93\u51fa\u65f6\uff0c\u9009\u62e9 Map \u4fa7\u8fde\u63a5\u6216 Reduce \u4fa7\u8fde\u63a5\u4f1a\u5f71\u54cd\u8f93\u51fa\u7684\u7ed3\u6784\u3002</p> <ul> <li>Reduce \u4fa7\u8fde\u63a5\u7684\u8f93\u51fa\u662f\u6309\u7167 \u8fde\u63a5\u952e \u8fdb\u884c\u5206\u533a\u548c\u6392\u5e8f\uff0c Map \u7aef\u8fde\u63a5\u7684\u8f93\u51fa\u5219\u6309\u7167\u4e0e\u8f83\u5927\u8f93\u5165\u76f8\u540c\u7684\u65b9\u5f0f\u8fdb\u884c\u5206\u533a\u548c\u6392\u5e8f\u3002</li> </ul> <p>Map \u4fa7\u8fde\u63a5\u4e5f\u5bf9\u8f93\u5165\u6570\u636e\u96c6\u7684\u5927\u5c0f\uff0c\u6709\u5e8f\u6027\u548c\u5206\u533a\u65b9\u5f0f\u505a\u51fa\u4e86\u66f4\u591a\u5047\u8bbe\u3002</p> <ul> <li>\u4e86\u89e3\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u6570\u636e\u96c6\u7684\u7269\u7406\u5e03\u5c40\u53d8\u5f97\u975e\u5e38\u91cd\u8981\uff1a\u5fc5\u987b\u77e5\u9053\u6570\u636e\u662f\u6309\u54ea\u4e9b\u952e\u505a\u7684\u5206\u533a\u548c\u6392\u5e8f\uff0c\u4ee5\u53ca\u5206\u533a\u7684\u6570\u91cf\u3002</li> </ul> <p>\u5728 Hadoop \u751f\u6001\u7cfb\u7edf\u4e2d\uff0c\u8fd9\u79cd\u5173\u4e8e\u6570\u636e\u96c6\u5206\u533a\u7684\u5143\u6570\u636e\u901a\u5e38\u5728 HCatalog \u548c Hive Metastore \u4e2d\u7ef4\u62a4\u301037\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_14","title":"\u6279\u5904\u7406\u5de5\u4f5c\u6d41\u7684\u8f93\u51fa","text":"<p>\u6279\u5904\u7406\u653e\u54ea\u91cc\u5408\u9002\uff1f\u5b83\u4e0d\u5c5e\u4e8e\u4e8b\u52a1\u5904\u7406\uff0c\u4e5f\u4e0d\u662f\u5206\u6790\u3002</p> <ul> <li>\u6279\u5904\u7406\u8fc7\u7a0b\u7684\u8f93\u51fa\u901a\u5e38\u4e0d\u662f\u62a5\u8868\uff0c\u800c\u662f\u4e00\u4e9b\u5176\u4ed6\u7c7b\u578b\u7684\u7ed3\u6784\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_15","title":"\u5efa\u7acb\u641c\u7d22\u7d22\u5f15","text":"<p>Google \u6700\u521d\u4f7f\u7528 MapReduce \u662f\u4e3a\u5176\u641c\u7d22\u5f15\u64ce\u5efa\u7acb\u7d22\u5f15\uff0c\u5176\u5b9e\u73b0\u4e3a\u7531 5 \u5230 10 \u4e2a MapReduce \u4f5c\u4e1a\u7ec4\u6210\u7684\u5de5\u4f5c\u6d41\u30101\u3011\u301043\u3011\u3002Hadoop MapReduce \u4ecd\u7136\u662f\u4e3a Lucene/Solr \u6784\u5efa\u7d22\u5f15\u7684\u597d\u65b9\u6cd5\u301044\u3011\u3002</p> <p>\u5982\u679c\u9700\u8981\u5bf9\u4e00\u7ec4\u56fa\u5b9a\u6587\u6863\u6267\u884c\u5168\u6587\u641c\u7d22\uff0c\u5219\u6279\u5904\u7406\u662f\u4e00\u79cd\u6784\u5efa\u7d22\u5f15\u7684\u9ad8\u6548\u65b9\u6cd5\uff1aMapper \u6839\u636e\u9700\u8981\u5bf9\u6587\u6863\u96c6\u5408\u8fdb\u884c\u5206\u533a\uff0c\u6bcf\u4e2a Reducer \u6784\u5efa\u8be5\u5206\u533a\u7684\u7d22\u5f15\uff0c\u5e76\u5c06\u7d22\u5f15\u6587\u4ef6\u5199\u5165\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u3002</p> <p>\u7531\u4e8e\u6309\u5173\u952e\u5b57\u67e5\u8be2\u641c\u7d22\u7d22\u5f15\u662f\u53ea\u8bfb\u64cd\u4f5c\uff0c\u56e0\u800c\u8fd9\u4e9b\u7d22\u5f15\u6587\u4ef6\u4e00\u65e6\u521b\u5efa\u5c31\u662f\u4e0d\u53ef\u53d8\u7684\u3002\u5982\u679c\u7d22\u5f15\u7684\u6587\u6863\u96c6\u5408\u53d1\u751f\u66f4\u6539</p> <ul> <li>\u4e00\u79cd\u9009\u62e9\u662f\u5b9a\u671f\u91cd\u8dd1\u6574\u4e2a\u7d22\u5f15\u5de5\u4f5c\u6d41\uff0c\u5e76\u5728\u5b8c\u6210\u540e\u7528\u65b0\u7684\u7d22\u5f15\u6587\u4ef6\u6279\u91cf\u66ff\u6362\u4ee5\u524d\u7684\u7d22\u5f15\u6587\u4ef6\u3002</li> <li>\u53e6\u4e00\u4e2a\u9009\u62e9\u662f\uff0c\u53ef\u4ee5\u589e\u91cf\u5efa\u7acb\u7d22\u5f15\u3002\u5982\u679c\u8981\u5728\u7d22\u5f15\u4e2d\u6dfb\u52a0\uff0c\u5220\u9664\u6216\u66f4\u65b0\u6587\u6863\uff0cLucene \u4f1a\u5199\u65b0\u7684\u6bb5\u6587\u4ef6\uff0c\u5e76\u5728\u540e\u53f0\u5f02\u6b65\u5408\u5e76\u538b\u7f29\u6bb5\u6587\u4ef6\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_16","title":"\u952e\u503c\u5b58\u50a8\u4f5c\u4e3a\u6279\u5904\u7406\u8f93\u51fa","text":"<p>\u6279\u5904\u7406\u7684\u53e6\u4e00\u4e2a\u5e38\u89c1\u7528\u9014\u662f\u6784\u5efa\u673a\u5668\u5b66\u4e60\u7cfb\u7edf\uff0c\u4f8b\u5982\u5206\u7c7b\u5668\uff08\u6bd4\u5982\u5783\u573e\u90ae\u4ef6\u8fc7\u6ee4\u5668\uff0c\u5f02\u5e38\u68c0\u6d4b\uff0c\u56fe\u50cf\u8bc6\u522b\uff09\u4e0e\u63a8\u8350\u7cfb\u7edf\u301029\u3011\u3002</p> <ul> <li>\u4f5c\u4e1a\u7684\u8f93\u51fa\u901a\u5e38\u662f\u67d0\u79cd\u6570\u636e\u5e93\uff1a\u4f8b\u5982\uff0c\u53ef\u4ee5\u901a\u8fc7\u7ed9\u5b9a\u7528\u6237 ID \u67e5\u8be2\u8be5\u7528\u6237\u63a8\u8350\u597d\u53cb\u7684\u6570\u636e\u5e93\uff0c\u6216\u8005\u53ef\u4ee5\u901a\u8fc7\u4ea7\u54c1 ID \u67e5\u8be2\u76f8\u5173\u4ea7\u54c1\u7684\u6570\u636e\u5e93\u301045\u3011\u3002</li> </ul> <p>\u6279\u5904\u7406\u8fc7\u7a0b\u7684\u8f93\u51fa\u5982\u4f55\u56de\u5230 Web \u5e94\u7528\u53ef\u4ee5\u67e5\u8be2\u7684\u6570\u636e\u5e93\u4e2d\u5462\uff1f</p> <ul> <li>\u6700\u76f4\u63a5\u7684\u9009\u62e9\uff1a\u5728 Mapper \u6216 Reducer \u4e2d\u4f7f\u7528\u4f60\u6700\u7231\u7684\u6570\u636e\u5e93\u7684\u5ba2\u6237\u7aef\u5e93\uff0c\u5e76\u4ece\u6279\u5904\u7406\u4f5c\u4e1a\u76f4\u63a5\u5199\u5165\u6570\u636e\u5e93\u670d\u52a1\u5668\uff0c\u4e00\u6b21\u5199\u5165\u4e00\u6761\u8bb0\u5f55\u3002</li> <li>\u6027\u80fd\u5dee\uff1a\u4e3a\u6bcf\u6761\u8bb0\u5f55\u53d1\u8d77\u4e00\u4e2a\u7f51\u7edc\u8bf7\u6c42\uff0c\u8981\u6bd4\u6279\u5904\u7406\u4efb\u52a1\u7684\u6b63\u5e38\u541e\u5410\u91cf\u6162\u51e0\u4e2a\u6570\u91cf\u7ea7\u3002\u5373\u4f7f\u5ba2\u6237\u7aef\u5e93\u652f\u6301\u6279\u5904\u7406\u3002</li> <li>\u6570\u636e\u5e93\u5f88\u53ef\u80fd\u88ab\u8f7b\u6613\u538b\u57ae\u301035\u3011\uff0cMapReduce \u4f5c\u4e1a\u7ecf\u5e38\u5e76\u884c\u8fd0\u884c\u8bb8\u591a\u4efb\u52a1\uff0c\u4ee5\u6279\u5904\u7406\u7684\u9884\u671f\u901f\u7387\u5de5\u4f5c\u3002</li> <li> <p>\u526f\u4f5c\u7528\uff1aMapReduce \u4e3a\u4f5c\u4e1a\u8f93\u51fa\u63d0\u4f9b\u4e86\u201c\u5168\u6709\u6216\u5168\u65e0\u201d \u4fdd\u8bc1\u3002\u4ece\u4f5c\u4e1a\u5185\u90e8\u5199\u5165\u5916\u90e8\u7cfb\u7edf\uff0c\u4f1a\u4ea7\u751f\u5916\u90e8\u53ef\u89c1\u7684\u526f\u4f5c\u7528\u3002</p> </li> <li> <p>\u66f4\u597d\u7684\u89e3\u51b3\u65b9\u6848\u662f\u5728\u6279\u5904\u7406\u4f5c\u4e1a \u5185 \u521b\u5efa\u4e00\u4e2a\u5168\u65b0\u7684\u6570\u636e\u5e93\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3a\u6587\u4ef6\u5199\u5165\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u4f5c\u4e1a\u7684\u8f93\u51fa\u76ee\u5f55\u3002</p> </li> <li>\u6570\u636e\u6587\u4ef6\u4e00\u65e6\u5199\u5165\u5c31\u662f\u4e0d\u53ef\u53d8\u7684\uff0c\u53ef\u4ee5\u6279\u91cf\u52a0\u8f7d\u5230\u5904\u7406\u53ea\u8bfb\u67e5\u8be2\u7684\u670d\u52a1\u5668\u4e2d\u3002\u5982 Voldemort \u301046\u3011\u3001Terrapin \u301047\u3011\u3001ElephantDB \u301048\u3011\u548c HBase \u6279\u91cf\u52a0\u8f7d\u301049\u3011\u3002</li> </ul> <p>\u6784\u5efa\u8fd9\u4e9b\u6570\u636e\u5e93\u6587\u4ef6\u662f MapReduce \u7684\u4e00\u79cd\u597d\u7528\u6cd5\uff1a\u4f7f\u7528 Mapper \u63d0\u53d6\u51fa\u952e\u5e76\u6309\u8be5\u952e\u6392\u5e8f\uff0c\u5df2\u7ecf\u5b8c\u6210\u4e86\u6784\u5efa\u7d22\u5f15\u6240\u5fc5\u9700\u7684\u5927\u91cf\u5de5\u4f5c\u3002</p> <ul> <li>\u8fd9\u4e9b\u952e\u503c\u5b58\u50a8\u5927\u591a\u90fd\u662f\u53ea\u8bfb\u7684\uff08\u6587\u4ef6\u53ea\u80fd\u7531\u6279\u5904\u7406\u4f5c\u4e1a\u4e00\u6b21\u6027\u5199\u5165\uff0c\u7136\u540e\u5c31\u4e0d\u53ef\u53d8\uff09\uff0c\u6240\u4ee5\u6570\u636e\u7ed3\u6784\u975e\u5e38\u7b80\u5355\u3002\u6bd4\u5982\u5b83\u4eec\u5c31\u4e0d\u9700\u8981\u9884\u5199\u5f0f\u65e5\u5fd7\u3002</li> </ul> <p>\u5c06\u6570\u636e\u52a0\u8f7d\u5230 Voldemort \u65f6\uff0c\u670d\u52a1\u5668\u5c06\u7ee7\u7eed\u7528\u65e7\u6570\u636e\u6587\u4ef6\u670d\u52a1\u8bf7\u6c42\uff0c\u540c\u65f6\u5c06\u65b0\u6570\u636e\u6587\u4ef6\u4ece\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u590d\u5236\u5230\u670d\u52a1\u5668\u7684\u672c\u5730\u78c1\u76d8\u3002\u4e00\u65e6\u590d\u5236\u5b8c\u6210\uff0c\u670d\u52a1\u5668\u4f1a\u81ea\u52a8\u5c06\u67e5\u8be2\u5207\u6362\u5230\u65b0\u6587\u4ef6\u3002\u5982\u679c\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4efb\u4f55\u95ee\u9898\uff0c\u5b83\u53ef\u4ee5\u8f7b\u6613\u56de\u6eda\u81f3\u65e7\u6587\u4ef6\uff0c\u56e0\u4e3a\u5b83\u4eec\u4ecd\u7136\u5b58\u5728\u800c\u4e14\u4e0d\u53ef\u53d8\u301046\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_17","title":"\u6279\u5904\u7406\u8f93\u51fa\u7684\u54f2\u5b66","text":"<p>Unix \u54f2\u5b66\u9f13\u52b1\u4ee5\u663e\u5f0f\u6307\u660e\u6570\u636e\u6d41\u7684\u65b9\u5f0f\u8fdb\u884c\u5b9e\u9a8c\uff1a\u7a0b\u5e8f\u8bfb\u53d6\u8f93\u5165\u5e76\u5199\u5165\u8f93\u51fa\u3002\u5728\u8fd9\u4e00\u8fc7\u7a0b\u4e2d\uff0c\u8f93\u5165\u4fdd\u6301\u4e0d\u53d8\uff0c\u4efb\u4f55\u5148\u524d\u7684\u8f93\u51fa\u90fd\u88ab\u65b0\u8f93\u51fa\u5b8c\u5168\u66ff\u6362\uff0c\u4e14\u6ca1\u6709\u5176\u4ed6\u526f\u4f5c\u7528\u3002</p> <p>MapReduce \u4f5c\u4e1a\u7684\u8f93\u51fa\u5904\u7406\u9075\u5faa\u540c\u6837\u7684Unix\u539f\u7406\u3002\u901a\u8fc7\u5c06\u8f93\u5165\u89c6\u4e3a\u4e0d\u53ef\u53d8\u4e14\u907f\u514d\u526f\u4f5c\u7528\uff08\u5982\u5199\u5165\u5916\u90e8\u6570\u636e\u5e93\uff09\uff0c\u6279\u5904\u7406\u4f5c\u4e1a\u4e0d\u4ec5\u5b9e\u73b0\u4e86\u826f\u597d\u7684\u6027\u80fd\uff0c\u800c\u4e14\u66f4\u5bb9\u6613\u7ef4\u62a4\uff1a</p> <ul> <li>\u5982\u679c\u5728\u4ee3\u7801\u4e2d\u5f15\u5165\u4e86\u4e00\u4e2a\u9519\u8bef\uff0c\u800c\u8f93\u51fa\u9519\u8bef\u6216\u635f\u574f\u4e86\uff0c\u5219\u53ef\u4ee5\u7b80\u5355\u5730\u56de\u6eda\u5230\u4ee3\u7801\u7684\u5148\u524d\u7248\u672c\uff0c\u7136\u540e\u91cd\u65b0\u8fd0\u884c\u8be5\u4f5c\u4e1a\uff0c\u8f93\u51fa\u5c06\u91cd\u65b0\u88ab\u7ea0\u6b63\u3002\uff08\u80fd\u591f\u4ece\u9519\u8bef\u4ee3\u7801\u4e2d\u6062\u590d\u7684\u6982\u5ff5\u88ab\u79f0\u4e3a \u4eba\u7c7b\u5bb9\u9519\uff08human fault tolerance\uff09\u301050\u3011\uff09</li> <li> <p>\u7531\u4e8e\u56de\u6eda\u5f88\u5bb9\u6613\uff0c\u6bd4\u8d77\u5728\u9519\u8bef\u610f\u5473\u7740\u4e0d\u53ef\u633d\u56de\u7684\u4f24\u5bb3\u7684\u73af\u5883\uff0c\u529f\u80fd\u5f00\u53d1\u8fdb\u5c55\u80fd\u5feb\u5f88\u591a\u3002\u8fd9\u79cd \u6700\u5c0f\u5316\u4e0d\u53ef\u9006\u6027\uff08minimizing irreversibility\uff09 \u7684\u539f\u5219\u6709\u5229\u4e8e\u654f\u6377\u8f6f\u4ef6\u5f00\u53d1\u301051\u3011\u3002</p> </li> <li> <p>\u5982\u679c Map \u6216 Reduce \u4efb\u52a1\u5931\u8d25\uff0cMapReduce \u6846\u67b6\u5c06\u81ea\u52a8\u91cd\u65b0\u8c03\u5ea6\uff0c\u5e76\u5728\u540c\u6837\u7684\u8f93\u5165\u4e0a\u518d\u6b21\u8fd0\u884c\u5b83\u3002\u56e0\u4e3a\u8f93\u5165\u4e0d\u53ef\u53d8\uff0c\u8fd9\u79cd\u81ea\u52a8\u91cd\u8bd5\u662f\u5b89\u5168\u7684\uff0c\u800c\u5931\u8d25\u4efb\u52a1\u7684\u8f93\u51fa\u4f1a\u88ab MapReduce \u6846\u67b6\u4e22\u5f03\u3002</p> </li> <li>\u540c\u4e00\u7ec4\u6587\u4ef6\u53ef\u7528\u4f5c\u5404\u79cd\u4e0d\u540c\u4f5c\u4e1a\u7684\u8f93\u5165\uff0c\u5305\u62ec\u8ba1\u7b97\u6307\u6807\u7684\u76d1\u63a7\u4f5c\u4e1a\u5e76\u4e14\u8bc4\u4f30\u4f5c\u4e1a\u7684\u8f93\u51fa\u662f\u5426\u5177\u6709\u9884\u671f\u7684\u6027\u8d28\uff08\u4f8b\u5982\uff0c\u5c06\u5176\u4e0e\u524d\u4e00\u6b21\u8fd0\u884c\u7684\u8f93\u51fa\u8fdb\u884c\u6bd4\u8f83\u5e76\u6d4b\u91cf\u5dee\u5f02\uff09 \u3002</li> <li>MapReduce \u4f5c\u4e1a\u5c06\u903b\u8f91\u4e0e\u5e03\u7ebf\uff08\u914d\u7f6e\u8f93\u5165\u548c\u8f93\u51fa\u76ee\u5f55\uff09\u5206\u79bb\uff0c\u8fd9\u4f7f\u5f97\u5173\u6ce8\u70b9\u5206\u79bb\uff0c\u53ef\u4ee5\u91cd\u7528\u4ee3\u7801\uff1a\u4e00\u4e2a\u56e2\u961f\u53ef\u4ee5\u4e13\u6ce8\u5b9e\u73b0\u4e00\u4e2a\u505a\u597d\u4e00\u4ef6\u4e8b\u7684\u4f5c\u4e1a\uff1b\u800c\u5176\u4ed6\u56e2\u961f\u53ef\u4ee5\u51b3\u5b9a\u4f55\u65f6\u4f55\u5730\u8fd0\u884c\u8fd9\u9879\u4f5c\u4e1a\u3002</li> </ul> <p>\u5728 Hadoop \u4e0a\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u66f4\u7ed3\u6784\u5316\u7684\u6587\u4ef6\u683c\u5f0f\u6d88\u9664\u4e00\u4e9b\u4f4e\u4ef7\u503c\u7684\u8bed\u6cd5\u8f6c\u6362\uff1a\u6bd4\u5982 Avro\uff08\u8bf7\u53c2\u9605 \u201cAvro\u201d\uff09\u548c Parquet\uff08\u8bf7\u53c2\u9605 \u201c\u5217\u5f0f\u5b58\u50a8\u201d\uff09\u7ecf\u5e38\u4f7f\u7528\uff0c\u56e0\u4e3a\u5b83\u4eec\u63d0\u4f9b\u4e86\u57fa\u4e8e\u6a21\u5f0f\u7684\u9ad8\u6548\u7f16\u7801\uff0c\u5e76\u5141\u8bb8\u6a21\u5f0f\u968f\u65f6\u95f4\u63a8\u79fb\u800c\u6f14\u8fdb\uff08\u89c1 \u7b2c\u56db\u7ae0\uff09\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#hadoop","title":"Hadoop\u4e0e\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u7684\u5bf9\u6bd4","text":"<p>\u5f53 MapReduce \u8bba\u6587\u53d1\u8868\u65f6\u30101\u3011\uff0c\u5b83\u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\u6765\u8bf4 \u2014\u2014 \u5e76\u4e0d\u65b0\u9c9c\u3002\u6211\u4eec\u5728\u524d\u51e0\u8282\u4e2d\u8ba8\u8bba\u7684\u6240\u6709\u5904\u7406\u548c\u5e76\u884c\u8fde\u63a5\u7b97\u6cd5\u5df2\u7ecf\u5728\u5341\u591a\u5e74\u524d\u6240\u8c13\u7684 \u5927\u89c4\u6a21\u5e76\u884c\u5904\u7406\uff08MPP\uff0cmassively parallel processing\uff09 \u6570\u636e\u5e93\u4e2d\u5b9e\u73b0\u4e86\u30103,40\u3011\u3002\u6bd4\u5982 Gamma database machine\u3001Teradata \u548c Tandem NonStop SQL \u5c31\u662f\u8fd9\u65b9\u9762\u7684\u5148\u9a71\u301052\u3011\u3002</p> <p>\u6700\u5927\u7684\u533a\u522b\u662f\uff0cMPP \u6570\u636e\u5e93\u4e13\u6ce8\u4e8e\u5728\u4e00\u7ec4\u673a\u5668\u4e0a\u5e76\u884c\u6267\u884c\u5206\u6790 SQL \u67e5\u8be2\uff0c\u800c MapReduce \u548c\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u301019\u3011\u7684\u7ec4\u5408\u5219\u66f4\u50cf\u662f\u4e00\u4e2a\u53ef\u4ee5\u8fd0\u884c\u4efb\u610f\u7a0b\u5e8f\u7684\u901a\u7528\u64cd\u4f5c\u7cfb\u7edf\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_18","title":"\u5b58\u50a8\u591a\u6837\u6027","text":"<p>Hadoop \u5f00\u653e\u4e86\u5c06\u6570\u636e\u4e0d\u52a0\u533a\u5206\u5730\u8f6c\u50a8\u5230 HDFS \u7684\u53ef\u80fd\u6027\uff0c\u5141\u8bb8\u540e\u7eed\u518d\u7814\u7a76\u5982\u4f55\u8fdb\u4e00\u6b65\u5904\u7406\u301053\u3011\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u5728\u5c06\u6570\u636e\u5bfc\u5165\u6570\u636e\u5e93\u4e13\u6709\u5b58\u50a8\u683c\u5f0f\u4e4b\u524d\uff0cMPP \u6570\u636e\u5e93\u901a\u5e38\u9700\u8981\u5bf9\u6570\u636e\u548c\u67e5\u8be2\u6a21\u5f0f\u8fdb\u884c\u4ed4\u7ec6\u7684\u524d\u671f\u5efa\u6a21\u3002</p> <p>\u5b9e\u8df5\u7ecf\u9a8c\u8868\u660e\uff0c\u7b80\u5355\u5730\u4f7f\u6570\u636e\u5feb\u901f\u53ef\u7528 \u2014\u2014 \u5373\u4f7f\u5b83\u5f88\u53e4\u602a\uff0c\u96be\u4ee5\u4f7f\u7528\uff0c\u4f7f\u7528\u539f\u59cb\u683c\u5f0f \u2014\u2014 \u4e5f\u901a\u5e38\u8981\u6bd4\u4e8b\u5148\u51b3\u5b9a\u7406\u60f3\u6570\u636e\u6a21\u578b\u8981\u66f4\u6709\u4ef7\u503c\u301054\u3011\u3002</p> <p>\u4ee5\u539f\u59cb\u5f62\u5f0f\u6536\u96c6\u6570\u636e\uff0c\u7a0d\u540e\u518d\u64cd\u5fc3\u6a21\u5f0f\u7684\u8bbe\u8ba1\uff0c\u80fd\u4f7f\u6570\u636e\u6536\u96c6\u901f\u5ea6\u52a0\u5feb\uff08\u6709\u65f6\u88ab\u79f0\u4e3a \u201c\u6570\u636e\u6e56\uff08data lake\uff09\u201d \u6216 \u201c\u4f01\u4e1a\u6570\u636e\u4e2d\u5fc3\uff08enterprise data hub\uff09\u201d\u301055\u3011\uff09\u3002</p> <p>\u4e0d\u52a0\u533a\u5206\u7684\u6570\u636e\u8f6c\u50a8\u8f6c\u79fb\u4e86\u89e3\u91ca\u6570\u636e\u7684\u8d1f\u62c5\uff1a\u6570\u636e\u96c6\u7684\u751f\u4ea7\u8005\u4e0d\u518d\u9700\u8981\u5f3a\u5236\u5c06\u5176\u8f6c\u5316\u4e3a\u6807\u51c6\u683c\u5f0f\uff0c\u6570\u636e\u7684\u89e3\u91ca\u6210\u4e3a\u6d88\u8d39\u8005\u7684\u95ee\u9898\uff08\u8bfb\u65f6\u6a21\u5f0f \u65b9\u6cd5\u301056\u3011\uff09\u3002\u4ee5\u539f\u59cb\u5f62\u5f0f\u7b80\u5355\u5730\u8f6c\u50a8\u6570\u636e\uff0c\u53ef\u4ee5\u5141\u8bb8\u591a\u79cd\u8fd9\u6837\u7684\u8f6c\u6362\u3002\u8fd9\u79cd\u65b9\u6cd5\u88ab\u79f0\u4e3a \u5bff\u53f8\u539f\u5219\uff08sushi principle\uff09\uff1a\u201c\u539f\u59cb\u6570\u636e\u66f4\u597d\u201d\u301057\u3011\u3002</p> <p>Hadoop \u7ecf\u5e38\u88ab\u7528\u4e8e\u5b9e\u73b0 ETL \u8fc7\u7a0b\uff1a\u4e8b\u52a1\u5904\u7406\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\u4ee5\u67d0\u79cd\u539f\u59cb\u5f62\u5f0f\u8f6c\u50a8\u5230\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u7136\u540e\u7f16\u5199 MapReduce \u4f5c\u4e1a\u6765\u6e05\u7406\u6570\u636e\uff0c\u5c06\u5176\u8f6c\u6362\u4e3a\u5173\u7cfb\u5f62\u5f0f\uff0c\u5e76\u5c06\u5176\u5bfc\u5165 MPP \u6570\u636e\u4ed3\u5e93\u4ee5\u8fdb\u884c\u5206\u6790\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_19","title":"\u5904\u7406\u6a21\u578b\u7684\u591a\u6837\u6027","text":"<p>MPP \u6570\u636e\u5e93\u662f\u5355\u4f53\u7684\uff0c\u7d27\u5bc6\u96c6\u6210\u7684\u8f6f\u4ef6\uff0c\u9488\u5bf9\u6570\u636e\u5e93\u7684\u7279\u5b9a\u9700\u6c42\u8fdb\u884c\u8c03\u6574\u548c\u4f18\u5316\uff0c\u56e0\u6b64\u6574\u4e2a\u7cfb\u7edf\u53ef\u4ee5\u5728\u5176\u8bbe\u8ba1\u9488\u5bf9\u7684\u67e5\u8be2\u7c7b\u578b\u4e0a\u53d6\u5f97\u975e\u5e38\u597d\u7684\u6027\u80fd\u3002SQL \u67e5\u8be2\u8bed\u8a00\u5141\u8bb8\u4ee5\u4f18\u96c5\u7684\u8bed\u6cd5\u8868\u8fbe\u67e5\u8be2\uff0c\u800c\u65e0\u9700\u7f16\u5199\u4ee3\u7801\uff0c\u53ef\u4ee5\u5728\u4e1a\u52a1\u5206\u6790\u5e08\u4f7f\u7528\u7684\u53ef\u89c6\u5316\u5de5\u5177\uff08\u4f8b\u5982 Tableau\uff09\u4e2d\u8bbf\u95ee\u5230\u3002</p> <p>\u5e76\u975e\u6240\u6709\u7c7b\u578b\u7684\u5904\u7406\u90fd\u53ef\u4ee5\u5408\u7406\u5730\u8868\u8fbe\u4e3a SQL \u67e5\u8be2\u3002\u5982\u673a\u5668\u5b66\u4e60\u3001\u63a8\u8350\u7cfb\u7edf\u3001\u5168\u6587\u641c\u7d22\u3001\u56fe\u5f62\u6a21\u578b\u7b49\uff0c\u9700\u8981\u66f4\u4e00\u822c\u7684\u6570\u636e\u5904\u7406\u6a21\u578b\u3002\u4e0d\u53ef\u907f\u514d\u5730\u9700\u8981\u7f16\u5199\u4ee3\u7801\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u67e5\u8be2\u3002</p> <p>MapReduce \u4f7f\u5de5\u7a0b\u5e08\u80fd\u591f\u8f7b\u677e\u5730\u5728\u5927\u578b\u6570\u636e\u96c6\u4e0a\u8fd0\u884c\u81ea\u5df1\u7684\u4ee3\u7801\u3002\u5982\u679c\u4f60\u6709 HDFS \u548c MapReduce\uff0c\u90a3\u4e48\u4f60 \u53ef\u4ee5 \u5728\u5b83\u4e4b\u4e0a\u5efa\u7acb\u4e00\u4e2a SQL \u67e5\u8be2\u6267\u884c\u5f15\u64ce\uff0c\u4e8b\u5b9e\u4e0a\u8fd9\u6b63\u662f Hive \u9879\u76ee\u6240\u505a\u7684\u301031\u3011\u3002\u4f46\u662f\uff0c\u4f60\u4e5f\u53ef\u4ee5\u7f16\u5199\u8bb8\u591a\u5176\u4ed6\u5f62\u5f0f\u7684\u6279\u5904\u7406\uff0c\u8fd9\u4e9b\u6279\u5904\u7406\u4e0d\u5fc5\u975e\u8981\u7528 SQL \u67e5\u8be2\u8868\u793a\u3002</p> <p>MapReduce \u5bf9\u4e8e\u67d0\u4e9b\u7c7b\u578b\u7684\u5904\u7406\u800c\u8a00\u5c40\u9650\u6027\u5f88\u5927\uff0c\u56e0\u6b64\u5728 Hadoop \u4e4b\u4e0a\u5176\u4ed6\u5404\u79cd\u5904\u7406\u6a21\u578b\u4e5f\u88ab\u5f00\u53d1\u51fa\u6765\u3002</p> <ul> <li>\u53ea\u6709\u4e24\u79cd\u5904\u7406\u6a21\u578b\uff0cSQL \u548c MapReduce\uff0c\u8fd8\u4e0d\u591f\uff1b\u7531\u4e8e Hadoop \u5e73\u53f0\u7684\u5f00\u653e\u6027\uff0c\u5b9e\u65bd\u4e00\u6574\u5957\u65b9\u6cd5\u662f\u53ef\u884c\u7684\uff0c\u800c\u8fd9\u5728\u5355\u4f53 MPP \u6570\u636e\u5e93\u7684\u8303\u7574\u5185\u662f\u4e0d\u53ef\u80fd\u7684\u301058\u3011\u3002</li> </ul> <p>\u5728 Hadoop \u65b9\u5f0f\u4e2d\uff0c\u4e0d\u9700\u8981\u5c06\u6570\u636e\u5bfc\u5165\u5230\u51e0\u4e2a\u4e0d\u540c\u7684\u4e13\u7528\u7cfb\u7edf\u4e2d\u8fdb\u884c\u4e0d\u540c\u7c7b\u578b\u7684\u5904\u7406\uff1a\u7cfb\u7edf\u8db3\u591f\u7075\u6d3b\uff0c\u53ef\u4ee5\u652f\u6301\u540c\u4e00\u4e2a\u96c6\u7fa4\u5185\u4e0d\u540c\u7684\u5de5\u4f5c\u8d1f\u8f7d\u3002\u4e0d\u9700\u8981\u79fb\u52a8\u6570\u636e\uff0c\u4f7f\u5f97\u4ece\u6570\u636e\u4e2d\u6316\u6398\u4ef7\u503c\u53d8\u5f97\u5bb9\u6613\u5f97\u591a\uff0c\u4e5f\u4f7f\u91c7\u7528\u65b0\u7684\u5904\u7406\u6a21\u578b\u5bb9\u6613\u7684\u591a\u3002</p> <p>Hadoop \u751f\u6001\u7cfb\u7edf\u5305\u62ec\u968f\u673a\u8bbf\u95ee\u7684 OLTP \u6570\u636e\u5e93\uff0c\u5982 HBase \u548c MPP \u98ce\u683c\u7684\u5206\u6790\u578b\u6570\u636e\u5e93\uff0c\u5982 Impala \u301041\u3011\u3002HBase \u4e0e Impala \u90fd\u4e0d\u4f7f\u7528 MapReduce\uff0c\u4f46\u90fd\u4f7f\u7528 HDFS \u8fdb\u884c\u5b58\u50a8\u3002\u5b83\u4eec\u662f\u8fe5\u5f02\u7684\u6570\u636e\u8bbf\u95ee\u4e0e\u5904\u7406\u65b9\u6cd5\uff0c\u4f46\u662f\u5b83\u4eec\u53ef\u4ee5\u5171\u5b58\uff0c\u5e76\u88ab\u96c6\u6210\u5230\u540c\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_20","title":"\u9488\u5bf9\u9891\u7e41\u6545\u969c\u8bbe\u8ba1","text":"<p>\u5982\u679c\u4e00\u4e2a\u8282\u70b9\u5728\u6267\u884c\u67e5\u8be2\u65f6\u5d29\u6e83\uff0c\u5927\u591a\u6570 MPP \u6570\u636e\u5e93\u4f1a\u4e2d\u6b62\u6574\u4e2a\u67e5\u8be2\uff0c\u5e76\u8ba9\u7528\u6237\u91cd\u65b0\u63d0\u4ea4\u67e5\u8be2\u6216\u81ea\u52a8\u91cd\u65b0\u8fd0\u884c\u5b83\u30103\u3011\u3002</p> <p>MapReduce \u65b9\u5f0f\u66f4\u9002\u7528\u4e8e\u8f83\u5927\u7684\u4f5c\u4e1a\uff1a\u8981\u5904\u7406\u5982\u6b64\u4e4b\u591a\u7684\u6570\u636e\u5e76\u8fd0\u884c\u5f88\u957f\u65f6\u95f4\u7684\u4f5c\u4e1a\uff0c\u4ee5\u81f3\u4e8e\u5728\u6b64\u8fc7\u7a0b\u4e2d\u5f88\u53ef\u80fd\u81f3\u5c11\u9047\u5230\u4e00\u4e2a\u4efb\u52a1\u6545\u969c\u3002\u5373\u4f7f\u4ee5\u5355\u4e2a\u4efb\u52a1\u7684\u7c92\u5ea6\u8fdb\u884c\u6062\u590d\u5f15\u5165\u4e86\u4f7f\u5f97\u65e0\u6545\u969c\u5904\u7406\u66f4\u6162\u7684\u5f00\u9500\uff0c\u4f46\u5982\u679c\u4efb\u52a1\u5931\u8d25\u7387\u8db3\u591f\u9ad8\uff0c\u8fd9\u4ecd\u7136\u662f\u4e00\u79cd\u5408\u7406\u7684\u6743\u8861\u3002</p> <ul> <li>\u4e86\u89e3\u6700\u521d\u8bbe\u8ba1 MapReduce \u7684\u73af\u5883\uff1aGoogle \u6709\u7740\u6df7\u7528\u7684\u6570\u636e\u4e2d\u5fc3\uff0c\u5728\u7ebf\u751f\u4ea7\u670d\u52a1\u548c\u79bb\u7ebf\u6279\u5904\u7406\u4f5c\u4e1a\u5728\u540c\u6837\u673a\u5668\u4e0a\u8fd0\u884c\uff1b</li> <li>\u4f18\u5148\u7ea7\u8f83\u9ad8\u7684\u4efb\u52a1\u9700\u8981\u66f4\u591a\u7684\u8d44\u6e90\uff0c\u5219\u53ef\u4ee5\u7ec8\u6b62\uff08\u62a2\u5360\uff09\u540c\u4e00\u53f0\u673a\u5668\u4e0a\u8f83\u4f4e\u4f18\u5148\u7ea7\u7684\u4efb\u52a1\u4ee5\u91ca\u653e\u8d44\u6e90\uff1b</li> <li>\u5728\u8c37\u6b4c\uff0c\u8fd0\u884c\u4e00\u4e2a\u5c0f\u65f6\u7684 MapReduce \u4efb\u52a1\u6709\u5927\u7ea6\u6709 5% \u7684\u98ce\u9669\u88ab\u7ec8\u6b62\uff0c\u4e3a\u4e86\u7ed9\u66f4\u9ad8\u4f18\u5148\u7ea7\u7684\u8fdb\u7a0b\u632a\u5730\u65b9\u3002\u8fd9\u4e00\u6982\u7387\u6bd4\u786c\u4ef6\u95ee\u9898\u3001\u673a\u5668\u91cd\u542f\u6216\u5176\u4ed6\u539f\u56e0\u7684\u6982\u7387\u9ad8\u4e86\u4e00\u4e2a\u6570\u91cf\u7ea7\u301059\u3011\u3002</li> <li>\u6309\u7167\u8fd9\u79cd\u62a2\u5360\u7387\uff0c\u5982\u679c\u4e00\u4e2a\u4f5c\u4e1a\u6709 100 \u4e2a\u4efb\u52a1\uff0c\u6bcf\u4e2a\u4efb\u52a1\u8fd0\u884c 10 \u5206\u949f\uff0c\u90a3\u4e48\u81f3\u5c11\u6709\u4e00\u4e2a\u4efb\u52a1\u5728\u5b8c\u6210\u4e4b\u524d\u88ab\u7ec8\u6b62\u7684\u98ce\u9669\u5927\u4e8e 50%\u3002</li> </ul> <p>MapReduce \u88ab\u8bbe\u8ba1\u4e3a\u5bb9\u5fcd\u9891\u7e41\u610f\u5916\u4efb\u52a1\u7ec8\u6b62\u7684\u539f\u56e0\uff1a\u4e0d\u662f\u56e0\u4e3a\u786c\u4ef6\u5f88\u4e0d\u53ef\u9760\uff0c\u800c\u662f\u56e0\u4e3a\u4efb\u610f\u7ec8\u6b62\u8fdb\u7a0b\u7684\u81ea\u7531\u6709\u5229\u4e8e\u63d0\u9ad8\u8ba1\u7b97\u96c6\u7fa4\u4e2d\u7684\u8d44\u6e90\u5229\u7528\u7387\u3002</p> <p>\u5728\u5f00\u6e90\u7684\u96c6\u7fa4\u8c03\u5ea6\u5668\u4e2d\uff0c\u62a2\u5360\u7684\u4f7f\u7528\u8f83\u5c11\u3002MapReduce \u7684\u8fd9\u4e00\u8bbe\u8ba1\u51b3\u7b56\u5c31\u6ca1\u6709\u591a\u5c11\u610f\u4e49\u4e86\u3002</p> <ul> <li>YARN \u7684 CapacityScheduler \u652f\u6301\u62a2\u5360\uff0c\u4ee5\u5e73\u8861\u4e0d\u540c\u961f\u5217\u7684\u8d44\u6e90\u5206\u914d\u301058\u3011\uff0c\u4f46\u5728\u7f16\u5199\u672c\u6587\u65f6\uff0cYARN\uff0cMesos \u6216 Kubernetes \u4e0d\u652f\u6301\u901a\u7528\u7684\u4f18\u5148\u7ea7\u62a2\u5360\u301060\u3011\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#mapreduce_4","title":"MapReduce\u4e4b\u540e","text":"<p>MapReduce \u662f\u5206\u5e03\u5f0f\u8ba1\u7b97\u6846\u67b6\u7684\u4e00\u79cd\u76f8\u5f53\u7b80\u5355\u660e\u6670\u7684\u62bd\u8c61\uff1a</p> <ul> <li>\u7b80\u5355 \u610f\u5473\u7740\u6211\u4eec\u80fd\u7406\u89e3\u5b83\u5728\u505a\u4ec0\u4e48\uff0c\u800c\u4e0d\u662f\u610f\u5473\u7740\u4f7f\u7528\u5b83\u5f88\u7b80\u5355\uff1b</li> <li>\u4f7f\u7528\u539f\u59cb\u7684 MapReduce API \u6765\u5b9e\u73b0\u590d\u6742\u7684\u5904\u7406\u5de5\u4f5c\u5b9e\u9645\u4e0a\u662f\u975e\u5e38\u56f0\u96be\u548c\u8d39\u529b\uff0c\u5982\u4efb\u610f\u4e00\u79cd\u8fde\u63a5\u7b97\u6cd5\u90fd\u9700\u8981\u4f60\u4ece\u5934\u5f00\u59cb\u5b9e\u73b0\u301037\u3011\u3002</li> <li>\u6709\u5f88\u591a\u9ad8\u7ea7\u7f16\u7a0b\u6a21\u578b\uff08Pig\u3001Hive\u3001Cascading\u3001Crunch\uff09\u5efa\u7acb\u5728 MapReduce \u4e4b\u4e0a\u7684\u62bd\u8c61\u3002</li> </ul> <p>\u4f46\u662f\uff0cMapReduce \u6267\u884c\u6a21\u578b\u672c\u8eab\u4e5f\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff0c\u8fd9\u4e9b\u95ee\u9898\u5e76\u6ca1\u6709\u901a\u8fc7\u589e\u52a0\u53e6\u4e00\u4e2a\u62bd\u8c61\u5c42\u6b21\u800c\u89e3\u51b3\uff0c\u800c\u5bf9\u4e8e\u67d0\u4e9b\u7c7b\u578b\u7684\u5904\u7406\uff0c\u5b83\u8868\u73b0\u5f97\u975e\u5e38\u5dee\u52b2\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_21","title":"\u7269\u5316\u4e2d\u95f4\u72b6\u6001","text":"<p>\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\uff0c\u4f60\u77e5\u9053\u4e00\u4e2a\u4f5c\u4e1a\u7684\u8f93\u51fa\u53ea\u80fd\u7528\u4f5c\u53e6\u4e00\u4e2a\u4f5c\u4e1a\u7684\u8f93\u5165\u3002\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u6587\u4ef6\u53ea\u662f\u7b80\u5355\u7684 \u4e2d\u95f4\u72b6\u6001\uff08intermediate state\uff09\uff1a\u4e00\u79cd\u5c06\u6570\u636e\u4ece\u4e00\u4e2a\u4f5c\u4e1a\u4f20\u9012\u5230\u4e0b\u4e00\u4e2a\u4f5c\u4e1a\u7684\u65b9\u5f0f\u3002</p> <ul> <li>\u5728\u4e00\u4e2a\u7528\u4e8e\u6784\u5efa\u63a8\u8350\u7cfb\u7edf\u7684\uff0c\u7531 50 \u6216 100 \u4e2a MapReduce \u4f5c\u4e1a\u7ec4\u6210\u7684\u590d\u6742\u5de5\u4f5c\u6d41\u4e2d\uff0c\u5b58\u5728\u7740\u5f88\u591a\u8fd9\u6837\u7684\u4e2d\u95f4\u72b6\u6001\u301029\u3011\u3002</li> </ul> <p>\u672c\u7ae0\u5f00\u5934\u7684\u65e5\u5fd7\u5206\u6790\u793a\u4f8b\u4f7f\u7528 Unix \u7ba1\u9053\u5c06\u4e00\u4e2a\u547d\u4ee4\u7684\u8f93\u51fa\u4e0e\u53e6\u4e00\u4e2a\u547d\u4ee4\u7684\u8f93\u5165\u8fde\u63a5\u8d77\u6765\u3002\u7ba1\u9053\u5e76\u6ca1\u6709\u5b8c\u5168\u7269\u5316\u4e2d\u95f4\u72b6\u6001\uff0c\u800c\u662f\u53ea\u4f7f\u7528\u4e00\u4e2a\u5c0f\u7684\u5185\u5b58\u7f13\u51b2\u533a\uff0c\u5c06\u8f93\u51fa\u589e\u91cf\u5730 \u6d41\uff08stream\uff09 \u5411\u8f93\u5165\u3002</p> <p>\u4e0e Unix \u7ba1\u9053\u76f8\u6bd4\uff0cMapReduce \u5b8c\u5168\u7269\u5316\u4e2d\u95f4\u72b6\u6001\u7684\u65b9\u6cd5\u5b58\u5728\u4e0d\u8db3\u4e4b\u5904\uff1a</p> <ul> <li>MapReduce \u4f5c\u4e1a\u53ea\u6709\u5728\u524d\u9a71\u4f5c\u4e1a\uff08\u751f\u6210\u5176\u8f93\u5165\uff09\u4e2d\u7684\u6240\u6709\u4efb\u52a1\u90fd\u5b8c\u6210\u65f6\u624d\u80fd\u542f\u52a8\uff0c\u800c\u7531 Unix \u7ba1\u9053\u8fde\u63a5\u7684\u8fdb\u7a0b\u4f1a\u540c\u65f6\u542f\u52a8\uff0c\u8f93\u51fa\u4e00\u65e6\u751f\u6210\u5c31\u4f1a\u88ab\u6d88\u8d39\u3002</li> <li>Mapper \u901a\u5e38\u662f\u591a\u4f59\u7684\uff1a\u5b83\u4eec\u4ec5\u4ec5\u662f\u8bfb\u53d6\u521a\u521a\u7531 Reducer \u5199\u5165\u7684\u540c\u6837\u6587\u4ef6\uff0c\u4e3a\u4e0b\u4e00\u4e2a\u9636\u6bb5\u7684\u5206\u533a\u548c\u6392\u5e8f\u505a\u51c6\u5907\u3002\u8bb8\u591a\u60c5\u51b5\u4e0b\uff0cMapper \u4ee3\u7801\u53ef\u80fd\u662f\u524d\u9a71 Reducer \u7684\u4e00\u90e8\u5206\u3002</li> <li>\u5c06\u4e2d\u95f4\u72b6\u6001\u5b58\u50a8\u5728\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u610f\u5473\u7740\u8fd9\u4e9b\u6587\u4ef6\u88ab\u590d\u5236\u5230\u591a\u4e2a\u8282\u70b9\uff0c\u5bf9\u8fd9\u4e9b\u4e34\u65f6\u6570\u636e\u8fd9\u4e48\u641e\u5c31\u6bd4\u8f83\u8fc7\u5206</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_22","title":"\u6570\u636e\u6d41\u5f15\u64ce","text":"<p>\u4e3a\u4e86\u89e3\u51b3 MapReduce \u7684\u8fd9\u4e9b\u95ee\u9898\uff0c\u51e0\u79cd\u7528\u4e8e\u5206\u5e03\u5f0f\u6279\u5904\u7406\u7684\u65b0\u6267\u884c\u5f15\u64ce\u88ab\u5f00\u53d1\u51fa\u6765\uff0c\u5176\u4e2d\u6700\u8457\u540d\u7684\u662f Spark \u301061,62\u3011\uff0cTez \u301063,64\u3011\u548c Flink \u301065,66\u3011\u3002</p> <ul> <li>\u628a\u6574\u4e2a\u5de5\u4f5c\u6d41\u4f5c\u4e3a\u5355\u4e2a\u4f5c\u4e1a\u6765\u5904\u7406\uff0c\u800c\u4e0d\u662f\u628a\u5b83\u5206\u89e3\u4e3a\u72ec\u7acb\u7684\u5b50\u4f5c\u4e1a\u3002</li> </ul> <p>\u7531\u4e8e\u5b83\u4eec\u5c06\u5de5\u4f5c\u6d41\u663e\u5f0f\u5efa\u6a21\u4e3a\u6570\u636e\u4ece\u51e0\u4e2a\u5904\u7406\u9636\u6bb5\u7a7f\u8fc7\uff0c\u6240\u4ee5\u8fd9\u4e9b\u7cfb\u7edf\u88ab\u79f0\u4e3a \u6570\u636e\u6d41\u5f15\u64ce\uff08dataflow engines\uff09\u3002</p> <ul> <li>\u901a\u8fc7\u8f93\u5165\u5206\u533a\u6765\u5e76\u884c\u5316\u8f7d\u8377\uff0c\u5b83\u4eec\u901a\u8fc7\u7f51\u7edc\u5c06\u4e00\u4e2a\u51fd\u6570\u7684\u8f93\u51fa\u590d\u5236\u5230\u53e6\u4e00\u4e2a\u51fd\u6570\u7684\u8f93\u5165\u3002</li> </ul> <p>\u6570\u636e\u6d41\u5f15\u64ce\u63d0\u4f9b\u4e86\u51e0\u79cd\u4e0d\u540c\u7684\u9009\u9879\u6765\u5c06\u4e00\u4e2a\u7b97\u5b50\u7684\u8f93\u51fa\u8fde\u63a5\u5230\u53e6\u4e00\u4e2a\u7b97\u5b50\u7684\u8f93\u5165\uff1a</p> <ul> <li>\u5bf9\u8bb0\u5f55\u6309\u952e\u91cd\u65b0\u5206\u533a\u5e76\u6392\u5e8f\uff0c\u5c31\u50cf\u5728 MapReduce \u7684\u6df7\u6d17\u9636\u6bb5\u4e00\u6837\uff1b</li> <li>\u63a5\u53d7\u591a\u4e2a\u8f93\u5165\uff0c\u5e76\u4ee5\u76f8\u540c\u7684\u65b9\u5f0f\u8fdb\u884c\u5206\u533a\uff0c\u4f46\u8df3\u8fc7\u6392\u5e8f\uff1b</li> <li>\u5bf9\u4e8e\u5e7f\u64ad\u6563\u5217\u8fde\u63a5\uff0c\u53ef\u4ee5\u5c06\u4e00\u4e2a\u7b97\u5b50\u7684\u8f93\u51fa\uff0c\u53d1\u9001\u5230\u8fde\u63a5\u7b97\u5b50\u7684\u6240\u6709\u5206\u533a\u3002</li> </ul> <p>\u4e0e MapReduce \u6a21\u578b\u76f8\u6bd4\uff0c\u5b83\u6709\u51e0\u4e2a\u4f18\u70b9\uff1a</p> <ul> <li>\u6392\u5e8f\u7b49\u6602\u8d35\u7684\u5de5\u4f5c\u53ea\u9700\u8981\u5728\u5b9e\u9645\u9700\u8981\u7684\u5730\u65b9\u6267\u884c\uff0c\u800c\u4e0d\u662f\u9ed8\u8ba4\u5730\u5728\u6bcf\u4e2a Map \u548c Reduce \u9636\u6bb5\u4e4b\u95f4\u51fa\u73b0\uff1b</li> <li>\u6ca1\u6709\u4e0d\u5fc5\u8981\u7684 Map \u4efb\u52a1\uff0c\u56e0\u4e3a Mapper \u6240\u505a\u7684\u5de5\u4f5c\u901a\u5e38\u53ef\u4ee5\u5408\u5e76\u5230\u524d\u9762\u7684 Reduce \u7b97\u5b50\u4e2d\uff1b</li> <li>\u5de5\u4f5c\u6d41\u4e2d\u7684\u6240\u6709\u8fde\u63a5\u548c\u6570\u636e\u4f9d\u8d56\u90fd\u662f\u663e\u5f0f\u58f0\u660e\u7684\uff0c\u56e0\u6b64\u8c03\u5ea6\u7a0b\u5e8f\u80fd\u591f\u603b\u89c8\u5168\u5c40\uff0c\u77e5\u9053\u54ea\u91cc\u9700\u8981\u54ea\u4e9b\u6570\u636e\uff0c\u56e0\u800c\u80fd\u591f\u5229\u7528\u5c40\u90e8\u6027\u8fdb\u884c\u4f18\u5316\uff1b</li> <li>\u901a\u5e38\uff0c\u7b97\u5b50\u95f4\u7684\u4e2d\u95f4\u72b6\u6001\u8db3\u4ee5\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d\u6216\u5199\u5165\u672c\u5730\u78c1\u76d8\uff0c\u8fd9\u6bd4\u5199\u5165 HDFS \u9700\u8981\u66f4\u5c11\u7684 I/O\uff1bMapReduce \u5df2\u7ecf\u5bf9 Mapper \u7684\u8f93\u51fa\u505a\u4e86\u8fd9\u79cd\u4f18\u5316\uff0c\u4f46\u6570\u636e\u6d41\u5f15\u64ce\u5c06\u8fd9\u79cd\u601d\u60f3\u63a8\u5e7f\u81f3\u6240\u6709\u7684\u4e2d\u95f4\u72b6\u6001\u3002</li> <li>\u7b97\u5b50\u53ef\u4ee5\u5728\u8f93\u5165\u5c31\u7eea\u540e\u7acb\u5373\u5f00\u59cb\u6267\u884c\uff1b\u540e\u7eed\u9636\u6bb5\u65e0\u9700\u7b49\u5f85\u524d\u9a71\u9636\u6bb5\u6574\u4e2a\u5b8c\u6210\u540e\u518d\u5f00\u59cb\u3002</li> <li>\u4e0e MapReduce\uff08\u4e3a\u6bcf\u4e2a\u4efb\u52a1\u542f\u52a8\u4e00\u4e2a\u65b0\u7684 JVM\uff09\u76f8\u6bd4\uff0c\u73b0\u6709 Java \u865a\u62df\u673a\uff08JVM\uff09\u8fdb\u7a0b\u53ef\u4ee5\u91cd\u7528\u6765\u8fd0\u884c\u65b0\u7b97\u5b50\uff0c\u4ece\u800c\u51cf\u5c11\u542f\u52a8\u5f00\u9500\u3002</li> </ul> <p>\u65e2\u7136\u7b97\u5b50\u662f Map \u548c Reduce \u7684\u6cdb\u5316\uff0c\u90a3\u4e48\u76f8\u540c\u7684\u5904\u7406\u4ee3\u7801\u5c31\u53ef\u4ee5\u5728\u4efb\u4e00\u6267\u884c\u5f15\u64ce\u4e0a\u8fd0\u884c\uff1aPig\uff0cHive \u6216 Cascading \u4e2d\u5b9e\u73b0\u7684\u5de5\u4f5c\u6d41\u53ef\u4ee5\u65e0\u9700\u4fee\u6539\u4ee3\u7801\uff0c\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u914d\u7f6e\uff0c\u7b80\u5355\u5730\u4ece MapReduce \u5207\u6362\u5230 Tez \u6216 Spark\u301064\u3011\u3002</p> <p>Tez \u662f\u4e00\u4e2a\u76f8\u5f53\u8584\u7684\u5e93\uff0c\u5b83\u4f9d\u8d56\u4e8e YARN shuffle \u670d\u52a1\u6765\u5b9e\u73b0\u8282\u70b9\u95f4\u6570\u636e\u7684\u5b9e\u9645\u590d\u5236\u301058\u3011\uff0c\u800c Spark \u548c Flink \u5219\u662f\u5305\u542b\u4e86\u72ec\u7acb\u7f51\u7edc\u901a\u4fe1\u5c42\uff0c\u8c03\u5ea6\u5668\uff0c\u53ca\u7528\u6237\u5411 API \u7684\u5927\u578b\u6846\u67b6\u3002\u6211\u4eec\u5c06\u7b80\u8981\u8ba8\u8bba\u8fd9\u4e9b\u9ad8\u7ea7 API\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_23","title":"\u5bb9\u9519","text":"<p>\u5b8c\u5168\u7269\u5316\u4e2d\u95f4\u72b6\u6001\u81f3\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u7684\u4e00\u4e2a\u4f18\u70b9\u662f\uff0c\u5b83\u5177\u6709\u6301\u4e45\u6027\uff0c\u5bb9\u9519\u76f8\u5f53\u5bb9\u6613\uff1a</p> <ul> <li>\u5982\u679c\u4e00\u4e2a\u4efb\u52a1\u5931\u8d25\uff0c\u5b83\u53ef\u4ee5\u5728\u53e6\u4e00\u53f0\u673a\u5668\u4e0a\u91cd\u65b0\u542f\u52a8\uff0c\u5e76\u4ece\u6587\u4ef6\u7cfb\u7edf\u91cd\u65b0\u8bfb\u53d6\u76f8\u540c\u7684\u8f93\u5165\u3002</li> </ul> <p>Spark\u3001Flink \u548c Tez \u907f\u514d\u5c06\u4e2d\u95f4\u72b6\u6001\u5199\u5165 HDFS\uff0c\u56e0\u6b64\u5b83\u4eec\u91c7\u53d6\u4e86\u4e0d\u540c\u7684\u65b9\u6cd5\u6765\u5bb9\u9519\uff1a</p> <ul> <li>\u5982\u679c\u4e00\u53f0\u673a\u5668\u53d1\u751f\u6545\u969c\uff0c\u5e76\u4e14\u8be5\u673a\u5668\u4e0a\u7684\u4e2d\u95f4\u72b6\u6001\u4e22\u5931\uff0c\u5219\u5b83\u4f1a\u4ece\u5176\u4ed6\u4ecd\u7136\u53ef\u7528\u7684\u6570\u636e\u91cd\u65b0\u8ba1\u7b97\uff08\u5728\u53ef\u884c\u7684\u60c5\u51b5\u4e0b\u662f\u5148\u524d\u7684\u4e2d\u95f4\u72b6\u6001\uff0c\u8981\u4e48\u5c31\u53ea\u80fd\u662f\u539f\u59cb\u8f93\u5165\u6570\u636e\uff0c\u901a\u5e38\u5728 HDFS \u4e0a\uff09\u3002</li> </ul> <p>\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u79cd\u91cd\u65b0\u8ba1\u7b97\uff0c\u6846\u67b6\u5fc5\u987b\u8ddf\u8e2a\u4e00\u4e2a\u7ed9\u5b9a\u7684\u6570\u636e\u662f\u5982\u4f55\u8ba1\u7b97\u7684 \u2014\u2014 \u4f7f\u7528\u4e86\u54ea\u4e9b\u8f93\u5165\u5206\u533a\uff1f\u5e94\u7528\u4e86\u54ea\u4e9b\u7b97\u5b50\uff1f</p> <ul> <li>Spark \u4f7f\u7528 \u5f39\u6027\u5206\u5e03\u5f0f\u6570\u636e\u96c6\uff08RDD\uff0cResilient Distributed Dataset\uff09 \u7684\u62bd\u8c61\u6765\u8ddf\u8e2a\u6570\u636e\u7684\u8c31\u7cfb\u301061\u3011</li> <li>Flink \u5bf9\u7b97\u5b50\u72b6\u6001\u5b58\u6863\uff0c\u5141\u8bb8\u6062\u590d\u8fd0\u884c\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u9047\u5230\u9519\u8bef\u7684\u7b97\u5b50\u301066\u3011\u3002</li> </ul> <p>\u5728\u91cd\u65b0\u8ba1\u7b97\u6570\u636e\u65f6\uff0c\u91cd\u8981\u7684\u662f\u8981\u77e5\u9053\u8ba1\u7b97\u662f\u5426\u662f \u786e\u5b9a\u6027\u7684\uff1a</p> <ul> <li>\u7ed9\u5b9a\u76f8\u540c\u7684\u8f93\u5165\u6570\u636e\uff0c\u7b97\u5b50\u662f\u5426\u59cb\u7ec8\u4ea7\u751f\u76f8\u540c\u7684\u8f93\u51fa\uff1f</li> <li>\u5bf9\u4e8e\u4e0d\u786e\u5b9a\u6027\u7b97\u5b50\u6765\u8bf4\uff0c\u89e3\u51b3\u65b9\u6848\u901a\u5e38\u662f\u6740\u6b7b\u4e0b\u6e38\u7b97\u5b50\uff0c\u7136\u540e\u518d\u91cd\u8dd1\u65b0\u6570\u636e\u3002</li> </ul> <p>\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u7ea7\u8054\u6545\u969c\uff0c\u6700\u597d\u8ba9\u7b97\u5b50\u5177\u6709\u786e\u5b9a\u6027\u3002\u975e\u786e\u5b9a\u6027\u884c\u4e3a\u5f88\u5bb9\u6613\u6084\u6084\u6e9c\u8fdb\u6765\uff1a</p> <ul> <li>\u8bb8\u591a\u7f16\u7a0b\u8bed\u8a00\u5728\u8fed\u4ee3\u54c8\u5e0c\u8868\u7684\u5143\u7d20\u65f6\u4e0d\u80fd\u5bf9\u987a\u5e8f\u4f5c\u51fa\u4fdd\u8bc1\uff0c\u5982 GO \u8bed\u8a00\uff1b</li> <li>\u8bb8\u591a\u6982\u7387\u548c\u7edf\u8ba1\u7b97\u6cd5\u663e\u5f0f\u4f9d\u8d56\u4e8e\u4f7f\u7528\u968f\u673a\u6570\uff1b</li> <li>\u7528\u5230\u7cfb\u7edf\u65f6\u949f\u6216\u5916\u90e8\u6570\u636e\u6e90\u7b49\u3002</li> </ul> <p>\u901a\u8fc7\u91cd\u7b97\u6570\u636e\u6765\u4ece\u6545\u969c\u4e2d\u6062\u590d\u5e76\u4e0d\u603b\u662f\u6b63\u786e\u7684\u7b54\u6848\uff1a\u5982\u679c\u4e2d\u95f4\u72b6\u6001\u6570\u636e\u8981\u6bd4\u6e90\u6570\u636e\u5c0f\u5f97\u591a\uff0c\u6216\u8005\u5982\u679c\u8ba1\u7b97\u91cf\u975e\u5e38\u5927\uff0c\u90a3\u4e48\u5c06\u4e2d\u95f4\u6570\u636e\u7269\u5316\u4e3a\u6587\u4ef6\u53ef\u80fd\u8981\u6bd4\u91cd\u65b0\u8ba1\u7b97\u5ec9\u4ef7\u7684\u591a\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_24","title":"\u5173\u4e8e\u7269\u5316\u7684\u8ba8\u8bba","text":"<p>MapReduce \u5c31\u50cf\u662f\u5c06\u6bcf\u4e2a\u547d\u4ee4\u7684\u8f93\u51fa\u5199\u5165\u4e34\u65f6\u6587\u4ef6\uff0c\u800c\u6570\u636e\u6d41\u5f15\u64ce\u770b\u8d77\u6765\u66f4\u50cf\u662f Unix \u7ba1\u9053\u3002</p> <ul> <li>Flink \u662f\u57fa\u4e8e\u7ba1\u9053\u6267\u884c\u7684\u601d\u60f3\u800c\u5efa\u7acb\u7684\uff1a\u4e5f\u5c31\u662f\u8bf4\uff0c\u5c06\u7b97\u5b50\u7684\u8f93\u51fa\u589e\u91cf\u5730\u4f20\u9012\u7ed9\u5176\u4ed6\u7b97\u5b50\uff0c\u4e0d\u5f85\u8f93\u5165\u5b8c\u6210\u4fbf\u5f00\u59cb\u5904\u7406\u3002</li> </ul> <p>\u6392\u5e8f\u7b97\u5b50\u4e0d\u53ef\u907f\u514d\u5730\u9700\u8981\u6d88\u8d39\u5168\u90e8\u7684\u8f93\u5165\u540e\u624d\u80fd\u751f\u6210\u4efb\u4f55\u8f93\u51fa\uff0c\u56e0\u4e3a\u8f93\u5165\u4e2d\u6700\u540e\u4e00\u6761\u8f93\u5165\u8bb0\u5f55\u53ef\u80fd\u5177\u6709\u6700\u5c0f\u7684\u952e\uff0c\u56e0\u6b64\u9700\u8981\u4f5c\u4e3a\u7b2c\u4e00\u6761\u8bb0\u5f55\u8f93\u51fa\u3002\u56e0\u6b64\uff0c\u4efb\u4f55\u9700\u8981\u6392\u5e8f\u7684\u7b97\u5b50\u90fd\u9700\u8981\u81f3\u5c11\u6682\u65f6\u5730\u7d2f\u79ef\u72b6\u6001\u3002\u4f46\u662f\u5de5\u4f5c\u6d41\u7684\u8bb8\u591a\u5176\u4ed6\u90e8\u5206\u53ef\u4ee5\u4ee5\u6d41\u6c34\u7ebf\u65b9\u5f0f\u6267\u884c\u3002</p> <p>\u5728\u4f7f\u7528\u6570\u636e\u6d41\u5f15\u64ce\u65f6\uff0cHDFS \u4e0a\u7684\u7269\u5316\u6570\u636e\u96c6\u901a\u5e38\u4ecd\u662f\u4f5c\u4e1a\u7684\u8f93\u5165\u548c\u6700\u7ec8\u8f93\u51fa\uff0c\u53ea\u662f\u4e0d\u7528\u518d\u81ea\u5df1\u53bb\u5c06\u4e2d\u95f4\u72b6\u6001\u5199\u5165\u6587\u4ef6\u7cfb\u7edf\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_25","title":"\u56fe\u4e0e\u8fed\u4ee3\u5904\u7406","text":"<p>\u6279\u5904\u7406\u4e0a\u4e0b\u6587\u4e2d\u7684\u56fe\u4e5f\u5f88\u6709\u8da3\uff0c\u5176\u76ee\u6807\u662f\u5728\u6574\u4e2a\u56fe\u4e0a\u6267\u884c\u67d0\u79cd\u79bb\u7ebf\u5904\u7406\u6216\u5206\u6790\u3002</p> <ul> <li>\u6700\u7740\u540d\u7684\u56fe\u5f62\u5206\u6790\u7b97\u6cd5\u4e4b\u4e00\u662f PageRank \u301069\u3011\uff1a\u8bd5\u56fe\u6839\u636e\u94fe\u63a5\u5230\u67d0\u4e2a\u7f51\u9875\u7684\u5176\u4ed6\u7f51\u9875\u6765\u4f30\u8ba1\u8be5\u7f51\u9875\u7684\u6d41\u884c\u5ea6\u3002</li> </ul> <p>\u8bb8\u591a\u56fe\u7b97\u6cd5\u662f\u901a\u8fc7\u4e00\u6b21\u904d\u5386\u4e00\u6761\u8fb9\u6765\u8868\u793a\u7684\uff0c\u5c06\u4e00\u4e2a\u9876\u70b9\u4e0e\u8fd1\u90bb\u7684\u9876\u70b9\u8fde\u63a5\u8d77\u6765\uff0c\u4ee5\u4f20\u64ad\u4e00\u4e9b\u4fe1\u606f\uff0c\u5e76\u4e0d\u65ad\u91cd\u590d\uff0c\u76f4\u5230\u6ee1\u8db3\u4e00\u4e9b\u6761\u4ef6\u4e3a\u6b62 \u3002</p> <p>\u53ef\u4ee5\u5728\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u5b58\u50a8\u56fe\uff08\u5305\u542b\u9876\u70b9\u548c\u8fb9\u7684\u5217\u8868\u7684\u6587\u4ef6\uff09\uff0c\u4f46\u662f\u8fd9\u79cd \u201c\u91cd\u590d\u81f3\u5b8c\u6210\u201d \u7684\u60f3\u6cd5\u4e0d\u80fd\u7528\u666e\u901a\u7684 MapReduce \u6765\u8868\u793a\uff0c\u56e0\u4e3a\u5b83\u53ea\u626b\u8fc7\u4e00\u8d9f\u6570\u636e\u3002\u8fd9\u79cd\u7b97\u6cd5\u56e0\u6b64\u7ecf\u5e38\u4ee5 \u8fed\u4ee3 \u7684\u98ce\u683c\u5b9e\u73b0\uff1a</p> <ul> <li>\u5916\u90e8\u8c03\u5ea6\u7a0b\u5e8f\u8fd0\u884c\u6279\u5904\u7406\u6765\u8ba1\u7b97\u7b97\u6cd5\u7684\u4e00\u4e2a\u6b65\u9aa4\u3002</li> <li>\u5f53\u6279\u5904\u7406\u8fc7\u7a0b\u5b8c\u6210\u65f6\uff0c\u8c03\u5ea6\u5668\u68c0\u67e5\u5b83\u662f\u5426\u5b8c\u6210\uff08\u57fa\u4e8e\u5b8c\u6210\u6761\u4ef6 \u2014\u2014 \u4f8b\u5982\uff0c\u6ca1\u6709\u66f4\u591a\u7684\u8fb9\u8981\u8ddf\u8fdb\uff0c\u6216\u8005\u4e0e\u4e0a\u6b21\u8fed\u4ee3\u76f8\u6bd4\u7684\u53d8\u5316\u4f4e\u4e8e\u67d0\u4e2a\u9608\u503c\uff09\u3002</li> <li>\u5982\u679c\u5c1a\u672a\u5b8c\u6210\uff0c\u5219\u8c03\u5ea6\u7a0b\u5e8f\u8fd4\u56de\u5230\u6b65\u9aa4 1 \u5e76\u8fd0\u884c\u53e6\u4e00\u8f6e\u6279\u5904\u7406\u3002</li> </ul> <p>MapReduce \u5b9e\u73b0\u5b83\u5f80\u5f80\u975e\u5e38\u4f4e\u6548\uff0c\u56e0\u4e3a MapReduce \u6ca1\u6709\u8003\u8651\u7b97\u6cd5\u7684\u8fed\u4ee3\u6027\u8d28\uff1a\u5b83\u603b\u662f\u8bfb\u53d6\u6574\u4e2a\u8f93\u5165\u6570\u636e\u96c6\u5e76\u4ea7\u751f\u4e00\u4e2a\u5168\u65b0\u7684\u8f93\u51fa\u6570\u636e\u96c6\uff0c\u5373\u4f7f\u4e0e\u4e0a\u6b21\u8fed\u4ee3\u76f8\u6bd4\uff0c\u6539\u53d8\u7684\u4ec5\u4ec5\u662f\u56fe\u4e2d\u7684\u4e00\u5c0f\u90e8\u5206\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#pregel","title":"Pregel\u5904\u7406\u6a21\u578b","text":"<p>\u9488\u5bf9\u56fe\u6279\u5904\u7406\u7684\u4f18\u5316 \u2014\u2014 \u6279\u91cf\u540c\u6b65\u5e76\u884c\uff08BSP\uff0cBulk Synchronous Parallel\uff09 \u8ba1\u7b97\u6a21\u578b\u301070\u3011\u5df2\u7ecf\u5f00\u59cb\u6d41\u884c\u8d77\u6765\u3002\u4e5f\u88ab\u79f0\u4e3a Pregel \u6a21\u578b\u301072\u3011</p> <ul> <li>Apache Giraph \u301037\u3011\uff0cSpark \u7684 GraphX API \u548c Flink \u7684 Gelly API \u301071\u3011\u5b9e\u73b0\u4e86\u5b83\uff1b</li> </ul> <p>Pregel \u80cc\u540e\u6709\u4e00\u4e2a\u7c7b\u4f3c\u7684\u60f3\u6cd5\uff1a\u4e00\u4e2a\u9876\u70b9\u53ef\u4ee5\u5411\u53e6\u4e00\u4e2a\u9876\u70b9 \u201c\u53d1\u9001\u6d88\u606f\u201d\uff0c\u901a\u5e38\u8fd9\u4e9b\u6d88\u606f\u662f\u6cbf\u7740\u56fe\u7684\u8fb9\u53d1\u9001\u7684\u3002</p> <ul> <li>\u5728\u6bcf\u6b21\u8fed\u4ee3\u4e2d\uff0c\u4e3a\u6bcf\u4e2a\u9876\u70b9\u8c03\u7528\u4e00\u4e2a\u51fd\u6570\uff0c\u5c06\u6240\u6709\u53d1\u9001\u7ed9\u5b83\u7684\u6d88\u606f\u4f20\u9012\u7ed9\u5b83</li> <li>\u5728 Pregel \u6a21\u578b\u4e2d\uff0c\u9876\u70b9\u5728\u4e00\u6b21\u8fed\u4ee3\u5230\u4e0b\u4e00\u6b21\u8fed\u4ee3\u7684\u8fc7\u7a0b\u4e2d\u4f1a\u8bb0\u4f4f\u5b83\u7684\u72b6\u6001\uff0c\u6240\u4ee5\u8fd9\u4e2a\u51fd\u6570\u53ea\u9700\u8981\u5904\u7406\u65b0\u7684\u4f20\u5165\u6d88\u606f\u3002</li> </ul> <p>\u8fd9\u4e0e Actor \u6a21\u578b\u6709\u4e9b\u76f8\u4f3c\uff08\u8bf7\u53c2\u9605 \u201c\u5206\u5e03\u5f0f\u7684 Actor \u6846\u67b6\u201d\uff09\uff0c\u9664\u4e86\u9876\u70b9\u72b6\u6001\u548c\u9876\u70b9\u4e4b\u95f4\u7684\u6d88\u606f\u5177\u6709\u5bb9\u9519\u6027\u548c\u6301\u4e45\u6027\uff0c\u4e14\u901a\u4fe1\u4ee5\u56fa\u5b9a\u7684\u56de\u5408\u8fdb\u884c\uff1a\u5728\u6bcf\u6b21\u8fed\u4ee3\u4e2d\uff0c\u6846\u67b6\u9012\u9001\u4e0a\u6b21\u8fed\u4ee3\u4e2d\u53d1\u9001\u7684\u6240\u6709\u6d88\u606f\u3002Actor \u901a\u5e38\u6ca1\u6709\u8fd9\u6837\u7684\u65f6\u5e8f\u4fdd\u8bc1\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_26","title":"\u5bb9\u9519","text":"<p>\u9876\u70b9\u53ea\u80fd\u901a\u8fc7\u6d88\u606f\u4f20\u9012\u8fdb\u884c\u901a\u4fe1\uff08\u800c\u4e0d\u662f\u76f4\u63a5\u76f8\u4e92\u67e5\u8be2\uff09\u7684\u4e8b\u5b9e\u6709\u52a9\u4e8e\u63d0\u9ad8 Pregel \u4f5c\u4e1a\u7684\u6027\u80fd\uff0c\u56e0\u4e3a\u6d88\u606f\u53ef\u4ee5\u6210\u6279\u5904\u7406\uff0c\u4e14\u7b49\u5f85\u901a\u4fe1\u7684\u6b21\u6570\u4e5f\u51cf\u5c11\u4e86\u3002</p> <ul> <li>\u552f\u4e00\u7684\u7b49\u5f85\u662f\u5728\u8fed\u4ee3\u4e4b\u95f4\uff1a\u5728\u4e0b\u4e00\u8f6e\u8fed\u4ee3\u5f00\u59cb\u524d\uff0c\u5148\u524d\u7684\u8fed\u4ee3\u5fc5\u987b\u5b8c\u5168\u5b8c\u6210\uff0c\u800c\u6240\u6709\u7684\u6d88\u606f\u5fc5\u987b\u5728\u7f51\u7edc\u4e0a\u5b8c\u6210\u590d\u5236\u3002</li> </ul> <p>\u5373\u4f7f\u5e95\u5c42\u7f51\u7edc\u53ef\u80fd\u4e22\u5931\u3001\u91cd\u590d\u6216\u4efb\u610f\u5ef6\u8fdf\u6d88\u606f\uff0cPregel \u7684\u5b9e\u73b0\u80fd\u4fdd\u8bc1\u5728\u540e\u7eed\u8fed\u4ee3\u4e2d\u6d88\u606f\u5728\u5176\u76ee\u6807\u9876\u70b9\u6070\u597d\u5904\u7406\u4e00\u6b21\u3002</p> <ul> <li>\u5bb9\u9519\u662f\u901a\u8fc7\u5728\u8fed\u4ee3\u7ed3\u675f\u65f6\uff0c\u5b9a\u671f\u5b58\u6863\u6240\u6709\u9876\u70b9\u7684\u72b6\u6001\u6765\u5b9e\u73b0\u7684\uff0c\u5373\u5c06\u5176\u5168\u90e8\u72b6\u6001\u5199\u5165\u6301\u4e45\u5316\u5b58\u50a8\u3002</li> <li>\u5982\u679c\u67d0\u4e2a\u8282\u70b9\u53d1\u751f\u6545\u969c\u5e76\u4e14\u5176\u5185\u5b58\u4e2d\u7684\u72b6\u6001\u4e22\u5931\uff0c\u5219\u6700\u7b80\u5355\u7684\u89e3\u51b3\u65b9\u6cd5\u662f\u5c06\u6574\u4e2a\u56fe\u8ba1\u7b97\u56de\u6eda\u5230\u4e0a\u4e00\u4e2a\u5b58\u6863\u70b9\uff0c\u7136\u540e\u91cd\u542f\u8ba1\u7b97\u3002</li> <li>\u5982\u679c\u7b97\u6cd5\u662f\u786e\u5b9a\u6027\u7684\uff0c\u4e14\u6d88\u606f\u8bb0\u5f55\u5728\u65e5\u5fd7\u4e2d\uff0c\u90a3\u4e48\u4e5f\u53ef\u4ee5\u9009\u62e9\u6027\u5730\u53ea\u6062\u590d\u4e22\u5931\u7684\u5206\u533a\u301072\u3011\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_27","title":"\u5e76\u884c\u6267\u884c","text":"<p>\u56fe\u7684\u5206\u533a\u53d6\u51b3\u4e8e\u6846\u67b6 \u2014\u2014 \u5373\uff0c\u786e\u5b9a\u54ea\u4e2a\u9876\u70b9\u8fd0\u884c\u5728\u54ea\u53f0\u673a\u5668\u4e0a\uff0c\u4ee5\u53ca\u5982\u4f55\u901a\u8fc7\u7f51\u7edc\u8def\u7531\u6d88\u606f\uff0c\u4ee5\u4fbf\u5b83\u4eec\u5230\u8fbe\u6b63\u786e\u7684\u5730\u65b9\u3002</p> <p>\u7531\u4e8e\u7f16\u7a0b\u6a21\u578b\u4e00\u6b21\u4ec5\u5904\u7406\u4e00\u4e2a\u9876\u70b9\uff0c\u6240\u4ee5\u6846\u67b6\u53ef\u4ee5\u4ee5\u4efb\u610f\u65b9\u5f0f\u5bf9\u56fe\u5206\u533a\u3002</p> <ul> <li>\u7406\u60f3\u60c5\u51b5\u4e0b\u5982\u679c\u9876\u70b9\u9700\u8981\u8fdb\u884c\u5927\u91cf\u7684\u901a\u4fe1\uff0c\u90a3\u4e48\u5b83\u4eec\u6700\u597d\u80fd\u88ab\u5206\u533a\u5230\u540c\u4e00\u53f0\u673a\u5668\u4e0a\u3002</li> <li>\u5728\u5b9e\u8df5\u4e2d\uff0c\u56fe\u7ecf\u5e38\u6309\u7167\u4efb\u610f\u5206\u914d\u7684\u9876\u70b9 ID \u5206\u533a\uff0c\u800c\u4e0d\u4f1a\u5c1d\u8bd5\u5c06\u76f8\u5173\u7684\u9876\u70b9\u5206\u7ec4\u5728\u4e00\u8d77\u3002</li> </ul> <p>\u56fe\u7b97\u6cd5\u901a\u5e38\u4f1a\u6709\u5f88\u591a\u8de8\u673a\u5668\u901a\u4fe1\u7684\u989d\u5916\u5f00\u9500\uff0c\u800c\u4e2d\u95f4\u72b6\u6001\uff08\u8282\u70b9\u4e4b\u95f4\u53d1\u9001\u7684\u6d88\u606f\uff09\u5f80\u5f80\u6bd4\u539f\u59cb\u56fe\u5927\u3002\u901a\u8fc7\u7f51\u7edc\u53d1\u9001\u6d88\u606f\u7684\u5f00\u9500\u4f1a\u663e\u8457\u62d6\u6162\u5206\u5e03\u5f0f\u56fe\u7b97\u6cd5\u7684\u901f\u5ea6\u3002</p> <p>\u5982\u679c\u4f60\u7684\u56fe\u53ef\u4ee5\u653e\u5165\u4e00\u53f0\u8ba1\u7b97\u673a\u7684\u5185\u5b58\u4e2d\uff0c\u90a3\u4e48\u5355\u673a\uff08\u751a\u81f3\u53ef\u80fd\u662f\u5355\u7ebf\u7a0b\uff09\u7b97\u6cd5\u5f88\u53ef\u80fd\u4f1a\u8d85\u8d8a\u5206\u5e03\u5f0f\u6279\u5904\u7406\u301073,74\u3011\u3002\u53ea\u8981\u80fd\u653e\u5165\u5355\u53f0\u8ba1\u7b97\u673a\u7684\u78c1\u76d8\uff0c\u4f7f\u7528 GraphChi \u7b49\u6846\u67b6\u8fdb\u884c\u5355\u673a\u5904\u7406\u662f\u5c31\u4e00\u4e2a\u53ef\u884c\u7684\u9009\u62e9\u301075\u3011\u3002\u9ad8\u6548\u7684\u5e76\u884c\u56fe\u7b97\u6cd5\u662f\u4e00\u4e2a\u8fdb\u884c\u4e2d\u7684\u7814\u7a76\u9886\u57df\u301076\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#api","title":"\u9ad8\u7ea7API\u548c\u8bed\u8a00","text":"<p>\u57fa\u7840\u8bbe\u65bd\u5df2\u7ecf\u8db3\u591f\u5f3a\u5927\uff0c\u80fd\u591f\u5b58\u50a8\u548c\u5904\u7406\u8d85\u8fc7 10,000 \u53f0\u673a\u5668\u96c6\u7fa4\u4e0a\u7684\u6570 PB \u7684\u6570\u636e\u3002\u5173\u6ce8\u70b9\u5df2\u7ecf\u8f6c\u5411\u5176\u4ed6\u9886\u57df\uff1a\u6539\u8fdb\u7f16\u7a0b\u6a21\u578b\uff0c\u63d0\u9ad8\u5904\u7406\u6548\u7387\uff0c\u6269\u5927\u8fd9\u4e9b\u6280\u672f\u53ef\u4ee5\u89e3\u51b3\u7684\u95ee\u9898\u96c6\u3002</p> <p>\u9ad8\u7ea7\u8bed\u8a00\u8fd8\u6709\u4e00\u4e2a\u989d\u5916\u597d\u5904\uff0c\u53ef\u4ee5\u8fc1\u79fb\u5230\u65b0\u7684\u6570\u636e\u6d41\u6267\u884c\u5f15\u64ce\uff0c\u800c\u65e0\u9700\u91cd\u5199\u4f5c\u4e1a\u4ee3\u7801\u3002Spark \u548c Flink \u4e5f\u6709\u5b83\u4eec\u81ea\u5df1\u7684\u9ad8\u7ea7\u6570\u636e\u6d41 API\uff0c\u901a\u5e38\u662f\u4ece FlumeJava \u4e2d\u83b7\u53d6\u7684\u7075\u611f\u301034\u3011\u3002</p> <ul> <li>\u8fd8\u652f\u6301\u4ea4\u4e92\u5f0f\u7528\u6cd5\uff0c\u5728\u63a2\u7d22\u6570\u636e\u96c6\u548c\u8bd5\u9a8c\u5904\u7406\u65b9\u6cd5\u65f6\u975e\u5e38\u6709\u7528\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_28","title":"\u5411\u58f0\u660e\u5f0f\u67e5\u8be2\u8bed\u8a00\u7684\u8f6c\u53d8","text":"<p>\u6307\u5b9a\u8fde\u63a5\u5173\u7cfb\u7b97\u5b50\u7684\u4f18\u70b9\u662f\uff0c\u6846\u67b6\u53ef\u4ee5\u5206\u6790\u8fde\u63a5\u8f93\u5165\u7684\u5c5e\u6027\uff0c\u5e76\u81ea\u52a8\u51b3\u5b9a\u54ea\u79cd\u4e0a\u8ff0\u8fde\u63a5\u7b97\u6cd5\u6700\u9002\u5408\u5f53\u524d\u4efb\u52a1\u3002</p> <ul> <li>Hive\u3001Spark \u548c Flink \u90fd\u6709\u57fa\u4e8e\u4ee3\u4ef7\u7684\u67e5\u8be2\u4f18\u5316\u5668\u53ef\u4ee5\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u751a\u81f3\u53ef\u4ee5\u6539\u53d8\u8fde\u63a5\u987a\u5e8f\uff0c\u6700\u5c0f\u5316\u4e2d\u95f4\u72b6\u6001\u7684\u6570\u91cf\u301066,77,78,79\u3011\u3002</li> </ul> <p>\u81ea\u7531\u8fd0\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u957f\u671f\u4ee5\u6765\u90fd\u662f\u4f20\u7edf MapReduce \u6279\u5904\u7406\u7cfb\u7edf\u4e0e MPP \u6570\u636e\u5e93\u7684\u533a\u522b\u6240\u5728\uff1a</p> <ul> <li>\u5bf9\u4e8e\u6bcf\u6761\u8bb0\u5f55\u6216\u8005\u4e00\u7ec4\u8bb0\u5f55\uff0c\u8c03\u7528\u4e00\u4e2a\u7528\u6237\u5b9a\u4e49\u7684\u51fd\u6570\uff0c\u5229\u7528\u5927\u91cf\u5df2\u6709\u5e93\u7684\u751f\u6001\u7cfb\u7edf\u521b\u4f5c\uff1b</li> <li>\u6570\u636e\u5e93\u5177\u6709\u7f16\u5199\u7528\u6237\u5b9a\u4e49\u51fd\u6570\u7684\u529f\u80fd\uff0c\u4f46\u662f\u5b83\u4eec\u901a\u5e38\u4f7f\u7528\u8d77\u6765\u5f88\u9ebb\u70e6\u3002</li> </ul> <p>\u6570\u636e\u6d41\u5f15\u64ce\u652f\u6301\u9664\u8fde\u63a5\u4e4b\u5916\u7684\u66f4\u591a \u58f0\u660e\u5f0f\u7279\u6027 \u8fd8\u6709\u5176\u4ed6\u7684\u4f18\u52bf\uff1a</p> <ul> <li>\u8c13\u8bcd\u8fc7\u6ee4\u548c\u4e0b\u63a8\uff1a\u67e5\u8be2\u4f18\u5316\u5668\u53ef\u4ee5\u5229\u7528\u5217\u5f0f\u5b58\u50a8\u5e03\u5c40\uff0c\u53ea\u4ece\u78c1\u76d8\u8bfb\u53d6\u6240\u9700\u7684\u5217\u3002</li> <li>Hive\u3001Spark DataFrames\u301079\u3011 \u548c Impala\u301041\u3011 \u8fd8\u4f7f\u7528\u4e86\u5411\u91cf\u5316\u6267\u884c\uff0c\u5728\u5bf9 CPU \u7f13\u5b58\u53cb\u597d\u7684\u5185\u90e8\u5faa\u73af\u4e2d\u8fed\u4ee3\u6570\u636e\uff0c\u907f\u514d\u51fd\u6570\u8c03\u7528\u3002</li> </ul> <p>\u901a\u8fc7\u5728\u9ad8\u7ea7 API \u4e2d\u5f15\u5165\u58f0\u660e\u5f0f\u7684\u90e8\u5206\uff0c\u5e76\u4f7f\u67e5\u8be2\u4f18\u5316\u5668\u53ef\u4ee5\u5728\u6267\u884c\u671f\u95f4\u5229\u7528\u8fd9\u4e9b\u6765\u505a\u4f18\u5316\uff0c\u6279\u5904\u7406\u6846\u67b6\u770b\u8d77\u6765\u8d8a\u6765\u8d8a\u50cf MPP \u6570\u636e\u5e93\u4e86\uff08\u5e76\u4e14\u80fd\u5b9e\u73b0\u53ef\u4e0e\u4e4b\u5ab2\u7f8e\u7684\u6027\u80fd\uff09\u3002\u540c\u65f6\uff0c\u901a\u8fc7\u62e5\u6709\u8fd0\u884c\u4efb\u610f\u4ee3\u7801\u548c\u4ee5\u4efb\u610f\u683c\u5f0f\u8bfb\u53d6\u6570\u636e\u7684\u53ef\u6269\u5c55\u6027\uff0c\u5b83\u4eec\u4fdd\u6301\u4e86\u7075\u6d3b\u6027\u7684\u4f18\u52bf\u3002</p>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_29","title":"\u4e13\u4e1a\u5316\u7684\u4e0d\u540c\u9886\u57df","text":"<p>\u6709\u5f88\u591a\u5e38\u89c1\u7684\u4f8b\u5b50\uff0c\u4e0d\u65ad\u91cd\u590d\u7740\u6807\u51c6\u7684\u5904\u7406\u6a21\u5f0f\u3002\u56e0\u800c\u8fd9\u4e9b\u6a21\u5f0f\u503c\u5f97\u62e5\u6709\u81ea\u5df1\u7684\u53ef\u91cd\u7528\u901a\u7528\u6784\u5efa\u6a21\u5757\u5b9e\u73b0\u3002</p> <ul> <li>MPP \u6570\u636e\u5e93\u6ee1\u8db3\u4e86\u5546\u4e1a\u667a\u80fd\u5206\u6790\u548c\u4e1a\u52a1\u62a5\u8868\u7684\u9700\u6c42\uff1b</li> <li>\u7edf\u8ba1\u548c\u6570\u503c\u7b97\u6cd5\uff0c\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\uff1aMahout\uff0cSpark MLlib, Flink \u7684 Alink \u7b49\uff0cApache HAWQ\u7684 MADlib\u301054\u3011\u3002</li> <li>\u7a7a\u95f4\u7b97\u6cd5\uff0c\u5982  k \u8fd1\u90bb\u641c\u7d22\uff08k-nearest neighbors, kNN\uff09\u301080\u3011\uff0c\u8fd1\u4f3c\u641c\u7d22\u301081\u3011\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/10_batch_processing.html#_30","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>Jeffrey Dean and Sanjay Ghemawat: \u201cMapReduce: Simplified Data Processing on Large Clusters,\u201d at 6th USENIX Symposium on Operating System Design and Implementation (OSDI), December 2004.</li> <li>Joel Spolsky: \u201cThe Perils of JavaSchools,\u201d joelonsoftware.com, December 25, 2005.</li> <li>Shivnath Babu and Herodotos Herodotou: \u201cMassively Parallel Databases and MapReduce Systems,\u201d Foundations and Trends in Databases, volume 5, number 1, pages 1\u2013104, November 2013. doi:10.1561/1900000036</li> <li>David J. DeWitt and Michael Stonebraker: \u201cMapReduce: A Major Step Backwards,\u201d originally published at databasecolumn.vertica.com, January 17, 2008.</li> <li>Henry Robinson: \u201cThe Elephant Was a Trojan Horse: On the Death of Map-Reduce at Google,\u201d the-paper-trail.org, June 25, 2014.</li> <li>\u201cThe Hollerith Machine,\u201d United States Census Bureau, census.gov.</li> <li>\u201cIBM 82, 83, and 84 Sorters Reference Manual,\u201d Edition A24-1034-1, International Business Machines Corporation, July 1962.</li> <li>Adam Drake: \u201cCommand-Line Tools Can Be 235x Faster than Your Hadoop Cluster,\u201d aadrake.com, January 25, 2014.</li> <li>\u201cGNU Coreutils 8.23 Documentation,\u201d Free Software Foundation, Inc., 2014.</li> <li>Martin Kleppmann: \u201cKafka, Samza, and the Unix Philosophy of Distributed Data,\u201d martin.kleppmann.com, August 5, 2015.</li> <li>Doug McIlroy:Internal Bell Labs memo, October 1964. Cited in: Dennis M. Richie: \u201cAdvice from Doug McIlroy,\u201d cm.bell-labs.com.</li> <li>M. D. McIlroy, E. N. Pinson, and B. A. Tague: \u201cUNIX Time-Sharing System: Foreword,\u201d The Bell System Technical Journal, volume 57, number 6, pages 1899\u20131904, July 1978.</li> <li>Eric S. Raymond: The Art of UNIX Programming. Addison-Wesley, 2003. ISBN: 978-0-13-142901-7</li> <li>Ronald Duncan: \u201cText File Formats \u2013 ASCII Delimited Text \u2013 Not CSV or TAB Delimited Text,\u201d ronaldduncan.wordpress.com, October 31, 2009.</li> <li>Alan Kay: \u201cIs 'Software Engineering' an Oxymoron?,\u201d tinlizzie.org.</li> <li>Martin Fowler: \u201cInversionOfControl,\u201d martinfowler.com, June 26, 2005.</li> <li>Daniel J. Bernstein: \u201cTwo File Descriptors for Sockets,\u201d cr.yp.to.</li> <li>Rob Pike and Dennis M. Ritchie: \u201cThe Styx Architecture for Distributed Systems,\u201d Bell Labs Technical Journal, volume 4, number 2, pages 146\u2013152, April 1999.</li> <li>Sanjay Ghemawat, Howard Gobioff, and Shun-Tak Leung: \u201cThe Google File System,\u201d at 19th ACM Symposium on Operating Systems Principles (SOSP), October 2003. doi:10.1145/945445.945450</li> <li>Michael Ovsiannikov, Silvius Rus, Damian Reeves, et al.: \u201cThe Quantcast File System,\u201d Proceedings of the VLDB Endowment, volume 6, number 11, pages 1092\u20131101, August 2013. doi:10.14778/2536222.2536234</li> <li>\u201cOpenStack Swift 2.6.1 Developer Documentation,\u201d OpenStack Foundation, docs.openstack.org, March 2016.</li> <li>Zhe Zhang, Andrew Wang, Kai Zheng, et al.: \u201cIntroduction to HDFS Erasure Coding in Apache Hadoop,\u201d blog.cloudera.com, September 23, 2015.</li> <li>Peter Cnudde: \u201cHadoop Turns 10,\u201d yahoohadoop.tumblr.com, February 5, 2016.</li> <li>Eric Baldeschwieler: \u201cThinking About the HDFS vs. Other Storage Technologies,\u201d hortonworks.com, July 25, 2012.</li> <li>Brendan Gregg: \u201cManta: Unix Meets Map Reduce,\u201d dtrace.org, June 25, 2013.</li> <li>Tom White: Hadoop: The Definitive Guide, 4th edition. O'Reilly Media, 2015. ISBN: 978-1-491-90163-2</li> <li>Jim N. Gray: \u201cDistributed Computing Economics,\u201d Microsoft Research Tech Report MSR-TR-2003-24, March 2003.</li> <li>M\u00e1rton Trencs\u00e9ni: \u201cLuigi vs Airflow vs Pinball,\u201d bytepawn.com, February 6, 2016.</li> <li>Roshan Sumbaly, Jay Kreps, and Sam Shah: \u201cThe 'Big Data' Ecosystem at LinkedIn,\u201d at ACM International Conference on Management of Data (SIGMOD), July 2013. doi:10.1145/2463676.2463707</li> <li>Alan F. Gates, Olga Natkovich, Shubham Chopra, et al.: \u201cBuilding a High-Level Dataflow System on Top of Map-Reduce: The Pig Experience,\u201d at 35th International Conference on Very Large Data Bases (VLDB), August 2009.</li> <li>Ashish Thusoo, Joydeep Sen Sarma, Namit Jain, et al.: \u201cHive \u2013 A Petabyte Scale Data Warehouse Using Hadoop,\u201d at 26th IEEE International Conference on Data Engineering (ICDE), March 2010. doi:10.1109/ICDE.2010.5447738</li> <li>\u201cCascading 3.0 User Guide,\u201d Concurrent, Inc., docs.cascading.org, January 2016.</li> <li>\u201cApache Crunch User Guide,\u201d Apache Software Foundation, crunch.apache.org.</li> <li>Craig Chambers, Ashish Raniwala, Frances Perry, et al.: \u201cFlumeJava: Easy, Efficient Data-Parallel Pipelines,\u201d at 31st ACM SIGPLAN Conference on Programming Language Design and Implementation (PLDI), June 2010. doi:10.1145/1806596.1806638</li> <li>Jay Kreps: \u201cWhy Local State is a Fundamental Primitive in Stream Processing,\u201d oreilly.com, July 31, 2014.</li> <li>Martin Kleppmann: \u201cRethinking Caching in Web Apps,\u201d martin.kleppmann.com, October 1, 2012.</li> <li>Mark Grover, Ted Malaska, Jonathan Seidman, and Gwen Shapira: Hadoop Application Architectures. O'Reilly Media, 2015. ISBN: 978-1-491-90004-8</li> <li>Philippe Ajoux, Nathan Bronson, Sanjeev Kumar, et al.: \u201cChallenges to Adopting Stronger Consistency at Scale,\u201d at 15th USENIX Workshop on Hot Topics in Operating Systems (HotOS), May 2015.</li> <li>Sriranjan Manjunath: \u201cSkewed Join,\u201d wiki.apache.org, 2009.</li> <li>David J. DeWitt, Jeffrey F. Naughton, Donovan A.Schneider, and S. Seshadri: \u201cPractical Skew Handling in Parallel Joins,\u201d at 18th International Conference on Very Large Data Bases (VLDB), August 1992.</li> <li>Marcel Kornacker, Alexander Behm, Victor Bittorf, et al.: \u201cImpala: A Modern, Open-Source SQL Engine for Hadoop,\u201d at 7th Biennial Conference on Innovative Data Systems Research (CIDR), January 2015.</li> <li>Matthieu Monsch: \u201cOpen-Sourcing PalDB, a Lightweight Companion for Storing Side Data,\u201d engineering.linkedin.com, October 26, 2015.</li> <li>Daniel Peng and Frank Dabek: \u201cLarge-Scale Incremental Processing Using Distributed Transactions and Notifications,\u201d at 9th USENIX conference on Operating Systems Design and Implementation (OSDI), October 2010.</li> <li>\u201c\"Cloudera Search User Guide,\" Cloudera, Inc., September 2015.</li> <li>Lili Wu, Sam Shah, Sean Choi, et al.: \u201cThe Browsemaps: Collaborative Filtering at LinkedIn,\u201d at 6th Workshop on Recommender Systems and the Social Web (RSWeb), October 2014.</li> <li>Roshan Sumbaly, Jay Kreps, Lei Gao, et al.: \u201cServing Large-Scale Batch Computed Data with Project Voldemort,\u201d at 10th USENIX Conference on File and Storage Technologies (FAST), February 2012.</li> <li>Varun Sharma: \u201cOpen-Sourcing Terrapin: A Serving System for Batch Generated Data,\u201d engineering.pinterest.com, September 14, 2015.</li> <li>Nathan Marz: \u201cElephantDB,\u201d slideshare.net, May 30, 2011.</li> <li>Jean-Daniel (JD) Cryans: \u201cHow-to: Use HBase Bulk Loading, and Why,\u201d blog.cloudera.com, September 27, 2013.</li> <li>Nathan Marz: \u201cHow to Beat the CAP Theorem,\u201d nathanmarz.com, October 13, 2011.</li> <li>Molly Bartlett Dishman and Martin Fowler: \u201cAgile Architecture,\u201d at O'Reilly Software Architecture Conference, March 2015.</li> <li>David J. DeWitt and Jim N. Gray: \u201cParallel Database Systems: The Future of High Performance Database Systems,\u201d Communications of the ACM, volume 35, number 6, pages 85\u201398, June 1992. doi:10.1145/129888.129894</li> <li>Jay Kreps: \u201cBut the multi-tenancy thing is actually really really hard,\u201d tweetstorm, twitter.com, October 31, 2014.</li> <li>Jeffrey Cohen, Brian Dolan, Mark Dunlap, et al.: \u201cMAD Skills: New Analysis Practices for Big Data,\u201d Proceedings of the VLDB Endowment, volume 2, number 2, pages 1481\u20131492, August 2009. doi:10.14778/1687553.1687576</li> <li>Ignacio Terrizzano, Peter Schwarz, Mary Roth, and John E. Colino: \u201cData Wrangling: The Challenging Journey from the Wild to the Lake,\u201d at 7th Biennial Conference on Innovative Data Systems Research (CIDR), January 2015.</li> <li>Paige Roberts: \u201cTo Schema on Read or to Schema on Write, That Is the Hadoop Data Lake Question,\u201d adaptivesystemsinc.com, July 2, 2015.</li> <li>Bobby Johnson and Joseph Adler: \u201cThe Sushi Principle: Raw Data Is Better,\u201d at Strata+Hadoop World, February 2015.</li> <li>Vinod Kumar Vavilapalli, Arun C. Murthy, Chris Douglas, et al.: \u201cApache Hadoop YARN: Yet Another Resource Negotiator,\u201d at 4th ACM Symposium on Cloud Computing (SoCC), October 2013. doi:10.1145/2523616.2523633</li> <li>Abhishek Verma, Luis Pedrosa, Madhukar Korupolu, et al.: \u201cLarge-Scale Cluster Management at Google with Borg,\u201d at 10th European Conference on Computer Systems (EuroSys), April 2015. doi:10.1145/2741948.2741964</li> <li>Malte Schwarzkopf: \u201cThe Evolution of Cluster Scheduler Architectures,\u201d firmament.io, March 9, 2016.</li> <li>Matei Zaharia, Mosharaf Chowdhury, Tathagata Das, et al.: \u201cResilient Distributed Datasets: A Fault-Tolerant Abstraction for In-Memory Cluster Computing,\u201d at 9th USENIX Symposium on Networked Systems Design and Implementation (NSDI), April 2012.</li> <li>Holden Karau, Andy Konwinski, Patrick Wendell, and Matei Zaharia: Learning Spark. O'Reilly Media, 2015. ISBN: 978-1-449-35904-1</li> <li>Bikas Saha and Hitesh Shah: \u201cApache Tez: Accelerating Hadoop Query Processing,\u201d at Hadoop Summit, June 2014.</li> <li>Bikas Saha, Hitesh Shah, Siddharth Seth, et al.: \u201cApache Tez: A Unifying Framework for Modeling and Building Data Processing Applications,\u201d at ACM International Conference on Management of Data (SIGMOD), June 2015. doi:10.1145/2723372.2742790</li> <li>Kostas Tzoumas: \u201cApache Flink: API, Runtime, and Project Roadmap,\u201d slideshare.net, January 14, 2015.</li> <li>Alexander Alexandrov, Rico Bergmann, Stephan Ewen, et al.: \u201cThe Stratosphere Platform for Big Data Analytics,\u201d The VLDB Journal, volume 23, number 6, pages 939\u2013964, May 2014. doi:10.1007/s00778-014-0357-y</li> <li>Michael Isard, Mihai Budiu, Yuan Yu, et al.: \u201cDryad: Distributed Data-Parallel Programs from Sequential Building Blocks,\u201d at European Conference on Computer Systems (EuroSys), March 2007. doi:10.1145/1272996.1273005</li> <li>Daniel Warneke and Odej Kao: \u201cNephele: Efficient Parallel Data Processing in the Cloud,\u201d at 2nd Workshop on Many-Task Computing on Grids and Supercomputers (MTAGS), November 2009. doi:10.1145/1646468.1646476</li> <li>Lawrence Page, Sergey Brin, Rajeev Motwani, and Terry Winograd: \"The PageRank\"</li> <li>Leslie G. Valiant: \u201cA Bridging Model for Parallel Computation,\u201d Communications of the ACM, volume 33, number 8, pages 103\u2013111, August 1990. doi:10.1145/79173.79181</li> <li>Stephan Ewen, Kostas Tzoumas, Moritz Kaufmann, and Volker Markl: \u201cSpinning Fast Iterative Data Flows,\u201d Proceedings of the VLDB Endowment, volume 5, number 11, pages 1268-1279, July 2012. doi:10.14778/2350229.2350245</li> <li>Grzegorz Malewicz, Matthew H.Austern, Aart J. C. Bik, et al.: \u201cPregel: A System for Large-Scale Graph Processing,\u201d at ACM International Conference on Management of Data (SIGMOD), June 2010. doi:10.1145/1807167.1807184</li> <li>Frank McSherry, Michael Isard, and Derek G. Murray: \u201cScalability! But at What COST?,\u201d at 15th USENIX Workshop on Hot Topics in Operating Systems (HotOS), May 2015.</li> <li>Ionel Gog, Malte Schwarzkopf, Natacha Crooks, et al.: \u201cMusketeer: All for One, One for All in Data Processing Systems,\u201d at 10th European Conference on Computer Systems (EuroSys), April 2015. doi:10.1145/2741948.2741968</li> <li>Aapo Kyrola, Guy Blelloch, and Carlos Guestrin: \u201cGraphChi: Large-Scale Graph Computation on Just a PC,\u201d at 10th USENIX Symposium on Operating Systems Design and Implementation (OSDI), October 2012.</li> <li>Andrew Lenharth, Donald Nguyen, and Keshav Pingali: \u201cParallel Graph Analytics,\u201d Communications of the ACM, volume 59, number 5, pages 78\u201387, May doi:10.1145/2901919</li> <li>Fabian H\u00fcske: \u201cPeeking into Apache Flink's Engine Room,\u201d flink.apache.org, March 13, 2015.</li> <li>Mostafa Mokhtar: \u201cHive 0.14 Cost Based Optimizer (CBO) Technical Overview,\u201d hortonworks.com, March 2, 2015.</li> <li>Michael Armbrust, Reynold S Xin, Cheng Lian, et al.: \u201cSpark SQL: Relational Data Processing in Spark,\u201d at ACM International Conference on Management of Data (SIGMOD), June 2015. doi:10.1145/2723372.2742797</li> <li>Daniel Blazevski: \u201cPlanting Quadtrees for Apache Flink,\u201d insightdataengineering.com, March 25, 2016.</li> <li>Tom White: \u201cGenome Analysis Toolkit: Now Using Apache Spark for Data Processing,\u201d blog.cloudera.com, April 6, 2016.</li> </ol> <ol> <li> <p>\u6709\u4e9b\u4eba\u8ba4\u4e3a <code>cat</code> \u8fd9\u91cc\u5e76\u6ca1\u6709\u5fc5\u8981\uff0c\u56e0\u4e3a\u8f93\u5165\u6587\u4ef6\u53ef\u4ee5\u76f4\u63a5\u4f5c\u4e3a awk \u7684\u53c2\u6570\u3002\u4f46\u8fd9\u79cd\u5199\u6cd5\u8ba9\u7ebf\u6027\u7ba1\u9053\u66f4\u4e3a\u663e\u773c\u3002\u00a0\u21a9</p> </li> <li> <p>\u5df4\u5c14\u5e72\u5316\uff08Balkanization\uff09 \u662f\u4e00\u4e2a\u5e38\u5e26\u6709\u8d2c\u4e49\u7684\u5730\u7f18\u653f\u6cbb\u5b66\u672f\u8bed\uff0c\u5176\u5b9a\u4e49\u4e3a\uff1a\u4e00\u4e2a\u56fd\u5bb6\u6216\u653f\u533a\u5206\u88c2\u6210\u591a\u4e2a\u4e92\u76f8\u654c\u5bf9\u7684\u56fd\u5bb6\u6216\u653f\u533a\u7684\u8fc7\u7a0b\u3002\u00a0\u21a9</p> </li> <li> <p>\u6211\u4eec\u5728\u672c\u4e66\u4e2d\u8ba8\u8bba\u7684\u8fde\u63a5\u901a\u5e38\u662f\u7b49\u503c\u8fde\u63a5\uff0c\u5373\u6700\u5e38\u89c1\u7684\u8fde\u63a5\u7c7b\u578b\uff0c\u5176\u4e2d\u8bb0\u5f55\u901a\u8fc7\u4e0e\u5176\u4ed6\u8bb0\u5f55\u5728\u7279\u5b9a\u5b57\u6bb5\uff08\u4f8b\u5982 ID\uff09\u4e2d\u5177\u6709 \u76f8\u540c\u503c \u76f8\u5173\u8054\u3002\u6709\u4e9b\u6570\u636e\u5e93\u652f\u6301\u66f4\u901a\u7528\u7684\u8fde\u63a5\u7c7b\u578b\uff0c\u4f8b\u5982\u4f7f\u7528\u5c0f\u4e8e\u8fd0\u7b97\u7b26\u800c\u4e0d\u662f\u7b49\u53f7\u8fd0\u7b97\u7b26\uff0c\u4f46\u662f\u6211\u4eec\u6ca1\u6709\u5730\u65b9\u6765\u8bb2\u8fd9\u4e9b\u4e1c\u897f\u3002\u00a0\u21a9</p> </li> <li> <p>\u7edf\u4e00\u63a5\u53e3\u7684\u53e6\u4e00\u4e2a\u4f8b\u5b50\u662f URL \u548c HTTP\uff0c\u8fd9\u662f Web \u7684\u57fa\u77f3\u3002\u4e00\u4e2a URL \u6807\u8bc6\u4e00\u4e2a\u7f51\u7ad9\u4e0a\u7684\u4e00\u4e2a\u7279\u5b9a\u7684\u4e1c\u897f\uff08\u8d44\u6e90\uff09\uff0c\u4f60\u53ef\u4ee5\u94fe\u63a5\u5230\u4efb\u4f55\u5176\u4ed6\u7f51\u7ad9\u7684\u4efb\u4f55\u7f51\u5740\u3002\u5177\u6709\u7f51\u7edc\u6d4f\u89c8\u5668\u7684\u7528\u6237\u56e0\u6b64\u53ef\u4ee5\u901a\u8fc7\u8ddf\u968f\u94fe\u63a5\u5728\u7f51\u7ad9\u4e4b\u95f4\u65e0\u7f1d\u8df3\u8f6c\uff0c\u5373\u4f7f\u670d\u52a1\u5668\u53ef\u80fd\u7531\u5b8c\u5168\u4e0d\u76f8\u5173\u7684\u7ec4\u7ec7\u7ef4\u62a4\u3002\u8fd9\u4e2a\u539f\u5219\u73b0\u5728\u4f3c\u4e4e\u975e\u5e38\u660e\u663e\uff0c\u4f46\u5b83\u5374\u662f\u7f51\u7edc\u53d6\u80fd\u53d6\u5f97\u4eca\u5929\u6210\u5c31\u7684\u5173\u952e\u3002\u4e4b\u524d\u7684\u7cfb\u7edf\u5e76\u4e0d\u662f\u90a3\u4e48\u7edf\u4e00\uff1a\u4f8b\u5982\uff0c\u5728\u516c\u544a\u677f\u7cfb\u7edf\uff08BBS\uff09\u65f6\u4ee3\uff0c\u6bcf\u4e2a\u7cfb\u7edf\u90fd\u6709\u81ea\u5df1\u7684\u7535\u8bdd\u53f7\u7801\u548c\u6ce2\u7279\u7387\u914d\u7f6e\u3002\u4ece\u4e00\u4e2a BBS \u5230\u53e6\u4e00\u4e2a BBS \u7684\u5f15\u7528\u5fc5\u987b\u4ee5\u7535\u8bdd\u53f7\u7801\u548c\u8c03\u5236\u89e3\u8c03\u5668\u8bbe\u7f6e\u7684\u5f62\u5f0f\uff1b\u7528\u6237\u5c06\u4e0d\u5f97\u4e0d\u6302\u65ad\uff0c\u62e8\u6253\u5176\u4ed6 BBS\uff0c\u7136\u540e\u624b\u52a8\u627e\u5230\u4ed6\u4eec\u6b63\u5728\u5bfb\u627e\u7684\u4fe1\u606f\u3002\u76f4\u63a5\u94fe\u63a5\u5230\u53e6\u4e00\u4e2a BBS \u5185\u7684\u4e00\u4e9b\u5185\u5bb9\u5f53\u65f6\u662f\u4e0d\u53ef\u80fd\u7684\u3002\u00a0\u21a9</p> </li> <li> <p>\u9664\u4e86\u4f7f\u7528\u4e00\u4e2a\u5355\u72ec\u7684\u5de5\u5177\uff0c\u5982 <code>netcat</code> \u6216 <code>curl</code>\u3002Unix \u8d77\u521d\u8bd5\u56fe\u5c06\u6240\u6709\u4e1c\u897f\u90fd\u8868\u793a\u4e3a\u6587\u4ef6\uff0c\u4f46\u662f BSD \u5957\u63a5\u5b57 API \u504f\u79bb\u4e86\u8fd9\u4e2a\u60ef\u4f8b\u301017\u3011\u3002\u7814\u7a76\u7528\u64cd\u4f5c\u7cfb\u7edf Plan 9 \u548c Inferno \u5728\u4f7f\u7528\u6587\u4ef6\u65b9\u9762\u66f4\u52a0\u4e00\u81f4\uff1a\u5b83\u4eec\u5c06 TCP \u8fde\u63a5\u8868\u793a\u4e3a <code>/net/tcp</code> \u4e2d\u7684\u6587\u4ef6\u301018\u3011\u3002\u00a0\u21a9</p> </li> <li> <p>\u4e00\u4e2a\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0c\u5bf9\u4e8e HDFS\uff0c\u53ef\u4ee5\u5c06\u8ba1\u7b97\u4efb\u52a1\u5b89\u6392\u5728\u5b58\u50a8\u7279\u5b9a\u6587\u4ef6\u526f\u672c\u7684\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\uff0c\u800c\u5bf9\u8c61\u5b58\u50a8\u901a\u5e38\u5c06\u5b58\u50a8\u548c\u8ba1\u7b97\u5206\u5f00\u3002\u5982\u679c\u7f51\u7edc\u5e26\u5bbd\u662f\u4e00\u4e2a\u74f6\u9888\uff0c\u4ece\u672c\u5730\u78c1\u76d8\u8bfb\u53d6\u6709\u6027\u80fd\u4f18\u52bf\u3002\u4f46\u662f\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u4f7f\u7528\u7ea0\u5220\u7801\uff08Erasure Coding\uff09\uff0c\u5219\u4f1a\u4e22\u5931\u5c40\u90e8\u6027\uff0c\u56e0\u4e3a\u6765\u81ea\u591a\u53f0\u673a\u5668\u7684\u6570\u636e\u5fc5\u987b\u8fdb\u884c\u5408\u5e76\u4ee5\u91cd\u5efa\u539f\u59cb\u6587\u4ef6\u301020\u3011\u3002\u00a0\u21a9</p> </li> <li> <p>\u8fd9\u4e2a\u4f8b\u5b50\u5047\u5b9a\u6563\u5217\u8868\u4e2d\u7684\u6bcf\u4e2a\u952e\u53ea\u6709\u4e00\u4e2a\u6761\u76ee\uff0c\u8fd9\u5bf9\u7528\u6237\u6570\u636e\u5e93\uff08\u7528\u6237 ID \u552f\u4e00\u6807\u8bc6\u4e00\u4e2a\u7528\u6237\uff09\u53ef\u80fd\u662f\u6b63\u786e\u7684\u3002\u901a\u5e38\uff0c\u54c8\u5e0c\u8868\u53ef\u80fd\u9700\u8981\u5305\u542b\u5177\u6709\u76f8\u540c\u952e\u7684\u591a\u4e2a\u6761\u76ee\uff0c\u800c\u8fde\u63a5\u8fd0\u7b97\u7b26\u5c06\u5bf9\u6bcf\u4e2a\u952e\u8f93\u51fa\u6240\u6709\u7684\u5339\u914d\u3002\u00a0\u21a9</p> </li> </ol>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html","title":"\u7b2c\u5341\u4e00\u7ae0\uff1a\u6d41\u5904\u7406","text":"<p>\u5f88\u591a\u6570\u636e\u662f \u65e0\u754c\u9650 \u7684\uff0c\u56e0\u4e3a\u5b83\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u800c\u9010\u6e10\u5230\u8fbe\uff1a\u7528\u6237\u5728\u6628\u5929\u548c\u4eca\u5929\u4ea7\u751f\u4e86\u6570\u636e\uff0c\u660e\u5929\u4ed6\u4eec\u5c06\u7ee7\u7eed\u4ea7\u751f\u66f4\u591a\u7684\u6570\u636e\u3002\u8fd9\u4e9b\u6570\u636e\u96c6\u4ece\u6765\u5c31\u4e0d\u4f1a\u4ee5\u4efb\u4f55\u6709\u610f\u4e49\u7684\u65b9\u5f0f \u201c\u5b8c\u6210\u201d\u30101\u3011\u3002</p> <ul> <li>\u6279\u5904\u7406\u7a0b\u5e8f\u5fc5\u987b\u5c06\u6570\u636e\u4eba\u4e3a\u5730\u5206\u6210\u56fa\u5b9a\u65f6\u95f4\u6bb5\u7684\u6570\u636e\u5757\uff0c\u4f8b\u5982\uff0c\u5728\u6bcf\u5929\u7ed3\u675f\u65f6\u5904\u7406\u4e00\u5929\u7684\u6570\u636e\uff0c\u6216\u8005\u5728\u6bcf\u5c0f\u65f6\u7ed3\u675f\u65f6\u5904\u7406\u4e00\u5c0f\u65f6\u7684\u6570\u636e\u3002</li> </ul> <p>\u4e3a\u4e86\u51cf\u5c11\u5ef6\u8fdf\uff0c\u6211\u4eec\u53ef\u4ee5\u66f4\u9891\u7e41\u5730\u8fd0\u884c\u5904\u7406 \uff0c\u5982\u5728\u6bcf\u79d2\u949f\u7684\u672b\u5c3e\u3002\u6216\u8005\u66f4\u8fde\u7eed\uff0c\u5f53\u4e8b\u4ef6\u53d1\u751f\u65f6\u5c31\u7acb\u5373\u8fdb\u884c\u5904\u7406\uff0c\u8fd9\u5c31\u662f \u6d41\u5904\u7406\uff08stream processing\uff09 \u80cc\u540e\u7684\u60f3\u6cd5\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u201c\u6d41\u201d \u662f\u6307\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u9010\u6e10\u53ef\u7528\u7684\u6570\u636e\u3002\u8fd9\u4e2a\u6982\u5ff5\u51fa\u73b0\u5728\u5f88\u591a\u5730\u65b9\uff1aUnix \u7684 stdin \u548c stdout\u3001\u7f16\u7a0b\u8bed\u8a00\uff08\u60f0\u6027\u5217\u8868\uff09\u30102\u3011\u3001\u6587\u4ef6\u7cfb\u7edf API\uff08\u5982 Java \u7684 <code>FileInputStream</code>\uff09\u3001TCP \u8fde\u63a5\u3001\u901a\u8fc7\u4e92\u8054\u7f51\u4f20\u9001\u97f3\u9891\u548c\u89c6\u9891\u7b49\u7b49\u3002</p> <p>\u672c\u7ae0\u628a \u4e8b\u4ef6\u6d41\uff08event stream\uff09 \u89c6\u4e3a\u4e00\u79cd\u6570\u636e\u7ba1\u7406\u673a\u5236\uff1a\u65e0\u754c\u9650\uff0c\u589e\u91cf\u5904\u7406\uff0c\u4e0e\u4e0a\u4e00\u7ae0\u4e2d\u7684\u6279\u91cf\u6570\u636e\u76f8\u5bf9\u5e94\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_2","title":"\u4f20\u9012\u4e8b\u4ef6\u6d41","text":"<p>\u5728\u6d41\u5904\u7406\u7684\u4e0a\u4e0b\u6587\u4e2d\uff0c\u8bb0\u5f55\u901a\u5e38\u88ab\u53eb\u505a \u4e8b\u4ef6\uff08event\uff09 \uff1a\u4e00\u4e2a\u5c0f\u7684\u3001\u81ea\u5305\u542b\u7684\u3001\u4e0d\u53ef\u53d8\u7684\u5bf9\u8c61\uff0c\u5305\u542b\u67d0\u4e2a\u65f6\u95f4\u70b9\u53d1\u751f\u7684\u67d0\u4ef6\u4e8b\u60c5\u7684\u7ec6\u8282\u3002\u901a\u5e38\u5305\u542b\u4e00\u4e2a\u6765\u81ea\u65e5\u5386\u65f6\u949f\u7684\u65f6\u95f4\u6233\uff0c\u4ee5\u6307\u660e\u4e8b\u4ef6\u53d1\u751f\u7684\u65f6\u95f4\u3002</p> <p>\u4e8b\u4ef6\u53ef\u80fd\u88ab\u7f16\u7801\u4e3a\u6587\u672c\u5b57\u7b26\u4e32\u6216 JSON\uff0c\u6216\u8005\u67d0\u79cd\u4e8c\u8fdb\u5236\u7f16\u7801\u3002\u53ef\u4ee5\u5b58\u50a8\u4e00\u4e2a\u4e8b\u4ef6\uff0c\u5c06\u5176\u8ffd\u52a0\u5230\u4e00\u4e2a\u6587\u4ef6\uff0c\u5c06\u5176\u63d2\u5165\u5173\u7cfb\u8868\uff0c\u6216\u5c06\u5176\u5199\u5165\u6587\u6863\u6570\u636e\u5e93\uff0c\u901a\u8fc7\u7f51\u7edc\u53d1\u9001\u7b49\u3002</p> <p>\u6d41\u5904\u7406\u672f\u8bed\u4e2d\uff0c\u4e00\u4e2a\u4e8b\u4ef6\u7531 \u751f\u4ea7\u8005\uff08producer\uff09 \uff08\u4e5f\u79f0\u4e3a \u53d1\u5e03\u8005\uff08publisher\uff09 \u6216 \u53d1\u9001\u8005\uff08sender\uff09 \uff09\u751f\u6210\u4e00\u6b21\uff0c\u7136\u540e\u53ef\u80fd\u7531\u591a\u4e2a \u6d88\u8d39\u8005\uff08consumer\uff09 \uff08 \u8ba2\u9605\u8005\uff08subscribers\uff09 \u6216 \u63a5\u6536\u8005\uff08recipients\uff09 \uff09\u8fdb\u884c\u5904\u7406\u30103\u3011\u3002</p> <p>\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u6587\u4ef6\u540d\u6807\u8bc6\u4e00\u7ec4\u76f8\u5173\u8bb0\u5f55\uff1b\u5728\u6d41\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u76f8\u5173\u7684\u4e8b\u4ef6\u901a\u5e38\u88ab\u805a\u5408\u4e3a\u4e00\u4e2a \u4e3b\u9898\uff08topic\uff09 \u6216 \u6d41\uff08stream\uff09 \u3002</p> <p>\u539f\u5219\u4e0a\u8bb2\uff0c\u6587\u4ef6\u6216\u6570\u636e\u5e93\u5c31\u8db3\u4ee5\u8fde\u63a5\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\uff1a\u751f\u4ea7\u8005\u5c06\u5176\u751f\u6210\u7684\u6bcf\u4e2a\u4e8b\u4ef6\u5199\u5165\u6570\u636e\u5b58\u50a8\uff0c\u4e14\u6bcf\u4e2a\u6d88\u8d39\u8005\u5b9a\u671f\u8f6e\u8be2\u6570\u636e\u5b58\u50a8\uff0c\u68c0\u67e5\u81ea\u4e0a\u6b21\u8fd0\u884c\u4ee5\u6765\u65b0\u51fa\u73b0\u7684\u4e8b\u4ef6\u3002\u8fd9\u5b9e\u9645\u4e0a\u6b63\u662f\u6279\u5904\u7406\u5728\u6bcf\u5929\u7ed3\u675f\u65f6\u5904\u7406\u5f53\u5929\u6570\u636e\u65f6\u6240\u505a\u7684\u4e8b\u60c5\u3002</p> <ul> <li>\u4f4e\u5ef6\u8fdf\u7684\u8fde\u7eed\u5904\u7406\uff1a\u5982\u679c\u6570\u636e\u5b58\u50a8\u4e0d\u662f\u4e3a\u8fd9\u79cd\u7528\u9014\u4e13\u95e8\u8bbe\u8ba1\u7684\uff0c\u90a3\u4e48\u8f6e\u8be2\u5f00\u9500\u5c31\u4f1a\u5f88\u5927\u3002</li> <li>\u5173\u7cfb\u578b\u6570\u636e\u5e93\u901a\u5e38\u6709 \u89e6\u53d1\u5668\uff08trigger\uff09\uff0c\u4f46\u662f\u5b83\u4eec\u7684\u529f\u80fd\u975e\u5e38\u6709\u9650\uff0c\u5e76\u4e14\u5728\u6570\u636e\u5e93\u8bbe\u8ba1\u4e2d\u6709\u4e9b\u540e\u987e\u4e4b\u5fe7\u30104,5\u3011\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_3","title":"\u6d88\u606f\u4f20\u9012\u7cfb\u7edf","text":"<p>\u5411\u6d88\u8d39\u8005\u901a\u77e5\u65b0\u4e8b\u4ef6\u7684\u5e38\u7528\u65b9\u5f0f\u662f\u4f7f\u7528 \u6d88\u606f\u4f20\u9012\u7cfb\u7edf\uff08messaging system\uff09\uff1a\u751f\u4ea7\u8005\u53d1\u9001\u5305\u542b\u4e8b\u4ef6\u7684\u6d88\u606f\uff0c\u7136\u540e\u5c06\u6d88\u606f\u63a8\u9001\u7ed9\u6d88\u8d39\u8005\u3002</p> <p>Unix \u7ba1\u9053\u548c TCP \u5c06\u6070\u597d\u4e00\u4e2a\u53d1\u9001\u8005\u4e0e\u6070\u597d\u4e00\u4e2a\u63a5\u6536\u8005\u8fde\u63a5\u3002\u800c\u4e00\u4e2a\u6d88\u606f\u4f20\u9012\u7cfb\u7edf\u5141\u8bb8\u591a\u4e2a\u751f\u4ea7\u8005\u8282\u70b9\u5c06\u6d88\u606f\u53d1\u9001\u5230\u540c\u4e00\u4e2a\u4e3b\u9898\uff0c\u5e76\u5141\u8bb8\u591a\u4e2a\u6d88\u8d39\u8005\u8282\u70b9\u63a5\u6536\u4e3b\u9898\u4e2d\u7684\u6d88\u606f\u3002</p> <p>\u5728\u8fd9\u4e2a \u53d1\u5e03 / \u8ba2\u9605 \u6a21\u5f0f\u4e2d\uff0c\u4e0d\u540c\u7684\u7cfb\u7edf\u91c7\u53d6\u5404\u79cd\u5404\u6837\u7684\u65b9\u6cd5\uff0c\u5e76\u6ca1\u6709\u9488\u5bf9\u6240\u6709\u76ee\u7684\u7684\u901a\u7528\u7b54\u6848\u3002</p> <ul> <li>\u5982\u679c\u751f\u4ea7\u8005\u53d1\u9001\u6d88\u606f\u7684\u901f\u5ea6\u6bd4\u6d88\u8d39\u8005\u80fd\u591f\u5904\u7406\u7684\u901f\u5ea6\u5feb\u4f1a\u53d1\u751f\u4ec0\u4e48</li> <li>\u4e22\u6389\u6d88\u606f\u3001\u5c06\u6d88\u606f\u653e\u5165\u7f13\u51b2\u961f\u5217\u3001\u6216\u4f7f\u7528 \u80cc\u538b\uff08backpressure\uff0c\u4e5f\u79f0\u4e3a \u6d41\u91cf\u63a7\u5236\uff0c\u5373 flow control\uff1a\u963b\u585e\u751f\u4ea7\u8005\uff0c\u4ee5\u514d\u5176\u53d1\u9001\u66f4\u591a\u7684\u6d88\u606f\uff09\u3002</li> <li>Unix \u7ba1\u9053\u548c TCP \u5c31\u4f7f\u7528\u4e86\u80cc\u538b\uff1a\u5b83\u4eec\u6709\u4e00\u4e2a\u56fa\u5b9a\u5927\u5c0f\u7684\u5c0f\u7f13\u51b2\u533a\uff0c\u5982\u679c\u586b\u6ee1\uff0c\u53d1\u9001\u8005\u4f1a\u88ab\u963b\u585e\uff0c\u76f4\u5230\u63a5\u6536\u8005\u4ece\u7f13\u51b2\u533a\u4e2d\u53d6\u51fa\u6570\u636e\u3002</li> <li>\u5982\u679c\u8282\u70b9\u5d29\u6e83\u6216\u6682\u65f6\u8131\u673a\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\u60c5\u51b5\uff1f \u2014\u2014 \u662f\u5426\u4f1a\u6709\u6d88\u606f\u4e22\u5931\uff1f</li> <li>\u6301\u4e45\u6027\u53ef\u80fd\u9700\u8981\u5199\u5165\u78c1\u76d8\u548c / \u6216\u590d\u5236\u7684\u67d0\u79cd\u7ec4\u5408\u8fd9\u662f\u6709\u4ee3\u4ef7\u7684\u3002\u5982\u679c\u4f60\u80fd\u63a5\u53d7\u6709\u65f6\u6d88\u606f\u4f1a\u4e22\u5931\uff0c\u5219\u53ef\u80fd\u5728\u540c\u4e00\u786c\u4ef6\u4e0a\u83b7\u5f97\u66f4\u9ad8\u7684\u541e\u5410\u91cf\u548c\u66f4\u4f4e\u7684\u5ef6\u8fdf\u3002</li> </ul> <p>\u662f\u5426\u53ef\u4ee5\u63a5\u53d7\u6d88\u606f\u4e22\u5931\u53d6\u51b3\u4e8e\u5e94\u7528\uff1a</p> <ul> <li>\u5bf9\u4e8e\u5468\u671f\u4f20\u8f93\u7684\u4f20\u611f\u5668\u8bfb\u6570\u548c\u6307\u6807\uff0c\u5076\u5c14\u4e22\u5931\u7684\u6570\u636e\u70b9\u53ef\u80fd\u5e76\u4e0d\u91cd\u8981\uff0c\u65b0\u503c\u77ed\u65f6\u95f4\u5185\u4f1a\u518d\u53d1\u51fa\uff1b\u5982\u679c\u5927\u91cf\u7684\u6d88\u606f\u88ab\u4e22\u5f03\uff0c\u53ef\u80fd\u65e0\u6cd5\u7acb\u523b\u610f\u8bc6\u5230\u6307\u6807\u5df2\u7ecf\u4e0d\u6b63\u786e\u4e86\u30107\u3011</li> <li>\u5982\u679c\u4f60\u6b63\u5728\u5bf9\u4e8b\u4ef6\u8ba1\u6570\uff0c\u90a3\u4e48\u5b83\u4eec\u80fd\u591f\u53ef\u9760\u9001\u8fbe\u662f\u66f4\u91cd\u8981\u7684\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u4e22\u5931\u7684\u6d88\u606f\u90fd\u610f\u5473\u7740\u4f7f\u8ba1\u6570\u5668\u7684\u9519\u8bef\u6269\u5927</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_4","title":"\u76f4\u63a5\u4ece\u751f\u4ea7\u8005\u4f20\u9012\u7ed9\u6d88\u8d39\u8005","text":"<p>\u8bb8\u591a\u6d88\u606f\u4f20\u9012\u7cfb\u7edf\u4f7f\u7528\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u4e4b\u95f4\u7684\u76f4\u63a5\u7f51\u7edc\u901a\u4fe1\uff0c\u800c\u4e0d\u901a\u8fc7\u4e2d\u95f4\u8282\u70b9\uff1a</p> <ul> <li>UDP \u7ec4\u64ad\u5e7f\u6cdb\u5e94\u7528\u4e8e\u91d1\u878d\u884c\u4e1a\uff0c\u4f8b\u5982\u80a1\u7968\u5e02\u573a\uff0c\u5176\u4e2d\u4f4e\u65f6\u5ef6\u975e\u5e38\u91cd\u8981\u30108\u3011\u3002UDP\u867d\u7136\u4e0d\u53ef\u9760\uff0c\u4f46\u5e94\u7528\u5c42\u7684\u534f\u8bae\u53ef\u4ee5\u6062\u590d\u4e22\u5931\u7684\u6570\u636e\u5305\uff08\u751f\u4ea7\u8005\u5fc5\u987b\u8bb0\u4f4f\u5b83\u53d1\u9001\u7684\u6570\u636e\u5305\uff0c\u4ee5\u4fbf\u80fd\u6309\u9700\u91cd\u65b0\u53d1\u9001\u6570\u636e\u5305\uff09\u3002</li> <li>\u65e0\u4ee3\u7406\u7684\u6d88\u606f\u5e93\uff0c\u5982 ZeroMQ \u30109\u3011\u548c nanomsg \u3002\u901a\u8fc7 TCP \u6216 IP \u591a\u64ad\u5b9e\u73b0\u53d1\u5e03 / \u8ba2\u9605\u6d88\u606f\u4f20\u9012\u3002</li> <li>StatsD \u301010\uff0c11\u3011\u548c Brubeck \u30107\u3011\u4f7f\u7528\u4e0d\u53ef\u9760\u7684 UDP \u6d88\u606f\u4f20\u9012\u6765\u6536\u96c6\u7f51\u7edc\u4e2d\u6240\u6709\u673a\u5668\u7684\u6307\u6807\u5e76\u5bf9\u5176\u8fdb\u884c\u76d1\u63a7\u3002</li> <li>\u5982\u679c\u6d88\u8d39\u8005\u5728\u7f51\u7edc\u4e0a\u516c\u5f00\u4e86\u670d\u52a1\uff0c\u751f\u4ea7\u8005\u53ef\u4ee5\u76f4\u63a5\u53d1\u9001 HTTP \u6216 RPC \u8bf7\u6c42\u5c06\u6d88\u606f\u63a8\u9001\u7ed9\u4f7f\u7528\u8005\u3002\u8fd9\u5c31\u662f webhooks \u80cc\u540e\u7684\u60f3\u6cd5\u301012\u3011\u3002</li> </ul> <p>\u76f4\u63a5\u6d88\u606f\u4f20\u9012\u7cfb\u7edf\u901a\u5e38\u8981\u6c42\u5e94\u7528\u4ee3\u7801\u610f\u8bc6\u5230\u6d88\u606f\u4e22\u5931\u7684\u53ef\u80fd\u6027\u3002\u5bb9\u9519\u7a0b\u5ea6\u6781\u4e3a\u6709\u9650\uff1a\u5373\u4f7f\u534f\u8bae\u68c0\u6d4b\u5230\u5e76\u91cd\u4f20\u5728\u7f51\u7edc\u4e2d\u4e22\u5931\u7684\u6570\u636e\u5305\uff0c\u5b83\u4eec\u901a\u5e38\u4e5f\u53ea\u662f\u5047\u8bbe\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u59cb\u7ec8\u5728\u7ebf\u3002</p> <p>\u5982\u679c\u6d88\u8d39\u8005\u5904\u4e8e\u8131\u673a\u72b6\u6001\uff0c\u5219\u53ef\u80fd\u4f1a\u4e22\u5931\u5176\u4e0d\u53ef\u8fbe\u65f6\u53d1\u9001\u7684\u6d88\u606f\u3002\u4e00\u4e9b\u534f\u8bae\u5141\u8bb8\u751f\u4ea7\u8005\u91cd\u8bd5\u5931\u8d25\u7684\u6d88\u606f\u4f20\u9012\uff0c\u4f46\u5f53\u751f\u4ea7\u8005\u5d29\u6e83\u65f6\uff0c\u5b83\u53ef\u80fd\u4f1a\u4e22\u5931\u6d88\u606f\u7f13\u51b2\u533a\u53ca\u5176\u672c\u5e94\u53d1\u9001\u7684\u6d88\u606f\uff0c\u8fd9\u79cd\u65b9\u6cd5\u53ef\u80fd\u5c31\u6ca1\u7528\u4e86\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_5","title":"\u6d88\u606f\u4ee3\u7406","text":"<p>\u4e00\u79cd\u5e7f\u6cdb\u4f7f\u7528\u7684\u66ff\u4ee3\u65b9\u6cd5\u662f\u901a\u8fc7 \u6d88\u606f\u4ee3\u7406\uff08message broker\uff0c\u4e5f\u79f0\u4e3a \u6d88\u606f\u961f\u5217\uff0c\u5373 message queue\uff09\u53d1\u9001\u6d88\u606f\u3002</p> <ul> <li>\u6d88\u606f\u4ee3\u7406\u5b9e\u8d28\u4e0a\u662f\u4e00\u79cd\u9488\u5bf9\u5904\u7406\u6d88\u606f\u6d41\u800c\u4f18\u5316\u7684\u6570\u636e\u5e93\uff1b</li> <li>\u4f5c\u4e3a\u670d\u52a1\u5668\u8fd0\u884c\uff0c\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u4f5c\u4e3a\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u670d\u52a1\u5668\u3002\u751f\u4ea7\u8005\u5c06\u6d88\u606f\u5199\u5165\u4ee3\u7406\uff0c\u6d88\u8d39\u8005\u901a\u8fc7\u4ece\u4ee3\u7406\u90a3\u91cc\u8bfb\u53d6\u6765\u63a5\u6536\u6d88\u606f\u3002</li> </ul> <p>\u5c06\u6570\u636e\u96c6\u4e2d\u5728\u4ee3\u7406\u4e0a\uff0c\u8fd9\u4e9b\u7cfb\u7edf\u53ef\u4ee5\u66f4\u5bb9\u6613\u5730\u5bb9\u5fcd\u6765\u6765\u53bb\u53bb\u7684\u5ba2\u6237\u7aef\uff08\u8fde\u63a5\uff0c\u65ad\u5f00\u8fde\u63a5\u548c\u5d29\u6e83\uff09\uff0c\u800c\u6301\u4e45\u6027\u95ee\u9898\u5219\u8f6c\u79fb\u5230\u4ee3\u7406\u7684\u8eab\u4e0a\u3002</p> <ul> <li>\u4e00\u4e9b\u6d88\u606f\u4ee3\u7406\u53ea\u5c06\u6d88\u606f\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u800c\u53e6\u4e00\u4e9b\u6d88\u606f\u4ee3\u7406\uff08\u53d6\u51b3\u4e8e\u914d\u7f6e\uff09\u5c06\u5176\u5199\u5165\u78c1\u76d8\uff0c\u4ee5\u4fbf\u5728\u4ee3\u7406\u5d29\u6e83\u7684\u60c5\u51b5\u4e0b\u4e0d\u4f1a\u4e22\u5931\u3002</li> <li>\u9488\u5bf9\u7f13\u6162\u7684\u6d88\u8d39\u8005\uff0c\u5b83\u4eec\u901a\u5e38\u4f1a\u5141\u8bb8\u65e0\u4e0a\u9650\u7684\u6392\u961f\uff08\u800c\u4e0d\u662f\u4e22\u5f03\u6d88\u606f\u6216\u80cc\u538b\uff09\uff0c\u5c3d\u7ba1\u8fd9\u79cd\u9009\u62e9\u4e5f\u53ef\u80fd\u53d6\u51b3\u4e8e\u914d\u7f6e\u3002</li> </ul> <p>\u6392\u961f\u7684\u7ed3\u679c\u662f\uff0c\u6d88\u8d39\u8005\u901a\u5e38\u662f \u5f02\u6b65\uff08asynchronous\uff09 \u7684\uff1a\u5f53\u751f\u4ea7\u8005\u53d1\u9001\u6d88\u606f\u65f6\uff0c\u901a\u5e38\u53ea\u4f1a\u7b49\u5f85\u4ee3\u7406\u786e\u8ba4\u6d88\u606f\u5df2\u7ecf\u88ab\u7f13\u5b58\uff0c\u800c\u4e0d\u7b49\u5f85\u6d88\u606f\u88ab\u6d88\u8d39\u8005\u5904\u7406\u3002\u5411\u6d88\u8d39\u8005\u9012\u9001\u6d88\u606f\u5c06\u53d1\u751f\u5728\u672a\u6765\u67d0\u4e2a\u672a\u5b9a\u7684\u65f6\u95f4\u70b9 \u2014\u2014 \u901a\u5e38\u5728\u51e0\u5206\u4e4b\u4e00\u79d2\u4e4b\u5185\uff0c\u4f46\u6709\u65f6\u5f53\u6d88\u606f\u5806\u79ef\u65f6\u4f1a\u663e\u8457\u5ef6\u8fdf\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_6","title":"\u6d88\u606f\u4ee3\u7406\u4e0e\u6570\u636e\u5e93\u7684\u5bf9\u6bd4","text":"<p>\u6709\u4e9b\u6d88\u606f\u4ee3\u7406\u751a\u81f3\u53ef\u4ee5\u4f7f\u7528 XA \u6216 JTA \u53c2\u4e0e\u4e24\u9636\u6bb5\u63d0\u4ea4\u534f\u8bae\uff08\u8bf7\u53c2\u9605 \u201c\u5b9e\u8df5\u4e2d\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u201d\uff09\uff0c\u4f46\u6d88\u606f\u4ee3\u7406\u548c\u6570\u636e\u5e93\u4e4b\u95f4\u4ecd\u5b58\u5728\u5b9e\u8df5\u4e0a\u5f88\u91cd\u8981\u7684\u5dee\u5f02\uff1a</p> <ul> <li>\u6570\u636e\u5e93\u901a\u5e38\u4fdd\u7559\u6570\u636e\u76f4\u81f3\u663e\u5f0f\u5220\u9664\uff0c\u800c\u5927\u591a\u6570\u6d88\u606f\u4ee3\u7406\u5728\u6d88\u606f\u6210\u529f\u9012\u9001\u7ed9\u6d88\u8d39\u8005\u65f6\u4f1a\u81ea\u52a8\u5220\u9664\u6d88\u606f\u3002</li> <li>\u7531\u4e8e\u5b83\u4eec\u5f88\u5feb\u5c31\u80fd\u5220\u9664\u6d88\u606f\uff0c\u5927\u591a\u6570\u6d88\u606f\u4ee3\u7406\u90fd\u8ba4\u4e3a\u5b83\u4eec\u7684\u5de5\u4f5c\u96c6\u76f8\u5f53\u5c0f\u3002\u5982\u679c\u4ee3\u7406\u9700\u8981\u7f13\u51b2\u5f88\u591a\u6d88\u606f\uff0c\u6bd4\u5982\u56e0\u4e3a\u6d88\u8d39\u8005\u901f\u5ea6\u8f83\u6162\uff08\u5982\u679c\u5185\u5b58\u88c5\u4e0d\u4e0b\u6d88\u606f\uff0c\u53ef\u80fd\u4f1a\u6ea2\u51fa\u5230\u78c1\u76d8\uff09\uff0c\u6bcf\u4e2a\u6d88\u606f\u9700\u8981\u66f4\u957f\u7684\u5904\u7406\u65f6\u95f4\uff0c\u6574\u4f53\u541e\u5410\u91cf\u53ef\u80fd\u4f1a\u6076\u5316\u30106\u3011\u3002</li> <li>\u6570\u636e\u5e93\u901a\u5e38\u652f\u6301\u6b21\u7ea7\u7d22\u5f15\u548c\u5404\u79cd\u641c\u7d22\u6570\u636e\u7684\u65b9\u5f0f\uff0c\u800c\u6d88\u606f\u4ee3\u7406\u901a\u5e38\u652f\u6301\u6309\u7167\u67d0\u79cd\u6a21\u5f0f\u5339\u914d\u4e3b\u9898\uff0c\u8ba2\u9605\u5176\u5b50\u96c6\u3002</li> <li>\u67e5\u8be2\u6570\u636e\u5e93\u65f6\uff0c\u7ed3\u679c\u901a\u5e38\u57fa\u4e8e\u67d0\u4e2a\u65f6\u95f4\u70b9\u7684\u6570\u636e\u5feb\u7167\uff1b\u5982\u679c\u53e6\u4e00\u4e2a\u5ba2\u6237\u7aef\u968f\u540e\u5411\u6570\u636e\u5e93\u5199\u5165\u4e00\u4e9b\u6539\u53d8\u4e86\u67e5\u8be2\u7ed3\u679c\u7684\u5185\u5bb9\uff0c\u5219\u7b2c\u4e00\u4e2a\u5ba2\u6237\u7aef\u4e0d\u4f1a\u53d1\u73b0\u5176\u5148\u524d\u7ed3\u679c\u73b0\u5df2\u8fc7\u671f\uff08\u9664\u975e\u5b83\u91cd\u590d\u67e5\u8be2\u6216\u8f6e\u8be2\u53d8\u66f4\uff09\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u6d88\u606f\u4ee3\u7406\u4e0d\u652f\u6301\u4efb\u610f\u67e5\u8be2\uff0c\u4f46\u662f\u5f53\u6570\u636e\u53d1\u751f\u53d8\u5316\u65f6\uff08\u5373\u65b0\u6d88\u606f\u53ef\u7528\u65f6\uff09\uff0c\u5b83\u4eec\u4f1a\u901a\u77e5\u5ba2\u6237\u7aef\u3002</li> </ul> <p>\u8fd9\u662f\u5173\u4e8e\u6d88\u606f\u4ee3\u7406\u7684\u4f20\u7edf\u89c2\u70b9\uff0c\u5b83\u88ab\u5c01\u88c5\u5728\u8bf8\u5982 JMS \u301014\u3011\u548c AMQP \u301015\u3011\u7684\u6807\u51c6\u4e2d\uff0c\u5e76\u4e14\u88ab\u8bf8\u5982 RabbitMQ\u3001ActiveMQ\u3001HornetQ\u3001Qpid\u3001TIBCO \u4f01\u4e1a\u6d88\u606f\u670d\u52a1\u3001IBM MQ\u3001Azure Service Bus \u548c Google Cloud Pub/Sub \u6240\u5b9e\u73b0 \u301016\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_7","title":"\u591a\u4e2a\u6d88\u8d39\u8005","text":"<p>\u5f53\u591a\u4e2a\u6d88\u8d39\u8005\u4ece\u540c\u4e00\u4e3b\u9898\u4e2d\u8bfb\u53d6\u6d88\u606f\u65f6\uff0c\u6709\u4e24\u79cd\u4e3b\u8981\u7684\u6d88\u606f\u4f20\u9012\u6a21\u5f0f\uff0c\u5982 \u56fe 11-1 \u6240\u793a\uff1a</p> <ul> <li>\u8d1f\u8f7d\u5747\u8861\uff08load balancing\uff09\uff1a\u6bcf\u6761\u6d88\u606f\u90fd\u88ab\u4f20\u9012\u7ed9\u6d88\u8d39\u8005 \u4e4b\u4e00</li> <li>\u4ee3\u7406\u53ef\u4ee5\u4e3a\u6d88\u8d39\u8005\u4efb\u610f\u5206\u914d\u6d88\u606f\u3002\u5f53\u5904\u7406\u6d88\u606f\u7684\u4ee3\u4ef7\u9ad8\u6602\uff0c\u5e0c\u671b\u80fd\u5e76\u884c\u5904\u7406\u6d88\u606f\u65f6\uff0c\u6b64\u6a21\u5f0f\u975e\u5e38\u6709\u7528</li> <li>\u6247\u51fa\uff08fan-out\uff09\uff1a\u6bcf\u6761\u6d88\u606f\u90fd\u88ab\u4f20\u9012\u7ed9 \u6240\u6709 \u6d88\u8d39\u8005</li> <li>\u51e0\u4e2a\u72ec\u7acb\u7684\u6d88\u8d39\u8005\u5404\u81ea \u201c\u6536\u542c\u201d \u76f8\u540c\u7684\u6d88\u606f\u5e7f\u64ad\uff0c\u5bf9\u5e94\u6279\u5904\u7406\u4e2d\u591a\u4e2a\u4e0d\u540c\u6279\u5904\u7406\u4f5c\u4e1a\u8bfb\u53d6\u540c\u4e00\u4efd\u8f93\u5165\u6587\u4ef6</li> </ul> <p></p> \u56fe 11-1 \uff08a\uff09\u8d1f\u8f7d\u5e73\u8861\uff1a\u5728\u6d88\u8d39\u8005\u95f4\u5171\u4eab\u6d88\u8d39\u4e3b\u9898\uff1b\uff08b\uff09\u6247\u51fa\uff1a\u5c06\u6bcf\u6761\u6d88\u606f\u4f20\u9012\u7ed9\u591a\u4e2a\u6d88\u8d39\u8005\u3002 <p>\u4e24\u79cd\u6a21\u5f0f\u53ef\u4ee5\u7ec4\u5408\u4f7f\u7528\uff1a\u4f8b\u5982\uff0c\u4e24\u4e2a\u72ec\u7acb\u7684\u6d88\u8d39\u8005\u7ec4\u53ef\u4ee5\u6bcf\u7ec4\u5404\u8ba2\u9605\u540c\u4e00\u4e2a\u4e3b\u9898\uff0c\u6bcf\u4e00\u7ec4\u90fd\u5171\u540c\u6536\u5230\u6240\u6709\u6d88\u606f\uff0c\u4f46\u5728\u6bcf\u4e00\u7ec4\u5185\u90e8\uff0c\u6bcf\u6761\u6d88\u606f\u4ec5\u7531\u5355\u4e2a\u8282\u70b9\u5904\u7406\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_8","title":"\u786e\u8ba4\u4e0e\u91cd\u65b0\u4f20\u9012","text":"<p>\u6d88\u8d39\u8005\u968f\u65f6\u53ef\u80fd\u4f1a\u5d29\u6e83\uff0c\u6240\u4ee5\u6709\u4e00\u79cd\u53ef\u80fd\u7684\u60c5\u51b5\u662f\uff1a\u4ee3\u7406\u5411\u6d88\u8d39\u8005\u9012\u9001\u6d88\u606f\uff0c\u4f46\u6d88\u8d39\u8005\u6ca1\u6709\u5904\u7406\uff0c\u6216\u8005\u5728\u6d88\u8d39\u8005\u5d29\u6e83\u4e4b\u524d\u53ea\u8fdb\u884c\u4e86\u90e8\u5206\u5904\u7406\u3002</p> <ul> <li>\u6d88\u606f\u4ee3\u7406\u4f7f\u7528 \u786e\u8ba4\uff08acknowledgments\uff09\uff1a\u5ba2\u6237\u7aef\u5fc5\u987b\u663e\u5f0f\u544a\u77e5\u4ee3\u7406\u6d88\u606f\u5904\u7406\u5b8c\u6bd5\u7684\u65f6\u95f4\uff0c\u4ee5\u4fbf\u4ee3\u7406\u80fd\u5c06\u6d88\u606f\u4ece\u961f\u5217\u4e2d\u79fb\u9664\u3002</li> </ul> <p>\u5982\u679c\u4e0e\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u5173\u95ed\uff0c\u6216\u8005\u4ee3\u7406\u8d85\u51fa\u4e00\u6bb5\u65f6\u95f4\u672a\u6536\u5230\u786e\u8ba4\uff0c\u4ee3\u7406\u5219\u8ba4\u4e3a\u6d88\u606f\u6ca1\u6709\u88ab\u5904\u7406\uff0c\u56e0\u6b64\u5b83\u5c06\u6d88\u606f\u518d\u9012\u9001\u7ed9\u53e6\u4e00\u4e2a\u6d88\u8d39\u8005\u3002</p> <ul> <li>\u53ef\u80fd\u53d1\u751f\u8fd9\u6837\u7684\u60c5\u51b5\uff0c\u6d88\u606f \u5b9e\u9645\u4e0a\u662f \u5904\u7406\u5b8c\u6bd5\u7684\uff0c\u4f46 \u786e\u8ba4 \u5728\u7f51\u7edc\u4e2d\u4e22\u5931\u4e86\u3002\u9700\u8981\u4e00\u79cd\u539f\u5b50\u63d0\u4ea4\u534f\u8bae\u624d\u80fd\u5904\u7406\u8fd9\u79cd\u60c5\u51b5\u3002</li> </ul> <p>\u5f53\u4e0e\u8d1f\u8f7d\u5747\u8861\u76f8\u7ed3\u5408\u65f6\uff0c\u8fd9\u79cd\u91cd\u4f20\u884c\u4e3a\u5bf9\u6d88\u606f\u7684\u987a\u5e8f\u6709\u79cd\u6709\u8da3\u7684\u5f71\u54cd\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <ul> <li>\u6d88\u8d39\u8005\u901a\u5e38\u6309\u7167\u751f\u4ea7\u8005\u53d1\u9001\u7684\u987a\u5e8f\u5904\u7406\u6d88\u606f\u3002\u6d88\u8d39\u8005 2 \u5728\u5904\u7406\u6d88\u606f m3 \u65f6\u5d29\u6e83\uff0c\u4e0e\u6b64\u540c\u65f6\u6d88\u8d39\u8005 1 \u6b63\u5728\u5904\u7406\u6d88\u606f m4\u3002</li> <li>\u672a\u786e\u8ba4\u7684\u6d88\u606f m3 \u968f\u540e\u88ab\u91cd\u65b0\u53d1\u9001\u7ed9\u6d88\u8d39\u8005 1\uff0c\u7ed3\u679c\u6d88\u8d39\u8005 1 \u6309\u7167 m4\uff0cm3\uff0cm5 \u7684\u987a\u5e8f\u5904\u7406\u6d88\u606f\u3002</li> <li>\u56e0\u6b64 m3 \u548c m4 \u7684\u4ea4\u4ed8\u987a\u5e8f\u4e0e\u751f\u4ea7\u8005 1 \u7684\u53d1\u9001\u987a\u5e8f\u4e0d\u540c\u3002</li> </ul> <p></p> \u56fe 11-2 \u5728\u5904\u7406 m3 \u65f6\u6d88\u8d39\u8005 2 \u5d29\u6e83\uff0c\u56e0\u6b64\u7a0d\u540e\u91cd\u4f20\u81f3\u6d88\u8d39\u8005 1 <p>\u5373\u4f7f\u6d88\u606f\u4ee3\u7406\u8bd5\u56fe\u4fdd\u7559\u6d88\u606f\u7684\u987a\u5e8f\uff08\u5982 JMS \u548c AMQP \u6807\u51c6\u6240\u8981\u6c42\u7684\uff09\uff0c\u8d1f\u8f7d\u5747\u8861\u4e0e\u91cd\u4f20\u7684\u7ec4\u5408\u4e5f\u4e0d\u53ef\u907f\u514d\u5730\u5bfc\u81f4\u6d88\u606f\u88ab\u91cd\u65b0\u6392\u5e8f\u3002</p> <ul> <li>\u4e3a\u907f\u514d\u6b64\u95ee\u9898\uff0c\u4f60\u53ef\u4ee5\u8ba9\u6bcf\u4e2a\u6d88\u8d39\u8005\u4f7f\u7528\u5355\u72ec\u7684\u961f\u5217\uff08\u5373\u4e0d\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\u529f\u80fd\uff09\u3002</li> <li>\u5982\u679c\u6d88\u606f\u4e4b\u95f4\u5b58\u5728\u56e0\u679c\u4f9d\u8d56\u5173\u7cfb\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u95ee\u9898\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_9","title":"\u5206\u533a\u65e5\u5fd7","text":"<p>\u57fa\u4e8e\u65e5\u5fd7\u7684\u6d88\u606f\u4ee3\u7406\uff08log-based message brokers\uff09 \uff1a\u65e2\u6709\u6570\u636e\u5e93\u7684\u6301\u4e45\u5b58\u50a8\u65b9\u5f0f\uff0c\u53c8\u6709\u6d88\u606f\u4f20\u9012\u7684\u4f4e\u5ef6\u8fdf\u901a\u77e5\u3002</p> <ul> <li>AMQP/JMS \u98ce\u683c\u7684\u6d88\u606f\u4f20\u9012\u7684\u95ee\u9898\uff1a\u6536\u5230\u6d88\u606f\u662f\u5177\u6709\u7834\u574f\u6027\u7684\uff0c\u56e0\u4e3a\u786e\u8ba4\u53ef\u80fd\u5bfc\u81f4\u6d88\u606f\u4ece\u4ee3\u7406\u4e2d\u88ab\u5220\u9664\uff0c\u56e0\u6b64\u4f60\u4e0d\u80fd\u671f\u671b\u518d\u6b21\u8fd0\u884c\u540c\u4e00\u4e2a\u6d88\u8d39\u8005\u80fd\u5f97\u5230\u76f8\u540c\u7684\u7ed3\u679c\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_10","title":"\u4f7f\u7528\u65e5\u5fd7\u8fdb\u884c\u6d88\u606f\u5b58\u50a8","text":"<p>\u65e5\u5fd7\u53ea\u662f\u78c1\u76d8\u4e0a\u7b80\u5355\u7684\u4ec5\u8ffd\u52a0\u8bb0\u5f55\u5e8f\u5217\u3002\u540c\u6837\u7684\u7ed3\u6784\u53ef\u4ee5\u7528\u4e8e\u5b9e\u73b0\u6d88\u606f\u4ee3\u7406\uff1a</p> <ul> <li>\u751f\u4ea7\u8005\u901a\u8fc7\u5c06\u6d88\u606f\u8ffd\u52a0\u5230\u65e5\u5fd7\u672b\u5c3e\u6765\u53d1\u9001\u6d88\u606f\uff0c\u800c\u6d88\u8d39\u8005\u901a\u8fc7\u4f9d\u6b21\u8bfb\u53d6\u65e5\u5fd7\u6765\u63a5\u6536\u6d88\u606f\u3002</li> <li>\u5982\u679c\u6d88\u8d39\u8005\u8bfb\u5230\u65e5\u5fd7\u672b\u5c3e\uff0c\u5219\u4f1a\u7b49\u5f85\u65b0\u6d88\u606f\u8ffd\u52a0\u7684\u901a\u77e5\u3002</li> <li>Unix \u5de5\u5177 <code>tail -f</code> \u80fd\u76d1\u89c6\u6587\u4ef6\u88ab\u8ffd\u52a0\u5199\u5165\u7684\u6570\u636e\uff0c\u57fa\u672c\u4e0a\u5c31\u662f\u8fd9\u6837\u5de5\u4f5c\u7684\u3002</li> </ul> <p>\u4e3a\u4e86\u4f38\u7f29\u8d85\u51fa\u5355\u4e2a\u78c1\u76d8\u6240\u80fd\u63d0\u4f9b\u7684\u66f4\u9ad8\u541e\u5410\u91cf\uff0c\u53ef\u4ee5\u5bf9\u65e5\u5fd7\u8fdb\u884c \u5206\u533a\uff1a</p> <ul> <li>\u4e0d\u540c\u7684\u5206\u533a\u53ef\u4ee5\u6258\u7ba1\u5728\u4e0d\u540c\u7684\u673a\u5668\u4e0a\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u5206\u533a\u90fd\u6709\u4e00\u4efd\u80fd\u72ec\u7acb\u4e8e\u5176\u4ed6\u5206\u533a\u8fdb\u884c\u8bfb\u5199\u7684\u65e5\u5fd7\u3002</li> <li>\u4e00\u4e2a\u4e3b\u9898\u53ef\u4ee5\u5b9a\u4e49\u4e3a\u4e00\u7ec4\u643a\u5e26\u76f8\u540c\u7c7b\u578b\u6d88\u606f\u7684\u5206\u533a\u3002</li> </ul> <p>\u5982\u4e0b\u56fe11-3\u6240\u793a\uff1a</p> <ul> <li>\u5728\u6bcf\u4e2a\u5206\u533a\u5185\uff0c\u4ee3\u7406\u4e3a\u6bcf\u4e2a\u6d88\u606f\u5206\u914d\u4e00\u4e2a\u5355\u8c03\u9012\u589e\u7684\u5e8f\u5217\u53f7\u6216 \u504f\u79fb\u91cf\uff08offset\uff0c\u6846\u4e2d\u7684\u6570\u5b57\u662f\u6d88\u606f\u504f\u79fb\u91cf\uff09\u3002</li> <li>\u8fd9\u79cd\u5e8f\u5217\u53f7\u662f\u6709\u610f\u4e49\u7684\uff0c\u56e0\u4e3a\u5206\u533a\u662f\u4ec5\u8ffd\u52a0\u5199\u5165\u7684\uff0c\u6240\u4ee5\u5206\u533a\u5185\u7684\u6d88\u606f\u662f\u5b8c\u5168\u6709\u5e8f\u7684\u3002</li> <li>\u6ca1\u6709\u8de8\u4e0d\u540c\u5206\u533a\u7684\u987a\u5e8f\u4fdd\u8bc1\u3002</li> </ul> <p></p> \u56fe 11-3 \u751f\u4ea7\u8005\u901a\u8fc7\u5c06\u6d88\u606f\u8ffd\u52a0\u5199\u5165\u4e3b\u9898\u5206\u533a\u6587\u4ef6\u6765\u53d1\u9001\u6d88\u606f\uff0c\u6d88\u8d39\u8005\u4f9d\u6b21\u8bfb\u53d6\u8fd9\u4e9b\u6587\u4ef6 <p>Apache Kafka \u301017,18\u3011\u3001Amazon Kinesis Streams \u301019\u3011\u548c Twitter \u7684 DistributedLog \u301020,21\u3011\u90fd\u662f\u57fa\u4e8e\u65e5\u5fd7\u7684\u6d88\u606f\u4ee3\u7406\u3002Google Cloud Pub/Sub \u5728\u67b6\u6784\u4e0a\u7c7b\u4f3c\uff0c\u4f46\u5bf9\u5916\u66b4\u9732\u7684\u662f JMS \u98ce\u683c\u7684 API\uff0c\u800c\u4e0d\u662f\u65e5\u5fd7\u62bd\u8c61\u301016\u3011\u3002</p> <p>\u5c3d\u7ba1\u8fd9\u4e9b\u6d88\u606f\u4ee3\u7406\u5c06\u6240\u6709\u6d88\u606f\u5199\u5165\u78c1\u76d8\uff0c\u4f46\u901a\u8fc7\u8de8\u591a\u53f0\u673a\u5668\u5206\u533a\uff0c\u6bcf\u79d2\u80fd\u591f\u5b9e\u73b0\u6570\u767e\u4e07\u6761\u6d88\u606f\u7684\u541e\u5410\u91cf\uff0c\u5e76\u901a\u8fc7\u590d\u5236\u6d88\u606f\u6765\u5b9e\u73b0\u5bb9\u9519\u6027\u301022,23\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_11","title":"\u65e5\u5fd7\u4e0e\u4f20\u7edf\u7684\u6d88\u606f\u4f20\u9012\u76f8\u6bd4","text":"<p>\u57fa\u4e8e\u65e5\u5fd7\u7684\u65b9\u6cd5\u5929\u7136\u652f\u6301\u6247\u51fa\u5f0f\u6d88\u606f\u4f20\u9012\uff0c\u56e0\u4e3a\u591a\u4e2a\u6d88\u8d39\u8005\u53ef\u4ee5\u72ec\u7acb\u8bfb\u53d6\u65e5\u5fd7\uff0c\u800c\u4e0d\u4f1a\u76f8\u4e92\u5f71\u54cd\u2014\u2014 \u8bfb\u53d6\u6d88\u606f\u4e0d\u4f1a\u5c06\u5176\u4ece\u65e5\u5fd7\u4e2d\u5220\u9664\u3002</p> <p>\u4e3a\u4e86\u5728\u4e00\u7ec4\u6d88\u8d39\u8005\u4e4b\u95f4\u5b9e\u73b0\u8d1f\u8f7d\u5e73\u8861\uff0c\u4ee3\u7406\u53ef\u4ee5\u5c06\u6574\u4e2a\u5206\u533a\u5206\u914d\u7ed9\u6d88\u8d39\u8005\u7ec4\u4e2d\u7684\u8282\u70b9\uff0c\u800c\u4e0d\u662f\u5c06\u5355\u6761\u6d88\u606f\u5206\u914d\u7ed9\u6d88\u8d39\u8005\u5ba2\u6237\u7aef\u3002\u6bcf\u4e2a\u5ba2\u6237\u7aef\u5c06\u6d88\u8d39\u88ab\u6307\u6d3e\u5206\u533a\u4e2d\u7684 \u6240\u6709 \u6d88\u606f\u3002</p> <p>\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5f53\u4e00\u4e2a\u7528\u6237\u88ab\u6307\u6d3e\u4e86\u4e00\u4e2a\u65e5\u5fd7\u5206\u533a\u65f6\uff0c\u5b83\u4f1a\u4ee5\u7b80\u5355\u7684\u5355\u7ebf\u7a0b\u65b9\u5f0f\u987a\u5e8f\u5730\u8bfb\u53d6\u5206\u533a\u4e2d\u7684\u6d88\u606f\u3002\u8fd9\u79cd\u7c97\u7c92\u5ea6\u7684\u8d1f\u8f7d\u5747\u8861\u65b9\u6cd5\u6709\u4e00\u4e9b\u7f3a\u70b9\uff1a</p> <ul> <li> <p>\u5171\u4eab\u6d88\u8d39\u4e3b\u9898\u5de5\u4f5c\u7684\u8282\u70b9\u6570\uff0c\u6700\u591a\u4e3a\u8be5\u4e3b\u9898\u4e2d\u7684\u65e5\u5fd7\u5206\u533a\u6570\uff0c\u56e0\u4e3a\u540c\u4e00\u4e2a\u5206\u533a\u5185\u7684\u6240\u6709\u6d88\u606f\u88ab\u9012\u9001\u5230\u540c\u4e00\u4e2a\u8282\u70b9 <sup>2</sup>\u3002</p> </li> <li> <p>\u5982\u679c\u67d0\u6761\u6d88\u606f\u5904\u7406\u7f13\u6162\uff0c\u5219\u5b83\u4f1a\u963b\u585e\u8be5\u5206\u533a\u4e2d\u540e\u7eed\u6d88\u606f\u7684\u5904\u7406\uff08\u4e00\u79cd\u884c\u9996\u963b\u585e\u7684\u5f62\u5f0f\uff09\u3002</p> </li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_12","title":"\u6d88\u8d39\u8005\u504f\u79fb\u91cf","text":"<p>\u987a\u5e8f\u6d88\u8d39\u4e00\u4e2a\u5206\u533a\u4f7f\u5f97\u5224\u65ad\u6d88\u606f\u662f\u5426\u5df2\u7ecf\u88ab\u5904\u7406\u53d8\u5f97\u76f8\u5f53\u5bb9\u6613\uff1a\u6240\u6709\u504f\u79fb\u91cf\u5c0f\u4e8e\u6d88\u8d39\u8005\u7684\u5f53\u524d\u504f\u79fb\u91cf\u7684\u6d88\u606f\u5df2\u7ecf\u88ab\u5904\u7406\uff0c\u800c\u5177\u6709\u66f4\u5927\u504f\u79fb\u91cf\u7684\u6d88\u606f\u8fd8\u6ca1\u6709\u88ab\u770b\u5230\u3002</p> <ul> <li>\u4ee3\u7406\u4e0d\u9700\u8981\u8ddf\u8e2a\u786e\u8ba4\u6bcf\u6761\u6d88\u606f\uff0c\u53ea\u9700\u8981\u5b9a\u671f\u8bb0\u5f55\u6d88\u8d39\u8005\u7684\u504f\u79fb\u5373\u53ef\u3002\u63d0\u9ad8\u57fa\u4e8e\u65e5\u5fd7\u7684\u7cfb\u7edf\u7684\u541e\u5410\u91cf\u3002</li> </ul> <p>\u8fd9\u79cd\u504f\u79fb\u91cf\u4e0e\u5355\u9886\u5bfc\u8005\u6570\u636e\u5e93\u590d\u5236\u4e2d\u5e38\u89c1\u7684\u65e5\u5fd7\u5e8f\u5217\u53f7\u975e\u5e38\u76f8\u4f3c\uff0c\u65e5\u5fd7\u5e8f\u5217\u53f7\u5141\u8bb8\u8ddf\u968f\u8005\u65ad\u5f00\u8fde\u63a5\u540e\uff0c\u91cd\u65b0\u8fde\u63a5\u5230\u9886\u5bfc\u8005\uff0c\u5e76\u5728\u4e0d\u8df3\u8fc7\u4efb\u4f55\u5199\u5165\u7684\u60c5\u51b5\u4e0b\u6062\u590d\u590d\u5236\u3002\u8fd9\u91cc\u539f\u7406\u5b8c\u5168\u76f8\u540c\uff1a\u6d88\u606f\u4ee3\u7406\u8868\u73b0\u5f97\u50cf\u4e00\u4e2a\u4e3b\u5e93\uff0c\u800c\u6d88\u8d39\u8005\u5c31\u50cf\u4e00\u4e2a\u4ece\u5e93\u3002</p> <p>\u5982\u679c\u6d88\u8d39\u8005\u8282\u70b9\u5931\u6548\uff0c\u5219\u5931\u6548\u6d88\u8d39\u8005\u7684\u5206\u533a\u5c06\u6307\u6d3e\u7ed9\u5176\u4ed6\u8282\u70b9\uff0c\u5e76\u4ece\u6700\u540e\u8bb0\u5f55\u7684\u504f\u79fb\u91cf\u5f00\u59cb\u6d88\u8d39\u6d88\u606f\u3002\u5982\u679c\u6d88\u8d39\u8005\u5df2\u7ecf\u5904\u7406\u4e86\u540e\u7eed\u7684\u6d88\u606f\uff0c\u4f46\u8fd8\u6ca1\u6709\u8bb0\u5f55\u5b83\u4eec\u7684\u504f\u79fb\u91cf\uff0c\u90a3\u4e48\u91cd\u542f\u540e\u8fd9\u4e9b\u6d88\u606f\u5c06\u88ab\u5904\u7406\u4e24\u6b21\u3002\u672c\u7ae0\u540e\u9762\u8ba8\u8bba\u8fd9\u4e2a\u95ee\u9898\u7684\u5904\u7406\u65b9\u6cd5\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_13","title":"\u78c1\u76d8\u7a7a\u95f4\u4f7f\u7528","text":"<p>\u4e3a\u4e86\u56de\u6536\u78c1\u76d8\u7a7a\u95f4\uff0c\u65e5\u5fd7\u5b9e\u9645\u4e0a\u88ab\u5206\u5272\u6210\u6bb5\uff0c\u5e76\u4e0d\u65f6\u5730\u5c06\u65e7\u6bb5\u5220\u9664\u6216\u79fb\u52a8\u5230\u5f52\u6863\u5b58\u50a8\u3002</p> <ul> <li> <p>\u5982\u679c\u4e00\u4e2a\u6162\u6d88\u8d39\u8005\u8ddf\u4e0d\u4e0a\u6d88\u606f\u4ea7\u751f\u7684\u901f\u7387\u800c\u843d\u540e\u5f97\u592a\u591a\uff0c\u5b83\u7684\u6d88\u8d39\u504f\u79fb\u91cf\u6307\u5411\u4e86\u5220\u9664\u7684\u6bb5\uff0c\u90a3\u4e48\u5b83\u5c31\u4f1a\u9519\u8fc7\u4e00\u4e9b\u6d88\u606f\u3002</p> </li> <li> <p>\u65e5\u5fd7\u5b9e\u73b0\u4e86\u4e00\u4e2a\u6709\u9650\u5927\u5c0f\u7684\u7f13\u51b2\u533a\uff0c\u5f53\u7f13\u51b2\u533a\u586b\u6ee1\u65f6\u4f1a\u4e22\u5f03\u65e7\u6d88\u606f\uff0c\u5b83\u4e5f\u88ab\u79f0\u4e3a \u5faa\u73af\u7f13\u51b2\u533a\uff08circular buffer\uff09 \u6216 \u73af\u5f62\u7f13\u51b2\u533a\uff08ring buffer\uff09\u3002</p> </li> </ul> <p>\u7531\u4e8e\u7f13\u51b2\u533a\u5728\u78c1\u76d8\u4e0a\uff0c\u56e0\u6b64\u7f13\u51b2\u533a\u53ef\u80fd\u76f8\u5f53\u7684\u5927\u3002\u505a\u4e2a\u7b80\u5355\u8ba1\u7b97\uff1a</p> <ul> <li>\u5728\u64b0\u5199\u672c\u6587\u65f6\uff0c\u5178\u578b\u7684\u5927\u578b\u786c\u76d8\u5bb9\u91cf\u4e3a 6TB\uff0c\u987a\u5e8f\u5199\u5165\u541e\u5410\u91cf\u4e3a 150MB/s\u3002</li> <li>\u4ee5\u6700\u5feb\u7684\u901f\u5ea6\u5199\u6d88\u606f\uff0c\u5219\u9700\u8981\u5927\u7ea6 11 \u4e2a\u5c0f\u65f6\u624d\u80fd\u586b\u6ee1\u78c1\u76d8\u3002</li> <li>\u56e0\u800c\u78c1\u76d8\u53ef\u4ee5\u7f13\u51b2 11 \u4e2a\u5c0f\u65f6\u7684\u6d88\u606f\uff0c\u4e4b\u540e\u5b83\u5c06\u5f00\u59cb\u8986\u76d6\u65e7\u7684\u6d88\u606f\u3002</li> </ul> <p>\u5b9e\u8df5\u4e2d\u7684\u90e8\u7f72\u5f88\u5c11\u80fd\u7528\u6ee1\u78c1\u76d8\u7684\u5199\u5165\u5e26\u5bbd\uff0c\u6240\u4ee5\u901a\u5e38\u53ef\u4ee5\u4fdd\u5b58\u4e00\u4e2a\u51e0\u5929\u751a\u81f3\u51e0\u5468\u7684\u65e5\u5fd7\u7f13\u51b2\u533a\u3002</p> <p>\u4e0d\u7ba1\u4fdd\u7559\u591a\u957f\u65f6\u95f4\u7684\u6d88\u606f\uff0c\u65e5\u5fd7\u7684\u541e\u5410\u91cf\u6216\u591a\u6216\u5c11\u4fdd\u6301\u4e0d\u53d8\uff0c\u56e0\u4e3a\u65e0\u8bba\u5982\u4f55\uff0c\u6bcf\u4e2a\u6d88\u606f\u90fd\u4f1a\u88ab\u5199\u5165\u78c1\u76d8\u301018\u3011\u3002\u8fd9\u79cd\u884c\u4e3a\u4e0e\u9ed8\u8ba4\u5c06\u6d88\u606f\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u4ec5\u5f53\u961f\u5217\u592a\u957f\u65f6\u624d\u5199\u5165\u78c1\u76d8\u7684\u6d88\u606f\u4f20\u9012\u7cfb\u7edf\u5f62\u6210\u9c9c\u660e\u5bf9\u6bd4\u3002</p> <ul> <li>\u5f53\u961f\u5217\u5f88\u77ed\u65f6\uff0c\u8fd9\u4e9b\u7cfb\u7edf\u975e\u5e38\u5feb\uff1b\u800c\u5f53\u8fd9\u4e9b\u7cfb\u7edf\u5f00\u59cb\u5199\u5165\u78c1\u76d8\u65f6\uff0c\u5c31\u8981\u6162\u7684\u591a\uff0c\u6240\u4ee5\u541e\u5410\u91cf\u53d6\u51b3\u4e8e\u4fdd\u7559\u7684\u5386\u53f2\u6570\u91cf\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_14","title":"\u5f53\u6d88\u8d39\u8005\u8ddf\u4e0d\u4e0a\u751f\u4ea7\u8005\u65f6","text":"<p>\u5982\u679c\u6d88\u8d39\u8005\u65e0\u6cd5\u8ddf\u4e0a\u751f\u4ea7\u8005\u53d1\u9001\u4fe1\u606f\u7684\u901f\u5ea6\u65f6\uff0c\u6211\u4eec\u8ba8\u8bba\u4e86\u4e09\u79cd\u9009\u62e9\uff1a\u4e22\u5f03\u4fe1\u606f\uff0c\u8fdb\u884c\u7f13\u51b2\u6216\u65bd\u52a0\u80cc\u538b\u3002</p> <ul> <li>\u57fa\u4e8e\u65e5\u5fd7\u7684\u65b9\u6cd5\u662f\u7f13\u51b2\u7684\u4e00\u79cd\u5f62\u5f0f\uff0c\u5177\u6709\u5f88\u5927\u4f46\u5927\u5c0f\u56fa\u5b9a\u7684\u7f13\u51b2\u533a\uff08\u53d7\u53ef\u7528\u78c1\u76d8\u7a7a\u95f4\u7684\u9650\u5236\uff09\u3002</li> </ul> <p>\u5982\u679c\u6d88\u8d39\u8005\u8fdc\u8fdc\u843d\u540e\uff0c\u800c\u6240\u8981\u6c42\u7684\u4fe1\u606f\u6bd4\u4fdd\u7559\u5728\u78c1\u76d8\u4e0a\u7684\u4fe1\u606f\u8fd8\u8981\u65e7\uff0c\u90a3\u4e48\u5b83\u5c06\u4e0d\u80fd\u8bfb\u53d6\u8fd9\u4e9b\u4fe1\u606f\uff0c\u6240\u4ee5\u4ee3\u7406\u5b9e\u9645\u4e0a\u4e22\u5f03\u4e86\u6bd4\u7f13\u51b2\u533a\u5bb9\u91cf\u66f4\u5927\u7684\u65e7\u4fe1\u606f\u3002</p> <ul> <li>\u76d1\u63a7\u6d88\u8d39\u8005\u843d\u540e\u65e5\u5fd7\u5934\u90e8\u7684\u8ddd\u79bb\uff0c\u5982\u679c\u843d\u540e\u592a\u591a\u5c31\u53d1\u51fa\u62a5\u8b66\u3002</li> <li>\u7531\u4e8e\u7f13\u51b2\u533a\u5f88\u5927\uff0c\u56e0\u800c\u6709\u8db3\u591f\u7684\u65f6\u95f4\u8ba9\u8fd0\u7ef4\u4eba\u5458\u6765\u4fee\u590d\u6162\u6d88\u8d39\u8005\uff0c\u5e76\u5728\u6d88\u606f\u5f00\u59cb\u4e22\u5931\u4e4b\u524d\u8ba9\u5176\u8d76\u4e0a\u3002</li> </ul> <p>\u5373\u4f7f\u6d88\u8d39\u8005\u771f\u7684\u843d\u540e\u592a\u591a\u5f00\u59cb\u4e22\u5931\u6d88\u606f\uff0c\u4e5f\u53ea\u6709\u90a3\u4e2a\u6d88\u8d39\u8005\u53d7\u5230\u5f71\u54cd\uff1b\u5b83\u4e0d\u4f1a\u4e2d\u65ad\u5176\u4ed6\u6d88\u8d39\u8005\u7684\u670d\u52a1\u3002</p> <ul> <li>\u53ef\u4ee5\u5b9e\u9a8c\u6027\u5730\u6d88\u8d39\u751f\u4ea7\u65e5\u5fd7\uff0c\u4ee5\u8fdb\u884c\u5f00\u53d1\uff0c\u6d4b\u8bd5\u6216\u8c03\u8bd5\uff0c\u800c\u4e0d\u5fc5\u62c5\u5fc3\u4f1a\u4e2d\u65ad\u751f\u4ea7\u670d\u52a1\u3002</li> <li>\u5f53\u6d88\u8d39\u8005\u5173\u95ed\u6216\u5d29\u6e83\u65f6\uff0c\u4f1a\u505c\u6b62\u6d88\u8017\u8d44\u6e90\uff0c\u552f\u4e00\u5269\u4e0b\u7684\u53ea\u6709\u6d88\u8d39\u8005\u504f\u79fb\u91cf\u3002</li> </ul> <p>\u8fd9\u79cd\u884c\u4e3a\u4e5f\u4e0e\u4f20\u7edf\u7684\u6d88\u606f\u4ee3\u7406\u5f62\u6210\u4e86\u9c9c\u660e\u5bf9\u6bd4\uff0c\u5728\u90a3\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f60\u9700\u8981\u5c0f\u5fc3\u5730\u5220\u9664\u90a3\u4e9b\u6d88\u8d39\u8005\u5df2\u7ecf\u5173\u95ed\u7684\u961f\u5217 \u2014\u2014 \u5426\u5219\u90a3\u4e9b\u961f\u5217\u5c31\u4f1a\u7d2f\u79ef\u4e0d\u5fc5\u8981\u7684\u6d88\u606f\uff0c\u4ece\u5176\u4ed6\u4ecd\u6d3b\u8dc3\u7684\u6d88\u8d39\u8005\u90a3\u91cc\u5360\u8d70\u5185\u5b58\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_15","title":"\u91cd\u64ad\u65e7\u6d88\u606f","text":"<p>\u9664\u4e86\u6d88\u8d39\u8005\u7684\u4efb\u4f55\u8f93\u51fa\u4e4b\u5916\uff0c\u5904\u7406\u7684\u552f\u4e00\u526f\u4f5c\u7528\u662f\u6d88\u8d39\u8005\u504f\u79fb\u91cf\u7684\u524d\u8fdb\u3002\u4f46\u504f\u79fb\u91cf\u662f\u5728\u6d88\u8d39\u8005\u7684\u63a7\u5236\u4e4b\u4e0b\u7684\uff0c\u6240\u4ee5\u5982\u679c\u9700\u8981\u7684\u8bdd\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u64cd\u7eb5\uff1a</p> <ul> <li>\u53ef\u4ee5\u7528\u6628\u5929\u7684\u504f\u79fb\u91cf\u8dd1\u4e00\u4e2a\u6d88\u8d39\u8005\u526f\u672c\uff0c\u5e76\u5c06\u8f93\u51fa\u5199\u5230\u4e0d\u540c\u7684\u4f4d\u7f6e\uff0c\u4ee5\u4fbf\u91cd\u65b0\u5904\u7406\u6700\u8fd1\u4e00\u5929\u7684\u6d88\u606f\u3002</li> <li>\u4f7f\u5f97\u57fa\u4e8e\u65e5\u5fd7\u7684\u6d88\u606f\u4f20\u9012\u66f4\u50cf\u4e0a\u4e00\u7ae0\u7684\u6279\u5904\u7406\uff0c\u5176\u4e2d\u884d\u751f\u6570\u636e\u901a\u8fc7\u53ef\u91cd\u590d\u7684\u8f6c\u6362\u8fc7\u7a0b\u4e0e\u8f93\u5165\u6570\u636e\u663e\u5f0f\u5206\u79bb\u3002</li> <li>\u5141\u8bb8\u8fdb\u884c\u66f4\u591a\u7684\u5b9e\u9a8c\uff0c\u66f4\u5bb9\u6613\u4ece\u9519\u8bef\u548c\u6f0f\u6d1e\u4e2d\u6062\u590d\uff0c\u4f7f\u5176\u6210\u4e3a\u5728\u7ec4\u7ec7\u5185\u96c6\u6210\u6570\u636e\u6d41\u7684\u826f\u597d\u5de5\u5177\u301024\u3011\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_16","title":"\u6570\u636e\u5e93\u4e0e\u6d41","text":"<p>\u4ece\u6d88\u606f\u4f20\u9012\u548c\u6d41\u4e2d\u83b7\u53d6\u7075\u611f\uff0c\u5e76\u5c06\u5b83\u4eec\u5e94\u7528\u4e8e\u6570\u636e\u5e93\u3002</p> <p>\u4e8b\u4ef6\u662f\u67d0\u4e2a\u65f6\u523b\u53d1\u751f\u7684\u4e8b\u60c5\u7684\u8bb0\u5f55\u3002\u53d1\u751f\u7684\u4e8b\u60c5\u53ef\u80fd\u662f\u7528\u6237\u64cd\u4f5c\uff08\u4f8b\u5982\u952e\u5165\u641c\u7d22\u67e5\u8be2\uff09\u6216\u8bfb\u53d6\u4f20\u611f\u5668\uff0c\u4f46\u4e5f\u53ef\u80fd\u662f \u5199\u5165\u6570\u636e\u5e93\u3002\u67d0\u4e9b\u4e1c\u897f\u88ab\u5199\u5165\u6570\u636e\u5e93\u7684\u4e8b\u5b9e\u662f\u53ef\u4ee5\u88ab\u6355\u83b7\u3001\u5b58\u50a8\u548c\u5904\u7406\u7684\u4e8b\u4ef6\u3002</p> <p>\u4e8b\u5b9e\u4e0a\uff0c\u590d\u5236\u65e5\u5fd7\u662f\u4e00\u4e2a\u7531\u6570\u636e\u5e93\u5199\u5165\u4e8b\u4ef6\u7ec4\u6210\u7684\u6d41\uff0c\u7531\u4e3b\u5e93\u5728\u5904\u7406\u4e8b\u52a1\u65f6\u751f\u6210\u3002\u4ece\u5e93\u5c06\u5199\u5165\u6d41\u5e94\u7528\u5230\u5b83\u4eec\u81ea\u5df1\u7684\u6570\u636e\u5e93\u526f\u672c\uff0c\u4ece\u800c\u6700\u7ec8\u5f97\u5230\u76f8\u540c\u6570\u636e\u7684\u7cbe\u786e\u526f\u672c\u3002\u590d\u5236\u65e5\u5fd7\u4e2d\u7684\u4e8b\u4ef6\u63cf\u8ff0\u53d1\u751f\u7684\u6570\u636e\u66f4\u6539\u3002</p> <p>\u72b6\u6001\u673a\u590d\u5236\u539f\u7406\uff0c\u5176\u4e2d\u6307\u51fa\uff1a\u5982\u679c\u6bcf\u4e2a\u4e8b\u4ef6\u4ee3\u8868\u5bf9\u6570\u636e\u5e93\u7684\u5199\u5165\uff0c\u5e76\u4e14\u6bcf\u4e2a\u526f\u672c\u6309\u76f8\u540c\u7684\u987a\u5e8f\u5904\u7406\u76f8\u540c\u7684\u4e8b\u4ef6\uff0c\u5219\u526f\u672c\u5c06\u8fbe\u5230\u76f8\u540c\u7684\u6700\u7ec8\u72b6\u6001 \uff08\u5047\u8bbe\u4e8b\u4ef6\u5904\u7406\u662f\u4e00\u4e2a\u786e\u5b9a\u6027\u7684\u64cd\u4f5c\uff09\u3002\u8fd9\u662f\u4e8b\u4ef6\u6d41\u7684\u53c8\u4e00\u79cd\u573a\u666f\uff01</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_17","title":"\u4fdd\u6301\u7cfb\u7edf\u540c\u6b65","text":"<p>\u6ca1\u6709\u4e00\u4e2a\u7cfb\u7edf\u80fd\u591f\u6ee1\u8db3\u6240\u6709\u7684\u6570\u636e\u5b58\u50a8\u3001\u67e5\u8be2\u548c\u5904\u7406\u9700\u6c42\u3002\u5728\u5b9e\u8df5\u4e2d\uff0c\u5927\u591a\u6570\u91cd\u8981\u5e94\u7528\u90fd\u9700\u8981\u7ec4\u5408\u4f7f\u7528\u51e0\u79cd\u4e0d\u540c\u7684\u6280\u672f\u6765\u6ee1\u8db3\u6240\u6709\u7684\u9700\u6c42\uff1a</p> <ul> <li>\u4f7f\u7528 OLTP \u6570\u636e\u5e93\u6765\u4e3a\u7528\u6237\u8bf7\u6c42\u63d0\u4f9b\u670d\u52a1\uff0c\u4f7f\u7528\u7f13\u5b58\u6765\u52a0\u901f\u5e38\u89c1\u8bf7\u6c42\uff0c\u4f7f\u7528\u5168\u6587\u7d22\u5f15\u6765\u5904\u7406\u641c\u7d22\u67e5\u8be2\uff0c\u4f7f\u7528\u6570\u636e\u4ed3\u5e93\u7528\u4e8e\u5206\u6790\u3002</li> </ul> <p>\u7531\u4e8e\u76f8\u540c\u6216\u76f8\u5173\u7684\u6570\u636e\u51fa\u73b0\u5728\u4e86\u4e0d\u540c\u7684\u5730\u65b9\uff0c\u56e0\u6b64\u76f8\u4e92\u95f4\u9700\u8981\u4fdd\u6301\u540c\u6b65\uff1a\u5982\u679c\u67d0\u4e2a\u9879\u76ee\u5728\u6570\u636e\u5e93\u4e2d\u88ab\u66f4\u65b0\uff0c\u5b83\u4e5f\u5e94\u5f53\u5728\u7f13\u5b58\u3001\u641c\u7d22\u7d22\u5f15\u548c\u6570\u636e\u4ed3\u5e93\u4e2d\u88ab\u66f4\u65b0\u3002</p> <ul> <li>\u5bf9\u4e8e\u6570\u636e\u4ed3\u5e93\uff0c\u8fd9\u79cd\u540c\u6b65\u901a\u5e38\u7531 ETL \u8fdb\u7a0b\u6267\u884c\u3002\u901a\u5e38\u662f\u5148\u53d6\u5f97\u6570\u636e\u5e93\u7684\u5b8c\u6574\u526f\u672c\uff0c\u7136\u540e\u6267\u884c\u8f6c\u6362\uff0c\u5e76\u6279\u91cf\u52a0\u8f7d\u5230\u6570\u636e\u4ed3\u5e93\u4e2d\u3002</li> </ul> <p>\u5982\u679c\u5468\u671f\u6027\u7684\u5b8c\u6574\u6570\u636e\u5e93\u8f6c\u50a8\u8fc7\u4e8e\u7f13\u6162\uff0c\u6709\u65f6\u4f1a\u4f7f\u7528\u7684\u66ff\u4ee3\u65b9\u6cd5\u662f \u53cc\u5199\uff08dual write\uff09\u3002 - \u5e94\u7528\u4ee3\u7801\u5728\u6570\u636e\u53d8\u66f4\u65f6\u660e\u786e\u5199\u5165\u6bcf\u4e2a\u7cfb\u7edf\uff1a\u4f8b\u5982\uff0c\u9996\u5148\u5199\u5165\u6570\u636e\u5e93\uff0c\u7136\u540e\u66f4\u65b0\u641c\u7d22\u7d22\u5f15\uff0c\u7136\u540e\u4f7f\u7f13\u5b58\u9879\u5931\u6548\uff08\u751a\u81f3\u540c\u65f6\u6267\u884c\u8fd9\u4e9b\u5199\u5165\uff09\u3002</p> <p>\u53cc\u5199\u6709\u4e00\u4e9b\u4e25\u91cd\u7684\u95ee\u9898\uff0c\u5176\u4e2d\u4e00\u4e2a\u662f\u7ade\u4e89\u6761\u4ef6\uff0c\u5982\u56fe 11-4 \u6240\u793a\uff1a</p> <ul> <li>\u4e24\u4e2a\u5ba2\u6237\u7aef\u540c\u65f6\u60f3\u8981\u66f4\u65b0\u4e00\u4e2a\u9879\u76ee X\uff1a\u5ba2\u6237\u7aef 1 \u60f3\u8981\u5c06\u503c\u8bbe\u7f6e\u4e3a A\uff0c\u5ba2\u6237\u7aef 2 \u60f3\u8981\u5c06\u5176\u8bbe\u7f6e\u4e3a B\u3002</li> <li>\u4e24\u4e2a\u5ba2\u6237\u7aef\u9996\u5148\u5c06\u65b0\u503c\u5199\u5165\u6570\u636e\u5e93\uff0c\u7136\u540e\u5c06\u5176\u5199\u5165\u5230\u641c\u7d22\u7d22\u5f15\u3002</li> </ul> <p>\u4f46\u8fd0\u6c14\u4e0d\u597d\uff0c\u8fd9\u4e9b\u8bf7\u6c42\u7684\u65f6\u5e8f\u662f\u4ea4\u9519\u7684\uff1a</p> <ul> <li>\u6570\u636e\u5e93\u9996\u5148\u770b\u5230\u6765\u81ea\u5ba2\u6237\u7aef 1 \u7684\u5199\u5165\u5c06\u503c\u8bbe\u7f6e\u4e3a A\uff0c\u7136\u540e\u6765\u81ea\u5ba2\u6237\u7aef 2 \u7684\u5199\u5165\u5c06\u503c\u8bbe\u7f6e\u4e3a B\uff0c\u56e0\u6b64\u6570\u636e\u5e93\u4e2d\u7684\u6700\u7ec8\u503c\u4e3a B\u3002</li> <li>\u641c\u7d22\u7d22\u5f15\u9996\u5148\u770b\u5230\u6765\u81ea\u5ba2\u6237\u7aef 2 \u7684\u5199\u5165\uff0c\u7136\u540e\u662f\u5ba2\u6237\u7aef 1 \u7684\u5199\u5165\uff0c\u6240\u4ee5\u641c\u7d22\u7d22\u5f15\u4e2d\u7684\u6700\u7ec8\u503c\u662f A\u3002</li> <li>\u5373\u4f7f\u6ca1\u53d1\u751f\u9519\u8bef\uff0c\u8fd9\u4e24\u4e2a\u7cfb\u7edf\u73b0\u5728\u4e5f\u6c38\u4e45\u5730\u4e0d\u4e00\u81f4\u4e86\u3002</li> </ul> <p></p> \u56fe 11-4 \u5728\u6570\u636e\u5e93\u4e2d X \u9996\u5148\u88ab\u8bbe\u7f6e\u4e3a A\uff0c\u7136\u540e\u88ab\u8bbe\u7f6e\u4e3a B\uff0c\u800c\u5728\u641c\u7d22\u7d22\u5f15\u5904\uff0c\u5199\u5165\u4ee5\u76f8\u53cd\u7684\u987a\u5e8f\u5230\u8fbe <p>\u9664\u975e\u6709\u4e00\u4e9b\u989d\u5916\u7684\u5e76\u53d1\u68c0\u6d4b\u673a\u5236\uff0c\u4f8b\u5982\u6211\u4eec\u5728 \u201c\u68c0\u6d4b\u5e76\u53d1\u5199\u5165\u201d \u4e2d\u8ba8\u8bba\u7684\u7248\u672c\u5411\u91cf\uff0c\u5426\u5219\u4f60\u751a\u81f3\u4e0d\u4f1a\u610f\u8bc6\u5230\u53d1\u751f\u4e86\u5e76\u53d1\u5199\u5165 \u2014\u2014 \u4e00\u4e2a\u503c\u5c06\u7b80\u5355\u5730\u4ee5\u65e0\u63d0\u793a\u65b9\u5f0f\u8986\u76d6\u53e6\u4e00\u4e2a\u503c\u3002</p> <p>\u53cc\u91cd\u5199\u5165\u7684\u53e6\u4e00\u4e2a\u95ee\u9898\u662f\uff0c\u5176\u4e2d\u4e00\u4e2a\u5199\u5165\u53ef\u80fd\u4f1a\u5931\u8d25\uff0c\u800c\u53e6\u4e00\u4e2a\u6210\u529f\u3002</p> <ul> <li>\u8fd9\u662f\u4e00\u4e2a\u5bb9\u9519\u95ee\u9898\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a\u5e76\u53d1\u95ee\u9898\uff0c\u4f46\u4e5f\u4f1a\u9020\u6210\u4e24\u4e2a\u7cfb\u7edf\u4e92\u76f8\u4e0d\u4e00\u81f4\u7684\u7ed3\u679c\u3002</li> <li>\u786e\u4fdd\u5b83\u4eec\u8981\u4e48\u90fd\u6210\u529f\u8981\u4e48\u90fd\u5931\u8d25\uff0c\u662f\u539f\u5b50\u63d0\u4ea4\u95ee\u9898\u7684\u4e00\u4e2a\u4f8b\u5b50\uff0c\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u4ee3\u4ef7\u662f\u6602\u8d35\u7684\uff08\u8bf7\u53c2\u9605 \u201c\u539f\u5b50\u63d0\u4ea4\u4e0e\u4e24\u9636\u6bb5\u63d0\u4ea4\u201d\uff09\u3002</li> </ul> <p>\u5982\u679c\u5b9e\u9645\u4e0a\u53ea\u6709\u4e00\u4e2a\u9886\u5bfc\u8005 \u2014\u2014 \u4f8b\u5982\uff0c\u6570\u636e\u5e93 \u2014\u2014 \u800c\u4e14\u6211\u4eec\u80fd\u8ba9\u641c\u7d22\u7d22\u5f15\u6210\u4e3a\u6570\u636e\u5e93\u7684\u8ffd\u968f\u8005\uff0c\u60c5\u51b5\u8981\u597d\u5f97\u591a\u3002\u4f46\u8fd9\u5728\u5b9e\u8df5\u4e2d\u53ef\u80fd\u5417\uff1f</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_18","title":"\u53d8\u66f4\u6570\u636e\u6355\u83b7","text":"<p>\u5927\u591a\u6570\u6570\u636e\u5e93\u7684\u590d\u5236\u65e5\u5fd7\u7684\u95ee\u9898\u5728\u4e8e\uff0c\u5b83\u4eec\u4e00\u76f4\u88ab\u5f53\u505a\u6570\u636e\u5e93\u7684\u5185\u90e8\u5b9e\u73b0\u7ec6\u8282\uff0c\u800c\u4e0d\u662f\u516c\u5f00\u7684 API\u3002\u5ba2\u6237\u7aef\u5e94\u8be5\u901a\u8fc7\u5176\u6570\u636e\u6a21\u578b\u548c\u67e5\u8be2\u8bed\u8a00\u6765\u67e5\u8be2\u6570\u636e\u5e93\uff0c\u800c\u4e0d\u662f\u89e3\u6790\u590d\u5236\u65e5\u5fd7\u5e76\u5c1d\u8bd5\u4ece\u4e2d\u63d0\u53d6\u6570\u636e\u3002</p> <p>\u53d8\u66f4\u6570\u636e\u6355\u83b7\uff08change data capture, CDC\uff09\uff1a\u89c2\u5bdf\u5199\u5165\u6570\u636e\u5e93\u7684\u6240\u6709\u6570\u636e\u53d8\u66f4\uff0c\u5e76\u5c06\u5176\u63d0\u53d6\u5e76\u8f6c\u6362\u4e3a\u53ef\u4ee5\u590d\u5236\u5230\u5176\u4ed6\u7cfb\u7edf\u4e2d\u7684\u5f62\u5f0f\u7684\u8fc7\u7a0b\u3002</p> <p>CDC \u5f53\u53d8\u66f4\u80fd\u5728\u88ab\u5199\u5165\u540e\u7acb\u523b\u7528\u4e8e\u6d41\u65f6\u3002\u4f8b\u5982\u53ef\u4ee5\u6355\u83b7\u6570\u636e\u5e93\u4e2d\u7684\u53d8\u66f4\uff0c\u5e76\u4e0d\u65ad\u5c06\u76f8\u540c\u7684\u53d8\u66f4\u5e94\u7528\u81f3\u641c\u7d22\u7d22\u5f15\u3002\u5982\u679c\u53d8\u66f4\u65e5\u5fd7\u4ee5\u76f8\u540c\u7684\u987a\u5e8f\u5e94\u7528\uff0c\u5219\u53ef\u4ee5\u9884\u671f\u641c\u7d22\u7d22\u5f15\u4e2d\u7684\u6570\u636e\u4e0e\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u662f\u5339\u914d\u7684\u3002\u641c\u7d22\u7d22\u5f15\u548c\u4efb\u4f55\u5176\u4ed6\u884d\u751f\u6570\u636e\u7cfb\u7edf\u53ea\u662f\u53d8\u66f4\u6d41\u7684\u6d88\u8d39\u8005\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> \u56fe 11-5 \u5c06\u6570\u636e\u6309\u987a\u5e8f\u5199\u5165\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u7136\u540e\u6309\u7167\u76f8\u540c\u7684\u987a\u5e8f\u5c06\u8fd9\u4e9b\u66f4\u6539\u5e94\u7528\u5230\u5176\u4ed6\u7cfb\u7edf"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_19","title":"\u53d8\u66f4\u6570\u636e\u6355\u83b7\u7684\u5b9e\u73b0","text":"<p>\u53ef\u4ee5\u5c06\u65e5\u5fd7\u6d88\u8d39\u8005\u53eb\u505a \u884d\u751f\u6570\u636e\u7cfb\u7edf\uff1a\u5728\u641c\u7d22\u7d22\u5f15\u548c\u6570\u636e\u4ed3\u5e93\u4e2d\u7684\u6570\u636e\uff0c\u53ea\u662f \u8bb0\u5f55\u7cfb\u7edf \u6570\u636e\u7684\u989d\u5916\u89c6\u56fe\u3002\u53d8\u66f4\u6570\u636e\u6355\u83b7\u662f\u4e00\u79cd\u673a\u5236\uff0c\u53ef\u786e\u4fdd\u5bf9\u8bb0\u5f55\u7cfb\u7edf\u6240\u505a\u7684\u6240\u6709\u66f4\u6539\u90fd\u53cd\u6620\u5728\u884d\u751f\u6570\u636e\u7cfb\u7edf\u4e2d\uff0c\u4ee5\u4fbf\u884d\u751f\u7cfb\u7edf\u5177\u6709\u6570\u636e\u7684\u51c6\u786e\u526f\u672c\u3002</p> <p>\u4ece\u672c\u8d28\u4e0a\u8bf4\uff0c\u53d8\u66f4\u6570\u636e\u6355\u83b7\u4f7f\u5f97\u4e00\u4e2a\u6570\u636e\u5e93\u6210\u4e3a\u9886\u5bfc\u8005\uff08\u88ab\u6355\u83b7\u53d8\u5316\u7684\u6570\u636e\u5e93\uff09\uff0c\u5e76\u5c06\u5176\u4ed6\u7ec4\u4ef6\u53d8\u4e3a\u8ffd\u968f\u8005\u3002\u57fa\u4e8e\u65e5\u5fd7\u7684\u6d88\u606f\u4ee3\u7406\u975e\u5e38\u9002\u5408\u4ece\u6e90\u6570\u636e\u5e93\u4f20\u8f93\u53d8\u66f4\u4e8b\u4ef6\uff0c\u56e0\u4e3a\u5b83\u4fdd\u7559\u4e86\u6d88\u606f\u7684\u987a\u5e8f\u3002</p> <p>\u6570\u636e\u5e93\u89e6\u53d1\u5668\u53ef\u7528\u6765\u5b9e\u73b0\u53d8\u66f4\u6570\u636e\u6355\u83b7\uff0c\u901a\u8fc7\u6ce8\u518c\u89c2\u5bdf\u6240\u6709\u53d8\u66f4\u7684\u89e6\u53d1\u5668\uff0c\u5e76\u5c06\u76f8\u5e94\u7684\u53d8\u66f4\u9879\u5199\u5165\u53d8\u66f4\u65e5\u5fd7\u8868\u4e2d\u3002</p> <ul> <li>\u4f46\u662f\u5b83\u4eec\u5f80\u5f80\u662f\u8106\u5f31\u7684\uff0c\u800c\u4e14\u6709\u663e\u8457\u7684\u6027\u80fd\u5f00\u9500\u3002</li> </ul> <p>\u89e3\u6790\u590d\u5236\u65e5\u5fd7\u53ef\u80fd\u662f\u4e00\u79cd\u66f4\u7a33\u5065\u7684\u65b9\u6cd5\uff0c\u4f46\u5b83\u4e5f\u5f88\u6709\u6311\u6218\uff0c\u4f8b\u5982\u5982\u4f55\u5e94\u5bf9\u6a21\u5f0f\u53d8\u66f4\u3002</p> <ul> <li>LinkedIn \u7684 Databus\u301025\u3011\uff0cFacebook \u7684 Wormhole\u301026\u3011\u548c Yahoo! \u7684 Sherpa\u301027\u3011\u5927\u89c4\u6a21\u5730\u5e94\u7528\u8fd9\u4e2a\u601d\u8def\uff1b</li> <li>Bottled Water \u4f7f\u7528\u89e3\u7801 WAL \u7684 API \u5b9e\u73b0\u4e86 PostgreSQL \u7684 CDC\u301028\u3011\uff1bMaxwell \u548c Debezium \u901a\u8fc7\u89e3\u6790 binlog \u5bf9 MySQL \u505a\u4e86\u7c7b\u4f3c\u7684\u4e8b\u60c5\u301029,30,31\u3011\uff1bMongoriver \u8bfb\u53d6 MongoDB oplog\u301032,33\u3011\uff1b GoldenGate \u4e3a Oracle \u63d0\u4f9b\u7c7b\u4f3c\u7684\u529f\u80fd\u301034,35\u3011\u3002</li> </ul> <p>\u7c7b\u4f3c\u4e8e\u6d88\u606f\u4ee3\u7406\uff0c\u53d8\u66f4\u6570\u636e\u6355\u83b7\u901a\u5e38\u662f\u5f02\u6b65\u7684\uff1a\u8bb0\u5f55\u6570\u636e\u5e93\u7cfb\u7edf\u5728\u63d0\u4ea4\u53d8\u66f4\u4e4b\u524d\u4e0d\u4f1a\u7b49\u5f85\u6d88\u8d39\u8005\u5e94\u7528\u53d8\u66f4\u3002</p> <ul> <li>\u6dfb\u52a0\u7f13\u6162\u7684\u6d88\u8d39\u8005\u4e0d\u4f1a\u8fc7\u5ea6\u5f71\u54cd\u8bb0\u5f55\u7cfb\u7edf\uff0c\u4e0d\u8fc7\uff0c\u6240\u6709\u590d\u5236\u5ef6\u8fdf\u53ef\u80fd\u6709\u7684\u95ee\u9898\u5728\u8fd9\u91cc\u90fd\u53ef\u80fd\u51fa\u73b0\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_20","title":"\u521d\u59cb\u5feb\u7167","text":"<p>\u5982\u679c\u4f60\u62e5\u6709 \u6240\u6709 \u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u53d8\u66f4\u7684\u65e5\u5fd7\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u91cd\u64ad\u8be5\u65e5\u5fd7\uff0c\u6765\u91cd\u5efa\u6570\u636e\u5e93\u7684\u5b8c\u6574\u72b6\u6001\u3002</p> <ul> <li>\u6c38\u8fdc\u4fdd\u7559\u6240\u6709\u66f4\u6539\u4f1a\u8017\u8d39\u592a\u591a\u78c1\u76d8\u7a7a\u95f4\uff0c\u4e14\u91cd\u64ad\u8fc7\u4e8e\u8d39\u65f6\uff0c\u56e0\u6b64\u65e5\u5fd7\u9700\u8981\u88ab\u622a\u65ad\u3002</li> </ul> <p>\u4f8b\u5982\uff0c\u6784\u5efa\u65b0\u7684\u5168\u6587\u7d22\u5f15\u9700\u8981\u6574\u4e2a\u6570\u636e\u5e93\u7684\u5b8c\u6574\u526f\u672c \u2014\u2014 \u4ec5\u4ec5\u5e94\u7528\u6700\u8fd1\u53d8\u66f4\u7684\u65e5\u5fd7\u662f\u4e0d\u591f\u7684\uff0c\u56e0\u4e3a\u8fd9\u6837\u4f1a\u4e22\u5931\u6700\u8fd1\u672a\u66fe\u66f4\u65b0\u7684\u9879\u76ee\u3002</p> <ul> <li>\u5982\u679c\u4f60\u6ca1\u6709\u5b8c\u6574\u7684\u5386\u53f2\u65e5\u5fd7\uff0c\u5219\u9700\u8981\u4ece\u4e00\u4e2a\u4e00\u81f4\u7684\u5feb\u7167\u5f00\u59cb\uff1b</li> <li>\u6570\u636e\u5e93\u7684\u5feb\u7167\u5fc5\u987b\u4e0e\u53d8\u66f4\u65e5\u5fd7\u4e2d\u7684\u5df2\u77e5\u4f4d\u7f6e\u6216\u504f\u79fb\u91cf\u76f8\u5bf9\u5e94\uff0c\u4ee5\u4fbf\u5728\u5904\u7406\u5b8c\u5feb\u7167\u540e\u77e5\u9053\u4ece\u54ea\u91cc\u5f00\u59cb\u5e94\u7528\u53d8\u66f4</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_21","title":"\u65e5\u5fd7\u538b\u7f29","text":"<p>\u5982\u679c\u4f60\u53ea\u80fd\u4fdd\u7559\u6709\u9650\u7684\u5386\u53f2\u65e5\u5fd7\uff0c\u5219\u6bcf\u6b21\u8981\u6dfb\u52a0\u65b0\u7684\u884d\u751f\u6570\u636e\u7cfb\u7edf\u65f6\uff0c\u90fd\u9700\u8981\u505a\u4e00\u6b21\u5feb\u7167\u3002\u4f46 \u65e5\u5fd7\u538b\u7f29\uff08log compaction\uff09 \u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f88\u597d\u7684\u5907\u9009\u65b9\u6848\u3002</p> <p>\u65e5\u5fd7\u538b\u7f29\u7684\u539f\u7406\uff1a\u5b58\u50a8\u5f15\u64ce\u5b9a\u671f\u5728\u65e5\u5fd7\u4e2d\u67e5\u627e\u5177\u6709\u76f8\u540c\u952e\u7684\u8bb0\u5f55\uff0c\u4e22\u6389\u6240\u6709\u91cd\u590d\u7684\u5185\u5bb9\uff0c\u5e76\u53ea\u4fdd\u7559\u6bcf\u4e2a\u952e\u7684\u6700\u65b0\u66f4\u65b0\u3002\u8fd9\u4e2a\u538b\u7f29\u4e0e\u5408\u5e76\u8fc7\u7a0b\u5728\u540e\u53f0\u8fd0\u884c\u3002</p> <ul> <li>\u5728\u65e5\u5fd7\u7ed3\u6784\u5b58\u50a8\u5f15\u64ce\u4e2d\uff0c\u5177\u6709\u7279\u6b8a\u503c NULL\uff08\u5893\u7891\uff0c\u5373 tombstone\uff09\u7684\u66f4\u65b0\u8868\u793a\u8be5\u952e\u88ab\u5220\u9664\uff0c\u5e76\u4f1a\u5728\u65e5\u5fd7\u538b\u7f29\u8fc7\u7a0b\u4e2d\u88ab\u79fb\u9664\u3002</li> <li>\u5177\u6709\u7279\u6b8a\u503c NULL\uff08\u5893\u7891\uff0c\u5373 tombstone\uff09\u7684\u66f4\u65b0\u8868\u793a\u8be5\u952e\u88ab\u5220\u9664\uff0c\u5e76\u4f1a\u5728\u65e5\u5fd7\u538b\u7f29\u8fc7\u7a0b\u4e2d\u88ab\u79fb\u9664\u3002</li> <li>\u538b\u7f29\u65e5\u5fd7\u6240\u9700\u7684\u78c1\u76d8\u7a7a\u95f4\u4ec5\u53d6\u51b3\u4e8e\u6570\u636e\u5e93\u7684\u5f53\u524d\u5185\u5bb9\uff0c\u4e0d\u53d6\u51b3\u4e8e\u6570\u636e\u5e93\u4e2d\u66fe\u7ecf\u53d1\u751f\u7684\u5199\u5165\u6b21\u6570\u3002</li> </ul> <p>\u5982\u679c CDC \u7cfb\u7edf\u88ab\u914d\u7f6e\u4e3a\uff0c\u6bcf\u4e2a\u53d8\u66f4\u90fd\u5305\u542b\u4e00\u4e2a\u4e3b\u952e\uff0c\u4e14\u6bcf\u4e2a\u952e\u7684\u66f4\u65b0\u90fd\u66ff\u6362\u4e86\u8be5\u952e\u4ee5\u524d\u7684\u503c\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u4fdd\u7559\u5bf9\u952e\u7684\u6700\u65b0\u5199\u5165\u5c31\u8db3\u591f\u4e86\u3002</p> <p>\u65e0\u8bba\u4f55\u65f6\u9700\u8981\u91cd\u5efa\u884d\u751f\u6570\u636e\u7cfb\u7edf\uff08\u5982\u641c\u7d22\u7d22\u5f15\uff09\uff0c\u4f60\u53ef\u4ee5\u4ece\u538b\u7f29\u65e5\u5fd7\u4e3b\u9898\u7684\u96f6\u504f\u79fb\u91cf\u5904\u542f\u52a8\u65b0\u7684\u6d88\u8d39\u8005\uff0c\u7136\u540e\u4f9d\u6b21\u626b\u63cf\u65e5\u5fd7\u4e2d\u7684\u6240\u6709\u6d88\u606f\u3002\u65e5\u5fd7\u80fd\u4fdd\u8bc1\u5305\u542b\u6570\u636e\u5e93\u4e2d\u6bcf\u4e2a\u952e\u7684\u6700\u65b0\u503c\uff08\u4e5f\u53ef\u80fd\u662f\u4e00\u4e9b\u8f83\u65e7\u7684\u503c\uff09\u2014\u2014 \u6362\u53e5\u8bdd\u8bf4\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u83b7\u53d6\u6570\u636e\u5e93\u5185\u5bb9\u7684\u5b8c\u6574\u526f\u672c\uff0c\u800c\u65e0\u9700\u4ece CDC \u6e90\u6570\u636e\u5e93\u53d6\u4e00\u4e2a\u5feb\u7167\u3002</p> <p>Apache Kafka \u652f\u6301\u8fd9\u79cd\u65e5\u5fd7\u538b\u7f29\u529f\u80fd\u3002\u5141\u8bb8\u6d88\u606f\u4ee3\u7406\u88ab\u5f53\u6210\u6301\u4e45\u6027\u5b58\u50a8\u4f7f\u7528\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u7528\u4e8e\u4e34\u65f6\u6d88\u606f\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#api","title":"\u53d8\u66f4\u6d41\u7684API\u652f\u6301","text":"<p>\u8d8a\u6765\u8d8a\u591a\u7684\u6570\u636e\u5e93\u5f00\u59cb\u5c06\u53d8\u66f4\u6d41\u4f5c\u4e3a\u7b2c\u4e00\u7b49\u7684\u63a5\u53e3\u3002\u4f8b\u5982\uff0cRethinkDB \u5141\u8bb8\u67e5\u8be2\u8ba2\u9605\u901a\u77e5\uff0c\u5f53\u67e5\u8be2\u7ed3\u679c\u53d8\u66f4\u65f6\u83b7\u5f97\u901a\u77e5\u301036\u3011\uff0cFirebase \u301037\u3011\u548c CouchDB \u301038\u3011\u57fa\u4e8e\u53d8\u66f4\u6d41\u8fdb\u884c\u540c\u6b65\uff0c\u8be5\u53d8\u66f4\u6d41\u540c\u6837\u53ef\u7528\u4e8e\u5e94\u7528\u3002\u800c Meteor \u4f7f\u7528 MongoDB oplog \u8ba2\u9605\u6570\u636e\u53d8\u66f4\uff0c\u5e76\u6539\u53d8\u4e86\u7528\u6237\u63a5\u53e3\u301039\u3011\u3002</p> <p>VoltDB \u5141\u8bb8\u4e8b\u52a1\u4ee5\u6d41\u7684\u5f62\u5f0f\u8fde\u7eed\u5730\u4ece\u6570\u636e\u5e93\u4e2d\u5bfc\u51fa\u6570\u636e\u301040\u3011</p> <p>Kafka Connect\u301041\u3011\u81f4\u529b\u4e8e\u5c06\u5e7f\u6cdb\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u7684\u53d8\u66f4\u6570\u636e\u6355\u83b7\u5de5\u5177\u4e0e Kafka \u96c6\u6210\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_22","title":"\u4e8b\u4ef6\u6eaf\u6e90","text":"<p>\u4e0e\u53d8\u66f4\u6570\u636e\u6355\u83b7\u7c7b\u4f3c\uff0c\u4e8b\u4ef6\u6eaf\u6e90\u6d89\u53ca\u5230 \u5c06\u6240\u6709\u5bf9\u5e94\u7528\u72b6\u6001\u7684\u53d8\u66f4 \u5b58\u50a8\u4e3a\u53d8\u66f4\u4e8b\u4ef6\u65e5\u5fd7\u3002\u6700\u5927\u7684\u533a\u522b\u662f\u4e8b\u4ef6\u6eaf\u6e90\u5c06\u8fd9\u4e00\u60f3\u6cd5\u5e94\u7528\u5230\u4e86\u4e00\u4e2a\u4e0d\u540c\u7684\u62bd\u8c61\u5c42\u6b21\u4e0a\uff1a</p> <ul> <li>\u5728\u53d8\u66f4\u6570\u636e\u6355\u83b7\u4e2d\uff0c\u5e94\u7528\u4ee5 \u53ef\u53d8\u65b9\u5f0f\uff08mutable way\uff09 \u4f7f\u7528\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u4efb\u610f\u66f4\u65b0\u548c\u5220\u9664\u8bb0\u5f55\u3002\u5199\u5165\u6570\u636e\u5e93\u7684\u5e94\u7528\u4e0d\u9700\u8981\u77e5\u9053 CDC \u7684\u5b58\u5728\u3002</li> <li>\u5728\u4e8b\u4ef6\u6eaf\u6e90\u4e2d\uff0c\u5e94\u7528\u903b\u8f91\u663e\u5f0f\u6784\u5efa\u5728\u5199\u5165\u4e8b\u4ef6\u65e5\u5fd7\u7684\u4e0d\u53ef\u53d8\u4e8b\u4ef6\u4e4b\u4e0a\u3002\u4e8b\u4ef6\u5b58\u50a8\u662f\u4ec5\u8ffd\u52a0\u5199\u5165\u7684\uff0c\u66f4\u65b0\u4e0e\u5220\u9664\u662f\u4e0d\u9f13\u52b1\u7684\u6216\u7981\u6b62\u7684\u3002\u4e8b\u4ef6\u88ab\u8bbe\u8ba1\u4e3a\u65e8\u5728\u53cd\u6620\u5e94\u7528\u5c42\u9762\u53d1\u751f\u7684\u4e8b\u60c5\uff0c\u800c\u4e0d\u662f\u5e95\u5c42\u7684\u72b6\u6001\u53d8\u66f4\u3002</li> </ul> <p>\u4e8b\u4ef6\u6eaf\u6e90\u662f\u4e00\u79cd\u5f3a\u5927\u7684\u6570\u636e\u5efa\u6a21\u6280\u672f\uff1a\u4ece\u5e94\u7528\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u5c06\u7528\u6237\u7684\u884c\u4e3a\u8bb0\u5f55\u4e3a\u4e0d\u53ef\u53d8\u7684\u4e8b\u4ef6\u66f4\u6709\u610f\u4e49\uff0c\u800c\u4e0d\u662f\u5728\u53ef\u53d8\u6570\u636e\u5e93\u4e2d\u8bb0\u5f55\u8fd9\u4e9b\u884c\u4e3a\u7684\u5f71\u54cd\u3002\u4e8b\u4ef6\u6eaf\u6e90\u4f7f\u5f97\u5e94\u7528\u968f\u65f6\u95f4\u6f14\u5316\u66f4\u4e3a\u5bb9\u6613\uff0c\u901a\u8fc7\u66f4\u5bb9\u6613\u7406\u89e3\u4e8b\u60c5\u53d1\u751f\u7684\u539f\u56e0\u6765\u5e2e\u52a9\u8c03\u8bd5\u7684\u8fdb\u884c\uff0c\u5e76\u6709\u5229\u4e8e\u9632\u6b62\u5e94\u7528 Bug\u3002</p> <p>\u4e8b\u4ef6\u6eaf\u6e90\u65b9\u6cd5\u5141\u8bb8\u5c06\u65b0\u7684\u526f\u4f5c\u7528\u8f7b\u677e\u5730\u4ece\u73b0\u6709\u4e8b\u4ef6\u4e2d\u8131\u5f00\u3002</p> <ul> <li> <p>\u4f8b\u5982\uff0c\u5b58\u50a8 \u201c\u5b66\u751f\u53d6\u6d88\u9009\u8bfe\u201d \u4e8b\u4ef6\u4ee5\u4e2d\u6027\u7684\u65b9\u5f0f\u6e05\u695a\u5730\u8868\u8fbe\u4e86\u5355\u4e2a\u884c\u4e3a\u7684\u610f\u56fe\uff0c\u800c\u5176\u526f\u4f5c\u7528 \u201c\u4ece\u767b\u8bb0\u8868\u4e2d\u5220\u9664\u4e86\u4e00\u4e2a\u6761\u76ee\uff0c\u800c\u4e00\u6761\u53d6\u6d88\u539f\u56e0\u7684\u8bb0\u5f55\u88ab\u6dfb\u52a0\u5230\u5b66\u751f\u53cd\u9988\u8868\u201d \u5219\u5d4c\u5165\u4e86\u5f88\u591a\u6709\u5173\u7a0d\u540e\u5bf9\u6570\u636e\u7684\u4f7f\u7528\u65b9\u5f0f\u7684\u5047\u8bbe\u3002</p> </li> <li> <p>\u5982\u679c\u5f15\u5165\u4e00\u4e2a\u65b0\u7684\u5e94\u7528\u529f\u80fd\uff0c\u4f8b\u5982 \u201c\u5c06\u4f4d\u7f6e\u7559\u7ed9\u7b49\u5f85\u5217\u8868\u4e2d\u7684\u4e0b\u4e00\u4e2a\u4eba\u201d\uff0c\u5219\u8fbe\u5230\u89e3\u5f00\u7684\u76ee\u7684\uff1b</p> </li> </ul> <p>\u4e8b\u4ef6\u6eaf\u6e90\u7c7b\u4f3c\u4e8e \u7f16\u5e74\u53f2\uff08chronicle\uff09 \u6570\u636e\u6a21\u578b\u301045\u3011\uff0c\u8bf8\u5982 Event Store\u301046\u3011\u8fd9\u6837\u7684\u4e13\u4e1a\u6570\u636e\u5e93\u5df2\u7ecf\u88ab\u5f00\u53d1\u51fa\u6765\uff0c\u4f9b\u4f7f\u7528\u4e8b\u4ef6\u6eaf\u6e90\u7684\u5e94\u7528\u4f7f\u7528\uff0c\u8fd9\u79cd\u65b9\u6cd5\u72ec\u7acb\u4e8e\u4efb\u4f55\u7279\u5b9a\u7684\u5de5\u5177\u3002\u4f20\u7edf\u7684\u6570\u636e\u5e93\u6216\u57fa\u4e8e\u65e5\u5fd7\u7684\u6d88\u606f\u4ee3\u7406\u4e5f\u53ef\u4ee5\u7528\u6765\u6784\u5efa\u8fd9\u79cd\u98ce\u683c\u7684\u5e94\u7528\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_23","title":"\u4ece\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u6d3e\u751f\u51fa\u5f53\u524d\u72b6\u6001","text":"<p>\u4e8b\u4ef6\u65e5\u5fd7\u672c\u8eab\u5e76\u4e0d\u662f\u5f88\u6709\u7528\uff0c\u56e0\u4e3a\u7528\u6237\u901a\u5e38\u671f\u671b\u770b\u5230\u7684\u662f\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\uff0c\u800c\u4e0d\u662f\u53d8\u66f4\u5386\u53f2\u3002</p> <p>\u7528\u4e8b\u4ef6\u6eaf\u6e90\u7684\u5e94\u7528\u9700\u8981\u62c9\u53d6\u4e8b\u4ef6\u65e5\u5fd7\uff08\u8868\u793a \u5199\u5165 \u7cfb\u7edf\u7684\u6570\u636e\uff09\uff0c\u5e76\u5c06\u5176\u8f6c\u6362\u4e3a\u9002\u5408\u5411\u7528\u6237\u663e\u793a\u7684\u5e94\u7528\u72b6\u6001\uff08\u4ece\u7cfb\u7edf \u8bfb\u53d6 \u6570\u636e\u7684\u65b9\u5f0f\u301047\u3011\uff09\u3002</p> <ul> <li>\u8f6c\u6362\u53ef\u4ee5\u4f7f\u7528\u4efb\u610f\u903b\u8f91\uff0c\u4f46\u5b83\u5e94\u5f53\u662f\u786e\u5b9a\u6027\u7684\uff0c\u4ee5\u4fbf\u80fd\u518d\u6b21\u8fd0\u884c\uff0c\u5e76\u4ece\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u884d\u751f\u51fa\u76f8\u540c\u7684\u5e94\u7528\u72b6\u6001\u3002</li> </ul> <p>\u4e0e\u53d8\u66f4\u6570\u636e\u6355\u83b7\u4e00\u6837\uff0c\u91cd\u64ad\u4e8b\u4ef6\u65e5\u5fd7\u5141\u8bb8\u8ba9\u4f60\u91cd\u65b0\u6784\u5efa\u7cfb\u7edf\u7684\u5f53\u524d\u72b6\u6001\u3002\u4e0d\u8fc7\uff0c\u65e5\u5fd7\u538b\u7f29\u9700\u8981\u91c7\u7528\u4e0d\u540c\u7684\u65b9\u5f0f\u5904\u7406\uff1a</p> <ul> <li>\u7528\u4e8e\u8bb0\u5f55\u66f4\u65b0\u7684 CDC \u4e8b\u4ef6\u901a\u5e38\u5305\u542b\u8bb0\u5f55\u7684 \u5b8c\u6574\u65b0\u7248\u672c\uff0c\u56e0\u6b64\u4e3b\u952e\u7684\u5f53\u524d\u503c\u5b8c\u5168\u7531\u8be5\u4e3b\u952e\u7684\u6700\u8fd1\u4e8b\u4ef6\u786e\u5b9a\uff0c\u800c\u65e5\u5fd7\u538b\u7f29\u53ef\u4ee5\u4e22\u5f03\u76f8\u540c\u4e3b\u952e\u7684\u5148\u524d\u4e8b\u4ef6\u3002</li> <li>\u4e8b\u4ef6\u6eaf\u6e90\u5728\u66f4\u9ad8\u5c42\u6b21\u8fdb\u884c\u5efa\u6a21\uff1a\u4e8b\u4ef6\u901a\u5e38\u8868\u793a\u7528\u6237\u64cd\u4f5c\u7684\u610f\u56fe\uff0c\u800c\u4e0d\u662f\u56e0\u4e3a\u64cd\u4f5c\u800c\u53d1\u751f\u7684\u72b6\u6001\u66f4\u65b0\u673a\u5236\u3002\u540e\u9762\u7684\u4e8b\u4ef6\u901a\u5e38\u4e0d\u4f1a\u8986\u76d6\u5148\u524d\u7684\u4e8b\u4ef6\uff0c\u6240\u4ee5\u4f60\u9700\u8981\u5b8c\u6574\u7684\u5386\u53f2\u4e8b\u4ef6\u6765\u91cd\u65b0\u6784\u5efa\u6700\u7ec8\u72b6\u6001\u3002\u8fd9\u91cc\u8fdb\u884c\u540c\u6837\u7684\u65e5\u5fd7\u538b\u7f29\u662f\u4e0d\u53ef\u80fd\u7684\u3002</li> </ul> <p>\u4f7f\u7528\u4e8b\u4ef6\u6eaf\u6e90\u7684\u5e94\u7528\u901a\u5e38\u6709\u4e00\u4e9b\u673a\u5236\uff0c\u7528\u4e8e\u5b58\u50a8\u4ece\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u5bfc\u51fa\u7684\u5f53\u524d\u72b6\u6001\u5feb\u7167\uff0c\u56e0\u6b64\u5b83\u4eec\u4e0d\u9700\u8981\u91cd\u590d\u5904\u7406\u5b8c\u6574\u7684\u65e5\u5fd7\u3002</p> <ul> <li>\u8fd9\u53ea\u662f\u4e00\u79cd\u6027\u80fd\u4f18\u5316\uff0c\u7528\u6765\u52a0\u901f\u8bfb\u53d6\uff0c\u63d0\u9ad8\u4ece\u5d29\u6e83\u4e2d\u6062\u590d\u7684\u901f\u5ea6\uff1b</li> <li>\u771f\u6b63\u7684\u76ee\u7684\u662f\u7cfb\u7edf\u80fd\u591f\u6c38\u4e45\u5b58\u50a8\u6240\u6709\u539f\u59cb\u4e8b\u4ef6\uff0c\u5e76\u5728\u9700\u8981\u65f6\u91cd\u65b0\u5904\u7406\u5b8c\u6574\u7684\u4e8b\u4ef6\u65e5\u5fd7\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_24","title":"\u547d\u4ee4\u548c\u4e8b\u4ef6","text":"<p>\u4e8b\u4ef6\u6eaf\u6e90\u7684\u54f2\u5b66\u662f\u4ed4\u7ec6\u533a\u5206 \u4e8b\u4ef6\uff08event\uff09 \u548c \u547d\u4ee4\uff08command\uff09\u301048\u3011\u3002</p> <ul> <li>\u5f53\u6765\u81ea\u7528\u6237\u7684\u8bf7\u6c42\u521a\u5230\u8fbe\u65f6\u5b83\u4e00\u5f00\u59cb\u662f\u4e00\u4e2a\u547d\u4ee4\uff1a\u5728\u8fd9\u4e2a\u65f6\u95f4\u70b9\u4e0a\u5b83\u4ecd\u7136\u53ef\u80fd\u5931\u8d25\uff0c\u6bd4\u5982\uff0c\u56e0\u4e3a\u8fdd\u53cd\u4e86\u4e00\u4e9b\u5b8c\u6574\u6027\u6761\u4ef6\u3002</li> <li>\u5982\u679c\u9a8c\u8bc1\u6210\u529f\u5e76\u4e14\u547d\u4ee4\u88ab\u63a5\u53d7\uff0c\u5219\u5b83\u53d8\u4e3a\u4e00\u4e2a\u6301\u4e45\u5316\u4e14\u4e0d\u53ef\u53d8\u7684\u4e8b\u4ef6\u3002</li> </ul> <p>\u5728\u4e8b\u4ef6\u751f\u6210\u7684\u65f6\u523b\uff0c\u5b83\u5c31\u6210\u4e3a\u4e86 \u4e8b\u5b9e\uff08fact\uff09\u3002\u5373\u4f7f\u5ba2\u6237\u7a0d\u540e\u51b3\u5b9a\u66f4\u6539\u6216\u53d6\u6d88\u9884\u8ba2\uff0c\u4ed6\u4eec\u4e4b\u524d\u66fe\u9884\u5b9a\u4e86\u67d0\u4e2a\u7279\u5b9a\u5ea7\u4f4d\u7684\u4e8b\u5b9e\u4ecd\u7136\u6210\u7acb\uff0c\u800c\u66f4\u6539\u6216\u53d6\u6d88\u662f\u4e4b\u540e\u6dfb\u52a0\u7684\u5355\u72ec\u7684\u4e8b\u4ef6\u3002</p> <ul> <li>\u4f8b\u5982\uff0c\u5982\u679c\u7528\u6237\u8bd5\u56fe\u6ce8\u518c\u7279\u5b9a\u7528\u6237\u540d\uff0c\u6216\u9884\u5b9a\u98de\u673a\u6216\u5267\u9662\u7684\u5ea7\u4f4d\uff0c\u5219\u5e94\u7528\u9700\u8981\u68c0\u67e5\u7528\u6237\u540d\u6216\u5ea7\u4f4d\u662f\u5426\u5df2\u88ab\u5360\u7528\u3002\u5f53\u68c0\u67e5\u6210\u529f\u65f6\uff0c\u5e94\u7528\u53ef\u4ee5\u751f\u6210\u4e00\u4e2a\u4e8b\u4ef6\uff0c\u6307\u793a\u7279\u5b9a\u7684\u7528\u6237\u540d\u662f\u7531\u7279\u5b9a\u7684\u7528\u6237 ID \u6ce8\u518c\u7684\uff0c\u6216\u8005\u5ea7\u4f4d\u5df2\u7ecf\u9884\u7559\u7ed9\u7279\u5b9a\u7684\u987e\u5ba2\u3002</li> </ul> <p>\u4e8b\u4ef6\u6d41\u7684\u6d88\u8d39\u8005\u4e0d\u5141\u8bb8\u62d2\u7edd\u4e8b\u4ef6\uff1a\u5f53\u6d88\u8d39\u8005\u770b\u5230\u4e8b\u4ef6\u65f6\uff0c\u5b83\u5df2\u7ecf\u6210\u4e3a\u65e5\u5fd7\u4e2d\u4e0d\u53ef\u53d8\u7684\u4e00\u90e8\u5206\uff0c\u5e76\u4e14\u53ef\u80fd\u5df2\u7ecf\u88ab\u5176\u4ed6\u6d88\u8d39\u8005\u770b\u5230\u4e86\u3002\u56e0\u6b64\u4efb\u4f55\u5bf9\u547d\u4ee4\u7684\u9a8c\u8bc1\uff0c\u90fd\u9700\u8981\u5728\u5b83\u6210\u4e3a\u4e8b\u4ef6\u4e4b\u524d\u540c\u6b65\u5b8c\u6210\u3002</p> <ul> <li>\u6216\u8005\uff0c\u9884\u8ba2\u5ea7\u4f4d\u7684\u7528\u6237\u8bf7\u6c42\u53ef\u4ee5\u62c6\u5206\u4e3a\u4e24\u4e2a\u4e8b\u4ef6\uff1a\u7b2c\u4e00\u4e2a\u662f\u6682\u65f6\u9884\u7ea6\uff0c\u7b2c\u4e8c\u4e2a\u662f\u9a8c\u8bc1\u9884\u7ea6\u540e\u7684\u72ec\u7acb\u7684\u786e\u8ba4\u4e8b\u4ef6 \u3002\u8fd9\u79cd\u5206\u5272\u65b9\u5f0f\u5141\u8bb8\u9a8c\u8bc1\u53d1\u751f\u5728\u4e00\u4e2a\u5f02\u6b65\u7684\u8fc7\u7a0b\u4e2d\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_25","title":"\u72b6\u6001\u3001\u6d41\u548c\u4e0d\u53d8\u6027","text":"<p>\u4e0d\u53d8\u6027\u539f\u5219\u4e5f\u662f\u4f7f\u5f97\u4e8b\u4ef6\u6eaf\u6e90\u4e0e\u53d8\u66f4\u6570\u636e\u6355\u83b7\u5982\u6b64\u5f3a\u5927\u7684\u539f\u56e0\u3002</p> <p>\u72b6\u6001\u7684\u672c\u8d28\u662f\uff0c\u5b83\u4f1a\u53d8\u5316\uff0c\u6240\u4ee5\u6570\u636e\u5e93\u624d\u4f1a\u652f\u6301\u6570\u636e\u7684\u589e\u5220\u6539\u3002\u8fd9\u53c8\u8be5\u5982\u4f55\u5339\u914d\u4e0d\u53d8\u6027\u5462\uff1f</p> <ul> <li>\u53ea\u8981\u4f60\u7684\u72b6\u6001\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u90a3\u4e48\u8fd9\u4e2a\u72b6\u6001\u5c31\u662f\u8fd9\u6bb5\u65f6\u95f4\u4e2d\u4e8b\u4ef6\u4fee\u6539\u7684\u7ed3\u679c\u3002</li> </ul> <p>\u65e0\u8bba\u72b6\u6001\u5982\u4f55\u53d8\u5316\uff0c\u603b\u662f\u6709\u4e00\u7cfb\u5217\u4e8b\u4ef6\u5bfc\u81f4\u4e86\u8fd9\u4e9b\u53d8\u5316\u3002</p> <ul> <li>\u5373\u4f7f\u4e8b\u60c5\u5df2\u7ecf\u6267\u884c\u4e0e\u56de\u6eda\uff0c\u8fd9\u4e9b\u4e8b\u4ef6\u51fa\u73b0\u662f\u59cb\u7ec8\u6210\u7acb\u7684\u3002</li> </ul> <p>\u53ef\u53d8\u7684\u72b6\u6001\u4e0e\u4e0d\u53ef\u53d8\u4e8b\u4ef6\u7684\u4ec5\u8ffd\u52a0\u65e5\u5fd7\u76f8\u4e92\u4e4b\u95f4\u5e76\u4e0d\u77db\u76fe\uff1a\u5b83\u4eec\u662f\u4e00\u4f53\u4e24\u9762\uff0c\u4e92\u4e3a\u9634\u9633\u7684\u3002\u6240\u6709\u53d8\u5316\u7684\u65e5\u5fd7 \u2014\u2014 \u53d8\u5316\u65e5\u5fd7\uff08changelog\uff09\uff0c\u8868\u793a\u4e86\u968f\u65f6\u95f4\u6f14\u53d8\u7684\u72b6\u6001\u3002</p> <p>\u5982\u679c\u4f60\u503e\u5411\u4e8e\u6570\u5b66\u8868\u793a\uff0c\u90a3\u4e48\u4f60\u53ef\u80fd\u4f1a\u8bf4\uff0c\u5e94\u7528\u72b6\u6001\u662f\u4e8b\u4ef6\u6d41\u5bf9\u65f6\u95f4\u6c42\u79ef\u5206\u5f97\u5230\u7684\u7ed3\u679c\uff0c\u800c\u53d8\u66f4\u6d41\u662f\u72b6\u6001\u5bf9\u65f6\u95f4\u6c42\u5fae\u5206\u7684\u7ed3\u679c\uff0c\u5982 \u56fe 11-6 \u6240\u793a\u301049,50,51\u3011\u3002</p> <ul> <li>\u8fd9\u4e2a\u6bd4\u55bb\u6709\u4e00\u4e9b\u5c40\u9650\u6027\uff08\u4f8b\u5982\uff0c\u72b6\u6001\u7684\u4e8c\u9636\u5bfc\u4f3c\u4e4e\u6ca1\u6709\u610f\u4e49\uff09\uff0c\u4f46\u8fd9\u662f\u8003\u8651\u6570\u636e\u7684\u4e00\u4e2a\u5b9e\u7528\u51fa\u53d1\u70b9\u3002</li> </ul> <p></p> \u56fe 11-6 \u5e94\u7528\u5f53\u524d\u72b6\u6001\u4e0e\u4e8b\u4ef6\u6d41\u4e4b\u95f4\u7684\u5173\u7cfb <p>\u6b63\u5982\u5e15\u7279\u30fb\u8d6b\u5170\uff08Pat Helland\uff09\u6240\u8bf4\u7684\u301052\u3011\uff1a</p> <p>\u4e8b\u52a1\u65e5\u5fd7\u8bb0\u5f55\u4e86\u6570\u636e\u5e93\u7684\u6240\u6709\u53d8\u66f4\u3002\u9ad8\u901f\u8ffd\u52a0\u662f\u66f4\u6539\u65e5\u5fd7\u7684\u552f\u4e00\u65b9\u6cd5\u3002\u4ece\u8fd9\u4e2a\u89d2\u5ea6\u6765\u770b\uff0c\u6570\u636e\u5e93\u7684\u5185\u5bb9\u5176\u5b9e\u662f\u65e5\u5fd7\u4e2d\u8bb0\u5f55\u6700\u65b0\u503c\u7684\u7f13\u5b58\u3002\u65e5\u5fd7\u624d\u662f\u771f\u76f8\uff0c\u6570\u636e\u5e93\u662f\u65e5\u5fd7\u5b50\u96c6\u7684\u7f13\u5b58\uff0c\u8fd9\u4e00\u7f13\u5b58\u5b50\u96c6\u6070\u597d\u6765\u81ea\u65e5\u5fd7\u4e2d\u6bcf\u6761\u8bb0\u5f55\u4e0e\u7d22\u5f15\u503c\u7684\u6700\u65b0\u503c\u3002</p> <p>\u65e5\u5fd7\u538b\u7f29\u662f\u8fde\u63a5\u65e5\u5fd7\u4e0e\u6570\u636e\u5e93\u72b6\u6001\u4e4b\u95f4\u7684\u6865\u6881\uff1a\u5b83\u53ea\u4fdd\u7559\u6bcf\u6761\u8bb0\u5f55\u7684\u6700\u65b0\u7248\u672c\uff0c\u5e76\u4e22\u5f03\u88ab\u8986\u76d6\u7684\u7248\u672c\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_26","title":"\u4e0d\u53ef\u53d8\u4e8b\u4ef6\u7684\u4f18\u70b9","text":"<p>\u6570\u636e\u5e93\u4e2d\u7684\u4e0d\u53d8\u6027\u662f\u4e00\u4e2a\u53e4\u8001\u7684\u6982\u5ff5\u3002\u4f8b\u5982\uff0c\u4f1a\u8ba1\u5728\u51e0\u4e2a\u4e16\u7eaa\u4ee5\u6765\u4e00\u76f4\u5728\u8d22\u52a1\u8bb0\u8d26\u4e2d\u5e94\u7528\u4e0d\u53d8\u6027\u3002</p> <ul> <li>\u4e00\u7b14\u4ea4\u6613\u53d1\u751f\u65f6\uff0c\u5b83\u88ab\u8bb0\u5f55\u5728\u4e00\u4e2a\u4ec5\u8ffd\u52a0\u5199\u5165\u7684\u5206\u7c7b\u5e10\u4e2d\uff0c\u5b9e\u8d28\u4e0a\u662f\u63cf\u8ff0\u8d27\u5e01\u3001\u5546\u54c1\u6216\u670d\u52a1\u8f6c\u624b\u7684\u4e8b\u4ef6\u65e5\u5fd7\u3002</li> <li>\u8d26\u76ee\uff0c\u6bd4\u5982\u5229\u6da6\u3001\u4e8f\u635f\u3001\u8d44\u4ea7\u8d1f\u503a\u8868\uff0c\u662f\u4ece\u5206\u7c7b\u8d26\u4e2d\u7684\u4ea4\u6613\u6c42\u548c\u884d\u751f\u800c\u6765\u301053\u3011\u3002</li> </ul> <p>\u5982\u679c\u53d1\u751f\u9519\u8bef\uff0c\u4f1a\u8ba1\u5e08\u4e0d\u4f1a\u5220\u9664\u6216\u66f4\u6539\u5206\u7c7b\u5e10\u4e2d\u7684\u9519\u8bef\u4ea4\u6613 \u2014\u2014 \u800c\u662f\u6dfb\u52a0\u53e6\u4e00\u7b14\u4ea4\u6613\u4ee5\u8865\u507f\u9519\u8bef\uff0c\u4f8b\u5982\u9000\u8fd8\u4e00\u7b14\u4e0d\u6b63\u786e\u7684\u8d39\u7528\u3002</p> <ul> <li>\u4e0d\u6b63\u786e\u7684\u4ea4\u6613\u5c06\u6c38\u8fdc\u4fdd\u7559\u5728\u5206\u7c7b\u5e10\u4e2d\uff0c\u5bf9\u4e8e\u5ba1\u8ba1\u800c\u8a00\u53ef\u80fd\u975e\u5e38\u91cd\u8981\u3002</li> <li>\u5982\u679c\u4ece\u4e0d\u6b63\u786e\u7684\u5206\u7c7b\u8d26\u884d\u751f\u51fa\u7684\u9519\u8bef\u6570\u5b57\u5df2\u7ecf\u516c\u5e03\uff0c\u90a3\u4e48\u4e0b\u4e00\u4e2a\u4f1a\u8ba1\u5468\u671f\u7684\u6570\u5b57\u5c31\u4f1a\u5305\u62ec\u4e00\u4e2a\u66f4\u6b63\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u5728\u4f1a\u8ba1\u4e8b\u52a1\u4e2d\u662f\u5f88\u5e38\u89c1\u7684\u301054\u3011\u3002</li> </ul> <p>\u4e0d\u53ef\u53d8\u7684\u4e8b\u4ef6\u4e5f\u5305\u542b\u4e86\u6bd4\u5f53\u524d\u72b6\u6001\u66f4\u591a\u7684\u4fe1\u606f\u3002\u4f8b\u5982\u5728\u8d2d\u7269\u7f51\u7ad9\u4e0a\uff0c\u987e\u5ba2\u53ef\u4ee5\u5c06\u7269\u54c1\u6dfb\u52a0\u5230\u4ed6\u4eec\u7684\u8d2d\u7269\u8f66\uff0c\u7136\u540e\u518d\u5c06\u5176\u79fb\u9664\u3002\u867d\u7136\u4ece\u5c65\u884c\u8ba2\u5355\u7684\u89d2\u5ea6\uff0c\u7b2c\u4e8c\u4e2a\u4e8b\u4ef6\u53d6\u6d88\u4e86\u7b2c\u4e00\u4e2a\u4e8b\u4ef6\uff0c\u4f46\u5bf9\u5206\u6790\u76ee\u7684\u800c\u8a00\uff0c\u77e5\u9053\u5ba2\u6237\u8003\u8651\u8fc7\u67d0\u4e2a\u7279\u5b9a\u9879\u800c\u4e4b\u540e\u53c8\u53cd\u6094\uff0c\u53ef\u80fd\u662f\u5f88\u6709\u7528\u7684\u3002\u4e5f\u8bb8\u4ed6\u4eec\u4f1a\u9009\u62e9\u5728\u672a\u6765\u8d2d\u4e70\uff0c\u6216\u8005\u4ed6\u4eec\u5df2\u7ecf\u627e\u5230\u4e86\u66ff\u4ee3\u54c1\u3002\u8fd9\u4e2a\u4fe1\u606f\u88ab\u8bb0\u5f55\u5728\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\uff0c\u4f46\u5bf9\u4e8e\u79fb\u51fa\u8d2d\u7269\u8f66\u5c31\u5220\u9664\u8bb0\u5f55\u7684\u6570\u636e\u5e93\u800c\u8a00\uff0c\u8fd9\u4e2a\u4fe1\u606f\u5728\u79fb\u51fa\u8d2d\u7269\u8f66\u65f6\u53ef\u80fd\u5c31\u4e22\u5931\u4e86\u301042\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_27","title":"\u4ece\u540c\u4e00\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u6d3e\u751f\u591a\u4e2a\u89c6\u56fe","text":"<p>\u901a\u8fc7\u4ece\u4e0d\u53d8\u7684\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u5206\u79bb\u51fa\u53ef\u53d8\u7684\u72b6\u6001\uff0c\u4f60\u53ef\u4ee5\u9488\u5bf9\u4e0d\u540c\u7684\u8bfb\u53d6\u65b9\u5f0f\uff0c\u4ece\u76f8\u540c\u7684\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u884d\u751f\u51fa\u51e0\u79cd\u4e0d\u540c\u7684\u8868\u73b0\u5f62\u5f0f\u3002\u6548\u679c\u5c31\u50cf\u4e00\u4e2a\u6d41\u7684\u591a\u4e2a\u6d88\u8d39\u8005\u4e00\u6837\uff08\u56fe11-5\uff09\uff1a</p> <ul> <li>\u5206\u6790\u578b\u6570\u636e\u5e93 Druid \u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u76f4\u63a5\u4ece Kafka \u6444\u53d6\u6570\u636e\u301055\u3011\uff0cPistachio \u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u7684\u952e\u503c\u5b58\u50a8\uff0c\u4f7f\u7528 Kafka \u4f5c\u4e3a\u63d0\u4ea4\u65e5\u5fd7\u301056\u3011\uff0cKafka Connect \u80fd\u5c06\u6765\u81ea Kafka \u7684\u6570\u636e\u5bfc\u51fa\u5230\u5404\u79cd\u4e0d\u540c\u7684\u6570\u636e\u5e93\u4e0e\u7d22\u5f15\u301041\u3011\u3002</li> </ul> <p>\u6dfb\u52a0\u4ece\u4e8b\u4ef6\u65e5\u5fd7\u5230\u6570\u636e\u5e93\u7684\u663e\u5f0f\u8f6c\u6362\uff0c\u80fd\u591f\u4f7f\u5e94\u7528\u66f4\u5bb9\u6613\u5730\u968f\u65f6\u95f4\u6f14\u8fdb\uff1a\u5982\u679c\u4f60\u60f3\u8981\u5f15\u5165\u4e00\u4e2a\u65b0\u529f\u80fd\uff0c\u4ee5\u65b0\u7684\u65b9\u5f0f\u8868\u793a\u73b0\u6709\u6570\u636e\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u4e8b\u4ef6\u65e5\u5fd7\u6765\u6784\u5efa\u4e00\u4e2a\u5355\u72ec\u7684\u3001\u9488\u5bf9\u65b0\u529f\u80fd\u7684\u8bfb\u53d6\u4f18\u5316\u89c6\u56fe\uff0c\u65e0\u9700\u4fee\u6539\u73b0\u6709\u7cfb\u7edf\u800c\u4e0e\u4e4b\u5171\u5b58\u3002</p> <ul> <li>\u5e76\u884c\u8fd0\u884c\u65b0\u65e7\u7cfb\u7edf\u901a\u5e38\u6bd4\u5728\u73b0\u6709\u7cfb\u7edf\u4e2d\u6267\u884c\u590d\u6742\u7684\u6a21\u5f0f\u8fc1\u79fb\u66f4\u5bb9\u6613\u3002\u4e00\u65e6\u4e0d\u518d\u9700\u8981\u65e7\u7684\u7cfb\u7edf\uff0c\u4f60\u53ef\u4ee5\u7b80\u5355\u5730\u5173\u95ed\u5b83\u5e76\u56de\u6536\u5176\u8d44\u6e90\u301047,57\u3011\u3002</li> </ul> <p>\u6a21\u5f0f\u8bbe\u8ba1\u3001\u7d22\u5f15\u548c\u5b58\u50a8\u5f15\u64ce\u7684\u8bb8\u591a\u590d\u6742\u6027\uff0c\u90fd\u662f\u5e0c\u671b\u652f\u6301\u67d0\u4e9b\u7279\u5b9a\u67e5\u8be2\u548c\u8bbf\u95ee\u6a21\u5f0f\u7684\u7ed3\u679c\u3002\u901a\u8fc7\u5c06\u6570\u636e\u5199\u5165\u7684\u5f62\u5f0f\u4e0e\u8bfb\u53d6\u5f62\u5f0f\u76f8\u5206\u79bb\uff0c\u5e76\u5141\u8bb8\u51e0\u4e2a\u4e0d\u540c\u7684\u8bfb\u53d6\u89c6\u56fe\uff0c\u4f60\u80fd\u83b7\u5f97\u5f88\u5927\u7684\u7075\u6d3b\u6027\u3002\u8fd9\u4e2a\u60f3\u6cd5\u6709\u65f6\u88ab\u79f0\u4e3a \u547d\u4ee4\u67e5\u8be2\u8d23\u4efb\u5206\u79bb\uff08command query responsibility segregation, CQRS\uff09\u301042,58,59\u3011\u3002</p> <p>\u6570\u636e\u5e93\u548c\u6a21\u5f0f\u8bbe\u8ba1\u7684\u4f20\u7edf\u65b9\u6cd5\u662f\u57fa\u4e8e\u8fd9\u6837\u4e00\u79cd\u8c2c\u8bba\uff0c\u6570\u636e\u5fc5\u987b\u4ee5\u4e0e\u67e5\u8be2\u76f8\u540c\u7684\u5f62\u5f0f\u5199\u5165\u3002</p> <ul> <li>\u5982\u679c\u53ef\u4ee5\u5c06\u6570\u636e\u4ece\u9488\u5bf9\u5199\u5165\u4f18\u5316\u7684\u4e8b\u4ef6\u65e5\u5fd7\u8f6c\u6362\u4e3a\u9488\u5bf9\u8bfb\u53d6\u4f18\u5316\u7684\u5e94\u7528\u72b6\u6001\uff0c\u90a3\u4e48\u6709\u5173\u89c4\u8303\u5316\u548c\u975e\u89c4\u8303\u5316\u7684\u4e89\u8bba\u5c31\u53d8\u5f97\u65e0\u5173\u7d27\u8981\u4e86\u3002</li> <li>\u5728\u9488\u5bf9\u8bfb\u53d6\u4f18\u5316\u7684\u89c6\u56fe\u4e2d\u5bf9\u6570\u636e\u8fdb\u884c\u975e\u89c4\u8303\u5316\u662f\u5b8c\u5168\u5408\u7406\u7684\uff0c\u56e0\u4e3a\u7ffb\u8bd1\u8fc7\u7a0b\u63d0\u4f9b\u4e86\u4f7f\u5176\u4e0e\u4e8b\u4ef6\u65e5\u5fd7\u4fdd\u6301\u4e00\u81f4\u7684\u673a\u5236\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_28","title":"\u5e76\u53d1\u63a7\u5236","text":"<p>\u4e8b\u4ef6\u6eaf\u6e90\u548c\u53d8\u66f4\u6570\u636e\u6355\u83b7\u7684\u6700\u5927\u7f3a\u70b9\u662f\uff0c\u4e8b\u4ef6\u65e5\u5fd7\u7684\u6d88\u8d39\u8005\u901a\u5e38\u662f\u5f02\u6b65\u7684\uff1a\u7528\u6237\u4f1a\u5199\u5165\u65e5\u5fd7\uff0c\u7136\u540e\u4ece\u65e5\u5fd7\u884d\u751f\u89c6\u56fe\u4e2d\u8bfb\u53d6\uff0c\u7ed3\u679c\u53d1\u73b0\u4ed6\u7684\u5199\u5165\u8fd8\u6ca1\u6709\u53cd\u6620\u5728\u8bfb\u53d6\u89c6\u56fe\u4e2d\u3002</p> <ul> <li>\u4e00\u79cd\u89e3\u51b3\u65b9\u6848\u662f\u5c06\u4e8b\u4ef6\u8ffd\u52a0\u5230\u65e5\u5fd7\u65f6\u540c\u6b65\u6267\u884c\u8bfb\u53d6\u89c6\u56fe\u7684\u66f4\u65b0\uff1b\u5c06\u8fd9\u4e9b\u5199\u5165\u64cd\u4f5c\u5408\u5e76\u4e3a\u4e00\u4e2a\u539f\u5b50\u5355\u5143\u9700\u8981 \u4e8b\u52a1\uff0c\u6240\u4ee5\u8981\u4e48\u5c06\u4e8b\u4ef6\u65e5\u5fd7\u548c\u8bfb\u53d6\u89c6\u56fe\u4fdd\u5b58\u5728\u540c\u4e00\u4e2a\u5b58\u50a8\u7cfb\u7edf\u4e2d\uff0c\u8981\u4e48\u5c31\u9700\u8981\u8de8\u4e0d\u540c\u7cfb\u7edf\u8fdb\u884c\u5206\u5e03\u5f0f\u4e8b\u52a1\u3002</li> </ul> <p>\u4ece\u4e8b\u4ef6\u65e5\u5fd7\u5bfc\u51fa\u5f53\u524d\u72b6\u6001\u4e5f\u7b80\u5316\u4e86\u5e76\u53d1\u63a7\u5236\u7684\u67d0\u4e9b\u90e8\u5206\u3002</p> <ul> <li>\u5bf9\u4e8e\u591a\u5bf9\u8c61\u4e8b\u52a1\u7684\u9700\u6c42\uff0c\u6e90\u4e8e\u5355\u4e2a\u7528\u6237\u64cd\u4f5c\u9700\u8981\u5728\u591a\u4e2a\u4e0d\u540c\u7684\u4f4d\u7f6e\u66f4\u6539\u6570\u636e\u3002\u901a\u8fc7\u4e8b\u4ef6\u6eaf\u6e90\uff0c\u4f60\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u4e2a\u81ea\u5305\u542b\u7684\u4e8b\u4ef6\u4ee5\u8868\u793a\u4e00\u4e2a\u7528\u6237\u64cd\u4f5c\u3002\u7136\u540e\u7528\u6237\u64cd\u4f5c\u5c31\u53ea\u9700\u8981\u5728\u4e00\u4e2a\u5730\u65b9\u8fdb\u884c\u5355\u6b21\u5199\u5165\u64cd\u4f5c \u2014\u2014 \u5373\u5c06\u4e8b\u4ef6\u9644\u52a0\u5230\u65e5\u5fd7\u4e2d \u2014\u2014 \u8fd9\u4e2a\u8fd8\u662f\u5f88\u5bb9\u6613\u4f7f\u539f\u5b50\u5316\u7684\u3002</li> </ul> <p>\u5982\u679c\u4e8b\u4ef6\u65e5\u5fd7\u4e0e\u5e94\u7528\u72b6\u6001\u4ee5\u76f8\u540c\u7684\u65b9\u5f0f\u5206\u533a\uff08\u4f8b\u5982\uff0c\u5904\u7406\u5206\u533a 3 \u4e2d\u7684\u5ba2\u6237\u4e8b\u4ef6\u53ea\u9700\u8981\u66f4\u65b0\u5206\u533a 3 \u4e2d\u7684\u5e94\u7528\u72b6\u6001\uff09\uff0c\u90a3\u4e48\u76f4\u63a5\u4f7f\u7528\u5355\u7ebf\u7a0b\u65e5\u5fd7\u6d88\u8d39\u8005\u5c31\u4e0d\u9700\u8981\u5199\u5165\u5e76\u53d1\u63a7\u5236\u4e86\u3002\u5b83\u4ece\u8bbe\u8ba1\u4e0a\u4e00\u6b21\u53ea\u5904\u7406\u4e00\u4e2a\u4e8b\u4ef6\u3002</p> <p>\u3002\u65e5\u5fd7\u901a\u8fc7\u5728\u5206\u533a\u4e2d\u5b9a\u4e49\u4e8b\u4ef6\u7684\u5e8f\u5217\u987a\u5e8f\uff0c\u6d88\u9664\u4e86\u5e76\u53d1\u6027\u7684\u4e0d\u786e\u5b9a\u6027\u301024\u3011\u3002\u5982\u679c\u4e00\u4e2a\u4e8b\u4ef6\u89e6\u53ca\u591a\u4e2a\u72b6\u6001\u5206\u533a\uff0c\u90a3\u4e48\u9700\u8981\u505a\u66f4\u591a\u7684\u5de5\u4f5c\uff0c\u6211\u4eec\u5c06\u5728 \u7b2c\u5341\u4e8c\u7ae0 \u8ba8\u8bba\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_29","title":"\u4e0d\u53d8\u6027\u7684\u5c40\u9650\u6027","text":"<p>\u8bb8\u591a\u4e0d\u4f7f\u7528\u4e8b\u4ef6\u6eaf\u6e90\u6a21\u578b\u7684\u7cfb\u7edf\u4e5f\u8fd8\u662f\u4f9d\u8d56\u4e0d\u53ef\u53d8\u6027\uff1a\u5404\u79cd\u6570\u636e\u5e93\u5728\u5185\u90e8\u4f7f\u7528\u4e0d\u53ef\u53d8\u7684\u6570\u636e\u7ed3\u6784\u6216\u591a\u7248\u672c\u6570\u636e\u6765\u652f\u6301\u65f6\u95f4\u70b9\u5feb\u7167\u3002Git\u3001Mercurial \u548c Fossil \u7b49\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u4e5f\u4f9d\u9760\u4e0d\u53ef\u53d8\u7684\u6570\u636e\u6765\u4fdd\u5b58\u6587\u4ef6\u7684\u7248\u672c\u5386\u53f2\u8bb0\u5f55\u3002</p> <p>\u6c38\u8fdc\u4fdd\u6301\u6240\u6709\u53d8\u66f4\u7684\u4e0d\u53d8\u5386\u53f2\uff0c\u5728\u591a\u5927\u7a0b\u5ea6\u4e0a\u662f\u53ef\u884c\u7684\uff1f\u7b54\u6848\u53d6\u51b3\u4e8e\u6570\u636e\u96c6\u7684\u6d41\u5931\u7387\u3002</p> <ul> <li>\u4e00\u4e9b\u5de5\u4f5c\u8d1f\u8f7d\u4e3b\u8981\u662f\u6dfb\u52a0\u6570\u636e\uff0c\u5f88\u5c11\u66f4\u65b0\u6216\u5220\u9664\uff1b\u5b83\u4eec\u5f88\u5bb9\u6613\u4fdd\u6301\u4e0d\u53d8\u3002\u5176\u4ed6\u5de5\u4f5c\u8d1f\u8f7d\u5728\u76f8\u5bf9\u8f83\u5c0f\u7684\u6570\u636e\u96c6\u4e0a\u6709\u8f83\u9ad8\u7684\u66f4\u65b0 / \u5220\u9664\u7387\uff1b\u5728\u8fd9\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4e0d\u53ef\u53d8\u7684\u5386\u53f2\u53ef\u80fd\u589e\u81f3\u96be\u4ee5\u63a5\u53d7\u7684\u5de8\u5927\uff0c\u788e\u7247\u5316\u53ef\u80fd\u6210\u4e3a\u4e00\u4e2a\u95ee\u9898\uff0c\u538b\u7f29\u4e0e\u5783\u573e\u6536\u96c6\u7684\u8868\u73b0\u5bf9\u4e8e\u8fd0\u7ef4\u7684\u7a33\u5065\u6027\u53d8\u5f97\u81f3\u5173\u91cd\u8981\u301060,61\u3011\u3002</li> </ul> <p>\u9664\u4e86\u6027\u80fd\u65b9\u9762\u7684\u539f\u56e0\u5916\uff0c\u4e5f\u53ef\u80fd\u6709\u51fa\u4e8e\u7ba1\u7406\u65b9\u9762\u7684\u539f\u56e0\u9700\u8981\u5220\u9664\u6570\u636e\u7684\u60c5\u51b5\uff0c\u5c3d\u7ba1\u8fd9\u4e9b\u6570\u636e\u90fd\u662f\u4e0d\u53ef\u53d8\u7684\u3002</p> <ul> <li>\u4f8b\u5982\uff0c\u9690\u79c1\u6761\u4f8b\u53ef\u80fd\u8981\u6c42\u5728\u7528\u6237\u5173\u95ed\u5e10\u6237\u540e\u5220\u9664\u4ed6\u4eec\u7684\u4e2a\u4eba\u4fe1\u606f\uff0c\u6570\u636e\u4fdd\u62a4\u7acb\u6cd5\u53ef\u80fd\u8981\u6c42\u5220\u9664\u9519\u8bef\u7684\u4fe1\u606f\uff0c\u6216\u8005\u53ef\u80fd\u9700\u8981\u963b\u6b62\u654f\u611f\u4fe1\u606f\u7684\u610f\u5916\u6cc4\u9732\u3002</li> </ul> <p>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4ec5\u4ec5\u5728\u65e5\u5fd7\u4e2d\u6dfb\u52a0\u53e6\u4e00\u4e2a\u4e8b\u4ef6\u6765\u6307\u660e\u5148\u524d\u7684\u6570\u636e\u5e94\u8be5\u88ab\u89c6\u4e3a\u5220\u9664\u662f\u4e0d\u591f\u7684\uff1a</p> <ul> <li>\u5b9e\u9645\u4e0a\u662f\u60f3\u6539\u5199\u5386\u53f2\uff0c\u5e76\u5047\u88c5\u6570\u636e\u4ece\u4e00\u5f00\u59cb\u5c31\u6ca1\u6709\u5199\u5165\u3002\u4f8b\u5982\uff0cDatomic \u7ba1\u8fd9\u4e2a\u7279\u6027\u53eb \u5207\u9664\uff08excision\uff09 \u301062\u3011\uff0c\u800c Fossil \u7248\u672c\u63a7\u5236\u7cfb\u7edf\u6709\u4e00\u4e2a\u7c7b\u4f3c\u7684\u6982\u5ff5\u53eb \u907f\u514d\uff08shunning\uff09 \u301063\u3011\u3002</li> </ul> <p>\u771f\u6b63\u5220\u9664\u6570\u636e\u662f\u975e\u5e38\u975e\u5e38\u56f0\u96be\u7684\u301064\u3011\uff0c\u56e0\u4e3a\u526f\u672c\u53ef\u80fd\u5b58\u5728\u4e8e\u5f88\u591a\u5730\u65b9\uff1a\u4f8b\u5982\uff0c\u5b58\u50a8\u5f15\u64ce\uff0c\u6587\u4ef6\u7cfb\u7edf\u548c SSD \u901a\u5e38\u4f1a\u5411\u4e00\u4e2a\u65b0\u4f4d\u7f6e\u5199\u5165\uff0c\u800c\u4e0d\u662f\u539f\u5730\u8986\u76d6\u65e7\u6570\u636e\u301052\u3011\uff0c\u800c\u5907\u4efd\u901a\u5e38\u662f\u7279\u610f\u505a\u6210\u4e0d\u53ef\u53d8\u7684\uff0c\u9632\u6b62\u610f\u5916\u5220\u9664\u6216\u635f\u574f\u3002</p> <ul> <li>\u5220\u9664\u64cd\u4f5c\u66f4\u591a\u7684\u662f\u6307 \u201c\u4f7f\u53d6\u56de\u6570\u636e\u66f4\u56f0\u96be\u201d\uff0c\u800c\u4e0d\u662f\u6307 \u201c\u4f7f\u53d6\u56de\u6570\u636e\u4e0d\u53ef\u80fd\u201d\u3002\u65e0\u8bba\u5982\u4f55\uff0c\u6709\u65f6\u4f60\u5fc5\u987b\u5f97\u5c1d\u8bd5\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_30","title":"\u6d41\u5904\u7406","text":"<p>\u53ef\u4ee5\u7528\u6d41\u505a\u4ec0\u4e48\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u6709\u4e09\u79cd\u9009\u9879\uff1a</p> <ul> <li>\u5c06\u4e8b\u4ef6\u4e2d\u7684\u6570\u636e\u5199\u5165\u6570\u636e\u5e93\u3001\u7f13\u5b58\u3001\u641c\u7d22\u7d22\u5f15\u6216\u7c7b\u4f3c\u7684\u5b58\u50a8\u7cfb\u7edf\uff0c\u7136\u540e\u80fd\u88ab\u5176\u4ed6\u5ba2\u6237\u7aef\u67e5\u8be2\u3002\u5982\u56fe11-5\u6240\u793a\uff0c\u8fd9\u662f\u6570\u636e\u5e93\u4e0e\u7cfb\u7edf\u5176\u4ed6\u90e8\u5206\u6240\u53d1\u751f\u7684\u53d8\u66f4\u4fdd\u6301\u540c\u6b65\u7684\u597d\u65b9\u6cd5</li> <li>\u4ee5\u67d0\u79cd\u65b9\u5f0f\u5c06\u4e8b\u4ef6\u63a8\u9001\u7ed9\u7528\u6237\uff0c\u4f8b\u5982\u53d1\u9001\u62a5\u8b66\u90ae\u4ef6\u6216\u63a8\u9001\u901a\u77e5\uff0c\u6216\u5c06\u4e8b\u4ef6\u6d41\u5f0f\u4f20\u8f93\u5230\u53ef\u5b9e\u65f6\u663e\u793a\u7684\u4eea\u8868\u677f\u4e0a\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4eba\u662f\u6d41\u7684\u6700\u7ec8\u6d88\u8d39\u8005\u3002</li> <li>\u5904\u7406\u4e00\u4e2a\u6216\u591a\u4e2a\u8f93\u5165\u6d41\uff0c\u5e76\u4ea7\u751f\u4e00\u4e2a\u6216\u591a\u4e2a\u8f93\u51fa\u6d41\u3002\u6d41\u53ef\u80fd\u4f1a\u7ecf\u8fc7\u7531\u51e0\u4e2a\u8fd9\u6837\u7684\u5904\u7406\u9636\u6bb5\u7ec4\u6210\u7684\u6d41\u6c34\u7ebf\uff0c\u6700\u540e\u518d\u8f93\u51fa\uff08\u9009\u9879 1 \u6216 2\uff09\u3002</li> </ul> <p>\u5728\u672c\u7ae0\u7684\u5269\u4f59\u90e8\u5206\u4e2d\uff0c\u6211\u4eec\u5c06\u8ba8\u8bba\u9009\u9879 3\uff1a\u5904\u7406\u6d41\u4ee5\u4ea7\u751f\u5176\u4ed6\u884d\u751f\u6d41\u3002</p> <ul> <li>\u5904\u7406\u8fd9\u6837\u7684\u6d41\u7684\u4ee3\u7801\u7247\u6bb5\uff0c\u88ab\u79f0\u4e3a \u7b97\u5b50\uff08operator\uff09 \u6216 \u4f5c\u4e1a\uff08job\uff09\u3002</li> <li>\u4e00\u4e2a\u6d41\u5904\u7406\u5668\u4ee5\u53ea\u8bfb\u7684\u65b9\u5f0f\u4f7f\u7528\u8f93\u5165\u6d41\uff0c\u5e76\u5c06\u5176\u8f93\u51fa\u4ee5\u4ec5\u8ffd\u52a0\u7684\u65b9\u5f0f\u5199\u5165\u4e00\u4e2a\u4e0d\u540c\u7684\u4f4d\u7f6e\u3002</li> </ul> <p>\u6d41\u5904\u7406\u4e2d\u7684\u5206\u533a\u548c\u5e76\u884c\u5316\u6a21\u5f0f\u4e5f\u975e\u5e38\u7c7b\u4f3c\u4e8e \u7b2c\u5341\u7ae0 \u4e2d\u4ecb\u7ecd\u7684 MapReduce \u548c\u6570\u636e\u6d41\u5f15\u64ce\uff0c\u56e0\u6b64\u6211\u4eec\u4e0d\u518d\u91cd\u590d\u8fd9\u4e9b\u4e3b\u9898\u3002\u57fa\u672c\u7684 Map \u64cd\u4f5c\uff08\u5982\u8f6c\u6362\u548c\u8fc7\u6ee4\u8bb0\u5f55\uff09\u4e5f\u662f\u4e00\u6837\u7684\u3002</p> <ul> <li>\u4e0e\u6279\u91cf\u4f5c\u4e1a\u76f8\u6bd4\u7684\u4e00\u4e2a\u5173\u952e\u533a\u522b\u662f\uff0c\u6d41\u4e0d\u4f1a\u7ed3\u675f\u3002\u56e0\u6b64\u65e0\u6cd5\u4f7f\u7528 \u6392\u5e8f\u5408\u5e76\u8fde\u63a5\u3002</li> <li>\u5bb9\u9519\u673a\u5236\u4e5f\u5fc5\u987b\u6539\u53d8\uff1a\u5bf9\u4e8e\u5df2\u7ecf\u8fd0\u884c\u4e86\u51e0\u5206\u949f\u7684\u6279\u5904\u7406\u4f5c\u4e1a\uff0c\u53ef\u4ee5\u7b80\u5355\u5730\u4ece\u5934\u5f00\u59cb\u91cd\u542f\u5931\u8d25\u4efb\u52a1\uff0c\u4f46\u662f\u5bf9\u4e8e\u5df2\u7ecf\u8fd0\u884c\u6570\u5e74\u7684\u6d41\u4f5c\u4e1a\uff0c\u91cd\u542f\u540e\u4ece\u5934\u5f00\u59cb\u8dd1\u53ef\u80fd\u5e76\u4e0d\u662f\u4e00\u4e2a\u53ef\u884c\u7684\u9009\u9879\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_31","title":"\u6d41\u5904\u7406\u7684\u5e94\u7528","text":"<p>\u957f\u671f\u4ee5\u6765\uff0c\u6d41\u5904\u7406\u4e00\u76f4\u7528\u4e8e\u76d1\u63a7\u76ee\u7684\uff0c\u5982\u679c\u67d0\u4e2a\u4e8b\u4ef6\u53d1\u751f\uff0c\u7ec4\u7ec7\u5e0c\u671b\u80fd\u5f97\u5230\u8b66\u62a5\u3002\u4f8b\u5982\uff1a</p> <ul> <li>\u6b3a\u8bc8\u68c0\u6d4b\u7cfb\u7edf\u9700\u8981\u786e\u5b9a\u4fe1\u7528\u5361\u7684\u4f7f\u7528\u6a21\u5f0f\u662f\u5426\u6709\u610f\u5916\u5730\u53d8\u5316\uff0c\u5982\u679c\u4fe1\u7528\u5361\u53ef\u80fd\u5df2\u88ab\u76d7\u5237\uff0c\u5219\u9501\u5361\u3002</li> <li>\u4ea4\u6613\u7cfb\u7edf\u9700\u8981\u68c0\u67e5\u91d1\u878d\u5e02\u573a\u7684\u4ef7\u683c\u53d8\u5316\uff0c\u5e76\u6839\u636e\u6307\u5b9a\u7684\u89c4\u5219\u8fdb\u884c\u4ea4\u6613\u3002</li> <li>\u5236\u9020\u7cfb\u7edf\u9700\u8981\u76d1\u63a7\u5de5\u5382\u4e2d\u673a\u5668\u7684\u72b6\u6001\uff0c\u5982\u679c\u51fa\u73b0\u6545\u969c\uff0c\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u95ee\u9898\u3002</li> <li>\u519b\u4e8b\u548c\u60c5\u62a5\u7cfb\u7edf\u9700\u8981\u8ddf\u8e2a\u6f5c\u5728\u4fb5\u7565\u8005\u7684\u6d3b\u52a8\uff0c\u5e76\u5728\u51fa\u73b0\u88ad\u51fb\u5f81\u5146\u65f6\u53d1\u51fa\u8b66\u62a5\u3002</li> </ul> <p>\u8fd9\u4e9b\u7c7b\u578b\u7684\u5e94\u7528\u9700\u8981\u975e\u5e38\u7cbe\u5bc6\u590d\u6742\u7684\u6a21\u5f0f\u5339\u914d\u4e0e\u76f8\u5173\u68c0\u6d4b\u3002\u7136\u800c\u968f\u7740\u65f6\u4ee3\u7684\u8fdb\u6b65\uff0c\u6d41\u5904\u7406\u7684\u5176\u4ed6\u7528\u9014\u4e5f\u5f00\u59cb\u51fa\u73b0\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_32","title":"\u590d\u5408\u4e8b\u4ef6\u5904\u7406","text":"<p>\u590d\u5408\u4e8b\u4ef6\u5904\u7406\uff08complex event processing, CEP\uff09 \u662f 20 \u4e16\u7eaa 90 \u5e74\u4ee3\u4e3a\u5206\u6790\u4e8b\u4ef6\u6d41\u800c\u5f00\u53d1\u51fa\u7684\u4e00\u79cd\u65b9\u6cd5\uff0c\u5c24\u5176\u9002\u7528\u4e8e\u9700\u8981\u641c\u7d22\u67d0\u4e9b\u4e8b\u4ef6\u6a21\u5f0f\u7684\u5e94\u7528\u301065,66\u3011\u3002CEP \u5141\u8bb8\u4f60\u6307\u5b9a\u89c4\u5219\u4ee5\u5728\u6d41\u4e2d\u641c\u7d22\u67d0\u4e9b\u4e8b\u4ef6\u6a21\u5f0f\u3002</p> <p>CEP \u7cfb\u7edf\u901a\u5e38\u4f7f\u7528\u9ad8\u5c42\u6b21\u7684\u58f0\u660e\u5f0f\u67e5\u8be2\u8bed\u8a00\uff0c\u6bd4\u5982 SQL\uff0c\u6216\u8005\u56fe\u5f62\u7528\u6237\u754c\u9762\uff0c\u6765\u63cf\u8ff0\u5e94\u8be5\u68c0\u6d4b\u5230\u7684\u4e8b\u4ef6\u6a21\u5f0f\u3002\u8fd9\u4e9b\u67e5\u8be2\u88ab\u63d0\u4ea4\u7ed9\u5904\u7406\u5f15\u64ce\uff0c\u8be5\u5f15\u64ce\u6d88\u8d39\u8f93\u5165\u6d41\uff0c\u5e76\u5728\u5185\u90e8\u7ef4\u62a4\u4e00\u4e2a\u6267\u884c\u6240\u9700\u5339\u914d\u7684\u72b6\u6001\u673a\u3002\u5f53\u53d1\u73b0\u5339\u914d\u65f6\uff0c\u5f15\u64ce\u53d1\u51fa\u4e00\u4e2a \u590d\u5408\u4e8b\u4ef6\uff08\u5373 complex event\uff0cCEP \u56e0\u6b64\u5f97\u540d\uff09\uff0c\u5e76\u9644\u6709\u68c0\u6d4b\u5230\u7684\u4e8b\u4ef6\u6a21\u5f0f\u8be6\u60c5\u301067\u3011\u3002</p> <p>\u5728\u8fd9\u4e9b\u7cfb\u7edf\u4e2d\uff0c\u67e5\u8be2\u548c\u6570\u636e\u4e4b\u95f4\u7684\u5173\u7cfb\u4e0e\u666e\u901a\u6570\u636e\u5e93\u76f8\u6bd4\u662f\u98a0\u5012\u7684\u3002</p> <ul> <li>\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u6570\u636e\u5e93\u4f1a\u6301\u4e45\u5b58\u50a8\u6570\u636e\uff0c\u5e76\u5c06\u67e5\u8be2\u89c6\u4e3a\u4e34\u65f6\u7684\uff1a\u5f53\u67e5\u8be2\u8fdb\u5165\u65f6\uff0c\u6570\u636e\u5e93\u641c\u7d22\u4e0e\u67e5\u8be2\u5339\u914d\u7684\u6570\u636e\uff0c\u7136\u540e\u5728\u67e5\u8be2\u5b8c\u6210\u65f6\u4e22\u6389\u67e5\u8be2\u3002</li> <li>CEP \u5f15\u64ce\u53cd\u8f6c\u4e86\u89d2\u8272\uff1a\u67e5\u8be2\u662f\u957f\u671f\u5b58\u50a8\u7684\uff0c\u6765\u81ea\u8f93\u5165\u6d41\u7684\u4e8b\u4ef6\u4e0d\u65ad\u6d41\u8fc7\u5b83\u4eec\uff0c\u641c\u7d22\u5339\u914d\u4e8b\u4ef6\u6a21\u5f0f\u7684\u67e5\u8be2\u301068\u3011\u3002</li> </ul> <p>CEP \u7684\u5b9e\u73b0\u5305\u62ec Esper\u301069\u3011\u3001IBM InfoSphere Streams\u301070\u3011\u3001Apama\u3001TIBCO StreamBase \u548c SQLstream\u3002\u50cf Samza \u8fd9\u6837\u7684\u5206\u5e03\u5f0f\u6d41\u5904\u7406\u7ec4\u4ef6\uff0c\u652f\u6301\u4f7f\u7528 SQL \u5728\u6d41\u4e0a\u8fdb\u884c\u58f0\u660e\u5f0f\u67e5\u8be2\u301071\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_33","title":"\u6d41\u5206\u6790","text":"<p>CEP \u4e0e\u6d41\u5206\u6790\u4e4b\u95f4\u7684\u8fb9\u754c\u662f\u6a21\u7cca\u7684\uff0c\u4f46\u4e00\u822c\u6765\u8bf4\uff0c\u5206\u6790\u5f80\u5f80\u5bf9\u627e\u51fa\u7279\u5b9a\u4e8b\u4ef6\u5e8f\u5217\u5e76\u4e0d\u5173\u5fc3\uff0c\u800c\u66f4\u5173\u6ce8\u5927\u91cf\u4e8b\u4ef6\u4e0a\u7684\u805a\u5408\u4e0e\u7edf\u8ba1\u6307\u6807 \u2014\u2014 \u4f8b\u5982\uff1a</p> <ul> <li>\u6d4b\u91cf\u67d0\u79cd\u7c7b\u578b\u4e8b\u4ef6\u7684\u901f\u7387\uff08\u6bcf\u4e2a\u65f6\u95f4\u95f4\u9694\u5185\u53d1\u751f\u7684\u9891\u7387\uff09</li> <li>\u6eda\u52a8\u8ba1\u7b97\u4e00\u6bb5\u65f6\u95f4\u7a97\u53e3\u5185\u67d0\u4e2a\u503c\u7684\u5e73\u5747\u503c</li> <li>\u5c06\u5f53\u524d\u7684\u7edf\u8ba1\u503c\u4e0e\u5148\u524d\u7684\u65f6\u95f4\u533a\u95f4\u7684\u503c\u5bf9\u6bd4\uff08\u4f8b\u5982\uff0c\u68c0\u6d4b\u8d8b\u52bf\uff0c\u5f53\u6307\u6807\u4e0e\u4e0a\u5468\u540c\u6bd4\u5f02\u5e38\u504f\u9ad8\u6216\u504f\u4f4e\u65f6\u62a5\u8b66\uff09</li> </ul> <p>\u8fd9\u4e9b\u7edf\u8ba1\u503c\u901a\u5e38\u662f\u5728\u56fa\u5b9a\u65f6\u95f4\u533a\u95f4\u5185\u8fdb\u884c\u8ba1\u7b97\u7684\uff0c\u4f8b\u5982\uff0c\u4f60\u53ef\u80fd\u60f3\u77e5\u9053\u5728\u8fc7\u53bb 5 \u5206\u949f\u5185\u670d\u52a1\u6bcf\u79d2\u67e5\u8be2\u6b21\u6570\u7684\u5747\u503c\uff0c\u4ee5\u53ca\u6b64\u65f6\u95f4\u6bb5\u5185\u54cd\u5e94\u65f6\u95f4\u7684\u7b2c 99 \u767e\u5206\u4f4d\u70b9\u3002</p> <ul> <li>\u5728\u51e0\u5206\u949f\u5185\u53d6\u5e73\u5747\uff0c\u80fd\u62b9\u5e73\u79d2\u548c\u79d2\u4e4b\u95f4\u7684\u65e0\u5173\u6ce2\u52a8\uff0c\u4e14\u4ecd\u7136\u80fd\u5411\u4f60\u5c55\u793a\u6d41\u91cf\u6a21\u5f0f\u7684\u65f6\u95f4\u56fe\u666f\u3002\u805a\u5408\u7684\u65f6\u95f4\u95f4\u9694\u79f0\u4e3a \u7a97\u53e3\uff08window\uff09</li> </ul> <p>\u6d41\u5206\u6790\u7cfb\u7edf\u6709\u65f6\u4f1a\u4f7f\u7528\u6982\u7387\u7b97\u6cd5\uff0c\u4f8b\u5982 Bloom filter\u6765\u7ba1\u7406\u6210\u5458\u8d44\u683c\uff0cHyperLogLog\u301072\u3011\u7528\u4e8e\u57fa\u6570\u4f30\u8ba1\u4ee5\u53ca\u5404\u79cd\u767e\u5206\u6bd4\u4f30\u8ba1\u7b97\u6cd5\u3002\u6982\u7387\u7b97\u6cd5\u4ea7\u51fa\u8fd1\u4f3c\u7684\u7ed3\u679c\uff0c\u4f46\u6bd4\u8d77\u7cbe\u786e\u7b97\u6cd5\u7684\u4f18\u70b9\u662f\u5185\u5b58\u4f7f\u7528\u8981\u5c11\u5f97\u591a\u3002\u4f7f\u7528\u8fd1\u4f3c\u7b97\u6cd5\u6709\u65f6\u8ba9\u4eba\u4eec\u89c9\u5f97\u6d41\u5904\u7406\u7cfb\u7edf\u603b\u662f\u6709\u635f\u7684\u548c\u4e0d\u7cbe\u786e\u7684\uff0c\u4f46\u8fd9\u662f\u9519\u8bef\u770b\u6cd5\uff1a\u6d41\u5904\u7406\u5e76\u6ca1\u6709\u4efb\u4f55\u5185\u5728\u7684\u8fd1\u4f3c\u6027\uff0c\u800c\u6982\u7387\u7b97\u6cd5\u53ea\u662f\u4e00\u79cd\u4f18\u5316\u301073\u3011\u3002</p> <p>\u8bb8\u591a\u5f00\u6e90\u5206\u5e03\u5f0f\u6d41\u5904\u7406\u6846\u67b6\u7684\u8bbe\u8ba1\u90fd\u662f\u9488\u5bf9\u5206\u6790\u8bbe\u8ba1\u7684\uff1a\u4f8b\u5982 Apache Storm\u3001Spark Streaming\u3001Flink\u3001Concord\u3001Samza \u548c Kafka Streams \u301074\u3011\u3002\u6258\u7ba1\u670d\u52a1\u5305\u62ec Google Cloud Dataflow \u548c Azure Stream Analytics\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_34","title":"\u7ef4\u62a4\u7269\u5316\u89c6\u56fe","text":"<p>\u6570\u636e\u5e93\u7684\u53d8\u66f4\u6d41\u53ef\u4ee5\u7528\u4e8e\u7ef4\u62a4\u884d\u751f\u6570\u636e\u7cfb\u7edf\uff08\u5982\u7f13\u5b58\u3001\u641c\u7d22\u7d22\u5f15\u548c\u6570\u636e\u4ed3\u5e93\uff09\uff0c\u5e76\u4f7f\u5176\u4e0e\u6e90\u6570\u636e\u5e93\u4fdd\u6301\u6700\u65b0\u3002\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u793a\u4f8b\u89c6\u4f5c\u7ef4\u62a4 \u7269\u5316\u89c6\u56fe\uff08materialized view\uff09 \u7684\u4e00\u79cd\u5177\u4f53\u573a\u666f\uff1a\u5728\u67d0\u4e2a\u6570\u636e\u96c6\u4e0a\u884d\u751f\u51fa\u4e00\u4e2a\u66ff\u4ee3\u89c6\u56fe\u4ee5\u4fbf\u9ad8\u6548\u67e5\u8be2\uff0c\u5e76\u5728\u5e95\u5c42\u6570\u636e\u53d8\u66f4\u65f6\u66f4\u65b0\u89c6\u56fe\u301050\u3011\u3002</p> <p>\u540c\u6837\uff0c\u5728\u4e8b\u4ef6\u6eaf\u6e90\u4e2d\uff0c\u5e94\u7528\u7a0b\u5e8f\u7684\u72b6\u6001\u662f\u901a\u8fc7\u5e94\u7528\u4e8b\u4ef6\u65e5\u5fd7\u6765\u7ef4\u62a4\u7684\uff1b\u8fd9\u91cc\u7684\u5e94\u7528\u7a0b\u5e8f\u72b6\u6001\u4e5f\u662f\u4e00\u79cd\u7269\u5316\u89c6\u56fe\u3002\u4e0e\u6d41\u5206\u6790\u573a\u666f\u4e0d\u540c\u7684\u662f\uff0c\u4ec5\u8003\u8651\u67d0\u4e2a\u65f6\u95f4\u7a97\u53e3\u5185\u7684\u4e8b\u4ef6\u901a\u5e38\u662f\u4e0d\u591f\u7684\uff1a\u6784\u5efa\u7269\u5316\u89c6\u56fe\u53ef\u80fd\u9700\u8981\u4efb\u610f\u65f6\u95f4\u6bb5\u5185\u7684 \u6240\u6709 \u4e8b\u4ef6\uff0c\u9664\u4e86\u90a3\u4e9b\u53ef\u80fd\u7531\u65e5\u5fd7\u538b\u7f29\u4e22\u5f03\u7684\u8fc7\u65f6\u4e8b\u4ef6\u3002\u5b9e\u9645\u4e0a\uff0c\u4f60\u9700\u8981\u4e00\u4e2a\u53ef\u4ee5\u4e00\u76f4\u5ef6\u4f38\u5230\u65f6\u95f4\u5f00\u7aef\u7684\u7a97\u53e3\u3002</p> <p>\u539f\u5219\u4e0a\u8bb2\uff0c\u4efb\u4f55\u6d41\u5904\u7406\u7ec4\u4ef6\u90fd\u53ef\u4ee5\u7528\u4e8e\u7ef4\u62a4\u7269\u5316\u89c6\u56fe\uff0c\u5c3d\u7ba1 \u201c\u6c38\u8fdc\u8fd0\u884c\u201d \u4e0e\u4e00\u4e9b\u9762\u5411\u5206\u6790\u7684\u6846\u67b6\u5047\u8bbe\u7684 \u201c\u4e3b\u8981\u5728\u6709\u9650\u65f6\u95f4\u6bb5\u7a97\u53e3\u4e0a\u8fd0\u884c\u201d \u80cc\u9053\u800c\u9a70\uff0cSamza \u548c Kafka Streams \u652f\u6301\u8fd9\u79cd\u7528\u6cd5\uff0c\u5efa\u7acb\u5728 Kafka \u5bf9\u65e5\u5fd7\u538b\u7f29\u7684\u652f\u6301\u4e0a\u301075\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_35","title":"\u5728\u6d41\u4e0a\u641c\u7d22","text":"<p>\u9664\u4e86\u5141\u8bb8\u641c\u7d22\u7531\u591a\u4e2a\u4e8b\u4ef6\u6784\u6210\u6a21\u5f0f\u7684 CEP \u5916\uff0c\u6709\u65f6\u4e5f\u5b58\u5728\u57fa\u4e8e\u590d\u6742\u6807\u51c6\uff08\u4f8b\u5982\u5168\u6587\u641c\u7d22\u67e5\u8be2\uff09\u6765\u641c\u7d22\u5355\u4e2a\u4e8b\u4ef6\u7684\u9700\u6c42\u3002</p> <p>\u4f8b\u5982\uff0c\u5a92\u4f53\u76d1\u6d4b\u670d\u52a1\u53ef\u4ee5\u8ba2\u9605\u65b0\u95fb\u6587\u7ae0 Feed \u4e0e\u6765\u81ea\u5a92\u4f53\u7684\u64ad\u5ba2\uff0c\u641c\u7d22\u4efb\u4f55\u5173\u4e8e\u516c\u53f8\u3001\u4ea7\u54c1\u6216\u611f\u5174\u8da3\u7684\u8bdd\u9898\u7684\u65b0\u95fb\u3002</p> <ul> <li>\u901a\u8fc7\u9884\u5148\u6784\u5efa\u4e00\u4e2a\u641c\u7d22\u67e5\u8be2\u6765\u5b8c\u6210\u7684\uff0c\u7136\u540e\u4e0d\u65ad\u5730\u5c06\u65b0\u95fb\u9879\u7684\u6d41\u4e0e\u8be5\u67e5\u8be2\u8fdb\u884c\u5339\u914d\u3002</li> </ul> <p>Elasticsearch \u7684\u8fd9\u79cd\u8fc7\u6ee4\u5668\u529f\u80fd\uff0c\u662f\u5b9e\u73b0\u8fd9\u79cd\u6d41\u641c\u7d22\u7684\u4e00\u79cd\u9009\u62e9\u301076\u3011\u3002</p> <p>\u4f20\u7edf\u7684\u641c\u7d22\u5f15\u64ce\u9996\u5148\u7d22\u5f15\u6587\u4ef6\uff0c\u7136\u540e\u5728\u7d22\u5f15\u4e0a\u8dd1\u67e5\u8be2\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u641c\u7d22\u4e00\u4e2a\u6570\u636e\u6d41\u5219\u53cd\u4e86\u8fc7\u6765\uff1a\u67e5\u8be2\u88ab\u5b58\u50a8\u4e0b\u6765\uff0c\u6587\u6863\u4ece\u67e5\u8be2\u4e2d\u6d41\u8fc7\uff0c\u5c31\u50cf\u5728 CEP \u4e2d\u4e00\u6837\u3002</p> <ul> <li>\u6700\u7b80\u5355\u7684\u60c5\u51b5\u5c31\u662f\uff0c\u4f60\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u6587\u6863\u6d4b\u8bd5\u6bcf\u4e2a\u67e5\u8be2\u3002\u4f46\u662f\u5982\u679c\u4f60\u6709\u5927\u91cf\u67e5\u8be2\uff0c\u8fd9\u53ef\u80fd\u4f1a\u53d8\u6162\u3002\u4e3a\u4e86\u4f18\u5316\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u50cf\u5bf9\u6587\u6863\u4e00\u6837\uff0c\u4e3a\u67e5\u8be2\u5efa\u7acb\u7d22\u5f15\u3002\u56e0\u800c\u6536\u7a84\u53ef\u80fd\u5339\u914d\u7684\u67e5\u8be2\u96c6\u5408\u301077\u3011\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#rpc","title":"\u6d88\u606f\u4f20\u9012\u548cRPC","text":"<p>\u6d88\u606f\u4f20\u9012\u7cfb\u7edf\u53ef\u4ee5\u4f5c\u4e3a RPC \u7684\u66ff\u4ee3\u65b9\u6848\uff0c\u5373\u4f5c\u4e3a\u4e00\u79cd\u670d\u52a1\u95f4\u901a\u4fe1\u7684\u673a\u5236\uff0c\u6bd4\u5982\u5728 Actor \u6a21\u578b\u4e2d\u6240\u4f7f\u7528\u7684\u90a3\u6837\u3002\u5c3d\u7ba1\u8fd9\u4e9b\u7cfb\u7edf\u4e5f\u662f\u57fa\u4e8e\u6d88\u606f\u548c\u4e8b\u4ef6\uff0c\u4f46\u6211\u4eec\u901a\u5e38\u4e0d\u4f1a\u5c06\u5176\u89c6\u4f5c\u6d41\u5904\u7406\u7ec4\u4ef6\uff1a</p> <ul> <li>Actor \u6846\u67b6\u4e3b\u8981\u662f\u7ba1\u7406\u6a21\u5757\u901a\u4fe1\u7684\u5e76\u53d1\u548c\u5206\u5e03\u5f0f\u6267\u884c\u7684\u4e00\u79cd\u673a\u5236\uff0c\u800c\u6d41\u5904\u7406\u4e3b\u8981\u662f\u4e00\u79cd\u6570\u636e\u7ba1\u7406\u6280\u672f\u3002</li> <li>Actor \u4e4b\u95f4\u7684\u4ea4\u6d41\u5f80\u5f80\u662f\u77ed\u6682\u7684\u3001\u4e00\u5bf9\u4e00\u7684\uff1b\u800c\u4e8b\u4ef6\u65e5\u5fd7\u5219\u662f\u6301\u4e45\u7684\u3001\u591a\u8ba2\u9605\u8005\u7684\u3002</li> <li>Actor \u53ef\u4ee5\u4ee5\u4efb\u610f\u65b9\u5f0f\u8fdb\u884c\u901a\u4fe1\uff08\u5305\u62ec\u5faa\u73af\u7684\u8bf7\u6c42 / \u54cd\u5e94\u6a21\u5f0f\uff09\uff0c\u4f46\u6d41\u5904\u7406\u901a\u5e38\u914d\u7f6e\u5728\u65e0\u73af\u6d41\u6c34\u7ebf\u4e2d\uff0c\u5176\u4e2d\u6bcf\u4e2a\u6d41\u90fd\u662f\u4e00\u4e2a\u7279\u5b9a\u4f5c\u4e1a\u7684\u8f93\u51fa\uff0c\u7531\u826f\u597d\u5b9a\u4e49\u7684\u8f93\u5165\u6d41\u4e2d\u6d3e\u751f\u800c\u6765\u3002</li> </ul> <p>\u4e5f\u5c31\u662f\u8bf4\uff0cRPC \u7c7b\u7cfb\u7edf\u4e0e\u6d41\u5904\u7406\u4e4b\u95f4\u6709\u4e00\u4e9b\u4ea4\u53c9\u9886\u57df\u3002\u4f8b\u5982\uff0cApache Storm \u6709\u4e00\u4e2a\u79f0\u4e3a \u5206\u5e03\u5f0f RPC \u7684\u529f\u80fd\uff0c\u5b83\u5141\u8bb8\u5c06\u7528\u6237\u67e5\u8be2\u5206\u6563\u5230\u4e00\u7cfb\u5217\u4e5f\u5904\u7406\u4e8b\u4ef6\u6d41\u7684\u8282\u70b9\u4e0a\uff1b\u7136\u540e\u8fd9\u4e9b\u67e5\u8be2\u4e0e\u6765\u81ea\u8f93\u5165\u6d41\u7684\u4e8b\u4ef6\u4ea4\u7ec7\uff0c\u800c\u7ed3\u679c\u53ef\u4ee5\u88ab\u6c47\u603b\u5e76\u53d1\u56de\u7ed9\u7528\u6237\u301078\u3011\u3002</p> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528 Actor \u6846\u67b6\u6765\u5904\u7406\u6d41\u3002\u4f46\u662f\uff0c\u5f88\u591a\u8fd9\u6837\u7684\u6846\u67b6\u5728\u5d29\u6e83\u65f6\u4e0d\u80fd\u4fdd\u8bc1\u6d88\u606f\u7684\u4f20\u9012\uff0c\u9664\u975e\u4f60\u5b9e\u73b0\u4e86\u989d\u5916\u7684\u91cd\u8bd5\u903b\u8f91\uff0c\u5426\u5219\u8fd9\u79cd\u5904\u7406\u4e0d\u662f\u5bb9\u9519\u7684\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_36","title":"\u65f6\u95f4\u63a8\u7406","text":"<p>\u6d41\u5904\u7406\u901a\u5e38\u9700\u8981\u4e0e\u65f6\u95f4\u6253\u4ea4\u9053\uff0c\u5c24\u5176\u662f\u7528\u4e8e\u5206\u6790\u76ee\u7684\u65f6\u5019\uff0c\u4f1a\u9891\u7e41\u4f7f\u7528\u65f6\u95f4\u7a97\u53e3\uff0c\u4f8b\u5982 \u201c\u8fc7\u53bb\u4e94\u5206\u949f\u7684\u5e73\u5747\u503c\u201d\u3002</p> <ul> <li>\u8bfb\u53d6\u8fd0\u884c\u6279\u5904\u7406\u673a\u5668\u7684\u7cfb\u7edf\u65f6\u949f\u6ca1\u6709\u4efb\u4f55\u610f\u4e49\uff0c\u56e0\u4e3a\u5904\u7406\u8fd0\u884c\u7684\u65f6\u95f4\u4e0e\u4e8b\u4ef6\u5b9e\u9645\u53d1\u751f\u7684\u65f6\u95f4\u65e0\u5173\u3002</li> </ul> <p>\u4f7f\u7528\u4e8b\u4ef6\u4e2d\u7684\u65f6\u95f4\u6233\uff0c\u4f7f\u5f97\u5904\u7406\u662f \u786e\u5b9a\u6027 \u7684\uff1a\u5728\u76f8\u540c\u7684\u8f93\u5165\u4e0a\u518d\u6b21\u8fd0\u884c\u76f8\u540c\u7684\u5904\u7406\u8fc7\u7a0b\u4f1a\u5f97\u5230\u76f8\u540c\u7684\u7ed3\u679c\u3002</p> <p>\u8bb8\u591a\u6d41\u5904\u7406\u6846\u67b6\u4f7f\u7528\u5904\u7406\u673a\u5668\u4e0a\u7684\u672c\u5730\u7cfb\u7edf\u65f6\u949f\uff08\u5904\u7406\u65f6\u95f4\uff0c\u5373 processing time\uff09\u6765\u786e\u5b9a \u7a97\u53e3\uff08windowing\uff09\u301079\u3011\u3002</p> <ul> <li>\u7b80\u5355\uff0c\u5982\u679c\u4e8b\u4ef6\u521b\u5efa\u4e0e\u4e8b\u4ef6\u5904\u7406\u4e4b\u95f4\u7684\u5ef6\u8fdf\u53ef\u4ee5\u5ffd\u7565\u4e0d\u8ba1\uff0c\u90a3\u4e5f\u662f\u5408\u7406\uff1b</li> <li>\u5982\u679c\u5b58\u5728\u4efb\u4f55\u663e\u8457\u7684\u5904\u7406\u5ef6\u8fdf \u2014\u2014 \u5373\uff0c\u4e8b\u4ef6\u5904\u7406\u663e\u8457\u5730\u665a\u4e8e\u4e8b\u4ef6\u5b9e\u9645\u53d1\u751f\u7684\u65f6\u95f4\uff0c\u8fd9\u79cd\u5904\u7406\u65b9\u5f0f\u5c31\u5931\u6548\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_37","title":"\u4e8b\u4ef6\u65f6\u95f4\u4e0e\u5904\u7406\u65f6\u95f4","text":"<p>\u5f88\u591a\u539f\u56e0\u90fd\u53ef\u80fd\u5bfc\u81f4\u5904\u7406\u5ef6\u8fdf\uff1a\u6392\u961f\uff0c\u7f51\u7edc\u6545\u969c\uff0c\u6027\u80fd\u95ee\u9898\u5bfc\u81f4\u6d88\u606f\u4ee3\u7406 / \u6d88\u606f\u5904\u7406\u5668\u51fa\u73b0\u4e89\u7528\uff0c\u6d41\u6d88\u8d39\u8005\u91cd\u542f\uff0c\u4ece\u6545\u969c\u4e2d\u6062\u590d\u65f6\u91cd\u65b0\u5904\u7406\u8fc7\u53bb\u7684\u4e8b\u4ef6\uff0c\u6216\u8005\u5728\u4fee\u590d\u4ee3\u7801 BUG \u4e4b\u540e\u3002</p> <p>\u800c\u4e14\uff0c\u6d88\u606f\u5ef6\u8fdf\u8fd8\u53ef\u80fd\u5bfc\u81f4\u65e0\u6cd5\u9884\u6d4b\u6d88\u606f\u987a\u5e8f\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u7528\u6237\u9996\u5148\u53d1\u51fa\u4e00\u4e2a Web \u8bf7\u6c42\uff08\u7531 Web \u670d\u52a1\u5668 A \u5904\u7406\uff09\uff0c\u7136\u540e\u53d1\u51fa\u7b2c\u4e8c\u4e2a\u8bf7\u6c42\uff08\u7531\u670d\u52a1\u5668 B \u5904\u7406\uff09\u3002A \u548c B \u53d1\u51fa\u63cf\u8ff0\u5b83\u4eec\u6240\u5904\u7406\u8bf7\u6c42\u7684\u4e8b\u4ef6\uff0c\u4f46\u662f B \u7684\u4e8b\u4ef6\u5728 A \u7684\u4e8b\u4ef6\u53d1\u751f\u4e4b\u524d\u5230\u8fbe\u6d88\u606f\u4ee3\u7406\u3002\u73b0\u5728\uff0c\u6d41\u5904\u7406\u5668\u5c06\u9996\u5148\u770b\u5230 B \u4e8b\u4ef6\uff0c\u7136\u540e\u770b\u5230 A \u4e8b\u4ef6\uff0c\u5373\u4f7f\u5b83\u4eec\u5b9e\u9645\u4e0a\u662f\u4ee5\u76f8\u53cd\u7684\u987a\u5e8f\u53d1\u751f\u7684\u3002</p> <p>\u5c06\u4e8b\u4ef6\u65f6\u95f4\u548c\u5904\u7406\u65f6\u95f4\u641e\u6df7\u4f1a\u5bfc\u81f4\u9519\u8bef\u7684\u6570\u636e\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u4f60\u6709\u4e00\u4e2a\u6d41\u5904\u7406\u5668\u7528\u4e8e\u6d4b\u91cf\u8bf7\u6c42\u901f\u7387\uff08\u8ba1\u7b97\u6bcf\u79d2\u8bf7\u6c42\u6570\uff09\u3002\u5982\u679c\u4f60\u91cd\u65b0\u90e8\u7f72\u6d41\u5904\u7406\u5668\uff0c\u5b83\u53ef\u80fd\u4f1a\u505c\u6b62\u4e00\u5206\u949f\uff0c\u5e76\u5728\u6062\u590d\u4e4b\u540e\u5904\u7406\u79ef\u538b\u7684\u4e8b\u4ef6\u3002\u5982\u679c\u4f60\u6309\u5904\u7406\u65f6\u95f4\u6765\u8861\u91cf\u901f\u7387\uff0c\u90a3\u4e48\u5728\u5904\u7406\u79ef\u538b\u65e5\u5fd7\u65f6\uff0c\u8bf7\u6c42\u901f\u7387\u770b\u4e0a\u53bb\u5c31\u50cf\u6709\u4e00\u4e2a\u5f02\u5e38\u7684\u7a81\u53d1\u5c16\u5cf0\uff0c\u800c\u5b9e\u9645\u4e0a\u8bf7\u6c42\u901f\u7387\u662f\u7a33\u5b9a\u7684\u3002</p> <p></p> \u56fe 11-7 \u6309\u5904\u7406\u65f6\u95f4\u5206\u7a97\uff0c\u4f1a\u56e0\u4e3a\u5904\u7406\u901f\u7387\u7684\u53d8\u52a8\u5f15\u5165\u4eba\u4e3a\u56e0\u7d20"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_38","title":"\u77e5\u9053\u4ec0\u4e48\u65f6\u5019\u51c6\u5907\u597d\u4e86","text":"<p>\u6c38\u8fdc\u4e5f\u65e0\u6cd5\u786e\u5b9a\u662f\u4e0d\u662f\u5df2\u7ecf\u6536\u5230\u4e86\u7279\u5b9a\u7a97\u53e3\u7684\u6240\u6709\u4e8b\u4ef6\uff0c\u8fd8\u662f\u8bf4\u8fd8\u6709\u4e00\u4e9b\u4e8b\u4ef6\u6b63\u5728\u6765\u7684\u8def\u4e0a\u3002</p> <ul> <li>\u4f8b\u5982\uff0c\u5047\u8bbe\u4f60\u5c06\u4e8b\u4ef6\u5206\u7ec4\u4e3a\u4e00\u5206\u949f\u7684\u7a97\u53e3\uff0c\u4ee5\u4fbf\u7edf\u8ba1\u6bcf\u5206\u949f\u7684\u8bf7\u6c42\u6570\u3002</li> </ul> <p>\u5728\u4e00\u6bb5\u65f6\u95f4\u6ca1\u6709\u770b\u5230\u4efb\u4f55\u65b0\u7684\u4e8b\u4ef6\u4e4b\u540e\uff0c\u4f60\u53ef\u4ee5\u8d85\u65f6\u5e76\u5ba3\u5e03\u4e00\u4e2a\u7a97\u53e3\u5df2\u7ecf\u5c31\u7eea\uff0c\u4f46\u4ecd\u7136\u53ef\u80fd\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\uff1a\u67d0\u4e9b\u4e8b\u4ef6\u88ab\u7f13\u51b2\u5728\u53e6\u4e00\u53f0\u673a\u5668\u4e0a\uff0c\u7531\u4e8e\u7f51\u7edc\u4e2d\u65ad\u800c\u5ef6\u8fdf\u3002\u9700\u8981\u80fd\u591f\u5904\u7406\u8fd9\u79cd\u5728\u7a97\u53e3\u5ba3\u544a\u5b8c\u6210\u4e4b\u540e\u5230\u8fbe\u7684 \u6ede\u7559\uff08straggler\uff09 \u4e8b\u4ef6\u3002\u5927\u4f53\u4e0a\uff0c\u4f60\u6709\u4e24\u79cd\u9009\u62e9\u30101\u3011\uff1a</p> <ul> <li>\u5ffd\u7565\u8fd9\u4e9b\u6ede\u7559\u4e8b\u4ef6\uff0c\u56e0\u4e3a\u5728\u6b63\u5e38\u60c5\u51b5\u4e0b\u5b83\u4eec\u53ef\u80fd\u53ea\u662f\u4e8b\u4ef6\u4e2d\u7684\u4e00\u5c0f\u90e8\u5206\u3002</li> <li>\u53d1\u5e03\u4e00\u4e2a \u66f4\u6b63\uff08correction\uff09\uff0c\u4e00\u4e2a\u5305\u62ec\u6ede\u7559\u4e8b\u4ef6\u7684\u66f4\u65b0\u7a97\u53e3\u503c\u3002\u4f60\u53ef\u80fd\u8fd8\u9700\u8981\u6536\u56de\u4ee5\u524d\u7684\u8f93\u51fa\u3002</li> </ul> <p>\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528\u7279\u6b8a\u7684\u6d88\u606f\u6765\u6307\u793a \u201c\u4ece\u73b0\u5728\u5f00\u59cb\uff0c\u4e0d\u4f1a\u6709\u6bd4 t \u66f4\u65e9\u65f6\u95f4\u6233\u7684\u6d88\u606f\u4e86\u201d\uff0c\u6d88\u8d39\u8005\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u89e6\u53d1\u7a97\u53e3\u301081\u3011\u3002\u4f46\u662f\uff0c\u5982\u679c\u4e0d\u540c\u673a\u5668\u4e0a\u7684\u591a\u4e2a\u751f\u4ea7\u8005\u90fd\u5728\u751f\u6210\u4e8b\u4ef6\uff0c\u6bcf\u4e2a\u751f\u4ea7\u8005\u90fd\u6709\u81ea\u5df1\u7684\u6700\u5c0f\u65f6\u95f4\u6233\u9608\u503c\uff0c\u5219\u6d88\u8d39\u8005\u9700\u8981\u5206\u522b\u8ddf\u8e2a\u6bcf\u4e2a\u751f\u4ea7\u8005\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6dfb\u52a0\u548c\u5220\u9664\u751f\u4ea7\u8005\u90fd\u662f\u6bd4\u8f83\u68d8\u624b\u7684\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_39","title":"\u4f60\u7528\u7684\u662f\u8c01\u7684\u65f6\u949f\uff1f","text":"<p>\u5f53\u4e8b\u4ef6\u53ef\u80fd\u5728\u7cfb\u7edf\u5185\u591a\u4e2a\u5730\u65b9\u8fdb\u884c\u7f13\u51b2\u65f6\uff0c\u4e3a\u4e8b\u4ef6\u5206\u914d\u65f6\u95f4\u6233\u66f4\u52a0\u56f0\u96be\u3002</p> <ul> <li>\u4f8b\u5982\uff0c\u8003\u8651\u4e00\u4e2a\u79fb\u52a8\u5e94\u7528\u5411\u670d\u52a1\u5668\u4e0a\u62a5\u5173\u4e8e\u7528\u91cf\u7684\u4e8b\u4ef6\u3002\u8be5\u5e94\u7528\u53ef\u80fd\u4f1a\u5728\u8bbe\u5907\u5904\u4e8e\u8131\u673a\u72b6\u6001\u65f6\u88ab\u4f7f\u7528</li> <li>\u5b83\u5c06\u5728\u8bbe\u5907\u672c\u5730\u7f13\u51b2\u4e8b\u4ef6\uff0c\u5e76\u5728\u4e0b\u4e00\u6b21\u4e92\u8054\u7f51\u8fde\u63a5\u53ef\u7528\u65f6\u5411\u670d\u52a1\u5668\u4e0a\u62a5\u8fd9\u4e9b\u4e8b\u4ef6\uff08\u53ef\u80fd\u662f\u51e0\u5c0f\u65f6\u751a\u81f3\u51e0\u5929\uff09\u3002\u5bf9\u4e8e\u8fd9\u4e2a\u6d41\u7684\u4efb\u610f\u6d88\u8d39\u8005\u800c\u8a00\uff0c\u5b83\u4eec\u5c31\u5982\u5ef6\u8fdf\u6781\u5927\u7684\u6ede\u7559\u4e8b\u4ef6\u4e00\u6837\u3002</li> </ul> <p>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e8b\u4ef6\u4e0a\u7684\u4e8b\u4ef6\u6233\u5b9e\u9645\u4e0a\u5e94\u5f53\u662f\u7528\u6237\u4ea4\u4e92\u53d1\u751f\u7684\u65f6\u95f4\uff0c\u53d6\u51b3\u4e8e\u79fb\u52a8\u8bbe\u5907\u7684\u672c\u5730\u65f6\u949f\u3002</p> <ul> <li>\u7528\u6237\u63a7\u5236\u7684\u8bbe\u5907\u4e0a\u7684\u65f6\u949f\u901a\u5e38\u662f\u4e0d\u53ef\u4fe1\u7684\uff0c\u56e0\u4e3a\u5b83\u53ef\u80fd\u4f1a\u88ab\u65e0\u610f\u6216\u6545\u610f\u8bbe\u7f6e\u6210\u9519\u8bef\u7684\u65f6\u95f4\u3002</li> <li>\u670d\u52a1\u5668\u6536\u5230\u4e8b\u4ef6\u7684\u65f6\u95f4\uff08\u53d6\u51b3\u4e8e\u670d\u52a1\u5668\u7684\u65f6\u949f\uff09\u53ef\u80fd\u662f\u66f4\u51c6\u786e\u7684\uff0c\u56e0\u4e3a\u670d\u52a1\u5668\u5728\u4f60\u7684\u63a7\u5236\u4e4b\u4e0b\uff0c\u4f46\u5728\u63cf\u8ff0\u7528\u6237\u4ea4\u4e92\u65b9\u9762\u610f\u4e49\u4e0d\u5927\u3002</li> </ul> <p>\u8981\u6821\u6b63\u4e0d\u6b63\u786e\u7684\u8bbe\u5907\u65f6\u949f\uff0c\u4e00\u79cd\u65b9\u6cd5\u662f\u8bb0\u5f55\u4e09\u4e2a\u65f6\u95f4\u6233\u301082\u3011\uff1a</p> <ul> <li>\u4e8b\u4ef6\u53d1\u751f\u7684\u65f6\u95f4\uff0c\u53d6\u51b3\u4e8e\u8bbe\u5907\u65f6\u949f</li> <li>\u4e8b\u4ef6\u53d1\u9001\u5f80\u670d\u52a1\u5668\u7684\u65f6\u95f4\uff0c\u53d6\u51b3\u4e8e\u8bbe\u5907\u65f6\u949f</li> <li>\u4e8b\u4ef6\u88ab\u670d\u52a1\u5668\u63a5\u6536\u7684\u65f6\u95f4\uff0c\u53d6\u51b3\u4e8e\u670d\u52a1\u5668\u65f6\u949f</li> </ul> <p>\u901a\u8fc7\u4ece\u7b2c\u4e09\u4e2a\u65f6\u95f4\u6233\u4e2d\u51cf\u53bb\u7b2c\u4e8c\u4e2a\u65f6\u95f4\u6233\uff0c\u53ef\u4ee5\u4f30\u7b97\u8bbe\u5907\u65f6\u949f\u548c\u670d\u52a1\u5668\u65f6\u949f\u4e4b\u95f4\u7684\u504f\u79fb\uff08\u5047\u8bbe\u7f51\u7edc\u5ef6\u8fdf\u4e0e\u6240\u9700\u7684\u65f6\u95f4\u6233\u7cbe\u5ea6\u76f8\u6bd4\u53ef\u5ffd\u7565\u4e0d\u8ba1\uff09\u3002\u7136\u540e\u53ef\u4ee5\u5c06\u8be5\u504f\u79fb\u5e94\u7528\u4e8e\u4e8b\u4ef6\u65f6\u95f4\u6233\uff0c\u4ece\u800c\u4f30\u8ba1\u4e8b\u4ef6\u5b9e\u9645\u53d1\u751f\u7684\u771f\u5b9e\u65f6\u95f4\uff08\u5047\u8bbe\u8bbe\u5907\u65f6\u949f\u504f\u79fb\u5728\u4e8b\u4ef6\u53d1\u751f\u65f6\u4e0e\u9001\u5f80\u670d\u52a1\u5668\u4e4b\u95f4\u6ca1\u6709\u53d8\u5316\uff09\u3002</p> <p>\u8fd9\u5e76\u4e0d\u662f\u6d41\u5904\u7406\u72ec\u6709\u7684\u95ee\u9898\uff0c\u6279\u5904\u7406\u6709\u7740\u5b8c\u5168\u4e00\u6837\u7684\u65f6\u95f4\u63a8\u7406\u95ee\u9898\u3002\u53ea\u662f\u5728\u6d41\u5904\u7406\u7684\u4e0a\u4e0b\u6587\u4e2d\uff0c\u6211\u4eec\u66f4\u5bb9\u6613\u610f\u8bc6\u5230\u65f6\u95f4\u7684\u6d41\u901d\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_40","title":"\u7a97\u53e3\u7684\u7c7b\u578b","text":"<p>\u5f53\u4f60\u77e5\u9053\u5982\u4f55\u786e\u5b9a\u4e00\u4e2a\u4e8b\u4ef6\u7684\u65f6\u95f4\u6233\u540e\uff0c\u4e0b\u4e00\u6b65\u5c31\u662f\u5982\u4f55\u5b9a\u4e49\u65f6\u95f4\u6bb5\u7684\u7a97\u53e3\u3002\u6709\u51e0\u79cd\u7a97\u53e3\u5f88\u5e38\u7528\u301079,83\u3011\uff1a</p> <ul> <li>\u6eda\u52a8\u7a97\u53e3\uff08Tumbling Window\uff09\uff1a\u6eda\u52a8\u7a97\u53e3\u6709\u7740\u56fa\u5b9a\u7684\u957f\u5ea6\uff0c\u6bcf\u4e2a\u4e8b\u4ef6\u90fd\u4ec5\u80fd\u5c5e\u4e8e\u4e00\u4e2a\u7a97\u53e3\u3002</li> <li>\u5047\u8bbe 1 \u5206\u949f\u7684\u6eda\u52a8\u7a97\u53e3\uff0c\u5219\u6240\u6709\u65f6\u95f4\u6233\u5728 <code>10:03:00</code> \u548c <code>10:03:59</code> \u4e4b\u95f4\u7684\u4e8b\u4ef6\u4f1a\u88ab\u5206\u7ec4\u5230\u4e00\u4e2a\u7a97\u53e3\u4e2d</li> <li><code>10:04:00</code> \u548c <code>10:04:59</code> \u4e4b\u95f4\u7684\u4e8b\u4ef6\u88ab\u5206\u7ec4\u5230\u4e0b\u4e00\u4e2a\u7a97\u53e3\uff0c\u4f9d\u6b64\u7c7b\u63a8</li> <li>\u901a\u8fc7\u5c06\u6bcf\u4e2a\u4e8b\u4ef6\u65f6\u95f4\u6233\u56db\u820d\u4e94\u5165\u81f3\u6700\u8fd1\u7684\u5206\u949f\u6765\u786e\u5b9a\u5b83\u6240\u5c5e\u7684\u7a97\u53e3\uff0c\u53ef\u4ee5\u5b9e\u73b0 1 \u5206\u949f\u7684\u6eda\u52a8\u7a97\u53e3\u3002</li> <li>\u8df3\u52a8\u7a97\u53e3\uff08Hopping Window\uff09\uff1a\u56fa\u5b9a\u7684\u957f\u5ea6\uff0c\u4f46\u5141\u8bb8\u7a97\u53e3\u91cd\u53e0\u4ee5\u63d0\u4f9b\u4e00\u4e9b\u5e73\u6ed1\u3002</li> <li>\u4e00\u4e2a\u5e26\u6709 1 \u5206\u949f\u8df3\u8dc3\u6b65\u957f\u7684 5 \u5206\u949f\u7a97\u53e3\u5c06\u5305\u542b <code>10:03:00</code> \u81f3 <code>10:07:59</code> \u4e4b\u95f4\u7684\u4e8b\u4ef6\uff0c\u800c\u4e0b\u4e00\u4e2a\u7a97\u53e3\u5c06\u8986\u76d6 <code>10:04:00</code> \u81f3 <code>10:08:59</code> \u4e4b\u95f4\u7684\u4e8b\u4ef6\uff0c\u7b49\u7b49\u3002</li> <li>\u901a\u8fc7\u9996\u5148\u8ba1\u7b97 1 \u5206\u949f\u7684\u6eda\u52a8\u7a97\u53e3\uff08tunmbling window\uff09\uff0c\u7136\u540e\u5728\u51e0\u4e2a\u76f8\u90bb\u7a97\u53e3\u4e0a\u8fdb\u884c\u805a\u5408\uff0c\u53ef\u4ee5\u5b9e\u73b0\u8fd9\u79cd\u8df3\u52a8\u7a97\u53e3\u3002</li> <li>\u6ed1\u52a8\u7a97\u53e3\uff08Sliding Window\uff09\uff1a\u5f7c\u6b64\u95f4\u8ddd\u5728\u7279\u5b9a\u65f6\u957f\u5185\u7684\u6240\u6709\u4e8b\u4ef6</li> <li>\u4e00\u4e2a 5 \u5206\u949f\u7684\u6ed1\u52a8\u7a97\u53e3\u5e94\u5f53\u8986\u76d6 <code>10:03:39</code> \u548c <code>10:08:12</code> \u7684\u4e8b\u4ef6\uff0c\u56e0\u4e3a\u5b83\u4eec\u76f8\u8ddd\u4e0d\u8d85\u8fc7 5 \u5206\u949f</li> <li>\u6eda\u52a8\u7a97\u53e3\u4e0e\u6b65\u957f 5 \u5206\u949f\u7684\u8df3\u52a8\u7a97\u53e3\u53ef\u80fd\u4e0d\u4f1a\u628a\u8fd9\u4e24\u4e2a\u4e8b\u4ef6\u5206\u7ec4\u5230\u540c\u4e00\u4e2a\u7a97\u53e3\u4e2d\uff0c\u56e0\u4e3a\u5b83\u4eec\u4f7f\u7528\u56fa\u5b9a\u7684\u8fb9\u754c</li> <li>\u901a\u8fc7\u7ef4\u62a4\u4e00\u4e2a\u6309\u65f6\u95f4\u6392\u5e8f\u7684\u4e8b\u4ef6\u7f13\u51b2\u533a\uff0c\u5e76\u4e0d\u65ad\u4ece\u7a97\u53e3\u4e2d\u79fb\u9664\u8fc7\u671f\u7684\u65e7\u4e8b\u4ef6\uff0c\u53ef\u4ee5\u5b9e\u73b0\u6ed1\u52a8\u7a97\u53e3\u3002</li> <li>\u4f1a\u8bdd\u7a97\u53e3\uff08Session window\uff09\uff1a\u4e0e\u5176\u4ed6\u7a97\u53e3\u7c7b\u578b\u4e0d\u540c\uff0c\u4f1a\u8bdd\u7a97\u53e3\u6ca1\u6709\u56fa\u5b9a\u7684\u6301\u7eed\u65f6\u95f4</li> <li>\u5c06\u540c\u4e00\u7528\u6237\u51fa\u73b0\u65f6\u95f4\u76f8\u8fd1\u7684\u6240\u6709\u4e8b\u4ef6\u5206\u7ec4\u5728\u4e00\u8d77\uff0c\u800c\u5f53\u7528\u6237\u4e00\u6bb5\u65f6\u95f4\u6ca1\u6709\u6d3b\u52a8\u65f6\uff08\u4f8b\u5982\uff0c\u5982\u679c 30 \u5206\u949f\u5185\u6ca1\u6709\u4e8b\u4ef6\uff09\u7a97\u53e3\u7ed3\u675f\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_41","title":"\u6d41\u8fde\u63a5","text":"<p>\u7531\u4e8e\u6d41\u5904\u7406\u5c06\u6570\u636e\u7ba1\u9053\u6cdb\u5316\u4e3a\u5bf9\u65e0\u9650\u6570\u636e\u96c6\u8fdb\u884c\u589e\u91cf\u5904\u7406\uff0c\u56e0\u6b64\u5bf9\u6d41\u8fdb\u884c\u8fde\u63a5\u7684\u9700\u6c42\u4e5f\u662f\u5b8c\u5168\u76f8\u540c\u7684\u3002\u5148\u6765\u533a\u5206\u4e09\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u8fde\u63a5\uff1a\u6d41 - \u6d41 \u8fde\u63a5\uff0c\u6d41 - \u8868 \u8fde\u63a5\uff0c\u4e0e \u8868 - \u8868 \u8fde\u63a5\u301084\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_42","title":"\u6d41\u6d41\u8fde\u63a5\uff08\u7a97\u53e3\u8fde\u63a5\uff09","text":"<p>\u5047\u8bbe\u4f60\u7684\u7f51\u7ad9\u4e0a\u6709\u641c\u7d22\u529f\u80fd\uff0c\u800c\u4f60\u60f3\u8981\u627e\u51fa\u641c\u7d22 URL \u7684\u8fd1\u671f\u8d8b\u52bf\u3002\u6bcf\u5f53\u6709\u4eba\u952e\u5165\u641c\u7d22\u67e5\u8be2\u65f6\uff0c\u90fd\u4f1a\u8bb0\u5f55\u4e0b\u4e00\u4e2a\u5305\u542b\u67e5\u8be2\u4e0e\u5176\u8fd4\u56de\u7ed3\u679c\u7684\u4e8b\u4ef6\u3002\u6bcf\u5f53\u6709\u4eba\u70b9\u51fb\u5176\u4e2d\u4e00\u4e2a\u641c\u7d22\u7ed3\u679c\u65f6\uff0c\u5c31\u4f1a\u8bb0\u5f55\u53e6\u4e00\u4e2a\u8bb0\u5f55\u70b9\u51fb\u4e8b\u4ef6\u3002\u4e3a\u4e86\u8ba1\u7b97\u641c\u7d22\u7ed3\u679c\u4e2d\u6bcf\u4e2a URL \u7684\u70b9\u51fb\u7387\uff0c\u4f60\u9700\u8981\u5c06\u641c\u7d22\u52a8\u4f5c\u4e0e\u70b9\u51fb\u52a8\u4f5c\u7684\u4e8b\u4ef6\u8fde\u5728\u4e00\u8d77\uff0c\u8fd9\u4e9b\u4e8b\u4ef6\u901a\u8fc7\u76f8\u540c\u7684\u4f1a\u8bdd ID \u8fdb\u884c\u8fde\u63a5\u3002\u5e7f\u544a\u7cfb\u7edf\u4e2d\u9700\u8981\u7c7b\u4f3c\u7684\u5206\u6790\u301085\u3011\u3002</p> <ul> <li>\u641c\u7d22\u4e0e\u70b9\u51fb\u4e4b\u95f4\u7684\u65f6\u95f4\u53ef\u80fd\u662f\u9ad8\u5ea6\u53ef\u53d8\uff1a\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\uff0c\u5b83\u53ef\u80fd\u662f\u51e0\u79d2\u949f\uff0c\u4f46\u4e5f\u53ef\u80fd\u957f\u8fbe\u51e0\u5929\u6216\u51e0\u5468\uff1b</li> <li>\u7531\u4e8e\u53ef\u53d8\u7684\u7f51\u7edc\u5ef6\u8fdf\uff0c\u70b9\u51fb\u4e8b\u4ef6\u751a\u81f3\u53ef\u80fd\u5148\u4e8e\u641c\u7d22\u4e8b\u4ef6\u5230\u8fbe\uff1b</li> <li>\u9009\u62e9\u5408\u9002\u7684\u8fde\u63a5\u7a97\u53e3 \u2014\u2014 \u4f8b\u5982\uff0c\u5982\u679c\u70b9\u51fb\u4e0e\u641c\u7d22\u4e4b\u95f4\u7684\u65f6\u95f4\u95f4\u9694\u5728\u4e00\u5c0f\u65f6\u5185\uff0c\u4f60\u53ef\u80fd\u4f1a\u9009\u62e9\u8fde\u63a5\u4e24\u8005\u3002</li> </ul> <p>\u5728\u70b9\u51fb\u4e8b\u4ef6\u4e2d\u5d4c\u5165\u641c\u7d22\u8be6\u60c5\u4e0e\u4e8b\u4ef6\u8fde\u63a5\u5e76\u4e0d\u4e00\u6837\uff1a\u8fd9\u6837\u505a\u7684\u8bdd\uff0c\u53ea\u6709\u5f53\u7528\u6237\u70b9\u51fb\u4e86\u4e00\u4e2a\u641c\u7d22\u7ed3\u679c\u65f6\u4f60\u624d\u80fd\u77e5\u9053\uff0c\u800c\u90a3\u4e9b\u6ca1\u6709\u70b9\u51fb\u7684\u641c\u7d22\u5c31\u65e0\u80fd\u4e3a\u529b\u4e86\u3002\u4e3a\u4e86\u8861\u91cf\u641c\u7d22\u8d28\u91cf\uff0c\u4f60\u9700\u8981\u51c6\u786e\u7684\u70b9\u51fb\u7387\uff0c\u4e3a\u6b64\u641c\u7d22\u4e8b\u4ef6\u548c\u70b9\u51fb\u4e8b\u4ef6\u4e24\u8005\u90fd\u662f\u5fc5\u8981\u7684\u3002</p> <p>\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u79cd\u7c7b\u578b\u7684\u8fde\u63a5\uff0c\u6d41\u5904\u7406\u5668\u9700\u8981\u7ef4\u62a4 \u72b6\u6001\uff1a</p> <ul> <li>\u4f8b\u5982\uff0c\u6309\u4f1a\u8bdd ID \u7d22\u5f15\u6700\u8fd1\u4e00\u5c0f\u65f6\u5185\u53d1\u751f\u7684\u6240\u6709\u4e8b\u4ef6\u3002\u65e0\u8bba\u4f55\u65f6\u53d1\u751f\u641c\u7d22\u4e8b\u4ef6\u6216\u70b9\u51fb\u4e8b\u4ef6\uff0c\u90fd\u4f1a\u88ab\u6dfb\u52a0\u5230\u5408\u9002\u7684\u7d22\u5f15\u4e2d\uff0c\u800c\u6d41\u5904\u7406\u5668\u4e5f\u4f1a\u68c0\u67e5\u53e6\u4e00\u4e2a\u7d22\u5f15\u662f\u5426\u6709\u5177\u6709\u76f8\u540c\u4f1a\u8bdd ID \u7684\u4e8b\u4ef6\u5230\u8fbe\u3002</li> <li>\u5982\u679c\u6709\u5339\u914d\u4e8b\u4ef6\u5c31\u4f1a\u53d1\u51fa\u4e00\u4e2a\u8868\u793a\u641c\u7d22\u7ed3\u679c\u88ab\u70b9\u51fb\u7684\u4e8b\u4ef6\uff1b\u5982\u679c\u641c\u7d22\u4e8b\u4ef6\u76f4\u5230\u8fc7\u671f\u90fd\u6ca1\u770b\u89c1\u6709\u5339\u914d\u7684\u70b9\u51fb\u4e8b\u4ef6\uff0c\u5c31\u4f1a\u53d1\u51fa\u4e00\u4e2a\u8868\u793a\u641c\u7d22\u7ed3\u679c\u672a\u88ab\u70b9\u51fb\u7684\u4e8b\u4ef6\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_43","title":"\u6d41\u8868\u8fde\u63a5\uff08\u6d41\u6269\u5145\uff09","text":"<p>\u8fde\u63a5\u4e24\u4e2a\u6570\u636e\u96c6\u7684\u6279\u5904\u7406\u4f5c\u4e1a\u793a\u4f8b\uff1a\u4e00\u7ec4\u7528\u6237\u6d3b\u52a8\u4e8b\u4ef6\u548c\u4e00\u4e2a\u7528\u6237\u6863\u6848\u6570\u636e\u5e93\u3002\u5c06\u7528\u6237\u6d3b\u52a8\u4e8b\u4ef6\u89c6\u4e3a\u6d41\uff0c\u5e76\u5728\u6d41\u5904\u7406\u5668\u4e2d\u8fde\u7eed\u6267\u884c\u76f8\u540c\u7684\u8fde\u63a5\u662f\u5f88\u81ea\u7136\u7684\u60f3\u6cd5\uff1a\u8f93\u5165\u662f\u5305\u542b\u7528\u6237 ID \u7684\u6d3b\u52a8\u4e8b\u4ef6\u6d41\uff0c\u800c\u8f93\u51fa\u8fd8\u662f\u6d3b\u52a8\u4e8b\u4ef6\u6d41\uff0c\u4f46\u5176\u4e2d\u7528\u6237 ID \u5df2\u7ecf\u88ab\u6269\u5c55\u4e3a\u7528\u6237\u7684\u6863\u6848\u4fe1\u606f\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u6709\u65f6\u88ab\u79f0\u4e3a\u4f7f\u7528\u6570\u636e\u5e93\u7684\u4fe1\u606f\u6765 \u6269\u5145\uff08enriching\uff09 \u6d3b\u52a8\u4e8b\u4ef6\u3002</p> <p>\u8981\u6267\u884c\u6b64\u8fde\u63a5\uff0c\u6d41\u5904\u7406\u5668\u9700\u8981\u4e00\u6b21\u5904\u7406\u4e00\u4e2a\u6d3b\u52a8\u4e8b\u4ef6\uff0c\u5728\u6570\u636e\u5e93\u4e2d\u67e5\u627e\u4e8b\u4ef6\u7684\u7528\u6237 ID\uff0c\u5e76\u5c06\u6863\u6848\u4fe1\u606f\u6dfb\u52a0\u5230\u6d3b\u52a8\u4e8b\u4ef6\u4e2d\u3002</p> <ul> <li>\u6570\u636e\u5e93\u67e5\u8be2\u53ef\u4ee5\u901a\u8fc7\u67e5\u8be2\u8fdc\u7a0b\u6570\u636e\u5e93\u6765\u5b9e\u73b0\uff0c\u6b64\u7c7b\u8fdc\u7a0b\u67e5\u8be2\u53ef\u80fd\u4f1a\u5f88\u6162\uff0c\u5e76\u4e14\u6709\u53ef\u80fd\u5bfc\u81f4\u6570\u636e\u5e93\u8fc7\u8f7d\u301075\u3011\u3002</li> <li>\u5c06\u6570\u636e\u5e93\u526f\u672c\u52a0\u8f7d\u5230\u6d41\u5904\u7406\u5668\u4e2d\uff0c\u4ee5\u4fbf\u5728\u672c\u5730\u8fdb\u884c\u67e5\u8be2\u800c\u65e0\u9700\u7f51\u7edc\u5f80\u8fd4\u3002\u5982\u679c\u6570\u636e\u5e93\u7684\u672c\u5730\u526f\u672c\u8db3\u591f\u5c0f\uff0c\u5219\u53ef\u4ee5\u662f\u5185\u5b58\u4e2d\u7684\u6563\u5217\u8868\uff0c\u6bd4\u8f83\u5927\u7684\u8bdd\u4e5f\u53ef\u4ee5\u662f\u672c\u5730\u78c1\u76d8\u4e0a\u7684\u7d22\u5f15\u3002</li> </ul> <p>\u6d41\u5904\u7406\u5668\u662f\u957f\u65f6\u95f4\u8fd0\u884c\u7684\uff0c\u4e14\u6570\u636e\u5e93\u7684\u5185\u5bb9\u53ef\u80fd\u968f\u65f6\u95f4\u800c\u6539\u53d8\uff0c\u6240\u4ee5\u6d41\u5904\u7406\u5668\u6570\u636e\u5e93\u7684\u672c\u5730\u526f\u672c\u9700\u8981\u4fdd\u6301\u66f4\u65b0\u3002</p> <ul> <li>\u901a\u8fc7\u53d8\u66f4\u6570\u636e\u6355\u83b7\u6765\u89e3\u51b3\uff1a\u6d41\u5904\u7406\u5668\u53ef\u4ee5\u8ba2\u9605\u7528\u6237\u6863\u6848\u6570\u636e\u5e93\u7684\u66f4\u65b0\u65e5\u5fd7\uff0c\u5982\u540c\u6d3b\u52a8\u4e8b\u4ef6\u6d41\u4e00\u6837\u3002\u5f53\u589e\u6dfb\u6216\u4fee\u6539\u6863\u6848\u65f6\uff0c\u6d41\u5904\u7406\u5668\u4f1a\u66f4\u65b0\u5176\u672c\u5730\u526f\u672c\u3002</li> </ul> <p>\u6d41\u8868\u8fde\u63a5\u5b9e\u9645\u4e0a\u975e\u5e38\u7c7b\u4f3c\u4e8e\u6d41\u6d41\u8fde\u63a5\uff1b\u6700\u5927\u7684\u533a\u522b\u5728\u4e8e\u5bf9\u4e8e\u8868\u7684\u53d8\u66f4\u65e5\u5fd7\u6d41\uff0c\u8fde\u63a5\u4f7f\u7528\u4e86\u4e00\u4e2a\u53ef\u4ee5\u56de\u6eaf\u5230 \u201c\u65f6\u95f4\u8d77\u70b9\u201d \u7684\u7a97\u53e3\uff08\u6982\u5ff5\u4e0a\u662f\u65e0\u9650\u7684\u7a97\u53e3\uff09\uff0c\u65b0\u7248\u672c\u7684\u8bb0\u5f55\u4f1a\u8986\u76d6\u66f4\u65e9\u7684\u7248\u672c\u3002\u5bf9\u4e8e\u8f93\u5165\u7684\u6d41\uff0c\u8fde\u63a5\u53ef\u80fd\u538b\u6839\u513f\u5c31\u6ca1\u6709\u7ef4\u62a4\u4efb\u4f55\u7a97\u53e3\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_44","title":"\u8868\u8868\u8fde\u63a5\uff08\u7ef4\u62a4\u7269\u5316\u89c6\u56fe\uff09","text":"<p>\u63a8\u7279\u65f6\u95f4\u7ebf\u4f8b\u5b50\uff1a\u5f53\u7528\u6237\u60f3\u8981\u67e5\u770b\u4ed6\u4eec\u7684\u4e3b\u9875\u65f6\u95f4\u7ebf\u65f6\uff0c\u8fed\u4ee3\u7528\u6237\u6240\u5173\u6ce8\u4eba\u7fa4\u7684\u63a8\u6587\u5e76\u5408\u5e76\u5b83\u4eec\u662f\u4e00\u4e2a\u5f00\u9500\u5de8\u5927\u7684\u64cd\u4f5c\u3002</p> <ul> <li>\u9700\u8981\u4e00\u4e2a\u65f6\u95f4\u7ebf\u7f13\u5b58\uff1a\u4e00\u79cd\u6bcf\u4e2a\u7528\u6237\u7684 \u201c\u6536\u4ef6\u7bb1\u201d\uff0c\u5728\u53d1\u9001\u63a8\u6587\u7684\u65f6\u5019\u5199\u5165\u8fd9\u4e9b\u4fe1\u606f\uff0c\u56e0\u800c\u8bfb\u53d6\u65f6\u95f4\u7ebf\u65f6\u53ea\u9700\u8981\u7b80\u5355\u5730\u67e5\u8be2\u5373\u53ef\u3002</li> </ul> <p>\u7269\u5316\u4e0e\u7ef4\u62a4\u8fd9\u4e2a\u7f13\u5b58\u9700\u8981\u5904\u7406\u4ee5\u4e0b\u4e8b\u4ef6\uff1a</p> <ul> <li>\u5f53\u7528\u6237 u \u53d1\u9001\u65b0\u7684\u63a8\u6587\u65f6\uff0c\u5b83\u5c06\u88ab\u6dfb\u52a0\u5230\u6bcf\u4e2a\u5173\u6ce8\u7528\u6237 u \u7684\u65f6\u95f4\u7ebf\u4e0a\u3002</li> <li>\u7528\u6237\u5220\u9664\u63a8\u6587\u65f6\uff0c\u63a8\u6587\u5c06\u4ece\u6240\u6709\u7528\u6237\u7684\u65f6\u95f4\u8868\u4e2d\u5220\u9664\u3002</li> <li>\u5f53\u7528\u6237 u1 \u5f00\u59cb\u5173\u6ce8\u7528\u6237 u2 \u65f6\uff0c\\(u_2\\) \u6700\u8fd1\u7684\u63a8\u6587\u5c06\u88ab\u6dfb\u52a0\u5230 u1 \u7684\u65f6\u95f4\u7ebf\u4e0a\u3002</li> <li>\u5f53\u7528\u6237 u1 \u53d6\u6d88\u5173\u6ce8\u7528\u6237 u2 \u65f6\uff0c\\(u_2\\) \u7684\u63a8\u6587\u5c06\u4ece u1 \u7684\u65f6\u95f4\u7ebf\u4e2d\u79fb\u9664\u3002</li> </ul> <p>\u8981\u5728\u6d41\u5904\u7406\u5668\u4e2d\u5b9e\u73b0\u8fd9\u79cd\u7f13\u5b58\u7ef4\u62a4\uff0c\u4f60\u9700\u8981\u63a8\u6587\u4e8b\u4ef6\u6d41\uff08\u53d1\u9001\u4e0e\u5220\u9664\uff09\u548c\u5173\u6ce8\u5173\u7cfb\u4e8b\u4ef6\u6d41\uff08\u5173\u6ce8\u4e0e\u53d6\u6d88\u5173\u6ce8\uff09\u3002\u6d41\u5904\u7406\u9700\u8981\u7ef4\u62a4\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u5305\u542b\u6bcf\u4e2a\u7528\u6237\u7684\u7c89\u4e1d\u96c6\u5408\u3002\u4ee5\u4fbf\u77e5\u9053\u5f53\u4e00\u6761\u65b0\u63a8\u6587\u5230\u8fbe\u65f6\uff0c\u9700\u8981\u66f4\u65b0\u54ea\u4e9b\u65f6\u95f4\u7ebf\u301086\u3011\u3002</p> <p>\u89c2\u5bdf\u8fd9\u4e2a\u6d41\u5904\u7406\u8fc7\u7a0b\u7684\u53e6\u4e00\u79cd\u89c6\u89d2\u662f\uff1a\u5b83\u7ef4\u62a4\u4e86\u4e00\u4e2a\u8fde\u63a5\u4e86\u4e24\u4e2a\u8868\uff08\u63a8\u6587\u4e0e\u5173\u6ce8\uff09\u7684\u7269\u5316\u89c6\u56fe\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>SELECT follows.follower_id AS timeline_id,\n    array_agg(tweets.* ORDER BY tweets.timestamp DESC)\nFROM tweets\nJOIN follows ON follows.followee_id = tweets.sender_id\nGROUP BY follows.follower_id\n</code></pre> <p>\u6d41\u8fde\u63a5\u76f4\u63a5\u5bf9\u5e94\u4e8e\u8fd9\u4e2a\u67e5\u8be2\u4e2d\u7684\u8868\u8fde\u63a5\u3002\u65f6\u95f4\u7ebf\u5b9e\u9645\u4e0a\u662f\u8fd9\u4e2a\u67e5\u8be2\u7ed3\u679c\u7684\u7f13\u5b58\uff0c\u6bcf\u5f53\u5e95\u5c42\u7684\u8868\u53d1\u751f\u53d8\u5316\u65f6\u90fd\u4f1a\u66f4\u65b0 <sup>1</sup>\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_45","title":"\u8fde\u63a5\u7684\u65f6\u95f4\u4f9d\u8d56\u6027","text":"<p>\u8fd9\u91cc\u63cf\u8ff0\u7684\u4e09\u79cd\u8fde\u63a5\uff08\u6d41\u6d41\uff0c\u6d41\u8868\uff0c\u8868\u8868\uff09\u6709\u5f88\u591a\u5171\u901a\u4e4b\u5904\uff1a\u5b83\u4eec\u90fd\u9700\u8981\u6d41\u5904\u7406\u5668\u7ef4\u62a4\u8fde\u63a5\u4e00\u4fa7\u7684\u4e00\u4e9b\u72b6\u6001\uff08\u641c\u7d22\u4e0e\u70b9\u51fb\u4e8b\u4ef6\uff0c\u7528\u6237\u6863\u6848\uff0c\u5173\u6ce8\u5217\u8868\uff09\uff0c\u7136\u540e\u5f53\u8fde\u63a5\u53e6\u4e00\u4fa7\u7684\u6d88\u606f\u5230\u8fbe\u65f6\u67e5\u8be2\u8be5\u72b6\u6001\u3002</p> <p>\u7528\u4e8e\u7ef4\u62a4\u72b6\u6001\u7684\u4e8b\u4ef6\u987a\u5e8f\u662f\u5f88\u91cd\u8981\u7684\uff08\u5148\u5173\u6ce8\u7136\u540e\u53d6\u6d88\u5173\u6ce8\uff0c\u6216\u8005\u5176\u4ed6\u7c7b\u4f3c\u64cd\u4f5c\uff09\u3002\u5728\u5206\u533a\u65e5\u5fd7\u4e2d\uff0c\u5355\u4e2a\u5206\u533a\u5185\u7684\u4e8b\u4ef6\u987a\u5e8f\u662f\u4fdd\u7559\u4e0b\u6765\u7684\u3002\u4f46\u5178\u578b\u60c5\u51b5\u4e0b\u662f\u6ca1\u6709\u8de8\u6d41\u6216\u8de8\u5206\u533a\u7684\u987a\u5e8f\u4fdd\u8bc1\u7684\u3002</p> <p>\u5982\u679c\u4e0d\u540c\u6d41\u4e2d\u7684\u4e8b\u4ef6\u53d1\u751f\u5728\u8fd1\u4f3c\u7684\u65f6\u95f4\u8303\u56f4\u5185\uff0c\u5219\u5e94\u8be5\u6309\u7167\u4ec0\u4e48\u6837\u7684\u987a\u5e8f\u8fdb\u884c\u5904\u7406\uff1f</p> <ul> <li>\u5728\u6d41\u8868\u8fde\u63a5\u7684\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u7528\u6237\u66f4\u65b0\u4e86\u5b83\u4eec\u7684\u6863\u6848\uff0c\u54ea\u4e9b\u6d3b\u52a8\u4e8b\u4ef6\u4e0e\u65e7\u6863\u6848\u8fde\u63a5\uff08\u5728\u6863\u6848\u66f4\u65b0\u524d\u5904\u7406\uff09\uff0c\u54ea\u4e9b\u53c8\u4e0e\u65b0\u6863\u6848\u8fde\u63a5\uff08\u5728\u6863\u6848\u66f4\u65b0\u4e4b\u540e\u5904\u7406\uff09\uff1f</li> <li>\u9700\u8981\u5bf9\u4e00\u4e9b\u72b6\u6001\u505a\u8fde\u63a5\uff0c\u5982\u679c\u72b6\u6001\u4f1a\u968f\u7740\u65f6\u95f4\u63a8\u79fb\u800c\u53d8\u5316\uff0c\u90a3\u5e94\u5f53\u4f7f\u7528\u4ec0\u4e48\u65f6\u95f4\u70b9\u6765\u8fde\u63a5\u5462\u301045\u3011\uff1f</li> </ul> <p>\u8fd9\u79cd\u65f6\u5e8f\u4f9d\u8d56\u53ef\u80fd\u51fa\u73b0\u5728\u5f88\u591a\u5730\u65b9\u3002\u4f8b\u5982\u9500\u552e\u4e1c\u897f\u9700\u8981\u5bf9\u53d1\u7968\u5e94\u7528\u9002\u5f53\u7684\u7a0e\u7387\uff0c\u5f53\u8fde\u63a5\u9500\u552e\u989d\u4e0e\u7a0e\u7387\u8868\u65f6\uff0c\u4f60\u53ef\u80fd\u671f\u671b\u7684\u662f\u4f7f\u7528\u9500\u552e\u65f6\u7684\u7a0e\u7387\u53c2\u4e0e\u8fde\u63a5\u3002\u5982\u679c\u4f60\u6b63\u5728\u91cd\u65b0\u5904\u7406\u5386\u53f2\u6570\u636e\uff0c\u9500\u552e\u65f6\u7684\u7a0e\u7387\u53ef\u80fd\u548c\u73b0\u5728\u7684\u7a0e\u7387\u6709\u6240\u4e0d\u540c\u3002</p> <p>\u5982\u679c\u8de8\u8d8a\u6d41\u7684\u4e8b\u4ef6\u987a\u5e8f\u662f\u672a\u5b9a\u7684\uff0c\u5219\u8fde\u63a5\u4f1a\u53d8\u4e3a\u4e0d\u786e\u5b9a\u6027\u7684\u301087\u3011\uff0c\u8fd9\u610f\u5473\u7740\u4f60\u5728\u540c\u6837\u8f93\u5165\u4e0a\u91cd\u8dd1\u76f8\u540c\u7684\u4f5c\u4e1a\u672a\u5fc5\u4f1a\u5f97\u5230\u76f8\u540c\u7684\u7ed3\u679c\uff1a\u5f53\u4f60\u91cd\u8dd1\u4efb\u52a1\u65f6\uff0c\u8f93\u5165\u6d41\u4e0a\u7684\u4e8b\u4ef6\u53ef\u80fd\u4f1a\u4ee5\u4e0d\u540c\u7684\u65b9\u5f0f\u4ea4\u7ec7\u3002</p> <p>\u5728\u6570\u636e\u4ed3\u5e93\u4e2d\uff0c\u8fd9\u4e2a\u95ee\u9898\u88ab\u79f0\u4e3a \u7f13\u6162\u53d8\u5316\u7684\u7ef4\u5ea6\uff08slowly changing dimension, SCD\uff09\uff0c\u901a\u5e38\u901a\u8fc7\u5bf9\u7279\u5b9a\u7248\u672c\u7684\u8bb0\u5f55\u4f7f\u7528\u552f\u4e00\u7684\u6807\u8bc6\u7b26\u6765\u89e3\u51b3\uff1a\u4f8b\u5982\uff0c\u6bcf\u5f53\u7a0e\u7387\u6539\u53d8\u65f6\u90fd\u4f1a\u83b7\u5f97\u4e00\u4e2a\u65b0\u7684\u6807\u8bc6\u7b26\uff0c\u800c\u53d1\u7968\u5728\u9500\u552e\u65f6\u4f1a\u5e26\u6709\u7a0e\u7387\u7684\u6807\u8bc6\u7b26\u301088,89\u3011\u3002\u8fd9\u79cd\u53d8\u5316\u4f7f\u8fde\u63a5\u53d8\u4e3a\u786e\u5b9a\u6027\u7684\uff0c\u4f46\u4e5f\u4f1a\u5bfc\u81f4\u65e5\u5fd7\u538b\u7f29\u65e0\u6cd5\u8fdb\u884c\uff1a\u8868\u4e2d\u6240\u6709\u7684\u8bb0\u5f55\u7248\u672c\u90fd\u9700\u8981\u4fdd\u7559\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_46","title":"\u5bb9\u9519","text":"<p>\u6279\u5904\u7406\u5bb9\u9519\u65b9\u6cd5\u53ef\u786e\u4fdd\u6279\u5904\u7406\u4f5c\u4e1a\u7684\u8f93\u51fa\u4e0e\u6ca1\u6709\u51fa\u9519\u7684\u60c5\u51b5\u76f8\u540c\uff0c\u5373\u4f7f\u5b9e\u9645\u4e0a\u67d0\u4e9b\u4efb\u52a1\u5931\u8d25\u4e86\u3002\u5c3d\u7ba1\u91cd\u542f\u4efb\u52a1\u610f\u5473\u7740\u5b9e\u9645\u4e0a\u53ef\u80fd\u4f1a\u591a\u6b21\u5904\u7406\u8bb0\u5f55\uff0c\u4f46\u8f93\u51fa\u4e2d\u7684\u53ef\u89c1\u6548\u679c\u770b\u4e0a\u53bb\u5c31\u50cf\u53ea\u5904\u7406\u8fc7\u4e00\u6b21\u3002\u8fd9\u4e2a\u539f\u5219\u88ab\u79f0\u4e3a \u6070\u597d\u4e00\u6b21\u8bed\u4e49\uff08exactly-once semantics\uff09\uff0c\u5c3d\u7ba1 \u7b49\u6548\u4e00\u6b21\uff08effectively-once\uff09 \u53ef\u80fd\u4f1a\u662f\u4e00\u4e2a\u66f4\u5199\u5b9e\u7684\u672f\u8bed\u301090\u3011</p> <p>\u5728\u6d41\u5904\u7406\u4e2d\u4e5f\u51fa\u73b0\u4e86\u540c\u6837\u7684\u5bb9\u9519\u95ee\u9898\uff0c\u4f46\u662f\u5904\u7406\u8d77\u6765\u6ca1\u6709\u90a3\u4e48\u76f4\u89c2\uff1a\u7b49\u5f85\u67d0\u4e2a\u4efb\u52a1\u5b8c\u6210\u4e4b\u540e\u518d\u4f7f\u5176\u8f93\u51fa\u53ef\u89c1\u5e76\u4e0d\u662f\u4e00\u4e2a\u53ef\u884c\u9009\u9879\uff0c\u56e0\u4e3a\u4f60\u6c38\u8fdc\u65e0\u6cd5\u5904\u7406\u5b8c\u4e00\u4e2a\u65e0\u9650\u7684\u6d41\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_47","title":"\u5fae\u6279\u91cf\u4e0e\u5b58\u6863\u70b9","text":"<p>\u4e00\u4e2a\u89e3\u51b3\u65b9\u6848\u662f\u5c06\u6d41\u5206\u89e3\u6210\u5c0f\u5757\uff0c\u5e76\u50cf\u5fae\u578b\u6279\u5904\u7406\u4e00\u6837\u5904\u7406\u6bcf\u4e2a\u5757\u3002\u8fd9\u79cd\u65b9\u6cd5\u88ab\u79f0\u4e3a \u5fae\u6279\u6b21\uff08microbatching\uff09\uff0c\u5b83\u88ab\u7528\u4e8e Spark Streaming \u301091\u3011\u3002</p> <ul> <li>\u6279\u6b21\u7684\u5927\u5c0f\u901a\u5e38\u7ea6\u4e3a 1 \u79d2\uff0c\u8fd9\u662f\u5bf9\u6027\u80fd\u59a5\u534f\u7684\u7ed3\u679c\uff1a\u8f83\u5c0f\u7684\u6279\u6b21\u4f1a\u5bfc\u81f4\u66f4\u5927\u7684\u8c03\u5ea6\u4e0e\u534f\u8c03\u5f00\u9500\uff0c\u800c\u8f83\u5927\u7684\u6279\u6b21\u610f\u5473\u7740\u6d41\u5904\u7406\u5668\u7ed3\u679c\u53ef\u89c1\u4e4b\u524d\u7684\u5ef6\u8fdf\u8981\u66f4\u957f\u3002</li> <li>\u5fae\u6279\u6b21\u4e5f\u9690\u5f0f\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4e0e\u6279\u6b21\u5927\u5c0f\u76f8\u7b49\u7684\u6eda\u52a8\u7a97\u53e3\uff08\u6309\u5904\u7406\u65f6\u95f4\u800c\u4e0d\u662f\u4e8b\u4ef6\u65f6\u95f4\u6233\u5206\u7a97\uff09\u3002\u4efb\u4f55\u9700\u8981\u66f4\u5927\u7a97\u53e3\u7684\u4f5c\u4e1a\u90fd\u9700\u8981\u663e\u5f0f\u5730\u5c06\u72b6\u6001\u4ece\u4e00\u4e2a\u5fae\u6279\u6b21\u8f6c\u79fb\u5230\u4e0b\u4e00\u4e2a\u5fae\u6279\u6b21\u3002</li> </ul> <p>Apache Flink \u5219\u4f7f\u7528\u4e0d\u540c\u7684\u65b9\u6cd5\uff0c\u5b83\u4f1a\u5b9a\u671f\u751f\u6210\u72b6\u6001\u7684\u6eda\u52a8\u5b58\u6863\u70b9\u5e76\u5c06\u5176\u5199\u5165\u6301\u4e45\u5b58\u50a8\u301092,93\u3011\u3002</p> <ul> <li>\u5982\u679c\u6d41\u7b97\u5b50\u5d29\u6e83\uff0c\u5b83\u53ef\u4ee5\u4ece\u6700\u8fd1\u7684\u5b58\u6863\u70b9\u91cd\u542f\uff0c\u5e76\u4e22\u5f03\u4ece\u6700\u8fd1\u68c0\u67e5\u70b9\u5230\u5d29\u6e83\u4e4b\u95f4\u7684\u6240\u6709\u8f93\u51fa\u3002</li> <li>\u5b58\u6863\u70b9\u4f1a\u7531\u6d88\u606f\u6d41\u4e2d\u7684 \u58c1\u969c\uff08barrier\uff09 \u89e6\u53d1\uff0c\u7c7b\u4f3c\u4e8e\u5fae\u6279\u6b21\u4e4b\u95f4\u7684\u8fb9\u754c\uff0c\u4f46\u4e0d\u4f1a\u5f3a\u5236\u4e00\u4e2a\u7279\u5b9a\u7684\u7a97\u53e3\u5927\u5c0f\u3002</li> </ul> <p>\u5728\u6d41\u5904\u7406\u6846\u67b6\u7684\u8303\u56f4\u5185\uff0c\u5fae\u6279\u6b21\u4e0e\u5b58\u6863\u70b9\u65b9\u6cd5\u63d0\u4f9b\u4e86\u4e0e\u6279\u5904\u7406\u4e00\u6837\u7684 \u6070\u597d\u4e00\u6b21\u8bed\u4e49\u3002\u4f46\u662f\uff0c\u53ea\u8981\u8f93\u51fa\u79bb\u5f00\u6d41\u5904\u7406\u5668\uff08\u4f8b\u5982\uff0c\u5199\u5165\u6570\u636e\u5e93\uff0c\u5411\u5916\u90e8\u6d88\u606f\u4ee3\u7406\u53d1\u9001\u6d88\u606f\uff0c\u6216\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\uff09\uff0c\u6846\u67b6\u5c31\u65e0\u6cd5\u629b\u5f03\u5931\u8d25\u6279\u6b21\u7684\u8f93\u51fa\u4e86\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u91cd\u542f\u5931\u8d25\u4efb\u52a1\u4f1a\u5bfc\u81f4\u5916\u90e8\u526f\u4f5c\u7528\u53d1\u751f\u4e24\u6b21\uff0c\u53ea\u6709\u5fae\u6279\u6b21\u6216\u5b58\u6863\u70b9\u4e0d\u8db3\u4ee5\u963b\u6b62\u8fd9\u4e00\u95ee\u9898\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_48","title":"\u539f\u5b50\u63d0\u4ea4\u518d\u73b0","text":"<p>\u786e\u4fdd\u4e8b\u4ef6\u5904\u7406\u7684\u6240\u6709\u8f93\u51fa\u548c\u526f\u4f5c\u7528 \u5f53\u4e14\u4ec5\u5f53 \u5904\u7406\u6210\u529f\u65f6\u624d\u4f1a\u751f\u6548\u3002</p> <ul> <li>\u5305\u62ec\u53d1\u9001\u7ed9\u4e0b\u6e38\u7b97\u5b50\u6216\u5916\u90e8\u6d88\u606f\u4f20\u9012\u7cfb\u7edf\uff08\u5305\u62ec\u7535\u5b50\u90ae\u4ef6\u6216\u63a8\u9001\u901a\u77e5\uff09\u7684\u4efb\u4f55\u6d88\u606f\uff0c\u4efb\u4f55\u6570\u636e\u5e93\u5199\u5165\uff0c\u5bf9\u7b97\u5b50\u72b6\u6001\u7684\u4efb\u4f55\u53d8\u66f4\uff0c\u4ee5\u53ca\u5bf9\u8f93\u5165\u6d88\u606f\u7684\u4efb\u4f55\u786e\u8ba4\uff08\u5305\u62ec\u5728\u57fa\u4e8e\u65e5\u5fd7\u7684\u6d88\u606f\u4ee3\u7406\u4e2d\u5c06\u6d88\u8d39\u8005\u504f\u79fb\u91cf\u524d\u79fb\uff09\u3002</li> </ul> <p>\u8fd9\u4e9b\u4e8b\u60c5\u8981\u4e48\u90fd\u539f\u5b50\u5730\u53d1\u751f\uff0c\u8981\u4e48\u90fd\u4e0d\u53d1\u751f\uff0c\u4f46\u662f\u5b83\u4eec\u4e0d\u5e94\u5f53\u5931\u53bb\u540c\u6b65\u3002\u5728 \u7b2c\u4e5d\u7ae0 \u4e2d\uff0c\u6211\u4eec\u8ba8\u8bba\u4e86\u5206\u5e03\u5f0f\u4e8b\u52a1\u4f20\u7edf\u5b9e\u73b0\u4e2d\u7684\u95ee\u9898\uff08\u5982 XA\uff09\u3002\u7136\u800c\u5728\u9650\u5236\u66f4\u4e3a\u4e25\u82db\u7684\u73af\u5883\u4e2d\uff0c\u4e5f\u662f\u6709\u53ef\u80fd\u9ad8\u6548\u5b9e\u73b0\u8fd9\u79cd\u539f\u5b50\u63d0\u4ea4\u673a\u5236\u7684\u3002</p> <ul> <li>Google Cloud Dataflow\u301081,92\u3011\u548c VoltDB \u301094\u3011\u4e2d\u4f7f\u7528\u4e86\u8fd9\u79cd\u65b9\u6cd5\uff0cApache Kafka \u6709\u8ba1\u5212\u52a0\u5165\u7c7b\u4f3c\u7684\u529f\u80fd\u301095,96\u3011\u3002</li> <li>\u4e0e XA \u4e0d\u540c\uff0c\u8fd9\u4e9b\u5b9e\u73b0\u4e0d\u4f1a\u5c1d\u8bd5\u8de8\u5f02\u6784\u6280\u672f\u63d0\u4f9b\u4e8b\u52a1\uff0c\u800c\u662f\u901a\u8fc7\u5728\u6d41\u5904\u7406\u6846\u67b6\u4e2d\u540c\u65f6\u7ba1\u7406\u72b6\u6001\u53d8\u66f4\u4e0e\u6d88\u606f\u4f20\u9012\u6765\u5185\u5316\u4e8b\u52a1\u3002\u4e8b\u52a1\u534f\u8bae\u7684\u5f00\u9500\u53ef\u4ee5\u901a\u8fc7\u5728\u5355\u4e2a\u4e8b\u52a1\u4e2d\u5904\u7406\u591a\u4e2a\u8f93\u5165\u6d88\u606f\u6765\u5206\u644a\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_49","title":"\u5e42\u7b49\u6027","text":"<p>\u6211\u4eec\u7684\u76ee\u6807\u662f\u4e22\u5f03\u4efb\u4f55\u5931\u8d25\u4efb\u52a1\u7684\u90e8\u5206\u8f93\u51fa\uff0c\u4ee5\u4fbf\u80fd\u5b89\u5168\u5730\u91cd\u8bd5\uff0c\u800c\u4e0d\u4f1a\u751f\u6548\u4e24\u6b21\u3002</p> <ul> <li>\u5206\u5e03\u5f0f\u4e8b\u52a1\u662f\u5b9e\u73b0\u8fd9\u4e2a\u76ee\u6807\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u800c\u53e6\u4e00\u79cd\u65b9\u5f0f\u662f\u4f9d\u8d56 \u5e42\u7b49\u6027\uff08idempotence\uff09\u301097\u3011\u3002\u5e42\u7b49\u64cd\u4f5c\u662f\u4e00\u79cd\u5b9e\u73b0 \u6070\u597d\u4e00\u6b21\u8bed\u4e49 \u7684\u6709\u6548\u65b9\u5f0f\uff0c\u4ec5\u9700\u5f88\u5c0f\u7684\u989d\u5916\u5f00\u9500\u3002</li> </ul> <p>\u5e42\u7b49\u64cd\u4f5c\u662f\u591a\u6b21\u91cd\u590d\u6267\u884c\u4e0e\u5355\u6b21\u6267\u884c\u6548\u679c\u76f8\u540c\u7684\u64cd\u4f5c\u3002</p> <ul> <li>\u4f8b\u5982\uff0c\u5c06\u952e\u503c\u5b58\u50a8\u4e2d\u7684\u67d0\u4e2a\u952e\u8bbe\u7f6e\u4e3a\u67d0\u4e2a\u7279\u5b9a\u503c\u662f\u5e42\u7b49\u7684\uff0c\u800c\u9012\u589e\u4e00\u4e2a\u8ba1\u6570\u5668\u4e0d\u662f\u5e42\u7b49\u7684\u3002</li> </ul> <p>\u5373\u4f7f\u4e00\u4e2a\u64cd\u4f5c\u4e0d\u662f\u5929\u751f\u5e42\u7b49\u7684\uff0c\u5f80\u5f80\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u989d\u5916\u7684\u5143\u6570\u636e\u505a\u6210\u5e42\u7b49\u7684\u3002</p> <ul> <li>\u4f8b\u5982\uff0c\u5728\u4f7f\u7528\u6765\u81ea Kafka \u7684\u6d88\u606f\u65f6\uff0c\u6bcf\u6761\u6d88\u606f\u90fd\u6709\u4e00\u4e2a\u6301\u4e45\u7684\u3001\u5355\u8c03\u9012\u589e\u7684\u504f\u79fb\u91cf\u3002\u5c06\u503c\u5199\u5165\u5916\u90e8\u6570\u636e\u5e93\u65f6\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u504f\u79fb\u91cf\u5e26\u4e0a\uff0c\u8fd9\u6837\u4f60\u5c31\u53ef\u4ee5\u5224\u65ad\u4e00\u6761\u66f4\u65b0\u662f\u4e0d\u662f\u5df2\u7ecf\u6267\u884c\u8fc7\u4e86\uff0c\u56e0\u800c\u907f\u514d\u91cd\u590d\u6267\u884c\u3002</li> </ul> <p>Storm \u7684 Trident \u57fa\u4e8e\u7c7b\u4f3c\u7684\u60f3\u6cd5\u6765\u5904\u7406\u72b6\u6001\u301078\u3011\u3002\u4f9d\u8d56\u5e42\u7b49\u6027\u610f\u5473\u7740\u9690\u542b\u4e86\u4e00\u4e9b\u5047\u8bbe\uff1a\u91cd\u542f\u4e00\u4e2a\u5931\u8d25\u7684\u4efb\u52a1\u5fc5\u987b\u4ee5\u76f8\u540c\u7684\u987a\u5e8f\u91cd\u64ad\u76f8\u540c\u7684\u6d88\u606f\uff08\u57fa\u4e8e\u65e5\u5fd7\u7684\u6d88\u606f\u4ee3\u7406\u80fd\u505a\u8fd9\u4e9b\u4e8b\uff09\uff0c\u5904\u7406\u5fc5\u987b\u662f\u786e\u5b9a\u6027\u7684\uff0c\u6ca1\u6709\u5176\u4ed6\u8282\u70b9\u80fd\u540c\u65f6\u66f4\u65b0\u76f8\u540c\u7684\u503c\u301098,99\u3011\u3002</p> <p>\u5f53\u4ece\u4e00\u4e2a\u5904\u7406\u8282\u70b9\u6545\u969c\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u8282\u70b9\u65f6\uff0c\u53ef\u80fd\u9700\u8981\u8fdb\u884c \u9632\u62a4\uff08fencing\uff09\uff0c\u4ee5\u9632\u6b62\u88ab\u5047\u6b7b\u8282\u70b9\u5e72\u6270\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_50","title":"\u5931\u8d25\u540e\u91cd\u5efa\u72b6\u6001","text":"<p>\u4efb\u4f55\u9700\u8981\u72b6\u6001\u7684\u6d41\u5904\u7406 \u2014\u2014 \u4f8b\u5982\uff0c\u4efb\u4f55\u7a97\u53e3\u805a\u5408\uff08\u4f8b\u5982\u8ba1\u6570\u5668\uff0c\u5e73\u5747\u503c\u548c\u76f4\u65b9\u56fe\uff09\u4ee5\u53ca\u4efb\u4f55\u7528\u4e8e\u8fde\u63a5\u7684\u8868\u548c\u7d22\u5f15\uff0c\u90fd\u5fc5\u987b\u786e\u4fdd\u5728\u5931\u8d25\u4e4b\u540e\u80fd\u6062\u590d\u5176\u72b6\u6001\u3002</p> <ul> <li>\u4e00\u79cd\u9009\u62e9\u662f\u5c06\u72b6\u6001\u4fdd\u5b58\u5728\u8fdc\u7a0b\u6570\u636e\u5b58\u50a8\u4e2d\uff0c\u5e76\u8fdb\u884c\u590d\u5236\uff0c\u6bcf\u4e2a\u6d88\u606f\u90fd\u8981\u67e5\u8be2\u8fdc\u7a0b\u6570\u636e\u5e93\u53ef\u80fd\u4f1a\u5f88\u6162\u3002</li> <li>\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u5728\u6d41\u5904\u7406\u5668\u672c\u5730\u4fdd\u5b58\u72b6\u6001\uff0c\u5e76\u5b9a\u671f\u590d\u5236\u3002</li> </ul> <p>\u4f8b\u5982\uff0cFlink \u5b9a\u671f\u6355\u83b7\u7b97\u5b50\u72b6\u6001\u7684\u5feb\u7167\uff0c\u5e76\u5c06\u5b83\u4eec\u5199\u5165 HDFS \u7b49\u6301\u4e45\u5b58\u50a8\u4e2d\u301092,93\u3011\u3002Samza \u548c Kafka Streams \u901a\u8fc7\u5c06\u72b6\u6001\u53d8\u66f4\u53d1\u9001\u5230\u5177\u6709\u65e5\u5fd7\u538b\u7f29\u529f\u80fd\u7684\u4e13\u7528 Kafka \u4e3b\u9898\u6765\u590d\u5236\u72b6\u6001\u53d8\u66f4\uff0c\u8fd9\u4e0e\u53d8\u66f4\u6570\u636e\u6355\u83b7\u7c7b\u4f3c\u301084,100\u3011\u3002VoltDB \u901a\u8fc7\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u5bf9\u6bcf\u4e2a\u8f93\u5165\u6d88\u606f\u8fdb\u884c\u5197\u4f59\u5904\u7406\u6765\u590d\u5236\u72b6\u6001\u3002</p> <p>\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u751a\u81f3\u53ef\u80fd\u90fd\u4e0d\u9700\u8981\u590d\u5236\u72b6\u6001\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u4ece\u8f93\u5165\u6d41\u91cd\u5efa\u3002</p> <ul> <li>\u4f8b\u5982\uff0c\u5982\u679c\u72b6\u6001\u662f\u4ece\u76f8\u5f53\u77ed\u7684\u7a97\u53e3\u4e2d\u805a\u5408\u800c\u6210\uff0c\u5219\u7b80\u5355\u5730\u91cd\u64ad\u8be5\u7a97\u53e3\u4e2d\u7684\u8f93\u5165\u4e8b\u4ef6\u53ef\u80fd\u662f\u8db3\u591f\u5feb\u7684\u3002</li> <li>\u5982\u679c\u72b6\u6001\u662f\u901a\u8fc7\u53d8\u66f4\u6570\u636e\u6355\u83b7\u6765\u7ef4\u62a4\u7684\u6570\u636e\u5e93\u7684\u672c\u5730\u526f\u672c\uff0c\u90a3\u4e48\u4e5f\u53ef\u4ee5\u4ece\u65e5\u5fd7\u538b\u7f29\u7684\u53d8\u66f4\u6d41\u4e2d\u91cd\u5efa\u6570\u636e\u5e93\u3002</li> </ul> <p>\u7136\u800c\uff0c\u6240\u6709\u8fd9\u4e9b\u6743\u8861\u53d6\u51b3\u4e8e\u5e95\u5c42\u57fa\u7840\u67b6\u6784\u7684\u6027\u80fd\u7279\u5f81\uff1a\u5728\u67d0\u4e9b\u7cfb\u7edf\u4e2d\uff0c\u7f51\u7edc\u5ef6\u8fdf\u53ef\u80fd\u4f4e\u4e8e\u78c1\u76d8\u8bbf\u95ee\u5ef6\u8fdf\uff0c\u7f51\u7edc\u5e26\u5bbd\u4e5f\u53ef\u80fd\u4e0e\u78c1\u76d8\u5e26\u5bbd\u76f8\u5f53\u3002\u6ca1\u6709\u9488\u5bf9\u6240\u6709\u60c5\u51b5\u7684\u666e\u9002\u7406\u60f3\u6743\u8861\uff0c\u968f\u7740\u5b58\u50a8\u548c\u7f51\u7edc\u6280\u672f\u7684\u53d1\u5c55\uff0c\u672c\u5730\u72b6\u6001\u4e0e\u8fdc\u7a0b\u72b6\u6001\u7684\u4f18\u70b9\u4e5f\u53ef\u80fd\u4f1a\u4e92\u6362\u3002</p>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_51","title":"\u672c\u7ae0\u5c0f\u7ed3","text":"<p>\u6d41\u5904\u7406\u5728\u65e0\u9650\u7684\uff08\u6c38\u65e0\u6b62\u5883\u7684\uff09\u6d41\u800c\u4e0d\u662f\u56fa\u5b9a\u5927\u5c0f\u7684\u8f93\u5165\u4e0a\u6301\u7eed\u8fdb\u884c\uff0c\u4ece\u8fd9\u4e2a\u89d2\u5ea6\u6765\u770b\uff0c\u6d88\u606f\u4ee3\u7406\u548c\u4e8b\u4ef6\u65e5\u5fd7\u53ef\u4ee5\u89c6\u4f5c\u6587\u4ef6\u7cfb\u7edf\u7684\u6d41\u5f0f\u7b49\u4ef7\u7269\u3002</p> <p>\u6bd4\u8f83\u4e24\u79cd\u6d88\u606f\u4ee3\u7406\uff1a</p> <ul> <li>AMQP/JMS \u98ce\u683c\u7684\u6d88\u606f\u4ee3\u7406\uff1a\u4ee3\u7406\u5c06\u5355\u6761\u6d88\u606f\u5206\u914d\u7ed9\u6d88\u8d39\u8005\uff0c\u6d88\u8d39\u8005\u5728\u6210\u529f\u5904\u7406\u5355\u6761\u6d88\u606f\u540e\u786e\u8ba4\u6d88\u606f\u3002\u6d88\u606f\u88ab\u786e\u8ba4\u540e\u4ece\u4ee3\u7406\u4e2d\u5220\u9664\u3002</li> <li>\u9002\u5408\u4f5c\u4e3a\u4e00\u79cd\u5f02\u6b65\u5f62\u5f0f\u7684 RPC\uff0c\u4f8b\u5982\u5728\u4efb\u52a1\u961f\u5217\u4e2d\uff0c\u6d88\u606f\u5904\u7406\u7684\u786e\u5207\u987a\u5e8f\u5e76\u4e0d\u91cd\u8981\uff0c\u800c\u4e14\u6d88\u606f\u5728\u5904\u7406\u5b8c\u4e4b\u540e\uff0c\u4e0d\u9700\u8981\u56de\u5934\u91cd\u65b0\u8bfb\u53d6\u65e7\u6d88\u606f\u3002</li> <li>\u57fa\u4e8e\u65e5\u5fd7\u7684\u6d88\u606f\u4ee3\u7406\uff1a\u4ee3\u7406\u5c06\u4e00\u4e2a\u5206\u533a\u4e2d\u7684\u6240\u6709\u6d88\u606f\u5206\u914d\u7ed9\u540c\u4e00\u4e2a\u6d88\u8d39\u8005\u8282\u70b9\uff0c\u5e76\u59cb\u7ec8\u4ee5\u76f8\u540c\u7684\u987a\u5e8f\u4f20\u9012\u6d88\u606f\u3002</li> <li>\u5e76\u884c\u662f\u901a\u8fc7\u5206\u533a\u5b9e\u73b0\u7684\uff0c\u6d88\u8d39\u8005\u901a\u8fc7\u5b58\u6863\u6700\u8fd1\u5904\u7406\u6d88\u606f\u7684\u504f\u79fb\u91cf\u6765\u8ddf\u8e2a\u5de5\u4f5c\u8fdb\u5ea6\u3002\u6d88\u606f\u4ee3\u7406\u5c06\u6d88\u606f\u4fdd\u7559\u5728\u78c1\u76d8\u4e0a\uff0c\u56e0\u6b64\u5982\u6709\u5fc5\u8981\u7684\u8bdd\uff0c\u53ef\u4ee5\u56de\u8df3\u5e76\u91cd\u65b0\u8bfb\u53d6\u65e7\u6d88\u606f\u3002</li> </ul> <p>\u57fa\u4e8e\u65e5\u5fd7\u7684\u65b9\u6cd5\u4e0e\u6570\u636e\u5e93\u4e2d\u7684\u590d\u5236\u65e5\u5fd7\u548c\u65e5\u5fd7\u7ed3\u6784\u5b58\u50a8\u5f15\u64ce\u6709\u76f8\u4f3c\u4e4b\u5904\u3002\u6211\u4eec\u770b\u5230\uff0c\u8fd9\u79cd\u65b9\u6cd5\u5bf9\u4e8e\u6d88\u8d39\u8f93\u5165\u6d41\uff0c\u5e76\u4ea7\u751f\u884d\u751f\u72b6\u6001\u6216\u884d\u751f\u8f93\u51fa\u6570\u636e\u6d41\u7684\u7cfb\u7edf\u800c\u8a00\u7279\u522b\u9002\u7528\u3002</p> <p>\u53d1\u73b0\u5c06\u6570\u636e\u5e93\u5199\u5165\u89c6\u4f5c\u6d41\u4e5f\u662f\u5f88\u6709\u7528\u7684\uff1a\u6211\u4eec\u53ef\u4ee5\u6355\u83b7\u53d8\u66f4\u65e5\u5fd7 \u2014\u2014 \u5373\u5bf9\u6570\u636e\u5e93\u6240\u505a\u7684\u6240\u6709\u53d8\u66f4\u7684\u5386\u53f2\u8bb0\u5f55 \u2014\u2014 \u9690\u5f0f\u5730\u901a\u8fc7\u53d8\u66f4\u6570\u636e\u6355\u83b7\uff0c\u6216\u663e\u5f0f\u5730\u901a\u8fc7\u4e8b\u4ef6\u6eaf\u6e90\u3002\u65e5\u5fd7\u538b\u7f29\u5141\u8bb8\u6d41\u4e5f\u80fd\u4fdd\u6709\u6570\u636e\u5e93\u5185\u5bb9\u7684\u5b8c\u6574\u526f\u672c\u3002</p> <ul> <li>\u901a\u8fc7\u6d88\u8d39\u53d8\u66f4\u65e5\u5fd7\u5e76\u5c06\u5176\u5e94\u7528\u81f3\u884d\u751f\u7cfb\u7edf\uff0c\u4f60\u80fd\u4f7f\u8bf8\u5982\u641c\u7d22\u7d22\u5f15\u3001\u7f13\u5b58\u4ee5\u53ca\u5206\u6790\u7cfb\u7edf\u8fd9\u7c7b\u884d\u751f\u6570\u636e\u7cfb\u7edf\u4e0d\u65ad\u4fdd\u6301\u66f4\u65b0\u3002</li> </ul> <p>\u8ba8\u8bba\u4e86\u6d41\u5904\u7406\u7684\u51e0\u79cd\u76ee\u7684\uff0c\u5305\u62ec\u641c\u7d22\u4e8b\u4ef6\u6a21\u5f0f\uff08\u590d\u6742\u4e8b\u4ef6\u5904\u7406\uff09\uff0c\u8ba1\u7b97\u5206\u7a97\u805a\u5408\uff08\u6d41\u5206\u6790\uff09\uff0c\u4ee5\u53ca\u4fdd\u8bc1\u884d\u751f\u6570\u636e\u7cfb\u7edf\u5904\u4e8e\u6700\u65b0\u72b6\u6001\uff08\u7269\u5316\u89c6\u56fe\uff09\u3002</p> <p>\u8ba8\u8bba\u4e86\u5728\u6d41\u5904\u7406\u4e2d\u5bf9\u65f6\u95f4\u8fdb\u884c\u63a8\u7406\u7684\u56f0\u96be\uff0c\u5305\u62ec\u5904\u7406\u65f6\u95f4\u4e0e\u4e8b\u4ef6\u65f6\u95f4\u6233\u4e4b\u95f4\u7684\u533a\u522b\uff0c\u4ee5\u53ca\u5f53\u4f60\u8ba4\u4e3a\u7a97\u53e3\u5df2\u7ecf\u5b8c\u4e8b\u4e4b\u540e\uff0c\u5982\u4f55\u5904\u7406\u5230\u8fbe\u7684\u6389\u961f\u4e8b\u4ef6\u7684\u95ee\u9898\u3002</p> <p>\u533a\u5206\u4e86\u6d41\u5904\u7406\u4e2d\u53ef\u80fd\u51fa\u73b0\u7684\u4e09\u79cd\u8fde\u63a5\u7c7b\u578b\uff1a</p> <ul> <li>\u6d41\u6d41\u8fde\u63a5\uff1a\u4e24\u4e2a\u8f93\u5165\u6d41\u90fd\u7531\u6d3b\u52a8\u4e8b\u4ef6\u7ec4\u6210\uff0c\u800c\u8fde\u63a5\u7b97\u5b50\u5728\u67d0\u4e2a\u65f6\u95f4\u7a97\u53e3\u5185\u641c\u7d22\u76f8\u5173\u7684\u4e8b\u4ef6\u3002</li> </ul> <p>\u4f8b\u5982\uff0c\u5b83\u53ef\u80fd\u4f1a\u5c06\u540c\u4e00\u4e2a\u7528\u6237 30 \u5206\u949f\u5185\u8fdb\u884c\u7684\u4e24\u4e2a\u6d3b\u52a8\u8054\u7cfb\u5728\u4e00\u8d77\u3002\u5982\u679c\u4f60\u60f3\u8981\u627e\u51fa\u4e00\u4e2a\u6d41\u5185\u7684\u76f8\u5173\u4e8b\u4ef6\uff0c\u8fde\u63a5\u7684\u4e24\u4fa7\u8f93\u5165\u53ef\u80fd\u5b9e\u9645\u4e0a\u90fd\u662f\u540c\u4e00\u4e2a\u6d41\uff08\u81ea\u8fde\u63a5\uff0c\u5373 self-join\uff09\u3002</p> <ul> <li>\u6d41\u8868\u8fde\u63a5\uff1a\u4e00\u4e2a\u8f93\u5165\u6d41\u7531\u6d3b\u52a8\u4e8b\u4ef6\u7ec4\u6210\uff0c\u53e6\u4e00\u4e2a\u8f93\u5165\u6d41\u662f\u6570\u636e\u5e93\u53d8\u66f4\u65e5\u5fd7\u3002</li> </ul> <p>\u53d8\u66f4\u65e5\u5fd7\u4fdd\u8bc1\u4e86\u6570\u636e\u5e93\u7684\u672c\u5730\u526f\u672c\u662f\u6700\u65b0\u7684\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u6d3b\u52a8\u4e8b\u4ef6\uff0c\u8fde\u63a5\u7b97\u5b50\u5c06\u67e5\u8be2\u6570\u636e\u5e93\uff0c\u5e76\u8f93\u51fa\u4e00\u4e2a\u6269\u5c55\u7684\u6d3b\u52a8\u4e8b\u4ef6\u3002</p> <ul> <li>\u8868\u8868\u8fde\u63a5\uff1a\u4e24\u4e2a\u8f93\u5165\u6d41\u90fd\u662f\u6570\u636e\u5e93\u53d8\u66f4\u65e5\u5fd7\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e00\u4fa7\u7684\u6bcf\u4e00\u4e2a\u53d8\u5316\u90fd\u4e0e\u53e6\u4e00\u4fa7\u7684\u6700\u65b0\u72b6\u6001\u76f8\u8fde\u63a5\u3002\u7ed3\u679c\u662f\u4e24\u8868\u8fde\u63a5\u6240\u5f97\u7269\u5316\u89c6\u56fe\u7684\u53d8\u66f4\u6d41\u3002</li> </ul> <p>\u6700\u540e\uff0c\u6211\u4eec\u8ba8\u8bba\u4e86\u5728\u6d41\u5904\u7406\u4e2d\u5b9e\u73b0\u5bb9\u9519\u548c\u6070\u597d\u4e00\u6b21\u8bed\u4e49\u7684\u6280\u672f\u3002\u7531\u4e8e\u6d41\u5904\u7406\u957f\u65f6\u95f4\u8fd0\u884c\u5e76\u6301\u7eed\u4ea7\u751f\u8f93\u51fa\uff0c\u6240\u4ee5\u4e0d\u80fd\u7b80\u5355\u5730\u4e22\u5f03\u6240\u6709\u7684\u8f93\u51fa\u3002</p> <ul> <li>\u4f7f\u7528\u66f4\u7ec6\u7c92\u5ea6\u7684\u6062\u590d\u673a\u5236\uff0c\u57fa\u4e8e\u5fae\u6279\u6b21\u3001\u5b58\u6863\u70b9\u3001\u4e8b\u52a1\u6216\u5e42\u7b49\u5199\u5165\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/11_streaming_processing.html#_52","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>Tyler Akidau, Robert Bradshaw, Craig Chambers, et al.: \u201cThe Dataflow Model: A Practical Approach to Balancing Correctness, Latency, and Cost in Massive-Scale, Unbounded, Out-of-Order Data Processing,\u201d Proceedings of the VLDB Endowment, volume 8, number 12, pages 1792\u20131803, August 2015. doi:10.14778/2824032.2824076</li> <li>Harold Abelson, Gerald Jay Sussman, and Julie Sussman: Structure and Interpretation of Computer Programs, 2nd edition. MIT Press, 1996. ISBN: 978-0-262-51087-5, available online at mitpress.mit.edu</li> <li>Patrick Th. Eugster, Pascal A. Felber, Rachid Guerraoui, and Anne-Marie Kermarrec: \u201cThe Many Faces of Publish/Subscribe,\u201d ACM Computing Surveys, volume 35, number 2, pages 114\u2013131, June 2003. doi:10.1145/857076.857078</li> <li>Joseph M. Hellerstein and Michael Stonebraker: Readings in Database Systems, 4th edition. MIT Press, 2005. ISBN: 978-0-262-69314-1, available online at redbook.cs.berkeley.edu</li> <li>Don Carney, U\u011fur \u00c7etintemel, Mitch Cherniack, et al.: \u201cMonitoring Streams \u2013 A New Class of Data Management Applications,\u201d at 28th International Conference on Very Large Data Bases (VLDB), August 2002.</li> <li>Matthew Sackman: \u201cPushing Back,\u201d lshift.net, May 5, 2016.</li> <li>Vicent Mart\u00ed: \u201cBrubeck, a statsd-Compatible Metrics Aggregator,\u201d githubengineering.com, June 15, 2015.</li> <li>Seth Lowenberger: \u201cMoldUDP64 Protocol Specification V 1.00,\u201d nasdaqtrader.com, July 2009.</li> <li>Pieter Hintjens: ZeroMQ \u2013 The Guide. O'Reilly Media, 2013. ISBN: 978-1-449-33404-8</li> <li>Ian Malpass: \u201cMeasure Anything, Measure Everything,\u201d codeascraft.com, February 15, 2011.</li> <li>Dieter Plaetinck: \u201c25 Graphite, Grafana and statsd Gotchas,\u201d blog.raintank.io, March 3, 2016.</li> <li>Jeff Lindsay: \u201cWeb Hooks to Revolutionize the Web,\u201d progrium.com, May 3, 2007.</li> <li>Jim N. Gray: \u201cQueues Are Databases,\u201d Microsoft Research Technical Report MSR-TR-95-56, December 1995.</li> <li>Mark Hapner, Rich Burridge, Rahul Sharma, et al.: \u201cJSR-343 Java Message Service (JMS) 2.0 Specification,\u201d jms-spec.java.net, March 2013.</li> <li>Sanjay Aiyagari, Matthew Arrott, Mark Atwell, et al.: \u201cAMQP: Advanced Message Queuing Protocol Specification,\u201d Version 0-9-1, November 2008.</li> <li>\u201cGoogle Cloud Pub/Sub: A Google-Scale Messaging Service,\u201d cloud.google.com, 2016.</li> <li>\u201cApache Kafka 0.9 Documentation,\u201d kafka.apache.org, November 2015.</li> <li>Jay Kreps, Neha Narkhede, and Jun Rao: \u201cKafka: A Distributed Messaging System for Log Processing,\u201d at 6th International Workshop on Networking Meets Databases (NetDB), June 2011.</li> <li>\u201cAmazon Kinesis Streams Developer Guide,\u201d docs.aws.amazon.com, April 2016.</li> <li>Leigh Stewart and Sijie Guo: \u201cBuilding DistributedLog: Twitter\u2019s High-Performance Replicated Log Service,\u201d blog.twitter.com, September 16, 2015.</li> <li>\u201cDistributedLog Documentation,\u201d Twitter, Inc., distributedlog.io, May 2016.</li> <li>Jay Kreps: \u201cBenchmarking Apache Kafka: 2 Million Writes Per Second (On Three Cheap Machines),\u201d engineering.linkedin.com, April 27, 2014.</li> <li>Kartik Paramasivam: \u201cHow We\u2019re Improving and Advancing Kafka at LinkedIn,\u201d engineering.linkedin.com, September 2, 2015.</li> <li>Jay Kreps: \u201cThe Log: What Every Software Engineer Should Know About Real-Time Data's Unifying Abstraction,\u201d engineering.linkedin.com, December 16, 2013.</li> <li>Shirshanka Das, Chavdar Botev, Kapil Surlaker, et al.: \u201cAll Aboard the Databus!,\u201d at 3rd ACM Symposium on Cloud Computing (SoCC), October 2012.</li> <li>Yogeshwer Sharma, Philippe Ajoux, Petchean Ang, et al.: \u201cWormhole: Reliable Pub-Sub to Support Geo-Replicated Internet Services,\u201d at 12th USENIX Symposium on Networked Systems Design and Implementation (NSDI), May 2015.</li> <li>P. P. S. Narayan: \u201cSherpa Update,\u201d developer.yahoo.com, June 8, .</li> <li>Martin Kleppmann: \u201cBottled Water: Real-Time Integration of PostgreSQL and Kafka,\u201d martin.kleppmann.com, April 23, 2015.</li> <li>Ben Osheroff: \u201cIntroducing Maxwell, a mysql-to-kafka Binlog Processor,\u201d developer.zendesk.com, August 20, 2015.</li> <li>Randall Hauch: \u201cDebezium 0.2.1 Released,\u201d debezium.io, June 10, 2016.</li> <li>Prem Santosh Udaya Shankar: \u201cStreaming MySQL Tables in Real-Time to Kafka,\u201d engineeringblog.yelp.com, August 1, 2016.</li> <li>\u201cMongoriver,\u201d Stripe, Inc., github.com, September 2014.</li> <li>Dan Harvey: \u201cChange Data Capture with Mongo + Kafka,\u201d at Hadoop Users Group UK, August 2015.</li> <li>\u201cOracle GoldenGate 12c: Real-Time Access to Real-Time Information,\u201d Oracle White Paper, March 2015.</li> <li>\u201cOracle GoldenGate Fundamentals: How Oracle GoldenGate Works,\u201d Oracle Corporation, youtube.com, November 2012.</li> <li>Slava Akhmechet: \u201cAdvancing the Realtime Web,\u201d rethinkdb.com, January 27, 2015.</li> <li>\u201cFirebase Realtime Database Documentation,\u201d Google, Inc., firebase.google.com, May 2016.</li> <li>\u201cApache CouchDB 1.6 Documentation,\u201d docs.couchdb.org, 2014.</li> <li>Matt DeBergalis: \u201cMeteor 0.7.0: Scalable Database Queries Using MongoDB Oplog Instead of Poll-and-Diff,\u201d info.meteor.com, December 17, 2013.</li> <li>\u201cChapter 15. Importing and Exporting Live Data,\u201d VoltDB 6.4 User Manual, docs.voltdb.com, June 2016.</li> <li>Neha Narkhede: \u201cAnnouncing Kafka Connect: Building Large-Scale Low-Latency Data Pipelines,\u201d confluent.io, February 18, 2016.</li> <li>Greg Young: \u201cCQRS and Event Sourcing,\u201d at Code on the Beach, August 2014.</li> <li>Martin Fowler: \u201cEvent Sourcing,\u201d martinfowler.com, December 12, 2005.</li> <li>Vaughn Vernon: Implementing Domain-Driven Design. Addison-Wesley Professional, 2013. ISBN: 978-0-321-83457-7</li> <li>H. V. Jagadish, Inderpal Singh Mumick, and Abraham Silberschatz: \u201cView Maintenance Issues for the Chronicle Data Model,\u201d at 14th ACM SIGACT-SIGMOD-SIGART Symposium on Principles of Database Systems (PODS), May 1995. doi:10.1145/212433.220201</li> <li>\u201cEvent Store 3.5.0 Documentation,\u201d Event Store LLP, docs.geteventstore.com, February 2016.</li> <li>Martin Kleppmann: Making Sense of Stream Processing. Report, O'Reilly Media, May 2016.</li> <li>Sander Mak: \u201cEvent-Sourced Architectures with Akka,\u201d at JavaOne, September 2014.</li> <li>Julian Hyde: personal communication, June 2016.</li> <li>Ashish Gupta and Inderpal Singh Mumick: Materialized Views: Techniques, Implementations, and Applications. MIT Press, 1999. ISBN: 978-0-262-57122-7</li> <li>Timothy Griffin and Leonid Libkin: \u201cIncremental Maintenance of Views with Duplicates,\u201d at ACM International Conference on Management of Data (SIGMOD), May 1995. doi:10.1145/223784.223849</li> <li>Pat Helland: \u201cImmutability Changes Everything,\u201d at 7th Biennial Conference on Innovative Data Systems Research (CIDR), January 2015.</li> <li>Martin Kleppmann: \u201cAccounting for Computer Scientists,\u201d martin.kleppmann.com, March 7, 2011.</li> <li>Pat Helland: \u201cAccountants Don't Use Erasers,\u201d blogs.msdn.com, June 14, 2007.</li> <li>Fangjin Yang: \u201cDogfooding with Druid, Samza, and Kafka: Metametrics at Metamarkets,\u201d metamarkets.com, June 3, 2015.</li> <li>Gavin Li, Jianqiu Lv, and Hang Qi: \u201cPistachio: Co-Locate the Data and Compute for Fastest Cloud Compute,\u201d yahoohadoop.tumblr.com, April 13, 2015.</li> <li>Kartik Paramasivam: \u201cStream Processing Hard Problems \u2013 Part 1: Killing Lambda,\u201d engineering.linkedin.com, June 27, 2016.</li> <li>Martin Fowler: \u201cCQRS,\u201d martinfowler.com, July 14, 2011.</li> <li>Greg Young: \u201cCQRS Documents,\u201d cqrs.files.wordpress.com, November 2010.</li> <li>Baron Schwartz: \u201cImmutability, MVCC, and Garbage Collection,\u201d xaprb.com, December 28, 2013.</li> <li>Daniel Eloff, Slava Akhmechet, Jay Kreps, et al.: \"Re: Turning the Database Inside-out with Apache Samza,\" Hacker News discussion, news.ycombinator.com, March 4, 2015.</li> <li>\u201cDatomic Development Resources: Excision,\u201d Cognitect, Inc., docs.datomic.com.</li> <li>\u201cFossil Documentation: Deleting Content from Fossil,\u201d fossil-scm.org, 2016.</li> <li>Jay Kreps: \u201cThe irony of distributed systems is that data loss is really easy but deleting data is surprisingly hard,\u201d twitter.com, March 30, 2015.</li> <li>David C. Luckham: \u201cWhat\u2019s the Difference Between ESP and CEP?,\u201d complexevents.com, August 1, 2006.</li> <li>Srinath Perera: \u201cHow Is Stream Processing and Complex Event Processing (CEP) Different?,\u201d quora.com, December 3, 2015.</li> <li>Arvind Arasu, Shivnath Babu, and Jennifer Widom: \u201cThe CQL Continuous Query Language: Semantic Foundations and Query Execution,\u201d The VLDB Journal, volume 15, number 2, pages 121\u2013142, June 2006. doi:10.1007/s00778-004-0147-z</li> <li>Julian Hyde: \u201cData in Flight: How Streaming SQL Technology Can Help Solve the Web 2.0 Data Crunch,\u201d ACM Queue, volume 7, number 11, December 2009. doi:10.1145/1661785.1667562</li> <li>\u201cEsper Reference, Version 5.4.0,\u201d EsperTech, Inc., espertech.com, April 2016.</li> <li>Zubair Nabi, Eric Bouillet, Andrew Bainbridge, and Chris Thomas: \u201cOf Streams and Storms,\u201d IBM technical report, developer.ibm.com, April 2014.</li> <li>Milinda Pathirage, Julian Hyde, Yi Pan, and Beth Plale: \u201cSamzaSQL: Scalable Fast Data Management with Streaming SQL,\u201d at IEEE International Workshop on High-Performance Big Data Computing (HPBDC), May 2016. doi:10.1109/IPDPSW.2016.141</li> <li>Philippe Flajolet, \u00c9ric Fusy, Olivier Gandouet, and Fr\u00e9d\u00e9ric Meunier: \u201cHyperLo\u2060gLog: The Analysis of a Near-Optimal Cardinality Estimation Algorithm,\u201d at Conference on Analysis of Algorithms (AofA), June 2007.</li> <li>Jay Kreps: \u201cQuestioning the Lambda Architecture,\u201d oreilly.com, July 2, 2014.</li> <li>Ian Hellstr\u00f6m: \u201cAn Overview of Apache Streaming Technologies,\u201d databaseline.wordpress.com, March 12, 2016.</li> <li>Jay Kreps: \u201cWhy Local State Is a Fundamental Primitive in Stream Processing,\u201d oreilly.com, July 31, 2014.</li> <li>Shay Banon: \u201cPercolator,\u201d elastic.co, February 8, 2011.</li> <li>Alan Woodward and Martin Kleppmann: \u201cReal-Time Full-Text Search with Luwak and Samza,\u201d martin.kleppmann.com, April 13, 2015.</li> <li>\u201cApache Storm 1.0.1 Documentation,\u201d storm.apache.org, May 2016.</li> <li>Tyler Akidau: \u201cThe World Beyond Batch: Streaming 102,\u201d oreilly.com, January 20, 2016.</li> <li>Stephan Ewen: \u201cStreaming Analytics with Apache Flink,\u201d at Kafka Summit, April 2016.</li> <li>Tyler Akidau, Alex Balikov, Kaya Bekiro\u011flu, et al.: \u201cMillWheel: Fault-Tolerant Stream Processing at Internet Scale,\u201d at 39th International Conference on Very Large Data Bases (VLDB), August 2013.</li> <li>Alex Dean: \u201cImproving Snowplow's Understanding of Time,\u201d snowplowanalytics.com, September 15, 2015.</li> <li>\u201cWindowing (Azure Stream Analytics),\u201d Microsoft Azure Reference, msdn.microsoft.com, April 2016.</li> <li>\u201cState Management,\u201d Apache Samza 0.10 Documentation, samza.apache.org, December 2015.</li> <li>Rajagopal Ananthanarayanan, Venkatesh Basker, Sumit Das, et al.: \u201cPhoton: Fault-Tolerant and Scalable Joining of Continuous Data Streams,\u201d at ACM International Conference on Management of Data (SIGMOD), June 2013. doi:10.1145/2463676.2465272</li> <li>Martin Kleppmann: \u201cSamza Newsfeed Demo,\u201d github.com, September 2014.</li> <li>Ben Kirwin: \u201cDoing the Impossible: Exactly-Once Messaging Patterns in Kafka,\u201d ben.kirw.in, November 28, 2014.</li> <li>Pat Helland: \u201cData on the Outside Versus Data on the Inside,\u201d at 2nd Biennial Conference on Innovative Data Systems Research (CIDR), January 2005.</li> <li>Ralph Kimball and Margy Ross: The Data Warehouse Toolkit: The Definitive Guide to Dimensional Modeling, 3rd edition. John Wiley &amp; Sons, 2013. ISBN: 978-1-118-53080-1</li> <li>Viktor Klang: \u201cI'm coining the phrase 'effectively-once' for message processing with at-least-once + idempotent operations,\u201d twitter.com, October 20, 2016.</li> <li>Matei Zaharia, Tathagata Das, Haoyuan Li, et al.: \u201cDiscretized Streams: An Efficient and Fault-Tolerant Model for Stream Processing on Large Clusters,\u201d at 4th USENIX Conference in Hot Topics in Cloud Computing (HotCloud), June 2012.</li> <li>Kostas Tzoumas, Stephan Ewen, and Robert Metzger: \u201cHigh-Throughput, Low-Latency, and Exactly-Once Stream Processing with Apache Flink,\u201d data-artisans.com, August 5, 2015.</li> <li>Paris Carbone, Gyula F\u00f3ra, Stephan Ewen, et al.: \u201cLightweight Asynchronous Snapshots for Distributed Dataflows,\u201d arXiv:1506.08603 [cs.DC], June 29, 2015.</li> <li>Ryan Betts and John Hugg: Fast Data: Smart and at Scale. Report, O'Reilly Media, October 2015.</li> <li>Flavio Junqueira: \u201cMaking Sense of Exactly-Once Semantics,\u201d at Strata+Hadoop World London, June 2016.</li> <li>Jason Gustafson, Flavio Junqueira, Apurva Mehta, Sriram Subramanian, and Guozhang Wang: \u201cKIP-98 \u2013 Exactly Once Delivery and Transactional Messaging,\u201d cwiki.apache.org, November 2016.</li> <li>Pat Helland: \u201cIdempotence Is Not a Medical Condition,\u201d Communications of the ACM, volume 55, number 5, page 56, May 2012. doi:10.1145/2160718.2160734</li> <li>Jay Kreps: \u201cRe: Trying to Achieve Deterministic Behavior on Recovery/Rewind,\u201d email to samza-dev mailing list, September 9, 2014.</li> <li>E. N. (Mootaz) Elnozahy, Lorenzo Alvisi, Yi-Min Wang, and David B. Johnson: \u201cA Survey of Rollback-Recovery Protocols in Message-Passing Systems,\u201d ACM Computing Surveys, volume 34, number 3, pages 375\u2013408, September 2002. doi:10.1145/568522.568525</li> <li>Adam Warski: \u201cKafka Streams \u2013 How Does It Fit the Stream Processing Landscape?,\u201d softwaremill.com, June 1, 2016.</li> </ol> <ol> <li> <p>\u5982\u679c\u4f60\u5c06\u6d41\u89c6\u4f5c\u8868\u7684\u884d\u751f\u7269\uff0c\u5982 \u56fe 11-6 \u6240\u793a\uff0c\u800c\u628a\u4e00\u4e2a\u8fde\u63a5\u770b\u4f5c\u662f\u4e24\u4e2a\u8868\u7684\u4e58\u6cd5u\u00b7v\uff0c\u90a3\u4e48\u4f1a\u53d1\u751f\u4e00\u4e9b\u6709\u8da3\u7684\u4e8b\u60c5\uff1a\u7269\u5316\u8fde\u63a5\u7684\u53d8\u5316\u6d41\u9075\u5faa\u4e58\u79ef\u6cd5\u5219\uff1a(u\u00b7v)'= u'v + uv'\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u4efb\u4f55\u63a8\u6587\u7684\u53d8\u5316\u91cf\u90fd\u4e0e\u5f53\u524d\u7684\u5173\u6ce8\u8054\u7cfb\u5728\u4e00\u8d77\uff0c\u4efb\u4f55\u5173\u6ce8\u7684\u53d8\u5316\u91cf\u90fd\u4e0e\u5f53\u524d\u7684\u63a8\u6587\u76f8\u8fde\u63a5\u301049,50\u3011\u3002\u00a0\u21a9</p> </li> <li> <p>\u8981\u8bbe\u8ba1\u4e00\u79cd\u8d1f\u8f7d\u5747\u8861\u65b9\u6848\u4e5f\u662f\u6709\u53ef\u80fd\u7684\uff0c\u5728\u8fd9\u79cd\u65b9\u6848\u4e2d\uff0c\u4e24\u4e2a\u6d88\u8d39\u8005\u901a\u8fc7\u8bfb\u53d6\u5168\u90e8\u6d88\u606f\u6765\u5171\u4eab\u5206\u533a\u5904\u7406\u7684\u5de5\u4f5c\uff0c\u4f46\u662f\u5176\u4e2d\u4e00\u4e2a\u53ea\u8003\u8651\u5177\u6709\u5076\u6570\u504f\u79fb\u91cf\u7684\u6d88\u606f\uff0c\u800c\u53e6\u4e00\u4e2a\u6d88\u8d39\u8005\u53ea\u5904\u7406\u5947\u6570\u7f16\u53f7\u7684\u504f\u79fb\u91cf\u3002\u6216\u8005\u4f60\u53ef\u4ee5\u5c06\u6d88\u606f\u644a\u5230\u4e00\u4e2a\u7ebf\u7a0b\u6c60\u4e2d\u6765\u5904\u7406\uff0c\u4f46\u8fd9\u79cd\u65b9\u6cd5\u4f1a\u4f7f\u6d88\u8d39\u8005\u504f\u79fb\u91cf\u7ba1\u7406\u53d8\u5f97\u590d\u6742\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u5355\u7ebf\u7a0b\u5904\u7406\u5355\u5206\u533a\u662f\u5408\u9002\u7684\uff0c\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u66f4\u591a\u5206\u533a\u6765\u63d0\u9ad8\u5e76\u884c\u5ea6\u3002\u00a0\u21a9</p> </li> </ol>"},{"location":"books/data_intensive_system_book/12_the_future.html","title":"\u7b2c\u5341\u4e8c\u7ae0\uff1a\u6570\u636e\u7cfb\u7edf\u7684\u672a\u6765","text":""},{"location":"books/data_intensive_system_book/12_the_future.html#_2","title":"\u6570\u636e\u96c6\u6210","text":"<p>\u5982\u679c\u4f60\u6709\u4e00\u4e2a\u7c7b\u4f3c\u4e8e \u201c\u6211\u60f3\u5b58\u50a8\u4e00\u4e9b\u6570\u636e\u5e76\u7a0d\u540e\u518d\u67e5\u8be2\u201d \u7684\u95ee\u9898\uff0c\u90a3\u4e48\u5e76\u6ca1\u6709\u4e00\u79cd\u6b63\u786e\u7684\u89e3\u51b3\u65b9\u6848\u3002\u4f46\u5bf9\u4e8e\u4e0d\u540c\u7684\u5177\u4f53\u73af\u5883\uff0c\u603b\u4f1a\u6709\u4e0d\u540c\u7684\u5408\u9002\u65b9\u6cd5\u3002\u4f7f\u5355\u6761\u4ee3\u7801\u8def\u5f84\u80fd\u505a\u5230\u7a33\u5b9a\u5065\u58ee\u4e14\u8868\u73b0\u826f\u597d\u5df2\u7ecf\u662f\u4e00\u4ef6\u975e\u5e38\u56f0\u96be\u7684\u4e8b\u60c5\u4e86 \u2014\u2014 \u5c1d\u8bd5\u5728\u5355\u4e2a\u8f6f\u4ef6\u4e2d\u5b8c\u6210\u6240\u6709\u4e8b\u60c5\uff0c\u51e0\u4e4e\u53ef\u4ee5\u4fdd\u8bc1\uff0c\u5b9e\u73b0\u6548\u679c\u4f1a\u5f88\u5dee\u3002</p> <p>\u56e0\u6b64\u8f6f\u4ef6\u5de5\u5177\u7684\u6700\u4f73\u9009\u62e9\u4e5f\u53d6\u51b3\u4e8e\u60c5\u51b5\u3002\u6bcf\u4e00\u79cd\u8f6f\u4ef6\uff0c\u751a\u81f3\u6240\u8c13\u7684 \u201c\u901a\u7528\u201d \u6570\u636e\u5e93\uff0c\u90fd\u662f\u9488\u5bf9\u7279\u5b9a\u7684\u4f7f\u7528\u6a21\u5f0f\u8bbe\u8ba1\u7684\u3002</p> <p>\u9762\u5bf9\u8ba9\u4eba\u773c\u82b1\u7f2d\u4e71\u7684\u8bf8\u591a\u66ff\u4ee3\u54c1\uff0c\u7b2c\u4e00\u4e2a\u6311\u6218\u5c31\u662f\u5f04\u6e05\u8f6f\u4ef6\u4e0e\u5176\u9002\u7528\u73af\u5883\u7684\u6620\u5c04\u5173\u7cfb\u3002\u4f9b\u5e94\u5546\u4e0d\u613f\u544a\u8bc9\u4f60\u4ed6\u4eec\u8f6f\u4ef6\u4e0d\u9002\u7528\u7684\u5de5\u4f5c\u8d1f\u8f7d\u3002\u8fd8\u6709\u4e00\u4e2a\u6311\u6218\uff1a\u5728\u590d\u6742\u7684\u5e94\u7528\u4e2d\uff0c\u6570\u636e\u7684\u7528\u6cd5\u901a\u5e38\u82b1\u6837\u767e\u51fa\u3002\u4e0d\u592a\u53ef\u80fd\u5b58\u5728\u9002\u7528\u4e8e \u6240\u6709 \u4e0d\u540c\u6570\u636e\u5e94\u7528\u573a\u666f\u7684\u8f6f\u4ef6\uff0c\u56e0\u6b64\u4f60\u4e0d\u53ef\u907f\u514d\u5730\u9700\u8981\u62fc\u51d1\u51e0\u4e2a\u4e0d\u540c\u7684\u8f6f\u4ef6\u6765\u4ee5\u63d0\u4f9b\u5e94\u7528\u6240\u9700\u7684\u529f\u80fd\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_3","title":"\u7ec4\u5408\u4f7f\u7528\u884d\u751f\u6570\u636e\u7684\u5de5\u5177","text":"<p>\u4f8b\u5982\uff0c\u4e3a\u4e86\u5904\u7406\u4efb\u610f\u5173\u952e\u8bcd\u7684\u641c\u7d22\u67e5\u8be2\uff0c\u5c06 OLTP \u6570\u636e\u5e93\u4e0e\u5168\u6587\u641c\u7d22\u7d22\u5f15\u96c6\u6210\u5728\u4e00\u8d77\u662f\u5f88\u5e38\u89c1\u7684\u9700\u6c42\u3002</p> <ul> <li>\u7b80\u5355\u7684\u5e94\u7528\uff0c\u4e00\u4e9b\u6570\u636e\u5e93\uff08\u4f8b\u5982 PostgreSQL\uff09\u5305\u542b\u4e86\u5168\u6587\u7d22\u5f15\u529f\u80fd\uff0c\u5b8c\u5168\u591f\u7528\u30101\u3011\uff1b\u66f4\u590d\u6742\u7684\u641c\u7d22\u80fd\u529b\u5c31\u9700\u8981\u4e13\u4e1a\u7684\u4fe1\u606f\u68c0\u7d22\u5de5\u5177\u3002</li> <li>\u76f8\u53cd\u7684\u662f\uff0c\u641c\u7d22\u7d22\u5f15\u901a\u5e38\u4e0d\u9002\u5408\u4f5c\u4e3a\u6301\u4e45\u7684\u8bb0\u5f55\u7cfb\u7edf\uff0c\u56e0\u6b64\u8bb8\u591a\u5e94\u7528\u9700\u8981\u7ec4\u5408\u8fd9\u4e24\u79cd\u4e0d\u540c\u7684\u5de5\u5177\u4ee5\u6ee1\u8db3\u6240\u6709\u9700\u6c42\u3002</li> </ul> <p>\u968f\u7740\u6570\u636e\u4e0d\u540c\u8868\u793a\u5f62\u5f0f\u7684\u589e\u52a0\uff0c\u96c6\u6210\u95ee\u9898\u53d8\u5f97\u8d8a\u6765\u8d8a\u56f0\u96be\u3002</p> <ul> <li>\u9664\u4e86\u6570\u636e\u5e93\u548c\u641c\u7d22\u7d22\u5f15\u4e4b\u5916\uff0c\u4e5f\u8bb8\u4f60\u9700\u8981\u5728\u5206\u6790\u7cfb\u7edf\uff08\u6570\u636e\u4ed3\u5e93\uff0c\u6216\u6279\u5904\u7406\u548c\u6d41\u5904\u7406\u7cfb\u7edf\uff09\u4e2d\u7ef4\u62a4\u6570\u636e\u526f\u672c\uff1b</li> <li>\u7ef4\u62a4\u4ece\u539f\u59cb\u6570\u636e\u4e2d\u884d\u751f\u7684\u7f13\u5b58\uff0c\u6216\u53cd\u89c4\u8303\u5316\u7684\u6570\u636e\u7248\u672c\uff1b\u5c06\u6570\u636e\u704c\u5165\u673a\u5668\u5b66\u4e60\u3001\u5206\u7c7b\u3001\u6392\u540d\u6216\u63a8\u8350\u7cfb\u7edf\u4e2d\uff1b\u6216\u8005\u57fa\u4e8e\u6570\u636e\u53d8\u66f4\u53d1\u9001\u901a\u77e5\u3002</li> </ul> <p>\u7ecf\u5e38\u770b\u5230\u8f6f\u4ef6\u5de5\u7a0b\u5e08\u505a\u51fa\u8fd9\u6837\u7684\u9648\u8ff0\uff1a\u201c\u6839\u636e\u6211\u7684\u7ecf\u9a8c\uff0c99% \u7684\u4eba\u53ea\u9700\u8981 X\u201d \u6216\u8005 \u201c...... \u4e0d\u9700\u8981 X\u201d\uff08\u5bf9\u4e8e\u5404\u79cd\u5404\u6837\u7684 X\uff09\u3002</p> <ul> <li>\u6211\u8ba4\u4e3a\u8fd9\u79cd\u9648\u8ff0\u66f4\u50cf\u662f\u53d1\u8a00\u4eba\u81ea\u5df1\u7684\u7ecf\u9a8c\uff0c\u800c\u4e0d\u662f\u6280\u672f\u5b9e\u9645\u4e0a\u7684\u5b9e\u7528\u6027\u3002</li> <li>\u67d0\u4eba\u8ba4\u4e3a\u9e21\u808b\u800c\u6beb\u65e0\u610f\u4e49\u7684\u529f\u80fd\u53ef\u80fd\u662f\u522b\u4eba\u7684\u6838\u5fc3\u9700\u6c42\u3002\u5f53\u4f60\u62c9\u9ad8\u89c6\u89d2\uff0c\u5e76\u8003\u8651\u8de8\u8d8a\u6574\u4e2a\u7ec4\u7ec7\u8303\u56f4\u7684\u6570\u636e\u6d41\u65f6\uff0c\u6570\u636e\u96c6\u6210\u7684\u9700\u6c42\u5f80\u5f80\u5c31\u4f1a\u53d8\u5f97\u660e\u663e\u8d77\u6765\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_4","title":"\u7406\u89e3\u6570\u636e\u6d41","text":"<p>\u5f53\u9700\u8981\u5728\u591a\u4e2a\u5b58\u50a8\u7cfb\u7edf\u4e2d\u7ef4\u62a4\u76f8\u540c\u6570\u636e\u7684\u526f\u672c\u4ee5\u6ee1\u8db3\u4e0d\u540c\u7684\u8bbf\u95ee\u6a21\u5f0f\u65f6\uff0c\u4f60\u8981\u5bf9\u8f93\u5165\u548c\u8f93\u51fa\u4e86\u5982\u6307\u638c\uff1a\u54ea\u4e9b\u6570\u636e\u5148\u5199\u5165\uff0c\u54ea\u4e9b\u6570\u636e\u8868\u793a\u884d\u751f\u81ea\u54ea\u4e9b\u6765\u6e90\uff1f\u5982\u4f55\u4ee5\u6b63\u786e\u7684\u683c\u5f0f\uff0c\u5c06\u6240\u6709\u6570\u636e\u5bfc\u5165\u6b63\u786e\u7684\u5730\u65b9\uff1f</p> <p>\u5199\u5165\u6570\u636e\u5e93\u662f\u5411\u8be5\u7cfb\u7edf\u63d0\u4f9b\u65b0\u8f93\u5165\u7684\u552f\u4e00\u65b9\u5f0f\u3002</p> <ul> <li>\u4f8b\u5982\uff0c\u4f60\u53ef\u80fd\u4f1a\u9996\u5148\u5c06\u6570\u636e\u5199\u5165 \u8bb0\u5f55\u7cfb\u7edf \u6570\u636e\u5e93\uff0c\u6355\u83b7\u5bf9\u8be5\u6570\u636e\u5e93\u6240\u505a\u7684\u53d8\u66f4\uff0c\u7136\u540e\u5c06\u53d8\u66f4\u4ee5\u76f8\u540c\u7684\u987a\u5e8f\u5e94\u7528\u4e8e\u641c\u7d22\u7d22\u5f15\u3002</li> <li>\u5982\u679c\u53d8\u66f4\u6570\u636e\u6355\u83b7\uff08CDC\uff09\u662f\u66f4\u65b0\u7d22\u5f15\u7684\u552f\u4e00\u65b9\u5f0f\uff0c\u5219\u53ef\u4ee5\u786e\u5b9a\u8be5\u7d22\u5f15\u5b8c\u5168\u6d3e\u751f\u81ea\u8bb0\u5f55\u7cfb\u7edf\uff0c\u56e0\u6b64\u4e0e\u5176\u4fdd\u6301\u4e00\u81f4\uff08\u9664\u8f6f\u4ef6\u9519\u8bef\u5916\uff09\u3002</li> </ul> <p>\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u76f4\u63a5\u5199\u5165\u641c\u7d22\u7d22\u5f15\u548c\u6570\u636e\u5e93\u5f15\u5165\u5982 \u56fe 11-4 \u6240\u793a\u7684\u95ee\u9898\uff0c\u8fdb\u5165\u5f7c\u6b64\u95f4\u6301\u4e45\u6027\u7684\u4e0d\u4e00\u81f4\u72b6\u6001\u3002</p> <p>\u5982\u679c\u4f60\u53ef\u4ee5\u901a\u8fc7\u5355\u4e2a\u7cfb\u7edf\u6765\u63d0\u4f9b\u6240\u6709\u7528\u6237\u8f93\u5165\uff0c\u4ece\u800c\u51b3\u5b9a\u6240\u6709\u5199\u5165\u7684\u6392\u5e8f\uff0c\u5219\u901a\u8fc7\u6309\u76f8\u540c\u987a\u5e8f\u5904\u7406\u5199\u5165\uff0c\u53ef\u4ee5\u66f4\u5bb9\u6613\u5730\u884d\u751f\u51fa\u5176\u4ed6\u6570\u636e\u8868\u793a\u3002\u8fd9\u662f\u72b6\u6001\u673a\u590d\u5236\u65b9\u6cd5\u7684\u4e00\u4e2a\u5e94\u7528\u3002</p> <ul> <li>\u65e0\u8bba\u4f60\u4f7f\u7528\u53d8\u66f4\u6570\u636e\u6355\u83b7\u8fd8\u662f\u4e8b\u4ef6\u6eaf\u6e90\u65e5\u5fd7\uff0c\u90fd\u4e0d\u5982\u7b80\u5355\u7684\u57fa\u4e8e\u5168\u5e8f\u7684\u51b3\u7b56\u539f\u5219\u66f4\u91cd\u8981\u3002</li> </ul> <p>\u57fa\u4e8e\u4e8b\u4ef6\u65e5\u5fd7\u6765\u66f4\u65b0\u884d\u751f\u6570\u636e\u7684\u7cfb\u7edf\uff0c\u901a\u5e38\u53ef\u4ee5\u505a\u5230 \u786e\u5b9a\u6027 \u4e0e \u5e42\u7b49\u6027\uff0c\u4f7f\u5f97\u4ece\u6545\u969c\u4e2d\u6062\u590d\u76f8\u5f53\u5bb9\u6613\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_5","title":"\u884d\u751f\u6570\u636e\u4e0e\u5206\u5e03\u5f0f\u4e8b\u52a1","text":"<p>\u4fdd\u6301\u4e0d\u540c\u6570\u636e\u7cfb\u7edf\u5f7c\u6b64\u4e00\u81f4\u7684\u7ecf\u5178\u65b9\u6cd5\u6d89\u53ca\u5206\u5e03\u5f0f\u4e8b\u52a1\uff0c\u4e0e\u5206\u5e03\u5f0f\u4e8b\u52a1\u76f8\u6bd4\uff0c\u4f7f\u7528\u884d\u751f\u6570\u636e\u7cfb\u7edf\u7684\u65b9\u6cd5\u5982\u4f55\uff1f</p> <ul> <li>\u5206\u5e03\u5f0f\u4e8b\u52a1\u901a\u8fc7 \u9501 \u8fdb\u884c\u4e92\u65a5\u6765\u51b3\u5b9a\u5199\u5165\u7684\u987a\u5e8f\uff0c\u4f7f\u7528\u539f\u5b50\u63d0\u4ea4\u6765\u786e\u4fdd\u53d8\u66f4\u53ea\u751f\u6548\u4e00\u6b21\uff1b</li> <li>CDC \u548c\u4e8b\u4ef6\u6eaf\u6e90\u4f7f\u7528\u65e5\u5fd7\u8fdb\u884c\u6392\u5e8f\uff0c\u57fa\u4e8e \u786e\u5b9a\u6027\u91cd\u8bd5 \u548c \u5e42\u7b49\u6027\u786e\u4fdd\u53d8\u66f4\u53ea\u751f\u6548\u4e00\u6b21\uff1b</li> </ul> <p>\u6700\u5927\u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u4e8b\u52a1\u7cfb\u7edf\u901a\u5e38\u63d0\u4f9b\u7ebf\u6027\u4e00\u81f4\u6027\uff0c\u8fd9\u5305\u542b\u7740\u6709\u7528\u7684\u4fdd\u8bc1\uff0c\u4f8b\u5982\u8bfb\u5df1\u4e4b\u5199\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u884d\u751f\u6570\u636e\u7cfb\u7edf\u901a\u5e38\u662f\u5f02\u6b65\u66f4\u65b0\u7684\uff0c\u56e0\u6b64\u5b83\u4eec\u9ed8\u8ba4\u4e0d\u4f1a\u63d0\u4f9b\u76f8\u540c\u7684\u65f6\u5e8f\u4fdd\u8bc1\u3002</p> <p>\u5728\u6ca1\u6709\u5e7f\u6cdb\u652f\u6301\u7684\u826f\u597d\u5206\u5e03\u5f0f\u4e8b\u52a1\u534f\u8bae\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u8ba4\u4e3a\u57fa\u4e8e\u65e5\u5fd7\u7684\u884d\u751f\u6570\u636e\u662f\u96c6\u6210\u4e0d\u540c\u6570\u636e\u7cfb\u7edf\u7684\u6700\u6709\u524d\u9014\u7684\u65b9\u6cd5\u3002</p> <ul> <li>XA \u7684\u5bb9\u9519\u80fd\u529b\u548c\u6027\u80fd\u5f88\u5dee\u52b2\uff08\u8bf7\u53c2\u9605 \u201c\u5b9e\u8df5\u4e2d\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u201d\uff09\uff0c\u4e25\u91cd\u9650\u5236\u4e86\u5b83\u7684\u5b9e\u7528\u6027\u3002</li> <li>\u4e3a\u5206\u5e03\u5f0f\u4e8b\u52a1\u8bbe\u8ba1\u4e00\u79cd\u66f4\u597d\u7684\u534f\u8bae\u662f\u53ef\u884c\u7684\uff0c\u4f46\u88ab\u73b0\u6709\u5de5\u5177\u5e7f\u6cdb\u63a5\u53d7\u662f\u5f88\u6709\u6311\u6218\u7684\uff0c\u4e14\u4e0d\u662f\u7acb\u7aff\u89c1\u5f71\u7684\u4e8b\u3002</li> </ul> <p>\u8bf8\u5982\u8bfb\u5df1\u4e4b\u5199\u7684\u4fdd\u8bc1\u662f\u6709\u7528\u7684\uff0c\u6211\u8ba4\u4e3a\u544a\u8bc9\u6240\u6709\u4eba \u201c\u6700\u7ec8\u4e00\u81f4\u6027\u662f\u4e0d\u53ef\u907f\u514d\u7684 \u2014\u2014 \u5fcd\u4e00\u5fcd\u5e76\u5b66\u4f1a\u548c\u5b83\u6253\u4ea4\u9053\u201d \u662f\u6ca1\u6709\u4ec0\u4e48\u5efa\u8bbe\u6027\u7684\uff08\u81f3\u5c11\u5728\u7f3a\u4e4f \u5982\u4f55 \u5e94\u5bf9\u7684\u826f\u597d\u6307\u5bfc\u65f6\uff09\u3002</p> <p>\u5728 \u201c\u5c06\u4e8b\u60c5\u505a\u6b63\u786e\u201d \u4e2d\uff0c\u6211\u4eec\u5c06\u8ba8\u8bba\u4e00\u4e9b\u5728\u5f02\u6b65\u884d\u751f\u7cfb\u7edf\u4e4b\u4e0a\u5b9e\u73b0\u66f4\u5f3a\u4fdd\u969c\u7684\u65b9\u6cd5\uff0c\u5e76\u8fc8\u5411\u5206\u5e03\u5f0f\u4e8b\u52a1\u548c\u57fa\u4e8e\u65e5\u5fd7\u7684\u5f02\u6b65\u7cfb\u7edf\u4e4b\u95f4\u7684\u4e2d\u95f4\u5730\u5e26\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_6","title":"\u5168\u5e8f\u7684\u9650\u5236","text":"<p>\u5bf9\u4e8e\u8db3\u591f\u5c0f\u7684\u7cfb\u7edf\uff0c\u6784\u5efa\u4e00\u4e2a\u5b8c\u5168\u6709\u5e8f\u7684\u4e8b\u4ef6\u65e5\u5fd7\u662f\u5b8c\u5168\u53ef\u884c\u7684\uff08\u6b63\u5982\u5355\u4e3b\u590d\u5236\u6570\u636e\u5e93\u7684\u6d41\u884c\u6240\u8bc1\u660e\u7684\u90a3\u6837\uff09\u3002\u4f46\u662f\uff0c\u968f\u7740\u7cfb\u7edf\u5411\u66f4\u5927\u66f4\u590d\u6742\u7684\u5de5\u4f5c\u8d1f\u8f7d\u4f38\u7f29\uff0c\u9650\u5236\u5f00\u59cb\u51fa\u73b0\uff1a</p> <ul> <li>\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6784\u5efa\u5b8c\u5168\u6709\u5e8f\u7684\u65e5\u5fd7\uff0c\u9700\u8981\u6240\u6709\u4e8b\u4ef6\u6c47\u96c6\u4e8e\u51b3\u5b9a\u987a\u5e8f\u7684 \u5355\u4e2a\u9886\u5bfc\u8005\u8282\u70b9\u3002\u5982\u679c\u4e8b\u4ef6\u541e\u5410\u91cf\u5927\u4e8e\u5355\u53f0\u8ba1\u7b97\u673a\u7684\u5904\u7406\u80fd\u529b\uff0c\u5219\u9700\u8981\u5c06\u5176\u5206\u533a\u5230\u591a\u53f0\u8ba1\u7b97\u673a\u4e0a\u3002\u7136\u540e\u4e24\u4e2a\u4e0d\u540c\u5206\u533a\u4e2d\u7684\u4e8b\u4ef6\u987a\u5e8f\u5173\u7cfb\u5c31\u4e0d\u660e\u786e\u3002</li> <li>\u5982\u679c\u670d\u52a1\u5668\u5206\u5e03\u5728\u591a\u4e2a \u5730\u7406\u4f4d\u7f6e\u5206\u6563 \u7684\u6570\u636e\u4e2d\u5fc3\uff0c\u4e3a\u4e86\u5bb9\u5fcd\u6574\u4e2a\u6570\u636e\u4e2d\u5fc3\u6389\u7ebf\uff0c\u4f60\u901a\u5e38\u5728\u6bcf\u4e2a\u6570\u636e\u4e2d\u5fc3\u90fd\u6709\u5355\u72ec\u7684\u4e3b\u5e93\uff0c\u56e0\u4e3a\u7f51\u7edc\u5ef6\u8fdf\u4f1a\u5bfc\u81f4\u540c\u6b65\u7684\u8de8\u6570\u636e\u4e2d\u5fc3\u534f\u8c03\u6548\u7387\u4f4e\u4e0b\u3002\u610f\u5473\u7740\u6e90\u81ea\u4e24\u4e2a\u4e0d\u540c\u6570\u636e\u4e2d\u5fc3\u7684\u4e8b\u4ef6\u987a\u5e8f\u672a\u5b9a\u4e49\u3002</li> <li>\u5c06\u5e94\u7528\u7a0b\u5e8f\u90e8\u7f72\u4e3a\u5fae\u670d\u52a1\u65f6\uff0c\u5e38\u89c1\u7684\u8bbe\u8ba1\u9009\u62e9\u662f\u5c06\u6bcf\u4e2a\u670d\u52a1\u53ca\u5176\u6301\u4e45\u72b6\u6001\u4f5c\u4e3a\u72ec\u7acb\u5355\u5143\u8fdb\u884c\u90e8\u7f72\uff0c\u670d\u52a1\u4e4b\u95f4\u4e0d\u5171\u4eab\u6301\u4e45\u72b6\u6001\u3002\u5f53\u4e24\u4e2a\u4e8b\u4ef6\u6765\u81ea\u4e0d\u540c\u7684\u670d\u52a1\u65f6\uff0c\u8fd9\u4e9b\u4e8b\u4ef6\u95f4\u7684\u987a\u5e8f\u672a\u5b9a\u4e49\u3002</li> <li>\u67d0\u4e9b\u5e94\u7528\u7a0b\u5e8f\u5728\u5ba2\u6237\u7aef\u4fdd\u5b58\u72b6\u6001\uff0c\u8be5\u72b6\u6001\u5728\u7528\u6237\u8f93\u5165\u65f6\u7acb\u5373\u66f4\u65b0\uff08\u65e0\u9700\u7b49\u5f85\u670d\u52a1\u5668\u786e\u8ba4\uff09\uff0c\u751a\u81f3\u53ef\u4ee5\u7ee7\u7eed\u8131\u673a\u5de5\u4f5c\u3002\u5bf9\u4e8e\u8fd9\u6837\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u5f88\u53ef\u80fd\u4ee5\u4e0d\u540c\u7684\u987a\u5e8f\u770b\u5230\u4e8b\u4ef6\u3002</li> </ul> <p>\u5728\u5f62\u5f0f\u4e0a\uff0c\u51b3\u5b9a\u4e8b\u4ef6\u7684\u5168\u5c40\u987a\u5e8f\u79f0\u4e3a \u5168\u5e8f\u5e7f\u64ad\uff0c\u76f8\u5f53\u4e8e \u5171\u8bc6\u3002\u5927\u591a\u6570\u5171\u8bc6\u7b97\u6cd5\u90fd\u662f\u9488\u5bf9\u5355\u4e2a\u8282\u70b9\u7684\u541e\u5410\u91cf\u8db3\u4ee5\u5904\u7406\u6574\u4e2a\u4e8b\u4ef6\u6d41\u7684\u60c5\u51b5\u800c\u8bbe\u8ba1\u7684\uff0c\u5e76\u4e14\u8fd9\u4e9b\u7b97\u6cd5\u4e0d\u63d0\u4f9b\u591a\u4e2a\u8282\u70b9\u5171\u4eab\u4e8b\u4ef6\u6392\u5e8f\u5de5\u4f5c\u7684\u673a\u5236\u3002\u8bbe\u8ba1\u53ef\u4ee5\u4f38\u7f29\u81f3\u5355\u4e2a\u8282\u70b9\u7684\u541e\u5410\u91cf\u4e4b\u4e0a\uff0c\u4e14\u5728\u5730\u7406\u4f4d\u7f6e\u5206\u6563\u7684\u73af\u5883\u4e2d\u4ecd\u7136\u5de5\u4f5c\u826f\u597d\u7684\u7684\u5171\u8bc6\u7b97\u6cd5\u4ecd\u7136\u662f\u4e00\u4e2a\u5f00\u653e\u7684\u7814\u7a76\u95ee\u9898\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_7","title":"\u6392\u5e8f\u4e8b\u4ef6\u4ee5\u6355\u83b7\u56e0\u679c\u5173\u7cfb","text":"<p>\u5728\u4e8b\u4ef6\u4e4b\u95f4\u4e0d\u5b58\u5728\u56e0\u679c\u5173\u7cfb\u7684\u60c5\u51b5\u4e0b\uff0c\u5168\u5e8f\u7684\u7f3a\u4e4f\u5e76\u4e0d\u662f\u4e00\u4e2a\u5927\u95ee\u9898\uff0c\u56e0\u4e3a\u5e76\u53d1\u4e8b\u4ef6\u53ef\u4ee5\u4efb\u610f\u6392\u5e8f\u3002\u4f8b\u5982\uff0c\u5f53\u540c\u4e00\u5bf9\u8c61\u6709\u591a\u4e2a\u66f4\u65b0\u65f6\uff0c\u5b83\u4eec\u53ef\u4ee5\u901a\u8fc7\u5c06\u7279\u5b9a\u5bf9\u8c61 ID \u7684\u6240\u6709\u66f4\u65b0\u8def\u7531\u5230\u76f8\u540c\u7684\u65e5\u5fd7\u5206\u533a\u6765\u5b8c\u5168\u6392\u5e8f\u3002\u7136\u800c\uff0c\u56e0\u679c\u5173\u7cfb\u6709\u65f6\u4f1a\u4ee5\u66f4\u5fae\u5999\u7684\u65b9\u5f0f\u51fa\u73b0\u3002</p> <p>\u4f8b\u5982\uff0c\u8003\u8651\u4e00\u4e2a\u793e\u4ea4\u7f51\u7edc\u670d\u52a1\uff0c\u4ee5\u53ca\u4e00\u5bf9\u66fe\u5904\u4e8e\u604b\u7231\u5173\u7cfb\u4f46\u521a\u5206\u624b\u7684\u7528\u6237\u3002\u5176\u4e2d\u4e00\u4e2a\u7528\u6237\u5c06\u53e6\u4e00\u4e2a\u7528\u6237\u4ece\u597d\u53cb\u4e2d\u79fb\u9664\uff0c\u7136\u540e\u5411\u5269\u4f59\u7684\u597d\u53cb\u53d1\u9001\u6d88\u606f\uff0c\u62b1\u6028\u4ed6\u4eec\u7684\u524d\u4efb\u3002\u7528\u6237\u7684\u5fc3\u601d\u662f\u4ed6\u4eec\u7684\u524d\u4efb\u4e0d\u5e94\u8be5\u770b\u5230\u8fd9\u4e9b\u7c97\u9c81\u7684\u6d88\u606f\uff0c\u56e0\u4e3a\u6d88\u606f\u662f\u5728\u597d\u53cb\u72b6\u6001\u89e3\u9664\u540e\u53d1\u9001\u7684\u3002</p> <ul> <li>\u4f46\u662f\u5982\u679c\u597d\u53cb\u5173\u7cfb\u72b6\u6001\u4e0e\u6d88\u606f\u5b58\u50a8\u5728\u4e0d\u540c\u7684\u5730\u65b9\uff0c\u5728\u8fd9\u6837\u4e00\u4e2a\u7cfb\u7edf\u4e2d\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0 \u89e3\u9664\u597d\u53cb \u4e8b\u4ef6\u4e0e \u53d1\u9001\u6d88\u606f \u4e8b\u4ef6\u4e4b\u95f4\u7684\u56e0\u679c\u4f9d\u8d56\u4e22\u5931\u7684\u60c5\u51b5\u3002</li> <li>\u5982\u679c\u56e0\u679c\u4f9d\u8d56\u5173\u7cfb\u6ca1\u6709\u88ab\u6355\u6349\u5230\uff0c\u5219\u53d1\u9001\u6709\u5173\u65b0\u6d88\u606f\u7684\u901a\u77e5\u7684\u670d\u52a1\u53ef\u80fd\u4f1a\u5728 \u89e3\u9664\u597d\u53cb \u4e8b\u4ef6\u4e4b\u524d\u5904\u7406 \u53d1\u9001\u6d88\u606f \u4e8b\u4ef6\uff0c\u4ece\u800c\u9519\u8bef\u5730\u5411\u524d\u4efb\u53d1\u9001\u901a\u77e5\u3002</li> </ul> <p>\u5728\u672c\u4f8b\u4e2d\uff0c\u901a\u77e5\u5b9e\u9645\u4e0a\u662f\u6d88\u606f\u548c\u597d\u53cb\u5217\u8868\u4e4b\u95f4\u7684\u8fde\u63a5\uff0c\u4f7f\u5f97\u5b83\u4e0e\u6211\u4eec\u5148\u524d\u8ba8\u8bba\u7684\u8fde\u63a5\u7684\u65f6\u5e8f\u95ee\u9898\u6709\u5173\u3002\u4e0d\u5e78\u7684\u662f\uff0c\u8fd9\u4e2a\u95ee\u9898\u4f3c\u4e4e\u5e76\u6ca1\u6709\u4e00\u4e2a\u7b80\u5355\u7684\u7b54\u6848\u30102,3\u3011\uff1a</p> <ul> <li>\u903b\u8f91\u65f6\u95f4\u6233\u53ef\u4ee5\u63d0\u4f9b\u65e0\u9700\u534f\u8c03\u7684\u5168\u5c40\u987a\u5e8f\uff0c\u56e0\u6b64\u5b83\u4eec\u53ef\u80fd\u6709\u52a9\u4e8e\u5168\u5e8f\u5e7f\u64ad\u4e0d\u53ef\u884c\u7684\u60c5\u51b5\u3002\u4f46\u662f\uff0c\u4ed6\u4eec\u4ecd\u7136\u8981\u6c42\u6536\u4ef6\u4eba\u5904\u7406\u4e0d\u6309\u987a\u5e8f\u53d1\u9001\u7684\u4e8b\u4ef6\uff0c\u5e76\u4e14\u9700\u8981\u4f20\u9012\u5176\u4ed6\u5143\u6570\u636e\u3002</li> <li>\u5982\u679c\u4f60\u53ef\u4ee5\u8bb0\u5f55\u4e00\u4e2a\u4e8b\u4ef6\u6765\u8bb0\u5f55\u7528\u6237\u5728\u505a\u51fa\u51b3\u5b9a\u4e4b\u524d\u6240\u770b\u5230\u7684\u7cfb\u7edf\u72b6\u6001\uff0c\u5e76\u7ed9\u8be5\u4e8b\u4ef6\u4e00\u4e2a\u552f\u4e00\u7684\u6807\u8bc6\u7b26\uff0c\u90a3\u4e48\u540e\u9762\u7684\u4efb\u4f55\u4e8b\u4ef6\u90fd\u53ef\u4ee5\u5f15\u7528\u8be5\u4e8b\u4ef6\u6807\u8bc6\u7b26\u6765\u8bb0\u5f55\u56e0\u679c\u5173\u7cfb\u30104\u3011\u3002</li> <li>\u51b2\u7a81\u89e3\u51b3\u7b97\u6cd5\uff08\u8bf7\u53c2\u9605 \u201c\u81ea\u52a8\u51b2\u7a81\u89e3\u51b3\u201d\uff09\u6709\u52a9\u4e8e\u5904\u7406\u4ee5\u610f\u5916\u987a\u5e8f\u4f20\u9012\u7684\u4e8b\u4ef6\u3002\u5b83\u4eec\u5bf9\u4e8e\u7ef4\u62a4\u72b6\u6001\u5f88\u6709\u7528\uff0c\u4f46\u5982\u679c\u884c\u4e3a\u6709\u5916\u90e8\u526f\u4f5c\u7528\uff08\u4f8b\u5982\uff0c\u7ed9\u7528\u6237\u53d1\u9001\u901a\u77e5\uff09\uff0c\u5c31\u6ca1\u4ec0\u4e48\u5e2e\u52a9\u4e86\u3002</li> </ul> <p>\u4e5f\u8bb8\uff0c\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\uff0c\u5e94\u7528\u5f00\u53d1\u6a21\u5f0f\u5c06\u51fa\u73b0\uff0c\u4f7f\u5f97\u80fd\u591f\u6709\u6548\u5730\u6355\u83b7\u56e0\u679c\u4f9d\u8d56\u5173\u7cfb\uff0c\u5e76\u4e14\u4fdd\u6301\u6b63\u786e\u7684\u884d\u751f\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u8feb\u4f7f\u6240\u6709\u4e8b\u4ef6\u7ecf\u5386\u5168\u5e8f\u5e7f\u64ad\u7684\u74f6\u9888\uff09\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_8","title":"\u6279\u5904\u7406\u4e0e\u6d41\u5904\u7406","text":"<p>\u6570\u636e\u96c6\u6210\u7684\u76ee\u6807\u662f\uff0c\u786e\u4fdd\u6570\u636e\u6700\u7ec8\u80fd\u5728\u6240\u6709\u6b63\u786e\u7684\u5730\u65b9\u8868\u73b0\u51fa\u6b63\u786e\u7684\u5f62\u5f0f\u3002\u8fd9\u6837\u505a\u9700\u8981\u6d88\u8d39\u8f93\u5165\u3001\u8f6c\u6362\u3001\u8fde\u63a5\u3001\u8fc7\u6ee4\u3001\u805a\u5408\u3001\u8bad\u7ec3\u6a21\u578b\u3001\u8bc4\u4f30\u3001\u4ee5\u53ca\u6700\u7ec8\u5199\u51fa\u9002\u5f53\u7684\u8f93\u51fa\u3002</p> <p>\u6279\u5904\u7406\u548c\u6d41\u5904\u7406\u662f\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\u7684\u5de5\u5177\u3002\u8f93\u51fa\u662f\u884d\u751f\u6570\u636e\u96c6\uff0c\u4f8b\u5982\u641c\u7d22\u7d22\u5f15\u3001\u7269\u5316\u89c6\u56fe\u3001\u5411\u7528\u6237\u663e\u793a\u7684\u5efa\u8bae\u3001\u805a\u5408\u6307\u6807\u7b49\u3002</p> <p>Spark \u5728\u6279\u5904\u7406\u5f15\u64ce\u4e0a\u6267\u884c\u6d41\u5904\u7406\uff0c\u5c06\u6d41\u5206\u89e3\u4e3a \u5fae\u6279\u6b21\uff08microbatches\uff09\uff0c\u800c Apache Flink \u5219\u5728\u6d41\u5904\u7406\u5f15\u64ce\u4e0a\u6267\u884c\u6279\u5904\u7406\u30105\u3011\u3002</p> <ul> <li>\u539f\u5219\u4e0a\uff0c\u4e00\u79cd\u7c7b\u578b\u7684\u5904\u7406\u53ef\u4ee5\u7528\u53e6\u4e00\u79cd\u7c7b\u578b\u6765\u6a21\u62df\uff0c\u4f46\u662f\u6027\u80fd\u7279\u5f81\u4f1a\u6709\u6240\u4e0d\u540c\uff1a\u4f8b\u5982\uff0c\u5728\u8df3\u8dc3\u6216\u6ed1\u52a8\u7a97\u53e3\u4e0a\uff0c\u5fae\u6279\u6b21\u53ef\u80fd\u8868\u73b0\u4e0d\u4f73\u30106\u3011\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_9","title":"\u7ef4\u62a4\u884d\u751f\u72b6\u6001","text":"<p>\u6279\u5904\u7406\u6709\u7740\u5f88\u5f3a\u7684\u51fd\u6570\u5f0f\u98ce\u683c\uff08\u5373\u4f7f\u5176\u4ee3\u7801\u4e0d\u662f\u7528\u51fd\u6570\u5f0f\u8bed\u8a00\u7f16\u5199\u7684\uff09\uff1a\u5b83\u9f13\u52b1\u786e\u5b9a\u6027\u7684\u7eaf\u51fd\u6570\uff0c\u5176\u8f93\u51fa\u4ec5\u4f9d\u8d56\u4e8e\u8f93\u5165\uff0c\u9664\u4e86\u663e\u5f0f\u8f93\u51fa\u5916\u6ca1\u6709\u526f\u4f5c\u7528\uff0c\u5c06\u8f93\u5165\u89c6\u4f5c\u4e0d\u53ef\u53d8\u7684\uff0c\u4e14\u8f93\u51fa\u662f\u4ec5\u8ffd\u52a0\u7684\u3002\u6d41\u5904\u7406\u4e0e\u4e4b\u7c7b\u4f3c\uff0c\u4f46\u5b83\u6269\u5c55\u4e86\u7b97\u5b50\u4ee5\u5141\u8bb8\u53d7\u7ba1\u7406\u7684\u3001\u5bb9\u9519\u7684\u72b6\u6001\u3002</p> <p>\u5177\u6709\u826f\u597d\u5b9a\u4e49\u7684\u8f93\u5165\u548c\u8f93\u51fa\u7684\u786e\u5b9a\u6027\u51fd\u6570\u7684\u539f\u7406\u4e0d\u4ec5\u6709\u5229\u4e8e\u5bb9\u9519\uff0c\u4e5f\u7b80\u5316\u4e86\u6709\u5173\u7ec4\u7ec7\u4e2d\u6570\u636e\u6d41\u7684\u63a8\u7406\u30107\u3011\u3002</p> <ul> <li>\u65e0\u8bba\u884d\u751f\u6570\u636e\u662f\u641c\u7d22\u7d22\u5f15\u3001\u7edf\u8ba1\u6a21\u578b\u8fd8\u662f\u7f13\u5b58\uff1a\u5c06\u5176\u89c6\u4e3a\u4ece\u4e00\u4e2a\u4e1c\u897f\u884d\u751f\u51fa\u53e6\u4e00\u4e2a\u7684\u6570\u636e\u7ba1\u9053\uff0c\u901a\u8fc7\u51fd\u6570\u5f0f\u5e94\u7528\u4ee3\u7801\u63a8\u9001\u4e00\u4e2a\u7cfb\u7edf\u7684\u72b6\u6001\u53d8\u66f4\uff0c\u5e76\u5c06\u5176\u6548\u679c\u5e94\u7528\u81f3\u884d\u751f\u7cfb\u7edf\u4e2d\u3002</li> </ul> <p>\u539f\u5219\u4e0a\uff0c\u884d\u751f\u6570\u636e\u7cfb\u7edf\u53ef\u4ee5\u540c\u6b65\u5730\u7ef4\u62a4\uff0c\u5c31\u50cf\u5173\u7cfb\u6570\u636e\u5e93\u5728\u4e0e\u7d22\u5f15\u8868\u5199\u5165\u64cd\u4f5c\u76f8\u540c\u7684\u4e8b\u52a1\u4e2d\u540c\u6b65\u66f4\u65b0\u6b21\u7ea7\u7d22\u5f15\u4e00\u6837\u3002\u7136\u800c\uff0c\u5f02\u6b65\u662f\u4f7f\u57fa\u4e8e\u4e8b\u4ef6\u65e5\u5fd7\u7684\u7cfb\u7edf\u7a33\u5065\u7684\u539f\u56e0\uff1a</p> <ul> <li>\u5b83\u5141\u8bb8\u7cfb\u7edf\u7684\u4e00\u90e8\u5206\u6545\u969c\u88ab\u6291\u5236\u5728\u672c\u5730\u3002\u800c\u5982\u679c\u4efb\u4f55\u4e00\u4e2a\u53c2\u4e0e\u8005\u5931\u8d25\uff0c\u5206\u5e03\u5f0f\u4e8b\u52a1\u5c06\u4e2d\u6b62\uff0c\u56e0\u6b64\u5b83\u4eec\u503e\u5411\u4e8e\u901a\u8fc7\u5c06\u6545\u969c\u4f20\u64ad\u5230\u7cfb\u7edf\u7684\u5176\u4f59\u90e8\u5206\u6765\u653e\u5927\u6545\u969c\u3002</li> </ul> <p>\u6b21\u7ea7\u7d22\u5f15\u7ecf\u5e38\u8de8\u8d8a\u5206\u533a\u8fb9\u754c\u3002\u5177\u6709\u6b21\u7ea7\u7d22\u5f15\u7684\u5206\u533a\u7cfb\u7edf\u9700\u8981\u5c06\u5199\u5165\u53d1\u9001\u5230\u591a\u4e2a\u5206\u533a\uff08\u5982\u679c\u7d22\u5f15\u6309\u5173\u952e\u8bcd\u5206\u533a\u7684\u8bdd\uff09\u6216\u5c06\u8bfb\u53d6\u53d1\u9001\u5230\u6240\u6709\u5206\u533a\uff08\u5982\u679c\u7d22\u5f15\u662f\u6309\u6587\u6863\u5206\u533a\u7684\u8bdd\uff09\u3002\u5982\u679c\u7d22\u5f15\u662f\u5f02\u6b65\u7ef4\u62a4\u7684\uff0c\u8fd9\u79cd\u8de8\u5206\u533a\u901a\u4fe1\u4e5f\u662f\u6700\u53ef\u9760\u548c\u6700\u53ef\u4f38\u7f29\u7684\u30108\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_10","title":"\u5e94\u7528\u6f14\u5316\u540e\u91cd\u65b0\u5904\u7406\u6570\u636e","text":"<p>\u5728\u7ef4\u62a4\u884d\u751f\u6570\u636e\u65f6\uff0c\u6279\u5904\u7406\u548c\u6d41\u5904\u7406\u90fd\u662f\u6709\u7528\u7684\u3002\u6d41\u5904\u7406\u5141\u8bb8\u5c06\u8f93\u5165\u4e2d\u7684\u53d8\u5316\u4ee5\u4f4e\u5ef6\u8fdf\u53cd\u6620\u5728\u884d\u751f\u89c6\u56fe\u4e2d\uff0c\u800c\u6279\u5904\u7406\u5141\u8bb8\u91cd\u65b0\u5904\u7406\u5927\u91cf\u7d2f\u79ef\u7684\u5386\u53f2\u6570\u636e\u4ee5\u4fbf\u5c06\u65b0\u89c6\u56fe\u5bfc\u51fa\u5230\u73b0\u6709\u6570\u636e\u96c6\u4e0a\u3002</p> <p>\u7279\u522b\u662f\uff0c\u91cd\u65b0\u5904\u7406\u73b0\u6709\u6570\u636e\u4e3a\u7ef4\u62a4\u7cfb\u7edf\u3001\u6f14\u5316\u5e76\u652f\u6301\u65b0\u529f\u80fd\u548c\u9700\u6c42\u53d8\u66f4\u63d0\u4f9b\u4e86\u4e00\u4e2a\u826f\u597d\u7684\u673a\u5236\uff1a</p> <ul> <li>\u6ca1\u6709\u91cd\u65b0\u8fdb\u884c\u5904\u7406\uff0c\u6a21\u5f0f\u6f14\u5316\u5c06\u4ec5\u9650\u4e8e\u7b80\u5355\u7684\u53d8\u5316\uff0c\u4f8b\u5982\u5411\u8bb0\u5f55\u4e2d\u6dfb\u52a0\u65b0\u7684\u53ef\u9009\u5b57\u6bb5\u6216\u6dfb\u52a0\u65b0\u7c7b\u578b\u7684\u8bb0\u5f55\uff08\u65e0\u8bba\u5199\u65f6\u6a21\u5f0f\u8fd8\u662f\u8bfb\u65f6\u6a21\u5f0f\uff09\u3002</li> <li>\u901a\u8fc7\u91cd\u65b0\u5904\u7406\uff0c\u53ef\u4ee5\u5c06\u6570\u636e\u96c6\u91cd\u7ec4\u4e3a\u4e00\u4e2a\u5b8c\u5168\u4e0d\u540c\u7684\u6a21\u578b\uff0c\u4ee5\u4fbf\u66f4\u597d\u5730\u6ee1\u8db3\u65b0\u7684\u8981\u6c42\u3002</li> </ul> <p>\u884d\u751f\u89c6\u56fe\u5141\u8bb8 \u6e10\u8fdb\u6f14\u5316\uff08gradual evolution\uff09\u3002\u5982\u679c\u4f60\u60f3\u91cd\u65b0\u6784\u5efa\u6570\u636e\u96c6\uff0c\u4e0d\u9700\u8981\u6267\u884c\u7a81\u7136\u5207\u6362\u5f0f\u7684\u8fc1\u79fb\u3002</p> <ul> <li>\u5c06\u65e7\u67b6\u6784\u548c\u65b0\u67b6\u6784\u5e76\u6392\u7ef4\u62a4\u4e3a\u76f8\u540c\u57fa\u7840\u6570\u636e\u4e0a\u7684\u4e24\u4e2a\u72ec\u7acb\u884d\u751f\u89c6\u56fe\u3002</li> <li>\u5c06\u5c11\u91cf\u7528\u6237\u8f6c\u79fb\u5230\u65b0\u89c6\u56fe\uff0c\u4ee5\u6d4b\u8bd5\u5176\u6027\u80fd\u5e76\u53d1\u73b0\u4efb\u4f55\u9519\u8bef\uff0c\u800c\u5927\u591a\u6570\u7528\u6237\u4ecd\u7136\u4f1a\u88ab\u8def\u7531\u5230\u65e7\u89c6\u56fe\u3002</li> <li>\u9010\u6e10\u5730\u589e\u52a0\u8bbf\u95ee\u65b0\u89c6\u56fe\u7684\u7528\u6237\u6bd4\u4f8b\uff0c\u6700\u7ec8\u53ef\u4ee5\u5220\u9664\u65e7\u89c6\u56fe\u301010\u3011\u3002</li> </ul> <p>\u8fd9\u79cd\u9010\u6e10\u8fc1\u79fb\u7684\u4f18\u52bf\u662f\u5982\u679c\u51fa\u73b0\u95ee\u9898\uff0c\u6bcf\u4e2a\u9636\u6bb5\u7684\u8fc7\u7a0b\u90fd\u5f88\u5bb9\u6613\u9006\u8f6c\uff1a\u4f60\u59cb\u7ec8\u6709\u4e00\u4e2a\u53ef\u4ee5\u56de\u6eda\u7684\u53ef\u7528\u7cfb\u7edf\u3002\u901a\u8fc7\u964d\u4f4e\u4e0d\u53ef\u9006\u635f\u5bb3\u7684\u98ce\u9669\uff0c\u4f60\u80fd\u5bf9\u7ee7\u7eed\u524d\u8fdb\u66f4\u6709\u4fe1\u5fc3\uff0c\u4ece\u800c\u66f4\u5feb\u5730\u6539\u5584\u7cfb\u7edf\u301011\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#lambda","title":"Lambda\u67b6\u6784","text":"<p>Lambda \u67b6\u6784\u7684\u6838\u5fc3\u601d\u60f3\u662f\u901a\u8fc7\u5c06\u4e0d\u53ef\u53d8\u4e8b\u4ef6\u9644\u52a0\u5230\u4e0d\u65ad\u589e\u957f\u7684\u6570\u636e\u96c6\u6765\u8bb0\u5f55\u4f20\u5165\u6570\u636e\uff0c\u8fd9\u7c7b\u4f3c\u4e8e\u4e8b\u4ef6\u6eaf\u6e90\u3002</p> <p>Lambda \u67b6\u6784\u5efa\u8bae\u5e76\u884c\u8fd0\u884c\u4e24\u4e2a\u4e0d\u540c\u7684\u7cfb\u7edf\uff1a\u6279\u5904\u7406\u7cfb\u7edf\uff08\u5982 Hadoop MapReduce\uff09\u548c\u72ec\u7acb\u7684\u6d41\u5904\u7406\u7cfb\u7edf\uff08\u5982 Storm\uff09\u3002</p> <ul> <li>\u6d41\u5904\u7406\u5668\u6d88\u8017\u4e8b\u4ef6\u5e76\u5feb\u901f\u751f\u6210\u5bf9\u89c6\u56fe\u7684\u8fd1\u4f3c\u66f4\u65b0\uff1b</li> <li>\u6279\u5904\u7406\u5668\u7a0d\u540e\u5c06\u4f7f\u7528\u540c\u4e00\u7ec4\u4e8b\u4ef6\u5e76\u751f\u6210\u884d\u751f\u89c6\u56fe\u7684\u66f4\u6b63\u7248\u672c\u3002</li> </ul> <p>\u8fd9\u4e2a\u8bbe\u8ba1\u80cc\u540e\u7684\u539f\u56e0\u662f\u6279\u5904\u7406\u66f4\u7b80\u5355\uff0c\u56e0\u6b64\u4e0d\u6613\u51fa\u9519\uff0c\u800c\u6d41\u5904\u7406\u5668\u88ab\u8ba4\u4e3a\u662f\u4e0d\u592a\u53ef\u9760\u548c\u96be\u4ee5\u5bb9\u9519\u7684\u3002\u800c\u4e14\uff0c\u6d41\u5904\u7406\u53ef\u4ee5\u4f7f\u7528\u5feb\u901f\u8fd1\u4f3c\u7b97\u6cd5\uff0c\u800c\u6279\u5904\u7406\u4f7f\u7528\u8f83\u6162\u7684\u7cbe\u786e\u7b97\u6cd5\u3002</p> <p>Lambda \u67b6\u6784\u662f\u4e00\u79cd\u6709\u5f71\u54cd\u529b\u7684\u60f3\u6cd5\uff0c\u5b83\u5c06\u6570\u636e\u7cfb\u7edf\u7684\u8bbe\u8ba1\u53d8\u5f97\u66f4\u597d\uff0c\u5c24\u5176\u662f\u901a\u8fc7\u63a8\u5e7f\u8fd9\u6837\u7684\u539f\u5219\uff1a\u5728\u4e0d\u53ef\u53d8\u4e8b\u4ef6\u6d41\u4e0a\u5efa\u7acb\u884d\u751f\u89c6\u56fe\uff0c\u5e76\u5728\u9700\u8981\u65f6\u91cd\u65b0\u5904\u7406\u4e8b\u4ef6\u3002\u4f46\u662f\u6211\u4e5f\u8ba4\u4e3a\u5b83\u6709\u4e00\u4e9b\u5b9e\u9645\u95ee\u9898\uff1a</p> <ul> <li>\u5728\u6279\u5904\u7406\u548c\u6d41\u5904\u7406\u6846\u67b6\u4e2d\u7ef4\u62a4\u76f8\u540c\u7684\u903b\u8f91\u662f\u5f88\u663e\u8457\u7684\u989d\u5916\u5de5\u4f5c\u3002</li> <li>\u7531\u4e8e\u6d41\u7ba1\u9053\u548c\u6279\u5904\u7406\u7ba1\u9053\u4ea7\u751f\u72ec\u7acb\u7684\u8f93\u51fa\uff0c\u56e0\u6b64\u9700\u8981\u5408\u5e76\u5b83\u4eec\u4ee5\u54cd\u5e94\u7528\u6237\u8bf7\u6c42\u3002\u5982\u679c\u8ba1\u7b97\u662f\u57fa\u4e8e\u6eda\u52a8\u7a97\u53e3\u7684\u7b80\u5355\u805a\u5408\uff0c\u5219\u5408\u5e76\u76f8\u5f53\u5bb9\u6613\uff0c\u4f46\u5982\u679c\u89c6\u56fe\u57fa\u4e8e\u66f4\u590d\u6742\u7684\u64cd\u4f5c\uff08\u4f8b\u5982\u8fde\u63a5\u548c\u4f1a\u8bdd\u5316\uff09\u800c\u5bfc\u51fa\uff0c\u6216\u8005\u8f93\u51fa\u4e0d\u662f\u65f6\u95f4\u5e8f\u5217\uff0c\u5219\u4f1a\u53d8\u5f97\u975e\u5e38\u56f0\u96be\u3002</li> <li>\u5c3d\u7ba1\u6709\u80fd\u529b\u91cd\u65b0\u5904\u7406\u6574\u4e2a\u5386\u53f2\u6570\u636e\u96c6\u662f\u5f88\u597d\u7684\uff0c\u4f46\u5728\u5927\u578b\u6570\u636e\u96c6\u4e0a\u8fd9\u6837\u505a\u7ecf\u5e38\u4f1a\u5f00\u9500\u5de8\u5927\u3002\u56e0\u6b64\uff0c\u6279\u5904\u7406\u6d41\u6c34\u7ebf\u901a\u5e38\u9700\u8981\u8bbe\u7f6e\u4e3a\u5904\u7406\u589e\u91cf\u6279\u5904\u7406\uff08\u4f8b\u5982\uff0c\u5728\u6bcf\u5c0f\u65f6\u7ed3\u675f\u65f6\u5904\u7406\u4e00\u5c0f\u65f6\u7684\u6570\u636e\uff09\uff0c\u800c\u4e0d\u662f\u91cd\u65b0\u5904\u7406\u6240\u6709\u5185\u5bb9\u3002</li> <li>\u5f15\u53d1\u4e86 \u201c\u65f6\u95f4\u63a8\u7406\u201d \u4e2d\u8ba8\u8bba\u7684\u95ee\u9898\uff0c\u4f8b\u5982\u5904\u7406\u6ede\u7559\u4e8b\u4ef6\u548c\u5904\u7406\u8de8\u6279\u6b21\u8fb9\u754c\u7684\u7a97\u53e3\u3002\u589e\u91cf\u5316\u6279\u5904\u7406\u8ba1\u7b97\u4f1a\u589e\u52a0\u590d\u6742\u6027\uff0c\u4f7f\u5176\u66f4\u7c7b\u4f3c\u4e8e\u6d41\u5f0f\u4f20\u8f93\u5c42\uff0c\u8fd9\u4e0e\u4fdd\u6301\u6279\u5904\u7406\u5c42\u5c3d\u53ef\u80fd\u7b80\u5355\u7684\u76ee\u6807\u80cc\u9053\u800c\u9a70\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_11","title":"\u7edf\u4e00\u6279\u5904\u7406\u548c\u6d41\u5904\u7406","text":"<p>\u6700\u8fd1\u7684\u5de5\u4f5c\u4f7f\u5f97 Lambda \u67b6\u6784\u7684\u4f18\u70b9\u5728\u6ca1\u6709\u5176\u7f3a\u70b9\u7684\u60c5\u51b5\u4e0b\u5f97\u4ee5\u5b9e\u73b0\uff0c\u5141\u8bb8\u6279\u5904\u7406\u8ba1\u7b97\uff08\u91cd\u65b0\u5904\u7406\u5386\u53f2\u6570\u636e\uff09\u548c\u6d41\u8ba1\u7b97\uff08\u5728\u4e8b\u4ef6\u5230\u8fbe\u65f6\u5373\u5904\u7406\uff09\u5728\u540c\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u5b9e\u73b0\u301015\u3011\u3002</p> <p>\u5728\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u7edf\u4e00\u6279\u5904\u7406\u548c\u6d41\u5904\u7406\u9700\u8981\u4ee5\u4e0b\u529f\u80fd\uff0c\u8fd9\u4e9b\u529f\u80fd\u4e5f\u6b63\u5728\u8d8a\u6765\u8d8a\u5e7f\u6cdb\u5730\u88ab\u63d0\u4f9b\uff1a</p> <ul> <li>\u901a\u8fc7\u5904\u7406\u6700\u8fd1\u4e8b\u4ef6\u6d41\u7684\u76f8\u540c\u5904\u7406\u5f15\u64ce\u6765\u91cd\u64ad\u5386\u53f2\u4e8b\u4ef6\u7684\u80fd\u529b\u3002</li> <li>\u4f8b\u5982\uff0c\u57fa\u4e8e\u65e5\u5fd7\u7684\u6d88\u606f\u4ee3\u7406\u53ef\u4ee5\u91cd\u64ad\u6d88\u606f\uff0c\u67d0\u4e9b\u6d41\u5904\u7406\u5668\u53ef\u4ee5\u4ece HDFS \u7b49\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u8bfb\u53d6\u8f93\u5165\u3002</li> <li>\u5bf9\u4e8e\u6d41\u5904\u7406\u5668\u6765\u8bf4\uff0c\u6070\u597d\u4e00\u6b21\u8bed\u4e49 \u2014\u2014 \u5373\u786e\u4fdd\u8f93\u51fa\u4e0e\u672a\u53d1\u751f\u6545\u969c\u7684\u8f93\u51fa\u76f8\u540c\uff0c\u5373\u4f7f\u4e8b\u5b9e\u4e0a\u53d1\u751f\u6545\u969c\u3002</li> <li>\u6309\u4e8b\u4ef6\u65f6\u95f4\u8fdb\u884c\u7a97\u53e3\u5316\u7684\u5de5\u5177\uff0c\u800c\u4e0d\u662f\u6309\u5904\u7406\u65f6\u95f4\u8fdb\u884c\u7a97\u53e3\u5316\uff0c\u56e0\u4e3a\u5904\u7406\u5386\u53f2\u4e8b\u4ef6\u65f6\uff0c\u5904\u7406\u65f6\u95f4\u6beb\u65e0\u610f\u4e49\u3002</li> <li>\u4f8b\u5982\uff0cApache Beam \u63d0\u4f9b\u4e86\u7528\u4e8e\u8868\u8fbe\u8fd9\u79cd\u8ba1\u7b97\u7684 API\uff0c\u53ef\u4ee5\u5728 Apache Flink \u6216 Google Cloud Dataflow \u4f7f\u7528\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_12","title":"\u5206\u62c6\u6570\u636e\u5e93","text":"<p>\u5728\u6700\u62bd\u8c61\u7684\u5c42\u9762\u4e0a\uff0c\u6570\u636e\u5e93\uff0cHadoop \u548c\u64cd\u4f5c\u7cfb\u7edf\u90fd\u53d1\u6325\u76f8\u540c\u7684\u529f\u80fd\uff1a\u5b83\u4eec\u5b58\u50a8\u4e00\u4e9b\u6570\u636e\uff0c\u5e76\u5141\u8bb8\u4f60\u5904\u7406\u548c\u67e5\u8be2\u8fd9\u4e9b\u6570\u636e\u301016\u3011\u3002\u5176\u6838\u5fc3\u90fd\u662f \u201c\u4fe1\u606f\u7ba1\u7406\u201d \u7cfb\u7edf\u301017\u3011\u3002</p> <ul> <li>\u6709\u5f88\u591a\u5b9e\u9645\u7684\u5dee\u5f02\uff1a\u8bb8\u591a\u6587\u4ef6\u7cfb\u7edf\u90fd\u4e0d\u80fd\u5f88\u597d\u5730\u5904\u7406\u5305\u542b 1000 \u4e07\u4e2a\u5c0f\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u800c\u5305\u542b 1000 \u4e07\u4e2a\u5c0f\u8bb0\u5f55\u7684\u6570\u636e\u5e93\u5b8c\u5168\u662f\u5bfb\u5e38\u800c\u4e0d\u8d77\u773c\u7684\u3002</li> </ul> <p>Unix \u548c\u5173\u7cfb\u6570\u636e\u5e93\u4ee5\u975e\u5e38\u4e0d\u540c\u7684\u54f2\u5b66\u6765\u5904\u7406\u4fe1\u606f\u7ba1\u7406\u95ee\u9898\u3002Unix \u53d1\u5c55\u51fa\u7684\u7ba1\u9053\u548c\u6587\u4ef6\u53ea\u662f\u5b57\u8282\u5e8f\u5217\uff0c\u800c\u6570\u636e\u5e93\u5219\u53d1\u5c55\u51fa\u4e86 SQL \u548c\u4e8b\u52a1\u3002</p> <ul> <li>Unix \u8ba4\u4e3a\u5b83\u7684\u76ee\u7684\u662f\u4e3a\u7a0b\u5e8f\u5458\u63d0\u4f9b\u4e00\u79cd\u76f8\u5f53\u4f4e\u5c42\u6b21\u7684\u786c\u4ef6\u7684\u903b\u8f91\u62bd\u8c61\uff1b</li> <li>\u5173\u7cfb\u6570\u636e\u5e93\u5219\u5e0c\u671b\u4e3a\u5e94\u7528\u7a0b\u5e8f\u5458\u63d0\u4f9b\u4e00\u79cd\u9ad8\u5c42\u6b21\u7684\u62bd\u8c61\uff0c\u4ee5\u9690\u85cf\u78c1\u76d8\u4e0a\u6570\u636e\u7ed3\u6784\u7684\u590d\u6742\u6027\u3001\u5e76\u53d1\u6027\u3001\u5d29\u6e83\u6062\u590d\u7b49\u7b49\u3002</li> </ul> <p>\u8fd9\u4e9b\u54f2\u5b66\u4e4b\u95f4\u7684\u77db\u76fe\u5df2\u7ecf\u6301\u7eed\u4e86\u51e0\u5341\u5e74\uff08Unix \u548c\u5173\u7cfb\u6a21\u578b\u90fd\u51fa\u73b0\u5728 70 \u5e74\u4ee3\u521d\uff09\uff0c\u4ecd\u7136\u6ca1\u6709\u89e3\u51b3\u3002\u4f8b\u5982\uff0c\u6211\u5c06 NoSQL \u8fd0\u52a8\u89e3\u91ca\u4e3a\uff0c\u5e0c\u671b\u5c06\u7c7b Unix \u7684\u4f4e\u7ea7\u522b\u62bd\u8c61\u65b9\u6cd5\u5e94\u7528\u4e8e\u5206\u5e03\u5f0f OLTP \u6570\u636e\u5b58\u50a8\u7684\u9886\u57df\u3002</p> <p>\u5728\u8fd9\u4e00\u90e8\u5206\u6211\u5c06\u8bd5\u56fe\u8c03\u548c\u8fd9\u4e24\u4e2a\u54f2\u5b66\uff0c\u5e0c\u671b\u6211\u4eec\u80fd\u5404\u53d6\u5176\u7f8e\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_13","title":"\u7ec4\u5408\u4f7f\u7528\u6570\u636e\u5b58\u50a8\u6280\u672f","text":"<p>\u672c\u4e66\u8ba8\u8bba\u4e86\u6570\u636e\u5e93\u63d0\u4f9b\u7684\u5404\u79cd\u529f\u80fd\u53ca\u5176\u5de5\u4f5c\u539f\u7406\uff0c\u5176\u4e2d\u5305\u62ec\uff1a</p> <ul> <li>\u6b21\u7ea7\u7d22\u5f15\uff0c\u4f7f\u4f60\u53ef\u4ee5\u6839\u636e\u5b57\u6bb5\u7684\u503c\u6709\u6548\u5730\u641c\u7d22\u8bb0\u5f55</li> <li>\u7269\u5316\u89c6\u56fe\uff0c\u8fd9\u662f\u4e00\u79cd\u9884\u8ba1\u7b97\u7684\u67e5\u8be2\u7ed3\u679c\u7f13\u5b58</li> <li>\u590d\u5236\u65e5\u5fd7\uff0c\u4fdd\u6301\u5176\u4ed6\u8282\u70b9\u4e0a\u6570\u636e\u7684\u526f\u672c\u6700\u65b0</li> <li>\u5168\u6587\u641c\u7d22\u7d22\u5f15\uff0c\u5141\u8bb8\u5728\u6587\u672c\u4e2d\u8fdb\u884c\u5173\u952e\u5b57\u641c\u7d22\uff0c\u4e5f\u5185\u7f6e\u4e8e\u67d0\u4e9b\u5173\u7cfb\u6570\u636e\u5e93\u30101\u3011</li> </ul> <p>\u6570\u636e\u5e93\u4e2d\u5185\u7f6e\u7684\u529f\u80fd\u4e0e\u4eba\u4eec\u7528\u6279\u5904\u7406\u548c\u6d41\u5904\u7406\u5668\u6784\u5efa\u7684\u884d\u751f\u6570\u636e\u7cfb\u7edf\u4f3c\u4e4e\u6709\u76f8\u4f3c\u4e4b\u5904\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_14","title":"\u521b\u5efa\u7d22\u5f15","text":"<p>\u8fd0\u884c <code>CREATE INDEX</code> \u5728\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7d22\u5f15\u65f6\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002</p> <ul> <li>\u6570\u636e\u5e93\u5fc5\u987b\u626b\u63cf\u8868\u7684\u4e00\u81f4\u6027\u5feb\u7167\uff0c\u6311\u9009\u51fa\u6240\u6709\u88ab\u7d22\u5f15\u7684\u5b57\u6bb5\u503c\uff0c\u5bf9\u5b83\u4eec\u8fdb\u884c\u6392\u5e8f\uff0c\u7136\u540e\u5199\u51fa\u7d22\u5f15\u3002</li> <li>\u5fc5\u987b\u5904\u7406\u81ea\u4e00\u81f4\u5feb\u7167\u4ee5\u6765\u6240\u505a\u7684\u5199\u5165\u64cd\u4f5c\uff08\u5047\u8bbe\u8868\u5728\u521b\u5efa\u7d22\u5f15\u65f6\u672a\u88ab\u9501\u5b9a\uff0c\u6240\u4ee5\u5199\u64cd\u4f5c\u53ef\u80fd\u4f1a\u7ee7\u7eed\uff09\u3002</li> <li>\u4e00\u65e6\u5b8c\u6210\uff0c\u53ea\u8981\u4e8b\u52a1\u5199\u5165\u8868\u4e2d\uff0c\u6570\u636e\u5e93\u5c31\u5fc5\u987b\u7ee7\u7eed\u4fdd\u6301\u7d22\u5f15\u6700\u65b0\u3002</li> </ul> <p>\u6b64\u8fc7\u7a0b\u975e\u5e38\u7c7b\u4f3c\u4e8e\u8bbe\u7f6e\u65b0\u7684\u4ece\u5e93\u526f\u672c\uff0c\u4e5f\u975e\u5e38\u7c7b\u4f3c\u4e8e\u6d41\u5904\u7406\u7cfb\u7edf\u4e2d\u7684 \u5f15\u5bfc\uff08bootstrap\uff09 \u53d8\u66f4\u6570\u636e\u6355\u83b7\u3002</p> <p>\u65e0\u8bba\u4f55\u65f6\u8fd0\u884c <code>CREATE INDEX</code>\uff0c\u6570\u636e\u5e93\u90fd\u4f1a\u91cd\u65b0\u5904\u7406\u73b0\u6709\u6570\u636e\u96c6\uff0c\u5e76\u5c06\u8be5\u7d22\u5f15\u4f5c\u4e3a\u65b0\u89c6\u56fe\u5bfc\u51fa\u5230\u73b0\u6709\u6570\u636e\u4e0a\u3002\u73b0\u6709\u6570\u636e\u53ef\u80fd\u662f\u72b6\u6001\u7684\u5feb\u7167\uff0c\u800c\u4e0d\u662f\u6240\u6709\u53d1\u751f\u53d8\u5316\u7684\u65e5\u5fd7\uff0c\u4f46\u4e24\u8005\u5bc6\u5207\u76f8\u5173\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_15","title":"\u4e00\u5207\u7684\u5143\u6570\u636e\u5e93","text":"<p>\u6709\u9274\u4e8e\u6b64\uff0c\u6211\u8ba4\u4e3a\u6574\u4e2a\u7ec4\u7ec7\u7684\u6570\u636e\u6d41\u5f00\u59cb\u50cf\u4e00\u4e2a\u5de8\u5927\u7684\u6570\u636e\u5e93\u30107\u3011\u3002\u6bcf\u5f53\u6279\u5904\u7406\u3001\u6d41\u6216 ETL \u8fc7\u7a0b\u5c06\u6570\u636e\u4ece\u4e00\u4e2a\u5730\u65b9\u4f20\u8f93\u5230\u53e6\u4e00\u4e2a\u5730\u65b9\u5e76\u7ec4\u88c5\u65f6\uff0c\u5b83\u8868\u73b0\u5730\u5c31\u50cf\u6570\u636e\u5e93\u5b50\u7cfb\u7edf\u4e00\u6837\uff0c\u4f7f\u7d22\u5f15\u6216\u7269\u5316\u89c6\u56fe\u4fdd\u6301\u6700\u65b0\u3002</p> <ul> <li>\u4ece\u8fd9\u79cd\u89d2\u5ea6\u6765\u770b\uff0c\u6279\u5904\u7406\u548c\u6d41\u5904\u7406\u5668\u5c31\u50cf\u7cbe\u5fc3\u5b9e\u73b0\u7684\u89e6\u53d1\u5668\u3001\u5b58\u50a8\u8fc7\u7a0b\u548c\u7269\u5316\u89c6\u56fe\u7ef4\u62a4\u4f8b\u7a0b\u3002</li> <li>\u5b83\u4eec\u7ef4\u62a4\u7684\u884d\u751f\u6570\u636e\u7cfb\u7edf\u5c31\u50cf\u4e0d\u540c\u7684\u7d22\u5f15\u7c7b\u578b\u3002\u4f8b\u5982\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u652f\u6301 B \u6811\u7d22\u5f15\u3001\u6563\u5217\u7d22\u5f15\u3001\u7a7a\u95f4\u7d22\u5f15\u7b49\u3002</li> </ul> <p>\u65b0\u5174\u7684\u884d\u751f\u6570\u636e\u7cfb\u7edf\u67b6\u6784\u4e2d\uff0c\u7531\u5404\u79cd\u4e0d\u540c\u7684\u8f6f\u4ef6\u63d0\u4f9b\uff0c\u8fd0\u884c\u5728\u4e0d\u540c\u7684\u673a\u5668\u4e0a\uff0c\u7531\u4e0d\u540c\u7684\u56e2\u961f\u7ba1\u7406\u3002</p> <p>\u5982\u679c\u6211\u4eec\u4ece\u6ca1\u6709\u9002\u5408\u6240\u6709\u8bbf\u95ee\u6a21\u5f0f\u7684\u5355\u4e00\u6570\u636e\u6a21\u578b\u6216\u5b58\u50a8\u683c\u5f0f\u7684\u524d\u63d0\u51fa\u53d1\uff0c\u6211\u63a8\u6d4b\u6709\u4e24\u79cd\u9014\u5f84\u53ef\u4ee5\u5c06\u4e0d\u540c\u7684\u5b58\u50a8\u548c\u5904\u7406\u5de5\u5177\u7ec4\u5408\u6210\u4e00\u4e2a\u6709\u51dd\u805a\u529b\u7684\u7cfb\u7edf\uff1a</p> <p>\u8054\u5408\u6570\u636e\u5e93\uff1a\u7edf\u4e00\u8bfb\u53d6</p> <p>\u53ef\u4ee5\u4e3a\u5404\u79cd\u5404\u6837\u7684\u5e95\u5c42\u5b58\u50a8\u5f15\u64ce\u548c\u5904\u7406\u65b9\u6cd5\u63d0\u4f9b\u4e00\u4e2a\u7edf\u4e00\u7684\u67e5\u8be2\u63a5\u53e3 \u2014\u2014 \u4e00\u79cd\u79f0\u4e3a \u8054\u5408\u6570\u636e\u5e93\uff08federated database\uff09 \u6216 \u591a\u6001\u5b58\u50a8\uff08polystore\uff09 \u7684\u65b9\u6cd5\u301018,19\u3011\u3002</p> <ul> <li>\u4f8b\u5982\uff0cPostgreSQL \u7684 \u5916\u90e8\u6570\u636e\u5305\u88c5\u5668\uff08foreign data wrapper\uff09 \u529f\u80fd\u7b26\u5408\u8fd9\u79cd\u6a21\u5f0f\u301020\u3011\u3002</li> <li>\u9700\u8981\u4e13\u7528\u6570\u636e\u6a21\u578b\u6216\u67e5\u8be2\u63a5\u53e3\u7684\u5e94\u7528\u7a0b\u5e8f\u4ecd\u7136\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u5e95\u5c42\u5b58\u50a8\u5f15\u64ce\uff0c\u800c\u60f3\u8981\u7ec4\u5408\u6765\u81ea\u4e0d\u540c\u4f4d\u7f6e\u7684\u6570\u636e\u7684\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u8054\u5408\u63a5\u53e3\u8f7b\u677e\u5b8c\u6210\u64cd\u4f5c\u3002</li> </ul> <p>\u8054\u5408\u67e5\u8be2\u63a5\u53e3\u9075\u5faa\u7740\u5355\u4e00\u96c6\u6210\u7cfb\u7edf\u7684\u5173\u7cfb\u578b\u4f20\u7edf\uff0c\u5e26\u6709\u9ad8\u7ea7\u67e5\u8be2\u8bed\u8a00\u548c\u4f18\u96c5\u7684\u8bed\u4e49\uff0c\u4f46\u5b9e\u73b0\u8d77\u6765\u975e\u5e38\u590d\u6742\u3002</p> <p>\u5206\u62c6\u6570\u636e\u5e93\uff1a\u7edf\u4e00\u5199\u5165</p> <p>\u867d\u7136\u8054\u5408\u80fd\u89e3\u51b3\u8de8\u591a\u4e2a\u4e0d\u540c\u7cfb\u7edf\u7684\u53ea\u8bfb\u67e5\u8be2\u95ee\u9898\uff0c\u4f46\u5b83\u5e76\u6ca1\u6709\u5f88\u597d\u7684\u89e3\u51b3\u8de8\u7cfb\u7edf \u540c\u6b65 \u5199\u5165\u7684\u95ee\u9898\u3002</p> <ul> <li>\u6784\u5efa\u591a\u4e2a\u5b58\u50a8\u7cfb\u7edf\u65f6\uff0c\u6211\u4eec\u540c\u6837\u9700\u8981\u786e\u4fdd\u6240\u6709\u6570\u636e\u53d8\u66f4\u90fd\u4f1a\u5728\u6240\u6709\u6b63\u786e\u7684\u4f4d\u7f6e\u7ed3\u675f\uff0c\u5373\u4f7f\u5728\u51fa\u73b0\u6545\u969c\u65f6\u4e5f\u662f\u5982\u6b64\u3002</li> </ul> <p>\u60f3\u8981\u66f4\u5bb9\u6613\u5730\u5c06\u5b58\u50a8\u7cfb\u7edf\u53ef\u9760\u5730\u63d2\u63a5\u5728\u4e00\u8d77\uff08\u4f8b\u5982\uff0c\u901a\u8fc7\u53d8\u66f4\u6570\u636e\u6355\u83b7\u548c\u4e8b\u4ef6\u65e5\u5fd7\uff09\uff0c\u5c31\u50cf\u5c06\u6570\u636e\u5e93\u7684\u7d22\u5f15\u7ef4\u62a4\u529f\u80fd\u4ee5\u53ef\u4ee5\u8de8\u4e0d\u540c\u6280\u672f\u540c\u6b65\u5199\u5165\u7684\u65b9\u5f0f\u5206\u5f00\u30107,21\u3011\u3002</p> <p>\u5206\u62c6\u65b9\u6cd5\u9075\u5faa Unix \u4f20\u7edf\u7684\u5c0f\u578b\u5de5\u5177\uff0c\u5b83\u53ef\u4ee5\u5f88\u597d\u5730\u5b8c\u6210\u4e00\u4ef6\u4e8b\u301022\u3011\uff0c\u901a\u8fc7\u7edf\u4e00\u7684\u4f4e\u5c42\u7ea7 API\uff08\u7ba1\u9053\uff09\u8fdb\u884c\u901a\u4fe1\uff0c\u5e76\u4e14\u53ef\u4ee5\u4f7f\u7528\u66f4\u9ad8\u5c42\u7ea7\u7684\u8bed\u8a00\u8fdb\u884c\u7ec4\u5408\uff08shell\uff09\u301016\u3011 \u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_16","title":"\u5f00\u5c55\u5206\u62c6\u5de5\u4f5c","text":"<p>\u8054\u5408\u548c\u5206\u62c6\u662f\u4e00\u4e2a\u786c\u5e01\u7684\u4e24\u9762\uff1a\u7528\u4e0d\u540c\u7684\u7ec4\u4ef6\u6784\u6210\u53ef\u9760\u3001 \u53ef\u4f38\u7f29\u548c\u53ef\u7ef4\u62a4\u7684\u7cfb\u7edf\u3002</p> <ul> <li>\u8054\u5408\u53ea\u8bfb\u67e5\u8be2\u9700\u8981\u5c06\u4e00\u4e2a\u6570\u636e\u6a21\u578b\u6620\u5c04\u5230\u53e6\u4e00\u4e2a\u6570\u636e\u6a21\u578b\uff0c\u9700\u8981\u4e00\u4e9b\u601d\u8003\uff0c\u4f46\u6700\u7ec8\u8fd8\u662f\u4e00\u4e2a\u53ef\u89e3\u51b3\u7684\u95ee\u9898\uff1b</li> <li>\u540c\u6b65\u5199\u5165\u5230\u51e0\u4e2a\u5b58\u50a8\u7cfb\u7edf\u662f\u66f4\u56f0\u96be\u7684\u5de5\u7a0b\u95ee\u9898\uff0c\u6240\u4ee5\u6211\u5c06\u91cd\u70b9\u5173\u6ce8\u5b83\u3002</li> </ul> <p>\u4f20\u7edf\u7684\u540c\u6b65\u5199\u5165\u65b9\u6cd5\u9700\u8981\u8de8\u5f02\u6784\u5b58\u50a8\u7cfb\u7edf\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u301018\u3011\uff0c\u6211\u8ba4\u4e3a\u8fd9\u662f\u9519\u8bef\u7684\u89e3\u51b3\u65b9\u6848\u3002</p> <ul> <li>\u5355\u4e2a\u5b58\u50a8\u6216\u6d41\u5904\u7406\u7cfb\u7edf\u5185\u7684\u4e8b\u52a1\u662f\u53ef\u884c\u7684\uff0c\u4f46\u662f\u5f53\u6570\u636e\u8de8\u8d8a\u4e0d\u540c\u6280\u672f\u4e4b\u95f4\u7684\u8fb9\u754c\u65f6\uff0c\u6211\u8ba4\u4e3a\u5177\u6709\u5e42\u7b49\u5199\u5165\u7684\u5f02\u6b65\u4e8b\u4ef6\u65e5\u5fd7\u662f\u4e00\u79cd\u66f4\u52a0\u5065\u58ee\u548c\u5b9e\u7528\u7684\u65b9\u6cd5\u3002</li> </ul> <p>\u4f8b\u5982\uff0c\u5206\u5e03\u5f0f\u4e8b\u52a1\u5728\u67d0\u4e9b\u6d41\u5904\u7406\u7ec4\u4ef6\u5185\u90e8\u4f7f\u7528\uff0c\u4ee5\u5339\u914d \u6070\u597d\u4e00\u6b21\uff08exactly-once\uff09 \u8bed\u4e49\uff0c\u8fd9\u53ef\u4ee5\u5f88\u597d\u5730\u5de5\u4f5c\u3002\u7136\u800c\uff0c\u5f53\u4e8b\u52a1\u9700\u8981\u6d89\u53ca\u7531\u4e0d\u540c\u4eba\u7fa4\u7f16\u5199\u7684\u7cfb\u7edf\u65f6\uff08\u4f8b\u5982\uff0c\u5f53\u6570\u636e\u4ece\u6d41\u5904\u7406\u7ec4\u4ef6\u5199\u5165\u5206\u5e03\u5f0f\u952e\u503c\u5b58\u50a8\u6216\u641c\u7d22\u7d22\u5f15\u65f6\uff09\uff0c\u7f3a\u4e4f\u6807\u51c6\u5316\u7684\u4e8b\u52a1\u534f\u8bae\u4f1a\u4f7f\u96c6\u6210\u66f4\u96be\u3002</p> <ul> <li>\u6709\u5e42\u7b49\u6d88\u8d39\u8005\u7684\u6709\u5e8f\u4e8b\u4ef6\u65e5\u5fd7\u662f\u4e00\u79cd\u66f4\u7b80\u5355\u7684\u62bd\u8c61\uff0c\u56e0\u6b64\u5728\u5f02\u6784\u7cfb\u7edf\u4e2d\u5b9e\u73b0\u66f4\u52a0\u53ef\u884c\u30107\u3011\u3002</li> </ul> <p>\u57fa\u4e8e\u65e5\u5fd7\u7684\u96c6\u6210\u7684\u4e00\u5927\u4f18\u52bf\u662f\u5404\u4e2a\u7ec4\u4ef6\u4e4b\u95f4\u7684 \u677e\u6563\u8026\u5408\uff08loose coupling\uff09\uff0c\u8fd9\u4f53\u73b0\u5728\u4e24\u4e2a\u65b9\u9762\uff1a</p> <ul> <li>\u5728\u7cfb\u7edf\u7ea7\u522b\uff0c\u5f02\u6b65\u4e8b\u4ef6\u6d41\u4f7f\u6574\u4e2a\u7cfb\u7edf\u5728\u4e2a\u522b\u7ec4\u4ef6\u7684\u4e2d\u65ad\u6216\u6027\u80fd\u4e0b\u964d\u65f6\u66f4\u52a0\u7a33\u5065\u3002</li> <li>\u5982\u679c\u6d88\u8d39\u8005\u8fd0\u884c\u7f13\u6162\u6216\u5931\u8d25\uff0c\u90a3\u4e48\u4e8b\u4ef6\u65e5\u5fd7\u53ef\u4ee5\u7f13\u51b2\u6d88\u606f\uff0c\u4ee5\u4fbf\u751f\u4ea7\u8005\u548c\u4efb\u4f55\u5176\u4ed6\u6d88\u8d39\u8005\u53ef\u4ee5\u7ee7\u7eed\u4e0d\u53d7\u5f71\u54cd\u5730\u8fd0\u884c\u3002</li> <li>\u6709\u95ee\u9898\u7684\u6d88\u8d39\u8005\u53ef\u4ee5\u5728\u95ee\u9898\u4fee\u590d\u540e\u8d76\u4e0a\uff0c\u56e0\u6b64\u4e0d\u4f1a\u9519\u8fc7\u4efb\u4f55\u6570\u636e\uff0c\u5e76\u4e14\u5305\u542b\u6545\u969c\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u540c\u6b65\u4ea4\u4e92\u5f80\u5f80\u4f1a\u5c06\u672c\u5730\u6545\u969c\u5347\u7ea7\u4e3a\u5927\u89c4\u6a21\u6545\u969c\u3002</li> <li>\u5728\u4eba\u529b\u65b9\u9762\uff0c\u5206\u62c6\u6570\u636e\u7cfb\u7edf\u5141\u8bb8\u4e0d\u540c\u7684\u56e2\u961f\u72ec\u7acb\u5f00\u53d1\uff0c\u6539\u8fdb\u548c\u7ef4\u62a4\u4e0d\u540c\u7684\u8f6f\u4ef6\u7ec4\u4ef6\u548c\u670d\u52a1\u3002</li> <li>\u4e13\u4e1a\u5316\u4f7f\u5f97\u6bcf\u4e2a\u56e2\u961f\u90fd\u53ef\u4ee5\u4e13\u6ce8\u4e8e\u505a\u597d\u4e00\u4ef6\u4e8b\uff0c\u5e76\u4e0e\u5176\u4ed6\u56e2\u961f\u7684\u7cfb\u7edf\u4ee5\u660e\u786e\u7684\u63a5\u53e3\u4ea4\u4e92\u3002</li> <li>\u4e8b\u4ef6\u65e5\u5fd7\u63d0\u4f9b\u4e86\u4e00\u4e2a\u8db3\u591f\u5f3a\u5927\u7684\u63a5\u53e3\uff0c\u4ee5\u6355\u83b7\u76f8\u5f53\u5f3a\u7684\u4e00\u81f4\u6027\u5c5e\u6027\uff08\u7531\u4e8e\u6301\u4e45\u6027\u548c\u4e8b\u4ef6\u7684\u987a\u5e8f\uff09\uff0c\u4f46\u4e5f\u8db3\u591f\u666e\u9002\u4e8e\u51e0\u4e4e\u4efb\u4f55\u7c7b\u578b\u7684\u6570\u636e\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#vs","title":"\u5206\u62c6\u7cfb\u7edfvs\u96c6\u6210\u7cfb\u7edf","text":"<p>\u5982\u679c\u5206\u62c6\u786e\u5b9e\u6210\u4e3a\u672a\u6765\u7684\u65b9\u5f0f\uff0c\u5b83\u4e5f\u4e0d\u4f1a\u53d6\u4ee3\u76ee\u524d\u5f62\u5f0f\u7684\u6570\u636e\u5e93 \u2014\u2014 \u5b83\u4eec\u4ecd\u7136\u4f1a\u50cf\u4ee5\u5f80\u4e00\u6837\u88ab\u9700\u8981\u3002</p> <ul> <li>\u4e3a\u4e86\u7ef4\u62a4\u6d41\u5904\u7406\u7ec4\u4ef6\u4e2d\u7684\u72b6\u6001\uff0c\u6570\u636e\u5e93\u4ecd\u7136\u662f\u9700\u8981\u7684\uff0c\u5e76\u4e14\u4e3a\u6279\u5904\u7406\u548c\u6d41\u5904\u7406\u5668\u7684\u8f93\u51fa\u63d0\u4f9b\u67e5\u8be2\u670d\u52a1\u3002</li> <li>\u4e13\u7528\u67e5\u8be2\u5f15\u64ce\u5bf9\u4e8e\u7279\u5b9a\u7684\u5de5\u4f5c\u8d1f\u8f7d\u4ecd\u7136\u975e\u5e38\u91cd\u8981\uff1a\u4f8b\u5982\uff0cMPP \u6570\u636e\u4ed3\u5e93\u4e2d\u7684\u67e5\u8be2\u5f15\u64ce\u9488\u5bf9\u63a2\u7d22\u6027\u5206\u6790\u67e5\u8be2\u8fdb\u884c\u4e86\u4f18\u5316\uff0c\u5e76\u4e14\u80fd\u591f\u5f88\u597d\u5730\u5904\u7406\u8fd9\u79cd\u7c7b\u578b\u7684\u5de5\u4f5c\u8d1f\u8f7d\u3002</li> </ul> <p>\u6bd4\u8d77\u4f7f\u7528\u5e94\u7528\u4ee3\u7801\u62fc\u63a5\u591a\u4e2a\u5de5\u5177\u800c\u6210\u7684\u7cfb\u7edf\uff0c\u5355\u4e00\u96c6\u6210\u8f6f\u4ef6\u4ea7\u54c1\u4e5f\u53ef\u4ee5\u5728\u5176\u8bbe\u8ba1\u5e94\u5bf9\u7684\u5de5\u4f5c\u8d1f\u8f7d\u7c7b\u578b\u4e0a\u5b9e\u73b0\u66f4\u597d\u3001\u66f4\u53ef\u9884\u6d4b\u7684\u6027\u80fd\u301023\u3011\u3002</p> <p>\u5206\u62c6\u7684\u76ee\u6807\u4e0d\u662f\u8981\u9488\u5bf9\u4e2a\u522b\u6570\u636e\u5e93\u4e0e\u7279\u5b9a\u5de5\u4f5c\u8d1f\u8f7d\u7684\u6027\u80fd\u8fdb\u884c\u7ade\u4e89\uff1b\u6211\u4eec\u7684\u76ee\u6807\u662f\u5141\u8bb8\u4f60\u7ed3\u5408\u591a\u4e2a\u4e0d\u540c\u7684\u6570\u636e\u5e93\uff0c\u4ee5\u4fbf\u5728\u6bd4\u5355\u4e2a\u8f6f\u4ef6\u53ef\u80fd\u5b9e\u73b0\u7684\u66f4\u5e7f\u6cdb\u7684\u5de5\u4f5c\u8d1f\u8f7d\u8303\u56f4\u5185\u5b9e\u73b0\u66f4\u597d\u7684\u6027\u80fd\u3002</p> <p>\u56e0\u6b64\uff0c\u5982\u679c\u6709\u4e00\u9879\u6280\u672f\u53ef\u4ee5\u6ee1\u8db3\u4f60\u7684\u6240\u6709\u9700\u6c42\uff0c\u90a3\u4e48\u6700\u597d\u4f7f\u7528\u8be5\u4ea7\u54c1\uff0c\u800c\u4e0d\u662f\u8bd5\u56fe\u7528\u66f4\u4f4e\u5c42\u7ea7\u7684\u7ec4\u4ef6\u91cd\u65b0\u5b9e\u73b0\u5b83\u3002\u53ea\u6709\u5f53\u6ca1\u6709\u5355\u4e00\u8f6f\u4ef6\u6ee1\u8db3\u4f60\u7684\u6240\u6709\u9700\u6c42\u65f6\uff0c\u624d\u4f1a\u51fa\u73b0\u62c6\u5206\u548c\u8054\u5408\u7684\u4f18\u52bf\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_17","title":"\u5c11\u4e86\u4ec0\u4e48\uff1f","text":"<p>\u8fd8\u7f3a\u5c11\u4e00\u4e2a\u4e3b\u8981\u7684\u4e1c\u897f\uff1a\u6ca1\u6709\u4e0e Unix shell \u7c7b\u4f3c\u7684\u5206\u62c6\u6570\u636e\u5e93\u7b49\u4ef7\u7269\uff08\u5373\uff0c\u4e00\u79cd\u58f0\u660e\u5f0f\u7684\u3001\u7b80\u5355\u7684\u3001\u7528\u4e8e\u7ec4\u88c5\u5b58\u50a8\u548c\u5904\u7406\u7cfb\u7edf\u7684\u9ad8\u7ea7\u8bed\u8a00\uff09\u3002</p> <p>\u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u5730\u58f0\u660e <code>mysql | elasticsearch</code>\uff0c\u7c7b\u4f3c\u4e8e Unix \u7ba1\u9053\u301022\u3011\uff0c\u6210\u4e3a <code>CREATE INDEX</code> \u7684\u5206\u62c6\u7b49\u4ef7\u7269\uff1a\u8bfb\u53d6 MySQL \u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709\u6587\u6863\u5e76\u5c06\u5176\u7d22\u5f15\u5230 Elasticsearch \u96c6\u7fa4\u4e2d\u3002\u7136\u540e\u5b83\u4f1a\u4e0d\u65ad\u6355\u83b7\u5bf9\u6570\u636e\u5e93\u6240\u505a\u7684\u6240\u6709\u53d8\u66f4\uff0c\u5e76\u81ea\u52a8\u5c06\u5b83\u4eec\u5e94\u7528\u4e8e\u641c\u7d22\u7d22\u5f15\uff0c\u800c\u65e0\u9700\u7f16\u5199\u81ea\u5b9a\u4e49\u5e94\u7528\u4ee3\u7801\u3002\u8fd9\u79cd\u96c6\u6210\u5e94\u5f53\u652f\u6301\u51e0\u4e4e\u4efb\u4f55\u7c7b\u578b\u7684\u5b58\u50a8\u6216\u7d22\u5f15\u7cfb\u7edf\u3002</p> <p>\u540c\u6837\uff0c\u80fd\u591f\u66f4\u5bb9\u6613\u5730\u9884\u5148\u8ba1\u7b97\u548c\u66f4\u65b0\u7f13\u5b58\u5c06\u662f\u4e00\u4ef6\u597d\u4e8b\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u4e3a\u590d\u6742\u67e5\u8be2\u58f0\u660e\u6307\u5b9a\u7269\u5316\u89c6\u56fe\u6765\u521b\u5efa\u7f13\u5b58\uff0c\u5305\u62ec\u56fe\u4e0a\u7684\u9012\u5f52\u67e5\u8be2\u548c\u5e94\u7528\u903b\u8f91\u3002\u5728\u8fd9\u65b9\u9762\u6709\u4e00\u4e9b\u6709\u8da3\u7684\u65e9\u671f\u7814\u7a76\uff0c\u5982 \u5dee\u5206\u6570\u636e\u6d41\uff08differential dataflow\uff09\u301024,25\u3011\uff0c\u6211\u5e0c\u671b\u8fd9\u4e9b\u60f3\u6cd5\u80fd\u591f\u5728\u751f\u4ea7\u7cfb\u7edf\u4e2d\u627e\u5230\u81ea\u5df1\u7684\u65b9\u6cd5\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_18","title":"\u56f4\u7ed5\u6570\u636e\u6d41\u8bbe\u8ba1\u5e94\u7528","text":"<p>\u4f7f\u7528\u5e94\u7528\u4ee3\u7801\u7ec4\u5408\u4e13\u7528\u5b58\u50a8\u4e0e\u5904\u7406\u7cfb\u7edf\u6765\u5206\u62c6\u6570\u636e\u5e93\u7684\u65b9\u6cd5\uff0c\u4e5f\u88ab\u79f0\u4e3a \u201c\u6570\u636e\u5e93\u7531\u5185\u800c\u5916\uff08database inside-out\uff09\u201d \u65b9\u6cd5\u301026\u3011\u301027\u3011\u3002\u4ec5\u5c06\u5176\u770b\u4f5c\u662f\u4e00\u79cd\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u800c\u4e0d\u662f\u201c\u65b0\u67b6\u6784\u201d\u3002</p> <ul> <li>\u662f\u5f88\u591a\u4eba\u7684\u601d\u60f3\u7684\u878d\u5408\uff0c\u4ee5 Oz\u301028\u3011\u548c Juttle\u301029\u3011\u4e3a\u4ee3\u8868\u7684\u6570\u636e\u6d41\u8bed\u8a00\uff0c\u4ee5 Elm\u301030,31\u3011\u4e3a\u4ee3\u8868\u7684 \u51fd\u6570\u5f0f\u54cd\u5e94\u5f0f\u7f16\u7a0b\uff08functional reactive programming, FRP\uff09\uff0c\u4ee5 Bloom\u301032\u3011\u4e3a\u4ee3\u8868\u7684\u903b\u8f91\u7f16\u7a0b\u8bed\u8a00\u3002</li> </ul> <p>\u5373\u4f7f\u662f \u7535\u5b50\u8868\u683c \u4e5f\u5728\u6570\u636e\u6d41\u7f16\u7a0b\u80fd\u529b\u4e0a\u7529\u5f00\u5927\u591a\u6570\u4e3b\u6d41\u7f16\u7a0b\u8bed\u8a00\u51e0\u6761\u8857\u301033\u3011\u3002</p> <ul> <li>\u53ea\u8981\u516c\u5f0f\u7684\u4efb\u4f55\u8f93\u5165\u53d1\u751f\u53d8\u66f4\uff0c\u516c\u5f0f\u7684\u7ed3\u679c\u90fd\u4f1a\u81ea\u52a8\u91cd\u65b0\u8ba1\u7b97\uff1b</li> <li>\u8fd9\u6b63\u662f\u6211\u4eec\u5728\u6570\u636e\u7cfb\u7edf\u5c42\u6b21\u6240\u9700\u8981\u7684\uff1a\u5f53\u6570\u636e\u5e93\u4e2d\u7684\u8bb0\u5f55\u53d1\u751f\u53d8\u66f4\u65f6\uff0c\u6211\u4eec\u5e0c\u671b\u81ea\u52a8\u66f4\u65b0\u8be5\u8bb0\u5f55\u7684\u4efb\u4f55\u7d22\u5f15\uff0c\u5e76\u4e14\u81ea\u52a8\u5237\u65b0\u4f9d\u8d56\u4e8e\u8bb0\u5f55\u7684\u4efb\u4f55\u7f13\u5b58\u89c6\u56fe\u6216\u805a\u5408\u3002</li> </ul> <p>\u56e0\u6b64\uff0c\u6211\u8ba4\u4e3a\u7edd\u5927\u591a\u6570\u6570\u636e\u7cfb\u7edf\u4ecd\u7136\u53ef\u4ee5\u4ece VisiCalc \u5728 1979 \u5e74\u5df2\u7ecf\u5177\u5907\u7684\u529f\u80fd\u4e2d\u5b66\u4e60\u301034\u3011\u3002\u4eca\u5929\u7684\u6570\u636e\u7cfb\u7edf\u9700\u8981\u5177\u6709\u5bb9\u9519\u6027\uff0c\u53ef\u4f38\u7f29\u6027\u4ee5\u53ca\u6301\u4e45\u5b58\u50a8\u6570\u636e\u3002\u8fd8\u9700\u8981\u80fd\u591f\u6574\u5408\u4e0d\u540c\u4eba\u7fa4\u7f16\u5199\u7684\u4e0d\u540c\u6280\u672f\uff0c\u5e76\u91cd\u7528\u73b0\u6709\u7684\u5e93\u548c\u670d\u52a1\uff1a</p> <ul> <li>\u671f\u671b\u4f7f\u7528\u67d0\u4e00\u79cd\u7279\u5b9a\u7684\u8bed\u8a00\u3001\u6846\u67b6\u6216\u5de5\u5177\u6765\u5f00\u53d1\u6240\u6709\u8f6f\u4ef6\u662f\u4e0d\u5207\u5b9e\u9645\u7684\u3002</li> </ul> <p>\u5728\u672c\u8282\u4e2d\uff0c\u6211\u5c06\u8be6\u7ec6\u4ecb\u7ecd\u8fd9\u4e9b\u60f3\u6cd5\uff0c\u5e76\u63a2\u8ba8\u4e00\u4e9b\u56f4\u7ed5\u5206\u62c6\u6570\u636e\u5e93\u548c\u6570\u636e\u6d41\u7684\u60f3\u6cd5\u6784\u5efa\u5e94\u7528\u7684\u65b9\u6cd5\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_19","title":"\u5e94\u7528\u4ee3\u7801\u4f5c\u4e3a\u884d\u751f\u51fd\u6570","text":"<p>\u5f53\u4e00\u4e2a\u6570\u636e\u96c6\u884d\u751f\u81ea\u53e6\u4e00\u4e2a\u6570\u636e\u96c6\u65f6\uff0c\u5b83\u4f1a\u7ecf\u5386\u67d0\u79cd\u8f6c\u6362\u51fd\u6570\u3002\u4f8b\u5982\uff1a</p> <ul> <li>\u6b21\u7ea7\u7d22\u5f15\u662f\u7531\u4e00\u79cd\u76f4\u767d\u7684\u8f6c\u6362\u51fd\u6570\u751f\u6210\u7684\u884d\u751f\u6570\u636e\u96c6\uff1a\u5bf9\u4e8e\u57fa\u7840\u8868\u4e2d\u7684\u6bcf\u884c\u6216\u6bcf\u4e2a\u6587\u6863\uff0c\u5b83\u6311\u9009\u88ab\u7d22\u5f15\u7684\u5217\u6216\u5b57\u6bb5\u4e2d\u7684\u503c\uff0c\u5e76\u6309\u8fd9\u4e9b\u503c\u6392\u5e8f\uff08\u5047\u8bbe\u4f7f\u7528 B \u6811\u6216 SSTable \u7d22\u5f15\uff0c\u6309\u952e\u6392\u5e8f\uff09\u3002</li> <li>\u5168\u6587\u641c\u7d22\u7d22\u5f15\u662f\u901a\u8fc7\u5e94\u7528\u5404\u79cd\u81ea\u7136\u8bed\u8a00\u5904\u7406\u51fd\u6570\u800c\u521b\u5efa\u7684\uff0c\u8bf8\u5982\u8bed\u8a00\u68c0\u6d4b\u3001\u5206\u8bcd\u3001\u8bcd\u5e72\u6216\u8bcd\u6c47\u5316\u3001\u62fc\u5199\u7ea0\u6b63\u548c\u540c\u4e49\u8bcd\u8bc6\u522b\uff0c\u7136\u540e\u6784\u5efa\u7528\u4e8e\u9ad8\u6548\u67e5\u627e\u7684\u6570\u636e\u7ed3\u6784\uff08\u4f8b\u5982\u5012\u6392\u7d22\u5f15\uff09\u3002</li> <li>\u5728\u673a\u5668\u5b66\u4e60\u7cfb\u7edf\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6a21\u578b\u89c6\u4f5c\u4ece\u8bad\u7ec3\u6570\u636e\u901a\u8fc7\u5e94\u7528\u5404\u79cd\u7279\u5f81\u63d0\u53d6\u3001\u7edf\u8ba1\u5206\u6790\u51fd\u6570\u884d\u751f\u7684\u6570\u636e\uff0c\u5f53\u6a21\u578b\u5e94\u7528\u4e8e\u65b0\u7684\u8f93\u5165\u6570\u636e\u65f6\uff0c\u6a21\u578b\u7684\u8f93\u51fa\u662f\u4ece\u8f93\u5165\u548c\u6a21\u578b\uff08\u56e0\u6b64\u95f4\u63a5\u5730\u4ece\u8bad\u7ec3\u6570\u636e\uff09\u4e2d\u884d\u751f\u7684\u3002</li> <li>\u7f13\u5b58\u901a\u5e38\u5305\u542b\u5c06\u4ee5\u7528\u6237\u754c\u9762\uff08UI\uff09\u663e\u793a\u7684\u5f62\u5f0f\u7684\u6570\u636e\u805a\u5408\u3002\u56e0\u6b64\u586b\u5145\u7f13\u5b58\u9700\u8981\u77e5\u9053 UI \u4e2d\u5f15\u7528\u7684\u5b57\u6bb5\uff1bUI \u4e2d\u7684\u53d8\u66f4\u53ef\u80fd\u9700\u8981\u66f4\u65b0\u7f13\u5b58\u586b\u5145\u65b9\u5f0f\u7684\u5b9a\u4e49\uff0c\u5e76\u91cd\u5efa\u7f13\u5b58\u3002</li> </ul> <p>\u7528\u4e8e\u6b21\u7ea7\u7d22\u5f15\u7684\u884d\u751f\u51fd\u6570\u662f\u5982\u6b64\u5e38\u7528\u7684\u9700\u6c42\uff0c\u4ee5\u81f4\u4e8e\u5b83\u4f5c\u4e3a\u6838\u5fc3\u529f\u80fd\u88ab\u5185\u5efa\u81f3\u8bb8\u591a\u6570\u636e\u5e93\u4e2d\uff0c\u4f60\u53ef\u4ee5\u7b80\u5355\u5730\u901a\u8fc7 <code>CREATE INDEX</code> \u6765\u8c03\u7528\u5b83\u3002\u5bf9\u4e8e\u5168\u6587\u7d22\u5f15\uff0c\u5e38\u89c1\u8bed\u8a00\u7684\u57fa\u672c\u8bed\u8a00\u7279\u5f81\u53ef\u80fd\u5185\u7f6e\u5230\u6570\u636e\u5e93\u4e2d\uff0c\u4f46\u66f4\u590d\u6742\u7684\u7279\u5f81\u901a\u5e38\u9700\u8981\u9886\u57df\u7279\u5b9a\u7684\u8c03\u6574\u3002\u5728\u673a\u5668\u5b66\u4e60\u4e2d\uff0c\u7279\u5f81\u5de5\u7a0b\u662f\u4f17\u6240\u5468\u77e5\u7684\u7279\u5b9a\u4e8e\u5e94\u7528\u7684\u7279\u5f81\uff0c\u901a\u5e38\u9700\u8981\u5305\u542b\u5f88\u591a\u5173\u4e8e\u7528\u6237\u4ea4\u4e92\u4e0e\u5e94\u7528\u90e8\u7f72\u7684\u8be6\u7ec6\u77e5\u8bc6\u301035\u3011\u3002</p> <p>\u5f53\u521b\u5efa\u884d\u751f\u6570\u636e\u96c6\u7684\u51fd\u6570\u4e0d\u662f\u50cf\u521b\u5efa\u6b21\u7ea7\u7d22\u5f15\u90a3\u6837\u7684\u6807\u51c6\u642c\u7816\u51fd\u6570\u65f6\uff0c\u9700\u8981\u81ea\u5b9a\u4e49\u4ee3\u7801\u6765\u5904\u7406\u7279\u5b9a\u4e8e\u5e94\u7528\u7684\u4e1c\u897f\u3002</p> <ul> <li>\u8fd9\u4e2a\u81ea\u5b9a\u4e49\u4ee3\u7801\u662f\u8ba9\u8bb8\u591a\u6570\u636e\u5e93\u6323\u624e\u7684\u5730\u65b9\uff0c\u867d\u7136\u5173\u7cfb\u6570\u636e\u5e93\u901a\u5e38\u652f\u6301\u89e6\u53d1\u5668\u3001\u5b58\u50a8\u8fc7\u7a0b\u548c\u7528\u6237\u5b9a\u4e49\u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u7528\u5b83\u4eec\u6765\u5728\u6570\u636e\u5e93\u4e2d\u6267\u884c\u5e94\u7528\u4ee3\u7801\uff0c\u4f46\u5b83\u4eec\u6709\u70b9\u50cf\u6570\u636e\u5e93\u8bbe\u8ba1\u91cc\u7684\u4e8b\u540e\u53cd\u601d\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_20","title":"\u5e94\u7528\u4ee3\u7801\u548c\u72b6\u6001\u7684\u5206\u79bb","text":"<p>\u7406\u8bba\u4e0a\uff0c\u6570\u636e\u5e93\u53ef\u4ee5\u662f\u4efb\u610f\u5e94\u7528\u4ee3\u7801\u7684\u90e8\u7f72\u73af\u5883\u3002\u4f46\u5b9e\u8df5\u4e2d\uff0c\u3002\u5b83\u4eec\u4e0d\u6ee1\u8db3\u73b0\u4ee3\u5e94\u7528\u5f00\u53d1\u7684\u8981\u6c42\uff0c\u4f8b\u5982\u4f9d\u8d56\u548c\u8f6f\u4ef6\u5305\u7ba1\u7406\u3001\u7248\u672c\u63a7\u5236\u3001\u6eda\u52a8\u5347\u7ea7\u3001\u53ef\u6f14\u5316\u6027\u3001\u76d1\u63a7\u3001\u6307\u6807\u3001\u5bf9\u7f51\u7edc\u670d\u52a1\u7684\u8c03\u7528\u4ee5\u53ca\u4e0e\u5916\u90e8\u7cfb\u7edf\u7684\u96c6\u6210\u3002</p> <p>\u53e6\u4e00\u65b9\u9762\uff0cMesos\u3001YARN\u3001Docker\u3001Kubernetes \u7b49\u90e8\u7f72\u548c\u96c6\u7fa4\u7ba1\u7406\u5de5\u5177\u4e13\u4e3a\u8fd0\u884c\u5e94\u7528\u4ee3\u7801\u800c\u8bbe\u8ba1\u3002</p> <p>\u6211\u8ba4\u4e3a\u8ba9\u7cfb\u7edf\u7684\u67d0\u4e9b\u90e8\u5206\u4e13\u95e8\u7528\u4e8e\u6301\u4e45\u6570\u636e\u5b58\u50a8\u5e76\u8ba9\u5176\u4ed6\u90e8\u5206\u4e13\u95e8\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u662f\u6709\u610f\u4e49\u7684\u3002\u8fd9\u4e24\u8005\u53ef\u4ee5\u5728\u4fdd\u6301\u72ec\u7acb\u7684\u540c\u65f6\u4e92\u52a8\u3002</p> <p>\u8d8b\u52bf\u662f\u5c06\u65e0\u72b6\u6001\u5e94\u7528\u7a0b\u5e8f\u903b\u8f91\u4e0e\u72b6\u6001\u7ba1\u7406\uff08\u6570\u636e\u5e93\uff09\u5206\u5f00\uff1a\u4e0d\u5c06\u5e94\u7528\u7a0b\u5e8f\u903b\u8f91\u653e\u5165\u6570\u636e\u5e93\u4e2d\uff0c\u4e5f\u4e0d\u5c06\u6301\u4e45\u72b6\u6001\u7f6e\u4e8e\u5e94\u7528\u7a0b\u5e8f\u4e2d\u301036\u3011\u3002</p> <ul> <li>\u5178\u578b\u7684 Web \u5e94\u7528\u6a21\u578b\u4e2d\uff0c\u6570\u636e\u5e93\u5145\u5f53\u4e00\u79cd\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u540c\u6b65\u8bbf\u95ee\u7684\u53ef\u53d8\u5171\u4eab\u53d8\u91cf\u3002</li> <li>\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u8bfb\u53d6\u548c\u66f4\u65b0\u53d8\u91cf\uff0c\u800c\u6570\u636e\u5e93\u8d1f\u8d23\u7ef4\u6301\u5b83\u7684\u6301\u4e45\u6027\uff0c\u63d0\u4f9b\u4e00\u4e9b\u8bf8\u5982\u5e76\u53d1\u63a7\u5236\u548c\u5bb9\u9519\u7684\u529f\u80fd\u3002</li> </ul> <p>\u4f46\u662f\uff0c\u5728\u5927\u591a\u6570\u7f16\u7a0b\u8bed\u8a00\u4e2d\uff0c\u4f60\u65e0\u6cd5\u8ba2\u9605\u53ef\u53d8\u53d8\u91cf\u4e2d\u7684\u53d8\u66f4 \u2014\u2014 \u4f60\u53ea\u80fd\u5b9a\u671f\u8bfb\u53d6\u5b83\u3002</p> <ul> <li>\u6570\u636e\u5e93\u7ee7\u627f\u4e86\u8fd9\u79cd\u53ef\u53d8\u6570\u636e\u7684\u88ab\u52a8\u65b9\u6cd5\uff1a\u5982\u679c\u4f60\u60f3\u77e5\u9053\u6570\u636e\u5e93\u7684\u5185\u5bb9\u662f\u5426\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u901a\u5e38\u4f60\u552f\u4e00\u7684\u9009\u62e9\u5c31\u662f\u8f6e\u8be2\uff08\u5373\u5b9a\u671f\u91cd\u590d\u4f60\u7684\u67e5\u8be2\uff09\u3002\u8ba2\u9605\u53d8\u66f4\u53ea\u662f\u521a\u521a\u5f00\u59cb\u51fa\u73b0\u7684\u529f\u80fd\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_21","title":"\u6570\u636e\u6d41\uff1a\u5e94\u7528\u4ee3\u7801\u4e0e\u72b6\u6001\u53d8\u5316\u7684\u4ea4\u4e92","text":"<p>\u4ece\u6570\u636e\u6d41\u7684\u89d2\u5ea6\u601d\u8003\u5e94\u7528\u7a0b\u5e8f\uff0c\u610f\u5473\u7740\u91cd\u65b0\u534f\u8c03\u5e94\u7528\u4ee3\u7801\u548c\u72b6\u6001\u7ba1\u7406\u4e4b\u95f4\u7684\u5173\u7cfb\u3002\u4e0d\u518d\u5c06\u6570\u636e\u5e93\u89c6\u4f5c\u88ab\u5e94\u7528\u64cd\u7eb5\u7684\u88ab\u52a8\u53d8\u91cf\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u66f4\u591a\u5730\u8003\u8651\u72b6\u6001\uff0c\u72b6\u6001\u53d8\u66f4\u548c\u5904\u7406\u5b83\u4eec\u7684\u4ee3\u7801\u4e4b\u95f4\u7684\u76f8\u4e92\u4f5c\u7528\u4e0e\u534f\u540c\u5173\u7cfb\u3002\u5e94\u7528\u4ee3\u7801\u901a\u8fc7\u5728\u53e6\u4e00\u4e2a\u5730\u65b9\u89e6\u53d1\u72b6\u6001\u53d8\u66f4\u6765\u54cd\u5e94\u72b6\u6001\u53d8\u66f4\u3002</p> <p>\u5c06\u6570\u636e\u5e93\u7684\u53d8\u66f4\u65e5\u5fd7\u89c6\u4e3a\u4e00\u79cd\u6211\u4eec\u53ef\u4ee5\u8ba2\u9605\u7684\u4e8b\u4ef6\u6d41\u3002\u8bf8\u5982 Actor \u7684\u6d88\u606f\u4f20\u9012\u7cfb\u7edf\u4e5f\u5177\u6709\u54cd\u5e94\u4e8b\u4ef6\u7684\u6982\u5ff5\u3002</p> <p>\u65e9\u5728 20 \u4e16\u7eaa 80 \u5e74\u4ee3\uff0c\u5143\u7ec4\u7a7a\u95f4\uff08tuple space\uff09 \u6a21\u578b\u5c31\u5df2\u7ecf\u63a2\u7d22\u4e86\u8868\u8fbe\u5206\u5e03\u5f0f\u8ba1\u7b97\u7684\u65b9\u5f0f\uff1a\u89c2\u5bdf\u72b6\u6001\u53d8\u66f4\u5e76\u4f5c\u51fa\u53cd\u5e94\u7684\u8fc7\u7a0b\u301038,39\u3011\u3002</p> <p>\u5f53\u89e6\u53d1\u5668\u7531\u4e8e\u6570\u636e\u53d8\u66f4\u800c\u88ab\u89e6\u53d1\u65f6\uff0c\u6216\u6b21\u7ea7\u7d22\u5f15\u66f4\u65b0\u4ee5\u53cd\u6620\u7d22\u5f15\u8868\u4e2d\u7684\u53d8\u66f4\u65f6\uff0c\u6570\u636e\u5e93\u5185\u90e8\u4e5f\u53d1\u751f\u7740\u7c7b\u4f3c\u7684\u60c5\u51b5\u3002\u5206\u62c6\u6570\u636e\u5e93\u610f\u5473\u7740\u5c06\u8fd9\u4e2a\u60f3\u6cd5\u5e94\u7528\u4e8e\u5728\u4e3b\u6570\u636e\u5e93\u4e4b\u5916\uff0c\u7528\u4e8e\u521b\u5efa\u884d\u751f\u6570\u636e\u96c6\uff1a\u7f13\u5b58\u3001\u5168\u6587\u641c\u7d22\u7d22\u5f15\u3001\u673a\u5668\u5b66\u4e60\u6216\u5206\u6790\u7cfb\u7edf\u3002\u6211\u4eec\u53ef\u4ee5\u4e3a\u6b64\u4f7f\u7528\u6d41\u5904\u7406\u548c\u6d88\u606f\u4f20\u9012\u7cfb\u7edf\u3002</p> <p>\u9700\u8981\u8bb0\u4f4f\u7684\u91cd\u8981\u4e00\u70b9\u662f\uff0c\u7ef4\u62a4\u884d\u751f\u6570\u636e\u4e0d\u540c\u4e8e\u6267\u884c\u5f02\u6b65\u4efb\u52a1\u3002\u4f20\u7edf\u7684\u6d88\u606f\u4f20\u9012\u7cfb\u7edf\u901a\u5e38\u662f\u4e3a\u6267\u884c\u5f02\u6b65\u4efb\u52a1\u8bbe\u8ba1\u7684\uff1a</p> <ul> <li>\u5728\u7ef4\u62a4\u884d\u751f\u6570\u636e\u65f6\uff0c\u72b6\u6001\u53d8\u66f4\u7684\u987a\u5e8f\u901a\u5e38\u5f88\u91cd\u8981\uff08\u5982\u679c\u591a\u4e2a\u89c6\u56fe\u662f\u4ece\u4e8b\u4ef6\u65e5\u5fd7\u884d\u751f\u7684\uff0c\u5219\u9700\u8981\u6309\u7167\u76f8\u540c\u7684\u987a\u5e8f\u5904\u7406\u4e8b\u4ef6\uff0c\u4ee5\u4fbf\u5b83\u4eec\u4e4b\u95f4\u4fdd\u6301\u4e00\u81f4\uff09\u3002</li> <li>\u5bb9\u9519\u662f\u884d\u751f\u6570\u636e\u7684\u5173\u952e\uff1a\u4ec5\u4ec5\u4e22\u5931\u5355\u4e2a\u6d88\u606f\u5c31\u4f1a\u5bfc\u81f4\u884d\u751f\u6570\u636e\u96c6\u6c38\u8fdc\u4e0e\u5176\u6570\u636e\u6e90\u5931\u53bb\u540c\u6b65\u3002\u6d88\u606f\u4f20\u9012\u548c\u884d\u751f\u72b6\u6001\u66f4\u65b0\u90fd\u5fc5\u987b\u53ef\u9760\u3002</li> <li>\u4f8b\u5982\uff0c\u8bb8\u591a Actor \u7cfb\u7edf\u9ed8\u8ba4\u5728\u5185\u5b58\u4e2d\u7ef4\u62a4 Actor \u7684\u72b6\u6001\u548c\u6d88\u606f\uff0c\u6240\u4ee5\u5982\u679c\u8fd0\u884c Actor \u7684\u673a\u5668\u5d29\u6e83\uff0c\u72b6\u6001\u548c\u6d88\u606f\u5c31\u4f1a\u4e22\u5931\u3002</li> </ul> <p>\u7a33\u5b9a\u7684\u6d88\u606f\u6392\u5e8f\u548c\u5bb9\u9519\u6d88\u606f\u5904\u7406\u662f\u76f8\u5f53\u4e25\u683c\u7684\u8981\u6c42\uff0c\u4f46\u4e0e\u5206\u5e03\u5f0f\u4e8b\u52a1\u76f8\u6bd4\uff0c\u5b83\u4eec\u5f00\u9500\u66f4\u5c0f\uff0c\u8fd0\u884c\u66f4\u7a33\u5b9a\u3002\u73b0\u4ee3\u6d41\u5904\u7406\u7ec4\u4ef6\u53ef\u4ee5\u63d0\u4f9b\u8fd9\u4e9b\u6392\u5e8f\u548c\u53ef\u9760\u6027\u4fdd\u8bc1\uff0c\u5e76\u5141\u8bb8\u5e94\u7528\u4ee3\u7801\u4ee5\u6d41\u7b97\u5b50\u7684\u5f62\u5f0f\u8fd0\u884c\u3002</p> <p>\u8fd9\u4e9b\u5e94\u7528\u4ee3\u7801\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u5904\u7406\uff0c\u5305\u62ec\u6570\u636e\u5e93\u5185\u7f6e\u884d\u751f\u51fd\u6570\u901a\u5e38\u4e0d\u63d0\u4f9b\u7684\u529f\u80fd\u3002\u5c31\u50cf\u901a\u8fc7\u7ba1\u9053\u94fe\u63a5\u7684 Unix \u5de5\u5177\u4e00\u6837\uff0c\u6d41\u7b97\u5b50\u53ef\u4ee5\u56f4\u7ed5\u7740\u6570\u636e\u6d41\u6784\u5efa\u5927\u578b\u7cfb\u7edf\u3002\u6bcf\u4e2a\u7b97\u5b50\u63a5\u53d7\u72b6\u6001\u53d8\u66f4\u7684\u6d41\u4f5c\u4e3a\u8f93\u5165\uff0c\u5e76\u4ea7\u751f\u5176\u4ed6\u72b6\u6001\u53d8\u5316\u7684\u6d41\u4f5c\u4e3a\u8f93\u51fa\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_22","title":"\u6d41\u5904\u7406\u5668\u548c\u670d\u52a1","text":"<p>\u5f53\u4eca\u6d41\u884c\u7684\u5e94\u7528\u5f00\u53d1\u98ce\u683c\u6d89\u53ca\u5c06\u529f\u80fd\u5206\u89e3\u4e3a\u4e00\u7ec4\u901a\u8fc7\u540c\u6b65\u7f51\u7edc\u8bf7\u6c42\uff08\u5982 REST API\uff09\u8fdb\u884c\u901a\u4fe1\u7684 \u670d\u52a1\uff09\u3002</p> <ul> <li>\u9762\u5411\u670d\u52a1\u7684\u67b6\u6784\u4f18\u4e8e\u5355\u4e00\u5e9e\u5927\u5e94\u7528\u7684\u4f18\u52bf\u4e3b\u8981\u5728\u4e8e\uff1a\u901a\u8fc7\u677e\u6563\u8026\u5408\u6765\u63d0\u4f9b\u7ec4\u7ec7\u4e0a\u7684\u53ef\u4f38\u7f29\u6027\uff1a\u4e0d\u540c\u7684\u56e2\u961f\u53ef\u4ee5\u4e13\u804c\u4e8e\u4e0d\u540c\u7684\u670d\u52a1\u4e0a\uff0c\u4ece\u800c\u51cf\u5c11\u56e2\u961f\u4e4b\u95f4\u7684\u534f\u8c03\u5de5\u4f5c\u3002</li> </ul> <p>\u5728\u6570\u636e\u6d41\u4e2d\u7ec4\u88c5\u6d41\u7b97\u5b50\u4e0e\u5fae\u670d\u52a1\u65b9\u6cd5\u6709\u5f88\u591a\u76f8\u4f3c\u4e4b\u5904\u301040\u3011\u3002\u4f46\u5e95\u5c42\u901a\u4fe1\u673a\u5236\u662f\u6709\u5f88\u5927\u533a\u522b\uff1a\u6570\u636e\u6d41\u91c7\u7528\u5355\u5411\u5f02\u6b65\u6d88\u606f\u6d41\uff0c\u800c\u4e0d\u662f\u540c\u6b65\u7684\u8bf7\u6c42 / \u54cd\u5e94\u5f0f\u4ea4\u4e92\u3002</p> <p>\u9664\u4e86\u5728 \u201c\u6d88\u606f\u4f20\u9012\u4e2d\u7684\u6570\u636e\u6d41\u201d \u4e2d\u5217\u51fa\u7684\u4f18\u70b9\uff08\u5982\u66f4\u597d\u7684\u5bb9\u9519\u6027\uff09\uff0c\u6570\u636e\u6d41\u7cfb\u7edf\u8fd8\u80fd\u5b9e\u73b0\u66f4\u597d\u7684\u6027\u80fd\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u5ba2\u6237\u6b63\u5728\u8d2d\u4e70\u4ee5\u4e00\u79cd\u8d27\u5e01\u5b9a\u4ef7\uff0c\u4f46\u4ee5\u53e6\u4e00\u79cd\u8d27\u5e01\u652f\u4ed8\u7684\u5546\u54c1\u3002\u9700\u8981\u77e5\u9053\u5f53\u524d\u7684\u6c47\u7387\uff0c\u6709\u4e24\u79cd\u5b9e\u73b0\u65b9\u5f0f\u301040,41\u3011\uff1a</p> <ul> <li>\u5728\u5fae\u670d\u52a1\u65b9\u6cd5\u4e2d\uff0c\u5904\u7406\u8d2d\u4e70\u7684\u4ee3\u7801\u53ef\u80fd\u4f1a\u67e5\u8be2\u6c47\u7387\u670d\u52a1\u6216\u6570\u636e\u5e93\uff0c\u4ee5\u83b7\u53d6\u7279\u5b9a\u8d27\u5e01\u7684\u5f53\u524d\u6c47\u7387\u3002</li> <li>\u5728\u6570\u636e\u6d41\u65b9\u6cd5\u4e2d\uff0c\u5904\u7406\u8ba2\u5355\u7684\u4ee3\u7801\u4f1a\u63d0\u524d\u8ba2\u9605\u6c47\u7387\u53d8\u66f4\u6d41\uff0c\u5e76\u5728\u6c47\u7387\u53d1\u751f\u53d8\u52a8\u65f6\u5c06\u5f53\u524d\u6c47\u7387\u5b58\u50a8\u5728\u672c\u5730\u6570\u636e\u5e93\u4e2d\u3002\u5904\u7406\u8ba2\u5355\u65f6\u53ea\u9700\u67e5\u8be2\u672c\u5730\u6570\u636e\u5e93\u5373\u53ef\u3002</li> </ul> <p>\u7b2c\u4e8c\u79cd\u65b9\u6cd5\u80fd\u5c06\u5bf9\u53e6\u4e00\u670d\u52a1\u7684\u540c\u6b65\u7f51\u7edc\u8bf7\u6c42\u66ff\u6362\u4e3a\u5bf9\u672c\u5730\u6570\u636e\u5e93\u7684\u67e5\u8be2\uff08\u53ef\u80fd\u5728\u540c\u4e00\u53f0\u673a\u5668\u751a\u81f3\u540c\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\uff09<sup>1</sup>\u3002\u6570\u636e\u6d41\u65b9\u6cd5\u4e0d\u4ec5\u66f4\u5feb\uff0c\u800c\u4e14\u5f53\u5176\u4ed6\u670d\u52a1\u5931\u6548\u65f6\u4e5f\u66f4\u7a33\u5065\u3002\u6700\u5feb\u4e14\u6700\u53ef\u9760\u7684\u7f51\u7edc\u8bf7\u6c42\u5c31\u662f\u538b\u6839\u6ca1\u6709\u7f51\u7edc\u8bf7\u6c42\uff01</p> <p>\u8fde\u63a5\u662f\u65f6\u95f4\u76f8\u5173\u7684\uff1a\u5982\u679c\u8d2d\u4e70\u4e8b\u4ef6\u5728\u7a0d\u540e\u7684\u65f6\u95f4\u70b9\u88ab\u91cd\u65b0\u5904\u7406\uff0c\u6c47\u7387\u53ef\u80fd\u5df2\u7ecf\u6539\u53d8\u3002\u5982\u679c\u8981\u91cd\u5efa\u539f\u59cb\u8f93\u51fa\uff0c\u5219\u9700\u8981\u83b7\u53d6\u539f\u59cb\u8d2d\u4e70\u65f6\u7684\u5386\u53f2\u6c47\u7387\u3002\u65e0\u8bba\u662f\u67e5\u8be2\u670d\u52a1\u8fd8\u662f\u8ba2\u9605\u6c47\u7387\u66f4\u65b0\u6d41\uff0c\u4f60\u90fd\u9700\u8981\u5904\u7406\u8fd9\u79cd\u65f6\u95f4\u76f8\u5173\u6027\u3002</p> <p>\u8ba2\u9605\u53d8\u66f4\u6d41\uff0c\u800c\u4e0d\u662f\u5728\u9700\u8981\u65f6\u67e5\u8be2\u5f53\u524d\u72b6\u6001\uff0c\u4f7f\u6211\u4eec\u66f4\u63a5\u8fd1\u7c7b\u4f3c\u7535\u5b50\u8868\u683c\u7684\u8ba1\u7b97\u6a21\u578b\uff1a\u5f53\u67d0\u4e9b\u6570\u636e\u53d1\u751f\u53d8\u66f4\u65f6\uff0c\u4f9d\u8d56\u4e8e\u6b64\u7684\u6240\u6709\u884d\u751f\u6570\u636e\u90fd\u53ef\u4ee5\u5feb\u901f\u66f4\u65b0\u3002</p> <ul> <li>\u8fd8\u6709\u5f88\u591a\u672a\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u4f8b\u5982\u5173\u4e8e\u65f6\u95f4\u76f8\u5173\u8fde\u63a5\u7b49\u95ee\u9898\uff0c\u4f46\u6211\u8ba4\u4e3a\u56f4\u7ed5\u6570\u636e\u6d41\u6784\u5efa\u5e94\u7528\u7684\u60f3\u6cd5\u662f\u4e00\u4e2a\u975e\u5e38\u6709\u5e0c\u671b\u7684\u65b9\u5411\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_23","title":"\u89c2\u5bdf\u884d\u751f\u6570\u636e\u72b6\u6001","text":"<p>\u5728\u62bd\u8c61\u5c42\u9762\uff0c\u4e0a\u4e00\u8282\u8ba8\u8bba\u7684\u6570\u636e\u6d41\u7cfb\u7edf\u63d0\u4f9b\u4e86\u521b\u5efa\u884d\u751f\u6570\u636e\u96c6\uff08\u4f8b\u5982\u641c\u7d22\u7d22\u5f15\u3001\u7269\u5316\u89c6\u56fe\u548c\u9884\u6d4b\u6a21\u578b\uff09\u5e76\u4f7f\u5176\u4fdd\u6301\u66f4\u65b0\u7684\u8fc7\u7a0b\u3002\u6211\u4eec\u5c06\u8fd9\u4e2a\u8fc7\u7a0b\u79f0\u4e3a \u5199\u8def\u5f84\uff08write path\uff09\uff1a\u53ea\u8981\u67d0\u4e9b\u4fe1\u606f\u88ab\u5199\u5165\u7cfb\u7edf\uff0c\u5b83\u53ef\u80fd\u4f1a\u7ecf\u5386\u6279\u5904\u7406\u4e0e\u6d41\u5904\u7406\u7684\u591a\u4e2a\u9636\u6bb5\uff0c\u800c\u6700\u7ec8\u6bcf\u4e2a\u884d\u751f\u6570\u636e\u96c6\u90fd\u4f1a\u88ab\u66f4\u65b0\uff0c\u4ee5\u9002\u914d\u5199\u5165\u7684\u6570\u636e\u3002</p> <p>\u56fe 12-1 \u663e\u793a\u4e86\u4e00\u4e2a\u66f4\u65b0\u641c\u7d22\u7d22\u5f15\u7684\u4f8b\u5b50\u3002</p> <ul> <li>\u4e3a\u4ec0\u4e48\u4e00\u5f00\u59cb\u5c31\u8981\u521b\u5efa\u884d\u751f\u6570\u636e\u96c6\uff1f\u5f88\u53ef\u80fd\u662f\u56e0\u4e3a\u4f60\u60f3\u5728\u4ee5\u540e\u518d\u6b21\u67e5\u8be2\u5b83\u3002\u8fd9\u5c31\u662f \u8bfb\u8def\u5f84\uff08read path\uff09\uff1a\u5f53\u670d\u52a1\u7528\u6237\u8bf7\u6c42\u65f6\uff0c\u4f60\u9700\u8981\u4ece\u884d\u751f\u6570\u636e\u96c6\u4e2d\u8bfb\u53d6\uff0c\u4e5f\u8bb8\u8fd8\u8981\u5bf9\u7ed3\u679c\u8fdb\u884c\u4e00\u4e9b\u989d\u5916\u5904\u7406\uff0c\u7136\u540e\u6784\u5efa\u7ed9\u7528\u6237\u7684\u54cd\u5e94\u3002</li> <li>\u884d\u751f\u6570\u636e\u96c6\u662f\u5199\u8def\u5f84\u548c\u8bfb\u8def\u5f84\u76f8\u9047\u7684\u5730\u65b9\u3002\u5b83\u4ee3\u8868\u4e86\u5728\u5199\u5165\u65f6\u9700\u8981\u5b8c\u6210\u7684\u5de5\u4f5c\u91cf\u4e0e\u5728\u8bfb\u53d6\u65f6\u9700\u8981\u5b8c\u6210\u7684\u5de5\u4f5c\u91cf\u4e4b\u95f4\u7684\u6743\u8861\u3002</li> </ul> <p></p> \u56fe 12-1 \u5728\u641c\u7d22\u7d22\u5f15\u4e2d\uff0c\u5199\uff08\u6587\u6863\u66f4\u65b0\uff09\u9047\u4e0a\u8bfb\uff08\u67e5\u8be2\uff09 <p>\u5199\u8def\u5f84\u548c\u8bfb\u8def\u5f84\u6db5\u76d6\u4e86\u6570\u636e\u7684\u6574\u4e2a\u65c5\u7a0b\uff0c\u4ece\u6536\u96c6\u6570\u636e\u5f00\u59cb\uff0c\u5230\u4f7f\u7528\u6570\u636e\u7ed3\u675f\uff08\u53ef\u80fd\u662f\u7531\u53e6\u4e00\u4e2a\u4eba\uff09\u3002\u5199\u8def\u5f84\u662f\u9884\u8ba1\u7b97\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206 \u2014\u2014 \u5373\uff0c\u4e00\u65e6\u6570\u636e\u8fdb\u5165\uff0c\u5373\u523b\u5b8c\u6210\uff0c\u65e0\u8bba\u662f\u5426\u6709\u4eba\u9700\u8981\u770b\u5b83\u3002\u8bfb\u8def\u5f84\u662f\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u53ea\u6709\u5f53\u6709\u4eba\u8bf7\u6c42\u65f6\u624d\u4f1a\u53d1\u751f\u7684\u90e8\u5206\u3002\u5982\u679c\u4f60\u719f\u6089\u51fd\u6570\u5f0f\u7f16\u7a0b\u8bed\u8a00\uff0c\u5219\u53ef\u80fd\u4f1a\u6ce8\u610f\u5230\u5199\u8def\u5f84\u7c7b\u4f3c\u4e8e\u7acb\u5373\u6c42\u503c\uff0c\u8bfb\u8def\u5f84\u7c7b\u4f3c\u4e8e\u60f0\u6027\u6c42\u503c\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_24","title":"\u7269\u5316\u89c6\u56fe\u548c\u7f13\u5b58","text":"<p>\u5168\u6587\u641c\u7d22\u7d22\u5f15\u5c31\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u4f8b\u5b50\uff1a\u5199\u8def\u5f84\u66f4\u65b0\u7d22\u5f15\uff0c\u8bfb\u8def\u5f84\u5728\u7d22\u5f15\u4e2d\u641c\u7d22\u5173\u952e\u5b57\u3002\u8bfb\u5199\u90fd\u9700\u8981\u505a\u4e00\u4e9b\u5de5\u4f5c\u3002</p> <ul> <li>\u5199\u5165\u9700\u8981\u66f4\u65b0\u6587\u6863\u4e2d\u51fa\u73b0\u7684\u6240\u6709\u5173\u952e\u8bcd\u7684\u7d22\u5f15\u6761\u76ee\u3002</li> <li>\u8bfb\u53d6\u9700\u8981\u641c\u7d22\u67e5\u8be2\u4e2d\u7684\u6bcf\u4e2a\u5355\u8bcd\uff0c\u5e76\u5e94\u7528\u5e03\u5c14\u903b\u8f91\u6765\u67e5\u627e\u5305\u542b\u67e5\u8be2\u4e2d\u6240\u6709\u5355\u8bcd\uff08AND \u8fd0\u7b97\u7b26\uff09\u7684\u6587\u6863\uff0c\u6216\u8005\u6bcf\u4e2a\u5355\u8bcd\uff08OR \u8fd0\u7b97\u7b26\uff09\u7684\u4efb\u4f55\u540c\u4e49\u8bcd\u3002</li> </ul> <p>\u5982\u679c\u6ca1\u6709\u7d22\u5f15\uff0c\u641c\u7d22\u67e5\u8be2\u5c06\u4e0d\u5f97\u4e0d\u626b\u63cf\u6240\u6709\u6587\u6863\uff08\u5982 grep\uff09\uff0c\u5982\u679c\u6709\u7740\u5927\u91cf\u6587\u6863\uff0c\u8fd9\u6837\u505a\u7684\u5f00\u9500\u5de8\u5927\u3002\u6ca1\u6709\u7d22\u5f15\u610f\u5473\u7740\u5199\u5165\u8def\u5f84\u4e0a\u7684\u5de5\u4f5c\u91cf\u8f83\u5c11\uff08\u6ca1\u6709\u8981\u66f4\u65b0\u7684\u7d22\u5f15\uff09\uff0c\u4f46\u662f\u5728\u8bfb\u53d6\u8def\u5f84\u4e0a\u9700\u8981\u66f4\u591a\u5de5\u4f5c\u3002</p> <p>\u53e6\u4e00\u65b9\u9762\uff0c\u53ef\u4ee5\u60f3\u8c61\u4e3a\u6240\u6709\u53ef\u80fd\u7684\u67e5\u8be2\u9884\u5148\u8ba1\u7b97\u641c\u7d22\u7ed3\u679c\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8bfb\u8def\u5f84\u4e0a\u7684\u5de5\u4f5c\u91cf\u4f1a\u51cf\u5c11\uff1a\u4e0d\u9700\u8981\u5e03\u5c14\u903b\u8f91\uff0c\u53ea\u9700\u67e5\u627e\u67e5\u8be2\u7ed3\u679c\u5e76\u8fd4\u56de\u5373\u53ef\u3002\u4f46\u5199\u8def\u5f84\u4f1a\u66f4\u52a0\u6602\u8d35\uff1a\u53ef\u80fd\u7684\u641c\u7d22\u67e5\u8be2\u96c6\u5408\u662f\u65e0\u9650\u5927\u7684\uff0c\u56e0\u6b64\u9884\u5148\u8ba1\u7b97\u6240\u6709\u53ef\u80fd\u7684\u641c\u7d22\u7ed3\u679c\u5c06\u9700\u8981\u65e0\u9650\u7684\u65f6\u95f4\u548c\u5b58\u50a8\u7a7a\u95f4\u3002</p> <p>\u4ece\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u7d22\u5f15\u4e0d\u662f\u5199\u8def\u5f84\u548c\u8bfb\u8def\u5f84\u4e4b\u95f4\u552f\u4e00\u53ef\u80fd\u7684\u8fb9\u754c\uff1b\u7f13\u5b58\u5e38\u89c1\u641c\u7d22\u7ed3\u679c\u4e5f\u662f\u53ef\u884c\u7684\uff1b\u800c\u5728\u5c11\u91cf\u6587\u6863\u4e0a\u4f7f\u7528\u6ca1\u6709\u7d22\u5f15\u7684\u7c7b grep \u626b\u63cf\u4e5f\u662f\u53ef\u884c\u7684\u3002</p> <ul> <li>\u7f13\u5b58\uff0c\u7d22\u5f15\u548c\u7269\u5316\u89c6\u56fe\u7684\u4f5c\u7528\u5f88\u7b80\u5355\uff1a\u5b83\u4eec\u6539\u53d8\u4e86\u8bfb\u8def\u5f84\u4e0e\u5199\u8def\u5f84\u4e4b\u95f4\u7684\u8fb9\u754c\u3002\u901a\u8fc7\u9884\u5148\u8ba1\u7b97\u7ed3\u679c\uff0c\u4ece\u800c\u5141\u8bb8\u6211\u4eec\u5728\u5199\u8def\u5f84\u4e0a\u505a\u66f4\u591a\u7684\u5de5\u4f5c\uff0c\u4ee5\u8282\u7701\u8bfb\u8def\u5f84\u4e0a\u7684\u5de5\u4f5c\u91cf\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_25","title":"\u6709\u72b6\u6001\u3001\u53ef\u79bb\u7ebf\u7684\u5ba2\u6237\u7aef","text":"<p>\u6211\u53d1\u73b0\u5199\u8def\u5f84\u548c\u8bfb\u8def\u5f84\u4e4b\u95f4\u7684\u8fb9\u754c\u5f88\u6709\u8da3\uff0c\u56e0\u4e3a\u6211\u4eec\u53ef\u4ee5\u8bd5\u7740\u6539\u53d8\u8fd9\u4e2a\u8fb9\u754c\uff0c\u5e76\u63a2\u8ba8\u8fd9\u79cd\u6539\u53d8\u7684\u5b9e\u9645\u610f\u4e49\u3002</p> <p>\u4f20\u7edf\u4e0a\uff0c\u7f51\u7edc\u6d4f\u89c8\u5668\u662f\u65e0\u72b6\u6001\u7684\u5ba2\u6237\u7aef\uff0c\u53ea\u6709\u5f53\u8fde\u63a5\u5230\u4e92\u8054\u7f51\u65f6\u624d\u80fd\u505a\u4e00\u4e9b\u6709\u7528\u7684\u4e8b\u60c5\uff08\u80fd\u79bb\u7ebf\u6267\u884c\u7684\u552f\u4e00\u4e8b\u60c5\u57fa\u672c\u4e0a\u5c31\u662f\u4e0a\u4e0b\u6eda\u52a8\u4e4b\u524d\u5728\u7ebf\u65f6\u52a0\u8f7d\u597d\u7684\u9875\u9762\uff09\u3002\u7136\u800c\uff0c\u6700\u8fd1\u7684 \u201c\u5355\u9875\u9762\u201d JavaScript Web \u5e94\u7528\u5df2\u7ecf\u83b7\u5f97\u4e86\u5f88\u591a\u6709\u72b6\u6001\u7684\u529f\u80fd\uff0c\u5305\u62ec\u5ba2\u6237\u7aef\u7528\u6237\u754c\u9762\u4ea4\u4e92\uff0c\u4ee5\u53ca Web \u6d4f\u89c8\u5668\u4e2d\u7684\u6301\u4e45\u5316\u672c\u5730\u5b58\u50a8\u3002\u79fb\u52a8\u5e94\u7528\u53ef\u4ee5\u7c7b\u4f3c\u5730\u5728\u8bbe\u5907\u4e0a\u5b58\u50a8\u5927\u91cf\u72b6\u6001\uff0c\u800c\u4e14\u5927\u591a\u6570\u7528\u6237\u4ea4\u4e92\u90fd\u4e0d\u9700\u8981\u4e0e\u670d\u52a1\u5668\u5f80\u8fd4\u4ea4\u4e92\u3002</p> <p>\u8fd9\u4e9b\u4e0d\u65ad\u53d8\u5316\u7684\u529f\u80fd\u91cd\u65b0\u5f15\u53d1\u4e86\u5bf9 \u79bb\u7ebf\u4f18\u5148\uff08offline-first\uff09 \u5e94\u7528\u7684\u5174\u8da3\uff0c\u8fd9\u4e9b\u5e94\u7528\u5c3d\u53ef\u80fd\u5730\u5728\u540c\u4e00\u8bbe\u5907\u4e0a\u4f7f\u7528\u672c\u5730\u6570\u636e\u5e93\uff0c\u65e0\u9700\u8fde\u63a5\u4e92\u8054\u7f51\uff0c\u5e76\u5728\u540e\u53f0\u7f51\u7edc\u8fde\u63a5\u53ef\u7528\u65f6\u4e0e\u8fdc\u7a0b\u670d\u52a1\u5668\u540c\u6b65\u301042\u3011\u3002\u7531\u4e8e\u79fb\u52a8\u8bbe\u5907\u901a\u5e38\u5177\u6709\u7f13\u6162\u4e14\u4e0d\u53ef\u9760\u7684\u8702\u7a9d\u7f51\u7edc\u8fde\u63a5\uff0c\u56e0\u6b64\uff0c\u5982\u679c\u7528\u6237\u7684\u7528\u6237\u754c\u9762\u4e0d\u5fc5\u7b49\u5f85\u540c\u6b65\u7f51\u7edc\u8bf7\u6c42\uff0c\u4e14\u5e94\u7528\u4e3b\u8981\u662f\u79bb\u7ebf\u5de5\u4f5c\u7684\uff0c\u5219\u8fd9\u662f\u4e00\u4e2a\u5de8\u5927\u4f18\u52bf\u3002</p> <p>\u53ef\u4ee5\u5c06\u8bbe\u5907\u4e0a\u7684\u72b6\u6001\u89c6\u4e3a \u670d\u52a1\u5668\u72b6\u6001\u7684\u7f13\u5b58\u3002\u5c4f\u5e55\u4e0a\u7684\u50cf\u7d20\u662f\u5ba2\u6237\u7aef\u5e94\u7528\u4e2d\u6a21\u578b\u5bf9\u8c61\u7684\u7269\u5316\u89c6\u56fe\uff1b\u6a21\u578b\u5bf9\u8c61\u662f\u8fdc\u7a0b\u6570\u636e\u4e2d\u5fc3\u7684\u672c\u5730\u72b6\u6001\u526f\u672c\u301027\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_26","title":"\u5c06\u72b6\u6001\u53d8\u66f4\u63a8\u9001\u7ed9\u5ba2\u6237\u7aef","text":"<p>\u5728\u5178\u578b\u7684\u7f51\u9875\u4e2d\uff0c\u5982\u679c\u4f60\u5728 Web \u6d4f\u89c8\u5668\u4e2d\u52a0\u8f7d\u9875\u9762\uff0c\u5e76\u4e14\u968f\u540e\u670d\u52a1\u5668\u4e0a\u7684\u6570\u636e\u53d1\u751f\u53d8\u66f4\uff0c\u5219\u6d4f\u89c8\u5668\u5728\u91cd\u65b0\u52a0\u8f7d\u9875\u9762\u4e4b\u524d\u5bf9\u6b64\u4e00\u65e0\u6240\u77e5\u3002\u6d4f\u89c8\u5668\u53ea\u80fd\u5728\u4e00\u4e2a\u65f6\u95f4\u70b9\u8bfb\u53d6\u6570\u636e\uff0c\u5047\u8bbe\u5b83\u662f\u9759\u6001\u7684 \u2014\u2014 \u5b83\u4e0d\u4f1a\u8ba2\u9605\u6765\u81ea\u670d\u52a1\u5668\u7684\u66f4\u65b0\u3002\u56e0\u6b64\u8bbe\u5907\u4e0a\u7684\u72b6\u6001\u662f\u9648\u65e7\u7684\u7f13\u5b58\uff0c\u9664\u975e\u4f60\u663e\u5f0f\u8f6e\u8be2\u53d8\u66f4\u5426\u5219\u4e0d\u4f1a\u66f4\u65b0\u3002\uff08\u50cf RSS \u8fd9\u6837\u57fa\u4e8e HTTP \u7684 Feed \u8ba2\u9605\u534f\u8bae\u5b9e\u9645\u4e0a\u53ea\u662f\u4e00\u79cd\u57fa\u672c\u7684\u8f6e\u8be2\u5f62\u5f0f\uff09</p> <p>\u6700\u8fd1\u7684\u534f\u8bae\u5df2\u7ecf\u8d85\u8d8a\u4e86 HTTP \u7684\u57fa\u672c\u8bf7\u6c42 / \u54cd\u5e94\u6a21\u5f0f\uff1a\u670d\u52a1\u7aef\u53d1\u9001\u7684\u4e8b\u4ef6\uff08EventSource API\uff09\u548c WebSockets \u63d0\u4f9b\u4e86\u901a\u4fe1\u4fe1\u9053\u3002Web \u6d4f\u89c8\u5668\u53ef\u4ee5\u4e0e\u670d\u52a1\u5668\u4fdd\u6301\u6253\u5f00\u7684 TCP \u8fde\u63a5\uff0c\u53ea\u8981\u6d4f\u89c8\u5668\u4ecd\u7136\u8fde\u63a5\u7740\uff0c\u670d\u52a1\u5668\u5c31\u80fd\u4e3b\u52a8\u5411\u6d4f\u89c8\u5668\u63a8\u9001\u4fe1\u606f\u3002</p> <p>\u7528\u6211\u4eec\u7684\u5199\u8def\u5f84\u4e0e\u8bfb\u8def\u5f84\u6a21\u578b\u6765\u8bb2\uff0c\u4e3b\u52a8\u5c06\u72b6\u6001\u53d8\u66f4\u63a8\u81f3\u5230\u5ba2\u6237\u7aef\u8bbe\u5907\uff0c\u610f\u5473\u7740\u5c06\u5199\u8def\u5f84\u4e00\u76f4\u5ef6\u4f38\u5230\u7ec8\u7aef\u7528\u6237\u3002\u5728\u6d41\u5904\u7406\u548c\u6d88\u606f\u4f20\u9012\u90e8\u5206\u8ba8\u8bba\u7684\u60f3\u6cd5\u5e76\u4e0d\u5c40\u9650\u4e8e\u6570\u636e\u4e2d\u5fc3\u4e2d\uff1a\u6211\u4eec\u53ef\u4ee5\u8fdb\u4e00\u6b65\u91c7\u7eb3\u8fd9\u4e9b\u60f3\u6cd5\uff0c\u5e76\u5c06\u5b83\u4eec\u4e00\u76f4\u5ef6\u4f38\u5230\u7ec8\u7aef\u7528\u6237\u8bbe\u5907\u301043\u3011\u3002</p> <p>\u8fd9\u4e9b\u8bbe\u5907\u6709\u65f6\u4f1a\u79bb\u7ebf\uff0c\u5e76\u5728\u6b64\u671f\u95f4\u65e0\u6cd5\u6536\u5230\u670d\u52a1\u5668\u72b6\u6001\u53d8\u66f4\u7684\u4efb\u4f55\u901a\u77e5\u3002\u4f46\u662f\u6211\u4eec\u5df2\u7ecf\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff1a</p> <ul> <li>\u57fa\u4e8e\u65e5\u5fd7\u7684\u6d88\u606f\u4ee3\u7406\u7684\u6d88\u8d39\u8005\u80fd\u5728\u5931\u8d25\u6216\u65ad\u5f00\u8fde\u63a5\u540e\u91cd\u8fde\uff0c\u5e76\u786e\u4fdd\u5b83\u4e0d\u4f1a\u9519\u8fc7\u6389\u7ebf\u671f\u95f4\u4efb\u4f55\u5230\u8fbe\u7684\u6d88\u606f\u3002</li> <li>\u540c\u6837\u7684\u6280\u672f\u9002\u7528\u4e8e\u5355\u4e2a\u7528\u6237\uff0c\u6bcf\u4e2a\u8bbe\u5907\u90fd\u662f\u4e00\u4e2a\u5c0f\u4e8b\u4ef6\u6d41\u7684\u5c0f\u5c0f\u8ba2\u9605\u8005\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_27","title":"\u7aef\u5230\u7aef\u7684\u4e8b\u4ef6\u6d41","text":"<p>\u6700\u8fd1\u7528\u4e8e\u5f00\u53d1\u6709\u72b6\u6001\u7684\u5ba2\u6237\u7aef\u4e0e\u7528\u6237\u754c\u9762\u7684\u5de5\u5177\uff0c\u4f8b\u5982\u5982 Elm \u8bed\u8a00\u301030\u3011\u548c Facebook \u7684 React\u3001Flux \u548c Redux \u5de5\u5177\u94fe\uff0c\u5df2\u7ecf\u901a\u8fc7\u8ba2\u9605\u8868\u793a\u7528\u6237\u8f93\u5165\u6216\u670d\u52a1\u5668\u54cd\u5e94\u7684\u4e8b\u4ef6\u6d41\u6765\u7ba1\u7406\u5ba2\u6237\u7aef\u7684\u5185\u90e8\u72b6\u6001\uff0c\u5176\u7ed3\u6784\u4e0e\u4e8b\u4ef6\u6eaf\u6e90\u76f8\u4f3c\u3002</p> <p>\u5c06\u8fd9\u79cd\u7f16\u7a0b\u6a21\u578b\u6269\u5c55\u4e3a\uff1a\u5141\u8bb8\u670d\u52a1\u5668\u5c06\u72b6\u6001\u53d8\u66f4\u4e8b\u4ef6\u63a8\u9001\u5230\u5ba2\u6237\u7aef\u7684\u4e8b\u4ef6\u7ba1\u9053\u4e2d\uff0c\u662f\u975e\u5e38\u81ea\u7136\u7684\u3002</p> <p>\u72b6\u6001\u53d8\u5316\u53ef\u4ee5\u901a\u8fc7 \u7aef\u5230\u7aef\uff08end-to-end\uff09 \u7684\u5199\u8def\u5f84\u6d41\u52a8\uff1a\u4ece\u4e00\u4e2a\u8bbe\u5907\u4e0a\u7684\u4ea4\u4e92\u89e6\u53d1\u72b6\u6001\u53d8\u66f4\u5f00\u59cb\uff0c\u7ecf\u7531\u4e8b\u4ef6\u65e5\u5fd7\uff0c\u5e76\u7a7f\u8fc7\u51e0\u4e2a\u884d\u751f\u6570\u636e\u7cfb\u7edf\u4e0e\u6d41\u5904\u7406\u5668\uff0c\u4e00\u76f4\u5230\u53e6\u4e00\u53f0\u8bbe\u5907\u4e0a\u7684\u7528\u6237\u754c\u9762\uff0c\u800c\u6709\u4eba\u6b63\u5728\u89c2\u5bdf\u7528\u6237\u754c\u9762\u4e0a\u7684\u72b6\u6001\u53d8\u5316\u3002\u8fd9\u4e9b\u72b6\u6001\u53d8\u5316\u80fd\u4ee5\u76f8\u5f53\u4f4e\u7684\u5ef6\u8fdf\u4f20\u64ad \u2014\u2014 \u6bd4\u5982\u8bf4\uff0c\u5728\u4e00\u79d2\u5185\u4ece\u4e00\u7aef\u5230\u53e6\u4e00\u7aef\u3002</p> <p>\u4e00\u4e9b\u5e94\u7528\uff08\u5982\u5373\u65f6\u6d88\u606f\u4f20\u9012\u4e0e\u5728\u7ebf\u6e38\u620f\uff09\u5df2\u7ecf\u5177\u6709\u8fd9\u79cd \u201c\u5b9e\u65f6\u201d \u67b6\u6784\uff08\u5728\u4f4e\u5ef6\u8fdf\u4ea4\u4e92\u7684\u610f\u4e49\u4e0a\uff09\u3002\u4f46\u6211\u4eec\u4e3a\u4ec0\u4e48\u4e0d\u7528\u8fd9\u79cd\u65b9\u5f0f\u6784\u5efa\u6240\u6709\u7684\u5e94\u7528\uff1f</p> <ul> <li>\u6311\u6218\u5728\u4e8e\uff0c\u5173\u4e8e\u65e0\u72b6\u6001\u5ba2\u6237\u7aef\u548c\u8bf7\u6c42 / \u54cd\u5e94\u4ea4\u4e92\u7684\u5047\u8bbe\u5df2\u7ecf\u6839\u6df1\u8482\u56fa\u5730\u690d\u5165\u5728\u6211\u4eec\u7684\u6570\u636e\u5e93\u3001\u5e93\u3001\u6846\u67b6\u4ee5\u53ca\u534f\u8bae\u4e4b\u4e2d\u3002-</li> <li>\u8bb8\u591a\u6570\u636e\u5b58\u50a8\u652f\u6301\u8bfb\u53d6\u4e0e\u5199\u5165\u64cd\u4f5c\uff0c\u4e3a\u8bf7\u6c42\u8fd4\u56de\u4e00\u4e2a\u54cd\u5e94\uff0c\u4f46\u53ea\u6709\u6781\u5c11\u6570\u63d0\u4f9b\u8ba2\u9605\u53d8\u66f4\u7684\u80fd\u529b \u2014\u2014 \u8bf7\u6c42\u8fd4\u56de\u4e00\u4e2a\u968f\u65f6\u95f4\u63a8\u79fb\u7684\u54cd\u5e94\u6d41\u3002</li> </ul> <p>\u4e3a\u4e86\u5c06\u5199\u8def\u5f84\u5ef6\u4f38\u81f3\u7ec8\u7aef\u7528\u6237\uff0c\u4ece\u6839\u672c\u4e0a\u91cd\u65b0\u601d\u8003\u6211\u4eec\u6784\u5efa\u8fd9\u4e9b\u7cfb\u7edf\u7684\u65b9\u5f0f\uff1a\u4ece\u8bf7\u6c42 / \u54cd\u5e94\u4ea4\u4e92\u8f6c\u5411\u53d1\u5e03 / \u8ba2\u9605\u6570\u636e\u6d41\u301027\u3011\u3002\u5982\u679c\u4f60\u6b63\u5728\u8bbe\u8ba1\u6570\u636e\u7cfb\u7edf\uff0c\u6211\u5e0c\u671b\u4f60\u5bf9\u8ba2\u9605\u53d8\u66f4\u7684\u9009\u9879\u7559\u6709\u5370\u8c61\uff0c\u800c\u4e0d\u53ea\u662f\u67e5\u8be2\u5f53\u524d\u72b6\u6001\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_28","title":"\u8bfb\u4e5f\u662f\u4e8b\u4ef6","text":"<p>\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\uff0c\u6570\u636e\u5b58\u50a8\u4e0e\u6d41\u5904\u7406\u7cfb\u7edf\u662f\u5206\u5f00\u7684\u3002\u4f46\u6d41\u5904\u7406\u5668\u8fd8\u662f\u9700\u8981\u7ef4\u62a4\u72b6\u6001\u4ee5\u6267\u884c\u805a\u5408\u548c\u8fde\u63a5\u7684\uff0c\u8fd9\u79cd\u72b6\u6001\u901a\u5e38\u9690\u85cf\u5728\u6d41\u5904\u7406\u5668\u5185\u90e8\uff0c\u4f46\u4e00\u4e9b\u6846\u67b6\u4e5f\u5141\u8bb8\u8fd9\u4e9b\u72b6\u6001\u88ab\u5916\u90e8\u5ba2\u6237\u7aef\u67e5\u8be2\u301045\u3011\uff0c\u5c06\u6d41\u5904\u7406\u5668\u672c\u8eab\u53d8\u6210\u4e00\u79cd\u7b80\u5355\u7684\u6570\u636e\u5e93\u3002</p> <p>\u5bf9\u5b58\u50a8\u7684\u5199\u5165\u662f\u901a\u8fc7\u4e8b\u4ef6\u65e5\u5fd7\u8fdb\u884c\u7684\uff0c\u800c\u8bfb\u53d6\u662f\u4e34\u65f6\u7684\u7f51\u7edc\u8bf7\u6c42\uff0c\u76f4\u63a5\u6d41\u5411\u5b58\u50a8\u7740\u5f85\u67e5\u6570\u636e\u7684\u8282\u70b9\u3002\u8fd9\u662f\u4e00\u4e2a\u5408\u7406\u7684\u8bbe\u8ba1\uff0c\u4f46\u4e0d\u662f\u552f\u4e00\u53ef\u884c\u7684\u8bbe\u8ba1\u3002</p> <ul> <li>\u4e5f\u53ef\u4ee5\u5c06\u8bfb\u53d6\u8bf7\u6c42\u8868\u793a\u4e3a\u4e8b\u4ef6\u6d41\uff0c\u5e76\u540c\u65f6\u5c06\u8bfb\u4e8b\u4ef6\u4e0e\u5199\u4e8b\u4ef6\u9001\u5f80\u6d41\u5904\u7406\u5668\uff1b\u6d41\u5904\u7406\u5668\u901a\u8fc7\u5c06\u8bfb\u53d6\u7ed3\u679c\u53d1\u9001\u5230\u8f93\u51fa\u6d41\u6765\u54cd\u5e94\u8bfb\u53d6\u4e8b\u4ef6\u301046\u3011\u3002</li> </ul> <p>\u5f53\u5199\u5165\u548c\u8bfb\u53d6\u90fd\u88ab\u8868\u793a\u4e3a\u4e8b\u4ef6\uff0c\u5e76\u4e14\u88ab\u8def\u7531\u5230\u540c\u4e00\u4e2a\u6d41\u7b97\u5b50\u4ee5\u4fbf\u5904\u7406\u65f6\uff0c\u662f\u5728\u8bfb\u53d6\u67e5\u8be2\u6d41\u548c\u6570\u636e\u5e93\u4e4b\u95f4\u6267\u884c\u6d41\u8868\u8fde\u63a5\u3002\u8bfb\u53d6\u4e8b\u4ef6\u9700\u8981\u88ab\u9001\u5f80\u4fdd\u5b58\u6570\u636e\u7684\u6570\u636e\u5e93\u5206\u533a\uff0c\u5c31\u50cf\u6279\u5904\u7406\u548c\u6d41\u5904\u7406\u5668\u5728\u8fde\u63a5\u65f6\u9700\u8981\u5728\u540c\u4e00\u4e2a\u952e\u4e0a\u5bf9\u8f93\u5165\u5206\u533a\u4e00\u6837\u3002</p> <p>\u670d\u52a1\u8bf7\u6c42\u4e0e\u6267\u884c\u8fde\u63a5\u4e4b\u95f4\u7684\u8fd9\u79cd\u76f8\u4f3c\u4e4b\u5904\u662f\u975e\u5e38\u5173\u952e\u7684\u301047\u3011\u3002\u4e00\u6b21\u6027\u8bfb\u53d6\u8bf7\u6c42\u53ea\u662f\u5c06\u8bf7\u6c42\u4f20\u8fc7\u8fde\u63a5\u7b97\u5b50\uff0c\u7136\u540e\u8bf7\u6c42\u9a6c\u4e0a\u5c31\u88ab\u5fd8\u6389\u4e86\uff1b\u800c\u4e00\u4e2a\u8ba2\u9605\u8bf7\u6c42\uff0c\u5219\u662f\u4e0e\u8fde\u63a5\u53e6\u4e00\u4fa7\u8fc7\u53bb\u4e0e\u672a\u6765\u4e8b\u4ef6\u7684\u6301\u4e45\u5316\u8fde\u63a5\u3002</p> <p>\u8bb0\u5f55\u8bfb\u53d6\u4e8b\u4ef6\u7684\u65e5\u5fd7\u53ef\u80fd\u5bf9\u4e8e\u8ffd\u8e2a\u6574\u4e2a\u7cfb\u7edf\u4e2d\u7684\u56e0\u679c\u5173\u7cfb\u4e0e\u6570\u636e\u6765\u6e90\u4e5f\u6709\u597d\u5904\uff1a\u5b83\u53ef\u4ee5\u8ba9\u4f60\u91cd\u73b0\u51fa\u5f53\u7528\u6237\u505a\u51fa\u7279\u5b9a\u51b3\u7b56\u4e4b\u524d\u770b\u89c1\u4e86\u4ec0\u4e48\u3002</p> <ul> <li>\u5982\u5728\u7f51\u5546\u4e2d\uff0c\u5411\u5ba2\u6237\u663e\u793a\u7684\u9884\u6d4b\u9001\u8fbe\u65e5\u671f\u4e0e\u5e93\u5b58\u72b6\u6001\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cd\u4ed6\u4eec\u662f\u5426\u9009\u62e9\u8d2d\u4e70\u4e00\u4ef6\u5546\u54c1\u30104\u3011\u3002\u8981\u5206\u6790\u8fd9\u79cd\u8054\u7cfb\uff0c\u5219\u9700\u8981\u8bb0\u5f55\u7528\u6237\u67e5\u8be2\u8fd0\u8f93\u4e0e\u5e93\u5b58\u72b6\u6001\u7684\u7ed3\u679c\u3002</li> </ul> <p>\u5c06\u8bfb\u53d6\u4e8b\u4ef6\u5199\u5165\u6301\u4e45\u5b58\u50a8\u53ef\u4ee5\u66f4\u597d\u5730\u8ddf\u8e2a\u56e0\u679c\u5173\u7cfb\uff0c\u4f46\u4f1a\u4ea7\u751f\u989d\u5916\u7684\u5b58\u50a8\u4e0e I/O \u6210\u672c\uff1a</p> <ul> <li>\u4f18\u5316\u8fd9\u4e9b\u7cfb\u7edf\u4ee5\u51cf\u5c11\u5f00\u9500\u4ecd\u7136\u662f\u4e00\u4e2a\u5f00\u653e\u7684\u7814\u7a76\u95ee\u9898\u30102\u3011\u3002</li> <li>\u5982\u679c\u4f60\u5df2\u7ecf\u51fa\u4e8e\u8fd0\u7ef4\u76ee\u7684\u7559\u4e0b\u4e86\u8bfb\u53d6\u8bf7\u6c42\u65e5\u5fd7\uff0c\u5c06\u5176\u4f5c\u4e3a\u8bf7\u6c42\u5904\u7406\u7684\u526f\u4f5c\u7528\uff0c\u90a3\u4e48\u5c06\u8fd9\u4efd\u65e5\u5fd7\u4f5c\u4e3a\u8bf7\u6c42\u4e8b\u4ef6\u6e90\u5e76\u4e0d\u662f\u4ec0\u4e48\u7279\u522b\u5927\u7684\u53d8\u66f4\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_29","title":"\u591a\u5206\u533a\u6570\u636e\u5904\u7406","text":"<p>\u5bf9\u4e8e\u53ea\u6d89\u53ca\u5355\u4e2a\u5206\u533a\u7684\u67e5\u8be2\uff0c\u901a\u8fc7\u6d41\u6765\u53d1\u9001\u67e5\u8be2\u4e0e\u6536\u96c6\u54cd\u5e94\u53ef\u80fd\u662f\u6740\u9e21\u7528\u725b\u5200\u4e86\u3002\u7136\u800c\uff0c\u8fd9\u4e2a\u60f3\u6cd5\u5f00\u542f\u4e86\u5206\u5e03\u5f0f\u6267\u884c\u590d\u6742\u67e5\u8be2\u7684\u53ef\u80fd\u6027\uff0c\u8fd9\u9700\u8981\u5408\u5e76\u6765\u81ea\u591a\u4e2a\u5206\u533a\u7684\u6570\u636e\uff0c\u5229\u7528\u4e86\u6d41\u5904\u7406\u5668\u5df2\u7ecf\u63d0\u4f9b\u7684\u6d88\u606f\u8def\u7531\u3001\u5206\u533a\u548c\u8fde\u63a5\u7684\u57fa\u7840\u8bbe\u65bd\u3002</p> <ul> <li>Storm \u7684\u5206\u5e03\u5f0f RPC \u529f\u80fd\u652f\u6301\u8fd9\u79cd\u4f7f\u7528\u6a21\u5f0f\uff0c\u88ab\u7528\u6765\u8ba1\u7b97\u6d4f\u89c8\u8fc7\u67d0\u4e2a\u63a8\u7279 URL \u7684\u4eba\u6570 \u2014\u2014 \u5373\uff0c\u53d1\u63a8\u5305\u542b\u8be5 URL \u7684\u6240\u6709\u4eba\u7684\u7c89\u4e1d\u96c6\u5408\u7684\u5e76\u96c6\u301048\u3011\u3002\u7531\u4e8e\u63a8\u7279\u7684\u7528\u6237\u662f\u5206\u533a\u7684\uff0c\u56e0\u6b64\u8fd9\u79cd\u8ba1\u7b97\u9700\u8981\u5408\u5e76\u6765\u81ea\u591a\u4e2a\u5206\u533a\u7684\u7ed3\u679c\u3002</li> <li>\u53e6\u4e00\u4e2a\u4f8b\u5b50\u662f\u6b3a\u8bc8\u9884\u9632\uff1a\u4e3a\u4e86\u8bc4\u4f30\u7279\u5b9a\u8d2d\u4e70\u4e8b\u4ef6\u662f\u5426\u5177\u6709\u6b3a\u8bc8\u98ce\u9669\uff0c\u4f60\u53ef\u4ee5\u68c0\u67e5\u8be5\u7528\u6237 IP \u5730\u5740\uff0c\u7535\u5b50\u90ae\u4ef6\u5730\u5740\uff0c\u5e10\u5355\u5730\u5740\uff0c\u9001\u8d27\u5730\u5740\u7684\u4fe1\u7528\u5206\u3002\u8fd9\u4e9b\u4fe1\u7528\u6570\u636e\u5e93\u4e2d\u7684\u6bcf\u4e00\u4e2a\u90fd\u662f\u6709\u5206\u533a\u7684\uff0c\u56e0\u6b64\u4e3a\u7279\u5b9a\u8d2d\u4e70\u4e8b\u4ef6\u91c7\u96c6\u5206\u6570\u9700\u8981\u8fde\u63a5\u4e00\u7cfb\u5217\u4e0d\u540c\u7684\u5206\u533a\u6570\u636e\u96c6\u301049\u3011\u3002</li> </ul> <p>MPP \u6570\u636e\u5e93\u7684\u5185\u90e8\u67e5\u8be2\u6267\u884c\u56fe\u6709\u7740\u7c7b\u4f3c\u7684\u7279\u5f81\u3002\u5982\u679c\u9700\u8981\u6267\u884c\u8fd9\u79cd\u591a\u5206\u533a\u8fde\u63a5\uff0c\u5219\u76f4\u63a5\u4f7f\u7528\u63d0\u4f9b\u6b64\u529f\u80fd\u7684\u6570\u636e\u5e93\uff0c\u53ef\u80fd\u8981\u6bd4\u4f7f\u7528\u6d41\u5904\u7406\u5668\u5b9e\u73b0\u5b83\u8981\u66f4\u7b80\u5355\u3002</p> <ul> <li>\u5c06\u67e5\u8be2\u89c6\u4e3a\u6d41\u63d0\u4f9b\u4e86\u4e00\u79cd\u9009\u9879\uff0c\u53ef\u4ee5\u7528\u4e8e\u5b9e\u73b0\u8d85\u51fa\u4f20\u7edf\u73b0\u6210\u89e3\u51b3\u65b9\u6848\u7684\u5927\u89c4\u6a21\u5e94\u7528\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_30","title":"\u5c06\u4e8b\u60c5\u505a\u6b63\u786e","text":"<p>\u5bf9\u4e8e\u53ea\u8bfb\u53d6\u6570\u636e\u7684\u65e0\u72b6\u6001\u670d\u52a1\uff0c\u51fa\u95ee\u9898\u4e5f\u6ca1\u4ec0\u4e48\u5927\u4e0d\u4e86\u7684\uff1a\u4f60\u53ef\u4ee5\u4fee\u590d\u8be5\u9519\u8bef\u5e76\u91cd\u542f\u670d\u52a1\uff0c\u800c\u4e00\u5207\u90fd\u6062\u590d\u6b63\u5e38\u3002\u50cf\u6570\u636e\u5e93\u8fd9\u6837\u7684\u6709\u72b6\u6001\u7cfb\u7edf\u5c31\u6ca1\u90a3\u4e48\u7b80\u5355\u4e86\uff1a\u5b83\u4eec\u88ab\u8bbe\u8ba1\u4e3a\u6c38\u8fdc\u8bb0\u4f4f\u4e8b\u7269\uff08\u6216\u591a\u6216\u5c11\uff09\uff0c\u6240\u4ee5\u5982\u679c\u51fa\u73b0\u95ee\u9898\uff0c\u8fd9\u79cd\uff08\u9519\u8bef\u7684\uff09\u6548\u679c\u4e5f\u5c06\u6f5c\u5728\u5730\u6c38\u8fdc\u6301\u7eed\u4e0b\u53bb\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u9700\u8981\u66f4\u4ed4\u7ec6\u7684\u601d\u8003\u301050\u3011\u3002</p> <p>\u6784\u5efa\u53ef\u9760\u4e14 \u6b63\u786e \u7684\u5e94\u7528\uff08\u5373\u4f7f\u9762\u5bf9\u5404\u79cd\u6545\u969c\uff0c\u7a0b\u5e8f\u7684\u8bed\u4e49\u4e5f\u80fd\u88ab\u5f88\u597d\u5730\u5b9a\u4e49\u4e0e\u7406\u89e3\uff09\u3002\u7ea6\u56db\u5341\u5e74\u6765\uff0c\u539f\u5b50\u6027\u3001\u9694\u79bb\u6027\u548c\u6301\u4e45\u6027\uff08\u7b2c\u4e03\u7ae0\uff09\u7b49\u4e8b\u52a1\u7279\u6027\u4e00\u76f4\u662f\u6784\u5efa\u6b63\u786e\u5e94\u7528\u7684\u9996\u9009\u5de5\u5177\u3002\u7136\u800c\u8fd9\u4e9b\u5730\u57fa\u6ca1\u6709\u770b\u4e0a\u53bb\u90a3\u4e48\u7262\u56fa\uff1a\u4f8b\u5982\u5f31\u9694\u79bb\u7ea7\u522b\u5e26\u6765\u7684\u56f0\u60d1\u53ef\u4ee5\u4f50\u8bc1\uff08\u8bf7\u53c2\u9605 \u201c\u5f31\u9694\u79bb\u7ea7\u522b\u201d\uff09\u3002</p> <ul> <li>\u4e8b\u52a1\u5728\u67d0\u4e9b\u9886\u57df\u88ab\u5b8c\u5168\u629b\u5f03\uff0c\u5e76\u88ab\u63d0\u4f9b\u66f4\u597d\u6027\u80fd\u4e0e\u53ef\u4f38\u7f29\u6027\u7684\u6a21\u578b\u53d6\u4ee3\uff0c\u4f46\u540e\u8005\u6709\u66f4\u590d\u6742\u7684\u8bed\u4e49\u3002</li> <li>\u4e00\u81f4\u6027\uff08Consistency\uff09 \u7ecf\u5e38\u88ab\u8c08\u8d77\uff0c\u4f46\u5176\u5b9a\u4e49\u5e76\u4e0d\u660e\u786e\u3002\u6709\u4e9b\u4eba\u65ad\u8a00\u6211\u4eec\u5e94\u5f53\u4e3a\u4e86\u9ad8\u53ef\u7528\u800c \u201c\u62e5\u62b1\u5f31\u4e00\u81f4\u6027\u201d\uff0c\u4f46\u5374\u5bf9\u8fd9\u4e9b\u6982\u5ff5\u5b9e\u9645\u4e0a\u610f\u5473\u7740\u4ec0\u4e48\u7f3a\u4e4f\u6e05\u6670\u7684\u8ba4\u8bc6\u3002</li> </ul> <p>\u5bf9\u4e8e\u5982\u6b64\u91cd\u8981\u7684\u8bdd\u9898\uff0c\u6211\u4eec\u7684\u7406\u89e3\uff0c\u4ee5\u53ca\u6211\u4eec\u7684\u5de5\u7a0b\u65b9\u6cd5\u5374\u662f\u60ca\u4eba\u5730\u8584\u5f31\u3002\u4f8b\u5982\uff0c\u5728\u786e\u5b9a\u5728\u7279\u5b9a\u4e8b\u52a1\u9694\u79bb\u7b49\u7ea7\u6216\u590d\u5236\u914d\u7f6e\u4e0b\u8fd0\u884c\u7279\u5b9a\u5e94\u7528\u662f\u5426\u5b89\u5168\u662f\u975e\u5e38\u56f0\u96be\u7684\u301051,52\u3011\u3002\u901a\u5e38\u7b80\u5355\u7684\u89e3\u51b3\u65b9\u6848\u4f3c\u4e4e\u5728\u4f4e\u5e76\u53d1\u6027\u7684\u60c5\u51b5\u4e0b\u5de5\u4f5c\u6b63\u5e38\uff0c\u5e76\u4e14\u6ca1\u6709\u9519\u8bef\uff0c\u4f46\u5728\u8981\u6c42\u66f4\u9ad8\u7684\u60c5\u51b5\u4e0b\u5374\u4f1a\u51fa\u73b0\u8bb8\u591a\u5fae\u5999\u7684\u9519\u8bef\u3002</p> <ul> <li>\u4f8b\u5982\uff0cKyle Kingsbury \u7684 Jepsen \u5b9e\u9a8c\u301053\u3011\u6807\u51fa\u4e86\u4e00\u4e9b\u4ea7\u54c1\u58f0\u79f0\u7684\u5b89\u5168\u4fdd\u8bc1\u4e0e\u5176\u5728\u7f51\u7edc\u95ee\u9898\u4e0e\u5d29\u6e83\u65f6\u7684\u5b9e\u9645\u884c\u4e3a\u4e4b\u95f4\u7684\u660e\u663e\u5dee\u5f02\u3002</li> <li>\u5373\u4f7f\u50cf\u6570\u636e\u5e93\u8fd9\u6837\u7684\u57fa\u7840\u8bbe\u65bd\u4ea7\u54c1\u6ca1\u6709\u95ee\u9898\uff0c\u5e94\u7528\u4ee3\u7801\u4ecd\u7136\u9700\u8981\u6b63\u786e\u4f7f\u7528\u5b83\u4eec\u63d0\u4f9b\u7684\u529f\u80fd\u624d\u884c\uff0c\u5982\u679c\u914d\u7f6e\u5f88\u96be\u7406\u89e3\uff0c\u8fd9\u662f\u5f88\u5bb9\u6613\u51fa\u9519\u7684\uff08\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u6307\u7684\u662f\u5f31\u9694\u79bb\u7ea7\u522b\uff0c\u6cd5\u5b9a\u4eba\u6570\u914d\u7f6e\u7b49\uff09\u3002</li> </ul> <p>\u5982\u679c\u4f60\u9700\u8981\u66f4\u5f3a\u7684\u6b63\u786e\u6027\u4fdd\u8bc1\uff0c\u90a3\u4e48\u53ef\u4e32\u884c\u5316\u4e0e\u539f\u5b50\u63d0\u4ea4\u5c31\u662f\u4e45\u7ecf\u8003\u9a8c\u7684\u65b9\u6cd5\uff0c\u4f46\u5b83\u4eec\u662f\u6709\u4ee3\u4ef7\u7684\uff1a\u5b83\u4eec\u901a\u5e38\u53ea\u5728\u5355\u4e2a\u6570\u636e\u4e2d\u5fc3\u4e2d\u5de5\u4f5c\uff08\u8fd9\u5c31\u6392\u9664\u4e86\u5730\u7406\u4f4d\u7f6e\u5206\u6563\u7684\u67b6\u6784\uff09\uff0c\u5e76\u9650\u5236\u4e86\u7cfb\u7edf\u80fd\u591f\u5b9e\u73b0\u7684\u89c4\u6a21\u4e0e\u5bb9\u9519\u7279\u6027\u3002</p> <p>\u867d\u7136\u4f20\u7edf\u7684\u4e8b\u52a1\u65b9\u6cd5\u5e76\u6ca1\u6709\u8d70\u8fdc\uff0c\u4f46\u6211\u4e5f\u76f8\u4fe1\u5728\u4f7f\u5e94\u7528\u6b63\u786e\u800c\u7075\u6d3b\u5730\u5904\u7406\u9519\u8bef\u65b9\u9762\u4e0a\uff0c\u4e8b\u52a1\u4e5f\u4e0d\u662f\u6700\u540e\u4e00\u4e2a\u53ef\u4ee5\u8c08\u7684\u3002\u5728\u672c\u8282\u4e2d\uff0c\u6211\u5c06\u63d0\u51fa\u4e00\u4e9b\u5728\u6570\u636e\u6d41\u67b6\u6784\u4e2d\u8003\u91cf\u6b63\u786e\u6027\u7684\u65b9\u5f0f\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_31","title":"\u6570\u636e\u5e93\u7684\u7aef\u5230\u7aef\u539f\u5219","text":"<p>\u4ec5\u4ec5\u56e0\u4e3a\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u4e86\u5177\u6709\u76f8\u5bf9\u8f83\u5f3a\u5b89\u5168\u5c5e\u6027\u7684\u6570\u636e\u7cfb\u7edf\uff08\u4f8b\u5982\u53ef\u4e32\u884c\u5316\u7684\u4e8b\u52a1\uff09\uff0c\u5e76\u4e0d\u610f\u5473\u7740\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u6ca1\u6709\u6570\u636e\u4e22\u5931\u6216\u635f\u574f\u3002\u4f8b\u5982\uff0c\u5982\u679c\u67d0\u4e2a\u5e94\u7528\u6709\u4e2a Bug\uff0c\u5bfc\u81f4\u5b83\u5199\u5165\u4e0d\u6b63\u786e\u7684\u6570\u636e\uff0c\u6216\u8005\u4ece\u6570\u636e\u5e93\u4e2d\u5220\u9664\u6570\u636e\uff0c\u90a3\u4e48\u53ef\u4e32\u884c\u5316\u7684\u4e8b\u52a1\u4e5f\u6551\u4e0d\u4e86\u4f60\u3002</p> <ul> <li>\u5e94\u7528\u4f1a\u51fa Bug\uff0c\u800c\u4eba\u4e5f\u4f1a\u72af\u9519\u8bef\u3002\u53ef\u4ee5\u4f7f\u7528</li> <li>\u4e0d\u53ef\u53d8\u548c\u4ec5\u8ffd\u52a0\u7684\u6570\u636e\uff0c\u9609\u5272\u6389\u9519\u8bef\u4ee3\u7801\u6467\u6bc1\u826f\u597d\u6570\u636e\u7684\u80fd\u529b\uff0c\u80fd\u8ba9\u4ece\u9519\u8bef\u4e2d\u6062\u590d\u66f4\u4e3a\u5bb9\u6613\u3002</li> </ul> <p>\u867d\u7136\u4e0d\u53d8\u6027\u5f88\u6709\u7528\uff0c\u4f46\u5b83\u672c\u8eab\u5e76\u975e\u4e07\u7075\u836f\u3002\u8ba9\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u53ef\u80fd\u53d1\u751f\u7684\u3001\u975e\u5e38\u5fae\u5999\u7684\u6570\u636e\u635f\u574f\u6848\u4f8b\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_32","title":"\u6b63\u597d\u6267\u884c\u4e00\u6b21\u64cd\u4f5c","text":"<p>\u5728\u5904\u7406\u6d88\u606f\u65f6\u51fa\u73b0\u95ee\u9898\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u653e\u5f03\uff08\u4e22\u5f03\u6d88\u606f \u2014\u2014 \u5bfc\u81f4\u6570\u636e\u4e22\u5931\uff09\u6216\u91cd\u8bd5\u3002</p> <ul> <li>\u91cd\u8bd5\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6d88\u606f\u5c31\u88ab\u5904\u7406\u4e86\u4e24\u6b21\uff1a\u4f46\u4e3a\u540c\u6837\u7684\u670d\u52a1\u5411\u5ba2\u6237\u6536\u8d39\u4e24\u6b21\uff08\u6536\u8d39\u592a\u591a\uff09\u6216\u589e\u957f\u8ba1\u6570\u5668\u4e24\u6b21\uff08\u5938\u5927\u6307\u6807\uff09\u662f\u4e0d\u53ef\u63a5\u53d7\u7684\u3002</li> </ul> <p>\u6070\u597d\u4e00\u6b21\u610f\u5473\u7740\u5b89\u6392\u8ba1\u7b97\uff0c\u4f7f\u5f97\u6700\u7ec8\u6548\u679c\u4e0e\u6ca1\u6709\u53d1\u751f\u9519\u8bef\u7684\u60c5\u51b5\u4e00\u6837\uff0c\u5373\u4f7f\u64cd\u4f5c\u5b9e\u9645\u4e0a\u56e0\u4e3a\u67d0\u79cd\u9519\u8bef\u800c\u91cd\u8bd5\u3002</p> <ul> <li>\u6700\u6709\u6548\u7684\u65b9\u6cd5\u4e4b\u4e00\u662f\u4f7f\u64cd\u4f5c \u5e42\u7b49\uff08idempotent\uff09\uff1a\u786e\u4fdd\u5b83\u65e0\u8bba\u662f\u6267\u884c\u4e00\u6b21\u8fd8\u662f\u6267\u884c\u591a\u6b21\u90fd\u5177\u6709\u76f8\u540c\u7684\u6548\u679c\u3002</li> <li>\u5c06\u4e0d\u662f\u5929\u751f\u5e42\u7b49\u7684\u64cd\u4f5c\u53d8\u4e3a\u5e42\u7b49\u7684\u64cd\u4f5c\u9700\u8981\u4e00\u4e9b\u989d\u5916\u7684\u52aa\u529b\u4e0e\u5173\u6ce8\uff1a\u4f60\u53ef\u80fd\u9700\u8981\u7ef4\u62a4\u4e00\u4e9b\u989d\u5916\u7684\u5143\u6570\u636e\uff08\u4f8b\u5982\u66f4\u65b0\u4e86\u503c\u7684\u64cd\u4f5c ID \u96c6\u5408\uff09\uff0c\u5e76\u5728\u4ece\u4e00\u4e2a\u8282\u70b9\u6545\u969c\u5207\u6362\u81f3\u53e6\u4e00\u4e2a\u8282\u70b9\u65f6\u505a\u597d\u9632\u62a4\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_33","title":"\u6291\u5236\u91cd\u590d","text":"<p>\u9664\u4e86\u6d41\u5904\u7406\u4e4b\u5916\uff0c\u5176\u4ed6\u8bb8\u591a\u5730\u65b9\u4e5f\u9700\u8981\u6291\u5236\u91cd\u590d\u7684\u6a21\u5f0f\u3002</p> <ul> <li>\u4f8b\u5982\uff0cTCP \u4f7f\u7528\u4e86\u6570\u636e\u5305\u4e0a\u7684\u5e8f\u5217\u53f7\uff0c\u4ee5\u4fbf\u63a5\u6536\u65b9\u53ef\u4ee5\u5c06\u5b83\u4eec\u6b63\u786e\u6392\u5e8f\uff0c\u5e76\u786e\u5b9a\u7f51\u7edc\u4e0a\u662f\u5426\u6709\u6570\u636e\u5305\u4e22\u5931\u6216\u91cd\u590d\u3002\u5728\u5c06\u6570\u636e\u4ea4\u4ed8\u5e94\u7528\u524d\uff0cTCP \u534f\u8bae\u6808\u4f1a\u91cd\u65b0\u4f20\u8f93\u4efb\u4f55\u4e22\u5931\u7684\u6570\u636e\u5305\uff0c\u4e5f\u4f1a\u79fb\u9664\u4efb\u4f55\u91cd\u590d\u7684\u6570\u636e\u5305\u3002</li> </ul> <p>\u4f46\u662f\uff0c\u8fd9\u79cd\u91cd\u590d\u6291\u5236\u4ec5\u9002\u7528\u4e8e\u5355\u6761 TCP \u8fde\u63a5\u7684\u573a\u666f\u4e2d\u3002\u5047\u8bbe TCP \u8fde\u63a5\u662f\u4e00\u4e2a\u5ba2\u6237\u7aef\u4e0e\u6570\u636e\u5e93\u7684\u8fde\u63a5\uff0c\u5e76\u4e14\u5b83\u6b63\u5728\u6267\u884c\u4e0b\u4f8b\u4e2d\u7684\u4e8b\u52a1\u3002</p> <ul> <li>\u5728\u8bb8\u591a\u6570\u636e\u5e93\u4e2d\uff0c\u4e8b\u52a1\u662f\u7ed1\u5b9a\u5728\u5ba2\u6237\u7aef\u8fde\u63a5\u4e0a\u7684\uff08\u5982\u679c\u5ba2\u6237\u7aef\u53d1\u9001\u4e86\u591a\u4e2a\u67e5\u8be2\uff0c\u6570\u636e\u5e93\u5c31\u77e5\u9053\u5b83\u4eec\u5c5e\u4e8e\u540c\u4e00\u4e2a\u4e8b\u52a1\uff0c\u56e0\u4e3a\u5b83\u4eec\u662f\u5728\u540c\u4e00\u4e2a TCP \u8fde\u63a5\u4e0a\u53d1\u9001\u7684\uff09\u3002</li> </ul> <p>\u4f8b 12-1 \u8d44\u91d1\u4ece\u4e00\u4e2a\u8d26\u6237\u5230\u53e6\u4e00\u4e2a\u8d26\u6237\u7684\u975e\u5e42\u7b49\u8f6c\u79fb</p> <pre><code>BEGIN TRANSACTION;\n    UPDATE accounts SET balance = balance + 11.00 WHERE account_id = 1234;\n    UPDATE accounts SET balance = balance - 11.00 WHERE account_id = 4321;\nCOMMIT;\n</code></pre> <p>\u5982\u679c\u5ba2\u6237\u7aef\u5728\u53d1\u9001 <code>COMMIT</code> \u4e4b\u540e\u5e76\u5728\u4ece\u6570\u636e\u5e93\u670d\u52a1\u5668\u6536\u5230\u54cd\u5e94\u4e4b\u524d\u9047\u5230\u7f51\u7edc\u4e2d\u65ad\u4e0e\u8fde\u63a5\u8d85\u65f6\uff0c\u5ba2\u6237\u7aef\u662f\u4e0d\u77e5\u9053\u4e8b\u52a1\u662f\u5426\u5df2\u7ecf\u88ab\u63d0\u4ea4\u7684\uff08\u56fe 8-1\uff09\u3002\u5ba2\u6237\u7aef\u53ef\u4ee5\u91cd\u8fde\u5230\u6570\u636e\u5e93\u5e76\u91cd\u8bd5\u4e8b\u52a1\uff0c\u4f46\u5df2\u7ecf\u5904\u4e8e TCP \u91cd\u590d\u6291\u5236\u7684\u8303\u56f4\u4e4b\u5916\u3002</p> <p>\u56e0\u4e3a \u4f8b 12-1 \u4e2d\u7684\u4e8b\u52a1\u4e0d\u662f\u5e42\u7b49\u7684\uff0c\u53ef\u80fd\u4f1a\u53d1\u751f\u8f6c\u4e86 22 \u800c\u4e0d\u662f\u671f\u671b\u7684 11\u3002\u5c3d\u7ba1\u8be5\u793a\u4f8b\u662f\u4e00\u4e2a\u4e8b\u52a1\u539f\u5b50\u6027\u7684\u6807\u51c6\u6837\u4f8b\uff0c\u4f46\u5b83\u5b9e\u9645\u4e0a\u5e76\u4e0d\u6b63\u786e\uff0c\u800c\u771f\u6b63\u7684\u94f6\u884c\u5e76\u4e0d\u4f1a\u8fd9\u6837\u529e\u4e8b\u30103\u3011\u3002</p> <p>\u4e24\u9636\u6bb5\u63d0\u4ea4\u534f\u8bae\u4f1a\u7834\u574f TCP \u8fde\u63a5\u4e0e\u4e8b\u52a1\u4e4b\u95f4\u7684 1:1 \u6620\u5c04\uff0c\u56e0\u4e3a\u5b83\u4eec\u5fc5\u987b\u5728\u6545\u969c\u540e\u5141\u8bb8\u4e8b\u52a1\u534f\u8c03\u5668\u91cd\u8fde\u5230\u6570\u636e\u5e93\uff0c\u544a\u8bc9\u6570\u636e\u5e93\u5c06\u5b58\u7591\u4e8b\u52a1\u63d0\u4ea4\u8fd8\u662f\u4e2d\u6b62\u3002\u8fd9\u8db3\u4ee5\u786e\u4fdd\u4e8b\u52a1\u53ea\u88ab\u6070\u597d\u6267\u884c\u4e00\u6b21\u5417\uff1f\u4e0d\u5e78\u7684\u662f\uff0c\u5e76\u4e0d\u80fd\u3002</p> <p>\u5373\u4f7f\u6211\u4eec\u53ef\u4ee5\u6291\u5236\u6570\u636e\u5e93\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u91cd\u590d\u4e8b\u52a1\uff0c\u6211\u4eec\u4ecd\u7136\u9700\u8981\u62c5\u5fc3\u7ec8\u7aef\u7528\u6237\u8bbe\u5907\u4e0e\u5e94\u7528\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u7f51\u7edc\u3002\u4f8b\u5982\uff0c\u5ba2\u6237\u7aefWeb\u6d4f\u89c8\u5668\u6210\u529f\u5730\u53d1\u9001\u4e86 POST\uff0c\u4f46\u5374\u5728\u80fd\u591f\u4ece\u670d\u52a1\u5668\u63a5\u6536\u54cd\u5e94\u4e4b\u524d\u6ca1\u4e86\u4fe1\u53f7\uff1a</p> <ul> <li>\u53ef\u80fd\u4f1a\u5411\u7528\u6237\u663e\u793a\u9519\u8bef\u6d88\u606f\uff0c\u800c\u5ba2\u6237\u53ef\u80fd\u4f1a\u624b\u52a8\u91cd\u8bd5\u3002\u4ece Web \u670d\u52a1\u5668\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u91cd\u8bd5\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u8bf7\u6c42\uff1b\u4ece\u6570\u636e\u5e93\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u8fd9\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u4e8b\u52a1\u3002\u901a\u5e38\u7684\u9664\u91cd\u673a\u5236\u65e0\u6d4e\u4e8e\u4e8b\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_34","title":"\u64cd\u4f5c\u6807\u8bc6\u7b26","text":"<p>\u8981\u5728\u901a\u8fc7\u51e0\u8df3\u7684\u7f51\u7edc\u901a\u4fe1\u4e0a\u4f7f\u64cd\u4f5c\u5177\u6709\u5e42\u7b49\u6027\uff0c\u4ec5\u4ec5\u4f9d\u8d56\u6570\u636e\u5e93\u63d0\u4f9b\u7684\u4e8b\u52a1\u673a\u5236\u662f\u4e0d\u591f\u7684 \u2014\u2014 \u4f60\u9700\u8981\u8003\u8651 \u7aef\u5230\u7aef\uff08end-to-end\uff09 \u7684\u8bf7\u6c42\u6d41\u3002 </p> <ul> <li>\u53ef\u4ee5\u4e3a\u64cd\u4f5c\u751f\u6210\u4e00\u4e2a\u552f\u4e00\u7684\u6807\u8bc6\u7b26\uff08\u4f8b\u5982 UUID\uff09\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3a\u9690\u85cf\u8868\u5355\u5b57\u6bb5\u5305\u542b\u5728\u5ba2\u6237\u7aef\u5e94\u7528\u4e2d\uff0c\u6216\u901a\u8fc7\u8ba1\u7b97\u6240\u6709\u8868\u5355\u76f8\u5173\u5b57\u6bb5\u7684\u6563\u5217\u6765\u751f\u6210\u64cd\u4f5c ID \u30103\u3011\u3002</li> <li>\u5982\u679c Web \u6d4f\u89c8\u5668\u63d0\u4ea4\u4e86\u4e24\u6b21 POST \u8bf7\u6c42\uff0c\u8fd9\u4e24\u4e2a\u8bf7\u6c42\u5c06\u5177\u6709\u76f8\u540c\u7684\u64cd\u4f5c ID\u3002\u7136\u540e\uff0c\u4f60\u53ef\u4ee5\u5c06\u8be5\u64cd\u4f5c ID \u4e00\u8def\u4f20\u9012\u5230\u6570\u636e\u5e93\uff0c\u5e76\u68c0\u67e5\u4f60\u662f\u5426\u66fe\u7ecf\u4f7f\u7528\u7ed9\u5b9a\u7684 ID \u6267\u884c\u8fc7\u4e00\u4e2a\u64cd\u4f5c\u3002</li> </ul> <p>\u4f8b 12-2 \u4f7f\u7528\u552f\u4e00 ID \u6765\u6291\u5236\u91cd\u590d\u8bf7\u6c42</p> <pre><code>ALTER TABLE requests ADD UNIQUE (request_id);\n\nBEGIN TRANSACTION;\n    INSERT INTO requests\n        (request_id, from_account, to_account, amount)\n        VALUES('0286FDB8-D7E1-423F-B40B-792B3608036C', 4321, 1234, 11.00);\n    UPDATE accounts SET balance = balance + 11.00 WHERE account_id = 1234;\n    UPDATE accounts SET balance = balance - 11.00 WHERE account_id = 4321;\nCOMMIT;\n</code></pre> <p>\u4e0a\u4f8b\u4f9d\u8d56\u4e8e <code>request_id</code> \u5217\u4e0a\u7684\u552f\u4e00\u7ea6\u675f\u3002\u5982\u679c\u4e00\u4e2a\u4e8b\u52a1\u5c1d\u8bd5\u63d2\u5165\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684 ID\uff0c\u90a3\u4e48 <code>INSERT</code> \u5931\u8d25\uff0c\u4e8b\u52a1\u88ab\u4e2d\u6b62\uff0c\u4f7f\u5176\u65e0\u6cd5\u751f\u6548\u4e24\u6b21\u3002\u5373\u4f7f\u5728\u8f83\u5f31\u7684\u9694\u79bb\u7ea7\u522b\u4e0b\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u4e5f\u80fd\u6b63\u786e\u5730\u7ef4\u62a4\u552f\u4e00\u6027\u7ea6\u675f\uff08\u800c\u5728 \u201c\u5199\u5165\u504f\u5dee\u4e0e\u5e7b\u8bfb\u201d \u4e2d\u8ba8\u8bba\u8fc7\uff0c\u5e94\u7528\u7ea7\u522b\u7684 \u68c0\u67e5 - \u7136\u540e - \u63d2\u5165 \u53ef\u80fd\u4f1a\u5728\u4e0d\u53ef\u4e32\u884c\u5316\u7684\u9694\u79bb\u4e0b\u5931\u8d25\uff09\u3002</p> <p>\u9664\u4e86\u6291\u5236\u91cd\u590d\u7684\u8bf7\u6c42\u4e4b\u5916\uff0c\u4e0a\u4f8b\u7684\u8bf7\u6c42\u8868\u8868\u73b0\u5f97\u5c31\u50cf\u4e00\u79cd\u4e8b\u4ef6\u65e5\u5fd7\uff0c\u6697\u793a\u7740\u4e8b\u4ef6\u6eaf\u6e90\u7684\u60f3\u6cd5\u3002\u66f4\u65b0\u8d26\u6237\u4f59\u989d\u4e8b\u5b9e\u4e0a\u4e0d\u5fc5\u4e0e\u63d2\u5165\u4e8b\u4ef6\u53d1\u751f\u5728\u540c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\uff0c\u56e0\u4e3a\u5b83\u4eec\u662f\u5197\u4f59\u7684\uff0c\u800c\u80fd\u7531\u4e0b\u6e38\u6d88\u8d39\u8005\u4ece\u8bf7\u6c42\u4e8b\u4ef6\u4e2d\u884d\u751f\u51fa\u6765 \u2014\u2014 \u53ea\u8981\u8be5\u4e8b\u4ef6\u88ab\u6070\u597d\u5904\u7406\u4e00\u6b21\uff0c\u8fd9\u53c8\u4e00\u6b21\u53ef\u4ee5\u4f7f\u7528\u8bf7\u6c42 ID \u6765\u5f3a\u5236\u6267\u884c\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_35","title":"\u7aef\u5230\u7aef\u539f\u5219","text":"<p>\u6291\u5236\u91cd\u590d\u4e8b\u52a1\u7684\u8fd9\u79cd\u60c5\u51b5\u53ea\u662f\u4e00\u4e2a\u66f4\u666e\u904d\u7684\u539f\u5219\u7684\u4e00\u4e2a\u4f8b\u5b50\uff0c\u8fd9\u4e2a\u539f\u5219\u88ab\u79f0\u4e3a \u7aef\u5230\u7aef\u539f\u5219\uff08end-to-end argument\uff09\uff0c\u5b83\u5728 1984 \u5e74\u7531 Saltzer\u3001Reed \u548c Clark \u9610\u8ff0\u301055\u3011\uff1a</p> <p>\u53ea\u6709\u5728\u901a\u4fe1\u7cfb\u7edf\u4e24\u7aef\u5e94\u7528\u7684\u77e5\u8bc6\u4e0e\u5e2e\u52a9\u4e0b\uff0c\u6240\u8ba8\u8bba\u7684\u529f\u80fd\u624d\u80fd\u5b8c\u5168\u5730\u6b63\u786e\u5730\u5b9e\u73b0\u3002\u56e0\u800c\u5c06\u8fd9\u79cd\u88ab\u8d28\u7591\u7684\u529f\u80fd\u4f5c\u4e3a\u901a\u4fe1\u7cfb\u7edf\u672c\u8eab\u7684\u529f\u80fd\u662f\u4e0d\u53ef\u80fd\u7684\uff08\u6709\u65f6\uff0c\u901a\u4fe1\u7cfb\u7edf\u53ef\u4ee5\u63d0\u4f9b\u8fd9\u79cd\u529f\u80fd\u7684\u4e0d\u5b8c\u5907\u7248\u672c\uff0c\u53ef\u80fd\u6709\u52a9\u4e8e\u63d0\u9ad8\u6027\u80fd\uff09\u3002</p> <p>\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d \u6240\u8ba8\u8bba\u7684\u529f\u80fd \u662f\u91cd\u590d\u6291\u5236\u3002\u6211\u4eec\u770b\u5230 TCP \u5728 TCP \u8fde\u63a5\u5c42\u6b21\u6291\u5236\u4e86\u91cd\u590d\u7684\u6570\u636e\u5305\uff0c\u4e00\u4e9b\u6d41\u5904\u7406\u5668\u5728\u6d88\u606f\u5904\u7406\u5c42\u6b21\u63d0\u4f9b\u4e86\u6240\u8c13\u7684\u6070\u597d\u4e00\u6b21\u8bed\u4e49\uff0c\u4f46\u8fd9\u4e9b\u90fd\u65e0\u6cd5\u963b\u6b62\u5f53\u4e00\u4e2a\u8bf7\u6c42\u8d85\u65f6\u65f6\uff0c\u7528\u6237\u4eb2\u81ea\u63d0\u4ea4\u91cd\u590d\u7684\u8bf7\u6c42\u3002</p> <ul> <li>TCP\uff0c\u6570\u636e\u5e93\u4e8b\u52a1\uff0c\u4ee5\u53ca\u6d41\u5904\u7406\u5668\u672c\u8eab\u5e76\u4e0d\u80fd\u5b8c\u5168\u6392\u9664\u8fd9\u4e9b\u91cd\u590d\u3002</li> <li>\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u9700\u8981\u4e00\u4e2a\u7aef\u5230\u7aef\u7684\u89e3\u51b3\u65b9\u6848\uff1a\u4ece\u7ec8\u7aef\u7528\u6237\u7684\u5ba2\u6237\u7aef\u4e00\u8def\u4f20\u9012\u5230\u6570\u636e\u5e93\u7684\u4e8b\u52a1\u6807\u8bc6\u7b26\u3002</li> </ul> <p>\u7aef\u5230\u7aef\u539f\u5219\u4e5f\u9002\u7528\u4e8e\u68c0\u67e5\u6570\u636e\u7684\u5b8c\u6574\u6027\uff1a\u4ee5\u592a\u7f51\uff0cTCP \u548c TLS \u4e2d\u5185\u7f6e\u7684\u6821\u9a8c\u548c\u53ef\u4ee5\u68c0\u6d4b\u7f51\u7edc\u4e2d\u6570\u636e\u5305\u7684\u635f\u574f\u60c5\u51b5\uff0c\u4f46\u662f\u5b83\u4eec\u65e0\u6cd5\u68c0\u6d4b\u5230\u7531\u8fde\u63a5\u4e24\u7aef\u53d1\u9001 / \u63a5\u6536\u8f6f\u4ef6\u4e2d Bug \u5bfc\u81f4\u7684\u635f\u574f\u3002\u6216\u6570\u636e\u5b58\u50a8\u6240\u5728\u78c1\u76d8\u4e0a\u7684\u635f\u574f\u3002</p> <p>\u7c7b\u4f3c\u7684\u539f\u5219\u4e5f\u9002\u7528\u4e8e\u52a0\u5bc6\u301055\u3011\uff1a\u5bb6\u5ead WiFi \u7f51\u7edc\u4e0a\u7684\u5bc6\u7801\u53ef\u4ee5\u9632\u6b62\u4eba\u4eec\u7a83\u542c\u4f60\u7684 WiFi \u6d41\u91cf\uff0c\u4f46\u65e0\u6cd5\u963b\u6b62\u4e92\u8054\u7f51\u4e0a\u5176\u4ed6\u5730\u65b9\u653b\u51fb\u8005\u7684\u7aa5\u63a2\uff1b\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u5668\u4e4b\u95f4\u7684 TLS/SSL \u53ef\u4ee5\u963b\u6321\u7f51\u7edc\u653b\u51fb\u8005\uff0c\u4f46\u65e0\u6cd5\u963b\u6b62\u6076\u610f\u670d\u52a1\u5668\u3002</p> <p>\u5c3d\u7ba1\u4f4e\u5c42\u7ea7\u7684\u529f\u80fd\uff08TCP \u91cd\u590d\u6291\u5236\u3001\u4ee5\u592a\u7f51\u6821\u9a8c\u548c\u3001WiFi \u52a0\u5bc6\uff09\u65e0\u6cd5\u5355\u72ec\u63d0\u4f9b\u6240\u9700\u7684\u7aef\u5230\u7aef\u529f\u80fd\uff0c\u4f46\u5b83\u4eec\u4ecd\u7136\u5f88\u6709\u7528\uff0c\u56e0\u4e3a\u5b83\u4eec\u80fd\u964d\u4f4e\u8f83\u9ad8\u5c42\u7ea7\u51fa\u73b0\u95ee\u9898\u7684\u53ef\u80fd\u6027\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u6ca1\u6709 TCP \u6765\u5c06\u6570\u636e\u5305\u6392\u6210\u6b63\u786e\u7684\u987a\u5e8f\uff0c\u90a3\u4e48 HTTP \u8bf7\u6c42\u901a\u5e38\u5c31\u4f1a\u88ab\u6405\u70c2\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_36","title":"\u5728\u6570\u636e\u7cfb\u7edf\u4e2d\u5e94\u7528\u7aef\u5230\u7aef\u601d\u8003","text":"<p>\u5e26\u56de\u6700\u521d\u7684\u8bba\u70b9\uff1a\u4ec5\u4ec5\u56e0\u4e3a\u5e94\u7528\u4f7f\u7528\u4e86\u63d0\u4f9b\u76f8\u5bf9\u8f83\u5f3a\u5b89\u5168\u5c5e\u6027\u7684\u6570\u636e\u7cfb\u7edf\uff0c\u4f8b\u5982\u53ef\u4e32\u884c\u5316\u7684\u4e8b\u52a1\uff0c\u5e76\u4e0d\u610f\u5473\u7740\u5e94\u7528\u7684\u6570\u636e\u5c31\u4e0d\u4f1a\u4e22\u5931\u6216\u635f\u574f\u4e86\u3002\u5e94\u7528\u672c\u8eab\u4e5f\u9700\u8981\u91c7\u53d6\u7aef\u5230\u7aef\u7684\u63aa\u65bd\uff0c\u4f8b\u5982\u9664\u91cd\u3002</p> <p>\u8fd9\u5b9e\u5728\u662f\u4e00\u4e2a\u9057\u61be\uff0c\u56e0\u4e3a\u5bb9\u9519\u673a\u5236\u5f88\u96be\u5f04\u597d\u3002</p> <ul> <li>\u4f4e\u5c42\u7ea7\u7684\u53ef\u9760\u673a\u5236\uff08\u6bd4\u5982 TCP \u4e2d\u7684\u90a3\u4e9b\uff09\u8fd0\u884c\u7684\u76f8\u5f53\u597d\uff0c\u56e0\u800c\u5269\u4e0b\u7684\u9ad8\u5c42\u7ea7\u9519\u8bef\u57fa\u672c\u5f88\u5c11\u51fa\u73b0\u3002</li> <li>\u8fd8\u6ca1\u6709\u627e\u5230\u5c06\u8fd9\u4e9b\u5269\u4e0b\u7684\u9ad8\u5c42\u7ea7\u5bb9\u9519\u673a\u5236\u6253\u5305\u6210\u62bd\u8c61\uff0c\u800c\u5e94\u7528\u4e0d\u9700\u8981\u518d\u53bb\u64cd\u5fc3\u7684\u65b9\u6848\u3002</li> </ul> <p>\u957f\u671f\u4ee5\u6765\uff0c\u4e8b\u52a1\u88ab\u8ba4\u4e3a\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u62bd\u8c61\uff0c\u5c06\u5404\u79cd\u53ef\u80fd\u7684\u95ee\u9898\uff08\u5e76\u53d1\u5199\u5165\u3001\u8fdd\u80cc\u7ea6\u675f\u3001\u5d29\u6e83\u3001\u7f51\u7edc\u4e2d\u65ad\u3001\u78c1\u76d8\u6545\u969c\uff09\u5408\u5e76\u4e3a\u4e24\u79cd\u53ef\u80fd\u7ed3\u679c\uff1a\u63d0\u4ea4\u6216\u4e2d\u6b62\u3002\u8fd9\u662f\u5bf9\u7f16\u7a0b\u6a21\u578b\u800c\u8a00\u662f\u4e00\u79cd\u5de8\u5927\u7684\u7b80\u5316\uff0c\u4f46\u6050\u6015\u8fd9\u8fd8\u4e0d\u591f\u3002</p> <p>\u62d2\u7edd\u4f7f\u7528\u5206\u5e03\u5f0f\u4e8b\u52a1\u662f\u56e0\u4e3a\u5b83\u5f00\u9500\u592a\u5927\uff0c\u7ed3\u679c\u6211\u4eec\u6700\u540e\u4e0d\u5f97\u4e0d\u5728\u5e94\u7528\u4ee3\u7801\u4e2d\u91cd\u65b0\u5b9e\u73b0\u5bb9\u9519\u673a\u5236\u3002</p> <ul> <li>\u5bf9\u5e76\u53d1\u6027\u4e0e\u90e8\u5206\u5931\u8d25\u7684\u63a8\u7406\u662f\u56f0\u96be\u4e14\u8fdd\u53cd\u76f4\u89c9\u7684\uff0c\u6240\u4ee5\u6211\u6000\u7591\u5927\u591a\u6570\u5e94\u7528\u7ea7\u522b\u7684\u673a\u5236\u90fd\u4e0d\u80fd\u6b63\u786e\u5de5\u4f5c\uff0c\u6700\u7ec8\u7ed3\u679c\u662f\u6570\u636e\u4e22\u5931\u6216\u635f\u574f\u3002</li> </ul> <p>\u51fa\u4e8e\u8fd9\u4e9b\u539f\u56e0\uff0c\u6211\u8ba4\u4e3a\u63a2\u7d22\u5bf9\u5bb9\u9519\u7684\u62bd\u8c61\u662f\u5f88\u6709\u4ef7\u503c\u7684\u3002\u5b83\u4f7f\u63d0\u4f9b\u5e94\u7528\u7279\u5b9a\u7684\u7aef\u5230\u7aef\u7684\u6b63\u786e\u6027\u5c5e\u6027\u53d8\u5f97\u66f4\u7b80\u5355\uff0c\u800c\u4e14\u8fd8\u80fd\u5728\u5927\u89c4\u6a21\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\u63d0\u4f9b\u826f\u597d\u7684\u6027\u80fd\u4e0e\u8fd0\u7ef4\u7279\u6027\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_37","title":"\u5f3a\u5236\u7ea6\u675f","text":"<p>\u8ba9\u6211\u4eec\u601d\u8003\u4e00\u4e0b\u5728 \u5206\u62c6\u6570\u636e\u5e93 \u4e0a\u4e0b\u6587\u4e2d\u7684 \u6b63\u786e\u6027\u3002\u7aef\u5230\u7aef\u7684\u9664\u91cd\u53ef\u4ee5\u901a\u8fc7\u4ece\u5ba2\u6237\u7aef\u4e00\u8def\u900f\u4f20\u5230\u6570\u636e\u5e93\u7684\u8bf7\u6c42 ID \u5b9e\u73b0\u3002\u90a3\u4e48\u5176\u4ed6\u7c7b\u578b\u7684\u7ea6\u675f\u5462\uff1f</p> <p>\u5148\u6765\u7279\u522b\u5173\u6ce8\u4e00\u4e0b\u552f\u4e00\u6027\u7ea6\u675f\uff1a\u5982\uff0c\u7528\u6237\u540d\u6216\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u5fc5\u987b\u552f\u4e00\u6807\u8bc6\u7528\u6237\uff0c\u6587\u4ef6\u5b58\u50a8\u670d\u52a1\u4e0d\u80fd\u5305\u542b\u591a\u4e2a\u91cd\u540d\u6587\u4ef6\u7b49\u3002</p> <ul> <li>\u5176\u4ed6\u7c7b\u578b\u7684\u7ea6\u675f\u4e5f\u975e\u5e38\u7c7b\u4f3c\uff1a\u4f8b\u5982\uff0c\u786e\u4fdd\u5e10\u6237\u4f59\u989d\u6c38\u8fdc\u4e0d\u4f1a\u53d8\u4e3a\u8d1f\u6570\uff0c\u786e\u4fdd\u4e0d\u4f1a\u8d85\u5356\u5e93\u5b58\uff0c\u6216\u8005\u4f1a\u8bae\u5ba4\u6ca1\u6709\u91cd\u590d\u7684\u9884\u8ba2\u3002\u6267\u884c\u552f\u4e00\u6027\u7ea6\u675f\u7684\u6280\u672f\u901a\u5e38\u4e5f\u53ef\u4ee5\u7528\u4e8e\u8fd9\u4e9b\u7ea6\u675f\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_38","title":"\u552f\u4e00\u6027\u7ea6\u675f\u9700\u8981\u8fbe\u6210\u5171\u8bc6","text":"<p>\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\uff0c\u5f3a\u5236\u6267\u884c\u552f\u4e00\u6027\u7ea6\u675f\u9700\u8981\u5171\u8bc6\uff1a\u5982\u679c\u5b58\u5728\u591a\u4e2a\u5177\u6709\u76f8\u540c\u503c\u7684\u5e76\u53d1\u8bf7\u6c42\uff0c\u5219\u7cfb\u7edf\u9700\u8981\u51b3\u5b9a\u51b2\u7a81\u64cd\u4f5c\u4e2d\u7684\u54ea\u4e00\u4e2a\u88ab\u63a5\u53d7\uff0c\u5e76\u62d2\u7edd\u5176\u4ed6\u8fdd\u80cc\u7ea6\u675f\u7684\u64cd\u4f5c\u3002</p> <ul> <li>\u8fbe\u6210\u8fd9\u4e00\u5171\u8bc6\u7684\u6700\u5e38\u89c1\u65b9\u5f0f\u662f\u4f7f\u5355\u4e2a\u8282\u70b9\u4f5c\u4e3a\u9886\u5bfc\uff0c\u5e76\u4f7f\u5176\u8d1f\u8d23\u6240\u6709\u51b3\u7b56\u3002</li> <li>\u5982\u679c\u4f60\u9700\u8981\u5bb9\u5fcd\u9886\u5bfc\u8005\u5931\u6548\uff0c\u90a3\u4e48\u5c31\u53c8\u56de\u5230\u4e86\u5171\u8bc6\u95ee\u9898\uff08\u8bf7\u53c2\u9605 \u201c\u5355\u4e3b\u590d\u5236\u4e0e\u5171\u8bc6\u201d\uff09\u3002</li> </ul> <p>\u552f\u4e00\u6027\u68c0\u67e5\u53ef\u4ee5\u901a\u8fc7\u5bf9\u552f\u4e00\u6027\u5b57\u6bb5\u5206\u533a\u505a\u6a2a\u5411\u4f38\u7f29\u3002\u4f8b\u5982\uff0c\u5982\u679c\u9700\u8981\u901a\u8fc7\u8bf7\u6c42 ID \u786e\u4fdd\u552f\u4e00\u6027</p> <ul> <li>\u786e\u4fdd\u6240\u6709\u5177\u6709\u76f8\u540c\u8bf7\u6c42 ID \u7684\u8bf7\u6c42\u90fd\u88ab\u8def\u7531\u5230\u540c\u4e00\u5206\u533a\u3002\u8ba9\u7528\u6237\u540d\u662f\u552f\u4e00\uff0c\u5219\u53ef\u4ee5\u6309\u7528\u6237\u540d\u7684\u6563\u5217\u503c\u505a\u5206\u533a\u3002</li> </ul> <p>\u4f46\u5f02\u6b65\u591a\u4e3b\u590d\u5236\u6392\u9664\u5728\u5916\uff0c\u56e0\u4e3a\u53ef\u80fd\u4f1a\u53d1\u751f\u4e0d\u540c\u4e3b\u5e93\u540c\u65f6\u63a5\u53d7\u51b2\u7a81\u5199\u64cd\u4f5c\u7684\u60c5\u51b5\uff0c\u56e0\u800c\u8fd9\u4e9b\u503c\u4e0d\u518d\u662f\u552f\u4e00\u7684\u3002</p> <ul> <li>\u5982\u679c\u4f60\u60f3\u7acb\u523b\u62d2\u7edd\u4efb\u4f55\u8fdd\u80cc\u7ea6\u675f\u7684\u5199\u5165\uff0c\u540c\u6b65\u534f\u8c03\u662f\u65e0\u6cd5\u907f\u514d\u7684\u301056\u3011\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_39","title":"\u57fa\u4e8e\u65e5\u5fd7\u6d88\u606f\u4f20\u9012\u4e2d\u7684\u552f\u4e00\u6027","text":"<p>\u65e5\u5fd7\u786e\u4fdd\u6240\u6709\u6d88\u8d39\u8005\u4ee5\u76f8\u540c\u7684\u987a\u5e8f\u770b\u89c1\u6d88\u606f \u2014\u2014 \u8fd9\u79cd\u4fdd\u8bc1\u5728\u5f62\u5f0f\u4e0a\u88ab\u79f0\u4e3a \u5168\u5e8f\u5e7f\u64ad\uff08total order boardcast\uff09 \u5e76\u4e14\u7b49\u4ef7\u4e8e\u5171\u8bc6\u3002\u5728\u4f7f\u7528\u57fa\u4e8e\u65e5\u5fd7\u7684\u6d88\u606f\u4f20\u9012\u7684\u5206\u62c6\u6570\u636e\u5e93\u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u975e\u5e38\u7c7b\u4f3c\u7684\u65b9\u6cd5\u6765\u6267\u884c\u552f\u4e00\u6027\u7ea6\u675f\u3002</p> <p>\u6d41\u5904\u7406\u5668\u5728\u5355\u4e2a\u7ebf\u7a0b\u4e0a\u4f9d\u6b21\u6d88\u8d39\u5355\u4e2a\u65e5\u5fd7\u5206\u533a\u4e2d\u7684\u6240\u6709\u6d88\u606f\u3002\u56e0\u6b64\uff0c\u5982\u679c\u65e5\u5fd7\u662f\u6309\u9700\u8981\u786e\u4fdd\u552f\u4e00\u7684\u503c\u505a\u7684\u5206\u533a\uff0c\u5219\u6d41\u5904\u7406\u5668\u53ef\u4ee5\u65e0\u6b67\u4e49\u5730\u3001\u786e\u5b9a\u6027\u5730\u51b3\u5b9a\u51e0\u4e2a\u51b2\u7a81\u64cd\u4f5c\u4e2d\u7684\u54ea\u4e00\u4e2a\u5148\u5230\u8fbe\u3002\u4f8b\u5982\uff0c\u5728\u591a\u4e2a\u7528\u6237\u5c1d\u8bd5\u5ba3\u544a\u76f8\u540c\u7528\u6237\u540d\u7684\u60c5\u51b5\u4e0b\u301057\u3011\uff1a</p> <ul> <li>\u6bcf\u4e2a\u5bf9\u7528\u6237\u540d\u7684\u8bf7\u6c42\u90fd\u88ab\u7f16\u7801\u4e3a\u4e00\u6761\u6d88\u606f\uff0c\u5e76\u8ffd\u52a0\u5230\u6309\u7528\u6237\u540d\u6563\u5217\u503c\u786e\u5b9a\u7684\u5206\u533a\u3002</li> <li>\u6d41\u5904\u7406\u5668\u4f9d\u5e8f\u8bfb\u53d6\u65e5\u5fd7\u4e2d\u7684\u8bf7\u6c42\uff0c\u5e76\u4f7f\u7528\u672c\u5730\u6570\u636e\u5e93\u6765\u8ffd\u8e2a\u54ea\u4e9b\u7528\u6237\u540d\u5df2\u7ecf\u88ab\u5360\u7528\u4e86\u3002</li> <li>\u5bf9\u4e8e\u6240\u6709\u7533\u8bf7\u53ef\u7528\u7528\u6237\u540d\u7684\u8bf7\u6c42\uff0c\u5b83\u90fd\u4f1a\u8bb0\u5f55\u8be5\u7528\u6237\u540d\uff0c\u5e76\u5411\u8f93\u51fa\u6d41\u53d1\u9001\u4e00\u6761\u6210\u529f\u6d88\u606f\u3002</li> <li>\u5bf9\u4e8e\u6240\u6709\u7533\u8bf7\u5df2\u5360\u7528\u7528\u6237\u540d\u7684\u8bf7\u6c42\uff0c\u5b83\u90fd\u4f1a\u5411\u8f93\u51fa\u6d41\u53d1\u9001\u4e00\u6761\u62d2\u7edd\u6d88\u606f\u3002</li> <li>\u8bf7\u6c42\u7528\u6237\u540d\u7684\u5ba2\u6237\u7aef\u76d1\u89c6\u8f93\u51fa\u6d41\uff0c\u7b49\u5f85\u4e0e\u5176\u8bf7\u6c42\u76f8\u5bf9\u5e94\u7684\u6210\u529f\u6216\u62d2\u7edd\u6d88\u606f\u3002</li> </ul> <p>\u8be5\u7b97\u6cd5\u57fa\u672c\u4e0a\u4e0e \u201c\u4f7f\u7528\u5168\u5e8f\u5e7f\u64ad\u5b9e\u73b0\u7ebf\u6027\u4e00\u81f4\u7684\u5b58\u50a8\u201d \u4e2d\u7684\u7b97\u6cd5\u76f8\u540c\u3002\u5b83\u53ef\u4ee5\u7b80\u5355\u5730\u901a\u8fc7\u589e\u52a0\u5206\u533a\u6570\u4f38\u7f29\u81f3\u8f83\u5927\u7684\u8bf7\u6c42\u541e\u5410\u91cf\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u5206\u533a\u90fd\u53ef\u4ee5\u88ab\u72ec\u7acb\u5904\u7406\u3002</p> <ul> <li>\u8be5\u65b9\u6cd5\u4e5f\u9002\u7528\u4e8e\u8bb8\u591a\u5176\u4ed6\u7c7b\u578b\u7684\u7ea6\u675f\uff1a\u57fa\u672c\u539f\u7406\u662f\uff0c\u4efb\u4f55\u53ef\u80fd\u51b2\u7a81\u7684\u5199\u5165\u90fd\u4f1a\u8def\u7531\u5230\u76f8\u540c\u7684\u5206\u533a\u5e76\u6309\u987a\u5e8f\u5904\u7406\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_40","title":"\u591a\u5206\u533a\u8bf7\u6c42\u5904\u7406","text":"<p>\u5f53\u6d89\u53ca\u591a\u4e2a\u5206\u533a\u65f6\uff0c\u786e\u4fdd\u64cd\u4f5c\u4ee5\u539f\u5b50\u65b9\u5f0f\u6267\u884c\u4e14\u540c\u65f6\u6ee1\u8db3\u7ea6\u675f\u5c31\u53d8\u5f97\u5f88\u6709\u8da3\u4e86\u3002\u5728 \u4f8b 12-2 \u4f7f\u7528\u552f\u4e00 ID \u6765\u6291\u5236\u91cd\u590d\u8bf7\u6c42\uff0c\u53ef\u80fd\u6709\u4e09\u4e2a\u5206\u533a\uff1a\u4e00\u4e2a\u5305\u542b\u8bf7\u6c42 ID\uff0c\u4e00\u4e2a\u5305\u542b\u6536\u6b3e\u4eba\u8d26\u6237\uff0c\u53e6\u4e00\u4e2a\u5305\u542b\u4ed8\u6b3e\u4eba\u8d26\u6237\u3002</p> <p>\u5728\u6570\u636e\u5e93\u7684\u4f20\u7edf\u65b9\u6cd5\u4e2d\uff0c\u6267\u884c\u6b64\u4e8b\u52a1\u9700\u8981\u8de8\u5168\u90e8\u4e09\u4e2a\u5206\u533a\u8fdb\u884c\u539f\u5b50\u63d0\u4ea4\uff0c\u5c31\u8fd9\u4e9b\u5206\u533a\u4e0a\u7684\u6240\u6709\u5176\u4ed6\u4e8b\u52a1\u800c\u8a00\uff0c\u8fd9\u5b9e\u8d28\u4e0a\u662f\u5c06\u8be5\u4e8b\u52a1\u5d4c\u5165\u4e00\u4e2a\u5168\u5e8f\u3002\u800c\u8fd9\u6837\u5c31\u8981\u6c42\u8de8\u5206\u533a\u534f\u8c03\uff0c\u4e0d\u540c\u7684\u5206\u533a\u65e0\u6cd5\u518d\u72ec\u7acb\u5730\u8fdb\u884c\u5904\u7406\uff0c\u56e0\u6b64\u541e\u5410\u91cf\u5f88\u53ef\u80fd\u4f1a\u53d7\u5230\u5f71\u54cd\u3002</p> <p>\u4f46\u4e8b\u5b9e\u8bc1\u660e\uff0c\u4f7f\u7528\u5206\u533a\u65e5\u5fd7\u53ef\u4ee5\u8fbe\u5230\u7b49\u4ef7\u7684\u6b63\u786e\u6027\u800c\u65e0\u9700\u539f\u5b50\u63d0\u4ea4\uff1a</p> <ol> <li>\u4ece\u8d26\u6237 A \u5411\u8d26\u6237 B \u8f6c\u8d26\u7684\u8bf7\u6c42\u7531\u5ba2\u6237\u7aef\u63d0\u4f9b\u4e00\u4e2a\u552f\u4e00\u7684\u8bf7\u6c42 ID\uff0c\u5e76\u6309\u8bf7\u6c42 ID \u8ffd\u52a0\u5199\u5165\u76f8\u5e94\u65e5\u5fd7\u5206\u533a\u3002</li> <li>\u6d41\u5904\u7406\u5668\u8bfb\u53d6\u8bf7\u6c42\u65e5\u5fd7\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8bf7\u6c42\u6d88\u606f\uff0c\u5b83\u5411\u8f93\u51fa\u6d41\u53d1\u51fa\u4e24\u6761\u6d88\u606f\uff1a\u4ed8\u6b3e\u4eba\u8d26\u6237 A \u7684\u501f\u8bb0\u6307\u4ee4\uff08\u6309 A \u5206\u533a\uff09\uff0c\u6536\u6b3e\u4eba B \u7684\u8d37\u8bb0\u6307\u4ee4\uff08\u6309 B \u5206\u533a\uff09\u3002\u88ab\u53d1\u51fa\u7684\u6d88\u606f\u4e2d\u4f1a\u5e26\u6709\u539f\u59cb\u7684\u8bf7\u6c42 ID\u3002</li> <li>\u540e\u7eed\u5904\u7406\u5668\u6d88\u8d39\u501f\u8bb0 / \u8d37\u8bb0\u6307\u4ee4\u6d41\uff0c\u6309\u7167\u8bf7\u6c42 ID \u9664\u91cd\uff0c\u5e76\u5c06\u53d8\u66f4\u5e94\u7528\u81f3\u8d26\u6237\u4f59\u989d\u3002</li> </ol> <p>\u6b65\u9aa4 1 \u548c\u6b65\u9aa4 2 \u662f\u5fc5\u8981\u7684\uff0c\u56e0\u4e3a\u5982\u679c\u5ba2\u6237\u76f4\u63a5\u53d1\u9001\u8d37\u8bb0\u4e0e\u501f\u8bb0\u6307\u4ee4\uff0c\u5219\u9700\u8981\u5728\u8fd9\u4e24\u4e2a\u5206\u533a\u4e4b\u95f4\u8fdb\u884c\u539f\u5b50\u63d0\u4ea4\uff0c\u4ee5\u786e\u4fdd\u4e24\u8005\u8981\u4e48\u90fd\u53d1\u751f\u6216\u90fd\u4e0d\u53d1\u751f\u3002\u4e3a\u4e86\u907f\u514d\u5bf9\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u9700\u8981\uff0c\u6211\u4eec\u9996\u5148\u5c06\u8bf7\u6c42\u6301\u4e45\u5316\u8bb0\u5f55\u4e3a\u5355\u6761\u6d88\u606f\uff0c\u7136\u540e\u4ece\u8fd9\u7b2c\u4e00\u6761\u6d88\u606f\u4e2d\u884d\u751f\u51fa\u8d37\u8bb0\u6307\u4ee4\u4e0e\u501f\u8bb0\u6307\u4ee4\u3002</p> <ul> <li>\u51e0\u4e4e\u5728\u6240\u6709\u6570\u636e\u7cfb\u7edf\u4e2d\uff0c\u5355\u5bf9\u8c61\u5199\u5165\u90fd\u662f\u539f\u5b50\u6027\u7684\uff0c\u56e0\u6b64\u8bf7\u6c42\u8981\u4e48\u51fa\u73b0\u5728\u65e5\u5fd7\u4e2d\uff0c\u8981\u4e48\u5c31\u4e0d\u51fa\u73b0\uff0c\u65e0\u9700\u591a\u5206\u533a\u539f\u5b50\u63d0\u4ea4\u3002</li> </ul> <p>\u5982\u679c\u6d41\u5904\u7406\u5668\u5728\u6b65\u9aa4 2 \u4e2d\u5d29\u6e83\uff0c\u5219\u5b83\u4f1a\u4ece\u4e0a\u4e00\u4e2a\u5b58\u6863\u70b9\u6062\u590d\u5904\u7406\u3002\u8fd9\u6837\u505a\u65f6\uff0c\u5b83\u4e0d\u4f1a\u8df3\u8fc7\u4efb\u4f55\u8bf7\u6c42\u6d88\u606f\uff0c\u4f46\u53ef\u80fd\u4f1a\u591a\u6b21\u5904\u7406\u8bf7\u6c42\u5e76\u4ea7\u751f\u91cd\u590d\u7684\u8d37\u8bb0\u4e0e\u501f\u8bb0\u6307\u4ee4\u3002\u4f46\u7531\u4e8e\u5b83\u662f\u786e\u5b9a\u6027\u7684\uff0c\u56e0\u6b64\u5b83\u53ea\u662f\u518d\u6b21\u751f\u6210\u76f8\u540c\u7684\u6307\u4ee4\uff0c\u800c\u6b65\u9aa4 3 \u4e2d\u7684\u5904\u7406\u5668\u53ef\u4ee5\u4f7f\u7528\u7aef\u5230\u7aef\u8bf7\u6c42 ID \u8f7b\u677e\u5730\u5bf9\u5176\u9664\u91cd\u3002</p> <p>\u5982\u679c\u4f60\u60f3\u786e\u4fdd\u4ed8\u6b3e\u4eba\u7684\u5e10\u6237\u4e0d\u4f1a\u56e0\u6b64\u6b21\u8f6c\u8d26\u800c\u900f\u652f\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u989d\u5916\u7684\u6d41\u5904\u7406\u5668\u6765\u7ef4\u62a4\u8d26\u6237\u4f59\u989d\u5e76\u6821\u9a8c\u4e8b\u52a1\uff08\u6309\u4ed8\u6b3e\u4eba\u8d26\u6237\u5206\u533a\uff09\uff0c\u53ea\u6709\u6709\u6548\u7684\u4e8b\u52a1\u4f1a\u88ab\u8bb0\u5f55\u5728\u6b65\u9aa4 1 \u4e2d\u7684\u8bf7\u6c42\u65e5\u5fd7\u4e2d\u3002</p> <p>\u901a\u8fc7\u5c06\u591a\u5206\u533a\u4e8b\u52a1\u5206\u89e3\u4e3a\u4e24\u4e2a\u4e0d\u540c\u5206\u533a\u65b9\u5f0f\u7684\u9636\u6bb5\uff0c\u5e76\u4f7f\u7528\u7aef\u5230\u7aef\u7684\u8bf7\u6c42 ID\uff0c\u6211\u4eec\u5b9e\u73b0\u4e86\u540c\u6837\u7684\u6b63\u786e\u6027\u5c5e\u6027\uff08\u6bcf\u4e2a\u8bf7\u6c42\u5bf9\u4ed8\u6b3e\u4eba\u4e0e\u6536\u6b3e\u4eba\u90fd\u6070\u597d\u751f\u6548\u4e00\u6b21\uff09\uff0c\u5373\u4f7f\u5728\u51fa\u73b0\u6545\u969c\uff0c\u4e14\u6ca1\u6709\u4f7f\u7528\u539f\u5b50\u63d0\u4ea4\u534f\u8bae\u7684\u60c5\u51b5\u4e0b\u4f9d\u7136\u5982\u6b64\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_41","title":"\u53ca\u65f6\u6027\u4e0e\u5b8c\u6574\u6027","text":"<p>\u4e8b\u52a1\u7684\u4e00\u4e2a\u4fbf\u5229\u5c5e\u6027\u662f\uff0c\u5b83\u4eec\u901a\u5e38\u662f\u7ebf\u6027\u4e00\u81f4\u7684\u3002\u5199\u5165\u8005\u4f1a\u7b49\u5230\u4e8b\u52a1\u63d0\u4ea4\uff0c\u800c\u4e4b\u540e\u5176\u5199\u5165\u7acb\u523b\u5bf9\u6240\u6709\u8bfb\u53d6\u8005\u53ef\u89c1\u3002</p> <p>\u5f53\u6211\u4eec\u628a\u4e00\u4e2a\u64cd\u4f5c\u62c6\u5206\u4e3a\u8de8\u8d8a\u591a\u4e2a\u9636\u6bb5\u7684\u6d41\u5904\u7406\u5668\u65f6\uff0c\u5374\u5e76\u975e\u5982\u6b64\uff1a\u65e5\u5fd7\u7684\u6d88\u8d39\u8005\u5728\u8bbe\u8ba1\u4e0a\u5c31\u662f\u5f02\u6b65\u7684\uff0c\u56e0\u6b64\u53d1\u9001\u8005\u4e0d\u4f1a\u7b49\u5176\u6d88\u606f\u88ab\u6d88\u8d39\u8005\u5904\u7406\u5b8c\u3002\u4f46\u662f\uff0c\u5ba2\u6237\u7aef\u7b49\u5f85\u8f93\u51fa\u6d41\u4e2d\u7684\u7279\u5b9a\u6d88\u606f\u662f\u53ef\u80fd\u7684\u3002</p> <p>\u672f\u8bed \u4e00\u81f4\u6027\uff08consistency\uff09 \u8fd9\u4e2a\u672f\u8bed\u6df7\u6dc6\u4e86\u4e24\u4e2a\u503c\u5f97\u5206\u522b\u8003\u8651\u7684\u9700\u6c42\uff1a</p> <ul> <li>\u53ca\u65f6\u6027\uff08Timeliness\uff09\uff1a\u786e\u4fdd\u7528\u6237\u89c2\u5bdf\u5230\u7cfb\u7edf\u7684\u6700\u65b0\u72b6\u6001\u3002</li> <li>\u5982\u679c\u7528\u6237\u4ece\u9648\u65e7\u7684\u6570\u636e\u526f\u672c\u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u5b83\u4eec\u53ef\u80fd\u4f1a\u89c2\u5bdf\u5230\u7cfb\u7edf\u5904\u4e8e\u4e0d\u4e00\u81f4\u7684\u72b6\u6001\u3002\u4f46\u8fd9\u79cd\u4e0d\u4e00\u81f4\u662f\u6682\u65f6\u7684\uff0c\u800c\u6700\u7ec8\u4f1a\u901a\u8fc7\u7b49\u5f85\u4e0e\u91cd\u8bd5\u7b80\u5355\u5730\u5f97\u5230\u89e3\u51b3\u3002</li> <li>CAP \u5b9a\u7406\u4f7f\u7528 \u7ebf\u6027\u4e00\u81f4\u6027\uff08linearizability\uff09 \u610f\u4e49\u4e0a\u7684\u4e00\u81f4\u6027\uff0c\u8fd9\u662f\u5b9e\u73b0\u53ca\u65f6\u6027\u7684\u5f3a\u6709\u529b\u65b9\u6cd5\u3002\u50cf \u5199\u540e\u8bfb \u8fd9\u6837\u53ca\u65f6\u6027\u66f4\u5f31\u7684\u4e00\u81f4\u6027\u4e5f\u5f88\u6709\u7528</li> <li>\u5b8c\u6574\u6027\uff08Integrity\uff09\uff1a\u610f\u5473\u7740\u6ca1\u6709\u635f\u574f\uff1b\u5373\u6ca1\u6709\u6570\u636e\u4e22\u5931\uff0c\u5e76\u4e14\u6ca1\u6709\u77db\u76fe\u6216\u9519\u8bef\u7684\u6570\u636e\u3002</li> <li>\u4f8b\u5982\uff0c\u6570\u636e\u5e93\u7d22\u5f15\u5fc5\u987b\u6b63\u786e\u5730\u53cd\u6620\u6570\u636e\u5e93\u7684\u5185\u5bb9 \u2014\u2014 \u7f3a\u5931\u67d0\u4e9b\u8bb0\u5f55\u7684\u7d22\u5f15\u5e76\u4e0d\u662f\u5f88\u6709\u7528\u3002</li> <li>\u5982\u679c\u5b8c\u6574\u6027\u88ab\u8fdd\u80cc\uff0c\u8fd9\u79cd\u4e0d\u4e00\u81f4\u662f\u6c38\u4e45\u7684\uff1a\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u7b49\u5f85\u4e0e\u91cd\u8bd5\u5e76\u4e0d\u80fd\u4fee\u590d\u6570\u636e\u5e93\u635f\u574f\u3002</li> </ul> <p>\u53e3\u53f7\u5f62\u5f0f\uff1a\u8fdd\u53cd\u53ca\u65f6\u6027\uff0c\u201c\u6700\u7ec8\u4e00\u81f4\u6027\u201d\uff1b\u8fdd\u53cd\u5b8c\u6574\u6027\uff0c\u201c\u6c38\u65e0\u4e00\u81f4\u6027\u201d\u3002\u5b8c\u6574\u6027\u6bd4\u53ca\u65f6\u6027\u91cd\u8981\u5f97\u591a\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_42","title":"\u6570\u636e\u6d41\u7cfb\u7edf\u7684\u6b63\u786e\u6027","text":"<p>\u5728\u5f02\u6b65\u5904\u7406\u4e8b\u4ef6\u6d41\u65f6\u4e0d\u80fd\u4fdd\u8bc1\u53ca\u65f6\u6027\uff0c\u9664\u975e\u4f60\u663e\u5f0f\u6784\u5efa\u4e00\u4e2a\u5728\u8fd4\u56de\u4e4b\u524d\u660e\u786e\u7b49\u5f85\u7279\u5b9a\u6d88\u606f\u5230\u8fbe\u7684\u6d88\u8d39\u8005\u3002\u4f46\u5b8c\u6574\u6027\u5b9e\u9645\u4e0a\u624d\u662f\u6d41\u5904\u7406\u7cfb\u7edf\u7684\u6838\u5fc3\u3002</p> <ul> <li>\u6070\u597d\u4e00\u6b21 \u6216 \u7b49\u6548\u4e00\u6b21 \u8bed\u4e49\u662f\u4e00\u79cd\u4fdd\u6301\u5b8c\u6574\u6027\u7684\u673a\u5236\u3002\u56e0\u6b64\u5728\u51fa\u73b0\u6545\u969c\u65f6\uff0c\u5bb9\u9519\u6d88\u606f\u4f20\u9012\u4e0e\u91cd\u590d\u6291\u5236\uff08\u4f8b\u5982\uff0c\u5e42\u7b49\u64cd\u4f5c\uff09\u5bf9\u4e8e\u7ef4\u62a4\u6570\u636e\u7cfb\u7edf\u7684\u5b8c\u6574\u6027\u662f\u5f88\u91cd\u8981\u7684\u3002</li> </ul> <p>\u53ef\u9760\u7684\u6d41\u5904\u7406\u7cfb\u7edf\u53ef\u4ee5\u5728\u65e0\u9700\u5206\u5e03\u5f0f\u4e8b\u52a1\u4e0e\u539f\u5b50\u63d0\u4ea4\u534f\u8bae\u7684\u60c5\u51b5\u4e0b\u4fdd\u6301\u5b8c\u6574\u6027\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u6709\u6f5c\u529b\u8fbe\u5230\u4e0e\u540e\u8005\u76f8\u5f53\u7684\u6b63\u786e\u6027\uff0c\u540c\u65f6\u8fd8\u5177\u5907\u597d\u5f97\u591a\u7684\u6027\u80fd\u4e0e\u8fd0\u7ef4\u7a33\u5065\u6027\u3002\u4e3a\u4e86\u8fbe\u6210\u8fd9\u79cd\u6b63\u786e\u6027\uff0c\u6211\u4eec\u7ec4\u5408\u4f7f\u7528\u4e86\u591a\u79cd\u673a\u5236\uff1a</p> <ul> <li>\u5c06\u5199\u5165\u64cd\u4f5c\u7684\u5185\u5bb9\u8868\u793a\u4e3a\u5355\u6761\u6d88\u606f\uff0c\u4ece\u800c\u53ef\u4ee5\u8f7b\u677e\u5730\u88ab\u539f\u5b50\u5199\u5165 \u2014\u2014 \u4e0e\u4e8b\u4ef6\u6eaf\u6e90\u642d\u914d\u6548\u679c\u62d4\u7fa4</li> <li>\u4f7f\u7528\u4e0e\u5b58\u50a8\u8fc7\u7a0b\u7c7b\u4f3c\u7684\u786e\u5b9a\u6027\u884d\u751f\u51fd\u6570\uff0c\u4ece\u8fd9\u4e00\u6d88\u606f\u4e2d\u884d\u751f\u51fa\u6240\u6709\u5176\u4ed6\u7684\u72b6\u6001\u53d8\u66f4</li> <li>\u5c06\u5ba2\u6237\u7aef\u751f\u6210\u7684\u8bf7\u6c42 ID \u4f20\u9012\u901a\u8fc7\u6240\u6709\u7684\u5904\u7406\u5c42\u6b21\uff0c\u4ece\u800c\u5141\u8bb8\u7aef\u5230\u7aef\u7684\u9664\u91cd\uff0c\u5e26\u6765\u5e42\u7b49\u6027</li> <li>\u4f7f\u6d88\u606f\u4e0d\u53ef\u53d8\uff0c\u5e76\u5141\u8bb8\u884d\u751f\u6570\u636e\u80fd\u968f\u65f6\u88ab\u91cd\u65b0\u5904\u7406\uff0c\u8fd9\u4f7f\u4ece\u9519\u8bef\u4e2d\u6062\u590d\u66f4\u52a0\u5bb9\u6613</li> </ul> <p>\u8fd9\u79cd\u673a\u5236\u7ec4\u5408\u5728\u6211\u770b\u6765\uff0c\u662f\u672a\u6765\u6784\u5efa\u5bb9\u9519\u5e94\u7528\u7684\u4e00\u4e2a\u975e\u5e38\u6709\u524d\u666f\u7684\u65b9\u5411\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_43","title":"\u5bbd\u677e\u5730\u89e3\u91ca\u7ea6\u675f","text":"<p>\u6267\u884c\u552f\u4e00\u6027\u7ea6\u675f\u9700\u8981\u5171\u8bc6\uff0c\u901a\u5e38\u901a\u8fc7\u5728\u5355\u4e2a\u8282\u70b9\u4e2d\u6c47\u96c6\u7279\u5b9a\u5206\u533a\u4e2d\u7684\u6240\u6709\u4e8b\u4ef6\u6765\u5b9e\u73b0\u3002\u5982\u679c\u6211\u4eec\u60f3\u8981\u4f20\u7edf\u7684\u552f\u4e00\u6027\u7ea6\u675f\u5f62\u5f0f\uff0c\u8fd9\u79cd\u9650\u5236\u662f\u4e0d\u53ef\u907f\u514d\u7684\uff0c\u6d41\u5904\u7406\u4e5f\u4e0d\u4f8b\u5916\u3002</p> <p>\u8bb8\u591a\u771f\u5b9e\u4e16\u754c\u7684\u5e94\u7528\u5b9e\u9645\u4e0a\u53ef\u4ee5\u6446\u8131\u8fd9\u79cd\u5f62\u5f0f\uff0c\u63a5\u53d7\u5f31\u5f97\u591a\u7684\u552f\u4e00\u6027\uff1a</p> <ul> <li>\u8865\u507f\u6027\u4e8b\u52a1\uff08compensating transaction\uff09\u301059,60\u3011\uff1a\u5982\u679c\u4e24\u4e2a\u4eba\u540c\u65f6\u6ce8\u518c\u4e86\u76f8\u540c\u7684\u7528\u6237\u540d\u6216\u9884\u8ba2\u4e86\u76f8\u540c\u7684\u5ea7\u4f4d\uff0c\u4f60\u53ef\u4ee5\u7ed9\u5176\u4e2d\u4e00\u4e2a\u4eba\u53d1\u6d88\u606f\u9053\u6b49\uff0c\u5e76\u8981\u6c42\u4ed6\u4eec\u6362\u4e00\u4e2a\u4e0d\u540c\u7684\u7528\u6237\u540d\u6216\u5ea7\u4f4d\u3002</li> <li>\u5982\u679c\u5ba2\u6237\u8ba2\u8d2d\u7684\u7269\u54c1\u591a\u4e8e\u4ed3\u5e93\u4e2d\u7684\u7269\u54c1\uff0c\u4f60\u53ef\u4ee5\u4e0b\u5355\u8865\u4ed3\uff0c\u5e76\u4e3a\u5ef6\u8bef\u5411\u5ba2\u6237\u9053\u6b49\uff0c\u5411\u4ed6\u4eec\u63d0\u4f9b\u6298\u6263\u3002\u5982\u679c\u53c9\u8f66\u5728\u4ed3\u5e93\u4e2d\u8f67\u8fc7\u4e86\u4f60\u7684\u8d27\u7269\uff0c\u5269\u4e0b\u7684\u8d27\u7269\u6bd4\u4f60\u60f3\u8c61\u7684\u8981\u5c11\uff0c\u90a3\u4e48\u4f60\u4e5f\u662f\u5f97\u8fd9\u4e48\u505a\u301061\u3011\u3002</li> <li>\u8d85\u5356\u673a\u7968\uff0c\u8d85\u5356\u5ba2\u623f\uff1a\u5f53\u9700\u6c42\u8d85\u8fc7\u4f9b\u7ed9\u7684\u60c5\u51b5\u51fa\u73b0\u65f6\uff0c\u5c31\u4f1a\u8fdb\u5165\u8865\u507f\u6d41\u7a0b\uff08\u9000\u6b3e\u3001\u5347\u7ea7\u8231\u4f4d / \u623f\u578b\u3001\u63d0\u4f9b\u9694\u58c1\u9152\u5e97\u7684\u514d\u8d39\u7684\u623f\u95f4\uff09\u3002\u5373\u4f7f\u6ca1\u6709\u8d85\u5356\uff0c\u4e3a\u4e86\u5e94\u5bf9\u7531\u6076\u52a3\u5929\u6c14\u6216\u5458\u5de5\u7f62\u5de5\u5bfc\u81f4\u7684\u822a\u73ed\u53d6\u6d88\uff0c\u4f60\u8fd8\u662f\u9700\u8981\u9053\u6b49\u4e0e\u8865\u507f\u6d41\u7a0b \u2014\u2014 \u4ece\u8fd9\u4e9b\u95ee\u9898\u4e2d\u6062\u590d\u4ec5\u4ec5\u662f\u5546\u4e1a\u6d3b\u52a8\u7684\u6b63\u5e38\u7ec4\u6210\u90e8\u5206\u3002</li> <li>\u5982\u679c\u6709\u4eba\u4ece\u8d26\u6237\u8d85\u989d\u53d6\u6b3e\uff0c\u94f6\u884c\u53ef\u4ee5\u5411\u4ed6\u4eec\u6536\u53d6\u900f\u652f\u8d39\u7528\uff0c\u5e76\u8981\u6c42\u4ed6\u4eec\u507f\u8fd8\u6b20\u6b3e\u3002\u901a\u8fc7\u9650\u5236\u6bcf\u5929\u7684\u63d0\u6b3e\u603b\u989d\uff0c\u94f6\u884c\u7684\u98ce\u9669\u662f\u6709\u9650\u7684\u3002</li> </ul> <p>\u5728\u8bb8\u591a\u5546\u4e1a\u573a\u666f\u4e2d\uff0c\u4e34\u65f6\u8fdd\u80cc\u7ea6\u675f\u5e76\u7a0d\u540e\u901a\u8fc7\u9053\u6b49\u6765\u4fee\u590d\uff0c\u5b9e\u9645\u4e0a\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002</p> <p>\u9053\u6b49\u7684\u6210\u672c\u662f\u5426\u80fd\u63a5\u53d7\u662f\u4e00\u4e2a\u5546\u4e1a\u51b3\u7b56\u3002\u5982\u679c\u53ef\u4ee5\u63a5\u53d7\u7684\u8bdd\uff0c\u5728\u5199\u5165\u6570\u636e\u4e4b\u524d\u68c0\u67e5\u6240\u6709\u7ea6\u675f\u7684\u4f20\u7edf\u6a21\u578b\u53cd\u800c\u4f1a\u5e26\u6765\u4e0d\u5fc5\u8981\u7684\u9650\u5236\uff0c\u800c\u7ebf\u6027\u4e00\u81f4\u6027\u7684\u7ea6\u675f\u4e5f\u4e0d\u662f\u5fc5\u987b\u7684\u3002\u4e50\u89c2\u5199\u5165\uff0c\u4e8b\u540e\u68c0\u67e5\u53ef\u80fd\u662f\u4e00\u79cd\u5408\u7406\u7684\u9009\u62e9\u3002</p> <p>\u8fd9\u4e9b\u5e94\u7528 \u786e\u5b9e \u9700\u8981\u5b8c\u6574\u6027\uff1a\u4f60\u4e0d\u4f1a\u5e0c\u671b\u4e22\u5931\u9884\u8ba2\u4fe1\u606f\uff0c\u6216\u8005\u7531\u4e8e\u501f\u65b9\u8d37\u65b9\u4e0d\u5339\u914d\u5bfc\u81f4\u8d44\u91d1\u6d88\u5931\u3002\u4f46\u662f\u5b83\u4eec\u5728\u6267\u884c\u7ea6\u675f\u65f6 \u5e76\u4e0d\u9700\u8981 \u53ca\u65f6\u6027\uff1a\u5982\u679c\u4f60\u9500\u552e\u7684\u8d27\u7269\u591a\u4e8e\u4ed3\u5e93\u4e2d\u7684\u5e93\u5b58\uff0c\u53ef\u4ee5\u5728\u4e8b\u540e\u9053\u6b49\u540e\u5e76\u5f25\u8865\u95ee\u9898\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_44","title":"\u65e0\u534f\u8c03\u6570\u636e\u7cfb\u7edf","text":"<p>\u73b0\u5728\u5df2\u7ecf\u505a\u4e86\u4e24\u4e2a\u6709\u8da3\u7684\u89c2\u5bdf\uff1a</p> <ol> <li>\u6570\u636e\u6d41\u7cfb\u7edf\u53ef\u4ee5\u7ef4\u6301\u884d\u751f\u6570\u636e\u7684\u5b8c\u6574\u6027\u4fdd\u8bc1\uff0c\u800c\u65e0\u9700\u539f\u5b50\u63d0\u4ea4\u3001\u7ebf\u6027\u4e00\u81f4\u6027\u6216\u8005\u540c\u6b65\u7684\u8de8\u5206\u533a\u534f\u8c03\u3002</li> <li>\u867d\u7136\u4e25\u683c\u7684\u552f\u4e00\u6027\u7ea6\u675f\u8981\u6c42\u53ca\u65f6\u6027\u548c\u534f\u8c03\uff0c\u4f46\u8bb8\u591a\u5e94\u7528\u5b9e\u9645\u4e0a\u53ef\u4ee5\u63a5\u53d7\u5bbd\u677e\u7684\u7ea6\u675f\uff1a\u53ea\u8981\u6574\u4e2a\u8fc7\u7a0b\u4fdd\u6301\u5b8c\u6574\u6027\uff0c\u8fd9\u4e9b\u7ea6\u675f\u53ef\u80fd\u4f1a\u88ab\u4e34\u65f6\u8fdd\u53cd\u5e76\u5728\u7a0d\u540e\u88ab\u4fee\u590d\u3002</li> </ol> <p>\u8fd9\u4e9b\u89c2\u5bdf\u610f\u5473\u7740\uff0c\u6570\u636e\u6d41\u7cfb\u7edf\u53ef\u4ee5\u4e3a\u8bb8\u591a\u5e94\u7528\u63d0\u4f9b\u65e0\u9700\u534f\u8c03\u7684\u6570\u636e\u7ba1\u7406\u670d\u52a1\uff0c\u4e14\u4ecd\u80fd\u7ed9\u51fa\u5f88\u5f3a\u7684\u5b8c\u6574\u6027\u4fdd\u8bc1\u3002</p> <p>\u8fd9\u79cd \u65e0\u534f\u8c03\uff08coordination-avoiding\uff09 \u7684\u6570\u636e\u7cfb\u7edf\u6709\u7740\u5f88\u5927\u7684\u5438\u5f15\u529b\uff1a\u6bd4\u8d77\u9700\u8981\u6267\u884c\u540c\u6b65\u534f\u8c03\u7684\u7cfb\u7edf\uff0c\u5b83\u4eec\u80fd\u8fbe\u5230\u66f4\u597d\u7684\u6027\u80fd\u4e0e\u66f4\u5f3a\u7684\u5bb9\u9519\u80fd\u529b\u301056\u3011\u3002</p> <ul> <li>\u4f8b\u5982\uff0c\u8fd9\u79cd\u7cfb\u7edf\u53ef\u4ee5\u4f7f\u7528\u591a\u9886\u5bfc\u8005\u914d\u7f6e\u8fd0\u7ef4\uff0c\u8de8\u8d8a\u591a\u4e2a\u6570\u636e\u4e2d\u5fc3\uff0c\u5728\u533a\u57df\u95f4\u5f02\u6b65\u590d\u5236\u3002\u4efb\u4f55\u4e00\u4e2a\u6570\u636e\u4e2d\u5fc3\u90fd\u53ef\u4ee5\u6301\u7eed\u72ec\u7acb\u8fd0\u884c\uff0c\u56e0\u4e3a\u4e0d\u9700\u8981\u540c\u6b65\u7684\u8de8\u533a\u57df\u534f\u8c03\u3002\u8fd9\u6837\u7684\u7cfb\u7edf\u7684\u53ca\u65f6\u6027\u4fdd\u8bc1\u4f1a\u5f88\u5f31 \u2014\u2014 \u5982\u679c\u4e0d\u5f15\u5165\u534f\u8c03\u5b83\u662f\u4e0d\u53ef\u80fd\u662f\u7ebf\u6027\u4e00\u81f4\u7684 \u2014\u2014 \u4f46\u5b83\u4ecd\u7136\u53ef\u4ee5\u63d0\u4f9b\u6709\u529b\u7684\u5b8c\u6574\u6027\u4fdd\u8bc1\u3002</li> </ul> <p>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ef\u4e32\u884c\u5316\u4e8b\u52a1\u4f5c\u4e3a\u7ef4\u62a4\u884d\u751f\u72b6\u6001\u7684\u4e00\u90e8\u5206\u4ecd\u7136\u662f\u6709\u7528\u7684\uff0c\u4f46\u5b83\u4eec\u53ea\u80fd\u5728\u5c0f\u8303\u56f4\u5185\u8fd0\u884c\uff0c\u5728\u90a3\u91cc\u5b83\u4eec\u5de5\u4f5c\u5f97\u5f88\u597d\u30108\u3011\u3002\u5f02\u6784\u5206\u5e03\u5f0f\u4e8b\u52a1\u4e0d\u662f\u5fc5\u9700\u7684\u3002\u540c\u6b65\u534f\u8c03\u4ecd\u7136\u53ef\u4ee5\u5728\u9700\u8981\u7684\u5730\u65b9\u5f15\u5165\uff08\u4f8b\u5982\u5728\u65e0\u6cd5\u6062\u590d\u7684\u64cd\u4f5c\u4e4b\u524d\u5f3a\u5236\u6267\u884c\u4e25\u683c\u7684\u7ea6\u675f\uff09\uff0c\u4f46\u662f\u5982\u679c\u53ea\u662f\u5e94\u7528\u7684\u4e00\u5c0f\u90e8\u5206\u5730\u65b9\u9700\u8981\u5b83\uff0c\u6ca1\u5fc5\u8981\u8ba9\u6240\u6709\u64cd\u4f5c\u90fd\u4ed8\u51fa\u534f\u8c03\u7684\u4ee3\u4ef7\u3002\u301043\u3011\u3002</p> <p>\u53e6\u4e00\u79cd\u5ba1\u89c6\u534f\u8c03\u4e0e\u7ea6\u675f\u7684\u89d2\u5ea6\u662f\uff1a\u5b83\u4eec\u51cf\u5c11\u4e86\u7531\u4e8e\u4e0d\u4e00\u81f4\u800c\u5fc5\u987b\u505a\u51fa\u7684\u9053\u6b49\u6570\u91cf\uff0c\u4f46\u4e5f\u53ef\u80fd\u4f1a\u964d\u4f4e\u7cfb\u7edf\u7684\u6027\u80fd\u548c\u53ef\u7528\u6027\uff0c\u4ece\u800c\u53ef\u80fd\u589e\u52a0\u7531\u4e8e\u5b95\u673a\u4e2d\u65ad\u800c\u9700\u8981\u505a\u51fa\u7684\u9053\u6b49\u6570\u91cf\u3002</p> <ul> <li>\u4f60\u4e0d\u53ef\u80fd\u5c06\u9053\u6b49\u6570\u91cf\u51cf\u5c11\u5230\u96f6\uff0c\u4f46\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\u5bfb\u627e\u6700\u4f73\u5e73\u8861\u70b9 \u2014\u2014 \u65e2\u4e0d\u5b58\u5728\u592a\u591a\u4e0d\u4e00\u81f4\u6027\uff0c\u53c8\u4e0d\u5b58\u5728\u592a\u591a\u53ef\u7528\u6027\u95ee\u9898\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_45","title":"\u4fe1\u4efb\u4f46\u9a8c\u8bc1","text":"<p>\u6211\u4eec\u6240\u6709\u5173\u4e8e\u6b63\u786e\u6027\uff0c\u5b8c\u6574\u6027\u548c\u5bb9\u9519\u7684\u8ba8\u8bba\u90fd\u57fa\u4e8e\u4e00\u4e9b\u5047\u8bbe\uff0c\u5047\u8bbe\u67d0\u4e9b\u4e8b\u60c5\u53ef\u80fd\u4f1a\u51fa\u9519\uff0c\u4f46\u5176\u4ed6\u4e8b\u60c5\u4e0d\u4f1a\u3002\u6211\u4eec\u5c06\u8fd9\u4e9b\u5047\u8bbe\u79f0\u4e3a\u6211\u4eec\u7684 \u7cfb\u7edf\u6a21\u578b\uff08system model\uff09\uff1a</p> <ul> <li>\u4f8b\u5982\uff0c\u6211\u4eec\u5e94\u8be5\u5047\u8bbe\u8fdb\u7a0b\u53ef\u80fd\u4f1a\u5d29\u6e83\uff0c\u673a\u5668\u53ef\u80fd\u7a81\u7136\u65ad\u7535\uff0c\u7f51\u7edc\u53ef\u80fd\u4f1a\u4efb\u610f\u5ef6\u8fdf\u6216\u4e22\u5f03\u6d88\u606f\u3002</li> <li>\u6211\u4eec\u4e5f\u53ef\u80fd\u5047\u8bbe\u5199\u5165\u78c1\u76d8\u7684\u6570\u636e\u5728\u6267\u884c <code>fsync</code> \u540e\u4e0d\u4f1a\u4e22\u5931\uff0c\u5185\u5b58\u4e2d\u7684\u6570\u636e\u6ca1\u6709\u635f\u574f\uff0c\u800c CPU \u7684\u4e58\u6cd5\u6307\u4ee4\u603b\u662f\u80fd\u8fd4\u56de\u6b63\u786e\u7684\u7ed3\u679c\u3002</li> </ul> <p>\u8fd9\u4e9b\u5047\u8bbe\u662f\u76f8\u5f53\u5408\u7406\u7684\uff0c\u56e0\u4e3a\u5927\u591a\u6570\u65f6\u5019\u5b83\u4eec\u90fd\u662f\u6210\u7acb\u7684\uff0c\u5982\u679c\u6211\u4eec\u4e0d\u5f97\u4e0d\u7ecf\u5e38\u62c5\u5fc3\u8ba1\u7b97\u673a\u51fa\u9519\uff0c\u90a3\u4e48\u57fa\u672c\u4e0a\u5bf8\u6b65\u96be\u884c\u3002\u5728\u4f20\u7edf\u4e0a\uff0c\u7cfb\u7edf\u6a21\u578b\u91c7\u7528\u4e8c\u5143\u65b9\u6cd5\u5904\u7406\u6545\u969c\uff1a\u6211\u4eec\u5047\u8bbe\u6709\u4e9b\u4e8b\u60c5\u53ef\u80fd\u4f1a\u53d1\u751f\uff0c\u800c\u5176\u4ed6\u4e8b\u60c5 \u6c38\u8fdc \u4e0d\u4f1a\u53d1\u751f\u3002</p> <ul> <li>\u95ee\u9898\u5728\u4e8e\u8fdd\u53cd\u6211\u4eec\u5047\u8bbe\u7684\u60c5\u51b5\u662f\u5426\u7ecf\u5e38\u53d1\u751f\uff0c\u4ee5\u81f3\u4e8e\u6211\u4eec\u53ef\u80fd\u5728\u5b9e\u8df5\u4e2d\u9047\u5230\u5b83\u4eec\u3002</li> </ul> <p>\u6211\u4eec\u5df2\u7ecf\u770b\u5230\uff0c\u6570\u636e\u53ef\u80fd\u4f1a\u5728\u5c1a\u672a\u843d\u76d8\u65f6\u635f\u574f\uff0c\u800c\u7f51\u7edc\u4e0a\u7684\u6570\u636e\u635f\u574f\u6709\u65f6\u53ef\u80fd\u89c4\u907f\u4e86 TCP \u6821\u9a8c\u548c\u3002\u4e5f\u8bb8\u6211\u4eec\u5e94\u5f53\u66f4\u5173\u6ce8\u8fd9\u4e9b\u4e8b\u60c5\uff1f</p> <p>\u9664\u4e86\u7531\u4e8e\u786c\u4ef6\u6545\u969c\u6216\u8f90\u5c04\u5bfc\u81f4\u7684\u968f\u673a\u5b58\u50a8\u5668\u635f\u574f\u4e4b\u5916\uff0c\u4e00\u4e9b\u75c5\u6001\u7684\u5b58\u50a8\u5668\u8bbf\u95ee\u6a21\u5f0f\u751a\u81f3\u53ef\u4ee5\u5728\u6ca1\u6709\u6545\u969c\u7684\u5b58\u50a8\u5668\u4e2d\u7ffb\u8f6c\u4f4d\u301062\u3011 \u2014\u2014 \u4e00\u79cd\u53ef\u7528\u4e8e\u7834\u574f\u64cd\u4f5c\u7cfb\u7edf\u5b89\u5168\u673a\u5236\u7684\u6548\u5e94\u301063\u3011\uff08\u8fd9\u79cd\u6280\u672f\u88ab\u79f0\u4e3a Rowhammer\uff09\u3002</p> <ul> <li>\u8981\u6f84\u6e05\u7684\u662f\uff0c\u968f\u673a\u4f4d\u7ffb\u8f6c\u5728\u73b0\u4ee3\u786c\u4ef6\u4e0a\u4ecd\u662f\u975e\u5e38\u7f55\u89c1\u7684\u301064\u3011\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#bug","title":"\u7ef4\u62a4\u5b8c\u6574\u6027\uff0c\u5c3d\u7ba1\u8f6f\u4ef6\u6709Bug","text":"<p>\u5373\u4f7f\u5e7f\u6cdb\u4f7f\u7528\u7684\u6570\u636e\u5e93\u8f6f\u4ef6\u4e5f\u6709 Bug\uff1a\u6bd4\u5982 MySQL \u672a\u80fd\u6b63\u786e\u7ef4\u62a4\u552f\u4e00\u7ea6\u675f\u301065\u3011\uff0c\u4ee5\u53ca PostgreSQL \u7684\u53ef\u4e32\u884c\u5316\u9694\u79bb\u7b49\u7ea7\u5b58\u5728\u7279\u5b9a\u7684\u5199\u5165\u504f\u5dee\u5f02\u5e38\u301066\u3011\u3002\u5bf9\u4e8e\u4e0d\u90a3\u4e48\u6210\u719f\u7684\u8f6f\u4ef6\u6765\u8bf4\uff0c\u60c5\u51b5\u53ef\u80fd\u8981\u7cdf\u7cd5\u5f97\u591a\u3002</p> <p>Bug \u4ecd\u7136\u4f1a\u5728\u4e0d\u77e5\u4e0d\u89c9\u4e2d\u4ea7\u751f\u3002\u5c3d\u7ba1\u5b83\u4eec\u5f88\u5c11\uff0c\u800c\u4e14\u6700\u7ec8\u4f1a\u88ab\u53d1\u73b0\u5e76\u88ab\u4fee\u590d\uff0c\u4f46\u603b\u4f1a\u6709\u90a3\u4e48\u4e00\u6bb5\u65f6\u95f4\uff0c\u8fd9\u4e9b Bug \u53ef\u80fd\u4f1a\u635f\u574f\u6570\u636e\u3002</p> <p>\u800c\u5bf9\u4e8e\u5e94\u7528\u4ee3\u7801\uff0c\u6211\u4eec\u4e0d\u5f97\u4e0d\u5047\u8bbe\u4f1a\u6709\u66f4\u591a\u7684\u9519\u8bef\uff0c\u56e0\u4e3a\u7edd\u5927\u591a\u6570\u5e94\u7528\u7684\u4ee3\u7801\u7ecf\u53d7\u7684\u8bc4\u5ba1\u4e0e\u6d4b\u8bd5\u8fdc\u8fdc\u65e0\u6cd5\u4e0e\u6570\u636e\u5e93\u7684\u4ee3\u7801\u76f8\u6bd4\u3002\u8bb8\u591a\u5e94\u7528\u751a\u81f3\u6ca1\u6709\u6b63\u786e\u4f7f\u7528\u6570\u636e\u5e93\u63d0\u4f9b\u7684\u7528\u4e8e\u7ef4\u6301\u5b8c\u6574\u6027\u7684\u529f\u80fd\uff0c\u4f8b\u5982\u5916\u952e\u6216\u552f\u4e00\u6027\u7ea6\u675f\u301036\u3011\u3002</p> <p>\u6211\u4eec\u671f\u671b\u6570\u636e\u5e93\u59cb\u7ec8\u5904\u4e8e\u4e00\u81f4\u72b6\u6001\u3002\u7136\u800c\uff0c\u53ea\u6709\u5f53\u4f60\u5047\u8bbe\u4e8b\u52a1\u6ca1\u6709 Bug \u65f6\uff0c\u8fd9\u79cd\u60f3\u6cd5\u624d\u6709\u610f\u4e49\u3002\u5982\u679c\u5e94\u7528\u4ee5\u67d0\u79cd\u9519\u8bef\u7684\u65b9\u5f0f\u4f7f\u7528\u6570\u636e\u5e93\uff0c\u4f8b\u5982\uff0c\u4e0d\u5b89\u5168\u5730\u4f7f\u7528\u5f31\u9694\u79bb\u7b49\u7ea7\uff0c\u6570\u636e\u5e93\u7684\u5b8c\u6574\u6027\u5c31\u65e0\u6cd5\u5f97\u5230\u4fdd\u8bc1\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_46","title":"\u4e0d\u8981\u76f2\u76ee\u4fe1\u4efb\u627f\u8bfa","text":"<p>\u5e94\u8be5\u6709\u529e\u6cd5\u67e5\u660e\u6570\u636e\u662f\u5426\u5df2\u7ecf\u635f\u574f\uff0c\u4ee5\u4fbf\u6211\u4eec\u80fd\u591f\u4fee\u590d\u5b83\uff0c\u5e76\u5c1d\u8bd5\u8ffd\u67e5\u9519\u8bef\u7684\u6765\u6e90\u3002\u68c0\u67e5\u6570\u636e\u5b8c\u6574\u6027\u79f0\u4e3a \u5ba1\u8ba1\uff08auditing\uff09\u3002</p> <p>\u6210\u719f\u7684\u7cfb\u7edf\u540c\u6837\u503e\u5411\u4e8e\u8003\u8651\u4e0d\u592a\u53ef\u80fd\u7684\u4e8b\u60c5\u51fa\u9519\u7684\u53ef\u80fd\u6027\uff0c\u5e76\u7ba1\u7406\u8fd9\u79cd\u98ce\u9669\u3002</p> <ul> <li>HDFS \u548c Amazon S3 \u7b49\u5927\u89c4\u6a21\u5b58\u50a8\u7cfb\u7edf\u5e76\u4e0d\u5b8c\u5168\u4fe1\u4efb\u78c1\u76d8\uff1a\u5b83\u4eec\u8fd0\u884c\u540e\u53f0\u8fdb\u7a0b\u6301\u7eed\u56de\u8bfb\u6587\u4ef6\uff0c\u5e76\u5c06\u5176\u4e0e\u5176\u4ed6\u526f\u672c\u8fdb\u884c\u6bd4\u8f83\uff0c\u5e76\u5c06\u6587\u4ef6\u4ece\u4e00\u4e2a\u78c1\u76d8\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\uff0c\u4ee5\u4fbf\u964d\u4f4e\u9759\u9ed8\u635f\u574f\u7684\u98ce\u9669\u301067\u3011\u3002</li> </ul> <p>\u5982\u679c\u4f60\u60f3\u786e\u4fdd\u4f60\u7684\u6570\u636e\u4ecd\u7136\u5b58\u5728\uff0c\u4f60\u5fc5\u987b\u771f\u6b63\u8bfb\u53d6\u5b83\u5e76\u8fdb\u884c\u68c0\u67e5\u3002\u5927\u591a\u6570\u65f6\u5019\u5b83\u4eec\u4ecd\u7136\u4f1a\u5728\u90a3\u91cc\uff0c\u4f46\u5982\u679c\u4e0d\u662f\u8fd9\u6837\uff0c\u4f60\u4e00\u5b9a\u60f3\u5c3d\u65e9\u77e5\u9053\u7b54\u6848\uff0c\u800c\u4e0d\u662f\u66f4\u665a\u3002\u6309\u7167\u540c\u6837\u7684\u539f\u5219\uff0c\u4e0d\u65f6\u5730\u5c1d\u8bd5\u4ece\u5907\u4efd\u4e2d\u6062\u590d\u662f\u975e\u5e38\u91cd\u8981\u7684 \u2014\u2014 \u5426\u5219\u5f53\u4f60\u53d1\u73b0\u5907\u4efd\u635f\u574f\u65f6\uff0c\u4f60\u53ef\u80fd\u5df2\u7ecf\u9047\u5230\u4e86\u6570\u636e\u4e22\u5931\uff0c\u90a3\u65f6\u5019\u5c31\u771f\u7684\u592a\u665a\u4e86\u3002\u4e0d\u8981\u76f2\u76ee\u5730\u76f8\u4fe1\u5b83\u4eec\u5168\u90fd\u7ba1\u7528\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_47","title":"\u9a8c\u8bc1\u7684\u6587\u5316","text":"<p>\u76ee\u524d\u8fd8\u6ca1\u6709\u591a\u5c11\u7cfb\u7edf\u91c7\u7528\u8fd9\u79cd \u201c\u4fe1\u4efb\u4f46\u662f\u9a8c\u8bc1\u201d \u7684\u65b9\u5f0f\u6765\u6301\u7eed\u5ba1\u8ba1\u81ea\u5df1\u3002\u8bb8\u591a\u4eba\u8ba4\u4e3a\u6b63\u786e\u6027\u4fdd\u8bc1\u662f\u7edd\u5bf9\u7684\uff0c\u5e76\u4e14\u6ca1\u6709\u4e3a\u7f55\u89c1\u7684\u6570\u636e\u635f\u574f\u7684\u53ef\u80fd\u6027\u505a\u8fc7\u51c6\u5907\u3002\u5e0c\u671b\u672a\u6765\u80fd\u770b\u5230\u66f4\u591a\u7684 \u81ea\u6211\u9a8c\u8bc1\uff08self-validating\uff09 \u6216 \u81ea\u6211\u5ba1\u8ba1\uff08self-auditing\uff09 \u7cfb\u7edf\uff0c\u4e0d\u65ad\u68c0\u67e5\u81ea\u5df1\u7684\u5b8c\u6574\u6027\uff0c\u800c\u4e0d\u662f\u4f9d\u8d56\u76f2\u76ee\u7684\u4fe1\u4efb\u301068\u3011\u3002</p> <p>\u6211\u62c5\u5fc3 ACID \u6570\u636e\u5e93\u7684\u6587\u5316\u5bfc\u81f4\u6211\u4eec\u5728\u76f2\u76ee\u4fe1\u4efb\u6280\u672f\uff08\u5982\u4e8b\u52a1\u673a\u5236\uff09\u7684\u57fa\u7840\u4e0a\u5f00\u53d1\u5e94\u7528\uff0c\u800c\u5ffd\u89c6\u4e86\u8fd9\u79cd\u8fc7\u7a0b\u4e2d\u7684\u4efb\u4f55\u53ef\u5ba1\u8ba1\u6027\u3002\u7531\u4e8e\u6211\u4eec\u6240\u4fe1\u4efb\u7684\u6280\u672f\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u5de5\u4f5c\u5f97\u5f88\u597d\uff0c\u901a\u5e38\u4f1a\u8ba4\u4e3a\u5ba1\u8ba1\u673a\u5236\u5e76\u4e0d\u503c\u5f97\u6295\u8d44\u3002</p> <p>\u5728 NoSQL \u7684\u65d7\u5e1c\u4e0b\uff0c\u66f4\u5f31\u7684\u4e00\u81f4\u6027\u4fdd\u8bc1\u6210\u4e3a\u5e38\u6001\uff0c\u66f4\u4e0d\u6210\u719f\u7684\u5b58\u50a8\u6280\u672f\u8d8a\u6765\u8d8a\u88ab\u5e7f\u6cdb\u4f7f\u7528\u3002\u4f46\u662f\u7531\u4e8e\u5ba1\u8ba1\u673a\u5236\u8fd8\u6ca1\u6709\u88ab\u5f00\u53d1\u51fa\u6765\uff0c\u5c3d\u7ba1\u8fd9\u79cd\u65b9\u5f0f\u8d8a\u6765\u8d8a\u5371\u9669\uff0c\u6211\u4eec\u4ecd\u4e0d\u65ad\u5728\u76f2\u76ee\u4fe1\u4efb\u7684\u57fa\u7840\u4e0a\u6784\u5efa\u5e94\u7528\u3002\u8ba9\u6211\u4eec\u60f3\u4e00\u60f3\u5982\u4f55\u9488\u5bf9\u53ef\u5ba1\u8ba1\u6027\u800c\u8bbe\u8ba1\u5427\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_48","title":"\u4e3a\u53ef\u5ba1\u8ba1\u6027\u800c\u8bbe\u8ba1","text":"<p>\u5982\u679c\u4e00\u4e2a\u4e8b\u52a1\u5728\u4e00\u4e2a\u6570\u636e\u5e93\u4e2d\u6539\u53d8\u4e86\u591a\u4e2a\u5bf9\u8c61\uff0c\u5728\u8fd9\u4e00\u4e8b\u5b9e\u53d1\u751f\u540e\uff0c\u5f88\u96be\u8bf4\u6e05\u8fd9\u4e2a\u4e8b\u52a1\u5230\u5e95\u610f\u5473\u7740\u4ec0\u4e48\u3002\u5373\u4f7f\u4f60\u6355\u83b7\u4e86\u4e8b\u52a1\u65e5\u5fd7\uff0c\u5404\u79cd\u8868\u4e2d\u7684\u63d2\u5165\u3001\u66f4\u65b0\u548c\u5220\u9664\u64cd\u4f5c\u5e76\u4e0d\u4e00\u5b9a\u80fd\u6e05\u695a\u5730\u8868\u660e \u4e3a\u4ec0\u4e48 \u8981\u6267\u884c\u8fd9\u4e9b\u53d8\u66f4\u3002\u51b3\u5b9a\u8fd9\u4e9b\u53d8\u66f4\u7684\u662f\u5e94\u7528\u903b\u8f91\u4e2d\u7684\u8c03\u7528\uff0c\u800c\u8fd9\u4e00\u5e94\u7528\u903b\u8f91\u7a0d\u7eb5\u5373\u901d\uff0c\u65e0\u6cd5\u91cd\u73b0\u3002</p> <p>\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u57fa\u4e8e\u4e8b\u4ef6\u7684\u7cfb\u7edf\u53ef\u4ee5\u63d0\u4f9b\u66f4\u597d\u7684\u53ef\u5ba1\u8ba1\u6027\u3002</p> <ul> <li>\u5728\u4e8b\u4ef6\u6eaf\u6e90\u65b9\u6cd5\u4e2d\uff0c\u7cfb\u7edf\u7684\u7528\u6237\u8f93\u5165\u88ab\u8868\u793a\u4e3a\u4e00\u4e2a\u5355\u4e00\u4e0d\u53ef\u53d8\u4e8b\u4ef6\uff0c\u800c\u4efb\u4f55\u5176\u5bfc\u81f4\u7684\u72b6\u6001\u53d8\u66f4\u90fd\u884d\u751f\u81ea\u8be5\u4e8b\u4ef6\u3002</li> <li>\u884d\u751f\u53ef\u4ee5\u5b9e\u73b0\u4e3a\u5177\u6709\u786e\u5b9a\u6027\u4e0e\u53ef\u91cd\u590d\u6027\uff0c\u56e0\u800c\u76f8\u540c\u7684\u4e8b\u4ef6\u65e5\u5fd7\u901a\u8fc7\u76f8\u540c\u7248\u672c\u7684\u884d\u751f\u4ee3\u7801\u65f6\uff0c\u4f1a\u5bfc\u81f4\u76f8\u540c\u7684\u72b6\u6001\u53d8\u66f4\u3002</li> </ul> <p>\u663e\u5f0f\u5904\u7406\u6570\u636e\u6d41\u53ef\u4ee5\u4f7f\u6570\u636e\u7684 \u6765\u9f99\u53bb\u8109\uff08provenance\uff09 \u66f4\u52a0\u6e05\u6670\uff0c\u4ece\u800c\u4f7f\u5b8c\u6574\u6027\u68c0\u67e5\u66f4\u5177\u53ef\u884c\u6027\u3002</p> <ul> <li>\u5bf9\u4e8e\u4e8b\u4ef6\u65e5\u5fd7\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6563\u5217\u6765\u68c0\u67e5\u4e8b\u4ef6\u5b58\u50a8\u6ca1\u6709\u88ab\u7834\u574f\u3002</li> <li>\u5bf9\u4e8e\u4efb\u4f55\u884d\u751f\u72b6\u6001\uff0c\u6211\u4eec\u53ef\u4ee5\u91cd\u65b0\u8fd0\u884c\u4ece\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u884d\u751f\u5b83\u7684\u6279\u5904\u7406\u5668\u4e0e\u6d41\u5904\u7406\u5668\uff0c\u4ee5\u68c0\u67e5\u662f\u5426\u83b7\u5f97\u76f8\u540c\u7684\u7ed3\u679c\uff0c\u6216\u8005\uff0c\u751a\u81f3\u5e76\u884c\u8fd0\u884c\u5197\u4f59\u7684\u884d\u751f\u6d41\u7a0b\u3002</li> </ul> <p>\u5177\u6709\u786e\u5b9a\u6027\u4e14\u5b9a\u4e49\u826f\u597d\u7684\u6570\u636e\u6d41\uff0c\u4e5f\u4f7f\u8c03\u8bd5\u4e0e\u8ddf\u8e2a\u7cfb\u7edf\u7684\u6267\u884c\u53d8\u5f97\u5bb9\u6613\uff0c\u4ee5\u4fbf\u786e\u5b9a\u5b83 \u4e3a\u4ec0\u4e48 \u505a\u4e86\u67d0\u4e9b\u4e8b\u60c5\u30104,69\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_49","title":"\u7aef\u5230\u7aef\u539f\u5219\u91cd\u73b0","text":"<p>\u5982\u679c\u6211\u4eec\u4e0d\u80fd\u5b8c\u5168\u76f8\u4fe1\u7cfb\u7edf\u7684\u6bcf\u4e2a\u7ec4\u4ef6\u90fd\u4e0d\u4f1a\u635f\u574f \u2014\u2014 \u6bcf\u4e00\u4e2a\u786c\u4ef6\u90fd\u6ca1\u7f3a\u9677\uff0c\u6bcf\u4e00\u4e2a\u8f6f\u4ef6\u90fd\u6ca1\u6709 Bug \u2014\u2014 \u90a3\u6211\u4eec\u81f3\u5c11\u5fc5\u987b\u5b9a\u671f\u68c0\u67e5\u6570\u636e\u7684\u5b8c\u6574\u6027\u3002</p> <p>\u68c0\u67e5\u6570\u636e\u7cfb\u7edf\u7684\u5b8c\u6574\u6027\uff0c\u6700\u597d\u662f\u4ee5\u7aef\u5230\u7aef\u7684\u65b9\u5f0f\u8fdb\u884c\uff1a\u6211\u4eec\u80fd\u5728\u5b8c\u6574\u6027\u68c0\u67e5\u4e2d\u6db5\u76d6\u7684\u7cfb\u7edf\u8d8a\u591a\uff0c\u67d0\u4e9b\u5904\u7406\u9636\u4e2d\u51fa\u73b0\u4e0d\u88ab\u5bdf\u89c9\u635f\u574f\u7684\u51e0\u7387\u5c31\u8d8a\u5c0f\u3002\u5982\u679c\u6211\u4eec\u80fd\u68c0\u67e5\u6574\u4e2a\u884d\u751f\u6570\u636e\u7ba1\u9053\u7aef\u5230\u7aef\u7684\u6b63\u786e\u6027\uff0c\u90a3\u4e48\u6cbf\u7740\u8fd9\u4e00\u8def\u5f84\u7684\u4efb\u4f55\u78c1\u76d8\u3001\u7f51\u7edc\u3001\u670d\u52a1\u4ee5\u53ca\u7b97\u6cd5\u7684\u6b63\u786e\u6027\u68c0\u67e5\u90fd\u9690\u542b\u5728\u5176\u4e2d\u4e86\u3002</p> <p>\u6301\u7eed\u7684\u7aef\u5230\u7aef\u5b8c\u6574\u6027\u68c0\u67e5\u53ef\u4ee5\u4e0d\u65ad\u63d0\u9ad8\u4f60\u5bf9\u7cfb\u7edf\u6b63\u786e\u6027\u7684\u4fe1\u5fc3\uff0c\u4ece\u800c\u4f7f\u4f60\u80fd\u66f4\u5feb\u5730\u8fdb\u6b65\u301070\u3011\u3002\u4e0e\u81ea\u52a8\u5316\u6d4b\u8bd5\u4e00\u6837\uff0c\u5ba1\u8ba1\u63d0\u9ad8\u4e86\u5feb\u901f\u53d1\u73b0\u9519\u8bef\u7684\u53ef\u80fd\u6027\uff0c\u4ece\u800c\u964d\u4f4e\u4e86\u7cfb\u7edf\u53d8\u66f4\u6216\u65b0\u5b58\u50a8\u6280\u672f\u53ef\u80fd\u5bfc\u81f4\u635f\u5931\u7684\u98ce\u9669\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_50","title":"\u7528\u4e8e\u53ef\u5ba1\u8ba1\u6570\u636e\u7cfb\u7edf\u7684\u5de5\u5177","text":"<p>\u76ee\u524d\uff0c\u5c06\u53ef\u5ba1\u8ba1\u6027\u4f5c\u4e3a\u9876\u5c42\u5173\u6ce8\u70b9\u7684\u6570\u636e\u7cfb\u7edf\u5e76\u4e0d\u591a\u3002\u4e00\u4e9b\u5e94\u7528\u5b9e\u73b0\u4e86\u81ea\u5df1\u7684\u5ba1\u8ba1\u673a\u5236\uff0c\u4f8b\u5982\u5c06\u6240\u6709\u53d8\u66f4\u8bb0\u5f55\u5230\u5355\u72ec\u7684\u5ba1\u8ba1\u8868\u4e2d\uff0c\u4f46\u662f\u786e\u4fdd\u5ba1\u8ba1\u65e5\u5fd7\u4e0e\u6570\u636e\u5e93\u72b6\u6001\u7684\u5b8c\u6574\u6027\u4ecd\u7136\u662f\u5f88\u56f0\u96be\u7684\u3002\u53ef\u4ee5\u5b9a\u671f\u4f7f\u7528\u786c\u4ef6\u5b89\u5168\u6a21\u5757\u5bf9\u4e8b\u52a1\u65e5\u5fd7\u8fdb\u884c\u7b7e\u540d\u6765\u9632\u6b62\u7be1\u6539\uff0c\u4f46\u8fd9\u65e0\u6cd5\u4fdd\u8bc1\u6b63\u786e\u7684\u4e8b\u52a1\u4e00\u5f00\u59cb\u5c31\u80fd\u8fdb\u5165\u5230\u65e5\u5fd7\u4e2d\u3002</p> <p>\u4f7f\u7528\u5bc6\u7801\u5b66\u5de5\u5177\u6765\u8bc1\u660e\u7cfb\u7edf\u7684\u5b8c\u6574\u6027\u662f\u5341\u5206\u6709\u8da3\u7684\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5bf9\u4e8e\u5bbd\u6cdb\u7684\u786c\u4ef6\u4e0e\u8f6f\u4ef6\u95ee\u9898\uff0c\u751a\u81f3\u662f\u6f5c\u5728\u7684\u6076\u610f\u884c\u4e3a\u90fd\u5f88\u7a33\u5065\u6709\u6548\u3002\u52a0\u5bc6\u8d27\u5e01\u3001\u533a\u5757\u94fe\u3001\u4ee5\u53ca\u8bf8\u5982\u6bd4\u7279\u5e01\u3001\u4ee5\u592a\u574a\u3001Ripple\u3001Stellar \u7684\u5206\u5e03\u5f0f\u8d26\u672c\u6280\u672f\u5df2\u7ecf\u8fc5\u901f\u51fa\u73b0\u5728\u8fd9\u4e00\u9886\u57df\u301071,72,73\u3011\u3002</p> <ul> <li>\u4ece\u6570\u636e\u7cfb\u7edf\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u5b83\u4eec\u662f\u5206\u5e03\u5f0f\u6570\u636e\u5e93\uff0c\u5177\u6709\u6570\u636e\u6a21\u578b\u4e0e\u4e8b\u52a1\u673a\u5236\uff0c\u800c\u4e0d\u540c\u526f\u672c\u53ef\u4ee5\u7531\u4e92\u4e0d\u4fe1\u4efb\u7684\u7ec4\u7ec7\u6258\u7ba1\u3002\u526f\u672c\u4e0d\u65ad\u68c0\u67e5\u5176\u4ed6\u526f\u672c\u7684\u5b8c\u6574\u6027\uff0c\u5e76\u4f7f\u7528\u5171\u8bc6\u534f\u8bae\u5bf9\u5e94\u5f53\u6267\u884c\u7684\u4e8b\u52a1\u8fbe\u6210\u4e00\u81f4\u3002</li> </ul> <p>\u6211\u5bf9\u8fd9\u4e9b\u6280\u672f\u7684\u62dc\u5360\u5ead\u5bb9\u9519\u65b9\u9762\u6709\u4e9b\u6000\u7591\uff0c\u800c\u4e14\u6211\u53d1\u73b0 \u5de5\u4f5c\u8bc1\u660e\uff08proof of work\uff09 \u6280\u672f\u975e\u5e38\u6d6a\u8d39\uff08\u6bd4\u5982\uff0c\u6bd4\u7279\u5e01\u6316\u77ff\uff09\u3002\u6bd4\u7279\u5e01\u7684\u4ea4\u6613\u541e\u5410\u91cf\u76f8\u5f53\u4f4e\uff0c\u5c3d\u7ba1\u66f4\u591a\u662f\u51fa\u4e8e\u653f\u6cbb\u4e0e\u7ecf\u6d4e\u539f\u56e0\u800c\u975e\u6280\u672f\u4e0a\u7684\u539f\u56e0\u3002\u4e0d\u8fc7\uff0c\u5b8c\u6574\u6027\u68c0\u67e5\u7684\u65b9\u9762\u662f\u5f88\u6709\u8da3\u7684\u3002</p> <p>\u5bc6\u7801\u5b66\u5ba1\u8ba1\u4e0e\u5b8c\u6574\u6027\u68c0\u67e5\u901a\u5e38\u4f9d\u8d56 \u9ed8\u514b\u5c14\u6811\uff08Merkle tree\uff09\u301074\u3011\uff0c\u8fd9\u662f\u4e00\u9897\u6563\u5217\u503c\u7684\u6811\uff0c\u80fd\u591f\u7528\u4e8e\u9ad8\u6548\u5730\u8bc1\u660e\u4e00\u6761\u8bb0\u5f55\u51fa\u73b0\u5728\u4e00\u4e2a\u6570\u636e\u96c6\u4e2d\uff08\u4ee5\u53ca\u5176\u4ed6\u4e00\u4e9b\u7279\u6027\uff09\u3002\u9664\u4e86\u7092\u4f5c\u7684\u6cb8\u6cb8\u626c\u626c\u7684\u52a0\u5bc6\u8d27\u5e01\u4e4b\u5916\uff0c\u8bc1\u4e66\u900f\u660e\u6027\uff08certificate transparency\uff09 \u4e5f\u662f\u4e00\u79cd\u4f9d\u8d56 Merkle \u6811\u7684\u5b89\u5168\u6280\u672f\uff0c\u7528\u6765\u68c0\u67e5 TLS/SSL \u8bc1\u4e66\u7684\u6709\u6548\u6027\u301075,76\u3011\u3002</p> <p>\u90a3\u4e9b\u5728\u8bc1\u4e66\u900f\u660e\u5ea6\u4e0e\u5206\u5e03\u5f0f\u8d26\u672c\u4e2d\u4f7f\u7528\u7684\u5b8c\u6574\u6027\u68c0\u67e5\u548c\u5ba1\u8ba1\u7b97\u6cd5\uff0c\u5c06\u4f1a\u5728\u901a\u7528\u6570\u636e\u7cfb\u7edf\u4e2d\u5f97\u5230\u8d8a\u6765\u8d8a\u5e7f\u6cdb\u7684\u5e94\u7528\u3002\u8981\u4f7f\u5f97\u8fd9\u4e9b\u7b97\u6cd5\u5bf9\u4e8e\u6ca1\u6709\u5bc6\u7801\u5b66\u5ba1\u8ba1\u7684\u7cfb\u7edf\u540c\u6837\u53ef\u4f38\u7f29\uff0c\u5e76\u5c3d\u53ef\u80fd\u964d\u4f4e\u6027\u80fd\u635f\u5931\u8fd8\u9700\u8981\u4e00\u4e9b\u5de5\u4f5c\u3002\u4f46\u6211\u8ba4\u4e3a\u8fd9\u662f\u4e00\u4e2a\u503c\u5f97\u5173\u6ce8\u7684\u6709\u8da3\u9886\u57df\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_51","title":"\u505a\u6b63\u786e\u7684\u4e8b\u60c5","text":"<p>\u6bcf\u4e2a\u7cfb\u7edf\u90fd\u670d\u52a1\u4e8e\u4e00\u4e2a\u76ee\u7684\uff1b\u6211\u4eec\u91c7\u53d6\u7684\u6bcf\u4e2a\u4e3e\u63aa\u90fd\u4f1a\u540c\u65f6\u4ea7\u751f\u671f\u671b\u7684\u540e\u679c\u4e0e\u610f\u5916\u7684\u540e\u679c\u3002</p> <ul> <li>\u76ee\u7684\u53ef\u80fd\u53ea\u662f\u7b80\u5355\u5730\u8d5a\u94b1\uff0c\u4f46\u5176\u5bf9\u4e16\u754c\u7684\u5f71\u54cd\uff0c\u53ef\u80fd\u4f1a\u8fdc\u8fdc\u8d85\u51fa\u6700\u521d\u7684\u76ee\u7684\u3002</li> <li>\u6211\u4eec\u5efa\u7acb\u8fd9\u4e9b\u7cfb\u7edf\u7684\u5de5\u7a0b\u5e08\uff0c\u6709\u8d23\u4efb\u53bb\u4ed4\u7ec6\u8003\u8651\u8fd9\u4e9b\u540e\u679c\uff0c\u5e76\u6709\u610f\u8bc6\u5730\u51b3\u5b9a\uff0c\u6211\u4eec\u5e0c\u671b\u751f\u6d3b\u5728\u600e\u6837\u7684\u4e16\u754c\u4e2d\u3002</li> </ul> <p>\u8bb8\u591a\u6570\u636e\u96c6\u90fd\u662f\u5173\u4e8e\u4eba\u7684\uff1a\u4ed6\u4eec\u7684\u884c\u4e3a\uff0c\u4ed6\u4eec\u7684\u5174\u8da3\uff0c\u4ed6\u4eec\u7684\u8eab\u4efd\u3002\u5bf9\u5f85\u8fd9\u4e9b\u6570\u636e\uff0c\u6211\u4eec\u5fc5\u987b\u6000\u7740\u4eba\u6027\u4e0e\u5c0a\u91cd\u3002\u7528\u6237\u4e5f\u662f\u4eba\u7c7b\uff0c\u4eba\u7c7b\u7684\u5c0a\u4e25\u662f\u81f3\u5173\u91cd\u8981\u7684\u3002</p> <p>\u8f6f\u4ef6\u5f00\u53d1\u8d8a\u6765\u8d8a\u591a\u5730\u6d89\u53ca\u91cd\u8981\u7684\u9053\u5fb7\u6289\u62e9\u3002\u6709\u4e00\u4e9b\u6307\u5bfc\u539f\u5219\u53ef\u4ee5\u5e2e\u52a9\u8f6f\u4ef6\u5de5\u7a0b\u5e08\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff0c\u4f8b\u5982 ACM \u7684\u8f6f\u4ef6\u5de5\u7a0b\u9053\u5fb7\u89c4\u8303\u4e0e\u4e13\u4e1a\u5b9e\u8df5\u301077\u3011\u3002\u4f46\u5b9e\u8df5\u4e2d\u5f88\u5c11\u4f1a\u8ba8\u8bba\u8fd9\u4e9b\uff0c\u66f4\u4e0d\u7528\u8bf4\u5e94\u7528\u4e0e\u5f3a\u5236\u6267\u884c\u4e86\u3002\u56e0\u6b64\uff0c\u5de5\u7a0b\u5e08\u548c\u4ea7\u54c1\u7ecf\u7406\u6709\u65f6\u4f1a\u5bf9\u9690\u79c1\u4e0e\u4ea7\u54c1\u6f5c\u5728\u7684\u8d1f\u9762\u540e\u679c\u62b1\u6709\u975e\u5e38\u50b2\u6162\u7684\u6001\u5ea6\u301078,79,80\u3011\u3002</p> <p>\u8f6f\u4ef6\u5de5\u7a0b\u5e08\u4ec5\u4ec5\u4e13\u6ce8\u4e8e\u6280\u672f\u800c\u5ffd\u89c6\u5176\u540e\u679c\u662f\u4e0d\u591f\u7684\uff1a\u9053\u5fb7\u8d23\u4efb\u4e5f\u662f\u6211\u4eec\u7684\u8d23\u4efb\u3002\u5bf9\u9053\u5fb7\u63a8\u7406\u5f88\u56f0\u96be\uff0c\u4f46\u5b83\u592a\u91cd\u8981\u4e86\uff0c\u6211\u4eec\u65e0\u6cd5\u5ffd\u89c6\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_52","title":"\u9884\u6d4b\u6027\u5206\u6790","text":"<p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u9884\u6d4b\u6027\u5206\u6790\u662f \u201c\u5927\u6570\u636e\u201d \u7092\u4f5c\u7684\u4e3b\u8981\u5185\u5bb9\u4e4b\u4e00\u3002\u4f7f\u7528\u6570\u636e\u5206\u6790\u9884\u6d4b\u5929\u6c14\u6216\u75be\u75c5\u4f20\u64ad\u662f\u4e00\u7801\u4e8b\u301081\u3011\uff1b\u800c\u9884\u6d4b\u4e00\u4e2a\u7f6a\u72af\u662f\u5426\u53ef\u80fd\u518d\u72af\uff0c\u4e00\u4e2a\u8d37\u6b3e\u7533\u8bf7\u4eba\u662f\u5426\u6709\u53ef\u80fd\u8fdd\u7ea6\uff0c\u6216\u8005\u4e00\u4e2a\u4fdd\u9669\u5ba2\u6237\u662f\u5426\u53ef\u80fd\u8fdb\u884c\u6602\u8d35\u7684\u7d22\u8d54\uff0c\u5219\u662f\u53e6\u5916\u4e00\u7801\u4e8b\u3002\u540e\u8005\u4f1a\u76f4\u63a5\u5f71\u54cd\u5230\u4e2a\u4eba\u7684\u751f\u6d3b\u3002</p> <p>\u968f\u7740\u7b97\u6cd5\u51b3\u7b56\u53d8\u5f97\u8d8a\u6765\u8d8a\u666e\u904d\uff0c\u88ab\u67d0\u79cd\u7b97\u6cd5\uff08\u51c6\u786e\u5730\u6216\u9519\u8bef\u5730\uff09\u6807\u8bb0\u4e3a\u6709\u98ce\u9669\u7684\u67d0\u4eba\u53ef\u80fd\u4f1a\u906d\u53d7\u5927\u91cf\u8fd9\u79cd \u201cNo\u201d \u7684\u51b3\u5b9a\u3002\u7cfb\u7edf\u6027\u5730\u88ab\u6392\u9664\u5728\u5de5\u4f5c\uff0c\u822a\u65c5\uff0c\u4fdd\u9669\uff0c\u79df\u8d41\uff0c\u91d1\u878d\u670d\u52a1\uff0c\u4ee5\u53ca\u5176\u4ed6\u793e\u4f1a\u5173\u952e\u9886\u57df\u4e4b\u5916\u3002\u8fd9\u662f\u4e00\u79cd\u5bf9\u4e2a\u4f53\u81ea\u7531\u7684\u6781\u5927\u7ea6\u675f\uff0c\u56e0\u6b64\u88ab\u79f0\u4e3a \u201c\u7b97\u6cd5\u76d1\u72f1\u201d\u301082\u3011\u3002</p> <p>\u5728\u5c0a\u91cd\u4eba\u6743\u7684\u56fd\u5bb6\uff0c\u5211\u4e8b\u53f8\u6cd5\u7cfb\u7edf\u4f1a\u505a\u65e0\u7f6a\u63a8\u5b9a\uff08\u9ed8\u8ba4\u6e05\u767d\uff0c\u76f4\u5230\u88ab\u8bc1\u660e\u6709\u7f6a\uff09\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u81ea\u52a8\u5316\u7cfb\u7edf\u53ef\u4ee5\u7cfb\u7edf\u5730\uff0c\u4efb\u610f\u5730\u5c06\u4e00\u4e2a\u4eba\u6392\u9664\u5728\u793e\u4f1a\u53c2\u4e0e\u4e4b\u5916\uff0c\u4e0d\u9700\u8981\u4efb\u4f55\u6709\u7f6a\u7684\u8bc1\u660e\uff0c\u800c\u4e14\u51e0\u4e4e\u6ca1\u6709\u7533\u8bc9\u7684\u673a\u4f1a\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_53","title":"\u504f\u89c1\u4e0e\u6b67\u89c6","text":"<p>\u7b97\u6cd5\u505a\u51fa\u7684\u51b3\u5b9a\u4e0d\u4e00\u5b9a\u6bd4\u4eba\u7c7b\u66f4\u597d\u6216\u66f4\u5dee\u3002\u6bcf\u4e2a\u4eba\u90fd\u53ef\u80fd\u6709\u504f\u89c1\uff0c\u5373\u4f7f\u4ed6\u4eec\u4e3b\u52a8\u6297\u62d2\u8fd9\u4e00\u70b9\uff1b\u800c\u6b67\u89c6\u6027\u505a\u6cd5\u4e5f\u53ef\u80fd\u5df2\u7ecf\u5728\u6587\u5316\u4e0a\u88ab\u5236\u5ea6\u5316\u4e86\u3002\u4eba\u4eec\u5e0c\u671b\u6839\u636e\u6570\u636e\u505a\u51fa\u51b3\u5b9a\uff0c\u800c\u4e0d\u662f\u901a\u8fc7\u4eba\u7684\u4e3b\u89c2\u8bc4\u4ef7\u4e0e\u76f4\u89c9\uff0c\u5e0c\u671b\u8fd9\u6837\u80fd\u66f4\u52a0\u516c\u5e73\uff0c\u5e76\u7ed9\u4e88\u4f20\u7edf\u4f53\u5236\u4e2d\u7ecf\u5e38\u88ab\u5ffd\u89c6\u7684\u4eba\u66f4\u597d\u7684\u673a\u4f1a\u301083\u3011\u3002</p> <p>\u8fd9\u4e9b\u7cfb\u7edf\u5b66\u5230\u7684\u6a21\u5f0f\u662f\u4e2a\u9ed1\u76d2\uff1a\u5373\u4f7f\u6570\u636e\u4e2d\u5b58\u5728\u4e00\u4e9b\u76f8\u5173\u6027\uff0c\u6211\u4eec\u53ef\u80fd\u4e5f\u538b\u6839\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u3002\u5982\u679c\u7b97\u6cd5\u7684\u8f93\u5165\u4e2d\u5b58\u5728\u7cfb\u7edf\u6027\u7684\u504f\u89c1\uff0c\u5219\u7cfb\u7edf\u5f88\u6709\u53ef\u80fd\u4f1a\u5728\u8f93\u51fa\u4e2d\u5b66\u4e60\u5e76\u653e\u5927\u8fd9\u79cd\u504f\u89c1\u301084\u3011\u3002</p> <ul> <li>\u4f8b\u5982\uff0c\u5728\u79cd\u65cf\u9694\u79bb\u5730\u533a\u4e2d\uff0c\u4e00\u4e2a\u4eba\u7684\u90ae\u653f\u7f16\u7801\uff0c\u751a\u81f3\u662f\u4ed6\u4eec\u7684 IP \u5730\u5740\uff0c\u90fd\u662f\u5f88\u5f3a\u7684\u79cd\u65cf\u6307\u793a\u7269\u3002\u8fd9\u6837\u7684\u8bdd\uff0c\u76f8\u4fe1\u4e00\u79cd\u7b97\u6cd5\u53ef\u4ee5\u4ee5\u67d0\u79cd\u65b9\u5f0f\u5c06\u6709\u504f\u89c1\u7684\u6570\u636e\u4f5c\u4e3a\u8f93\u5165\uff0c\u5e76\u4ea7\u751f\u516c\u5e73\u548c\u516c\u6b63\u7684\u8f93\u51fa\u301085\u3011\u4f3c\u4e4e\u662f\u5f88\u8352\u8c2c\u7684\u3002\u7136\u800c\u8fd9\u79cd\u89c2\u70b9\u4f3c\u4e4e\u5e38\u5e38\u6f5c\u4f0f\u5728\u6570\u636e\u9a71\u52a8\u578b\u51b3\u7b56\u7684\u652f\u6301\u8005\u4e2d\uff0c\u8fd9\u79cd\u6001\u5ea6\u88ab\u8bbd\u523a\u4e3a \u201c\u5728\u5904\u7406\u504f\u5dee\u4e0a\uff0c\u673a\u5668\u5b66\u4e60\u4e0e\u6d17\u94b1\u7c7b\u4f3c\u201d\uff08machine learning is like money laundering for bias\uff09\u301086\u3011\u3002</li> </ul> <p>\u9884\u6d4b\u6027\u5206\u6790\u7cfb\u7edf\u53ea\u662f\u57fa\u4e8e\u8fc7\u53bb\u8fdb\u884c\u63a8\u65ad\uff1b\u5982\u679c\u8fc7\u53bb\u662f\u6b67\u89c6\u6027\u7684\uff0c\u5b83\u4eec\u5c31\u4f1a\u5c06\u8fd9\u79cd\u6b67\u89c6\u5f52\u7eb3\u4e3a\u89c4\u5f8b\u3002\u5982\u679c\u6211\u4eec\u5e0c\u671b\u672a\u6765\u6bd4\u8fc7\u53bb\u66f4\u597d\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u9053\u5fb7\u60f3\u8c61\u529b\uff0c\u800c\u8fd9\u662f\u53ea\u6709\u4eba\u7c7b\u624d\u80fd\u63d0\u4f9b\u7684\u4e1c\u897f\u301087\u3011\u3002\u6570\u636e\u4e0e\u6a21\u578b\u5e94\u8be5\u662f\u6211\u4eec\u7684\u5de5\u5177\uff0c\u800c\u4e0d\u662f\u6211\u4eec\u7684\u4e3b\u4eba\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_54","title":"\u8d23\u4efb\u4e0e\u95ee\u8d23","text":"<p>\u81ea\u52a8\u51b3\u7b56\u5f15\u53d1\u4e86\u5173\u4e8e\u8d23\u4efb\u4e0e\u95ee\u8d23\u7684\u95ee\u9898\u301087\u3011\u3002\u5982\u679c\u4e00\u4e2a\u4eba\u72af\u4e86\u9519\u8bef\uff0c\u4ed6\u53ef\u4ee5\u88ab\u8ffd\u8d23\uff0c\u53d7\u51b3\u5b9a\u5f71\u54cd\u7684\u4eba\u53ef\u4ee5\u7533\u8bc9\u3002\u7b97\u6cd5\u4e5f\u4f1a\u72af\u9519\u8bef\uff0c\u4f46\u662f\u5982\u679c\u5b83\u4eec\u51fa\u9519\uff0c\u8c01\u6765\u8d1f\u8d23\u301088\u3011\uff1f</p> <ul> <li>\u5f53\u4e00\u8f86\u81ea\u52a8\u9a7e\u9a76\u6c7d\u8f66\u5f15\u53d1\u4e8b\u6545\u65f6\uff0c\u8c01\u6765\u8d1f\u8d23\uff1f\u5982\u679c\u81ea\u52a8\u4fe1\u7528\u8bc4\u5206\u7b97\u6cd5\u7cfb\u7edf\u6027\u5730\u6b67\u89c6\u7279\u5b9a\u79cd\u65cf\u6216\u5b97\u6559\u7684\u4eba\uff0c\u8fd9\u4e9b\u4eba\u662f\u5426\u6709\u4efb\u4f55\u8ffd\u7d22\u6743\uff1f\u5982\u679c\u673a\u5668\u5b66\u4e60\u7cfb\u7edf\u7684\u51b3\u5b9a\u8981\u53d7\u5230\u53f8\u6cd5\u5ba1\u67e5\uff0c\u4f60\u80fd\u5411\u6cd5\u5b98\u89e3\u91ca\u7b97\u6cd5\u662f\u5982\u4f55\u505a\u51fa\u51b3\u5b9a\u7684\u5417\uff1f</li> </ul> <p>\u6536\u96c6\u5173\u4e8e\u4eba\u7684\u6570\u636e\u5e76\u8fdb\u884c\u51b3\u7b56\uff0c\u4fe1\u7528\u8bc4\u7ea7\u673a\u6784\u662f\u4e00\u4e2a\u5f88\u7ecf\u5178\u7684\u4f8b\u5b50\u3002</p> <ul> <li>\u4e0d\u826f\u7684\u4fe1\u7528\u8bc4\u5206\u4f1a\u4f7f\u751f\u6d3b\u53d8\u5f97\u66f4\u8270\u96be\uff0c\u4f46\u81f3\u5c11\u4fe1\u7528\u5206\u901a\u5e38\u662f\u57fa\u4e8e\u4e2a\u4eba \u5b9e\u9645\u7684 \u501f\u6b3e\u5386\u53f2\u8bb0\u5f55\uff0c\u800c\u8bb0\u5f55\u4e2d\u7684\u4efb\u4f55\u9519\u8bef\u90fd\u80fd\u88ab\u7ea0\u6b63\uff08\u5c3d\u7ba1\u673a\u6784\u901a\u5e38\u4f1a\u8bbe\u7f6e\u95e8\u69db\uff09\u3002</li> <li>\u7136\u800c\uff0c\u57fa\u4e8e\u673a\u5668\u5b66\u4e60\u7684\u8bc4\u5206\u7b97\u6cd5\u901a\u5e38\u4f1a\u4f7f\u7528\u66f4\u5bbd\u6cdb\u7684\u8f93\u5165\uff0c\u5e76\u4e14\u66f4\u4e0d\u900f\u660e\uff1b\u56e0\u800c\u5f88\u96be\u7406\u89e3\u7279\u5b9a\u51b3\u7b56\u662f\u600e\u6837\u4f5c\u51fa\u7684\uff0c\u4ee5\u53ca\u662f\u5426\u6709\u4eba\u88ab\u4e0d\u516c\u6b63\u5730\uff0c\u6b67\u89c6\u6027\u5730\u5bf9\u5f85\u301089\u3011\u3002</li> </ul> <p>\u4fe1\u7528\u5206\u603b\u7ed3\u4e86 \u201c\u4f60\u8fc7\u53bb\u7684\u8868\u73b0\u5982\u4f55\uff1f\u201d\uff0c\u800c\u9884\u6d4b\u6027\u5206\u6790\u901a\u5e38\u662f\u57fa\u4e8e \u201c\u8c01\u4e0e\u4f60\u7c7b\u4f3c\uff0c\u4ee5\u53ca\u4e0e\u4f60\u7c7b\u4f3c\u7684\u4eba\u8fc7\u53bb\u8868\u73b0\u7684\u5982\u4f55\uff1f\u201d\u3002</p> <ul> <li>\u4e0e\u4ed6\u4eba\u7684\u884c\u4e3a\u753b\u4e0a\u7b49\u53f7\u610f\u5473\u7740\u523b\u677f\u5370\u8c61\uff0c\u4f8b\u5982\uff0c\u6839\u636e\u4ed6\u4eec\u5c45\u4f4f\u7684\u5730\u65b9\uff08\u4e0e\u79cd\u65cf\u548c\u9636\u7ea7\u5173\u7cfb\u5bc6\u5207\u7684\u7279\u5f81\uff09\u3002\u90a3\u4e48\u90a3\u4e9b\u653e\u9519\u4f4d\u7f6e\u7684\u4eba\u600e\u4e48\u529e\uff1f\u800c\u4e14\uff0c\u5982\u679c\u662f\u56e0\u4e3a\u9519\u8bef\u6570\u636e\u5bfc\u81f4\u7684\u9519\u8bef\u51b3\u5b9a\uff0c\u8ffd\u7d22\u51e0\u4e4e\u662f\u4e0d\u53ef\u80fd\u7684\u301087\u3011\u3002</li> </ul> <p>\u5f88\u591a\u6570\u636e\u672c\u8d28\u4e0a\u662f\u7edf\u8ba1\u6027\u7684\uff0c\u8fd9\u610f\u5473\u7740\u5373\u4f7f\u6982\u7387\u5206\u5e03\u5728\u603b\u4f53\u4e0a\u662f\u6b63\u786e\u7684\uff0c\u5bf9\u4e8e\u4e2a\u4f8b\u4e5f\u53ef\u80fd\u662f\u9519\u8bef\u7684\u3002</p> <ul> <li>\u4f8b\u5982\uff0c\u5982\u679c\u8d35\u56fd\u7684\u5e73\u5747\u5bff\u547d\u662f 80 \u5c81\uff0c\u8fd9\u5e76\u4e0d\u610f\u5473\u7740\u4f60\u5728 80 \u5c81\u751f\u65e5\u65f6\u5c31\u4f1a\u6b7b\u6389\u3002\u5f88\u96be\u4ece\u5e73\u5747\u503c\u4e0e\u6982\u7387\u5206\u5e03\u4e2d\u5bf9\u67d0\u4e2a\u7279\u5b9a\u4e2a\u4f53\u7684\u5bff\u547d\u4f5c\u51fa\u4ec0\u4e48\u5224\u65ad\uff0c\u540c\u6837\uff0c\u9884\u6d4b\u7cfb\u7edf\u7684\u8f93\u51fa\u662f\u6982\u7387\u6027\u7684\uff0c\u5bf9\u4e8e\u4e2a\u4f8b\u53ef\u80fd\u662f\u9519\u8bef\u7684\u3002</li> </ul> <p>\u76f2\u76ee\u76f8\u4fe1\u6570\u636e\u51b3\u7b56\u81f3\u9ad8\u65e0\u4e0a\uff0c\u8fd9\u4e0d\u4ec5\u4ec5\u662f\u4e00\u79cd\u5984\u60f3\uff0c\u800c\u662f\u6709\u5207\u5b9e\u5371\u9669\u7684\u3002\u968f\u7740\u6570\u636e\u9a71\u52a8\u7684\u51b3\u7b56\u53d8\u5f97\u8d8a\u6765\u8d8a\u666e\u904d\uff0c\u6211\u4eec\u9700\u8981\u5f04\u6e05\u695a\uff0c\u5982\u4f55\u4f7f\u7b97\u6cd5\u66f4\u8d1f\u8d23\u4efb\u4e14\u66f4\u52a0\u900f\u660e\uff0c\u5982\u4f55\u907f\u514d\u52a0\u5f3a\u73b0\u6709\u7684\u504f\u89c1\uff0c\u4ee5\u53ca\u5982\u4f55\u5728\u5b83\u4eec\u4e0d\u53ef\u907f\u514d\u5730\u51fa\u9519\u65f6\u52a0\u4ee5\u4fee\u590d\u3002</p> <p>\u8fd8\u9700\u8981\u60f3\u6e05\u695a\uff0c\u5982\u4f55\u907f\u514d\u6570\u636e\u88ab\u7528\u4e8e\u5bb3\u4eba\uff0c\u5982\u4f55\u8ba4\u8bc6\u6570\u636e\u7684\u79ef\u6781\u6f5c\u529b\u3002\u4f8b\u5982\uff0c\u5206\u6790\u53ef\u4ee5\u63ed\u793a\u4eba\u4eec\u751f\u6d3b\u7684\u8d22\u52a1\u7279\u70b9\u4e0e\u793e\u4f1a\u7279\u70b9\u3002</p> <ul> <li>\u4e00\u65b9\u9762\uff0c\u8fd9\u79cd\u6743\u529b\u53ef\u4ee5\u7528\u6765\u5c06\u63f4\u52a9\u4e0e\u652f\u6301\u96c6\u4e2d\u5728\u5e2e\u52a9\u90a3\u4e9b\u6700\u9700\u8981\u63f4\u52a9\u7684\u4eba\u8eab\u4e0a\u3002</li> <li>\u53e6\u4e00\u65b9\u9762\uff0c\u5b83\u6709\u65f6\u4f1a\u88ab\u63a0\u593a\u6027\u4f01\u4e1a\u7528\u4e8e\u8bc6\u522b\u5f31\u52bf\u7fa4\u4f53\uff0c\u5e76\u5411\u5176\u515c\u552e\u9ad8\u98ce\u9669\u4ea7\u54c1\uff0c\u6bd4\u5982\u9ad8\u5229\u8d37\u548c\u6ca1\u6709\u4ef7\u503c\u7684\u5927\u5b66\u6587\u51ed\u301087,90\u3011\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_55","title":"\u53cd\u9988\u5faa\u73af","text":"<p>\u5373\u4f7f\u662f\u90a3\u4e9b\u5bf9\u4eba\u76f4\u63a5\u5f71\u54cd\u6bd4\u8f83\u5c0f\u7684\u9884\u6d4b\u6027\u5e94\u7528\uff0c\u6bd4\u5982\u63a8\u8350\u7cfb\u7edf\uff0c\u4e5f\u6709\u4e00\u4e9b\u5fc5\u987b\u6b63\u89c6\u7684\u96be\u9898\u3002\u5f53\u670d\u52a1\u53d8\u5f97\u5584\u4e8e\u9884\u6d4b\u7528\u6237\u60f3\u8981\u770b\u5230\u4ec0\u4e48\u5185\u5bb9\u65f6\uff0c\u5b83\u6700\u7ec8\u53ef\u80fd\u53ea\u4f1a\u5411\u4eba\u4eec\u5c55\u793a\u4ed6\u4eec\u5df2\u7ecf\u540c\u610f\u7684\u89c2\u70b9\uff0c\u5c06\u4eba\u4eec\u5e26\u5165\u6ecb\u751f\u523b\u677f\u5370\u8c61\uff0c\u8bef\u5bfc\u4fe1\u606f\uff0c\u4e0e\u6781\u7aef\u601d\u60f3\u7684 \u56de\u97f3\u5ba4\u3002\u6211\u4eec\u5df2\u7ecf\u770b\u5230\u8fc7\u793e\u4ea4\u5a92\u4f53\u56de\u97f3\u5ba4\u5bf9\u7ade\u9009\u7684\u5f71\u54cd\u4e86\u301091\u3011\u3002</p> <p>\u5f53\u9884\u6d4b\u6027\u5206\u6790\u5f71\u54cd\u4eba\u4eec\u7684\u751f\u6d3b\u65f6\uff0c\u81ea\u6211\u5f3a\u5316\u7684\u53cd\u9988\u5faa\u73af\u4f1a\u5bfc\u81f4\u975e\u5e38\u6709\u5bb3\u7684\u95ee\u9898\u3002\u4f8b\u5982\uff0c\u8003\u8651\u96c7\u4e3b\u4f7f\u7528\u4fe1\u7528\u5206\u6765\u8bc4\u4f30\u5019\u9009\u4eba\u7684\u4f8b\u5b50\u3002</p> <ul> <li>\u4f60\u53ef\u80fd\u662f\u4e00\u4e2a\u4fe1\u7528\u5206\u4e0d\u9519\u7684\u597d\u5458\u5de5\uff0c\u4f46\u56e0\u4e0d\u53ef\u6297\u529b\u7684\u610f\u5916\u800c\u9677\u5165\u8d22\u52a1\u56f0\u5883\u3002\u7531\u4e8e\u4e0d\u80fd\u6309\u671f\u4ed8\u8d26\u5355\uff0c\u4f60\u7684\u4fe1\u7528\u5206\u4f1a\u53d7\u5230\u5f71\u54cd\uff0c\u8fdb\u800c\u5bfc\u81f4\u627e\u5230\u5de5\u4f5c\u66f4\u4e3a\u56f0\u96be\u3002</li> <li>\u5931\u4e1a\u4f7f\u4f60\u9677\u5165\u8d2b\u56f0\uff0c\u8fd9\u8fdb\u4e00\u6b65\u6076\u5316\u4e86\u4f60\u7684\u5206\u6570\uff0c\u4f7f\u4f60\u66f4\u96be\u627e\u5230\u5de5\u4f5c\u301087\u3011\u3002\u5728\u6570\u636e\u4e0e\u6570\u5b66\u4e25\u8c28\u6027\u7684\u4f2a\u88c5\u80cc\u540e\uff0c\u9690\u85cf\u7684\u662f\u7531\u6076\u6bd2\u5047\u8bbe\u5bfc\u81f4\u7684\u6076\u6027\u5faa\u73af\u3002</li> </ul> <p>\u6211\u4eec\u65e0\u6cd5\u9884\u6d4b\u8fd9\u79cd\u53cd\u9988\u5faa\u73af\u4f55\u65f6\u53d1\u751f\u3002\u7136\u800c\u901a\u8fc7\u5bf9\u6574\u4e2a\u7cfb\u7edf\uff08\u4e0d\u4ec5\u4ec5\u662f\u8ba1\u7b97\u673a\u5316\u7684\u90e8\u5206\uff0c\u800c\u4e14\u8fd8\u6709\u4e0e\u4e4b\u4e92\u52a8\u7684\u4eba\uff09\u8fdb\u884c\u6574\u4f53\u601d\u8003\uff0c\u8bb8\u591a\u540e\u679c\u662f\u53ef\u4ee5\u591f\u9884\u6d4b\u7684 \u2014\u2014 \u4e00\u79cd\u79f0\u4e3a \u7cfb\u7edf\u601d\u7ef4\uff08systems thinking\uff09 \u7684\u65b9\u6cd5\u301092\u3011\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u7406\u89e3\u6570\u636e\u5206\u6790\u7cfb\u7edf\u5982\u4f55\u54cd\u5e94\u4e0d\u540c\u7684\u884c\u4e3a\uff0c\u7ed3\u6784\u6216\u7279\u6027\u3002\u8be5\u7cfb\u7edf\u662f\u5426\u52a0\u5f3a\u548c\u589e\u5927\u4e86\u4eba\u4eec\u4e4b\u95f4\u73b0\u6709\u7684\u5dee\u5f02\uff08\u4f8b\u5982\uff0c\u635f\u4e0d\u8db3\u4ee5\u5949\u6709\u4f59\uff0c\u5bcc\u8005\u6108\u5bcc\uff0c\u8d2b\u8005\u6108\u8d2b\uff09\uff0c\u8fd8\u662f\u8bd5\u56fe\u4e0e\u4e0d\u516c\u4f5c\u6597\u4e89\uff1f\u800c\u4e14\u5373\u4f7f\u6709\u7740\u6700\u597d\u7684\u52a8\u673a\uff0c\u6211\u4eec\u4e5f\u5fc5\u987b\u5f53\u5fc3\u610f\u60f3\u4e0d\u5230\u7684\u540e\u679c\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_56","title":"\u9690\u79c1\u548c\u8ffd\u8e2a","text":"<p>\u9664\u4e86\u9884\u6d4b\u6027\u5206\u6790 \u2014\u2014 \u4f7f\u7528\u6570\u636e\u6765\u505a\u51fa\u5173\u4e8e\u4eba\u7684\u81ea\u52a8\u51b3\u7b56 \u2014\u2014 \u6570\u636e\u6536\u96c6\u672c\u8eab\u4e5f\u5b58\u5728\u9053\u5fb7\u95ee\u9898\u3002\u6536\u96c6\u6570\u636e\u7684\u7ec4\u7ec7\uff0c\u4e0e\u88ab\u6536\u96c6\u6570\u636e\u7684\u4eba\u4e4b\u95f4\uff0c\u5230\u5e95\u5c5e\u4e8e\u4ec0\u4e48\u5173\u7cfb\uff1f</p> <p>\u5f53\u7cfb\u7edf\u53ea\u5b58\u50a8\u7528\u6237\u660e\u786e\u8f93\u5165\u7684\u6570\u636e\u65f6\uff0c\u662f\u56e0\u4e3a\u7528\u6237\u5e0c\u671b\u7cfb\u7edf\u4ee5\u7279\u5b9a\u65b9\u5f0f\u5b58\u50a8\u548c\u5904\u7406\u8fd9\u4e9b\u6570\u636e\uff0c\u7cfb\u7edf\u662f\u5728\u4e3a\u7528\u6237\u63d0\u4f9b\u670d\u52a1\uff1a\u7528\u6237\u5c31\u662f\u5ba2\u6237\u3002\u4f46\u662f\uff0c\u5f53\u7528\u6237\u7684\u6d3b\u52a8\u88ab\u8ddf\u8e2a\u5e76\u8bb0\u5f55\uff0c\u4f5c\u4e3a\u4ed6\u4eec\u6b63\u5728\u505a\u7684\u5176\u4ed6\u4e8b\u60c5\u7684\u526f\u4f5c\u7528\u65f6\uff0c\u8fd9\u79cd\u5173\u7cfb\u5c31\u6ca1\u6709\u90a3\u4e48\u6e05\u6670\u4e86\u3002\u8be5\u670d\u52a1\u4e0d\u518d\u4ec5\u4ec5\u5b8c\u6210\u7528\u6237\u60f3\u8981\u5b83\u8981\u505a\u7684\u4e8b\u60c5\uff0c\u800c\u662f\u670d\u52a1\u4e8e\u5b83\u81ea\u5df1\u7684\u5229\u76ca\uff0c\u800c\u8fd9\u53ef\u80fd\u4e0e\u7528\u6237\u7684\u5229\u76ca\u76f8\u51b2\u7a81\u3002</p> <p>\u8ffd\u8e2a\u7528\u6237\u884c\u4e3a\u6570\u636e\u5bf9\u4e8e\u8bb8\u591a\u9762\u5411\u7528\u6237\u7684\u5728\u7ebf\u670d\u52a1\u800c\u8a00\uff0c\u53d8\u5f97\u8d8a\u6765\u8d8a\u91cd\u8981\uff1a\u8ffd\u8e2a\u7528\u6237\u70b9\u51fb\u4e86\u54ea\u4e9b\u641c\u7d22\u7ed3\u679c\u6709\u52a9\u4e8e\u6539\u5584\u641c\u7d22\u7ed3\u679c\u7684\u6392\u540d\uff1b\u63a8\u8350 \u201c\u559c\u6b22 X \u7684\u4eba\u4e5f\u559c\u6b22 Y\u201d\uff0c\u53ef\u4ee5\u5e2e\u52a9\u7528\u6237\u53d1\u73b0\u5b9e\u7528\u6709\u8da3\u7684\u4e1c\u897f\uff1bA/B \u6d4b\u8bd5\u548c\u7528\u6237\u6d41\u91cf\u5206\u6790\u6709\u52a9\u4e8e\u6539\u5584\u7528\u6237\u754c\u9762\u3002\u8fd9\u4e9b\u529f\u80fd\u9700\u8981\u4e00\u5b9a\u91cf\u7684\u7528\u6237\u884c\u4e3a\u8ddf\u8e2a\uff0c\u800c\u7528\u6237\u4e5f\u53ef\u4ee5\u4ece\u4e2d\u53d7\u76ca\u3002</p> <p>\u4f46\u4e0d\u540c\u516c\u53f8\u6709\u7740\u4e0d\u540c\u7684\u5546\u4e1a\u6a21\u5f0f\uff0c\u8ffd\u8e2a\u5e76\u672a\u6b62\u6b65\u4e8e\u6b64\u3002\u5982\u679c\u670d\u52a1\u662f\u901a\u8fc7\u5e7f\u544a\u76c8\u5229\u7684\uff0c\u90a3\u4e48\u5e7f\u544a\u4e3b\u624d\u662f\u771f\u6b63\u7684\u5ba2\u6237\uff0c\u800c\u7528\u6237\u7684\u5229\u76ca\u5219\u5c48\u5c45\u5176\u6b21\u3002\u8ddf\u8e2a\u7684\u6570\u636e\u4f1a\u53d8\u5f97\u66f4\u8be6\u7ec6\uff0c\u5206\u6790\u53d8\u5f97\u66f4\u6df1\u5165\uff0c\u6570\u636e\u4f1a\u4fdd\u7559\u5f88\u957f\u65f6\u95f4\uff0c\u4ee5\u4fbf\u4e3a\u6bcf\u4e2a\u4eba\u5efa\u7acb\u8be6\u7ec6\u753b\u50cf\uff0c\u7528\u4e8e\u8425\u9500\u3002</p> <p>\u73b0\u5728\uff0c\u516c\u53f8\u4e0e\u88ab\u6536\u96c6\u6570\u636e\u7684\u7528\u6237\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u770b\u4e0a\u53bb\u5c31\u4e0d\u592a\u4e00\u6837\u4e86\u3002\u516c\u53f8\u4f1a\u514d\u8d39\u670d\u52a1\u7528\u6237\uff0c\u5e76\u5f15\u8bf1\u7528\u6237\u5c3d\u53ef\u80fd\u591a\u5730\u4f7f\u7528\u670d\u52a1\u3002\u5bf9\u7528\u6237\u7684\u8ffd\u8e2a\uff0c\u4e3b\u8981\u4e0d\u662f\u670d\u52a1\u4e8e\u8be5\u7528\u6237\u4e2a\u4f53\uff0c\u800c\u662f\u670d\u52a1\u4e8e\u638f\u94b1\u8d44\u52a9\u8be5\u670d\u52a1\u7684\u5e7f\u544a\u5546\u3002\u6211\u8ba4\u4e3a\u8fd9\u79cd\u5173\u7cfb\u53ef\u4ee5\u7528\u4e00\u4e2a\u66f4\u5177\u7f6a\u72af\u5185\u6db5\u7684\u8bcd\u6765\u6070\u5f53\u5730\u63cf\u8ff0\uff1a\u76d1\u89c6\uff08surveilance\uff09\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_57","title":"\u76d1\u89c6","text":"<p>\u5c1d\u8bd5\u7528 \u76d1\u89c6\uff08surveillance\uff09 \u4e00\u8bcd\u66ff\u6362 \u6570\u636e\uff08data\uff09\uff0c\u518d\u770b\u770b\u5e38\u89c1\u7684\u77ed\u8bed\u662f\u4e0d\u662f\u542c\u8d77\u6765\u8fd8\u90a3\u4e48\u6f02\u4eae\u301093\u3011\u3002\u6bd4\u5982\uff1a\u201c\u5728\u6211\u4eec\u7684\u76d1\u89c6\u9a71\u52a8\u7684\u7ec4\u7ec7\u4e2d\uff0c\u6211\u4eec\u6536\u96c6\u5b9e\u65f6\u76d1\u89c6\u6d41\u5e76\u5c06\u5b83\u4eec\u5b58\u50a8\u5728\u6211\u4eec\u7684\u76d1\u89c6\u4ed3\u5e93\u4e2d\u3002\u6211\u4eec\u7684\u76d1\u89c6\u79d1\u5b66\u5bb6\u4f7f\u7528\u9ad8\u7ea7\u5206\u6790\u548c\u76d1\u89c6\u5904\u7406\u6765\u83b7\u5f97\u65b0\u7684\u89c1\u89e3\u3002\u201d</p> <p>\u5728\u6211\u4eec\u5c1d\u8bd5\u5236\u9020\u8f6f\u4ef6 \u201c\u541e\u566c\u4e16\u754c\u201d \u7684\u8fc7\u7a0b\u4e2d\u301094\u3011\uff0c\u6211\u4eec\u5df2\u7ecf\u5efa\u7acb\u4e86\u4e16\u754c\u4e0a\u8fc4\u4eca\u4e3a\u6b62\u6240\u89c1\u8fc7\u7684\u6700\u4f1f\u5927\u7684\u5927\u89c4\u6a21\u76d1\u89c6\u57fa\u7840\u8bbe\u65bd\u3002</p> <ul> <li>\u6b63\u671d\u7740\u4e07\u7269\u4e92\u8054\u8fc8\u8fdb\uff1a\u6bcf\u4e2a\u6709\u4eba\u5c45\u4f4f\u7684\u7a7a\u95f4\u81f3\u5c11\u5305\u542b\u4e00\u4e2a\u5e26\u4e92\u8054\u7f51\u8fde\u63a5\u7684\u9ea6\u514b\u98ce\uff0c\u4ee5\u667a\u80fd\u624b\u673a\u3001\u667a\u80fd\u7535\u89c6\u3001\u8bed\u97f3\u63a7\u5236\u52a9\u7406\u8bbe\u5907\u3001\u5a74\u513f\u76d1\u89c6\u5668\u751a\u81f3\u513f\u7ae5\u73a9\u5177\u7684\u5f62\u5f0f\u5b58\u5728\uff0c\u5e76\u4f7f\u7528\u57fa\u4e8e\u4e91\u7684\u8bed\u97f3\u8bc6\u522b\u3002\u8fd9\u4e9b\u8bbe\u5907\u4e2d\u7684\u5f88\u591a\u90fd\u6709\u7740\u53ef\u6015\u7684\u5b89\u5168\u8bb0\u5f55\u301095\u3011\u3002</li> </ul> <p>\u6211\u4eec\u663e\u7136\u662f\u81ea\u613f\u5730\uff0c\u751a\u81f3\u70ed\u60c5\u5730\u6295\u8eab\u4e8e\u8fd9\u4e2a\u5168\u57df\u76d1\u89c6\u7684\u4e16\u754c\u3002\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0c\u6570\u636e\u662f\u7531\u516c\u53f8\uff0c\u800c\u4e0d\u662f\u7531\u653f\u5e9c\u673a\u6784\u6536\u96c6\u7684\u301096\u3011\u3002</p> <p>\u4f60\u4e0e\u5f53\u6743\u9636\u7ea7\u7a7f\u4e00\u6761\u88e4\u5b50\uff0c\u4f60\u4e0d\u662f\u88ab\u8fb9\u7f18\u5316\u7684\u5c11\u6570\u6d3e\uff0c\u4e5f\u4e0d\u5fc5\u5bb3\u6015\u53d7\u5230\u8feb\u5bb3\u301097\u3011\u3002</p> <ul> <li>\u4e0d\u662f\u6bcf\u4e2a\u4eba\u90fd\u5982\u6b64\u5e78\u8fd0\u3002\u6216\u8005\uff0c\u4e5f\u8bb8\u8fd9\u662f\u56e0\u4e3a\u76ee\u7684\u4f3c\u4e4e\u662f\u6e29\u548c\u7684 \u2014\u2014 \u8fd9\u4e0d\u662f\u516c\u7136\u80c1\u8feb\uff0c\u4e5f\u4e0d\u662f\u5f3a\u5236\u6027\u7684\uff0c\u800c\u53ea\u662f\u66f4\u597d\u7684\u63a8\u8350\u4e0e\u66f4\u4e2a\u6027\u5316\u7684\u8425\u9500\u3002</li> </ul> <p>\u6211\u4eec\u5df2\u7ecf\u770b\u5230\u4e0e\u6c7d\u8f66\u8ffd\u8e2a\u8bbe\u5907\u6302\u94a9\u7684\u6c7d\u8f66\u4fdd\u9669\u8d39\uff0c\u4ee5\u53ca\u53d6\u51b3\u4e8e\u9700\u8981\u4eba\u4f69\u6234\u5065\u8eab\u8ffd\u8e2a\u8bbe\u5907\u6765\u786e\u5b9a\u7684\u5065\u5eb7\u4fdd\u9669\u8303\u56f4\u3002\u5f53\u76d1\u89c6\u88ab\u7528\u4e8e\u51b3\u5b9a\u751f\u6d3b\u7684\u91cd\u8981\u65b9\u9762\u65f6\uff0c\u4f8b\u5982\u4fdd\u9669\u6216\u5c31\u4e1a\uff0c\u5b83\u5c31\u5f00\u59cb\u53d8\u5f97\u4e0d\u90a3\u4e48\u6e29\u548c\u4e86\u3002</p> <ul> <li>\u4f8b\u5982\uff0c\u667a\u80fd\u624b\u8868\u6216\u5065\u8eab\u8ffd\u8e2a\u5668\u4e2d\u7684\u8fd0\u52a8\u4f20\u611f\u5668\u80fd\u4ee5\u76f8\u5f53\u597d\u7684\u7cbe\u5ea6\u8ba1\u7b97\u51fa\u4f60\u6b63\u5728\u8f93\u5165\u7684\u5185\u5bb9\uff08\u6bd4\u5982\u5bc6\u7801\uff09\u301098\u3011\u3002\u800c\u5206\u6790\u7b97\u6cd5\u53ea\u4f1a\u53d8\u5f97\u8d8a\u6765\u8d8a\u7cbe\u786e\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/12_the_future.html#_58","title":"\u540c\u610f\u4e0e\u9009\u62e9\u7684\u81ea\u7531","text":"<p>\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u58f0\u79f0\uff0c\u7528\u6237\u5728\u7528\u6240\u63d0\u4f9b\u7684\u6570\u636e\u6765 \u6362\u53d6 \u6709\u4ef7\u503c\u7684\u670d\u52a1\uff0c\u5e76\u4e14\u4e3a\u4e86\u63d0\u4f9b\u670d\u52a1\uff0c\u8ffd\u8e2a\u662f\u5fc5\u8981\u7684\u3002\u4f46\u662f\u8fd9\u4e2a\u8bf4\u6cd5\u5374\u5b58\u5728\u95ee\u9898\u3002</p> <ul> <li>\u5927\u591a\u6570\u9690\u79c1\u653f\u7b56\u90fd\u662f\u6a21\u68f1\u4e24\u53ef\uff1a\u7528\u6237\u51e0\u4e4e\u4e0d\u77e5\u9053\u4ed6\u4eec\u63d0\u4f9b\u7ed9\u6211\u4eec\u7684\u662f\u4ec0\u4e48\u6570\u636e\uff0c\u54ea\u4e9b\u6570\u636e\u88ab\u653e\u8fdb\u4e86\u6570\u636e\u5e93\uff0c\u6570\u636e\u53c8\u662f\u600e\u6837\u88ab\u4fdd\u7559\u4e0e\u5904\u7406\u7684\u3002</li> <li>\u4ece\u7528\u6237\u8eab\u4e0a\u6316\u6398\u6570\u636e\u662f\u4e00\u4e2a\u5355\u5411\u8fc7\u7a0b\uff0c\u800c\u4e0d\u662f\u771f\u6b63\u7684\u4e92\u60e0\u5173\u7cfb\uff0c\u4e5f\u4e0d\u662f\u516c\u5e73\u7684\u4ef7\u503c\u4ea4\u6362\u3002\u670d\u52a1\u4e0e\u7528\u6237\u4e4b\u95f4\u7684\u5173\u7cfb\u662f\u975e\u5e38\u4e0d\u5bf9\u79f0\u4e0e\u5355\u8fb9\u7684\u3002\u8fd9\u4e9b\u6761\u6b3e\u662f\u7531\u670d\u52a1\u63d0\u51fa\u7684\uff0c\u800c\u4e0d\u662f\u7531\u7528\u6237\u63d0\u51fa\u7684\u301099\u3011\u3002</li> </ul> <p>\u5bf9\u4e8e\u4e0d\u540c\u610f\u76d1\u89c6\u7684\u7528\u6237\uff0c\u552f\u4e00\u771f\u6b63\u7ba1\u7528\u7684\u5907\u9009\u9879\uff0c\u5c31\u662f\u7b80\u5355\u5730\u4e0d\u4f7f\u7528\u670d\u52a1\u3002\u4f46\u8fd9\u4e2a\u9009\u62e9\u4e5f\u4e0d\u662f\u771f\u6b63\u81ea\u7531\u7684\uff1a\u5982\u679c\u4e00\u9879\u670d\u52a1\u5982\u6b64\u53d7\u6b22\u8fce\uff0c\u4ee5\u81f3\u4e8e \u201c\u88ab\u5927\u591a\u6570\u4eba\u8ba4\u4e3a\u662f\u57fa\u672c\u793e\u4f1a\u53c2\u4e0e\u7684\u5fc5\u8981\u6761\u4ef6\u201d\u301099\u3011\uff0c\u90a3\u4e48\u6307\u671b\u4eba\u4eec\u9009\u62e9\u9000\u51fa\u8fd9\u9879\u670d\u52a1\u662f\u4e0d\u5408\u7406\u7684 \u2014\u2014 \u4f7f\u7528\u5b83 \u4e8b\u5b9e\u4e0a\uff08de facto\uff09 \u662f\u5f3a\u5236\u6027\u7684\u3002</p> <p>\u56e0\u4e3a\u4e00\u4e2a\u670d\u52a1\u4f1a\u8ddf\u8e2a\u7528\u6237\u800c\u62d2\u7edd\u4f7f\u7528\u5b83\uff0c\u8fd9\u53ea\u662f\u5c11\u6570\u4eba\u624d\u62e5\u6709\u7684\u6743\u529b\uff0c\u4ed6\u4eec\u6709\u8db3\u591f\u7684\u65f6\u95f4\u4e0e\u77e5\u8bc6\u6765\u4e86\u89e3\u9690\u79c1\u653f\u7b56\uff0c\u5e76\u627f\u53d7\u5f97\u8d77\u4ee3\u4ef7\uff1a\u9519\u8fc7\u793e\u4f1a\u53c2\u4e0e\uff0c\u4ee5\u53ca\u4f7f\u7528\u670d\u52a1\u53ef\u80fd\u5e26\u6765\u7684\u4e13\u4e1a\u673a\u4f1a\u3002\u5bf9\u4e8e\u90a3\u4e9b\u5904\u5883\u4e0d\u592a\u597d\u7684\u4eba\u800c\u8a00\uff0c\u5e76\u6ca1\u6709\u771f\u6b63\u610f\u4e49\u4e0a\u7684\u9009\u62e9\uff1a\u76d1\u63a7\u662f\u4e0d\u53ef\u907f\u514d\u7684\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_59","title":"\u9690\u79c1\u4e0e\u6570\u636e\u4f7f\u7528","text":"<p>\u62e5\u6709\u9690\u79c1\u5e76\u4e0d\u610f\u5473\u7740\u4fdd\u5bc6\u4e00\u5207\u4e1c\u897f\uff1b\u5b83\u610f\u5473\u7740\u62e5\u6709\u9009\u62e9\u5411\u8c01\u5c55\u793a\u54ea\u4e9b\u4e1c\u897f\u7684\u81ea\u7531\uff0c\u8981\u516c\u5f00\u4ec0\u4e48\uff0c\u4ee5\u53ca\u8981\u4fdd\u5bc6\u4ec0\u4e48\u3002\u9690\u79c1\u6743\u662f\u4e00\u9879\u51b3\u5b9a\u6743\uff1a\u5728\u4ece\u4fdd\u5bc6\u5230\u900f\u660e\u7684\u5149\u8c31\u4e0a\uff0c\u9690\u79c1\u4f7f\u5f97\u6bcf\u4e2a\u4eba\u90fd\u80fd\u51b3\u5b9a\u81ea\u5df1\u60f3\u8981\u5728\u4ec0\u4e48\u5730\u65b9\u4f4d\u4e8e\u5149\u8c31\u4e0a\u7684\u54ea\u4e2a\u4f4d\u7f6e\u301099\u3011\u3002\u8fd9\u662f\u4e00\u4e2a\u4eba\u81ea\u7531\u4e0e\u81ea\u4e3b\u7684\u91cd\u8981\u65b9\u9762\u3002</p> <p>\u5f53\u901a\u8fc7\u76d1\u63a7\u57fa\u7840\u8bbe\u65bd\u4ece\u4eba\u8eab\u4e0a\u63d0\u53d6\u6570\u636e\u65f6\uff0c\u9690\u79c1\u6743\u4e0d\u4e00\u5b9a\u53d7\u5230\u635f\u5bb3\uff0c\u800c\u662f\u8f6c\u79fb\u5230\u4e86\u6570\u636e\u6536\u96c6\u8005\u624b\u4e2d\u3002\u83b7\u53d6\u6570\u636e\u7684\u516c\u53f8\u5b9e\u9645\u4e0a\u662f\u8bf4 \u201c\u76f8\u4fe1\u6211\u4eec\u4f1a\u7528\u4f60\u7684\u6570\u636e\u505a\u6b63\u786e\u7684\u4e8b\u60c5\u201d\uff0c\u8fd9\u610f\u5473\u7740\uff0c\u51b3\u5b9a\u8981\u900f\u9732\u4ec0\u4e48\u548c\u4fdd\u5bc6\u4ec0\u4e48\u7684\u6743\u5229\u4ece\u4e2a\u4f53\u624b\u4e2d\u8f6c\u79fb\u5230\u4e86\u516c\u53f8\u624b\u4e2d\u3002</p> <p>\u8fd9\u4e9b\u516c\u53f8\u53cd\u8fc7\u6765\u9009\u62e9\u4fdd\u5bc6\u8fd9\u4e9b\u76d1\u89c6\u7ed3\u679c\uff0c\u56e0\u4e3a\u63ed\u9732\u8fd9\u4e9b\u4f1a\u4ee4\u4eba\u6bdb\u9aa8\u609a\u7136\uff0c\u5e76\u635f\u5bb3\u5b83\u4eec\u7684\u5546\u4e1a\u6a21\u5f0f\uff08\u6bd4\u5176\u4ed6\u516c\u53f8\u66f4\u4e86\u89e3\u4eba\uff09\u3002\u7528\u6237\u7684\u79c1\u5bc6\u4fe1\u606f\u53ea\u4f1a\u95f4\u63a5\u5730\u62ab\u9732\uff0c\u4f8b\u5982\u9488\u5bf9\u7279\u5b9a\u4eba\u7fa4\u5b9a\u5411\u6295\u653e\u5e7f\u544a\u7684\u5de5\u5177\uff08\u6bd4\u5982\u90a3\u4e9b\u60a3\u6709\u7279\u5b9a\u75be\u75c5\u7684\u4eba\u7fa4\uff09\u3002</p> <ul> <li>\u51b3\u5b9a\u5411\u8c01\u900f\u9732\u4ec0\u4e48\u5e76\u4e0d\u662f\u7531\u4e2a\u4f53\u6309\u7167\u81ea\u5df1\u7684\u559c\u597d\u51b3\u5b9a\u7684\uff0c\u800c\u662f\u7531 \u516c\u53f8\uff0c\u4ee5\u5229\u6da6\u6700\u5927\u5316\u4e3a\u76ee\u6807\u6765\u884c\u4f7f\u9690\u79c1\u6743\u3002</li> </ul> <p>\u5141\u8bb8\u5728\u7ebf\u670d\u52a1\u7684\u7528\u6237\u63a7\u5236\u5176\u9690\u79c1\u8bbe\u7f6e\uff0c\u4f8b\u5982\u63a7\u5236\u5176\u4ed6\u7528\u6237\u53ef\u4ee5\u770b\u5230\u54ea\u4e9b\u4e1c\u897f\uff0c\u662f\u5c06\u4e00\u4e9b\u63a7\u5236\u4ea4\u8fd8\u7ed9\u7528\u6237\u7684\u7b2c\u4e00\u6b65\u3002\u4f46\u670d\u52a1\u672c\u8eab\u4ecd\u7136\u53ef\u4ee5\u4e0d\u53d7\u9650\u5236\u5730\u8bbf\u95ee\u6570\u636e\uff0c\u5e76\u80fd\u4ee5\u9690\u79c1\u7b56\u7565\u5141\u8bb8\u7684\u4efb\u4f55\u65b9\u5f0f\u81ea\u7531\u4f7f\u7528\u5b83\u3002\u5373\u4f7f\u670d\u52a1\u627f\u8bfa\u4e0d\u4f1a\u5c06\u6570\u636e\u51fa\u552e\u7ed9\u7b2c\u4e09\u65b9\uff0c\u5b83\u901a\u5e38\u4f1a\u6388\u4e88\u81ea\u5df1\u4e0d\u53d7\u9650\u5236\u7684\u6743\u5229\uff0c\u4ee5\u4fbf\u5728\u5185\u90e8\u5904\u7406\u4e0e\u5206\u6790\u6570\u636e\uff0c\u800c\u4e14\u5f80\u5f80\u6bd4\u7528\u6237\u516c\u5f00\u53ef\u89c1\u7684\u90e8\u5206\u8981\u6df1\u5165\u7684\u591a\u3002</p> <p>\u8fd9\u79cd\u4ece\u4e2a\u4f53\u5230\u516c\u53f8\u7684\u5927\u89c4\u6a21\u9690\u79c1\u6743\u8f6c\u79fb\u5728\u5386\u53f2\u4e0a\u662f\u53f2\u65e0\u524d\u4f8b\u7684\u301099\u3011\u3002\u76d1\u63a7\u4e00\u76f4\u5b58\u5728\uff0c\u4f46\u5b83\u8fc7\u53bb\u662f\u6602\u8d35\u7684\u3001\u624b\u52a8\u7684\uff0c\u4e0d\u662f\u53ef\u4f38\u7f29\u7684\u3001\u81ea\u52a8\u5316\u7684\u3002\u4fe1\u4efb\u5173\u7cfb\u4e00\u76f4\u5b58\u5728\uff0c\u4f8b\u5982\u60a3\u8005\u4e0e\u5176\u533b\u751f\u4e4b\u95f4\uff0c\u6216\u88ab\u544a\u4e0e\u5176\u5f8b\u5e08\u4e4b\u95f4 \u2014\u2014 \u4f46\u5728\u8fd9\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6570\u636e\u7684\u4f7f\u7528\u4e25\u683c\u53d7\u5230\u9053\u5fb7\uff0c\u6cd5\u5f8b\u548c\u76d1\u7ba1\u9650\u5236\u7684\u7ea6\u675f\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_60","title":"\u6570\u636e\u8d44\u4ea7\u4e0e\u6743\u529b","text":"<p>\u4ece\u7ecf\u6d4e\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u5982\u679c\u5b9a\u5411\u5e7f\u544a\u662f\u670d\u52a1\u7684\u91d1\u4e3b\uff0c\u90a3\u4e48\u5173\u4e8e\u4eba\u7684\u884c\u4e3a\u6570\u636e\u5c31\u662f\u670d\u52a1\u7684\u6838\u5fc3\u8d44\u4ea7\u3002</p> <ul> <li>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u4e0e\u4e4b\u4ea4\u4e92\u7684\u5e94\u7528\u4ec5\u4ec5\u662f\u4e00\u79cd\u8bf1\u9a97\u7528\u6237\u5c06\u66f4\u591a\u7684\u4e2a\u4eba\u4fe1\u606f\u63d0\u4f9b\u7ed9\u76d1\u63a7\u57fa\u7840\u8bbe\u65bd\u7684\u624b\u6bb5\u301099\u3011\u3002</li> </ul> <p>\u4e2a\u4eba\u6570\u636e\u662f\u73cd\u8d35\u8d44\u4ea7\u7684\u8bf4\u6cd5\u56e0\u4e3a\u6570\u636e\u4e2d\u4ecb\u7684\u5b58\u5728\u5f97\u5230\u652f\u6301\uff0c\u8fd9\u662f\u9634\u5f71\u4e2d\u7684\u79d8\u5bc6\u884c\u4e1a\uff0c\u8d2d\u4e70\u3001\u805a\u5408\u3001\u5206\u6790\u3001\u63a8\u65ad\u4ee5\u53ca\u8f6c\u552e\u79c1\u5bc6\u4e2a\u4eba\u6570\u636e\uff0c\u4e3b\u8981\u7528\u4e8e\u5e02\u573a\u8425\u9500\u301090\u3011\u3002\u521d\u521b\u516c\u53f8\u6309\u7167\u5b83\u4eec\u7684\u7528\u6237\u6570\u91cf\uff0c\u201c\u773c\u7403\u6570\u201d\uff0c\u2014\u2014 \u5373\u5b83\u4eec\u7684\u76d1\u89c6\u80fd\u529b\u6765\u4f30\u503c\u3002</p> <p>\u653f\u5e9c\u4e5f\u60f3\u83b7\u5f97\u6570\u636e\uff1a\u901a\u8fc7\u79d8\u5bc6\u4ea4\u6613\u3001\u80c1\u8feb\u3001\u6cd5\u5f8b\u5f3a\u5236\u6216\u8005\u53ea\u662f\u7a83\u53d6\u3010101\u3011\u3002\u5f53\u516c\u53f8\u7834\u4ea7\u65f6\uff0c\u6536\u96c6\u5230\u7684\u4e2a\u4eba\u6570\u636e\u5c31\u662f\u88ab\u51fa\u552e\u7684\u8d44\u4ea7\u4e4b\u4e00\u3002\u800c\u4e14\u6570\u636e\u5b89\u5168\u5f88\u96be\u4fdd\u62a4\uff0c\u56e0\u6b64\u7ecf\u5e38\u53d1\u751f\u4ee4\u4eba\u96be\u582a\u7684\u6cc4\u6f0f\u4e8b\u4ef6\u3010102\u3011\u3002</p> <p>\u8fd9\u4e9b\u89c2\u5bdf\u5df2\u7ecf\u5bfc\u81f4\u6279\u8bc4\u8005\u58f0\u79f0\uff0c\u6570\u636e\u4e0d\u4ec5\u4ec5\u662f\u4e00\u79cd\u8d44\u4ea7\uff0c\u800c\u4e14\u662f\u4e00\u79cd \u201c\u6709\u6bd2\u8d44\u4ea7\u201d\u3010101\u3011\uff0c\u6216\u8005\u81f3\u5c11\u662f \u201c\u6709\u5bb3\u7269\u8d28\u201d\u3010103\u3011\u3002\u5373\u4f7f\u6211\u4eec\u8ba4\u4e3a\u81ea\u5df1\u6709\u80fd\u529b\u963b\u6b62\u6570\u636e\u6ee5\u7528\uff0c\u4f46\u6bcf\u5f53\u6211\u4eec\u6536\u96c6\u6570\u636e\u65f6\uff0c\u6211\u4eec\u90fd\u9700\u8981\u5e73\u8861\u6536\u76ca\u4ee5\u53ca\u8fd9\u4e9b\u6570\u636e\u843d\u5165\u6076\u4eba\u624b\u4e2d\u7684\u98ce\u9669\uff1a\u8ba1\u7b97\u673a\u7cfb\u7edf\u53ef\u80fd\u4f1a\u88ab\u72af\u7f6a\u5206\u5b50\u6216\u654c\u56fd\u7279\u52a1\u6e17\u900f\uff0c\u6570\u636e\u53ef\u80fd\u4f1a\u88ab\u5185\u9b3c\u6cc4\u9732\uff0c\u516c\u53f8\u53ef\u80fd\u4f1a\u843d\u5165\u4e0d\u62e9\u624b\u6bb5\u7684\u7ba1\u7406\u5c42\u624b\u4e2d\uff0c\u800c\u8fd9\u4e9b\u7ba1\u7406\u8005\u6709\u7740\u8fe5\u7136\u4e0d\u540c\u7684\u4ef7\u503c\u89c2\uff0c\u6216\u8005\u56fd\u5bb6\u53ef\u80fd\u88ab\u80fd\u6beb\u65e0\u6127\u8272\u8feb\u4f7f\u6211\u4eec\u4ea4\u51fa\u6570\u636e\u7684\u653f\u6743\u6240\u63a5\u7ba1\u3002</p> <p>\u201d\u5728\u907f\u514d\u81ea\u5df1\u88ab\u5ba1\u89c6\u7684\u540c\u65f6\u5ba1\u89c6\u4ed6\u4eba\uff0c\u662f\u6743\u529b\u6700\u91cd\u8981\u7684\u5f62\u5f0f\u4e4b\u4e00\u201d\u3010105\u3011\u3002\u8fd9\u5c31\u662f\u6781\u6743\u653f\u5e9c\u60f3\u8981\u76d1\u63a7\u7684\u539f\u56e0\uff1a\u8fd9\u8ba9\u5b83\u4eec\u6709\u80fd\u529b\u63a7\u5236\u5168\u4f53\u5c45\u6c11\u3002\u5c3d\u7ba1\u4eca\u5929\u7684\u79d1\u6280\u516c\u53f8\u5e76\u6ca1\u6709\u516c\u5f00\u5730\u5bfb\u6c42\u653f\u6cbb\u6743\u529b\uff0c\u4f46\u662f\u5b83\u4eec\u79ef\u7d2f\u7684\u6570\u636e\u4e0e\u77e5\u8bc6\u5374\u7ed9\u5b83\u4eec\u5e26\u6765\u4e86\u5f88\u591a\u6743\u529b\uff0c\u5176\u4e2d\u5927\u90e8\u5206\u662f\u5728\u516c\u5171\u76d1\u7763\u4e4b\u5916\u5077\u5077\u8fdb\u884c\u7684\u3010106\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_61","title":"\u56de\u987e\u5de5\u4e1a\u9769\u547d","text":"<p>\u6211\u4eec\u7684\u65e5\u5e38\u751f\u6d3b\u4e0e\u793e\u4f1a\u7ec4\u7ec7\u5728\u8fc7\u53bb\u5341\u5e74\u4e2d\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u800c\u4e14\u5728\u672a\u6765\u7684\u5341\u5e74\u4e2d\u53ef\u80fd\u4f1a\u7ee7\u7eed\u53d1\u751f\u6839\u672c\u6027\u7684\u53d8\u5316\uff0c\u6240\u4ee5\u6211\u4eec\u4f1a\u60f3\u5230\u4e0e\u5de5\u4e1a\u9769\u547d\u5bf9\u6bd4\u301087,96\u3011\u3002</p> <ul> <li> <p>\u5de5\u4e1a\u9769\u547d\u5e26\u6765\u7684\u95ee\u9898\uff0c\u5236\u5b9a\u4fdd\u62a4\u63aa\u65bd\u82b1\u8d39\u4e86\u5f88\u957f\u7684\u65f6\u95f4\uff0c\u4f8b\u5982\u73af\u5883\u4fdd\u62a4\u6761\u4f8b\u3001\u5de5\u4f5c\u573a\u6240\u5b89\u5168\u6761\u4f8b\u7b49\uff1b\u4f46\u662f\u6574\u4e2a\u793e\u4f1a\u90fd\u4ece\u4e2d\u53d7\u76ca\u826f\u591a\uff0c\u6211\u4eec\u4e2d\u5f88\u5c11\u4f1a\u6709\u4eba\u60f3\u56de\u5230\u8fd9\u4e9b\u7ba1\u5236\u6761\u4f8b\u4e4b\u524d\u7684\u65e5\u5b50\u301087\u3011\u3002</p> </li> <li> <p>\u4fe1\u606f\u65f6\u4ee3\u7684\u91cd\u5927\u95ee\u9898\uff0c\u6570\u636e\u7684\u6536\u96c6\u4e0e\u4f7f\u7528\u5c31\u662f\u5176\u4e2d\u4e00\u4e2a\u7528 Bruce Schneier \u7684\u8bdd\u6765\u8bf4\u301096\u3011\uff1a</p> </li> </ul> <p>\u6570\u636e\u662f\u4fe1\u606f\u65f6\u4ee3\u7684\u6c61\u67d3\u95ee\u9898\uff0c\u4fdd\u62a4\u9690\u79c1\u662f\u73af\u5883\u6311\u6218\u3002\u51e0\u4e4e\u6240\u6709\u7684\u7535\u8111\u90fd\u80fd\u751f\u4ea7\u4fe1\u606f\u3002\u5b83\u5806\u79ef\u5728\u5468\u56f4\uff0c\u5f00\u59cb\u6e83\u70c2\u3002\u6211\u4eec\u5982\u4f55\u5904\u7406\u5b83 \u2014\u2014 \u6211\u4eec\u5982\u4f55\u63a7\u5236\u5b83\uff0c\u4ee5\u53ca\u5982\u4f55\u6446\u8131\u5b83 \u2014\u2014 \u662f\u4fe1\u606f\u7ecf\u6d4e\u5065\u5eb7\u53d1\u5c55\u7684\u6838\u5fc3\u8bae\u9898\u3002\u6b63\u5982\u6211\u4eec\u4eca\u5929\u56de\u987e\u5de5\u4e1a\u65f6\u4ee3\u7684\u65e9\u671f\u5e74\u4ee3\uff0c\u5e76\u60f3\u77e5\u9053\u6211\u4eec\u7684\u7956\u5148\u5728\u5fd9\u4e8e\u5efa\u8bbe\u5de5\u4e1a\u4e16\u754c\u7684\u8fc7\u7a0b\u65f6\u600e\u4e48\u80fd\u5ffd\u7565\u6c61\u67d3\u95ee\u9898\uff1b\u6211\u4eec\u7684\u5b59\u8f88\u5728\u56de\u671b\u4fe1\u606f\u65f6\u4ee3\u7684\u65e9\u671f\u5e74\u4ee3\u65f6\uff0c\u5c06\u4f1a\u5c31\u6211\u4eec\u5982\u4f55\u5e94\u5bf9\u6570\u636e\u6536\u96c6\u548c\u6ee5\u7528\u7684\u6311\u6218\u6765\u8bc4\u65ad\u6211\u4eec\u3002</p> <p>\u6211\u4eec\u5e94\u8be5\u8bbe\u6cd5\u8ba9\u4ed6\u4eec\u611f\u5230\u9a84\u50b2\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_62","title":"\u7acb\u6cd5\u4e0e\u81ea\u5f8b","text":"<p>\u6570\u636e\u4fdd\u62a4\u6cd5\u53ef\u80fd\u6709\u52a9\u4e8e\u7ef4\u62a4\u4e2a\u4eba\u7684\u6743\u5229\u3002\u4f8b\u5982\uff0c1995 \u5e74\u7684 \u201c\u6b27\u6d32\u6570\u636e\u4fdd\u62a4\u6307\u793a\u201d \u89c4\u5b9a\uff0c\u4e2a\u4eba\u6570\u636e\u5fc5\u987b \u201c\u4e3a\u7279\u5b9a\u7684\u3001\u660e\u786e\u7684\u548c\u5408\u6cd5\u7684\u76ee\u7684\u6536\u96c6\uff0c\u800c\u4e0d\u662f\u4ee5\u4e0e\u8fd9\u4e9b\u76ee\u7684\u4e0d\u76f8\u7b26\u7684\u65b9\u5f0f\u8fdb\u4e00\u6b65\u5904\u7406\u201d\uff0c\u5e76\u4e14\u6570\u636e\u5fc5\u987b \u201c\u5c31\u6536\u96c6\u7684\u76ee\u7684\u800c\u8a00\u9002\u5f53\u3001\u76f8\u5173\u3001\u4e0d\u8fc7\u5206\u3002\u201d\u3010107\u3011\u3002</p> <p>\u4f46\u662f\uff0c\u8fd9\u4e2a\u7acb\u6cd5\u5728\u4eca\u5929\u7684\u4e92\u8054\u7f51\u73af\u5883\u4e0b\u662f\u5426\u6709\u6548\u8fd8\u662f\u6709\u7591\u95ee\u7684\u3010108\u3011\u3002\u8fd9\u4e9b\u89c4\u5219\u76f4\u63a5\u5426\u5b9a\u4e86\u5927\u6570\u636e\u7684\u54f2\u5b66\uff0c\u5373\u6700\u5927\u9650\u5ea6\u5730\u6536\u96c6\u6570\u636e\uff0c\u5c06\u5176\u4e0e\u5176\u4ed6\u6570\u636e\u96c6\u7ed3\u5408\u8d77\u6765\u8fdb\u884c\u8bd5\u9a8c\u548c\u63a2\u7d22\uff0c\u4ee5\u4fbf\u4ea7\u751f\u65b0\u7684\u6d1e\u5bdf\u3002\u63a2\u7d22\u610f\u5473\u7740\u5c06\u6570\u636e\u7528\u4e8e\u672a\u66fe\u9884\u671f\u7684\u76ee\u7684\uff0c\u8fd9\u4e0e\u7528\u6237\u540c\u610f\u7684 \u201c\u7279\u5b9a\u548c\u660e\u786e\u201d \u76ee\u7684\u76f8\u53cd\uff08\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u6709\u610f\u4e49\u5730\u8868\u793a\u540c\u610f\u7684\u8bdd\uff09\u3010109\u3011\u3002\u66f4\u65b0\u7684\u89c4\u7ae0\u6b63\u5728\u5236\u5b9a\u4e2d\u301089\u3011\u3002</p> <p>\u90a3\u4e9b\u6536\u96c6\u4e86\u5927\u91cf\u6709\u5173\u4eba\u7684\u6570\u636e\u7684\u516c\u53f8\u53cd\u5bf9\u76d1\u7ba1\uff0c\u8ba4\u4e3a\u8fd9\u662f\u521b\u65b0\u7684\u8d1f\u62c5\u4e0e\u963b\u788d\u3002\u5728\u67d0\u79cd\u7a0b\u5ea6\u4e0a\uff0c\u8fd9\u79cd\u53cd\u5bf9\u662f\u6709\u9053\u7406\u7684\u3002\u4f8b\u5982\uff0c\u5206\u4eab\u533b\u7597\u6570\u636e\u65f6\uff0c\u5b58\u5728\u660e\u663e\u7684\u9690\u79c1\u98ce\u9669\uff0c\u4f46\u4e5f\u6709\u6f5c\u5728\u7684\u673a\u9047\uff1a\u5982\u679c\u6570\u636e\u5206\u6790\u80fd\u591f\u5e2e\u52a9\u6211\u4eec\u5b9e\u73b0\u66f4\u597d\u7684\u8bca\u65ad\u6216\u627e\u5230\u66f4\u597d\u7684\u6cbb\u7597\u65b9\u6cd5\uff0c\u80fd\u591f\u963b\u6b62\u591a\u5c11\u4eba\u7684\u6b7b\u4ea1\u3010110\u3011\uff1f\u8fc7\u5ea6\u76d1\u7ba1\u53ef\u80fd\u4f1a\u963b\u6b62\u8fd9\u79cd\u7a81\u7834\u3002\u5728\u8fd9\u79cd\u6f5c\u5728\u673a\u4f1a\u4e0e\u98ce\u9669\u4e4b\u95f4\u627e\u51fa\u5e73\u8861\u662f\u5f88\u56f0\u96be\u7684\u3010105\u3011\u3002</p> <p>\u4ece\u6839\u672c\u4e0a\u8bf4\uff0c\u6211\u8ba4\u4e3a\u6211\u4eec\u9700\u8981\u79d1\u6280\u884c\u4e1a\u5728\u4e2a\u4eba\u6570\u636e\u65b9\u9762\u7684\u6587\u5316\u8f6c\u53d8\u3002\u6211\u4eec\u5e94\u8be5\u505c\u6b62\u5c06\u7528\u6237\u89c6\u4f5c\u5f85\u4f18\u5316\u7684\u6307\u6807\u6570\u636e\uff0c\u5e76\u8bb0\u4f4f\u4ed6\u4eec\u662f\u503c\u5f97\u5c0a\u91cd\u3001\u6709\u5c0a\u4e25\u548c\u80fd\u52a8\u6027\u7684\u4eba\u3002\u6211\u4eec\u5e94\u5f53\u5728\u6570\u636e\u6536\u96c6\u548c\u5b9e\u9645\u5904\u7406\u4e2d\u81ea\u6211\u7ea6\u675f\uff0c\u4ee5\u5efa\u7acb\u548c\u7ef4\u6301\u4f9d\u8d56\u6211\u4eec\u8f6f\u4ef6\u7684\u4eba\u4eec\u7684\u4fe1\u4efb\u3010111\u3011\u3002\u6211\u4eec\u5e94\u5f53\u5c06\u6559\u80b2\u7ec8\u7aef\u7528\u6237\u89c6\u4e3a\u5df1\u4efb\uff0c\u544a\u8bc9\u4ed6\u4eec\u6211\u4eec\u662f\u5982\u4f55\u4f7f\u7528\u4ed6\u4eec\u7684\u6570\u636e\u7684\uff0c\u800c\u4e0d\u662f\u5c06\u4ed6\u4eec\u8499\u5728\u9f13\u91cc\u3002</p> <p>\u6211\u4eec\u5e94\u8be5\u5141\u8bb8\u6bcf\u4e2a\u4eba\u4fdd\u7559\u81ea\u5df1\u7684\u9690\u79c1 \u2014\u2014 \u5373\uff0c\u5bf9\u81ea\u5df1\u6570\u636e\u7684\u63a7\u5236 \u2014\u2014 \u800c\u4e0d\u662f\u901a\u8fc7\u76d1\u89c6\u6765\u7a83\u53d6\u8fd9\u79cd\u63a7\u5236\u6743\u3002</p> <p>\u6211\u4eec\u7a76\u7adf\u80fd\u505a\u5230\u54ea\u4e00\u6b65\uff0c\u662f\u4e00\u4e2a\u5f00\u653e\u7684\u95ee\u9898\u3002\u9996\u5148\uff0c\u6211\u4eec\u4e0d\u5e94\u8be5\u6c38\u4e45\u4fdd\u7559\u6570\u636e\uff0c\u800c\u662f\u4e00\u65e6\u4e0d\u518d\u9700\u8981\u5c31\u7acb\u5373\u6e05\u9664\u6570\u636e\u3010111,112\u3011\u3002\u6e05\u9664\u6570\u636e\u4e0e\u4e0d\u53d8\u6027\u7684\u60f3\u6cd5\u80cc\u9053\u800c\u9a70\uff0c\u4f46\u8fd9\u662f\u53ef\u4ee5\u89e3\u51b3\u7684\u95ee\u9898\u3002\u6211\u6240\u770b\u5230\u7684\u4e00\u79cd\u5f88\u6709\u524d\u666f\u7684\u65b9\u6cd5\u662f\u901a\u8fc7\u52a0\u5bc6\u534f\u8bae\u6765\u5b9e\u65bd\u8bbf\u95ee\u63a7\u5236\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u901a\u8fc7\u7b56\u7565\u3010113,114\u3011\u3002\u603b\u7684\u6765\u8bf4\uff0c\u6587\u5316\u4e0e\u6001\u5ea6\u7684\u6539\u53d8\u662f\u5fc5\u8981\u7684\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_63","title":"\u672c\u7ae0\u5c0f\u7ed3","text":"<p>\u6ca1\u6709\u5355\u79cd\u5de5\u5177\u80fd\u9ad8\u6548\u670d\u52a1\u6240\u6709\u53ef\u80fd\u7684\u7528\u4f8b\uff0c\u56e0\u6b64\u5e94\u7528\u5fc5\u987b\u7ec4\u5408\u4f7f\u7528\u51e0\u79cd\u4e0d\u540c\u7684\u8f6f\u4ef6\u624d\u80fd\u5b9e\u73b0\u5176\u76ee\u6807\u3002</p> <ul> <li>\u8ba8\u8bba\u4e86\u5982\u4f55\u4f7f\u7528\u6279\u5904\u7406\u4e0e\u4e8b\u4ef6\u6d41\u6765\u89e3\u51b3\u8fd9\u4e00 \u6570\u636e\u96c6\u6210\uff08data integration\uff09 \u95ee\u9898\uff0c\u4ee5\u4fbf\u8ba9\u6570\u636e\u53d8\u66f4\u5728\u4e0d\u540c\u7cfb\u7edf\u4e4b\u95f4\u6d41\u52a8\u3002</li> </ul> <p>\u5728\u8fd9\u79cd\u65b9\u6cd5\u4e2d\uff0c\u67d0\u4e9b\u7cfb\u7edf\u88ab\u6307\u5b9a\u4e3a\u8bb0\u5f55\u7cfb\u7edf\uff0c\u800c\u5176\u4ed6\u6570\u636e\u5219\u901a\u8fc7\u8f6c\u6362\u884d\u751f\u81ea\u8bb0\u5f55\u7cfb\u7edf\u3002\u901a\u8fc7\u4f7f\u8fd9\u4e9b\u884d\u751f\u548c\u8f6c\u6362\u64cd\u4f5c\u5f02\u6b65\u4e14\u677e\u6563\u8026\u5408\uff0c\u80fd\u591f\u9632\u6b62\u4e00\u4e2a\u533a\u57df\u4e2d\u7684\u95ee\u9898\u6269\u6563\u5230\u7cfb\u7edf\u4e2d\u4e0d\u76f8\u5173\u90e8\u5206\uff0c\u4ece\u800c\u589e\u52a0\u6574\u4e2a\u7cfb\u7edf\u7684\u7a33\u5065\u6027\u4e0e\u5bb9\u9519\u6027\u3002</p> <p>\u5c06\u6570\u636e\u6d41\u8868\u793a\u4e3a\u4ece\u4e00\u4e2a\u6570\u636e\u96c6\u5230\u53e6\u4e00\u4e2a\u6570\u636e\u96c6\u7684\u8f6c\u6362\u4e5f\u6709\u52a9\u4e8e\u6f14\u5316\u5e94\u7528\u7a0b\u5e8f\uff1a\u5982\u679c\u4f60\u60f3\u53d8\u66f4\u5176\u4e2d\u4e00\u4e2a\u5904\u7406\u6b65\u9aa4\uff0c\u4f8b\u5982\u53d8\u66f4\u7d22\u5f15\u6216\u7f13\u5b58\u7684\u7ed3\u6784\uff0c\u5219\u53ef\u4ee5\u5728\u6574\u4e2a\u8f93\u5165\u6570\u636e\u96c6\u4e0a\u91cd\u65b0\u8fd0\u884c\u65b0\u7684\u8f6c\u6362\u4ee3\u7801\uff0c\u4ee5\u4fbf\u91cd\u65b0\u884d\u751f\u8f93\u51fa\u3002\u540c\u6837\uff0c\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4fee\u590d\u4ee3\u7801\u5e76\u91cd\u65b0\u5904\u7406\u6570\u636e\u4ee5\u4fbf\u6062\u590d\u3002</p> <p>\u8fd9\u4e9b\u8fc7\u7a0b\u4e0e\u6570\u636e\u5e93\u5185\u90e8\u5df2\u7ecf\u5b8c\u6210\u7684\u8fc7\u7a0b\u975e\u5e38\u7c7b\u4f3c\uff0c\u56e0\u6b64\u6211\u4eec\u5c06\u6570\u636e\u6d41\u5e94\u7528\u7684\u6982\u5ff5\u91cd\u65b0\u6539\u5199\u4e3a\uff0c\u5206\u62c6\uff08unbundling\uff09 \u6570\u636e\u5e93\u7ec4\u4ef6\uff0c\u5e76\u901a\u8fc7\u7ec4\u5408\u8fd9\u4e9b\u677e\u6563\u8026\u5408\u7684\u7ec4\u4ef6\u6765\u6784\u5efa\u5e94\u7528\u7a0b\u5e8f\u3002</p> <p>\u884d\u751f\u72b6\u6001\u53ef\u4ee5\u901a\u8fc7\u89c2\u5bdf\u5e95\u5c42\u6570\u636e\u7684\u53d8\u66f4\u6765\u66f4\u65b0\u3002\u6b64\u5916\uff0c\u884d\u751f\u72b6\u6001\u672c\u8eab\u53ef\u4ee5\u8fdb\u4e00\u6b65\u88ab\u4e0b\u6e38\u6d88\u8d39\u8005\u89c2\u5bdf\u3002\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u5c06\u8fd9\u79cd\u6570\u636e\u6d41\u4e00\u8def\u4f20\u9001\u81f3\u663e\u793a\u6570\u636e\u7684\u7ec8\u7aef\u7528\u6237\u8bbe\u5907\uff0c\u4ece\u800c\u6784\u5efa\u53ef\u52a8\u6001\u66f4\u65b0\u4ee5\u53cd\u6620\u6570\u636e\u53d8\u66f4\uff0c\u5e76\u5728\u79bb\u7ebf\u65f6\u80fd\u7ee7\u7eed\u5de5\u4f5c\u7684\u7528\u6237\u754c\u9762\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u8ba8\u8bba\u4e86\u5982\u4f55\u786e\u4fdd\u6240\u6709\u8fd9\u4e9b\u5904\u7406\u5728\u51fa\u73b0\u6545\u969c\u65f6\u4fdd\u6301\u6b63\u786e\u3002\u6211\u4eec\u770b\u5230\u53ef\u4f38\u7f29\u7684\u5f3a\u5b8c\u6574\u6027\u4fdd\u8bc1\u53ef\u4ee5\u901a\u8fc7\u5f02\u6b65\u4e8b\u4ef6\u5904\u7406\u6765\u5b9e\u73b0\uff0c\u901a\u8fc7\u4f7f\u7528\u7aef\u5230\u7aef\u64cd\u4f5c\u6807\u8bc6\u7b26\u4f7f\u64cd\u4f5c\u5e42\u7b49\uff0c\u4ee5\u53ca\u901a\u8fc7\u5f02\u6b65\u68c0\u67e5\u7ea6\u675f\u3002\u5ba2\u6237\u7aef\u53ef\u4ee5\u7b49\u5230\u68c0\u67e5\u901a\u8fc7\uff0c\u6216\u8005\u4e0d\u7b49\u5f85\u7ee7\u7eed\u524d\u8fdb\uff0c\u4f46\u662f\u53ef\u80fd\u4f1a\u5192\u6709\u8fdd\u53cd\u7ea6\u675f\u9700\u8981\u9053\u6b49\u7684\u98ce\u9669\u3002\u8fd9\u79cd\u65b9\u6cd5\u6bd4\u4f7f\u7528\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u4f20\u7edf\u65b9\u6cd5\u66f4\u5177\u53ef\u4f38\u7f29\u6027\u4e0e\u53ef\u9760\u6027\uff0c\u5e76\u4e14\u5728\u5b9e\u8df5\u4e2d\u9002\u7528\u4e8e\u5f88\u591a\u4e1a\u52a1\u6d41\u7a0b\u3002</p> <p>\u901a\u8fc7\u56f4\u7ed5\u6570\u636e\u6d41\u6784\u5efa\u5e94\u7528\uff0c\u5e76\u5f02\u6b65\u68c0\u67e5\u7ea6\u675f\uff0c\u6211\u4eec\u53ef\u4ee5\u907f\u514d\u7edd\u5927\u591a\u6570\u7684\u534f\u8c03\u5de5\u4f5c\uff0c\u521b\u5efa\u4fdd\u8bc1\u5b8c\u6574\u6027\u4e14\u6027\u80fd\u4ecd\u7136\u8868\u73b0\u826f\u597d\u7684\u7cfb\u7edf\uff0c\u5373\u4f7f\u5728\u5730\u7406\u6563\u5e03\u7684\u60c5\u51b5\u4e0b\u4e0e\u51fa\u73b0\u6545\u969c\u65f6\u4ea6\u7136\u3002\u7136\u540e\uff0c\u6211\u4eec\u5bf9\u4f7f\u7528\u5ba1\u8ba1\u6765\u9a8c\u8bc1\u6570\u636e\u5b8c\u6574\u6027\uff0c\u4ee5\u53ca\u635f\u574f\u68c0\u6d4b\u8fdb\u884c\u4e86\u4e00\u4e9b\u8ba8\u8bba\u3002</p> <p>\u6700\u540e\uff0c\u5ba1\u89c6\u4e86\u6784\u5efa\u6570\u636e\u5bc6\u96c6\u578b\u5e94\u7528\u7684\u4e00\u4e9b\u9053\u5fb7\u95ee\u9898\u3002\u6211\u4eec\u770b\u5230\uff0c\u867d\u7136\u6570\u636e\u53ef\u4ee5\u7528\u6765\u505a\u597d\u4e8b\uff0c\u4f46\u5b83\u4e5f\u53ef\u80fd\u9020\u6210\u5f88\u5927\u4f24\u5bb3\uff1a\u4f5c\u51fa\u4e25\u91cd\u5f71\u54cd\u4eba\u4eec\u751f\u6d3b\u7684\u51b3\u5b9a\u5374\u96be\u4ee5\u7533\u8bc9\uff0c\u5bfc\u81f4\u6b67\u89c6\u4e0e\u5265\u524a\u3001\u76d1\u89c6\u5e38\u6001\u5316\u3001\u66dd\u5149\u79c1\u5bc6\u4fe1\u606f\u3002\u6211\u4eec\u4e5f\u5192\u7740\u6570\u636e\u88ab\u6cc4\u9732\u7684\u98ce\u9669\uff0c\u5e76\u4e14\u53ef\u80fd\u4f1a\u53d1\u73b0\uff0c\u5373\u4f7f\u662f\u5584\u610f\u5730\u4f7f\u7528\u6570\u636e\u4e5f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u610f\u60f3\u4e0d\u5230\u7684</p> <p>\u7531\u4e8e\u8f6f\u4ef6\u548c\u6570\u636e\u5bf9\u4e16\u754c\u4ea7\u751f\u4e86\u5982\u6b64\u5de8\u5927\u7684\u5f71\u54cd\uff0c\u6211\u4eec\u5de5\u7a0b\u5e08\u4eec\u5fc5\u987b\u7262\u8bb0\uff0c\u6211\u4eec\u6709\u8d23\u4efb\u4e3a\u6211\u4eec\u60f3\u8981\u7684\u90a3\u79cd\u4e16\u754c\u800c\u52aa\u529b\uff1a\u4e00\u4e2a\u5c0a\u91cd\u4eba\u4eec\uff0c\u5c0a\u91cd\u4eba\u6027\u7684\u4e16\u754c\u3002\u6211\u5e0c\u671b\u6211\u4eec\u80fd\u591f\u4e00\u8d77\u4e3a\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\u800c\u52aa\u529b\u3002</p>"},{"location":"books/data_intensive_system_book/12_the_future.html#_64","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>Rachid Belaid: \u201cPostgres Full-Text Search is Good Enough!,\u201d rachbelaid.com, July 13, 2015.</li> <li>Philippe Ajoux, Nathan Bronson, Sanjeev Kumar, et al.: \u201cChallenges to Adopting Stronger Consistency at Scale,\u201d at 15th USENIX Workshop on Hot Topics in Operating Systems (HotOS), May 2015.</li> <li>Pat Helland and Dave Campbell: \u201cBuilding on Quicksand,\u201d at 4th Biennial Conference on Innovative Data Systems Research (CIDR), January 2009.</li> <li>Jessica Kerr: \u201cProvenance and Causality in Distributed Systems,\u201d blog.jessitron.com, September 25, 2016.</li> <li>Kostas Tzoumas: \u201cBatch Is a Special Case of Streaming,\u201d data-artisans.com, September 15, 2015.</li> <li>Shinji Kim and Robert Blafford: \u201cStream Windowing Performance Analysis: Concord and Spark Streaming,\u201d concord.io, July 6, 2016.</li> <li>Jay Kreps: \u201cThe Log: What Every Software Engineer Should Know About Real-Time Data's Unifying Abstraction,\u201d engineering.linkedin.com, December 16, 2013.</li> <li>Pat Helland: \u201cLife Beyond Distributed Transactions: An Apostate\u2019s Opinion,\u201d at 3rd Biennial Conference on Innovative Data Systems Research (CIDR), January 2007.</li> <li>\u201cGreat Western Railway (1835\u20131948),\u201d Network Rail Virtual Archive, networkrail.co.uk.</li> <li>Jacqueline Xu: \u201cOnline Migrations at Scale,\u201d stripe.com, February 2, 2017.</li> <li>Molly Bartlett Dishman and Martin Fowler: \u201cAgile Architecture,\u201d at O'Reilly Software Architecture Conference, March 2015.</li> <li>Nathan Marz and James Warren: Big Data: Principles and Best Practices of Scalable Real-Time Data Systems. Manning, 2015. ISBN: 978-1-617-29034-3</li> <li>Oscar Boykin, Sam Ritchie, Ian O'Connell, and Jimmy Lin: \u201cSummingbird: A Framework for Integrating Batch and Online MapReduce Computations,\u201d at 40th International Conference on Very Large Data Bases (VLDB), September 2014.</li> <li>Jay Kreps: \u201cQuestioning the Lambda Architecture,\u201d oreilly.com, July 2, 2014.</li> <li>Raul Castro Fernandez, Peter Pietzuch, Jay Kreps, et al.: \u201cLiquid: Unifying Nearline and Offline Big Data Integration,\u201d at 7th Biennial Conference on Innovative Data Systems Research (CIDR), January 2015.</li> <li>Dennis M. Ritchie and Ken Thompson: \u201cThe UNIX Time-Sharing System,\u201d Communications of the ACM, volume 17, number 7, pages 365\u2013375, July 1974. doi:10.1145/361011.361061</li> <li>Eric A. Brewer and Joseph M. Hellerstein: \u201cCS262a: Advanced Topics in Computer Systems,\u201d lecture notes, University of California, Berkeley, cs.berkeley.edu, August 2011.</li> <li>Michael Stonebraker: \u201cThe Case for Polystores,\u201d wp.sigmod.org, July 13, 2015.</li> <li>Jennie Duggan, Aaron J. Elmore, Michael Stonebraker, et al.: \u201cThe BigDAWG Polystore System,\u201d ACM SIGMOD Record, volume 44, number 2, pages 11\u201316, June 2015. doi:10.1145/2814710.2814713</li> <li>Patrycja Dybka: \u201cForeign Data Wrappers for PostgreSQL,\u201d vertabelo.com, March 24, 2015.</li> <li>David B. Lomet, Alan Fekete, Gerhard Weikum, and Mike Zwilling: \u201cUnbundling Transaction Services in the Cloud,\u201d at 4th Biennial Conference on Innovative Data Systems Research (CIDR), January 2009.</li> <li>Martin Kleppmann and Jay Kreps: \u201cKafka, Samza and the Unix Philosophy of Distributed Data,\u201d IEEE Data Engineering Bulletin, volume 38, number 4, pages 4\u201314, December 2015.</li> <li>John Hugg: \u201cWinning Now and in the Future: Where VoltDB Shines,\u201d voltdb.com, March 23, 2016.</li> <li>Frank McSherry, Derek G. Murray, Rebecca Isaacs, and Michael Isard: \u201cDifferential Dataflow,\u201d at 6th Biennial Conference on Innovative Data Systems Research (CIDR), January 2013.</li> <li>Derek G Murray, Frank McSherry, Rebecca Isaacs, et al.: \u201cNaiad: A Timely Dataflow System,\u201d at 24th ACM Symposium on Operating Systems Principles (SOSP), pages 439\u2013455, November 2013. doi:10.1145/2517349.2522738</li> <li>Gwen Shapira: \u201cWe have a bunch of customers who are implementing \u2018database inside-out\u2019 concept and they all ask \u2018is anyone else doing it? are we crazy?\u2019\u201d twitter.com, July 28, 2016.</li> <li>Martin Kleppmann: \u201cTurning the Database Inside-out with Apache Samza,\u201d at Strange Loop, September 2014.</li> <li>Peter Van Roy and Seif Haridi: Concepts, Techniques, and Models of Computer Programming. MIT Press, 2004. ISBN: 978-0-262-22069-9</li> <li>\u201cJuttle Documentation,\u201d juttle.github.io, 2016.</li> <li>Evan Czaplicki and Stephen Chong: \u201cAsynchronous Functional Reactive Programming for GUIs,\u201d at 34th ACM SIGPLAN Conference on Programming Language Design and Implementation (PLDI), June 2013. doi:10.1145/2491956.2462161</li> <li>Engineer Bainomugisha, Andoni Lombide Carreton, Tom van Cutsem, Stijn Mostinckx, and Wolfgang de Meuter: \u201cA Survey on Reactive Programming,\u201d ACM Computing Surveys, volume 45, number 4, pages 1\u201334, August 2013. doi:10.1145/2501654.2501666</li> <li>Peter Alvaro, Neil Conway, Joseph M. Hellerstein, and William R. Marczak: \u201cConsistency Analysis in Bloom: A CALM and Collected Approach,\u201d at 5th Biennial Conference on Innovative Data Systems Research (CIDR), January 2011.</li> <li>Felienne Hermans: \u201cSpreadsheets Are Code,\u201d at Code Mesh, November 2015.</li> <li>Dan Bricklin and Bob Frankston: \u201cVisiCalc: Information from Its Creators,\u201d danbricklin.com.</li> <li>D. Sculley, Gary Holt, Daniel Golovin, et al.: \u201cMachine Learning: The High-Interest Credit Card of Technical Debt,\u201d at NIPS Workshop on Software Engineering for Machine Learning (SE4ML), December 2014.</li> <li>Peter Bailis, Alan Fekete, Michael J Franklin, et al.: \u201cFeral Concurrency Control: An Empirical Investigation of Modern Application Integrity,\u201d at ACM International Conference on Management of Data (SIGMOD), June 2015. doi:10.1145/2723372.2737784</li> <li>Guy Steele: \u201cRe: Need for Macros (Was Re: Icon),\u201d email to ll1-discuss mailing list, people.csail.mit.edu, December 24, 2001.</li> <li>David Gelernter: \u201cGenerative Communication in Linda,\u201d ACM Transactions on Programming Languages and Systems (TOPLAS), volume 7, number 1, pages 80\u2013112, January 1985. doi:10.1145/2363.2433</li> <li>Patrick Th. Eugster, Pascal A. Felber, Rachid Guerraoui, and Anne-Marie Kermarrec: \u201cThe Many Faces of Publish/Subscribe,\u201d ACM Computing Surveys, volume 35, number 2, pages 114\u2013131, June 2003. doi:10.1145/857076.857078</li> <li>Ben Stopford: \u201cMicroservices in a Streaming World,\u201d at QCon London, March 2016.</li> <li>Christian Posta: \u201cWhy Microservices Should Be Event Driven: Autonomy vs Authority,\u201d blog.christianposta.com, May 27, 2016.</li> <li>Alex Feyerke: \u201cSay Hello to Offline First,\u201d hood.ie, November 5, 2013.</li> <li>Sebastian Burckhardt, Daan Leijen, Jonathan Protzenko, and Manuel F\u00e4hndrich: \u201cGlobal Sequence Protocol: A Robust Abstraction for Replicated Shared State,\u201d at 29th European Conference on Object-Oriented Programming (ECOOP), July 2015. doi:10.4230/LIPIcs.ECOOP.2015.568</li> <li>Mark Soper: \u201cClearing Up React Data Management Confusion with Flux, Redux, and Relay,\u201d medium.com, December 3, 2015.</li> <li>Eno Thereska, Damian Guy, Michael Noll, and Neha Narkhede: \u201cUnifying Stream Processing and Interactive Queries in Apache Kafka,\u201d confluent.io, October 26, 2016.</li> <li>Frank McSherry: \u201cDataflow as Database,\u201d github.com, July 17, 2016.</li> <li>Peter Alvaro: \u201cI See What You Mean,\u201d at Strange Loop, September 2015.</li> <li>Nathan Marz: \u201cTrident: A High-Level Abstraction for Realtime Computation,\u201d blog.twitter.com, August 2, 2012.</li> <li>Edi Bice: \u201cLow Latency Web Scale Fraud Prevention with Apache Samza, Kafka and Friends,\u201d at Merchant Risk Council MRC Vegas Conference, March 2016.</li> <li>Charity Majors: \u201cThe Accidental DBA,\u201d charity.wtf, October 2, 2016.</li> <li>Arthur J. Bernstein, Philip M. Lewis, and Shiyong Lu: \u201cSemantic Conditions for Correctness at Different Isolation Levels,\u201d at 16th International Conference on Data Engineering (ICDE), February 2000. doi:10.1109/ICDE.2000.839387</li> <li>Sudhir Jorwekar, Alan Fekete, Krithi Ramamritham, and S. Sudarshan: \u201cAutomating the Detection of Snapshot Isolation Anomalies,\u201d at 33rd International Conference on Very Large Data Bases (VLDB), September 2007.</li> <li>Kyle Kingsbury: Jepsen blog post series, aphyr.com, 2013\u20132016.</li> <li>Michael Jouravlev: \u201cRedirect After Post,\u201d theserverside.com, August 1, 2004.</li> <li>Jerome H. Saltzer, David P. Reed, and David D. Clark: \u201cEnd-to-End Arguments in System Design,\u201d ACM Transactions on Computer Systems, volume 2, number 4, pages 277\u2013288, November 1984. doi:10.1145/357401.357402</li> <li>Peter Bailis, Alan Fekete, Michael J. Franklin, et al.: \u201cCoordination-Avoiding Database Systems,\u201d Proceedings of the VLDB Endowment, volume 8, number 3, pages 185\u2013196, November 2014.</li> <li>Alex Yarmula: \u201cStrong Consistency in Manhattan,\u201d blog.twitter.com, March 17, 2016.</li> <li>Douglas B Terry, Marvin M Theimer, Karin Petersen, et al.: \u201cManaging Update Conflicts in Bayou, a Weakly Connected Replicated Storage System,\u201d at 15th ACM Symposium on Operating Systems Principles (SOSP), pages 172\u2013182, December 1995. doi:10.1145/224056.224070</li> <li>Jim Gray: \u201cThe Transaction Concept: Virtues and Limitations,\u201d at 7th International Conference on Very Large Data Bases (VLDB), September 1981.</li> <li>Hector Garcia-Molina and Kenneth Salem: \u201cSagas,\u201d at ACM International Conference on Management of Data (SIGMOD), May 1987. doi:10.1145/38713.38742</li> <li>Pat Helland: \u201cMemories, Guesses, and Apologies,\u201d blogs.msdn.com, May 15, 2007.</li> <li>Yoongu Kim, Ross Daly, Jeremie Kim, et al.: \u201cFlipping Bits in Memory Without Accessing Them: An Experimental Study of DRAM Disturbance Errors,\u201d at 41st Annual International Symposium on Computer Architecture (ISCA), June 2014. doi:10.1145/2678373.2665726</li> <li>Mark Seaborn and Thomas Dullien: \u201cExploiting the DRAM Rowhammer Bug to Gain Kernel Privileges,\u201d googleprojectzero.blogspot.co.uk, March 9, 2015.</li> <li>Jim N. Gray and Catharine van Ingen: \u201cEmpirical Measurements of Disk Failure Rates and Error Rates,\u201d Microsoft Research, MSR-TR-2005-166, December 2005.</li> <li>Annamalai Gurusami and Daniel Price: \u201cBug #73170: Duplicates in Unique Secondary Index Because of Fix of Bug#68021,\u201d bugs.mysql.com, July 2014.</li> <li>Gary Fredericks: \u201cPostgres Serializability Bug,\u201d github.com, September 2015.</li> <li>Xiao Chen: \u201cHDFS DataNode Scanners and Disk Checker Explained,\u201d blog.cloudera.com, December 20, 2016.</li> <li>Jay Kreps: \u201cGetting Real About Distributed System Reliability,\u201d blog.empathybox.com, March 19, 2012.</li> <li>Martin Fowler: \u201cThe LMAX Architecture,\u201d martinfowler.com, July 12, 2011.</li> <li>Sam Stokes: \u201cMove Fast with Confidence,\u201d blog.samstokes.co.uk, July 11, 2016.</li> <li>\u201cSawtooth Lake Documentation,\u201d Intel Corporation, intelledger.github.io, 2016.</li> <li>Richard Gendal Brown: \u201cIntroducing R3 Corda\u2122: A Distributed Ledger Designed for Financial Services,\u201d gendal.me, April 5, 2016.</li> <li>Trent McConaghy, Rodolphe Marques, Andreas M\u00fcller, et al.: \u201cBigchainDB: A Scalable Blockchain Database,\u201d bigchaindb.com, June 8, 2016.</li> <li>Ralph C. Merkle: \u201cA Digital Signature Based on a Conventional Encryption Function,\u201d at CRYPTO '87, August 1987. doi:10.1007/3-540-48184-2_32</li> <li>Ben Laurie: \u201cCertificate Transparency,\u201d ACM Queue, volume 12, number 8, pages 10-19, August 2014. doi:10.1145/2668152.2668154</li> <li>Mark D. Ryan: \u201cEnhanced Certificate Transparency and End-to-End Encrypted Mail,\u201d at Network and Distributed System Security Symposium (NDSS), February 2014. doi:10.14722/ndss.2014.23379</li> <li>\u201cSoftware Engineering Code of Ethics and Professional Practice,\u201d Association for Computing Machinery, acm.org, 1999.</li> <li>Fran\u00e7ois Chollet: \u201cSoftware development is starting to involve important ethical choices,\u201d twitter.com, October 30, 2016.</li> <li>Igor Perisic: \u201cMaking Hard Choices: The Quest for Ethics in Machine Learning,\u201d engineering.linkedin.com, November 2016.</li> <li>John Naughton: \u201cAlgorithm Writers Need a Code of Conduct,\u201d theguardian.com, December 6, 2015.</li> <li>Logan Kugler: \u201cWhat Happens When Big Data Blunders?,\u201d Communications of the ACM, volume 59, number 6, pages 15\u201316, June 2016. doi:10.1145/2911975</li> <li>Bill Davidow: \u201cWelcome to Algorithmic Prison,\u201d theatlantic.com, February 20, 2014.</li> <li>Don Peck: \u201cThey're Watching You at Work,\u201d theatlantic.com, December 2013.</li> <li>Leigh Alexander: \u201cIs an Algorithm Any Less Racist Than a Human?\u201d theguardian.com, August 3, 2016.</li> <li>Jesse Emspak: \u201cHow a Machine Learns Prejudice,\u201d scientificamerican.com, December 29, 2016.</li> <li>Maciej Ceg\u0142owski: \u201cThe Moral Economy of Tech,\u201d idlewords.com, June 2016.</li> <li>Cathy O'Neil: Weapons of Math Destruction: How Big Data Increases Inequality and Threatens Democracy. Crown Publishing, 2016. ISBN: 978-0-553-41881-1</li> <li>Julia Angwin: \u201cMake Algorithms Accountable,\u201d nytimes.com, August 1, 2016.</li> <li>Bryce Goodman and Seth Flaxman: \u201cEuropean Union Regulations on Algorithmic Decision-Making and a \u2018Right to Explanation\u2019,\u201d arXiv:1606.08813, August 31, 2016.</li> <li>\u201cA Review of the Data Broker Industry: Collection, Use, and Sale of Consumer Data for Marketing Purposes,\u201d Staff Report, United States Senate Committee on Commerce, Science, and Transportation, commerce.senate.gov, December 2013.</li> <li>Olivia Solon: \u201cFacebook\u2019s Failure: Did Fake News and Polarized Politics Get Trump Elected?\u201d theguardian.com, November 10, 2016.</li> <li>Donella H. Meadows and Diana Wright: Thinking in Systems: A Primer. Chelsea Green Publishing, 2008. ISBN: 978-1-603-58055-7</li> <li>Daniel J. Bernstein: \u201cListening to a \u2018big data\u2019/\u2018data science\u2019 talk,\u201d twitter.com, May 12, 2015.</li> <li>Marc Andreessen: \u201cWhy Software Is Eating the World,\u201d The Wall Street Journal, 20 August 2011.</li> <li>J. M. Porup: \u201c\u2018Internet of Things\u2019 Security Is Hilariously Broken and Getting Worse,\u201d arstechnica.com, January 23, 2016.</li> <li>Bruce Schneier: Data and Goliath: The Hidden Battles to Collect Your Data and Control Your World. W. W. Norton, 2015. ISBN: 978-0-393-35217-7</li> <li>The Grugq: \u201cNothing to Hide,\u201d grugq.tumblr.com, April 15, 2016.</li> <li>Tony Beltramelli: \u201cDeep-Spying: Spying Using Smartwatch and Deep Learning,\u201d Masters Thesis, IT University of Copenhagen, December 2015. Available at arxiv.org/abs/1512.05616</li> <li>Shoshana Zuboff: \u201cBig Other: Surveillance Capitalism and the Prospects of an Information Civilization,\u201d Journal of Information Technology, volume 30, number 1, pages 75\u201389, April 2015.doi:10.1057/jit.2015.5</li> <li>Carina C. Zona: \u201cConsequences of an Insightful Algorithm,\u201d at GOTO Berlin, November 2016.</li> <li>Bruce Schneier: \u201cData Is a Toxic Asset, So Why Not Throw It Out?,\u201d schneier.com, March 1, 2016.</li> <li>John E. Dunn: \u201cThe UK\u2019s 15 Most Infamous Data Breaches,\u201d techworld.com, November 18, 2016.</li> <li>Cory Scott: \u201cData is not toxic - which implies no benefit - but rather hazardous material, where we must balance need vs. want,\u201d twitter.com, March 6, 2016.</li> <li>Bruce Schneier: \u201cMission Creep: When Everything Is Terrorism,\u201d schneier.com, July 16, 2013.</li> <li>Lena Ulbricht and Maximilian von Grafenstein: \u201cBig Data: Big Power Shifts?,\u201d Internet Policy Review, volume 5, number 1, March 2016. doi:10.14763/2016.1.406</li> <li>Ellen P. Goodman and Julia Powles: \u201cFacebook and Google: Most Powerful and Secretive Empires We've Ever Known,\u201d theguardian.com, September 28, 2016.</li> <li>Directive 95/46/EC on the protection of individuals with regard to the processing of personal data and on the free movement of such data, Official Journal of the European Communities No. L 281/31, eur-lex.europa.eu, November 1995.</li> <li>Brendan Van Alsenoy: \u201cRegulating Data Protection: The Allocation of Responsibility and Risk Among Actors Involved in Personal Data Processing,\u201d Thesis, KU Leuven Centre for IT and IP Law, August 2016.</li> <li>Michiel Rhoen: \u201cBeyond Consent: Improving Data Protection Through Consumer Protection Law,\u201d Internet Policy Review, volume 5, number 1, March 2016. doi:10.14763/2016.1.404</li> <li>Jessica Leber: \u201cYour Data Footprint Is Affecting Your Life in Ways You Can\u2019t Even Imagine,\u201d fastcoexist.com, March 15, 2016.</li> <li>Maciej Ceg\u0142owski: \u201cHaunted by Data,\u201d idlewords.com, October 2015.</li> <li>Sam Thielman: \u201cYou Are Not What You Read: Librarians Purge User Data to Protect Privacy,\u201d theguardian.com, January 13, 2016.</li> <li>Conor Friedersdorf: \u201cEdward Snowden\u2019s Other Motive for Leaking,\u201d theatlantic.com, May 13, 2014.</li> <li>Phillip Rogaway: \u201cThe Moral Character of Cryptographic Work,\u201d Cryptology ePrint 2015/1162, December 2015.</li> </ol> <ol> <li> <p>\u5728\u5fae\u670d\u52a1\u65b9\u6cd5\u4e2d\uff0c\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5728\u5904\u7406\u8d2d\u4e70\u7684\u670d\u52a1\u4e2d\u672c\u5730\u7f13\u5b58\u6c47\u7387\u6765\u907f\u514d\u540c\u6b65\u7f51\u7edc\u8bf7\u6c42\u3002\u4f46\u662f\u4e3a\u4e86\u4fdd\u8bc1\u7f13\u5b58\u7684\u65b0\u9c9c\u5ea6\uff0c\u4f60\u9700\u8981\u5b9a\u671f\u8f6e\u8be2\u6c47\u7387\u4ee5\u83b7\u53d6\u5176\u66f4\u65b0\uff0c\u6216\u8ba2\u9605\u53d8\u66f4\u6d41 \u2014\u2014 \u8fd9\u6070\u597d\u662f\u6570\u636e\u6d41\u65b9\u6cd5\u4e2d\u53d1\u751f\u7684\u4e8b\u60c5\u3002\u00a0\u21a9</p> </li> </ol>"},{"location":"books/data_intensive_system_book/1_data_system_basic.html","title":"\u53ef\u9760\u3001\u53ef\u6269\u5c55\u3001\u53ef\u7ef4\u62a4\u7684\u5e94\u7528\u7cfb\u7edf","text":"<p>\u5f53\u524d\u8bb8\u591a\u65b0\u578b\u5e94\u7528\u90fd\u5c5e\u4e8e\u6570\u636e\u5bc6\u96c6\u578b\uff0c\u800c\u4e0d\u662f\u8ba1\u7b97\u5bc6\u96c6\u578b\u3002</p> <p>\u672c\u8282\u4e3b\u8981\u8ba8\u8bba\uff1a\u53ef\u9760\u6027\u3001\u53ef\u6269\u5c55\u6027\u548c\u53ef\u7ef4\u62a4\u6027\u3002</p> <p>\u6570\u636e\u5bc6\u96c6\u578b\u5e94\u7528\u7cfb\u7edf\uff0cCPU\u5904\u7406\u80fd\u529b\u5f80\u5f80\u4e0d\u662f\u7b2c\u4e00\u9650\u5236\u6027\u56e0\u7d20\uff1a</p> <ul> <li>\u9650\u5236\u6027\u56e0\u7d20\u5728\u4e8e\u6570\u636e\u91cf\u3001\u6570\u636e\u7684\u590d\u6742\u5ea6\u548c\u6570\u636e\u7684\u591a\u53d8\u6027\u3002</li> </ul> <p>\u6570\u636e\u5bc6\u96c6\u578b\u5e94\u7528\u7cfb\u7edf\u901a\u5e38\u4e5f\u662f\u57fa\u4e8e\u6807\u51c6\u6a21\u5757\u6784\u5efa\u800c\u6210\uff0c\u6bcf\u4e2a\u6a21\u5757\u8d1f\u8d23\u5355\u4e00\u7684\u5e38\u7528\u529f\u80fd\u3002\u5982\u8bb8\u591a\u5e94\u7528\u7cfb\u7edf\u90fd\u5305\u542b\u4ee5\u4e0b\u6a21\u5757\uff1a</p> <ul> <li>\u6570\u636e\u5e93\uff1a\u5b58\u50a8\u6570\u636e\uff0c\u5e94\u7528\u53ef\u4ee5\u518d\u6b21\u8bbf\u95ee\uff1b</li> <li>\u9ad8\u901f\u7f13\u5b58\uff1a\u7f13\u5b58\u590d\u6742\u6216\u4ee3\u4ef7\u9ad8\u7684\u7ed3\u679c\uff0c\u52a0\u901f\u4e0b\u4e00\u6b21\u8bbf\u95ee\uff1b</li> <li>\u7d22\u5f15\uff1a\u6309\u5173\u952e\u5b57\u641c\u7d22\u6216\u8005\u8fc7\u6ee4\uff0c\u52a0\u901f\u8bbf\u95ee\uff1b</li> <li>\u6d41\u5f0f\u5904\u7406\uff1a\u6301\u7eed\u53d1\u9001\u6d88\u606f\u81f3\u53e6\u4e00\u8fdb\u7a0b\uff0c\u5904\u7406\u91c7\u7528\u5f02\u6b65\u65b9\u5f0f\uff1b</li> <li>\u6279\u5904\u7406\uff1a\u5b9a\u671f\u5904\u7406\u5927\u91cf\u7684\u7d2f\u8ba1\u6570\u636e\uff1b</li> <li>\u6d88\u606f\u961f\u5217\uff1a\u6d88\u606f\u7684\u8ba2\u9605\u548c\u53d1\u9001</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/1_data_system_basic.html#_2","title":"\u8ba4\u8bc6\u6570\u636e\u7cfb\u7edf","text":"<p>\u8fd1\u5e74\u6765\u8bb8\u591a\u7528\u4e8e\u6570\u636e\u5b58\u50a8\u548c\u5904\u7406\u7684\u65b0\u5de5\u5177\u9488\u5bf9\u4e0d\u540c\u5e94\u7528\u573a\u666f\u8fdb\u884c\u4f18\u5316\uff0c\u4e0d\u9002\u5408\u518d\u5f52\u4e3a\u4f20\u7edf\u7c7b\u578b\\(^{[1]}\\)\uff0c\u7cfb\u7edf\u4e4b\u95f4\u7684\u754c\u9650\u6b63\u5728\u6a21\u7cca\uff1a</p> <ul> <li>Redis \u65e2\u53ef\u4ee5\u7528\u4f5c\u6570\u636e\u5b58\u50a8\uff0c\u4e5f\u9002\u7528\u6d88\u606f\u961f\u5217\uff1b</li> <li>Kafka \u4f5c\u4e3a\u6d88\u606f\u961f\u5217\uff0c\u4e5f\u5177\u5907\u6301\u4e45\u5316\u5b58\u50a8\u4fdd\u8bc1\u3002</li> </ul> <p>\u5e94\u7528\u7cfb\u7edf\u9700\u6c42\u5e7f\u6cdb\uff0c\u9700\u8981\u7ec4\u5408\u591a\u4e2a\u7ec4\u4ef6\uff0c\u6bcf\u4e2a\u7ec4\u4ef6\u5b8c\u6210\u90e8\u5206\u529f\u80fd\uff0c\u591a\u4e2a\u7ec4\u4ef6\u4f9d\u9760\u5e94\u7528\u5c42\u4ee3\u7801\u9a71\u52a8\u6709\u673a\u7ed3\u5408\u3002</p> <ul> <li>\u793a\u4f8b\u5e94\u7528\u7cfb\u7edf\uff0c\u5305\u542b\u7f13\u5b58\u548c\u5168\u6587\u7d22\u5f15\uff0c\u4e8c\u8005\u4e0e\u6570\u636e\u5e93\u4fdd\u6301\u5173\u8054\uff0c\u901a\u5e38\u7531\u5e94\u7528\u4ee3\u7801\u8d1f\u8d23\u7f13\u5b58\u3001\u7d22\u5f15\u548c\u4e3b\u5e93\u7684\u540c\u6b65\uff0c\u5176\u67b6\u6784\u5982\u4e0b\u56fe\u6240\u793a</li> </ul> <p></p> <p>\u8fd9\u4e48\u4e00\u4e2a\u5c0f\u7cfb\u7edf\uff0c\u5728\u8bbe\u8ba1\u65f6\uff0c\u5c31\u53ef\u4ee5\u6709\u5f88\u591a\u53d6\u820d\uff1a</p> <ul> <li>\u5982\u4f55\u4fdd\u8bc1\u7f13\u5b58\u548cDB\u7684\u4e00\u81f4\u6027\uff0cCache Aside \u6216 Writre Through \u8fd8\u662f\uff1f</li> <li>\u90e8\u5206\u7ec4\u4ef6\u673a\u5668\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u662f\u4fdd\u8bc1\u53ef\u7528\u6027\u8fd8\u662f\u4fdd\u8bc1\u4e00\u81f4\u6027\uff1f</li> <li>\u5f53\u673a\u5668\u4e00\u65f6\u96be\u4ee5\u6062\u590d\uff0c\u5982\u4f55\u4fdd\u8bc1\u6570\u636e\u7684\u6b63\u786e\u6027\u548c\u5b8c\u6574\u6027\uff1f</li> <li>\u5f53\u8d1f\u8f7d\u589e\u52a0\u65f6\uff0c\u662f\u589e\u52a0\u673a\u5668\u8fd8\u662f\u63d0\u5347\u5355\u673a\u6027\u80fd\uff1f</li> <li>\u8bbe\u8ba1\u5bf9\u5916\u7684 API \u65f6\uff0c\u662f\u529b\u6c42\u7b80\u6d01\u8fd8\u662f\u8ffd\u6c42\u5f3a\u5927\uff1f</li> </ul> <p>\u4e66\u4e2d\u7528\u4e86\u4e09\u4e2a\u8bcd\u6765\u56de\u7b54\uff1a\u53ef\u9760\u6027\uff08Reliability\uff09\u3001\u53ef\u4f38\u7f29\u6027\uff08Scalability\uff09\u3001\u53ef\u7ef4\u62a4\u6027\uff08Maintainability\uff09</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/1_data_system_basic.html#_3","title":"\u53ef\u9760\u6027","text":"<p>\u5bb9\u9519\uff08fault-tolerant\uff09\u6216 \u5f39\u6027\uff08resilient\uff09</p> <ul> <li>\u5bb9\u5fcd\u7279\u5b9a\u7c7b\u578b\u7684\u6545\u969c/\u9519\u8bef\uff0c\u8f6f\u4ef6\u800c\u4e0d\u5931\u6548\uff08failure\uff09\u3002.</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/1_data_system_basic.html#_4","title":"\u786c\u4ef6\u6545\u969c","text":"<p>\u901a\u5e38\u8ba4\u4e3a\u591a\u662f\u76f8\u4e92\u72ec\u7acb\u7684</p> <ul> <li>\u786c\u76d8\u5d29\u6e83\u3001\u5185\u5b58\u6545\u969c\u3001\u7535\u7f51\u505c\u7535\u3001\u7f51\u7ebf\u8bef\u62d4\u7b49\uff1b</li> <li>\u786c\u76d8\u7684\u5e73\u5747\u65e0\u6545\u969c\u65f6\u95f4\uff08MTTF\uff09\u7ea6\u4e3a10\u5e74 ~ 50\u5e74\\(^{[1]}\\)\uff1b</li> <li>\u786c\u4ef6\u5197\u4f59\uff1aRAID\u3001\u53cc\u7535\u6e90\u3001\u70ed\u63d2\u62d4CPU\u7b49\uff1b</li> <li>\u7cfb\u7edf\u5f3a\u8c03\u603b\u4f53\u7075\u6d3b\u6027\u548c\u5f39\u6027\u800c\u975e\u5355\u53f0\u673a\u5668\u7684\u53ef\u9760\u6027\uff1b</li> <li>\u8f6f\u4ef6\u5bb9\u9519\u7684\u65b9\u5f0f\u5bb9\u5fcd\u591a\u673a\u5931\u6548\u662f\u6709\u529b\u7684\u8865\u5145\u548c\u65b0\u7684\u624b\u6bb5\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/1_data_system_basic.html#_5","title":"\u8f6f\u4ef6\u9519\u8bef","text":"<p>\u7cfb\u7edf\u5185\u8f6f\u4ef6\u7cfb\u7edf\u66f4\u96be\u9884\u6599\uff0c\u5f80\u5f80\u4f1a\u5bfc\u81f4\u66f4\u591a\u7684\u7cfb\u7edf\u6545\u969c\uff1a</p> <ul> <li>\u7279\u5b9a\u573a\u666f\u7684\u7684\u5d29\u6e83\uff0c\u6bd4\u59822012\u5e746\u7ea630\u65e5Linux\u5185\u6838\u95f0\u79d2\u7684\u5904\u7406BUG\\(^{[2]}\\)\uff1b</li> <li>\u5171\u4eab\u8d44\u6e90\u4f7f\u7528\u5f02\u5e38\uff0c\u5982CPU\u3001\u5185\u5b58\u3001\u78c1\u76d8\u3001\u7f51\u7edc\u4f7f\u7528\u5931\u63a7\u8dd1\u98de\uff1b</li> <li>\u4f9d\u8d56\u7684\u670d\u52a1\u53d8\u6162\u6216\u8005\u5f02\u5e38\uff1b</li> <li>\u7ea7\u8054\u6545\u969c\uff0c\u6709\u4e00\u4e2a\u7ec4\u4ef6\u5c0f\u6545\u969c\u5f15\u8d77\u53e6\u4e00\u4e2a\u7ec4\u4ef6\u6545\u969c\uff1b</li> </ul> <p>\u7cfb\u7edf\u8f6f\u4ef6\u901a\u5e38\u5bf9\u4f7f\u7528\u73af\u5883\u5b58\u5728\u67d0\u79cd\u5047\u8bbe\uff0c\u5728\u7279\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u5047\u8bbe\u6761\u4ef6\u53d8\u5f97\u4e0d\u5728\u6210\u7acb\u3002</p> <p>\u6c92\u6709\u5feb\u901f\u89e3\u51b3\u65b9\u6cd5\uff0c\u53ea\u80fd\u8003\u8651\u66f4\u591a\u7684\u7ec6\u8282\uff1a</p> <ul> <li>\u8ba4\u771f\u68c0\u67e5\u4f9d\u8d56\u7684\u5047\u8bbe\u6761\u4ef6\uff1b</li> <li>\u8fdb\u884c\u5168\u9762\u7684\u6d4b\u8bd5\uff1b</li> <li>\u8fdb\u7a0b\u9694\u79bb\uff0c\u5141\u8bb8\u8fdb\u7a0b\u5d29\u6e83\u540e\u81ea\u542f\u52a8\uff1b</li> <li>\u76d1\u63a7\u5e76\u5206\u6790\u751f\u4ea7\u884c\u4e3a\uff0c\u5f02\u5e38\u68c0\u6d4b\u7b49\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/1_data_system_basic.html#_6","title":"\u4eba\u4e3a\u9519\u8bef","text":"<p>\u4e92\u8054\u7f51\u670d\u52a1\u4e2d\uff0c\u8fd0\u7ef4\u7684\u914d\u7f6e\u9519\u8bef\u662f\u7cfb\u7edf\u4e0b\u7ebf\u7684\u9996\u8981\u539f\u56e0\\(^{[3]}\\)\u3002</p> <p>\u5047\u5b9a\u4eba\u662f\u4e0d\u53ef\u9760\u7684\uff0c\u5982\u4f55\u4fdd\u8bc1\u7cfb\u7edf\u7684\u53ef\u9760\u6027\uff1f</p> <ul> <li>\u4ee5\u6700\u5c0f\u51fa\u9519\u7684\u65b9\u5f0f\u6765\u8bbe\u8ba1\u7cfb\u7edf\uff0c\u5982\u7cbe\u5fc3\u8bbe\u8ba1\u62bd\u8c61\u5c42\u3001API\u5c42\u548c\u7ba1\u7406\u754c\u9762\uff0c\u9650\u5236\u4e0e\u5e73\u8861\uff1b</li> <li>\u60f3\u529e\u6cd5\u5206\u79bb\u51fa\u6700\u5bb9\u6613\u51fa\u9519\u7684\u5730\u65b9\uff0c\u63d0\u4f9b\u6c99\u7bb1/\u7c7b\u751f\u4ea7\u73af\u5883\uff1b</li> <li>\u5145\u5206\u7684\u6d4b\u8bd5\uff0c\u81ea\u52a8\u5316\u6d4b\u8bd5\uff1b</li> <li>\u4eba\u4e3a\u5931\u8bef\u65f6\uff0c\u5feb\u901f\u7684\u6062\u590d\u673a\u5236\u4ee5\u5c3d\u91cf\u51cf\u5c11\u6545\u969c\u5f71\u54cd\uff1b</li> <li>\u8bbe\u7f6e\u8be6\u7ec6\u800c\u6e05\u6670\u7684\u76d1\u63a7\u5b50\u7cfb\u7edf\uff0c\u5305\u62ec\u6027\u80fd\u6307\u6807\u548c\u9519\u8bef\u7387\uff1b</li> <li>\u63a8\u7406\u7ba1\u7406\u6d41\u7a0b\u5e76\u52a0\u4ee5\u57f9\u8bad\uff0c\u826f\u597d\u7684\u64cd\u4f5c\u6587\u6863\u7b49\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/1_data_system_basic.html#_7","title":"\u53ef\u6269\u5c55\u6027","text":"<p>\u53ef\u6269\u5c55\u6027\u662f\u63cf\u8ff0\u7cfb\u7edf\u5e94\u5bf9\u8d1f\u8f7d\u589e\u52a0\u80fd\u529b\u7684\u672f\u8bed\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/1_data_system_basic.html#_8","title":"\u63cf\u8ff0\u8d1f\u8f7d","text":"<p>\u8d1f\u8f7d\u7528\u79f0\u4e3a\u8d1f\u8f7d\u53c2\u6570\u7684\u82e5\u5e72\u6570\u5b57\u6765\u63cf\u8ff0\uff0c\u53d6\u51b3\u4e8e\u7cfb\u7edf\u7684\u4f53\u7cfb\u7ed3\u6784\uff1a</p> <ul> <li>Web\u670d\u52a1\u5668\u7684\u6bcf\u79d2\u8bf7\u6c42\u5904\u7406\u6b21\u6570\uff1b</li> <li>\u6570\u636e\u5e93\u4e2d\u8bfb\u5199\u7684\u6bd4\u4f8b\u548c\u6b21\u6570\uff1b</li> <li>\u7f13\u5b58\u547d\u4e2d\u7387\u3001\u540c\u65f6\u5728\u7ebf\u4eba\u6570\u7b49\uff1b</li> </ul> <p>\u4ee5\u63a8\u7279\u5728 2012 \u5e74 11 \u6708\u53d1\u5e03\u7684\u6570\u636e\\(^{[6]}\\)\u4e3a\u4f8b\u3002\u63a8\u7279\u7684\u4e24\u4e2a\u4e3b\u8981\u4e1a\u52a1\u662f\uff1a</p> <ul> <li>\u53d1\u5e03Tweet\u6d88\u606f\uff1a\u7528\u6237\u53ef\u4ee5\u5feb\u901f\u63a8\u9001\u65b0\u6d88\u606f\u5230\u6240\u6709\u5173\u6ce8\u8005\uff0c\u5e73\u5747\u5927\u7ea64.6k request/sec\uff0c\u5cf0\u503c\u7ea612k request/sec\uff1b</li> <li>\u4e3b\u9875\u65f6\u95f4\u7ebf\uff08Home timeline\uff09\u6d4f\u89c8\uff1a\u5e73\u5747300K request/sec \u67e5\u770b\u5173\u6ce8\u5bf9\u8c61\u7684\u6700\u65b0\u6d88\u606f\uff1b</li> </ul> <p>\u63a8\u7279\u7684\u4f38\u7f29\u6027\u6311\u6218\u6765\u81ea \u6247\u51fa\uff08fan-out\uff09\uff1a\u6bcf\u4e2a\u7528\u6237\u5173\u6ce8\u4e86\u5f88\u591a\u4eba\uff0c\u4e5f\u88ab\u5f88\u591a\u4eba\u5173\u6ce8\u3002</p> <p>\u4e00\u822c\u6709\u4e24\u79cd\u601d\u8def\uff1a</p> <ul> <li> <p>\u62c9\u53d6\uff1a\u5c06\u53d1\u9001\u7684\u65b0\u7684 tweet \u63d2\u5165\u5230\u5168\u5c40\u7684 tweet \u96c6\u5408\u3002\u5f53\u7528\u6237\u67e5\u770b\u65f6\u95f4\u7ebf\u65f6\uff0c\u9996\u5148\u67e5\u627e\u6240\u6709\u7684\u5173\u6ce8\u5bf9\u8c61\uff0c\u5217\u51fa\u8fd9\u4e9b\u4eba\u7684 tweet\uff0c\u6700\u540e\u4e00\u65f6\u95f4\u4e3a\u5e8f\u5c06\u8fdb\u884c\u6392\u5e8f\u5408\u5e76\u3002</p> </li> <li> <p>\u7528\u6237\u53ea\u6709\u67e5\u770b\u65f6\u624d\u4f1a\u53bb\u62c9\u53d6\uff0c\u4f46\u662f\u6bcf\u6b21\u67e5\u770b\u65f6\u73b0\u53bb\u62c9\u53d6\uff0c\u5448\u73b0\u901f\u5ea6\u8f83\u6162\uff1b</p> </li> </ul> <pre><code># SQL code\nSELECT tweet.*, user.* FROM tweets JOIN users ON tweets.sender_id = users.id\nJOIN follows ON follows.followee_id = users.id\nWHERE follows.follower_id = current_user\n</code></pre> <p></p> <ul> <li> <p>\u63a8\u9001\uff1a\u5bf9\u6bcf\u4e2a\u7528\u6237\u7684\u65f6\u95f4\u7ebf\u7ef4\u62a4\u4e00\u4e2a\u7f13\u5b58\uff0c\u7c7b\u4f3c\u6bcf\u4e2a\u7528\u6237\u4e00\u4e2a tweet \u90ae\u7bb1\u3002\u5f53\u7528\u6237\u63a8\u9001\u65b0 tweet \u65f6\uff0c\u67e5\u8be2\u5176\u5173\u6ce8\u8005\uff0c\u5c06 tweet \u63d2\u5165\u5230\u6bcf\u4e2a\u5173\u6ce8\u7740\u7684\u65f6\u95f4\u7ebf\u7f13\u5b58\u4e2d</p> </li> <li> <p>\u8bfb\u53d6\u4e3b\u9875\u65f6\u95f4\u7ebf\u7684\u8bf7\u6c42\u5f00\u9500\u5f88\u5c0f\uff0c\u56e0\u4e3a\u7ed3\u679c\u5df2\u7ecf\u63d0\u524d\u8ba1\u7b97\u597d\uff1b</p> </li> <li>\u5199\u653e\u5927\uff1a\u7c89\u4e1d\u591a\u7684\u4eba\u53d1\u7684\u4e00\u4e2a tweet \u4f1a\u5bfc\u81f4 3000 \u4e07\u7b14\u5199\u5165\uff0c\u5bf9\u4e8e\u54cd\u5e94\u6027\u80fd/\u5b58\u50a8\u662f\u6311\u6218\uff1b</li> </ul> <p></p> <p>Tweet \u540e\u9762\u91c7\u7528\u65b9\u6cd52\uff0c\u6548\u679c\u66f4\u597d\uff0c\u56e0\u4e3a\u53d1\u63a8\u9891\u7387\u6bd4\u67e5\u8be2\u4e3b\u9875\u65f6\u95f4\u7ebf\u7684\u9891\u7387\u51e0\u4e4e\u4f4e\u4e86\u4e24\u4e2a\u6570\u91cf\u7ea7\u3002</p> <ul> <li>\u63a8\u7279\u5c1d\u8bd5\u5728 5 \u79d2\u5185\u5411\u7c89\u4e1d\u53d1\u9001\u63a8\u6587\uff1a3000 \u4e07\u7684\u7c89\u4e1d\u5927 V \u7684\u63a8\u6587\u5bfc\u81f4\u4e3b\u9875\u65f6\u95f4\u7ebf\u7f13\u5b58\u7684 3000 \u4e07\u6b21\u7684\u53ca\u65f6\u5199\u5165</li> </ul> <p>\u5173\u952e\u70b9\uff1a\u6bcf\u4e2a\u7528\u6237\u8005\u7684\u5206\u5e03\u60c5\u51b5\uff08\u53ef\u4ee5\u7ed3\u5408\u7528\u6237\u4f7f\u7528\u9891\u7387\u8fdb\u884c\u52a0\u6743\uff09\u662f\u53ef\u6269\u5c55\u7684\u5173\u952e\u8d1f\u8f7d\u56e0\u7d20\u3002</p> <ul> <li>\u5927\u591a\u6570\u7528\u6237\u53d1\u7684\u63a8\u6587\u4f1a\u88ab\u6247\u51fa\u5199\u5165\u5176\u7c89\u4e1d\u4e3b\u9875\u65f6\u95f4\u7ebf\u7f13\u5b58\u4e2d\uff0c\u6d77\u91cf\u7c89\u4e1d\u7684\u7528\u6237\uff08\u5373\u540d\u6d41\uff09\u9664\u5916\uff1b</li> <li>\u5f53\u7528\u6237\u8bfb\u53d6\u4e3b\u9875\u65f6\u95f4\u7ebf\u65f6\uff0c\u5206\u522b\u5730\u83b7\u53d6\u51fa\u8be5\u7528\u6237\u6240\u5173\u6ce8\u7684\u6bcf\u4f4d\u540d\u6d41\u7684\u63a8\u6587\uff0c\u518d\u4e0e\u7528\u6237\u7684\u4e3b\u9875\u65f6\u95f4\u7ebf\u7f13\u5b58\u5408\u5e76\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/1_data_system_basic.html#_9","title":"\u63cf\u8ff0\u6027\u80fd","text":"<ul> <li>\u8d1f\u8f7d\u589e\u52a0\uff0c\u7cfb\u7edf\u8d44\u6e90\u4e0d\u53d8\uff0c\u7cfb\u7edf\u6027\u80fd\u5982\u4f55\u53d8\u5316\uff1f</li> <li>\u8d1f\u8f7d\u589e\u52a0\uff0c\u5982\u679c\u8981\u4fdd\u6301\u6027\u80fd\u4e0d\u53d8\uff0c\u9700\u8981\u589e\u52a0\u591a\u5c11\u8d44\u6e90\uff1f</li> </ul> <p>\u6027\u80fd\u6307\u6807\uff1a\u541e\u5410\u91cf\uff08\u79bb\u7ebf\uff09\uff0c\u54cd\u5e94\u65f6\u95f4\uff08\u5728\u7ebf\uff09\u3002</p> <p>\u54cd\u5e94\u65f6\u95f4\u901a\u8fc7\u767e\u5206\u4f4d\u6570\u8868\u793a\uff0cp95\uff0890%\uff09\uff0cp99\uff0899%\uff09\uff0cp999\uff0899.9%\uff09\uff1b</p> <ul> <li>\u767e\u5206\u4f4d\u6570\u7528\u6765\u5b9a\u4e49\u670d\u52a1\u8d28\u91cf\u76ee\u6807\uff08SLO\uff09\u548c\u670d\u52a1\u8d28\u91cf\u534f\u8bae\uff08SLA\uff09\uff1b</li> <li>\u54cd\u5e94\u65f6\u95f4\u7684\u9ad8\u767e\u5206\u4f4d\u70b9\uff08\u4e5f\u79f0\u4e3a \u5c3e\u90e8\u5ef6\u8fdf\uff0c\u5373 tail latencies\uff09\uff0c\u76f4\u63a5\u5f71\u54cd\u7528\u6237\u7684\u670d\u52a1\u4f53\u9a8c</li> <li>\u7814\u7a76\u8868\u660e\uff0c1s\u7684\u5ef6\u8fdf\u589e\u52a0\u7b49\u4ef7\u4e8e\u5ba2\u6237\u6ee1\u610f\u5ea6\u4e0b\u964d16%\\(^{[4]}\\)\uff1b</li> </ul> <p>\u6392\u961f\u5ef6\u8fdf\uff08queueing delay\uff09 \u901a\u5e38\u5360\u4e86\u9ad8\u767e\u5206\u4f4d\u70b9\u5904\u54cd\u5e94\u65f6\u95f4\u7684\u5f88\u5927\u4e00\u90e8\u5206\u3002</p> <ul> <li>\u5934\u90e8\u963b\u585e\uff08head-of-line blocking\uff09\uff1a\u670d\u52a1\u5668\u53ea\u80fd\u5e76\u884c\u5904\u7406\u5c11\u91cf\u7684\u4e8b\u52a1\uff08\u5982\u53d7\u5176 CPU \u6838\u6570\u7684\u9650\u5236\uff09\uff0c\u53ea\u8981\u6709\u5c11\u91cf\u7f13\u6162\u7684\u8bf7\u6c42\u5c31\u80fd\u963b\u788d\u540e\u7eed\u8bf7\u6c42\u7684\u5904\u7406</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/1_data_system_basic.html#_10","title":"\u5e94\u5bf9\u8d1f\u8f7d\u589e\u52a0","text":"<ul> <li> <p>\u5782\u76f4\u6269\u5c55\uff08scaling up\uff09\uff1a\u66f4\u5f3a\u5927\u7684\u673a\u5668\uff1b</p> </li> <li> <p>\u6c34\u5e73\u6269\u5c55\uff08scaling out\uff09\uff1a\u66f4\u591a\u7684\u673a\u5668\uff1b</p> </li> </ul> <p>\u8d85\u5927\u89c4\u6a21\u7684\u7cfb\u7edf\u5f80\u5f80\u9488\u5bf9\u7279\u5b9a\u5e94\u7528\u800c\u9ad8\u5ea6\u5b9a\u5236\uff0c\u5f88\u96be\u6709\u4e00\u79cd\u901a\u7528\u7684\u67b6\u6784\u3002</p> <ul> <li>\u6bcf\u79d2\u5904\u740610w\u6b21\u8bf7\u6c42\uff08\u5927\u5c0f1KB\uff09\uff0c\u4e0e\u6bcf\u5206\u949f3\u4e2a\u8bf7\u6c42\uff08\u5927\u5c0f2GB\uff09\u8bbe\u8ba1\u7684\u7cfb\u7edf\u5927\u4e0d\u76f8\u540c\uff1b</li> <li>\u6269\u5c55\u80fd\u529b\u597d\u7684\u67b6\u6784\u901a\u5e38\u4f1a\u505a\u51fa\u67d0\u4e9b\u5047\u8bbe\uff0c\u6709\u9488\u5bf9\u6027\u4f18\u5316\u8bbe\u8ba1\uff0c\u54ea\u4e9b\u64cd\u4f5c\u9891\u7e41\u3001\u90a3\u4e9b\u8d1f\u8f7d\u5c11\u6570\uff1f\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/1_data_system_basic.html#_11","title":"\u53ef\u7ef4\u62a4\u6027","text":"<p>\u8f6f\u4ef6\u7684\u5927\u90e8\u5206\u6210\u672c\uff0c\u5728\u4e8e\u6574\u4e2a\u751f\u547d\u5468\u671f\u5185\u6301\u7eed\u7684\u6295\u5165\uff0c\u5305\u62ec\u7ef4\u62a4\u4e0e\u7f3a\u9677\u4fee\u590d\u3001\u76d1\u63a7\u7cfb\u7edf\u6b63\u5e38\u4e91\u4e60\u60ef\u3001\u6545\u969c\u6392\u67e5\u3001\u9002\u914d\u65b0\u5e73\u53f0\u3001\u589e\u52a0\u65b0\u529f\u80fd\u7b49\u3002</p> <p>\u8f6f\u4ef6\u8bbe\u8ba1\u65f6\uff0c\u5c3d\u53ef\u80fd\u51cf\u5c11\u7ef4\u62a4\u671f\u95f4\u7684\u9ebb\u70e6\uff1a</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/1_data_system_basic.html#_12","title":"\u53ef\u8fd0\u7ef4\u6027","text":"<p>\u826f\u597d\u7684\u53ef\u64cd\u4f5c\u6027</p> <ul> <li>\u63d0\u4f9b\u5bf9\u7cfb\u7edf\u5185\u90e8\u8fd0\u884c\u65f6\u884c\u4e3a\u548c\u5185\u90e8\u7684\u53ef\u89c2\u6d4b\u6027\uff0c\u65b9\u4fbf\u76d1\u63a7\uff1b</li> <li>\u652f\u6301\u81ea\u52a8\u5316\uff0c\u4e0e\u6807\u51c6\u5de5\u5177\u96c6\u6210\uff1b</li> <li>\u907f\u514d\u7ed1\u5b9a\u7279\u5b9a\u7684\u673a\u5668\uff0c\u7cfb\u7edf\u4e0d\u95f4\u65ad\u8fd0\u884c\u540c\u65f6\u5141\u8bb8\u673a\u5668\u505c\u673a\u7ef4\u62a4\uff1b</li> <li>\u63d0\u4f9b\u826f\u597d\u7684\u6587\u6863\u548c\u6613\u4e8e\u7406\u89e3\u7684\u64cd\u4f5c\u6a21\u5f0f\uff0c\u5982\u201c\u5982\u679c\u6211\u505a\u4e86X\uff0c\u4f1a\u53d1\u751fY\u201d\uff1b</li> <li>\u63d0\u4f9b\u826f\u597d\u7684\u9ed8\u8ba4\u914d\u7f6e\uff0c\u4e14\u5141\u8bb8\u7ba1\u7406\u5458\u5728\u9700\u8981\u65f6\u65b9\u4fbf\u5730\u4fee\u6539\u9ed8\u8ba4\u503c\uff1b</li> <li>\u5c1d\u8bd5\u81ea\u6211\u4fee\u590d\uff0c\u540c\u65f6\u63d0\u4f9b\u624b\u52a8\u65b9\u5f0f\u63a7\u5236\u7cfb\u7edf\u72b6\u6001\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/1_data_system_basic.html#_13","title":"\u7b80\u5355\u6027","text":"<p>\u7b80\u5316\u590d\u6742\u5ea6\uff0c\u590d\u6742\u6027\u4f7f\u5f97\u7ef4\u62a4\u53d8\u5f97\u8d8a\u6765\u8d8a\u56f0\u96be\uff0c\u5bfc\u81f4\u9884\u7b97\u8d85\u652f\u548c\u5f00\u53d1\u8fdb\u5ea6\u6ede\u540e\uff1b</p> <ul> <li>\u590d\u6742\u6027\uff1a\u72b6\u6001\u7a7a\u95f4\u81a8\u80c0\u3001\u6a21\u5757\u7d27\u8026\u5408\u3001\u76f8\u4e92\u4f9d\u8d56\u3001\u4e0d\u4e00\u81f4\u7684\u547d\u540d\u548c\u672f\u8bed\u3001\u7279\u6b8a\u903b\u8f91\u548c\u7279\u6b8a\u6846\u67b6\\(^{[5]}\\)\uff1b</li> <li>\u590d\u6742\u6027\u88ab\u5b9a\u4e49\u4e3a\u4e00\u79cd\u201c\u610f\u5916\u201d\uff0c\u975e\u8f6f\u4ef6\u56fa\u6709\uff0c\u7528\u6237\u4e0d\u611f\u77e5\uff0c\u800c\u662f\u5b9e\u73b0\u672c\u8eab\u6240\u884d\u751f\u51fa\u6765\u7684\u95ee\u9898\uff1b</li> <li>\u6d88\u9664\u610f\u5916\u590d\u6742\u6027\u6700\u597d\u7684\u624b\u6bb5\u4e4b\u4e00\u662f\u62bd\u8c61\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/1_data_system_basic.html#_14","title":"\u53ef\u6f14\u5316\u6027","text":"<p>\u6613\u4e8e\u6539\u53d8\uff0c\u60f3\u6cd5\u548c\u76ee\u6807\u7ecf\u5e38\u5728\u4e0d\u65ad\u53d8\u5316\uff1a\u65b0\u529f\u80fd\u3001\u65b0\u73af\u5883\u3001\u6cd5\u5f8b\u5b89\u5168\u6027\u3001\u4e1a\u52a1\u67b6\u6784\u53d8\u5316\uff1b</p> <p>\u201c\u53ef\u6f14\u5316\u6027\u201d\uff1a\u63cf\u8ff0\u6570\u636e\u7cfb\u7edf\u7ea7\u7684\u654f\u6377\u6027\uff1a</p> <ul> <li>\u7b80\u5355\u6027\u9ad8\u7684\u7cfb\u7edf\u901a\u5e38\u6bd4\u590d\u6742\u7684\u7cfb\u7edf\u66f4\u5bb9\u6613\u4fee\u6539\uff1b</li> <li>\u654f\u6377\u5f00\u53d1\u6a21\u5f0f\u548c\u76f8\u5e94\u7684\u6280\u672f(TDD/\u91cd\u6784)\u53ef\u4ee5\u5e26\u6765\u4e00\u4e9b\u5e2e\u52a9\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/1_data_system_basic.html#_15","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>Brian Beach: \u201cHard Drive Reliability Update \u2013 Sep 2014,\u201d backblaze.com, September 23, 2014.</li> <li>Nelson Minar: \u201cLeap Second Crashes Half the Internet,\u201d somebits.com, July 3, 2012.</li> <li>David Oppenheimer, Archana Ganapathi, and David A. Patterson: \u201cWhy Do Internet Services Fail, and What Can Be Done About It?,\u201d at 4th USENIX Symposium on Internet Technologies and Systems (USITS), March 2003.</li> <li>Tammy Everts: \u201cThe Real Cost of Slow Time vs Downtime,\u201d webperformancetoday.com, November 12, 2014.</li> <li>Rich Hickey: \u201cSimple Made Easy,\u201d at Strange Loop, September 2011.</li> <li>Raffi Krikorian: \u201cTimelines at Scale,\u201d at QCon San Francisco, November 2012.</li> </ol>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html","title":"\u6570\u636e\u6a21\u578b\u548c\u67e5\u8be2\u8bed\u8a00","text":"<p>\u4ecb\u7ecd\u7528\u4e8e\u6570\u636e\u5b58\u50a8\u548c\u67e5\u8be2\u7684\u901a\u7528\u6570\u636e\u6a21\u578b\u3002</p> <p>\u6bcf\u5c42\u901a\u8fc7\u63d0\u4f9b\u4e00\u4e2a\u7b80\u5355\u7684\u6570\u636e\u6a21\u578b\u6765\u9690\u85cf\u4e0b\u5c42\u7684\u590d\u6742\u6027\u3002</p> <p>A data model is an abstract model that organizes elements of data and standardizes how they relate to one another and to the properties of real-world entities. \u2014https://en.wikipedia.org/wiki/Data_model   </p> <p>\u5728\u5386\u53f2\u4e0a\uff0c\u6570\u636e\u6700\u5f00\u59cb\u88ab\u8868\u793a\u4e3a\u4e00\u68f5\u5927\u6811\uff08\u5c42\u6b21\u6570\u636e\u6a21\u578b\uff09\uff0c\u4f46\u662f\u8fd9\u4e0d\u5229\u4e8e\u8868\u793a\u591a\u5bf9\u591a\u7684\u5173\u7cfb\uff0c\u6240\u4ee5\u53d1\u660e\u4e86\u5173\u7cfb\u6a21\u578b\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>\u6700\u8fd1\uff0c\u5f00\u53d1\u4eba\u5458\u53d1\u73b0\u4e00\u4e9b\u5e94\u7528\u7a0b\u5e8f\u4e5f\u4e0d\u9002\u5408\u91c7\u7528\u5173\u7cfb\u6a21\u578b\u3002\u65b0\u7684\u975e\u5173\u7cfb\u578b \u201cNoSQL\u201d \u6570\u636e\u5b58\u50a8\u5206\u5316\u4e3a\u4e24\u4e2a\u4e3b\u8981\u65b9\u5411\uff1a</p> <ul> <li>\u6587\u6863\u6570\u636e\u5e93\uff1a\u6570\u636e\u6765\u81ea\u4e8e\u81ea\u5305\u542b\u6587\u6863\uff0c\u4e14\u4e00\u4e2a\u6587\u6863\u4e0e\u5176\u4ed6\u6587\u6863\u4e4b\u95f4\u7684\u5173\u8054\u5f88\u5c11\uff1b</li> <li>\u56fe\u6570\u636e\u5e93\uff1a\u6240\u6709\u6570\u636e\u90fd\u53ef\u80fd\u4f1a\u76f8\u5173\u8054\uff1b</li> </ul> <p>\u8fd9\u4e09\u79cd\u6a21\u578b\uff08\u6587\u6863\uff0c\u5173\u7cfb\u548c\u56fe\u5f62\uff09\u5728\u4eca\u5929\u90fd\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u5e76\u4e14\u5728\u5404\u81ea\u7684\u9886\u57df\u90fd\u53d1\u6325\u5f88\u597d\u3002</p> <p>\u6587\u6863\u6570\u636e\u5e93\u548c\u56fe\u6570\u636e\u5e93\u6709\u4e00\u4e2a\u5171\u540c\u70b9\uff0c\u90a3\u5c31\u662f\u5b83\u4eec\u901a\u5e38\u4e0d\u4f1a\u5c06\u5b58\u50a8\u7684\u6570\u636e\u5f3a\u5236\u7ea6\u675f\u4e3a\u7279\u5b9a\u6a21\u5f0f\uff1a</p> <ul> <li>\u5e94\u7528\u7a0b\u5e8f\u5f88\u53ef\u80fd\u4ecd\u4f1a\u5047\u5b9a\u6570\u636e\u5177\u6709\u4e00\u5b9a\u7684\u7ed3\u6784\uff1b\u533a\u522b\u4ec5\u5728\u4e8e\u6a21\u5f0f\u662f\u660e\u786e\u7684\uff08\u5199\u5165\u65f6\u5f3a\u5236\uff09\u8fd8\u662f\u9690\u542b\u7684\uff08\u8bfb\u53d6\u65f6\u5904\u7406\uff09</li> </ul> <p>\u4ecd\u7136\u6709\u8bb8\u591a\u6570\u636e\u6a21\u578b\u6ca1\u6709\u63d0\u5230\uff1a</p> <ul> <li>\u57fa\u56e0\u7ec4\u6570\u636e\uff1a\u76f8\u4f3c\u6027\u641c\u7d22\uff0c\u76f8\u4f3c\u4f46\u5b8c\u5168\u4e0d\u540c\u7684\u5927\u578b\u5b57\u7b26\u4e32\u6570\u636e\u5339\u914d\uff0c\u4e13\u7528\u8f6f\u4ef6GenBank\\(^{[16]}\\)\u3002</li> <li>\u5168\u6587\u68c0\u7d22\uff1a\u7ecf\u5e38\u4e0e\u6570\u636e\u5e93\u4e00\u8d77\u4f7f\u7528\u7684\u6a21\u578b\uff0c\u8f6f\u4ef6\u5982 ElasticSearch\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#_2","title":"\u5173\u7cfb\u6a21\u578b\u4e0e\u6587\u6863\u6a21\u578b","text":"<p>\u5173\u7cfb\u6a21\u578b\u7684\u6bcf\u4e2a\u7ade\u4e89\u8005\u90fd\u5728\u5176\u65f6\u4ee3\u4ea7\u751f\u4e86\u5927\u91cf\u7684\u7092\u4f5c\uff0c\u4f46\u4ece\u6765\u6ca1\u6709\u6301\u7eed\\(^{[2]}\\)\u3002</p> <p>\u878d\u5408\u5173\u7cfb\u578b\u548c\u6587\u6863\u6a21\u578b\u662f\u672a\u6765\u6570\u636e\u5e93\u53d1\u5c55\u7684\u4e00\u6761\u5f88\u597d\u7684\u9014\u5f84\u3002</p> <ul> <li>MyQL 5.7, PostgreSQL 9.3 \u652f\u6301 JSON \u6587\u6863\u3002</li> </ul> <p>1970 \u5e74\u63d0\u51fa\u5173\u7cfb\u6a21\u578b\uff08SQL\uff09\\(^{[1]}\\)\uff1aOLAP/OLTP/HTAP</p> <ul> <li> <p>\u652f\u6301\u4e00\u5bf9\u4e00\u3001\u4e00\u5bf9\u591a\u3001\u591a\u5bf9\u4e00\u3001\u591a\u5bf9\u591a\u5173\u7cfb\uff1b</p> </li> <li> <p>\u6d88\u9664\u6570\u636e\u91cd\u590d\uff08ID\u4f5c\u4e3a\u5173\u952e\u5b57\u8054\u7ed3\uff09\u662f\u6570\u636e\u5e93\u89c4\u8303\u5316\u7684\u6838\u5fc3\u601d\u60f3\uff1b</p> </li> <li> <p>\u5199\u65f6\u6a21\u5f0f\uff1a\u6240\u6709\u8bb0\u5f55\u90fd\u5177\u6709\u76f8\u540c\u7684\u6570\u636e\u7ed3\u6784\uff1b</p> </li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#nosql","title":"NoSQL \u7684\u8bde\u751f","text":"<p>NoSQL\\(^{[3]}\\)\uff08Not only SQL\uff09\u662f\u5bf9\u4e0d\u540c\u4e8e\u4f20\u7edf\u7684\u5173\u7cfb\u6570\u636e\u5e93\u7684\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u7684\u7edf\u79f0\u3002\u6839\u636e DB-Engines \u6392\u540d\uff0c\u73b0\u5728\u6700\u53d7\u6b22\u8fce\u7684 NoSQL \u524d\u51e0\u540d\u4e3a\uff1aMongoDB\uff0cRedis\uff0cElasticSearch\uff0cCassandra\u3002</p> <p>\u5176\u50ac\u52a8\u56e0\u7d20\u6709\uff1a</p> <ol> <li>\u5904\u7406\u66f4\u5927\u6570\u636e\u96c6\uff1a\u66f4\u5f3a\u4f38\u7f29\u6027\u3001\u66f4\u9ad8\u541e\u5410\u91cf</li> <li>\u5f00\u6e90\u514d\u8d39\u7684\u5174\u8d77\uff1a\u51b2\u51fb\u4e86\u539f\u6765\u628a\u63e1\u5728\u5382\u5546\u7684\u6807\u51c6</li> <li>\u7279\u5316\u7684\u67e5\u8be2\u64cd\u4f5c\uff1a\u5173\u7cfb\u6570\u636e\u5e93\u96be\u4ee5\u652f\u6301\u7684\uff0c\u6bd4\u5982\u56fe\u4e2d\u7684\u591a\u8df3\u5206\u6790</li> <li>\u8868\u8fbe\u80fd\u529b\u66f4\u5f3a\uff1a\u5173\u7cfb\u6a21\u578b\u7ea6\u675f\u592a\u4e25\uff0c\u9650\u5236\u592a\u591a</li> </ol>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#_3","title":"\u5bf9\u8c61\u5173\u7cfb\u4e0d\u5339\u914d","text":"<p>\u5982\u679c\u6570\u636e\u5b58\u50a8\u5728\u5173\u7cfb\u8868\u4e2d\uff0c\u90a3\u4e48\u9700\u8981\u4e00\u4e2a\u7b28\u62d9\u7684\u8f6c\u6362\u5c42\uff0c\u5904\u4e8e\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u4e2d\u7684\u5bf9\u8c61\u548c\u8868\u3001\u884c\u3001\u5217\u7684\u6570\u636e\u5e93\u6a21\u578b\u4e4b\u95f4\u3002\u6a21\u578b\u4e4b\u95f4\u7684\u4e0d\u8fde\u8d2f\u6709\u65f6\u88ab\u79f0\u4e3a \u963b\u6297\u4e0d\u5339\u914d\uff08impedance mismatch\uff09\u3002</p> <p>Hibernate \u8fd9\u6837\u7684 \u5bf9\u8c61\u5173\u7cfb\u6620\u5c04\uff08ORM object-relational mapping\uff09 \u6846\u67b6\u53ef\u4ee5\u51cf\u5c11\u8fd9\u4e2a\u8f6c\u6362\u5c42\u6240\u9700\u7684\u6837\u677f\u4ee3\u7801\u7684\u6570\u91cf\uff0c\u4f46\u662f\u5b83\u4eec\u4e0d\u80fd\u5b8c\u5168\u9690\u85cf\u8fd9\u4e24\u4e2a\u6a21\u578b\u4e4b\u95f4\u7684\u5dee\u5f02\u3002</p> <p>\u4e0b\u56fe\u5c55\u793a\u5982\u4f55\u5728\u5173\u7cfb\u6a21\u5f0f\u4e2d\u8868\u793a\u7b80\u5386\uff08\u4e00\u4e2a LinkedIn \u7b80\u4ecb\uff09\uff1a</p> <ul> <li>\u4f20\u7edf SQL \u6a21\u578b\uff08SQL\uff1a1999 \u4e4b\u524d\uff09\uff0c\u89c4\u8303\u5316\u8868\u793a\uff0c\u91c7\u7528\u5916\u952e\u5f15\u7528\u7684\u5f62\u5f0f\uff0c\u591a\u8868\u4e4b\u95f4\u8fdb\u884c\u5173\u8054\uff1b</li> <li>\u540e\u7eed SQL \u652f\u6301\u5bf9\u7ed3\u6784\u5316\u6570\u636e\uff08Json\uff09\u548cXML\u7c7b\u578b\u6570\u636e\u7684\u652f\u6301\uff0c\u5982 PostgreSQL\uff0c\u652f\u6301\u67e5\u8be2\u548c\u7d22\u5f15\uff1b</li> </ul> <p></p> <p>\u50cf\u7b80\u5386\u8fd9\u6837\u81ea\u5305\u542b\u6587\u6863\u7684\u6570\u636e\u7ed3\u6784\u800c\u8a00\uff0cJSON \u8868\u793a\u662f\u975e\u5e38\u5408\u9002\u7684\uff0c\u5982 MongoDB\u3002</p> <ul> <li>\u6bd4\u591a\u8868\u6a21\u5f0f\u5177\u5907\u66f4\u597d\u7684\u5c40\u90e8\u6027\uff0c\u67e5\u8be2\u6574\u4e2a\u7b80\u5386\u65f6\uff0c\u5176\u901f\u5ea6\u8981\u5feb\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#_4","title":"\u591a\u5bf9\u4e00\u548c\u591a\u5bf9\u591a\u7684\u5173\u7cfb","text":"<p>\u5b58\u50a8 ID \u8fd8\u662f\u6587\u672c\u5b57\u7b26\u4e32\uff0c\u8fd9\u662f\u4e2a \u526f\u672c\uff08duplication\uff09 \u95ee\u9898\u3002</p> <ul> <li>\u5f53\u4f7f\u7528 ID \u65f6\uff0c\u5bf9\u4eba\u7c7b\u6709\u610f\u4e49\u7684\u4fe1\u606f\uff08\u6bd4\u5982\u5355\u8bcd\uff1aPhilanthropy\uff09\u53ea\u5b58\u50a8\u5728\u4e00\u5904\uff0c\u6240\u6709\u5f15\u7528\u5b83\u7684\u5730\u65b9\u4f7f\u7528 ID\uff08ID \u53ea\u5728\u6570\u636e\u5e93\u4e2d\u6709\u610f\u4e49\uff09</li> <li>\u5f53\u76f4\u63a5\u5b58\u50a8\u6587\u672c\u65f6\uff0c\u5bf9\u4eba\u7c7b\u6709\u610f\u4e49\u7684\u4fe1\u606f\u4f1a\u590d\u5236\u5728\u6bcf\u5904\u4f7f\u7528\u8bb0\u5f55\u4e2d\u3002</li> </ul> <p>\u4f7f\u7528 ID \u7684\u597d\u5904\uff1a</p> <ul> <li>ID \u53ef\u4ee5\u4fdd\u6301\u4e0d\u53d8\uff0c\u5373\u4f7f\u5b83\u6807\u8bc6\u7684\u4fe1\u606f\u53d1\u751f\u53d8\u5316\uff0c\u4f46\u4efb\u4f55\u5bf9\u4eba\u7c7b\u6709\u610f\u4e49\u7684\u4e1c\u897f\u90fd\u53ef\u80fd\u9700\u8981\u5728\u5c06\u6765\u67d0\u4e2a\u65f6\u5019\u6539\u53d8\uff1b</li> <li>\u5982\u679c\u8fd9\u4e9b\u4fe1\u606f\u88ab\u590d\u5236\uff0c\u6240\u6709\u7684\u5197\u4f59\u526f\u672c\u90fd\u9700\u8981\u66f4\u65b0\u3002\u8fd9\u4f1a\u5bfc\u81f4\u5199\u5165\u5f00\u9500\uff0c\u4e5f\u5b58\u5728\u4e0d\u4e00\u81f4\u7684\u98ce\u9669</li> <li>\u53bb\u9664\u6b64\u7c7b\u91cd\u590d\u662f\u6570\u636e\u5e93 \u89c4\u8303\u5316\uff08normalization\uff09 \u7684\u5173\u952e\u601d\u60f3</li> </ul> <p>\u6587\u6863\u6a21\u578b\u4e0d\u592a\u9002\u5408\u591a\u5bf9\u4e00\uff08\u591a\u5bf9\u591a\uff09\u7684\u5173\u7cfb\uff0c\u5982\u8bb8\u591a\u4eba\u751f\u6d3b\u5728\u4e00\u4e2a\u7279\u5b9a\u7684\u5730\u533a\uff0c\u8bb8\u591a\u4eba\u5728\u4e00\u4e2a\u7279\u5b9a\u7684\u884c\u4e1a\u5de5\u4f5c</p> <ul> <li>\u5bf9\u8fde\u63a5\u7684\u652f\u6301\u901a\u5e38\u5f88\u5f31\uff0c\u5982\u679c\u6587\u6863\u6570\u636e\u5e93\u4e0d\u652f\u6301\u8fde\u63a5\uff0c\u5219\u53ea\u80fd\u5728\u5e94\u7528\u5c42\u8fdb\u884c\u8fde\u63a5\uff1b</li> </ul> <p>\u5373\u4fbf\u5e94\u7528\u7a0b\u5e8f\u7684\u6700\u521d\u7248\u672c\u9002\u5408\u65e0\u8fde\u63a5\u7684\u6587\u6863\u6a21\u578b\uff0c\u968f\u7740\u529f\u80fd\u6dfb\u52a0\u5230\u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u6570\u636e\u4f1a\u53d8\u5f97\u66f4\u52a0\u4e92\u8054\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#_5","title":"\u6587\u6863\u6570\u636e\u5e93\u662f\u5426\u5728\u91cd\u8e48\u8986\u8f99\uff1f","text":"<p>\u6587\u6863\u6570\u636e\u5e93\u548c NoSQL \u91cd\u542f\u4e86\u8fa9\u8bba\uff1a\u5982\u4f55\u4ee5\u6700\u4f73\u65b9\u5f0f\u5728\u6570\u636e\u5e93\u4e2d\u8868\u793a\u591a\u5bf9\u591a\u5173\u7cfb</p> <ul> <li>\u8fc4\u4eca\u4e3a\u6b62\uff0c\u6587\u6863\u6570\u636e\u5e93\u6ca1\u6709\u8d70 \u7f51\u72b6\u6a21\u578b CODASYL \u7684\u8001\u8def\u3002</li> </ul> <p>\u5173\u7cfb\u6a21\u578b\uff08relational model\uff0c\u53d8\u6210\u4e86 SQL\u5e76\u7edf\u6cbb\u4e86\u4e16\u754c\uff09\u548c \u7f51\u72b6\u6a21\u578b\uff08network model\uff0c\u6700\u521d\u5f88\u53d7\u5173\u6ce8\uff0c\u4f46\u6700\u7ec8\u53d8\u5f97\u51b7\u95e8\uff09\u3002\u8fd9\u4e24\u4e2a\u9635\u8425\u4e4b\u95f4\u7684 \u201c\u5927\u8fa9\u8bba\u201d \u5728 70 \u5e74\u4ee3\u6301\u7eed\u4e86\u5f88\u4e45\u65f6\u95f4\\(^{[2]}\\)\u3002</p> <ul> <li>\u7f51\u72b6\u6a21\u578b\uff08CODASYL \u6a21\u578b\uff09\u662f\u5c42\u6b21\u6a21\u578b\u7684\u63a8\u5e7f\uff0c\u6bcf\u6761\u8bb0\u5f55\u53ef\u80fd\u6709\u591a\u4e2a\u7236\u8282\u70b9\uff1b</li> <li>\u5176\u8ddf\u56fe\u6a21\u578b\u6709\u672c\u8d28\u4e0a\u7684\u533a\u522b\uff0c\u89c1\u4e0b\u6587\u7684\u56fe\u6570\u636e\u5e93\uff1b</li> </ul> <p>\u5728\u8868\u793a\u591a\u5bf9\u4e00\u548c\u591a\u5bf9\u591a\u7684\u5173\u7cfb\u65f6\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u548c\u6587\u6863\u6570\u636e\u5e93\u5e76\u6ca1\u6709\u6839\u672c\u7684\u4e0d\u540c\uff1a\u5728\u8fd9\u4e24\u79cd\u60c5\u51b5\u4e0b\uff0c\u76f8\u5173\u9879\u76ee\u90fd\u88ab\u4e00\u4e2a\u552f\u4e00\u7684\u6807\u8bc6\u7b26\u5f15\u7528\uff0c\u8fd9\u4e2a\u6807\u8bc6\u7b26\u5728\u5173\u7cfb\u6a21\u578b\u4e2d\u88ab\u79f0\u4e3a \u5916\u952e\uff0c\u5728\u6587\u6863\u6a21\u578b\u4e2d\u79f0\u4e3a \u6587\u6863\u5f15\u7528\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#_6","title":"\u5173\u7cfb\u578b\u6570\u636e\u5e93\u548c\u6587\u6863\u6570\u636e\u5e93\u7684\u5bf9\u6bd4","text":"<p>\u672c\u7ae0\u5c06\u53ea\u5173\u6ce8\u6570\u636e\u6a21\u578b\u4e2d\u7684\u5dee\u5f02\u3002</p> <ul> <li>\u5bf9\u9ad8\u5ea6\u5173\u8054\u7684\u6570\u636e\u800c\u8a00\uff0c\u6587\u6863\u6a21\u578b\u662f\u6781\u5176\u7cdf\u7cd5\u7684\uff0c\u5173\u7cfb\u6a21\u578b\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\uff0c\u800c\u9009\u7528\u56fe\u5f62\u6a21\u578b\uff08\u8bf7\u53c2\u9605 \u201c\u56fe\u6570\u636e\u6a21\u578b\u201d\uff09\u662f\u6700\u81ea\u7136\u7684\u3002</li> </ul> <p>\u6587\u6863\u6a21\u578b\uff1a\u66f4\u9002\u7528\u4e8e</p> <ul> <li>\u5b58\u5728\u8bb8\u591a\u4e0d\u540c\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u5c06\u6bcf\u79cd\u7c7b\u578b\u7684\u5bf9\u8c61\u653e\u5728\u81ea\u5df1\u7684\u8868\u4e2d\u662f\u4e0d\u73b0\u5b9e\u7684\u3002</li> <li>\u6570\u636e\u7684\u7ed3\u6784\u7531\u5916\u90e8\u7cfb\u7edf\u51b3\u5b9a\u3002\u4f60\u65e0\u6cd5\u63a7\u5236\u5916\u90e8\u7cfb\u7edf\u4e14\u5b83\u968f\u65f6\u53ef\u80fd\u53d8\u5316\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#_7","title":"\u9002\u7528\u573a\u666f","text":"<p>\u6587\u6863\u6a21\u578b\uff08JSON\uff09\uff1a\u5982\u7b80\u5386\u7684\u5b58\u50a8\uff0c\u7c7b\u4f3c\u6587\u6863\u7684\u7ed3\u6784\uff0c\u6216\u4f55\u65f6\u4f55\u5730\u53d1\u751f\u4f55\u4e8b\u7684\u65f6\u5e8f\u6570\u636e\\(^{[10]}\\)</p> <ul> <li>\u9002\u5408\u4e00\u5bf9\u4e00\u3001\u4e00\u5bf9\u591a\u7684\u5173\u7cfb\uff1b</li> <li>\u4e0d\u9002\u5408\u591a\u5bf9\u4e00\u3001\u591a\u5bf9\u591a\u7684\u5173\u7cfb\uff0c\u8054\u7ed3\u7684\u652f\u6301\u5f88\u5f31\\(^{[4]}\\)\uff1b</li> <li>\u8bfb\u65f6\u6a21\u5f0f\uff1a\u8bb0\u5f55\u5e76\u4e0d\u662f\u90fd\u662f\u540c\u6837\u7684\u6570\u636e\u7ed3\u6784\uff08\u52a8\u6001\uff0c\u4e0d\u53ef\u9884\u4f30\uff09\uff1b</li> <li>\u5c40\u90e8\u6027\u66f4\u597d\uff1a\u5bf9\u4e8e\u5e94\u7528\u7a0b\u5e8f\u9891\u7e41\u8bbf\u95ee\u6574\u4e2a\u6587\u6863\u7684\u60c5\u5f62\uff1b</li> <li>\u901a\u5e38\u5efa\u8bae\u6587\u6863\u5e94\u8be5\u5c3d\u91cf\u5c0f\u4e14\u907f\u514d\u5199\u5165\u65f6\u589e\u52a0\u6587\u6863\u5927\u5c0f\\(^{[9]}\\)\uff1b</li> </ul> <p>\u5728\u8868\u793a\u591a\u5bf9\u4e00\u548c\u591a\u5bf9\u591a\u7684\u5173\u7cfb\u65f6\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u548c\u6587\u6863\u6570\u636e\u5e93\u6ca1\u6709\u6839\u672c\u4e0d\u540c\uff0c\u7531\u552f\u4e00\u7684\u6807\u8bc6\u7b26\u5f15\u7528\uff1a</p> <ul> <li>\u5173\u7cfb\u6a21\u578b\u4e2d\u79f0\u4e3a\u5916\u952e\uff0c\u6587\u6863\u6a21\u578b\u4e2d\u79f0\u4e3a\u6587\u6863\u5f15\u7528\uff1b</li> <li>\u6587\u6863\u6a21\u578b\u5f3a\u5728\u6a21\u5f0f\u7075\u6d3b\u6027\uff08\u8bfb\u6a21\u5f0f\uff09\uff0c\u5c40\u90e8\u6027\u5e26\u6765\u8f83\u597d\u6027\u80fd\uff0c\u6ce8\u91cd\u6574\u4f53\uff0c\u66f4\u63a5\u8fd1\u5e94\u7528\u7684\u6570\u636e\u7ed3\u6784\uff1b</li> <li>\u5173\u7cfb\u6a21\u578b\uff08\u5199\u6a21\u5f0f\uff09\u5f3a\u5728\u8fde\u63a5\u64cd\u4f5c\u3001\u591a\u5bf9\u4e00\u548c\u591a\u5bf9\u591a\u5173\u7cfb\u66f4\u7b80\u6d01\u7684\u8868\u8fbe\u4e0a\uff0c\u6ce8\u91cd\u90e8\u5206\uff08\u5206\u89e3\uff09\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#_8","title":"\u6a21\u5f0f\u7075\u6d3b\u6027","text":"<p>\u8bfb\u65f6\u6a21\u5f0f\uff08schema-on-read\uff09\u548c\u5199\u65f6\u6a21\u5f0f\uff08schema-on-write\uff09\\(^{[5]}\\)\uff1a</p> <ul> <li>\"\u5199\u65f6\u6a21\u5f0f\"\uff1a\u6570\u636e\u5728\u5199\u5165\u6570\u636e\u5e93\u65f6\u5bf9\u7167\u8868\u6a21\u5f0f\u8fdb\u884c\u68c0\u67e5\uff1b</li> <li>\"\u8bfb\u65f6\u6a21\u5f0f\"\uff1a\u5728\u9700\u8981\u67e5\u8be2\u5206\u6790\u7684\u65f6\u5019\u518d\u4e3a\u6570\u636e\u8bbe\u7f6eschema\u8fdb\u884c\u9a8c\u8bc1\uff08\u5931\u8d25\u8bbe\u7f6e\u4e3aNULL\uff09\uff0c\u5e95\u5c42\u5b58\u50a8\u4e0d\u4f1a\u5728\u6570\u636e\u52a0\u8f7d\u65f6\u8fdb\u884c\u9a8c\u8bc1</li> </ul> <p>\u6539\u53d8\u5176\u6570\u636e\u683c\u5f0f\u65f6\uff1a\u5982\u5c06\u7528\u6237\u540d\u6539\u4e3a\u59d3\u6c0f\u548c\u540d\u79f0\uff1a</p> <ul> <li>\u6587\u6863\u6570\u636e\u5e93\uff08\u8bfb\u6a21\u5f0f\uff09\uff1a\u53ea\u9700\u5f00\u59cb\u5199\u5165\u5177\u6709\u65b0\u5b57\u6bb5\u7684\u65b0\u6587\u6863\uff0c\u5e76\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u4ee3\u7801\u6765\u5904\u7406\u8bfb\u53d6\u65e7\u6587\u6863\u7684\u60c5\u51b5\uff1b</li> </ul> <pre><code>if (user &amp;&amp; user.name &amp;&amp; !user.first_name) {\n  // Documents written before Dec 8, 2013 don't have first_name\n  user.first_name = user.name.split(\" \")[0];\n}\n</code></pre> <ul> <li> <p>\u6570\u636e\u5e93\uff08\u5199\u6a21\u5f0f\uff09\uff1a\u901a\u5e38\u4f1a\u6267\u884c\u4ee5\u4e0b \u8fc1\u79fb\uff08migration\uff09 \u64cd\u4f5c</p> </li> <li> <p>MYSQL \u8fdb\u884c ALTER TABLE\u65f6\u4f1a\u628a\u73b0\u5728\u7684\u6574\u5f20\u8868\u8fdb\u884c\u590d\u5236\uff0c\u4f46\u6709\u5de5\u5177\u53ef\u4ee5\u89e3\u51b3\\(^{[6-8]}\\)</p> </li> <li>\u4e5f\u53ef\u4ee5\u5c06 <code>first_name</code> \u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c <code>NULL</code>\uff0c\u5e76\u5728\u8bfb\u53d6\u65f6\u518d\u586b\u5145\uff0c\u5c31\u50cf\u4f7f\u7528\u6587\u6863\u6570\u636e\u5e93\u4e00\u6837</li> </ul> <pre><code>ALTER TABLE users ADD COLUMN first_name text;\nUPDATE users SET first_name = split_part(name, ' ', 1);      -- PostgreSQL\nUPDATE users SET first_name = substring_index(name, ' ', 1);      -- MySQL\n</code></pre>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#_9","title":"\u67e5\u8be2\u7684\u6570\u636e\u5c40\u90e8\u6027","text":"<p>\u5728 \u7b2c\u4e09\u7ae0 \u5c06\u8fd8\u4f1a\u770b\u5230\u66f4\u591a\u5173\u4e8e\u5c40\u90e8\u6027\u7684\u5185\u5bb9\u3002</p> <p>\u6587\u6863\u901a\u5e38\u4ee5\u5355\u4e2a\u8fde\u7eed\u5b57\u7b26\u4e32\u5f62\u5f0f\u8fdb\u884c\u5b58\u50a8\uff1a</p> <ul> <li>\u8bbf\u95ee\u6574\u4e2a\u6587\u6863\uff08\u4f8b\u5982\uff0c\u5c06\u5176\u6e32\u67d3\u81f3\u7f51\u9875\uff09\uff0c\u5b58\u50a8\u5c40\u90e8\u6027\u4f1a\u5e26\u6765\u6027\u80fd\u4f18\u52bf\uff1b</li> <li>\u53ea\u8bbf\u95ee\u6587\u6863\u5176\u4e2d\u7684\u4e00\u5c0f\u90e8\u5206\uff0c\u6570\u636e\u5e93\u901a\u5e38\u9700\u8981\u52a0\u8f7d\u6574\u4e2a\u6587\u6863\uff0c\u5bf9\u4e8e\u5927\u578b\u6587\u6863\u6765\u8bf4\u8fd9\u79cd\u52a0\u8f7d\u884c\u4e3a\u5f88\u6d6a\u8d39\uff1b</li> <li>\u66f4\u65b0\u6587\u6863\u65f6\uff0c\u901a\u5e38\u9700\u8981\u6574\u4e2a\u91cd\u5199\uff0c\u53ea\u6709\u4e0d\u6539\u53d8\u6587\u6863\u5927\u5c0f\u7684\u4fee\u6539\u624d\u53ef\u4ee5\u5bb9\u6613\u5730\u539f\u5730\u6267\u884c\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#_10","title":"\u6587\u6863\u548c\u5173\u7cfb\u6570\u636e\u5e93\u7684\u878d\u5408","text":"<p>\u5173\u7cfb\u6a21\u578b\u548c\u6587\u6863\u6a21\u578b\u7684\u6df7\u5408\u662f\u672a\u6765\u6570\u636e\u5e93\u4e00\u6761\u5f88\u597d\u7684\u8def\u7ebf\u3002</p> <p>\u6570\u636e\u5e93\u652f\u6301 JSON \u6587\u6863\uff1a</p> <ul> <li>9.3 \u7248\u672c\u5f00\u59cb\u7684 PostgreSQL \\(^{[11]}\\)\uff0c\u4ece 5.7 \u7248\u672c\u5f00\u59cb\u7684 MySQL \u4ee5\u53ca\u4ece\u7248\u672c 10.5 \u5f00\u59cb\u7684 IBM DB2\\(^{[12]}\\)\u4e5f\u5bf9 JSON \u6587\u6863\u63d0\u4f9b\u4e86\u7c7b\u4f3c\u7684\u652f\u6301\u7ea7\u522b\u3002</li> </ul> <p>\u6587\u6863\u6570\u636e\u5e93\u652f\u6301\u8054\u7ed3\uff1a</p> <ul> <li>\u4e00\u4e9b MongoDB \u9a71\u52a8\u7a0b\u5e8f\u53ef\u4ee5\u81ea\u52a8\u89e3\u6790\u6570\u636e\u5e93\u5f15\u7528\uff08\u6709\u6548\u5730\u6267\u884c\u5ba2\u6237\u7aef\u8fde\u63a5\uff0c\u53ef\u80fd\u6bd4\u5728\u6570\u636e\u5e93\u4e2d\u6267\u884c\u7684\u8fde\u63a5\u6162\uff0c\u9700\u8981\u989d\u5916\u7684\u7f51\u7edc\u5f80\u8fd4\uff0c\u5e76\u4e14\u4f18\u5316\u66f4\u5c11\uff09\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#_11","title":"\u6570\u636e\u67e5\u8be2\u8bed\u8a00","text":"<p>\u547d\u4ee4\u5f0f</p> <ul> <li>\u4ee5\u7279\u5b9a\u987a\u5e8f\u6267\u884c\u67d0\u4e9b\u64cd\u4f5c\uff1b</li> </ul> <p>\u58f0\u660e\u5f0f\uff1aSQL \u662f\u58f0\u660e\u5f0f\uff0cWeb \u5f00\u53d1 Vue / CSS \u4e5f\u662f\u58f0\u660e\u5f0f\uff08JavaScript \u7684 DOM API \u5219\u662f\u547d\u4ee4\u5f0f\uff09</p> <ul> <li>\u6307\u5b9a\u6240\u9700\u6570\u636e\u6a21\u5f0f\uff0c\u7ed3\u679c\u6ee1\u8db3\u7684\u6761\u4ef6\u4ee5\u53ca\u5982\u4f55\u8f6c\u6362\u6570\u636e\uff0c\u4e0d\u9700\u8981\u6307\u660e\u5982\u4f55\u5b9e\u73b0\uff1b</li> <li>SQL \u76f8\u5f53\u6709\u9650\u7684\u529f\u80fd\u6027\u4e3a\u6570\u636e\u5e93\u63d0\u4f9b\u4e86\u66f4\u591a\u81ea\u52a8\u4f18\u5316\u7684\u7a7a\u95f4\uff0c\u4e14\u5bf9\u7528\u6237\u4e0d\u611f\u77e5\uff1b</li> <li>\u901a\u5e38\u9002\u7528\u4e8e\u5e76\u884c\u6267\u884c\\(^{[13]}\\)\uff1b</li> </ul> <p>Map-Reduce\uff1a\u65e2\u4e0d\u662f\u4e00\u4e2a\u58f0\u660e\u5f0f\u7684\u67e5\u8be2\u8bed\u8a00\uff0c\u4e5f\u4e0d\u662f\u4e00\u4e2a\u5b8c\u5168\u547d\u4ee4\u5f0f\u7684\u67e5\u8be2 API\uff0c\u800c\u662f\u5904\u4e8e\u4e24\u8005\u4e4b\u95f4</p> <ul> <li>\u67e5\u8be2\u7684\u903b\u8f91\u7528\u4ee3\u7801\u7247\u6bb5\uff08\u53ef\u590d\u7528\uff09\u6765\u8868\u793a</li> <li>\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u601d\u60f3\uff0c\u90e8\u5206\u5c01\u88c5\uff08\u7528\u6237\u4e0d\u9700\u5b9a\u4e49\u6570\u636e\u96c6\u7684\u904d\u5386\u65b9\u5f0f\u3001Shuffle\u8fc7\u7a0b\uff0c\u4f46\u9700\u8981\u5b9a\u4e49\u5355\u6761\u6570\u636e\u5904\u7406\u8fc7\u7a0b\uff09\uff1b</li> <li>\u7eaf\u51fd\u6570\uff0c\u4e0d\u80fd\u5e26\u6709\u526f\u4f5c\u7528\uff0c\u53ea\u80fd\u4f7f\u7528\u4f20\u9012\u7684\u6570\u636e\u4f5c\u4e3a\u8f93\u5165\uff08\u5e42\u7b49\uff09\uff1b</li> <li>SQL \u53ef\u4ee5\u7528 map-reduce \u7b49\u5206\u5e03\u5f0f\u7f16\u7a0b\u6a21\u578b\u5b9e\u73b0</li> </ul> <p>\u793a\u4f8b\uff1a\u6bcf\u6708\u770b\u5230\u591a\u5c11\u9ca8\u9c7c</p> <ul> <li>PostgreSQL </li> </ul> <pre><code>SELECT\n  date_trunc('month', observation_timestamp) AS observation_month,\n  sum(num_animals)                           AS total_animals\nFROM observations\nWHERE family = 'Sharks'\nGROUP BY observation_month;\n</code></pre> <ul> <li>MongoDB \u7684 MapReduce </li> </ul> <pre><code>db.observations.mapReduce(function map() {\n        var year = this.observationTimestamp.getFullYear();\n        var month = this.observationTimestamp.getMonth() + 1;\n        emit(year + \"-\" + month, this.numAnimals);\n    },\n    function reduce(key, values) {\n        return Array.sum(values);\n    },\n    {\n        query: {\n          family: \"Sharks\"\n        },\n        out: \"monthlySharkReport\"\n    });\n</code></pre> <ul> <li>MongoDB \u7684\u805a\u5408\u7ba1\u9053\uff08\u58f0\u660e\u5f0f\uff09\uff1aNoSQL \u7cfb\u7edf\u53ef\u80fd\u4f1a\u610f\u5916\u53d1\u73b0\u81ea\u5df1\u53ea\u662f\u91cd\u65b0\u53d1\u660e\u4e86\u4e00\u5957\u7ecf\u8fc7\u4e54\u88c5\u6539\u626e\u7684 SQL</li> </ul> <pre><code>db.observations.aggregate([\n  { $match: { family: \"Sharks\" } },\n  { $group: {\n    _id: {\n      year:  { $year:  \"$observationTimestamp\" },\n      month: { $month: \"$observationTimestamp\" }\n    },\n    totalAnimals: { $sum: \"$numAnimals\" } }}\n]);\n</code></pre>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#_12","title":"\u56fe\u72b6\u6570\u636e\u6a21\u578b","text":"<p>\u9002\u7528\u4e8e\u9ad8\u5ea6\u5173\u8054\u7684\u6570\u636e\uff0c\u5982\u793e\u4ea4\u7f51\u7edc\u3001Web\u56fe\u3001\u516c\u8def/\u94c1\u8def\u7f51\uff1b</p> <p>\u56fe\u6570\u636e\u6a21\u578b\u7684\u57fa\u672c\u6982\u5ff5\u4e00\u822c\u6709\u4e09\u4e2a\uff1a\u70b9\uff0c\u8fb9\u548c\u9644\u7740\u4e8e\u4e24\u8005\u4e4b\u4e0a\u7684\u5c5e\u6027\u3002</p> <p>\u5e38\u89c1\u7684\u53ef\u4ee5\u7528\u56fe\u5efa\u6a21\u7684\u573a\u666f\uff1a</p> \u4f8b\u5b50 \u5efa\u6a21 \u5e94\u7528 \u793e\u4ea4\u56fe\u8c31 \u4eba\u662f\u70b9\uff0cfollow \u5173\u7cfb\u662f\u8fb9 \u516d\u5ea6\u5206\u9694\uff0c\u4fe1\u606f\u6d41\u63a8\u8350 \u4e92\u8054\u7f51 \u7f51\u9875\u662f\u70b9\uff0c\u94fe\u63a5\u5173\u7cfb\u662f\u8fb9 PageRank \u8def\u7f51 \u4ea4\u901a\u67a2\u7ebd\u662f\u70b9\uff0c\u94c1\u8def/\u516c\u8def\u662f\u8fb9 \u8def\u5f84\u89c4\u5212\uff0c\u5bfc\u822a\u6700\u77ed\u8def\u5f84 \u6d17\u94b1 \u8d26\u6237\u662f\u70b9\uff0c\u8f6c\u8d26\u5173\u7cfb\u662f\u8fb9 \u5224\u65ad\u662f\u5426\u6709\u73af \u77e5\u8bc6\u56fe\u8c31 \u6982\u5ff5\u65f6\u70b9\uff0c\u5173\u8054\u5173\u7cfb\u662f\u8fb9 \u542f\u53d1\u5f0f\u95ee\u7b54 <p>\u793a\u4f8b\u56fe 2-5\uff1a</p> <p></p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#property-graph","title":"\u56fe\u6a21\u578b\uff08property graph\uff09","text":"<p>Neo4j\u3001Titan\u3001InfiniteGraph</p> <p>\u6570\u636e\u7ed3\u6784</p> \u70b9 (vertices, nodes, entities) \u8fb9 (edges, relations, arcs) \u5168\u5c40\u552f\u4e00 ID \u5168\u5c40\u552f\u4e00 ID \u51fa\u8fb9\u96c6\u5408 \u8d77\u59cb\u70b9 \u5165\u8fb9\u96c6\u5408 \u7ec8\u6b62\u70b9 \u5c5e\u6027\u96c6\uff08kv \u5bf9\u8868\u793a\uff09 \u5c5e\u6027\u96c6\uff08kv \u5bf9\u8868\u793a\uff09 \u8868\u793a\u70b9\u7c7b\u578b\u7684 type\uff1f\uff08\u5f02\u6784\u56fe\uff09 \u8868\u793a\u8fb9\u7c7b\u578b\u7684 label <p>\u56fe\u662f\u4e00\u79cd\u5f88\u7075\u6d3b\u7684\u5efa\u6a21\u65b9\u5f0f\uff1a</p> <ol> <li>\u4efb\u4f55\u4e24\u70b9\u95f4\u90fd\u53ef\u4ee5\u63d2\u5165\u8fb9\uff0c\u6ca1\u6709\u4efb\u4f55\u6a21\u5f0f\u9650\u5236\u3002</li> <li>\u5bf9\u4e8e\u4efb\u4f55\u9876\u70b9\u90fd\u53ef\u4ee5\u9ad8\u6548\u627e\u5230\u5176\u5165\u8fb9\u548c\u51fa\u8fb9\uff0c\u4ece\u800c\u8fdb\u884c\u56fe\u904d\u5386\u3002</li> <li>\u4f7f\u7528\u591a\u79cd\u6807\u7b7e\u6765\u6807\u8bb0\u4e0d\u540c\u7c7b\u578b\u8fb9\uff08\u5173\u7cfb\uff09\u3002</li> </ol> <p>\u56fe\u6709\u5229\u4e8e\u6f14\u5316\uff1a\u5411\u5e94\u7528\u7a0b\u5e8f\u6dfb\u52a0\u529f\u80fd\u65f6\uff0c\u56fe\u53ef\u4ee5\u5bb9\u6613\u6269\u5c55\u4ee5\u9002\u5e94\u6570\u636e\u7ed3\u6784\u7684\u4e0d\u65ad\u53d8\u5316\u3002</p> <ul> <li>\u4eba\u5bf9\u98df\u7269\u8fc7\u654f\uff0c\u53ef\u4ee5\u65b0\u589e\u8fc7\u654f\u6e90\u9876\u70b9\uff0c\u4eba\u548c\u8fc7\u654f\u6e90\u7684\u8fb9\u8868\u793a\u8fc7\u654f\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#cypher","title":"Cypher \u67e5\u8be2\u8bed\u8a00","text":"<p>Cypher \u662f Neo4j \u521b\u9020\u7684\u4e00\u79cd\u67e5\u8be2\u8bed\u8a00\u3002</p> <p>\u56fe2-5\u5de6\u8fb9\u90e8\u5206\u7684\u63d2\u5165\u8bed\u53e5\uff1a</p> <pre><code>CREATE\n  (NAmerica:Location {name:'North America', type:'continent'}),\n  (USA:Location      {name:'United States', type:'country'  }),\n  (Idaho:Location    {name:'Idaho',         type:'state'    }),\n  (Lucy:Person       {name:'Lucy' }),\n  (Idaho) -[:WITHIN]-&gt;  (USA)  -[:WITHIN]-&gt; (NAmerica),\n  (Lucy)  -[:BORN_IN]-&gt; (Idaho)\n</code></pre> <p>\u67e5\u8be2\uff1a\u627e\u51fa\u6240\u6709\u4ece\u7f8e\u56fd\u79fb\u5c45\u5230\u6b27\u6d32\u7684\u4eba\u540d\u3002</p> <pre><code>MATCH\n  (person) -[:BORN_IN]-&gt;  () -[:WITHIN*0..]-&gt; (us:Location {name:'United States'}),\n  (person) -[:LIVES_IN]-&gt; () -[:WITHIN*0..]-&gt; (eu:Location {name:'Europe'})\nRETURN person.name\n</code></pre> <p>\u5982\u679c\u7528SQL\u8fdb\u884c\u67e5\u8be2\uff0c\u5219\u9700\u8981\u901a\u8fc7\u9012\u5f52\u516c\u7528\u8868\u8fbe\u5f0f\uff08<code>WITH RECURSIVE</code>\uff09\uff09\u8868\u793a <code>:WITHIN*0..</code>\u3002</p> <ul> <li> <p>\u8fde\u63a5\u7684\u6570\u91cf\u4e8b\u5148\u5e76\u4e0d\u786e\u5b9a</p> </li> <li> <p>\u793a\u4f8b\uff1a\u627e\u51fa\u6240\u6709\u4ece\u7f8e\u56fd\u79fb\u5c45\u5230\u6b27\u6d32\u7684\u4eba\u540d\uff08\u56fe\u67e5\u8be2 4\u884c\uff0cSQL \u67e5\u8be2 29 \u884c\uff09</p> </li> </ul> <pre><code>WITH RECURSIVE\n  -- in_usa \u5305\u542b\u6240\u6709\u7684\u7f8e\u56fd\u5883\u5185\u7684\u4f4d\u7f6e ID\n    in_usa(vertex_id) AS (\n    SELECT vertex_id FROM vertices WHERE properties -&gt;&gt; 'name' = 'United States'\n    UNION\n    SELECT edges.tail_vertex FROM edges\n      JOIN in_usa ON edges.head_vertex = in_usa.vertex_id\n      WHERE edges.label = 'within'\n  ),\n  -- in_europe \u5305\u542b\u6240\u6709\u7684\u6b27\u6d32\u5883\u5185\u7684\u4f4d\u7f6e ID\n    in_europe(vertex_id) AS (\n    SELECT vertex_id FROM vertices WHERE properties -&gt;&gt; 'name' = 'Europe'\n    UNION\n    SELECT edges.tail_vertex FROM edges\n      JOIN in_europe ON edges.head_vertex = in_europe.vertex_id\n      WHERE edges.label = 'within' ),\n\n  -- born_in_usa \u5305\u542b\u4e86\u6240\u6709\u7c7b\u578b\u4e3a Person\uff0c\u4e14\u51fa\u751f\u5728\u7f8e\u56fd\u7684\u9876\u70b9\n    born_in_usa(vertex_id) AS (\n      SELECT edges.tail_vertex FROM edges\n        JOIN in_usa ON edges.head_vertex = in_usa.vertex_id\n        WHERE edges.label = 'born_in' ),\n\n  -- lives_in_europe \u5305\u542b\u4e86\u6240\u6709\u7c7b\u578b\u4e3a Person\uff0c\u4e14\u5c45\u4f4f\u5728\u6b27\u6d32\u7684\u9876\u70b9\u3002\n    lives_in_europe(vertex_id) AS (\n      SELECT edges.tail_vertex FROM edges\n        JOIN in_europe ON edges.head_vertex = in_europe.vertex_id\n        WHERE edges.label = 'lives_in')\n\n  SELECT vertices.properties -&gt;&gt; 'name'\n  FROM vertices\n    JOIN born_in_usa ON vertices.vertex_id = born_in_usa.vertex_id\n    JOIN lives_in_europe ON vertices.vertex_id = lives_in_europe.vertex_id;\n</code></pre>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#triple-store","title":"\u4e09\u5143\u5b58\u50a8\u6a21\u578b\uff08triple-store\uff09","text":"<p>Datomic\u3001AllegroGraph</p> <p>\uff08lucy, age, 33), (lucy, marriedTo, alain)</p> \u6982\u5ff5 \u5b9a\u4e49 Subject\uff08\u4e3b\u4f53\uff09 \u5bf9\u5e94\u56fe\u4e2d\u7684\u4e00\u4e2a\u70b9\uff08<code>_:someName</code>) Predicate\uff08\u8c13\u8bed\uff09 1. \u5982\u679c Object \u662f\u539f\u5b50\u6570\u636e\uff0c\u5219  \u5bf9\u5e94\u70b9\u9644\u5e26\u7684 KV \u5bf9\u30022. \u5982\u679c Object \u662f\u53e6\u4e00\u4e2a Object\uff0c\u5219 Predicate \u5bf9\u5e94\u56fe\u4e2d\u7684\u8fb9\u3002 Object\uff08\u5ba2\u4f53\uff09 1. \u4e00\u4e2a\u539f\u5b50\u6570\u636e\uff0c\u5982 string \u6216\u8005 number\u30022. \u53e6\u4e00\u4e2a Subject\u3002 <p>\u56fe2-5\u5de6\u8fb9\u90e8\u5206\u7684\u63d2\u5165\u8bed\u53e5\uff1aTurtle 3\u5143\u7ec4</p> <pre><code>@prefix : &lt;urn:example:&gt;.\n_:lucy     a: Person;   :name \"Lucy\";          :bornIn _:idaho\n_:idaho    a: Location; :name \"Idaho\";         :type \"state\";     :within _:usa.\n_:usa      a: Location; :name \"United States\"; :type \"country\";   :within _:namerica.\n_:namerica a :Location; :name \"North America\"; :type \"continent\".\n</code></pre>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#_13","title":"\u8bed\u4e49\u7f51","text":"<p>\u4e07\u7ef4\u7f51\u4e4b\u7236 Tim Berners Lee \u4e8e 1998 \u5e74\u63d0\u51fa\uff0c\u77e5\u8bc6\u56fe\u8c31\u524d\u8eab\u3002\u5176\u76ee\u7684\u5728\u4e8e\u5bf9\u7f51\u7edc\u4e2d\u7684\u8d44\u6e90\u8fdb\u884c\u7ed3\u6784\u5316\uff0c\u4ece\u800c\u8ba9\u8ba1\u7b97\u673a\u80fd\u591f\u7406\u89e3\u7f51\u7edc\u4e2d\u7684\u6570\u636e\u3002</p> <ul> <li>\u4e09\u5143\u7ec4\u5b58\u50a8\u6a21\u578b\u5176\u5b9e\u662f\u5b8c\u5168\u72ec\u7acb\u4e8e\u8bed\u4e49\u7f51\u5b58\u5728</li> </ul> <p>RDF\uff08Resource Description Framwork\uff09\uff0c\u8ba9\u4e0d\u540c\u7684\u7f51\u7ad9\u4ee5\u4e00\u81f4\u7684\u683c\u5f0f\u53d1\u5e03\u6570\u636e\uff0c\u4f9b\u8ba1\u7b97\u673a\u53ef\u8bfb\u3002</p> <ul> <li>\u81f3\u4eca\uff082021\u5e74\uff09\u6ca1\u6709\u5728\u5b9e\u8df5\u4e2d\u89c1\u5230\u4efb\u4f55\u9760\u8c31\u7684\u5b9e\u73b0\uff1b</li> <li>\u6280\u672f\u6808\u5f71\u54cd\u4e86\u540e\u6765\u7684\u77e5\u8bc6\u56fe\u8c31\u548c\u56fe\u67e5\u8be2\u8bed\u8a00\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#sparql","title":"SparQL \u67e5\u8be2\u8bed\u8a00","text":"<p>\u91c7\u7528 RDF \u6570\u636e\u6a21\u578b\u7684\u4e09\u5143\u5b58\u50a8\u67e5\u8be2\u8bed\u8a00\\(^{[14,15]}\\)\u3002</p> <p>\u67e5\u8be2\uff1a\u627e\u51fa\u6240\u6709\u4ece\u7f8e\u56fd\u79fb\u5c45\u5230\u6b27\u6d32\u7684\u4eba\u540d\u3002</p> <ul> <li>RDF \u4e0d\u533a\u5206\u5c5e\u6027\u548c\u8fb9\uff0c\u800c\u53ea\u662f\u5c06\u5b83\u4eec\u4f5c\u4e3a\u8c13\u8bed\uff0c\u6240\u4ee5\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u8bed\u6cd5\u6765\u5339\u914d\u5c5e\u6027</li> </ul> <pre><code>PREFIX : &lt;urn:example:&gt;\nSELECT ?personName WHERE {\n  ?person :name ?personName.\n  ?person :bornIn  / :within* / :name \"United States\".\n  ?person :livesIn / :within* / :name \"Europe\".\n}\n</code></pre>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#_14","title":"\u56fe\u6a21\u578b\u4e0e\u7f51\u7edc\u6a21\u578b","text":"<p>\u56fe\u6a21\u578b\u662f\u7f51\u7edc\u6a21\u578b\u65e7\u74f6\u88c5\u65b0\u9152\u5417\uff1f\u5426\uff0c\u4ed6\u4eec\u5728\u5f88\u591a\u91cd\u8981\u7684\u65b9\u9762\u90fd\u4e0d\u4e00\u6837\u3002</p> \u6a21\u578b \u56fe\u6a21\u578b\uff08Graph Model\uff09 \u7f51\u7edc\u6a21\u578b\uff08Network Model\uff09 \u8fde\u63a5\u65b9\u5f0f \u4efb\u610f\u4e24\u4e2a\u70b9\u4e4b\u95f4\u90fd\u6709\u53ef\u4ee5\u6709\u8fb9 \u6307\u5b9a\u5d4c\u5957\u7ea6\u675f\uff08\u54ea\u79cd\u8bb0\u5f55\u7c7b\u578b\u53ef\u4ee5\u5d4c\u5957\u5728\u5176\u4ed6\u8bb0\u5f55\u7c7b\u578b\uff09 \u8bb0\u5f55\u67e5\u627e 1. \u4f7f\u7528\u5168\u5c40 ID 2. \u4f7f\u7528\u5c5e\u6027\u7d22\u5f153. \u4f7f\u7528\u56fe\u904d\u5386 \u53ea\u80fd\u4f7f\u7528\u8def\u5f84\u67e5\u8be2 \u6709\u5e8f\u6027 \u70b9\u548c\u8fb9\u90fd\u662f\u65e0\u5e8f\u7684 \u8bb0\u5f55\u7684\u5b50\u8282\u70b9\u662f\u6709\u5e8f\u96c6\u5408\uff0c\u5728\u63d2\u5165\u65f6\u9700\u8981\u8003\u8651\u7ef4\u6301\u6709\u5e8f\u7684\u5f00\u9500 \u67e5\u8be2\u8bed\u8a00 \u5373\u53ef\u547d\u4ee4\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u58f0\u660e\u5f0f \u547d\u4ee4\u5f0f\u7684","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/2_data_model_query_language.html#_15","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>Edgar F. Codd: \u201cA Relational Model of Data for Large Shared Data Banks,\u201d Communications of the ACM, volume 13, number 6, pages 377\u2013387, June 1970. doi:10.1145/362384.362685</li> <li>Michael Stonebraker and Joseph M. Hellerstein: \u201cWhat Goes Around Comes Around,\u201d in Readings in Database Systems, 4th edition, MIT Press, pages 2\u201341, 2005. ISBN: 978-0-262-69314-1</li> <li>Eric Evans: \u201cNoSQL: What's in a Name?,\u201d blog.sym-link.com, October 30, 2009.</li> <li>Sarah Mei: \u201cWhy You Should Never Use MongoDB,\u201d sarahmei.com, November 11, 2013.</li> <li>Martin Odersky: \u201cThe Trouble with Types,\u201d at Strange Loop, September 2013.</li> <li>\u201cPercona Toolkit Documentation: pt-online-schema-change,\u201d Percona Ireland Ltd., 2013.</li> <li>Rany Keddo, Tobias Bielohlawek, and Tobias Schmidt: \u201cLarge Hadron Migrator,\u201d SoundCloud, 2013.</li> <li>Shlomi Noach: \u201cgh-ost: GitHub's Online Schema Migration Tool for MySQL,\u201d githubengineering.com, August 1, 2016.</li> <li>\u201cThe MongoDB 2.4 Manual,\u201d MongoDB, Inc., 2013.</li> <li>Sandeep Parikh and Kelly Stirman: \u201cSchema Design for Time Series Data in MongoDB,\u201d blog.mongodb.org, October 30, 2013.</li> <li>\u201cPostgreSQL 9.3.1 Documentation,\u201d The PostgreSQL Global Development Group, 2013.</li> <li>Bobbie J. Cochrane and Kathy A. McKnight: \u201cDB2 JSON Capabilities, Part 1: Introduction to DB2 JSON,\u201d IBM developerWorks, June 20, 2013.</li> <li>Joseph M. Hellerstein: \u201cThe Declarative Imperative: Experiences and Conjectures in Distributed Logic,\u201d Electrical Engineering and Computer Sciences, University of California at Berkeley, Tech report UCB/EECS-2010-90, June 2010.</li> <li>\u201cApache Jena,\u201d Apache Software Foundation.</li> <li>Steve Harris, Andy Seaborne, and Eric Prud'hommeaux: \u201cSPARQL 1.1 Query Language,\u201d W3C Recommendation, March 2013.</li> <li>Dennis A. Benson, Ilene Karsch-Mizrachi, David J. Lipman, et al.: \u201cGenBank,\u201d Nucleic Acids Research, volume 36, Database issue, pages D25\u2013D30, December 2007. doi:10.1093/nar/gkm929</li> </ol>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html","title":"\u6570\u636e\u5b58\u50a8\u4e0e\u68c0\u7d22","text":"<p>\u5b58\u50a8\u5f15\u64ce\u5206\u4e3a\u4e24\u5927\u7c7b\uff1a\u9488\u5bf9 \u4e8b\u52a1\u5904\u7406\uff08OLTP\uff09 \u4f18\u5316\u7684\u5b58\u50a8\u5f15\u64ce\u548c\u9488\u5bf9 \u5728\u7ebf\u5206\u6790\uff08OLAP\uff09 \u4f18\u5316\u7684\u5b58\u50a8\u5f15\u64ce</p> <p>\u5bf9\u4e8e OLTP \uff0c\u4e24\u6d3e\u4e3b\u6d41\u7684\u5b58\u50a8\u5f15\u64ce</p> <ul> <li>\u65e5\u5fd7\u7ed3\u6784\u7684\u5b58\u50a8\u5f15\u64ce\uff1a\u53ea\u5141\u8bb8\u8ffd\u52a0\u5230\u6587\u4ef6\u548c\u5220\u9664\u8fc7\u65f6\u7684\u6587\u4ef6\uff0c\u4f46\u4e0d\u4f1a\u66f4\u65b0\u5df2\u7ecf\u5199\u5165\u7684\u6587\u4ef6\uff0c\u5982 LSM \u6811\u3001SSTables\uff1b</li> <li>\u539f\u5730\u66f4\u65b0\u5b66\u6d3e\uff1a\u9762\u5411\u9875\u7684\u5b58\u50a8\u5f15\u64ce\uff0c\u786c\u76d8\u89c6\u4e3a\u4e00\u7ec4\u53ef\u4ee5\u8986\u5199\u7684\u56fa\u5b9a\u5927\u5c0f\u7684\u9875\u9762\uff0c\u5982 B-tree\uff1b</li> </ul> <p>\u5bf9\u4e8e OLAP\uff1a\u4e3b\u8981\u7684\u662f\u5217\u793a\u5b58\u50a8\u3001\u538b\u7f29\uff0c\u52a0\u901f\u67e5\u8be2\uff1b</p> <ul> <li>\u5927\u91cf\u884c\u4e2d\u987a\u5e8f\u626b\u63cf\u65f6\uff0c\u7d22\u5f15\u7684\u91cd\u8981\u6027\u5c31\u4f1a\u964d\u4f4e\u5f88\u591a\uff0c\u4ee5\u6700\u5927\u9650\u5ea6\u5730\u51cf\u5c11\u67e5\u8be2\u9700\u8981\u4ece\u786c\u76d8\u8bfb\u53d6\u7684\u6570\u636e\u91cf\u3002</li> </ul> <p>\u4f5c\u4e3a\u5e94\u7528\u7cfb\u7edf\u5f00\u53d1\u4eba\u5458\uff0c\u4e3a\u4ec0\u4e48\u9700\u8981\u5173\u6ce8\u6570\u636e\u5e93\u5185\u90e8\u7684\u5b58\u50a8\u548c\u68c0\u7d22\u5462\uff1f</p> <ul> <li>\u4e0d\u4f1a\u4ece\u5934\u5b9e\u73b0\u5b58\u50a8\u5f15\u64ce\uff0c\u800c\u662f\u4ece\u73b0\u6709\u7684\u5b58\u50a8\u5f15\u64ce\u4e2d\u9009\u62e9\uff1b</li> <li>\u4e3a\u4e86\u7279\u5b9a\u7684\u5de5\u4f5c\u8d1f\u8f7d\u800c\u5bf9\u6570\u636e\u5e93\u8c03\u4f18\u65f6\uff0c\u9700\u8981\u5bf9\u5b58\u50a8\u5f15\u64ce\u7684\u5e95\u5c42\u673a\u5236\u6709\u4e86\u89e3\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_2","title":"\u6570\u636e\u5e93\u6838\u5fc3\uff1a\u6570\u636e\u7ed3\u6784","text":"<p>\u6700\u7b80\u5355\u7684\u6570\u636e\u5e93\uff0c\u7531\u4e24\u4e2a Bash \u51fd\u6570\u5b9e\u73b0\uff1a</p> <ul> <li>\u7531\u7eaf\u6587\u672c\u683c\u5f0f\u8fdb\u884c\u5b58\u50a8\uff0ckey \u548c value \u7531 \u9017\u53f7 \u5206\u9694\uff1b</li> </ul> <pre><code># !/bin/bash\n# \u5c06\u6587\u4ef6\u5b58\u50a8\u4e3a db_func.sh\n\ndb_set() {\n    echo \"$1,$2\" &gt;&gt; database\n}\n\ndb_get() {\n    grep \"$1,\" database | sed \"s/^$1,//\" | tail -n 1\n}\n</code></pre> <p>\u4f7f\u7528\u793a\u4f8b\uff1a\u591a\u6b21\u8bbe\u7f6e\u540c\u6837\u7684key\uff0c\u65e7\u7248\u672c\u7684\u503c\u4e0d\u4f1a\u88ab\u8986\u76d6\uff0c\u83b7\u53d6\u65f6\u8fd4\u56de\u6700\u65b0\u7684\u503c</p> <pre><code>$ source db_func.sh\n$ db_set 123 '{\"name:\" : \"xliu\"}'\n$ db_set 456 '{\"name\": \"book\"}'\n$ db_get 123\n{\"name:\" : \"xliu\"}\n</code></pre> <p>\u65e5\u5fd7\uff1a\u4ec5\u652f\u6301\u8ffd\u52a0\u5f0f\u66f4\u65b0\u7684\u6570\u636e\u6587\u4ef6\uff0c\u53ef\u4ee5\u662f\u6587\u672c\u683c\u5f0f\u6216\u8005\u4e8c\u8fdb\u5236\u683c\u5f0f\u3002</p> <p>\u6027\u80fd\u5206\u6790\uff1a</p> <ul> <li><code>db_set</code>\u8ffd\u52a0\u5230\u6587\u4ef6\uff0c\u6027\u80fd\u5f88\u597d\uff08\u5f88\u96be\u8d85\u8fc7\u7b80\u5355\u7684\u8ffd\u52a0\u6587\u4ef6\u7684\u6027\u80fd\uff09\uff1b</li> <li><code>db_get</code>\u7684\u6027\u80fd\u8ddf\u8bb0\u5f55\u6570\u5448\u7ebf\u6027\u5173\u7cfb\uff0c\u590d\u6742\u5ea6<code>O(N)</code>\uff1b</li> </ul> <p>\u5982\u4f55\u9ad8\u6548\u67e5\u627e\u6570\u636e\u5e93\u4e2d\u7279\u5b9a\u952e\u7684\u503c\uff1f\u65b0\u7684\u6570\u636e\u7ed3\u6784\uff1a\u7d22\u5f15</p> <ul> <li>\u4fdd\u7559\u989d\u5916\u7684\u5143\u6570\u636e\uff0c\u4f5c\u4e3a\u8def\u6807\uff0c\u5b9a\u4f4d\u76ee\u6807\u6570\u636e\uff1b</li> <li>\u9002\u5f53\u7684\u7d22\u5f15\u53ef\u4ee5\u52a0\u901f\u8bfb\u53d6\u67e5\u8be2\uff0c\u4f46\u6bcf\u4e2a\u7d22\u5f15\u90fd\u4f1a\u51cf\u6162\u5199\u5165\u901f\u5ea6\uff1b</li> <li>\u5e94\u7528\u5f00\u53d1\u4eba\u5458\u6216\u8005DB\u7ba1\u7406\u5458\uff0c\u6839\u636e\u67e5\u8be2\u6a21\u5f0f\uff0c\u624b\u52a8\u5efa\u7acb\u7d22\u5f15\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_3","title":"\u54c8\u5e0c\u7d22\u5f15","text":"<p>\u9488\u5bf9 key- value \u7c7b\u578b\u7684\u7d22\u5f15\uff0c\u5355\u70b9\u67e5\u8be2\u3002</p> <p>\u901a\u8fc7 hashmap \uff0c\u5c06\u6bcf\u4e2a\u952e\u6620\u5c04\u5230\u6587\u4ef6\u4e2d\u7684\u7279\u5b9a\u7684\u5b57\u8282\u504f\u79fb\u91cf\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <ul> <li> <p>Bitcask \u7684\u6838\u5fc3\u505a\u6cd5\\(^{[1]}\\)\uff0c\u5176\u662f Riak \u4e2d\u9ed8\u8ba4\u7684\u5b58\u50a8\u5f15\u64ce\uff1b</p> </li> <li> <p>\u67e5\u627e\u53ea\u9700\u8981\u4e00\u6b21\u78c1\u76d8\u5bfb\u5740\uff0c\u53ef\u5c06\u6570\u636e\u52a0\u8f7d\u5230\u5185\u5b58\uff0c\u5982\u679c\u6570\u636e\u5728\u6587\u4ef6\u7cfb\u7edf\u7f13\u5b58\uff0c\u5219\u4e0d\u9700\u8981\u78c1\u76d8I/O\uff1b</p> </li> </ul> <p></p> <p>\u9002\u5408\u4e8e\u6bcf\u4e2a\u952e\u7684\u503c\u9891\u7e41\u66f4\u65b0\u7684\u573a\u666f\uff0c\u4f46 key \u7684\u6570\u91cf\u4e0d\u591a\uff0c\u5185\u5b58\u53ef\u4ee5\u653e\u4e0b\uff1b</p> <ul> <li>\u5982 key\u662f\u732b\u7684\u89c6\u9891URL\uff0cvalue \u662f\u5b83\u64ad\u653e\u6b21\u6570\uff08\u66f4\u65b0\u65f6\uff0c\u5148\u4ece\u78c1\u76d8\u83b7\u53d6\u6570\u636e\uff0c\u518d +1 \u540e\u5199\u76d8\uff09\uff1b</li> </ul> <p>\u5982\u4e0a\u6240\u8ff0\uff0c\u53ea\u8ffd\u52a0\u5230\u4e00\u4e2a\u6587\u4ef6\uff0c\u5982\u4f55\u907f\u514d\u6700\u7ec8\u7528\u6237\u7528\u5c3d\u78c1\u76d8\u7a7a\u95f4\uff1f</p> <ul> <li>\u4e00\u4e2a\u6587\u4ef6\u4e0d\u80fd\u6267\u884c\u538b\u7f29\uff0c\u5c06\u5176\u65e7\u7684\u6570\u636e\u5220\u9664\uff0c\u8282\u7701\u78c1\u76d8\u7a7a\u95f4\uff1b</li> <li>\u5c06\u65e5\u5fd7\u6587\u4ef6\u5206\u89e3\u6210\u4e00\u5b9a\u5927\u5c0f\u7684\u6bb5\uff0c\u6587\u4ef6\u8fbe\u5230\u4e00\u5b9a\u5927\u5c0f\u662f\u5173\u95ed\uff0c\u540e\u7eed\u5199\u5165\u5230\u65b0\u7684\u6587\u4ef6\u4e2d\uff1b</li> <li>\u5bf9\u4e8e\u5173\u95ed\u7684\u6bb5\u6587\u4ef6\uff0c\u6267\u884c\u538b\u7f29\uff0c\u4e22\u5f03\u91cd\u590d\u7684\u952e\uff0c\u53ea\u4fdd\u7559\u6700\u65b0\u7684\u6570\u636e\uff1b</li> <li>\u6bb5\u538b\u7f29\u540e\u6587\u4ef6\u53ef\u80fd\u5f88\u5c0f\uff0c\u53ef\u4ee5\u5c06\u591a\u4e2a\u6bb5\u5408\u5e76\u6210\u4e00\u4e2a\u5927\u7684\u6bb5\uff1b</li> <li>\u538b\u7f29\u548c\u5408\u5e76\u540e\u53f0\u5f02\u6b65\u6267\u884c\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</li> <li>\u8fd0\u884c\u65f6\uff0c\u8bfb\u53d6\u91c7\u7528\u65e7\u7684\u6bb5\u6587\u4ef6\uff0c\u5199\u5165\u5230\u65b0\u7684\u6bb5\u6587\u4ef6\uff1b</li> <li>\u8fd0\u884c\u7ed3\u675f\u540e\uff0c\u8bfb\u5199\u90fd\u91c7\u7528\u65b0\u7684\u6bb5\u6587\u4ef6\uff1b</li> </ul> <p></p> <p>\u6bcf\u4e2a\u6bb5\u90fd\u6709\u81ea\u5df1\u7684\u5185\u5b58 hashmap\uff0c\u5c06\u952e\u6620\u5c04\u5230\u6587\u4ef6\u504f\u79fb\u91cf\uff1a</p> <ul> <li>\u67e5\u627e\u65f6\uff0c\u5148\u67e5\u627e\u6700\u65b0\u7684\u6bb5\u7684 hashmap\uff0c\u4e0d\u5b58\u5728\u5219\u67e5\u627e\u7b2c\u4e8c\u6700\u65b0\u7684\u6bb5\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff08\u6bb5\u7684\u6570\u91cf\u4e0d\u80fd\u591a\uff09\uff1b</li> </ul> <p>\u5b9e\u73b0\u843d\u5730\u8fc7\u7a0b\u7684\u5176\u5b83\u7ec6\u8282\uff1a</p> <ul> <li>\u6587\u4ef6\u683c\u5f0f\uff1aCSV \u4e0d\u662f\u6700\u4f73\u683c\u5f0f\uff0c\u66f4\u5feb\u66f4\u7b80\u5355\u7684\u662f\u4e8c\u8fdb\u5236\u683c\u5f0f\uff1a\u957f\u5ea6+\u6570\u636e</li> <li>\u5220\u9664\u8bb0\u5f55\uff1a\u5893\u7891\u6807\u8bb0\uff0c\u8ba4\u4e3a\u67d0\u4e2a\u952e\u88ab\u5220\u9664\uff1b</li> <li>\u5d29\u6e83\u6062\u590d\uff1a\u5185\u5b58 hashmap \u7684\u91cd\u65b0\u6784\u5efa\uff0c\u53ef\u4ee5\u626b\u63cf\u6bb5\u6587\u4ef6\u4ece\u5934\u6784\u5efa\uff0c\u6216\u8005\u4fdd\u5b58\u6bcf\u4e2a\u6bb5\u7684 hashmap \u7684\u5feb\u7167\uff1b</li> <li>\u5feb\u7167\u662f\u9488\u5bf9\u4e0d\u518d\u5199\u5165\u7684\u6bb5\uff0c\u5982\u679c\u6b63\u5728\u5199\u5165\u7684\u6bb5\uff0c\u662f\u5426\u91cd\u5934\u6784\u5efa\uff08\u4fdd\u8bc1\u4e00\u81f4\u6027\uff0c\u6bcf\u6b21\u66f4\u65b0hashmap\uff0c\u90fd\u4fdd\u5b58\u5feb\u7167\u5219\u6027\u80fd\u592a\u6162\uff09</li> <li>\u90e8\u5206\u5199\u5165\uff1a\u6570\u636e\u5e93\u968f\u65f6\u4f1a\u5d29\u6e83\uff0c\u5982\u5c06\u8bb0\u5f55\u8ffd\u52a0\u5230\u65e5\u5fd7\u8fc7\u7a0b\u4e2d\u3002Bitcask \u6587\u4ef6\u5305\u62ec\u6821\u9a8c\u503c\uff0c\u53ef\u4ee5\u53d1\u73b0\u635f\u574f\u90e8\u5206\u5e76\u4e22\u5f03\uff1b</li> <li>\u5e76\u53d1\u63a7\u5236\uff1a\u901a\u5e38\u91c7\u7528\u4e00\u5199\u591a\u8bfb\u7684\u5f62\u5f0f\uff1b</li> </ul> <p>\u91c7\u7528\u8ffd\u52a0\u5199\u65e5\u5fd7\u7684\u65b9\u5f0f\u4f3c\u4e4e\u5f88\u6d6a\u8d39\u7a7a\u95f4\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u91c7\u7528\u539f\u5730\u66f4\u65b0\u7528\u65b0\u503c\u66ff\u6362\u65e7\u503c\u7684\u65b9\u5f0f\uff1f</p> <ul> <li>\u987a\u5e8f\u5199\u6bd4\u968f\u673a\u5199\u8981\u5feb\u7684\u591a\uff0c\u7279\u522b\u662f\u5728\u78c1\u76d8\u4e0a\u3002\u5bf9\u4e8eSSD\uff0c\u987a\u5e8f\u5199\u5165\u4e5f\u662f\u5408\u9002\u7684\\(^{[2]}\\)\uff1b</li> <li>\u5bf9\u4e8e\u8ffd\u52a0\u5199\uff0c\u5176\u5e76\u53d1\u548c\u5d29\u6e83\u6062\u590d\u8981\u66f4\u7b80\u5355\uff0c\u5982\u5f53\u4e00\u4e2a\u6570\u636e\u503c\u88ab\u66f4\u65b0\u7684\u65f6\u5019\u53d1\u751f\u5d29\u6e83\uff0c\u4e0d\u7528\u62c5\u5fc3\u6587\u4ef6\u91cc\u5c06\u4f1a\u540c\u65f6\u5305\u542b\u65e7\u503c\u548c\u65b0\u503c\u5404\u81ea\u7684\u4e00\u90e8\u5206;</li> <li>\u5408\u5e76\u65e7\u6bb5\u7684\u5904\u7406\u4e5f\u53ef\u4ee5\u907f\u514d\u6570\u636e\u6587\u4ef6\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u800c\u788e\u7247\u5316\u7684\u95ee\u9898\uff1b</li> <li>\u539f\u5730\u66f4\u65b0\uff0c\u5982\u679c\u503c\u7684\u5927\u5c0f\u4e0d\u4e00\u6837\uff0c\u5176\u5904\u7406\u76f8\u5bf9\u4e8e\u8ffd\u52a0\u5199\u8981\u590d\u6742\uff1b</li> </ul> <p>\u54c8\u5e0c\u8868\u7d22\u5f15\u7684\u5c40\u9650\u6027\uff1a</p> <ul> <li>\u54c8\u5e0c\u8868\u5fc5\u987b\u5168\u90e8\u653e\u5165\u5185\u5b58\u3002\u867d\u7136\u53ef\u4ee5\u5728\u78c1\u76d8\u4e0a\u7ef4\u62a4 hash map\uff0c\u4f46\u5f88\u96be\u4f7f\u5f97\u78c1\u76d8\u4e0a\u7684 hash map\u8868\u73b0\u826f\u597d\\(^{[3]}\\)\uff1b</li> <li>\u533a\u95f4\u67e5\u8be2\u6548\u7387\u4e0d\u9ad8\uff0c\u53ea\u80fd\u901a\u8fc7\u5355\u4e2a\u67e5\u627e\u7684\u5f62\u5f0f\u67e5\u8be2\u6bcf\u4e2a\u952e\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#sstables-lsm-tree","title":"SSTables \u548c LSM-Tree","text":"<p>\u8981\u6c42\u6587\u4ef6\u4e2d\u7684key-value\u5bf9\u7684\u987a\u5e8f\u6309\u952e\u6392\u5e8f\uff0c\u8fd9\u4e2a\u683c\u5f0f\u79f0\u4e3a \u6392\u5e8f\u5b57\u7b26\u4e32\u8868\uff08Sorted String Table\uff09\uff0c\u7b80\u79f0 SSTable\u3002</p> <p>\u76f8\u6bd4\u4e8e\u54c8\u5e0c\u7d22\u5f15\u7684\u65e5\u5fd7\u6bb5\uff0c\u5176\u4f18\u52bf\uff1a</p> <ul> <li> <p>\u5408\u5e76\u6bb5\u66f4\u52a0\u9ad8\u6548\uff0c\u5373\u4f7f\u6587\u4ef6\u8fdc\u5927\u4e8e\u53ef\u7528\u5185\u5b58\uff0c\u7c7b\u4f3c\u5408\u5e76\u6392\u5e8f\u7684\u7b97\u6cd5\uff0c\u76f8\u540c\u7684\u952e\u4fdd\u7559\u6700\u65b0\u7684\u6bb5\u4e2d\u7684\u503c\uff1b</p> </li> <li> <p>\u5728\u6587\u4ef6\u4e2d\u67e5\u627e\u7279\u5b9a\u7684\u952e\u65f6\uff0c\u4e0d\u9700\u8981\u5185\u5b58\u4e2d\u4fdd\u5b58\u6240\u6709\u952e\u7684\u7d22\u5f15\uff1b\u4f46\u4ecd\u9700\u8981\u4fdd\u5b58\u7a00\u758f\u7d22\u5f15\u8bb0\u5f55\u4e00\u4e9b\u952e\u7684\u504f\u79fb\u91cf</p> </li> <li> <p>\u6bcf\u51e0\u5343\u5b57\u8282\u7684\u6bb5\u6587\u4ef6\u6709\u4e00\u4e2a\u952e\u5c31\u8db3\u591f\u4e86\uff0c\u56e0\u4e3a\u51e0\u5343\u5b57\u8282\u53ef\u4ee5\u5f88\u5feb\u5730\u88ab\u626b\u63cf\u5b8c<sup>2</sup></p> </li> </ul> <p></p> <ul> <li>\u8bfb\u8bf7\u6c42\u5f80\u5f80\u9700\u8981\u626b\u63cf\u8bf7\u6c42\u8303\u56f4\u5185\u591a\u4e2akey-value\u5bf9\uff0c\u53ef\u4ee5\u5c06\u8bb0\u5f55\u5206\u7ec4\u4e3a\u5757\uff0c\u5e76\u5199\u5165\u78c1\u76d8\u524d\u8fdb\u884c\u538b\u7f29\uff08\u5982\u4e0a\u56fe\u9634\u5f71\u90e8\u5206\uff09\uff0c\u7d22\u5f15\u5185\u5bb9\u6307\u5411\u538b\u7f29\u5757\u5f00\u5934\uff0c\u51cf\u5c11I/O\u5e26\u5bbd\u5360\u7528\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#sstables","title":"\u6784\u5efa\u548c\u7ef4\u62a4 SSTables","text":"<p>\u5982\u4f55\u4fdd\u8bc1\u6570\u636e\u662f\u6392\u597d\u5e8f\u7684\uff1f</p> <ul> <li>\u91c7\u7528\u57fa\u4e8e\u5185\u5b58\u7684\u6811\u5f62\u6570\u636e\u7ed3\u6784\uff08\u5982\u7ea2\u9ed1\u6811\u548cAVL\u6811\uff09\uff0c\u867d\u7136\u57fa\u4e8e\u78c1\u76d8\u7684B\u6811\u4e5f\u53ef\u4ee5\uff08\u5176\u6548\u7387\u6162\uff09\uff1b</li> </ul> <p>\u5b58\u50a8\u5f15\u64ce\u7684\u57fa\u672c\u5de5\u4f5c\u6d41\u7a0b\uff1a</p> <ul> <li>\u65b0\u5199\u5165\u65f6\uff0c\u5c06\u5176\u6dfb\u52a0\u5230\u5185\u5b58\u4e2d\u7684\u5e73\u8861\u6811\u6570\u636e\u7ed3\u6784\uff08\u4f8b\u5982\u7ea2\u9ed1\u6811\uff09\u3002\u8fd9\u4e2a\u5185\u5b58\u6811\u6709\u65f6\u88ab\u79f0\u4e3a \u5185\u5b58\u8868\uff08memtable\uff09\uff1b</li> <li>\u5f53 \u5185\u5b58\u8868\u5927\u4e8e\u67d0\u4e2a\u9608\u503c\uff08\u901a\u5e38\u4e3a\u51e0\u5146\u5b57\u8282\uff09\u65f6\uff0c\u5c06\u5176\u4f5c\u4e3a SSTable \u6587\u4ef6\u5199\u5165\u786c\u76d8 \uff1b\u65b0\u7684 SSTable \u6587\u4ef6\u5c06\u6210\u4e3a\u6570\u636e\u5e93\u4e2d\u6700\u65b0\u7684\u6bb5\u3002\u5f53\u8be5 SSTable \u88ab\u5199\u5165\u786c\u76d8\u65f6\uff0c\u65b0\u7684\u5199\u5165\u53ef\u4ee5\u5728\u4e00\u4e2a\u65b0\u7684\u5185\u5b58\u8868\u5b9e\u4f8b\u4e0a\u7ee7\u7eed\u8fdb\u884c\u3002</li> <li>\u6536\u5230\u8bfb\u53d6\u8bf7\u6c42\u65f6\uff0c\u9996\u5148\u5c1d\u8bd5\u5728\u5185\u5b58\u8868\u4e2d\u627e\u5230\u5bf9\u5e94\u7684\u952e\uff0c\u5982\u679c\u6ca1\u6709\u5c31\u5728\u6700\u8fd1\u7684\u786c\u76d8\u6bb5\u4e2d\u5bfb\u627e\uff0c\u5982\u679c\u8fd8\u6ca1\u6709\u5c31\u5728\u4e0b\u4e00\u4e2a\u8f83\u65e7\u7684\u6bb5\u4e2d\u7ee7\u7eed\u5bfb\u627e\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff1b</li> <li>\u540e\u53f0\u7ebf\u7a0b\u5468\u671f\u6027\u6267\u884c\u6bb5\u5408\u5e76\u4e0e\u538b\u7f29\u8fc7\u7a0b\uff0c\u5408\u5e76\u6bb5\u6587\u4ef6\u5e76\u5c06\u5df2\u8986\u76d6\u548c\u5220\u9664\u7684\u6570\u636e\u4e22\u5f03\uff1b</li> </ul> <p>\u5982\u679c\u6570\u636e\u5e93\u5d29\u6e83\uff0c\u6700\u8fd1\u7684\u5199\u5165\uff08\u5728\u5185\u5b58\u4f46\u672a\u5199\u5165\u78c1\u76d8\uff09\u5c06\u4f1a\u4e22\u5931\uff1a</p> <ul> <li>\u78c1\u76d8\u4e0a\u4fdd\u7559\u5355\u72ec\u7684\u65e5\u5fd7\uff08WriteAheadLog\uff09\uff0c\u6bcf\u4e2a\u5199\u5165\u4f1a\u5148\u8ffd\u52a0\u5230\u8be5\u65e5\u5fd7\uff0c\u518d\u5199\u5165\u5185\u5b58\uff1b</li> <li>\u8be5\u65e5\u5fd7\u65e0\u9700\u6392\u5e8f\uff0c\u7528\u4e8e\u5d29\u6e83\u540e\u6062\u590d\u5185\u5b58\u8868\uff0c\u5f53\u5185\u5b58\u8868\u5199\u5165 SSTable \u65f6\uff0c\u76f8\u5e94\u7684\u65e5\u5fd7\u53ef\u4ee5\u88ab\u4e22\u5f03\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#sstable-lsm","title":"\u4ece SSTable \u5230 LSM","text":"<p>\u4e0a\u8ff0\u7b97\u6cd5\u672c\u8d28\u4e0a\u662f LevelDB \u548c RocksDB \u8fd9\u4e9b\u952e\u503c\u5b58\u50a8\u5f15\u64ce\u5e93\u6240\u4f7f\u7528\u7684\u6280\u672f\u3002\u5728 Cassandra \u548c HBase \u4e2d\u4e5f\u4f7f\u7528\u4e86\u7c7b\u4f3c\u7684\u5b58\u50a8\u5f15\u64ce\uff0c\u53d7\u5230 Google Bigtable \u8bba\u6587\u7684\u542f\u53d1\u3002</p> <p>\u8fd9\u79cd\u7d22\u5f15\u7ed3\u6784\u6700\u65e9\u7531 Patrick O'Neil \u7b49\u4eba\u53d1\u660e\uff0c\u4e14\u88ab\u547d\u540d\u4e3a\u65e5\u5fd7\u7ed3\u6784\u5408\u5e76\u6811\uff08\u6216 LSM \u6811\uff09\\(^{[4]}\\)\uff0c\u5b83\u662f\u57fa\u4e8e\u66f4\u65e9\u4e4b\u524d\u7684\u65e5\u5fd7\u7ed3\u6784\u6587\u4ef6\u7cfb\u7edf\\(^{[5]}\\)\u6765\u6784\u5efa\u7684\u3002\u57fa\u4e8e\u8fd9\u79cd\u5408\u5e76\u548c\u538b\u7f29\u6392\u5e8f\u6587\u4ef6\u539f\u7406\u7684\u5b58\u50a8\u5f15\u64ce\u901a\u5e38\u88ab\u79f0\u4e3a LSM \u5b58\u50a8\u5f15\u64ce\u3002</p> <p>Apache Lucene\uff0c\u662f\u4e00\u79cd\u5168\u6587\u641c\u7d22\u7684\u7d22\u5f15\u5f15\u64ce\uff0c\u5728 Elasticsearch \u548c Solr \u88ab\u4f7f\u7528\uff0c\u5b83\u4f7f\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\u6765\u5b58\u50a8\u5b83\u7684\u5173\u952e\u8bcd\u8bcd\u5178\\(^{[6, 7]}\\)\uff1a</p> <ul> <li>\u952e\u662f \u5355\u8bcd\uff08term\uff09\uff0c\u503c\u662f\u6240\u6709\u5305\u542b\u8be5\u5355\u8bcd\u7684\u6587\u6863\u7684 ID \u5217\u8868</li> <li>\u4ece\u8bcd\u8bed\u5230\u8bb0\u5f55\u5217\u8868\u7684\u8fd9\u79cd\u6620\u5c04\u4fdd\u5b58\u5728\u7c7b\u4f3c\u4e8e SSTable \u7684\u6709\u5e8f\u6587\u4ef6\u4e2d\uff0c\u5e76\u6839\u636e\u9700\u8981\u5728\u540e\u53f0\u6267\u884c\u5408\u5e76\\(^{[8]}\\)</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_4","title":"\u6027\u80fd\u4f18\u5316","text":"<p>\u8ba9\u5b58\u50a8\u5f15\u64ce\u5728\u5b9e\u8df5\u4e2d\u8868\u73b0\u826f\u597d\u6d89\u53ca\u5230\u5927\u91cf\u8bbe\u8ba1\u7ec6\u8282\uff1a</p> <ul> <li>\u5e03\u9686\u8fc7\u6ee4\u5668\uff08Bloom filters\uff09\uff1a\u5f53\u67e5\u627e\u6570\u636e\u5e93\u4e2d\u4e0d\u5b58\u5728\u7684\u952e\u65f6\uff0cLSM \u6811\u7b97\u6cd5\u53ef\u80fd\u4f1a\u5f88\u6162\uff08\u68c0\u67e5\u5185\u5b58\u8868\u548c\u6240\u6709\u7684\u6bb5\uff09\uff1b</li> <li>SSTables \u88ab\u538b\u7f29\u548c\u5408\u5e76\u7684\u987a\u5e8f\u548c\u65f6\u95f4</li> <li><code>size-tiered</code>\uff1a\u8f83\u65b0\u548c\u8f83\u5c0f\u7684 SSTables \u76f8\u7ee7\u88ab\u5408\u5e76\u5230\u8f83\u65e7\u7684\u548c\u8f83\u5927\u7684 SSTable \u4e2d\uff0c\u5982 HBase\uff0cCassandra \u3002</li> <li><code>leveled compaction</code>\uff1akey \uff08\u6309\u7167\u5206\u5e03\u8303\u56f4\uff09\u88ab\u62c6\u5206\u5230\u8f83\u5c0f\u7684 SSTables\uff0c\u800c\u8f83\u65e7\u7684\u6570\u636e\u88ab\u79fb\u52a8\u5230\u5355\u72ec\u7684\u5c42\u7ea7\uff08level\uff09\uff0c\u8fd9\u4f7f\u5f97\u538b\u7f29\uff08compaction\uff09\u80fd\u591f\u66f4\u52a0\u589e\u91cf\u5730\u8fdb\u884c\uff0c\u5e76\u4e14\u4f7f\u7528\u8f83\u5c11\u7684\u786c\u76d8\u7a7a\u95f4\u3002\u5982 LevelDB\uff0cRocksDB\uff0cCassandra \u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#b-tree","title":"B-tree","text":"<p>B \u6811\u5c06\u6570\u636e\u5e93\u5206\u89e3\u6210\u56fa\u5b9a\u5927\u5c0f\u7684 \u5757\uff08block\uff09 \u6216 \u5206\u9875\uff08page\uff09\uff0c\u4f20\u7edf\u4e0a\u5927\u5c0f\u4e3a 4KB\uff08\u6709\u65f6\u4f1a\u66f4\u5927\uff09\uff0c\u5e76\u4e14\u4e00\u6b21\u53ea\u80fd\u8bfb\u53d6\u6216\u5199\u5165\u4e00\u4e2a\u9875\u9762\u3002</p> <ul> <li>\u4e00\u4e2a\u9875\u9762\u4f1a\u88ab\u6307\u5b9a\u4e3a B \u6811\u7684\u6839\uff0c\u5305\u542b\u51e0\u4e2a\u952e\u548c\u5bf9\u5b50\u9875\u9762\u7684\u5f15\u7528\u3002\u7d22\u5f15\u4e2d\u67e5\u627e\u4e00\u4e2a\u952e\u65f6\u4ece\u8fd9\u91cc\u5f00\u59cb\uff1b</li> <li>\u6bcf\u4e2a\u5b50\u9875\u9762\u8d1f\u8d23\u4e00\u6bb5\u8fde\u7eed\u8303\u56f4\u7684\u952e\uff0c\u6839\u9875\u9762\u4e0a\u6bcf\u4e24\u4e2a\u5f15\u7528\u4e4b\u95f4\u7684\u952e\uff0c\u8868\u793a\u76f8\u90bb\u5b50\u9875\u9762\u7ba1\u7406\u7684\u952e\u7684\u8303\u56f4\uff08\u8fb9\u754c\uff09</li> <li>\u4e00\u4e2a\u9875\u9762\u4e2d\u5bf9\u5b50\u9875\u9762\u7684\u5f15\u7528\u7684\u6570\u91cf\u79f0\u4e3a \u5206\u652f\u56e0\u5b50\uff0c\u4e0b\u56fe\u7684\u5206\u652f\u56e0\u5b50\u4e3a 6\uff1b</li> </ul> <p></p> <ul> <li>\u8981\u66f4\u65b0 B \u6811\u4e2d\u73b0\u6709\u952e\u7684\u503c\uff0c\u9700\u8981\u641c\u7d22\u5305\u542b\u8be5\u952e\u7684\u53f6\u5b50\u9875\u9762\uff0c\u66f4\u6539\u8be5\u9875\u9762\u4e2d\u7684\u503c\uff0c\u5e76\u5c06\u8be5\u9875\u9762\u5199\u56de\u5230\u786c\u76d8\uff1b</li> <li>\u60f3\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u952e\uff0c\u4f60\u9700\u8981\u627e\u5230\u5176\u8303\u56f4\u80fd\u5305\u542b\u65b0\u952e\u7684\u9875\u9762\uff0c\u5e76\u5c06\u5176\u6dfb\u52a0\u5230\u8be5\u9875\u9762\u3002\u5982\u679c\u9875\u9762\u4e2d\u6ca1\u6709\u8db3\u591f\u7684\u53ef\u7528\u7a7a\u95f4\u5bb9\u7eb3\u65b0\u952e\uff0c\u5219\u5c06\u5176\u5206\u6210\u4e24\u4e2a\u534a\u6ee1\u9875\u9762\uff0c\u5e76\u66f4\u65b0\u7236\u9875\u9762\u4ee5\u53cd\u6620\u65b0\u7684\u952e\u8303\u56f4\u5206\u533a\uff0c\u5982\u4e0b\u56fe\u6240\u793a</li> </ul> <p></p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#b","title":"\u4f7f B \u6811\u66f4\u53ef\u9760","text":"<p>B \u6811\u7684\u57fa\u672c\u5e95\u5c42\u5199\u64cd\u4f5c\u662f\u7528\u65b0\u6570\u636e\u8986\u5199\u786c\u76d8\u4e0a\u7684\u9875\u9762\uff0c\u5e76\u5047\u5b9a\u8986\u5199\u4e0d\u6539\u53d8\u9875\u9762\u7684\u4f4d\u7f6e\u3002</p> <ul> <li>\u5bf9\u4e8e\u78c1\u76d8\uff0c\u5c06\u78c1\u5934\u79fb\u52a8\u5230\u6b63\u786e\u7684\u4f4d\u7f6e\uff0c\u7b49\u5f85\u65cb\u8f6c\u76d8\u4e0a\u7684\u6b63\u786e\u4f4d\u7f6e\u51fa\u73b0\uff0c\u7136\u540e\u7528\u65b0\u7684\u6570\u636e\u8986\u5199\u9002\u5f53\u7684\u6247\u533a\uff1b</li> <li>\u5bf9\u4e8e SSD\uff0c\u7531\u4e8e SSD \u5fc5\u987b\u4e00\u6b21\u64e6\u9664\u548c\u91cd\u5199\u76f8\u5f53\u5927\u7684\u5b58\u50a8\u82af\u7247\u5757\uff0c\u60c5\u51b5\u66f4\u4e3a\u590d\u6742\uff1b</li> </ul> <p>\u9884\u5199\u5f0f\u65e5\u5fd7\uff08WAL\uff09\uff0c\u4e5f\u79f0\u91cd\u505a\u65e5\u5fd7\uff08redo log\uff09\uff0c\u4f7f\u6570\u636e\u5e93\u80fd\u5904\u7406\u5f02\u5e38\u5d29\u6e83\u7684\u573a\u666f\uff1a</p> <ul> <li>\u4ec5\u8ffd\u52a0\u7684\u6587\u4ef6\uff0c\u6bcf\u4e2a B \u6811\u7684\u4fee\u6539\u5728\u5176\u80fd\u88ab\u5e94\u7528\u5230\u6811\u672c\u8eab\u7684\u9875\u9762\u4e4b\u524d\u90fd\u5fc5\u987b\u5148\u5199\u5165\u5230\u8be5\u6587\u4ef6\\(^{[3,9]}\\)</li> </ul> <p>\u591a\u7ebf\u7a0b\u5e76\u53d1\u66f4\u65b0B\u6811\uff0c\u9632\u6b62\u7ebf\u7a0b\u53ef\u80fd\u4f1a\u770b\u5230\u6811\u5904\u4e8e\u4e0d\u4e00\u81f4\u7684\u72b6\u6001\uff1a</p> <ul> <li>\u91c7\u7528\u9501\u5b58\u5668\uff08latches\uff0c\u8f7b\u91cf\u7ea7\u9501\uff09\u4fdd\u62a4\u6811\u7684\u6570\u636e\u7ed3\u6784\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#b_1","title":"B \u6811\u7684\u4f18\u5316","text":"<ul> <li>\u5199\u65f6\u590d\u5236\u65b9\u6848\\(^{[10]}\\)\uff1a\u7ecf\u8fc7\u4fee\u6539\u7684\u9875\u9762\u88ab\u5199\u5165\u5230\u4e0d\u540c\u7684\u4f4d\u7f6e\uff0c\u5e76\u4e14\u8fd8\u5728\u6811\u4e2d\u521b\u5efa\u4e86\u7236\u9875\u9762\u7684\u65b0\u7248\u672c\uff0c\u4ee5\u6307\u5411\u65b0\u7684\u4f4d\u7f6e\uff1b</li> <li>\u4fdd\u5b58\u952e\u7684\u7f29\u7565\u4fe1\u606f\uff1a\u63d0\u5347\u5206\u652f\u56e0\u5b50\uff0c\u51cf\u5c11\u5c42\u7ea7<sup>1</sup>\uff1b</li> <li>\u6dfb\u52a0\u989d\u5916\u7684\u6307\u9488\u5230\u6811\uff1a\u5982\u6bcf\u4e2a\u53f6\u5b50\u9875\u9762\u53ef\u4ee5\u5f15\u7528\u5176\u5de6\u8fb9\u548c\u53f3\u8fb9\u7684\u5144\u5f1f\u9875\u9762\uff0c\u4f7f\u5f97\u4e0d\u7528\u8df3\u56de\u7236\u9875\u9762\u5c31\u80fd\u6309\u987a\u5e8f\u5bf9\u952e\u8fdb\u884c\u626b\u63cf\uff1b</li> <li>\u9875\u9762\u987a\u5e8f\u5b58\u50a8\uff1a\u9488\u5bf9\u987a\u5e8f\u626b\u63cf\u952e\u8303\u56f4\u7684\u573a\u666f\uff0c\u8bb8\u591a B \u6811\u7684\u5b9e\u73b0\u5728\u5e03\u5c40\u6811\u65f6\u4f1a\u5c3d\u91cf\u4f7f\u53f6\u5b50\u9875\u9762\u6309\u987a\u5e8f\u51fa\u73b0\u5728\u786c\u76d8\u4e0a\uff0c\u907f\u514d\u78c1\u76d8\u591a\u6b21\u67e5\u627e</li> <li> <p>\u968f\u7740\u6811\u7684\u589e\u957f\uff0c\u7ef4\u6301\u987a\u5e8f\u5f88\u56f0\u96be\uff1b\u4f46 LSM \u5408\u5e76\u65f6\u4f1a\u91cd\u5199\u6bb5\uff0c\u66f4\u5bb9\u6613\u4f7f\u5f97\u987a\u5e8f\u952e\u5728\u786c\u76d8\u4e0a\u987a\u5e8f\u5b58\u50a8\uff1b</p> </li> <li> <p>B \u6811\u7684\u53d8\u4f53\u5982 \u5206\u5f62\u6811\uff08fractal trees\uff09\\(^{[11]}\\)\u501f\u7528\u4e86\u4e00\u4e9b\u65e5\u5fd7\u7ed3\u6784\u7684\u601d\u60f3\u6765\u51cf\u5c11\u786c\u76d8\u67e5\u627e\uff08\u800c\u4e14\u5b83\u4eec\u4e0e\u5206\u5f62\u65e0\u5173\uff09\u3002</p> </li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#lsm-tree-b-tree","title":"LSM-tree \u548c B-tree\u7684\u6bd4\u8f83","text":"<p>\u901a\u5e38 LSM \u6811\u7684\u5199\u5165\u901f\u5ea6\u66f4\u5feb\uff0c\u800c B \u6811\u7684\u8bfb\u53d6\u901f\u5ea6\u66f4\u5feb\\(^{[12]}\\)\u3002\u7136\u800c\uff0c\u57fa\u51c6\u6d4b\u8bd5\u7684\u7ed3\u679c\u901a\u5e38\u548c\u5de5\u4f5c\u8d1f\u8f7d\u7684\u7ec6\u8282\u76f8\u5173\u3002\u4f60\u9700\u8981\u7528\u4f60\u7279\u6709\u7684\u5de5\u4f5c\u8d1f\u8f7d\u6765\u6d4b\u8bd5\u7cfb\u7edf\uff0c\u4ee5\u4fbf\u8fdb\u884c\u6709\u6548\u7684\u6bd4\u8f83\u3002</p> <p>B \u6811\u5728\u6570\u636e\u5e93\u67b6\u6784\u4e2d\u662f\u975e\u5e38\u6839\u6df1\u8482\u56fa\u7684\uff0c\u4e3a\u8bb8\u591a\u5de5\u4f5c\u8d1f\u8f7d\u90fd\u63d0\u4f9b\u4e86\u59cb\u7ec8\u5982\u4e00\u7684\u826f\u597d\u6027\u80fd\uff0c\u6240\u4ee5\u5b83\u4eec\u4e0d\u53ef\u80fd\u5728\u77ed\u671f\u5185\u6d88\u5931\u3002\u5728\u65b0\u7684\u6570\u636e\u5e93\u4e2d\uff0c\u65e5\u5fd7\u7ed3\u6784\u5316\u7d22\u5f15\u53d8\u5f97\u8d8a\u6765\u8d8a\u6d41\u884c\u3002\u6ca1\u6709\u7b80\u5355\u6613\u884c\u7684\u529e\u6cd5\u6765\u5224\u65ad\u54ea\u79cd\u7c7b\u578b\u7684\u5b58\u50a8\u5f15\u64ce\u5bf9\u4f60\u7684\u4f7f\u7528\u573a\u666f\u66f4\u597d\uff0c\u6240\u4ee5\u9700\u8981\u901a\u8fc7\u4e00\u4e9b\u6d4b\u8bd5\u6765\u5f97\u5230\u76f8\u5173\u7ecf\u9a8c\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#lsm","title":"LSM \u6811\u7684\u4f18\u70b9","text":"<p>LSM \u6811\u901a\u5e38\u80fd\u591f\u6bd4 B \u6811\u652f\u6301\u66f4\u9ad8\u7684\u5199\u5165\u541e\u5410\u91cf</p> <ul> <li>\u6709\u65f6\u5177\u6709\u8f83\u4f4e\u7684\u5199\u653e\u5927\uff08\u5c3d\u7ba1\u8fd9\u53d6\u51b3\u4e8e\u5b58\u50a8\u5f15\u64ce\u7684\u914d\u7f6e\u548c\u5de5\u4f5c\u8d1f\u8f7d\uff09</li> <li>B \u6811\u7d22\u5f15\u4e2d\u7684\u6bcf\u5757\u6570\u636e\u90fd\u5fc5\u987b\u81f3\u5c11\u5199\u5165\u4e24\u6b21\uff1a\u4e00\u6b21\u5199\u5165\u9884\u5148\u5199\u5165\u65e5\u5fd7\uff08WAL\uff09\uff0c\u4e00\u6b21\u5199\u5165\u6811\u9875\u9762\u672c\u8eab\uff08\u5982\u679c\u6709\u5206\u9875\u8fd8\u9700\u8981\u518d\u5199\u5165\u4e00\u6b21\uff09</li> <li>\u56e0\u4e3a\u53cd\u590d\u538b\u7f29\u548c\u5408\u5e76 SSTables\uff0c\u65e5\u5fd7\u7ed3\u6784\u7d22\u5f15\u4e5f\u4f1a\u591a\u6b21\u91cd\u5199\u6570\u636e\uff08\u4e5f\u4f1a\u5199\u5165WAL \u65e5\u5fd7\uff0c\u7528\u4e8e\u5d29\u6e83\u6062\u590d\uff09</li> <li>\u987a\u5e8f\u5730\u5199\u5165\u7d27\u51d1\u7684 SSTable \u6587\u4ef6\u800c\u4e0d\u662f\u5fc5\u987b\u8986\u5199\u6811\u4e2d\u7684\u591a\u4e2a\u9875\\(^{[13]}\\)\uff0c\u7279\u522b\u662f\u5728\u673a\u68b0\u786c\u76d8\u4e0a\uff1b</li> </ul> <p>LSM \u6811\u53ef\u4ee5\u88ab\u538b\u7f29\u5f97\u66f4\u597d\uff0c\u56e0\u6b64\u901a\u5e38\u80fd\u6bd4 B \u6811\u5728\u786c\u76d8\u4e0a\u4ea7\u751f\u66f4\u5c0f\u7684\u6587\u4ef6\u3002</p> <ul> <li>B \u6811\u5b58\u50a8\u5f15\u64ce\u4f1a\u7531\u4e8e\u788e\u7247\u5316\u800c\u7559\u4e0b\u4e00\u4e9b\u672a\u4f7f\u7528\u7684\u786c\u76d8\u7a7a\u95f4\uff1a\u5f53\u9875\u9762\u88ab\u62c6\u5206\u6216\u67d0\u884c\u4e0d\u80fd\u653e\u5165\u73b0\u6709\u9875\u9762\u65f6\uff0c\u9875\u9762\u4e2d\u7684\u67d0\u4e9b\u7a7a\u95f4\u4ecd\u672a\u88ab\u4f7f\u7528\uff1b</li> </ul> <p>\u5728\u8bb8\u591a\u56fa\u6001\u786c\u76d8\u4e0a\uff0c\u56fa\u4ef6\u5185\u90e8\u4f7f\u7528\u4e86\u65e5\u5fd7\u7ed3\u6784\u5316\u7b97\u6cd5\uff0c\u4ee5\u5c06\u968f\u673a\u5199\u5165\u8f6c\u53d8\u4e3a\u987a\u5e8f\u5199\u5165\u5e95\u5c42\u5b58\u50a8\u82af\u7247\uff0c\u56e0\u6b64\u5b58\u50a8\u5f15\u64ce\u5199\u5165\u6a21\u5f0f\u7684\u5f71\u54cd\u4e0d\u592a\u660e\u663e\\(^{[14]}\\)\u3002</p> <p>\u4f46\u662f\uff0c\u8f83\u4f4e\u7684\u5199\u5165\u653e\u5927\u7387\u548c\u51cf\u5c11\u7684\u788e\u7247\u4ecd\u7136\u5bf9\u56fa\u6001\u786c\u76d8\u66f4\u6709\u5229\uff1a\u66f4\u7d27\u51d1\u5730\u8868\u793a\u6570\u636e\u5141\u8bb8\u5728\u53ef\u7528\u7684 I/O \u5e26\u5bbd\u5185\u5904\u7406\u66f4\u591a\u7684\u8bfb\u53d6\u548c\u5199\u5165\u8bf7\u6c42\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#lsm_1","title":"LSM \u6811\u7684\u7f3a\u70b9","text":"<p>LSM \u6811\u5728\u538b\u7f29\u4e0e\u5408\u5e76\u7684\u8fc7\u7a0b\u6709\u65f6\u4f1a\u5e72\u6270\u6b63\u5728\u8fdb\u884c\u7684\u8bfb\u5199\u64cd\u4f5c\uff1b</p> <ul> <li>\u5bf9\u541e\u5410\u91cf\u548c\u5e73\u5747\u54cd\u5e94\u65f6\u95f4\u7684\u5f71\u54cd\u901a\u5e38\u5f88\u5c0f\uff0c\u4f46\u662f\u5728\u66f4\u9ad8\u767e\u5206\u4f4d\u7684\u54cd\u5e94\u65f6\u95f4\u6709\u65f6\u4f1a\u76f8\u5f53\u957f\uff0c\u800c B \u6811\u7684\u884c\u4e3a\u5219\u76f8\u5bf9\u66f4\u5177\u6709\u53ef\u9884\u6d4b\u6027\u301028\u3011\uff1b</li> <li>\u5728\u9ad8\u5199\u5165\u541e\u5410\u91cf\u65f6\uff0c\u521d\u59cb\u5199\u5165\uff08WAL\u548c\u5237\u65b0\u5185\u5b58\u8868\u5230\u786c\u76d8\uff09\u548c\u540e\u53f0\u538b\u7f29\u5408\u5e76\u7ebf\u7a0b\u4e4b\u95f4\u5171\u4eab\u78c1\u76d8\u7684\u6709\u9650\u5199\u5165\u5e26\u5bbd\uff1b</li> <li>\u538b\u7f29\u6ca1\u914d\u7f6e\u597d\uff0c\u4f1a\u51fa\u73b0\u538b\u7f29\u8ddf\u4e0d\u4e0a\u5199\u5165\u901f\u7387\uff0c\u672a\u5408\u5e76\u6bb5\u4e0d\u65ad\u589e\u52a0\uff0c\u5bfc\u81f4\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\u548c\u8bfb\u53d6\u901f\u7387\u4e5f\u4f1a\u964d\u4f4e\uff1b</li> <li>\u5373\u4f7f\u538b\u7f29\u65e0\u6cd5\u8ddf\u4e0a\uff0c\u57fa\u4e8e SSTable \u7684\u5b58\u50a8\u5f15\u64ce\u901a\u5e38\u4e5f\u4e0d\u4f1a\u9650\u5236\u4f20\u5165\u5199\u5165\u7684\u901f\u7387\uff0c\u6240\u4ee5\u9700\u8981\u8fdb\u884c\u660e\u786e\u7684\u76d1\u63a7\u6765\u68c0\u6d4b\u8fd9\u79cd\u60c5\u51b5\u301029,30\u3011\uff1b</li> </ul> <p>B \u6811\u6bcf\u4e2a\u952e\u53ea\u5b58\u5728\u4e8e\u7d22\u5f15\u4e2d\u7684\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u66f4\u5bb9\u6613\u63d0\u4f9b\u5f3a\u5927\u7684\u4e8b\u52a1\u8bed\u4e49\uff1a</p> <ul> <li>\u5728\u8bb8\u591a\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\uff0c\u4e8b\u52a1\u9694\u79bb\u662f\u901a\u8fc7\u5728\u952e\u8303\u56f4\u4e0a\u4f7f\u7528\u9501\u6765\u5b9e\u73b0\u7684\uff0c\u5728 B \u6811\u7d22\u5f15\u4e2d\uff0c\u8fd9\u4e9b\u9501\u53ef\u4ee5\u76f4\u63a5\u9644\u52a0\u5230\u6811\u4e0a\\(^{[3]}\\)\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_5","title":"\u5176\u5b83\u7d22\u5f15\u7ed3\u6784","text":"<p>\u952e\u503c\u7d22\u5f15\uff1a\u7c7b\u4f3c\u5173\u7cfb\u6a21\u578b\u4e2d\u7684\u4e3b\u952e\uff08primary key\uff09\u7d22\u5f15\u3002\u552f\u4e00\u6807\u8bc6\u5173\u7cfb\u8868\u4e2d\u7684\u4e00\u884c\uff0c\u6216\u6587\u6863\u6570\u636e\u5e93\u4e2d\u4e00\u7bc7\u6587\u6863\uff0c\u6216\u56fe\u6570\u636e\u5e93\u4e2d\u7684\u4e00\u4e2a\u9876\u70b9\uff1b</p> <p>\u6b21\u7ea7\u7d22\u5f15\uff08secondary indexes\uff09\uff1a\u4e0d\u540c\u7684\u952e\u4e0d\u662f\u552f\u4e00\uff0c\u5b58\u5728\u591a\u884c\uff08\u6587\u6863\uff0c\u9876\u70b9\uff09\u5177\u6709\u76f8\u540c\u7684\u952e\uff1b</p> <ul> <li>\u5bf9\u5b57\u6bb5\u5efa\u7d22\u5f15\uff0c\u9488\u5bf9 join / where \u8bed\u53e5\uff0c\u5feb\u901f\u8fc7\u6ee4\uff1b</li> </ul> <p>\u6b21\u7ea7\u7d22\u5f15\u53ef\u4ee5\u901a\u8fc7\u952e\u503c\u7d22\u5f15\u6784\u5efa\uff1a</p> <ul> <li>\u7d22\u5f15\u91cc\u7684\u503c\u53d8\u6210\u5339\u914d\u884c\u6807\u8bc6\u7b26\u7684\u5217\u8868\uff1b</li> <li>\u6bcf\u4e2a\u952e\u6dfb\u52a0\u884c\u6807\u8bc6\u7b26\u6765\u4f7f\u952e\u552f\u4e00\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_6","title":"\u5c06\u503c\u5b58\u50a8\u5728\u7d22\u5f15\u4e2d","text":"<p>\u7d22\u5f15\u4e2d\u7684\u952e\u662f\u67e5\u8be2\u8981\u641c\u7d22\u7684\u5185\u5bb9\uff0c\u800c\u5176\u503c\u53ef\u4ee5\u662f\u4ee5\u4e0b\u4e24\u79cd\u60c5\u51b5\u4e4b\u4e00\uff1a</p> <ul> <li>\u5b9e\u9645\u7684\u884c\uff08\u6587\u6863\uff0c\u9876\u70b9\uff09\uff0c\u5c06\u88ab\u7d22\u5f15\u7684\u884c\u76f4\u63a5\u5b58\u50a8\u5728\u7d22\u5f15\u4e2d\uff0c\u79f0\u4e3a\u805a\u96c6\u7d22\u5f15\uff1b</li> <li>\u4f8b\u5982 MySQL \u7684 InnoDB \u4e2d\uff0c\u8868\u7684\u4e3b\u952e\u603b\u662f\u805a\u96c6\u7d22\u5f15\uff0c\u6b21\u7ea7\u7d22\u5f15\u5219\u5f15\u7528\u4e3b\u952e\uff1b</li> <li>\u5bf9\u5b58\u50a8\u5728\u522b\u5904\u7684\u884c\u7684\u5f15\u7528\uff08\u5730\u5740\uff09\uff0c\u884c\u88ab\u5b58\u50a8\u7684\u5730\u65b9\u88ab\u79f0\u4e3a \u5806\u6587\u4ef6\uff08heap file\uff09\uff1b</li> </ul> <p>\u5806\u6587\u4ef6\u7684\u597d\u5904\uff1a</p> <ul> <li>\u907f\u514d\u4e86\u5728\u5b58\u5728\u591a\u4e2a\u6b21\u7ea7\u7d22\u5f15\u65f6\u5bf9\u6570\u636e\u7684\u590d\u5236\uff1a</li> </ul> <p>\u5806\u6587\u4ef6\u7684\u52a3\u52bf\uff1a\u4e0d\u66f4\u6539\u952e\u7684\u60c5\u51b5\u4e0b\u66f4\u65b0\u503c\u65f6</p> <ul> <li>\u65b0\u503c\u7684\u5b57\u8282\u6570\u5927\u4e8e\u65e7\u503c\u65f6\uff0c\u8981\u4e48\u6240\u6709\u7684\u7d22\u5f15\u90fd\u9700\u8981\u66f4\u65b0\uff0c\u4ee5\u6307\u5411\u8bb0\u5f55\u7684\u65b0\u5806\u4f4d\u7f6e\uff0c\u6216\u8005\u5728\u65e7\u5806\u4f4d\u7f6e\u7559\u4e0b\u4e00\u4e2a\u8f6c\u53d1\u6307\u9488\\(^{[3]}\\)</li> </ul> <p>\u8986\u76d6\u7d22\u5f15\uff08covering index\uff09 \u6216 \u5305\u542b\u5217\u7684\u7d22\u5f15\uff08index with included columns\uff09\uff0c\u5176\u5728\u7d22\u5f15\u5185\u5b58\u50a8\u8868\u7684\u4e00\u90e8\u5206\u5217</p> <ul> <li>\u805a\u96c6\u7d22\u5f15\u548c\u8986\u76d6\u7d22\u5f15\u53ef\u4ee5\u52a0\u5feb\u8bfb\u53d6\u901f\u5ea6\uff0c\u4f46\u662f\u5b83\u4eec\u9700\u8981\u989d\u5916\u7684\u5b58\u50a8\u7a7a\u95f4\uff0c\u5e76\u4e14\u4f1a\u589e\u52a0\u5199\u5165\u5f00\u9500\uff08\u4e8b\u52a1\uff09\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_7","title":"\u591a\u5217\u7d22\u5f15","text":"<p>\u540c\u65f6\u67e5\u8be2\u4e00\u4e2a\u8868\u4e2d\u7684\u591a\u4e2a\u5217\uff08\u6216\u6587\u6863\u4e2d\u7684\u591a\u4e2a\u5b57\u6bb5\uff09</p> <p>\u8fde\u63a5\u7d22\u5f15\uff08concatenated index\uff09\uff1a\u591a\u4e2a\u5b57\u6bb5\u7ec4\u5408\u6210\u4e00\u4e2a\u952e\uff08\u7d22\u5f15\uff0c\u6709\u5e8f\uff09\uff0c\u67e5\u8be2\u65f6\u5fc5\u987b\u6307\u5b9a\u524d\u9762\u7684\u7d22\u5f15\uff0c\u5426\u5219\u65e0\u6548\uff0c\u5982 MySQL\u4e2d\u8986\u76d6\u7d22\u5f15\uff1b</p> <p>\u591a\u7ef4\u7d22\u5f15\uff08multi-dimensional index\uff09\uff1a\u9002\u7528\u5730\u7406\u7a7a\u95f4\u6570\u636e\u7b49\u591a\u4e2a\u7ef4\u5ea6\u8fdb\u884c\u68c0\u7d22\u6570\u636e</p> <pre><code>SELECT * FROM restaurants WHERE latitude &gt; 51.4946 AND latitude &lt; 51.5079\n                          AND longitude &gt; -0.1162 AND longitude &lt; -0.1004;\n</code></pre> <ul> <li>\u7a7a\u95f4\u586b\u5145\u66f2\u7ebf\uff08space-filling curve\uff09 \u5c06\u4e8c\u7ef4\u4f4d\u7f6e\u8f6c\u6362\u4e3a\u5355\u4e2a\u6570\u5b57\uff0c\u7136\u540e\u4f7f\u7528\u5e38\u89c4 B \u6811\u7d22\u5f15\\(^{[15]}\\)</li> <li>\u7279\u6b8a\u5316\u7684\u7a7a\u95f4\u7d22\u5f15\uff0c\u4f8b\u5982 R \u6811\uff1b</li> </ul> <p>\u591a\u7ef4\u7d22\u5f15\u548c\u591a\u4e2a\u5217\u7d22\u5f15\u7684\u533a\u522b\uff1a</p> <ul> <li>\u591a\u4e2a\u5217\u7d22\u5f15\u6307\u7684\u662f\u6bcf\u4e2a\u5217\u90fd\u5355\u72ec\u5efa\u7acb\u7d22\u5f15\uff0c\u7531\u4f18\u5316\u5668\u51b3\u5b9a\u662f\u5426\u91c7\u7528\u7d22\u5f15\u5408\u5e76\u7684\u7b56\u7565\uff1b</li> <li>MySQL 5.0 \u4e4b\u540e\u624d\u652f\u6301\u201d\u7d22\u5f15\u5408\u5e76\u201c\u7684\u7b56\u7565\uff0c\u4f7f\u7528\u591a\u4e2a\u5355\u5217\u7d22\u5f15\u901a\u8fc7\u5e76\u96c6/\u4ea4\u96c6\u6765\u9009\u62e9\u7b26\u5408\u7684\u884c\uff1b</li> <li>\u591a\u7ef4\u7d22\u5f15\u6307\u7684\u662f\u4e00\u4e2a\u7d22\u5f15\u5305\u542b\u591a\u4e2a\u7ef4\u5ea6\u7684\u4fe1\u606f\uff0c\u7b49\u4ef7\u4e8e\u590d\u5408\u7d22\u5f15\u7684\u65e0\u5e8f\u7248\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_8","title":"\u5168\u6587\u641c\u7d22\u548c\u6a21\u7cca\u7d22\u5f15","text":"<p>\u641c\u7d22\u7c7b\u4f3c\u7684\u952e\uff0c\u5982\u62fc\u5199\u9519\u8bef\u7684\u5355\u8bcd\uff0c\u5355\u8bcd\u7684\u540c\u4e49\u8bcd\uff0c\u5ffd\u7565\u5355\u8bcd\u7684\u8bed\u6cd5\u53d8\u4f53\uff0c\u641c\u7d22\u5728\u76f8\u540c\u6587\u6863\u4e2d\u7684\u8fd1\u4e49\u8bcd\uff0c\u5e76\u4e14\u652f\u6301\u5404\u79cd\u5176\u4ed6\u53d6\u51b3\u4e8e\u6587\u672c\u7684\u8bed\u8a00\u5206\u6790\u529f\u80fd\u3002</p> <p>Lucene \u80fd\u591f\u5728\u4e00\u5b9a\u7684\u7f16\u8f91\u8ddd\u79bb\u5185\u641c\u7d22\u6587\u672c\\(^{[17]}\\)\uff0c\u5185\u5b58\u4e2d\u7684\u7d22\u5f15\u662f\u952e\u4e2d\u5b57\u7b26\u7684\u6709\u9650\u72b6\u6001\u81ea\u52a8\u673a\uff0c\u7c7b\u4f3c\u4e8e trie\\(^{[18]}\\)\u3002\u8fd9\u4e2a\u81ea\u52a8\u673a\u53ef\u4ee5\u8f6c\u6362\u6210 Levenshtein \u81ea\u52a8\u673a\uff0c\u5b83\u652f\u6301\u5728\u7ed9\u5b9a\u7684\u7f16\u8f91\u8ddd\u79bb\u5185\u6709\u6548\u5730\u641c\u7d22\u5355\u8bcd\\(^{[19]}\\)\u3002</p> <p>\u5176\u4ed6\u7684\u6a21\u7cca\u641c\u7d22\u6280\u672f\u6b63\u671d\u7740\u6587\u6863\u5206\u7c7b\u548c\u673a\u5668\u5b66\u4e60\u7684\u65b9\u5411\u53d1\u5c55\u3002\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u9605\u4fe1\u606f\u68c0\u7d22\u6559\u79d1\u4e66\\(^{[20]}\\)\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_9","title":"\u5185\u5b58\u4e2d\u5b58\u50a8\u4e00\u5207","text":"<p>\u5982\u679c \u975e\u6613\u5931\u6027\u5b58\u50a8\u5668\uff08non-volatile memory, NVM\uff09 \u6280\u672f\u5f97\u5230\u66f4\u5e7f\u6cdb\u7684\u5e94\u7528\uff0c\u53ef\u80fd\u8fd8\u9700\u8981\u8fdb\u4e00\u6b65\u6539\u53d8\u5b58\u50a8\u5f15\u64ce\u8bbe\u8ba1\\({[23]}\\)\u3002</p> <p>\u76ee\u524d\u4e3a\u6b62\u8ba8\u8bba\u7684\u6570\u636e\u7ed3\u6784\u90fd\u662f\u5bf9\u786c\u76d8\u9650\u5236\u7684\u5e94\u5bf9 \uff1a</p> <ul> <li>\u5bf9\u4e8e\u78c1\u6027\u786c\u76d8\u548c\u56fa\u6001\u786c\u76d8\uff0c\u5982\u679c\u8981\u5728\u8bfb\u53d6\u548c\u5199\u5165\u65f6\u83b7\u5f97\u826f\u597d\u6027\u80fd\uff0c\u5219\u9700\u8981\u7cbe\u5fc3\u5730\u5b89\u6392\u786c\u76d8\u4e0a\u7684\u6570\u636e\u5e03\u5c40\uff1b</li> <li>\u786c\u76d8\u6709\u4e24\u4e2a\u663e\u8457\u7684\u4f18\u70b9\uff1a\u5b83\u4eec\u662f\u6301\u4e45\u7684\uff08\u5185\u5bb9\u5728\u7535\u6e90\u5173\u95ed\u65f6\u4e0d\u4f1a\u4e22\u5931\uff09\uff0c\u5e76\u4e14\u6bcf GB \u7684\u6210\u672c\u6bd4 RAM \u4f4e\u3002</li> </ul> <p>\u968f\u7740\u5185\u5b58\u53d8\u5f97\u66f4\u4fbf\u5b9c\uff0c\u6bcf GB \u6210\u672c\u88ab\u644a\u8584\uff0c\u5bfc\u81f4\u4e86\u5185\u5b58\u6570\u636e\u5e93\u7684\u53d1\u5c55\u3002</p> <p>\u5185\u5b58\u6570\u636e\u5e93\uff1a</p> <ul> <li> <p>\u7f13\u5b58\u7c7b\u578b\u7684 key-value \u5b58\u50a8\uff08ru Memcached\uff09\uff0c\u5bf9\u4e8e\u673a\u5668\u91cd\u542f\u5bfc\u81f4\u7684\u6570\u636e\u4e22\u5931\u662f\u53ef\u4ee5\u63a5\u6536\u7684\uff1a</p> </li> <li> <p>\u6301\u4e45\u5316\u7684\u5185\u5b58\u6570\u636e\u5e93\uff1a\u7279\u6b8a\u7684\u786c\u4ef6\uff08\u4f8b\u5982\u7535\u6c60\u4f9b\u7535\u7684 RAM\uff09\uff1b\u5c06\u66f4\u6539\u8bb0\u5f55\u5199\u5165\u78c1\u76d8\uff1b\u5feb\u7167\u5b9a\u671f\u5199\u5165\u78c1\u76d8\uff1b</p> </li> <li>Redis \u548c Couchbase \u901a\u8fc7\u5f02\u6b65\u5199\u5165\u78c1\u76d8\u63d0\u4f9b\u8f83\u5f31\u7684\u6301\u4e45\u6027\uff0cRedis \u7684 AOF \u53ef\u914d\u7f6e\u652f\u6301\u540c\u6b65\u5199\u56de\u78c1\u76d8\uff1b</li> </ul> <p>\u5185\u5b58\u6570\u636e\u5e93\u7684\u6027\u80fd\u4f18\u52bf\u5e76\u4e0d\u662f\u56e0\u4e3a\u5b83\u4eec\u4e0d\u9700\u8981\u4ece\u786c\u76d8\u8bfb\u53d6\u7684\u4e8b\u5b9e\uff1a</p> <ul> <li>\u64cd\u4f5c\u7cfb\u7edf\u5728\u5185\u5b58\u4e2d\u7f13\u5b58\u4e86\u6700\u8fd1\u4f7f\u7528\u7684\u786c\u76d8\u5757\uff0c\u53ea\u8981\u5185\u5b58\u8db3\u591f\u5373\u4f7f\u662f\u57fa\u4e8e\u786c\u76d8\u7684\u5b58\u50a8\u5f15\u64ce\u4e5f\u53ef\u80fd\u6c38\u8fdc\u4e0d\u9700\u8981\u4ece\u786c\u76d8\u8bfb\u53d6\uff1b</li> <li>\u5728\u4e8e\u8282\u7701\u4e86\u5c06\u5185\u5b58\u6570\u636e\u7ed3\u6784\u7f16\u7801\u4e3a\u786c\u76d8\u6570\u636e\u7ed3\u6784\u7684\u5f00\u9500\\(^{[21]}\\)\uff1b</li> </ul> <p>\u5185\u5b58\u6570\u636e\u5e93\u7684\u5176\u5b83\u4f18\u52bf\uff1a</p> <ul> <li>\u63d0\u4f9b\u96be\u4ee5\u7528\u57fa\u4e8e\u786c\u76d8\u7684\u7d22\u5f15\u5b9e\u73b0\u7684\u6570\u636e\u6a21\u578b\uff0c\u5982 Redis \u7684\u5404\u79cd\u6570\u636e\u7ed3\u6784\uff08\u4f18\u5148\u7ea7\u961f\u5217\uff0c\u96c6\u5408\u7b49\uff09\uff1b</li> </ul> <p>\u53cd\u5185\u5b58\uff08anti-caching\uff09\u65b9\u6cd5\\(^{[22]}\\)\uff1a\u5185\u5b58\u6570\u636e\u5e93\u4f53\u7cfb\u7ed3\u6784\u53ef\u4ee5\u6269\u5c55\u5230\u652f\u6301\u6bd4\u53ef\u7528\u5185\u5b58\u66f4\u5927\u7684\u6570\u636e\u96c6\uff0c\u800c\u4e0d\u5fc5\u91cd\u65b0\u91c7\u7528\u4ee5\u786c\u76d8\u4e3a\u4e2d\u5fc3\u7684\u4f53\u7cfb\u7ed3\u6784</p> <ul> <li>\u5728\u5185\u5b58\u4e0d\u8db3\u7684\u60c5\u51b5\u4e0b\u5c06\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u6570\u636e\u4ece\u5185\u5b58\u8f6c\u79fb\u5230\u786c\u76d8\uff0c\u5e76\u5728\u5c06\u6765\u518d\u6b21\u8bbf\u95ee\u65f6\u5c06\u5176\u91cd\u65b0\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff1b</li> <li>\u6570\u636e\u5e93\u53ef\u4ee5\u6bd4\u64cd\u4f5c\u7cfb\u7edf\u66f4\u6709\u6548\u5730\u7ba1\u7406\u5185\u5b58\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u6309\u5355\u4e2a\u8bb0\u5f55\u7684\u7c92\u5ea6\u5de5\u4f5c\uff0c\u800c\u4e0d\u662f\u6574\u4e2a\u5185\u5b58\u9875\u9762\uff1b</li> <li>\u9700\u8981\u7d22\u5f15\u80fd\u5b8c\u5168\u653e\u5165\u5185\u5b58\u4e2d\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_10","title":"\u4e8b\u52a1\u5904\u7406\u4e0e\u5206\u6790\u5904\u7406","text":"<p>\u4e8b\u52a1\u4e0d\u4e00\u5b9a\u5177\u6709 ACID\uff08\u539f\u5b50\u6027\uff0c\u4e00\u81f4\u6027\uff0c\u9694\u79bb\u6027\u548c\u6301\u4e45\u6027\uff09\u5c5e\u6027\u3002\u4e8b\u52a1\u5904\u7406\u53ea\u662f\u610f\u5473\u7740\u5141\u8bb8\u5ba2\u6237\u7aef\u8fdb\u884c\u4f4e\u5ef6\u8fdf\u7684\u8bfb\u53d6\u548c\u5199\u5165 \u2014\u2014 \u800c\u4e0d\u662f\u53ea\u80fd\u5b9a\u671f\u8fd0\u884c\uff08\u4f8b\u5982\u6bcf\u5929\u4e00\u6b21\uff09\u7684\u6279\u5904\u7406\u4f5c\u4e1a\u3002</p> <p>\u5728\u7ebf\u4e8b\u52a1\u5904\u7406\uff08OLTP, OnLine Transaction Processing\uff09</p> <ul> <li>\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u4f7f\u7528\u7d22\u5f15\u901a\u8fc7\u67d0\u4e2a\u952e\u627e\u5c11\u91cf\u8bb0\u5f55\uff0c\u6839\u636e\u7528\u6237\u7684\u8f93\u5165\u6765\u63d2\u5165\u6216\u66f4\u65b0\u8bb0\u5f55\u3002</li> </ul> <p>\u5728\u7ebf\u5206\u6790\u5904\u7406\uff08OLAP, OnLine Analytic Processing\uff09</p> <ul> <li>\u6570\u636e\u5206\u6790\u67e5\u8be2\u9700\u8981\u626b\u63cf\u5927\u91cf\u8bb0\u5f55\uff0c\u6bcf\u4e2a\u8bb0\u5f55\u53ea\u8bfb\u53d6\u51e0\u5217\uff0c\u5e76\u8ba1\u7b97\u6c47\u603b\u7edf\u8ba1\u4fe1\u606f\uff08\u5982\u8ba1\u6570\u3001\u603b\u548c\u6216\u5e73\u5747\u503c\uff09\uff0c\u800c\u4e0d\u662f\u5c06\u539f\u59cb\u6570\u636e\u8fd4\u56de\u7ed9\u7528\u6237</li> <li>\u67e5\u8be2\u901a\u5e38\u7531\u4e1a\u52a1\u5206\u6790\u5e08\u7f16\u5199\uff0c\u5e76\u63d0\u4f9b\u62a5\u544a\u4ee5\u5e2e\u52a9\u516c\u53f8\u7ba1\u7406\u5c42\u505a\u51fa\u66f4\u597d\u7684\u51b3\u7b56\uff08\u5546\u4e1a\u667a\u80fd\uff09</li> </ul> <p>\u8868 3-1 \u6bd4\u8f83\u4e8b\u52a1\u5904\u7406\u548c\u5206\u6790\u7cfb\u7edf\u7684\u7279\u70b9</p> \u5c5e\u6027 \u4e8b\u52a1\u5904\u7406\u7cfb\u7edf OLTP \u5206\u6790\u7cfb\u7edf OLAP \u4e3b\u8981\u8bfb\u53d6\u6a21\u5f0f \u67e5\u8be2\u5c11\u91cf\u8bb0\u5f55\uff0c\u6309\u952e\u8bfb\u53d6 \u5728\u5927\u6279\u91cf\u8bb0\u5f55\u4e0a\u805a\u5408 \u4e3b\u8981\u5199\u5165\u6a21\u5f0f \u968f\u673a\u8bbf\u95ee\uff0c\u5199\u5165\u8981\u6c42\u4f4e\u5ef6\u65f6 \u6279\u91cf\u5bfc\u5165\uff08ETL\uff09\u6216\u8005\u4e8b\u4ef6\u6d41 \u4e3b\u8981\u7528\u6237 \u7ec8\u7aef\u7528\u6237\uff0c\u901a\u8fc7 Web \u5e94\u7528 \u5185\u90e8\u6570\u636e\u5206\u6790\u5e08\uff0c\u7528\u4e8e\u51b3\u7b56\u652f\u6301 \u5904\u7406\u7684\u6570\u636e \u6570\u636e\u7684\u6700\u65b0\u72b6\u6001\uff08\u5f53\u524d\u65f6\u95f4\u70b9\uff09 \u968f\u65f6\u95f4\u63a8\u79fb\u7684\u5386\u53f2\u4e8b\u4ef6 \u6570\u636e\u96c6\u5c3a\u5bf8 GB ~ TB TB ~ PB <p>\u8d77\u521d\uff0c\u4e8b\u52a1\u5904\u7406\u548c\u5206\u6790\u67e5\u8be2\u4f7f\u7528\u4e86\u76f8\u540c\u7684\u6570\u636e\u5e93\uff08SQL\u652f\u6301\uff09\u3002\u572820\u4e16\u7eaa80\u5e74\u4ee3\u672b\u548c90\u5e74\u4ee3\u521d\u671f\uff0c\u4f01\u4e1a\u6709\u505c\u6b62\u4f7f\u7528 OLTP \u7cfb\u7edf\u8fdb\u884c\u5206\u6790\u7684\u8d8b\u52bf\uff0c\u8f6c\u800c\u5728\u5355\u72ec\u7684\u6570\u636e\u5e93\u4e0a\u8fd0\u884c\u5206\u6790\u3002\u8fd9\u4e2a\u5355\u72ec\u7684\u6570\u636e\u5e93\u88ab\u79f0\u4e3a \u6570\u636e\u4ed3\u5e93\uff08data warehouse\uff09\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_11","title":"\u6570\u636e\u4ed3\u5e93","text":"<p>\u6570\u636e\u4ed3\u5e93\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u6570\u636e\u5e93\uff0c\u5206\u6790\u4eba\u5458\u53ef\u4ee5\u67e5\u8be2\u4ed6\u4eec\u60f3\u8981\u7684\u5185\u5bb9\u800c\u4e0d\u5f71\u54cd OLTP \u64cd\u4f5c\\(^{[24]}\\)</p> <ul> <li>\u4f01\u4e1a\u53ef\u80fd\u6709\u51e0\u5341\u4e2a\u4e0d\u540c\u7684\u4ea4\u6613\u5904\u7406\u7cfb\u7edf\uff0c\u8fd9\u4e9bOLTP \u7cfb\u7edf\u5f80\u5f80\u5bf9\u4e1a\u52a1\u8fd0\u884c\u81f3\u5173\u91cd\u8981\uff0c\u56e0\u800c\u901a\u5e38\u4f1a\u8981\u6c42 \u9ad8\u53ef\u7528 \u4e0e \u4f4e\u5ef6\u8fdf</li> </ul> <p>ETL\uff08\u62bd\u53d6 - \u8f6c\u6362 - \u52a0\u8f7d\uff09\uff1a\u6570\u636e\u4ed3\u5e93\u5305\u542b\u516c\u53f8\u5404\u79cd OLTP \u7cfb\u7edf\u4e2d\u6240\u6709\u7684\u53ea\u8bfb\u6570\u636e\u526f\u672c</p> <ul> <li>\u4ece OLTP \u6570\u636e\u5e93\u4e2d\u63d0\u53d6\u6570\u636e\uff08\u4f7f\u7528\u5b9a\u671f\u7684\u6570\u636e\u8f6c\u50a8\u6216\u8fde\u7eed\u7684\u66f4\u65b0\u6d41\uff09\uff0c\u8f6c\u6362\u6210\u9002\u5408\u5206\u6790\u7684\u6a21\u5f0f\uff0c\u6e05\u7406\u5e76\u52a0\u8f7d\u5230\u6570\u636e\u4ed3\u5e93\u4e2d\u3002</li> </ul> <p></p> <p>\u4e8b\u5b9e\u8bc1\u660e\uff0c\u672c\u7ae0\u524d\u534a\u90e8\u5206\u8ba8\u8bba\u7684\u7d22\u5f15\u7b97\u6cd5\u9002\u5408 OLTP \uff0c\u4f46\u4e0d\u64c5\u957f\u5904\u7406\u5206\u6790\u67e5\u8be2\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#oltp","title":"OLTP\u6570\u636e\u5e93\u548c\u6570\u636e\u4ed3\u5e93\u4e4b\u95f4\u7684\u5dee\u5f02","text":"<p>\u6570\u636e\u4ed3\u5e93\u7684\u6570\u636e\u6a21\u578b\u901a\u5e38\u662f\u5173\u7cfb\u578b\u7684\uff0c\u56e0\u4e3a SQL \u901a\u5e38\u5f88\u9002\u5408\u5206\u6790\u67e5\u8be2</p> <ul> <li>\u6709\u8bb8\u591a\u56fe\u5f62\u6570\u636e\u5206\u6790\u5de5\u5177\uff08BI\uff09\u53ef\u4ee5\u751f\u6210 SQL \u67e5\u8be2\uff0c\u53ef\u89c6\u5316\u7ed3\u679c\uff0c\u5e76\u5141\u8bb8\u5206\u6790\u4eba\u5458\u63a2\u7d22\u6570\u636e\uff08\u901a\u8fc7\u4e0b\u94bb\u3001\u5207\u7247\u548c\u5207\u5757\u7b49\u64cd\u4f5c\uff09\u3002</li> </ul> <p>\u6570\u636e\u4ed3\u5e93\u548c OLTP \u6570\u636e\u5e93\u90fd\u662f SQL \u63a5\u53e3\uff0c\u4f46\u662f\u5185\u90e8\u770b\u8d77\u6765\u53ef\u80fd\u5b8c\u5168\u4e0d\u540c\uff0c\u56e0\u4e3a\u5b83\u4eec\u9488\u5bf9\u975e\u5e38\u4e0d\u540c\u7684\u67e5\u8be2\u6a21\u5f0f\u8fdb\u884c\u4e86\u4f18\u5316</p> <ul> <li>\u8bb8\u591a\u6570\u636e\u5e93\u4f9b\u5e94\u5546\u90fd\u53ea\u662f\u91cd\u70b9\u652f\u6301\u4e8b\u52a1\u5904\u7406\u8d1f\u8f7d\u548c\u5206\u6790\u5de5\u4f5c\u8d1f\u8f7d\u8fd9\u4e24\u8005\u4e2d\u7684\u4e00\u4e2a\uff0c\u800c\u4e0d\u662f\u90fd\u652f\u6301\uff1b</li> </ul> <p>\u6700\u8fd1\uff082012-2020\uff09\uff0c\u5927\u91cf\u7684\u5f00\u6e90 SQL-on-Hadoop \u9879\u76ee\u5df2\u7ecf\u51fa\u73b0\uff0c\u5b83\u4eec\u8fd8\u5f88\u5e74\u8f7b\uff0c\u4f46\u662f\u6b63\u5728\u4e0e\u5546\u4e1a\u6570\u636e\u4ed3\u5e93\u7cfb\u7edf\u7ade\u4e89\uff0c\u5305\u62ec Apache Hive\u3001Spark SQL\u3001Cloudera Impala\u3001Facebook Presto \u548c Apache Drill\\(^{[25,26]}\\)\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#htap","title":"HTAP","text":"<p>HTAP\uff08Hybrid Transaction / Analytical Processing\uff0c\u6df7\u5408\u4e8b\u52a1\u5206\u6790\u5904\u7406\uff092014 \u5e74\u88ab\u9996\u6b21\u63d0\u51fa\u5e76\u8d4b\u4e88\u660e\u786e\u7684\u5b9a\u4e49\uff1a\u5373\u540c\u65f6\u652f\u6301 OLTP \u548c OLAP \u573a\u666f\u662f\u3002</p> <ul> <li>\u5728\u4e00\u4efd\u6570\u636e\u4e0a\u4fdd\u8bc1\u4e8b\u52a1\u7684\u540c\u65f6\u652f\u6301\u5b9e\u65f6\u5206\u6790\uff0c\u7701\u53bb\u8d39\u65f6\u7684 ETL \u8fc7\u7a0b\uff1b</li> <li>\u963f\u91cc\u7684 OceanBase/PolarDB\uff0cPingCap\u5f00\u6e90\u7684TiDB \\(^{[27]}\\)\u7b49\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_12","title":"\u661f\u578b\u548c\u96ea\u82b1\u578b\uff1a\u5206\u6790\u7684\u6a21\u5f0f","text":"<p>\u5728\u4e8b\u52a1\u5904\u7406\u9886\u57df\u4e2d\u4f7f\u7528\u4e86\u5927\u91cf\u4e0d\u540c\u7684\u6570\u636e\u6a21\u578b\uff0c\u800c\u5728\u5206\u6790\u578b\u4e1a\u52a1\u4e2d\uff0c\u6570\u636e\u6a21\u578b\u7684\u591a\u6837\u6027\u5219\u5c11\u5f97\u591a\u3002</p> <ul> <li>\u8bb8\u591a\u6570\u636e\u4ed3\u5e93\u90fd\u4ee5\u76f8\u5f53\u516c\u5f0f\u5316\u7684\u65b9\u5f0f\u4f7f\u7528\uff0c\u88ab\u79f0\u4e3a\u661f\u578b\u6a21\u5f0f\uff08\u4e5f\u79f0\u4e3a\u7ef4\u5ea6\u5efa\u6a21\\(^{[28]}\\)\uff09</li> </ul> <p>\u6a21\u5f0f\u7684\u4e2d\u5fc3\u662f\u4e00\u4e2a\u6240\u8c13\u7684\u4e8b\u5b9e\u8868\uff0c\u5982\u4e0b\u4f8b\u6240\u793a\uff08\u98df\u54c1\u96f6\u552e\u5546\uff09\uff1a</p> <ul> <li>\u4e8b\u5b9e\u8868\u7684\u6bcf\u4e00\u884c\u4ee3\u8868\u5728\u7279\u5b9a\u65f6\u95f4\u53d1\u751f\u7684\u4e8b\u4ef6\uff08\u8fd9\u91cc\uff0c\u6bcf\u4e00\u884c\u4ee3\u8868\u5ba2\u6237\u8d2d\u4e70\u7684\u4ea7\u54c1\uff09</li> <li>\u4e8b\u5b9e\u8868\u4f1a\u5f88\u5927\uff0c\u82f9\u679c\u3001\u6c83\u5c14\u739b\u7b49\u5927\u4f01\u4e1a\u5728\u5176\u6570\u636e\u4ed3\u5e93\u4e2d\u53ef\u80fd\u6709\u51e0\u5341 PB \u7684\u4ea4\u6613\u5386\u53f2\uff1b</li> <li>\u4e8b\u5b9e\u8868\u4e2d\u7684\u5176\u4ed6\u5217\u662f\u5bf9\u5176\u4ed6\u8868\uff08\u79f0\u4e3a\u7ef4\u5ea6\u8868\uff09\u7684\u5916\u952e\u5f15\u7528\uff1a</li> <li>\u7ef4\u5ea6\u4ee3\u8868\u4e8b\u4ef6\u53d1\u751f\u7684\u5bf9\u8c61\u3001\u5185\u5bb9\u3001\u5730\u70b9\u3001\u65f6\u95f4\u3001\u65b9\u5f0f\u548c\u539f\u56e0</li> <li>\u8868\u683c\u901a\u5e38\u975e\u5e38\u5bbd\uff1a\u4e8b\u5b9e\u8868\u901a\u5e38\u6709 100 \u5217\u4ee5\u4e0a\uff0c\u6709\u65f6\u751a\u81f3\u6709\u6570\u767e\u5217\uff1b\u7ef4\u5ea6\u8868\u4e5f\u53ef\u4ee5\u662f\u975e\u5e38\u5bbd\u7684\uff0c\u56e0\u4e3a\u5b83\u4eec\u5305\u62ec\u4e86\u6240\u6709\u53ef\u80fd\u4e0e\u5206\u6790\u76f8\u5173\u7684\u5143\u6570\u636e</li> </ul> <p></p> <p>\u661f\u578b\u6a21\u5f0f\uff1a</p> <ul> <li>\u5bf9\u8868\u4e4b\u95f4\u7684\u5173\u7cfb\u8fdb\u884c\u53ef\u89c6\u5316\u65f6\uff0c\u4e8b\u5b9e\u8868\u5728\u4e2d\u95f4\uff0c\u88ab\u7ef4\u5ea6\u8868\u5305\u56f4\uff0c\u4e0e\u8fd9\u4e9b\u8868\u7684\u8fde\u63a5\u5c31\u50cf\u661f\u661f\u7684\u5149\u8292\u3002</li> </ul> <p>\u96ea\u82b1\u6a21\u5f0f\uff1a</p> <ul> <li>\u7ef4\u5ea6\u88ab\u8fdb\u4e00\u6b65\u5206\u89e3\u4e3a\u5b50\u7ef4\u5ea6\uff0c\u5982\u54c1\u724c\u548c\u4ea7\u54c1\u7c7b\u522b\u53ef\u80fd\u6709\u5355\u72ec\u7684\u8868\u683c\uff0c\u5e76\u4e14 <code>dim_product</code> \u8868\u683c\u4e2d\u7684\u6bcf\u4e00\u884c\u90fd\u53ef\u4ee5\u5c06\u54c1\u724c\u548c\u7c7b\u522b\u4f5c\u4e3a\u5916\u952e\u5f15\u7528</li> </ul> <p>\u96ea\u82b1\u6a21\u5f0f\u6bd4\u661f\u5f62\u6a21\u5f0f\u66f4\u89c4\u8303\u5316\uff0c\u4f46\u662f\u661f\u5f62\u6a21\u5f0f\u901a\u5e38\u662f\u9996\u9009\uff0c\u56e0\u4e3a\u5206\u6790\u5e08\u4f7f\u7528\u5b83\u66f4\u7b80\u5355\\(^{[28]}\\)\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_13","title":"\u5217\u5f0f\u5b58\u50a8","text":"<p>\u5982\u679c\u4e8b\u5b9e\u8868\u4e2d\u6709\u4e07\u4ebf\u884c\u548c\u6570 PB \u7684\u6570\u636e\uff0c\u90a3\u4e48\u9ad8\u6548\u5730\u5b58\u50a8\u548c\u67e5\u8be2\u5b83\u4eec\u5c31\u6210\u4e3a\u4e00\u4e2a\u5177\u6709\u6311\u6218\u6027\u7684\u95ee\u9898\u3002\u7ef4\u5ea6\u8868\u901a\u5e38\u8981\u5c0f\u5f97\u591a\uff08\u6570\u767e\u4e07\u884c\uff09\u3002</p> <p>\u5c3d\u7ba1\u4e8b\u5b9e\u8868\u901a\u5e38\u8d85\u8fc7 100 \u5217\uff0c\u4f46\u5178\u578b\u7684\u6570\u636e\u4ed3\u5e93\u67e5\u8be2\u4e00\u6b21\u53ea\u4f1a\u8bbf\u95ee\u5176\u4e2d 4 \u4e2a\u6216 5 \u4e2a\u5217\uff08 \u201c<code>SELECT *</code>\u201d \u67e5\u8be2\u5f88\u5c11\u7528\u4e8e\u5206\u6790\uff09\\(^{[29]}\\)\u3002</p> <ul> <li>\u4e0b\u9762\u7684\u5206\u6790SQL\u793a\u4f8b\u8bbf\u95ee\u5927\u91cf\u7684\u884c\uff08\u5728 2013 \u5e74\u4e2d\u6240\u6709\u8d2d\u4e70\u4e86\u6c34\u679c\u6216\u7cd6\u679c\u7684\u8bb0\u5f55\uff09\uff0c\u4f46\u53ea\u9700\u8bbf\u95ee <code>fact_sales</code> \u8868\u7684\u4e09\u5217\uff1a<code>date_key, product_sk, quantity</code>\u3002\u8be5\u67e5\u8be2\u5ffd\u7565\u4e86\u6240\u6709\u5176\u4ed6\u7684\u5217\u3002</li> </ul> <p>\u4f8b 3-1 \u5206\u6790\u4eba\u4eec\u662f\u5426\u66f4\u503e\u5411\u4e8e\u5728\u4e00\u5468\u7684\u67d0\u4e00\u5929\u8d2d\u4e70\u65b0\u9c9c\u6c34\u679c\u6216\u7cd6\u679c</p> <pre><code>SELECT\n  dim_date.weekday,\n  dim_product.category,\n  SUM(fact_sales.quantity) AS quantity_sold\nFROM fact_sales\n  JOIN dim_date ON fact_sales.date_key = dim_date.date_key\n  JOIN dim_product ON fact_sales.product_sk = dim_product.product_sk\nWHERE\n  dim_date.year = 2013 AND\n  dim_product.category IN ('Fresh fruit', 'Candy')\nGROUP BY\n  dim_date.weekday, dim_product.category;\n</code></pre> <p>\u9762\u5411\u884c\u7684\u5b58\u50a8\u5f15\u64ce\u4ecd\u7136\u9700\u8981\u5c06\u6240\u6709\u8fd9\u4e9b\u884c\uff08\u6bcf\u4e2a\u5305\u542b\u8d85\u8fc7 100 \u4e2a\u5c5e\u6027\uff09\u4ece\u786c\u76d8\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u89e3\u6790\u5b83\u4eec\uff0c\u5e76\u8fc7\u6ee4\u6389\u90a3\u4e9b\u4e0d\u7b26\u5408\u8981\u6c42\u7684\u5c5e\u6027\uff0c\u53ef\u80fd\u4f1a\u6d88\u8017\u5f88\u591a\u65f6\u95f4\u3002</p> <p>\u5217\u5f0f\u5b58\u50a8\uff1a\u5982 Parquet\\(^{[30]}\\)\uff0cCarbonData \u7b49\u683c\u5f0f</p> <ul> <li>\u5c06\u6765\u81ea\u6bcf\u4e00\u5217\u7684\u6240\u6709\u503c\u5b58\u50a8\u5728\u4e00\u8d77\uff0c\u67e5\u8be2\u53ea\u9700\u8981\u8bfb\u53d6\u548c\u89e3\u6790\u67e5\u8be2\u4e2d\u4f7f\u7528\u7684\u90a3\u4e9b\u5217\uff1b</li> <li>\u5217\u5f0f\u5b58\u50a8\u5e03\u5c40\u4f9d\u8d56\u4e8e\u6bcf\u4e2a\u5217\u6587\u4ef6\u5305\u542b\u76f8\u540c\u987a\u5e8f\u7684\u884c\uff0c\u8981\u5b8c\u6574\u7684\u884c\uff0c\u9700\u8981\u4ece\u6bcf\u4e2a\u5355\u72ec\u7684\u5217\u6587\u4ef6\u4e2d\u83b7\u53d6\u7b2c 23 \u9879\u5e76\u7ec4\u6210\u884c\uff1b</li> </ul> <p></p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_14","title":"\u5217\u538b\u7f29","text":"<p>\u9664\u4e86\u4ec5\u4ece\u786c\u76d8\u52a0\u8f7d\u67e5\u8be2\u6240\u9700\u7684\u5217\u4ee5\u5916\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u538b\u7f29\u6570\u636e\u6765\u8fdb\u4e00\u6b65\u964d\u4f4e\u5bf9\u786c\u76d8\u541e\u5410\u91cf\u7684\u9700\u6c42\uff1a</p> <ul> <li>\u6839\u636e\u5217\u4e2d\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u538b\u7f29\u6280\u672f\\(^{[31]}\\)\uff0c\u5982\u4f4d\u56fe\u7f16\u7801\u3001\u6e38\u7a0b\u7f16\u7801\u7b49\uff08\u89c1\u4e0b\u56fe\u793a\u4f8b\uff09</li> <li>\u4f4d\u56fe\u7f16\u7801\uff1a\u4e00\u5217\u4e2d\u4e0d\u540c\u503c\u7684\u6570\u91cf\uff08n\uff09\u4e0e\u884c\u6570\u76f8\u6bd4\u8981\u5c0f\u5f97\u591a\uff0c\u6bcf\u4e2a\u4e0d\u540c\u503c\u5bf9\u5e94\u4e00\u4e2a\u4f4d\u56fe\uff0c\u6bcf\u884c\u5bf9\u5e94\u4e00\u4e2a\u6bd4\u7279\u4f4d</li> <li>\u6e38\u7a0b\u7f16\u7801\uff1a\u5982\u679c n \u66f4\u5927\uff0c\u5927\u90e8\u5206\u4f4d\u56fe\u4e2d\u5c06\u4f1a\u6709\u5f88\u591a\u7684\u96f6\uff0c\u4f4d\u56fe\u53ef\u4ee5\u53e6\u5916\u518d\u8fdb\u884c\u6e38\u7a0b\u7f16\u7801</li> </ul> <p></p> <p>\u4f4d\u56fe\u7d22\u5f15\u975e\u5e38\u9002\u5408\u6570\u636e\u4ed3\u5e93\u4e2d\u5e38\u89c1\u7684\u5404\u79cd\u67e5\u8be2\uff1a\u901a\u8fc7\u4f4d\u56fe\u7684\u6309\u4f4d\u6216\uff08OR\uff09\u6216\u6309\u4f4d\u4e0e\uff08AND\uff09</p> <p>\u5217\u5f0f\u5b58\u50a8\u548c\u5217\u65cf</p> <p>Cassandra \u548c HBase \u6709\u4e00\u4e2a\u5217\u65cf\uff08column families\uff09\u7684\u6982\u5ff5\uff0c\u4ece Bigtable \u7ee7\u627f\\(^{[32]}\\)\uff0c\u4e3b\u8981\u662f\u9762\u5411\u884c</p> <ul> <li>\u5217\u65cf\u662f\u5355\u72ec\u5b58\u50a8\uff0c\u4f46\u5728\u6bcf\u4e2a\u5217\u65cf\u4e2d\uff0c\u5b83\u4eec\u5c06\u4e00\u884c\u4e2d\u7684\u6240\u6709\u5217\u4e0e\u884c\u952e\u4e00\u8d77\u5b58\u50a8\uff0c\u5e76\u4e14\u4e0d\u4f7f\u7528\u5217\u538b\u7f29\u3002</li> </ul> <p>\u5185\u5b58\u5e26\u5bbd\u548c\u77e2\u91cf\u5316\u5904\u7406</p> <p>\u9700\u8981\u626b\u63cf\u6570\u767e\u4e07\u884c\u7684\u6570\u636e\u4ed3\u5e93\u67e5\u8be2\u6765\u8bf4\uff0c\u74f6\u9888\u662f\u4ece\u786c\u76d8\u83b7\u53d6\u6570\u636e\u5230\u5185\u5b58\u7684\u5e26\u5bbd\uff0c\u6b64\u5916\u8fd8\u9700\u8981</p> <ul> <li>\u5229\u7528\u5185\u5b58\u5230 CPU \u7f13\u5b58\u7684\u5e26\u5bbd\uff0c\u907f\u514d CPU \u6307\u4ee4\u5904\u7406\u6d41\u6c34\u7ebf\u4e2d\u7684\u5206\u652f\u9884\u6d4b\u9519\u8bef\u548c\u95f2\u7f6e\u7b49\u5f85</li> <li>\u73b0\u4ee3 CPU \u4e0a\u4f7f\u7528\u5355\u6307\u4ee4\u591a\u6570\u636e\uff08SIMD\uff09\u6307\u4ee4\u6765\u52a0\u901f\u8fd0\u7b97\\(^{[33,34]}\\)</li> <li>\u77e2\u91cf\u5316\u5904\u7406\uff08vectorized processing\uff09\\(^{[31]}\\)\uff1a\u5217\u5f0f\u5b58\u50a8\u5e03\u5c40\u4e5f\u53ef\u4ee5\u6709\u6548\u5229\u7528 CPU \u5468\u671f</li> <li>\u5c06\u4e00\u6574\u5757\u538b\u7f29\u597d\u7684\u5217\u6570\u636e\u653e\u8fdb CPU \u7684 L1 \u7f13\u5b58\u4e2d\uff0c\u7136\u540e\u4ee5\u7d27\u5bc6\u7684\u5faa\u73af\uff08\u5373\u6ca1\u6709\u51fd\u6570\u8c03\u7528\uff09\u8fdb\u884c\u904d\u5386</li> <li>\u76f8\u6bd4\u4e8e\u6bcf\u6761\u8bb0\u5f55\u7684\u5904\u7406\u90fd\u9700\u8981\u5927\u91cf\u51fd\u6570\u8c03\u7528\u548c\u6761\u4ef6\u5224\u65ad\u7684\u4ee3\u7801\uff0cCPU \u6267\u884c\u8fd9\u6837\u4e00\u4e2a\u5faa\u73af\u8981\u5feb\u5f97\u591a</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_15","title":"\u5217\u5f0f\u5b58\u50a8\u4e2d\u7684\u6392\u5e8f\u987a\u5e8f","text":"<p>\u6570\u636e\u7684\u6392\u5e8f\u9700\u8981\u5bf9\u4e00\u6574\u884c\u7edf\u4e00\u64cd\u4f5c\uff0c\u5373\u4f7f\u662f\u6309\u5217\u5b58\u50a8\uff1a</p> <ul> <li>\u53ea\u6709\u660e\u786e\u4e00\u5217\u4e2d\u7684\u7b2c k \u9879\u4e0e\u53e6\u4e00\u5217\u4e2d\u7684\u7b2c k \u9879\u5c5e\u4e8e\u540c\u4e00\u884c\u7684\u60c5\u51b5\u4e0b\uff0c\u624d\u80fd\u91cd\u5efa\u51fa\u5b8c\u6574\u7684\u884c</li> </ul> <p>\u6309\u987a\u5e8f\u6392\u5e8f\u7684\u597d\u5904</p> <ul> <li> <p>\u52a0\u901f\u67e5\u8be2\uff1a\u53ea\u9700\u8981\u626b\u63cf\u7279\u5b9a\u8303\u56f4\u7684\u884c\uff0c\u65e0\u9700\u5168\u8868\u626b\u63cf\uff1b</p> </li> <li> <p>\u5e2e\u52a9\u538b\u7f29\u5217\uff1a\u6392\u5e8f\u4e4b\u540e\uff0c\u5c06\u4f1a\u5f97\u5230\u4e00\u4e2a\u76f8\u540c\u7684\u503c\u8fde\u7eed\u91cd\u590d\u591a\u6b21\u7684\u5e8f\u5217\uff0c\u53ef\u4ee5\u4f7f\u7528\u7b80\u5355\u7684\u6e38\u7a0b\u7f16\u7801\u53ef\u4ee5\u5c06\u8be5\u5217\u538b\u7f29\u3002</p> </li> </ul> <p>\u7b2c\u4e00\u4e2a\u6392\u5e8f\u952e\u7684\u538b\u7f29\u6548\u679c\u6700\u5f3a\uff0c\u7b2c\u4e8c\u548c\u7b2c\u4e09\u4e2a\u6392\u5e8f\u952e\u4f1a\u4f7f\u60c5\u51b5\u66f4\u590d\u6742\uff1a</p> <ul> <li>\u4e0d\u4f1a\u6709\u592a\u591a\u76f8\u90bb\u7684\u91cd\u590d\u503c\uff0c\u6392\u5e8f\u4f18\u5148\u7ea7\u66f4\u4f4e\u7684\u5217\u4ee5\u51e0\u4e4e\u968f\u673a\u7684\u987a\u5e8f\u51fa\u73b0\uff0c\u6240\u4ee5\u53ef\u80fd\u4e0d\u4f1a\u88ab\u538b\u7f29\u3002\u4f46\u5bf9\u524d\u51e0\u5217\u505a\u6392\u5e8f\u5728\u6574\u4f53\u4e0a\u4ecd\u7136\u662f\u6709\u597d\u5904\u3002</li> </ul> <p>\u51e0\u79cd\u4e0d\u540c\u7684\u6392\u5e8f\u987a\u5e8f</p> <ul> <li>\u7528\u4e0d\u540c\u6392\u5e8f\u65b9\u5f0f\u6765\u5b58\u50a8\u5197\u4f59\u6570\u636e\uff0c\u5728\u5904\u7406\u67e5\u8be2\u65f6\uff0c\u8c03\u7528\u6700\u9002\u5408\u67e5\u8be2\u6a21\u5f0f\u7684\u6392\u5e8f\u7248\u672c\uff1b</li> <li>\u7c7b\u4f3c\u4e8e\u5728\u4e00\u4e2a\u9762\u5411\u884c\u7684\u5b58\u50a8\u4e2d\u6709\u591a\u4e2a\u6b21\u7ea7\u7d22\u5f15\uff0c\u533a\u522b\u5728\u4e8e\u6b21\u7ea7\u7d22\u5f15\u53ea\u4fdd\u5b58\u6307\u9488\uff0c\u800c\u5217\u5f0f\u5b58\u50a8\u4e2d\u6ca1\u6709\u6307\u9488\uff0c\u53ea\u6709\u5305\u542b\u6570\u636e\u7684\u5217\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_16","title":"\u5199\u5165\u5217\u5f0f\u5b58\u50a8","text":"<p>\u5217\u5f0f\u5b58\u50a8\u3001\u538b\u7f29\u548c\u6392\u5e8f\u90fd\u6709\u52a9\u4e8e\u66f4\u5feb\u5730\u8bfb\u53d6\u8fd9\u4e9b\u67e5\u8be2\u3002\u7136\u800c\uff0c\u4ed6\u4eec\u7684\u7f3a\u70b9\u662f\u5199\u5165\u66f4\u52a0\u56f0\u96be\u3002</p> <p>\u4f7f\u7528 B \u6811\u7684\u5c31\u5730\u66f4\u65b0\u65b9\u6cd5\u5bf9\u4e8e\u538b\u7f29\u7684\u5217\u662f\u4e0d\u53ef\u80fd\u7684\uff1a</p> <ul> <li>\u60f3\u5728\u6392\u5e8f\u8868\u7684\u4e2d\u95f4\u63d2\u5165\u4e00\u884c\uff0c\u53ef\u80fd\u4e0d\u5f97\u4e0d\u91cd\u5199\u6240\u6709\u7684\u5217\u6587\u4ef6</li> </ul> <p>\u89e3\u51b3\u65b9\u6848\uff1aLSM \u6811\uff0c\u57fa\u672c\u4e0a\u662f Vertica \\(^{[35]}\\)\u6240\u505a\u7684</p> <ul> <li>\u6240\u6709\u7684\u5199\u64cd\u4f5c\u9996\u5148\u8fdb\u5165\u4e00\u4e2a\u5185\u5b58\u4e2d\u7684\u5b58\u50a8\uff08\u5df2\u6392\u5e8f\uff0c\u9762\u5411\u884c\u6216\u8005\u5217\u5b58\u50a8\u683c\u5f0f\u90fd\u53ef\u4ee5\uff09\uff1b</li> <li>\u79ef\u7d2f\u8db3\u591f\u7684\u5199\u5165\u6570\u636e\u65f6\uff0c\u5b83\u4eec\u5c06\u4e0e\u786c\u76d8\u4e0a\u7684\u5217\u6587\u4ef6\u5408\u5e76\uff0c\u5e76\u6279\u91cf\u5199\u5165\u65b0\u6587\u4ef6\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_17","title":"\u805a\u5408\uff1a\u6570\u636e\u7acb\u65b9\u4f53\u548c\u7269\u5316\u89c6\u56fe","text":"<p>\u7269\u5316\u805a\u5408\uff08materialized aggregates\uff09\uff1a\u6570\u636e\u4ed3\u5e93\u67e5\u8be2\u901a\u5e38\u6d89\u53ca\u805a\u5408\u51fd\u6570\uff0c\u5982 SUM\uff0cCOUNT\uff0cAVG\uff0cMIN\uff0cMAX\u7b49</p> <ul> <li>\u5c06\u4e00\u4e9b\u67e5\u8be2\u4f7f\u7528\u6700\u9891\u7e41\u7684\u8ba1\u6570\u6216\u603b\u548c\u7f13\u5b58\u8d77\u6765\uff0c\u907f\u514d\u6bcf\u6b21\u901a\u8fc7\u539f\u59cb\u6570\u636e\u91cd\u65b0\u8ba1\u7b97\uff1b</li> </ul> <p>\u7269\u5316\u89c6\u56fe\uff08Materialized View\uff09</p> <ul> <li>\u7269\u5316\u89c6\u56fe\u662f\u67e5\u8be2\u7ed3\u679c\u7684\u5b9e\u9645\u526f\u672c\uff0c\u4f1a\u88ab\u5199\u5165\u786c\u76d8\uff1b</li> <li>\u5f53\u5e95\u5c42\u6570\u636e\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u7269\u5316\u89c6\u56fe\u9700\u8981\u66f4\u65b0\uff0c\u6570\u636e\u5e93\u53ef\u4ee5\u81ea\u52a8\u5b8c\u6210\u8be5\u64cd\u4f5c\uff0c\u4f46\u662f\u8fd9\u6837\u7684\u66f4\u65b0\u4f7f\u5f97\u5199\u5165\u6210\u672c\u66f4\u9ad8\uff1b</li> </ul> <p>\u7269\u5316\u89c6\u56fe\u7684\u5e38\u89c1\u7279\u4f8b\u79f0\u4e3a\u6570\u636e\u7acb\u65b9\u4f53\u6216 OLAP \u7acb\u65b9\\(^{[36]}\\)\uff0c\u662f\u6309\u4e0d\u540c\u7ef4\u5ea6\u5206\u7ec4\u7684\u805a\u5408\u7f51\u683c\uff0c\u5982\u4e0b\u56fe\u662f\u6309\u7167\u65e5\u671f\u548c\u4ea7\u54c1\u4e24\u4e2a\u7ef4\u5ea6\uff1a</p> <ul> <li>\u5927\u591a\u6570\u6570\u636e\u4ed3\u5e93\u8bd5\u56fe\u4fdd\u7559\u5c3d\u53ef\u80fd\u591a\u7684\u539f\u59cb\u6570\u636e\uff0c\u5e76\u5c06\u805a\u5408\u6570\u636e\uff08\u5982\u6570\u636e\u7acb\u65b9\u4f53\uff09\u4ec5\u7528\u4f5c\u67d0\u4e9b\u67e5\u8be2\u7684\u6027\u80fd\u63d0\u5347\u624b\u6bb5</li> </ul> <p></p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/3_data_store_and_search.html#_18","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>Justin Sheehy and David Smith: \u201cBitcask: A Log-Structured Hash Table for Fast Key/Value Data,\u201d Basho Technologies, April 2010.</li> <li>Yinan Li, Bingsheng He, Robin Jun Yang, et al.: \u201cTree Indexing on Solid State Drives,\u201d Proceedings of the VLDB Endowment, volume 3, number 1, pages 1195\u20131206, September 2010.</li> <li>Goetz Graefe: \u201cModern B-Tree Techniques,\u201d Foundations and Trends in Databases, volume 3, number 4, pages 203\u2013402, August 2011. doi:10.1561/1900000028</li> <li>Patrick O'Neil, Edward Cheng, Dieter Gawlick, and Elizabeth O'Neil: \u201cThe Log-Structured Merge-Tree (LSM-Tree),\u201d Acta Informatica, volume 33, number 4, pages 351\u2013385, June 1996. doi:10.1007/s002360050048</li> <li>Mendel Rosenblum and John K. Ousterhout: \u201cThe Design and Implementation of a Log-Structured File System,\u201d ACM Transactions on Computer Systems, volume 10, number 1, pages 26\u201352, February 1992. doi:10.1145/146941.146943</li> <li>Adrien Grand: \u201cWhat Is in a Lucene Index?,\u201d at Lucene/Solr Revolution, November 14, 2013.</li> <li>Deepak Kandepet: \u201cHacking Lucene\u2014The Index Format,\u201d hackerlabs.org, October 1, 2011.</li> <li>Michael McCandless: \u201cVisualizing Lucene's Segment Merges,\u201d blog.mikemccandless.com, February 11, 2011.</li> <li>C. Mohan and Frank Levine: \u201cARIES/IM: An Efficient and High Concurrency Index Management Method Using Write-Ahead Logging,\u201d at ACM International Conference on Management of Data (SIGMOD), June 1992. doi:10.1145/130283.130338</li> <li>Howard Chu: \u201cLDAP at Lightning Speed,\u201d at Build Stuff '14, November 2014.</li> <li>Bradley C. Kuszmaul: \u201cA Comparison of Fractal Trees to Log-Structured Merge (LSM) Trees,\u201d tokutek.com, April 22, 2014.</li> <li>Manos Athanassoulis, Michael S. Kester, Lukas M. Maas, et al.: \u201cDesigning Access Methods: The RUM Conjecture,\u201d at 19th International Conference on Extending Database Technology (EDBT), March 2016. doi:10.5441/002/edbt.2016.42</li> <li>Mark Callaghan: \u201cThe Advantages of an LSM vs a B-Tree,\u201d smalldatum.blogspot.co.uk, January 19, 2016.</li> <li>Emmanuel Goossaert: \u201cCoding for SSDs,\u201d codecapsule.com, February 12, 2014.</li> <li>Frank Ramsak, Volker Markl, Robert Fenk, et al.: \u201cIntegrating the UB-Tree into a Database System Kernel,\u201d at 26th International Conference on Very Large Data Bases (VLDB), September 2000.</li> <li>Robert Escriva, Bernard Wong, and Emin G\u00fcn Sirer: \u201cHyperDex: A Distributed, Searchable Key-Value Store,\u201d at ACM SIGCOMM Conference, August 2012. doi:10.1145/2377677.2377681.</li> <li>Michael McCandless: \u201cLucene's FuzzyQuery Is 100 Times Faster in 4.0,\u201d blog.mikemccandless.com, March 24, 2011.</li> <li>Steffen Heinz, Justin Zobel, and Hugh E. Williams: \u201cBurst Tries: A Fast, Efficient Data Structure for String Keys,\u201d ACM Transactions on Information Systems, volume 20, number 2, pages 192\u2013223, April 2002. doi:10.1145/506309.506312</li> <li>Klaus U. Schulz and Stoyan Mihov: \u201cFast String Correction with Levenshtein Automata,\u201d International Journal on Document Analysis and Recognition, volume 5, number 1, pages 67\u201385, November 2002. doi:10.1007/s10032-002-0082-8</li> <li>Christopher D. Manning, Prabhakar Raghavan, and Hinrich Sch\u00fctze: Introduction to Information Retrieval. Cambridge University Press, 2008. ISBN: 978-0-521-86571-5, available online at nlp.stanford.edu/IR-book</li> <li>Stavros Harizopoulos, Daniel J. Abadi, Samuel Madden, and Michael Stonebraker: \u201cOLTP Through the Looking Glass, and What We Found There,\u201d at ACM International Conference on Management of Data (SIGMOD), June 2008. doi:10.1145/1376616.1376713</li> <li>Justin DeBrabant, Andrew Pavlo, Stephen Tu, et al.: \u201cAnti-Caching: A New Approach to Database Management System Architecture,\u201d Proceedings of the VLDB Endowment, volume 6, number 14, pages 1942\u20131953, September 2013.</li> <li>oy Arulraj, Andrew Pavlo, and Subramanya R. Dulloor: \u201cLet's Talk About Storage &amp; Recovery Methods for Non-Volatile Memory Database Systems,\u201d at ACM International Conference on Management of Data (SIGMOD), June 2015. doi:10.1145/2723372.2749441</li> <li>Surajit Chaudhuri and Umeshwar Dayal: \u201cAn Overview of Data Warehousing and OLAP Technology,\u201d ACM SIGMOD Record, volume 26, number 1, pages 65\u201374, March 1997. doi:10.1145/248603.248616</li> <li>Daniel J. Abadi: \u201cClassifying the SQL-on-Hadoop Solutions,\u201d hadapt.com, October 2, 2013.</li> <li>Marcel Kornacker, Alexander Behm, Victor Bittorf, et al.: \u201cImpala: A Modern, Open-Source SQL Engine for Hadoop,\u201d at 7th Biennial Conference on Innovative Data Systems Research (CIDR), January 2015.</li> <li>Huang D, Liu Q, Cui Q, et al. TiDB: a Raft-based HTAP database[J]. Proceedings of the VLDB Endowment, 2020, 13(12): 3072-3084.</li> <li>Ralph Kimball and Margy Ross: The Data Warehouse Toolkit: The Definitive Guide to Dimensional Modeling, 3rd edition. John Wiley &amp; Sons, July 2013. ISBN: 978-1-118-53080-1</li> <li>Michael Stonebraker: \u201cThe Traditional RDBMS Wisdom Is (Almost Certainly) All Wrong,\u201d presentation at EPFL, May 2013.</li> <li>Julien Le Dem: \u201cDremel Made Simple with Parquet,\u201d blog.twitter.com, September 11, 2013.</li> <li>Daniel J. Abadi, Peter Boncz, Stavros Harizopoulos, et al.: \u201cThe Design and Implementation of Modern Column-Oriented Database Systems,\u201d Foundations and Trends in Databases, volume 5, number 3, pages 197\u2013280, December 2013. doi:10.1561/1900000024</li> <li>Fay Chang, Jeffrey Dean, Sanjay Ghemawat, et al.: \u201cBigtable: A Distributed Storage System for Structured Data,\u201d at 7th USENIX Symposium on Operating System Design and Implementation (OSDI), November 2006.</li> <li>Peter Boncz, Marcin Zukowski, and Niels Nes: \u201cMonetDB/X100: Hyper-Pipelining Query Execution,\u201d at 2nd Biennial Conference on Innovative Data Systems Research (CIDR), January 2005.</li> <li>Jingren Zhou and Kenneth A. Ross: \u201cImplementing Database Operations Using SIMD Instructions,\u201d at ACM International Conference on Management of Data (SIGMOD), pages 145\u2013156, June 2002. doi:10.1145/564691.564709</li> <li>Andrew Lamb, Matt Fuller, Ramakrishna Varadarajan, et al.: \u201cThe Vertica Analytic Database: C-Store 7 Years Later,\u201d Proceedings of the VLDB Endowment, volume 5, number 12, pages 1790\u20131801, August 2012.</li> <li>Jim Gray, Surajit Chaudhuri, Adam Bosworth, et al.: \u201cData Cube: A Relational Aggregation Operator Generalizing Group-By, Cross-Tab, and Sub-Totals,\u201d Data Mining and Knowledge Discovery, volume 1, number 1, pages 29\u201353, March 2007. doi:10.1023/A:1009726021843</li> </ol> <ol> <li> <p>\u8fd9\u4e2a\u53d8\u79cd\u6709\u65f6\u88ab\u79f0\u4e3a B+ \u6811\uff0c\u4f46\u56e0\u4e3a\u8fd9\u4e2a\u4f18\u5316\u5df2\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u6240\u4ee5\u7ecf\u5e38\u65e0\u6cd5\u533a\u5206\u4e8e\u5176\u5b83\u7684 B \u6811\u53d8\u79cd\u00a0\u21a9</p> </li> <li> <p>\u5982\u679c\u6240\u6709\u7684\u952e\u4e0e\u503c\u90fd\u662f\u5b9a\u957f\u7684\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u6bb5\u6587\u4ef6\u4e0a\u7684\u4e8c\u5206\u67e5\u627e\u5e76\u5b8c\u5168\u907f\u514d\u4f7f\u7528\u5185\u5b58\u7d22\u5f15\u3002\u7136\u800c\u5b9e\u8df5\u4e2d\u7684\u952e\u548c\u503c\u901a\u5e38\u90fd\u662f\u53d8\u957f\u7684\uff0c\u56e0\u6b64\u5982\u679c\u6ca1\u6709\u7d22\u5f15\uff0c\u5c31\u5f88\u96be\u77e5\u9053\u8bb0\u5f55\u7684\u5206\u754c\u70b9\uff08\u524d\u4e00\u6761\u8bb0\u5f55\u7ed3\u675f\u4ee5\u53ca\u540e\u4e00\u6761\u8bb0\u5f55\u5f00\u59cb\u7684\u5730\u65b9\uff09\u00a0\u21a9</p> </li> </ol>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html","title":"\u7f16\u7801\u4e0e\u6f14\u5316","text":"<p>\u5c06\u6570\u636e\u7ed3\u6784\u8f6c\u6362\u4e3a\u7f51\u7edc\u4e2d\u7684\u5b57\u8282\u6216\u78c1\u76d8\u4e0a\u7684\u5b57\u8282\u7684\u7f16\u7801\u65b9\u5f0f\u548c\u6f14\u8fdb\u7b56\u7565\u3002</p> <p>\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u66f4\u6539\u5e94\u7528\u7a0b\u5e8f\u529f\u80fd\u65f6\uff0c\u4e5f\u9700\u8981\u66f4\u6539\u5176\u5b58\u50a8\u7684\u6570\u636e\u3002</p> <p>\u5173\u7cfb\u6570\u636e\u5e93\u901a\u5e38\u5047\u5b9a\u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709\u6570\u636e\u90fd\u9075\u5faa\u4e00\u4e2a\u6a21\u5f0f\uff1a\u5c3d\u7ba1\u53ef\u4ee5\u66f4\u6539\u8be5\u6a21\u5f0f\uff08<code>ALTER</code> \u8bed\u53e5\uff09\uff0c\u4f46\u5728\u4efb\u4f55\u65f6\u95f4\u70b9\u90fd\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a\u6b63\u786e\u7684\u6a21\u5f0f\u3002</p> <p>\u8bfb\u65f6\u6a21\u5f0f\uff08schema-on-read\uff0c\u6216 \u65e0\u6a21\u5f0f\uff09\u6570\u636e\u5e93\u4e0d\u4f1a\u5f3a\u5236\u4e00\u4e2a\u6a21\u5f0f\uff0c\u56e0\u6b64\u6570\u636e\u5e93\u53ef\u4ee5\u5305\u542b\u5728\u4e0d\u540c\u65f6\u95f4\u5199\u5165\u7684\u65b0\u8001\u6570\u636e\u683c\u5f0f\u7684\u6df7\u5408\uff08\u8bf7\u53c2\u9605 \u201c\u6587\u6863\u6a21\u578b\u4e2d\u7684\u6a21\u5f0f\u7075\u6d3b\u6027\u201d \uff09\u3002</p> <p>\u5f53\u6570\u636e \u683c\u5f0f\uff08format\uff09 \u6216 \u6a21\u5f0f\uff08schema\uff09 \u53d1\u751f\u53d8\u5316\uff0c\u9700\u8981\u5bf9\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u8fdb\u884c\u76f8\u5e94\u7684\u66f4\u6539\uff1a</p> <ul> <li>\u670d\u52a1\u7aef\uff1a\u6eda\u52a8\u5347\u7ea7\uff0c\u65e0\u9700\u4e2d\u65ad\u670d\u52a1\u5373\u53ef\u90e8\u7f72\u65b0\u7248\u672c\uff1b</li> <li>\u5ba2\u6237\u7aef\uff1a\u770b\u7528\u6237\u5fc3\u60c5\uff0c\u7528\u6237\u53ef\u80fd\u76f8\u5f53\u957f\u4e00\u6bb5\u65f6\u95f4\u91cc\u90fd\u4e0d\u4f1a\u53bb\u5347\u7ea7\u8f6f\u4ef6\u3002\uff1b</li> </ul> <p>\u65b0\u65e7\u7248\u672c\u7684\u4ee3\u7801\uff0c\u4ee5\u53ca\u65b0\u65e7\u6570\u636e\u683c\u5f0f\u53ef\u80fd\u4f1a\u5728\u7cfb\u7edf\u4e2d\u540c\u65f6\u5171\u5904\u3002\u7cfb\u7edf\u60f3\u8981\u7ee7\u7eed\u987a\u5229\u8fd0\u884c\uff0c\u5c31\u9700\u8981\u4fdd\u6301 \u53cc\u5411\u517c\u5bb9\u6027\uff1a</p> <ul> <li>\u5411\u540e\u517c\u5bb9 (backward compatibility)\uff1a\u5f88\u5bb9\u6613\u5b9e\u73b0\uff1b</li> </ul> <p>\u65b0\u7684\u4ee3\u7801\u53ef\u4ee5\u8bfb\u53d6\u7531\u65e7\u7684\u4ee3\u7801\u5199\u5165\u7684\u6570\u636e\u3002</p> <ul> <li>\u5411\u524d\u517c\u5bb9 (forward compatibility)\uff1a\u8f83\u96be\u5b9e\u73b0\uff0c\u65e7\u7248\u7684\u7a0b\u5e8f\u9700\u8981\u5ffd\u7565\u65b0\u7248\u6570\u636e\u683c\u5f0f\u4e2d\u65b0\u589e\u7684\u90e8\u5206\uff1b</li> </ul> <p>\u65e7\u7684\u4ee3\u7801\u53ef\u4ee5\u8bfb\u53d6\u7531\u65b0\u7684\u4ee3\u7801\u5199\u5165\u7684\u6570\u636e\u3002</p> <p>\u5728 Web \u670d\u52a1\u4e2d\uff0c\u8868\u8ff0\u6027\u72b6\u6001\u4f20\u9012\uff08REST\uff09 \u548c \u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\uff08RPC\uff09\uff0c\u4ee5\u53ca \u6d88\u606f\u4f20\u9012\u7cfb\u7edf\uff08\u5982 Actor \u548c\u6d88\u606f\u961f\u5217\uff09\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#_2","title":"\u6570\u636e\u7f16\u7801\u683c\u5f0f","text":"<p>\u7a0b\u5e8f\u901a\u5e38\uff08\u81f3\u5c11\uff09\u4f7f\u7528\u4e24\u79cd\u5f62\u5f0f\u7684\u6570\u636e\uff1a</p> <ul> <li>\u5185\u5b58\u4e2d\uff1a\u6570\u636e\u4fdd\u5b58\u5728\u5bf9\u8c61\u3001\u7ed3\u6784\u4f53\u3001\u5217\u8868\u3001\u6570\u7ec4\u3001\u54c8\u5e0c\u8868\u3001\u6811\u7b49\u7ed3\u6784\u4e2d\uff1b</li> <li>\u6587\u4ef6/\u7f51\u7edc\u53d1\u9001\uff1a\u67d0\u79cd\u81ea\u5305\u542b\u7684\u5b57\u8282\u5e8f\u5217\uff08\u4f8b\u5982\uff0cJSON \u6587\u6863\uff09\uff1b</li> </ul> <p>\u4ece\u5185\u5b58\u4e2d\u8868\u793a\u5230\u5b57\u8282\u5e8f\u5217\u7684\u8f6c\u6362\u79f0\u4e3a \u7f16\u7801\uff08\u6216\u5e8f\u5217\u5316\uff09 \uff0c\u53cd\u8fc7\u6765\u79f0\u4e3a \u89e3\u7801\uff08\u6216\u53cd\u5e8f\u5217\u5316\uff09\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#_3","title":"\u8bed\u8a00\u7279\u5b9a\u7684\u683c\u5f0f","text":"<p>\u7f16\u7a0b\u8bed\u8a00\u57fa\u672c\u90fd\u5185\u7f6e\u652f\u6301\u5c06\u5185\u5b58\u5bf9\u8c61\u7f16\u7801\u4e3a\u5b57\u8282\u5e8f\u5217\uff0c\u5982\uff0cJava \u6709 <code>java.io.Serializable</code>\\(^{[1]}\\)\uff0cRuby \u6709 <code>Marshal</code>\\(^{[2]}\\)\uff0cPython \u6709 <code>pickle</code>\\(^{[3]}\\)\u7b49\u3002\u8bb8\u591a\u7b2c\u4e09\u65b9\u5e93\u4e5f\u5b58\u5728\uff0c\u4f8b\u5982 <code>Kryo for Java</code>\\(^{[4]}\\)\u3002</p> <p>\u7f16\u7801\u5e93\u975e\u5e38\u65b9\u4fbf\uff0c\u7528\u5f88\u5c11\u7684\u989d\u5916\u4ee3\u7801\u5b9e\u73b0\u5185\u5b58\u5bf9\u8c61\u7684\u4fdd\u5b58\u4e0e\u6062\u590d\u3002\u4f46\u662f\u5b83\u4eec\u4e5f\u6709\u4e00\u4e9b\u6df1\u5c42\u6b21\u7684\u95ee\u9898</p> <ul> <li>\u8bed\u8a00\u7ed1\u5b9a\uff1a\u5176\u4ed6\u8bed\u8a00\u5f88\u96be\u8bfb\u53d6\u8fd9\u79cd\u6570\u636e\uff1b</li> <li>\u5b89\u5168\u9690\u60a3\uff1a\u89e3\u7801\u8fc7\u7a0b\u9700\u8981 \u5b9e\u4f8b\u5316\u4efb\u610f\u7c7b \u7684\u80fd\u529b\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u8fdc\u7a0b\u6267\u884c\u4efb\u610f\u4ee3\u7801\\(^{[5\uff0c6]}\\);</li> <li>\u517c\u5bb9\u6027\uff1a\u591a\u7248\u672c\u6570\u636e\u901a\u5e38\u662f\u6b21\u8981\u7684\uff0c\u5ffd\u7565\u5411\u524d\u548c\u5411\u540e\u517c\u5bb9\u6027\u7b49\u95ee\u9898\uff1b</li> <li>\u6548\u7387\uff1a\u5f80\u5f80\u4e5f\u662f\u4e8b\u540e\u624d\u8003\u8651\uff0c\u5982 Java \u7684\u5185\u7f6e\u5e8f\u5217\u5316\u7531\u4e8e\u5176\u7cdf\u7cd5\u7684\u6027\u80fd\u548c\u81c3\u80bf\u7684\u7f16\u7801\u800c\u81ed\u540d\u662d\u8457\\(^{[7]}\\)</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#jsonxml","title":"JSON\u3001XML\u548c\u4e8c\u8fdb\u5236\u53d8\u4f53","text":"<p>JSON\uff0cXML \u5c5e\u4e8e\u6587\u672c\u683c\u5f0f\uff0c\u53ef\u8bfb\u6027\u5f3a\uff0c\u4f46\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff1a</p> <ul> <li>\u6570\u5b57\uff08numbers\uff09 \u7f16\u7801\u6709\u5f88\u591a\u6a21\u7cca\u4e4b\u5904</li> <li>XML \u65e0\u6cd5\u533a\u5206\u6570\u5b57\u8fd8\u662f\u78b0\u5de7\u7531\u6570\u5b57\u7ec4\u6210\u7684\u5b57\u7b26\u4e32\uff1b</li> <li>JSON \u533a\u5206\u5b57\u7b26\u4e32\u548c\u6570\u5b57\uff0c\u4f46\u4e0d\u533a\u5206\u6574\u6570\u548c\u6d6e\u70b9\u6570\uff0c\u4e0d\u80fd\u6307\u5b9a\u7cbe\u5ea6\uff0c\u5927\u4e8e2\\(^{53}\\)\u7684\u6574\u6570\u65e0\u6cd5\u4f7f\u7528 IEEE 754 \u53cc\u7cbe\u5ea6\u6d6e\u70b9\u6570\u7cbe\u786e\u8868\u793a\uff0c\u56e0\u6b64\u5728\u4f7f\u7528\u6d6e\u70b9\u6570\uff08\u4f8b\u5982 JavaScript\uff09\u7684\u8bed\u8a00\u8fdb\u884c\u5206\u6790\u65f6\uff0c\u8fd9\u4e9b\u6570\u5b57\u4f1a\u53d8\u5f97\u4e0d\u51c6\u786e\uff1b</li> <li>JSON \u548c XML \u4e0d\u652f\u6301\u4e8c\u8fdb\u5236\uff0c\u7528 Base64 \u4e8c\u8fdb\u5236\u7f16\u7801\u6765\u89e3\u51b3\uff0c\u6570\u636e\u5927\u5c0f\u589e\u52a0 33%\uff1b</li> <li>XML\\(^{[8]}\\)\u548c JSON\\(^{[9]}\\)\u90fd\u6709\u53ef\u9009\u7684\u6a21\u5f0f\u652f\u6301\u3002\u8fd9\u4e9b\u6a21\u5f0f\u9884\u8a00\u76f8\u5f53\u5f3a\u5927\uff0c\u5b66\u4e60\u548c\u5b9e\u73b0\u6bd4\u8f83\u590d\u6742\uff1b</li> </ul> <p>JSON \u548c XML \u4f5c\u4e3a\u6570\u636e\u4ea4\u6362\u683c\u5f0f\uff0c\u901a\u5e38\u591f\u7528\u4e14\u53ef\u80fd\u4f1a\u7ee7\u7eed\u6d41\u884c\u4e0b\u6765\u3002\u6700\u96be\u7684\u95ee\u9898\u662f\u5728\u4e8e\u5982\u4f55\u8ba9\u4e0d\u540c\u7684\u7ec4\u7ec7\u8fbe\u6210\u683c\u5f0f\u4e00\u81f4\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#_4","title":"\u4e8c\u8fdb\u5236\u7f16\u7801","text":"<p>JSON \u6bd4 XML \u7b80\u6d01\uff0c\u4f46\u4e0e\u4e8c\u8fdb\u5236\u683c\u5f0f\u76f8\u6bd4\u8fd8\u662f\u592a\u5360\u7a7a\u95f4\uff1a</p> <ul> <li> <p>\u5927\u91cf\u4e8c\u8fdb\u5236\u7f16\u7801\u7248\u672c JSON\uff08MessagePack\u3001BSON\u3001BJSON\u3001UBJSON\u3001BISON \u548c Smile \u7b49\uff09 \u548c XML\uff08\u4f8b\u5982 WBXML \u548c Fast Infoset\uff09\u7684\u51fa\u73b0</p> </li> <li> <p>\u6ca1\u6709\u6539\u53d8 JSON / XML \u7684\u6570\u636e\u6a21\u578b\uff0c\u5176\u6570\u636e\u5927\u5c0f\u4ecd\u7136\u5f88\u5927\uff1b</p> </li> </ul> <p>\u4e0b\u9762\u7684\u793a\u4f8b\u662f\u7528 MessagePack \\(^{[10]}\\)\u5bf9\u4e0b\u9762 json \u6570\u636e\u7684\u4e8c\u8fdb\u5236\u7f16\u7801\uff1a</p> <pre><code>{\n    \"userName\": \"Martin\",\n    \"favoriteNumber\": 1337,\n    \"interests\": [\"daydreaming\", \"hacking\"]\n}\n</code></pre> <p>\u4e8c\u8fdb\u5236\u7f16\u7801\u957f\u5ea6\u4e3a 66 \u4e2a\u5b57\u8282\uff0c\u4ec5\u7565\u5c0f\u4e8e\u6587\u672c JSON \u7f16\u7801\u6240\u53d6\u7684 81 \u4e2a\u5b57\u8282\uff08\u5220\u9664\u4e86\u7a7a\u767d\uff09\u3002</p> <p></p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#thriftprotocol-buffers","title":"Thrift\u4e0eProtocol Buffers","text":"<p>Apache Thrift\\(^{[11]}\\) \u548c Protocol Buffers\uff08protobuf\uff09\\(^{[12]}\\)\u662f\u57fa\u4e8e\u76f8\u540c\u539f\u7406\u7684\u4e8c\u8fdb\u5236\u7f16\u7801\u5e93\uff1a</p> <ul> <li>\u9700\u8981\u4e00\u4e2a\u6a21\u5f0f\u6765\u7f16\u7801\u4efb\u4f55\u6570\u636e\uff1b</li> <li>\u63d0\u4f9b\u4e00\u4e2a\u4ee3\u7801\u751f\u6210\u5de5\u5177\uff0c\u6839\u636e\u6a21\u5f0f\u751f\u6210\u5bf9\u5e94\u8bed\u8a00\u7684\u7c7b\\(^{[13]}\\)\uff1b</li> </ul> <p>Thrift \u63a5\u53e3\u5b9a\u4e49\u8bed\u8a00\uff08IDL\uff09\u63cf\u8ff0\u6a21\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>struct Person {\n    1: required string       userName,\n    2: optional i64          favoriteNumber,\n    3: optional list&lt;string&gt; interests\n}\n</code></pre> <p>Protocol Buffers \u7684\u7b49\u6548\u6a21\u5f0f\u5b9a\u4e49\u770b\u8d77\u6765\u975e\u5e38\u76f8\u4f3c\uff1a</p> <ul> <li>protobuf 3 \u4e2d\u79fb\u9664\u4e86<code>required</code>\u548c<code>optional</code>\u5b57\u6bb5\uff0c\u6240\u6709\u5b57\u6bb5\u90fd\u662f <code>optional</code></li> </ul> <pre><code>message Person {\n    string user_name       = 1;\n    int64  favorite_number = 2;\n    repeated string interests       = 3;\n}\n</code></pre> <p>\u8fd9\u91cc\u4ee5 protobuf \u7684\u4e8c\u8fdb\u5236\u7f16\u7801\u4e3a\u4f8b\uff0c\u4ec5\u9700 33 \u4e2a\u5b57\u8282\uff1a</p> <p></p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#_5","title":"\u6a21\u5f0f\u6f14\u53d8","text":"<p>\u6a21\u5f0f\u4e0d\u53ef\u907f\u514d\u5730\u9700\u8981\u968f\u7740\u65f6\u95f4\u800c\u6539\u53d8\uff0cThrift \u548c Protocol Buffers \u5982\u4f55\u5904\u7406\u6a21\u5f0f\u66f4\u6539\uff0c\u540c\u65f6\u4fdd\u6301\u5411\u540e\u517c\u5bb9\uff1f</p> <ul> <li>\u5b57\u6bb5\u6807\u7b7e\u7684\u53d8\u66f4</li> <li>\u6570\u636e\u7c7b\u578b\u7684\u53d8\u66f4</li> </ul> <p>\u5411\u524d\u517c\u5bb9\u6027\uff1a\u65e7\u4ee3\u7801\u53ef\u4ee5\u8bfb\u53d6\u7531\u65b0\u4ee3\u7801\u7f16\u5199\u7684\u8bb0\u5f55\u3002</p> <ul> <li>\u65b0\u7684\u5b57\u6bb5\uff0c\u5176\u6807\u7b7e\u53f7\u7801\u4e0d\u80fd\u8bc6\u522b\uff0c\u5b83\u53ef\u4ee5\u7b80\u5355\u5730\u5ffd\u7565\u8be5\u5b57\u6bb5\uff1b</li> <li>\u53ea\u80fd\u5220\u9664\u53ef\u9009\u7684\u5b57\u6bb5\uff08\u5fc5\u9700\u5b57\u6bb5\u6c38\u8fdc\u4e0d\u80fd\u5220\u9664\uff09</li> </ul> <p>\u5411\u540e\u517c\u5bb9\u6027\uff1a\u6bcf\u4e2a\u5b57\u6bb5\u90fd\u6709\u4e00\u4e2a\u552f\u4e00\u7684\u6807\u7b7e\u53f7\u7801\uff0c\u65b0\u4ee3\u7801\u603b\u662f\u53ef\u4ee5\u8bfb\u53d6\u65e7\u4ee3\u7801\u5199\u7684\u6570\u636e</p> <ul> <li>\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u5b57\u6bb5\uff0c\u4f60\u4e0d\u80fd\u8bbe\u7f6e\u4e3a\u5fc5\u9700\uff1b\u521d\u59cb\u90e8\u7f72\u4e4b\u540e \u6dfb\u52a0\u7684\u6bcf\u4e2a\u5b57\u6bb5\u5fc5\u987b\u662f\u53ef\u9009\u7684\u6216\u5177\u6709\u9ed8\u8ba4\u503c\u3002</li> <li>\u5220\u9664\u5b57\u6bb5\u65f6\uff0c\u65b0\u4ee3\u7801\u53ea\u9700\u5ffd\u7565\u591a\u4f59\u7684\u5b57\u6bb5\uff1b</li> </ul> <p>\u6539\u53d8\u5b57\u6bb5\u7684\u6570\u636e\u7c7b\u578b\uff0c\u503c\u5c06\u5931\u53bb\u7cbe\u5ea6\u6216\u88ab\u622a\u65ad\u3002</p> <ul> <li>\u4f8b\u5982\u5c06\u4e00\u4e2a 32 \u4f4d\u7684\u6574\u6570\u53d8\u6210\u4e00\u4e2a 64 \u4f4d\u7684\u6574\u6570\u65f6\uff0c\u65e7\u4ee3\u7801\u8bfb\u65b0\u5b57\u6bb5\u4f1a\u51fa\u73b0\u622a\u65ad\u7684\u60c5\u51b5\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#avro","title":"Avro","text":"<p>\u884c\u7684\u5b58\u50a8\u683c\u5f0f\uff0c\u4f5c\u4e3a Hadoop \u7684\u4e00\u4e2a\u5b50\u9879\u76ee\u5728 2009 \u5e74\u5f00\u59cb\u7684\uff0c\u56e0\u4e3a Thrift \u4e0d\u9002\u5408 Hadoop \u7684\u7528\u4f8b\uff08\u52a8\u6001\u6a21\u5f0f\uff09\\(^{[14]}\\)\uff1a</p> <ul> <li>\u5199\u5165\u65f6\uff0c\u6a21\u5f0f\u4f1a\u5b58\u5728\u6587\u4ef6\u4e2d\uff0c\u4f46\u662f\u8bfb\u53d6\u6587\u4ef6\u65f6\u53ef\u4ee5\u6307\u5b9a\u5176\u5b83\u7684\u8bfb\u53d6\u6a21\u5f0f\uff1b</li> </ul> <p>\u5176\u6a21\u5f0f\u6587\u4ef6\u793a\u4f8b\u5982\u4e0b\uff1a</p> <pre><code>{\n    \"namespace\":\"com.xliuqq.cs.avro.bean\",\n    \"type\": \"record\",\n    \"name\": \"Person\",\n    \"fields\": [\n        {\"name\": \"userName\", \"type\": \"string\"},\n        {\"name\": \"favoriteNumber\", \"type\": [\"null\", \"long\"], \"default\": null},\n        {\"name\": \"interests\", \"type\": {\"type\": \"array\", \"items\": \"string\"}}\n    ]\n}\n</code></pre> <p>Avro \u7684\u5173\u952e\u601d\u60f3\u662f Writer \u6a21\u5f0f(\u5199\u6570\u636e\u65f6\u7684\u6a21\u5f0f\uff09\u548c Reader \u6a21\u5f0f\uff08\u8bfb\u6570\u636e\u65f6\u7684\u6a21\u5f0f\uff09\u4e0d\u5fc5\u662f\u76f8\u540c\uff0c\u53ea\u9700\u517c\u5bb9\uff1a\u6a21\u5f0f\u89e3\u6790\u901a\u8fc7\u5b57\u6bb5\u540d\u5339\u914d\u5b57\u6bb5</p> <ul> <li>\u5982\u679c\u8bfb\u53d6\u6570\u636e\u7684\u4ee3\u7801\u9047\u5230\u51fa\u73b0\u5728 Writer \u6a21\u5f0f\u4e2d\u4f46\u4e0d\u5728 Reader \u6a21\u5f0f\u4e2d\u7684\u5b57\u6bb5\uff0c\u5219\u5ffd\u7565\u5b83\uff1b</li> <li>\u5982\u679c\u8bfb\u53d6\u6570\u636e\u7684\u4ee3\u7801\u9700\u8981\u67d0\u4e2a\u5b57\u6bb5\uff0c\u4f46\u662f Writer \u6a21\u5f0f\u4e0d\u5305\u542b\u8be5\u540d\u79f0\u7684\u5b57\u6bb5\uff0c\u5219\u4f7f\u7528\u5728 Reader \u6a21\u5f0f\u4e2d\u58f0\u660e\u7684\u9ed8\u8ba4\u503c\u586b\u5145\u3002</li> </ul> <p></p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#_6","title":"\u6a21\u5f0f\u6f14\u53d8","text":"<p>\u5411\u524d\u517c\u5bb9\uff1a</p> <ul> <li>\u5c06\u65b0\u7248\u672c\u7684\u6a21\u5f0f\u4f5c\u4e3a Writer\uff0c\u5e76\u5c06\u65e7\u7248\u672c\u7684\u6a21\u5f0f\u4f5c\u4e3a Reader</li> </ul> <p>\u5411\u540e\u517c\u5bb9\uff1a</p> <ul> <li>\u4f5c\u4e3a Reader \u7684\u65b0\u7248\u672c\u6a21\u5f0f\u548c\u4f5c\u4e3a Writer \u7684\u65e7\u7248\u672c\u6a21\u5f0f\uff1b</li> <li>Reader \u6a21\u5f0f\u53ef\u4ee5\u5305\u542b\u5b57\u6bb5\u540d\u79f0\u7684\u522b\u540d\uff0c\u6240\u4ee5\u5b83\u53ef\u4ee5\u5339\u914d\u65e7 Writer \u7684\u6a21\u5f0f\u5b57\u6bb5\u540d\u79f0\u4e0e\u522b\u540d\uff0c\u4f46\u4e0d\u80fd\u5411\u524d\u517c\u5bb9\uff1b</li> <li>\u5411\u8054\u5408\u7c7b\u578b\u6dfb\u52a0\u5206\u652f\u4e5f\u662f\u5411\u540e\u517c\u5bb9\u7684\uff0c\u4f46\u4e0d\u80fd\u5411\u524d\u517c\u5bb9\u3002</li> </ul> <p>\u4fdd\u8bc1\u517c\u5bb9\u6027\uff1a</p> <ul> <li>\u53ea\u80fd\u6dfb\u52a0\u6216\u5220\u9664\u5177\u6709\u9ed8\u8ba4\u503c\u7684\u5b57\u6bb5\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#_7","title":"\u52a8\u6001\u751f\u6210\u7684\u6a21\u5f0f","text":"<p>Avro \u4e3a\u9759\u6001\u7c7b\u578b\u7f16\u7a0b\u8bed\u8a00\u63d0\u4f9b\u4e86\u53ef\u9009\u7684\u4ee3\u7801\u751f\u6210\u529f\u80fd\uff0c\u4f46\u662f\u5b83\u4e5f\u53ef\u4ee5\u5728\u4e0d\u751f\u6210\u4efb\u4f55\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u3002</p> <ul> <li>\u4f7f\u7528 Avro \u5e93\u6253\u5f00 avro\u6587\u4ef6\uff08\u5d4c\u5165Write\u6a21\u5f0f\uff09\uff0c\u5e76\u4ee5\u4e0e\u67e5\u770b JSON \u6587\u4ef6\u76f8\u540c\u7684\u65b9\u5f0f\u67e5\u770b\u6570\u636e\u3002\u8be5\u6587\u4ef6\u662f\u81ea\u63cf\u8ff0\u7684\uff0c\u56e0\u4e3a\u5b83\u5305\u542b\u6240\u6709\u5fc5\u8981\u7684\u5143\u6570\u636e\u3002</li> <li>\u9002\u7528\u4e8e\u52a8\u6001\u7c7b\u578b\u7684\u6570\u636e\u5904\u7406\u8bed\u8a00\u5982 Apache Pig\\(^{[15]}\\)\uff0c\u6253\u5f00Avro \u6587\u4ef6\uff0c\u5206\u6790\u5b83\u4eec\u5e76\u7f16\u5199\u6d3e\u751f\u6570\u636e\u96c6\u4ee5 Avro \u683c\u5f0f\u8f93\u51fa\u6587\u4ef6\uff0c\u800c\u65e0\u9700\u8003\u8651\u6a21\u5f0f\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#_8","title":"\u6a21\u5f0f\u7684\u4f18\u70b9","text":"<p>Protocol Buffers\u3001Thrift \u548c Avro \u90fd\u4f7f\u7528\u6a21\u5f0f\u6765\u63cf\u8ff0\u4e8c\u8fdb\u5236\u7f16\u7801\u683c\u5f0f\uff0c\u4f46\u7f16\u7801\u6240\u57fa\u4e8e\u7684\u60f3\u6cd5\u7edd\u4e0d\u662f\u65b0\u7684\uff1a</p> <ul> <li>ASN.1 \u662f1984 \u5e74\u9996\u6b21\u88ab\u6807\u51c6\u5316\u7684\u6a21\u5f0f\u5b9a\u4e49\u8bed\u8a00\\(^{[16]}\\)\uff0c\u5176\u4e8c\u8fdb\u5236\u7f16\u7801\uff08DER\uff09\u4ecd\u7136\u88ab\u7528\u4e8e\u7f16\u7801 SSL \u8bc1\u4e66\uff08X.509\uff09\\(^{[17]}\\)\uff1b</li> <li>\u5b83\u4e5f\u975e\u5e38\u590d\u6742\uff0c\u800c\u4e14\u6ca1\u6709\u597d\u7684\u914d\u5957\u6587\u6863\uff0c\u6240\u4ee5 ASN.1 \u53ef\u80fd\u4e0d\u662f\u65b0\u5e94\u7528\u7a0b\u5e8f\u7684\u597d\u9009\u62e9\u3002</li> </ul> <p>\u8bb8\u591a\u6570\u636e\u7cfb\u7edf\u4e5f\u4e3a\u5176\u6570\u636e\u5b9e\u73b0\u4e86\u67d0\u79cd\u4e13\u6709\u7684\u4e8c\u8fdb\u5236\u7f16\u7801\uff0c\u5982\u5173\u7cfb\u6570\u636e\u5e93\u90fd\u6709\u4e00\u4e2a\u7f51\u7edc\u534f\u8bae\u3002</p> <ul> <li>\u6570\u636e\u5e93\u4f9b\u5e94\u5546\u63d0\u4f9b\u5c06\u6765\u81ea\u6570\u636e\u5e93\u7684\u7f51\u7edc\u534f\u8bae\u7684\u54cd\u5e94\u89e3\u7801\u4e3a\u5185\u5b58\u6570\u636e\u7ed3\u6784\u7684\u9a71\u52a8\u7a0b\u5e8f\uff08\u4f8b\u5982\u4f7f\u7528 ODBC \u6216 JDBC API\uff09\u3002</li> </ul> <p>\u6a21\u5f0f\u6f14\u5316\u4fdd\u6301\u4e86\u4e0e JSON \u6570\u636e\u5e93\u63d0\u4f9b\u7684\u65e0\u6a21\u5f0f / \u8bfb\u65f6\u6a21\u5f0f\u76f8\u540c\u7684\u7075\u6d3b\u6027\uff0c\u540c\u65f6\u8fd8\u53ef\u4ee5\u66f4\u597d\u5730\u4fdd\u8bc1\u4f60\u7684\u6570\u636e\u5e76\u63d0\u4f9b\u66f4\u597d\u7684\u5de5\u5177\uff1a</p> <ul> <li>\u5b58\u50a8\uff1a\u6bd4\u5404\u79cd \u201c\u4e8c\u8fdb\u5236 JSON\u201d \u53d8\u4f53\u66f4\u7d27\u51d1\uff0c\u56e0\u4e3a\u5b83\u4eec\u53ef\u4ee5\u7701\u7565\u7f16\u7801\u6570\u636e\u4e2d\u7684\u5b57\u6bb5\u540d\u79f0\uff1b</li> <li>\u65f6\u6548\uff1a\u6a21\u5f0f\u662f\u6709\u4ef7\u503c\u7684\u6587\u6863\uff08\u89e3\u7801\u5fc5\u9700\uff09\uff0c\u53ef\u4ee5\u786e\u5b9a\u5b83\u662f\u6700\u65b0\u7684\uff08\u800c\u624b\u52a8\u7ef4\u62a4\u7684\u6587\u6863\u53ef\u80fd\u5f88\u5bb9\u6613\u504f\u79bb\u73b0\u5b9e\uff09\uff1b</li> <li>\u517c\u5bb9\uff1a\u7ef4\u62a4\u4e00\u4e2a\u6a21\u5f0f\u7684\u6570\u636e\u5e93\u5141\u8bb8\u4f60\u5728\u90e8\u7f72\u4efb\u4f55\u5185\u5bb9\u4e4b\u524d\u68c0\u67e5\u6a21\u5f0f\u66f4\u6539\u7684\u5411\u524d\u548c\u5411\u540e\u517c\u5bb9\u6027\uff1b</li> <li>\u5b89\u5168\uff1a\u9759\u6001\u7c7b\u578b\u7f16\u7a0b\u8bed\u8a00\uff0c\u4ece\u6a21\u5f0f\u751f\u6210\u4ee3\u7801\u53ef\u4ee5\u5728\u7f16\u8bd1\u65f6\u8fdb\u884c\u7c7b\u578b\u68c0\u67e5</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#_9","title":"\u6570\u636e\u6d41\u6a21\u578b","text":"<p>\u517c\u5bb9\u6027\u662f\u7f16\u7801\u6570\u636e\u7684\u4e00\u4e2a\u8fdb\u7a0b\u548c\u89e3\u7801\u5b83\u7684\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u4e4b\u95f4\u7684\u4e00\u79cd\u5173\u7cfb\u3002\u6570\u636e\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u4ece\u4e00\u4e2a\u6d41\u7a0b\u6d41\u5411\u53e6\u4e00\u4e2a\u6d41\u7a0b\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#_10","title":"\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u6d41","text":"<p>\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u5199\u5165\u6570\u636e\u5e93\u7684\u8fc7\u7a0b\u5bf9\u6570\u636e\u8fdb\u884c\u7f16\u7801\uff0c\u4ece\u6570\u636e\u5e93\u8bfb\u53d6\u7684\u8fc7\u7a0b\u5bf9\u6570\u636e\u8fdb\u884c\u89e3\u7801\u3002</p> <ul> <li>\u5411\u540e\u517c\u5bb9\uff1a\u65b0\u7248\u672c\u7684\u4ee3\u7801\u9700\u8981\u89e3\u7801\u65e7\u7248\u672c\u5199\u7684\u6570\u636e\uff0c\u8fd9\u4e2a\u662f\u5fc5\u8981\u7684\uff1b</li> <li>\u5411\u524d\u517c\u5bb9\uff1a\u65e7\u7248\u672c\u7684\u4ee3\u7801\u89e3\u7801\u65b0\u7248\u672c\u7684\u6570\u636e\uff0c\u65e0\u6cd5\u5f3a\u5236\u6240\u6709\u7684\u5ba2\u6237\u7aef\u5347\u7ea7\uff1b</li> <li>\u65e7\u7248\u672c\u66f4\u65b0\u6570\u636e\u65f6\uff0c\u8981\u4fdd\u8bc1\u65b0\u7684\u5b57\u6bb5\u4e0d\u53d8\uff0c\u5373\u4f7f\u4ed6\u4e0d\u80fd\u88ab\u89e3\u91ca\uff1b</li> <li>\u5373\u66f4\u65b0\u6570\u636e\u4e0d\u80fd\u5168\u91cf\u66f4\u65b0\uff0c\u53ea\u80fd\u505a\u90e8\u5206\u66f4\u65b0\uff08\u5168\u91cf\u66f4\u65b0\u5373\u8986\u76d6\uff0c\u65b0\u5b57\u6bb5\u7684\u503c\u4f1a\u4e22\u5931\uff09</li> </ul> <p>\u793a\u4f8b\uff1a\u56fe 4-7 \u65e7\u7248\u672c\u7684\u5e94\u7528\u7a0b\u5e8f\u66f4\u65b0\u4ee5\u524d\u7531\u8f83\u65b0\u7248\u672c\u7684\u5e94\u7528\u7a0b\u5e8f\u7f16\u5199\u7684\u6570\u636e\u65f6\uff0c\u5982\u679c\u4e0d\u5c0f\u5fc3\uff0c\u6570\u636e\u53ef\u80fd\u4f1a\u4e22\u5931</p> <p></p> <p>\u6570\u636e\u7684\u751f\u547d\u5468\u671f\u8d85\u51fa\u4ee3\u7801\u7684\u751f\u547d\u5468\u671f\uff1a</p> <ul> <li>\u6570\u636e\u5e93\u5185\u5bb9\u4e2d\u4e94\u5e74\u524d\u7684\u6570\u636e\uff0c\u9664\u975e\u5bf9\u5176\u8fdb\u884c\u663e\u5f0f\u91cd\u5199\uff0c\u5426\u5219\u5b83\u4ecd\u7136\u4f1a\u4ee5\u539f\u59cb\u7f16\u7801\u5f62\u5f0f\u5b58\u5728</li> <li>\u53ef\u4ee5\u5c06\u6570\u636e\u91cd\u5199\uff08\u8fc1\u79fb\uff09\u5230\u4e00\u4e2a\u65b0\u7684\u6a21\u5f0f\uff0c\u4f46\u5bf9\u4e8e\u5927\u6570\u636e\u96c6\u4ee3\u4ef7\u6602\u8d35\uff1b </li> </ul> <p>\u6a21\u5f0f\u6f14\u53d8\u5141\u8bb8\u6574\u4e2a\u6570\u636e\u5e93\u770b\u8d77\u6765\u597d\u50cf\u662f\u7528\u5355\u4e2a\u6a21\u5f0f\u7f16\u7801\uff0c\u5373\u4f7f\u5e95\u5c42\u5b58\u50a8\u53ef\u80fd\u5305\u542b\u7528\u5404\u79cd\u5386\u53f2\u7248\u672c\u7684\u6a21\u5f0f\u7f16\u7801\u7684\u8bb0\u5f55</p> <p>\u5f52\u6863\u5b58\u50a8\uff1a\u4e3a\u6570\u636e\u5e93\u521b\u5efa\u4e00\u4e2a\u5feb\u7167</p> <ul> <li>\u4f7f\u7528\u6700\u65b0\u6a21\u5f0f\u8fdb\u884c\u7f16\u7801\uff0c\u5373\u4f7f\u6e90\u6570\u636e\u5e93\u4e2d\u7684\u539f\u59cb\u7f16\u7801\u5305\u542b\u6765\u81ea\u4e0d\u540c\u65f6\u4ee3\u7684\u6a21\u5f0f\u7248\u672c\u7684\u6df7\u5408\uff1b</li> <li>\u6570\u636e\u8f6c\u50a8\u662f\u4e00\u6b21\u5199\u5165\u7684\uff0c\u800c\u4e14\u4ee5\u540e\u662f\u4e0d\u53ef\u53d8\uff0cAvro \u5bf9\u8c61\u5bb9\u5668\u6587\u4ef6\u7b49\u683c\u5f0f\u975e\u5e38\u9002\u5408\uff08\u5305\u62ec\u7f16\u7801\u4e3a\u5217\u5f0f\u683c\u5f0f Parquest\uff09\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#restrpc","title":"\u670d\u52a1\u4e2d\u7684\u6570\u636e\u6d41\uff1aREST\u4e0eRPC","text":"<p>\u9762\u5411\u670d\u52a1\u7684\u4f53\u7cfb\u7ed3\u6784\uff08service-oriented architecture\uff0cSOA\uff09\uff0c\u6700\u8fd1\u88ab\u6539\u8fdb\u548c\u66f4\u540d\u4e3a \u5fae\u670d\u52a1\u67b6\u6784\\(^{[18,19]}\\)</p> <ul> <li>\u5c06\u5927\u578b\u5e94\u7528\u7a0b\u5e8f\u6309\u7167\u529f\u80fd\u533a\u57df\u5206\u89e3\u4e3a\u8f83\u5c0f\u7684\u670d\u52a1\uff0c\u5f53\u4e00\u4e2a\u670d\u52a1\u9700\u8981\u6765\u81ea\u53e6\u4e00\u4e2a\u670d\u52a1\u7684\u67d0\u4e9b\u529f\u80fd\u6216\u6570\u636e\u65f6\uff0c\u5c31\u4f1a\u5411\u53e6\u4e00\u4e2a\u670d\u52a1\u53d1\u51fa\u8bf7\u6c42\uff1b</li> <li>\u5173\u952e\u8bbe\u8ba1\u76ee\u6807\uff1a\u901a\u8fc7\u4f7f\u670d\u52a1\u72ec\u7acb\u90e8\u7f72\u548c\u6f14\u5316\u6765\u4f7f\u5e94\u7528\u7a0b\u5e8f\u66f4\u6613\u4e8e\u66f4\u6539\u548c\u7ef4\u62a4\u3002</li> <li>\u671f\u671b\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u7684\u65e7\u7248\u672c\u548c\u65b0\u7248\u672c\u540c\u65f6\u8fd0\u884c\uff0c\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u4f7f\u7528\u7684\u6570\u636e\u7f16\u7801\u5fc5\u987b\u5728\u4e0d\u540c\u7248\u672c\u7684\u670d\u52a1 API \u4e4b\u95f4\u517c\u5bb9</li> </ul> <p>SOAP Web \u670d\u52a1\u7684 API \u4f7f\u7528\u79f0\u4e3a Web \u670d\u52a1\u63cf\u8ff0\u8bed\u8a00\uff08WSDL\uff09\u7684\u57fa\u4e8e XML \u7684\u8bed\u8a00\u6765\u63cf\u8ff0\uff1a\u57fa\u672c\u4e0d\u518d\u53d7\u9752\u7750</p> <ul> <li>SOAP \u6d88\u606f\u901a\u5e38\u56e0\u4e3a\u8fc7\u4e8e\u590d\u6742\u800c\u65e0\u6cd5\u624b\u52a8\u6784\u5efa\uff0c\u4f9d\u8d56\u4e8e\u5de5\u5177\u652f\u6301\uff0c\u4ee3\u7801\u751f\u6210\u548c IDE\\(^{[20]}\\)</li> <li>SOAP \u53ca\u5176\u5404\u79cd\u6269\u5c55\u8868\u9762\u4e0a\u662f\u6807\u51c6\u5316\uff0c\u4f46\u4e0d\u540c\u5382\u5546\u7684\u5b9e\u73b0\u4e4b\u95f4\u7684\u4e92\u64cd\u4f5c\u6027\u5f80\u5f80\u4f1a\u9020\u6210\u95ee\u9898\\(^{[21]}\\)</li> </ul> <p>REST \u4e00\u4e2a\u57fa\u4e8e HTTP \u539f\u5219\u7684\u8bbe\u8ba1\u54f2\u5b66\\(^{[22,23]}\\)\uff0c\u6839\u636e REST \u539f\u5219\u8bbe\u8ba1\u7684 API \u79f0\u4e3a RESTful</p> <ul> <li>\u7b80\u5355\u7684\u6570\u636e\u683c\u5f0f\uff0c\u4f7f\u7528 URL \u6765\u6807\u8bc6\u8d44\u6e90\uff0c\u5e76\u4f7f\u7528 HTTP \u529f\u80fd\u8fdb\u884c\u7f13\u5b58\u63a7\u5236\uff0c\u8eab\u4efd\u9a8c\u8bc1\u548c\u5185\u5bb9\u7c7b\u578b\u534f\u5546\uff1b</li> <li>\u6d89\u53ca\u8f83\u5c11\u7684\u4ee3\u7801\u751f\u6210\u548c\u81ea\u52a8\u5316\u5de5\u5177\uff0c\u5982OpenAPI\uff0c\u4e5f\u79f0\u4e3a Swagger\\(^{[24]}\\)\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#rpc","title":"\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\uff08RPC\uff09\u7684\u95ee\u9898","text":"<p>REST \u7684\u90e8\u5206\u5438\u5f15\u529b\u5728\u4e8e\uff0c\u5b83\u5e76\u4e0d\u8bd5\u56fe\u9690\u85cf\u5b83\u662f\u4e00\u4e2a\u7f51\u7edc\u534f\u8bae\u7684\u4e8b\u5b9e\uff08\u5c3d\u7ba1\u8fd9\u4f3c\u4e4e\u5e76\u6ca1\u6709\u963b\u6b62\u4eba\u4eec\u5728 REST \u4e4b\u4e0a\u6784\u5efa RPC \u5e93\uff09\u3002</p> <p>Web \u670d\u52a1\u4ec5\u4ec5\u662f\u901a\u8fc7\u7f51\u7edc\u8fdb\u884c API \u8bf7\u6c42\u7684\u4e00\u7cfb\u5217\u6280\u672f\u7684\u6700\u65b0\u7248\u672c\uff0c\u8fd8\u6709\u5176\u5b83\u6280\u672f</p> <ul> <li> <p>Enterprise JavaBeans\uff08EJB\uff09\u548c Java \u7684 \u8fdc\u7a0b\u65b9\u6cd5\u8c03\u7528\uff08RMI\uff09 \u4ec5\u9650\u4e8e Java\uff1b</p> </li> <li> <p>\u5206\u5e03\u5f0f\u7ec4\u4ef6\u5bf9\u8c61\u6a21\u578b\uff08DCOM\uff09 \u4ec5\u9650\u4e8e Microsoft \u5e73\u53f0\uff1b</p> </li> <li> <p>\u516c\u5171\u5bf9\u8c61\u8bf7\u6c42\u4ee3\u7406\u4f53\u7cfb\u7ed3\u6784\uff08CORBA\uff09 \u8fc7\u4e8e\u590d\u6742\uff0c\u4e0d\u63d0\u4f9b\u5411\u540e\u6216\u5411\u524d\u517c\u5bb9\u6027\\(^{[25]}\\)</p> </li> </ul> <p>\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\uff08RPC\uff09\\(^{[26]}\\)\uff0c1970\u5e74\u51fa\u73b0\uff0c\u901a\u8fc7\u51fd\u6570\u8c03\u7528\u548c\u7f51\u7edc\u8bf7\u6c42\uff08\u4f4d\u7f6e\u900f\u660e\uff09\uff0c\u5b9e\u73b0\u8de8\u8fdb\u7a0b\u7684\u6570\u636e\u901a\u4fe1\uff1a\u5176\u8ddf\u672c\u5730\u51fd\u6570\u8c03\u7528\u672c\u8d28\u533a\u522b\uff1a</p> <ul> <li>\u7f51\u7edc\u8bf7\u6c42\u662f\u4e0d\u53ef\u9884\u6d4b\uff0c\u4e0d\u5728\u4f60\u7684\u63a7\u5236\u8303\u56f4\u4e4b\u5185\u3002\u7f51\u7edc\u95ee\u9898\u5f88\u5e38\u89c1\uff0c\u56e0\u6b64\u8981\u505a\u5bb9\u9519\u5904\u7406\uff0c\u5982\u4f8b\u5982\u91cd\u8bd5\u5931\u8d25\u7684\u8bf7\u6c42\uff1b</li> <li>\u7f51\u7edc\u8bf7\u6c42\u6709\u53e6\u4e00\u4e2a\u53ef\u80fd\u7684\u7ed3\u679c\uff1a\u7531\u4e8e\u8d85\u65f6\uff0c\u5b83\u8fd4\u56de\u65f6\u53ef\u80fd\u6ca1\u6709\u7ed3\u679c\u3002\u65e0\u6cd5\u77e5\u9053\u8bf7\u6c42\u662f\u5426\u901a\u8fc7\uff1b</li> <li>\u5982\u679c\u5931\u8d25\u91cd\u8bd5\uff0c\u91cd\u8bd5\u5c06\u5bfc\u81f4\u8be5\u64cd\u4f5c\u88ab\u6267\u884c\u591a\u6b21\uff0c\u9664\u975e\u5728\u534f\u8bae\u4e2d\u5efa\u7acb\u6570\u636e\u53bb\u91cd\u673a\u5236\uff08\u5e42\u7b49\u6027\uff0c\u5373 idempotence\uff09\uff1b</li> <li>\u7f51\u7edc\u8bf7\u6c42\u6bd4\u51fd\u6570\u8c03\u7528\u8981\u6162\u5f97\u591a\uff0c\u800c\u4e14\u5176\u5ef6\u8fdf\u4e5f\u662f\u975e\u5e38\u53ef\u53d8\uff1b</li> <li>\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u53ef\u4ee5\u7528\u4e0d\u540c\u7684\u7f16\u7a0b\u8bed\u8a00\u5b9e\u73b0\uff0c\u4f46\u4e0d\u662f\u6240\u6709\u7684\u8bed\u8a00\u90fd\u5177\u6709\u76f8\u540c\u7684\u7c7b\u578b\uff08\u5982 JavaScript \u7684\u6570\u5b57\u5927\u4e8e\\(2^{53}\\)\u7684\u95ee\u9898 \uff09\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#rpc_1","title":"RPC\u7684\u5f53\u524d\u65b9\u5411","text":"<p>\u65b0\u4e00\u4ee3\u7684 RPC \u6846\u67b6\u66f4\u52a0\u660e\u786e\u7684\u662f\uff0c\u8fdc\u7a0b\u8bf7\u6c42\u4e0e\u672c\u5730\u51fd\u6570\u8c03\u7528\u4e0d\u540c\uff0c\u5982 Thritf/Avro\u81ea\u5e26\u7684RPC\uff0cProtobuf\u7684gRPC\u7b49\u3002</p> <p>REST \u4f3c\u4e4e\u662f\u516c\u5171 API \u7684\u4e3b\u8981\u98ce\u683c\u3002RPC \u6846\u67b6\u7684\u4e3b\u8981\u91cd\u70b9\u5728\u4e8e\u540c\u4e00\u7ec4\u7ec7\u62e5\u6709\u7684\u670d\u52a1\u4e4b\u95f4\u7684\u8bf7\u6c42\uff0c\u901a\u5e38\u5728\u540c\u4e00\u6570\u636e\u4e2d\u5fc3\u5185\uff1a</p> <ul> <li>\u65b9\u4fbf\u5b9e\u9a8c\u548c\u8c03\u8bd5\uff0c\u80fd\u88ab\u6240\u6709\u4e3b\u6d41\u7684\u7f16\u7a0b\u8bed\u8a00\u548c\u5e73\u53f0\u6240\u652f\u6301\uff1b</li> <li>\u6709\u5927\u91cf\u53ef\u7528\u7684\u5de5\u5177\uff08\u670d\u52a1\u5668\u3001\u7f13\u5b58\u3001\u8d1f\u8f7d\u5e73\u8861\u5668\u3001\u4ee3\u7406\u3001\u9632\u706b\u5899\u3001\u76d1\u63a7\u3001\u8c03\u8bd5\u5de5\u5177\u3001\u6d4b\u8bd5\u5de5\u5177\u7b49\uff09\u7684\u751f\u6001\u7cfb\u7edf\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#rpc_2","title":"\u6570\u636e\u7f16\u7801\u4e0eRPC\u7684\u6f14\u5316","text":"<p>RPC \u65b9\u6848\u7684\u5411\u540e\u548c\u5411\u524d\u517c\u5bb9\u6027\u5c5e\u6027\u662f\u4ece\u5b83\u4f7f\u7528\u7684\u7f16\u7801\u65b9\u5f0f\u4e2d\u7ee7\u627f\u800c\u6765\u3002</p> <p>\u901a\u8fc7\u670d\u52a1\u8fdb\u884c\u6570\u636e\u6d41\u7684\u60c5\u51b5\u4e0b\u505a\u4e00\u4e2a\u7b80\u5316\u7684\u5047\u8bbe\uff1a\u5047\u5b9a\u6240\u6709\u7684\u670d\u52a1\u5668\u90fd\u4f1a\u5148\u66f4\u65b0\uff0c\u5176\u6b21\u662f\u6240\u6709\u7684\u5ba2\u6237\u7aef</p> <ul> <li>\u8bf7\u6c42\u4e0a\u5177\u6709\u5411\u540e\u517c\u5bb9\u6027\uff1a\u65b0\u7684\u670d\u52a1\u7aef\u5904\u7406\u65e7\u7684\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u6570\u636e\uff1b</li> <li>\u54cd\u5e94\u4e0a\u5177\u6709\u5411\u524d\u517c\u5bb9\u6027\uff1a\u65e7\u7684\u670d\u52a1\u7aef\u5904\u7406\u65b0\u7684\u5ba2\u6237\u7aef\u54cd\u5e94\u7684\u6570\u636e\uff1b</li> </ul> <p>RPC \u7ecf\u5e38\u88ab\u7528\u4e8e\u8de8\u8d8a\u7ec4\u7ec7\u8fb9\u754c\u7684\u901a\u4fe1\uff0c\u6240\u4ee5\u670d\u52a1\u7684\u517c\u5bb9\u6027\u53d8\u5f97\u66f4\u52a0\u56f0\u96be\uff0c\u56e0\u6b64\u670d\u52a1\u7684\u63d0\u4f9b\u8005\u7ecf\u5e38\u65e0\u6cd5\u63a7\u5236\u5176\u5ba2\u6237\uff0c\u4e5f\u4e0d\u80fd\u5f3a\u8feb\u4ed6\u4eec\u5347\u7ea7\uff1a</p> <ul> <li>\u9700\u8981\u8fdb\u884c\u517c\u5bb9\u6027\u66f4\u6539\uff0c\u5219\u670d\u52a1\u63d0\u4f9b\u5546\u901a\u5e38\u4f1a\u5e76\u6392\u7ef4\u62a4\u591a\u4e2a\u7248\u672c\u7684\u670d\u52a1 API\uff1b</li> <li>RESTful API\uff0c\u5e38\u7528\u7684\u65b9\u6cd5\u662f\u5728 URL \u6216 HTTP Accept \u5934\u4e2d\u4f7f\u7528\u7248\u672c\u53f7\\(^{[27]}\\)\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#_11","title":"\u6d88\u606f\u4f20\u9012\u4e2d\u7684\u6570\u636e\u6d41","text":"<p>RPC \u548c\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u5f02\u6b65\u6d88\u606f\u4f20\u9012\u7cfb\u7edf\uff1a</p> <ul> <li>\u4e0e RPC \u7c7b\u4f3c\uff0c\u56e0\u4e3a\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff08\u901a\u5e38\u79f0\u4e3a\u6d88\u606f\uff09\u4ee5\u4f4e\u5ef6\u8fdf\u4f20\u9001\u5230\u53e6\u4e00\u4e2a\u8fdb\u7a0b</li> <li>\u4e0e\u6570\u636e\u5e93\u7c7b\u4f3c\uff0c\u4e0d\u662f\u901a\u8fc7\u76f4\u63a5\u7684\u7f51\u7edc\u8fde\u63a5\u53d1\u9001\u6d88\u606f\uff0c\u800c\u662f\u901a\u8fc7\u79f0\u4e3a\u6d88\u606f\u4ee3\u7406\uff08\u4e5f\u79f0\u4e3a\u6d88\u606f\u961f\u5217\u6216\u9762\u5411\u6d88\u606f\u7684\u4e2d\u95f4\u4ef6\uff09\u7684\u4e2d\u4ecb\u6765\u4e34\u65f6\u5b58\u50a8\u6d88\u606f</li> </ul> <p>\u4e0e\u76f4\u63a5 RPC \u76f8\u6bd4\uff0c\u4f7f\u7528\u6d88\u606f\u4ee3\u7406\u6709\u51e0\u4e2a\u4f18\u70b9\uff1a</p> <ul> <li>\u5982\u679c\u6536\u4ef6\u4eba\u4e0d\u53ef\u7528\u6216\u8fc7\u8f7d\uff0c\u53ef\u4ee5\u5145\u5f53\u7f13\u51b2\u533a\uff0c\u4ece\u800c\u63d0\u9ad8\u7cfb\u7edf\u7684\u53ef\u9760\u6027</li> <li>\u81ea\u52a8\u5c06\u6d88\u606f\u91cd\u65b0\u53d1\u9001\u5230\u5df2\u7ecf\u5d29\u6e83\u7684\u8fdb\u7a0b\uff0c\u4ece\u800c\u9632\u6b62\u6d88\u606f\u4e22\u5931</li> <li>\u907f\u514d\u53d1\u4ef6\u4eba\u9700\u8981\u77e5\u9053\u6536\u4ef6\u4eba\u7684 IP \u5730\u5740\u548c\u7aef\u53e3\u53f7</li> <li>\u5141\u8bb8\u5c06\u4e00\u6761\u6d88\u606f\u53d1\u9001\u7ed9\u591a\u4e2a\u6536\u4ef6\u4eba</li> <li>\u5c06\u53d1\u4ef6\u4eba\u4e0e\u6536\u4ef6\u4eba\u903b\u8f91\u5206\u79bb</li> </ul> <p>\u4e0e RPC \u76f8\u6bd4\uff0c\u5dee\u5f02\u5728\u4e8e\u6d88\u606f\u4f20\u9012\u901a\u4fe1\u901a\u5e38\u662f\u5355\u5411\u7684\uff1a\u53d1\u9001\u8005\u901a\u5e38\u4e0d\u671f\u671b\u6536\u5230\u5176\u6d88\u606f\u7684\u56de\u590d\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#_12","title":"\u6d88\u606f\u4ee3\u7406","text":"<p>\u5f00\u6e90\u5b9e\u73b0\uff1aRabbitMQ\u3001ActiveMQ\u3001Apache Kafka\u3001Apache Pulsar</p> <p>\u6d88\u606f\u4ee3\u7406\u7684\u4f7f\u7528\u65b9\u5f0f\u5982\u4e0b\uff1a\u4e00\u4e2a\u8fdb\u7a0b\u5c06\u6d88\u606f\u53d1\u9001\u5230\u6307\u5b9a\u7684\u961f\u5217\u6216\u4e3b\u9898\uff0c\u4ee3\u7406\u786e\u4fdd\u5c06\u6d88\u606f\u4f20\u9012\u7ed9\u90a3\u4e2a\u961f\u5217\u6216\u4e3b\u9898\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u6d88\u8d39\u8005\u6216\u8ba2\u9605\u8005\u3002</p> <ul> <li> <p>\u5728\u540c\u4e00\u4e3b\u9898\u4e0a\u53ef\u4ee5\u6709\u8bb8\u591a\u751f\u4ea7\u8005\u548c\u8bb8\u591a\u6d88\u8d39\u8005\uff1b</p> </li> <li> <p>\u6d88\u606f\u4ee3\u7406\u901a\u5e38\u4e0d\u4f1a\u6267\u884c\u4efb\u4f55\u7279\u5b9a\u7684\u6570\u636e\u6a21\u578b\uff0c\u6d88\u606f\u53ea\u662f\u5305\u542b\u4e00\u4e9b\u5143\u6570\u636e\u7684\u5b57\u8282\u5e8f\u5217\uff1b</p> </li> <li> <p>\u4efb\u610f\u7f16\u7801\u6a21\u5f0f\uff0c\u5411\u524d/\u5411\u540e\u517c\u5bb9\u6027\u7531\u7f16\u7801\u51b3\u5b9a\uff1b</p> </li> <li>\u91cd\u65b0\u53d1\u5e03\u6d88\u606f\uff0c\u9700\u8981\u5c0f\u5fc3\u4fdd\u7559\u672a\u77e5\u5b57\u6bb5\uff0c\u9632\u6b62\u51fa\u73b0 4-7 \u7684\u65e7\u7248\u672c\u4ee3\u7801\u5168\u91cf\u66f4\u65b0\u6570\u5bfc\u81f4\u65b0\u5b57\u6bb5\u4e22\u5931\u7684\u95ee\u9898\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#actor","title":"\u5206\u5e03\u5f0f\u7684Actor\u6846\u67b6","text":"<p>Actor \u6a21\u578b\u662f\u5355\u4e2a\u8fdb\u7a0b\u4e2d\u5e76\u53d1\u7684\u7f16\u7a0b\u6a21\u578b\uff1a</p> <ul> <li>\u903b\u8f91\u88ab\u5c01\u88c5\u5728 actor \u4e2d\uff0c\u901a\u5e38\u4ee3\u8868\u4e00\u4e2a\u5ba2\u6237\u6216\u5b9e\u4f53\uff0c\u5b83\u53ef\u80fd\u6709\u4e00\u4e9b\u672c\u5730\u72b6\u6001\uff08\u4e0d\u4e0e\u5176\u4ed6\u4efb\u4f55\u89d2\u8272\u5171\u4eab\uff09\uff1b</li> <li>\u901a\u8fc7\u53d1\u9001\u548c\u63a5\u6536\u5f02\u6b65\u6d88\u606f\u4e0e\u5176\u4ed6\u89d2\u8272\uff08actor \uff09\u901a\u4fe1\uff0c\u4e0d\u4fdd\u8bc1\u6d88\u606f\u4f20\u9001\uff0c\u6d88\u606f\u53ef\u80fd\u4f1a\u4e22\u5931\uff08\u4f4d\u7f6e\u900f\u660e\u6027\u6bd4RPC\u597d\uff09\uff1b</li> <li>\u6bcf\u4e2a\u89d2\u8272\u4e00\u6b21\u53ea\u80fd\u5904\u7406\u4e00\u6761\u6d88\u606f\uff0c\u4e0d\u7528\u8003\u8651\u7ebf\u7a0b\u5b89\u5168\uff0c\u89d2\u8272\u53ef\u4ee5\u7531\u6846\u67b6\u72ec\u7acb\u8c03\u5ea6\uff1b</li> </ul> <p>\u5206\u5e03\u5f0f Actor \u6846\u67b6\uff1a\u7528\u4e8e\u8de8\u591a\u4e2a\u8282\u70b9\u4f38\u7f29\u5e94\u7528\u7a0b\u5e8f</p> <ul> <li> <p>\u5c06\u6d88\u606f\u4ee3\u7406\u548c actor \u7f16\u7a0b\u6a21\u578b\u96c6\u6210\u5230\u4e00\u4e2a\u6846\u67b6\u4e2d</p> </li> <li> <p>\u6d88\u606f\u88ab\u900f\u660e\u5730\u7f16\u7801\u6210\u5b57\u8282\u5e8f\u5217\uff0c\u901a\u8fc7\u7f51\u7edc\u53d1\u9001\uff0c\u5e76\u5728\u53e6\u4e00\u4fa7\u89e3\u7801</p> </li> <li>\u57fa\u4e8e actor \u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u6eda\u52a8\u5347\u7ea7\uff0c\u5219\u4ecd\u7136\u9700\u8981\u62c5\u5fc3\u5411\u524d\u548c\u5411\u540e\u517c\u5bb9\u6027\u95ee\u9898</li> </ul> <p>\u6d41\u884c\u7684\u5206\u5e03\u5f0f actor \u6846\u67b6Akka \u5904\u7406\u6d88\u606f\u7f16\u7801\uff1a</p> <ul> <li>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cAkka \u4f7f\u7528 Java \u7684\u5185\u7f6e\u5e8f\u5217\u5316\uff0c\u4e0d\u63d0\u4f9b\u5411\u524d\u6216\u5411\u540e\u517c\u5bb9\u6027\uff0c\u4f46\u53ef\u4ee5\u81ea\u5df1\u81ea\u5b9a\u4e49\u7f16\u7801\\(^{[28]}\\)\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/4_encoding_and_evolution.html#_13","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>\u201cJava Object Serialization Specification,\u201d docs.oracle.com, 2010.</li> <li>\u201cRuby 2.2.0 API Documentation,\u201d ruby-doc.org, Dec 2014.</li> <li>\u201cThe Python 3.4.3 Standard Library Reference Manual,\u201d docs.python.org, February 2015.</li> <li>\u201cEsotericSoftware/kryo,\u201d github.com, October 2014.</li> <li>Steve Breen: \u201cWhat Do WebLogic, WebSphere, JBoss, Jenkins, OpenNMS, and Your Application Have in Common? This Vulnerability,\u201d foxglovesecurity.com, November 6, 2015.</li> <li>Patrick McKenzie: \u201cWhat the Rails Security Issue Means for Your Startup,\u201d kalzumeus.com, January 31, 2013.</li> <li>Eishay Smith: \u201cjvm-serializers wiki,\u201d github.com, November 2014.</li> <li>Shudi (Sandy) Gao, C. M. Sperberg-McQueen, and Henry S. Thompson: \u201cXML Schema 1.1,\u201d W3C Recommendation, May 2001.</li> <li>Francis Galiegue, Kris Zyp, and Gary Court: \u201cJSON Schema,\u201d IETF Internet-Draft, February 2013.</li> <li>\u201cMessagePack Specification,\u201d msgpack.org.</li> <li>Mark Slee, Aditya Agarwal, and Marc Kwiatkowski: \u201cThrift: Scalable Cross-Language Services Implementation,\u201d Facebook technical report, April 2007.</li> <li>\u201cProtocol Buffers Developer Guide,\u201d Google, Inc., developers.google.com.</li> <li>\u201cA Matrix of the Features Each Individual Language Library Supports,\u201d wiki.apache.org.</li> <li>Doug Cutting, Chad Walters, Jim Kellerman, et al.: \u201c[PROPOSAL] New Subproject: Avro,\u201d email thread on hadoop-general mailing list, mail-archives.apache.org, April 2009.</li> <li>\u201cApache Pig 0.14.0 Documentation,\u201d pig.apache.org, November 2014.</li> <li>Russell Housley, Warwick Ford, Tim Polk, and David Solo: \u201cRFC 2459: Internet X.509 Public Key Infrastructure: Certificate and CRL Profile,\u201d IETF Network Working Group, Standards Track, January 1999.</li> <li>Lev Walkin: \u201cQuestion: Extensibility and Dropping Fields,\u201d lionet.info, September 21, 2010.</li> <li>Sam Newman: Building Microservices. O'Reilly Media, 2015. ISBN: 978-1-491-95035-7</li> <li>Chris Richardson: \u201cMicroservices: Decomposing Applications for Deployability and Scalability,\u201d infoq.com, May 25, 2014.</li> <li>Pete Lacey: \u201cThe S Stands for Simple,\u201d harmful.cat-v.org, November 15, 2006.</li> <li>Stefan Tilkov: \u201cInterview: Pete Lacey Criticizes Web Services,\u201d infoq.com, December 12, 2006.</li> <li>Roy Thomas Fielding: \u201cArchitectural Styles and the Design of Network-Based Software Architectures,\u201d PhD Thesis, University of California, Irvine, 2000.</li> <li>Roy Thomas Fielding: \u201cREST APIs Must Be Hypertext-Driven,\u201d roy.gbiv.com, October 20 2008.</li> <li>\u201cOpenAPI Specification (fka Swagger RESTful API Documentation Specification) Version 2.0,\u201d swagger.io, September 8, 2014.</li> <li>Michi Henning: \u201cThe Rise and Fall of CORBA,\u201d ACM Queue, volume 4, number 5, pages 28\u201334, June 2006. doi:10.1145/1142031.1142044</li> <li>Andrew D. Birrell and Bruce Jay Nelson: \u201cImplementing Remote Procedure Calls,\u201d ACM Transactions on Computer Systems (TOCS), volume 2, number 1, pages 39\u201359, February 1984. doi:10.1145/2080.357392</li> <li>Troy Hunt: \u201cYour API Versioning Is Wrong, Which Is Why I Decided to Do It 3 Different Wrong Ways,\u201d troyhunt.com, February 10, 2014.</li> <li>Jonas Bon\u00e9r: \u201cUpgrade in an Akka Cluster,\u201d email to akka-user mailing list, grokbase.com, August 28, 2013.</li> </ol>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html","title":"\u590d\u5236","text":"<p>\u51fa\u4e8e\u5404\u79cd\u5404\u6837\u7684\u539f\u56e0\uff0c\u5e0c\u671b\u80fd\u590d\u5236\u6570\u636e\uff1a</p> <ul> <li>\u5ef6\u8fdf\uff1a\u4f7f\u5f97\u6570\u636e\u4e0e\u7528\u6237\u5728\u5730\u7406\u4e0a\u63a5\u8fd1 \uff0c\u5982 CDN\uff1b</li> <li>\u53ef\u7528\u6027\uff1a\u5373\u4f7f\u7cfb\u7edf\u7684\u4e00\u90e8\u5206\u51fa\u73b0\u6545\u969c\uff0c\u7cfb\u7edf\u4e5f\u80fd\u7ee7\u7eed\u5de5\u4f5c\uff1b</li> <li>\u8bfb\u53d6\u541e\u5410\u91cf\uff1a\u4f38\u7f29\u53ef\u4ee5\u63a5\u53d7\u8bfb\u8bf7\u6c42\u7684\u673a\u5668\u6570\u91cf\uff1b</li> </ul> <p>\u590d\u5236\u9700\u8981\u4ed4\u7ec6\u8003\u8651\u5e76\u53d1\u548c\u6240\u6709\u53ef\u80fd\u51fa\u9519\u7684\u4e8b\u60c5\uff0c\u5e76\u5904\u7406\u6545\u969c\uff08\u5982\u4e0d\u53ef\u7528\u7684\u8282\u70b9\u548c\u7f51\u7edc\u4e2d\u65ad\uff0c\u4e0d\u5305\u62ec\u66f4\u9690\u853d\u7684\u6545\u969c\uff0c\u5982\u8f6f\u4ef6\u9519\u8bef\u5bfc\u81f4\u7684\u9759\u9ed8\u6570\u636e\u635f\u574f\uff09\u3002</p> <p>\u590d\u5236\u7684\u56f0\u96be\u4e4b\u5904\u5728\u4e8e\u5904\u7406\u590d\u5236\u6570\u636e\u7684 \u53d8\u66f4\uff08change\uff09\uff0c\u4e09\u79cd\u6d41\u884c\u7684\u53d8\u66f4\u590d\u5236\u7b97\u6cd5\uff1a</p> <ul> <li>\u5355\u9886\u5bfc\u8005\uff08single leader\uff0c\u5355\u4e3b\uff09\uff1a\u5ba2\u6237\u7aef\u5c06\u6240\u6709\u5199\u5165\u64cd\u4f5c\u53d1\u9001\u5230\u5355\u4e2a\u8282\u70b9\uff08\u4e3b\u5e93\uff09\uff0c\u8bfb\u53d6\u53ef\u4ee5\u5728\u4efb\u4f55\u526f\u672c\u4e0a\u6267\u884c\uff08\u4f46\u53ef\u80fd\u662f\u65e7\u6570\u636e\uff09</li> <li>\u591a\u9886\u5bfc\u8005\uff08multi leader\uff0c\u591a\u4e3b\uff09 \uff1a\u5ba2\u6237\u7aef\u5c06\u6bcf\u4e2a\u5199\u5165\u53d1\u9001\u5230\u51e0\u4e2a\u4e3b\u5e93\u8282\u70b9\u4e4b\u4e00\uff0c\u4e3b\u5e93\u5c06\u6570\u636e\u66f4\u6539\u4e8b\u4ef6\u6d41\u53d1\u9001\u7ed9\u5f7c\u6b64\u4ee5\u53ca\u4efb\u4f55\u4ece\u5e93\u8282\u70b9\u3002</li> <li>\u65e0\u9886\u5bfc\u8005\uff08leaderless\uff0c\u65e0\u4e3b\uff09\uff1a\u5ba2\u6237\u7aef\u5c06\u6bcf\u4e2a\u5199\u5165\u53d1\u9001\u5230\u51e0\u4e2a\u8282\u70b9\uff0c\u5e76\u4ece\u591a\u4e2a\u8282\u70b9\u5e76\u884c\u8bfb\u53d6\uff0c\u4ee5\u68c0\u6d4b\u548c\u7ea0\u6b63\u5177\u6709\u9648\u65e7\u6570\u636e\u7684\u8282\u70b9\u3002</li> </ul> <p>\u590d\u5236\u53ef\u4ee5\u662f\u540c\u6b65\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u5f02\u6b65\u7684\uff0c\u8fd9\u5728\u53d1\u751f\u6545\u969c\u65f6\u5bf9\u7cfb\u7edf\u884c\u4e3a\u6709\u6df1\u8fdc\u7684\u5f71\u54cd\u3002</p> <ul> <li>\u4f8b\u5982\uff0c\u5982\u679c\u4e3b\u5e93\u5931\u8d25\u540e\u4f60\u5c06\u4e00\u4e2a\u5f02\u6b65\u66f4\u65b0\u7684\u4ece\u5e93\u63d0\u5347\u4e3a\u65b0\u7684\u4e3b\u5e93\uff0c\u90a3\u4e48\u6700\u8fd1\u63d0\u4ea4\u7684\u6570\u636e\u53ef\u80fd\u4f1a\u4e22\u5931\u3002</li> </ul> <p>\u51b3\u5b9a\u5e94\u7528\u7a0b\u5e8f\u5728\u590d\u5236\u5ef6\u8fdf\u65f6\u7684\u884c\u4e3a\u7684\u4e00\u81f4\u6027\u6a21\u578b\uff1a</p> <ul> <li>\u5199\u540e\u8bfb\u4e00\u81f4\u6027\uff1a\u7528\u6237\u5e94\u8be5\u603b\u662f\u80fd\u770b\u5230\u81ea\u5df1\u63d0\u4ea4\u7684\u6570\u636e\u3002</li> <li>\u5355\u8c03\u8bfb\uff1a\u7528\u6237\u5728\u770b\u5230\u67d0\u4e2a\u65f6\u95f4\u70b9\u7684\u6570\u636e\u540e\uff0c\u4ed6\u4eec\u4e0d\u5e94\u8be5\u518d\u770b\u5230\u8be5\u6570\u636e\u5728\u66f4\u65e9\u65f6\u95f4\u70b9\u7684\u60c5\u51b5\u3002</li> <li>\u4e00\u81f4\u524d\u7f00\u8bfb\uff1a\u7528\u6237\u5e94\u8be5\u770b\u5230\u6570\u636e\u5904\u4e8e\u4e00\u79cd\u5177\u6709\u56e0\u679c\u610f\u4e49\u7684\u72b6\u6001\uff1a\u4f8b\u5982\uff0c\u6309\u6b63\u786e\u7684\u987a\u5e8f\u770b\u5230\u4e00\u4e2a\u95ee\u9898\u548c\u5bf9\u5e94\u7684\u56de\u7b54\u3002</li> </ul> <p>\u591a\u4e3b\u590d\u5236\u548c\u65e0\u4e3b\u590d\u5236\u65b9\u6cd5\u6240\u56fa\u6709\u7684\u5e76\u53d1\u95ee\u9898\uff1a\u56e0\u4e3a\u4ed6\u4eec\u5141\u8bb8\u591a\u4e2a\u5199\u5165\u5e76\u53d1\u53d1\u751f\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u51b2\u7a81\u3002</p> <ul> <li>\u4e00\u4e2a\u7b97\u6cd5\u6765\u786e\u5b9a\u4e00\u4e2a\u64cd\u4f5c\u662f\u5426\u53d1\u751f\u5728\u53e6\u4e00\u4e2a\u64cd\u4f5c\u4e4b\u524d\uff0c\u6216\u8005\u5b83\u4eec\u662f\u5426\u5e76\u53d1\u53d1\u751f\uff1b</li> <li>\u901a\u8fc7\u5408\u5e76\u5e76\u53d1\u66f4\u65b0\u6765\u89e3\u51b3\u51b2\u7a81\u7684\u65b9\u6cd5\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_2","title":"\u9886\u5bfc\u8005\u4e0e\u8ffd\u968f\u8005","text":"<p>\u5b58\u5728\u591a\u4e2a\u526f\u672c\u65f6\uff0c\u4f1a\u4e0d\u53ef\u907f\u514d\u7684\u51fa\u73b0\u4e00\u4e2a\u95ee\u9898\uff1a\u5982\u4f55\u786e\u4fdd\u6240\u6709\u6570\u636e\u90fd\u843d\u5728\u4e86\u6240\u6709\u7684\u526f\u672c\u4e0a\uff1f</p> <p>\u57fa\u4e8e\u9886\u5bfc\u8005\u7684\u590d\u5236\uff08leader-based replication\uff09 \uff08\u4e5f\u79f0 \u4e3b\u52a8/\u88ab\u52a8\uff08active/passive\uff09 \u590d\u5236\u6216 \u4e3b/\u4ece\uff08master/slave\uff09 \u590d\u5236</p> <ul> <li>\u5176\u4e2d\u4e00\u4e2a\u526f\u672c\u88ab\u6307\u5b9a\u4e3a \u9886\u5bfc\u8005\uff08leader\uff09\uff0c\u4e5f\u79f0\u4e3a \u4e3b\u5e93\uff08master|primary\uff09\uff0c\u5176\u4ed6\u526f\u672c\u88ab\u79f0\u4e3a \u8ffd\u968f\u8005\uff08followers\uff09\uff0c\u4ea6\u79f0\u4e3a \u53ea\u8bfb\u526f\u672c\uff08read replicas\uff09\u3001\u4ece\u5e93\uff08slaves\uff09\u3001\u5907\u5e93\uff08 secondaries\uff09 \u6216 \u70ed\u5907\uff08hot-standby\uff09\uff1b       </li> </ul> <p>\u5199\u5165\u6d41\u7a0b\uff1a\u4ec5\u5411\u9886\u5bfc\u8005\u5199\u5165\u6570\u636e\uff1b</p> <ul> <li>\u5f53\u5ba2\u6237\u7aef\u8981\u5411\u6570\u636e\u5e93\u5199\u5165\u65f6\uff0c\u5b83\u5fc5\u987b\u5c06\u8bf7\u6c42\u53d1\u9001\u7ed9\u8be5 \u9886\u5bfc\u8005\uff1b</li> <li>\u5f53\u9886\u5bfc\u8005\u5c06\u65b0\u6570\u636e\u5199\u5165\u672c\u5730\u5b58\u50a8\u65f6\uff0c\u5b83\u4e5f\u4f1a\u5c06\u6570\u636e\u53d8\u66f4\u53d1\u9001\u7ed9\u6240\u6709\u7684\u8ffd\u968f\u8005\uff0c\u79f0\u4e4b\u4e3a \u590d\u5236\u65e5\u5fd7\uff08replication log\uff09 \u6216 \u53d8\u66f4\u6d41\uff08change stream\uff09\uff1b</li> <li>\u6bcf\u4e2a\u8ddf\u968f\u8005\u4ece\u9886\u5bfc\u8005\u62c9\u53d6\u65e5\u5fd7\uff0c\u5e76\u76f8\u5e94\u66f4\u65b0\u5176\u672c\u5730\u6570\u636e\u5e93\u526f\u672c\uff0c\u65b9\u6cd5\u662f\u6309\u7167\u4e0e\u9886\u5bfc\u8005\u76f8\u540c\u7684\u5904\u7406\u987a\u5e8f\u6765\u8fdb\u884c\u6240\u6709\u5199\u5165\u3002</li> </ul> <p>\u8bfb\u53d6\u6d41\u7a0b\uff1a\u5411\u9886\u5bfc\u8005\u6216\u4efb\u4e00\u8ffd\u968f\u8005\u8fdb\u884c\u67e5\u8be2\u3002</p> <p></p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_3","title":"\u540c\u6b65\u590d\u5236\u4e0e\u5f02\u6b65\u590d\u5236","text":"<p>\u540c\u6b65\u4e0e\u5f02\u6b65\u590d\u5236\u7684\u793a\u4f8b\uff1a\u4ece\u5e931\u662f\u540c\u6b65\u590d\u5236\uff0c\u4ece\u5e932\u662f\u5f02\u6b65\u590d\u5236</p> <p></p> <p>\u5173\u4e8e\u771f\u5b9e\u73af\u5883\u7684\u4f7f\u7528\uff1a</p> <ul> <li> <p>\u5c06\u6240\u6709\u4ece\u5e93\u90fd\u8bbe\u7f6e\u4e3a\u540c\u6b65\u7684\u662f\u4e0d\u5207\u5b9e\u9645\uff0c\u4e00\u822c\u91c7\u7528 \u534a\u540c\u6b65\uff08semi-synchronous\uff09\\(^{[1]}\\)\uff0c\u4e00\u4e2a\u4ece\u5e93\u540c\u6b65\uff0c\u5176\u5b83\u4ece\u5e93\u5f02\u6b65\uff1b</p> </li> <li> <p>\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u57fa\u4e8e\u9886\u5bfc\u8005\u7684\u590d\u5236\u90fd\u914d\u7f6e\u4e3a\u5b8c\u5168\u5f02\u6b65\uff1b</p> </li> <li> <p>\u5df2\u7ecf\u786e\u8ba4\u5199\u5165\u4e5f\u4e0d\u80fd\u4fdd\u8bc1\u662f \u6301\u4e45\uff08Durable\uff09\uff1a\u672a\u590d\u5236\u7ed9\u4ece\u5e93\u7684\u5199\u5165\u5728\u4e3b\u5e93\u5931\u6548\u4e0d\u53ef\u6062\u590d\u65f6\u5c06\u4f1a\u4e22\u5931\uff1b</p> </li> </ul> <p>\u5bf9\u4e8e\u5f02\u6b65\u590d\u5236\u7cfb\u7edf\u800c\u8a00\uff0c\u4e3b\u5e93\u6545\u969c\u65f6\u4f1a\u4e22\u5931\u6570\u636e\u53ef\u80fd\u662f\u4e00\u4e2a\u4e25\u91cd\u7684\u95ee\u9898\uff1a</p> <ul> <li>\u94fe\u5f0f\u590d\u5236\uff08chain replication\uff09\\(^{[2,3]}\\)\uff1a\u7814\u7a76\u4e0d\u4e22\u6570\u636e\u4f46\u4ecd\u80fd\u63d0\u4f9b\u826f\u597d\u6027\u80fd\u548c\u53ef\u7528\u6027\u7684\u590d\u5236\u65b9\u6cd5</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_4","title":"\u8bbe\u7f6e\u65b0\u7684\u4ece\u5e93","text":"<p>\u6709\u65f6\u5019\u9700\u8981\u8bbe\u7f6e\u4e00\u4e2a\u65b0\u7684\u4ece\u5e93\uff1a\u4e5f\u8bb8\u662f\u4e3a\u4e86\u589e\u52a0\u526f\u672c\u7684\u6570\u91cf\uff0c\u6216\u66ff\u6362\u5931\u8d25\u7684\u8282\u70b9\u3002\u5982\u4f55\u786e\u4fdd\u65b0\u7684\u4ece\u5e93\u62e5\u6709\u4e3b\u5e93\u6570\u636e\u7684\u7cbe\u786e\u526f\u672c\uff1f</p> <ul> <li>\u7b80\u5355\u5730\u5c06\u6570\u636e\u6587\u4ef6\u4ece\u4e00\u4e2a\u8282\u70b9\u590d\u5236\u5230\u53e6\u4e00\u4e2a\u8282\u70b9\u901a\u5e38\u662f\u4e0d\u591f\u7684</li> <li>\u6807\u51c6\u7684\u6587\u4ef6\u590d\u5236\u4f1a\u770b\u5230\u6570\u636e\u5e93\u7684\u4e0d\u540c\u90e8\u5206\u5728\u4e0d\u540c\u7684\u65f6\u95f4\u70b9\u7684\u5185\u5bb9\uff0c\u5176\u7ed3\u679c\u53ef\u80fd\u6ca1\u6709\u4efb\u4f55\u610f\u4e49\u3002</li> <li>\u9501\u5b9a\u6570\u636e\u5e93\uff08\u4f7f\u5176\u4e0d\u53ef\u7528\u4e8e\u5199\u5165\uff09\u6765\u4f7f\u78c1\u76d8\u4e0a\u7684\u6587\u4ef6\u4fdd\u6301\u4e00\u81f4\uff1a\u8fdd\u80cc\u9ad8\u53ef\u7528\u7684\u76ee\u6807</li> </ul> <p>\u6807\u51c6\u6b65\u9aa4\uff1a</p> <ul> <li>\u5728\u67d0\u4e2a\u65f6\u523b\u83b7\u53d6\u4e3b\u5e93\u7684\u4e00\u81f4\u6027\u5feb\u7167\uff08\u5982\u679c\u53ef\u80fd\uff0c\u4e0d\u5fc5\u9501\u5b9a\u6574\u4e2a\u6570\u636e\u5e93\uff09\uff0c\u5927\u591a\u6570\u6570\u636e\u5e93\u90fd\u5177\u6709\u8fd9\u4e2a\u529f\u80fd\uff0c\u56e0\u4e3a\u5b83\u662f\u5907\u4efd\u5fc5\u9700\u7684</li> <li>\u5c06\u5feb\u7167\u590d\u5236\u5230\u65b0\u7684\u4ece\u5e93\u8282\u70b9</li> <li>\u4ece\u5e93\u8fde\u63a5\u5230\u4e3b\u5e93\uff0c\u5e76\u62c9\u53d6\u5feb\u7167\u4e4b\u540e\u53d1\u751f\u7684\u6240\u6709\u6570\u636e\u53d8\u66f4\u3002\u8fd9\u8981\u6c42\u5feb\u7167\u4e0e\u4e3b\u5e93\u590d\u5236\u65e5\u5fd7\u4e2d\u7684\u4f4d\u7f6e\u7cbe\u786e\u5173\u8054\u3002</li> <li>PostgreSQL \u5c06\u5176\u79f0\u4e3a \u65e5\u5fd7\u5e8f\u5217\u53f7\uff08log sequence number\uff0cLSN\uff09\uff0cMySQL \u5c06\u5176\u79f0\u4e3a \u4e8c\u8fdb\u5236\u65e5\u5fd7\u5750\u6807\uff08binlog coordinates\uff09</li> <li>\u5f53\u4ece\u5e93\u5904\u7406\u5b8c\u5feb\u7167\u4e4b\u540e\u79ef\u7d2f\u7684\u6570\u636e\u53d8\u66f4\uff0c\u5c31\u8bf4\u5b83 \u8d76\u4e0a\uff08caught up\uff09 \u4e86\u4e3b\u5e93\uff0c\u73b0\u5728\u5b83\u53ef\u4ee5\u7ee7\u7eed\u53ca\u65f6\u5904\u7406\u4e3b\u5e93\u4ea7\u751f\u7684\u6570\u636e\u53d8\u5316</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_5","title":"\u5904\u7406\u8282\u70b9\u5b95\u673a","text":"<p>\u5373\u4f7f\u4e2a\u522b\u8282\u70b9\u5931\u6548\uff0c\u4e5f\u80fd\u4fdd\u6301\u6574\u4e2a\u7cfb\u7edf\u8fd0\u884c\uff0c\u5e76\u5c3d\u53ef\u80fd\u63a7\u5236\u8282\u70b9\u505c\u673a\u5e26\u6765\u7684\u5f71\u54cd\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_6","title":"\u4ece\u5e93\u5931\u6548\uff1a\u8ffd\u8d76\u6062\u590d","text":"<p>\u4ece\u5e93\u53ef\u4ee5\u4ece\u65e5\u5fd7\u4e2d\u77e5\u9053\uff0c\u5728\u53d1\u751f\u6545\u969c\u4e4b\u524d\u5904\u7406\u7684\u6700\u540e\u4e00\u4e2a\u4e8b\u52a1\uff0c\u4ece\u5e93\u53ef\u4ee5\u8fde\u63a5\u5230\u4e3b\u5e93\uff0c\u5e76\u8bf7\u6c42\u5728\u4ece\u5e93\u65ad\u5f00\u671f\u95f4\u53d1\u751f\u7684\u6240\u6709\u6570\u636e\u53d8\u66f4\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_7","title":"\u4e3b\u5e93\u5931\u6548\uff1a\u6545\u969c\u5207\u6362","text":"<p>\u6545\u969c\u5207\u6362\uff08failover\uff09\uff1a\u4e00\u4e2a\u4ece\u5e93\u9700\u8981\u88ab\u63d0\u5347\u4e3a\u65b0\u7684\u4e3b\u5e93\uff0c\u9700\u8981\u91cd\u65b0\u914d\u7f6e\u5ba2\u6237\u7aef\u5c06\u5b83\u4eec\u7684\u5199\u64cd\u4f5c\u53d1\u9001\u7ed9\u65b0\u7684\u4e3b\u5e93\uff0c\u5176\u4ed6\u4ece\u5e93\u9700\u8981\u5f00\u59cb\u62c9\u53d6\u6765\u81ea\u65b0\u4e3b\u5e93\u7684\u6570\u636e\u53d8\u66f4\u3002</p> <p>\u81ea\u52a8\u7684\u6545\u969c\u5207\u6362\u8fc7\u7a0b\u901a\u5e38\u7531\u4ee5\u4e0b\u6b65\u9aa4\u7ec4\u6210\uff1a</p> <ul> <li>\u786e\u8ba4\u4e3b\u5e93\u5931\u6548\uff1a\u6ca1\u6709\u4e07\u65e0\u4e00\u5931\u7684\u65b9\u6cd5\u6765\u68c0\u6d4b\u51fa\u73b0\u4e86\u4ec0\u4e48\u95ee\u9898\uff0c\u6240\u4ee5\u5927\u591a\u6570\u7cfb\u7edf\u53ea\u662f\u7b80\u5355\u4f7f\u7528 \u8d85\u65f6\uff08Timeout\uff09 </li> <li>\u9009\u62e9\u4e00\u4e2a\u65b0\u7684\u4e3b\u5e93\uff1a\u6700\u4f73\u4eba\u9009\u901a\u5e38\u662f\u62e5\u6709\u65e7\u4e3b\u5e93\u6700\u65b0\u6570\u636e\u526f\u672c\u7684\u4ece\u5e93\uff08\u4ee5\u6700\u5c0f\u5316\u6570\u636e\u635f\u5931\uff09\uff0c\u8fd9\u662f\u4e2a\u5171\u8bc6\u95ee\u9898\uff1b</li> <li>\u91cd\u65b0\u914d\u7f6e\u7cfb\u7edf\u4ee5\u542f\u7528\u65b0\u7684\u4e3b\u5e93\uff1a\u540c\u65f6\u786e\u4fdd\u65e7\u4e3b\u5e93\uff08\u91cd\u542f\u540e\uff09\u610f\u8bc6\u5230\u65b0\u4e3b\u5e93\u7684\u5b58\u5728\u5e76\u6210\u4e3a\u4e00\u4e2a\u4ece\u5e93</li> </ul> <p>\u6545\u969c\u5207\u6362\u8fc7\u7a0b\u53ef\u80fd\u5b58\u5728\u7684\u95ee\u9898\uff1a</p> <ul> <li>\u6570\u636e\u51b2\u7a81/\u4e22\u5931\uff1a\u5f02\u6b65\u590d\u5236\uff0c\u5219\u65b0\u4e3b\u5e93\u53ef\u80fd\u6ca1\u6709\u6536\u5230\u8001\u4e3b\u5e93\u5b95\u673a\u524d\u6700\u540e\u7684\u5199\u5165\u64cd\u4f5c</li> <li>\u9009\u51fa\u65b0\u4e3b\u5e93\u540e\uff0c\u5982\u679c\u8001\u4e3b\u5e93\u91cd\u65b0\u52a0\u5165\u96c6\u7fa4\uff0c\u65b0\u4e3b\u5e93\u53ef\u80fd\u5df2\u7ecf\u6536\u5230\u4e86\u4e0e\u8001\u4e3b\u5e93\u5c1a\u672a\u590d\u5236\u7684\u5199\u5165\u76f8\u51b2\u7a81\u7684\u5199\u5165</li> <li>\u6700\u5e38\u89c1\u7684\u89e3\u51b3\u65b9\u6848\u662f\u7b80\u5355\u4e22\u5f03\u8001\u4e3b\u5e93\u672a\u590d\u5236\u7684\u5199\u5165\uff0c\u8fd9\u5f88\u53ef\u80fd\u6253\u7834\u5ba2\u6237\u5bf9\u4e8e\u6570\u636e\u6301\u4e45\u6027\u7684\u671f\u671b\u3002</li> <li>\u5916\u90e8\u4e0d\u4e00\u81f4\uff1a\u5982\u679c\u6570\u636e\u5e93\u9700\u8981\u548c\u5176\u4ed6\u5916\u90e8\u5b58\u50a8\u76f8\u534f\u8c03\uff0c\u90a3\u4e48\u4e22\u5f03\u5199\u5165\u5185\u5bb9\u662f\u6781\u5176\u5371\u9669\u7684\u64cd\u4f5c</li> <li> <p>\u5728 GitHub \u7684\u4e00\u573a\u4e8b\u6545\\(^{[4]}\\)\u4e2d\uff0c\u6570\u636e\u5e93\u4f7f\u7528\u81ea\u589e\u4e3b\u952e\uff0c\u65b0\u4e3b\u5e93\u8ba1\u6570\u5668\u843d\u540e\u4e8e\u8001\u4e3b\u5e93\uff0c\u8fd9\u4e9b\u4e3b\u952e\u5e76\u4e14\u5728Redis\u4e5f\u4f7f\u7528\uff0c\u5bfc\u81f4\u6570\u636e\u4e0d\u4e00\u81f4\uff1b</p> </li> <li> <p>\u8111\u88c2\uff08split brain\uff09\uff1a\u53d1\u751f\u67d0\u4e9b\u6545\u969c\u65f6\uff08\u89c1\u7b2c\u516b\u7ae0\uff09\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e24\u4e2a\u8282\u70b9\u90fd\u4ee5\u4e3a\u81ea\u5df1\u662f\u4e3b\u5e93\u7684\u60c5\u51b5</p> </li> <li>\u5982\u679c\u4e24\u4e2a\u4e3b\u5e93\u90fd\u53ef\u4ee5\u63a5\u53d7\u5199\u64cd\u4f5c\uff0c\u5374\u6ca1\u6709\u51b2\u7a81\u89e3\u51b3\u673a\u5236\uff08\u8bf7\u53c2\u9605 \u201c\u591a\u4e3b\u590d\u5236\u201d\uff09\uff0c\u6570\u636e\u4f1a\u4e22\u5931\u6216\u635f\u574f\uff1b</li> <li>\u5f53\u68c0\u6d4b\u5230\u4e24\u4e2a\u4e3b\u5e93\u8282\u70b9\u540c\u65f6\u5b58\u5728\u65f6\u5173\u95ed\u5176\u4e2d\u4e00\u4e2a\u8282\u70b9\u65f6\uff08\u5c4f\u969c\uff08fencing\uff09\u673a\u5236\uff09\uff0c\u4f46\u7c97\u7cd9\u7684\u673a\u5236\u53ef\u80fd\u6700\u540e\u4f1a\u5bfc\u81f4\u4e24\u4e2a\u8282\u70b9\u90fd\u88ab\u5173\u95ed\\(^{[5]}\\)\uff1b</li> </ul> <p>\u5982\u4f55\u914d\u7f6e\u6b63\u786e\u7684\u8d85\u65f6\u65f6\u95f4\uff1a</p> <ul> <li>\u8d85\u65f6\u65f6\u95f4\u8d8a\u957f\u610f\u5473\u7740\u6062\u590d\u65f6\u95f4\u4e5f\u8d8a\u957f\uff1b</li> <li>\u8d85\u65f6\u8bbe\u7f6e\u592a\u77ed\uff0c\u53c8\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e0d\u5fc5\u8981\u7684\u6545\u969c\u5207\u6362\uff1b</li> <li>\u9ad8\u8d1f\u8f7d\u548c\u7f51\u7edc\u6545\u969c\u4f1a\u5bfc\u81f4\u54cd\u5e94\u8d85\u65f6\uff0c\u5982\u679c\u7cfb\u7edf\u5df2\u7ecf\u5904\u4e8e\u9ad8\u8d1f\u8f7d\u6216\u7f51\u7edc\u95ee\u9898\u7684\u56f0\u6270\u4e4b\u4e2d\uff0c\u90a3\u4e48\u4e0d\u5fc5\u8981\u7684\u6545\u969c\u5207\u6362\u53ef\u80fd\u4f1a\u8ba9\u60c5\u51b5\u53d8\u5f97\u66f4\u7cdf\u7cd5</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_8","title":"\u590d\u5236\u65e5\u5fd7\u7684\u5b9e\u73b0","text":"<p>\u57fa\u4e8e\u9886\u5bfc\u8005\u7684\u590d\u5236\u5728\u5e95\u5c42\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff1f\u5b9e\u8df5\u4e2d\u6709\u597d\u51e0\u79cd\u4e0d\u540c\u7684\u590d\u5236\u65b9\u5f0f\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_9","title":"\u57fa\u4e8e\u8bed\u53e5\u7684\u590d\u5236","text":"<p>\u4e3b\u5e93\u8bb0\u5f55\u4e0b\u5b83\u6267\u884c\u7684\u6bcf\u4e2a\u5199\u5165\u8bf7\u6c42\uff08\u8bed\u53e5\uff0c\u5373 statement\uff09\u5e76\u5c06\u8be5\u8bed\u53e5\u65e5\u5fd7\u53d1\u9001\u7ed9\u4ece\u5e93</p> <ul> <li>\u975e\u786e\u5b9a\u6027\uff08nondeterministic\uff09 \u7684\u95ee\u9898\uff1a\u4f8b\u5982 <code>Now()</code> \u548c <code>Rand()</code> \u51fd\u6570\uff0c\u89e6\u53d1\u5668/\u5b58\u50a8\u8fc7\u7a0b\u4ea7\u751f\u53d1\u975e\u786e\u5b9a\u7684\u526f\u4f5c\u7528\u7b49\uff1b</li> <li>\u987a\u5e8f\u6267\u884c\uff1a\u5728\u6bcf\u4e2a\u526f\u672c\u4e0a\u6309\u7167\u5b8c\u5168\u76f8\u540c\u7684\u987a\u5e8f\u6267\u884c\u5b83\u4eec</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#wal","title":"\u4f20\u8f93\u9884\u5199\u5f0f\u65e5\u5fd7\uff08WAL\uff09","text":"<p>\u901a\u5e38\u4f1a\u5c06\u5199\u64cd\u4f5c\u8ffd\u52a0\u5230\u65e5\u5fd7\u4e2d\uff1a\u65e5\u5fd7\u90fd\u662f\u5305\u542b\u6240\u6709\u6570\u636e\u5e93\u5199\u5165\u7684\u4ec5\u8ffd\u52a0\u5b57\u8282\u5e8f\u5217\uff0c\u53ef\u4ee5\u4f7f\u7528\u5b8c\u5168\u76f8\u540c\u7684\u65e5\u5fd7\u5728\u53e6\u4e00\u4e2a\u8282\u70b9\u4e0a\u6784\u5efa\u526f\u672c</p> <ul> <li>\u5bf9\u4e8e\u65e5\u5fd7\u7ed3\u6784\u5b58\u50a8\u5f15\u64ce\uff08\u8bf7\u53c2\u9605 \u201cSSTables \u548c LSM \u6811\u201d\uff09\uff0c\u65e5\u5fd7\u662f\u4e3b\u8981\u7684\u5b58\u50a8\u4f4d\u7f6e\u3002\u65e5\u5fd7\u6bb5\u5728\u540e\u53f0\u538b\u7f29\uff0c\u5e76\u8fdb\u884c\u5783\u573e\u56de\u6536\u3002</li> <li>\u5bf9\u4e8e\u8986\u5199\u5355\u4e2a\u78c1\u76d8\u5757\u7684 B \u6811\uff0c\u6bcf\u6b21\u4fee\u6539\u90fd\u4f1a\u5148\u5199\u5165 \u9884\u5199\u5f0f\u65e5\u5fd7\uff08Write Ahead Log, WAL\uff09\uff0c\u4ee5\u4fbf\u5d29\u6e83\u540e\u7d22\u5f15\u53ef\u4ee5\u6062\u590d\u5230\u4e00\u4e2a\u4e00\u81f4\u7684\u72b6\u6001</li> </ul> <p>\u901a\u8fc7\u4f7f\u7528\u8fd9\u4e2a\u65e5\u5fd7\uff0c\u4ece\u5e93\u53ef\u4ee5\u6784\u5efa\u4e00\u4e2a\u4e0e\u4e3b\u5e93\u4e00\u6a21\u4e00\u6837\u7684\u6570\u636e\u7ed3\u6784\u62f7\u8d1d\u3002</p> <ul> <li>\u7f3a\u70b9\u662f\u65e5\u5fd7\u8bb0\u5f55\u7684\u6570\u636e\u975e\u5e38\u5e95\u5c42\uff1aWAL \u5305\u542b\u54ea\u4e9b\u78c1\u76d8\u5757\u4e2d\u7684\u54ea\u4e9b\u5b57\u8282\u53d1\u751f\u4e86\u66f4\u6539\u3002</li> <li>\u590d\u5236\u4e0e\u5b58\u50a8\u5f15\u64ce\u7d27\u5bc6\u8026\u5408\uff0c\u5b58\u50a8\u683c\u5f0f\u7684\u53d8\u66f4\u7684\u517c\u5bb9\u6027\uff08\u5347\u7ea7\u7248\u672c\u662f\u5426\u9700\u8981\u505c\u673a\uff09\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_10","title":"\u903b\u8f91\u65e5\u5fd7\u590d\u5236\uff08\u57fa\u4e8e\u884c\uff09","text":"<p>\u5bf9\u590d\u5236\u548c\u5b58\u50a8\u5f15\u64ce\u4f7f\u7528\u4e0d\u540c\u7684\u65e5\u5fd7\u683c\u5f0f\uff0c\u8fd9\u6837\u53ef\u4ee5\u5c06\u590d\u5236\u65e5\u5fd7\u4ece\u5b58\u50a8\u5f15\u64ce\u7684\u5185\u90e8\u5b9e\u73b0\u4e2d\u89e3\u8026\u51fa\u6765</p> <ul> <li>\u903b\u8f91\u65e5\u5fd7\uff08logical log\uff09\uff1a\u4ee5\u5c06\u5176\u4e0e\u5b58\u50a8\u5f15\u64ce\u7684\uff08\u7269\u7406\uff09\u6570\u636e\u8868\u793a\u533a\u5206\u5f00\u6765</li> </ul> <p>\u5173\u7cfb\u6570\u636e\u5e93\u7684\u903b\u8f91\u65e5\u5fd7\u901a\u5e38\u662f\u4ee5\u884c\u7684\u7c92\u5ea6\u6765\u63cf\u8ff0\u5bf9\u6570\u636e\u5e93\u8868\u7684\u5199\u5165\u8bb0\u5f55\u7684\u5e8f\u5217\uff1a</p> <ul> <li>\u5bf9\u4e8e\u63d2\u5165\u7684\u884c\uff0c\u65e5\u5fd7\u5305\u542b\u6240\u6709\u5217\u7684\u65b0\u503c\uff1b</li> <li>\u5bf9\u4e8e\u5220\u9664\u7684\u884c\uff0c\u4e3b\u952e\u552f\u4e00\u6807\u8bc6\u884c\uff0c\u5982\u679c\u6ca1\u6709\u4e3b\u952e\uff0c\u5219\u8bb0\u5f55\u6240\u6709\u65e7\u5217\u7684\u503c\uff1b</li> <li>\u5bf9\u4e8e\u66f4\u65b0\u7684\u884c\uff0c\u8db3\u591f\u7684\u4fe1\u606f\u6765\u552f\u4e00\u6807\u8bc6\u88ab\u66f4\u65b0\u7684\u884c\uff0c\u4ee5\u53ca\u6240\u6709\u5217\u7684\u65b0\u503c\uff08\u6216\u81f3\u5c11\u6240\u6709\u5df2\u66f4\u6539\u7684\u5217\u7684\u65b0\u503c\uff09</li> </ul> <p>\u4fee\u6539\u591a\u884c\u7684\u4e8b\u52a1\u4f1a\u751f\u6210\u591a\u6761\u8fd9\u6837\u7684\u65e5\u5fd7\u8bb0\u5f55\uff0c\u540e\u9762\u8ddf\u7740\u4e00\u6761\u6307\u660e\u4e8b\u52a1\u5df2\u7ecf\u63d0\u4ea4\u7684\u8bb0\u5f55\u3002</p> <ul> <li>\u903b\u8f91\u65e5\u5fd7\u4e0e\u5b58\u50a8\u5f15\u64ce\u7684\u5185\u90e8\u5b9e\u73b0\u662f\u89e3\u8026\u7684\uff0c\u7cfb\u7edf\u53ef\u4ee5\u66f4\u5bb9\u6613\u5730\u505a\u5230\u5411\u540e\u517c\u5bb9\uff1b</li> <li>\u903b\u8f91\u65e5\u5fd7\u683c\u5f0f\u4e5f\u66f4\u5bb9\u6613\u89e3\u6790\uff0c\u7528\u4e8e\u6570\u636e\u53d8\u66f4\u6355\u83b7\uff08change data capture\uff09\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_11","title":"\u57fa\u4e8e\u89e6\u53d1\u5668\u7684\u590d\u5236","text":"<p>\u5230\u76ee\u524d\u4e3a\u6b62\u63cf\u8ff0\u7684\u590d\u5236\u65b9\u6cd5\u662f\u7531\u6570\u636e\u5e93\u7cfb\u7edf\u5b9e\u73b0\u7684\uff0c\u4e0d\u6d89\u53ca\u4efb\u4f55\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u3002</p> <p>\u67d0\u4e9b\u60c5\u51b5\u4e0b\u9700\u8981\u66f4\u591a\u7684\u7075\u6d3b\u6027\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u53ea\u60f3\u590d\u5236\u6570\u636e\u7684\u4e00\u4e2a\u5b50\u96c6\uff0c\u6216\u8005\u60f3\u4ece\u4e00\u79cd\u6570\u636e\u5e93\u590d\u5236\u5230\u53e6\u4e00\u79cd\u6570\u636e\u5e93\uff0c\u6216\u8005\u5982\u679c\u4f60\u9700\u8981\u51b2\u7a81\u89e3\u51b3\u903b\u8f91\uff08\u8bf7\u53c2\u9605 \u201c\u5904\u7406\u5199\u5165\u51b2\u7a81\u201d\uff09\uff1a</p> <ul> <li>\u89e6\u53d1\u5668\u6709\u673a\u4f1a\u5c06\u66f4\u6539\u8bb0\u5f55\u5230\u4e00\u4e2a\u5355\u72ec\u7684\u8868\u4e2d\uff0c\u4f7f\u7528\u5916\u90e8\u7a0b\u5e8f\u8bfb\u53d6\u8fd9\u4e2a\u8868\uff0c\u518d\u52a0\u4e0a\u4e00\u4e9b\u5fc5\u8981\u7684\u4e1a\u52a1\u903b\u8f91\uff0c\u5c31\u53ef\u4ee5\u5c06\u6570\u636e\u53d8\u66f4\u590d\u5236\u5230\u53e6\u4e00\u4e2a\u7cfb\u7edf\u53bb\uff1b</li> <li>\u57fa\u4e8e\u89e6\u53d1\u5668\u7684\u590d\u5236\u901a\u5e38\u6bd4\u5176\u4ed6\u590d\u5236\u65b9\u6cd5\u5177\u6709\u66f4\u9ad8\u7684\u5f00\u9500\uff0c\u5e76\u4e14\u6bd4\u6570\u636e\u5e93\u5185\u7f6e\u7684\u590d\u5236\u66f4\u5bb9\u6613\u51fa\u9519\uff0c\u4e5f\u6709\u5f88\u591a\u9650\u5236\uff0c\u4f46\u662f\u66f4\u7075\u6d3b\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_12","title":"\u590d\u5236\u5ef6\u8fdf\u95ee\u9898","text":"<p>\u63a2\u8ba8\u590d\u5236\u5ef6\u8fdf\u7684\u6ede\u540e\u65f6\u95f4\u592a\u957f\u5f15\u5165\u7684\u4e0d\u4e00\u81f4\u6027\u6240\u5bfc\u81f4\u7684\u95ee\u9898\uff0c\u4ee5\u53ca\u76f8\u5173\u7684\u89e3\u51b3\u65b9\u6848\u3002</p> <p>\u5bf9\u4e8e\u8bfb\u591a\u5199\u5c11\u7684\u573a\u666f\uff08Web \u4e0a\u7684\u5e38\u89c1\u6a21\u5f0f\uff09\uff0c\u901a\u5e38\u521b\u5efa\u4e00\u4e3b\u591a\u4ece\uff0c\u5c06\u8bfb\u8bf7\u6c42\u5206\u6563\u5230\u6240\u6709\u7684\u4ece\u5e93\uff0c\u5e76\u5141\u8bb8\u7531\u9644\u8fd1\u7684\u526f\u672c\u6765\u5904\u7406\u8bfb\u8bf7\u6c42\uff1a</p> <ul> <li>\u5f02\u6b65\u590d\u5236\uff1a\u5b8c\u5168\u540c\u6b65\u7684\u914d\u7f6e\u5c06\u662f\u975e\u5e38\u4e0d\u53ef\u9760\uff0c\u5355\u4e2a\u8282\u70b9\u5f02\u5e38\u5bfc\u81f4\u7cfb\u7edf\u65e0\u6cd5\u5199\u5165\uff1b</li> <li>\u4e00\u81f4\u6027\u95ee\u9898\uff1a\u540c\u65f6\u5bf9\u4e3b\u5e93\u548c\u4ece\u5e93\u6267\u884c\u76f8\u540c\u7684\u67e5\u8be2\uff0c\u53ef\u80fd\u5f97\u5230\u4e0d\u540c\u7684\u7ed3\u679c\uff0c\u53ea\u5177\u5907\u6700\u7ec8\u4e00\u81f4\u6027\uff1b</li> </ul> <p>\u590d\u5236\u5ef6\u8fdf\uff08replication lag\uff09\uff0c\u5373\u5199\u5165\u4e3b\u5e93\u5230\u53cd\u6620\u81f3\u4ece\u5e93\u4e4b\u95f4\u7684\u5ef6\u8fdf</p> <ul> <li>\u53ef\u80fd\u4ec5\u4ec5\u662f\u51e0\u5206\u4e4b\u4e00\u79d2\uff0c\u5728\u5b9e\u8df5\u4e2d\u5e76\u4e0d\u663e\u773c</li> <li>\u5982\u679c\u7cfb\u7edf\u5728\u63a5\u8fd1\u6781\u9650\u7684\u60c5\u51b5\u4e0b\u8fd0\u884c\uff0c\u6216\u7f51\u7edc\u4e2d\u5b58\u5728\u95ee\u9898\u65f6\uff0c\u5ef6\u8fdf\u53ef\u4ee5\u8f7b\u800c\u6613\u4e3e\u5730\u8d85\u8fc7\u51e0\u79d2\uff0c\u751a\u81f3\u8fbe\u5230\u51e0\u5206\u949f</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_13","title":"\u8bfb\u5df1\u4e4b\u5199","text":"<p>\u7528\u6237\u5199\u5165\u540e\u4ece\u65e7\u526f\u672c\u4e2d\u8bfb\u53d6\u6570\u636e\uff1a\u9700\u8981\u5199\u540e\u8bfb (read-after-write) \u7684\u4e00\u81f4\u6027\uff0c\u4e5f\u79f0\u4e3a \u8bfb\u5df1\u4e4b\u5199\u4e00\u81f4\u6027\uff08read-your-writes consistency\uff09\\(^{[6]}\\)</p> <ul> <li>\u5982\u679c\u7528\u6237\u91cd\u65b0\u52a0\u8f7d\u9875\u9762\uff0c\u4ed6\u4eec\u603b\u4f1a\u770b\u5230\u4ed6\u4eec\u81ea\u5df1\u63d0\u4ea4\u7684\u4efb\u4f55\u66f4\u65b0\uff0c\u4f46\u4e0d\u5bf9\u5176\u5b83\u7528\u6237\u505a\u51fa\u627f\u8bfa\uff1b</li> </ul> <p></p> <p>\u5982\u4f55\u5728\u57fa\u4e8e\u9886\u5bfc\u8005\u7684\u590d\u5236\u7cfb\u7edf\u4e2d\u5b9e\u73b0\u5199\u540e\u8bfb\u4e00\u81f4\u6027\uff1f\u6709\u5404\u79cd\u53ef\u80fd\u7684\u6280\u672f\uff1a</p> <ul> <li>\u5bf9\u4e8e\u7528\u6237 \u53ef\u80fd\u4fee\u6539\u8fc7 \u7684\u5185\u5bb9\uff0c\u603b\u662f\u4ece\u4e3b\u5e93\u8bfb\u53d6\uff1a\u6709\u529e\u6cd5\u4e0d\u901a\u8fc7\u5b9e\u9645\u7684\u67e5\u8be2\u5c31\u53ef\u4ee5\u77e5\u9053\u7528\u6237\u662f\u5426\u4fee\u6539\u4e86\u67d0\u4e9b\u4e1c\u897f</li> <li>\u603b\u662f\u4ece\u4e3b\u5e93\u8bfb\u53d6\u7528\u6237\u81ea\u5df1\u7684\u6863\u6848\uff0c\u4ece\u5e93\u8bfb\u53d6\u5176\u4ed6\u7528\u6237\u7684\u6863\u6848\uff1a\u56e0\u4e3a\u7528\u6237\u4e2a\u4eba\u8d44\u6599\u4fe1\u606f\u901a\u5e38\u53ea\u80fd\u7531\u7528\u6237\u672c\u4eba\u7f16\u8f91\uff0c\u800c\u4e0d\u80fd\u7531\u5176\u4ed6\u4eba\u7f16\u8f91\uff1a</li> <li>\u5e94\u7528\u4e2d\u7684\u5927\u90e8\u5206\u5185\u5bb9\u90fd\u53ef\u80fd\u88ab\u7528\u6237\u7f16\u8f91\u7684\u573a\u666f\uff1a\u4e0a\u8ff0\u529e\u6cd5\u6ca1\u7528\uff0c\u9700\u8981\u4f7f\u7528\u5176\u5b83\u6807\u51c6</li> <li>\u8ddf\u8e2a\u4e0a\u6b21\u66f4\u65b0\u7684\u65f6\u95f4\uff0c\u5728\u4e0a\u6b21\u66f4\u65b0\u540e\u7684\u4e00\u5206\u949f\u5185\uff0c\u4ece\u4e3b\u5e93\u8bfb</li> <li>\u76d1\u63a7\u4ece\u5e93\u7684\u590d\u5236\u5ef6\u8fdf\uff0c\u9632\u6b62\u5411\u4efb\u4f55\u6ede\u540e\u4e3b\u5e93\u8d85\u8fc7\u4e00\u5206\u949f\u7684\u4ece\u5e93\u53d1\u51fa\u67e5\u8be2</li> <li>\u5ba2\u6237\u7aef\u53ef\u4ee5\u8bb0\u4f4f\u6700\u8fd1\u4e00\u6b21\u5199\u5165\u7684\u65f6\u95f4\u6233\uff08\u67e5\u8be2\u65f6\u5e26\u4e0a\uff09\uff0c\u7cfb\u7edf\u9700\u8981\u786e\u4fdd\u4ece\u5e93\u5728\u5904\u7406\u8be5\u7528\u6237\u7684\u8bfb\u53d6\u8bf7\u6c42\u65f6\uff0c\u8be5\u65f6\u95f4\u6233\u524d\u7684\u53d8\u66f4\u90fd\u5df2\u7ecf\u4f20\u64ad\u5230\u4e86\u672c\u4ece\u5e93\u4e2d</li> <li>\u5f53\u524d\u4ece\u5e93\u4e0d\u591f\u65b0\uff0c\u5219\u53ef\u4ee5\u4ece\u53e6\u4e00\u4e2a\u4ece\u5e93\u8bfb\u53d6\uff0c\u6216\u8005\u7b49\u5f85\u4ece\u5e93\u8ffd\u8d76\u4e0a\u6765</li> <li> <p>\u65f6\u95f4\u6233\u53ef\u4ee5\u662f\u903b\u8f91\u65f6\u95f4\u6233\uff08\u8868\u793a\u5199\u5165\u987a\u5e8f\u7684\u4e1c\u897f\uff0c\u4f8b\u5982\u65e5\u5fd7\u5e8f\u5217\u53f7\uff09\u6216\u5b9e\u9645\u7684\u7cfb\u7edf\u65f6\u949f\uff08\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u65f6\u949f\u540c\u6b65\u53d8\u5f97\u81f3\u5173\u91cd\u8981\uff09</p> </li> <li> <p>\u526f\u672c\u5206\u5e03\u5728\u591a\u4e2a\u6570\u636e\u4e2d\u5fc3\uff08\u5728\u5730\u7406\u4e0a\u63a5\u8fd1\u7528\u6237\u6216\u8005\u51fa\u4e8e\u53ef\u7528\u6027\u76ee\u7684\uff09\uff0c\u6709\u989d\u5916\u7684\u590d\u6742\u6027\u3002</p> </li> <li>\u4efb\u4f55\u9700\u8981\u7531\u4e3b\u5e93\u63d0\u4f9b\u670d\u52a1\u7684\u8bf7\u6c42\u90fd\u5fc5\u987b\u8def\u7531\u5230\u5305\u542b\u8be5\u4e3b\u5e93\u7684\u6570\u636e\u4e2d\u5fc3\uff0c\u800c\u4e0d\u518d\u662f\u5c31\u8fd1\u7684\u6570\u636e\u4e2d\u5fc3\uff1b</li> </ul> <p>\u66f4\u590d\u6742\u7684\u60c5\u51b5\uff1a\u540c\u4e00\u4f4d\u7528\u6237\u4ece\u591a\u4e2a\u8bbe\u5907\uff08\u4f8b\u5982\u684c\u9762\u6d4f\u89c8\u5668\u548c\u79fb\u52a8 APP\uff09\u8bf7\u6c42\u670d\u52a1\u7684\u65f6\u5019\uff0c\u8de8\u8bbe\u5907\u7684\u5199\u540e\u8bfb\u4e00\u81f4\u6027</p> <ul> <li>\u5982\u679c\u7528\u6237\u5728\u4e00\u4e2a\u8bbe\u5907\u4e0a\u8f93\u5165\u4e86\u4e00\u4e9b\u4fe1\u606f\uff0c\u7136\u540e\u5728\u53e6\u4e00\u4e2a\u8bbe\u5907\u4e0a\u67e5\u770b\uff0c\u5219\u5e94\u8be5\u770b\u5230\u4ed6\u4eec\u521a\u8f93\u5165\u7684\u4fe1\u606f\u3002</li> <li>\u8bb0\u4f4f\u7528\u6237\u4e0a\u6b21\u66f4\u65b0\u65f6\u95f4\u6233\u7684\u65b9\u6cd5\u53d8\u5f97\u66f4\u52a0\u56f0\u96be\uff1a\u5bf9\u8fd9\u4e9b\u5143\u6570\u636e\u8fdb\u884c\u4e2d\u5fc3\u5316\u7684\u5b58\u50a8\uff0c\u56e0\u4e3a\u4e00\u4e2a\u8bbe\u5907\u4e0a\u8fd0\u884c\u7684\u7a0b\u5e8f\u4e0d\u77e5\u9053\u53e6\u4e00\u4e2a\u8bbe\u5907\u4e0a\u53d1\u751f\u4e86\u4ec0\u4e48\uff1b</li> <li>\u5982\u679c\u526f\u672c\u5206\u5e03\u5728\u4e0d\u540c\u7684\u6570\u636e\u4e2d\u5fc3\uff0c\u5f88\u96be\u4fdd\u8bc1\u6765\u81ea\u4e0d\u540c\u8bbe\u5907\u7684\u8fde\u63a5\uff08\u5bbd\u5e26\u548c\u8702\u7a9d\u6570\u636e\u7f51\u7edc\uff09\u4f1a\u8def\u7531\u5230\u540c\u4e00\u6570\u636e\u4e2d\u5fc3</li> <li>\u5982\u679c\u8bf7\u6c42\u9700\u8981\u8bfb\u4e3b\u5e93\uff0c\u53ef\u80fd\u9996\u5148\u9700\u8981\u628a\u6765\u81ea\u8be5\u7528\u6237\u6240\u6709\u8bbe\u5907\u7684\u8bf7\u6c42\u90fd\u8def\u7531\u5230\u540c\u4e00\u4e2a\u6570\u636e\u4e2d\u5fc3\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_14","title":"\u5355\u8c03\u8bfb","text":"<p>\u65f6\u5149\u5012\u6d41\uff08moving backward in time\uff09\uff1a\u4ece\u5f02\u6b65\u4ece\u5e93\u8bfb\u53d6\u65f6\u53ef\u80fd\u53d1\u751f\u7684\u5f02\u5e38\u3002</p> <ul> <li>\u4ece\u4e0d\u540c\u4ece\u5e93\u8fdb\u884c\u591a\u6b21\u8bfb\u53d6\u65f6</li> </ul> <p>\u7528\u6237\u9996\u5148\u4ece\u65b0\u526f\u672c\u8bfb\u53d6\uff0c\u7136\u540e\u4ece\u65e7\u526f\u672c\u8bfb\u53d6\u3002\u65f6\u95f4\u770b\u4e0a\u53bb\u56de\u9000\u4e86\u3002\u4e3a\u4e86\u9632\u6b62\u8fd9\u79cd\u5f02\u5e38\uff0c\u6211\u4eec\u9700\u8981\u5355\u8c03\u7684\u8bfb\u53d6\u3002</p> <p></p> <p>\u5355\u8c03\u8bfb\uff08monotonic reads\uff09\\(^{[7]}\\)\u53ef\u4ee5\u4fdd\u8bc1\u8fd9\u79cd\u5f02\u5e38\u4e0d\u4f1a\u53d1\u751f\uff0c\u6bd4 \u5f3a\u4e00\u81f4\u6027\uff08strong consistency\uff09 \u5f31\uff0c\u4f46\u6bd4 \u6700\u7ec8\u4e00\u81f4\u6027\uff08eventual consistency\uff09 \u5f3a\u3002</p> <ul> <li>\u5f53\u8bfb\u53d6\u6570\u636e\u65f6\uff0c\u53ef\u80fd\u4f1a\u770b\u5230\u4e00\u4e2a\u65e7\u503c\uff1b</li> <li>\u5982\u679c\u5df2\u7ecf\u8bfb\u53d6\u5230\u8f83\u65b0\u7684\u6570\u636e\uff0c\u540e\u7eed\u7684\u8bfb\u53d6\u4e0d\u4f1a\u5f97\u5230\u66f4\u65e7\u7684\u6570\u636e\uff1b</li> </ul> <p>\u5b9e\u73b0\u5355\u8c03\u8bfb\u7684\u4e00\u79cd\u65b9\u5f0f\u662f\u786e\u4fdd\u6bcf\u4e2a\u7528\u6237\u603b\u662f\u4ece\u540c\u4e00\u4e2a\u526f\u672c\u8fdb\u884c\u8bfb\u53d6\uff08\u4e0d\u540c\u7684\u7528\u6237\u53ef\u4ee5\u4ece\u4e0d\u540c\u7684\u526f\u672c\u8bfb\u53d6\uff09\u3002</p> <ul> <li>\u57fa\u4e8e\u7528\u6237 ID \u7684\u6563\u5217\u6765\u9009\u62e9\u526f\u672c\uff0c\u5982\u679c\u8be5\u526f\u672c\u51fa\u73b0\u6545\u969c\uff0c\u7528\u6237\u7684\u67e5\u8be2\u5c06\u9700\u8981\u91cd\u65b0\u8def\u7531\u5230\u53e6\u4e00\u4e2a\u526f\u672c\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_15","title":"\u4e00\u81f4\u524d\u7f00\u8bfb","text":"<p>\u4ece\u4e0d\u540c\u7684\u4ece\u5e93\u8bfb\u6570\u636e\u65f6\u53ef\u80fd\u8fdd\u53cd\u4e86\u56e0\u679c\u5f8b\uff1a\u5148\u8bfb\u5230\u56de\u590d\u7684\u5185\u5bb9\uff0c\u518d\u8bfb\u5230\u63d0\u95ee\u7684\u5185\u5bb9</p> <p>\u5982\u679c\u67d0\u4e9b\u5206\u533a\u7684\u590d\u5236\u901f\u5ea6\u6162\u4e8e\u5176\u4ed6\u5206\u533a\uff0c\u90a3\u4e48\u89c2\u5bdf\u8005\u53ef\u80fd\u4f1a\u5728\u770b\u5230\u95ee\u9898\u4e4b\u524d\u5148\u770b\u5230\u7b54\u6848\u3002</p> <p></p> <p>\u4e00\u81f4\u524d\u7f00\u8bfb\uff08consistent prefix reads\uff09\\(^{[7]}\\)\u53ef\u4ee5\u9632\u6b62\u8fd9\u79cd\u5f02\u5e38</p> <ul> <li>\u5982\u679c\u4e00\u7cfb\u5217\u5199\u5165\u6309\u67d0\u4e2a\u987a\u5e8f\u53d1\u751f\uff0c\u90a3\u4e48\u4efb\u4f55\u4eba\u8bfb\u53d6\u8fd9\u4e9b\u5199\u5165\u65f6\uff0c\u4e5f\u4f1a\u770b\u89c1\u5b83\u4eec\u4ee5\u540c\u6837\u7684\u987a\u5e8f\u51fa\u73b0\u3002</li> </ul> <p>\u8fd9\u662f \u5206\u533a\uff08partitioned\uff09 \u6216 \u5206\u7247\uff08sharded\uff09 \u6570\u636e\u5e93\u4e2d\u7684\u4e00\u4e2a\u7279\u6b8a\u95ee\u9898\uff1a\u67d0\u4e9b\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u4e2d\u4e0d\u540c\u7684\u5206\u533a\u72ec\u7acb\u8fd0\u884c\uff0c\u56e0\u6b64\u4e0d\u5b58\u5728 \u5168\u5c40\u7684\u5199\u5165\u987a\u5e8f</p> <ul> <li>\u5f53\u7528\u6237\u4ece\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u6570\u636e\u65f6\uff0c\u53ef\u80fd\u4f1a\u770b\u5230\u6570\u636e\u5e93\u7684\u67d0\u4e9b\u90e8\u5206\u5904\u4e8e\u8f83\u65e7\u7684\u72b6\u6001\uff0c\u800c\u67d0\u4e9b\u5219\u5904\u4e8e\u8f83\u65b0\u7684\u72b6\u6001</li> </ul> <p>\u89e3\u51b3\u65b9\u6848\uff1a</p> <ul> <li>\u786e\u4fdd\u4efb\u4f55\u56e0\u679c\u76f8\u5173\u7684\u5199\u5165\u90fd\u5199\u5165\u76f8\u540c\u7684\u5206\u533a\uff0c\u4f46\u5728\u4e00\u4e9b\u5e94\u7528\u4e2d\u53ef\u80fd\u65e0\u6cd5\u9ad8\u6548\u5730\u5b8c\u6210\u8fd9\u79cd\u64cd\u4f5c\u3002</li> <li>\u901a\u8fc7\u663e\u5f0f\u8ddf\u8e2a\u56e0\u679c\u4f9d\u8d56\u5173\u7cfb\u7684\u7b97\u6cd5\uff0c\u89c1 \u6b64\u524d\u53d1\u751f\u201d \u7684\u5173\u7cfb\u548c\u5e76\u53d1</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_16","title":"\u590d\u5236\u5ef6\u8fdf\u7684\u89e3\u51b3\u65b9\u6848","text":"<p>\u5728\u4f7f\u7528\u6700\u7ec8\u4e00\u81f4\u7684\u7cfb\u7edf\u65f6\uff0c\u5982\u679c\u590d\u5236\u5ef6\u8fdf\u589e\u52a0\u5230\u51e0\u5206\u949f\u751a\u81f3\u51e0\u5c0f\u65f6\uff0c\u5219\u5e94\u8be5\u8003\u8651\u5e94\u7528\u7a0b\u5e8f\u7684\u884c\u4e3a\u3002</p> <ul> <li>\u7b54\u6848\u662f \u201c\u6ca1\u95ee\u9898\u201d\uff0c\u90a3\u5f88\u597d</li> <li>\u7528\u6237\u6765\u8bf4\u662f\u4e0d\u597d\u7684\u4f53\u9a8c\uff0c\u90a3\u4e48\u8bbe\u8ba1\u7cfb\u7edf\u6765\u63d0\u4f9b\u66f4\u5f3a\u7684\u4fdd\u8bc1\uff08\u4f8b\u5982 \u5199\u540e\u8bfb\uff09</li> </ul> <p>\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u63d0\u4f9b\u6bd4\u5e95\u5c42\u6570\u636e\u5e93\u66f4\u5f3a\u6709\u529b\u7684\u4fdd\u8bc1\uff0c\u4f8b\u5982\u901a\u8fc7\u4e3b\u5e93\u8fdb\u884c\u67d0\u79cd\u8bfb\u53d6\u3002\u4f46\u5728\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u4e2d\u5904\u7406\u8fd9\u4e9b\u95ee\u9898\u662f\u590d\u6742\u7684\uff0c\u5bb9\u6613\u51fa\u9519\u3002</p> <p>\u4e8b\u52a1\uff08transaction\uff09 \u5b58\u5728\u7684\u539f\u56e0\uff1a\u6570\u636e\u5e93\u901a\u8fc7\u4e8b\u52a1\u63d0\u4f9b\u5f3a\u5927\u7684\u4fdd\u8bc1</p> <ul> <li>\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u4e0d\u5fc5\u62c5\u5fc3\u5fae\u5999\u7684\u590d\u5236\u95ee\u9898\uff0c\u5e76\u53ef\u4ee5\u4fe1\u8d56\u4ed6\u4eec\u7684\u6570\u636e\u5e93 \u201c\u505a\u4e86\u6b63\u786e\u7684\u4e8b\u60c5\u201d</li> </ul> <p>\u5728\u8d70\u5411\u5206\u5e03\u5f0f\uff08\u590d\u5236\u548c\u5206\u533a\uff09\u6570\u636e\u5e93\u65f6\uff0c\u8bb8\u591a\u7cfb\u7edf\u653e\u5f03\u4e86\u4e8b\u52a1\uff0c\u58f0\u79f0\u4e8b\u52a1\u5728\u6027\u80fd\u548c\u53ef\u7528\u6027\u4e0a\u7684\u4ee3\u4ef7\u592a\u9ad8\uff0c\u5e76\u65ad\u8a00\u5728\u53ef\u4f38\u7f29\u7cfb\u7edf\u4e2d\u6700\u7ec8\u4e00\u81f4\u6027\u662f\u4e0d\u53ef\u907f\u514d\u7684\u3002</p> <ul> <li>\u7b2c\u4e03\u7ae0 \u548c \u7b2c\u4e5d\u7ae0 \u56de\u5230\u4e8b\u52a1\u7684\u8bdd\u9898\uff0c\u5e76\u5c06\u5728 \u7b2c\u4e09\u90e8\u5206 \u8ba8\u8bba\u4e00\u4e9b\u66ff\u4ee3\u673a\u5236\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_17","title":"\u591a\u4e3b\u590d\u5236","text":"<p>\u591a\u9886\u5bfc\u8005\u914d\u7f6e\uff08multi-leader configuration\uff0c\u4e5f\u79f0\u591a\u4e3b\u3001\u591a\u6d3b\u590d\u5236\uff0c\u5373 master-master replication \u6216 active/active replication\uff09</p> <ul> <li>\u5141\u8bb8\u591a\u4e2a\u8282\u70b9\u63a5\u53d7\u5199\u5165\uff1a\u5904\u7406\u5199\u5165\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u5fc5\u987b\u5c06\u8be5\u6570\u636e\u53d8\u66f4\u8f6c\u53d1\u7ed9\u6240\u6709\u5176\u4ed6\u8282\u70b9\u3002</li> <li>\u6bcf\u4e2a\u4e3b\u5e93\u540c\u65f6\u662f\u5176\u4ed6\u4e3b\u5e93\u7684\u4ece\u5e93</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_18","title":"\u591a\u4e3b\u590d\u5236\u7684\u5e94\u7528\u573a\u666f","text":"<p>\u5728\u5355\u4e2a\u6570\u636e\u4e2d\u5fc3\u5185\u90e8\u4f7f\u7528\u591a\u4e2a\u4e3b\u5e93\u7684\u914d\u7f6e\u6ca1\u6709\u592a\u5927\u610f\u4e49\uff0c\u56e0\u4e3a\u5176\u5bfc\u81f4\u7684\u590d\u6742\u6027\u5df2\u7ecf\u8d85\u8fc7\u4e86\u80fd\u5e26\u6765\u7684\u597d\u5904\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_19","title":"\u8fd0\u7ef4\u591a\u4e2a\u6570\u636e\u4e2d\u5fc3","text":"<p>\u526f\u672c\u5206\u6563\u5728\u597d\u51e0\u4e2a\u4e0d\u540c\u7684\u6570\u636e\u4e2d\u5fc3\uff08\u53ef\u80fd\u4f1a\u7528\u6765\u5bb9\u5fcd\u5355\u4e2a\u6570\u636e\u4e2d\u5fc3\u7684\u6545\u969c\uff0c\u6216\u8005\u4e3a\u4e86\u5728\u5730\u7406\u4e0a\u66f4\u63a5\u8fd1\u7528\u6237\uff09</p> <ul> <li>\u5728\u6bcf\u4e2a\u6570\u636e\u4e2d\u5fc3\u5185\u4f7f\u7528\u5e38\u89c4\u7684\u4e3b\u4ece\u590d\u5236</li> <li>\u6570\u636e\u4e2d\u5fc3\u4e4b\u95f4\uff0c\u6bcf\u4e2a\u6570\u636e\u4e2d\u5fc3\u7684\u4e3b\u5e93\u90fd\u4f1a\u5c06\u5176\u66f4\u6539\u590d\u5236\u5230\u5176\u4ed6\u6570\u636e\u4e2d\u5fc3\u7684\u4e3b\u5e93\u4e2d</li> </ul> <p>\u8de8\u591a\u4e2a\u6570\u636e\u4e2d\u5fc3\u7684\u591a\u4e3b\u590d\u5236</p> <p></p> <p>\u6bd4\u8f83\u4e00\u4e0b\u5728\u8fd0\u7ef4\u591a\u4e2a\u6570\u636e\u4e2d\u5fc3\u65f6\uff0c\u5355\u4e3b\u548c\u591a\u4e3b\u7684\u9002\u5e94\u60c5\u51b5</p> \u5355\u4e3b \u591a\u4e3b \u6027\u80fd \u6bcf\u4e2a\u5199\u5165\u90fd\u5fc5\u987b\u7a7f\u8fc7\u4e92\u8054\u7f51\uff0c\u8fdb\u5165\u4e3b\u5e93\u6240\u5728\u7684\u6570\u636e\u4e2d\u5fc3\u3002- \u589e\u52a0\u5199\u5165\u4e2d\u5fc3\uff0c\u8fdd\u80cc\u8bbe\u7f6e\u591a\u4e2a\u6570\u636e\u4e2d\u5fc3\u7684\u521d\u5fc3\uff1b \u6bcf\u4e2a\u5199\u64cd\u4f5c\u90fd\u53ef\u4ee5\u5728\u672c\u5730\u6570\u636e\u4e2d\u5fc3\u8fdb\u884c\u5904\u7406\uff0c\u5e76\u4e0e\u5176\u4ed6\u6570\u636e\u4e2d\u5fc3\u5f02\u6b65\u590d\u5236- \u6570\u636e\u4e2d\u5fc3\u7684\u7f51\u7edc\u5ef6\u8fdf\u5bf9\u7528\u6237\u900f\u660e\uff0c\u7528\u6237\u611f\u89c9\u6027\u80fd\u66f4\u597d \u5bb9\u5fcd\u6570\u636e\u4e2d\u5fc3\u505c\u673a \u6545\u969c\u5207\u6362\u5fc5\u987b\u4f7f\u53e6\u4e00\u4e2a\u6570\u636e\u4e2d\u5fc3\u91cc\u7684\u4ece\u5e93\u6210\u4e3a\u4e3b\u5e93 \u6bcf\u4e2a\u6570\u636e\u4e2d\u5fc3\u53ef\u4ee5\u72ec\u7acb\u4e8e\u5176\u4ed6\u6570\u636e\u4e2d\u5fc3\u7ee7\u7eed\u8fd0\u884c\uff0c\u5e76\u4e14\u5f53\u53d1\u751f\u6545\u969c\u7684\u6570\u636e\u4e2d\u5fc3\u6062\u590d\u4e0a\u7ebf\u65f6\uff0c\u590d\u5236\u4f1a\u81ea\u52a8\u8d76\u4e0a \u5bb9\u5fcd\u7f51\u7edc\u95ee\u9898 \u5bf9\u6570\u636e\u4e2d\u5fc3\u4e4b\u95f4\u7684\u8fde\u63a5\u95ee\u9898\u975e\u5e38\u654f\u611f\uff0c\u56e0\u4e3a\u901a\u8fc7\u8fd9\u4e2a\u8fde\u63a5\u8fdb\u884c\u7684\u5199\u64cd\u4f5c\u662f\u540c\u6b65\u7684 \u5f02\u6b65\u590d\u5236\u529f\u80fd\u7684\u591a\u4e3b\u914d\u7f6e\u901a\u5e38\u80fd\u66f4\u597d\u5730\u627f\u53d7\u7f51\u7edc\u95ee\u9898\uff0c\u4e34\u65f6\u7684\u7f51\u7edc\u4e2d\u65ad\u5e76\u4e0d\u4f1a\u59a8\u788d\u6b63\u5728\u5904\u7406\u7684\u5199\u5165\u3002 <p>\u591a\u4e3b\u590d\u5236\u5b58\u5728\u7684\u95ee\u9898\uff1a</p> <ul> <li>\u5199\u51b2\u7a81\uff1a\u4e24\u4e2a\u4e0d\u540c\u7684\u6570\u636e\u4e2d\u5fc3\u53ef\u80fd\u4f1a\u540c\u65f6\u4fee\u6539\u76f8\u540c\u7684\u6570\u636e\uff0c\u8be6\u7ec6\u89c1\u5904\u7406\u5199\u5165\u51b2\u7a81</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_20","title":"\u9700\u8981\u79bb\u7ebf\u64cd\u4f5c\u7684\u5ba2\u6237\u7aef","text":"<p>\u5e94\u7528\u7a0b\u5e8f\u5728\u65ad\u7f51\u4e4b\u540e\u4ecd\u7136\u9700\u8981\u7ee7\u7eed\u5de5\u4f5c\uff1a\u5982 \u624b\u673a\uff0c\u7b14\u8bb0\u672c\u7535\u8111\u548c\u5176\u4ed6\u8bbe\u5907\u4e0a\u7684\u65e5\u5386\u5e94\u7528</p> <ul> <li>\u6bcf\u4e2a\u8bbe\u5907\u90fd\u6709\u4e00\u4e2a\u5145\u5f53\u4e3b\u5e93\u7684\u672c\u5730\u6570\u636e\u5e93\uff08\u5b83\u63a5\u53d7\u5199\u8bf7\u6c42\uff09</li> <li>\u5728\u6240\u6709\u8bbe\u5907\u4e0a\u7684\u65e5\u5386\u526f\u672c\u4e4b\u95f4\u540c\u6b65\u65f6\uff0c\u5b58\u5728\u5f02\u6b65\u7684\u591a\u4e3b\u590d\u5236\u8fc7\u7a0b\u3002\u590d\u5236\u5ef6\u8fdf\u53ef\u80fd\u662f\u51e0\u5c0f\u65f6\u751a\u81f3\u51e0\u5929\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u4f55\u65f6\u53ef\u4ee5\u8bbf\u95ee\u4e92\u8054\u7f51</li> </ul> <p>\u4ece\u5386\u53f2\u4e0a\u5404\u7c7b\u65e5\u5386\u540c\u6b65\u529f\u80fd\u7684\u7834\u70c2\u5b9e\u73b0\u53ef\u4ee5\u770b\u51fa\uff0c\u60f3\u628a\u591a\u4e3b\u590d\u5236\u7528\u597d\u662f\u591a\u4e48\u56f0\u96be\u7684\u4e00\u4ef6\u4e8b\u3002</p> <p>\u6709\u4e00\u4e9b\u5de5\u5177\u65e8\u5728\u4f7f\u8fd9\u79cd\u591a\u4e3b\u914d\u7f6e\u66f4\u5bb9\u6613\u3002\u4f8b\u5982\uff0cCouchDB \\(^{[8]}\\)\u5c31\u662f\u4e3a\u8fd9\u79cd\u64cd\u4f5c\u6a21\u5f0f\uff08\u591a\u4e3b\u590d\u5236\uff09\u800c\u8bbe\u8ba1\u7684\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_21","title":"\u534f\u540c\u7f16\u8f91","text":"<p>\u5b9e\u65f6\u534f\u4f5c\u7f16\u8f91\u5e94\u7528\u7a0b\u5e8f\u5141\u8bb8\u591a\u4e2a\u4eba\u540c\u65f6\u7f16\u8f91\u6587\u6863\uff0c\u5982 Google Docs\uff0c\u98de\u4e66\u6587\u6863\u7b49\uff1a</p> <ul> <li>\u7b97\u6cd5\u5728 \u201c\u81ea\u52a8\u51b2\u7a81\u89e3\u51b3\u201d \u4e2d\u7b80\u8981\u8ba8\u8bba</li> </ul> <p>\u901a\u5e38\u4e0d\u4f1a\u5c06\u534f\u4f5c\u5f0f\u7f16\u8f91\u89c6\u4e3a\u6570\u636e\u5e93\u590d\u5236\u95ee\u9898\uff0c\u4f46\u5b83\u4e0e\u524d\u9762\u63d0\u5230\u7684\u79bb\u7ebf\u7f16\u8f91\u7528\u4f8b\u6709\u8bb8\u591a\u76f8\u4f3c\u4e4b\u5904</p> <ul> <li>\u5f53\u4e00\u4e2a\u7528\u6237\u7f16\u8f91\u6587\u6863\u65f6\uff0c\u6240\u505a\u7684\u66f4\u6539\u5c06\u7acb\u5373\u5e94\u7528\u5230\u5176\u672c\u5730\u526f\u672c\uff08\u5982Web \u6d4f\u89c8\u5668\uff09\uff0c\u5e76\u5f02\u6b65\u590d\u5236\u5230\u670d\u52a1\u5668\u548c\u7f16\u8f91\u540c\u4e00\u6587\u6863\u7684\u4efb\u4f55\u5176\u4ed6\u7528\u6237\u3002</li> </ul> <p>\u5982\u679c\u8981\u4fdd\u8bc1\u4e0d\u4f1a\u53d1\u751f\u7f16\u8f91\u51b2\u7a81\uff1a\u4e24\u79cd\u65b9\u5f0f</p> <ul> <li>\u53d6\u5f97\u6587\u6863\u7684\u9501\u5b9a\uff1a\u76f8\u5f53\u4e8e\u4e3b\u4ece\u590d\u5236\u6a21\u578b\u4e0b\u5728\u4e3b\u8282\u70b9\u4e0a\u6267\u884c\u4e8b\u52a1\u64cd\u4f5c</li> <li>\u66f4\u6539\u7684\u5355\u4f4d\u8bbe\u7f6e\u5f97\u975e\u5e38\u5c0f\uff08\u4f8b\u5982\u5355\u6b21\u6309\u952e\uff09\uff0c\u5e76\u907f\u514d\u9501\u5b9a\u3002\u6b64\u65f6\uff0c\u9700\u8981\u89e3\u51b3\u51b2\u7a81\\(^{[9]}\\)\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_22","title":"\u5904\u7406\u5199\u5165\u51b2\u7a81","text":"<p>\u591a\u4e3b\u590d\u5236\u7684\u6700\u5927\u95ee\u9898\u662f\u53ef\u80fd\u53d1\u751f\u5199\u51b2\u7a81\uff0c\u8fd9\u610f\u5473\u7740\u9700\u8981\u89e3\u51b3\u51b2\u7a81\u3002</p> <p>\u4e24\u4e2a\u4e3b\u5e93\u540c\u65f6\u66f4\u65b0\u540c\u4e00\u8bb0\u5f55\u5f15\u8d77\u7684\u5199\u5165\u51b2\u7a81</p> <ul> <li>\u7528\u6237 1 \u5c06\u9875\u9762\u7684\u6807\u9898\u4ece A \u66f4\u6539\u4e3a B\uff0c\u5e76\u4e14\u7528\u6237 2 \u540c\u65f6\u5c06\u6807\u9898\u4ece A \u66f4\u6539\u4e3a C\uff1b</li> <li>\u6bcf\u4e2a\u7528\u6237\u7684\u66f4\u6539\u5df2\u6210\u529f\u5e94\u7528\u5230\u5176\u672c\u5730\u4e3b\u5e93\u3002\u4f46\u5f53\u5f02\u6b65\u590d\u5236\u65f6\uff0c\u4f1a\u53d1\u73b0\u51b2\u7a81\\(^{[10]}\\)\uff1b</li> </ul> <p></p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_23","title":"\u540c\u6b65\u4e0e\u5f02\u6b65\u51b2\u7a81\u68c0\u6d4b","text":"<p>\u5982\u679c\u4f60\u60f3\u8981\u540c\u6b65\u51b2\u7a81\u68c0\u6d4b\uff0c\u90a3\u4e48\u4f60\u53ef\u80fd\u4e0d\u5982\u76f4\u63a5\u4f7f\u7528\u5355\u4e3b\u590d\u5236\u3002</p> <p>\u5728\u5355\u4e3b\u6570\u636e\u5e93\u4e2d\uff0c\u7b2c\u4e8c\u4e2a\u5199\u5165\u5c06\u88ab\u963b\u585e\u5e76\u7b49\u5f85\u7b2c\u4e00\u4e2a\u5199\u5165\u5b8c\u6210\uff0c\u6216\u8005\u4e2d\u6b62\u7b2c\u4e8c\u4e2a\u5199\u5165\u4e8b\u52a1\u5e76\u5f3a\u5236\u7528\u6237\u91cd\u8bd5\u3002</p> <p>\u5728\u591a\u4e3b\u914d\u7f6e\u4e2d\uff0c\u4e24\u4e2a\u5199\u5165\u90fd\u662f\u6210\u529f\u7684\uff0c\u5728\u7a0d\u540e\u7684\u67d0\u4e2a\u65f6\u95f4\u70b9\u624d\u80fd\u5f02\u6b65\u5730\u68c0\u6d4b\u5230\u51b2\u7a81\u3002\u90a3\u65f6\u518d\u6765\u8981\u6c42\u7528\u6237\u89e3\u51b3\u51b2\u7a81\u53ef\u80fd\u4e3a\u65f6\u5df2\u665a\u3002</p> <p>\u51b2\u7a81\u68c0\u6d4b\u540c\u6b65\uff1a\u5373\u7b49\u5f85\u5199\u5165\u88ab\u590d\u5236\u5230\u6240\u6709\u526f\u672c\uff0c\u7136\u540e\u518d\u544a\u8bc9\u7528\u6237\u5199\u5165\u6210\u529f</p> <ul> <li>\u5931\u53bb\u591a\u4e3b\u590d\u5236\u7684\u4e3b\u8981\u4f18\u70b9\uff1a\u5141\u8bb8\u6bcf\u4e2a\u526f\u672c\u72ec\u7acb\u5730\u63a5\u53d7\u5199\u5165</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_24","title":"\u907f\u514d\u51b2\u7a81","text":"<p>\u5904\u7406\u51b2\u7a81\u7684\u6700\u7b80\u5355\u7684\u7b56\u7565\u5c31\u662f\u907f\u514d\u5b83\u4eec\\(^{[11]}\\)\uff1a</p> <ul> <li>\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u786e\u4fdd\u7279\u5b9a\u8bb0\u5f55\u7684\u6240\u6709\u5199\u5165\u90fd\u901a\u8fc7\u540c\u4e00\u4e2a\u4e3b\u5e93\uff0c\u90a3\u4e48\u51b2\u7a81\u5c31\u4e0d\u4f1a\u53d1\u751f</li> </ul> <p>\u793a\u4f8b\uff1a</p> <ul> <li>\u534f\u540c\u7f16\u8f91\u65f6\uff0c\u5c06\u6587\u6863\u5212\u5206\u4e3a\u4e0d\u540c\u7ae0\u8282\u90e8\u5206\uff08\u8ddf\u5ba2\u6237\u7aef\u8bbe\u5907\u7c7b\u578b\u65e0\u5173\uff09\uff0c\u6bcf\u4e2a\u90e8\u5206\u53ef\u4ee5\u8def\u7531\u5230\u540c\u4e00\u4e2a\u6570\u636e\u4e2d\u5fc3\u7684\u4e3b\u5e93\u8fdb\u884c\u5904\u7406\uff1b</li> </ul> <p>\u5bf9\u4e8e\u79bb\u7ebf\u64cd\u4f5c\u65f6\u7684\u591a\u4e3b\u51b2\u7a81\u95ee\u9898\uff1a\u79bb\u7ebf\u7684\u5ba2\u6237\u7aef\u4e0a\u7ebf\u65f6\u7684\u51b2\u7a81\u95ee\u9898</p> <ul> <li>\u7528\u6237\u624b\u52a8\u89e3\u51b3\u51b2\u7a81\uff1a\u5148\u8fdb\u884c\u5408\u5e76\uff08\u7c7b\u4f3c git merge\uff09\uff0c\u5982\u679c\u6709\u51b2\u7a81\u5219\u7528\u6237\u624b\u52a8\u89e3\u51b3\uff1b</li> </ul> <p>\u6709\u65f6\u4f60\u53ef\u80fd\u9700\u8981\u66f4\u6539\u88ab\u6307\u5b9a\u7684\u4e3b\u5e93\uff1a\u67d0\u4e2a\u6570\u636e\u4e2d\u5fc3\u51fa\u73b0\u6545\u969c\u6216\u8005\u7528\u6237\u5df2\u7ecf\u8fc1\u79fb\u5230\u53e6\u4e00\u4e2a\u4f4d\u7f6e</p> <ul> <li>\u6b64\u65f6\uff0c\u51b2\u7a81\u907f\u514d\u5c06\u5931\u6548\uff0c\u4f60\u5fc5\u987b\u5904\u7406\u4e0d\u540c\u4e3b\u5e93\u540c\u65f6\u5199\u5165\u7684\u53ef\u80fd\u6027</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_25","title":"\u6536\u655b\u81f3\u4e00\u81f4\u7684\u72b6\u6001","text":"<p>\u5728\u591a\u4e3b\u914d\u7f6e\u4e2d\uff0c\u6ca1\u6709\u660e\u786e\u7684\u5199\u5165\u987a\u5e8f\uff0c\u6240\u4ee5\u6700\u7ec8\u503c\u5e94\u8be5\u662f\u4ec0\u4e48\u5e76\u4e0d\u6e05\u695a\u3002</p> <ul> <li>\u4e0d\u540c\u7684\u5e76\u53d1\u7684\u64cd\u4f5c\u987a\u5e8f\uff0c\u4e0d\u5b58\u5728\u4e00\u79cd\u6bd4\u53e6\u4e00\u79cd\u66f4\u6b63\u786e\uff1b</li> <li>\u5982\u679c\u6bcf\u4e2a\u526f\u672c\u53ea\u662f\u6309\u7167\u5b83\u770b\u5230\u5199\u5165\u7684\u987a\u5e8f\u5199\u5165\uff0c\u90a3\u4e48\u6570\u636e\u5e93\u6700\u7ec8\u5c06\u5904\u4e8e\u4e0d\u4e00\u81f4\u7684\u72b6\u6001\uff1b</li> </ul> <p>\u4f46\u9700\u8981\u4fdd\u8bc1\uff1a\u6bcf\u4e2a\u590d\u5236\u65b9\u6848\u90fd\u5fc5\u987b\u786e\u4fdd\u6570\u636e\u6700\u7ec8\u5728\u6240\u6709\u526f\u672c\u4e2d\u90fd\u662f\u76f8\u540c</p> <p>\u5b9e\u73b0\u51b2\u7a81\u5408\u5e76\u89e3\u51b3\u6709\u591a\u79cd\u9014\u5f84\uff1a</p> <ul> <li>\u6700\u540e\u5199\u5165\u80dc\u5229\uff08LWW, last write wins\uff09\uff1a\u6bcf\u4e2a\u5199\u5165\u4e00\u4e2a\u552f\u4e00\u7684 ID\uff08\u5982\u65f6\u95f4\u6233\uff09\uff0c\u6311\u9009\u6700\u9ad8 ID \u7684\u5199\u5165\u4f5c\u4e3a\u80dc\u5229\u8005\uff0c\u5e76\u4e22\u5f03\u5176\u4ed6\u5199\u5165\u3002</li> <li>\u4f1a\u9020\u6210\u6570\u636e\u4e22\u5931\uff0c\u89c1\u540e\u9762\u7684\u68c0\u6d4b\u5e76\u53d1\u5199\u5165</li> <li>\u4ee5\u67d0\u79cd\u65b9\u5f0f\u5c06\u8fd9\u4e9b\u503c\u5408\u5e76\u5728\u4e00\u8d77 - \u4f8b\u5982\uff0c\u6309\u5b57\u6bcd\u987a\u5e8f\u6392\u5e8f\uff0c\u7136\u540e\u8fde\u63a5\u5b83\u4eec</li> <li>\u7528\u4e00\u79cd\u53ef\u4fdd\u7559\u6240\u6709\u4fe1\u606f\u7684\u663e\u5f0f\u6570\u636e\u7ed3\u6784\u6765\u8bb0\u5f55\u51b2\u7a81\uff0c\u5e76\u7f16\u5199\u89e3\u51b3\u51b2\u7a81\u7684\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\uff08\u4e5f\u8bb8\u901a\u8fc7\u63d0\u793a\u7528\u6237\u7684\u65b9\u5f0f\uff09\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_26","title":"\u81ea\u5b9a\u4e49\u51b2\u7a81\u89e3\u51b3\u903b\u8f91","text":"<p>\u89e3\u51b3\u51b2\u7a81\u7684\u6700\u5408\u9002\u7684\u65b9\u6cd5\u53ef\u80fd\u53d6\u51b3\u4e8e\u5e94\u7528\u7a0b\u5e8f\uff0c\u5927\u591a\u6570\u591a\u4e3b\u590d\u5236\u5de5\u5177\u5141\u8bb8\u4f7f\u7528\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u7f16\u5199\u51b2\u7a81\u89e3\u51b3\u903b\u8f91\u3002</p> <ul> <li>\u5199\u65f6\u6267\u884c\uff1a\u6570\u636e\u5e93\u7cfb\u7edf\u68c0\u6d4b\u5230\u590d\u5236\u66f4\u6539\u65e5\u5fd7\u4e2d\u5b58\u5728\u51b2\u7a81\uff0c\u5c31\u4f1a\u8c03\u7528\u51b2\u7a81\u5904\u7406\u7a0b\u5e8f\u3002\u540e\u53f0\u8fdb\u7a0b\u4e2d\u8fd0\u884c\uff0c\u5e76\u4e14\u5fc5\u987b\u5feb\u901f\u6267\u884c\u3002</li> <li>\u8bfb\u65f6\u6267\u884c\uff1a\u5f53\u68c0\u6d4b\u5230\u51b2\u7a81\u65f6\uff0c\u6240\u6709\u51b2\u7a81\u5199\u5165\u88ab\u5b58\u50a8\u3002\u4e0b\u4e00\u6b21\u8bfb\u53d6\u6570\u636e\u65f6\uff0c\u4f1a\u5c06\u8fd9\u4e9b\u591a\u4e2a\u7248\u672c\u7684\u6570\u636e\u8fd4\u56de\u7ed9\u5e94\u7528\u7a0b\u5e8f\u3002</li> <li>\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u63d0\u793a\u7528\u6237\u6216\u81ea\u52a8\u89e3\u51b3\u51b2\u7a81\uff0c\u5e76\u5c06\u7ed3\u679c\u5199\u56de\u6570\u636e\u5e93\u3002\u5982 CouchDB \u91c7\u7528\u8be5\u65b9\u5f0f\u3002</li> </ul> <p>\u51b2\u7a81\u89e3\u51b3\u901a\u5e38\u9002\u7528\u4e8e\u5355\u884c\u8bb0\u5f55\u6216\u5355\u4e2a\u6587\u6863\u7684\u5c42\u9762\uff0c\u800c\u4e0d\u662f\u6574\u4e2a\u4e8b\u52a1\\(^{[12]}\\)\u3002</p> <ul> <li>\u6709\u4e00\u4e2a\u4e8b\u52a1\u4f1a\u539f\u5b50\u6027\u5730\u8fdb\u884c\u51e0\u6b21\u4e0d\u540c\u7684\u5199\u5165\uff08\u8bf7\u53c2\u9605 \u7b2c\u4e03\u7ae0\uff09\uff0c\u5bf9\u4e8e\u51b2\u7a81\u89e3\u51b3\u800c\u8a00\uff0c\u6bcf\u4e2a\u5199\u5165\u4ecd\u9700\u5206\u5f00\u5355\u72ec\u8003\u8651\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_27","title":"\u81ea\u52a8\u51b2\u7a81\u89e3\u51b3","text":"<p>\u4e00\u4e9b\u6709\u8da3\u7684\u7814\u7a76\u6765\u81ea\u52a8\u89e3\u51b3\u7531\u4e8e\u6570\u636e\u4fee\u6539\u5f15\u8d77\u7684\u51b2\u7a81\uff1a</p> <ul> <li>\u65e0\u51b2\u7a81\u590d\u5236\u6570\u636e\u7c7b\u578b\uff08Conflict-free replicated datatypes\uff0cCRDT\uff09\\(^{[9,13]}\\)\uff1a\u5f00\u6e90\u5b9e\u73b0 Yjs \\(^{[16]}\\)</li> <li>\u7531\u591a\u4e2a\u7528\u6237\u540c\u65f6\u7f16\u8f91\u7684\u96c6\u5408\u3001\u6620\u5c04\u3001\u6709\u5e8f\u5217\u8868\u3001\u8ba1\u6570\u5668\u7b49\u4e00\u7cfb\u5217\u6570\u636e\u7ed3\u6784\uff0c\u5b83\u4eec\u4ee5\u5408\u7406\u7684\u65b9\u5f0f\u81ea\u52a8\u89e3\u51b3\u51b2\u7a81\u3002</li> <li>\u53ef\u5408\u5e76\u7684\u6301\u4e45\u6570\u636e\u7ed3\u6784\uff08Mergeable persistent data structures\uff09\\(^{[14]}\\)</li> <li>\u663e\u5f0f\u8ddf\u8e2a\u5386\u53f2\u8bb0\u5f55\uff0c\u7c7b\u4f3c\u4e8e Git \u7248\u672c\u63a7\u5236\u7cfb\u7edf\uff0c\u5e76\u4f7f\u7528\u4e09\u5411\u5408\u5e76\u529f\u80fd\uff08\u800c CRDT \u4f7f\u7528\u53cc\u5411\u5408\u5e76\uff09\u3002</li> <li>\u64cd\u4f5c\u8f6c\u6362\uff08operational transformation\uff0cOT\uff09\uff1aGoogle Docs \\(^{[15]}\\)\u7b49\u534f\u540c\u7f16\u8f91\u5e94\u7528\u80cc\u540e\u7684\u51b2\u7a81\u89e3\u51b3\u7b97\u6cd5</li> <li>\u4e13\u4e3a\u6709\u5e8f\u5217\u8868\u7684\u5e76\u53d1\u7f16\u8f91\u800c\u8bbe\u8ba1\u7684\uff0c\u4f8b\u5982\u6784\u6210\u6587\u672c\u6587\u6863\u7684\u5b57\u7b26\u5217\u8868</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_28","title":"\u4ec0\u4e48\u662f\u51b2\u7a81\uff1f","text":"<p>\u51b2\u7a81\u7684\u793a\u4f8b\uff1a</p> <ul> <li>\u663e\u800c\u6613\u89c1\uff1a\u4e24\u4e2a\u5199\u64cd\u4f5c\u5e76\u53d1\u5730\u4fee\u6539\u4e86\u540c\u4e00\u6761\u8bb0\u5f55\u4e2d\u7684\u540c\u4e00\u4e2a\u5b57\u6bb5\uff0c\u5e76\u5c06\u5176\u8bbe\u7f6e\u4e3a\u4e24\u4e2a\u4e0d\u540c\u7684\u503c</li> <li>\u5fae\u5999\u800c\u96be\u4ee5\u53d1\u73b0\uff1a\u4e3a\u540c\u4e00\u4e2a\u623f\u95f4\u540c\u65f6\u521b\u5efa\u4e24\u4e2a\u4e0d\u540c\u7684\u9884\u8ba2\uff0c\u5219\u53ef\u80fd\u4f1a\u53d1\u751f\u51b2\u7a81</li> <li>\u5373\u4f7f\u5e94\u7528\u7a0b\u5e8f\u5728\u5141\u8bb8\u7528\u6237\u8fdb\u884c\u9884\u8ba2\u4e4b\u524d\u5148\u68c0\u67e5\u4f1a\u8bae\u5ba4\u7684\u53ef\u7528\u6027\uff0c\u5982\u679c\u4e24\u6b21\u9884\u8ba2\u662f\u7531\u4e24\u4e2a\u4e0d\u540c\u7684\u4e3b\u5e93\u8fdb\u884c\u7684\uff0c\u5219\u4ecd\u7136\u53ef\u80fd\u4f1a\u6709\u51b2\u7a81</li> </ul> <p>\u5728 \u7b2c\u4e03\u7ae0 \u4e2d\u770b\u5230\u66f4\u591a\u7684\u51b2\u7a81\u793a\u4f8b\uff0c\u5728 \u7b2c\u5341\u4e8c\u7ae0 \u4e2d\u6211\u4eec\u5c06\u8ba8\u8bba\u7528\u4e8e\u68c0\u6d4b\u548c\u89e3\u51b3\u590d\u5236\u7cfb\u7edf\u4e2d\u51b2\u7a81\u7684\u53ef\u4f38\u7f29\u65b9\u6cd5\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_29","title":"\u591a\u4e3b\u590d\u5236\u62d3\u6251","text":"<p>\u590d\u5236\u62d3\u6251\uff08replication topology\uff09\u7528\u6765\u63cf\u8ff0\u5199\u5165\u64cd\u4f5c\u4ece\u4e00\u4e2a\u8282\u70b9\u4f20\u64ad\u5230\u53e6\u4e00\u4e2a\u8282\u70b9\u7684\u901a\u4fe1\u8def\u5f84\u3002</p> <p>\u4e09\u79cd\u53ef\u4ee5\u5728\u591a\u4e3b\u590d\u5236\u4e2d\u4f7f\u7528\u7684\u62d3\u6251\u793a\u4f8b</p> <ul> <li>\u73af\u5f62\u62d3\u6251\uff1a\u6bcf\u4e2a\u8282\u70b9\u4ece\u4e00\u4e2a\u8282\u70b9\u63a5\u53d7\u5199\u5165\uff0c\u5e76\u5c06\u8fd9\u4e9b\u5199\u5165\uff08\u52a0\u4e0a\u81ea\u5df1\u7684\u5199\u5165\uff09\u8f6c\u53d1\u7ed9\u53e6\u4e00\u8282\u70b9\uff1b</li> <li>\u661f\u578b\u62d3\u6251\uff1a\u4e00\u4e2a\u6307\u5b9a\u7684\u6839\u8282\u70b9\u5c06\u5199\u5165\u8f6c\u53d1\u7ed9\u6240\u6709\u5176\u4ed6\u8282\u70b9\u3002\u661f\u5f62\u62d3\u6251\u53ef\u4ee5\u63a8\u5e7f\u5230\u6811\uff1b</li> <li>\u5168\u90e8\u5230\u5168\u90e8\u62d3\u6251\uff1a\u6bcf\u4e2a\u4e3b\u5e93\u90fd\u5c06\u5176\u5199\u5165\u53d1\u9001\u7ed9\u5176\u4ed6\u6240\u6709\u7684\u4e3b\u5e93\u3002</li> </ul> <p></p> <p>\u5728\u73af\u5f62\u548c\u661f\u5f62\u62d3\u6251\u4e2d\uff0c\u5199\u5165\u53ef\u80fd\u9700\u8981\u5728\u5230\u8fbe\u6240\u6709\u526f\u672c\u4e4b\u524d\u901a\u8fc7\u591a\u4e2a\u8282\u70b9\uff1a\u8282\u70b9\u9700\u8981\u8f6c\u53d1\u4ece\u5176\u4ed6\u8282\u70b9\u6536\u5230\u7684\u6570\u636e\u66f4\u6539\uff1b</p> <ul> <li>\u9632\u6b62\u65e0\u9650\u590d\u5236\u5faa\u73af\uff1a\u6bcf\u4e2a\u8282\u70b9\u88ab\u8d4b\u4e88\u4e00\u4e2a\u552f\u4e00\u7684\u6807\u8bc6\u7b26\uff0c\u5e76\u4e14\u5728\u590d\u5236\u65e5\u5fd7\u4e2d\uff0c\u6bcf\u6b21\u5199\u5165\u90fd\u4f1a\u4f7f\u7528\u5176\u7ecf\u8fc7\u7684\u6240\u6709\u8282\u70b9\u7684\u6807\u8bc6\u7b26\u8fdb\u884c\u6807\u8bb0\\(^{[17]}\\)</li> <li>\u5f53\u4e00\u4e2a\u8282\u70b9\u6536\u5230\u7528\u81ea\u5df1\u7684\u6807\u8bc6\u7b26\u6807\u8bb0\u7684\u6570\u636e\u66f4\u6539\u65f6\uff0c\u8be5\u6570\u636e\u66f4\u6539\u5c06\u88ab\u5ffd\u7565\uff0c\u56e0\u4e3a\u8282\u70b9\u77e5\u9053\u5b83\u5df2\u7ecf\u88ab\u5904\u7406\u8fc7\u3002</li> </ul> <p>\u73af\u5f62\u548c\u661f\u5f62\u62d3\u6251\u7684\u95ee\u9898\uff1a\u5bb9\u9519\u6027</p> <ul> <li>\u5982\u679c\u53ea\u6709\u4e00\u4e2a\u8282\u70b9\u53d1\u751f\u6545\u969c\uff0c\u5219\u53ef\u80fd\u4f1a\u4e2d\u65ad\u5176\u4ed6\u8282\u70b9\u4e4b\u95f4\u7684\u590d\u5236\u6d88\u606f\u6d41\uff0c\u5bfc\u81f4\u5b83\u4eec\u65e0\u6cd5\u901a\u4fe1\uff0c\u9664\u975e\u8282\u70b9\u88ab\u4fee\u590d\uff1b</li> <li>\u62d3\u6251\u7ed3\u6784\u53ef\u4ee5\u91cd\u65b0\u914d\u7f6e\u4e3a\u8df3\u8fc7\u53d1\u751f\u6545\u969c\u7684\u8282\u70b9\uff0c\u4f46\u5728\u5927\u591a\u6570\u90e8\u7f72\u4e2d\uff0c\u8fd9\u79cd\u91cd\u65b0\u914d\u7f6e\u5fc5\u987b\u624b\u52a8\u5b8c\u6210\uff1b</li> </ul> <p>\u5168\u90e8\u5230\u5168\u90e8\u7684\u62d3\u6251\u7684\u95ee\u9898\uff1a\u6d88\u606f\u51b2\u7a81</p> <ul> <li>\u4e00\u4e9b\u7f51\u7edc\u94fe\u63a5\u53ef\u80fd\u6bd4\u5176\u4ed6\u7f51\u7edc\u94fe\u63a5\u66f4\u5feb\uff08\u4f8b\u5982\u7531\u4e8e\u7f51\u7edc\u62e5\u585e\uff09\uff0c\u7ed3\u679c\u662f\u4e00\u4e9b\u590d\u5236\u6d88\u606f\u53ef\u80fd \u201c\u8d85\u8d8a\u201d \u5176\u4ed6\u590d\u5236\u6d88\u606f</li> </ul> <p>\u4f7f\u7528\u591a\u4e3b\u590d\u5236\u65f6\uff0c\u5199\u5165\u53ef\u80fd\u4f1a\u4ee5\u9519\u8bef\u7684\u987a\u5e8f\u5230\u8fbe\u67d0\u4e9b\u526f\u672c</p> <ul> <li>\u5ba2\u6237\u7aef A \u5411\u4e3b\u5e93 1 \u7684\u8868\u4e2d\u63d2\u5165\u4e00\u884c\uff0c\u5ba2\u6237\u7aef B \u5728\u4e3b\u5e93 3 \u4e0a\u66f4\u65b0\u8be5\u884c\u3002\u7136\u800c\uff0c\u4e3b\u5e93 2 \u53ef\u4ee5\u4ee5\u4e0d\u540c\u7684\u987a\u5e8f\u63a5\u6536\u5199\u5165</li> <li>\u56e0\u679c\u5173\u7cfb\u7684\u95ee\u9898\uff1a\u6bcf\u4e00\u6b21\u5199\u5165\u65f6\u6dfb\u52a0\u4e00\u4e2a\u65f6\u95f4\u6233\u662f\u4e0d\u591f\uff08\u65f6\u949f\u540c\u6b65\u95ee\u9898\uff0c\u9700\u8981\u5168\u5c40\u903b\u8f91\u65f6\u95f4\u6233\uff09\uff0c\u4e3b\u5e93 2 \u5c31\u65e0\u6cd5\u6b63\u786e\u5730\u5bf9\u8fd9\u4e9b\u4e8b\u4ef6\u8fdb\u884c\u6392\u5e8f</li> <li>\u7248\u672c\u5411\u91cf\uff08version vectors\uff09\uff1a\u89e3\u51b3\u4e8b\u4ef6\u6392\u5e8f\u95ee\u9898\uff0c\u53c2\u9605 \u201c\u68c0\u6d4b\u5e76\u53d1\u5199\u5165\u201d</li> </ul> <p></p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_30","title":"\u65e0\u4e3b\u590d\u5236","text":"<p>\u5728\u5173\u7cfb\u6570\u636e\u5e93\u4e3b\u5bfc\u7684\u65f6\u4ee3\uff0c\u65e0\u4e3b\u7684\u590d\u5236\u7cfb\u7edf\u7684\u60f3\u6cd5\u51e0\u4e4e\u88ab\u5fd8\u5374\uff0c\u5f53\u4e9a\u9a6c\u900a\u7528\u4e8e\u5176\u5185\u90e8\u7684 Dynamo \u7cfb\u7edf\u4e4b\u540e\uff0c\u5b83\u518d\u4e00\u6b21\u6210\u4e3a\u6570\u636e\u5e93\u7684\u4e00\u79cd\u65f6\u5c1a\u67b6\u6784\\(^{[18]}\\)\u3002</p> <p>\u65e0\u4e3b\u590d\u5236\u9002\u7528\u4e8e\u9700\u8981\u9ad8\u53ef\u7528\u3001\u4f4e\u5ef6\u65f6\u3001\u4e14\u80fd\u591f\u5bb9\u5fcd\u5076\u5c14\u8bfb\u5230\u9648\u65e7\u503c\u7684\u5e94\u7528\u573a\u666f\u3002</p> <p>\u5355\u4e3b\u590d\u5236\u3001\u591a\u4e3b\u590d\u5236\uff1a\u5ba2\u6237\u7aef\u5411\u4e00\u4e2a\u4e3b\u5e93\u53d1\u9001\u5199\u8bf7\u6c42\uff0c\u6570\u636e\u5e93\u7cfb\u7edf\u8d1f\u8d23\u5c06\u5199\u5165\u590d\u5236\u5230\u5176\u4ed6\u526f\u672c\u3002</p> <ul> <li>\u4e3b\u5e93\u51b3\u5b9a\u5199\u5165\u7684\u987a\u5e8f\uff0c\u800c\u4ece\u5e93\u6309\u76f8\u540c\u987a\u5e8f\u5e94\u7528\u4e3b\u5e93\u7684\u5199\u5165\u3002</li> </ul> <p>\u65e0\u4e3b\u590d\u5236\uff1a</p> <ul> <li>\u5ba2\u6237\u7aef\u76f4\u63a5\u5c06\u5199\u5165\u53d1\u9001\u5230\u51e0\u4e2a\u526f\u672c\uff0c\u6216\uff1b</li> <li>\u7531\u4e00\u4e2a \u534f\u8c03\u8005\uff08coordinator\uff09 \u8282\u70b9\u4ee3\u8868\u5ba2\u6237\u7aef\u8fdb\u884c\u5199\u5165\uff0c\u4f46\u534f\u8c03\u8005\u4e0d\u6267\u884c\u7279\u5b9a\u7684\u5199\u5165\u987a\u5e8f\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_31","title":"\u5f53\u8282\u70b9\u6545\u969c\u65f6\u5199\u5165\u6570\u636e\u5e93","text":"<p>\u5728\u57fa\u4e8e\u9886\u5bfc\u8005\u7684\u914d\u7f6e\u4e2d\uff0c\u591a\u526f\u672c\u7684\u6570\u636e\u5e93\u4e2d\uff0c\u6709\u4e00\u4e2a\u526f\u672c\u4e0d\u53ef\u7528\u65f6\uff0c\u5982\u679c\u8981\u7ee7\u7eed\u5904\u7406\u5199\u5165\uff0c\u5219\u53ef\u80fd\u9700\u8981\u6267\u884c\u6545\u969c\u5207\u6362\uff08\u8bf7\u53c2\u9605\u300c\u5904\u7406\u8282\u70b9\u5b95\u673a\u300d\uff09\u3002</p> <p>\u5728\u65e0\u4e3b\u914d\u7f6e\u4e2d\uff0c\u4e0d\u5b58\u5728\u6545\u969c\u8f6c\u79fb\uff1a\u4e0b\u56fe\u793a\u4f8b\uff0c\u5047\u8bbe\u4e09\u4e2a\u526f\u672c\u4e2d\u7684\u4e24\u4e2a\u627f\u8ba4\u5199\u5165\u662f\u8db3\u591f</p> <ul> <li>\u6cd5\u5b9a\u5199\u5165\uff0c\u6cd5\u5b9a\u8bfb\u53d6\uff0c\u5e76\u5728\u8282\u70b9\u4e2d\u65ad\u540e\u8bfb\u4fee\u590d</li> </ul> <p></p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_32","title":"\u8bfb\u4fee\u590d\u548c\u53cd\u71b5","text":"<p>\u5728\u4e00\u4e2a\u4e0d\u53ef\u7528\u7684\u8282\u70b9\u91cd\u65b0\u8054\u673a\u4e4b\u540e\uff0c\u8bfb\u5176\u6570\u636e\uff0c\u53ef\u80fd\u4f1a\u62ff\u5230\u9648\u65e7\u7684\u6570\u636e</p> <ul> <li>\u8bfb\u8bf7\u6c42\u5c06\u88ab\u5e76\u884c\u5730\u53d1\u9001\u5230\u591a\u4e2a\u8282\u70b9\uff1a\u7248\u672c\u53f7\u5c06\u88ab\u7528\u4e8e\u786e\u5b9a\u54ea\u4e2a\u503c\u662f\u66f4\u65b0\u7684\uff08\u8bf7\u53c2\u9605 \u201c\u68c0\u6d4b\u5e76\u53d1\u5199\u5165\u201d\uff09\u3002</li> </ul> <p>\u5728\u4e00\u4e2a\u4e0d\u53ef\u7528\u7684\u8282\u70b9\u91cd\u65b0\u8054\u673a\u4e4b\u540e\uff0c\u5b83\u5982\u4f55\u8d76\u4e0a\u5b83\u9519\u8fc7\u7684\u5199\u5165\uff1f</p> <ul> <li>\u8bfb\u4fee\u590d\uff1a\u9002\u7528\u4e8e\u8bfb\u9891\u7e41\uff0c\u5ba2\u6237\u7aef\u5e76\u884c\u8bfb\u53d6\u591a\u4e2a\u8282\u70b9\u65f6\uff0c\u5b83\u53ef\u4ee5\u68c0\u6d4b\u5230\u4efb\u4f55\u9648\u65e7\u7684\u54cd\u5e94\uff0c\u5e76\u5c06\u65b0\u503c\u5199\u56de\u5230\u8be5\u526f\u672c\uff1b</li> <li>\u53cd\u71b5\u8fc7\u7a0b\uff1a\u4e00\u4e9b\u6570\u636e\u5b58\u50a8\u5177\u6709\u540e\u53f0\u8fdb\u7a0b\uff0c\u8be5\u8fdb\u7a0b\u4e0d\u65ad\u67e5\u627e\u526f\u672c\u4e4b\u95f4\u7684\u6570\u636e\u5dee\u5f02\uff0c\u5e76\u5c06\u4efb\u4f55\u7f3a\u5c11\u7684\u6570\u636e\u4ece\u4e00\u4e2a\u526f\u672c\u590d\u5236\u5230\u53e6\u4e00\u4e2a\u526f\u672c</li> <li>\u4e0e\u57fa\u4e8e\u9886\u5bfc\u8005\u7684\u590d\u5236\u4e2d\u7684\u590d\u5236\u65e5\u5fd7\u4e0d\u540c\uff0c\u6b64\u53cd\u71b5\u8fc7\u7a0b\u4e0d\u4f1a\u4ee5\u4efb\u4f55\u7279\u5b9a\u7684\u987a\u5e8f\u590d\u5236\u5199\u5165\uff0c\u5e76\u4e14\u5728\u590d\u5236\u6570\u636e\u4e4b\u524d\u53ef\u80fd\u4f1a\u6709\u663e\u8457\u7684\u5ef6\u8fdf\u3002</li> </ul> <p>\u5982\u679c\u6ca1\u6709\u53cd\u71b5\u8fc7\u7a0b\uff0c\u5f88\u5c11\u88ab\u8bfb\u53d6\u7684\u503c\u53ef\u80fd\u4f1a\u4ece\u67d0\u4e9b\u526f\u672c\u4e2d\u4e22\u5931\uff0c\u4ece\u800c\u964d\u4f4e\u4e86\u6301\u4e45\u6027\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_33","title":"\u8bfb\u5199\u7684\u6cd5\u5b9a\u4eba\u6570","text":"<p>\u5982\u679c\u6709 n \u4e2a\u526f\u672c\uff0c\u6bcf\u4e2a\u5199\u5165\u5fc5\u987b\u7531 w \u4e2a\u8282\u70b9\u786e\u8ba4\u624d\u80fd\u88ab\u8ba4\u4e3a\u662f\u6210\u529f\u7684\uff0c\u5e76\u4e14\u6211\u4eec\u5fc5\u987b\u81f3\u5c11\u4e3a\u6bcf\u4e2a\u8bfb\u53d6\u67e5\u8be2 r \u4e2a\u8282\u70b9\u3002</p> <ul> <li>\\(w+r&gt;n\\)\uff1a\u9884\u671f\u5728\u8bfb\u53d6\u65f6\u80fd\u83b7\u5f97\u6700\u65b0\u7684\u503c\uff0c\u56e0\u4e3a r \u4e2a\u8bfb\u53d6\u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u8282\u70b9\u662f\u6700\u65b0\u7684</li> <li>\u5e38\u89c1\u7684\u9009\u62e9\u662f\u4f7f n \u4e3a\u5947\u6570\uff08\u901a\u5e38\u4e3a 3 \u6216 5\uff09\u5e76\u8bbe\u7f6e \\(w=r=(n+1)/2\\)\uff08\u5411\u4e0a\u53d6\u6574\uff09</li> </ul> <p>\u96c6\u7fa4\u4e2d\u53ef\u80fd\u6709\u591a\u4e8e n \u4e2a\u7684\u8282\u70b9\uff08\u96c6\u7fa4\u7684\u673a\u5668\u6570\u53ef\u80fd\u591a\u4e8e\u526f\u672c\u6570\u76ee\uff09\u3002\u4f46\u662f\u4efb\u4f55\u7ed9\u5b9a\u7684\u503c\u53ea\u80fd\u5b58\u50a8\u5728 n \u4e2a\u8282\u70b9\u4e0a\u3002\u8fd9\u5141\u8bb8\u5bf9\u6570\u636e\u96c6\u8fdb\u884c\u5206\u533a\uff0c\u4ece\u800c\u53ef\u4ee5\u652f\u6301\u6bd4\u5355\u4e2a\u8282\u70b9\u7684\u5b58\u50a8\u80fd\u529b\u66f4\u5927\u7684\u6570\u636e\u96c6\u3002\u6211\u4eec\u5c06\u5728 \u7b2c\u516d\u7ae0 \u7ee7\u7eed\u8ba8\u8bba\u5206\u533a\u3002</p> <p>\u6cd5\u5b9a\u4eba\u6570\u6761\u4ef6 \\(w+r&gt;n\\)\u5141\u8bb8\u7cfb\u7edf\u5bb9\u5fcd\u4e0d\u53ef\u7528\u7684\u8282\u70b9\uff1a</p> <ul> <li>\u5982\u679c \\(w&lt;n\\)\uff0c\u5f53\u8282\u70b9\u4e0d\u53ef\u7528\u65f6\uff0c\u4ecd\u7136\u53ef\u4ee5\u5904\u7406\u5199\u5165\uff1b</li> <li>\u5982\u679c \\(r&lt;n\\)\uff0c\u5f53\u8282\u70b9\u4e0d\u53ef\u7528\u65f6\uff0c\u4ecd\u7136\u53ef\u4ee5\u5904\u7406\u8bfb\u53d6\uff1b</li> <li>\u5bf9\u4e8e \\(n=3,w=r=2\\)\uff0c\u53ef\u4ee5\u5bb9\u5fcd\u4e00\u4e2a\u4e0d\u53ef\u7528\u7684\u8282\u70b9\uff1b</li> </ul> <p>\u5982\u679c\\(w+r&gt;n\\)\uff0c\u8bfb\u53d6 r \u4e2a\u526f\u672c\uff0c\u81f3\u5c11\u6709\u4e00\u4e2a\u526f\u672c\u5fc5\u7136\u5305\u542b\u4e86\u6700\u8fd1\u7684\u6210\u529f\u5199\u5165</p> <p></p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_34","title":"\u6cd5\u5b9a\u4eba\u6570\u4e00\u81f4\u6027\u7684\u5c40\u9650\u6027","text":"<p>\u901a\u5e38\uff0cr \u548c w \u88ab\u9009\u4e3a\u591a\u6570\uff08\u8d85\u8fc7\\(n/2\\) \uff09\u8282\u70b9\uff0c\u56e0\u4e3a\u8fd9\u786e\u4fdd\u4e86 \\(w+r&gt;n\\)\uff0c\u540c\u65f6\u4ecd\u7136\u5bb9\u5fcd\u591a\u8fbe\\(n/2\\) \u4e2a\u8282\u70b9\u6545\u969c\u3002</p> <p>\u53ef\u4ee5\u5c06 w \u548c r \u8bbe\u7f6e\u4e3a\u8f83\u5c0f\u7684\u6570\u5b57\uff0c\u4ee5\u4f7f \\(w+r \\le n\\)\uff08\u5373\u6cd5\u5b9a\u6761\u4ef6\u4e0d\u6ee1\u8db3\uff09</p> <ul> <li>\u8bfb\u53d6\u66f4\u6709\u53ef\u80fd\u672a\u5305\u542b\u5177\u6709\u6700\u65b0\u503c\u7684\u8282\u70b9</li> <li>\u5141\u8bb8\u66f4\u4f4e\u7684\u5ef6\u8fdf\u548c\u66f4\u9ad8\u7684\u53ef\u7528\u6027</li> </ul> <p>\u5373\u4f7f\u5728  \\(w+r&gt;n\\)\u7684\u60c5\u51b5\u4e0b\uff0c\u4e5f\u53ef\u80fd\u5b58\u5728\u8fd4\u56de\u9648\u65e7\u503c\u7684\u8fb9\u7f18\u60c5\u51b5\uff1a</p> <ul> <li>\u5982\u679c\u4f7f\u7528\u5bbd\u677e\u7684\u6cd5\u5b9a\u4eba\u6570\uff08\u89c1 \u201c\u5bbd\u677e\u7684\u6cd5\u5b9a\u4eba\u6570\u4e0e\u63d0\u793a\u79fb\u4ea4\u201d\uff09\uff0cw \u4e2a\u5199\u5165\u548c r \u4e2a\u8bfb\u53d6\u53ef\u80fd\u843d\u5728\u5b8c\u5168\u4e0d\u540c\u7684\u8282\u70b9\u4e0a\uff0c\u56e0\u6b64 r \u8282\u70b9\u548c w \u4e4b\u95f4\u4e0d\u518d\u4fdd\u8bc1\u6709\u91cd\u53e0\u8282\u70b9\\(^{[19]}\\)\uff1b</li> <li>\u5982\u679c\u4e24\u4e2a\u5199\u5165\u540c\u65f6\u53d1\u751f\uff0c\u552f\u4e00\u5b89\u5168\u7684\u89e3\u51b3\u65b9\u6848\u662f\u5408\u5e76\u5e76\u53d1\u5199\u5165\uff08\u8bf7\u53c2\u9605 \u201c\u5904\u7406\u5199\u5165\u51b2\u7a81\u201d\uff09\u3002\u5982\u679c\u6839\u636e\u65f6\u95f4\u6233\uff08\u6700\u540e\u5199\u5165\u80dc\u5229\uff09\u6311\u9009\u51fa\u4e00\u4e2a\u80dc\u8005\uff0c\u5219\u5199\u5165\u53ef\u80fd\u7531\u4e8e\u65f6\u949f\u504f\u5dee\\(^{[20]}\\)\u800c\u4e22\u5931\u3002\u5c06\u5728 \u201c\u68c0\u6d4b\u5e76\u53d1\u5199\u5165\u201d \u7ee7\u7eed\u8ba8\u8bba\u6b64\u8bdd\u9898\uff1b</li> <li>\u5982\u679c\u5199\u64cd\u4f5c\u4e0e\u8bfb\u64cd\u4f5c\u540c\u65f6\u53d1\u751f\uff0c\u5199\u64cd\u4f5c\u53ef\u80fd\u4ec5\u53cd\u6620\u5728\u67d0\u4e9b\u526f\u672c\u4e0a\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e0d\u786e\u5b9a\u8bfb\u53d6\u8fd4\u56de\u7684\u662f\u65e7\u503c\u8fd8\u662f\u65b0\u503c\uff1b</li> <li>\u6574\u4f53\u5199\u5165\u5931\u8d25\uff08\u5728\u5c0f\u4e8e w \u4e2a\u526f\u672c\u4e0a\u5199\u5165\u6210\u529f\uff09\u5e76\u6ca1\u6709\u5728\u5199\u5165\u6210\u529f\u7684\u526f\u672c\u4e0a\u56de\u6eda\uff0c\u540e\u7eed\u7684\u8bfb\u53d6\u4ecd\u7136\u53ef\u80fd\u4f1a\u8bfb\u53d6\u8fd9\u6b21\u5931\u8d25\u5199\u5165\u7684\u503c\\(^{[21]}\\)\uff1b</li> <li>\u5982\u679c\u643a\u5e26\u65b0\u503c\u7684\u8282\u70b9\u53d1\u751f\u6545\u969c\uff0c\u9700\u8981\u4ece\u5176\u4ed6\u5e26\u6709\u65e7\u503c\u7684\u526f\u672c\u8fdb\u884c\u6062\u590d\uff0c\u5219\u5b58\u50a8\u65b0\u503c\u7684\u526f\u672c\u6570\u53ef\u80fd\u4f1a\u4f4e\u4e8e w\uff0c\u4ece\u800c\u6253\u7834\u6cd5\u5b9a\u4eba\u6570\u6761\u4ef6\uff1b</li> <li>\u5373\u4f7f\u4e00\u5207\u5de5\u4f5c\u6b63\u5e38\uff0c\u6709\u65f6\u4e5f\u4f1a\u4e0d\u5e78\u5730\u51fa\u73b0\u5173\u4e8e \u65f6\u5e8f\uff08timing\uff09 \u7684\u8fb9\u7f18\u60c5\u51b5\uff0c\u6211\u4eec\u5c06\u5728 \u201c\u7ebf\u6027\u4e00\u81f4\u6027\u548c\u6cd5\u5b9a\u4eba\u6570\u201d \u4e2d\u770b\u5230\u8fd9\u70b9</li> </ul> <p>\u56e0\u4e3a\u901a\u5e38\u5f97\u4e0d\u5230 \u201c\u590d\u5236\u5ef6\u8fdf\u95ee\u9898\u201d \u4e2d\u8ba8\u8bba\u7684\u90a3\u4e9b\u4fdd\u8bc1\uff08\u8bfb\u5df1\u4e4b\u5199\uff0c\u5355\u8c03\u8bfb\uff0c\u4e00\u81f4\u524d\u7f00\u8bfb\uff09\uff0c\u524d\u9762\u63d0\u5230\u7684\u5f02\u5e38\u53ef\u80fd\u4f1a\u53d1\u751f\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u3002\u66f4\u5f3a\u6709\u529b\u7684\u4fdd\u8bc1\u901a\u5e38\u9700\u8981 \u4e8b\u52a1 \u6216 \u5171\u8bc6\u3002\u6211\u4eec\u5c06\u5728 \u7b2c\u4e03\u7ae0 \u548c \u7b2c\u4e5d\u7ae0 \u56de\u5230\u8fd9\u4e9b\u8bdd\u9898\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_35","title":"\u76d1\u63a7\u9648\u65e7\u5ea6","text":"<p>\u4ece\u8fd0\u7ef4\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u76d1\u89c6\u4f60\u7684\u6570\u636e\u5e93\u662f\u5426\u8fd4\u56de\u6700\u65b0\u7684\u7ed3\u679c\u662f\u5f88\u91cd\u8981\u7684\u3002</p> <ul> <li>\u5bf9\u4e8e\u57fa\u4e8e\u9886\u5bfc\u8005\u7684\u590d\u5236\uff0c\u6570\u636e\u5e93\u901a\u5e38\u4f1a\u63d0\u4f9b\u590d\u5236\u5ef6\u8fdf\u7684\u6d4b\u91cf\u503c</li> <li>\u901a\u8fc7\u4ece\u4e3b\u5e93\u7684\u5f53\u524d\u4f4d\u7f6e\u4e2d\u51cf\u53bb\u4ece\u5e93\u7684\u5f53\u524d\u4f4d\u7f6e\uff0c\u4f60\u53ef\u4ee5\u6d4b\u91cf\u590d\u5236\u5ef6\u8fdf\u7684\u7a0b\u5ea6\u3002</li> <li>\u65e0\u4e3b\u590d\u5236\u7684\u7cfb\u7edf\u4e2d\uff0c\u6ca1\u6709\u56fa\u5b9a\u7684\u5199\u5165\u987a\u5e8f</li> <li>\u5982\u679c\u6570\u636e\u5e93\u53ea\u4f7f\u7528\u8bfb\u4fee\u590d\uff08\u6ca1\u6709\u53cd\u71b5\u8fc7\u7a0b\uff09\uff0c\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a\u503c\u53ef\u80fd\u4f1a\u6709\u591a\u9648\u65e7\u5176\u5b9e\u662f\u6ca1\u6709\u9650\u5236</li> <li>\u590d\u5236\u9648\u65e7\u5ea6\u7684\u7814\u7a76\uff1a\u6839\u636e\u53c2\u6570 n\u3001w \u548c r \u6765\u9884\u6d4b\u9648\u65e7\u8bfb\u53d6\u7684\u9884\u671f\u767e\u5206\u6bd4\\(^{[22]}\\)</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_36","title":"\u5bbd\u677e\u7684\u6cd5\u5b9a\u4eba\u6570\u4e0e\u63d0\u793a\u79fb\u4ea4","text":"<p>\u6cd5\u5b9a\u4eba\u6570\uff08\u5982\u8fc4\u4eca\u4e3a\u6b62\u6240\u63cf\u8ff0\u7684\uff09\u5e76\u4e0d\u50cf\u5b83\u4eec\u53ef\u80fd\u7684\u90a3\u6837\u5177\u6709\u5bb9\u9519\u6027\uff0c\u7f51\u7edc\u4e2d\u65ad\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u5c06\u5ba2\u6237\u7aef\u4ece\u5927\u91cf\u7684\u6570\u636e\u5e93\u8282\u70b9\u4e0a\u5207\u65ad\u3002</p> <p>\u5728\u4e00\u4e2a\u5927\u578b\u7684\u96c6\u7fa4\u4e2d\uff08\u8282\u70b9\u6570\u91cf\u660e\u663e\u591a\u4e8e n \u4e2a\uff09\uff0c\u7f51\u7edc\u4e2d\u65ad\u671f\u95f4\u5ba2\u6237\u7aef\u53ef\u80fd\u4ecd\u80fd\u8fde\u63a5\u5230\u4e00\u4e9b\u6570\u636e\u5e93\u8282\u70b9\uff0c\u4f46\u53c8\u4e0d\u8db3\u4ee5\u7ec4\u6210\u4e00\u4e2a\u7279\u5b9a\u7684\u6cd5\u5b9a\u4eba\u6570\u3002</p> <ul> <li>\u5bf9\u4e8e\u6240\u6709\u65e0\u6cd5\u8fbe\u5230 w \u6216 r \u4e2a\u8282\u70b9\u6cd5\u5b9a\u4eba\u6570\u7684\u8bf7\u6c42\uff0c\u662f\u5426\u8fd4\u56de\u9519\u8bef\u662f\u66f4\u597d\u7684\uff1f</li> <li>\u6216\u8005\u6211\u4eec\u662f\u5426\u5e94\u8be5\u63a5\u53d7\u5199\u5165\uff0c\u7136\u540e\u5c06\u5b83\u4eec\u5199\u5165\u4e00\u4e9b\u53ef\u8fbe\u7684\u8282\u70b9\uff0c\u4f46\u4e0d\u5728\u8fd9\u4e9b\u503c\u901a\u5e38\u6240\u5b58\u5728\u7684 n \u4e2a\u8282\u70b9\u4e0a\uff1f</li> </ul> <p>\u540e\u8005\u88ab\u8ba4\u4e3a\u662f\u4e00\u4e2a \u5bbd\u677e\u7684\u6cd5\u5b9a\u4eba\u6570\uff08sloppy quorum\uff09\\(^{[18]}\\)\uff1a</p> <ul> <li>\u5199\u548c\u8bfb\u4ecd\u7136\u9700\u8981 w \u548c r \u4e2a\u6210\u529f\u7684\u54cd\u5e94\uff0c\u4f46\u8fd9\u4e9b\u54cd\u5e94\u53ef\u80fd\u6765\u81ea\u4e0d\u5728\u6307\u5b9a\u7684 n \u4e2a \u201c\u4e3b\u201d \u8282\u70b9\u4e2d\u7684\u5176\u5b83\u8282\u70b9</li> <li>\u63d0\u793a\u79fb\u4ea4\uff08hinted handoff\uff09\uff1a\u7f51\u7edc\u4e2d\u65ad\u5f97\u5230\u89e3\u51b3\uff0c\u4e00\u4e2a\u8282\u70b9\u4ee3\u8868\u53e6\u4e00\u4e2a\u8282\u70b9\u4e34\u65f6\u63a5\u53d7\u7684\u4efb\u4f55\u5199\u5165\u90fd\u5c06\u88ab\u53d1\u9001\u5230\u9002\u5f53\u7684 \u201c\u4e3b\u201d \u8282\u70b9</li> </ul> <p>\u5bbd\u677e\u7684\u6cd5\u5b9a\u4eba\u6570\u63d0\u9ad8\u5199\u5165\u53ef\u7528\u6027\uff1a\u53ea\u8981\u6709\u4efb\u4f55 w \u4e2a\u8282\u70b9\u53ef\u7528\uff0c\u6570\u636e\u5e93\u5c31\u53ef\u4ee5\u63a5\u53d7\u5199\u5165\u3002</p> <ul> <li>\u610f\u5473\u7740\u5373\u4f7f\u5f53 \\(w+r&gt;n\\) \u65f6\uff0c\u4e5f\u4e0d\u80fd\u786e\u4fdd\u8bfb\u53d6\u5230\u67d0\u4e2a\u952e\u7684\u6700\u65b0\u503c\uff0c\u56e0\u4e3a\u6700\u65b0\u7684\u503c\u53ef\u80fd\u5df2\u7ecf\u4e34\u65f6\u5199\u5165\u4e86 n \u4e4b\u5916\u7684\u67d0\u4e9b\u8282\u70b9\\(^{[21]}\\)\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_37","title":"\u8fd0\u7ef4\u591a\u4e2a\u6570\u636e\u4e2d\u5fc3","text":"<p>\u65e0\u4e3b\u590d\u5236\u4e5f\u9002\u7528\u4e8e\u591a\u6570\u636e\u4e2d\u5fc3\u64cd\u4f5c\uff0c\u65e2\u7136\u5b83\u65e8\u5728\u5bb9\u5fcd\u51b2\u7a81\u7684\u5e76\u53d1\u5199\u5165\u3001\u7f51\u7edc\u4e2d\u65ad\u548c\u5ef6\u8fdf\u5c16\u5cf0\u3002</p> <p>Cassandra \u5728\u6b63\u5e38\u7684\u65e0\u4e3b\u6a21\u578b\u4e2d\u5b9e\u73b0\u4e86\u4ed6\u4eec\u7684\u591a\u6570\u636e\u4e2d\u5fc3\u652f\u6301\\(^{[23]}\\)\uff1a</p> <ul> <li>\u526f\u672c\u7684\u6570\u91cf n \u5305\u62ec\u6240\u6709\u6570\u636e\u4e2d\u5fc3\u7684\u8282\u70b9\uff0c\u914d\u7f6e\u4e2d\u6307\u5b9a\u6bcf\u4e2a\u6570\u636e\u4e2d\u5fc3\u6240\u62e5\u6709\u7684\u526f\u672c\u7684\u6570\u91cf</li> <li>\u6bcf\u4e2a\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u5199\u5165\u90fd\u4f1a\u53d1\u9001\u5230\u6240\u6709\u526f\u672c</li> <li>\u5ba2\u6237\u7aef\u901a\u5e38\u53ea\u7b49\u5f85\u6765\u81ea\u5176\u672c\u5730\u6570\u636e\u4e2d\u5fc3\u5185\u7684\u6cd5\u5b9a\u8282\u70b9\u7684\u786e\u8ba4\uff0c\u4e0d\u4f1a\u53d7\u5230\u8de8\u6570\u636e\u4e2d\u5fc3\u94fe\u8def\u5ef6\u8fdf\u548c\u4e2d\u65ad\u7684\u5f71\u54cd</li> <li>\u5176\u4ed6\u6570\u636e\u4e2d\u5fc3\u7684\u9ad8\u5ef6\u8fdf\u5199\u5165\u901a\u5e38\u88ab\u914d\u7f6e\u4e3a\u5f02\u6b65\u6267\u884c</li> </ul> <p>Riak \u5c06\u5ba2\u6237\u7aef\u548c\u6570\u636e\u5e93\u8282\u70b9\u4e4b\u95f4\u7684\u6240\u6709\u901a\u4fe1\u4fdd\u6301\u5728\u4e00\u4e2a\u672c\u5730\u7684\u6570\u636e\u4e2d\u5fc3\uff0c\u56e0\u6b64 n \u63cf\u8ff0\u4e86\u4e00\u4e2a\u6570\u636e\u4e2d\u5fc3\u5185\u7684\u526f\u672c\u6570\u91cf\u3002\u6570\u636e\u5e93\u96c6\u7fa4\u4e4b\u95f4\u7684\u8de8\u6570\u636e\u4e2d\u5fc3\u590d\u5236\u5728\u540e\u53f0\u5f02\u6b65\u53d1\u751f\uff0c\u5176\u98ce\u683c\u7c7b\u4f3c\u4e8e\u591a\u4e3b\u590d\u5236\\(^{[24]}\\)\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_38","title":"\u68c0\u6d4b\u5e76\u53d1\u5199\u5165","text":"<p>Dynamo \u98ce\u683c\u7684\u6570\u636e\u5e93\u5141\u8bb8\u591a\u4e2a\u5ba2\u6237\u7aef\u540c\u65f6\u5199\u5165\u76f8\u540c\u7684\u952e\uff08Key\uff09\uff0c\u8fd9\u610f\u5473\u7740\u5373\u4f7f\u4f7f\u7528\u4e25\u683c\u7684\u6cd5\u5b9a\u4eba\u6570\u4e5f\u4f1a\u53d1\u751f\u51b2\u7a81\u3002\u5728 \u8bfb\u4fee\u590d \u6216 \u63d0\u793a\u79fb\u4ea4 \u671f\u95f4\u4e5f\u53ef\u80fd\u4f1a\u4ea7\u751f\u51b2\u7a81\u3002</p> <p>\u7531\u4e8e\u53ef\u53d8\u7684\u7f51\u7edc\u5ef6\u8fdf\u548c\u90e8\u5206\u8282\u70b9\u7684\u6545\u969c\uff0c\u4e8b\u4ef6\u53ef\u80fd\u4ee5\u4e0d\u540c\u7684\u987a\u5e8f\u5230\u8fbe\u4e0d\u540c\u7684\u8282\u70b9\u3002</p> <p>\u5982\u679c\u6bcf\u4e2a\u8282\u70b9\u53ea\u8981\u63a5\u6536\u5230\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u5199\u5165\u8bf7\u6c42\u5c31\u7b80\u5355\u5730\u8986\u5199\u67d0\u4e2a\u952e\u503c\uff0c\u90a3\u4e48\u8282\u70b9\u5c31\u4f1a\u6c38\u4e45\u5730\u4e0d\u4e00\u81f4\u3002\u4e0b\u56fe\u663e\u793a\u4e86\u4e24\u4e2a\u5ba2\u6237\u673a A \u548c B \u540c\u65f6\u5199\u5165\u4e09\u8282\u70b9\u6570\u636e\u5b58\u50a8\u4e2d\u7684\u952e X\uff1a</p> <ul> <li>\u8282\u70b9 1 \u63a5\u6536\u6765\u81ea A \u7684\u5199\u5165\uff0c\u4f46\u7531\u4e8e\u6682\u65f6\u4e2d\u65ad\uff0c\u672a\u63a5\u6536\u5230\u6765\u81ea B \u7684\u5199\u5165\u3002</li> <li>\u8282\u70b9 2 \u9996\u5148\u63a5\u6536\u6765\u81ea A \u7684\u5199\u5165\uff0c\u7136\u540e\u63a5\u6536\u6765\u81ea B \u7684\u5199\u5165\u3002</li> <li>\u8282\u70b9 3 \u9996\u5148\u63a5\u6536\u6765\u81ea B \u7684\u5199\u5165\uff0c\u7136\u540e\u4ece A \u5199\u5165\u3002</li> </ul> <p></p> <p>\u4e3a\u4e86\u6700\u7ec8\u8fbe\u6210\u4e00\u81f4\uff0c\u526f\u672c\u5e94\u8be5\u8d8b\u4e8e\u76f8\u540c\u7684\u503c\u3002\u5728 \u201c\u5904\u7406\u5199\u5165\u51b2\u7a81\u201d \u4e00\u8282\u4e2d\u5df2\u7ecf\u7b80\u8981\u4ecb\u7ecd\u4e86\u4e00\u4e9b\u89e3\u51b3\u51b2\u7a81\u7684\u6280\u672f\uff0c\u4e0b\u9762\u66f4\u8be6\u7ec6\u5730\u8ba8\u8bba\u8fd9\u4e2a\u95ee\u9898\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_39","title":"\u6700\u540e\u5199\u5165\u80dc\u5229\uff08\u4e22\u5f03\u5e76\u53d1\u5199\u5165\uff09","text":"<p>\u5b9e\u73b0\u6700\u7ec8\u6536\u655b\u7684\u4e00\u79cd\u65b9\u6cd5\u662f\u58f0\u660e\u6bcf\u4e2a\u526f\u672c\u53ea\u9700\u8981\u5b58\u50a8 \u201c\u6700\u8fd1\u201d \u7684\u503c\uff0c\u5e76\u5141\u8bb8 \u201c\u66f4\u65e7\u201d \u7684\u503c\u88ab\u8986\u76d6\u548c\u629b\u5f03\u3002</p> <ul> <li>\u5199\u5165\u662f \u5e76\u53d1\uff08concurrent\uff09 \u7684\uff0c\u90a3\u4e48\u5b83\u4eec\u7684\u987a\u5e8f\u5c31\u662f\u4e0d\u786e\u5b9a\u7684\uff0c\u5373\u6ca1\u6709\u81ea\u7136\u7684\u6392\u5e8f\uff1b</li> </ul> <p>\u6700\u540e\u5199\u5165\u80dc\u5229\uff08LWW, last write wins\uff09\uff1aCassandra \u552f\u4e00\u652f\u6301\u7684\u51b2\u7a81\u89e3\u51b3\u65b9\u6cd5\\(^{[25]}\\)</p> <ul> <li>\u4e3a\u6bcf\u4e2a\u5199\u5165\u9644\u52a0\u4e00\u4e2a\u65f6\u95f4\u6233\uff0c\u7136\u540e\u6311\u9009\u6700\u5927\u7684\u65f6\u95f4\u6233\u4f5c\u4e3a \u201c\u6700\u8fd1\u7684\u201d\uff0c\u5e76\u4e22\u5f03\u5177\u6709\u8f83\u65e9\u65f6\u95f4\u6233\u7684\u4efb\u4f55\u5199\u5165</li> <li>\u4ee5 \u6301\u4e45\u6027 \u4e3a\u4ee3\u4ef7\uff1a\u540c\u4e00\u4e2a\u952e\u6709\u591a\u4e2a\u5e76\u53d1\u5199\u5165\uff0c\u5373\u4f7f\u5b83\u4eec\u53cd\u9988\u7ed9\u5ba2\u6237\u7aef\u7684\u7ed3\u679c\u90fd\u662f\u6210\u529f\u7684\uff08\u56e0\u4e3a\u5b83\u4eec\u88ab\u5199\u5165 w \u4e2a\u526f\u672c\uff09\uff0c\u4e5f\u53ea\u6709\u4e00\u4e2a\u5199\u5165\u5c06\u88ab\u4fdd\u7559\uff0c\u800c\u5176\u4ed6\u5199\u5165\u5c06\u88ab\u9ed8\u9ed8\u5730\u4e22\u5f03</li> <li>LWW \u751a\u81f3\u53ef\u80fd\u4f1a\u4e22\u5f03\u4e0d\u662f\u5e76\u53d1\u7684\u5199\u5165\uff0c\u89c1 \u201c\u6709\u5e8f\u4e8b\u4ef6\u7684\u65f6\u95f4\u6233\u201d</li> </ul> <p>\u5982\u679c\u6570\u636e\u4e22\u5931\u4e0d\u53ef\u63a5\u53d7\uff0cLWW \u662f\u89e3\u51b3\u51b2\u7a81\u7684\u4e00\u4e2a\u5f88\u70c2\u7684\u9009\u62e9\u3002</p> <p>\u5728\u6570\u636e\u5e93\u4e2d\u4f7f\u7528 LWW \u7684\u552f\u4e00\u5b89\u5168\u65b9\u6cd5\u662f\u786e\u4fdd\u4e00\u4e2a\u952e\u53ea\u5199\u5165\u4e00\u6b21\uff0c\u7136\u540e\u89c6\u4e3a\u4e0d\u53ef\u53d8\uff0c\u4ece\u800c\u907f\u514d\u5bf9\u540c\u4e00\u4e2a\u952e\u8fdb\u884c\u5e76\u53d1\u66f4\u65b0\u3002</p> <ul> <li>\uff1f\uff1fCassandra \u63a8\u8350\u4f7f\u7528\u7684\u65b9\u6cd5\u662f\u4f7f\u7528 UUID \u4f5c\u4e3a\u952e\uff0c\u4ece\u800c\u4e3a\u6bcf\u4e2a\u5199\u64cd\u4f5c\u63d0\u4f9b\u4e00\u4e2a\u552f\u4e00\u7684\u952e\\(^{[25]}\\)\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_40","title":"\u201c\u6b64\u524d\u53d1\u751f\u201d\u7684\u5173\u7cfb\u548c\u5e76\u53d1","text":"<p>\u5982\u679c\u64cd\u4f5c B \u4e86\u89e3\u64cd\u4f5c A\uff0c\u6216\u8005\u4f9d\u8d56\u4e8e A\uff0c\u6216\u8005\u4ee5\u67d0\u79cd\u65b9\u5f0f\u6784\u5efa\u4e8e\u64cd\u4f5c A \u4e4b\u4e0a\uff0c\u5219\u64cd\u4f5c A \u5728\u64cd\u4f5c B \u4e4b\u524d\u53d1\u751f\uff08happens before\uff09\u3002</p> <p>\u5e76\u53d1\u64cd\u4f5c\\(^{[26]}\\)\uff1a\u5982\u679c\u4e24\u4e2a\u64cd\u4f5c\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\u90fd\u4e0d\u5728\u53e6\u4e00\u4e2a\u4e4b\u524d\u53d1\u751f\uff08\u5373\uff0c\u4e24\u4e2a\u64cd\u4f5c\u90fd\u4e0d\u77e5\u9053\u5bf9\u65b9\uff09\u3002</p> <ul> <li>\u5982\u679c\u4e00\u4e2a\u64cd\u4f5c\u53d1\u751f\u5728\u53e6\u4e00\u4e2a\u64cd\u4f5c\u4e4b\u524d\uff0c\u5219\u540e\u9762\u7684\u64cd\u4f5c\u5e94\u8be5\u8986\u76d6\u524d\u9762\u7684\u64cd\u4f5c\uff0c\u4f46\u662f\u5982\u679c\u8fd9\u4e9b\u64cd\u4f5c\u662f\u5e76\u53d1\u7684\uff0c\u5219\u5b58\u5728\u9700\u8981\u89e3\u51b3\u7684\u51b2\u7a81\u3002</li> </ul> <p>\u5e76\u53d1\u6027\u3001\u65f6\u95f4\u548c\u76f8\u5bf9\u6027</p> <p>\u7531\u4e8e\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u65f6\u949f\u95ee\u9898\uff0c\u73b0\u5b9e\u4e2d\u662f\u5f88\u96be\u5224\u65ad\u4e24\u4e2a\u4e8b\u4ef6\u662f\u5426\u662f \u540c\u65f6 \u53d1\u751f\u7684\u3002</p> <p>\u4e3a\u4e86\u5b9a\u4e49\u5e76\u53d1\u6027\uff0c\u786e\u5207\u7684\u65f6\u95f4\u5e76\u4e0d\u91cd\u8981\uff1a\u5982\u679c\u4e24\u4e2a\u64cd\u4f5c\u90fd\u610f\u8bc6\u4e0d\u5230\u5bf9\u65b9\u7684\u5b58\u5728\uff0c\u5c31\u79f0\u8fd9\u4e24\u4e2a\u64cd\u4f5c \u5e76\u53d1\uff0c\u800c\u4e0d\u7ba1\u5b83\u4eec\u5b9e\u9645\u53d1\u751f\u7684\u7269\u7406\u65f6\u95f4\u3002</p> <p>\u5728\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e2d\uff0c\u5373\u4f7f\u4e00\u4e2a\u64cd\u4f5c\u5f71\u54cd\u53e6\u4e00\u4e2a\u64cd\u4f5c\uff0c\u4f46\u4e24\u4e2a\u64cd\u4f5c\u4e5f\u53ef\u80fd\u662f \u5e76\u53d1\u7684\u3002</p> <ul> <li>\u5982\u679c\u7f51\u7edc\u7f13\u6162\u6216\u4e2d\u65ad\uff0c\u4e24\u4e2a\u64cd\u4f5c\u95f4\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e00\u6bb5\u65f6\u95f4\u95f4\u9694\uff0c\u4f46\u4ecd\u7136\u662f\u5e76\u53d1\u7684\uff0c\u56e0\u4e3a\u7f51\u7edc\u95ee\u9898\u963b\u6b62\u4e00\u4e2a\u64cd\u4f5c\u610f\u8bc6\u5230\u53e6\u4e00\u4e2a\u64cd\u4f5c\u7684\u5b58\u5728\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_41","title":"\u6355\u83b7\"\u6b64\u524d\u53d1\u751f\"\u5173\u7cfb","text":"<p>\u770b\u4e00\u4e2a\u7b97\u6cd5\uff0c\u5b83\u53ef\u4ee5\u786e\u5b9a\u4e24\u4e2a\u64cd\u4f5c\u662f\u5426\u4e3a\u5e76\u53d1\u7684\uff0c\u8fd8\u662f\u4e00\u4e2a\u5728\u53e6\u4e00\u4e2a\u4e4b\u524d\u3002\u7b80\u5355\u8d77\u89c1\uff0c\u6211\u4eec\u4ece\u4e00\u4e2a\u53ea\u6709\u4e00\u4e2a\u526f\u672c\u7684\u6570\u636e\u5e93\u5f00\u59cb\u3002</p> <p>\u4e0b\u56fe\u663e\u793a\u4e86\u4e24\u4e2a\u5ba2\u6237\u7aef\u540c\u65f6\u5411\u540c\u4e00\u8d2d\u7269\u8f66\u6dfb\u52a0\u9879\u76ee\uff1a</p> <p></p> <p>\u4e0a\u56fe\u64cd\u4f5c\u4e4b\u95f4\u7684\u6570\u636e\u6d41\u5982\u4e0b\u56fe\u6240\u793a\uff1a\u7bad\u5934\u8868\u793a\u54ea\u4e2a\u64cd\u4f5c\u53d1\u751f\u5728\u5176\u4ed6\u64cd\u4f5c\u4e4b\u524d\uff0c\u610f\u5473\u7740\u540e\u9762\u7684\u64cd\u4f5c\u77e5\u9053\u6216\u4f9d\u8d56\u4e8e\u8f83\u65e9\u7684\u64cd\u4f5c\u3002</p> <ul> <li>\u5ba2\u6237\u7aef\u6c38\u8fdc\u4e0d\u4f1a\u5b8c\u5168\u62ff\u5230\u670d\u52a1\u5668\u4e0a\u7684\u6700\u65b0\u6570\u636e\uff0c\u56e0\u4e3a\u603b\u662f\u6709\u53e6\u4e00\u4e2a\u64cd\u4f5c\u540c\u65f6\u8fdb\u884c\u3002\u4f46\u662f\u65e7\u7248\u672c\u7684\u503c\u6700\u7ec8\u4f1a\u88ab\u8986\u76d6\uff0c\u5e76\u4e14\u4e0d\u4f1a\u4e22\u5931\u4efb\u4f55\u5199\u5165\u3002</li> </ul> <p></p> <p>\u670d\u52a1\u5668\u53ef\u4ee5\u53ea\u901a\u8fc7\u67e5\u770b\u7248\u672c\u53f7\u6765\u786e\u5b9a\u4e24\u4e2a\u64cd\u4f5c\u662f\u5426\u662f\u5e76\u53d1\u7684 \u2014\u2014 \u5b83\u4e0d\u9700\u8981\u5bf9\u503c\u672c\u8eab\u8fdb\u884c\u89e3\u91ca\uff08\u56e0\u6b64\u8be5\u503c\u53ef\u4ee5\u662f\u4efb\u4f55\u6570\u636e\u7ed3\u6784\uff09\u3002\u8be5\u7b97\u6cd5\u7684\u5de5\u4f5c\u539f\u7406\u5982\u4e0b\uff1a</p> <ul> <li>\u670d\u52a1\u5668\u4e3a\u6bcf\u4e2a\u952e\u7ef4\u62a4\u4e00\u4e2a\u7248\u672c\u53f7\uff1a\u6bcf\u6b21\u5199\u5165\u8be5\u952e\u65f6\u90fd\u9012\u589e\u7248\u672c\u53f7\uff0c\u5e76\u5c06\u65b0\u7248\u672c\u53f7\u4e0e\u5199\u5165\u7684\u503c\u4e00\u8d77\u5b58\u50a8\uff1b</li> <li>\u5f53\u5ba2\u6237\u7aef\u8bfb\u53d6\u952e\u65f6\uff0c\u670d\u52a1\u5668\u5c06\u8fd4\u56de\u6240\u6709\u672a\u8986\u76d6\u7684\u503c\u4ee5\u53ca\u6700\u65b0\u7684\u7248\u672c\u53f7\u3002\u5ba2\u6237\u7aef\u5728\u5199\u5165\u524d\u5fc5\u987b\u5148\u8bfb\u53d6\uff1b</li> <li>\u5f53\u5ba2\u6237\u7aef\u5199\u5165\u952e\u65f6\uff0c\u5fc5\u987b\u5305\u542b\u4e4b\u524d\u8bfb\u53d6\u7684\u7248\u672c\u53f7\uff0c\u5e76\u4e14\u5fc5\u987b\u5c06\u4e4b\u524d\u8bfb\u53d6\u7684\u6240\u6709\u503c\u5408\u5e76\u5728\u4e00\u8d77\uff1b</li> <li>\u5f53\u670d\u52a1\u5668\u63a5\u6536\u5230\u5177\u6709\u7279\u5b9a\u7248\u672c\u53f7\u7684\u5199\u5165\u65f6\uff0c\u5b83\u53ef\u4ee5\u8986\u76d6\u8be5\u7248\u672c\u53f7\u6216\u66f4\u4f4e\u7248\u672c\u7684\u6240\u6709\u503c\uff08\u56e0\u4e3a\u5b83\u77e5\u9053\u5b83\u4eec\u5df2\u7ecf\u88ab\u5408\u5e76\u5230\u65b0\u7684\u503c\u4e2d\uff09\uff0c\u4f46\u662f\u5b83\u5fc5\u987b\u7528\u66f4\u9ad8\u7684\u7248\u672c\u53f7\u6765\u4fdd\u5b58\u6240\u6709\u503c\uff08\u56e0\u4e3a\u8fd9\u4e9b\u503c\u4e0e\u6b63\u5728\u8fdb\u884c\u7684\u5176\u5b83\u5199\u5165\u662f\u5e76\u53d1\u7684\uff09\uff1b</li> </ul> <p>\u5f53\u4e00\u4e2a\u5199\u5165\u5305\u542b\u524d\u4e00\u6b21\u8bfb\u53d6\u7684\u7248\u672c\u53f7\u65f6\uff0c\u5b83\u4f1a\u544a\u8bc9\u6211\u4eec\u7684\u5199\u5165\u662f\u57fa\u4e8e\u4e4b\u524d\u7684\u54ea\u4e00\u79cd\u72b6\u6001\uff1a</p> <ul> <li>\u5728\u4e0d\u5305\u542b\u7248\u672c\u53f7\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u5199\u64cd\u4f5c\uff0c\u5219\u4e0e\u6240\u6709\u5176\u4ed6\u5199\u64cd\u4f5c\u5e76\u53d1\uff0c\u56e0\u6b64\u5b83\u4e0d\u4f1a\u8986\u76d6\u4efb\u4f55\u5185\u5bb9\uff0c\u53ea\u4f1a\u5728\u968f\u540e\u7684\u8bfb\u53d6\u4e2d\u4f5c\u4e3a\u5176\u4e2d\u4e00\u4e2a\u503c\u8fd4\u56de\u3002</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_42","title":"\u5408\u5e76\u5e76\u53d1\u5199\u5165\u7684\u503c","text":"<p>\u8fd9\u79cd\u7b97\u6cd5\u53ef\u4ee5\u786e\u4fdd\u6ca1\u6709\u6570\u636e\u88ab\u65e0\u58f0\u5730\u4e22\u5f03\uff0c\u5ba2\u6237\u7aef\u9700\u8981\u505a\u4e00\u4e9b\u989d\u5916\u7684\u5de5\u4f5c\uff1a\u5ba2\u6237\u7aef\u968f\u540e\u5fc5\u987b\u5408\u5e76\u5e76\u53d1\u5199\u5165\u7684\u503c\u3002</p> <ul> <li>\u8fd9\u4e9b\u5e76\u53d1\u503c\u4e3a \u5144\u5f1f\uff08siblings\uff09</li> </ul> <p>\u5408\u5e76\u5e76\u53d1\u503c\uff1a</p> <ul> <li>\u6839\u636e\u7248\u672c\u53f7\u6216\u65f6\u95f4\u6233\uff08\u6700\u540e\u5199\u5165\u80dc\u5229\uff09\u6765\u9009\u62e9\u4e00\u4e2a\u503c\uff0c\u4f46\u8fd9\u610f\u5473\u7740\u4e22\u5931\u6570\u636e\uff1b</li> <li>\u4e00\u79cd\u5408\u7406\u7684\u5408\u5e76\u503c\u7684\u65b9\u6cd5\u5c31\u662f\u505a\u5e76\u96c6\uff0c\u5982\u8d2d\u7269\u8f66\u7684\u4f8b\u5b50\uff0c\u4f46\u4e0d\u9002\u7528\u4e8e\u4ece\u8d2d\u7269\u8f66\u4e2d\u79fb\u9664\u4e1c\u897f\uff1b</li> <li>\u5893\u7891\uff08tombstone\uff09\u673a\u5236\uff1a\u5220\u9664\u6807\u8bb0\uff0c\u8868\u660e\u5408\u5e76\u65f6\u8868\u660e\u8be5\u9879\u76ee\u5df2\u88ab\u79fb\u9664\uff1b</li> </ul> <p>\u5728\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u4e2d\u505a\u5144\u5f1f\u5408\u5e76\u662f\u590d\u6742\u4e14\u5bb9\u6613\u51fa\u9519\uff1a</p> <ul> <li>\u4e00\u4e9b\u6570\u636e\u7ed3\u6784\u88ab\u8bbe\u8ba1\u51fa\u6765\u7528\u4e8e\u81ea\u52a8\u6267\u884c\u8fd9\u79cd\u5408\u5e76\uff0c\u5982 CRDT\\(^{[13,27,28]}\\) \u7b49\uff1b</li> </ul>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_43","title":"\u7248\u672c\u5411\u91cf","text":"<p>\u4e0a\u4f8b\u5355\u526f\u672c\u65f6\u4f7f\u7528\u5355\u4e2a\u7248\u672c\u53f7\u6765\u6355\u83b7\u64cd\u4f5c\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u4f46\u662f\u5f53\u591a\u4e2a\u526f\u672c\u5e76\u53d1\u63a5\u53d7\u5199\u5165\u65f6\uff0c\u8fd9\u662f\u4e0d\u591f\u7684\uff1a</p> <ul> <li>\u9664\u4e86\u5bf9\u6bcf\u4e2a\u952e\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u5bf9 \u6bcf\u4e2a\u526f\u672c \u4f7f\u7528\u7248\u672c\u53f7</li> <li>\u4fe1\u606f\u6307\u51fa\u4e86\u8981\u8986\u76d6\u54ea\u4e9b\u5e76\u53d1\u503c\uff0c\u4ee5\u53ca\u8981\u4fdd\u7559\u54ea\u4e9b\u5e76\u53d1\u503c\u6216\u5144\u5f1f\u503c</li> </ul> <p>\u6240\u6709\u526f\u672c\u7684\u7248\u672c\u53f7\u96c6\u5408\u79f0\u4e3a \u7248\u672c\u5411\u91cf\uff08version vector\uff09\\(^{[29]}\\) \uff1a</p> <ul> <li>\u5f53\u8bfb\u53d6\u503c\u65f6\uff0c\u7248\u672c\u5411\u91cf\u4f1a\u4ece\u6570\u636e\u5e93\u526f\u672c\u53d1\u9001\u5230\u5ba2\u6237\u7aef\uff0c\u5e76\u4e14\u968f\u540e\u5199\u5165\u503c\u65f6\u9700\u8981\u5c06\u5176\u53d1\u9001\u56de\u6570\u636e\u5e93\uff1b</li> <li>\u7248\u672c\u5411\u91cf\u5141\u8bb8\u6570\u636e\u5e93\u533a\u5206\u8986\u76d6\u5199\u5165\u548c\u5e76\u53d1\u5199\u5165\uff1b</li> <li>\u7248\u672c\u5411\u91cf\u7ed3\u6784\u80fd\u591f\u786e\u4fdd\u4ece\u4e00\u4e2a\u526f\u672c\u8bfb\u53d6\u5e76\u968f\u540e\u5199\u56de\u5230\u53e6\u4e00\u4e2a\u526f\u672c\u662f\u5b89\u5168\u7684</li> <li>Riak 2.0 \\(^{[30,31]}\\)\u4e2d\u4f7f\u7528\u5176\u53d8\u4f53\u7684 \u865a\u7ebf\u7248\u672c\u5411\u91cf\uff08dotted version vector\uff09\\(^{[32]}\\)</li> </ul> <p>\u7248\u672c\u5411\u91cf\u548c\u5411\u91cf\u65f6\u949f</p> <p>\u7248\u672c\u5411\u91cf\u6709\u65f6\u4e5f\u88ab\u79f0\u4e3a\u5411\u91cf\u65f6\u949f\uff0c\u5373\u4f7f\u5b83\u4eec\u4e0d\u5b8c\u5168\u76f8\u540c\u3002\u5176\u4e2d\u7684\u5dee\u522b\u5f88\u5fae\u5999 \u2014\u2014 \u7ec6\u8282\u8bf7\u53c2\u9605\u53c2\u8003\u8d44\u6599\\(^{[32,33,34]}\\)\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u5728\u6bd4\u8f83\u526f\u672c\u7684\u72b6\u6001\u65f6\uff0c\u7248\u672c\u5411\u91cf\u624d\u662f\u6b63\u786e\u7684\u6570\u636e\u7ed3\u6784\u3002</p>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/5_replication.html#_44","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>Yoshinori Matsunobu: \u201cSemi-Synchronous Replication at Facebook,\u201d yoshinorimatsunobu.blogspot.co.uk, April 1, 2014.</li> <li>Robbert van Renesse and Fred B. Schneider: \u201cChain Replication for Supporting High Throughput and Availability,\u201d at 6th USENIX Symposium on Operating System Design and Implementation (OSDI), December 2004.</li> <li>Jeff Terrace and Michael J. Freedman: \u201cObject Storage on CRAQ: High-Throughput Chain Replication for Read-Mostly Workloads,\u201d at USENIX Annual Technical Conference (ATC), June 2009.</li> <li>Jesse Newland: \u201cGitHub Availability This Week,\u201d github.com, September 14, 2012.</li> <li>Mark Imbriaco: \u201cDowntime Last Saturday,\u201d github.com, December 26, 2012.</li> <li>Douglas B. Terry, Alan J. Demers, Karin Petersen, et al.: \u201cSession Guarantees for Weakly Consistent Replicated Data,\u201d at 3rd International Conference on Parallel and Distributed Information Systems (PDIS), September 1994. doi:10.1109/PDIS.1994.331722</li> <li>Douglas B. Terry: \u201cReplicated Data Consistency Explained Through Baseball,\u201d Microsoft Research, Technical Report MSR-TR-2011-137, October 2011.</li> <li>J. Chris Anderson, Jan Lehnardt, and Noah Slater: CouchDB: The Definitive Guide. O'Reilly Media, 2010. ISBN: 978-0-596-15589-6</li> <li>Martin Kleppmann and Alastair R. Beresford: \u201cA Conflict-Free Replicated JSON Datatype,\u201d arXiv:1608.03960, August 13, 2016.</li> <li>Frazer Clement: \u201cEventual Consistency \u2013 Detecting Conflicts,\u201d messagepassing.blogspot.co.uk, October 20, 2011.</li> <li>Robert Hodges: \u201cState of the Art for MySQL Multi-Master Replication,\u201d at Percona Live: MySQL Conference &amp; Expo, April 2013.</li> <li>Riley Berton: \u201cIs Bi-Directional Replication (BDR) in Postgres Transactional?,\u201d sdf.org, January 4, 2016.</li> <li>Marc Shapiro, Nuno Pregui\u00e7a, Carlos Baquero, and Marek Zawirski: \u201cA Comprehensive Study of Convergent and Commutative Replicated Data Types,\u201d INRIA Research Report no. 7506, January 2011.</li> <li>Benjamin Farinier, Thomas Gazagnaire, and Anil Madhavapeddy: \u201cMergeable Persistent Data Structures,\u201d at 26es Journ\u00e9es Francophones des Langages Applicatifs (JFLA), January 2015.</li> <li>John Day-Richter: \u201cWhat\u2019s Different About the New Google Docs: Making Collaboration Fast,\u201d googledrive.blogspot.com, 23 September 2010.</li> <li>\"yjs/yjs: Shared data types for building collaborative software\".</li> <li>Lars Hofhansl: \u201cHBASE-7709: Infinite Loop Possible in Master/Master Replication,\u201d issues.apache.org, January 29, 2013.</li> <li>Giuseppe DeCandia, Deniz Hastorun, Madan Jampani, et al.: \u201cDynamo: Amazon's Highly Available Key-Value Store,\u201d at 21st ACM Symposium on Operating Systems Principles (SOSP), October 2007.</li> <li>Joseph Blomstedt: \u201cRe: Absolute Consistency,\u201d email to riak-users mailing list, lists.basho.com, January 11, 2012.</li> <li>John Daily: \u201cClocks Are Bad, or, Welcome to the Wonderful World of Distributed Systems,\u201d basho.com, November 12, 2013.</li> <li>Joseph Blomstedt: \u201cBringing Consistency to Riak,\u201d at RICON West, October 2012.</li> <li>Peter Bailis, Shivaram Venkataraman, Michael J. Franklin, et al.: \u201cQuantifying Eventual Consistency with PBS,\u201d Communications of the ACM, volume 57, number 8, pages 93\u2013102, August 2014. doi:10.1145/2632792</li> <li>\u201cApache Cassandra 2.0 Documentation,\u201d DataStax, Inc., 2014.</li> <li>\u201cRiak Enterprise: Multi-Datacenter Replication.\u201d Technical whitepaper, Basho Technologies, Inc., September 2014.</li> <li>Jonathan Ellis: \u201cWhy Cassandra Doesn't Need Vector Clocks,\u201d datastax.com, September 2, 2013.</li> <li>Leslie Lamport: \u201cTime, Clocks, and the Ordering of Events in a Distributed System,\u201d Communications of the ACM, volume 21, number 7, pages 558\u2013565, July 1978. doi:10.1145/359545.359563</li> <li>Sam Elliott: \u201cCRDTs: An UPDATE (or Maybe Just a PUT),\u201d at RICON West, October 2013.</li> <li>Joel Jacobson: \u201cRiak 2.0: Data Types,\u201d blog.joeljacobson.com, March 23, 2014.</li> <li>D. Stott Parker Jr., Gerald J. Popek, Gerard Rudisin, et al.: \u201cDetection of Mutual Inconsistency in Distributed Systems,\u201d IEEE Transactions on Software Engineering, volume 9, number 3, pages 240\u2013247, May 1983. doi:10.1109/TSE.1983.236733</li> <li>Sean Cribbs: \u201cA Brief History of Time in Riak,\u201d at RICON, October 2014.</li> <li>Russell Brown: \u201cVector Clocks Revisited Part 2: Dotted Version Vectors,\u201d basho.com, November 10, 2015.</li> <li>Nuno Pregui\u00e7a, Carlos Baquero, Paulo S\u00e9rgio Almeida, et al.: \u201cDotted Version Vectors: Logical Clocks for Optimistic Replication,\u201d arXiv:1011.5808, November 26, 2010.</li> <li>Carlos Baquero: \u201cVersion Vectors Are Not Vector Clocks,\u201d haslab.wordpress.com, July 8, 2011.</li> <li>Reinhard Schwarz and Friedemann Mattern: \u201cDetecting Causal Relationships in Distributed Computations: In Search of the Holy Grail,\u201d Distributed Computing, volume 7, number 3, pages 149\u2013174, March 1994. doi:10.1007/BF02277859</li> </ol>","tags":["\u6570\u636e\u5bc6\u96c6\u578b\u7cfb\u7edf"]},{"location":"books/data_intensive_system_book/6_partitions.html","title":"\u5206\u533a","text":"<p>\u7ee7\u7eed\u8003\u5bdf\u6570\u636e\u5206\u5e03\u5728\u591a\u53f0\u673a\u5668\u95f4\u7684\u53e6\u4e00\u79cd\u4e0d\u540c\u4e8e \u590d\u5236 \u7684\u5f62\u5f0f\uff1a\u5c06\u5927\u6570\u636e\u96c6\u5206\u5272\u6210 \u5206\u533a</p> <p>\u5bf9\u4e8e\u975e\u5e38\u5927\u7684\u6570\u636e\u96c6\uff0c\u6216\u975e\u5e38\u9ad8\u7684\u541e\u5410\u91cf\uff0c\u4ec5\u4ec5\u8fdb\u884c\u590d\u5236\u662f\u4e0d\u591f\u7684\uff1a\u6211\u4eec\u9700\u8981\u5c06\u6570\u636e\u8fdb\u884c \u5206\u533a\uff08partitions\uff09\uff0c\u4e5f\u79f0\u4e3a \u5206\u7247\uff08sharding\uff09\u3002</p> <p>\u5206\u533a\u4e3b\u8981\u662f\u4e3a\u4e86 \u53ef\u4f38\u7f29\u6027\u3002\u4e0d\u540c\u7684\u5206\u533a\u53ef\u4ee5\u653e\u5728\u4e0d\u5171\u4eab\u96c6\u7fa4\u4e2d\u7684\u4e0d\u540c\u8282\u70b9\u4e0a:</p> <ul> <li>\u5927\u6570\u636e\u96c6\u53ef\u4ee5\u5206\u5e03\u5728\u591a\u4e2a\u78c1\u76d8\u4e0a\uff0c\u5e76\u4e14\u67e5\u8be2\u8d1f\u8f7d\u53ef\u4ee5\u5206\u5e03\u5728\u591a\u4e2a\u5904\u7406\u5668\u4e0a\u3002</li> </ul> <p>\u5206\u533a\u7684\u76ee\u6807\u662f\u5728\u591a\u53f0\u673a\u5668\u4e0a\u5747\u5300\u5206\u5e03\u6570\u636e\u548c\u67e5\u8be2\u8d1f\u8f7d\uff0c\u907f\u514d\u51fa\u73b0\u70ed\u70b9\uff08\u8d1f\u8f7d\u4e0d\u6210\u6bd4\u4f8b\u7684\u8282\u70b9\uff09\u3002\u4e3b\u8981\u4e24\u79cd\u5206\u533a\u65b9\u6cd5\uff1a</p> <ul> <li>\u952e\u8303\u56f4\u5206\u533a\uff1a\u952e\u662f\u6709\u5e8f\u7684\uff0c\u5e76\u4e14\u5206\u533a\u62e5\u6709\u4ece\u67d0\u4e2a\u6700\u5c0f\u503c\u5230\u67d0\u4e2a\u6700\u5927\u503c\u7684\u6240\u6709\u952e</li> <li>\u6709\u6548\u7684\u8303\u56f4\u67e5\u8be2\uff0c\u7ecf\u5e38\u8bbf\u95ee\u76f8\u90bb\u7684\u952e\uff0c\u5219\u5b58\u5728\u70ed\u70b9\u7684\u98ce\u9669\uff1b\u5206\u533a\u592a\u5927\u65f6\uff0c\u9700\u8981\u62c6\u5206\u6210\u4e24\u5b50\u5206\u533a\u52a8\u6001\u5730\u91cd\u65b0\u5e73\u8861\u5206\u533a\uff1b</li> <li>\u6563\u5217\u5206\u533a\uff1a\u6563\u5217\u51fd\u6570\u5e94\u7528\u4e8e\u6bcf\u4e2a\u952e\uff0c\u5206\u533a\u62e5\u6709\u4e00\u5b9a\u8303\u56f4\u7684\u6563\u5217\u3002</li> <li>\u8303\u56f4\u67e5\u8be2\u6548\u7387\u4f4e\u4e0b\uff0c\u4f46\u53ef\u4ee5\u66f4\u5747\u5300\u5730\u5206\u914d\u8d1f\u8f7d\uff1b\u901a\u5e38\u5148\u63d0\u524d\u521b\u5efa\u56fa\u5b9a\u6570\u91cf\u7684\u5206\u533a\uff0c\u4e3a\u6bcf\u4e2a\u8282\u70b9\u5206\u914d\u591a\u4e2a\u5206\u533a\uff0c\u4e5f\u53ef\u4ee5\u91c7\u7528\u52a8\u6001\u5206\u533a\uff1b</li> </ul> <p>\u590d\u5408\u4e3b\u952e\uff08\u4e24\u79cd\u5206\u533a\u642d\u914d\u4f7f\u7528\uff09\uff1a\u4f7f\u7528\u952e\u7684\u4e00\u90e8\u5206\u6765\u6807\u8bc6\u5206\u533a\uff0c\u800c\u4f7f\u7528\u53e6\u4e00\u90e8\u5206\u4f5c\u4e3a\u6392\u5e8f\u987a\u5e8f\u3002</p> <p>\u6b21\u7ea7\u7d22\u5f15\u4e5f\u9700\u8981\u5206\u533a\uff0c\u4e24\u79cd\u65b9\u6cd5\uff1a</p> <ul> <li>\u57fa\u4e8e\u6587\u6863\u5206\u533a\uff08\u672c\u5730\u7d22\u5f15\uff09\uff1a\u4e00\u4e2a\u5206\u533a\u9700\u8981\u5728\u5199\u5165\u65f6\u66f4\u65b0\uff0c\u8bfb\u53d6\u6b21\u7ea7\u7d22\u5f15\u9700\u8981\u5728\u6240\u6709\u5206\u533a\u4e4b\u95f4\u8fdb\u884c\u5206\u6563 / \u6536\u96c6\uff1b</li> <li>\u57fa\u4e8e\u5173\u952e\u8bcd\u5206\u533a\uff08\u5168\u5c40\u7d22\u5f15\uff09\uff1a\u5199\u5165\u65f6\u9700\u8981\u66f4\u65b0\u591a\u4e2a\u5206\u533a\u4e2d\u7684\u6b21\u7ea7\u7d22\u5f15\uff1b\u4f46\u662f\u53ef\u4ee5\u4ece\u5355\u4e2a\u5206\u533a\u4e2d\u8fdb\u884c\u8bfb\u53d6\uff1b</li> </ul> <p>\u6700\u540e\uff0c\u662f\u5c06\u67e5\u8be2\u8def\u7531\u5230\u9002\u5f53\u7684\u5206\u533a\u7684\u6280\u672f\uff0c\u4ece\u7b80\u5355\u7684\u5206\u533a\u8d1f\u8f7d\u5e73\u8861\u5230\u590d\u6742\u7684\u5e76\u884c\u67e5\u8be2\u6267\u884c\u5f15\u64ce\u3002</p> <p>\u6309\u7167\u8bbe\u8ba1\uff0c\u591a\u6570\u60c5\u51b5\u4e0b\u6bcf\u4e2a\u5206\u533a\u662f\u72ec\u7acb\u8fd0\u884c\u7684\uff08\u53ef\u4f38\u7f29\u6027\uff09\uff1a</p> <ul> <li>\u5199\u5165\u591a\u4e2a\u5206\u533a\u7684\u64cd\u4f5c\u7ed3\u679c\u5982\u679c\u4e00\u4e2a\u6210\u529f\uff0c\u4e00\u4e2a\u5931\u8d25\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\u60c5\u51b5\uff0c\u5c06\u5728\u4e0b\u4e00\u4e2a\u7ae0\u8282\u4e2d\u8ba8\u8bba\u8be5\u95ee\u9898\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/6_partitions.html#_2","title":"\u672f\u8bed\u6f84\u6e05","text":"<p>\u4e0a\u6587\u4e2d\u7684 \u5206\u533a\uff08partition\uff09\uff0c\u5728 MongoDB\uff0cElasticsearch \u548c Solr Cloud \u4e2d\u88ab\u79f0\u4e3a \u5206\u7247\uff08shard\uff09\uff0c\u5728 HBase \u4e2d\u79f0\u4e4b\u4e3a \u533a\u57df\uff08Region\uff09\uff0cBigtable \u4e2d\u5219\u662f \u8868\u5757\uff08tablet\uff09\uff0cCassandra \u548c Riak \u4e2d\u662f \u865a\u8282\u70b9\uff08vnode\uff09\uff0cCouchbase \u4e2d\u53eb\u505a \u865a\u6876\uff08vBucket\uff09\u3002\u4f46\u662f \u5206\u533a\uff08partitioning\uff09 \u662f\u6700\u7ea6\u5b9a\u4fd7\u6210\u7684\u53eb\u6cd5\u3002</p>"},{"location":"books/data_intensive_system_book/6_partitions.html#_3","title":"\u5206\u533a\u4e0e\u590d\u5236","text":"<p>\u5206\u533a\u901a\u5e38\u4e0e\u590d\u5236\u7ed3\u5408\u4f7f\u7528\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u5206\u533a\u7684\u526f\u672c\u5b58\u50a8\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u3002</p> <ul> <li>\u5373\u4f7f\u6bcf\u6761\u8bb0\u5f55\u5c5e\u4e8e\u4e00\u4e2a\u5206\u533a\uff0c\u5b83\u4ecd\u7136\u53ef\u4ee5\u5b58\u50a8\u5728\u591a\u4e2a\u4e0d\u540c\u7684\u8282\u70b9\u4e0a\u4ee5\u83b7\u5f97\u5bb9\u9519\u80fd\u529b\u3002</li> </ul> <p>\u4e00\u4e2a\u8282\u70b9\u53ef\u80fd\u5b58\u50a8\u591a\u4e2a\u5206\u533a\u3002\u5982\u679c\u4f7f\u7528\u4e3b\u4ece\u590d\u5236\u6a21\u578b\uff0c\u5219\u5206\u533a\u548c\u590d\u5236\u7684\u7ec4\u5408\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <ul> <li>\u6bcf\u4e2a\u5206\u533a\u9886\u5bfc\u8005\uff08\u4e3b\u5e93\uff09\u88ab\u5206\u914d\u7ed9\u4e00\u4e2a\u8282\u70b9\uff0c\u8ffd\u968f\u8005\uff08\u4ece\u5e93\uff09\u88ab\u5206\u914d\u7ed9\u5176\u4ed6\u8282\u70b9\u3002\u6bcf\u4e2a\u8282\u70b9\u53ef\u80fd\u662f\u67d0\u4e9b\u5206\u533a\u7684\u4e3b\u5e93\uff0c\u540c\u65f6\u662f\u5176\u4ed6\u5206\u533a\u7684\u4ece\u5e93\u3002</li> <li>\u7b2c\u4e94\u7ae0 \u8ba8\u8bba\u7684\u5173\u4e8e\u6570\u636e\u5e93\u590d\u5236\u7684\u6240\u6709\u5185\u5bb9\u540c\u6837\u9002\u7528\u4e8e\u5206\u533a\u7684\u590d\u5236\u3002\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u5206\u533a\u65b9\u6848\u7684\u9009\u62e9\u4e0e\u590d\u5236\u65b9\u6848\u7684\u9009\u62e9\u662f\u72ec\u7acb\u7684\u3002</li> </ul> <p></p>"},{"location":"books/data_intensive_system_book/6_partitions.html#_4","title":"\u952e\u503c\u6570\u636e\u7684\u5206\u533a","text":"<p>\u5206\u533a\u76ee\u6807\u662f\u5c06\u6570\u636e\u548c\u67e5\u8be2\u8d1f\u8f7d\u5747\u5300\u5206\u5e03\u5728\u5404\u4e2a\u8282\u70b9\u4e0a\u3002</p> <ul> <li>\u504f\u659c\uff08skew\uff09\uff1a\u4e00\u4e9b\u5206\u533a\u6bd4\u5176\u4ed6\u5206\u533a\u6709\u66f4\u591a\u7684\u6570\u636e\u6216\u67e5\u8be2</li> <li>\u70ed\u70b9\uff08hot spot\uff09\uff1a\u4e0d\u5747\u8861\u5bfc\u81f4\u7684\u9ad8\u8d1f\u8f7d\u7684\u5206\u533a</li> </ul>"},{"location":"books/data_intensive_system_book/6_partitions.html#_5","title":"\u6839\u636e\u952e\u7684\u8303\u56f4\u5206\u533a","text":"<p>\u4e00\u79cd\u5206\u533a\u7684\u65b9\u6cd5\u662f\u4e3a\u6bcf\u4e2a\u5206\u533a\u6307\u5b9a\u4e00\u5757\u8fde\u7eed\u7684\u952e\u8303\u56f4\uff08\u4ece\u6700\u5c0f\u503c\u5230\u6700\u5927\u503c\uff09\uff0c \u5982 HBase\\(^{[1]}\\)\uff1b</p> <ul> <li>\u4e3a\u4e86\u5747\u5300\u5206\u914d\u6570\u636e\uff0c\u5206\u533a\u8fb9\u754c\u9700\u8981\u4f9d\u636e\u6570\u636e\u8c03\u6574\uff08\u624b\u52a8\u6216\u81ea\u52a8\uff09\uff1b</li> </ul> <p>\u5728\u6bcf\u4e2a\u5206\u533a\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u4e00\u5b9a\u7684\u987a\u5e8f\u4fdd\u5b58\u952e\uff08\u8bf7\u53c2\u9605 \u201cSSTables \u548c LSM-Tree\u201d\uff09</p> <ul> <li>\u8303\u56f4\u626b\u63cf\u975e\u5e38\u7b80\u5355\uff1a\u5c06\u952e\u4f5c\u4e3a\u8054\u5408\u7d22\u5f15\u6765\u5904\u7406\uff0c\u4ee5\u4fbf\u5728\u4e00\u6b21\u67e5\u8be2\u4e2d\u83b7\u53d6\u591a\u4e2a\u76f8\u5173\u8bb0\u5f55</li> <li>\u67d0\u4e9b\u7279\u5b9a\u7684\u8bbf\u95ee\u6a21\u5f0f\u4f1a\u5bfc\u81f4\u70ed\u70b9\uff1a\u4f8b\u5982\u4e3b\u952e\u662f\u65f6\u95f4\u6233\uff0c\u6309\u5929\u5206\u533a\uff0c\u4f1a\u5bfc\u81f4\u4eca\u5929\u6240\u6709\u5199\u5165\u64cd\u4f5c\u90fd\u4f1a\u8f6c\u5230\u540c\u4e00\u4e2a\u5206\u533a</li> <li>\u591a\u7ea7\u5206\u533a\uff1a\u4f8b\u5982\u5148\u6309\u4f20\u611f\u5668\u540d\u79f0\uff0c\u7136\u540e\u6309\u65f6\u95f4\u8fdb\u884c\u5206\u533a</li> </ul>"},{"location":"books/data_intensive_system_book/6_partitions.html#_6","title":"\u6839\u636e\u952e\u7684\u6563\u5217\u5206\u533a","text":"<p>\u4e00\u4e2a\u597d\u7684\u6563\u5217\u51fd\u6570\u53ef\u4ee5\u5c06\u504f\u659c\u7684\u6570\u636e\u5747\u5300\u5206\u5e03</p> <ul> <li>\u6563\u5217\u51fd\u6570\u4e0d\u9700\u8981\u591a\u4e48\u5f3a\u58ee\u7684\u52a0\u5bc6\u7b97\u6cd5\uff1a\u5982  MD5 \u548c Fowler-Noll-Vo \u51fd\u6570\uff1b</li> </ul> <p>\u5408\u9002\u7684\u952e\u6563\u5217\u51fd\u6570\uff0c\u4e3a\u6bcf\u4e2a\u5206\u533a\u5206\u914d\u4e00\u4e2a\u6563\u5217\u8303\u56f4\uff08\u800c\u4e0d\u662f\u952e\u7684\u8303\u56f4\uff09</p> <ul> <li>\u6bcf\u4e2a\u901a\u8fc7\u54c8\u5e0c\u6563\u5217\u843d\u5728\u5206\u533a\u8303\u56f4\u5185\u7684\u952e\u5c06\u88ab\u5b58\u50a8\u5728\u8be5\u5206\u533a\u4e2d</li> <li>\u5206\u533a\u8fb9\u754c\u53ef\u4ee5\u662f\u5747\u5300\u95f4\u9694\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u4f2a\u968f\u673a\u9009\u62e9\u7684\uff08\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8be5\u6280\u672f\u6709\u65f6\u4e5f\u88ab\u79f0\u4e3a \u4e00\u81f4\u6027\u54c8\u5e0c\\(^{[2]}\\)\uff0c\u5373 consistent hashing\uff09\u3002</li> </ul> <p>\u952e\u6563\u5217\u5931\u53bb\u9ad8\u6548\u6267\u884c\u8303\u56f4\u67e5\u8be2\u7684\u80fd\u529b\uff1a</p> <ul> <li>MongoDB \u4e2d\uff0c\u5982\u679c\u4f60\u4f7f\u7528\u4e86\u57fa\u4e8e\u6563\u5217\u7684\u5206\u533a\u6a21\u5f0f\uff0c\u5219\u4efb\u4f55\u8303\u56f4\u67e5\u8be2\u90fd\u5fc5\u987b\u53d1\u9001\u5230\u6240\u6709\u5206\u533a\\(^{[3]}\\)</li> </ul> <p>\u7ec4\u5408\u7d22\u5f15\u65b9\u6cd5\u4e3a\u4e00\u5bf9\u591a\u5173\u7cfb\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4f18\u96c5\u7684\u6570\u636e\u6a21\u578b</p> <ul> <li>Cassandra \\(^{[4]}\\)\u4e2d\u7684\u8868\u53ef\u4ee5\u4f7f\u7528\u7531\u591a\u4e2a\u5217\u7ec4\u6210\u7684\u590d\u5408\u4e3b\u952e\uff0c\u53ea\u6709\u7b2c\u4e00\u5217\u4f1a\u4f5c\u4e3a\u6563\u5217\u7684\u4f9d\u636e\uff0c\u7b2c\u4e00\u5217\u503c\u56fa\u5b9a\u65f6\uff0c\u53ef\u4ee5\u6267\u884c\u8303\u56f4\u626b\u63cf\uff1b</li> <li>\u66f4\u65b0\u7684\u4e3b\u952e\u88ab\u9009\u62e9\u4e3a <code>(user_id, update_timestamp)</code>\uff0c\u90a3\u4e48\u53ef\u4ee5\u6709\u6548\u5730\u68c0\u7d22\u7279\u5b9a\u7528\u6237\u5728\u67d0\u4e2a\u65f6\u95f4\u95f4\u9694\u5185\u6309\u65f6\u95f4\u6233\u6392\u5e8f\u7684\u6240\u6709\u66f4\u65b0</li> </ul>"},{"location":"books/data_intensive_system_book/6_partitions.html#_7","title":"\u4e00\u81f4\u6027\u54c8\u5e0c","text":"<p>\u4e00\u81f4\u6027\u54c8\u5e0c\u7531 Karger \u7b49\u4eba\u5b9a\u4e49\\(^{[2]}\\)\u7528\u4e8e\u8de8\u4e92\u8054\u7f51\u7ea7\u522b\u7684\u7f13\u5b58\u7cfb\u7edf\uff0c\u4f7f\u7528\u968f\u673a\u9009\u62e9\u7684 \u5206\u533a\u8fb9\u754c\uff08partition boundaries\uff09 \u6765\u907f\u514d\u4e2d\u592e\u63a7\u5236\u6216\u5206\u5e03\u5f0f\u5171\u8bc6\u3002</p> <ul> <li>\u8fd9\u91cc\u7684\u4e00\u81f4\u6027\u4e0e\u590d\u5236\u4e00\u81f4\u6027\u6216\u8005ACID\u4e00\u81f4\u6027\u65e0\u5173\uff0c\u53ea\u662f\u63cf\u8ff0\u4e86\u4e00\u79cd\u518d\u5e73\u8861\uff08rebalancing\uff09\u7684\u7279\u5b9a\u65b9\u6cd5\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/6_partitions.html#_8","title":"\u8d1f\u8f7d\u504f\u659c\u4e0e\u70ed\u70b9\u6d88\u9664","text":"<p>\u5373\u4f7fHash\u5206\u533a\uff0c\u6781\u7aef\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u7684\u8bfb\u5199\u64cd\u4f5c\u90fd\u662f\u9488\u5bf9\u540c\u4e00\u4e2a\u952e\uff0c\u6240\u6709\u7684\u8bf7\u6c42\u90fd\u4f1a\u88ab\u8def\u7531\u5230\u540c\u4e00\u4e2a\u5206\u533a\u3002</p> <ul> <li>\u6570\u767e\u4e07\u8ffd\u968f\u8005\u7684\u540d\u4eba\u7528\u6237\u5728\u505a\u67d0\u4e8b\u65f6\u53ef\u80fd\u4f1a\u5f15\u53d1\u4e00\u573a\u98ce\u66b4\\(^{[5]}\\)</li> </ul> <p>\u89e3\u51b3\u65b9\u6848\uff1a\u4e3b\u952e\u7684\u5f00\u59cb\u6216\u7ed3\u5c3e\u6dfb\u52a0\u4e00\u4e2a\u968f\u673a\u6570</p> <ul> <li>\u53ea\u8981\u4e00\u4e2a\u4e24\u4f4d\u6570\u7684\u5341\u8fdb\u5236\u968f\u673a\u6570\u5c31\u53ef\u4ee5\u5c06\u4e3b\u952e\u5206\u6563\u4e3a 100 \u79cd\u4e0d\u540c\u7684\u4e3b\u952e\uff0c\u4ece\u800c\u5b58\u50a8\u5728\u4e0d\u540c\u7684\u5206\u533a\u4e2d\uff1b</li> <li>\u8bfb\u53d6\u8981\u4ece\u6240\u6709 100 \u4e2a\u4e3b\u952e\u5206\u5e03\u4e2d\u8bfb\u53d6\u6570\u636e\u5e76\u5c06\u5176\u5408\u5e76\uff1b</li> <li>\u989d\u5916\u7684\u8bb0\u5f55\uff1a\u53ea\u9700\u8981\u5bf9\u5c11\u91cf\u70ed\u70b9\u9644\u52a0\u968f\u673a\u6570\uff0c\u8ddf\u8e2a\u54ea\u4e9b\u952e\u9700\u8981\u88ab\u5206\u5272\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/6_partitions.html#_9","title":"\u5206\u533a\u4e0e\u6b21\u7ea7\u7d22\u5f15","text":"<p>\u6b21\u7ea7\u7d22\u5f15\u901a\u5e38\u5e76\u4e0d\u80fd\u552f\u4e00\u5730\u6807\u8bc6\u8bb0\u5f55\uff0c\u800c\u662f\u4e00\u79cd\u641c\u7d22\u8bb0\u5f55\u4e2d\u51fa\u73b0\u7279\u5b9a\u503c\u7684\u65b9\u5f0f\uff1a\u5982\u67e5\u627e\u5305\u542b\u8bcd\u8bed <code>hogwash</code> \u7684\u6240\u6709\u6587\u7ae0\u3001\u67e5\u627e\u6240\u6709\u989c\u8272\u4e3a\u7ea2\u8272\u7684\u8f66\u8f86\u7b49\u3002</p> <p>\u6b21\u7ea7\u7d22\u5f15\u662f\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u57fa\u7840\uff0c\u5e76\u4e14\u5728\u6587\u6863\u6570\u636e\u5e93\u4e2d\u4e5f\u5f88\u666e\u904d</p> <ul> <li>\u8bb8\u591a\u952e\u503c\u5b58\u50a8\uff08\u5982 HBase\uff09\u51cf\u5c11\u5b9e\u73b0\u7684\u590d\u6742\u5ea6\u800c\u653e\u5f03\u4e86\u6b21\u7ea7\u7d22\u5f15\uff1b</li> <li>\u4f46\u4e00\u4e9b\uff08\u5982Riak\uff09\u5df2\u7ecf\u5f00\u59cb\u6dfb\u52a0\u5b83\u4eec\uff0c\u6b21\u7ea7\u7d22\u5f15\u4e5f\u662f Solr \u548c Elasticsearch \u7b49\u641c\u7d22\u670d\u52a1\u5668\u7684\u57fa\u77f3\uff1b</li> </ul> <p>\u6b21\u7ea7\u7d22\u5f15\u7684\u95ee\u9898\u662f\u5b83\u4eec\u4e0d\u80fd\u6574\u9f50\u5730\u6620\u5c04\u5230\u5206\u533a\u3002</p> <p>\u6709\u4e24\u79cd\u7528\u6b21\u7ea7\u7d22\u5f15\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u5206\u533a\u7684\u65b9\u6cd5\uff1a\u57fa\u4e8e\u6587\u6863\u7684\u5206\u533a\uff08document-based\uff09 \u548c \u57fa\u4e8e\u5173\u952e\u8bcd\uff08term-based\uff09\u7684\u5206\u533a\u3002</p>"},{"location":"books/data_intensive_system_book/6_partitions.html#_10","title":"\u57fa\u4e8e\u6587\u6863\u7684\u6b21\u7ea7\u7d22\u5f15\u8fdb\u884c\u5206\u533a","text":"<p>\u6587\u6863\u5206\u533a\u7d22\u5f15 \u4e5f\u88ab\u79f0\u4e3a \u672c\u5730\u7d22\u5f15\uff08\u800c\u4e0d\u662f\u5c06\u5728\u4e0b\u4e00\u8282\u4e2d\u63cf\u8ff0\u7684 \u5168\u5c40\u7d22\u5f15\uff09\uff1a</p> <ul> <li>\u6bcf\u4e2a\u5206\u533a\u662f\u5b8c\u5168\u72ec\u7acb\uff1a\u6bcf\u4e2a\u5206\u533a\u7ef4\u62a4\u81ea\u5df1\u7684\u6b21\u7ea7\u7d22\u5f15\uff0c\u4ec5\u8986\u76d6\u8be5\u5206\u533a\u4e2d\u7684\u6587\u6863\uff1b</li> <li>\u67e5\u8be2\u53d1\u9001\u5230\u6240\u6709\u5206\u533a\uff0c\u5e76\u5408\u5e76\u6240\u6709\u8fd4\u56de\u7684\u7ed3\u679c\u3002</li> </ul> <p></p> <p>\u8fd9\u79cd\u67e5\u8be2\u5206\u533a\u6570\u636e\u5e93\u7684\u65b9\u6cd5\u6709\u65f6\u88ab\u79f0\u4e3a \u5206\u6563 / \u805a\u96c6\uff08scatter/gather\uff09\uff1a</p> <ul> <li>\u4f7f\u6b21\u7ea7\u7d22\u5f15\u4e0a\u7684\u8bfb\u53d6\u67e5\u8be2\u76f8\u5f53\u6602\u8d35\uff1a\u5373\u4f7f\u5e76\u884c\u67e5\u8be2\u5206\u533a\uff0c\u5206\u6563 / \u805a\u96c6\u4e5f\u5bb9\u6613\u5bfc\u81f4\u5c3e\u90e8\u5ef6\u8fdf\u653e\u5927</li> <li>MongoDB\uff0cRiak \uff0cCassandra\uff0cElasticsearch \u90fd\u4f7f\u7528\u6587\u6863\u5206\u533a\u6b21\u7ea7\u7d22\u5f15\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/6_partitions.html#term","title":"\u57fa\u4e8e\u5173\u952e\u8bcd(Term)\u7684\u6b21\u7ea7\u7d22\u5f15\u8fdb\u884c\u5206\u533a","text":"<p>\u6784\u5efa\u4e00\u4e2a\u8986\u76d6\u6240\u6709\u5206\u533a\u6570\u636e\u7684 \u5168\u5c40\u7d22\u5f15\uff0c\u800c\u4e0d\u662f\u7ed9\u6bcf\u4e2a\u5206\u533a\u521b\u5efa\u81ea\u5df1\u7684\u6b21\u7ea7\u7d22\u5f15\uff08\u672c\u5730\u7d22\u5f15\uff09\u3002</p> <p>\u5168\u5c40\u7d22\u5f15\u4e5f\u5fc5\u987b\u8fdb\u884c\u5206\u533a\uff0c\u4f46\u53ef\u4ee5\u91c7\u7528\u4e0e\u4e3b\u952e\u4e0d\u540c\u7684\u5206\u533a\u65b9\u5f0f\uff0c\u5173\u952e\u8bcd\u5206\u533a\uff08term-partitioned\uff09</p> <ul> <li>\u5bfb\u627e\u7684\u5173\u952e\u8bcd\u51b3\u5b9a\u4e86\u7d22\u5f15\u7684\u5206\u533a\u65b9\u5f0f</li> <li>\u53ef\u4ee5\u901a\u8fc7 \u5173\u952e\u8bcd \u672c\u8eab\u6216\u8005\u5b83\u7684\u6563\u5217\u8fdb\u884c\u7d22\u5f15\u5206\u533a</li> </ul> <p>\u4e0b\u56fe\u662f\u793a\u4f8b\uff1a\u6240\u6709\u5206\u533a\u7684\u7ea2\u8272\u6c7d\u8f66\u5728\u7ea2\u8272\u7d22\u5f15\u4e2d\uff0c\u5e76\u4e14\u7d22\u5f15\u662f\u5206\u533a\u7684\uff0c\u9996\u5b57\u6bcd\u4ece <code>a</code> \u5230 <code>r</code> \u7684\u989c\u8272\u5728\u5206\u533a 0 \u4e2d\uff0c<code>s</code> \u5230 <code>z</code> \u7684\u5728\u5206\u533a 1\u3002\u6c7d\u8f66\u5236\u9020\u5546\u7684\u7d22\u5f15\u4e5f\u4e0e\u4e4b\u7c7b\u4f3c\uff08\u5206\u533a\u8fb9\u754c\u5728 <code>f</code> \u548c <code>h</code> \u4e4b\u95f4\uff09</p> <p></p> <p>\u5168\u5c40\u7d22\u5f15\u7684\u4f18\u7f3a\u70b9\uff1a</p> <ul> <li>\u8bfb\u53d6\u66f4\u6709\u6548\u7387\uff1a\u4e0d\u9700\u8981 \u5206\u6563 / \u6536\u96c6 \u6240\u6709\u5206\u533a\uff0c\u5ba2\u6237\u7aef\u53ea\u9700\u8981\u5411\u5305\u542b\u5173\u952e\u8bcd\u7684\u5206\u533a\u53d1\u51fa\u8bf7\u6c42\u3002</li> <li>\u5199\u5165\u901f\u5ea6\u8f83\u6162\u4e14\u8f83\u4e3a\u590d\u6742\uff1a\u5199\u5165\u5355\u4e2a\u6587\u6863\u73b0\u5728\u53ef\u80fd\u4f1a\u5f71\u54cd\u7d22\u5f15\u7684\u591a\u4e2a\u5206\u533a</li> </ul> <p>\u7406\u60f3\u60c5\u51b5\u4e0b\uff0c\u7d22\u5f15\u603b\u662f\u6700\u65b0\u7684\uff0c\u5199\u5165\u6570\u636e\u5e93\u7684\u6bcf\u4e2a\u6587\u6863\u90fd\u4f1a\u7acb\u5373\u53cd\u6620\u5728\u7d22\u5f15\u4e2d\u3002</p> <ul> <li>\u5173\u952e\u8bcd\u5206\u533a\u7d22\u5f15\u4e2d\uff1a\u8de8\u5206\u533a\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u6570\u636e\u5e93\u90fd\u652f\u6301\uff08\u8bf7\u53c2\u9605 \u7b2c\u4e03\u7ae0 \u548c \u7b2c\u4e5d\u7ae0\uff09</li> <li>\u5728\u5b9e\u8df5\u4e2d\uff0c\u5bf9\u5168\u5c40\u6b21\u7ea7\u7d22\u5f15\u7684\u66f4\u65b0\u901a\u5e38\u662f \u5f02\u6b65 \u7684\uff08\u5199\u5165\u4e4b\u540e\u8bfb\u53d6\uff0c\u53ef\u80fd\u8bfb\u53d6\u4e0d\u5230\uff09\uff1b</li> </ul>"},{"location":"books/data_intensive_system_book/6_partitions.html#_11","title":"\u5206\u533a\u518d\u5e73\u8861","text":"<p>\u518d\u5e73\u8861\uff1a\u5c06\u8d1f\u8f7d\u4ece\u96c6\u7fa4\u4e2d\u7684\u4e00\u4e2a\u8282\u70b9\u5411\u53e6\u4e00\u4e2a\u8282\u70b9\u79fb\u52a8\u7684\u8fc7\u7a0b</p> <ul> <li>\u67e5\u8be2\u541e\u5410\u91cf\u589e\u52a0\uff1a\u66f4\u591a\u7684 CPU</li> <li>\u6570\u636e\u96c6\u5927\u5c0f\u589e\u52a0\uff1a\u66f4\u591a\u7684\u78c1\u76d8\u548c\u5185\u5b58</li> <li>\u673a\u5668\u51fa\u73b0\u6545\u969c\uff1a\u5176\u5b83\u673a\u5668\u63a5\u7ba1</li> </ul> <p>\u65e0\u8bba\u4f7f\u7528\u54ea\u79cd\u5206\u533a\u65b9\u6848\uff0c\u518d\u5e73\u8861\u901a\u5e38\u90fd\u8981\u6ee1\u8db3\u4e00\u4e9b\u6700\u4f4e\u8981\u6c42\uff1a</p> <ul> <li>\u518d\u5e73\u8861\u4e4b\u540e\uff0c\u8d1f\u8f7d\uff08\u6570\u636e\u5b58\u50a8\uff0c\u8bfb\u53d6\u548c\u5199\u5165\u8bf7\u6c42\uff09\u5e94\u8be5\u5728\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u4e4b\u95f4\u516c\u5e73\u5730\u5171\u4eab\u3002</li> <li>\u518d\u5e73\u8861\u53d1\u751f\u65f6\uff0c\u6570\u636e\u5e93\u5e94\u8be5\u7ee7\u7eed\u63a5\u53d7\u8bfb\u53d6\u548c\u5199\u5165\u3002</li> <li>\u8282\u70b9\u4e4b\u95f4\u53ea\u79fb\u52a8\u5fc5\u987b\u7684\u6570\u636e\uff0c\u4ee5\u4fbf\u5feb\u901f\u518d\u5e73\u8861\uff0c\u5e76\u51cf\u5c11\u7f51\u7edc\u548c\u78c1\u76d8 I/O \u8d1f\u8f7d\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/6_partitions.html#_12","title":"\u518d\u5e73\u8861\u7b56\u7565","text":"<p>\u6709\u51e0\u79cd\u4e0d\u540c\u7684\u5206\u533a\u5206\u914d\u65b9\u6cd5\\(^{[6]}\\)</p> <p>\u6700\u597d\u5c06\u53ef\u80fd\u7684\u6563\u5217\u5206\u6210\u4e0d\u540c\u7684\u8303\u56f4\uff0c\u5e76\u5c06\u6bcf\u4e2a\u8303\u56f4\u5206\u914d\u7ed9\u4e00\u4e2a\u5206\u533a\uff08\u4f8b\u5982\uff0c\u5982\u679c \\(0\\le hash(key) \\le b_0\\)\uff0c\u5219\u5c06\u952e\u5206\u914d\u7ed9\u5206\u533a 0\uff0c\u5982\u679c \\(b_0\\le hash(key) \\le b_1\\)\uff0c\u5219\u5206\u914d\u7ed9\u5206\u533a 1\uff09\u3002</p>"},{"location":"books/data_intensive_system_book/6_partitions.html#hash-mod-n","title":"\u53cd\u9762\u6559\u6750\uff1ahash mod N","text":"<p>\u6a21 N\uff08\\(mod N\\)\uff09\u65b9\u6cd5\u7684\u95ee\u9898\u662f\uff0c\u5982\u679c\u8282\u70b9\u6570\u91cf N \u53d1\u751f\u53d8\u5316\uff0c\u5927\u591a\u6570\u952e\u5c06\u9700\u8981\u4ece\u4e00\u4e2a\u8282\u70b9\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u8282\u70b9\u3002</p>"},{"location":"books/data_intensive_system_book/6_partitions.html#_13","title":"\u56fa\u5b9a\u6570\u91cf\u7684\u5206\u533a","text":"<p>\u8fd9\u4e2a\u8ddf\u6309\u8282\u70b9\u6bd4\u4f8b\u5206\u533a\uff0c\u8c01\u6700\u7b26\u5408\u4e00\u81f4\u6027 Hash \uff1f</p> <p>\u521b\u5efa\u6bd4\u8282\u70b9\u66f4\u591a\u7684\u5206\u533a\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u8282\u70b9\u5206\u914d\u591a\u4e2a\u5206\u533a\uff1a\u5982\u572810\u4e2a\u8282\u70b9\u7684\u96c6\u7fa4\u4e0a\uff0c\u5206\u62101000\u4e2a\u5206\u533a\uff0c\u6bcf\u4e2a\u8282\u70b9\u5927\u7ea6100\u4e2a\u5206\u533a</p> <ul> <li>\u5982\u679c\u4e00\u4e2a\u8282\u70b9\u88ab\u6dfb\u52a0\u5230\u96c6\u7fa4\u4e2d\uff0c\u65b0\u8282\u70b9\u53ef\u4ee5\u4ece\u5f53\u524d\u6bcf\u4e2a\u8282\u70b9\u4e2d \u7a83\u53d6 \u4e00\u4e9b\u5206\u533a\uff0c\u76f4\u5230\u5206\u533a\u518d\u6b21\u516c\u5e73\u5206\u914d\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1b</li> <li>\u4ece\u96c6\u7fa4\u4e2d\u5220\u9664\u4e00\u4e2a\u8282\u70b9\uff0c\u5219\u4f1a\u53d1\u751f\u76f8\u53cd\u7684\u60c5\u51b5\uff0c\u5c06\u5220\u9664\u8282\u70b9\u7684\u5206\u533a\u91cd\u65b0\u5206\u914d\u5230\u5176\u5b83\u8282\u70b9\uff1b</li> </ul> <p></p> <p>\u5206\u533a\u7684\u6570\u91cf\u4e0d\u4f1a\u6539\u53d8\uff0c\u952e\u6240\u6307\u5b9a\u7684\u5206\u533a\u4e5f\u4e0d\u4f1a\u6539\u53d8\u3002\u552f\u4e00\u6539\u53d8\u7684\u662f\u5206\u533a\u6240\u5728\u7684\u8282\u70b9\u3002</p> <ul> <li>\u53d8\u66f4\u5e76\u4e0d\u662f\u5373\u65f6\uff1a\u5927\u91cf\u4f20\u8f93\u6570\u636e\u8017\u65f6\uff0c\u5728\u4f20\u8f93\u8fc7\u7a0b\u4e2d\uff0c\u539f\u6709\u5206\u533a\u4ecd\u7136\u4f1a\u63a5\u53d7\u8bfb\u5199\u64cd\u4f5c\uff1b</li> <li>\u89e3\u51b3\u96c6\u7fa4\u4e2d\u7684\u786c\u4ef6\u4e0d\u5339\u914d\u95ee\u9898\uff1a\u901a\u8fc7\u4e3a\u66f4\u5f3a\u5927\u7684\u8282\u70b9\u5206\u914d\u66f4\u591a\u7684\u5206\u533a\uff0c\u53ef\u4ee5\u5f3a\u5236\u8fd9\u4e9b\u8282\u70b9\u627f\u8f7d\u66f4\u591a\u7684\u8d1f\u8f7d\u3002</li> </ul> <p>\u5206\u533a\u7684\u6570\u91cf\u901a\u5e38\u5728\u6570\u636e\u5e93\u7b2c\u4e00\u6b21\u5efa\u7acb\u65f6\u786e\u5b9a\uff0c\u4e4b\u540e\u4e0d\u4f1a\u6539\u53d8\uff1a</p> <ul> <li>\u539f\u5219\u4e0a\u53ef\u4ee5\u5206\u5272\u548c\u5408\u5e76\u5206\u533a\uff0c\u4f46\u56fa\u5b9a\u6570\u91cf\u7684\u5206\u533a\u5728\u64cd\u4f5c\u4e0a\u66f4\u7b80\u5355\uff1b</li> <li>\u9009\u62e9\u8db3\u591f\u591a\u7684\u5206\u533a\uff08\u5373\u6700\u5927\u8282\u70b9\u6570\u91cf\uff09\u4ee5\u9002\u5e94\u672a\u6765\u7684\u589e\u957f\uff0c\u592a\u5927\u7684\u6570\u5b57\u5e26\u6765\u5206\u533a\u7684\u7ba1\u7406\u5f00\u9500\uff1b</li> </ul>"},{"location":"books/data_intensive_system_book/6_partitions.html#_14","title":"\u52a8\u6001\u5206\u533a","text":"<p>\u6309\u952e\u7684\u8303\u56f4\u8fdb\u884c\u5206\u533a\u7684\u6570\u636e\u5e93\uff08\u5982 HBase \u548c RethinkDB\uff09\u4f1a\u52a8\u6001\u521b\u5efa\u5206\u533a</p> <ul> <li>\u56fa\u5b9a\u8fb9\u754c\u7684\u56fa\u5b9a\u6570\u91cf\u7684\u5206\u533a\u975e\u5e38\u4e0d\u4fbf\uff1a\u5982\u679c\u8fb9\u754c\u8bbe\u7f6e\u9519\u8bef\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6240\u6709\u6570\u636e\u90fd\u5728\u4e00\u4e2a\u5206\u533a\u4e2d\uff0c\u800c\u5176\u4ed6\u5206\u533a\u5219\u4e3a\u7a7a\uff1b</li> <li>\u5f53\u5206\u533a\u589e\u957f\u5230\u8d85\u8fc7\u914d\u7f6e\u7684\u5927\u5c0f\u65f6\uff08\u5728 HBase \u4e0a\uff0c\u9ed8\u8ba4\u503c\u662f 10GB\uff09\uff0c\u4f1a\u88ab\u5206\u6210\u4e24\u4e2a\u5206\u533a\uff0c\u6bcf\u4e2a\u5206\u533a\u7ea6\u5360\u4e00\u534a\u7684\u6570\u636e\\(^{[7]}\\)\uff1b</li> <li>\u5982\u679c\u5927\u91cf\u6570\u636e\u88ab\u5220\u9664\u5e76\u4e14\u5206\u533a\u7f29\u5c0f\u5230\u67d0\u4e2a\u9608\u503c\u4ee5\u4e0b\uff0c\u5219\u53ef\u4ee5\u5c06\u5176\u4e0e\u76f8\u90bb\u5206\u533a\u5408\u5e76\uff1b</li> </ul> <p>\u6bcf\u4e2a\u5206\u533a\u5206\u914d\u7ed9\u4e00\u4e2a\u8282\u70b9\uff0c\u6bcf\u4e2a\u8282\u70b9\u53ef\u4ee5\u5904\u7406\u591a\u4e2a\u5206\u533a\uff1a</p> <ul> <li>\u5927\u578b\u5206\u533a\u62c6\u5206\u540e\uff0c\u53ef\u4ee5\u5c06\u5176\u4e2d\u7684\u4e00\u534a\u8f6c\u79fb\u5230\u53e6\u4e00\u4e2a\u8282\u70b9\uff0c\u4ee5\u5e73\u8861\u8d1f\u8f7d\uff1b</li> </ul> <p>\u52a8\u6001\u5206\u533a\u7684\u4e00\u4e2a\u4f18\u70b9\u662f\u5206\u533a\u6570\u91cf\u9002\u5e94\u603b\u6570\u636e\u91cf\uff1a</p> <ul> <li>\u5c11\u91cf\u7684\u6570\u636e\uff0c\u5c11\u91cf\u7684\u5206\u533a\uff0c\u7ba1\u7406\u5f00\u9500\u5f88\u5c0f\uff1b</li> <li>\u5927\u91cf\u7684\u6570\u636e\uff0c\u6bcf\u4e2a\u5206\u533a\u7684\u5927\u5c0f\u88ab\u9650\u5236\u5728\u4e00\u4e2a\u53ef\u914d\u7f6e\u7684\u6700\u5927\u503c\uff1b</li> </ul> <p>\u9884\u5206\u5272\uff08 pre-splitting\uff09\uff1a\u5728\u4e00\u4e2a\u7a7a\u7684\u6570\u636e\u5e93\u4e0a\u914d\u7f6e\u4e00\u7ec4\u521d\u59cb\u5206\u533a\uff0c\u89e3\u51b3\u521d\u59cb\u5206\u533a\u62c6\u5206\u65f6\u7684\u5355\u70b9\u74f6\u9888</p> <ul> <li>\u7a7a\u7684\u6570\u636e\u5e93\u4ece\u4e00\u4e2a\u5206\u533a\u5f00\u59cb\uff0c\u76f4\u5230\u8fbe\u5230\u7b2c\u4e00\u4e2a\u5206\u533a\u7684\u5206\u5272\u70b9\uff0c\u6240\u6709\u5199\u5165\u64cd\u4f5c\u90fd\u5fc5\u987b\u7531\u5355\u4e2a\u8282\u70b9\u5904\u7406\uff0c\u800c\u5176\u4ed6\u8282\u70b9\u5219\u5904\u4e8e\u7a7a\u95f2\u72b6\u6001\uff1b</li> </ul> <p>\u52a8\u6001\u5206\u533a\u4e0d\u4ec5\u9002\u7528\u4e8e\u6570\u636e\u7684\u8303\u56f4\u5206\u533a\uff0c\u800c\u4e14\u4e5f\u9002\u7528\u4e8e\u6563\u5217\u5206\u533a\u3002</p>"},{"location":"books/data_intensive_system_book/6_partitions.html#_15","title":"\u6309\u8282\u70b9\u6bd4\u4f8b\u5206\u533a","text":"<p>\u56fa\u5b9a\u5206\u533a\u548c\u52a8\u6001\u5206\u533a\u7684\u65b9\u6848\u4e2d\uff0c\u5206\u533a\u7684\u6570\u91cf\u8ddf\u8282\u70b9\u7684\u6570\u91cf\u65e0\u5173\uff1a</p> <ul> <li>\u52a8\u6001\u5206\u533a\uff0c\u5206\u533a\u7684\u6570\u91cf\u4e0e\u6570\u636e\u96c6\u7684\u5927\u5c0f\u6210\u6b63\u6bd4\uff1b</li> <li>\u56fa\u5b9a\u6570\u91cf\u7684\u5206\u533a\uff0c\u6bcf\u4e2a\u5206\u533a\u7684\u5927\u5c0f\u4e0e\u6570\u636e\u96c6\u7684\u5927\u5c0f\u6210\u6b63\u6bd4\uff1b</li> </ul> <p>\u4f7f\u5206\u533a\u6570\u4e0e\u8282\u70b9\u6570\u6210\u6b63\u6bd4 \uff1a\u6bcf\u4e2a\u8282\u70b9\u5177\u6709\u56fa\u5b9a\u6570\u91cf\u7684\u5206\u533a\\(^{[8]}\\)</p> <ul> <li>\u6bcf\u4e2a\u5206\u533a\u7684\u5927\u5c0f\u4e0e\u6570\u636e\u96c6\u5927\u5c0f\u6210\u6bd4\u4f8b\u5730\u589e\u957f\uff0c\u800c\u8282\u70b9\u6570\u91cf\u4fdd\u6301\u4e0d\u53d8\uff1b</li> <li>\u5f53\u589e\u52a0\u8282\u70b9\u6570\u65f6\uff0c\u968f\u673a\u9009\u62e9\u56fa\u5b9a\u6570\u91cf\u7684\u73b0\u6709\u5206\u533a\u8fdb\u884c\u62c6\u5206\uff0c\u5360\u6709\u4e00\u534a\uff0c\u7559\u4e00\u534a\u5728\u539f\u5730\uff1b</li> <li>\u968f\u673a\u5316\u53ef\u80fd\u4f1a\u4ea7\u751f\u4e0d\u516c\u5e73\u7684\u5206\u5272\uff0c\u4f46\u5728\u66f4\u5927\u6570\u91cf\u7684\u5206\u533a\u4e0a\u65f6\uff0c\u65b0\u8282\u70b9\u6700\u7ec8\u4ece\u73b0\u6709\u8282\u70b9\u83b7\u5f97\u516c\u5e73\u7684\u8d1f\u8f7d\u4efd\u989d</li> <li>Cassandra 3.0 \u5f15\u5165\u4e86\u53e6\u4e00\u79cd\u518d\u5e73\u8861\u7684\u7b97\u6cd5\u6765\u907f\u514d\u4e0d\u516c\u5e73\u7684\u5206\u5272\\(^{[9]}\\)\uff1b</li> </ul> <p>\u968f\u673a\u9009\u62e9\u5206\u533a\u8fb9\u754c\u8981\u6c42\u4f7f\u7528\u57fa\u4e8e\u6563\u5217\u7684\u5206\u533a\uff08\u53ef\u4ee5\u4ece\u6563\u5217\u51fd\u6570\u4ea7\u751f\u7684\u6570\u5b57\u8303\u56f4\u4e2d\u6311\u9009\u8fb9\u754c\uff09\uff0c\u7b26\u5408\u4e00\u81f4\u6027\u54c8\u5e0c\u7684\u539f\u59cb\u5b9a\u4e49\\(^{[2]}\\)\uff08\u8bf7\u53c2\u9605 \u201c\u4e00\u81f4\u6027\u54c8\u5e0c\u201d\uff09\u3002</p>"},{"location":"books/data_intensive_system_book/6_partitions.html#_16","title":"\u8fd0\u7ef4\uff1a\u624b\u52a8\u8fd8\u662f\u81ea\u52a8\u518d\u5e73\u8861","text":"<p>\u518d\u5e73\u8861\u662f\u4e00\u4e2a\u6602\u8d35\u7684\u64cd\u4f5c\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u91cd\u65b0\u8def\u7531\u8bf7\u6c42\u5e76\u5c06\u5927\u91cf\u6570\u636e\u4ece\u4e00\u4e2a\u8282\u70b9\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u8282\u70b9\uff1a</p> <ul> <li>\u5982\u679c\u6ca1\u6709\u505a\u597d\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u53ef\u80fd\u4f1a\u4f7f\u7f51\u7edc\u6216\u8282\u70b9\u8d1f\u8f7d\u8fc7\u91cd\uff0c\u964d\u4f4e\u5176\u4ed6\u8bf7\u6c42\u7684\u6027\u80fd\u3002</li> </ul> <p>\u5168\u81ea\u52a8\u518d\u5e73\u8861\u4e0e\u81ea\u52a8\u6545\u969c\u68c0\u6d4b\u76f8\u7ed3\u5408\u53ef\u80fd\u5341\u5206\u5371\u9669\uff0c\u5bfc\u81f4\u7ea7\u8054\u5931\u8d25\uff1a</p> <ul> <li>\u5047\u8bbe\u4e00\u4e2a\u8282\u70b9\u8fc7\u8f7d\uff0c\u5e76\u4e14\u5bf9\u8bf7\u6c42\u7684\u54cd\u5e94\u6682\u65f6\u5f88\u6162\uff1b</li> <li>\u5176\u4ed6\u8282\u70b9\u5f97\u51fa\u7ed3\u8bba\uff1a\u8fc7\u8f7d\u7684\u8282\u70b9\u5df2\u7ecf\u6b7b\u4ea1\uff0c\u5e76\u81ea\u52a8\u91cd\u65b0\u5e73\u8861\u96c6\u7fa4\uff0c\u4f7f\u8d1f\u8f7d\u79bb\u5f00\u5b83\uff1b</li> <li>\u5bf9\u5df2\u7ecf\u8d85\u8d1f\u8377\u7684\u8282\u70b9\uff0c\u5176\u4ed6\u8282\u70b9\u548c\u7f51\u7edc\u9020\u6210\u989d\u5916\u7684\u8d1f\u8f7d\uff0c\u4f7f\u60c5\u51b5\u53d8\u5f97\u66f4\u7cdf\u3002</li> </ul> <p>\u518d\u5e73\u8861\u7684\u8fc7\u7a0b\u4e2d\u6709\u4eba\u53c2\u4e0e\u662f\u4e00\u4ef6\u597d\u4e8b\u3002\u8fd9\u6bd4\u5168\u81ea\u52a8\u7684\u8fc7\u7a0b\u6162\uff0c\u4f46\u53ef\u4ee5\u5e2e\u52a9\u9632\u6b62\u8fd0\u7ef4\u610f\u5916\u3002</p> <ul> <li>Couchbase\u3001Riak \u548c Voldemort \u4f1a\u81ea\u52a8\u751f\u6210\u5efa\u8bae\u7684\u5206\u533a\u5206\u914d\uff0c\u4f46\u9700\u8981\u7ba1\u7406\u5458\u63d0\u4ea4\u624d\u80fd\u751f\u6548\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/6_partitions.html#_17","title":"\u8bf7\u6c42\u8def\u7531","text":"<p>\u5f53\u5ba2\u6237\u60f3\u8981\u53d1\u51fa\u8bf7\u6c42\u65f6\uff0c\u5982\u4f55\u77e5\u9053\u8981\u8fde\u63a5\u54ea\u4e2a\u8282\u70b9\uff1f\u968f\u7740\u5206\u533a\u7684\u91cd\u65b0\u5e73\u8861\uff0c\u5206\u533a\u5bf9\u8282\u70b9\u7684\u5206\u914d\u4e5f\u53d1\u751f\u53d8\u5316\u3002</p> <p>\u670d\u52a1\u53d1\u73b0\uff08service discovery\uff09\uff1a\u5f00\u6e90\u53d1\u5e03\u7684\u5bf9\u6bd4\\(^{[10]}\\)\uff0c\u95ee\u9898\u7684\u51e0\u79cd\u89e3\u51b3\u65b9\u6848\uff1a</p> <ul> <li>\u5141\u8bb8\u5ba2\u6237\u8054\u7cfb\u4efb\u4f55\u8282\u70b9\uff08\u5982 Roubd-Robin Load Balancer\uff09\uff1a\u8282\u70b9\u5177\u6709\u8bf7\u6c42\u7684\u5206\u533a\uff0c\u5219\u8bf7\u6c42\uff0c\u5426\u5219\u8f6c\u53d1\u5230\u5bf9\u5e94\u7684\u8282\u70b9\uff1b</li> <li>\u8def\u7531\u5c42\uff1a\u4ec5\u8d1f\u8d23\u5206\u533a\u7684\u8d1f\u8f7d\u5747\u8861\uff0c\u5c06\u5ba2\u6237\u7aef\u8bf7\u6c42\u8f6c\u5230\u5bf9\u5e94\u7684\u5206\u533a\uff1b</li> <li>\u5ba2\u6237\u7aef\u77e5\u9053\u5206\u533a\u548c\u8282\u70b9\u7684\u5206\u914d\uff0c\u76f4\u63a5\u8fde\u63a5\uff1b</li> </ul> <p></p> <p>\u8bb8\u591a\u5206\u5e03\u5f0f\u6570\u636e\u7cfb\u7edf\u90fd\u4f9d\u8d56\u4e8e\u4e00\u4e2a\u72ec\u7acb\u7684\u534f\u8c03\u670d\u52a1\uff08\u6240\u6709\u53c2\u4e0e\u8005\u90fd\u8fbe\u6210\u5171\u8bc6\u5173\u4e8e\u5206\u533a\u5230\u8282\u70b9\u7684\u6620\u5c04\uff09\uff0c\u5982 ZooKeeper \u6765\u8ddf\u8e2a\u96c6\u7fa4\u5143\u6570\u636e\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <ul> <li>\u6bcf\u4e2a\u8282\u70b9\u5728 ZooKeeper \u4e2d\u6ce8\u518c\u81ea\u5df1\uff0cZooKeeper \u7ef4\u62a4\u5206\u533a\u5230\u8282\u70b9\u7684\u53ef\u9760\u6620\u5c04\uff1b</li> <li>\u5176\u4ed6\u53c2\u4e0e\u8005\uff08\u5982\u8def\u7531\u5c42\u6216\u5206\u533a\u611f\u77e5\u5ba2\u6237\u7aef\uff09\u53ef\u4ee5\u5728 ZooKeeper \u4e2d\u8ba2\u9605\u6b64\u4fe1\u606f\uff1b</li> </ul> <p></p> <p>\u4f8b\u5982\uff0cLinkedIn\u7684Espresso\u4f7f\u7528Helix\\(^{[11]}\\)\u8fdb\u884c\u96c6\u7fa4\u7ba1\u7406\uff08\u4f9d\u9760ZooKeeper\uff09\uff0c\u5b9e\u73b0\u8def\u7531\u5c42\uff1bHBase\u3001SolrCloud\u548cKafka\u4e5f\u4f7f\u7528ZooKeeper\u6765\u8ddf\u8e2a\u5206\u533a\u5206\u914d\u3002</p> <p>Cassandra \u548c Riak \u91c7\u53d6\u4e0d\u540c\u7684\u65b9\u6cd5\uff1a\u4ed6\u4eec\u5728\u8282\u70b9\u4e4b\u95f4\u4f7f\u7528 \u6d41\u8a00\u534f\u8bae\uff08gossip protocol\uff09 \u6765\u4f20\u64ad\u96c6\u7fa4\u72b6\u6001\u7684\u53d8\u5316\u3002</p> <ul> <li>\u8bf7\u6c42\u53ef\u4ee5\u53d1\u9001\u5230\u4efb\u610f\u8282\u70b9\uff0c\u8be5\u8282\u70b9\u4f1a\u8f6c\u53d1\u5230\u5305\u542b\u6240\u8bf7\u6c42\u7684\u5206\u533a\u7684\u9002\u5f53\u8282\u70b9\uff1b</li> <li>\u5728\u6570\u636e\u5e93\u8282\u70b9\u4e2d\u589e\u52a0\u4e86\u66f4\u591a\u7684\u590d\u6742\u6027\uff0c\u4f46\u662f\u907f\u514d\u4e86\u5bf9\u50cf ZooKeeper \u8fd9\u6837\u7684\u5916\u90e8\u534f\u8c03\u670d\u52a1\u7684\u4f9d\u8d56\u3002</li> </ul> <p>\u5f53\u4f7f\u7528\u8def\u7531\u5c42\u6216\u5411\u968f\u673a\u8282\u70b9\u53d1\u9001\u8bf7\u6c42\u65f6\uff0c\u5ba2\u6237\u7aef\u4ecd\u7136\u9700\u8981\u627e\u5230\u8981\u8fde\u63a5\u7684 IP \u5730\u5740\uff1a</p> <ul> <li>\u8fd9\u4e9b\u5730\u5740\u5e76\u4e0d\u50cf\u5206\u533a\u7684\u8282\u70b9\u5206\u5e03\u53d8\u5316\u7684\u90a3\u4e48\u5feb\uff0c\u6240\u4ee5\u4f7f\u7528 DNS \u901a\u5e38\u5c31\u8db3\u591f\u4e86\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/6_partitions.html#_18","title":"\u6267\u884c\u5e76\u884c\u67e5\u8be2","text":"<p>\u76ee\u524d\u4e3a\u6b62\u53ea\u5173\u6ce8\u8bfb\u53d6\u6216\u5199\u5165\u5355\u4e2a\u952e\u7684\u975e\u5e38\u7b80\u5355\u7684\u67e5\u8be2\uff08\u52a0\u4e0a\u57fa\u4e8e\u6587\u6863\u5206\u533a\u7684\u6b21\u7ea7\u7d22\u5f15\u573a\u666f\u4e0b\u7684\u5206\u6563 / \u805a\u96c6\u67e5\u8be2\uff09\uff0c\u8fd9\u662f\u5927\u591a\u6570NoSQL\u5206\u5e03\u5f0f\u6570\u636e\u5b58\u50a8\u6240\u652f\u6301\u7684\u8bbf\u95ee\u5c42\u7ea7\u3002</p> <p>\u901a\u5e38\u7528\u4e8e\u5206\u6790\u7684 \u5927\u89c4\u6a21\u5e76\u884c\u5904\u7406\uff08MPP, Massively parallel processing\uff09 \u5173\u7cfb\u578b\u6570\u636e\u5e93\u4ea7\u54c1\u5728\u5176\u652f\u6301\u7684\u67e5\u8be2\u7c7b\u578b\u65b9\u9762\u8981\u590d\u6742\u5f97\u591a</p> <ul> <li>\u5178\u578b\u7684\u6570\u636e\u4ed3\u5e93\u67e5\u8be2\u5305\u542b\u591a\u4e2a\u8fde\u63a5\uff0c\u8fc7\u6ee4\uff0c\u5206\u7ec4\u548c\u805a\u5408\u64cd\u4f5c\uff1b</li> <li>MPP \u67e5\u8be2\u4f18\u5316\u5668\u5c06\u8fd9\u4e2a\u590d\u6742\u7684\u67e5\u8be2\u5206\u89e3\u6210\u8bb8\u591a\u6267\u884c\u9636\u6bb5\u548c\u5206\u533a\uff0c\u5176\u4e2d\u8bb8\u591a\u53ef\u4ee5\u5728\u6570\u636e\u5e93\u96c6\u7fa4\u7684\u4e0d\u540c\u8282\u70b9\u4e0a\u5e76\u884c\u6267\u884c\uff1b</li> <li>\u6d89\u53ca\u626b\u63cf\u5927\u89c4\u6a21\u6570\u636e\u96c6\u7684\u67e5\u8be2\u7279\u522b\u53d7\u76ca\u4e8e\u8fd9\u79cd\u5e76\u884c\u6267\u884c\u3002</li> </ul> <p>\u5728 \u7b2c\u5341\u7ae0 \u8ba8\u8bba\u5e76\u884c\u67e5\u8be2\u6267\u884c\u7684\u4e00\u4e9b\u6280\u5de7\u3002\u6709\u5173\u5e76\u884c\u6570\u636e\u5e93\u4e2d\u4f7f\u7528\u7684\u6280\u672f\u7684\u66f4\u8be6\u7ec6\u7684\u6982\u8ff0\uff0c\u8bf7\u53c2\u9605\u53c2\u8003\u6587\u732e\\(^{[12,13]}\\)\u3002</p>"},{"location":"books/data_intensive_system_book/6_partitions.html#_19","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>\u201cThe Apache HBase Reference Guide,\u201d Apache Software Foundation, hbase.apache.org, 2014.</li> <li>David Karger, Eric Lehman, Tom Leighton, et al.: \u201cConsistent Hashing and Random Trees: Distributed Caching Protocols for Relieving Hot Spots on the World Wide Web,\u201d at 29th Annual ACM Symposium on Theory of Computing (STOC), pages 654\u2013663, 1997. doi:10.1145/258533.258660</li> <li>MongoDB, Inc.: \u201cNew Hash-Based Sharding Feature in MongoDB 2.4,\u201d blog.mongodb.org, April 10, 2013.</li> <li>Avinash Lakshman and Prashant Malik: \u201cCassandra \u2013 A Decentralized Structured Storage System,\u201d at 3rd ACM SIGOPS International Workshop on Large Scale Distributed Systems and Middleware (LADIS), October 2009.</li> <li>Samuel Axon: \u201c3% of Twitter's Servers Dedicated to Justin Bieber,\u201d mashable.com, September 7, 2010.</li> <li>Eric Evans: \u201cRethinking Topology in Cassandra,\u201d at ApacheCon Europe, November 2012.</li> <li>Enis Soztutar: \u201cApache HBase Region Splitting and Merging,\u201d hortonworks.com, February 1, 2013.</li> <li>Brandon Williams: \u201cVirtual Nodes in Cassandra 1.2,\u201d datastax.com, December 4, 2012.</li> <li>Branimir Lambov: \u201cNew Token Allocation Algorithm in Cassandra 3.0,\u201d datastax.com, January 28, 2016.</li> <li>Jason Wilder: \u201cOpen-Source Service Discovery,\u201d jasonwilder.com, February 2014.</li> <li>Kishore Gopalakrishna, Shi Lu, Zhen Zhang, et al.: \u201cUntangling Cluster Management with Helix,\u201d at ACM Symposium on Cloud Computing (SoCC), October 2012. doi:10.1145/2391229.2391248</li> <li>David J. DeWitt and Jim N. Gray: \u201cParallel Database Systems: The Future of High Performance Database Systems,\u201d Communications of the ACM, volume 35, number 6, pages 85\u201398, June 1992. doi:10.1145/129888.129894</li> <li>Shivnath Babu and Herodotos Herodotou: \u201cMassively Parallel Databases and MapReduce Systems,\u201d Foundations and Trends in Databases, volume 5, number 1, pages 1\u2013104, November 2013.doi:10.1561/1900000036</li> </ol>"},{"location":"books/data_intensive_system_book/7_transaction.html","title":"\u4e8b\u52a1","text":"<p>SQL-92 \u6807\u51c6\u5b9a\u4e49\u4e86 4 \u79cd\u9694\u79bb\u7ea7\u522b\uff1a\u8bfb\u672a\u63d0\u4ea4 (READ UNCOMMITTED)\u3001\u8bfb\u5df2\u63d0\u4ea4 (READ COMMITTED)\u3001\u53ef\u91cd\u590d\u8bfb (REPEATABLE READ)\u3001\u4e32\u884c\u5316 (SERIALIZABLE)\u3002\u8be6\u89c1\u4e0b\u8868\uff1a</p> \u9694\u79bb\u7ea7\u522b \u810f\u5199 \u810f\u8bfb \u4e0d\u53ef\u91cd\u590d\u8bfb(fuzzy read) \u5e7b\u8bfb\uff08Phantom\uff09 READ UNCOMMITTED Not Possible Possible Possible Possible READ COMMITTED Not Possible Not possible Possible Possible REPEATABLE READ Not Possible Not possible Not possible Possible SERIALIZABLE Not Possible Not possible Not possible Not possible <p>\u5728\u6570\u636e\u7cfb\u7edf\u7684\u6b8b\u9177\u73b0\u5b9e\u4e2d\uff0c\u5f88\u591a\u4e8b\u60c5\u90fd\u53ef\u80fd\u51fa\u9519\uff1a</p> <ul> <li>\u6570\u636e\u5e93\u8f6f\u4ef6\u3001\u786c\u4ef6\u53ef\u80fd\u5728\u4efb\u610f\u65f6\u523b\u53d1\u751f\u6545\u969c\uff08\u5305\u62ec\u5199\u64cd\u4f5c\u8fdb\u884c\u5230\u4e00\u534a\u65f6\uff09\u3002</li> <li>\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u5728\u4efb\u610f\u65f6\u523b\u5d29\u6e83\uff08\u5305\u62ec\u4e00\u7cfb\u5217\u64cd\u4f5c\u7684\u4e2d\u95f4\uff09\u3002</li> <li>\u7f51\u7edc\u4e2d\u65ad\u53ef\u80fd\u4f1a\u610f\u5916\u5207\u65ad\u6570\u636e\u5e93\u4e0e\u5e94\u7528\u7684\u8fde\u63a5\uff0c\u6216\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u8fde\u63a5\u3002</li> <li>\u591a\u4e2a\u5ba2\u6237\u7aef\u53ef\u80fd\u4f1a\u540c\u65f6\u5199\u5165\u6570\u636e\u5e93\uff0c\u8986\u76d6\u5f7c\u6b64\u7684\u66f4\u6539\u3002</li> <li>\u5ba2\u6237\u7aef\u53ef\u80fd\u8bfb\u53d6\u5230\u65e0\u610f\u4e49\u7684\u6570\u636e\uff0c\u56e0\u4e3a\u6570\u636e\u53ea\u66f4\u65b0\u4e86\u4e00\u90e8\u5206\u3002</li> <li>\u5ba2\u6237\u7aef\u4e4b\u95f4\u7684\u7ade\u4e89\u6761\u4ef6\u53ef\u80fd\u5bfc\u81f4\u4ee4\u4eba\u60ca\u8bb6\u7684\u9519\u8bef\u3002</li> </ul> <p>\u4e8b\u52a1\uff08transaction\uff09\u662f\u5e94\u7528\u7a0b\u5e8f\u5c06\u591a\u4e2a\u8bfb\u5199\u64cd\u4f5c\u7ec4\u5408\u6210\u4e00\u4e2a\u903b\u8f91\u5355\u5143\u7684\u4e00\u79cd\u65b9\u5f0f</p> <ul> <li>\u6574\u4e2a\u4e8b\u52a1\u8981\u4e48\u6210\u529f \u63d0\u4ea4\uff08commit\uff09\uff0c\u8981\u4e48\u5931\u8d25 \u4e2d\u6b62\uff08abort\uff09\u6216 \u56de\u6eda\uff08rollback\uff09\uff1b</li> <li>\u5982\u679c\u5931\u8d25\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5b89\u5168\u5730\u91cd\u8bd5\uff1b\u4e0d\u7528\u62c5\u5fc3\u90e8\u5206\u5931\u8d25\u7684\u573a\u666f\uff1b</li> </ul> <p>\u5e76\u4e0d\u662f\u6240\u6709\u7684\u5e94\u7528\u90fd\u9700\u8981\u4e8b\u52a1\uff0c\u6709\u65f6\u5019\u5f31\u5316\u4e8b\u52a1\u4fdd\u8bc1\u3001\u6216\u5b8c\u5168\u653e\u5f03\u4e8b\u52a1\u4e5f\u662f\u6709\u597d\u5904\u7684\uff08\u4f8b\u5982\uff0c\u4e3a\u4e86\u83b7\u5f97\u66f4\u9ad8\u6027\u80fd\u6216\u66f4\u9ad8\u53ef\u7528\u6027\uff09\u3002</p> <p>\u672c\u7ae0\u5c06\u7814\u7a76\u8bb8\u591a\u51fa\u9519\u6848\u4f8b\uff0c\u5e76\u63a2\u7d22\u6570\u636e\u5e93\u7528\u4e8e\u9632\u8303\u8fd9\u4e9b\u95ee\u9898\u7684\u7b97\u6cd5\u3002</p> <ul> <li>\u6570\u636e\u5e93\u5982\u4f55\u5b9e\u73b0 \u8bfb\u5df2\u63d0\u4ea4\uff08read committed\uff09\uff0c\u5feb\u7167\u9694\u79bb\uff08snapshot isolation\uff09 \u548c \u53ef\u4e32\u884c\u5316\uff08serializability\uff09 \u7b49\u9694\u79bb\u7ea7\u522b\u3002</li> <li>\u6df1\u5165 \u5e76\u53d1\u63a7\u5236 \u7684\u9886\u57df\uff0c\u8ba8\u8bba\u5404\u79cd\u53ef\u80fd\u53d1\u751f\u7684\u7ade\u4e89\u6761\u4ef6\uff0c\u6765\u63cf\u8ff0\u8fd9\u4e9b\u9694\u79bb\u7b49\u7ea7\uff1b</li> <li>\u810f\u5199\uff1a\u4e00\u4e2a\u5ba2\u6237\u7aef\u8986\u76d6\u5199\u5165\u4e86\u53e6\u4e00\u4e2a\u5ba2\u6237\u7aef\u5c1a\u672a\u63d0\u4ea4\u7684\u5199\u5165\u3002\u51e0\u4e4e\u6240\u6709\u7684\u4e8b\u52a1\u5b9e\u73b0\u90fd\u53ef\u4ee5\u9632\u6b62\u810f\u5199\u3002</li> <li>\u810f\u8bfb\uff1a\u4e00\u4e2a\u5ba2\u6237\u7aef\u8bfb\u53d6\u5230\u53e6\u4e00\u4e2a\u5ba2\u6237\u7aef\u5c1a\u672a\u63d0\u4ea4\u7684\u5199\u5165\u3002\u8bfb\u5df2\u63d0\u4ea4 \u6216\u66f4\u5f3a\u7684\u9694\u79bb\u7ea7\u522b\u53ef\u4ee5\u9632\u6b62\u810f\u8bfb\u3002</li> <li>\u8bfb\u504f\u5dee\uff08\u4e0d\u53ef\u91cd\u590d\u8bfb\uff09\uff1a\u5728\u540c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\uff0c\u5ba2\u6237\u7aef\u5728\u4e0d\u540c\u7684\u65f6\u95f4\u70b9\u4f1a\u770b\u89c1\u6570\u636e\u5e93\u7684\u4e0d\u540c\u72b6\u6001\uff08\u8bfb\u53d6\u5230\u521a\u63d0\u4ea4\u7684\u5199\u5165\uff09\u3002<ul> <li>\u5feb\u7167\u9694\u79bb\u7528\u4e8e\u89e3\u51b3\u8be5\u95ee\u9898\uff0c\u901a\u5e38\u91c7\u7528 \u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236\uff08MVCC\uff09\u5b9e\u73b0\uff1b</li> </ul> </li> <li>\u4e22\u5931\u66f4\u65b0\uff1a\u4e24\u4e2a\u5ba2\u6237\u7aef\u540c\u65f6\u6267\u884c \u8bfb\u53d6 - \u4fee\u6539 - \u5199\u5165\u5e8f\u5217\uff08\u5728\u4e00\u4e2a\u4e8b\u52a1\u4e2d\uff09\uff0c\u5982\u8ba1\u6570\u5668\u7d2f\u52a0\u3002<ul> <li>\u5199\u64cd\u4f5c\uff0c\u5728\u6ca1\u6709\u5408\u5e76\u53e6\u4e00\u4e2a\u5199\u5165\u53d8\u66f4\u60c5\u51b5\u4e0b\uff0c\u76f4\u63a5\u8986\u76d6\u4e86\u53e6\u4e00\u4e2a\u5199\u64cd\u4f5c\u7684\u7ed3\u679c</li> <li>\u5feb\u7167\u9694\u79bb\u7684\u4e00\u4e9b\u5b9e\u73b0\u53ef\u4ee5\u81ea\u52a8\u9632\u6b62\u8fd9\u79cd\u5f02\u5e38\uff0c\u800c\u53e6\u4e00\u4e9b\u5b9e\u73b0\u5219\u9700\u8981\u624b\u52a8\u9501\u5b9a\uff08<code>SELECT FOR UPDATE</code>\uff09</li> </ul> </li> <li>\u5e7b\u8bfb\uff1a\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u7684\u5199\u5165\u6539\u53d8\u53e6\u4e00\u4e2a\u4e8b\u52a1\u7684\u641c\u7d22\u67e5\u8be2\u7684\u7ed3\u679c<ul> <li>\u5feb\u7167\u9694\u79bb\u907f\u514d\u4e86\u53ea\u8bfb\u67e5\u8be2\u4e2d\u5e7b\u8bfb\uff0c\u4f46\u5728\u8bfb\u5199\u4e8b\u52a1\u4e2d\uff0c\u4f1a\u5bfc\u81f4\u5199\u5165\u504f\u5dee\u7684\u60c5\u51b5\uff0c\u9700\u8981\u4f7f\u7528\u7d22\u5f15\u8303\u56f4\u9501\u5b9a\uff1b</li> </ul> </li> <li>\u5199\u504f\u5dee\uff1a\u4e00\u4e2a\u4e8b\u52a1\u8bfb\u53d6\u4e00\u4e9b\u4e1c\u897f\uff0c\u6839\u636e\u5b83\u6240\u770b\u5230\u7684\u503c\u4f5c\u51fa\u51b3\u5b9a\uff0c\u5e76\u5c06\u8be5\u51b3\u5b9a\u5199\u5165\u6570\u636e\u5e93\u3002\u4f46\u5199\u5165\u65f6\uff0c\u5176\u524d\u63d0\u4e0d\u518d\u771f\u5b9e\u3002<ul> <li>\u53ea\u6709\u53ef\u4e32\u884c\u5316\u7684\u9694\u79bb\u624d\u80fd\u9632\u6b62\u8fd9\u79cd\u5f02\u5e38\u3002</li> </ul> </li> </ul> <p>\u5f31\u9694\u79bb\u7ea7\u522b\u53ef\u4ee5\u9632\u6b62\u5176\u4e2d\u4e00\u4e9b\u5f02\u5e38\u60c5\u51b5\uff0c\u4f46\u8981\u6c42\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u624b\u52a8\u5904\u7406\u5269\u4f59\u90a3\u4e9b\uff08\u4f8b\u5982\uff0c\u4f7f\u7528\u663e\u5f0f\u9501\u5b9a\uff09\u3002</p> <p>\u53ea\u6709\u53ef\u4e32\u884c\u5316\u7684\u9694\u79bb\u624d\u80fd\u9632\u8303\u6240\u6709\u8fd9\u4e9b\u95ee\u9898\uff0c\u6709\u4e09\u79cd\u4e0d\u540c\u65b9\u6cd5\u5b9e\u73b0\u53ef\u4e32\u884c\u5316\u4e8b\u52a1\uff1a</p> <ul> <li>\u5b57\u9762\u610f\u4e49\u4e0a\u7684\u4e32\u884c\u6267\u884c\uff1a\u5355\u4e2aCPU\u4e32\u884c\u5904\u7406\uff0c\u8981\u6c42\u6bcf\u4e2a\u4e8b\u52a1\u6267\u884c\u901f\u5ea6\u5feb\uff0c\u4e14\u4e8b\u52a1\u7684\u541e\u5410\u91cf\u4f4e\uff1b</li> <li>\u4e24\u9636\u6bb5\u9501\u5b9a\uff082PL\uff09\uff1a\u53ef\u4e32\u884c\u5316\u5b9e\u73b0\u7684\u6807\u51c6\u65b9\u5f0f\uff0c\u4f46\u8bb8\u591a\u5e94\u7528\u51fa\u4e8e\u6027\u80fd\u95ee\u9898\u7684\u8003\u8651\u907f\u514d\u4f7f\u7528\u5b83</li> <li>\u53ef\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb\uff08SSI\uff09\uff1a\u4e50\u89c2\u7b97\u6cd5\uff0c\u5141\u8bb8\u4e8b\u52a1\u6267\u884c\u800c\u65e0\u9700\u963b\u585e\uff0c\u4e8b\u540e\u68c0\u67e5\u5982\u679c\u6267\u884c\u4e0d\u53ef\u4e32\u884c\u5316\uff0c\u5219\u4e2d\u6b62\u4e8b\u52a1\u3002</li> </ul> <p>\u672c\u7ae0\u540c\u65f6\u9002\u7528\u4e8e\u5355\u673a\u6570\u636e\u5e93\u4e0e\u5206\u5e03\u5f0f\u6570\u636e\u5e93\uff1b\u5728 \u7b2c\u516b\u7ae0 \u4e2d\u5c06\u91cd\u70b9\u8ba8\u8bba\u4ec5\u51fa\u73b0\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u7279\u6b8a\u6311\u6218\u3002</p>"},{"location":"books/data_intensive_system_book/7_transaction.html#_2","title":"\u4e8b\u52a1\u7684\u68d8\u624b\u6982\u5ff5","text":"<p>\u968f\u7740\u8fd9\u79cd\u65b0\u578b\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u7684\u7092\u4f5c\uff0c\u4eba\u4eec\u666e\u904d\u8ba4\u4e3a\u4e8b\u52a1\u662f\u53ef\u4f38\u7f29\u6027\u7684\u5bf9\u7acb\u9762\uff0c\u4efb\u4f55\u5927\u578b\u7cfb\u7edf\u90fd\u5fc5\u987b\u653e\u5f03\u4e8b\u52a1\u4ee5\u4fdd\u6301\u826f\u597d\u7684\u6027\u80fd\u548c\u9ad8\u53ef\u7528\u6027\\(^{[1,2]}\\)\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u6570\u636e\u5e93\u5382\u5546\u6709\u65f6\u5c06\u4e8b\u52a1\u4fdd\u8bc1\u4f5c\u4e3a \u201c\u91cd\u8981\u5e94\u7528\u201d \u548c \u201c\u6709\u4ef7\u503c\u6570\u636e\u201d \u7684\u57fa\u672c\u8981\u6c42\u3002\u8fd9\u4e24\u79cd\u89c2\u70b9\u90fd\u662f \u7eaf\u7cb9\u7684\u5938\u5f20\u3002</p> <p>\u4e0e\u5176\u4ed6\u6280\u672f\u8bbe\u8ba1\u9009\u62e9\u4e00\u6837\uff0c\u4e8b\u52a1\u6709\u5176\u4f18\u52bf\u548c\u5c40\u9650\u6027\uff0c\u9700\u8981\u8fdb\u4e00\u6b65\u4e86\u89e3\u8fd9\u4e9b\u6743\u8861\u3002</p>"},{"location":"books/data_intensive_system_book/7_transaction.html#acid","title":"ACID\u7684\u542b\u4e49","text":"<p>ACID \u7531 Theo H\u00e4rder \u548c Andreas Reuter \u4e8e 1983 \u5e74\u63d0\u51fa\uff0c\u65e8\u5728\u4e3a\u6570\u636e\u5e93\u4e2d\u7684\u5bb9\u9519\u673a\u5236\u5efa\u7acb\u7cbe\u786e\u7684\u672f\u8bed\u3002</p> <ul> <li>\u4e0d\u540c\u6570\u636e\u5e93\u7684 ACID \u5b9e\u73b0\u5e76\u4e0d\u76f8\u540c\uff0c\u5173\u4e8e \u9694\u79bb\u6027 \u7684\u542b\u4e49\u5c31\u6709\u8bb8\u591a\u542b\u7cca\u4e0d\u6e05\\(^{[3]}\\)\uff1b</li> </ul> <p>\u7b26\u5408 ACID \u6807\u51c6\u7684\u7cfb\u7edf\u6709\u65f6\u88ab\u79f0\u4e3a BASE\uff1a</p> <ul> <li>\u57fa\u672c\u53ef\u7528\u6027\uff08Basically Available\uff09\uff0c\u8f6f\u72b6\u6001\uff08Soft State\uff09 \u548c \u6700\u7ec8\u4e00\u81f4\u6027\uff08Eventual consistency\uff09\\(^{[4]}\\)</li> <li>\u6bd4 ACID \u7684\u5b9a\u4e49\u66f4\u52a0\u6a21\u7cca\uff0c\u4f3c\u4e4e BASE \u7684\u552f\u4e00\u5408\u7406\u7684\u5b9a\u4e49\u662f \u201c\u4e0d\u662f ACID\u201d</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#atomicity","title":"\u539f\u5b50\u6027\uff08Atomicity\uff09","text":"<p>ACID \u7684\u539f\u5b50\u6027\u5e76\u4e0d\u662f\u5173\u4e8e \u5e76\u53d1\uff0c\u63cf\u8ff0\u5982\u679c\u51e0\u4e2a\u8fdb\u7a0b\u8bd5\u56fe\u540c\u65f6\u8bbf\u95ee\u76f8\u540c\u7684\u6570\u636e\u4f1a\u53d1\u751f\u4ec0\u4e48\u60c5\u51b5\u5c5e\u4e8e\u9694\u79bb\u6027\u3002</p> <p>\u539f\u5b50\u6027\uff1a\u80fd\u591f\u5728\u9519\u8bef\u65f6\u4e2d\u6b62\u4e8b\u52a1\uff0c\u4e22\u5f03\u8be5\u4e8b\u52a1\u8fdb\u884c\u7684\u6240\u6709\u5199\u5165\u53d8\u66f4\u7684\u80fd\u529b</p> <ul> <li>\u5982\u679c\u4e8b\u52a1\u88ab \u4e2d\u6b62\uff08abort\uff09\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u786e\u5b9a\u5b83\u6ca1\u6709\u6539\u53d8\u4efb\u4f55\u4e1c\u897f\uff0c\u6240\u4ee5\u53ef\u4ee5\u5b89\u5168\u5730\u91cd\u8bd5</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#consistency","title":"\u4e00\u81f4\u6027\uff08Consistency\uff09","text":"<p>\u4e00\u81f4\u6027\u8fd9\u4e2a\u8bcd\u88ab\u8d4b\u4e88\u592a\u591a\u542b\u4e49\uff1a</p> <ul> <li>\u5728 \u7b2c\u4e94\u7ae0 \u4e2d\uff0c\u6211\u4eec\u8ba8\u8bba\u4e86\u526f\u672c\u4e00\u81f4\u6027\uff0c\u4ee5\u53ca\u5f02\u6b65\u590d\u5236\u7cfb\u7edf\u4e2d\u7684\u6700\u7ec8\u4e00\u81f4\u6027\u95ee\u9898\uff08\u8bf7\u53c2\u9605 \u201c\u590d\u5236\u5ef6\u8fdf\u95ee\u9898\u201d\uff09\u3002</li> <li>\u4e00\u81f4\u6027\u54c8\u5e0c \u662f\u67d0\u4e9b\u7cfb\u7edf\u7528\u4e8e\u91cd\u65b0\u5206\u533a\u7684\u4e00\u79cd\u5206\u533a\u65b9\u6cd5\u3002</li> <li>\u5728 CAP \u5b9a\u7406 \u4e2d\uff0c\u4e00\u81f4\u6027\u4e00\u8bcd\u7528\u4e8e\u8868\u793a \u7ebf\u6027\u4e00\u81f4\u6027\u3002</li> <li>\u5728 ACID \u7684\u4e0a\u4e0b\u6587\u4e2d\uff0c\u4e00\u81f4\u6027 \u662f\u6307\u6570\u636e\u5e93\u5728\u5e94\u7528\u7a0b\u5e8f\u7684\u7279\u5b9a\u6982\u5ff5\u4e2d\u5904\u4e8e \u201c\u826f\u597d\u72b6\u6001\u201d\u3002</li> </ul> <p>ACID \u4e00\u81f4\u6027\u7684\u6982\u5ff5\u662f\uff0c\u5bf9\u6570\u636e\u7684\u4e00\u7ec4\u7279\u5b9a\u7ea6\u675f\u5fc5\u987b\u59cb\u7ec8\u6210\u7acb\uff0c\u5373 \u4e0d\u53d8\u5f0f\uff08invariants\uff09\u3002</p> <ul> <li> <p>\u4e00\u81f4\u6027\uff08\u5728 ACID \u610f\u4e49\u4e0a\uff09\u662f\u5e94\u7528\u7a0b\u5e8f\u7684\u5c5e\u6027\uff0c\u5b57\u6bcd C \u4e0d\u5c5e\u4e8e ACID<sup>7</sup></p> </li> <li> <p>\u5e94\u7528\u53ef\u80fd\u4f9d\u8d56\u6570\u636e\u5e93\u7684\u539f\u5b50\u6027\u548c\u9694\u79bb\u6027\u6765\u5b9e\u73b0\u4e00\u81f4\u6027\uff0c\u4f46\u8fd9\u5e76\u4e0d\u4ec5\u53d6\u51b3\u4e8e\u6570\u636e\u5e93;</p> </li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#isolation","title":"\u9694\u79bb\u6027\uff08Isolation\uff09","text":"<p>\u5e76\u53d1 \u95ee\u9898\uff08\u7ade\u4e89\u6761\u4ef6\uff0c\u5373 race conditions\uff09\uff1a\u591a\u4e2a\u5ba2\u6237\u7aef\u540c\u65f6\u8bbf\u95ee\u76f8\u540c\u7684\u6570\u636e\u5e93\u8bb0\u5f55\u3002</p> <ul> <li>\u5982\u4e0b\u56fe 7-1 \u6240\u793a\uff1a\u5047\u8bbe\u4f60\u6709\u4e24\u4e2a\u5ba2\u6237\u7aef\u540c\u65f6\u5728\u6570\u636e\u5e93\u4e2d\u589e\u957f\u4e00\u4e2a\u8ba1\u6570\u5668\uff0c\u7531\u4e8e\u7ade\u6001\u6761\u4ef6\uff0c\u5b9e\u9645\u4e0a\u53ea\u589e\u81f3 43\u3002</li> </ul> <p></p> <p>\u9694\u79bb\u6027\uff1a\u610f\u5473\u7740\u540c\u65f6\u6267\u884c\u7684\u4e8b\u52a1\u662f\u76f8\u4e92\u9694\u79bb\u7684</p> <ul> <li>\u4f20\u7edf\u7684\u6570\u636e\u5e93\u6559\u79d1\u4e66\u5c06\u9694\u79bb\u6027\u5f62\u5f0f\u5316\u4e3a \u53ef\u4e32\u884c\u5316\uff08Serializability\uff09</li> <li>\u786e\u4fdd\u5f53\u591a\u4e2a\u4e8b\u52a1\u88ab\u63d0\u4ea4\u65f6\uff0c\u7ed3\u679c\u4e0e\u5b83\u4eec\u4e32\u884c\u8fd0\u884c\uff08\u4e00\u4e2a\u63a5\u4e00\u4e2a\uff09\u662f\u4e00\u6837\u7684\uff0c\u5c3d\u7ba1\u5b9e\u9645\u4e0a\u5b83\u4eec\u53ef\u80fd\u662f\u5e76\u53d1\u8fd0\u884c\u7684\\(^{[6]}\\)</li> <li>\u5b9e\u8df5\u4e2d\u5f88\u5c11\u4f1a\u4f7f\u7528\u53ef\u4e32\u884c\u7684\u9694\u79bb\uff0c\u56e0\u4e3a\u6709\u6027\u80fd\u635f\u5931\uff0c\u5728 \u201c\u5f31\u9694\u79bb\u7ea7\u522b\u201d \u4e2d\u7814\u7a76\u5feb\u7167\u9694\u79bb\u548c\u5176\u4ed6\u5f62\u5f0f\u7684\u9694\u79bb\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#durability","title":"\u6301\u4e45\u6027\uff08Durability\uff09","text":"<p>\u6301\u4e45\u6027 \u662f\u4e00\u4e2a\u627f\u8bfa\uff0c\u5373\u4e00\u65e6\u4e8b\u52a1\u6210\u529f\u5b8c\u6210\uff0c\u5373\u4f7f\u53d1\u751f\u786c\u4ef6\u6545\u969c\u6216\u6570\u636e\u5e93\u5d29\u6e83\uff0c\u5199\u5165\u7684\u4efb\u4f55\u6570\u636e\u4e5f\u4e0d\u4f1a\u4e22\u5931\u3002</p> <ul> <li>\u5355\u8282\u70b9\u6570\u636e\u5e93\uff1a\u6570\u636e\u5df2\u88ab\u5199\u5165\u975e\u6613\u5931\u6027\u5b58\u50a8\u8bbe\u5907\uff0c\u8fd8\u5305\u62ec\u9884\u5199\u65e5\u5fd7\u6216\u7c7b\u4f3c\u7684\u6587\u4ef6\uff1b</li> <li>\u5e26\u590d\u5236\u7684\u6570\u636e\u5e93\uff1a\u6570\u636e\u5df2\u6210\u529f\u590d\u5236\u5230\u4e00\u4e9b\u8282\u70b9\uff1b</li> </ul> <p>\u4e3a\u4e86\u63d0\u4f9b\u6301\u4e45\u6027\u4fdd\u8bc1\uff0c\u6570\u636e\u5e93\u5fc5\u987b\u7b49\u5230\u8fd9\u4e9b\u5199\u5165\u6216\u590d\u5236\u5b8c\u6210\u540e\uff0c\u624d\u80fd\u62a5\u544a\u4e8b\u52a1\u6210\u529f\u63d0\u4ea4\u3002</p> <ul> <li>\u5b8c\u7f8e\u7684\u6301\u4e45\u6027\u662f\u4e0d\u5b58\u5728\u7684 \uff1a\u5982\u679c\u6240\u6709\u786c\u76d8\u548c\u6240\u6709\u5907\u4efd\u540c\u65f6\u88ab\u9500\u6bc1</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_3","title":"\u590d\u5236\u4e0e\u6301\u4e45\u6027","text":"<p>\u5728\u5386\u53f2\u4e0a\uff0c\u6301\u4e45\u6027\u610f\u5473\u7740\u5199\u5165\u5f52\u6863\u78c1\u5e26\u3002\u540e\u6765\u5b83\u88ab\u7406\u89e3\u4e3a\u5199\u5165\u78c1\u76d8\u6216 SSD\u3002\u518d\u540e\u6765\u5b83\u53c8\u6709\u4e86\u65b0\u7684\u5185\u6db5\u5373 \u201c\u590d\u5236\uff08replication\uff09\u201d\u3002</p> <p>\u6ca1\u6709\u54ea\u79cd\u5b9e\u73b0\u662f\u5b8c\u7f8e\u7684\uff1a</p> <ul> <li>\u5199\u5165\u78c1\u76d8\u7136\u540e\u673a\u5668\u5b95\u673a\uff1a\u5373\u4f7f\u6570\u636e\u672a\u4e22\u5931\uff0c\u4ecd\u9700\u7b49\u5f85\u673a\u5668\u4fee\u590d\u6216\u8005\u78c1\u76d8\u8fc1\u79fb\u3002\u590d\u5236\u7cfb\u7edf\u53ef\u4ee5\u4fdd\u6301\u53ef\u7528\u6027\uff1b</li> <li>\u4e00\u4e2a\u76f8\u5173\u6027\u6545\u969c\uff08\u505c\u7535\uff0c\u6216\u4e00\u4e2a\u7279\u5b9a\u8f93\u5165\u5bfc\u81f4\u6240\u6709\u8282\u70b9\u5d29\u6e83\u7684 Bug\uff09\u53ef\u80fd\u4f1a\u4e00\u6b21\u6027\u6467\u6bc1\u6240\u6709\u526f\u672c\uff0c\u5185\u5b58\u6570\u636e\u5e93\u4ecd\u8981\u8ddf\u78c1\u76d8\u6253\u4ea4\u9053\uff1b</li> <li>\u5728\u5f02\u6b65\u590d\u5236\u7cfb\u7edf\u4e2d\uff0c\u5f53\u4e3b\u5e93\u4e0d\u53ef\u7528\u65f6\uff0c\u6700\u8fd1\u7684\u5199\u5165\u64cd\u4f5c\u53ef\u80fd\u4f1a\u4e22\u5931\uff08\u53c2\u9605\u300c\u5904\u7406\u8282\u70b9\u5b95\u673a\u300d\uff09\uff1b</li> <li>\u5f53\u7535\u6e90\u7a81\u7136\u65ad\u7535\u65f6\uff0c\u7279\u522b\u662f\u56fa\u6001\u786c\u76d8\uff0c\u6709\u8bc1\u636e\u663e\u793a\u6709\u65f6\u4f1a\u8fdd\u53cd\u5e94\u6709\u7684\u4fdd\u8bc1\uff1a\u751a\u81f3 fsync \u4e5f\u4e0d\u80fd\u4fdd\u8bc1\u6b63\u5e38\u5de5\u4f5c\\(^{[7]}\\)\u3002\u786c\u76d8\u56fa\u4ef6\u53ef\u80fd\u6709\u9519\u8bef\uff0c\u5c31\u50cf\u4efb\u4f55\u5176\u4ed6\u7c7b\u578b\u7684\u8f6f\u4ef6\u4e00\u6837\\(^{[8,9]}\\)\u3002</li> <li>\u5b58\u50a8\u5f15\u64ce\u548c\u6587\u4ef6\u7cfb\u7edf\u4e4b\u95f4\u7684\u5fae\u5999\u4ea4\u4e92\u53ef\u80fd\u4f1a\u5bfc\u81f4\u96be\u4ee5\u8ffd\u8e2a\u7684\u9519\u8bef\uff0c\u5e76\u53ef\u80fd\u5bfc\u81f4\u78c1\u76d8\u4e0a\u7684\u6587\u4ef6\u5728\u5d29\u6e83\u540e\u88ab\u635f\u574f\\(^{[10,11]}\\)\u3002</li> <li>\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u53ef\u80fd\u4f1a\u5728\u6ca1\u6709\u68c0\u6d4b\u5230\u7684\u60c5\u51b5\u4e0b\u9010\u6e10\u635f\u574f\\(^{[12]}\\)\u3002\u9700\u8981\u5c1d\u8bd5\u4ece\u5386\u53f2\u5907\u4efd\u4e2d\u6062\u590d\u6570\u636e\u3002</li> <li>\u56fa\u6001\u786c\u76d8\u7684\u7814\u7a76\u53d1\u73b0\uff0c\u5728\u8fd0\u884c\u7684\u524d\u56db\u5e74\u4e2d\uff0c30% \u5230 80% \u7684\u786c\u76d8\u4f1a\u4ea7\u751f\u81f3\u5c11\u4e00\u4e2a\u574f\u5757\\(^{[13]}\\)\u3002\u76f8\u6bd4\u56fa\u6001\u786c\u76d8\uff0c\u78c1\u76d8\u7684\u574f\u9053\u7387\u8f83\u4f4e\uff0c\u4f46\u5b8c\u5168\u5931\u6548\u7684\u6982\u7387\u66f4\u9ad8\u3002</li> <li>\u5982\u679c SSD \u65ad\u7535\uff0c\u53ef\u80fd\u4f1a\u5728\u51e0\u5468\u5185\u5f00\u59cb\u4e22\u5931\u6570\u636e\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u6e29\u5ea6\\(^{[14]}\\)\u3002</li> </ul> <p>\u5728\u5b9e\u8df5\u4e2d\uff0c\u6ca1\u6709\u4e00\u79cd\u6280\u672f\u53ef\u4ee5\u63d0\u4f9b\u7edd\u5bf9\u4fdd\u8bc1\u3002\u53ea\u6709\u5404\u79cd\u964d\u4f4e\u98ce\u9669\u7684\u6280\u672f\uff0c\u5305\u62ec\u5199\u5165\u78c1\u76d8\uff0c\u590d\u5236\u5230\u8fdc\u7a0b\u673a\u5668\u548c\u5907\u4efd \u2014\u2014 \u5b83\u4eec\u53ef\u4ee5\u4e14\u5e94\u8be5\u4e00\u8d77\u4f7f\u7528\u3002\u4e0e\u5f80\u5e38\u4e00\u6837\uff0c\u6700\u597d\u62b1\u7740\u6000\u7591\u7684\u6001\u5ea6\u63a5\u53d7\u4efb\u4f55\u7406\u8bba\u4e0a\u7684 \u201c\u4fdd\u8bc1\u201d\u3002</p>"},{"location":"books/data_intensive_system_book/7_transaction.html#_4","title":"\u5355\u5bf9\u8c61\u548c\u591a\u5bf9\u8c61\u64cd\u4f5c","text":"<p>\u5047\u8bbe\u4f60\u60f3\u540c\u65f6\u4fee\u6539\u591a\u4e2a\u5bf9\u8c61\uff08\u884c\uff0c\u6587\u6863\uff0c\u8bb0\u5f55\uff09\u3002\u901a\u5e38\u9700\u8981 \u591a\u5bf9\u8c61\u4e8b\u52a1\uff08multi-object transaction\uff09 \u6765\u4fdd\u6301\u591a\u5757\u6570\u636e\u540c\u6b65\u3002</p> <p>\u793a\u4f8b\uff1a\u6267\u884c\u4ee5\u4e0b\u67e5\u8be2\u6765\u663e\u793a\u7528\u6237\u672a\u8bfb\u90ae\u4ef6\u6570\u91cf\uff1a</p> <pre><code>SELECT COUNT\uff08*\uff09FROM emails WHERE recipient_id = 2 AND unread_flag = true\n</code></pre> <ul> <li>\u5355\u72ec\u7684\u5b57\u6bb5\u5b58\u50a8\u672a\u8bfb\u90ae\u4ef6\u7684\u6570\u91cf\uff08\u4e00\u79cd\u53cd\u89c4\u8303\u5316\uff09\uff1a\u65b0\u6d88\u606f\u5199\u5165\u65f6\uff0c\u9700\u8981\u540c\u65f6\u4fee\u6539\u672a\u8bfb\u8ba1\u6570\u5668\uff1b</li> <li>\u4e0b\u56fe\u662f\u8fdd\u53cd\u9694\u79bb\u6027\u7684\u793a\u4f8b\uff1a\u7528\u6237 2 \u770b\u5230\u90ae\u4ef6\u5217\u8868\u91cc\u663e\u793a\u6709\u672a\u8bfb\u6d88\u606f\uff0c\u4f46\u8ba1\u6570\u5668\u663e\u793a\u4e3a\u96f6\u672a\u8bfb\u6d88\u606f\uff1b</li> </ul> <p></p> <ul> <li>\u4e0b\u9762\u662f\u5bf9\u539f\u5b50\u6027\u7684\u8981\u6c42\uff1a\u5982\u679c\u5bf9\u8ba1\u6570\u5668\u7684\u66f4\u65b0\u5931\u8d25\uff0c\u4e8b\u52a1\u5c06\u88ab\u4e2d\u6b62\uff0c\u5e76\u4e14\u63d2\u5165\u7684\u7535\u5b50\u90ae\u4ef6\u5c06\u88ab\u56de\u6eda\u3002</li> </ul> <p></p> <p>\u591a\u5bf9\u8c61\u4e8b\u52a1\u9700\u8981\u67d0\u79cd\u65b9\u5f0f\u6765\u786e\u5b9a\u54ea\u4e9b\u8bfb\u5199\u64cd\u4f5c\u5c5e\u4e8e\u540c\u4e00\u4e2a\u4e8b\u52a1\u3002</p> <ul> <li>\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff1a\u57fa\u4e8e\u5ba2\u6237\u7aef\u4e0e\u6570\u636e\u5e93\u670d\u52a1\u5668\u7684 TCP \u8fde\u63a5</li> <li> <p>\u5728\u4efb\u4f55\u7279\u5b9a\u8fde\u63a5\u4e0a\uff0c<code>BEGIN TRANSACTION</code> \u548c <code>COMMIT</code> \u8bed\u53e5\u4e4b\u95f4\u7684\u6240\u6709\u5185\u5bb9\uff0c\u88ab\u8ba4\u4e3a\u662f\u540c\u4e00\u4e8b\u52a1\u7684\u4e00\u90e8\u5206<sup>8</sup></p> </li> <li> <p>\u8bb8\u591a\u975e\u5173\u7cfb\u6570\u636e\u5e93\u5e76\u6ca1\u6709\u5c06\u8fd9\u4e9b\u64cd\u4f5c\u7ec4\u5408\u5728\u4e00\u8d77\u7684\u65b9\u6cd5</p> </li> <li>\u5373\u4f7f\u5b58\u5728\u591a\u5bf9\u8c61 API\uff08\u4f8b\u5982\uff0c\u67d0\u952e\u503c\u5b58\u50a8\u53ef\u80fd\u5177\u6709\u5728\u4e00\u4e2a\u64cd\u4f5c\u4e2d\u66f4\u65b0\u51e0\u4e2a\u952e\u7684 multi-put \u64cd\u4f5c\uff09\uff0c\u4f46\u8fd9\u5e76\u4e0d\u4e00\u5b9a\u610f\u5473\u7740\u5b83\u5177\u6709\u4e8b\u52a1\u8bed\u4e49</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_5","title":"\u5355\u5bf9\u8c61\u5199\u5165","text":"<p>\u5f53\u5355\u4e2a\u5bf9\u8c61\u53d1\u751f\u6539\u53d8\u65f6\uff0c\u539f\u5b50\u6027\u548c\u9694\u79bb\u6027\u4e5f\u662f\u9002\u7528\u7684\uff1a\u4f8b\u5982\uff0c\u5199\u5165 20KB \u7684 JSON \u6587\u6863</p> <ul> <li>\u5982\u679c\u5728\u53d1\u9001\u7b2c\u4e00\u4e2a 10 KB \u4e4b\u540e\u7f51\u7edc\u8fde\u63a5\u4e2d\u65ad\uff0c\u6570\u636e\u5e93\u662f\u5426\u5b58\u50a8\u4e86\u4e0d\u53ef\u89e3\u6790\u7684 10KB JSON \u7247\u6bb5\uff1f</li> <li>\u5982\u679c\u5728\u6570\u636e\u5e93\u6b63\u5728\u8986\u76d6\u78c1\u76d8\u4e0a\u7684\u524d\u4e00\u4e2a\u503c\u7684\u8fc7\u7a0b\u4e2d\u7535\u6e90\u53d1\u751f\u6545\u969c\uff0c\u662f\u5426\u6700\u7ec8\u5c06\u65b0\u65e7\u503c\u62fc\u63a5\u5728\u4e00\u8d77\uff1f</li> <li>\u5982\u679c\u53e6\u4e00\u4e2a\u5ba2\u6237\u7aef\u5728\u5199\u5165\u8fc7\u7a0b\u4e2d\u8bfb\u53d6\u8be5\u6587\u6863\uff0c\u662f\u5426\u4f1a\u770b\u5230\u90e8\u5206\u66f4\u65b0\u7684\u503c\uff1f</li> </ul> <p>\u5b58\u50a8\u5f15\u64ce\u4e00\u4e2a\u51e0\u4e4e\u666e\u904d\u7684\u76ee\u6807\u662f\uff1a\u5bf9\u5355\u8282\u70b9\u4e0a\u7684\u5355\u4e2a\u5bf9\u8c61\uff08\u4f8b\u5982\u952e\u503c\u5bf9\uff09\u4e0a\u63d0\u4f9b\u539f\u5b50\u6027\u548c\u9694\u79bb\u6027\u3002</p> <ul> <li>\u539f\u5b50\u6027\uff1a\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u65e5\u5fd7\u6765\u5b9e\u73b0\u5d29\u6e83\u6062\u590d\uff1b</li> <li>\u9694\u79bb\u6027\uff1a\u4f7f\u7528\u6bcf\u4e2a\u5bf9\u8c61\u4e0a\u7684\u9501\u6765\u5b9e\u73b0\u9694\u79bb\uff08\u6bcf\u6b21\u53ea\u5141\u8bb8\u4e00\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u5bf9\u8c61\uff09 \uff1b</li> </ul> <p>\u4e00\u4e9b\u6570\u636e\u5e93\u4e5f\u63d0\u4f9b\u66f4\u590d\u6742\u7684\u539f\u5b50\u64cd\u4f5c<sup>1</sup>\uff1a\u5982\u81ea\u589e\u64cd\u4f5c\uff0cCAS \u64cd\u4f5c</p> <ul> <li>\u9632\u6b62\u5728\u591a\u4e2a\u5ba2\u6237\u7aef\u5c1d\u8bd5\u540c\u65f6\u5199\u5165\u540c\u4e00\u4e2a\u5bf9\u8c61\u65f6\u4e22\u5931\u66f4\u65b0\uff08\u8bf7\u53c2\u9605 \u201c\u9632\u6b62\u4e22\u5931\u66f4\u65b0\u201d\uff09\uff1b</li> <li>CAS \u4ee5\u53ca\u5176\u4ed6\u5355\u4e00\u5bf9\u8c61\u64cd\u4f5c\u88ab\u79f0\u4e3a \u201c\u8f7b\u91cf\u7ea7\u4e8b\u52a1\u201d\uff0c\u4e0d\u662f\u901a\u5e38\u610f\u4e49\u4e0a\u7684\u4e8b\u52a1\uff1b</li> </ul> <p>\u4e8b\u52a1\u901a\u5e38\u88ab\u7406\u89e3\u4e3a\uff0c\u5c06\u591a\u4e2a\u5bf9\u8c61\u4e0a\u7684\u591a\u4e2a\u64cd\u4f5c\u5408\u5e76\u4e3a\u4e00\u4e2a\u6267\u884c\u5355\u5143\u7684\u673a\u5236\u3002</p>"},{"location":"books/data_intensive_system_book/7_transaction.html#_6","title":"\u591a\u5bf9\u8c61\u4e8b\u52a1\u7684\u9700\u6c42","text":"<p>\u8bb8\u591a\u5206\u5e03\u5f0f\u6570\u636e\u5b58\u50a8\u5df2\u7ecf\u653e\u5f03\u4e86\u591a\u5bf9\u8c61\u4e8b\u52a1\uff0c\u56e0\u4e3a\u591a\u5bf9\u8c61\u4e8b\u52a1\u5f88\u96be\u8de8\u5206\u533a\u5b9e\u73b0\uff0c\u800c\u4e14\u5728\u9700\u8981\u9ad8\u53ef\u7528\u6027\u6216\u9ad8\u6027\u80fd\u7684\u60c5\u51b5\u4e0b\u3002</p> <ul> <li>\u4f46\u5728\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u4e2d\u5b9e\u73b0\u4e8b\u52a1\uff0c\u5e76\u6ca1\u6709\u4ec0\u4e48\u6839\u672c\u6027\u7684\u969c\u788d\u3002\u7b2c\u4e5d\u7ae0 \u5c06\u8ba8\u8bba\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u5b9e\u73b0\u3002</li> </ul> <p>\u8bb8\u591a\u5176\u4ed6\u573a\u666f\u9700\u8981\u534f\u8c03\u5199\u5165\u51e0\u4e2a\u4e0d\u540c\u7684\u5bf9\u8c61\uff1a\u9700\u8981\u591a\u5bf9\u8c61\u4e8b\u52a1</p> <ul> <li>\u5173\u7cfb\u6570\u636e\u6a21\u578b\u4e2d\u7684\u5916\u952e\u5f15\u7528\uff1a\u5f53\u63d2\u5165\u51e0\u4e2a\u76f8\u4e92\u5f15\u7528\u7684\u8bb0\u5f55\u65f6\uff0c\u5916\u952e\u5fc5\u987b\u662f\u6b63\u786e\u7684\u548c\u6700\u65b0\u7684\uff1b</li> <li>\u6587\u6863\u6570\u636e\u6a21\u578b\uff1a\u7f3a\u4e4f\u8fde\u63a5\u529f\u80fd\u7684\u6587\u6863\u6570\u636e\u5e93\u4f1a\u9f13\u52b1\u975e\u89c4\u8303\u5316\uff08\u8bf7\u53c2\u9605 \u201c\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e0e\u6587\u6863\u6570\u636e\u5e93\u5728\u4eca\u65e5\u7684\u5bf9\u6bd4\u201d\uff09\uff1b</li> <li>\u6b21\u7ea7\u7d22\u5f15\u7684\u6570\u636e\u5e93\uff1a\u6bcf\u6b21\u66f4\u6539\u503c\u65f6\u90fd\u9700\u8981\u66f4\u65b0\u7d22\u5f15\uff1b</li> </ul> <p>\u8fd9\u4e9b\u5e94\u7528\u4ecd\u7136\u53ef\u4ee5\u5728\u6ca1\u6709\u4e8b\u52a1\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u3002\u7136\u800c\uff0c\u6ca1\u6709\u539f\u5b50\u6027\uff0c\u9519\u8bef\u5904\u7406\u5c31\u8981\u590d\u6742\u5f97\u591a\uff0c\u7f3a\u4e4f\u9694\u79bb\u6027\uff0c\u5c31\u4f1a\u5bfc\u81f4\u5e76\u53d1\u95ee\u9898\u3002</p> <ul> <li>\u5728 \u201c\u5f31\u9694\u79bb\u7ea7\u522b\u201d \u4e2d\u8ba8\u8bba\u8fd9\u4e9b\u95ee\u9898\uff0c\u5e76\u5728 \u7b2c\u5341\u4e8c\u7ae0 \u4e2d\u63a2\u8ba8\u5176\u4ed6\u65b9\u6cd5\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_7","title":"\u5904\u7406\u9519\u8bef\u548c\u4e2d\u6b62","text":"<p>\u65e0\u4e3b\u590d\u5236 \u7684\u6570\u636e\u5b58\u50a8\uff0c\u4e3b\u8981\u662f\u5728 \u201c\u5c3d\u529b\u800c\u4e3a\u201d \u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u5de5\u4f5c\uff1a</p> <ul> <li>\u4ece\u9519\u8bef\u4e2d\u6062\u590d\u662f\u5e94\u7528\u7a0b\u5e8f\u7684\u8d23\u4efb\uff1a\u6570\u636e\u5e93\u5c06\u505a\u5c3d\u53ef\u80fd\u591a\u7684\u4e8b\uff0c\u8fd0\u884c\u9047\u5230\u9519\u8bef\u65f6\uff0c\u5b83\u4e0d\u4f1a\u64a4\u6d88\u5b83\u5df2\u7ecf\u5b8c\u6210\u7684\u4e8b\u60c5\uff1b</li> </ul> <p>\u9519\u8bef\u53d1\u751f\u4e0d\u53ef\u907f\u514d\uff0c\u4f46\u8bb8\u591a\u8f6f\u4ef6\u5f00\u53d1\u4eba\u5458\u503e\u5411\u4e8e\u53ea\u8003\u8651\u4e50\u89c2\u60c5\u51b5\uff0c\u800c\u4e0d\u662f\u9519\u8bef\u5904\u7406\u7684\u590d\u6742\u6027\uff1a</p> <ul> <li>\u50cf Rails \u7684 ActiveRecord \u548c Django \u8fd9\u6837\u7684 \u5bf9\u8c61\u5173\u7cfb\u6620\u5c04\uff08ORM, object-relation Mapping\uff09 \u6846\u67b6\u4e0d\u4f1a\u91cd\u8bd5\u4e2d\u65ad\u7684\u4e8b\u52a1\uff1b</li> <li>\u4ece\u5806\u6808\u5411\u4e0a\u4f20\u64ad\u7684\u5f02\u5e38\uff0c\u7528\u6237\u62ff\u5230\u4e00\u4e2a\u9519\u8bef\u4fe1\u606f</li> <li>\u4e00\u822c\u7cfb\u7edf\u90fd\u662f\u4e2d\u6b62\u4e8b\u52a1\uff0c\u5e76\u8fd4\u56de\u5f02\u5e38\uff0c\u800c\u4e0d\u662f\u8fdb\u884c\u91cd\u8bd5\uff0c\u662f\u5426\u80fd\u591f\u91cd\u8bd5\u9700\u8981\u5728\u5e94\u7528\u5c42\u505a\u5224\u65ad\uff08\u89c1\u4e0b\u9762\u7684\u7406\u7531\uff09\uff1b</li> </ul> <p>\u5c3d\u7ba1\u91cd\u8bd5\u4e00\u4e2a\u4e2d\u6b62\u7684\u4e8b\u52a1\u662f\u4e00\u4e2a\u7b80\u5355\u800c\u6709\u6548\u7684\u9519\u8bef\u5904\u7406\u673a\u5236\uff0c\u4f46\u5b83\u5e76\u4e0d\u5b8c\u7f8e\uff1a</p> <ul> <li>\u7f51\u7edc\u6545\u969c\u5bfc\u81f4\u6267\u884c\u591a\u6b21\uff1a\u4e8b\u52a1\u6267\u884c\u6210\u529f\u4f46\u670d\u52a1\u5668\u8ddf\u5ba2\u6237\u7aef\u786e\u8ba4\u65f6\u7f51\u7edc\u6545\u969c\uff0c\u5ba2\u6237\u7aef\u8ba4\u4e3a\u63d0\u4ea4\u5931\u8d25\uff0c\u8fdb\u884c\u91cd\u8bd5\uff0c\u5bfc\u81f4\u6267\u884c\u4e24\u6b21\uff1b</li> <li>\u8d1f\u8f7d\u8fc7\u9ad8\uff1a\u5982\u679c\u9519\u8bef\u662f\u7531\u4e8e\u8d1f\u8f7d\u8fc7\u5927\u9020\u6210\u7684\uff0c\u5219\u91cd\u8bd5\u4e8b\u52a1\u5c06\u4f7f\u95ee\u9898\u53d8\u5f97\u66f4\u7cdf\uff0c\u9700\u8981\u9650\u5236\u91cd\u8bd5\u6b21\u6570\uff08\u6307\u6570\u9000\u907f\u7b97\u6cd5\uff09\uff1b</li> <li>\u4ec5\u4e34\u65f6\u6027\u9519\u8bef\u9700\u8981\u91cd\u8bd5\uff1a\u6b7b\u9501\uff0c\u5f02\u5e38\u60c5\u51b5\uff0c\u4e34\u65f6\u6027\u7f51\u7edc\u4e2d\u65ad\u548c\u6545\u969c\u5207\u6362\u7b49\u9519\u8bef\u624d\u503c\u5f97\u91cd\u8bd5\uff0c\u6c38\u4e45\u6027\u9519\u8bef\uff08\u4f8b\u5982\uff0c\u8fdd\u53cd\u7ea6\u675f\uff09\u65e0\u610f\u4e49\uff1b</li> <li>\u5916\u90e8\u7cfb\u7edf\u7684\u526f\u4f5c\u7528\uff1a\u4e8b\u52a1\u5728\u6570\u636e\u5e93\u4e4b\u5916\u6709\u526f\u4f5c\u7528\uff0c\u5982\u679c\u786e\u4fdd\u591a\u4e2a\u4e0d\u540c\u7684\u7cfb\u7edf\u4e00\u8d77\u63d0\u4ea4\u6216\u653e\u5f03\uff0c\u4f7f\u7528\u4e24\u9636\u6bb5\u63d0\u4ea4\uff1b</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_8","title":"\u5f31\u9694\u79bb\u7ea7\u522b","text":"<p>\u5f53\u4e00\u4e2a\u4e8b\u52a1\u8bfb\u53d6\u7531\u53e6\u4e00\u4e2a\u4e8b\u52a1\u540c\u65f6\u4fee\u6539\u7684\u6570\u636e\u65f6\uff0c\u6216\u8005\u5f53\u4e24\u4e2a\u4e8b\u52a1\u8bd5\u56fe\u540c\u65f6\u4fee\u6539\u76f8\u540c\u7684\u6570\u636e\u65f6\uff0c\u5e76\u53d1\u95ee\u9898\uff08\u7ade\u4e89\u6761\u4ef6\uff09\u624d\u4f1a\u51fa\u73b0\u3002</p> <ul> <li>\u5e76\u53d1 BUG \u5728\u7279\u6b8a\u65f6\u5e8f\u4e0b\u624d\u4f1a\u89e6\u53d1\uff0c\u901a\u5e38\u5f88\u96be\u91cd\u73b0<sup>4</sup>\u3002</li> </ul> <p>\u6570\u636e\u5e93\u4e00\u76f4\u8bd5\u56fe\u901a\u8fc7\u63d0\u4f9b \u4e8b\u52a1\u9694\u79bb\uff08transaction isolation\uff09 \u6765\u9690\u85cf\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u8005\u7684\u5e76\u53d1\u95ee\u9898\u3002</p> <ul> <li>\u53ef\u4e32\u884c\u7684\uff08serializable\uff09 \u9694\u79bb\uff1a\u4fdd\u8bc1\u4e8b\u52a1\u7684\u6548\u679c\u5982\u540c\u4e32\u884c\u8fd0\u884c\u4e00\u6837\uff1b</li> <li>\u53ef\u4e32\u884c\u7684\u9694\u79bb \u4f1a\u6709\u6027\u80fd\u635f\u5931\uff0c\u8bb8\u591a\u6570\u636e\u5e93\u4e0d\u613f\u610f\u652f\u4ed8\u8fd9\u4e2a\u4ee3\u4ef7\\(^{[15]}\\)\uff1b</li> </ul> <p>\u7cfb\u7edf\u901a\u5e38\u4f7f\u7528\u8f83\u5f31\u7684\u9694\u79bb\u7ea7\u522b\u6765\u9632\u6b62\u4e00\u90e8\u5206\uff0c\u800c\u4e0d\u662f\u5168\u90e8\u7684\u5e76\u53d1\u95ee\u9898\u3002</p> <ul> <li>\u8fd9\u4e9b\u9694\u79bb\u7ea7\u522b\u96be\u4ee5\u7406\u89e3\uff0c\u5e76\u4e14\u4f1a\u5bfc\u81f4\u5fae\u5999\u7684\u9519\u8bef\uff0c\u4f46\u662f\u5b83\u4eec\u4ecd\u7136\u5728\u5b9e\u8df5\u4e2d\u88ab\u4f7f\u7528\\(^{[16]}\\)</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_9","title":"\u8bfb\u5df2\u63d0\u4ea4","text":"<p>\u6700\u57fa\u672c\u7684\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u662f \u8bfb\u5df2\u63d0\u4ea4\uff08Read Committed\uff09<sup>2</sup></p> <ol> <li>\u4ece\u6570\u636e\u5e93\u8bfb\u65f6\uff0c\u53ea\u80fd\u770b\u5230\u5df2\u63d0\u4ea4\u7684\u6570\u636e\uff08\u6ca1\u6709 \u810f\u8bfb\uff0c\u5373 dirty reads\uff09\u3002</li> <li>\u5199\u5165\u6570\u636e\u5e93\u65f6\uff0c\u53ea\u4f1a\u8986\u76d6\u5df2\u63d0\u4ea4\u7684\u6570\u636e\uff08\u6ca1\u6709 \u810f\u5199\uff0c\u5373 dirty writes\uff09\u3002</li> </ol>"},{"location":"books/data_intensive_system_book/7_transaction.html#_10","title":"\u6ca1\u6709\u810f\u8bfb","text":"<p>\u810f\u8bfb\uff08dirty reads\uff09\\(^{[17]}\\)\uff1a\u4e00\u4e2a\u4e8b\u52a1\u5df2\u7ecf\u5c06\u4e00\u4e9b\u6570\u636e\u5199\u5165\u6570\u636e\u5e93\uff0c\u4f46\u4e8b\u52a1\u8fd8\u6ca1\u6709\u63d0\u4ea4\u6216\u4e2d\u6b62\u3002\u53e6\u4e00\u4e2a\u4e8b\u52a1\u53ef\u4ee5\u770b\u5230\u672a\u63d0\u4ea4\u7684\u6570\u636e\u3002</p> <p>\u5728 \u8bfb\u5df2\u63d0\u4ea4 \u9694\u79bb\u7ea7\u522b\u8fd0\u884c\u7684\u4e8b\u52a1\u5fc5\u987b\u9632\u6b62\u810f\u8bfb\uff1a</p> <ul> <li>\u4e8b\u52a1\u7684\u4efb\u4f55\u5199\u5165\u64cd\u4f5c\u53ea\u6709\u5728\u8be5\u4e8b\u52a1\u63d0\u4ea4\u65f6\u624d\u80fd\u88ab\u5176\u4ed6\u4eba\u770b\u5230\uff08\u7136\u540e\u6240\u6709\u7684\u5199\u5165\u64cd\u4f5c\u90fd\u4f1a\u7acb\u5373\u53d8\u5f97\u53ef\u89c1\uff09</li> <li>\u4e0b\u56fe 7-4 \u662f\u793a\u4f8b\uff0cUser 1 \u672a commit \u4e4b\u524d\uff0cUser 2 \u770b\u5230\u7684 x \u7684\u503c\u6c38\u8fdc\u662f 2\uff1b</li> </ul> <p></p> <p>\u9632\u6b62\u810f\u8bfb\u7684\u539f\u56e0\uff1a</p> <ul> <li>\u90e8\u5206\u66f4\u65b0\uff1a\u5982\u679c\u4e8b\u52a1\u9700\u8981\u66f4\u65b0\u591a\u4e2a\u5bf9\u8c61\uff0c\u810f\u8bfb\u53d6\u610f\u5473\u7740\u53e6\u4e00\u4e2a\u4e8b\u52a1\u53ef\u80fd\u4f1a\u53ea\u770b\u5230\u4e00\u90e8\u5206\u66f4\u65b0\u3002</li> <li>\u90e8\u5206\u66f4\u65b0\u72b6\u6001\u7684\u6570\u636e\u5e93\u4f1a\u8ba9\u7528\u6237\u56f0\u60d1\uff0c\u5e76\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u4e8b\u52a1\u505a\u51fa\u9519\u8bef\u7684\u51b3\u5b9a\uff1b</li> <li>\u56de\u6eda\uff1a\u5982\u679c\u4e8b\u52a1\u4e2d\u6b62\uff0c\u5219\u6240\u6709\u5199\u5165\u64cd\u4f5c\u90fd\u9700\u8981\u56de\u6eda\uff1b</li> <li>\u5141\u8bb8\u810f\u8bfb\uff0c\u90a3\u5c31\u610f\u5473\u7740\u4e00\u4e2a\u4e8b\u52a1\u53ef\u80fd\u4f1a\u770b\u5230\u7a0d\u540e\u9700\u8981\u56de\u6eda\u7684\u6570\u636e\uff0c\u5373\u4ece\u672a\u5b9e\u9645\u63d0\u4ea4\u7ed9\u6570\u636e\u5e93\u7684\u6570\u636e\uff1b</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_11","title":"\u6ca1\u6709\u810f\u5199","text":"<p>\u810f\u5199\uff08dirty write\uff09\\(^{[18]}\\)\uff1a\u5148\u524d\u7684\u5199\u5165\u662f\u5c1a\u672a\u63d0\u4ea4\u4e8b\u52a1\u7684\u4e00\u90e8\u5206\uff0c\u4f7f\u5f97\u540e\u9762\u7684\u5199\u5165\u8986\u76d6\u4e86\u4e00\u4e2a\u5c1a\u672a\u63d0\u4ea4\u7684\u503c\u3002</p> <p>\u5728 \u8bfb\u5df2\u63d0\u4ea4 \u7684\u9694\u79bb\u7ea7\u522b\u4e0a\u8fd0\u884c\u7684\u4e8b\u52a1\u5fc5\u987b\u9632\u6b62\u810f\u5199\uff0c\u901a\u5e38\u662f\u5ef6\u8fdf\u7b2c\u4e8c\u6b21\u5199\u5165\uff0c\u76f4\u5230\u7b2c\u4e00\u6b21\u5199\u5165\u4e8b\u52a1\u63d0\u4ea4\u6216\u4e2d\u6b62\u4e3a\u6b62\u3002</p> <p>\u810f\u5199\u9632\u6b62\u7684\u95ee\u9898\uff1a</p> <ul> <li>\u5982\u679c\u4e8b\u52a1\u66f4\u65b0\u591a\u4e2a\u5bf9\u8c61\uff0c\u810f\u5199\u4f1a\u5bfc\u81f4\u4e0d\u597d\u7684\u7ed3\u679c\uff1a\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u51fa\u73b0\u9500\u552e\u662f\u5c5e\u4e8e Bob \u7684\uff08\u56e0\u4e3a\u4ed6\u6210\u529f\u66f4\u65b0\u4e86\u5546\u54c1\u5217\u8868\uff09\uff0c\u4f46\u53d1\u7968\u5374\u5bc4\u9001\u7ed9\u4e86 Alice\uff08\u56e0\u4e3a\u5979\u6210\u529f\u66f4\u65b0\u4e86\u53d1\u7968\u8868\uff09\u7684\u95ee\u9898\u3002</li> </ul> <p></p> <p>\u810f\u5199\u4e0d\u80fd\u89e3\u51b3\u4e4b\u524d\u9694\u79bb\u6027\u4e2d\u63d0\u5230\u7684\u4e24\u4e2a\u8ba1\u6570\u5668\u589e\u91cf\u4e4b\u95f4\u7684\u7ade\u4e89\u72b6\u6001\uff1a</p> <ul> <li>\u7b2c\u4e8c\u6b21\u5199\u5165\u53d1\u751f\u5728\u7b2c\u4e00\u4e2a\u4e8b\u52a1\u63d0\u4ea4\u540e\uff0c\u6240\u4ee5\u5b83\u4e0d\u662f\u4e00\u4e2a\u810f\u5199\uff0c\u4f46\u662f\u503c\u6ca1\u6709\u6b63\u786e\u8ba1\u7b97\uff1b</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_12","title":"\u5b9e\u73b0\u8bfb\u5df2\u63d0\u4ea4","text":"<p>\u8bfb\u5df2\u63d0\u4ea4 \u662f\u4e00\u4e2a\u975e\u5e38\u6d41\u884c\u7684\u9694\u79bb\u7ea7\u522b\u3002\u8fd9\u662f Oracle 11g\u3001PostgreSQL\u3001SQL Server 2012\u3001MemSQL \u548c\u5176\u4ed6\u8bb8\u591a\u6570\u636e\u5e93\u7684\u9ed8\u8ba4\u8bbe\u7f6e\\(^{[15]}\\)\u3002</p> <p>\u6570\u636e\u5e93\u901a\u8fc7\u4f7f\u7528 \u884c\u9501\uff08row-level lock\uff09 \u6765\u9632\u6b62\u810f\u5199\uff1a</p> <ul> <li>\u4e8b\u52a1\u60f3\u8981\u4fee\u6539\u7279\u5b9a\u5bf9\u8c61\uff08\u884c\u6216\u6587\u6863\uff09\u65f6\uff0c\u5148\u83b7\u5f97\u8be5\u5bf9\u8c61\u7684\u9501\u3002\u7136\u540e\u5fc5\u987b\u6301\u6709\u8be5\u9501\u76f4\u5230\u4e8b\u52a1\u88ab\u63d0\u4ea4\u6216\u4e2d\u6b62\uff1b</li> <li>\u5982\u679c\u53e6\u4e00\u4e2a\u4e8b\u52a1\u8981\u5199\u5165\u540c\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5219\u5fc5\u987b\u7b49\u5230\u7b2c\u4e00\u4e2a\u4e8b\u52a1\u63d0\u4ea4\u6216\u4e2d\u6b62\u540e\uff0c\u624d\u80fd\u83b7\u53d6\u8be5\u9501\u5e76\u7ee7\u7eed\u3002</li> </ul> <p>\u9632\u6b62\u810f\u8bfb\uff1a\u8981\u6c42\u8bfb\u9501\u4f1a\u5f71\u54cd\u6027\u80fd\uff0c\u56e0\u6b64\u591a\u6570\u6570\u636e\u5e93\u4f7f\u7528\u56fe 7-4 \u7684\u65b9\u5f0f\u9632\u6b62\u810f\u8bfb</p> <ul> <li>\u5bf9\u4e8e\u5199\u5165\u7684\u6bcf\u4e2a\u5bf9\u8c61\uff0c\u6570\u636e\u5e93\u90fd\u4f1a\u8bb0\u4f4f\u65e7\u7684\u5df2\u63d0\u4ea4\u503c\uff0c\u548c\u7531\u5f53\u524d\u6301\u6709\u5199\u5165\u9501\u7684\u4e8b\u52a1\u8bbe\u7f6e\u7684\u65b0\u503c</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_13","title":"\u5feb\u7167\u9694\u79bb\u548c\u53ef\u91cd\u590d\u8bfb","text":"<p>\u8bfb\u5df2\u63d0\u4ea4\u9694\u79bb\u7ea7\u522b\uff0c\u4ecd\u7136\u6709\u5f88\u591a\u5730\u65b9\u53ef\u80fd\u4f1a\u4ea7\u751f\u5e76\u53d1\u9519\u8bef\u3002</p> <ul> <li>\u4e0b\u56fe 7- 6 \u8bf4\u660e\u4e86\u8bfb\u5df2\u63d0\u4ea4\u65f6\u53ef\u80fd\u53d1\u751f\u7684\u95ee\u9898\uff1aAlice\u4e24\u4e2a\u8d26\u6237\u5404500 \u7f8e\u5143\uff0c\u6709\u4e00\u7b14\u4e8b\u52a1\u4ece\u5979\u7684\u4e00\u4e2a\u8d26\u6237\u8f6c\u79fb\u4e86 100 \u7f8e\u5143\u5230\u53e6\u4e00\u4e2a\u8d26\u6237</li> <li>\u5728\u6536\u5230\u4ed8\u6b3e\u4e4b\u524d\u5148\u770b\u5230\u4e00\u4e2a\u8d26\u6237\u7684\u4f59\u989d\uff08\u6536\u6b3e\u8d26\u6237\uff0c\u4f59\u989d\u4ecd\u4e3a 500 \u7f8e\u5143\uff09\uff0c\u5728\u53d1\u51fa\u8f6c\u8d26\u4e4b\u540e\u518d\u770b\u5230\u53e6\u4e00\u4e2a\u8d26\u6237\u7684\u4f59\u989d\uff08\u4ed8\u6b3e\u8d26\u6237\uff0c\u65b0\u4f59\u989d\u4e3a 400 \u7f8e\u5143\uff09</li> <li>\u5bf9 Alice \u6765\u8bf4\uff0c\u73b0\u5728\u5979\u7684\u8d26\u6237\u4f3c\u4e4e\u603b\u5171\u53ea\u6709 900 \u7f8e\u5143</li> </ul> <p></p> <p>\u4e0d\u53ef\u91cd\u590d\u8bfb\uff08nonrepeatable read\uff09 \u6216 \u8bfb\u53d6\u504f\u5dee\uff08read skew\uff09\uff1a\u5728\u4e00\u4e2a\u4e8b\u52a1\u4e2d\uff0c\u8bfb\u53d6\u4e86\u5176\u4ed6\u4e8b\u52a1\u66f4\u6539\u7684\u6570\u636e\uff0c\u9488\u5bf9update\u64cd\u4f5c</p> <ul> <li>\u5982\u679c Alice \u5728\u4e8b\u52a1\u7ed3\u675f\u65f6\u518d\u6b21\u8bfb\u53d6\u8d26\u6237 1 \u7684\u4f59\u989d\uff0c\u5979\u5c06\u770b\u5230\u4e0e\u5979\u4e4b\u524d\u7684\u67e5\u8be2\u4e2d\u770b\u5230\u7684\u4e0d\u540c\u7684\u503c\uff08600 \u7f8e\u5143\uff09\u3002</li> </ul> <p>\u5728\u8bfb\u5df2\u63d0\u4ea4\u7684\u9694\u79bb\u6761\u4ef6\u4e0b\uff0c\u4e0d\u53ef\u91cd\u590d\u8bfb \u88ab\u8ba4\u4e3a\u662f\u53ef\u63a5\u53d7\u7684\uff0c\u4f46\u6709\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4e0d\u80fd\u5bb9\u5fcd\u8fd9\u79cd\u6682\u65f6\u7684\u4e0d\u4e00\u81f4\uff1a</p> <ul> <li>\u5907\u4efd\uff1a\u5907\u4efd\u8fdb\u7a0b\u8fd0\u884c\u65f6\uff0c\u6570\u636e\u5e93\u4ecd\u7136\u4f1a\u63a5\u53d7\u5199\u5165\u64cd\u4f5c\u3002\u56e0\u6b64\u5907\u4efd\u53ef\u80fd\u4f1a\u5305\u542b\u4e00\u4e9b\u65e7\u7684\u90e8\u5206\u548c\u4e00\u4e9b\u65b0\u7684\u90e8\u5206\uff0c\u5907\u4efd\u6570\u636e\u6062\u590d\u65f6\uff0c\u4e0d\u4e00\u81f4\u5c31\u4f1a\u53d8\u6210\u6c38\u4e45\uff1b</li> <li>\u5206\u6790\u67e5\u8be2\u548c\u5b8c\u6574\u6027\u68c0\u67e5\uff1a\u4e00\u4e2a\u67e5\u8be2\uff0c\u626b\u63cf\u5927\u90e8\u5206\u7684\u6570\u636e\u5e93\u6216\u8005\u5b9a\u671f\u5b8c\u6574\u6027\u68c0\u67e5\uff08\u5373\u76d1\u89c6\u6570\u636e\u635f\u574f\uff09\u7684\u4e00\u90e8\u5206\uff0c\u5982\u679c\u5728\u4e0d\u540c\u65f6\u95f4\u70b9\u89c2\u5bdf\u6570\u636e\u5e93\u7684\u4e0d\u540c\u90e8\u5206\uff0c\u5219\u53ef\u80fd\u4f1a\u8fd4\u56de\u6ca1\u6709\u610f\u4e49\u7684\u7ed3\u679c\uff1b</li> </ul> <p>\u5feb\u7167\u9694\u79bb\uff08snapshot isolation\uff09\\(^{[18]}\\)\u662f\u89e3\u51b3\u4e0d\u53ef\u91cd\u590d\u8bfb\u7684\u65b9\u6848\uff1a\u6bcf\u4e2a\u4e8b\u52a1\u90fd\u4ece\u6570\u636e\u5e93\u7684 \u4e00\u81f4\u5feb\u7167\uff08consistent snapshot\uff09 \u4e2d\u8bfb\u53d6</p> <ul> <li> <p>\u4e8b\u52a1\u53ef\u4ee5\u770b\u5230\u4e8b\u52a1\u5f00\u59cb\u65f6\u5728\u6570\u636e\u5e93\u4e2d\u63d0\u4ea4\u7684\u6240\u6709\u6570\u636e\u3002\u5373\u4f7f\u8fd9\u4e9b\u6570\u636e\u968f\u540e\u88ab\u53e6\u4e00\u4e2a\u4e8b\u52a1\u66f4\u6539\uff0c\u6bcf\u4e2a\u4e8b\u52a1\u4e5f\u53ea\u80fd\u770b\u5230\u8be5\u7279\u5b9a\u65f6\u95f4\u70b9\u7684\u65e7\u6570\u636e\u3002</p> </li> <li> <p>\u5feb\u7167\u9694\u79bb\u662f\u4e00\u4e2a\u6d41\u884c\u7684\u529f\u80fd\uff1aPostgreSQL\u3001\u4f7f\u7528 InnoDB \u5f15\u64ce\u7684 MySQL\u3001Oracle\u3001SQL Server \u7b49\u90fd\u652f\u6301\uff1b</p> </li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_14","title":"\u5b9e\u73b0\u5feb\u7167\u9694\u79bb","text":"<p>\u5feb\u7167\u9694\u79bb\u7684\u4e00\u4e2a\u5173\u952e\u539f\u5219\uff1a\u8bfb\u4e0d\u963b\u585e\u5199\uff0c\u5199\u4e0d\u963b\u585e\u8bfb\uff1a</p> <ul> <li>\u901a\u5e38\u4f7f\u7528\u5199\u9501\u6765\u9632\u6b62\u810f\u5199\uff0c\u8bfb\u53d6\u4e0d\u9700\u8981\u52a0\u9501\uff1b</li> <li>\u5728\u5904\u7406\u4e00\u81f4\u6027\u5feb\u7167\u4e0a\u7684\u957f\u65f6\u95f4\u67e5\u8be2\u65f6\uff0c\u53ef\u4ee5\u6b63\u5e38\u5730\u540c\u65f6\u5904\u7406\u5199\u5165\u64cd\u4f5c\uff0c\u4e14\u4e24\u8005\u95f4\u6ca1\u6709\u4efb\u4f55\u9501\u4e89\u7528</li> </ul> <p>\u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236\uff08MVCC, multi-version concurrency control\uff09</p> <ul> <li>\u6570\u636e\u5e93\u5fc5\u987b\u53ef\u80fd\u4fdd\u7559\u4e00\u4e2a\u5bf9\u8c61\u7684\u51e0\u4e2a\u4e0d\u540c\u7684\u63d0\u4ea4\u7248\u672c\uff1b</li> <li>\u5b9e\u73b0\u63d0\u4f9b \u8bfb\u5df2\u63d0\u4ea4 \u7684\u9694\u79bb\u7ea7\u522b\uff0c\u800c\u4e0d\u63d0\u4f9b \u5feb\u7167\u9694\u79bb\uff0c\u90a3\u4e48\u4fdd\u7559\u4e00\u4e2a\u5bf9\u8c61\u7684\u4e24\u4e2a\u7248\u672c\u5c31\u8db3\u591f\uff1b</li> </ul> <p>\u4e0b\u56fe\u8bf4\u660e PostgreSQL \u5982\u4f55\u5b9e\u73b0\u57fa\u4e8e MVCC \u7684\u5feb\u7167\u9694\u79bb\\(^{[19]}\\)\uff1a</p> <ul> <li>\u5f53\u4e00\u4e2a\u4e8b\u52a1\u5f00\u59cb\u65f6\uff0c\u5b83\u88ab\u8d4b\u4e88\u4e00\u4e2a\u552f\u4e00\u7684\u6c38\u8fdc\u589e\u957f<sup>5</sup>\u7684\u4e8b\u52a1 ID\uff08<code>txid</code>\uff09\uff1a\u5f53\u4e8b\u52a1\u5411\u6570\u636e\u5e93\u5199\u5165\u65f6\uff0c\u5b83\u6240\u5199\u5165\u7684\u6570\u636e\u90fd\u4f1a\u88ab\u6807\u8bb0\u4e0a\u5199\u5165\u8005\u7684\u4e8b\u52a1 ID\u3002</li> <li>\u5f53\u4e8b\u52a1 12 \u4ece\u8d26\u6237 2 \u8bfb\u53d6\u65f6\uff0c\u5b83\u4f1a\u770b\u5230 $500 \u7684\u4f59\u989d\uff0c\u4e8b\u52a1 12 \u770b\u4e0d\u5230\u4e8b\u52a1 13 \u6267\u884c\u7684\u5220\u9664\uff08\u89c1\u4e0b\u9762\u7684\u53ef\u89c1\u6027\u89c4\u5219\uff09</li> </ul> <p></p> <p>\u8868\u4e2d\u7684\u6bcf\u884c\u90fd\u4f1a\u6709<code>created_by</code>\u548c<code>deleted_by</code>\u5b57\u6bb5<sup>3</sup>\uff1a</p> <ul> <li><code>created_by</code> \uff1a\u5176\u4e2d\u5305\u542b\u5c06\u8be5\u884c\u63d2\u5165\u5230\u8868\u4e2d\u7684\u7684\u4e8b\u52a1 ID\uff1b</li> <li><code>deleted_by</code>\uff1a\u6700\u521d\u662f\u7a7a\u7684\uff0c\u5c06 <code>deleted_by</code> \u5b57\u6bb5\u8bbe\u7f6e\u4e3a\u8bf7\u6c42\u5220\u9664\u7684\u4e8b\u52a1\u7684 ID \u6765\u6807\u8bb0\u4e3a\u5220\u9664\uff1b</li> <li>\u5f53\u786e\u5b9a\u6ca1\u6709\u4e8b\u52a1\u53ef\u4ee5\u518d\u8bbf\u95ee\u5df2\u5220\u9664\u7684\u6570\u636e\u65f6\uff0c\u6570\u636e\u5e93\u4e2d\u7684\u5783\u573e\u6536\u96c6\u8fc7\u7a0b\u4f1a\u5c06\u6240\u6709\u5e26\u6709\u5220\u9664\u6807\u8bb0\u7684\u884c\u79fb\u9664\uff0c\u5e76\u91ca\u653e\u5176\u7a7a\u95f4</li> <li>UPDATE \u64cd\u4f5c\u5728\u5185\u90e8\u7ffb\u8bd1\u4e3a DELETE \u548c INSERT\uff1b</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_15","title":"\u89c2\u5bdf\u4e00\u81f4\u6027\u5feb\u7167\u7684\u53ef\u89c1\u6027\u89c4\u5219","text":"<p>\u5f53\u4e00\u4e2a\u4e8b\u52a1\u4ece\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u65f6\uff0c\u4e8b\u52a1 ID \u7528\u4e8e\u51b3\u5b9a\u5b83\u53ef\u4ee5\u770b\u89c1\u54ea\u4e9b\u5bf9\u8c61\uff0c\u770b\u4e0d\u89c1\u54ea\u4e9b\u5bf9\u8c61\u3002\u4e00\u81f4\u7684\u6570\u636e\u5e93\u5feb\u7167\u7684\u53ef\u89c1\u6027\u89c4\u5219\u5982\u4e0b\uff1a</p> <ol> <li>\u5728\u6bcf\u6b21\u4e8b\u52a1\u5f00\u59cb\u65f6\uff0c\u6570\u636e\u5e93\u5217\u51fa\u5f53\u65f6\u6240\u6709\u5176\u4ed6\uff08\u5c1a\u672a\u63d0\u4ea4\u6216\u5c1a\u672a\u4e2d\u6b62\uff09\u7684\u4e8b\u52a1\u6e05\u5355\uff0c\u5373\u4f7f\u4e4b\u540e\u63d0\u4ea4\u4e86\uff0c\u8fd9\u4e9b\u4e8b\u52a1\u5df2\u6267\u884c\u7684\u4efb\u4f55\u5199\u5165\u4e5f\u90fd\u4f1a\u88ab\u5ffd\u7565\uff1b</li> <li>\u88ab\u4e2d\u6b62\u4e8b\u52a1\u6240\u6267\u884c\u7684\u4efb\u4f55\u5199\u5165\u90fd\u5c06\u88ab\u5ffd\u7565\uff1b</li> <li>\u7531\u5177\u6709\u8f83\u665a\u4e8b\u52a1 ID\uff08\u5373\uff0c\u5728\u5f53\u524d\u4e8b\u52a1\u5f00\u59cb\u4e4b\u540e\u5f00\u59cb\u7684\uff09\u7684\u4e8b\u52a1\u6240\u505a\u7684\u4efb\u4f55\u5199\u5165\u90fd\u88ab\u5ffd\u7565\uff0c\u800c\u4e0d\u7ba1\u8fd9\u4e9b\u4e8b\u52a1\u662f\u5426\u5df2\u7ecf\u63d0\u4ea4\uff1b</li> <li>\u6240\u6709\u5176\u4ed6\u5199\u5165\uff0c\u5bf9\u5e94\u7528\u90fd\u662f\u53ef\u89c1\u7684\u3002</li> </ol> <p>\u8fd9\u4e9b\u89c4\u5219\u9002\u7528\u4e8e\u521b\u5efa\u548c\u5220\u9664\u5bf9\u8c61\u3002</p> <p>\u7531\u4e8e\u4ece\u6765\u4e0d\u539f\u5730\u66f4\u65b0\u503c\uff0c\u800c\u662f\u6bcf\u6b21\u503c\u6539\u53d8\u65f6\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7248\u672c\uff0c\u6570\u636e\u5e93\u53ef\u4ee5\u5728\u63d0\u4f9b\u4e00\u81f4\u5feb\u7167\u7684\u540c\u65f6\u53ea\u4ea7\u751f\u5f88\u5c0f\u7684\u989d\u5916\u5f00\u9500\u3002</p>"},{"location":"books/data_intensive_system_book/7_transaction.html#_16","title":"\u7d22\u5f15\u548c\u5feb\u7167\u9694\u79bb","text":"<p>\u7d22\u5f15\u5982\u4f55\u5728\u591a\u7248\u672c\u6570\u636e\u5e93\u4e2d\u5de5\u4f5c</p> <p>\u7b2c\u4e00\u79cd\u65b9\u6848\uff1a\u7d22\u5f15\u7b80\u5355\u5730\u6307\u5411\u5bf9\u8c61\u7684\u6240\u6709\u7248\u672c</p> <ul> <li>\u9700\u8981\u7d22\u5f15\u67e5\u8be2\u6765\u8fc7\u6ee4\u6389\u5f53\u524d\u4e8b\u52a1\u4e0d\u53ef\u89c1\u7684\u4efb\u4f55\u5bf9\u8c61\u7248\u672c\uff1b\u5f53\u5783\u573e\u6536\u96c6\u5220\u9664\u4efb\u4f55\u4e8b\u52a1\u4e0d\u518d\u53ef\u89c1\u7684\u65e7\u5bf9\u8c61\u7248\u672c\u65f6\uff0c\u76f8\u5e94\u7684\u7d22\u5f15\u6761\u76ee\u4e5f\u53ef\u4ee5\u88ab\u5220\u9664\uff1b</li> <li>\u5982\u679c\u540c\u4e00\u5bf9\u8c61\u7684\u4e0d\u540c\u7248\u672c\u53ef\u4ee5\u653e\u5165\u540c\u4e00\u4e2a\u9875\u9762\u4e2d\uff0cPostgreSQL \u7684\u4f18\u5316\u53ef\u4ee5\u907f\u514d\u66f4\u65b0\u7d22\u5f15\\(^{[19]}\\)\u3002</li> </ul> <p>\u7b2c\u4e8c\u79cd\u65b9\u6848\uff1a\u4ec5\u8ffd\u52a0 / \u5199\u65f6\u62f7\u8d1d\uff08append-only/copy-on-write\uff09 \u7684\u53d8\u4f53\uff0c\u5728 CouchDB\u3001Datomic \u548c LMDB \u4e2d\u4f7f\u7528</p> <ul> <li>\u5728\u66f4\u65b0\u65f6\u4e0d\u8986\u76d6\u6811\u7684\u9875\u9762\uff0c\u800c\u4e3a\u6bcf\u4e2a\u4fee\u6539\u9875\u9762\u521b\u5efa\u4e00\u4efd\u526f\u672c\uff1b\u4ece\u7236\u9875\u9762\u76f4\u5230\u6811\u6839\u90fd\u4f1a\u7ea7\u8054\u66f4\u65b0\uff0c\u4ee5\u6307\u5411\u5b83\u4eec\u5b50\u9875\u9762\u7684\u65b0\u7248\u672c\u3002</li> <li>\u4efb\u4f55\u4e0d\u53d7\u5199\u5165\u5f71\u54cd\u7684\u9875\u9762\u90fd\u4e0d\u9700\u8981\u88ab\u590d\u5236\uff0c\u5e76\u4e14\u4fdd\u6301\u4e0d\u53d8\\(^{[20-22]}\\)</li> </ul> <p>\u4f7f\u7528\u4ec5\u8ffd\u52a0\u7684 B \u6811 \u65f6\uff1a</p> <ul> <li>\u6bcf\u4e2a\u5199\u5165\u4e8b\u52a1\uff08\u6216\u4e00\u6279\u4e8b\u52a1\uff09\u90fd\u4f1a\u521b\u5efa\u4e00\u68f5\u65b0\u7684 B \u6811\uff0c\u5f53\u521b\u5efa\u65f6\uff0c\u4ece\u8be5\u7279\u5b9a\u6811\u6839\u751f\u957f\u7684\u6811\u5c31\u662f\u6570\u636e\u5e93\u7684\u4e00\u4e2a\u4e00\u81f4\u6027\u5feb\u7167\uff1b</li> <li>\u6ca1\u5fc5\u8981\u6839\u636e\u4e8b\u52a1 ID \u8fc7\u6ee4\u6389\u5bf9\u8c61\uff0c\u56e0\u4e3a\u540e\u7eed\u5199\u5165\u4e0d\u80fd\u4fee\u6539\u73b0\u6709\u7684 B \u6811\uff1b\u5b83\u4eec\u53ea\u80fd\u521b\u5efa\u65b0\u7684\u6811\u6839\uff1b</li> <li>\u9700\u8981\u4e00\u4e2a\u8d1f\u8d23\u538b\u7f29\u548c\u5783\u573e\u6536\u96c6\u7684\u540e\u53f0\u8fdb\u7a0b\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_17","title":"\u53ef\u91cd\u590d\u8bfb\u4e0e\u547d\u540d\u6df7\u6dc6","text":"<p>\u5feb\u7167\u9694\u79bb\u5728 Oracle \u4e2d\u79f0\u4e3a \u53ef\u4e32\u884c\u5316\uff08Serializable\uff09 \u7684\uff0c\u5728 PostgreSQL \u548c MySQL \u4e2d\u79f0\u4e3a \u53ef\u91cd\u590d\u8bfb\uff08repeatable read\uff09\u3002</p>"},{"location":"books/data_intensive_system_book/7_transaction.html#_18","title":"\u9632\u6b62\u4e22\u5931\u66f4\u65b0","text":"<p>\u5e76\u53d1\u7684\u5199\u5165\u4e8b\u52a1\u4e4b\u95f4\u6709\u51e0\u79cd\u6709\u8da3\u7684\u51b2\u7a81\u3002\u5176\u4e2d\u6700\u8457\u540d\u7684\u662f \u4e22\u5931\u66f4\u65b0\uff08lost update\uff09 \u95ee\u9898\uff0c\u5982\u56fe 7-1 \u7684\u4e24\u4e2a\u5e76\u53d1\u8ba1\u6570\u5668\u7684\u589e\u91cf\u7684\u4f8b\u5b50\uff1a</p> <ul> <li>\u5e94\u7528\u5c42\u7684\u6bcf\u4e2a\u4e8b\u52a1\u90fd\u662f\uff1a\u8bfb\u53d6 - \u4fee\u6539 - \u5199\u5165\u5e8f\u5217\uff0c\u5728\u591a\u7ebf\u7a0b\u5f00\u53d1\u4e2d\u8fd9\u662f\u4e2a\u57fa\u672c\u7684\u5e76\u53d1\u51b2\u7a81\u95ee\u9898\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_19","title":"\u539f\u5b50\u5199","text":"<p>\u6570\u636e\u5e93\u63d0\u4f9b\u4e86\u539f\u5b50\u66f4\u65b0\u64cd\u4f5c\uff0c\u4ece\u800c\u6d88\u9664\u4e86\u5728\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u4e2d\u6267\u884c\u8bfb\u53d6 - \u4fee\u6539 - \u5199\u5165\u5e8f\u5217\u7684\u9700\u8981\uff1a</p> <ul> <li>\u4e0b\u9762\u7684\u6307\u4ee4\u5728\u5927\u591a\u6570\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u662f\u5e76\u53d1\u5b89\u5168</li> </ul> <pre><code>UPDATE counters SET value = value + 1 WHERE key = 'foo';\n</code></pre> <ul> <li>\u539f\u5b50\u64cd\u4f5c\u901a\u5e38\u901a\u8fc7\u5728\u8bfb\u53d6\u5bf9\u8c61\u65f6\uff0c\u83b7\u53d6\u5176\u4e0a\u7684\u6392\u5b83\u9501\u6765\u5b9e\u73b0\uff0c\u66f4\u65b0\u5b8c\u6210\u4e4b\u524d\u6ca1\u6709\u5176\u4ed6\u4e8b\u52a1\u53ef\u4ee5\u8bfb\u53d6\u5b83\uff1b</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_20","title":"\u663e\u5f0f\u9501\u5b9a","text":"<p>\u6709\u4e9b\u60c5\u51b5\u9700\u8981\u5e94\u7528\u7a0b\u5e8f\u663e\u5f0f\u5730\u9501\u5b9a\u5c06\u8981\u66f4\u65b0\u7684\u5bf9\u8c61\uff1a\u5982<code>\u8bfb\u53d6-&gt;\u5224\u65ad-&gt;\u4fee\u6539-&gt;\u5199\u5165</code>\u7684\u903b\u8f91</p> <ul> <li> <p>\u5982\u591a\u4eba\u6e38\u620f\u4e2d\u9632\u6b62\u4e24\u4e2a\u4eba\u540c\u65f6\u79fb\u52a8\u540c\u4e00\u4e2a\u68cb\u5b50\uff1a\u9700\u8981\u8fdb\u884c\u4e00\u4e9b\u903b\u8f91\u5224\u65ad\uff0c\u5fc5\u987b\u901a\u8fc7\u4e8b\u52a1\u8fdb\u884c\uff0c\u4e0d\u80fd\u4f7f\u7528\u5355\u4e2a\u7684\u539f\u5b50\u64cd\u4f5c\uff1b</p> </li> <li> <p>\u663e\u5f0f\u9501\u5b9a\u884c\u4ee5\u9632\u6b62\u4e22\u5931\u66f4\u65b0\uff1a<code>FOR UPDATE</code> \u5b50\u53e5\u544a\u8bc9\u6570\u636e\u5e93\u5e94\u8be5\u5bf9\u8be5\u67e5\u8be2\u8fd4\u56de\u7684\u6240\u6709\u884c\u52a0\u9501</p> </li> </ul> <pre><code>BEGIN TRANSACTION;\nSELECT * FROM figures\n  WHERE name = 'robot' AND game_id = 222\nFOR UPDATE;\n\n-- \u68c0\u67e5\u73a9\u5bb6\u7684\u64cd\u4f5c\u662f\u5426\u6709\u6548\uff0c\u7136\u540e\u66f4\u65b0\u5148\u524d SELECT \u8fd4\u56de\u68cb\u5b50\u7684\u4f4d\u7f6e\u3002\nUPDATE figures SET position = 'c4' WHERE id = 1234;\nCOMMIT;\n</code></pre> <ul> <li>\u9700\u8981\u4ed4\u7ec6\u8003\u8651\u5e94\u7528\u903b\u8f91\u3002\u5fd8\u8bb0\u5728\u4ee3\u7801\u67d0\u5904\u52a0\u9501\u5f88\u5bb9\u6613\u5f15\u5165\u7ade\u4e89\u6761\u4ef6\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_21","title":"\u81ea\u52a8\u68c0\u6d4b\u4e22\u5931\u7684\u66f4\u65b0","text":"<p>\u539f\u5b50\u64cd\u4f5c\u548c\u9501\u662f\u901a\u8fc7\u5f3a\u5236 \u8bfb\u53d6 - \u4fee\u6539 - \u5199\u5165\u5e8f\u5217 \u6309\u987a\u5e8f\u53d1\u751f\uff0c\u6765\u9632\u6b62\u4e22\u5931\u66f4\u65b0\u7684\u65b9\u6cd5\u3002</p> <p>\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u5141\u8bb8\u5b83\u4eec\u5e76\u884c\u6267\u884c\uff0c\u5982\u679c\u4e8b\u52a1\u7ba1\u7406\u5668\u68c0\u6d4b\u5230\u4e22\u5931\u66f4\u65b0\uff0c\u5219\u4e2d\u6b62\u4e8b\u52a1\u5e76\u5f3a\u5236\u5b83\u4eec\u91cd\u8bd5\u5176 \u8bfb\u53d6 - \u4fee\u6539 - \u5199\u5165\u5e8f\u5217\u3002</p> <ul> <li>\u6570\u636e\u5e93\u53ef\u4ee5\u7ed3\u5408\u5feb\u7167\u9694\u79bb\u9ad8\u6548\u5730\u6267\u884c\u6b64\u68c0\u67e5</li> <li>\u5982 PostgreSQL \u7684\u53ef\u91cd\u590d\u8bfb\uff0cOracle \u7684\u53ef\u4e32\u884c\u5316\u90fd\u4f1a\u81ea\u52a8\u68c0\u6d4b\u5230\u4e22\u5931\u66f4\u65b0\uff0c\u5e76\u4e2d\u6b62\u60f9\u9ebb\u70e6\u7684\u4e8b\u52a1\uff1b</li> <li>\u4f46 MySQL/InnoDB \u7684\u53ef\u91cd\u590d\u8bfb\u5e76\u4e0d\u4f1a\u68c0\u6d4b \u4e22\u5931\u66f4\u65b0\\(^{[16]}\\)\uff1b</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#cas","title":"\u6bd4\u8f83\u5e76\u8bbe\u7f6e\uff08CAS\uff09","text":"<p>\u5728\u4e0d\u63d0\u4f9b\u4e8b\u52a1\u7684\u6570\u636e\u5e93\u4e2d\uff0c\u6709\u65f6\u4f1a\u53d1\u73b0\u4e00\u79cd\u539f\u5b50\u64cd\u4f5c\uff1a\u6bd4\u8f83\u5e76\u8bbe\u7f6e\uff08CAS\uff09</p> <ul> <li>\u5982\u679c\u6570\u636e\u5e93\u5141\u8bb8 <code>WHERE</code> \u5b50\u53e5\u4ece\u65e7\u5feb\u7167\u4e2d\u8bfb\u53d6\uff0c\u5219\u6b64\u8bed\u53e5\u53ef\u80fd\u65e0\u6cd5\u9632\u6b62\u4e22\u5931\u66f4\u65b0\uff0c\u56e0\u4e3a\u5373\u4f7f\u53d1\u751f\u4e86\u53e6\u4e00\u4e2a\u5e76\u53d1\u5199\u5165\uff0c<code>WHERE</code> \u6761\u4ef6\u4e5f\u53ef\u80fd\u4e3a\u771f</li> </ul> <pre><code>-- \u6839\u636e\u6570\u636e\u5e93\u7684\u5b9e\u73b0\u60c5\u51b5\uff0c\u8fd9\u53ef\u80fd\u5b89\u5168\u4e5f\u53ef\u80fd\u4e0d\u5b89\u5168\nUPDATE wiki_pages SET content = '\u65b0\u5185\u5bb9'  WHERE id = 1234 AND content = '\u65e7\u5185\u5bb9';\n</code></pre>"},{"location":"books/data_intensive_system_book/7_transaction.html#_22","title":"\u51b2\u7a81\u89e3\u51b3\u548c\u590d\u5236","text":"<p>\u5728\u590d\u5236\u6570\u636e\u5e93\u4e2d\uff08\u8bf7\u53c2\u9605 \u7b2c\u4e94\u7ae0\uff09\uff0c\u662f\u4ece\u53e6\u4e00\u4e2a\u7ef4\u5ea6\u6765\u9632\u6b62\u4e22\u5931\u7684\u66f4\u65b0\uff1a</p> <ul> <li>\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u5b58\u5728\u6570\u636e\u526f\u672c\uff0c\u5e76\u4e14\u5728\u4e0d\u540c\u8282\u70b9\u4e0a\u7684\u6570\u636e\u53ef\u80fd\u88ab\u5e76\u53d1\u5730\u4fee\u6539\uff0c\u56e0\u6b64\u9700\u8981\u91c7\u53d6\u4e00\u4e9b\u989d\u5916\u7684\u6b65\u9aa4\u6765\u9632\u6b62\u4e22\u5931\u66f4\u65b0\uff1b</li> <li>\u57fa\u4e8e\u9501\u6216 CAS \u64cd\u4f5c\u7684\u6280\u672f\uff08\u5047\u5b9a\u53ea\u6709\u4e00\u4e2a\u6700\u65b0\u7684\u6570\u636e\u526f\u672c\uff09\u4e0d\u9002\u7528\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u56e0\u4e3a\u65e0\u6cd5\u4fdd\u8bc1\u53ea\u6709\u4e00\u4e2a\u6700\u65b0\u6570\u636e\u7684\u526f\u672c\uff1b</li> </ul> <p>\u590d\u5236\u6570\u636e\u5e93\u4e2d\u7684\u4e00\u79cd\u5e38\u89c1\u65b9\u6cd5\u662f\u5141\u8bb8\u5e76\u53d1\u5199\u5165\u521b\u5efa\u591a\u4e2a\u51b2\u7a81\u7248\u672c\u7684\u503c\uff08\u4e5f\u79f0\u4e3a\u5144\u5f1f\uff09\uff0c\u5e76\u4f7f\u7528\u5e94\u7528\u4ee3\u7801\u6216\u7279\u6b8a\u6570\u636e\u7ed3\u6784\u5728\u4e8b\u5b9e\u53d1\u751f\u4e4b\u540e\u89e3\u51b3\u548c\u5408\u5e76\u8fd9\u4e9b\u7248\u672c\u3002</p> <ul> <li>\u539f\u5b50\u64cd\u4f5c\u53ef\u4ee5\u5728\u590d\u5236\u7684\u4e0a\u4e0b\u6587\u4e2d\u5f88\u597d\u5730\u5de5\u4f5c\uff0c\u5c24\u5176\u5f53\u5b83\u4eec\u5177\u6709\u53ef\u4ea4\u6362\u6027\u65f6\uff0c\u5982\u9012\u589e\u64cd\u4f5c/\u96c6\u5408\u6dfb\u52a0\u5143\u7d20\u64cd\u4f5c\uff1b</li> <li>\u5f53\u4e0d\u540c\u7684\u5ba2\u6237\u7aef\u540c\u65f6\u66f4\u65b0\u4e00\u4e2a\u503c\u65f6\uff0cRiak \u81ea\u52a8\u5c06\u66f4\u65b0\u5408\u5e76\u5728\u4e00\u8d77\uff0c\u4ee5\u514d\u4e22\u5931\u66f4\u65b0\\(^{[23]}\\)\u3002</li> <li>\u6700\u540e\u5199\u5165\u80dc\u5229\uff08LWW\uff09\u7684\u51b2\u7a81\u89e3\u51b3\u65b9\u6cd5\u5f88\u5bb9\u6613\u4e22\u5931\u66f4\u65b0\uff0c\u4f46\u5176\u662f\u8bb8\u591a\u6570\u636e\u5e93\u4e2d\u9ed8\u8ba4\u7684\u65b9\u6848\uff1b</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_23","title":"\u5199\u5165\u504f\u5dee\u4e0e\u5e7b\u8bfb","text":"<p>\u5f53\u4e0d\u540c\u7684\u4e8b\u52a1\u5e76\u53d1\u5730\u5c1d\u8bd5\u5199\u5165\u76f8\u540c\u7684\u5bf9\u8c61\u65f6\uff0c\u4f1a\u51fa\u73b0\u8fd9\u7ade\u4e89\u6761\u4ef6\uff1a\u810f\u5199 \u548c \u4e22\u5931\u66f4\u65b0\u3002</p> <p>\u4f46\u5e76\u53d1\u5199\u5165\u95f4\u53ef\u80fd\u53d1\u751f\u7684\u7ade\u4e89\u6761\u4ef6\u8fd8\u6ca1\u6709\u5b8c\uff0c\u4ee5\u4e0b\u662f\u66f4\u5fae\u5999\u7684\u793a\u4f8b\uff0c</p> <ul> <li>\u533b\u751f\u8f6e\u73ed\u7ba1\u7406\u7a0b\u5e8f\u3002\u533b\u9662\u901a\u5e38\u4f1a\u540c\u65f6\u8981\u6c42\u51e0\u4f4d\u533b\u751f\u5f85\u547d\uff0c\u4f46\u5e95\u7ebf\u662f\u81f3\u5c11\u6709\u4e00\u4f4d\u533b\u751f\u5728\u5f85\u547d\uff1b</li> <li>Alice \u548c Bob \u662f\u4e24\u4f4d\u503c\u73ed\u533b\u751f\uff0c\u6070\u597d\u5728\u540c\u4e00\u65f6\u95f4\u70b9\u51fb\u6309\u94ae\u4e0b\u73ed\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</li> </ul> <p></p> <p>\u7531\u4e8e\u6570\u636e\u5e93\u4f7f\u7528\u5feb\u7167\u9694\u79bb\uff0c\u4e24\u6b21\u68c0\u67e5\u90fd\u8fd4\u56de 2 \uff0c\u6240\u4ee5\u4e24\u4e2a\u4e8b\u52a1\u90fd\u8fdb\u5165\u4e0b\u4e00\u4e2a\u9636\u6bb5\u3002\u4e24\u4e2a\u4e8b\u52a1\u90fd\u6210\u529f\u63d0\u4ea4\u4e86\uff0c\u73b0\u5728\u6ca1\u6709\u533b\u751f\u503c\u73ed\uff0c\u8fdd\u53cd\u4e86\u81f3\u5c11\u6709\u4e00\u540d\u533b\u751f\u5728\u503c\u73ed\u7684\u8981\u6c42\u3002</p>"},{"location":"books/data_intensive_system_book/7_transaction.html#_24","title":"\u5199\u5165\u504f\u5dee\u7684\u7279\u5f81","text":"<p>\u8fd9\u79cd\u5f02\u5e38\u79f0\u4e3a \u5199\u5165\u504f\u5dee \\(^{[18]}\\)\uff1a</p> <ul> <li>\u4e0d\u662f\u810f\u5199\uff0c\u4e5f\u4e0d\u662f\u4e22\u5931\u66f4\u65b0\uff0c\u56e0\u4e3a\u8fd9\u4e24\u4e2a\u4e8b\u52a1\u6b63\u5728\u66f4\u65b0\u4e24\u4e2a\u4e0d\u540c\u7684\u5bf9\u8c61\uff08Alice \u548c Bob \u5404\u81ea\u7684\u5f85\u547d\u8bb0\u5f55\uff09\uff1b</li> <li>\u663e\u7136\u662f\u4e00\u4e2a\u7ade\u4e89\u6761\u4ef6\uff1a\u5982\u679c\u4e24\u4e2a\u4e8b\u52a1\u4e00\u4e2a\u63a5\u4e00\u4e2a\u5730\u8fd0\u884c\uff0c\u90a3\u4e48\u7b2c\u4e8c\u4e2a\u533b\u751f\u5c31\u4e0d\u80fd\u6b47\u73ed\uff1b</li> </ul> <p>\u53ef\u4ee5\u5c06\u5199\u5165\u504f\u5dee\u89c6\u4e3a\u4e22\u5931\u66f4\u65b0\u95ee\u9898\u7684\u4e00\u822c\u5316\u3002</p> <ul> <li>\u4e24\u4e2a\u4e8b\u52a1\u8bfb\u53d6\u76f8\u540c\u7684\u5bf9\u8c61\uff0c\u7136\u540e\u66f4\u65b0\u5176\u4e2d\u4e00\u4e9b\u5bf9\u8c61\uff08\u4e0d\u540c\u7684\u4e8b\u52a1\u53ef\u80fd\u66f4\u65b0\u4e0d\u540c\u7684\u5bf9\u8c61\uff09\uff0c\u5219\u53ef\u80fd\u53d1\u751f\u5199\u5165\u504f\u5dee\uff1b</li> <li>\u591a\u4e2a\u4e8b\u52a1\u66f4\u65b0\u540c\u4e00\u4e2a\u5bf9\u8c61\u7684\u7279\u6b8a\u60c5\u51b5\u4e0b\uff0c\u5c31\u4f1a\u53d1\u751f\u810f\u5199\u6216\u4e22\u5931\u66f4\u65b0\uff08\u53d6\u51b3\u4e8e\u65f6\u5e8f\uff09\uff1b</li> </ul> <p>\u5bf9\u4e8e\u5199\u5165\u504f\u5dee\uff0c\u53ef\u9009\u7684\u65b9\u6cd5\u66f4\u53d7\u9650\u5236\uff1a</p> <ul> <li>\u7531\u4e8e\u6d89\u53ca\u591a\u4e2a\u5bf9\u8c61\uff0c\u5355\u5bf9\u8c61\u7684\u539f\u5b50\u64cd\u4f5c\u4e0d\u8d77\u4f5c\u7528\uff1b</li> <li>\u5728\u4e00\u4e9b\u5feb\u7167\u9694\u79bb\u7684\u5b9e\u73b0\u4e2d\uff0c\u81ea\u52a8\u68c0\u6d4b\u4e22\u5931\u66f4\u65b0\u5bf9\u6b64\u5e76\u6ca1\u6709\u5e2e\u52a9</li> <li>\u5982PG\u4e2d\u53ef\u91cd\u590d\u8bfb\u7b49\u90fd\u4e0d\u4f1a\u81ea\u52a8\u68c0\u6d4b\u5199\u5165\u504f\u5dee\\(^{[16]}\\)\uff0c\u52a8\u9632\u6b62\u5199\u5165\u504f\u5dee\u9700\u8981\u771f\u6b63\u7684\u53ef\u4e32\u884c\u5316\u9694\u79bb\uff08\u8bf7\u53c2\u9605 \u201c\u53ef\u4e32\u884c\u5316\u201d\uff09\u3002</li> </ul> <p>\u5982\u679c\u65e0\u6cd5\u4f7f\u7528\u53ef\u4e32\u884c\u5316\u7684\u9694\u79bb\u7ea7\u522b\uff0c\u5219\u6b64\u60c5\u51b5\u4e0b\u7684\u6b21\u4f18\u9009\u9879\u53ef\u80fd\u662f\u663e\u5f0f\u9501\u5b9a\u4e8b\u52a1\u6240\u4f9d\u8d56\u7684\u884c\uff0c\u5982\u4e0b\u6240\u793a</p> <ul> <li><code>FOR UPDATE</code> \u544a\u8bc9\u6570\u636e\u5e93\u9501\u5b9a\u8fd4\u56de\u7684\u6240\u6709\u884c\uff08\u6392\u4ed6\u9501\uff09\u4ee5\u7528\u4e8e\u66f4\u65b0</li> </ul> <pre><code>BEGIN TRANSACTION;\nSELECT * FROM doctors WHERE on_call = TRUE AND shift_id = 1234 \n  FOR UPDATE;\n\nUPDATE doctors  SET on_call = FALSE\n  WHERE name = 'Alice' AND shift_id = 1234;\n\nCOMMIT;\n</code></pre>"},{"location":"books/data_intensive_system_book/7_transaction.html#_25","title":"\u5199\u5165\u504f\u5dee\u7684\u66f4\u591a\u4f8b\u5b50","text":"<p>\u5199\u5165\u504f\u5dee\u53ef\u80fd\u53d1\u751f\u5728\u66f4\u591a\u573a\u666f\u4e0b\uff1a</p> <ul> <li>\u4f1a\u8bae\u5ba4\u9884\u8ba2\u7cfb\u7edf\uff1a\u4e0d\u80fd\u5728\u540c\u4e00\u65f6\u95f4\u5bf9\u540c\u4e00\u4e2a\u4f1a\u8bae\u5ba4\u8fdb\u884c\u591a\u6b21\u7684\u9884\u8ba2</li> <li>\u5148\u68c0\u67e5\u662f\u5426\u6709\u91cd\u53e0\u7684\uff0c\u5982\u679c\u6ca1\u6709\u5219\u5199\u5165\uff1b\u8be5\u65b9\u6848\u4e0d\u80fd\u7528<code>SELECT FOR UPDATE</code>\u65e0\u6cd5\u907f\u514d\uff1b</li> <li>\u591a\u4eba\u6e38\u620f\uff1a\u4f7f\u7528\u4e00\u4e2a\u9501\u6765\u9632\u6b62\u4e22\u5931\u66f4\u65b0\uff08\u786e\u4fdd\u4e24\u4e2a\u73a9\u5bb6\u4e0d\u80fd\u540c\u65f6\u79fb\u52a8\u540c\u4e00\u4e2a\u68cb\u5b50\uff09\uff0c\u4f46\u4e0d\u80fd\u9632\u6b62\u4e24\u4e2a\u73a9\u5bb6\u5c06\u68cb\u5b50\u79fb\u52a8\u5230\u540c\u4e00\u4e2a\u4f4d\u7f6e\uff1b</li> <li>\u62a2\u6ce8\u7528\u6237\u540d\uff1a\u4e24\u4e2a\u7528\u6237\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u540c\u65f6\u521b\u5efa\u5177\u6709\u76f8\u540c\u7528\u6237\u540d\u7684\u5e10\u6237\uff0c\u5e78\u8fd0\u7684\u662f\u552f\u4e00\u7ea6\u675f\u53ef\u4ee5\u9632\u6b62\uff1b</li> <li>\u9632\u6b62\u53cc\u91cd\u5f00\u652f\uff1a\u68c0\u67e5\u7528\u6237\u7684\u652f\u4ed8\u6570\u989d\u4e0d\u8d85\u8fc7\u5176\u4f59\u989d\uff0c\u53ef\u80fd\u4f1a\u53d1\u751f\u4e24\u4e2a\u652f\u51fa\u9879\u76ee\u540c\u65f6\u63d2\u5165\uff0c\u4e00\u8d77\u5bfc\u81f4\u4f59\u989d\u53d8\u4e3a\u8d1f\u503c\u3002</li> </ul> <p>\u6b64\u65f6\uff0c<code>SELECT FOR UPDATE</code>\u6765\u4f7f\u4e8b\u52a1\u5b89\u5168\u5e76\u907f\u514d\u5199\u5165\u504f\u5dee\uff0c\u4f46\u5176\u5177\u5907\u5c40\u9650\u6027\uff1a</p> <ul> <li>\u68c0\u67e5\u662f\u5426 \u4e0d\u5b58\u5728 \u67d0\u4e9b\u6ee1\u8db3\u6761\u4ef6\u7684\u884c\uff0c\u5199\u5165\u4f1a \u6dfb\u52a0 \u4e00\u4e2a\u5339\u914d\u76f8\u540c\u6761\u4ef6\u7684\u884c\uff1b</li> <li>\u56e0\u6b64\u67e5\u8be2\u6ca1\u6709\u8fd4\u56de\u4efb\u4f55\u884c\uff0c\u5219 <code>SELECT FOR UPDATE</code> \u9501\u4e0d\u4e86\u4efb\u4f55\u4e1c\u897f\uff0c\u65e0\u6cd5\u9501\u4f4f\u5373\u5c06\u8981\u63d2\u5165\u7684\u884c\uff1b</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_26","title":"\u5bfc\u81f4\u5199\u5165\u504f\u5dee\u7684\u5e7b\u8bfb","text":"<p>\u5176\u89e3\u51b3\u65b9\u6cd5\u89c1\u53ef\u4e32\u884c\u5316\uff0c\u5e38\u89c1\u7684\u662f\u4e8c\u9636\u6bb5\u9501\u5b9a\u3002</p> <p>\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u7684\u5199\u5165\u6539\u53d8\u53e6\u4e00\u4e2a\u4e8b\u52a1\u7684\u641c\u7d22\u67e5\u8be2\u7684\u7ed3\u679c\uff0c\u88ab\u79f0\u4e3a \u5e7b\u8bfb\\(^{[24]}\\)\u3002</p> <ul> <li>\u5feb\u7167\u9694\u79bb\u907f\u514d\u4e86\u53ea\u8bfb\u67e5\u8be2\u4e2d\u5e7b\u8bfb\uff0c\u4f46\u6ca1\u6709\u89e3\u51b3\u8bfb\u5199\u4e8b\u52a1\u4e2d\u7684\u5e7b\u8bfb\uff1b</li> </ul> <p>\u6240\u6709\u8fd9\u4e9b\u4f8b\u5b50\u90fd\u9075\u5faa\u7c7b\u4f3c\u7684\u6a21\u5f0f\uff1a</p> <ol> <li>\u4e00\u4e2a <code>SELECT</code> \u67e5\u8be2\u627e\u51fa\u7b26\u5408\u6761\u4ef6\u7684\u884c\uff0c\u5e76\u68c0\u67e5\u662f\u5426\u7b26\u5408\u4e00\u4e9b\u8981\u6c42</li> <li>\u6309\u7167\u7b2c\u4e00\u4e2a\u67e5\u8be2\u7684\u7ed3\u679c\uff0c\u5e94\u7528\u4ee3\u7801\u51b3\u5b9a\u662f\u5426\u7ee7\u7eed\uff1b</li> <li>\u5982\u679c\u5e94\u7528\u51b3\u5b9a\u7ee7\u7eed\u64cd\u4f5c\uff0c\u5c31\u6267\u884c\u5199\u5165\uff08\u63d2\u5165\u3001\u66f4\u65b0\u6216\u5220\u9664\uff09\uff0c\u5e76\u63d0\u4ea4\u4e8b\u52a1\u3002</li> </ol> <p>\u5199\u5165\u7684\u6548\u679c\u6539\u53d8\u4e86\u6b65\u9aa4 2 \u4e2d\u7684\u5148\u51b3\u6761\u4ef6\u3002</p> <ul> <li>\u5982\u679c\u6b65\u9aa41\u7684\u67e5\u8be2\u6ca1\u6709\u8fd4\u56de\u4efb\u4f55\u884c\uff0c\u5219 <code>SELECT FOR UPDATE</code> \u9501\u4e0d\u4e86\u4efb\u4f55\u4e1c\u897f</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_27","title":"\u7269\u5316\u51b2\u7a81","text":"<p>\u5982\u679c\u5e7b\u8bfb\u7684\u95ee\u9898\u662f\u6ca1\u6709\u5bf9\u8c61\u53ef\u4ee5\u52a0\u9501\uff0c\u4e5f\u8bb8\u53ef\u4ee5\u4eba\u4e3a\u5730\u5728\u6570\u636e\u5e93\u4e2d\u5f15\u5165\u4e00\u4e2a\u9501\u5bf9\u8c61\uff1f</p> <ul> <li>\u5728\u4f1a\u8bae\u5ba4\u9884\u8ba2\u7684\u573a\u666f\uff0c\u521b\u5efa\u4e00\u4e2a\u5173\u4e8e\u65f6\u95f4\u69fd\u548c\u623f\u95f4\u7684\u8868\uff0c\u8868\u4e2d\u7684\u6bcf\u4e00\u884c\u5bf9\u5e94\u4e8e\u7279\u5b9a\u65f6\u95f4\u6bb5\uff08\u4f8b\u5982 15 \u5206\u949f\uff09\u7684\u7279\u5b9a\u623f\u95f4\uff1b</li> <li>\u521b\u5efa\u9884\u8ba2\u7684\u4e8b\u52a1\u53ef\u4ee5\u9501\u5b9a\uff08<code>SELECT FOR UPDATE</code>\uff09\u8868\u4e2d\u4e0e\u6240\u9700\u623f\u95f4\u548c\u65f6\u95f4\u6bb5\u5bf9\u5e94\u7684\u884c\uff1b</li> <li>\u83b7\u5f97\u9501\u5b9a\u4e4b\u540e\uff0c\u5b83\u53ef\u4ee5\u68c0\u67e5\u91cd\u53e0\u7684\u9884\u8ba2\u5e76\u50cf\u4ee5\u524d\u4e00\u6837\u63d2\u5165\u65b0\u7684\u9884\u8ba2\uff1b</li> </ul> <p>\u7269\u5316\u51b2\u7a81\uff08materializing conflicts\uff09\uff0c\u5b83\u5c06\u5e7b\u8bfb\u53d8\u4e3a\u6570\u636e\u5e93\u4e2d\u4e00\u7ec4\u5177\u4f53\u884c\u4e0a\u7684\u9501\u51b2\u7a81\\(^{[25]}\\)</p> <ul> <li>\u5f04\u6e05\u695a\u5982\u4f55\u7269\u5316\u51b2\u7a81\u53ef\u80fd\u5f88\u96be\uff0c\u4e5f\u5f88\u5bb9\u6613\u51fa\u9519\uff0c\u7269\u5316\u51b2\u7a81\u5e94\u88ab\u89c6\u4e3a\u6700\u540e\u7684\u624b\u6bb5\uff1b</li> <li>\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u3002\u53ef\u4e32\u884c\u5316\uff08Serializable\uff09 \u7684\u9694\u79bb\u7ea7\u522b\u662f\u66f4\u53ef\u53d6\u7684\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_28","title":"\u53ef\u4e32\u884c\u5316","text":"<p>\u53ef\u4e32\u884c\u5316\uff08Serializability\uff09 \u9694\u79bb\u901a\u5e38\u88ab\u8ba4\u4e3a\u662f\u6700\u5f3a\u7684\u9694\u79bb\u7ea7\u522b\uff0c\u5176\u6280\u672f\u6709\u4ee5\u4e0b\u4e09\u79cd\u5b9e\u73b0\u65b9\u5f0f\uff1a</p> <ul> <li>\u5b57\u9762\u610f\u4e49\u4e0a\u5730\u4e32\u884c\u987a\u5e8f\u6267\u884c\u4e8b\u52a1\uff08\u8bf7\u53c2\u9605 \u201c\u771f\u7684\u4e32\u884c\u6267\u884c\u201d\uff09</li> <li>\u4e24\u9636\u6bb5\u9501\u5b9a\uff082PL, two-phase locking\uff09\uff0c\u51e0\u5341\u5e74\u6765\u552f\u4e00\u53ef\u884c\u7684\u9009\u62e9\uff08\u8bf7\u53c2\u9605 \u201c\u4e24\u9636\u6bb5\u9501\u5b9a\u201d\uff09</li> <li>\u4e50\u89c2\u5e76\u53d1\u63a7\u5236\u6280\u672f\uff0c\u4f8b\u5982 \u53ef\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb\uff08serializable snapshot isolation\uff0c\u8bf7\u53c2\u9605 \u201c\u53ef\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb\u201d\uff09</li> </ul> <p>\u540e\u7eed\u5728\u5355\u8282\u70b9\u6570\u636e\u5e93\u7684\u80cc\u666f\u4e0b\u8ba8\u8bba\u8fd9\u4e9b\u6280\u672f\uff0c\u7b2c\u4e5d\u7ae0\u4f1a\u7814\u7a76\u5982\u4f55\u5c06\u4ed6\u4eec\u63a8\u5e7f\u5230\u6d89\u53ca\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u591a\u4e2a\u8282\u70b9\u7684\u4e8b\u52a1\u3002</p>"},{"location":"books/data_intensive_system_book/7_transaction.html#_29","title":"\u771f\u7684\u4e32\u884c\u6267\u884c","text":"<p>\u5728\u5355\u4e2a\u7ebf\u7a0b\u4e0a\u6309\u987a\u5e8f\u4e00\u6b21\u53ea\u6267\u884c\u4e00\u4e2a\u4e8b\u52a1\u3002\u4f46\u6570\u636e\u5e93\u8bbe\u8ba1\u4eba\u5458\u53ea\u662f\u5728 2007 \u5e74\u5de6\u53f3\u624d\u51b3\u5b9a\uff0c\u5355\u7ebf\u7a0b\u5faa\u73af\u6267\u884c\u4e8b\u52a1\u662f\u53ef\u884c\u7684\\(^{[26]}\\)</p> <ul> <li>RAM \u8db3\u591f\u4fbf\u5b9c\uff0c\u53ef\u4ee5\u5c06\u5b8c\u6574\u7684\u6d3b\u8dc3\u6570\u636e\u96c6\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d\uff08\u8bf7\u53c2\u9605 \u201c\u5728\u5185\u5b58\u4e2d\u5b58\u50a8\u4e00\u5207\u201d\uff09\uff0c\u6b64\u65f6\u4e8b\u52a1\u5904\u7406\u7684\u6267\u884c\u901f\u5ea6\u8981\u6bd4\u7b49\u5f85\u6570\u636e\u4ece\u78c1\u76d8\u52a0\u8f7d\u65f6\u5feb\u5f97\u591a\uff1b</li> <li>OLTP \u4e8b\u52a1\u901a\u5e38\u5f88\u77ed\uff0c\u800c\u4e14\u53ea\u8fdb\u884c\u5c11\u91cf\u7684\u8bfb\u5199\u64cd\u4f5c\u8bf7\u53c2\u9605 \u201c\u4e8b\u52a1\u5904\u7406\u4e0e\u5206\u6790\u5904\u7406\u201d\uff09\uff1bOLAP \u901a\u5e38\u90fd\u662f\u53ea\u8bfb\u7684\uff0c\u53ef\u4ee5\u5728\u5feb\u7167\u9694\u79bb\u4e0a\u8fd0\u884c\uff1b</li> </ul> <p>\u4e32\u884c\u6267\u884c\u4e8b\u52a1\u7684\u65b9\u6cd5\u5728 VoltDB/H-Store\u3001Redis \u548c Datomic \u4e2d\u5b9e\u73b0\\(^{27,28,29}\\)\u3002\u5355\u7ebf\u7a0b\u6267\u884c\u907f\u514d\u9501\u7684\u534f\u8c03\u5f00\u9500\uff0c\u6709\u65f6\u53ef\u4ee5\u6bd4\u652f\u6301\u5e76\u53d1\u7684\u7cfb\u7edf\u6027\u80fd\u66f4\u597d\uff0c\u4f46\u5176\u541e\u5410\u91cf\u4ec5\u9650\u4e8e\u5355\u4e2a CPU \u6838\u7684\u541e\u5410\u91cf\u3002</p>"},{"location":"books/data_intensive_system_book/7_transaction.html#_30","title":"\u5728\u5b58\u50a8\u8fc7\u7a0b\u4e2d\u5c01\u88c5\u4e8b\u52a1","text":"<p>\u4ea4\u4e92\u5f0f\u4e8b\u52a1\uff1a\u4e8b\u52a1\u4ecd\u7136\u4ee5\u4ea4\u4e92\u5f0f\u7684\u5ba2\u6237\u7aef / \u670d\u52a1\u5668\u98ce\u683c\u6267\u884c\uff0c\u4e00\u6b21\u4e00\u4e2a\u8bed\u53e5\u3002\u5e94\u7528\u7a0b\u5e8f\u8fdb\u884c\u67e5\u8be2\uff0c\u8bfb\u53d6\u7ed3\u679c\uff0c\u53ef\u80fd\u6839\u636e\u7b2c\u4e00\u4e2a\u67e5\u8be2\u7684\u7ed3\u679c\u8fdb\u884c\u53e6\u4e00\u4e2a\u67e5\u8be2\u3002</p> <ul> <li>\u5e94\u7528\u7a0b\u5e8f\u548c\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u7f51\u7edc\u901a\u4fe1\u8017\u8d39\u4e86\u5927\u91cf\u7684\u65f6\u95f4\uff0c\u5982\u679c\u4e0d\u5141\u8bb8\u5728\u6570\u636e\u5e93\u4e2d\u8fdb\u884c\u5e76\u53d1\u5904\u7406\uff0c\u5219\u541e\u5410\u91cf\uff08\u9488\u5bf9\u4e8b\u52a1\uff09\u4f1a\u975e\u5e38\u7cdf\u7cd5\uff1b</li> </ul> <p>\u5177\u6709\u5355\u7ebf\u7a0b\u4e32\u884c\u4e8b\u52a1\u5904\u7406\u7684\u7cfb\u7edf\u4e0d\u5141\u8bb8\u4ea4\u4e92\u5f0f\u7684\u591a\u8bed\u53e5\u4e8b\u52a1\uff0c\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u63d0\u524d\u5c06\u6574\u4e2a\u4e8b\u52a1\u4ee3\u7801\u4f5c\u4e3a\u5b58\u50a8\u8fc7\u7a0b\u63d0\u4ea4\u7ed9\u6570\u636e\u5e93\uff1a</p> <ul> <li>\u4e8b\u52a1\u6240\u9700\u7684\u6240\u6709\u6570\u636e\u90fd\u5728\u5185\u5b58\u4e2d\uff0c\u5219\u5b58\u50a8\u8fc7\u7a0b\u53ef\u4ee5\u975e\u5e38\u5feb\u5730\u6267\u884c\uff0c\u800c\u4e0d\u7528\u7b49\u5f85\u4efb\u4f55\u7f51\u7edc\u6216\u78c1\u76d8 I/O</li> </ul> <p>\u56fe 7-9 \u4ea4\u4e92\u5f0f\u4e8b\u52a1\u548c\u5b58\u50a8\u8fc7\u7a0b\u4e4b\u95f4\u7684\u533a\u522b\uff08\u4f7f\u7528\u56fe 7-8 \u7684\u793a\u4f8b\u4e8b\u52a1\uff09</p> <p></p>"},{"location":"books/data_intensive_system_book/7_transaction.html#_31","title":"\u5b58\u50a8\u8fc7\u7a0b\u7684\u4f18\u70b9\u548c\u7f3a\u70b9","text":"<p>\u5b58\u50a8\u8fc7\u7a0b\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u95ee\u9898\uff1a</p> <ul> <li>\u4e0d\u540c\u7684\u5b58\u50a8\u8fc7\u7a0b\u8bed\u8a00\uff0c\u5982 Oracle \u6709 PL/SQL\uff0cPostgreSQL \u6709 PL/pgSQL\u7b49\uff0c\u751f\u6001\u5dee\uff0c\u96be\u4ee5\u4f7f\u7528\uff1b</li> <li>\u4ee3\u7801\u96be\u4ee5\u7ba1\u7406\uff1a\u4e0e\u5e94\u7528\u670d\u52a1\u5668\u76f8\u6bd4\uff0c\u5b83\u66f4\u96be\u8c03\u8bd5\uff0c\u66f4\u96be\u4ee5\u4fdd\u6301\u7248\u672c\u63a7\u5236\u548c\u90e8\u7f72\uff0c\u66f4\u96be\u6d4b\u8bd5\uff1b</li> <li>\u6027\u80fd\uff1a\u5199\u5f97\u4e0d\u597d\u7684\u5b58\u50a8\u8fc7\u7a0b\uff08\u4f8b\u5982\uff0c\u5360\u7528\u5927\u91cf\u5185\u5b58\u6216 CPU \u65f6\u95f4\uff09\u4f1a\u6bd4\u5728\u5e94\u7528\u670d\u52a1\u5668\u4e2d\u76f8\u540c\u7684\u4ee3\u7801\u9020\u6210\u66f4\u591a\u7684\u9ebb\u70e6\u3002</li> </ul> <p>\u73b0\u4ee3\u7684\u5b58\u50a8\u8fc7\u7a0b\u5b9e\u73b0\u653e\u5f03\u4e86 PL/SQL\uff0c\u800c\u662f\u4f7f\u7528\u73b0\u6709\u7684\u901a\u7528\u7f16\u7a0b\u8bed\u8a00\uff1aVoltDB \u4f7f\u7528 Java \u6216 Groovy\uff0cDatomic \u4f7f\u7528 Java \u6216 Clojure\uff0c\u800c Redis \u4f7f\u7528 Lua\u3002</p> <p>\u5b58\u50a8\u8fc7\u7a0b\u4e0e\u5185\u5b58\u5b58\u50a8\uff0c\u4f7f\u5f97\u5728\u5355\u4e2a\u7ebf\u7a0b\u4e0a\u6267\u884c\u6240\u6709\u4e8b\u52a1\u53d8\u5f97\u53ef\u884c\u3002</p> <ul> <li>\u4e0d\u9700\u8981\u7b49\u5f85 I/O\uff0c\u4e14\u907f\u514d\u4e86\u5e76\u53d1\u63a7\u5236\u673a\u5236\u7684\u5f00\u9500\uff0c\u5b83\u4eec\u53ef\u4ee5\u5728\u5355\u4e2a\u7ebf\u7a0b\u4e0a\u5b9e\u73b0\u76f8\u5f53\u597d\u7684\u541e\u5410\u91cf\u3002</li> </ul> <p>VoltDB \u8fd8\u4f7f\u7528\u5b58\u50a8\u8fc7\u7a0b\u8fdb\u884c\u590d\u5236\uff1a\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u6267\u884c\u76f8\u540c\u7684\u5b58\u50a8\u8fc7\u7a0b</p> <ul> <li>\u8981\u6c42\u5b58\u50a8\u8fc7\u7a0b\u662f \u786e\u5b9a\u6027\u7684\uff0c\u4f8b\u5982\u5f53\u524d\u65f6\u95f4\u7684API\u9700\u8981\u901a\u8fc7\u7279\u6b8a\u7684\u786e\u5b9a\u6027API\u5b9e\u73b0\uff1b</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_32","title":"\u5206\u533a","text":"<p>\u5bf9\u4e8e\u5199\u5165\u541e\u5410\u91cf\u8f83\u9ad8\u7684\u5e94\u7528\uff0c\u5355\u7ebf\u7a0b\u4e8b\u52a1\u5904\u7406\u5668\u53ef\u80fd\u6210\u4e3a\u4e00\u4e2a\u4e25\u91cd\u7684\u74f6\u9888\u3002</p> <ul> <li>\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u533a\uff0c\u53ef\u4ee5\u4f38\u7f29\u81f3\u591a\u4e2a CPU \u6838\u5fc3\u548c\u591a\u4e2a\u8282\u70b9\uff1b</li> </ul> <p>\u9700\u8981\u8bbf\u95ee\u591a\u4e2a\u5206\u533a\u7684\u4efb\u4f55\u4e8b\u52a1\uff0c\u6570\u636e\u5e93\u5fc5\u987b\u5728\u89e6\u53ca\u7684\u6240\u6709\u5206\u533a\u4e4b\u95f4\u534f\u8c03\u4e8b\u52a1\u3002\u5b58\u50a8\u8fc7\u7a0b\u9700\u8981\u8de8\u8d8a\u6240\u6709\u5206\u533a\u9501\u5b9a\u6267\u884c\uff0c\u4ee5\u786e\u4fdd\u6574\u4e2a\u7cfb\u7edf\u7684\u53ef\u4e32\u884c\u6027\u3002</p> <ul> <li>\u8de8\u5206\u533a\u4e8b\u52a1\u5177\u6709\u989d\u5916\u7684\u534f\u8c03\u5f00\u9500\uff0c\u6240\u4ee5\u5b83\u4eec\u6bd4\u5355\u5206\u533a\u4e8b\u52a1\u6162\u5f97\u591a\uff1b\u5982 VoltDB \u5927\u7ea6\u6bcf\u79d21000\u4e2a\u8de8\u5206\u533a\u5199\u5165\uff0c\u6bd4\u5355\u5206\u533a\u4f4e\u51e0\u4e2a\u6570\u91cf\u7ea7\uff1b</li> </ul> <p>\u4e8b\u52a1\u662f\u5426\u53ef\u4ee5\u662f\u5212\u5206\u81f3\u5355\u4e2a\u5206\u533a\u5f88\u5927\u7a0b\u5ea6\u4e0a\u53d6\u51b3\u4e8e\u5e94\u7528\u6570\u636e\u7684\u7ed3\u6784\u3002</p> <ul> <li>\u7b80\u5355\u7684\u952e\u503c\u6570\u636e\u901a\u5e38\u53ef\u4ee5\u975e\u5e38\u5bb9\u6613\u5730\u8fdb\u884c\u5206\u533a\uff0c\u4f46\u662f\u5177\u6709\u591a\u4e2a\u6b21\u7ea7\u7d22\u5f15\u7684\u6570\u636e\u53ef\u80fd\u9700\u8981\u5927\u91cf\u7684\u8de8\u5206\u533a\u534f\u8c03</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_33","title":"\u4e32\u884c\u6267\u884c\u5c0f\u7ed3","text":"<p>\u5728\u7279\u5b9a\u7ea6\u675f\u6761\u4ef6\u4e0b\uff0c\u771f\u7684\u4e32\u884c\u6267\u884c\u4e8b\u52a1\uff0c\u5df2\u7ecf\u6210\u4e3a\u4e00\u79cd\u5b9e\u73b0\u53ef\u4e32\u884c\u5316\u9694\u79bb\u7b49\u7ea7\u7684\u53ef\u884c\u529e\u6cd5\u3002</p> <ul> <li>\u6bcf\u4e2a\u4e8b\u52a1\u90fd\u5fc5\u987b\u5c0f\u800c\u5feb\uff0c\u53ea\u8981\u6709\u4e00\u4e2a\u7f13\u6162\u7684\u4e8b\u52a1\uff0c\u5c31\u4f1a\u62d6\u6162\u6240\u6709\u4e8b\u52a1\u5904\u7406\u3002</li> <li>\u4ec5\u9650\u4e8e\u6d3b\u8dc3\u6570\u636e\u96c6\u53ef\u4ee5\u653e\u5165\u5185\u5b58\u7684\u60c5\u51b5\u3002\u5982\u679c\u9700\u8981\u5728\u5355\u7ebf\u7a0b\u6267\u884c\u7684\u4e8b\u52a1\u4e2d\u8bbf\u95ee\u8fd9\u4e9b\u78c1\u76d8\u4e2d\u7684\u6570\u636e\uff0c\u7cfb\u7edf\u5c31\u4f1a\u53d8\u5f97\u975e\u5e38\u6162<sup>6</sup>\u3002</li> <li>\u5199\u5165\u541e\u5410\u91cf\u5fc5\u987b\u4f4e\u5230\u80fd\u5728\u5355\u4e2a CPU \u6838\u4e0a\u5904\u7406\uff0c\u5982\u82e5\u4e0d\u7136\uff0c\u4e8b\u52a1\u9700\u8981\u80fd\u5212\u5206\u81f3\u5355\u4e2a\u5206\u533a\uff0c\u4e14\u4e0d\u9700\u8981\u8de8\u5206\u533a\u534f\u8c03\u3002</li> <li>\u8de8\u5206\u533a\u4e8b\u52a1\u662f\u53ef\u80fd\u7684\uff0c\u4f46\u662f\u5b83\u4eec\u80fd\u88ab\u4f7f\u7528\u7684\u7a0b\u5ea6\u6709\u5f88\u5927\u7684\u9650\u5236\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_34","title":"\u4e24\u9636\u6bb5\u9501\u5b9a","text":"<p>\u5927\u7ea6 30 \u5e74\u6765\uff0c\u5728\u6570\u636e\u5e93\u4e2d\u53ea\u6709\u4e00\u79cd\u5e7f\u6cdb\u4f7f\u7528\u7684\u4e32\u884c\u5316\u7b97\u6cd5\uff1a\u4e24\u9636\u6bb5\u9501\u5b9a\uff082PL\uff0ctwo-phase locking\uff09\u3002</p> <p>\u4e00\u6b21\u6027\u9501\u534f\u8bae\uff1a\u4e8b\u52a1\u5f00\u59cb\u65f6\uff0c\u5373\u4e00\u6b21\u6027\u7533\u8bf7\u6240\u6709\u7684\u9501\uff0c\u4e4b\u540e\u4e0d\u4f1a\u518d\u7533\u8bf7\u4efb\u4f55\u9501\uff0c\u4e8b\u52a1\u7ed3\u675f\u540e\u91ca\u653e\u6240\u6709\u9501\uff1b</p> <ul> <li>\u4e00\u6b21\u6027\u9501\u534f\u8bae\u4e0d\u4f1a\u4ea7\u751f\u6b7b\u9501\u7684\u95ee\u9898\uff0c\u4f46\u4e8b\u52a1\u7684\u5e76\u53d1\u5ea6\u4e0d\u9ad8\u3002</li> </ul> <p>\u4e24\u9636\u6bb5\u9501\u534f\u8bae\uff1a\u6574\u4e2a\u4e8b\u52a1\u5206\u4e3a\u4e24\u4e2a\u9636\u6bb5\uff0c\u524d\u4e00\u4e2a\u9636\u6bb5\u4e3a\u52a0\u9501\uff0c\u540e\u4e00\u4e2a\u9636\u6bb5\u4e3a\u89e3\u9501\u3002</p> <ul> <li>\u52a0\u9501\u9636\u6bb5\uff0c\u4e8b\u52a1\u53ea\u80fd\u52a0\u9501\uff0c\u4e5f\u53ef\u4ee5\u64cd\u4f5c\u6570\u636e\uff0c\u4f46\u4e0d\u80fd\u89e3\u9501\uff0c\u76f4\u5230\u4e8b\u52a1\u91ca\u653e\u7b2c\u4e00\u4e2a\u9501\uff0c\u5c31\u8fdb\u5165\u89e3\u9501\u9636\u6bb5\uff1b</li> <li>\u89e3\u9501\u9636\u6bb5\uff0c\u6b64\u8fc7\u7a0b\u4e2d\u4e8b\u52a1\u53ea\u80fd\u89e3\u9501\uff0c\u4e5f\u53ef\u4ee5\u64cd\u4f5c\u6570\u636e\uff0c\u4e0d\u80fd\u518d\u52a0\u9501\uff1b</li> <li></li> </ul> <p></p> <p>2PL \u4e8b\u52a1\u5177\u6709\u8f83\u9ad8\u7684\u5e76\u53d1\u5ea6\uff0c\u56e0\u4e3a\u89e3\u9501\u4e0d\u5fc5\u53d1\u751f\u5728\u4e8b\u52a1\u7ed3\u5c3e\uff0c\u4f46\u4f1a\u6709\u6b7b\u9501\u884c\u4e3a\u548c\u7ea7\u8054\u4e2d\u6b62 (cascading aborts)</p> <p></p> <p>2PL \u8fd8\u6709\u4e00\u4e2a\u589e\u5f3a\u7248\u53d8\u79cd\uff0cStrong Strict 2PL(SSPL)\uff0c\u4e5f\u79f0Rigorous 2PL\uff0c\u540e\u8005\u6bcf\u4e2a\u4e8b\u52a1\u5728\u7ed3\u675f\u4e4b\u524d\uff0c\u5176\u5199\u8fc7\u7684\u6570\u636e\u4e0d\u80fd\u88ab\u5176\u5b83\u4e8b\u52a1\u8bfb\u53d6\u6216\u8005\u91cd\u5199\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>2PL\u4e0d\u662f2PC</p> <p>\u8bf7\u6ce8\u610f\uff0c\u867d\u7136\u4e24\u9636\u6bb5\u9501\u5b9a\uff082PL\uff09\u542c\u8d77\u6765\u975e\u5e38\u7c7b\u4f3c\u4e8e\u4e24\u9636\u6bb5\u63d0\u4ea4\uff082PC\uff09\uff0c\u4f46\u5b83\u4eec\u662f\u5b8c\u5168\u4e0d\u540c\u7684\u4e1c\u897f\u3002</p> <p>\u4e24\u9636\u6bb5\u9501\u5b9a\u5bf9\u9501\u7684\u8981\u6c42\u66f4\u5f3a\u5f97\u591a\u3002\u53ea\u8981\u6ca1\u6709\u5199\u5165\uff0c\u5c31\u5141\u8bb8\u591a\u4e2a\u4e8b\u52a1\u540c\u65f6\u8bfb\u53d6\u540c\u4e00\u4e2a\u5bf9\u8c61\u3002\u4f46\u5bf9\u8c61\u53ea\u8981\u6709\u5199\u5165\uff08\u4fee\u6539\u6216\u5220\u9664\uff09\uff0c\u5c31\u9700\u8981 \u72ec\u5360\u8bbf\u95ee\uff08exclusive access\uff09 \u6743\u9650\uff1a</p> <ul> <li>\u5982\u679c\u4e8b\u52a1 A \u8bfb\u53d6\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5e76\u4e14\u4e8b\u52a1 B \u60f3\u8981\u5199\u5165\u8be5\u5bf9\u8c61\uff0c\u90a3\u4e48 B \u5fc5\u987b\u7b49\u5230 A \u63d0\u4ea4\u6216\u4e2d\u6b62\u624d\u80fd\u7ee7\u7eed\uff08\u8fd9\u786e\u4fdd B \u4e0d\u80fd\u5728 A \u5e95\u4e0b\u610f\u5916\u5730\u6539\u53d8\u5bf9\u8c61\uff09\u3002</li> <li>\u5982\u679c\u4e8b\u52a1 A \u5199\u5165\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5e76\u4e14\u4e8b\u52a1 B \u60f3\u8981\u8bfb\u53d6\u8be5\u5bf9\u8c61\uff0c\u5219 B \u5fc5\u987b\u7b49\u5230 A \u63d0\u4ea4\u6216\u4e2d\u6b62\u624d\u80fd\u7ee7\u7eed\uff08\u50cf\u56fe 7-1 \u90a3\u6837\u8bfb\u53d6\u65e7\u7248\u672c\u7684\u5bf9\u8c61\u5728 2PL \u4e0b\u662f\u4e0d\u53ef\u63a5\u53d7\u7684\uff09\u3002</li> </ul> <p>2PL \u548c\u5feb\u7167\u9694\u79bb\u4e4b\u95f4\u7684\u5173\u952e\u533a\u522b\uff1a</p> <ul> <li>2PL \u4e2d\uff0c\u5199\u5165\u4e0d\u4ec5\u4f1a\u963b\u585e\u5176\u4ed6\u5199\u5165\uff0c\u4e5f\u4f1a\u963b\u585e\u8bfb\uff0c\u53cd\u4e4b\u4ea6\u7136</li> <li>\u5feb\u7167\u9694\u79bb\u4f7f\u5f97 \u8bfb\u4e0d\u963b\u585e\u5199\uff0c\u5199\u4e5f\u4e0d\u963b\u585e\u8bfb</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_35","title":"\u5b9e\u73b0\u4e24\u9636\u6bb5\u9501","text":"<p>2PL \u7528\u4e8e MySQL\uff08InnoDB\uff09\u548c SQL Server \u4e2d\u7684\u53ef\u4e32\u884c\u5316\u9694\u79bb\u7ea7\u522b\uff0c\u4ee5\u53ca DB2 \u4e2d\u7684\u53ef\u91cd\u590d\u8bfb\u9694\u79bb\u7ea7\u522b\u3002</p> <p>\u8bfb\u4e0e\u5199\u7684\u963b\u585e\u662f\u901a\u8fc7\u4e3a\u6570\u636e\u5e93\u4e2d\u6bcf\u4e2a\u5bf9\u8c61\u6dfb\u52a0\u9501\u6765\u5b9e\u73b0\u7684\u3002\u9501\u53ef\u4ee5\u5904\u4e8e \u5171\u4eab\u6a21\u5f0f\uff08shared mode\uff09 \u6216 \u72ec\u5360\u6a21\u5f0f\uff08exclusive mode\uff09\uff0c\u7c7b\u4f3c\u4e8e\u8bfb\u5199\u9501\u3002</p> <ul> <li> <p>\u82e5\u4e8b\u52a1\u8981\u5199\u5165\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5b83\u5fc5\u987b\u9996\u5148\u4ee5\u72ec\u5360\u6a21\u5f0f\u83b7\u53d6\u8be5\u9501\u3002\uff08\u7c7b\u4f3c\u4e8e\u5199\u9501\uff09</p> </li> <li> <p>\u82e5\u4e8b\u52a1\u8981\u8bfb\u53d6\u5bf9\u8c61\uff0c\u5219\u987b\u5148\u4ee5\u5171\u4eab\u6a21\u5f0f\u83b7\u53d6\u9501\u3002\uff08\u7c7b\u4f3c\u4e8e\u8bfb\u9501\uff09</p> </li> <li> <p>\u5982\u679c\u4e8b\u52a1\u5148\u8bfb\u53d6\u518d\u5199\u5165\u5bf9\u8c61\uff0c\u5219\u5b83\u53ef\u80fd\u4f1a\u5c06\u5176\u5171\u4eab\u9501\u5347\u7ea7\u4e3a\u72ec\u5360\u9501\u3002</p> </li> <li> <p>\u5982\u679c\u6b64\u65f6\u5176\u5b83\u4e8b\u52a1\u5177\u5907\u8bfb\u9501\uff0c\u90a3\u4e48\u80fd\u5347\u7ea7\u4e48\uff1f\u5bfc\u81f4\u6b7b\u9501\u4e48\uff1f</p> </li> <li> <p>MySQL \u9700\u8981\u663e\u793a\u58f0\u660e<code>SELECT</code>\u7528\u4ec0\u4e48\u9501\uff0c\u6bcf\u4e2a\u4e8b\u52a1\u90fd\u662f<code>\u8bfb\u9501+\u5199\u9501</code>\u7684SQL\u4f1a\u5bfc\u81f4\u6b7b\u9501\uff0c\u5982\u4e0b\u9762\u7684\u793a\u4f8b</p> <pre><code># \u4e0b\u9762\u5c31\u662f\u9519\u8bef\u7684\u793a\u4f8b\uff0c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\uff0c\u4e0d\u80fd\u524d\u9762\u7528\u8bfb\u9501\uff0c\u540e\u9762\u7528\u5199\u9501\uff0c\u5e76\u53d1\u573a\u666f\u4e0b\uff0c\u4f1a\u51fa\u73b0\u6b7b\u9501\n# \u5bf9\u8bfb\u53d6\u7684\u8bb0\u5f55\u52a0\u5171\u4eab\u9501(S\u578b\u9501)\nselect ... lock in share mode;\n# \u66f4\u65b0\u9501\u5b9a\u7684\u8bb0\u5f55\nupdate ...\n</code></pre> </li> <li> <p>\u4e8b\u52a1\u83b7\u5f97\u9501\u4e4b\u540e\uff0c\u5fc5\u987b\u7ee7\u7eed\u6301\u6709\u9501\u76f4\u5230\u4e8b\u52a1\u7ed3\u675f\uff08\u63d0\u4ea4\u6216\u4e2d\u6b62\uff09</p> </li> </ul> <p>\u6b7b\u9501\uff1a\u4e8b\u52a1 A \u7b49\u5f85\u4e8b\u52a1 B \u91ca\u653e\u5b83\u7684\u9501\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002</p> <p>\u6570\u636e\u5e93\u4f1a\u81ea\u52a8\u68c0\u6d4b\u4e8b\u52a1\u4e4b\u95f4\u7684\u6b7b\u9501\uff0c\u5e76\u4e2d\u6b62\u5176\u4e2d\u4e00\u4e2a\uff0c\u4ee5\u4fbf\u53e6\u4e00\u4e2a\u7ee7\u7eed\u6267\u884c\u3002\u88ab\u4e2d\u6b62\u7684\u4e8b\u52a1\u9700\u8981\u7531\u5e94\u7528\u7a0b\u5e8f\u91cd\u8bd5\u3002</p>"},{"location":"books/data_intensive_system_book/7_transaction.html#_36","title":"\u4e24\u9636\u6bb5\u9501\u5b9a\u7684\u6027\u80fd","text":"<p>\u4e24\u9636\u6bb5\u9501\u5b9a\u4e0b\u7684\u4e8b\u52a1\u541e\u5410\u91cf\u4e0e\u67e5\u8be2\u54cd\u5e94\u65f6\u95f4\u8981\u6bd4\u5f31\u9694\u79bb\u7ea7\u522b\u4e0b\u8981\u5dee\u5f97\u591a\u3002</p> <ul> <li>\u4e00\u90e8\u5206\u662f\u7531\u4e8e\u83b7\u53d6\u548c\u91ca\u653e\u6240\u6709\u8fd9\u4e9b\u9501\u7684\u5f00\u9500\uff0c\u4f46\u66f4\u91cd\u8981\u7684\u662f\u7531\u4e8e\u5e76\u53d1\u6027\u7684\u964d\u4f4e\uff1b</li> <li>\u8fd0\u884c 2PL \u7684\u6570\u636e\u5e93\u53ef\u80fd\u5177\u6709\u76f8\u5f53\u4e0d\u7a33\u5b9a\u7684\u5ef6\u8fdf\uff0c\u56e0\u4e3a\u4e8b\u52a1\u9700\u8981\u7b49\u5f85\uff1b</li> <li>\u57fa\u4e8e 2PL \u5b9e\u73b0\u7684\u53ef\u4e32\u884c\u5316\u9694\u79bb\u7ea7\u522b\u4e2d\uff0c\u6b7b\u9501\u4f1a\u51fa\u73b0\u7684\u9891\u7e41\u7684\u591a\uff08\u53d6\u51b3\u4e8e\u4e8b\u52a1\u7684\u8bbf\u95ee\u6a21\u5f0f\uff09\uff0c\u91cd\u8bd5\u964d\u4f4e\u6027\u80fd\uff1b</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_37","title":"\u8c13\u8bcd\u9501","text":"<p>\u8c13\u8bcd\u9501\uff08predicate lock\uff09\\(^{[24]}\\)\u7c7b\u4f3c\u4e8e\u524d\u9762\u63cf\u8ff0\u7684\u5171\u4eab / \u6392\u5b83\u9501\uff0c\u4f46\u4e0d\u5c5e\u4e8e\u7279\u5b9a\u7684\u5bf9\u8c61\uff08\u4f8b\u5982\uff0c\u8868\u4e2d\u7684\u4e00\u884c\uff09\uff0c\u5b83\u5c5e\u4e8e\u6240\u6709\u7b26\u5408\u67d0\u4e9b\u641c\u7d22\u6761\u4ef6\u7684\u5bf9\u8c61\uff0c\u5982\uff1a</p> <pre><code>SELECT * FROM bookings\nWHERE room_id = 123 AND\n      end_time &gt; '2018-01-01 12:00' AND\n      start_time &lt; '2018-01-01 13:00';\n</code></pre> <ul> <li>\u5982\u679c\u4e8b\u52a1 A \u60f3\u8981\u8bfb\u53d6\u5339\u914d\u67d0\u4e9b\u6761\u4ef6\u7684\u5bf9\u8c61\uff0c\u5fc5\u987b\u83b7\u53d6\u67e5\u8be2\u6761\u4ef6\u4e0a\u7684 \u5171\u4eab\u8c13\u8bcd\u9501\uff08shared-mode predicate lock\uff09\uff1b</li> <li>\u5982\u679c\u4e8b\u52a1 A \u60f3\u8981\u63d2\u5165\uff0c\u66f4\u65b0\u6216\u5220\u9664\u4efb\u4f55\u5bf9\u8c61\uff0c\u5219\u5fc5\u987b\u9996\u5148\u68c0\u67e5\u65e7\u503c\u6216\u65b0\u503c\u662f\u5426\u4e0e\u4efb\u4f55\u73b0\u6709\u7684\u8c13\u8bcd\u9501\u5339\u914d\u3002\u5982\u679c\u4e8b\u52a1 B \u6301\u6709\u5339\u914d\u7684\u8c13\u8bcd\u9501\uff0c\u90a3\u4e48 A \u5fc5\u987b\u7b49\u5230 B \u5df2\u7ecf\u63d0\u4ea4\u6216\u4e2d\u6b62\u540e\u624d\u80fd\u7ee7\u7eed\u3002</li> </ul> <p>\u5982\u679c\u4e24\u9636\u6bb5\u9501\u5b9a\u5305\u542b\u8c13\u8bcd\u9501\uff0c\u5219\u6570\u636e\u5e93\u5c06\u963b\u6b62\u6240\u6709\u5f62\u5f0f\u7684\u5199\u5165\u504f\u5dee\u548c\u5176\u4ed6\u7ade\u4e89\u6761\u4ef6\uff0c\u56e0\u6b64\u5176\u9694\u79bb\u5b9e\u73b0\u4e86\u53ef\u4e32\u884c\u5316\u3002</p>"},{"location":"books/data_intensive_system_book/7_transaction.html#_38","title":"\u7d22\u5f15\u8303\u56f4\u9501","text":"<p>\u5728\u5199\u5165\u504f\u5dee\u7684\u66f4\u591a\u4f8b\u5b50\u4e2d\uff0c\u7ed9\u51fa\u793a\u4f8b\u8bf4\u53ef\u4ee5\u5c06 SQL \u6539\u4e0b\uff0c\u7528\u4e8e\u9501\u5b9a\u76f8\u5173\u7684\u884c\uff08\u6392\u4ed6\u9501\uff09\uff0c\u5c31\u662f\u4f7f\u7528\u8fd9\u4e2a\u7d22\u5f15\u8303\u56f4\u9501\u3002</p> <p>MySQL InnoDB \u5728\u53ef\u91cd\u590d\u8bfb\u7684\u9694\u79bb\u7ea7\u522b\u4e2d\uff0c\u901a\u8fc7  next-key lock\uff08\u8bb0\u5f55\u9501+\u95f4\u9699\u9501\uff09 \u5b9e\u73b0\u9501\u5b9a</p> <ul> <li><code>SELECT FOR UPDATE</code>\u4f1a\u6839\u636e\u4e0d\u540c\u7684\u67e5\u8be2\uff08\u7b49\u503c/\u8303\u56f4\uff09\u60c5\u51b5\u548c\u7d22\u5f15\u60c5\u51b5\uff0c\u7528\u4e0d\u540c\u7c7b\u578b\u7684\u9501</li> </ul> <p>\u4e0d\u5e78\u7684\u662f\u8c13\u8bcd\u9501\u6027\u80fd\u4e0d\u4f73\uff1a\u5982\u679c\u6d3b\u8dc3\u4e8b\u52a1\u6301\u6709\u5f88\u591a\u9501\uff0c\u68c0\u67e5\u5339\u914d\u7684\u9501\u4f1a\u975e\u5e38\u8017\u65f6\u3002 \u56e0\u6b64\uff0c\u5927\u591a\u6570\u4f7f\u7528 2PL \u7684\u6570\u636e\u5e93\u5b9e\u9645\u4e0a\u5b9e\u73b0\u4e86\u7d22\u5f15\u8303\u56f4\u9501\uff08index-range locking\uff0c\u4e5f\u79f0\u4e3a next-key locking\\(^{[30]}\\)\uff09\uff0c\u8fd9\u662f\u4e00\u4e2a\u7b80\u5316\u7684\u8fd1\u4f3c\u7248\u8c13\u8bcd\u9501\u3002</p> <p>\u4f7f\u8c13\u8bcd\u5339\u914d\u5230\u4e00\u4e2a\u66f4\u5927\u7684\u96c6\u5408\u6765\u7b80\u5316\u8c13\u8bcd\u9501\u662f\u5b89\u5168\u7684\uff0c\u4efb\u4f55\u6ee1\u8db3\u539f\u59cb\u8c13\u8bcd\u7684\u5199\u5165\u4e5f\u4e00\u5b9a\u4f1a\u6ee1\u8db3\u8fd9\u79cd\u66f4\u677e\u6563\u7684\u8fd1\u4f3c\uff1a</p> <ul> <li>\u4f8b\u5982\u5728\u4e2d\u5348\u548c\u4e0b\u5348 1 \u70b9\u4e4b\u95f4\u9884\u8ba2 123 \u53f7\u623f\u95f4\u7684\u8c13\u8bcd\u9501\uff0c\u53ef\u4ee5\u9501\u5b9a 123 \u53f7\u623f\u95f4\u7684\u6240\u6709\u65f6\u95f4\u6bb5\uff0c\u6216\u8005\u9501\u5b9a 12:00~13:00 \u65f6\u95f4\u6bb5\u7684\u6240\u6709\u623f\u95f4</li> </ul> <p>\u5728\u623f\u95f4\u9884\u8ba2\u6570\u636e\u5e93\u4e2d\uff0c\u4f60\u53ef\u80fd\u4f1a\u5728 <code>room_id</code> \u5217\u4e0a\u6709\u4e00\u4e2a\u7d22\u5f15\uff0c\u5e76\u4e14 / \u6216\u8005\u5728 <code>start_time</code> \u548c <code>end_time</code> \u4e0a\u6709\u7d22\u5f15</p> <ul> <li>\u5047\u8bbe\u4f60\u7684\u7d22\u5f15\u4f4d\u4e8e <code>room_id</code>\uff0c\u67e5\u627e 123 \u53f7\u623f\u95f4\u7684\u73b0\u6709\u9884\u8ba2\uff0c\u6570\u636e\u5e93\u5c06\u5171\u4eab\u9501\u9644\u52a0\u5230\u8fd9\u4e2a\u7d22\u5f15\u9879\u4e0a\uff0c\u6307\u793a\u4e8b\u52a1\u5df2\u641c\u7d22 123 \u53f7\u623f\u95f4\u7528\u4e8e\u9884\u8ba2\u3002</li> <li>\u5982\u679c\u53e6\u4e00\u4e2a\u4e8b\u52a1\u60f3\u8981\u63d2\u5165\u3001\u66f4\u65b0\u6216\u5220\u9664\u540c\u4e00\u4e2a\u623f\u95f4\u548c / \u6216\u91cd\u53e0\u65f6\u95f4\u6bb5\u7684\u9884\u8ba2\uff0c\u5219\u5b83\u5c06\u4e0d\u5f97\u4e0d\u66f4\u65b0\u7d22\u5f15\u7684\u76f8\u540c\u90e8\u5206\uff0c\u9047\u5230\u5171\u4eab\u9501\u7b49\u5f85\u9501\u91ca\u653e\uff1b</li> </ul> <p>\u7d22\u5f15\u8303\u56f4\u9501\u5e76\u4e0d\u50cf\u8c13\u8bcd\u9501\u90a3\u6837\u7cbe\u786e\uff0c\u4f46\u662f\u7531\u4e8e\u5b83\u4eec\u7684\u5f00\u9500\u8f83\u4f4e\uff0c\u6240\u4ee5\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u6298\u8877\u3002</p> <ul> <li>\u5982\u679c\u6ca1\u6709\u53ef\u4ee5\u6302\u8f7d\u8303\u56f4\u9501\u7684\u7d22\u5f15\uff0c\u6570\u636e\u5e93\u53ef\u4ee5\u9000\u5316\u5230\u4f7f\u7528\u6574\u4e2a\u8868\u4e0a\u7684\u5171\u4eab\u9501\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_39","title":"\u53ef\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb","text":"<p>PG \u7684 Serializable \u5c31\u662f\u901a\u8fc7 SSI \u5b9e\u73b0\u7684\uff0c\u76f8\u6bd4 S2PL \u6027\u80fd\u6709\u63d0\u5347\u3002</p> <p>\u53ef\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb\uff08SSI, serializable snapshot isolation\uff09\\(^{31,32]}\\) \u7684\u7b97\u6cd5\u662f\u975e\u5e38\u6709\u524d\u9014</p> <ul> <li>\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u53ef\u4e32\u884c\u5316\u9694\u79bb\u7ea7\u522b\uff0c\u4f46\u4e0e\u5feb\u7167\u9694\u79bb\u76f8\u6bd4\u53ea\u6709\u5f88\u5c0f\u7684\u6027\u80fd\u635f\u5931\uff1b</li> <li>SSI \u65e2\u7528\u4e8e\u5355\u8282\u70b9\u6570\u636e\u5e93\uff08PostgreSQL9.1 \u4ee5\u540e\u7684\u53ef\u4e32\u884c\u5316\u9694\u79bb\u7ea7\u522b\uff09\uff0c\u4e5f\u7528\u4e8e\u5206\u5e03\u5f0f\u6570\u636e\u5e93\uff08FoundationDB \u4f7f\u7528\u7c7b\u4f3c\u7684\u7b97\u6cd5\uff09</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_40","title":"\u60b2\u89c2\u4e0e\u4e50\u89c2\u7684\u5e76\u53d1\u63a7\u5236","text":"<p>\u4e24\u9636\u6bb5\u9501\u662f\u4e00\u79cd\u6240\u8c13\u7684 \u60b2\u89c2\u5e76\u53d1\u63a7\u5236\u673a\u5236\uff08pessimistic\uff09 </p> <ul> <li>\u5982\u679c\u6709\u4e8b\u60c5\u53ef\u80fd\u51fa\u9519\uff08\u5982\u53e6\u4e00\u4e2a\u4e8b\u52a1\u6240\u6301\u6709\u7684\u9501\u6240\u8868\u793a\u7684\uff09\uff0c\u6700\u597d\u7b49\u5230\u60c5\u51b5\u5b89\u5168\u540e\u518d\u505a\u4efb\u4f55\u4e8b\u60c5\uff0c\u7c7b\u4f3c\u4e8e\u4e92\u65a5\uff1b</li> <li>\u4e32\u884c\u6267\u884c\u53ef\u4ee5\u79f0\u4e3a\u60b2\u89c2\u5230\u4e86\u6781\u81f4\uff1a\u5728\u4e8b\u52a1\u6301\u7eed\u671f\u95f4\uff0c\u6bcf\u4e2a\u4e8b\u52a1\u5bf9\u6574\u4e2a\u6570\u636e\u5e93\uff08\u6216\u6570\u636e\u5e93\u7684\u4e00\u4e2a\u5206\u533a\uff09\u5177\u6709\u6392\u5b83\u9501\u3002</li> </ul> <p>\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb \u662f\u4e00\u79cd \u4e50\u89c2\uff08optimistic\uff09 \u7684\u5e76\u53d1\u63a7\u5236\u6280\u672f</p> <ul> <li>\u5982\u679c\u5b58\u5728\u6f5c\u5728\u7684\u5371\u9669\u4e5f\u4e0d\u963b\u6b62\u4e8b\u52a1\uff0c\u800c\u662f\u7ee7\u7eed\u6267\u884c\u4e8b\u52a1\uff0c\u5e0c\u671b\u4e00\u5207\u90fd\u4f1a\u597d\u8d77\u6765\uff1b</li> <li>\u5f53\u4e00\u4e2a\u4e8b\u52a1\u60f3\u8981\u63d0\u4ea4\u65f6\uff0c\u6570\u636e\u5e93\u68c0\u67e5\u662f\u5426\u6709\u4ec0\u4e48\u4e0d\u597d\u7684\u4e8b\u60c5\u53d1\u751f\uff08\u5373\u9694\u79bb\u662f\u5426\u88ab\u8fdd\u53cd\uff09\uff1b</li> <li>\u5982\u679c\u662f\u7684\u8bdd\uff0c\u4e8b\u52a1\u5c06\u88ab\u4e2d\u6b62\uff0c\u5e76\u4e14\u5fc5\u987b\u91cd\u8bd5\u3002</li> </ul> <p>\u4e50\u89c2\u5e76\u53d1\u63a7\u5236\u662f\u4e00\u4e2a\u53e4\u8001\u7684\u60f3\u6cd5\\(^{[33]}\\)</p> <ul> <li> <p>\u5176\u4f18\u70b9\u662f\uff1a</p> </li> <li> <p>\u5982\u679c\u6709\u8db3\u591f\u7684\u7a7a\u95f2\u5bb9\u91cf\uff0c\u5e76\u4e14\u4e8b\u52a1\u4e4b\u95f4\u7684\u4e89\u7528\u4e0d\u662f\u592a\u9ad8\uff0c\u4e50\u89c2\u7684\u5e76\u53d1\u63a7\u5236\u6280\u672f\u5f80\u5f80\u6bd4\u60b2\u89c2\u7684\u6027\u80fd\u8981\u597d</p> </li> <li> <p>\u5176\u7f3a\u70b9\u662f\uff1a</p> </li> <li> <p>\u5982\u679c\u5b58\u5728\u5f88\u591a \u4e89\u7528\uff08contention\uff0c\u5373\u5f88\u591a\u4e8b\u52a1\u8bd5\u56fe\u8bbf\u95ee\u76f8\u540c\u7684\u5bf9\u8c61\uff09\uff0c\u5219\u8868\u73b0\u4e0d\u4f73\uff0c\u56e0\u4e3a\u8fd9\u4f1a\u5bfc\u81f4\u5f88\u5927\u4e00\u90e8\u5206\u4e8b\u52a1\u9700\u8981\u4e2d\u6b62</p> </li> <li> <p>\u5982\u679c\u7cfb\u7edf\u5df2\u7ecf\u63a5\u8fd1\u6700\u5927\u541e\u5410\u91cf\uff0c\u6765\u81ea\u91cd\u8bd5\u4e8b\u52a1\u7684\u989d\u5916\u8d1f\u8f7d\u53ef\u80fd\u4f1a\u4f7f\u6027\u80fd\u53d8\u5dee</p> </li> </ul> <p>SSI \u57fa\u4e8e\u5feb\u7167\u9694\u79bb\uff1a\u4e8b\u52a1\u4e2d\u7684\u6240\u6709\u8bfb\u53d6\u90fd\u662f\u6765\u81ea\u6570\u636e\u5e93\u7684\u4e00\u81f4\u6027\u5feb\u7167\u3002</p> <ul> <li>\u6dfb\u52a0\u4e86\u4e00\u79cd\u7b97\u6cd5\u6765\u68c0\u6d4b\u5199\u5165\u4e4b\u95f4\u7684\u4e32\u884c\u5316\u51b2\u7a81\uff0c\u5e76\u786e\u5b9a\u8981\u4e2d\u6b62\u54ea\u4e9b\u4e8b\u52a1</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_41","title":"\u57fa\u4e8e\u8fc7\u65f6\u524d\u63d0\u7684\u51b3\u7b56","text":"<p>\u4e8b\u52a1\u4e2d\u7684\u67e5\u8be2\u4e0e\u5199\u5165\u53ef\u80fd\u5b58\u5728\u56e0\u679c\u4f9d\u8d56\u3002\u4e3a\u4e86\u63d0\u4f9b\u53ef\u4e32\u884c\u5316\u7684\u9694\u79bb\u7ea7\u522b\uff0c\u5982\u679c\u4e8b\u52a1\u5728\u8fc7\u65f6\u7684\u524d\u63d0\u4e0b\u6267\u884c\u64cd\u4f5c\uff0c\u6570\u636e\u5e93\u5fc5\u987b\u80fd\u68c0\u6d4b\u5230\u8fd9\u79cd\u60c5\u51b5\uff0c\u5e76\u4e2d\u6b62\u4e8b\u52a1\u3002</p> <p>\u6570\u636e\u5e93\u5982\u4f55\u77e5\u9053\u67e5\u8be2\u7ed3\u679c\u662f\u5426\u53ef\u80fd\u5df2\u7ecf\u6539\u53d8\uff1f\u6709\u4e24\u79cd\u60c5\u51b5\u9700\u8981\u8003\u8651\uff1a</p> <ul> <li>\u68c0\u6d4b\u5bf9\u65e7 MVCC \u5bf9\u8c61\u7248\u672c\u7684\u8bfb\u53d6\uff08\u8bfb\u4e4b\u524d\u5b58\u5728\u672a\u63d0\u4ea4\u7684\u5199\u5165\uff09</li> <li>\u68c0\u6d4b\u5f71\u54cd\u5148\u524d\u8bfb\u53d6\u7684\u5199\u5165\uff08\u8bfb\u4e4b\u540e\u53d1\u751f\u5199\u5165\uff09</li> </ul> <p>\u68c0\u6d4b\u65e7MVCC\u8bfb\u53d6</p> <p>\u5f53\u4e00\u4e2a\u4e8b\u52a1\u4ece MVCC \u6570\u636e\u5e93\u4e2d\u7684\u4e00\u81f4\u5feb\u7167\u8bfb\u65f6\uff0c\u5b83\u5c06\u5ffd\u7565\u53d6\u5feb\u7167\u65f6\u5c1a\u672a\u63d0\u4ea4\u7684\u4efb\u4f55\u5176\u4ed6\u4e8b\u52a1\u6240\u505a\u7684\u5199\u5165\u3002</p> <ul> <li>\u4e0b\u56fe\u4e2d\uff1a\u4e8b\u52a1 43 \u8ba4\u4e3a Alice \u7684 <code>on_call = true</code> \uff0c\u56e0\u4e3a\u4e8b\u52a1 42\uff08\u4fee\u6539 Alice \u7684\u5f85\u547d\u72b6\u6001\uff09\u672a\u88ab\u63d0\u4ea4\u3002\u7136\u800c\uff0c\u5728\u4e8b\u52a1 43 \u60f3\u8981\u63d0\u4ea4\u65f6\uff0c\u4e8b\u52a1 42 \u5df2\u7ecf\u63d0\u4ea4\u3002\u5728\u8bfb\u4e00\u81f4\u6027\u5feb\u7167\u65f6\u88ab\u5ffd\u7565\u7684\u5199\u5165\u5df2\u7ecf\u751f\u6548\uff0c\u4e8b\u52a1 43 \u7684\u524d\u63d0\u4e0d\u518d\u4e3a\u771f\u3002</li> </ul> <p></p> <p>\u89e3\u51b3\u65b9\u6848\uff1a\u6570\u636e\u5e93\u9700\u8981\u8ddf\u8e2a\u4e00\u4e2a\u4e8b\u52a1\u7531\u4e8e MVCC \u53ef\u89c1\u6027\u89c4\u5219\u800c\u5ffd\u7565\u53e6\u4e00\u4e2a\u4e8b\u52a1\u7684\u5199\u5165</p> <ul> <li>\u5f53\u4e8b\u52a1\u60f3\u8981\u63d0\u4ea4\u65f6\uff0c\u6570\u636e\u5e93\u68c0\u67e5\u662f\u5426\u6709\u4efb\u4f55\u88ab\u5ffd\u7565\u7684\u5199\u5165\u73b0\u5728\u5df2\u7ecf\u88ab\u63d0\u4ea4\u3002\u5982\u679c\u662f\u8fd9\u6837\uff0c\u4e8b\u52a1\u5fc5\u987b\u4e2d\u6b62\u3002</li> <li>\u4e3a\u4ec0\u4e48\u8981\u7b49\u5230\u63d0\u4ea4\uff1f\u56e0\u4e3a\u5982\u679c\u4e8b\u52a1\u53ea\u662f\u53ea\u8bfb\u4e8b\u52a1\uff0c\u4e0d\u9700\u8981\u4e2d\u6b62\u3002\u901a\u8fc7\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u4e2d\u6b62\uff0cSSI \u4fdd\u7559\u4e86\u5feb\u7167\u9694\u79bb\u4ece\u4e00\u81f4\u5feb\u7167\u4e2d\u957f\u65f6\u95f4\u8bfb\u53d6\u7684\u80fd\u529b\u3002</li> </ul> <p>\u68c0\u6d4b\u5f71\u54cd\u4e4b\u524d\u8bfb\u53d6\u7684\u5199\u5165</p> <p>\u8003\u8651\u7684\u662f\u53e6\u4e00\u4e2a\u4e8b\u52a1\u5728\u8bfb\u53d6\u6570\u636e\u4e4b\u540e\u4fee\u6539\u6570\u636e\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <ul> <li>SSI \u9501\uff0c\u7c7b\u4f3c\u7d22\u5f15\u8303\u56f4\u9501\uff0c\u5141\u8bb8\u6570\u636e\u5e93\u9501\u5b9a\u4e0e\u67d0\u4e2a\u641c\u7d22\u67e5\u8be2\u5339\u914d\u7684\u6240\u6709\u884c\u7684\u8bbf\u95ee\u6743\uff0c\u4f8b\u5982 <code>WHERE shift_id = 1234</code>\uff0c\u4f46\u4e0d\u4f1a\u963b\u585e\u5176\u4ed6\u4e8b\u52a1\u3002</li> <li>\u4e8b\u52a1 42 \u548c 43 \u90fd\u5728\u73ed\u6b21 1234 \u67e5\u627e\u503c\u73ed\u533b\u751f\u3002\u5982\u679c\u5728 <code>shift_id</code> \u4e0a\u6709\u7d22\u5f15\uff0c\u5219\u6570\u636e\u5e93\u53ef\u4ee5\u4f7f\u7528\u7d22\u5f15\u9879 1234 \u6765\u8bb0\u5f55\u4e8b\u52a1 42 \u548c 43 \u8bfb\u53d6\u8fd9\u4e2a\u6570\u636e\u7684\u4e8b\u5b9e\u3002</li> <li>\u5982\u679c\u6ca1\u6709\u7d22\u5f15\uff0c\u8fd9\u4e2a\u4fe1\u606f\u53ef\u4ee5\u5728\u8868\u7ea7\u522b\u8fdb\u884c\u8ddf\u8e2a</li> <li>\u5728\u4e00\u4e2a\u4e8b\u52a1\u5b8c\u6210\uff08\u63d0\u4ea4\u6216\u4e2d\u6b62\uff09\uff0c\u5e76\u4e14\u6240\u6709\u7684\u5e76\u53d1\u4e8b\u52a1\u5b8c\u6210\u4e4b\u540e\uff0c\u6570\u636e\u5e93\u5c31\u53ef\u4ee5\u5fd8\u8bb0\u5b83\u8bfb\u53d6\u7684\u6570\u636e</li> <li>\u5f53\u4e8b\u52a1\u5199\u5165\u6570\u636e\u5e93\u65f6\uff0c\u5b83\u5fc5\u987b\u5728\u7d22\u5f15\u4e2d\u67e5\u627e\u6700\u8fd1\u66fe\u8bfb\u53d6\u53d7\u5f71\u54cd\u6570\u636e\u7684\u5176\u4ed6\u4e8b\u52a1</li> <li>\u7c7b\u4f3c\u4e8e\u5728\u53d7\u5f71\u54cd\u7684\u952e\u8303\u56f4\u4e0a\u83b7\u53d6\u5199\u9501\uff0c\u4f46\u9501\u5e76\u4e0d\u4f1a\u963b\u585e\u4e8b\u52a1\u76f4\u5230\u5176\u4ed6\u8bfb\u4e8b\u52a1\u5b8c\u6210\uff0c\u800c\u53ea\u662f\u7b80\u5355\u901a\u77e5\u5176\u4ed6\u4e8b\u52a1\uff1a\u4f60\u4eec\u8bfb\u8fc7\u7684\u6570\u636e\u53ef\u80fd\u4e0d\u662f\u6700\u65b0\u7684\u5566\u3002</li> <li>\u4e0b\u56fe\u4e2d\uff0c\u4e8b\u52a1 43 \u901a\u77e5\u4e8b\u52a1 42 \u5176\u5148\u524d\u8bfb\u5df2\u8fc7\u65f6</li> <li>\u4e8b\u52a1 42 \u9996\u5148\u63d0\u4ea4\u5e76\u6210\u529f\uff0c\u5c3d\u7ba1\u4e8b\u52a1 43 \u7684\u5199\u5f71\u54cd\u4e86 42 \uff0c\u4f46\u56e0\u4e3a\u4e8b\u52a1 43 \u5c1a\u672a\u63d0\u4ea4\uff0c\u6240\u4ee5\u5199\u5165\u5c1a\u672a\u751f\u6548\u3002</li> <li>\u5f53\u4e8b\u52a1 43 \u60f3\u8981\u63d0\u4ea4\u65f6\uff0c\u6765\u81ea\u4e8b\u52a1 42 \u7684\u51b2\u7a81\u5199\u5165\u5df2\u7ecf\u88ab\u63d0\u4ea4\uff0c\u6240\u4ee5\u4e8b\u52a1 43 \u5fc5\u987b\u4e2d\u6b62\u3002</li> </ul> <p></p>"},{"location":"books/data_intensive_system_book/7_transaction.html#_42","title":"\u53ef\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb\u7684\u6027\u80fd","text":"<p>\u4e00\u4e2a\u6743\u8861\u662f\u8ddf\u8e2a\u4e8b\u52a1\u7684\u8bfb\u53d6\u548c\u5199\u5165\u7684 \u7c92\u5ea6\uff08granularity\uff09</p> <ul> <li>\u6570\u636e\u5e93\u8be6\u7ec6\u5730\u8ddf\u8e2a\u6bcf\u4e2a\u4e8b\u52a1\u7684\u6d3b\u52a8\uff08\u7ec6\u7c92\u5ea6\uff09\uff0c\u66f4\u51c6\u786e\u77e5\u9053\u54ea\u4e9b\u4e8b\u52a1\u9700\u8981\u4e2d\u6b62\uff0c\u4f46\u662f\u8bb0\u8d26\uff08bookkeeping\uff09\u5f00\u9500\u4f1a\u5f88\u663e\u8457\uff1b</li> <li>\u7b80\u7565\u7684\u8ddf\u8e2a\u901f\u5ea6\u66f4\u5feb\uff08\u7c97\u7c92\u5ea6\uff09\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u66f4\u591a\u4e0d\u5fc5\u8981\u7684\u4e8b\u52a1\u4e2d\u6b62\u3002</li> </ul> <p>\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4e8b\u52a1\u53ef\u4ee5\u8bfb\u53d6\u88ab\u53e6\u4e00\u4e2a\u4e8b\u52a1\u8986\u76d6\u7684\u4fe1\u606f\uff1a\u8fd9\u53d6\u51b3\u4e8e\u53d1\u751f\u4e86\u4ec0\u4e48\uff0c\u6709\u65f6\u53ef\u4ee5\u8bc1\u660e\u6267\u884c\u7ed3\u679c\u65e0\u8bba\u5982\u4f55\u90fd\u662f\u53ef\u4e32\u884c\u5316\u7684\u3002</p> <ul> <li>PostgreSQL \u4f7f\u7528\u8fd9\u4e2a\u7406\u8bba\u6765\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u4e2d\u6b62\u6b21\u6570\\(^{[34]}\\)\u3002</li> </ul> <p>\u4e0e\u4e24\u9636\u6bb5\u9501\u5b9a\u76f8\u6bd4\uff0c\u53ef\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb\u7684\u6700\u5927\u4f18\u70b9\u662f\uff1a\u4e00\u4e2a\u4e8b\u52a1\u4e0d\u9700\u8981\u963b\u585e\u7b49\u5f85\u53e6\u4e00\u4e2a\u4e8b\u52a1\u6240\u6301\u6709\u7684\u9501</p> <p>\u4e0e\u4e32\u884c\u6267\u884c\u76f8\u6bd4\uff0c\u53ef\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb\u5e76\u4e0d\u5c40\u9650\u4e8e\u5355\u4e2a CPU \u6838\u7684\u541e\u5410\u91cf</p> <ul> <li>FoundationDB \u5c06\u4e32\u884c\u5316\u51b2\u7a81\u7684\u68c0\u6d4b\u5206\u5e03\u5728\u591a\u53f0\u673a\u5668\u4e0a\uff0c\u5141\u8bb8\u6269\u5c55\u5230\u5f88\u9ad8\u7684\u541e\u5410\u91cf\u3002</li> <li>\u5373\u4f7f\u6570\u636e\u53ef\u80fd\u8de8\u591a\u53f0\u673a\u5668\u8fdb\u884c\u5206\u533a\uff0c\u4e8b\u52a1\u4e5f\u53ef\u4ee5\u5728\u4fdd\u8bc1\u53ef\u4e32\u884c\u5316\u9694\u79bb\u7b49\u7ea7\u7684\u540c\u65f6\u8bfb\u5199\u591a\u4e2a\u5206\u533a\u4e2d\u7684\u6570\u636e\\(^{[35]}\\)</li> </ul> <p>\u4e2d\u6b62\u7387\u663e\u8457\u5f71\u54cd SSI \u7684\u6574\u4f53\u8868\u73b0\uff1a\u4f8b\u5982\u957f\u65f6\u95f4\u8bfb\u53d6\u548c\u5199\u5165\u6570\u636e\u7684\u4e8b\u52a1\u5f88\u53ef\u80fd\u4f1a\u53d1\u751f\u51b2\u7a81\u5e76\u4e2d\u6b62</p> <ul> <li>SSI \u8981\u6c42\u540c\u65f6\u8bfb\u5199\u7684\u4e8b\u52a1\u5c3d\u91cf\u77ed\uff08\u53ea\u8bfb\u7684\u957f\u4e8b\u52a1\u53ef\u80fd\u6ca1\u95ee\u9898\uff09</li> <li>\u5bf9\u4e8e\u6162\u4e8b\u52a1\uff0cSSI \u53ef\u80fd\u6bd4\u4e24\u9636\u6bb5\u9501\u5b9a\u6216\u4e32\u884c\u6267\u884c\u66f4\u4e0d\u654f\u611f</li> </ul>"},{"location":"books/data_intensive_system_book/7_transaction.html#_43","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>John D. Cook: \u201cACID Versus BASE for Database Transactions,\u201d johndcook.com, July 6, 2009.</li> <li>Gavin Clarke: \u201cNoSQL's CAP Theorem Busters: We Don't Drop ACID,\u201d theregister.co.uk, November 22, 2012.</li> <li>Peter Bailis, Alan Fekete, Ali Ghodsi, et al.: \u201cHAT, not CAP: Towards Highly Available Transactions,\u201d at 14th USENIX Workshop on Hot Topics in Operating Systems (HotOS), May 2013.</li> <li>Armando Fox, Steven D. Gribble, Yatin Chawathe, et al.: \u201cCluster-Based Scalable Network Services,\u201d at 16th ACM Symposium on Operating Systems Principles (SOSP), October 1997.</li> <li>Theo H\u00e4rder and Andreas Reuter: \u201cPrinciples of Transaction-Oriented Database Recovery,\u201d ACM Computing Surveys, volume 15, number 4, pages 287\u2013317, December 1983. doi:10.1145/289.291</li> <li>Philip A. Bernstein, Vassos Hadzilacos, and Nathan Goodman: Concurrency Control and Recovery in Database Systems. Addison-Wesley, 1987. ISBN: 978-0-201-10715-9, available online at research.microsoft.com.</li> <li>Mai Zheng, Joseph Tucek, Feng Qin, and Mark Lillibridge: \u201cUnderstanding the Robustness of SSDs Under Power Fault,\u201d at 11th USENIX Conference on File and Storage Technologies (FAST), February 2013.</li> <li>Laurie Denness: \u201cSSDs: A Gift and a Curse,\u201d laur.ie, June 2, 2015.</li> <li>Adam Surak: \u201cWhen Solid State Drives Are Not That Solid,\u201d blog.algolia.com, June 15, 2015.</li> <li>Thanumalayan Sankaranarayana Pillai, Vijay Chidambaram, Ramnatthan Alagappan, et al.: \u201cAll File Systems Are Not Created Equal: On the Complexity of Crafting Crash-Consistent Applications,\u201d at 11th USENIX Symposium on Operating Systems Design and Implementation (OSDI), October 2014.</li> <li>Chris Siebenmann: \u201cUnix's File Durability Problem,\u201d utcc.utoronto.ca, April 14, 2016.</li> <li>Lakshmi N. Bairavasundaram, Garth R. Goodson, Bianca Schroeder, et al.: \u201cAn Analysis of Data Corruption in the Storage Stack,\u201d at 6th USENIX Conference on File and Storage Technologies (FAST), February 2008.</li> <li>Bianca Schroeder, Raghav Lagisetty, and Arif Merchant: \u201cFlash Reliability in Production: The Expected and the Unexpected,\u201d at 14th USENIX Conference on File and Storage Technologies (FAST), February 2016.</li> <li>Don Allison: \u201cSSD Storage \u2013 Ignorance of Technology Is No Excuse,\u201d blog.korelogic.com, March 24, 2015.</li> <li>Peter Bailis, Alan Fekete, Ali Ghodsi, et al.: \u201cHAT, not CAP: Towards Highly Available Transactions,\u201d at 14th USENIX Workshop on Hot Topics in Operating Systems (HotOS), May 2013.</li> <li>Martin Kleppmann: \u201cHermitage: Testing the 'I' in ACID,\u201d martin.kleppmann.com, November 25, 2014.</li> <li>Jim N. Gray, Raymond A. Lorie, Gianfranco R. Putzolu, and Irving L. Traiger: \u201cGranularity of Locks and Degrees of Consistency in a Shared Data Base,\u201d in Modelling in Data Base Management Systems: Proceedings of the IFIP Working Conference on Modelling in Data Base Management Systems, edited by G. M. Nijssen, pages 364\u2013394, Elsevier/North Holland Publishing, 1976. Also in Readings in Database Systems, 4th edition, edited by Joseph M. Hellerstein and Michael Stonebraker, MIT Press, 2005. ISBN: 978-0-262-69314-1</li> <li>Hal Berenson, Philip A. Bernstein, Jim N. Gray, et al.: \u201cA Critique of ANSI SQL Isolation Levels,\u201d at ACM International Conference on Management of Data (SIGMOD), May 1995.</li> <li>Bruce Momjian: \u201cMVCC Unmasked,\u201d momjian.us, July 2014.</li> <li>Nikita Prokopov: \u201cUnofficial Guide to Datomic Internals,\u201d tonsky.me, May 6, 2014.</li> <li>Baron Schwartz: \u201cImmutability, MVCC, and Garbage Collection,\u201d xaprb.com, December 28, 2013.</li> <li>J. Chris Anderson, Jan Lehnardt, and Noah Slater: CouchDB: The Definitive Guide. O'Reilly Media, 2010. ISBN: 978-0-596-15589-6</li> <li>Joel Jacobson: \u201cRiak 2.0: Data Types,\u201d blog.joeljacobson.com, March 23, 2014.</li> <li>Kapali P. Eswaran, Jim N. Gray, Raymond A. Lorie, and Irving L. Traiger: \u201cThe Notions of Consistency and Predicate Locks in a Database System,\u201d Communications of the ACM, volume 19, number 11, pages 624\u2013633, November 1976.</li> <li>Alan Fekete, Dimitrios Liarokapis, Elizabeth O'Neil, et al.: \u201cMaking Snapshot Isolation Serializable,\u201d ACM Transactions on Database Systems, volume 30, number 2, pages 492\u2013528, June 2005. doi:10.1145/1071610.1071615</li> <li>Michael Stonebraker, Samuel Madden, Daniel J. Abadi, et al.: \u201cThe End of an Architectural Era (It\u2019s Time for a Complete Rewrite),\u201d at 33rd International Conference on Very Large Data Bases (VLDB), September 2007.</li> <li>John Hugg: \u201cH-Store/VoltDB Architecture vs. CEP Systems and Newer Streaming Architectures,\u201d at Data @Scale Boston, November 2014.</li> <li>Robert Kallman, Hideaki Kimura, Jonathan Natkins, et al.: \u201cH-Store: A High-Performance, Distributed Main Memory Transaction Processing System,\u201d Proceedings of the VLDB Endowment, volume 1, number 2, pages 1496\u20131499, August 2008.</li> <li>Rich Hickey: \u201cThe Architecture of Datomic,\u201d infoq.com, November 2, 2012.</li> <li>Joseph M. Hellerstein, Michael Stonebraker, and James Hamilton: \u201cArchitecture of a Database System,\u201d Foundations and Trends in Databases, volume 1, number 2, pages 141\u2013259, November 2007. doi:10.1561/1900000002</li> <li>Michael J. Cahill, Uwe R\u00f6hm, and Alan Fekete: \u201cSerializable Isolation for Snapshot Databases,\u201d at ACM International Conference on Management of Data (SIGMOD), June 2008. doi:10.1145/1376616.1376690</li> <li>Michael J. Cahill: \u201cSerializable Isolation for Snapshot Databases,\u201d PhD Thesis, University of Sydney, July 2009.</li> <li>D. Z. Badal: \u201cCorrectness of Concurrency Control and Implications in Distributed Databases,\u201d at 3rd International IEEE Computer Software and Applications Conference (COMPSAC), November 1979.</li> <li>Dan R. K. Ports and Kevin Grittner: \u201cSerializable Snapshot Isolation in PostgreSQL,\u201d at 38th International Conference on Very Large Databases (VLDB), August 2012.</li> <li>Dave Rosenthal: \u201cDatabases at 14.4MHz,\u201d blog.foundationdb.com, December 10, 2014.</li> </ol> <ol> <li> <p>\u4e25\u683c\u5730\u8bf4\uff0c\u539f\u5b50\u81ea\u589e\uff08atomic increment\uff09 \u8fd9\u4e2a\u672f\u8bed\u5728\u591a\u7ebf\u7a0b\u7f16\u7a0b\u7684\u610f\u4e49\u4e0a\u4f7f\u7528\u4e86\u539f\u5b50\u8fd9\u4e2a\u8bcd\u3002\u5728 ACID \u7684\u60c5\u51b5\u4e0b\uff0c\u5b83\u5b9e\u9645\u4e0a\u5e94\u8be5\u88ab\u79f0\u4e3a \u9694\u79bb\u7684\uff08isolated\uff09 \u7684\u6216 \u53ef\u4e32\u884c\u7684\uff08serializable\uff09 \u7684\u589e\u91cf\u3002\u4f46\u8fd9\u5c31\u592a\u5439\u6bdb\u6c42\u75b5\u4e86\u3002\u00a0\u21a9</p> </li> <li> <p>\u67d0\u4e9b\u6570\u636e\u5e93\u652f\u6301\u751a\u81f3\u66f4\u5f31\u7684\u9694\u79bb\u7ea7\u522b\uff0c\u79f0\u4e3a \u8bfb\u672a\u63d0\u4ea4\uff08Read uncommitted\uff09\u3002\u5b83\u53ef\u4ee5\u9632\u6b62\u810f\u5199\uff0c\u4f46\u4e0d\u9632\u6b62\u810f\u8bfb\u3002\u00a0\u21a9</p> </li> <li> <p>\u5728 PostgreSQL \u4e2d\uff0c<code>created_by</code> \u7684\u5b9e\u9645\u540d\u79f0\u4e3a <code>xmin</code>\uff0c<code>deleted_by</code> \u7684\u5b9e\u9645\u540d\u79f0\u4e3a <code>xmax</code> \u21a9</p> </li> <li> <p>\u8f76\u4e8b\uff1a\u5076\u7136\u51fa\u73b0\u7684\u77ac\u65f6\u9519\u8bef\u6709\u65f6\u79f0\u4e3a Heisenbug\uff0c\u800c\u786e\u5b9a\u6027\u7684\u95ee\u9898\u5bf9\u5e94\u5730\u79f0\u4e3a Bohrbugs \u21a9</p> </li> <li> <p>\u4e8b\u5b9e\u4e0a\uff0c\u4e8b\u52a1 ID \u662f 32 \u4f4d\u6574\u6570\uff0c\u6240\u4ee5\u5927\u7ea6\u4f1a\u5728 40 \u4ebf\u6b21\u4e8b\u52a1\u4e4b\u540e\u6ea2\u51fa\u3002PostgreSQL \u7684 Vacuum \u8fc7\u7a0b\u4f1a\u6e05\u7406\u8001\u65e7\u7684\u4e8b\u52a1 ID\uff0c\u786e\u4fdd\u4e8b\u52a1 ID \u6ea2\u51fa\uff08\u56de\u5377\uff09\u4e0d\u4f1a\u5f71\u54cd\u5230\u6570\u636e\u3002\u00a0\u21a9</p> </li> <li> <p>\u5982\u679c\u4e8b\u52a1\u9700\u8981\u8bbf\u95ee\u4e0d\u5728\u5185\u5b58\u4e2d\u7684\u6570\u636e\uff0c\u6700\u597d\u7684\u89e3\u51b3\u65b9\u6848\u53ef\u80fd\u662f\u4e2d\u6b62\u4e8b\u52a1\uff0c\u5f02\u6b65\u5730\u5c06\u6570\u636e\u63d0\u53d6\u5230\u5185\u5b58\u4e2d\uff0c\u540c\u65f6\u7ee7\u7eed\u5904\u7406\u5176\u4ed6\u4e8b\u52a1\uff0c\u7136\u540e\u5728\u6570\u636e\u52a0\u8f7d\u5b8c\u6bd5\u65f6\u91cd\u65b0\u542f\u52a8\u4e8b\u52a1\u3002\u8fd9\u79cd\u65b9\u6cd5\u88ab\u79f0\u4e3a \u53cd\u7f13\u5b58\uff08anti-caching\uff09 \u21a9</p> </li> <li> <p>\u4e54\u30fb\u6d77\u52d2\u65af\u5766\uff08Joe Hellerstein\uff09\u6307\u51fa\uff0c\u5728 H\u00e4rder \u4e0e Reuter \u7684\u8bba\u6587\u4e2d\uff0c\u201cACID \u4e2d\u7684 C\u201d \u662f\u88ab \u201c\u6254\u8fdb\u53bb\u51d1\u7f29\u5199\u5355\u8bcd\u7684\u201d\\(^{[5]}\\)\uff0c\u800c\u4e14\u90a3\u65f6\u5019\u5927\u5bb6\u90fd\u4e0d\u600e\u4e48\u5728\u4e4e\u4e00\u81f4\u6027\u3002\u00a0\u21a9</p> </li> <li> <p>\u8fd9\u5e76\u4e0d\u5b8c\u7f8e\u3002\u5982\u679c TCP \u8fde\u63a5\u4e2d\u65ad\uff0c\u5219\u4e8b\u52a1\u5fc5\u987b\u4e2d\u6b62\u3002\u5982\u679c\u4e2d\u65ad\u53d1\u751f\u5728\u5ba2\u6237\u7aef\u8bf7\u6c42\u63d0\u4ea4\u4e4b\u540e\uff0c\u4f46\u5728\u670d\u52a1\u5668\u786e\u8ba4\u63d0\u4ea4\u53d1\u751f\u4e4b\u524d\uff0c\u5ba2\u6237\u7aef\u5e76\u4e0d\u77e5\u9053\u4e8b\u52a1\u662f\u5426\u5df2\u63d0\u4ea4\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u4e8b\u52a1\u7ba1\u7406\u5668\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u552f\u4e00\u4e8b\u52a1\u6807\u8bc6\u7b26\u6765\u5bf9\u64cd\u4f5c\u8fdb\u884c\u5206\u7ec4\uff0c\u8fd9\u4e2a\u6807\u8bc6\u7b26\u5e76\u672a\u7ed1\u5b9a\u5230\u7279\u5b9a TCP \u8fde\u63a5\u3002\u540e\u7eed\u518d \u201c\u6570\u636e\u5e93\u7684\u7aef\u5230\u7aef\u539f\u5219\u201d \u4e00\u8282\u5c06\u56de\u5230\u8fd9\u4e2a\u4e3b\u9898\u3002\u00a0\u21a9</p> </li> </ol>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html","title":"\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u9ebb\u70e6","text":"<p>\u80fd\u591f\u5728\u5355\u53f0\u8ba1\u7b97\u673a\u4e0a\u89e3\u51b3\u4e00\u4e2a\u95ee\u9898\uff0c\u90a3\u4e48\u5206\u5e03\u5f0f\u7cfb\u7edf\u5de5\u7a0b\u5e08\u901a\u5e38\u4f1a\u8ba4\u4e3a\u8fd9\u4e2a\u95ee\u9898\u662f\u5e73\u51e1\u7684\\(^{[1]}\\)\uff0c\u73b0\u5728\u5355\u4e2a\u8ba1\u7b97\u673a\u786e\u5b9e\u53ef\u4ee5\u505a\u5f88\u591a\u4e8b\u60c5\\(^{[2]}\\)\u3002\u4f46\u662f\u5bb9\u9519\u548c\u4f4e\u5ef6\u8fdf\u662f\u4e0d\u80fd\u7528\u5355\u4e2a\u8282\u70b9\u5b9e\u73b0\u7684\u3002</p> <p>\u4f7f\u7528\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0e\u5728\u4e00\u53f0\u8ba1\u7b97\u673a\u4e0a\u7f16\u5199\u8f6f\u4ef6\u6709\u7740\u6839\u672c\u7684\u533a\u522b\uff0c\u4e3b\u8981\u7684\u533a\u522b\u5728\u4e8e\uff0c\u6709\u8bb8\u591a\u65b0\u9896\u548c\u523a\u6fc0\u7684\u65b9\u6cd5\u53ef\u4ee5\u4f7f\u4e8b\u60c5\u51fa\u9519\\(^{[3,4]}\\)\u3002</p> <p>\u672c\u7ae0\u5bf9\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u53ef\u80fd\u51fa\u73b0\u7684\u95ee\u9898\u8fdb\u884c\u5f7b\u5e95\u7684\u60b2\u89c2\u548c\u6cae\u4e27\u7684\u603b\u7ed3\u3002\u6211\u4eec\u5c06\u7814\u7a76\u7f51\u7edc\u7684\u95ee\u9898\uff08\u201c\u4e0d\u53ef\u9760\u7684\u7f51\u7edc\u201d\uff09; \u65f6\u949f\u548c\u65f6\u5e8f\u95ee\u9898\uff08\u201c\u4e0d\u53ef\u9760\u7684\u65f6\u949f\u201d\uff09\u3002</p> <p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u53ef\u80fd\u53d1\u751f\u7684\u5404\u79cd\u95ee\u9898\uff0c\u5305\u62ec\uff1a</p> <ul> <li>\u7f51\u7edc\u6d88\u606f\u7684\u4e0d\u786e\u5b9a\u6027\uff1a\u6570\u636e\u5305\u53ef\u80fd\u4f1a\u4e22\u5931\u6216\u4efb\u610f\u5ef6\u8fdf\uff0c\u540c\u6837\u7b54\u590d\u53ef\u80fd\u4f1a\u4e22\u5931\u6216\u5ef6\u8fdf\uff0c\u4e0d\u6e05\u695a\u662f\u5426\u53d1\u9001\u6210\u529f\uff1b</li> <li>\u8282\u70b9\u65f6\u949f\u7684\u4e0d\u540c\u6b65\uff1a\u8282\u70b9\u7684\u65f6\u949f\u53ef\u80fd\u4f1a\u4e0e\u5176\u4ed6\u8282\u70b9\u663e\u8457\u4e0d\u540c\u6b65\uff08\u5c3d\u7ba1\u4f60\u5c3d\u6700\u5927\u52aa\u529b\u8bbe\u7f6e NTP\uff09\uff0c\u5b83\u53ef\u80fd\u4f1a\u7a81\u7136\u8df3\u8f6c\u6216\u8df3\u56de\uff1b</li> <li>\u8fdb\u7a0b\u7684\u6682\u505c\uff1a\u4e00\u4e2a\u8fdb\u7a0b\u53ef\u80fd\u4f1a\u5728\u5176\u6267\u884c\u7684\u4efb\u4f55\u65f6\u5019\u6682\u505c\u4e00\u6bb5\u76f8\u5f53\u957f\u7684\u65f6\u95f4\uff08\u53ef\u80fd\u662f\u56e0\u4e3a\u505c\u6b62\u6240\u6709\u5904\u7406\u7684\u5783\u573e\u6536\u96c6\u5668\uff09\uff0c\u88ab\u5176\u4ed6\u8282\u70b9\u5ba3\u544a\u6b7b\u4ea1\uff0c\u7136\u540e\u518d\u6b21\u590d\u6d3b\uff0c\u5374\u6ca1\u6709\u610f\u8bc6\u5230\u5b83\u88ab\u6682\u505c</li> </ul> <p>\u8fd9\u7c7b \u90e8\u5206\u5931\u6548\uff08partial failure\uff09 \u53ef\u80fd\u53d1\u751f\u7684\u4e8b\u5b9e\u662f\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u51b3\u5b9a\u6027\u7279\u5f81\u3002</p> <p>\u8bd5\u56fe\u5728\u8f6f\u4ef6\u4e2d\u5efa\u7acb \u90e8\u5206\u5931\u6548 \u7684\u5bb9\u9519\u673a\u5236\uff0c\u8fd9\u6837\u6574\u4e2a\u7cfb\u7edf\u5728\u5373\u4f7f\u67d0\u4e9b\u7ec4\u6210\u90e8\u5206\u88ab\u7834\u574f\u7684\u60c5\u51b5\u4e0b\uff0c\u4e5f\u53ef\u4ee5\u7ee7\u7eed\u8fd0\u884c\u3002</p> <ul> <li>\u68c0\u6d4b\uff1a\u5927\u591a\u6570\u6ca1\u6709\u68c0\u6d4b\u8282\u70b9\u662f\u5426\u6545\u969c\u7684\u51c6\u786e\u673a\u5236\uff0c\u5206\u5e03\u5f0f\u7b97\u6cd5\u4f9d\u9760\u8d85\u8d85\u65f6\u6765\u786e\u5b9a\u8fdc\u7a0b\u8282\u70b9\u662f\u5426\u53ef\u7528\uff1b</li> <li>\u8d85\u65f6\u65e0\u6cd5\u5374\u5206\u7f51\u7edc\u5931\u6548\u548c\u8282\u70b9\u5931\u6548\uff0c\u5e76\u4e14\u53ef\u53d8\u7684\u7f51\u7edc\u5ef6\u8fdf\u6709\u65f6\u4f1a\u5bfc\u81f4\u8282\u70b9\u88ab\u9519\u8bef\u5730\u6000\u7591\u53d1\u751f\u6545\u969c</li> <li>\u5bb9\u5fcd\uff1a\u8282\u70b9\u751a\u81f3\u4e0d\u80fd\u5c31\u73b0\u5728\u662f\u4ec0\u4e48\u65f6\u95f4\u8fbe\u6210\u4e00\u81f4</li> <li>\u9700\u8981\u4e00\u4e2a\u80fd\u4ece\u5176\u4ed6\u8282\u70b9\u83b7\u5f97\u5e2e\u52a9\u7684\u534f\u8bae\uff0c\u5e76\u4e89\u53d6\u8fbe\u5230\u6cd5\u5b9a\u4eba\u6570\u4ee5\u8fbe\u6210\u4e00\u81f4\u3002</li> </ul> <p>\u7f51\u7edc\u3001\u65f6\u949f\u548c\u8fdb\u7a0b\u7684\u4e0d\u53ef\u9760\u6027\u662f\u5426\u662f\u4e0d\u53ef\u907f\u514d\u7684\u81ea\u7136\u89c4\u5f8b</p> <ul> <li>\u53ef\u80fd\u7ed9\u7f51\u7edc\u63d0\u4f9b\u786c\u5b9e\u65f6\u7684\u54cd\u5e94\u4fdd\u8bc1\u548c\u6709\u9650\u7684\u5ef6\u8fdf\uff0c\u4f46\u662f\u8fd9\u6837\u505a\u975e\u5e38\u6602\u8d35\uff0c\u4e14\u5bfc\u81f4\u786c\u4ef6\u8d44\u6e90\u7684\u5229\u7528\u7387\u964d\u4f4e\u3002</li> <li>\u5927\u591a\u6570\u975e\u5b89\u5168\u5173\u952e\u7cfb\u7edf\u4f1a\u9009\u62e9 \u4fbf\u5b9c\u800c\u4e0d\u53ef\u9760\uff0c\u800c\u4e0d\u662f \u6602\u8d35\u548c\u53ef\u9760\u3002</li> </ul> <p>\u8d85\u7ea7\u8ba1\u7b97\u673a\u91c7\u7528\u53ef\u9760\u7684\u7ec4\u4ef6\uff0c\u56e0\u6b64\u5f53\u7ec4\u4ef6\u53d1\u751f\u6545\u969c\u65f6\u5fc5\u987b\u5b8c\u5168\u505c\u6b62\u5e76\u91cd\u65b0\u542f\u52a8\u3002</p> <p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u53ef\u4ee5\u6c38\u4e45\u8fd0\u884c\u800c\u4e0d\u4f1a\u5728\u670d\u52a1\u5c42\u9762\u4e2d\u65ad\uff0c\u56e0\u4e3a\u6240\u6709\u7684\u9519\u8bef\u548c\u7ef4\u62a4\u90fd\u53ef\u4ee5\u5728\u8282\u70b9\u7ea7\u522b\u8fdb\u884c\u5904\u7406 \u2014\u2014 \u81f3\u5c11\u5728\u7406\u8bba\u4e0a\u662f\u5982\u6b64\u3002</p>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_2","title":"\u6545\u969c\u4e0e\u90e8\u5206\u5931\u6548","text":"<p>\u5355\u4e2a\u8ba1\u7b97\u673a\u4e0a\u7684\u8f6f\u4ef6\u6ca1\u6709\u6839\u672c\u6027\u7684\u4e0d\u53ef\u9760\u539f\u56e0\uff1a</p> <ul> <li>\u786c\u4ef6\u6b63\u5e38\u5de5\u4f5c\u65f6\uff0c\u76f8\u540c\u7684\u64cd\u4f5c\u603b\u662f\u4ea7\u751f\u76f8\u540c\u7684\u7ed3\u679c\uff08\u8fd9\u662f\u786e\u5b9a\u6027\u7684\uff09</li> <li>\u5b58\u5728\u786c\u4ef6\u95ee\u9898\uff08\u4f8b\u5982\uff0c\u5185\u5b58\u635f\u574f\u6216\u8fde\u63a5\u5668\u677e\u52a8\uff09\uff0c\u5176\u540e\u679c\u901a\u5e38\u662f\u6574\u4e2a\u7cfb\u7edf\u6545\u969c\uff08\u4f8b\u5982\uff0c\u5185\u6838\u6050\u614c\uff0c\u201c\u84dd\u5c4f\u6b7b\u673a\u201d\uff0c\u542f\u52a8\u5931\u8d25\uff09</li> </ul> <p>\u4ece\u7b2c\u4e00\u53f0\u6570\u5b57\u8ba1\u7b97\u673a\u5f00\u59cb\uff0c\u59cb\u7ec8\u6b63\u786e\u5730\u8ba1\u7b97 \u8fd9\u4e2a\u8bbe\u8ba1\u76ee\u6807\u8d2f\u7a7f\u59cb\u7ec8\\(^{[5]}\\)\u3002</p> <ul> <li>\u8ba1\u7b97\u673a\u8bbe\u8ba1\u4e2d\u7684\u4e00\u4e2a\u6709\u610f\u7684\u9009\u62e9\uff1a\u5982\u679c\u53d1\u751f\u5185\u90e8\u9519\u8bef\uff0c\u6211\u4eec\u5b81\u613f\u7535\u8111\u5b8c\u5168\u5d29\u6e83\uff0c\u800c\u4e0d\u662f\u8fd4\u56de\u9519\u8bef\u7684\u7ed3\u679c</li> </ul> <p>\u800c\u5728\u73b0\u5b9e\u4e16\u754c\u4e2d\uff0c\u5404\u79cd\u5404\u6837\u7684\u4e8b\u60c5\u90fd\u53ef\u80fd\u4f1a\u51fa\u73b0\u95ee\u9898\\(^{[6]}\\)\u3002</p> <p>\u90e8\u5206\u5931\u6548\uff08partial failure\uff09\uff1a\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u7cfb\u7edf\u7684\u67d0\u4e9b\u90e8\u5206\u53ef\u80fd\u4f1a\u4ee5\u67d0\u79cd\u4e0d\u53ef\u9884\u77e5\u7684\u65b9\u5f0f\u88ab\u7834\u574f\u3002</p> <ul> <li>\u90e8\u5206\u5931\u6548\u662f \u4e0d\u786e\u5b9a\u6027\u7684\uff08nondeterministic\uff09</li> <li>\u4efb\u4f55\u6d89\u53ca\u591a\u4e2a\u8282\u70b9\u548c\u7f51\u7edc\u7684\u4e8b\u60c5\uff0c\u5b83\u6709\u65f6\u53ef\u80fd\u4f1a\u5de5\u4f5c\uff0c\u6709\u65f6\u4f1a\u51fa\u73b0\u4e0d\u53ef\u9884\u77e5\u7684\u5931\u8d25\uff1b\u751a\u81f3\u4e0d\u77e5\u9053\u662f\u5426\u6210\u529f\uff0c\u7f51\u7edc\u4f20\u64ad\u65f6\u95f4\u4e5f\u662f\u4e0d\u786e\u5b9a\u7684\uff1b</li> </ul> <p>\u8fd9\u79cd\u4e0d\u786e\u5b9a\u6027\u548c\u90e8\u5206\u5931\u6548\u7684\u53ef\u80fd\u6027\uff0c\u4f7f\u5f97\u5206\u5e03\u5f0f\u7cfb\u7edf\u96be\u4ee5\u5de5\u4f5c\\(^{[7]}\\)\u3002</p>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_3","title":"\u4e91\u8ba1\u7b97\u4e0e\u8d85\u7ea7\u8ba1\u7b97\u673a","text":"<p>\u5982\u4f55\u6784\u5efa\u5927\u578b\u8ba1\u7b97\u7cfb\u7edf\u6709\u4e00\u7cfb\u5217\u7684\u54f2\u5b66\uff1a</p> <ul> <li>\u4e00\u4e2a\u6781\u7aef\u662f\u9ad8\u6027\u80fd\u8ba1\u7b97\uff08HPC\uff09\u9886\u57df\uff1a\u901a\u5e38\u7528\u4e8e\u8ba1\u7b97\u5bc6\u96c6\u578b\u79d1\u5b66\u8ba1\u7b97\u4efb\u52a1\uff0c\u5982\u5929\u6c14\u9884\u62a5\u6216\u5206\u5b50\u52a8\u529b\u5b66\uff08\u6a21\u62df\u539f\u5b50\u548c\u5206\u5b50\u7684\u8fd0\u52a8\uff09</li> <li>\u53e6\u4e00\u4e2a\u6781\u7aef\u662f \u4e91\u8ba1\u7b97\uff08cloud computing\uff09\\(^{[8]}\\)\uff1a\u901a\u5e38\u4e0e\u591a\u79df\u6237\u6570\u636e\u4e2d\u5fc3\uff0c\u4ee5\u592a\u7f51\u8fde\u63a5\u7684\u5546\u7528\u8ba1\u7b97\u673a\uff0c\u5f39\u6027 / \u6309\u9700\u8d44\u6e90\u5206\u914d\u4ee5\u53ca\u8ba1\u91cf\u8ba1\u8d39\u7b49\u76f8\u5173\u8054\uff1b</li> </ul> <p>\u4e0d\u540c\u7684\u54f2\u5b66\u4f1a\u5bfc\u81f4\u4e0d\u540c\u7684\u6545\u969c\u5904\u7406\u65b9\u5f0f\uff1a</p> <ul> <li>\u8d85\u7ea7\u8ba1\u7b97\u673a\uff1a\u901a\u8fc7\u8ba9\u90e8\u5206\u5931\u8d25\u5347\u7ea7\u4e3a\u5b8c\u5168\u5931\u8d25\u6765\u5904\u7406\u90e8\u5206\u5931\u8d25</li> <li>\u4f5c\u4e1a\u901a\u5e38\u4f1a\u4e0d\u65f6\u5730\u5c06\u8ba1\u7b97\u7684\u72b6\u6001\u5b58\u76d8\u5230\u6301\u4e45\u5b58\u50a8\u4e2d\uff0c\u5355\u4e2a\u8282\u70b9\u6545\u969c\u540e\uff0c\u91cd\u65b0\u542f\u52a8\u5de5\u4f5c\u8d1f\u8f7d\u4ece\u4e0a\u4e00\u4e2a\u68c0\u67e5\u70b9\u5f00\u59cb\\(^{[9,10]}\\)\uff1b</li> <li>\u8d85\u7ea7\u8ba1\u7b97\u673a\u66f4\u50cf\u662f\u4e00\u4e2a\u5355\u8282\u70b9\u8ba1\u7b97\u673a\u800c\u4e0d\u662f\u5206\u5e03\u5f0f\u7cfb\u7edf</li> </ul> <p>\u672c\u4e66\u7684\u91cd\u70b9\u653e\u5728\u5b9e\u73b0\u4e92\u8054\u7f51\u670d\u52a1\u7684\u7cfb\u7edf\u4e0a\uff0c\u4e0e\u8d85\u7ea7\u8ba1\u7b97\u673a\u770b\u8d77\u6765\u6709\u5f88\u5927\u4e0d\u540c\uff1a</p> <ul> <li>\u53ef\u7528\u6027\uff1a\u4e92\u8054\u7f51\u670d\u52a1\u8981\u6c42\u4f4e\u5ef6\u8fdf\uff0c\u670d\u52a1\u4e0d\u53ef\u7528\uff08\u5982\u505c\u6b62\u96c6\u7fa4\u8fdb\u884c\u4fee\u590d\uff09\u662f\u4e0d\u53ef\u63a5\u53d7\uff1b\u50cf\u5929\u6c14\u6a21\u62df\u8fd9\u6837\u79bb\u7ebf\uff08\u6279\u5904\u7406\uff09\u5de5\u4f5c\u53ef\u4ee5\u91cd\u65b0\u542f\u52a8\uff1b</li> <li>\u786c\u4ef6\uff1a\u8d85\u7ea7\u8ba1\u7b97\u673a\u7531\u4e13\u7528\u786c\u4ef6\u6784\u6210\uff0c\u8282\u70b9\u76f8\u5f53\u53ef\u9760\uff0c\u8282\u70b9\u95f4\u901a\u8fc7\u5171\u4eab\u5185\u5b58\u548c\u8fdc\u7a0b\u76f4\u63a5\u5185\u5b58\u8bbf\u95ee\u8fdb\u884c\u901a\u4fe1\uff1b\u4e91\u670d\u52a1\u662f\u5546\u7528\u673a\u5668\u6784\u5efa\u800c\u6210\uff0c\u4ee5\u8f83\u4f4e\u7a0b\u672c\u63d0\u4f9b\u76f8\u540c\u6027\u80fd\uff0c\u4e14\u5177\u6709\u8f83\u9ad8\u7684\u6545\u969c\u7387\uff1b</li> <li>\u7f51\u7edc\uff1a\u8d85\u7ea7\u8ba1\u7b97\u673a\u901a\u5e38\u4f7f\u7528\u4e13\u95e8\u7684\u7f51\u7edc\u62d3\u6251\u7ed3\u6784\uff08\u5982\u591a\u7ef4\u7f51\u683c\u548cTorus\u7f51\u7edc\\(^{[12]}\\)\uff09\uff1b\u4e92\u8054\u7f51\u901a\u5e38\u57fa\u4e8eIP\u548c\u4ee5\u592a\u7f51\uff0c\u4ee5 CLOS \u62d3\u6251\u6392\u5217\uff0c\u63d0\u4f9b\u66f4\u9ad8\u7684\u5bf9\u5206\uff08bisection\uff09\u5e26\u5bbd\\(^{[11]}\\)\uff1b</li> <li>\u4f4d\u7f6e\uff1a\u8d85\u7ea7\u8ba1\u7b97\u673a\u901a\u5e38\u5047\u8bbe\u6240\u6709\u8282\u70b9\u90fd\u5728\u4e00\u8d77\uff0c\u800c\u4e92\u8054\u7f51\u53ef\u4ee5\u662f\u5730\u7406\u4f4d\u7f6e\u5206\u6563\u90e8\u7f72\uff0c\u4e0e\u672c\u5730\u7f51\u7edc\u76f8\u6bd4\uff0c\u901a\u4fe1\u901f\u5ea6\u7f13\u6162\u4e14\u4e0d\u53ef\u9760\uff1b</li> <li>\u6545\u969c\u5904\u7406\uff1a\u6210\u5343\u4e0a\u4e07\u7684\u8282\u70b9\u7684\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u603b\u4f1a\u6709\u4e00\u4e9b\u4e1c\u897f\u662f\u574f\u6389\u7684\\(^{[9]}\\)\u3002\u5982\u679c\u9519\u8bef\u5904\u7406\u7b56\u7565\u53ea\u662f\u7b80\u5355\u653e\u5f03\u7ec4\u6210\u65f6\uff0c\u4e00\u4e2a\u5927\u7684\u7cfb\u7edf\u6700\u7ec8\u4f1a\u82b1\u8d39\u5927\u91cf\u65f6\u95f4\u4ece\u9519\u8bef\u4e2d\u6062\u590d\uff0c\u800c\u4e0d\u662f\u505a\u6709\u7528\u7684\u5de5\u4f5c\\(^{[10]}\\)\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_4","title":"\u4ece\u4e0d\u53ef\u9760\u7684\u7ec4\u4ef6\u6784\u5efa\u53ef\u9760\u7684\u7cfb\u7edf","text":"<p>\u76f4\u89c2\u5730\u770b\u6765\uff0c\u7cfb\u7edf\u53ea\u80fd\u50cf\u5176\u6700\u4e0d\u53ef\u9760\u7684\u7ec4\u4ef6\uff08\u6700\u8584\u5f31\u7684\u73af\u8282\uff09\u4e00\u6837\u53ef\u9760\u3002\u4f46\u4e8b\u5b9e\u4e0a\uff0c\u4ece\u4e0d\u592a\u53ef\u9760\u7684\u6f5c\u5728\u57fa\u7840\u6784\u5efa\u66f4\u53ef\u9760\u7684\u7cfb\u7edf\u662f\u8ba1\u7b97\u673a\u9886\u57df\u7684\u4e00\u4e2a\u53e4\u8001\u601d\u60f3\\(^{[13]}\\)\uff1a</p> <ul> <li> <p>\u7ea0\u9519\u7801\u5141\u8bb8\u6570\u5b57\u6570\u636e\u5728\u901a\u4fe1\u4fe1\u9053\u4e0a\u51c6\u786e\u4f20\u8f93\uff0c\u5076\u5c14\u4f1a\u51fa\u73b0\u4e00\u4e9b\u9519\u8bef\uff0c\u4f8b\u5982\u7531\u4e8e\u65e0\u7ebf\u7f51\u7edc\u4e0a\u7684\u65e0\u7ebf\u7535\u5e72\u6270\\(^{[14]}\\)</p> </li> <li> <p>\u4e92\u8054\u7f51\u534f\u8bae\uff08Internet Protocol, IP\uff09 \u4e0d\u53ef\u9760\uff1a\u53ef\u80fd\u4e22\u5f03\u3001\u5ef6\u8fdf\u3001\u91cd\u590d\u6216\u91cd\u6392\u6570\u636e\u5305\u3002\u4f20\u8f93\u63a7\u5236\u534f\u8bae\uff08Transmission Control Protocol, TCP\uff09\u5728\u4e92\u8054\u7f51\u534f\u8bae\uff08IP\uff09\u4e4b\u4e0a\u63d0\u4f9b\u4e86\u66f4\u53ef\u9760\u7684\u4f20\u8f93\u5c42\u3002</p> </li> </ul> <p>\u867d\u7136\u8fd9\u4e2a\u7cfb\u7edf\u53ef\u4ee5\u6bd4\u5b83\u7684\u5e95\u5c42\u90e8\u5206\u66f4\u53ef\u9760\uff0c\u4f46\u5b83\u7684\u53ef\u9760\u6027\u603b\u662f\u6709\u9650\u7684\u3002</p> <ul> <li>\u7ea0\u9519\u7801\u53ef\u4ee5\u5904\u7406\u5c11\u91cf\u7684\u5355\u6bd4\u7279\u9519\u8bef\uff0c\u4f46\u662f\u5982\u679c\u4f60\u7684\u4fe1\u53f7\u88ab\u5e72\u6270\u6240\u6df9\u6ca1\uff0c\u90a3\u4e48\u901a\u8fc7\u4fe1\u9053\u53ef\u4ee5\u5f97\u5230\u591a\u5c11\u6570\u636e\uff0c\u662f\u6709\u6839\u672c\u6027\u7684\u9650\u5236\u7684\\(^{[15]}\\)</li> <li>TCP \u53ef\u4ee5\u9690\u85cf\u6570\u636e\u5305\u7684\u4e22\u5931\uff0c\u91cd\u590d\u548c\u91cd\u65b0\u6392\u5e8f\uff0c\u4f46\u662f\u5b83\u4e0d\u80fd\u795e\u5947\u5730\u6d88\u9664\u7f51\u7edc\u4e2d\u7684\u5ef6\u8fdf\u3002</li> </ul> <p>\u867d\u7136\u66f4\u53ef\u9760\u7684\u9ad8\u7ea7\u7cfb\u7edf\u5e76\u4e0d\u5b8c\u7f8e\uff0c\u4f46\u5b83\u4ecd\u7136\u6709\u7528\uff0c\u56e0\u4e3a\u5b83\u5904\u7406\u4e86\u4e00\u4e9b\u68d8\u624b\u7684\u4f4e\u7ea7\u9519\u8bef\uff0c\u6240\u4ee5\u5176\u4f59\u7684\u9519\u8bef\u901a\u5e38\u66f4\u5bb9\u6613\u63a8\u7406\u548c\u5904\u7406\u3002\u6211\u4eec\u5c06\u5728 \u201c\u6570\u636e\u5e93\u7684\u7aef\u5230\u7aef\u539f\u5219\u201d \u4e2d\u8fdb\u4e00\u6b65\u63a2\u8ba8\u8fd9\u4e2a\u95ee\u9898\u3002</p>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_5","title":"\u4e0d\u53ef\u9760\u7684\u7f51\u7edc","text":"<p>\u672c\u4e66\u4e2d\u5173\u6ce8\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u662f\u65e0\u5171\u4eab\u7684\u7cfb\u7edf\uff0c\u5373\u901a\u8fc7\u7f51\u7edc\u8fde\u63a5\u7684\u4e00\u5806\u673a\u5668\u3002</p> <p>\u4e92\u8054\u7f51\u548c\u6570\u636e\u4e2d\u5fc3\uff08\u901a\u5e38\u662f\u4ee5\u592a\u7f51\uff09\u4e2d\u7684\u5927\u591a\u6570\u5185\u90e8\u7f51\u7edc\u90fd\u662f \u5f02\u6b65\u5206\u7ec4\u7f51\u7edc\uff08asynchronous packet networks\uff09</p> <ul> <li>\u4e00\u4e2a\u8282\u70b9\u53ef\u4ee5\u5411\u53e6\u4e00\u4e2a\u8282\u70b9\u53d1\u9001\u4e00\u4e2a\u6d88\u606f\uff08\u4e00\u4e2a\u6570\u636e\u5305\uff09\uff0c\u4f46\u662f\u7f51\u7edc\u4e0d\u80fd\u4fdd\u8bc1\u5b83\u4ec0\u4e48\u65f6\u5019\u5230\u8fbe\uff0c\u6216\u8005\u662f\u5426\u5230\u8fbe</li> <li>\u53d1\u9001\u8bf7\u6c42\u5e76\u671f\u5f85\u54cd\u5e94\uff0c\u5219\u5f88\u591a\u4e8b\u60c5\u53ef\u80fd\u4f1a\u51fa\u9519\uff08\u5176\u4e2d\u4e00\u4e9b\u5982 \u56fe 8-1 \u6240\u793a\uff09\uff1a</li> <li>\u8bf7\u6c42\u53ef\u80fd\u5df2\u7ecf\u4e22\u5931\uff08\u53ef\u80fd\u6709\u4eba\u62d4\u6389\u4e86\u7f51\u7ebf\uff09\u3002</li> <li>\u8bf7\u6c42\u53ef\u80fd\u6b63\u5728\u6392\u961f\uff0c\u7a0d\u540e\u5c06\u4ea4\u4ed8\uff08\u4e5f\u8bb8\u7f51\u7edc\u6216\u63a5\u6536\u65b9\u8fc7\u8f7d\uff09\u3002</li> <li>\u8fdc\u7a0b\u8282\u70b9\u53ef\u80fd\u5df2\u7ecf\u5931\u6548\uff08\u53ef\u80fd\u662f\u5d29\u6e83\u6216\u5173\u673a\uff09\u3002</li> <li>\u8fdc\u7a0b\u8282\u70b9\u53ef\u80fd\u6682\u65f6\u505c\u6b62\u4e86\u54cd\u5e94\uff08\u53ef\u80fd\u4f1a\u9047\u5230\u957f\u65f6\u95f4\u7684\u5783\u573e\u56de\u6536\u6682\u505c\uff1b\u8bf7\u53c2\u9605 \u201c\u8fdb\u7a0b\u6682\u505c\u201d\uff09\uff0c\u4f46\u7a0d\u540e\u4f1a\u518d\u6b21\u54cd\u5e94\u3002</li> <li>\u8fdc\u7a0b\u8282\u70b9\u53ef\u80fd\u5df2\u7ecf\u5904\u7406\u4e86\u8bf7\u6c42\uff0c\u4f46\u662f\u7f51\u7edc\u4e0a\u7684\u54cd\u5e94\u5df2\u7ecf\u4e22\u5931\uff08\u53ef\u80fd\u662f\u7f51\u7edc\u4ea4\u6362\u673a\u914d\u7f6e\u9519\u8bef\uff09\u3002</li> <li>\u8fdc\u7a0b\u8282\u70b9\u53ef\u80fd\u5df2\u7ecf\u5904\u7406\u4e86\u8bf7\u6c42\uff0c\u4f46\u662f\u54cd\u5e94\u5df2\u7ecf\u88ab\u5ef6\u8fdf\uff0c\u5e76\u4e14\u7a0d\u540e\u5c06\u88ab\u4f20\u9012\uff08\u53ef\u80fd\u662f\u7f51\u7edc\u6216\u8005\u4f60\u81ea\u5df1\u7684\u673a\u5668\u8fc7\u8f7d\uff09\u3002</li> </ul> <p>\u56fe 8-1 \u5982\u679c\u53d1\u9001\u8bf7\u6c42\u5e76\u6ca1\u6709\u5f97\u5230\u54cd\u5e94\uff0c\u5219\u65e0\u6cd5\u533a\u5206\uff08a\uff09\u8bf7\u6c42\u662f\u5426\u4e22\u5931\uff0c\uff08b\uff09\u8fdc\u7a0b\u8282\u70b9\u662f\u5426\u5173\u95ed\uff0c\u6216\uff08c\uff09\u54cd\u5e94\u662f\u5426\u4e22\u5931\u3002</p> <p></p> <p>\u53d1\u9001\u8005\u4e0d\u80fd\u5206\u8fa8\u6570\u636e\u5305\u662f\u5426\u88ab\u53d1\u9001\uff0c\u4e0d\u80fd\u786e\u8ba4\u63a5\u6536\u8005\u662f\u5426\u5df2\u7ecf\u5904\u7406\uff1a</p> <ul> <li>\u5904\u7406\u8fd9\u4e2a\u95ee\u9898\u7684\u901a\u5e38\u65b9\u6cd5\u662f \u8d85\u65f6\uff08Timeout\uff09\uff1a\u5728\u4e00\u6bb5\u65f6\u95f4\u4e4b\u540e\u653e\u5f03\u7b49\u5f85\uff0c\u5e76\u4e14\u8ba4\u4e3a\u54cd\u5e94\u4e0d\u4f1a\u5230\u8fbe\u3002</li> <li>\u5bfc\u81f4\uff1a\u6d88\u606f\u88ab\u53d1\u9001\u591a\u6b21\uff0c\u6216\u8005\u88ab\u5904\u7406\u591a\u6b21\uff1b</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_6","title":"\u771f\u5b9e\u4e16\u754c\u7684\u7f51\u7edc\u6545\u969c","text":"<p>\u6709\u4eba\u53ef\u80fd\u5e0c\u671b\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u627e\u51fa\u4e86\u4f7f\u7f51\u7edc\u53d8\u5f97\u53ef\u9760\u7684\u65b9\u6cd5\u3002\u4f46\u662f\u73b0\u5728\u4f3c\u4e4e\u8fd8\u6ca1\u6709\u6210\u529f\u3002</p> <p>\u5373\u4f7f\u5728\u50cf\u4e00\u5bb6\u516c\u53f8\u8fd0\u8425\u7684\u6570\u636e\u4e2d\u5fc3\u90a3\u6837\u7684\u53d7\u63a7\u73af\u5883\u4e2d\uff0c\u7f51\u7edc\u95ee\u9898\u4e5f\u53ef\u80fd\u51fa\u4e4e\u610f\u6599\u5730\u666e\u904d\uff1a</p> <ul> <li>\u6bcf\u4e2a\u6708\u5927\u7ea6\u6709 12 \u4e2a\u7f51\u7edc\u6545\u969c\uff0c\u5176\u4e2d\u4e00\u534a\u65ad\u5f00\u4e00\u53f0\u673a\u5668\uff0c\u4e00\u534a\u65ad\u5f00\u6574\u4e2a\u673a\u67b6\\(^{[16]}\\)</li> <li>\u6dfb\u52a0\u5197\u4f59\u7f51\u7edc\u8bbe\u5907\u4e0d\u4f1a\u51cf\u5c11\u6545\u969c\uff0c\u4e0d\u80fd\u9632\u8303\u4eba\u4e3a\u9519\u8bef\uff08\u4f8b\u5982\uff0c\u9519\u8bef\u914d\u7f6e\u7684\u4ea4\u6362\u673a\uff0c\u4e2d\u65ad\u7684\u4e3b\u8981\u539f\u56e0\uff09\\(^{[17]}\\)</li> </ul> <p>\u8f6f\u4ef6\u9700\u8981\u80fd\u591f\u5904\u7406\u7f51\u7edc\u6545\u969c\uff1a</p> <ul> <li>\u5982\u679c\u7f51\u7edc\u6545\u969c\u7684\u9519\u8bef\u5904\u7406\u6ca1\u6709\u5b9a\u4e49\u4e0e\u6d4b\u8bd5\uff0c\u5404\u79cd\u9519\u8bef\u53ef\u80fd\u90fd\u4f1a\u53d1\u751f\uff0c\u5982\u5220\u9664\u6240\u6709\u6570\u636e\\(^{[18]}\\)\uff1b</li> </ul> <p>\u5904\u7406\u7f51\u7edc\u6545\u969c\u5e76\u4e0d\u610f\u5473\u7740\u5bb9\u5fcd\u5b83\u4eec\uff1a</p> <ul> <li>\u5f53\u4f60\u7684\u7f51\u7edc\u9047\u5230\u95ee\u9898\u65f6\uff0c\u7b80\u5355\u5730\u5411\u7528\u6237\u663e\u793a\u4e00\u6761\u9519\u8bef\u4fe1\u606f\uff1b</li> <li>\u9700\u8981\u77e5\u9053\u4f60\u7684\u8f6f\u4ef6\u5982\u4f55\u5e94\u5bf9\u7f51\u7edc\u95ee\u9898\uff0c\u5e76\u786e\u4fdd\u7cfb\u7edf\u80fd\u591f\u4ece\u4e2d\u6062\u590d\uff1b</li> <li>\u6709\u610f\u8bc6\u5730\u89e6\u53d1\u7f51\u7edc\u95ee\u9898\u5e76\u6d4b\u8bd5\u7cfb\u7edf\u54cd\u5e94</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_7","title":"\u7f51\u7edc\u5206\u533a","text":"<p>\u5f53\u7f51\u7edc\u7684\u4e00\u90e8\u5206\u7531\u4e8e\u7f51\u7edc\u6545\u969c\u800c\u88ab\u5207\u65ad\u65f6\uff0c\u6709\u65f6\u79f0\u4e3a \u7f51\u7edc\u5206\u533a\uff08network partition\uff09 \u6216 \u7f51\u7edc\u65ad\u88c2\uff08netsplit\uff09\u3002\u5728\u672c\u4e66\u4e2d\u4f7f\u7528\u66f4\u4e00\u822c\u7684\u672f\u8bed \u7f51\u7edc\u6545\u969c\uff08network fault\uff09\uff0c\u4ee5\u907f\u514d\u4e0e \u7b2c\u516d\u7ae0 \u8ba8\u8bba\u7684\u5b58\u50a8\u7cfb\u7edf\u7684\u5206\u533a\uff08\u5206\u7247\uff09\u76f8\u6df7\u6dc6\u3002</p>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_8","title":"\u68c0\u6d4b\u6545\u969c","text":"<p>\u8bb8\u591a\u7cfb\u7edf\u9700\u8981\u81ea\u52a8\u68c0\u6d4b\u6545\u969c\u8282\u70b9\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>\u8d1f\u8f7d\u5e73\u8861\u5668\u9700\u8981\u505c\u6b62\u5411\u5df2\u6b7b\u4ea1\u7684\u8282\u70b9\u8f6c\u53d1\u8bf7\u6c42\uff08\u4ece\u8f6e\u8be2\u5217\u8868\u79fb\u51fa\uff0c\u5373 out of rotation\uff09\uff1b</li> <li>\u5728\u5355\u4e3b\u590d\u5236\u529f\u80fd\u7684\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u4e2d\uff0c\u5982\u679c\u4e3b\u5e93\u5931\u6548\uff0c\u5219\u9700\u8981\u5c06\u4ece\u5e93\u4e4b\u4e00\u5347\u7ea7\u4e3a\u65b0\u4e3b\u5e93\uff1b</li> </ul> <p>\u7f51\u7edc\u7684\u4e0d\u786e\u5b9a\u6027\u4f7f\u5f97\u5f88\u96be\u5224\u65ad\u4e00\u4e2a\u8282\u70b9\u662f\u5426\u5de5\u4f5c\uff0c\u5728\u67d0\u4e9b\u7279\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u4f1a\u6536\u5230\u4e00\u4e9b\u53cd\u9988\u4fe1\u606f\uff0c\u660e\u786e\u544a\u8bc9\u4f60\u67d0\u4e9b\u4e8b\u60c5\u6ca1\u6709\u6210\u529f\uff1a</p> <ul> <li>\u5982\u679c\u6ca1\u6709\u8fdb\u7a0b\u6b63\u5728\u4fa6\u542c\u76ee\u6807\u7aef\u53e3\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5c06\u901a\u8fc7\u53d1\u9001 FIN \u6216 RST \u6765\u5173\u95ed\u5e76\u91cd\u7528 TCP \u8fde\u63a5\u3002\u4f46\u662f\uff0c\u5982\u679c\u8282\u70b9\u5728\u5904\u7406\u8bf7\u6c42\u65f6\u53d1\u751f\u5d29\u6e83\uff0c\u5219\u65e0\u6cd5\u77e5\u9053\u8fdc\u7a0b\u8282\u70b9\u5b9e\u9645\u5904\u7406\u4e86\u591a\u5c11\u6570\u636e\\(^{[19]}\\)\u3002</li> <li>\u5982\u679c\u8fdb\u7a0b\u5d29\u6e83\uff0c\u4f46\u8282\u70b9\u4ecd\u8fd0\u884c\uff0c\u811a\u672c\u53ef\u4ee5\u901a\u77e5\u5176\u4ed6\u8282\u70b9\u4ee5\u4fbf\u5feb\u901f\u63a5\u7ba1\uff0c\u65e0\u9700\u7b49\u5f85\u8d85\u65f6\u5230\u671f\uff0c\u5982 HBase\\(^{[20]}\\)\u3002</li> <li>\u901a\u8fc7\u6570\u636e\u4e2d\u5fc3\u7f51\u7edc\u4ea4\u6362\u673a\u7684\u7ba1\u7406\u754c\u9762\u68c0\u6d4b\u786c\u4ef6\u7ea7\u522b\u7684\u94fe\u8def\u6545\u969c\uff08\u4f8b\u5982\uff0c\u8fdc\u7a0b\u673a\u5668\u662f\u5426\u5173\u95ed\u7535\u6e90\uff09\u3002</li> </ul> <p>\u5373\u4f7f TCP \u786e\u8ba4\u5df2\u7ecf\u4f20\u9001\u4e86\u4e00\u4e2a\u6570\u636e\u5305\uff0c\u5e94\u7528\u7a0b\u5e8f\u5728\u5904\u7406\u4e4b\u524d\u53ef\u80fd\u5df2\u7ecf\u5d29\u6e83\u3002\u5982\u679c\u4f60\u60f3\u786e\u4fdd\u4e00\u4e2a\u8bf7\u6c42\u662f\u6210\u529f\u7684\uff0c\u4f60\u9700\u8981\u5e94\u7528\u7a0b\u5e8f\u672c\u8eab\u7684\u6b63\u786e\u54cd\u5e94\\(^{[21]}\\)\u3002</p>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_9","title":"\u8d85\u65f6\u4e0e\u65e0\u7a77\u7684\u5ef6\u8fdf","text":"<p>\u8d85\u65f6\u5e94\u8be5\u7b49\u5f85\u591a\u4e45\uff1f\u4e0d\u5e78\u7684\u662f\u6ca1\u6709\u7b80\u5355\u7684\u7b54\u6848</p> <ul> <li>\u957f\u65f6\u95f4\u7684\u8d85\u65f6\u610f\u5473\u7740\u957f\u65f6\u95f4\u7b49\u5f85\uff0c\u76f4\u5230\u4e00\u4e2a\u8282\u70b9\u88ab\u5ba3\u544a\u6b7b\u4ea1\uff0c\u7528\u6237\u53ef\u80fd\u4e0d\u5f97\u4e0d\u7b49\u5f85\uff0c\u6216\u8005\u770b\u5230\u9519\u8bef\u4fe1\u606f\uff1b</li> <li>\u77ed\u7684\u8d85\u65f6\u53ef\u4ee5\u66f4\u5feb\u5730\u68c0\u6d4b\u5230\u6545\u969c\uff0c\u4f46\u6709\u66f4\u9ad8\u5730\u98ce\u9669\u8bef\u5c06\u4e00\u4e2a\u8282\u70b9\u5ba3\u5e03\u4e3a\u5931\u6548\uff1b</li> <li>\u52a8\u4f5c\u53ef\u80fd\u4f1a\u6700\u7ec8\u6267\u884c\u4e24\u6b21\uff0c\u8282\u70b9\u5b9e\u9645\u4e0a\u662f\u6d3b\u7740\u7684\uff0c\u5e76\u4e14\u6b63\u5728\u6267\u884c\u4e00\u4e9b\u52a8\u4f5c\uff1b</li> <li>\u7ea7\u8054\u5931\u6548\uff1a\u8282\u70b9\u7531\u4e8e\u8fc7\u8f7d\u5bfc\u81f4\u5176\u54cd\u5e94\u7f13\u6162</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_10","title":"\u7f51\u7edc\u62e5\u585e\u548c\u6392\u961f","text":"<p>\u8ba1\u7b97\u673a\u7f51\u7edc\u4e0a\u6570\u636e\u5305\u5ef6\u8fdf\u7684\u53ef\u53d8\u6027\u901a\u5e38\u662f\u7531\u4e8e\u6392\u961f\\(^{[22]}\\)\uff1a</p> <ul> <li>\u7f51\u7edc\u4ea4\u6362\u673a\u6392\u961f\uff1a\u591a\u4e2a\u4e0d\u540c\u7684\u8282\u70b9\u540c\u65f6\u5c1d\u8bd5\u5c06\u6570\u636e\u5305\u53d1\u9001\u5230\u540c\u4e00\u76ee\u7684\u5730</li> <li>\u7f51\u7edc\u4ea4\u6362\u673a\u5fc5\u987b\u5c06\u5b83\u4eec\u6392\u961f\u5e76\u5c06\u5b83\u4eec\u9010\u4e2a\u9001\u5165\u76ee\u6807\u7f51\u7edc\u94fe\u8def\uff0c\u5982\u4e0b\u56fe</li> <li>\u5982\u679c\u4f20\u5165\u7684\u6570\u636e\u592a\u591a\uff0c\u4ea4\u6362\u673a\u961f\u5217\u586b\u6ee1\uff0c\u6570\u636e\u5305\u5c06\u88ab\u4e22\u5f03\uff0c\u9700\u8981\u91cd\u65b0\u53d1\u9001\u6570\u636e\u5305 - \u5373\u4f7f\u7f51\u7edc\u826f\u597d\u3002</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u6392\u961f\uff1a\u76ee\u6807\u673a\u5668\u6240\u6709 CPU \u5185\u6838\u5f53\u524d\u90fd\u5904\u4e8e\u7e41\u5fd9\u72b6\u6001\uff0c\u8fd9\u53ef\u80fd\u9700\u8981\u4e00\u6bb5\u4efb\u610f\u7684\u65f6\u95f4</li> <li>\u865a\u62df\u673a\u76d1\u89c6\u5668 \\(^{[23]}\\)\u6392\u961f\uff08\u7f13\u51b2\uff09\uff1a\u5728\u865a\u62df\u5316\u73af\u5883\u4e2d\uff0c\u6b63\u5728\u8fd0\u884c\u7684\u64cd\u4f5c\u7cfb\u7edf\u7ecf\u5e38\u6682\u505c\u51e0\u5341\u6beb\u79d2\uff0c\u56e0\u4e3a\u53e6\u4e00\u4e2a\u865a\u62df\u673a\u6b63\u5728\u4f7f\u7528 CPU \u5185\u6838\u3002\u5728\u8fd9\u6bb5\u65f6\u95f4\u5185\uff0c\u865a\u62df\u673a\u4e0d\u80fd\u4ece\u7f51\u7edc\u4e2d\u6d88\u8017\u4efb\u4f55\u6570\u636e</li> <li>TCP \u6267\u884c \u6d41\u91cf\u63a7\u5236\uff1a\u8282\u70b9\u4f1a\u9650\u5236\u81ea\u5df1\u7684\u53d1\u9001\u901f\u7387\u4ee5\u907f\u514d\u7f51\u7edc\u94fe\u8def\u6216\u63a5\u6536\u8282\u70b9\u8fc7\u8f7d\\(^{[24]}\\)</li> </ul> <p>\u5982\u679c\u6709\u591a\u53f0\u673a\u5668\u5c06\u7f51\u7edc\u6d41\u91cf\u53d1\u9001\u5230\u540c\u4e00\u76ee\u7684\u5730\uff0c\u5219\u5176\u4ea4\u6362\u673a\u961f\u5217\u53ef\u80fd\u4f1a\u88ab\u586b\u6ee1\u3002\u5728\u8fd9\u91cc\uff0c\u7aef\u53e3 1,2 \u548c 4 \u90fd\u8bd5\u56fe\u53d1\u9001\u6570\u636e\u5305\u5230\u7aef\u53e3 3</p> <p></p> <p>\u5728\u516c\u5171\u4e91\u548c\u591a\u79df\u6237\u6570\u636e\u4e2d\u5fc3\u4e2d\uff0c\u8d44\u6e90\u88ab\u8bb8\u591a\u5ba2\u6237\u5171\u4eab\uff1a\u7f51\u7edc\u94fe\u63a5\u548c\u4ea4\u6362\u673a\uff0c\u751a\u81f3\u6bcf\u4e2a\u673a\u5668\u7684\u7f51\u5361\u548c CPU\uff08\u5728\u865a\u62df\u673a\u4e0a\u8fd0\u884c\u65f6\uff09\uff1a</p> <ul> <li>\u5982\u679c\u9644\u8fd1\u7684\u67d0\u4e2a\u4eba\uff08\u5608\u6742\u7684\u90bb\u5c45\uff09\u6b63\u5728\u4f7f\u7528\u5927\u91cf\u8d44\u6e90\uff0c\u5219\u7f51\u7edc\u5ef6\u8fdf\u53ef\u80fd\u4f1a\u53d1\u751f\u5267\u70c8\u53d8\u5316\\(^{[25,26]}\\)\uff1b</li> <li>\u7cfb\u7edf\u8fde\u7eed\u6d4b\u91cf\u54cd\u5e94\u65f6\u95f4\u53ca\u5176\u53d8\u5316\uff08\u6296\u52a8\uff09\uff0c\u5e76\u6839\u636e\u89c2\u5bdf\u5230\u7684\u54cd\u5e94\u65f6\u95f4\u5206\u5e03\u81ea\u52a8\u8c03\u6574\u8d85\u65f6\u65f6\u95f4\uff0c\u5982Phi Accrual \u6545\u969c\u68c0\u6d4b\u5668\\(^{[27]}\\)\uff1b</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#tcpudp","title":"TCP\u4e0eUDP","text":"<p>\u4e00\u4e9b\u5bf9\u5ef6\u8fdf\u654f\u611f\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u6bd4\u5982\u89c6\u9891\u4f1a\u8bae\u548c IP \u8bed\u97f3\uff08VoIP\uff09\uff0c\u4f7f\u7528\u4e86 UDP \u800c\u4e0d\u662f TCP\u3002</p> <ul> <li>UDP \u4e0d\u6267\u884c\u6d41\u91cf\u63a7\u5236\u5e76\u4e14\u4e0d\u91cd\u4f20\u4e22\u5931\u7684\u5206\u7ec4\uff0c\u6240\u4ee5\u907f\u514d\u4e86\u7f51\u7edc\u5ef6\u8fdf\u53d8\u5316\u7684\u4e00\u4e9b\u539f\u56e0\uff08\u5c3d\u7ba1\u5b83\u4ecd\u7136\u6613\u53d7\u5207\u6362\u961f\u5217\u548c\u8c03\u5ea6\u5ef6\u8fdf\u7684\u5f71\u54cd\uff09</li> <li>\u5728\u5ef6\u8fdf\u6570\u636e\u6beb\u65e0\u4ef7\u503c\u7684\u60c5\u51b5\u4e0b\uff0cUDP \u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\u3002\u91cd\u8bd5\u53d1\u751f\u5728\u4eba\u7c7b\u5c42\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_11","title":"\u540c\u6b65\u7f51\u7edc\u4e0e\u5f02\u6b65\u7f51\u7edc","text":"<p>\u4e3a\u4ec0\u4e48\u6211\u4eec\u4e0d\u80fd\u5728\u786c\u4ef6\u5c42\u9762\u4e0a\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff08\u6700\u5927\u5ef6\u8fdf\u56fa\u5b9a \u7684\u6570\u636e\u5305\uff09\uff0c\u4f7f\u7f51\u7edc\u53ef\u9760\uff0c\u4f7f\u8f6f\u4ef6\u4e0d\u5fc5\u62c5\u5fc3\u5462</p> <ul> <li>\u5c06\u6570\u636e\u4e2d\u5fc3\u7f51\u7edc\u4e0e\u975e\u5e38\u53ef\u9760\u7684\u4f20\u7edf\u56fa\u5b9a\u7535\u8bdd\u7f51\u7edc\uff08\u975e\u8702\u7a9d\uff0c\u975e VoIP\uff09\u8fdb\u884c\u6bd4\u8f83\u3002</li> </ul> <p>\u901a\u8fc7\u7535\u8bdd\u7f51\u7edc\u62e8\u6253\u7535\u8bdd\u65f6\uff0c\u5b83\u4f1a\u5efa\u7acb\u4e00\u4e2a\u7535\u8def\uff1a</p> <ul> <li>\u5728\u4e24\u4e2a\u547c\u53eb\u8005\u4e4b\u95f4\u7684\u6574\u4e2a\u8def\u7ebf\u4e0a\u4e3a\u547c\u53eb\u5206\u914d\u4e00\u4e2a\u56fa\u5b9a\u7684\uff0c\u6709\u4fdd\u8bc1\u7684\u5e26\u5bbd\u91cf\uff0c\u4fdd\u6301\u81f3\u901a\u8bdd\u7ed3\u675f\\(^{[28]}\\)\uff1b</li> <li>\u4f8b\u5982\uff0cISDN \u7f51\u7edc\u4ee5\u6bcf\u79d2 4000 \u5e27\u7684\u56fa\u5b9a\u901f\u7387\u8fd0\u884c\u3002\u547c\u53eb\u5efa\u7acb\u65f6\uff0c\u6bcf\u4e2a\u5e27\u5185\uff08\u6bcf\u4e2a\u65b9\u5411\uff09\u5206\u914d 16 \u4f4d\u7a7a\u95f4\uff0c\u6bcf\u4e00\u65b9\u90fd\u4fdd\u8bc1\u80fd\u591f\u6bcf 250 \u5fae\u79d2\u53d1\u9001\u4e00\u4e2a\u7cbe\u786e\u7684 16 \u4f4d\u97f3\u9891\u6570\u636e\\(^{[29,30]}\\)\u3002</li> <li>\u7f51\u7edc\u662f\u540c\u6b65\u7684\uff1a\u5373\u4f7f\u6570\u636e\u7ecf\u8fc7\u591a\u4e2a\u8def\u7531\u5668\uff0c\u4e5f\u4e0d\u4f1a\u53d7\u5230\u6392\u961f\u7684\u5f71\u54cd\uff0c\u56e0\u4e3a\u547c\u53eb\u7684 16 \u4f4d\u7a7a\u95f4\u5df2\u7ecf\u5728\u7f51\u7edc\u7684\u4e0b\u4e00\u8df3\u4e2d\u4fdd\u7559\u4e86\u4e0b\u6765\u3002\u800c\u4e14\u7531\u4e8e\u6ca1\u6709\u6392\u961f\uff0c\u7f51\u7edc\u7684\u6700\u5927\u7aef\u5230\u7aef\u5ef6\u8fdf\u662f\u56fa\u5b9a\u7684\uff08\u6709\u9650\u5ef6\u8fdf\uff08bounded delay\uff09)\u3002</li> </ul> <p>\u7535\u8def\u662f\u56fa\u5b9a\u6570\u91cf\u7684\u9884\u7559\u5e26\u5bbd\uff0c\u5728\u7535\u8def\u5efa\u7acb\u65f6\u6ca1\u6709\u5176\u4ed6\u4eba\u53ef\u4ee5\u4f7f\u7528\uff0c\u800c TCP \u8fde\u63a5\u7684\u6570\u636e\u5305 \u673a\u4f1a\u6027\u5730 \u4f7f\u7528\u4efb\u4f55\u53ef\u7528\u7684\u7f51\u7edc\u5e26\u5bbd\u3002</p> <p>\u4ee5\u592a\u7f51\u548c IP \u662f \u5206\u7ec4\u4ea4\u6362\u534f\u8bae\uff0c\u4e0d\u5f97\u4e0d\u5fcd\u53d7\u6392\u961f\u7684\u6298\u78e8\u548c\u56e0\u6b64\u5bfc\u81f4\u7684\u7f51\u7edc\u65e0\u9650\u5ef6\u8fdf\uff0c\u8fd9\u4e9b\u534f\u8bae\u6ca1\u6709\u7535\u8def\u7684\u6982\u5ff5\u3002</p> <ul> <li>\u9488\u5bf9 \u7a81\u53d1\u6d41\u91cf\uff08bursty traffic\uff09 \u8fdb\u884c\u4e86\u4f18\u5316\uff0c\u4e00\u4e2a\u7535\u8def\u9002\u7528\u4e8e\u97f3\u9891\u6216\u89c6\u9891\u901a\u8bdd\uff0c\u5728\u901a\u8bdd\u671f\u95f4\u9700\u8981\u6bcf\u79d2\u4f20\u9001\u76f8\u5f53\u6570\u91cf\u7684\u6bd4\u7279\uff0c\u800c\u8bf7\u6c42\u7f51\u9875/\u4f20\u8f93\u6587\u4ef6\u6ca1\u6709\u7279\u5b9a\u7684\u5e26\u5bbd\u8981\u6c42\uff1b</li> <li>TCP \u52a8\u6001\u8c03\u6574\u6570\u636e\u4f20\u8f93\u901f\u7387\u4ee5\u9002\u5e94\u53ef\u7528\u7684\u7f51\u7edc\u5bb9\u91cf\u3002\u7535\u8def\u7528\u4e8e\u7a81\u53d1\u6570\u636e\u4f20\u8f93\u4f1a\u6d6a\u8d39\u7f51\u7edc\u5bb9\u91cf\uff0c\u5e76\u4e14\u4f7f\u4f20\u8f93\u4e0d\u5fc5\u8981\u5730\u7f13\u6162\u3002</li> </ul> <p>\u5c1d\u8bd5\u53bb\u5efa\u7acb\u540c\u65f6\u652f\u6301\u7535\u8def\u4ea4\u6362\u548c\u5206\u7ec4\u4ea4\u6362\u7684\u6df7\u5408\u7f51\u7edc\uff0c\u6bd4\u5982 ATM</p> <ul> <li>InfiniBand \u6709\u4e00\u4e9b\u76f8\u4f3c\u4e4b\u5904\\(^{[31]}\\)\uff1a\u5b83\u5728\u94fe\u8def\u5c42\u5b9e\u73b0\u4e86\u7aef\u5230\u7aef\u7684\u6d41\u91cf\u63a7\u5236\uff0c\u4ece\u800c\u51cf\u5c11\u4e86\u5728\u7f51\u7edc\u4e2d\u6392\u961f\u7684\u9700\u8981\uff0c\u5c3d\u7ba1\u5b83\u4ecd\u7136\u53ef\u80fd\u56e0\u94fe\u8def\u62e5\u585e\u800c\u53d7\u5230\u5ef6\u8fdf\\(^{[32]}\\)\uff1b</li> <li>\u4f7f\u7528 \u670d\u52a1\u8d28\u91cf\uff08quality of service\uff0c\u5373 QoS\uff0c\u6570\u636e\u5305\u7684\u4f18\u5148\u7ea7\u548c\u8c03\u5ea6\uff09\u548c \u51c6\u5165\u63a7\u5236\uff08admission control\uff0c\u9650\u901f\u53d1\u9001\u5668\uff09\uff0c\u53ef\u4ee5\u5728\u5206\u7ec4\u7f51\u7edc\u4e0a\u6a21\u62df\u7535\u8def\u4ea4\u6362\uff0c\u6216\u63d0\u4f9b\u7edf\u8ba1\u4e0a\u7684 \u6709\u9650\u5ef6\u8fdf\\(^{[22, 28]}\\)</li> </ul> <p>\u76ee\u524d\u5728\u591a\u79df\u6237\u6570\u636e\u4e2d\u5fc3\u548c\u516c\u5171\u4e91\u6216\u901a\u8fc7\u4e92\u8054\u7f51\u8fdb\u884c\u901a\u4fe1\u65f6\uff0c\u6b64\u7c7b\u670d\u52a1\u8d28\u91cf\u5c1a\u672a\u542f\u7528\u3002\u5f53\u524d\u90e8\u7f72\u7684\u6280\u672f\u4e0d\u5141\u8bb8\u6211\u4eec\u5bf9\u7f51\u7edc\u7684\u5ef6\u8fdf\u6216\u53ef\u9760\u6027\u4f5c\u51fa\u4efb\u4f55\u4fdd\u8bc1\uff1a\u6211\u4eec\u5fc5\u987b\u5047\u8bbe\u7f51\u7edc\u62e5\u585e\uff0c\u6392\u961f\u548c\u65e0\u9650\u7684\u5ef6\u8fdf\u603b\u662f\u4f1a\u53d1\u751f\u3002</p> <p>\u7f51\u7edc\u4e2d\u7684\u53ef\u53d8\u5ef6\u8fdf\u4e0d\u662f\u4e00\u79cd\u81ea\u7136\u89c4\u5f8b\uff0c\u800c\u53ea\u662f\u6210\u672c / \u6536\u76ca\u6743\u8861\u7684\u7ed3\u679c\u3002</p>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_12","title":"\u4e0d\u53ef\u9760\u7684\u65f6\u949f","text":"<p>\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u65f6\u95f4\u662f\u4e00\u4ef6\u68d8\u624b\u7684\u4e8b\u60c5\uff0c\u56e0\u4e3a\u901a\u4fe1\u4e0d\u662f\u5373\u65f6\u7684\uff1a</p> <ul> <li>\u6536\u5230\u6d88\u606f\u7684\u65f6\u95f4\u603b\u662f\u665a\u4e8e\u53d1\u9001\u7684\u65f6\u95f4\uff0c\u4f46\u662f\u7531\u4e8e\u7f51\u7edc\u4e2d\u7684\u53ef\u53d8\u5ef6\u8fdf\uff0c\u6211\u4eec\u4e0d\u77e5\u9053\u665a\u4e86\u591a\u5c11\u65f6\u95f4\uff1b</li> <li>\u5bfc\u81f4\u6709\u65f6\u5f88\u96be\u786e\u5b9a\u5728\u6d89\u53ca\u591a\u53f0\u673a\u5668\u65f6\u53d1\u751f\u4e8b\u60c5\u7684\u987a\u5e8f\u3002</li> </ul> <p>\u7f51\u7edc\u65f6\u95f4\u534f\u8bae\uff08NTP\uff09\uff1a\u5141\u8bb8\u6839\u636e\u4e00\u7ec4\u670d\u52a1\u5668\u62a5\u544a\u7684\u65f6\u95f4\u6765\u8c03\u6574\u8ba1\u7b97\u673a\u65f6\u949f\\(^{[32]}\\)\u3002\u670d\u52a1\u5668\u5219\u4ece\u66f4\u7cbe\u786e\u7684\u65f6\u95f4\u6e90\uff08\u5982 GPS \u63a5\u6536\u673a\uff09\u83b7\u53d6\u65f6\u95f4\u3002</p>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_13","title":"\u5355\u8c03\u949f\u4e0e\u65e5\u5386\u65f6\u949f","text":"<p>\u65e5\u5386\u65f6\u949f\uff08time-of-day clock\uff09\uff1a\u6839\u636e\u67d0\u4e2a\u65e5\u5386\uff08\u4e5f\u79f0\u4e3a \u6302\u949f\u65f6\u95f4\uff0c\u5373 wall-clock time\uff09\u8fd4\u56de\u5f53\u524d\u65e5\u671f\u548c\u65f6\u95f4\u3002</p> <ul> <li>\u5982 Linux \u4e0a\u7684 <code>clock_gettime(CLOCK_REALTIME)</code>\u548c Java \u4e2d\u7684 <code>System.currentTimeMillis()</code> </li> <li>\u901a\u5e38\u4e0e NTP \u540c\u6b65\uff0c\u4f46\u53ef\u80fd\u4f1a\u51fa\u73b0\u8df3\u8dc3\u548c\u5ffd\u7565\u95f0\u79d2\uff0c\u4f7f\u65e5\u5386\u65f6\u949f\u4e0d\u80fd\u7528\u4e8e\u6d4b\u91cf\u7ecf\u8fc7\u65f6\u95f4\uff08elapsed time\uff09\\(^{[33]}\\)\u3002</li> </ul> <p>\u5355\u8c03\u949f\uff08monotonic clock\uff09\uff1a\u9002\u7528\u4e8e\u6d4b\u91cf\u6301\u7eed\u65f6\u95f4\uff08\u65f6\u95f4\u95f4\u9694\uff09\uff0c\u7edd\u5bf9\u503c\u662f\u6beb\u65e0\u610f\u4e49</p> <ul> <li>\u5982Linux \u4e0a\u7684 <code>clock_gettime(CLOCK_MONOTONIC)</code>\uff0c\u548c Java \u4e2d\u7684 <code>System.nanoTime()</code>\uff1b</li> <li>\u591aCPU\u65f6\u6bcf\u4e2a CPU \u53ef\u80fd\u6709\u4e00\u4e2a\u5355\u72ec\u7684\u8ba1\u65f6\u5668\uff0c\u4f46\u4e0d\u4e00\u5b9a\u4e0e\u5176\u4ed6 CPU \u540c\u6b65\uff0c\u660e\u667a\u7684\u505a\u6cd5\u662f\u4e0d\u8981\u592a\u628a\u8fd9\u79cd\u5355\u8c03\u6027\u4fdd\u8bc1\u5f53\u56de\u4e8b\\(^{[34]}\\)\u3002</li> </ul> <p>NTP \u534f\u8bae\u68c0\u6d4b\u5230\u8ba1\u7b97\u673a\u7684\u672c\u5730\u77f3\u82f1\u949f\u6bd4 NTP \u670d\u52a1\u5668\u8981\u66f4\u5feb\u6216\u66f4\u6162\uff0c\u5219\u53ef\u4ee5\u8c03\u6574\u5355\u8c03\u949f\u5411\u524d\u8d70\u7684\u9891\u7387\uff08\u8fd9\u79f0\u4e3a \u504f\u79fb\uff08skewing\uff09 \u65f6\u949f\uff09\uff0c\u901f\u7387\u589e\u52a0\u6216\u51cf\u6162\u6700\u9ad8\u81f3 0.05%\u3002</p>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_14","title":"\u65f6\u949f\u540c\u6b65\u4e0e\u51c6\u786e\u6027","text":"<p>\u65e5\u5386\u65f6\u949f\u9700\u8981\u6839\u636e NTP \u670d\u52a1\u5668\u6216\u5176\u4ed6\u5916\u90e8\u65f6\u95f4\u6e90\u6765\u8bbe\u7f6e\u624d\u80fd\u6709\u7528\uff0c\u4f46\u786c\u4ef6\u65f6\u949f\u548c NTP \u53ef\u80fd\u4f1a\u53d8\u5e7b\u83ab\u6d4b\uff1a</p> <ul> <li>\u8ba1\u7b97\u673a\u4e2d\u7684\u77f3\u82f1\u949f\u4e0d\u591f\u7cbe\u786e\uff1a\u5b83\u4f1a \u6f02\u79fb\uff08drifts\uff0c\u5373\u8fd0\u884c\u901f\u5ea6\u5feb\u4e8e\u6216\u6162\u4e8e\u9884\u671f\uff09\u3002</li> <li>\u5982\u679c\u8ba1\u7b97\u673a\u7684\u65f6\u949f\u4e0e NTP \u670d\u52a1\u5668\u7684\u65f6\u949f\u5dee\u522b\u592a\u5927\uff0c\u53ef\u80fd\u4f1a\u62d2\u7edd\u540c\u6b65\uff0c\u6216\u8005\u672c\u5730\u65f6\u949f\u5c06\u88ab\u5f3a\u5236\u91cd\u7f6e\\(^{[32]}\\)\u3002</li> <li>NTP \u540c\u6b65\u53ea\u80fd\u548c\u7f51\u7edc\u5ef6\u8fdf\u4e00\u6837\u597d\uff0c\u6240\u4ee5\u5f53\u4f60\u5728\u62e5\u6709\u53ef\u53d8\u6570\u636e\u5305\u5ef6\u8fdf\u7684\u62e5\u585e\u7f51\u7edc\u4e0a\u65f6\uff0cNTP \u540c\u6b65\u7684\u51c6\u786e\u6027\u4f1a\u53d7\u5230\u9650\u5236\u3002</li> <li>\u95f0\u79d2\u5bfc\u81f4\u4e00\u5206\u949f\u53ef\u80fd\u6709 59 \u79d2\u6216 61 \u79d2\uff0c\u672a\u8003\u8651\u5230\u4f1a\u5bfc\u81f4\u7cfb\u7edf\u5d29\u6e83\\(^{[33,36,37]}\\)\u3002NTP\u670d\u52a1\u5668\u5904\u7406\u95f0\u79d2\u6700\u4f73\u65b9\u6848\u662f\u901a\u8fc7\u5728\u4e00\u5929\u4e2d\u9010\u6e10\u6267\u884c\u95f0\u79d2\u8c03\u6574\uff08\u8fd9\u88ab\u79f0\u4e3a \u62d6\u5c3e\uff0c\u5373 smearing\uff09\u3002</li> <li>\u5f53\u4e00\u4e2a CPU \u6838\u5fc3\u5728\u865a\u62df\u673a\u4e4b\u95f4\u5171\u4eab\u65f6\uff0c\u6bcf\u4e2a\u865a\u62df\u673a\u90fd\u4f1a\u6682\u505c\u51e0\u5341\u6beb\u79d2\uff0c\u4e0e\u6b64\u540c\u65f6\u53e6\u4e00\u4e2a\u865a\u62df\u673a\u6b63\u5728\u8fd0\u884c\u3002\u4ece\u5e94\u7528\u7a0b\u5e8f\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u8fd9\u79cd\u505c\u987f\u8868\u73b0\u4e3a\u65f6\u949f\u7a81\u7136\u5411\u524d\u8df3\u8dc3\u3002</li> <li>\u6ca1\u6709\u5b8c\u6574\u63a7\u5236\u6743\u7684\u8bbe\u5907\uff08\u4f8b\u5982\uff0c\u79fb\u52a8\u8bbe\u5907\u6216\u5d4c\u5165\u5f0f\u8bbe\u5907\uff09\u4e0a\u8fd0\u884c\u8f6f\u4ef6\uff0c\u5219\u53ef\u80fd\u5b8c\u5168\u4e0d\u80fd\u4fe1\u4efb\u8be5\u8bbe\u5907\u7684\u786c\u4ef6\u65f6\u949f\u3002</li> </ul> <p>\u901a\u8fc7 GPS \u63a5\u6536\u673a\uff0c\u7cbe\u786e\u65f6\u95f4\u534f\u8bae\uff08PTP\uff09\\(^{[38]}\\)\u4ee5\u53ca\u4ed4\u7ec6\u7684\u90e8\u7f72\u548c\u76d1\u6d4b\u53ef\u4ee5\u5b9e\u73b0\u5728 UTC \u65f6\u95f4 100 \u5fae\u79d2\u5185\u540c\u6b65\u65f6\u949f\u3002</p>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_15","title":"\u4f9d\u8d56\u540c\u6b65\u65f6\u949f","text":"<p>\u65e5\u5386\u65f6\u949f \u53ef\u80fd\u4f1a\u524d\u540e\u8df3\u8dc3\uff0c\u800c\u4e00\u4e2a\u8282\u70b9\u4e0a\u7684\u65f6\u95f4\u53ef\u80fd\u4e0e\u53e6\u4e00\u4e2a\u8282\u70b9\u4e0a\u7684\u65f6\u95f4\u5b8c\u5168\u4e0d\u540c\u3002</p> <ul> <li>\u4f7f\u7528\u9700\u8981\u540c\u6b65\u65f6\u949f\u7684\u8f6f\u4ef6\uff0c\u5fc5\u987b\u4ed4\u7ec6\u76d1\u63a7\u6240\u6709\u673a\u5668\u4e4b\u95f4\u7684\u65f6\u949f\u504f\u79fb\u3002\u65f6\u949f\u504f\u79bb\u5176\u4ed6\u65f6\u949f\u592a\u8fdc\u7684\u8282\u70b9\u5e94\u5f53\u88ab\u5ba3\u544a\u6b7b\u4ea1\uff0c\u5e76\u4ece\u96c6\u7fa4\u4e2d\u79fb\u9664\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_16","title":"\u6709\u5e8f\u4e8b\u4ef6\u7684\u65f6\u95f4\u6233","text":"<p>\u5982\u679c\u4e24\u4e2a\u5ba2\u6237\u7aef\u5199\u5165\u5206\u5e03\u5f0f\u6570\u636e\u5e93\uff0c\u8c01\u5148\u5230\u8fbe\uff1f</p> <p>\u4e0b\u56fe\u663e\u793a\u5177\u6709\u591a\u4e3b\u590d\u5236\u7684\u6570\u636e\u5e93\u4e2d\u5bf9\u65f6\u949f\u7684\u5371\u9669\u4f7f\u7528\uff08\u5f53\u5199\u5165\u88ab\u590d\u5236\u5230\u5176\u4ed6\u8282\u70b9\u65f6\uff0c\u6839\u636e\u53d1\u751f\u5199\u5165\u7684\u8282\u70b9\u4e0a\u7684\u65e5\u5386\u65f6\u949f\u6807\u8bb0\u4e00\u4e2a\u65f6\u95f4\u6233\uff09</p> <ul> <li>\u5ba2\u6237\u7aef A \u5728\u8282\u70b9 1 \u4e0a\u5199\u5165 <code>x = 1</code>\uff1b\u5199\u5165\u88ab\u590d\u5236\u5230\u8282\u70b9 3\uff1b</li> <li>\u5ba2\u6237\u7aef B \u5728\u8282\u70b9 3 \u4e0a\u589e\u52a0 x\uff08\u6211\u4eec\u73b0\u5728\u6709 <code>x = 2</code>\uff09\uff1b</li> <li>\u6700\u540e\u8fd9\u4e24\u4e2a\u5199\u5165\u90fd\u88ab\u590d\u5236\u5230\u8282\u70b9 2\u3002</li> </ul> <p>\u5ba2\u6237\u7aef B \u7684\u5199\u5165\u6bd4\u5ba2\u6237\u7aef A \u7684\u5199\u5165\u8981\u665a\uff0c\u4f46\u662f B \u7684\u5199\u5165\u5177\u6709\u8f83\u65e9\u7684\u65f6\u95f4\u6233\u3002</p> <p></p> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u65f6\u949f\u540c\u6b65\u662f\u975e\u5e38\u597d\u7684\uff1a\u8282\u70b9 1 \u548c\u8282\u70b9 3 \u4e4b\u95f4\u7684\u504f\u5dee\u5c0f\u4e8e 3ms\uff0c\u8fd9\u53ef\u80fd\u6bd4\u4f60\u5728\u5b9e\u8df5\u4e2d\u80fd\u9884\u671f\u7684\u66f4\u597d\u3002</p> <p>\u65f6\u95f4\u6233\u5374\u65e0\u6cd5\u6b63\u786e\u6392\u5217\u4e8b\u4ef6\uff1a</p> <ul> <li>\u5199\u5165 <code>x = 1</code> \u7684\u65f6\u95f4\u6233\u4e3a 42.004 \u79d2\uff0c\u4f46\u5199\u5165 <code>x = 2</code> \u7684\u65f6\u95f4\u6233\u4e3a 42.003 \u79d2</li> <li>\u5f53\u8282\u70b9 2 \u63a5\u6536\u5230\u8fd9\u4e24\u4e2a\u4e8b\u4ef6\u65f6\uff0c\u4f1a\u9519\u8bef\u5730\u63a8\u65ad\u51fa <code>x = 1</code> \u662f\u6700\u8fd1\u7684\u503c\uff0c\u800c\u4e22\u5f03\u5199\u5165 <code>x = 2</code>\u3002</li> </ul> <p>\u8fd9\u79cd\u51b2\u7a81\u89e3\u51b3\u7b56\u7565\u88ab\u79f0\u4e3a \u6700\u540e\u5199\u5165\u80dc\u5229\uff08LWW\uff09\uff0c\u4f46\u662f\u201c\u6700\u8fd1\u201d \u7684\u5b9a\u4e49\u4e0d\u80fd\u57fa\u4e8e\u672c\u5730\u7684\u65e5\u5386\u65f6\u949f\uff1b</p> <ul> <li>\u903b\u8f91\u65f6\u949f\uff08logic clock\uff09\\(^{[39,40]}\\)\u662f\u57fa\u4e8e\u9012\u589e\u8ba1\u6570\u5668\u800c\u4e0d\u662f\u632f\u8361\u77f3\u82f1\u6676\u4f53\uff0c\u5bf9\u4e8e\u6392\u5e8f\u4e8b\u4ef6\u6765\u8bf4\u662f\u66f4\u5b89\u5168\u7684\u9009\u62e9\uff1b\u4ec5\u6d4b\u91cf\u4e8b\u4ef6\u7684\u76f8\u5bf9\u987a\u5e8f\uff08\u65e0\u8bba\u4e00\u4e2a\u4e8b\u4ef6\u53d1\u751f\u5728\u53e6\u4e00\u4e2a\u4e8b\u4ef6\u4e4b\u524d\u8fd8\u662f\u4e4b\u540e\uff09</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_17","title":"\u65f6\u949f\u8bfb\u6570\u5b58\u5728\u7f6e\u4fe1\u533a\u95f4","text":"<p>\u4f7f\u7528\u516c\u5171\u4e92\u8054\u7f51\u4e0a\u7684 NTP \u670d\u52a1\u5668\uff0c\u6700\u597d\u7684\u51c6\u786e\u5ea6\u53ef\u80fd\u8fbe\u5230\u51e0\u5341\u6beb\u79d2\uff0c\u800c\u4e14\u5f53\u7f51\u7edc\u62e5\u585e\u65f6\uff0c\u8bef\u5dee\u53ef\u80fd\u4f1a\u8d85\u8fc7 100 \u6beb\u79d2\\(^{[40]}\\)\u3002</p> <p>\u5c06\u65f6\u949f\u8bfb\u6570\u89c6\u4e3a\u4e00\u4e2a\u65f6\u95f4\u70b9\u662f\u6ca1\u6709\u610f\u4e49\u7684 \u2014\u2014 \u5b83\u66f4\u50cf\u662f\u4e00\u6bb5\u65f6\u95f4\u8303\u56f4\uff1a</p> <ul> <li>\u4e00\u4e2a\u7cfb\u7edf\u53ef\u80fd\u4ee5 95% \u7684\u7f6e\u4fe1\u5ea6\u8ba4\u4e3a\u5f53\u524d\u65f6\u95f4\u5904\u4e8e\u672c\u5206\u949f\u5185\u7684\u7b2c 10.3 \u79d2\u548c 10.5 \u79d2\u4e4b\u95f4\uff0c\u5b83\u53ef\u80fd\u6ca1\u6cd5\u6bd4\u8fd9\u66f4\u7cbe\u786e\u4e86\\(^{[41]}\\)</li> </ul> <p>\u5927\u591a\u6570\u7cfb\u7edf\u4e0d\u516c\u5f00\u8fd9\u79cd\u4e0d\u786e\u5b9a\u6027\uff1a</p> <ul> <li>\u5f53\u8c03\u7528 <code>clock_gettime()</code> \u65f6\uff0c\u8fd4\u56de\u503c\u4e0d\u4f1a\u544a\u8bc9\u4f60\u65f6\u95f4\u6233\u7684\u9884\u671f\u9519\u8bef\uff1b</li> <li>\u4f8b\u5916\u662f Spanner \u4e2d\u7684 Google TrueTime API \\(^{[35]}\\)\uff0c\u5b83\u660e\u786e\u5730\u62a5\u544a\u4e86\u672c\u5730\u65f6\u949f\u7684\u7f6e\u4fe1\u533a\u95f4[\u6700\u65e9\uff0c\u6700\u665a]\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_18","title":"\u5168\u5c40\u5feb\u7167\u7684\u540c\u6b65\u65f6\u949f","text":"<p>\u5bf9\u5206\u5e03\u5f0f\u4e8b\u52a1\u8bed\u4e49\u4f7f\u7528\u65f6\u949f\u540c\u6b65\u662f\u4e00\u4e2a\u6d3b\u8dc3\u7684\u7814\u7a76\u9886\u57df\\(^{[40,44,45]}\\)\uff0c\u4f46\u662f\u5b83\u4eec\u8fd8\u6ca1\u6709\u5728\u8c37\u6b4c\u4e4b\u5916\u7684\u4e3b\u6d41\u6570\u636e\u5e93\u4e2d\u5b9e\u73b0\u3002</p> <p>\u5feb\u7167\u9694\u79bb\u6700\u5e38\u89c1\u7684\u5b9e\u73b0\u9700\u8981\u5355\u8c03\u9012\u589e\u7684\u4e8b\u52a1 ID\u3002\u5982\u679c\u5199\u5165\u6bd4\u5feb\u7167\u665a\uff08\u5373\uff0c\u5199\u5165\u5177\u6709\u6bd4\u5feb\u7167\u66f4\u5927\u7684\u4e8b\u52a1 ID\uff09\uff0c\u5219\u8be5\u5199\u5165\u5bf9\u4e8e\u5feb\u7167\u4e8b\u52a1\u662f\u4e0d\u53ef\u89c1\u7684\u3002</p> <ul> <li>\u5355\u8282\u70b9\u6570\u636e\u5e93\u4e0a\uff0c\u4e00\u4e2a\u7b80\u5355\u7684\u8ba1\u6570\u5668\u5c31\u8db3\u4ee5\u751f\u6210\u4e8b\u52a1 ID</li> <li>\u5206\u5e03\u5f0f\u6570\u636e\u5e93\uff0c\uff08\u8de8\u6240\u6709\u5206\u533a\uff09\u5168\u5c40\u5355\u8c03\u9012\u589e\u7684\u4e8b\u52a1 ID \u4f1a\u5f88\u96be\u751f\u6210</li> </ul> <p>\u4e8b\u52a1 ID \u5fc5\u987b\u53cd\u6620\u56e0\u679c\u5173\u7cfb\uff1a\u5982\u679c\u4e8b\u52a1 B \u8bfb\u53d6\u7531\u4e8b\u52a1 A \u5199\u5165\u7684\u503c\uff0c\u5219 B \u5fc5\u987b\u5177\u6709\u6bd4 A \u66f4\u5927\u7684\u4e8b\u52a1 ID\uff0c\u5426\u5219\u5feb\u7167\u5c31\u65e0\u6cd5\u4fdd\u6301\u4e00\u81f4\u3002\u5728\u6709\u5927\u91cf\u7684\u5c0f\u89c4\u6a21\u3001\u9ad8\u9891\u7387\u7684\u4e8b\u52a1\u60c5\u666f\u4e0b\uff0c\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u521b\u5efa\u4e8b\u52a1 ID \u6210\u4e3a\u4e00\u4e2a\u96be\u4ee5\u5904\u7406\u7684\u74f6\u9888\u3002</p> <p>\u4f7f\u7528\u540c\u6b65\u65f6\u949f\u7684\u65f6\u95f4\u6233\u4f5c\u4e3a\u4e8b\u52a1 ID\uff1f\u95ee\u9898\u5728\u4e8e\u65f6\u949f\u7cbe\u5ea6\u7684\u4e0d\u786e\u5b9a\u6027</p> <ul> <li>Spanner\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u5b9e\u73b0\u8de8\u6570\u636e\u4e2d\u5fc3\u7684\u5feb\u7167\u9694\u79bb\\(^{[42,43]}\\)\u3002</li> <li>\u4e24\u4e2a\u7f6e\u4fe1\u533a\u95f4\u4e0d\u91cd\u53e0\\(A_{earliest} &lt;A_{latest} &lt;B_{earliest} &lt;B_{latest}\\)\uff0cB \u80af\u5b9a\u53d1\u751f\u5728 A \u4e4b\u540e\u3002</li> <li>\u5728\u63d0\u4ea4\u8bfb\u5199\u4e8b\u52a1\u4e4b\u524d\uff0cSpanner \u5728\u63d0\u4ea4\u8bfb\u5199\u4e8b\u52a1\u65f6\uff0c\u4f1a\u6545\u610f\u7b49\u5f85\u7f6e\u4fe1\u533a\u95f4\u957f\u5ea6\u7684\u65f6\u95f4\u3002</li> <li>\u5c3d\u53ef\u80fd\u77ed\u7684\u7b49\u5f85\u65f6\u95f4\uff1aGoogle \u5728\u6bcf\u4e2a\u6570\u636e\u4e2d\u5fc3\u90fd\u90e8\u7f72 GPS \u63a5\u6536\u5668\u6216\u539f\u5b50\u949f\uff0c\u65f6\u949f\u540c\u6b65\u5230\u5927\u7ea6 7 \u6beb\u79d2\u4ee5\u5185\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_19","title":"\u8fdb\u7a0b\u6682\u505c","text":"<p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u4f7f\u7528\u5371\u9669\u65f6\u949f\u7684\u53e6\u4e00\u4e2a\u4f8b\u5b50\uff1a</p> <ul> <li>\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u6bcf\u4e2a\u5206\u533a\u53ea\u6709\u4e00\u4e2a\u9886\u5bfc\u8005\u3002\u53ea\u6709\u9886\u5bfc\u88ab\u5141\u8bb8\u63a5\u53d7\u5199\u5165\u3002\u4e00\u4e2a\u8282\u70b9\u5982\u4f55\u77e5\u9053\u5b83\u4ecd\u7136\u662f\u9886\u5bfc\u8005\uff08\u5b83\u5e76\u6ca1\u6709\u88ab\u522b\u4eba\u5ba3\u544a\u4e3a\u6b7b\u4ea1\uff09\uff0c\u5e76\u4e14\u5b83\u53ef\u4ee5\u5b89\u5168\u5730\u63a5\u53d7\u5199\u5165\uff1f</li> </ul> <p>\u4e00\u79cd\u9009\u62e9\u662f\u9886\u5bfc\u8005\u4ece\u5176\u4ed6\u8282\u70b9\u83b7\u5f97\u4e00\u4e2a \u79df\u7ea6\uff08lease\uff09\uff0c\u7c7b\u4f3c\u4e00\u4e2a\u5e26\u8d85\u65f6\u7684\u9501\\(^{[46]}\\)\u3002\u4efb\u4e00\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u8282\u70b9\u53ef\u4ee5\u6301\u6709\u79df\u7ea6\uff0c\u8282\u70b9\u5fc5\u987b\u5468\u671f\u6027\u5730\u5728\u79df\u7ea6\u8fc7\u671f\u524d\u7eed\u671f\u3002</p> <p>\u4ee3\u7801\u7c7b\u4f3c\u5982\u4e0b\uff1a</p> <pre><code>while (true) {\n  request = getIncomingRequest();\n  // \u786e\u4fdd\u79df\u7ea6\u8fd8\u5269\u4e0b\u81f3\u5c11 10 \u79d2\n  if (lease.expiryTimeMillis - System.currentTimeMillis() &lt; 10000){\n    lease = lease.renew();\n  }\n\n  if (lease.isValid()) { // GC Pause\n    process(request);\n  }\n}\n</code></pre> <p>\u5b58\u5728\u7684\u95ee\u9898\uff1a</p> <ul> <li>\u4f9d\u8d56\u4e8e\u540c\u6b65\u65f6\u949f\uff1a\u79df\u7ea6\u5230\u671f\u65f6\u95f4\u7531\u53e6\u4e00\u53f0\u673a\u5668\u8bbe\u7f6e\uff08\u4f8b\u5982\uff0c\u5f53\u524d\u65f6\u95f4\u52a0\u4e0a 30 \u79d2\uff0c\u8ba1\u7b97\u5230\u671f\u65f6\u95f4\uff09\uff0c\u5e76\u5c06\u5176\u4e0e\u672c\u5730\u7cfb\u7edf\u65f6\u949f\u8fdb\u884c\u6bd4\u8f83\u3002\u5982\u679c\u65f6\u949f\u4e0d\u540c\u6b65\u8d85\u8fc7\u51e0\u79d2\uff0c\u5219\u4f1a\u5b58\u5728\u95ee\u9898\uff1b</li> </ul> <p>\u5373\u4f7f\u5c06\u534f\u8bae\u66f4\u6539\u4e3a\u4ec5\u4f7f\u7528\u672c\u5730\u5355\u8c03\u65f6\u949f\uff0c\u4e5f\u5b58\u5728\u53e6\u4e00\u4e2a\u95ee\u9898\uff1a</p> <ul> <li>\u7a0b\u5e8f\u6267\u884c\u4e2d\u51fa\u73b0\u4e86\u610f\u5916\u7684\u505c\u987f\uff0c\u5982\u7ebf\u7a0b\u5728 <code>lease.isValid()</code> \u884c\u5468\u56f4\u505c\u6b62 15 \u79d2\uff0c\u7136\u540e\u624d\u7ee7\u7eed\u3002</li> </ul> <p>\u4e00\u4e2a\u7ebf\u7a0b\u53ef\u80fd\u4f1a\u6682\u505c\u5f88\u957f\u65f6\u95f4\uff0c\u53d1\u751f\u7684\u539f\u56e0\u6709\u5f88\u591a\u79cd\uff1a</p> <ul> <li>\u5783\u573e\u6536\u96c6\u5668\uff08GC\uff09\u7684 stop-the-world\uff0c\u5982 Java \u865a\u62df\u673a\uff0c\u53ef\u4ee5\u901a\u8fc7\u6539\u53d8\u5206\u914d\u6a21\u5f0f\u6216\u8c03\u6574 GC \u7b56\u7565\u6765\u51cf\u5c11\u6682\u505c\u3002</li> <li>\u865a\u62df\u5316\u73af\u5883\u4e2d\uff0c\u53ef\u4ee5 \u6302\u8d77\uff08suspend\uff09 \u865a\u62df\u673a\uff08\u6682\u505c\u6267\u884c\u6240\u6709\u8fdb\u7a0b\u5e76\u5c06\u5185\u5b58\u5185\u5bb9\u4fdd\u5b58\u5230\u78c1\u76d8\uff09\u5e76\u6062\u590d\uff08\u6062\u590d\u5185\u5b58\u5185\u5bb9\u5e76\u7ee7\u7eed\u6267\u884c\uff09\u3002</li> <li>\u5728\u6700\u7ec8\u7528\u6237\u7684\u8bbe\u5907\uff08\u5982\u7b14\u8bb0\u672c\u7535\u8111\uff09\u4e0a\uff0c\u6267\u884c\u4e5f\u53ef\u80fd\u88ab\u6682\u505c\u5e76\u968f\u610f\u6062\u590d\uff0c\u5982\u5173\u95ed\u7535\u8111\u76d6\u5b50\u4f11\u7720\u65f6\u3002</li> <li>\u5728\u865a\u62df\u673a\u7684\u60c5\u51b5\u4e0b\uff0c\u5728\u5176\u4ed6\u865a\u62df\u673a\u4e2d\u82b1\u8d39\u7684 CPU \u65f6\u95f4\u88ab\u79f0\u4e3a \u7a83\u53d6\u65f6\u95f4\uff08steal time\uff09\u3002\u5f53\u7ba1\u7406\u7a0b\u5e8f\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u865a\u62df\u673a\u65f6\uff08\u5728\u865a\u62df\u673a\u4e2d\u8fd0\u884c\u65f6\uff09\uff0c\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u53ef\u80fd\u5728\u4ee3\u7801\u4e2d\u7684\u4efb\u610f\u70b9\u5904\u6682\u505c\u3002</li> <li>\u5e94\u7528\u7a0b\u5e8f\u6267\u884c\u540c\u6b65\u78c1\u76d8\u8bbf\u95ee\uff0c\u5219\u7ebf\u7a0b\u53ef\u80fd\u6682\u505c\uff0c\u7b49\u5f85\u7f13\u6162\u7684\u78c1\u76d8 I/O \u64cd\u4f5c\u5b8c\u6210\\(^{[48]}\\)\u3002I/O \u6682\u505c\u548c GC \u6682\u505c\u751a\u81f3\u53ef\u80fd\u5408\u8c0b\u7ec4\u5408\u5b83\u4eec\u7684\u5ef6\u8fdf\\(^{[49]}\\)\u3002</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u914d\u7f6e\u4e3a\u5141\u8bb8\u4ea4\u6362\u5230\u78c1\u76d8\uff08\u9875\u9762\u4ea4\u6362\uff09\uff0c\u5219\u7b80\u5355\u7684\u5185\u5b58\u8bbf\u95ee\u53ef\u80fd\u5bfc\u81f4 \u9875\u9762\u9519\u8bef\uff08page fault\uff09\uff0c\u8981\u6c42\u5c06\u78c1\u76d8\u4e2d\u7684\u9875\u9762\u88c5\u5165\u5185\u5b58\u3002\u5f53\u8fd9\u4e2a\u7f13\u6162\u7684 I/O \u64cd\u4f5c\u53d1\u751f\u65f6\uff0c\u7ebf\u7a0b\u6682\u505c\u3002\u5982\u679c\u5185\u5b58\u538b\u529b\u5f88\u9ad8\uff0c\u5219\u53ef\u80fd\u9700\u8981\u5c06\u53e6\u4e00\u4e2a\u9875\u9762\u6362\u51fa\u5230\u78c1\u76d8\u3002\u5728\u6781\u7aef\u60c5\u51b5\u4e0b\uff0c\u64cd\u4f5c\u7cfb\u7edf\u53ef\u80fd\u82b1\u8d39\u5927\u90e8\u5206\u65f6\u95f4\u5c06\u9875\u9762\u4ea4\u6362\u5230\u5185\u5b58\u4e2d\uff0c\u800c\u5b9e\u9645\u4e0a\u5b8c\u6210\u7684\u5de5\u4f5c\u5f88\u5c11\uff08\u8fd9\u88ab\u79f0\u4e3a \u6296\u52a8\uff0c\u5373 thrashing\uff09\u3002</li> <li>\u53d1\u9001 <code>SIGSTOP</code> \u4fe1\u53f7\u6765\u6682\u505c Unix \u8fdb\u7a0b\uff0c\u4f8b\u5982\u901a\u8fc7\u5728 shell \u4e2d\u6309\u4e0b Ctrl-Z\u3002\u8fd9\u4e2a\u4fe1\u53f7\u7acb\u5373\u963b\u6b62\u8fdb\u7a0b\u7ee7\u7eed\u6267\u884c\u66f4\u591a\u7684 CPU \u5468\u671f\uff0c\u76f4\u5230 <code>SIGCONT</code> \u6062\u590d\u4e3a\u6b62\uff0c\u6b64\u65f6\u5b83\u5c06\u7ee7\u7eed\u8fd0\u884c\u3002</li> </ul> <p>\u6240\u6709\u8fd9\u4e9b\u4e8b\u4ef6\u90fd\u53ef\u4ee5\u968f\u65f6 \u62a2\u5360\uff08preempt\uff09 \u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\uff0c\u5e76\u5728\u7a0d\u540e\u7684\u65f6\u95f4\u6062\u590d\u8fd0\u884c\uff0c\u800c\u7ebf\u7a0b\u751a\u81f3\u4e0d\u4f1a\u6ce8\u610f\u5230\u8fd9\u4e00\u70b9\u3002</p> <p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u8282\u70b9\uff0c\u5fc5\u987b\u5047\u5b9a\u5176\u6267\u884c\u53ef\u80fd\u5728\u4efb\u610f\u65f6\u523b\u6682\u505c\u76f8\u5f53\u957f\u7684\u65f6\u95f4\uff0c\u5373\u4f7f\u662f\u5728\u4e00\u4e2a\u51fd\u6570\u7684\u4e2d\u95f4\u3002</p>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_20","title":"\u54cd\u5e94\u65f6\u95f4\u4fdd\u8bc1","text":"<p>\u786c\u5b9e\u65f6\uff08hard real-time\uff09 \u7cfb\u7edf\uff1a\u8f6f\u4ef6\u5fc5\u987b\u6709\u4e00\u4e2a\u7279\u5b9a\u7684 \u622a\u6b62\u65f6\u95f4\uff08deadline\uff09\uff0c\u5982\u679c\u622a\u6b62\u65f6\u95f4\u4e0d\u6ee1\u8db3\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6574\u4e2a\u7cfb\u7edf\u7684\u6545\u969c\u3002\u9700\u8981\u5404\u7ea7\u8f6f\u4ef6\u6808\u7684\u652f\u6301\uff1a</p> <ul> <li>\u4e00\u4e2a\u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf\uff08RTOS\uff09\uff1a\u5728\u6307\u5b9a\u7684\u65f6\u95f4\u95f4\u9694\u5185\u4fdd\u8bc1 CPU \u65f6\u95f4\u7684\u5206\u914d</li> <li>\u52a8\u6001\u5185\u5b58\u5206\u914d\u53ef\u80fd\u53d7\u5230\u9650\u5236\u6216\u5b8c\u5168\u4e0d\u5141\u8bb8\uff08\u5b9e\u65f6\u5783\u573e\u6536\u96c6\u5668\u5b58\u5728\uff0c\u4f46\u662f\u5e94\u7528\u7a0b\u5e8f\u4ecd\u7136\u5fc5\u987b\u786e\u4fdd\u5b83\u4e0d\u4f1a\u7ed9 GC \u592a\u591a\u7684\u8d1f\u62c5\uff09</li> </ul> <p>\u5b9e\u65f6\u7cfb\u7edf\u53ef\u80fd\u5177\u6709\u8f83\u4f4e\u7684\u541e\u5410\u91cf\uff0c\u56e0\u4e3a\u4ed6\u4eec\u5fc5\u987b\u8ba9\u53ca\u65f6\u54cd\u5e94\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e\u4e00\u5207\u3002</p> <ul> <li>\u9650\u5236\u4e86\u53ef\u4ee5\u4f7f\u7528\u7684\u7f16\u7a0b\u8bed\u8a00\u3001\u5e93\u548c\u5de5\u5177\u7684\u8303\u56f4\uff0c\u5f00\u53d1\u5b9e\u65f6\u7cfb\u7edf\u975e\u5e38\u6602\u8d35\uff0c\u901a\u5e38\u7528\u4e8e\u5b89\u5168\u5173\u952e\u7684\u5d4c\u5165\u5f0f\u8bbe\u5907\u3002</li> </ul> <p>\u5bf9\u4e8e\u5927\u591a\u6570\u670d\u52a1\u5668\u7aef\u6570\u636e\u5904\u7406\u7cfb\u7edf\u6765\u8bf4\uff0c\u5b9e\u65f6\u4fdd\u8bc1\u662f\u4e0d\u7ecf\u6d4e\u6216\u4e0d\u5408\u9002\u7684\u3002\u56e0\u6b64\uff0c\u8fd9\u4e9b\u7cfb\u7edf\u5fc5\u987b\u627f\u53d7\u5728\u975e\u5b9e\u65f6\u73af\u5883\u4e2d\u8fd0\u884c\u7684\u6682\u505c\u548c\u65f6\u949f\u4e0d\u7a33\u5b9a\u6027\u3002</p>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_21","title":"\u9650\u5236\u5783\u573e\u6536\u96c6\u7684\u5f71\u54cd","text":"<p>\u8bed\u8a00\u8fd0\u884c\u65f6\u5728\u8ba1\u5212\u5783\u573e\u56de\u6536\u65f6\u5177\u6709\u4e00\u5b9a\u7684\u7075\u6d3b\u6027\uff0c\u56e0\u4e3a\u5b83\u4eec\u53ef\u4ee5\u8ddf\u8e2a\u5bf9\u8c61\u5206\u914d\u7684\u901f\u5ea6\u548c\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u5269\u4f59\u7684\u7a7a\u95f2\u5185\u5b58\u3002</p> <ul> <li>\u5c06 GC \u6682\u505c\u89c6\u4e3a\u4e00\u4e2a\u8282\u70b9\u7684\u77ed\u6682\u8ba1\u5212\u4e2d\u65ad\uff0c\u5e76\u5728\u8fd9\u4e2a\u8282\u70b9\u6536\u96c6\u5176\u5783\u573e\u7684\u540c\u65f6\uff0c\u8ba9\u5176\u4ed6\u8282\u70b9\u5904\u7406\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\\(^{[50,51,52]}\\)\u3002</li> <li>\u53ea\u7528\u5783\u573e\u6536\u96c6\u5668\u6765\u5904\u7406\u77ed\u547d\u5bf9\u8c61\uff08\u8fd9\u4e9b\u5bf9\u8c61\u53ef\u4ee5\u5feb\u901f\u6536\u96c6\uff09\uff0c\u5e76\u5b9a\u671f\u5728\u79ef\u7d2f\u5927\u91cf\u957f\u5bff\u5bf9\u8c61\uff08\u56e0\u6b64\u9700\u8981\u5b8c\u6574 GC\uff09\u4e4b\u524d\u91cd\u65b0\u542f\u52a8\u8fdb\u7a0b\\(^{[47,53]}\\)\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_22","title":"\u77e5\u8bc6\u3001\u771f\u76f8\u4e0e\u8c0e\u8a00","text":"<p>\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u9648\u8ff0\u5173\u4e8e\u884c\u4e3a\uff08\u7cfb\u7edf\u6a21\u578b\uff09\u7684\u5047\u8bbe\uff0c\u5e76\u4ee5\u6ee1\u8db3\u8fd9\u4e9b\u5047\u8bbe\u7684\u65b9\u5f0f\u8bbe\u8ba1\u5b9e\u9645\u7cfb\u7edf\u3002\u7b97\u6cd5\u53ef\u4ee5\u88ab\u8bc1\u660e\u5728\u67d0\u4e2a\u7cfb\u7edf\u6a21\u578b\u4e2d\u6b63\u786e\u8fd0\u884c\u3002\u8fd9\u610f\u5473\u7740\u5373\u4f7f\u5e95\u5c42\u7cfb\u7edf\u6a21\u578b\u63d0\u4f9b\u4e86\u5f88\u5c11\u7684\u4fdd\u8bc1\uff0c\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u53ef\u9760\u7684\u884c\u4e3a\u3002</p>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_23","title":"\u771f\u76f8\u7531\u591a\u6570\u6240\u5b9a\u4e49","text":"<p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0d\u80fd\u5b8c\u5168\u4f9d\u8d56\u5355\u4e2a\u8282\u70b9\uff0c\u56e0\u4e3a\u8282\u70b9\u53ef\u80fd\u968f\u65f6\u5931\u6548\uff0c\u53ef\u80fd\u4f1a\u4f7f\u7cfb\u7edf\u5361\u6b7b\uff0c\u65e0\u6cd5\u6062\u590d\u3002</p> <ul> <li>\u5206\u5e03\u5f0f\u7b97\u6cd5\u90fd\u4f9d\u8d56\u4e8e\u6cd5\u5b9a\u4eba\u6570\uff0c\u51b3\u7b56\u9700\u8981\u6765\u81ea\u591a\u4e2a\u8282\u70b9\u7684\u6700\u5c0f\u6295\u7968\u6570\uff0c\u4ee5\u51cf\u5c11\u5bf9\u4e8e\u67d0\u4e2a\u7279\u5b9a\u8282\u70b9\u7684\u4f9d\u8d56\u3002</li> </ul> <p>\u6700\u5e38\u89c1\u7684\u6cd5\u5b9a\u4eba\u6570\u662f\u8d85\u8fc7\u4e00\u534a\u7684\u7edd\u5bf9\u591a\u6570\uff08\u5c3d\u7ba1\u5176\u4ed6\u7c7b\u578b\u7684\u6cd5\u5b9a\u4eba\u6570\u4e5f\u662f\u53ef\u80fd\u7684\uff09\u3002</p> <ul> <li>\u591a\u6570\u6cd5\u5b9a\u4eba\u6570\u5141\u8bb8\u7cfb\u7edf\u7ee7\u7eed\u5de5\u4f5c\uff0c\u5982\u679c\u5355\u4e2a\u8282\u70b9\u53d1\u751f\u6545\u969c\uff08\u4e09\u4e2a\u8282\u70b9\u53ef\u4ee5\u5bb9\u5fcd\u5355\u8282\u70b9\u6545\u969c\uff1b\u4e94\u4e2a\u8282\u70b9\u53ef\u4ee5\u5bb9\u5fcd\u53cc\u8282\u70b9\u6545\u969c\uff09\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_24","title":"\u9886\u5bfc\u8005\u548c\u9501","text":"<p>\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e9b\u4e1c\u897f\u5728\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u53ea\u80fd\u6709\u4e00\u4e2a\u3002\u4f8b\u5982\uff1a</p> <ul> <li>\u6570\u636e\u5e93\u5206\u533a\u7684\u9886\u5bfc\u8005\u53ea\u80fd\u6709\u4e00\u4e2a\u8282\u70b9\uff0c\u4ee5\u907f\u514d \u8111\u88c2\uff08\u5373 split brain\uff09\u3002</li> <li>\u7279\u5b9a\u8d44\u6e90\u7684\u9501\u6216\u5bf9\u8c61\u53ea\u5141\u8bb8\u4e00\u4e2a\u4e8b\u52a1 / \u5ba2\u6237\u7aef\u6301\u6709\uff0c\u4ee5\u9632\u540c\u65f6\u5199\u5165\u548c\u635f\u574f\u3002</li> <li>\u4e00\u4e2a\u7279\u5b9a\u7684\u7528\u6237\u540d\u53ea\u80fd\u88ab\u4e00\u4e2a\u7528\u6237\u6240\u6ce8\u518c\uff0c\u56e0\u4e3a\u7528\u6237\u540d\u5fc5\u987b\u552f\u4e00\u6807\u8bc6\u4e00\u4e2a\u7528\u6237\u3002</li> </ul> <p>\u5373\u4f7f\u4e00\u4e2a\u8282\u70b9\u8ba4\u4e3a\u5b83\u662f \u201c\u5929\u9009\u8005\uff08the choosen one\uff09\u201d\uff08\u5206\u533a\u7684\u8d1f\u8d23\u4eba\uff0c\u9501\u7684\u6301\u6709\u8005\uff0c\u6210\u529f\u83b7\u53d6\u7528\u6237\u540d\u7684\u7528\u6237\u7684\u8bf7\u6c42\u5904\u7406\u7a0b\u5e8f\uff09\uff0c\u4f46\u8fd9\u5e76\u4e0d\u4e00\u5b9a\u610f\u5473\u7740\u6709\u6cd5\u5b9a\u4eba\u6570\u7684\u8282\u70b9\u540c\u610f\uff01</p> <ul> <li>\u4e00\u4e2a\u8282\u70b9\u53ef\u80fd\u4ee5\u524d\u662f\u9886\u5bfc\u8005\uff0c\u4f46\u662f\u5982\u679c\u5176\u4ed6\u8282\u70b9\u5728\u6b64\u671f\u95f4\u5ba3\u5e03\u5b83\u6b7b\u4ea1\uff08\u4f8b\u5982\uff0c\u7531\u4e8e\u7f51\u7edc\u4e2d\u65ad\u6216 GC \u6682\u505c\uff09\uff0c\u5219\u5b83\u53ef\u80fd\u5df2\u88ab\u964d\u7ea7\uff0c\u4e14\u53e6\u4e00\u4e2a\u9886\u5bfc\u8005\u53ef\u80fd\u5df2\u7ecf\u5f53\u9009\u3002</li> </ul> <p>\u4e0b\u56fe\u662f\u7531\u4e8e\u4e0d\u6b63\u786e\u7684\u9501\u5b9e\u73b0\u5bfc\u81f4\u7684\u6570\u636e\u635f\u574f\u9519\u8bef\u3002</p> <ul> <li>\u4e00\u4e2a\u5b58\u50a8\u670d\u52a1\u4e2d\u7684\u6587\u4ef6\u4e00\u6b21\u53ea\u80fd\u88ab\u4e00\u4e2a\u5ba2\u6237\u8bbf\u95ee\uff0c\u8981\u6c42\u5ba2\u6237\u7aef\u4ece\u9501\u5b9a\u670d\u52a1\u83b7\u53d6\u79df\u7ea6\u6765\u5b9e\u73b0\u3002</li> </ul> <p></p> \u5206\u5e03\u5f0f\u9501\u7684\u5b9e\u73b0\u4e0d\u6b63\u786e\uff1a\u5ba2\u6237\u7aef 1 \u8ba4\u4e3a\u5b83\u4ecd\u7136\u5177\u6709\u6709\u6548\u7684\u79df\u7ea6\uff0c\u5373\u4f7f\u5b83\u5df2\u7ecf\u8fc7\u671f\uff0c\u4ece\u800c\u7834\u574f\u4e86\u5b58\u50a8\u4e2d\u7684\u6587\u4ef6"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_25","title":"\u9632\u62a4\u4ee4\u724c","text":"<p>\u9632\u62a4\uff08fencing\uff09\uff1a\u786e\u4fdd\u4e00\u4e2a\u88ab\u8bef\u8ba4\u4e3a\u81ea\u5df1\u662f \u201c\u5929\u9009\u8005\u201d \u7684\u8282\u70b9\u4e0d\u80fd\u6270\u4e71\u7cfb\u7edf\u7684\u5176\u5b83\u90e8\u5206\u3002</p> <ul> <li>\u5047\u8bbe\u6bcf\u6b21\u9501\u5b9a\u670d\u52a1\u5668\u6388\u4e88\u9501\u6216\u79df\u7ea6\u65f6\uff0c\u5b83\u8fd8\u4f1a\u8fd4\u56de\u4e00\u4e2a \u9632\u62a4\u4ee4\u724c\uff08fencing token\uff09\uff0c\u4e14\u6570\u5b57\u6bcf\u6b21\u6388\u4e88\u9501\u5b9a\u65f6\u90fd\u4f1a\u589e\u52a0\uff08\u5982\u7531\u9501\u5b9a\u670d\u52a1\u589e\u52a0\uff09\uff1b</li> <li>\u8981\u6c42\u5ba2\u6237\u7aef\u6bcf\u6b21\u5411\u5b58\u50a8\u670d\u52a1\u53d1\u9001\u5199\u5165\u8bf7\u6c42\u65f6\uff0c\u90fd\u5fc5\u987b\u5305\u542b\u5f53\u524d\u7684\u9632\u62a4\u4ee4\u724c\uff1b</li> <li>\u670d\u52a1\u5668\u53d1\u73b0\u5ba2\u6237\u7aef\u53d1\u9001\u7684 token \u8fc7\u65f6\uff0c\u4f1a\u62d2\u7edd\u5199\u5165\u8bf7\u6c42\uff1b</li> </ul> <p></p> \u53ea\u5141\u8bb8\u4ee5\u589e\u52a0\u9632\u62a4\u4ee4\u724c\u7684\u987a\u5e8f\u8fdb\u884c\u5199\u64cd\u4f5c\uff0c\u4ece\u800c\u4fdd\u8bc1\u5b58\u50a8\u5b89\u5168 <p>\u5982\u679c\u5c06 ZooKeeper \u7528\u4f5c\u9501\u5b9a\u670d\u52a1\uff0c\u5219\u53ef\u5c06\u4e8b\u52a1\u6807\u8bc6 <code>zxid</code> \u6216\u8282\u70b9\u7248\u672c <code>cversion</code> \u7528\u4f5c\u9632\u62a4\u4ee4\u724c\u3002\u7531\u4e8e\u5b83\u4eec\u4fdd\u8bc1\u5355\u8c03\u9012\u589e\uff0c\u56e0\u6b64\u5b83\u4eec\u5177\u6709\u6240\u9700\u7684\u5c5e\u6027\\(^{[54]}\\)\u3002</p> <ul> <li>zookeeper \u901a\u8fc7\u4e34\u65f6\u8282\u70b9\u5b9e\u73b0\u7684\u9501\uff0c\u8fd8\u9700\u8981\u9632\u62a4\u4ee4\u724c\u4e48\uff1f</li> </ul> <p>\u5728\u670d\u52a1\u5668\u7aef\u68c0\u67e5\u4e00\u4e2a\u4ee4\u724c\u53ef\u80fd\u770b\u8d77\u6765\u50cf\u662f\u4e00\u4e2a\u7f3a\u70b9\uff0c\u4f46\u8fd9\u53ef\u4ee5\u8bf4\u662f\u4e00\u4ef6\u597d\u4e8b\uff1a\u4e00\u4e2a\u670d\u52a1\u5047\u5b9a\u5b83\u7684\u5ba2\u6237\u603b\u662f\u5b88\u89c4\u77e9\u5e76\u4e0d\u660e\u667a\uff0c\u56e0\u4e3a\u4f7f\u7528\u5ba2\u6237\u7aef\u7684\u4eba\u4e0e\u8fd0\u884c\u670d\u52a1\u7684\u4eba\u4f18\u5148\u7ea7\u975e\u5e38\u4e0d\u4e00\u6837\\(^{[55]}\\)\u3002</p>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_26","title":"\u62dc\u5360\u5ead\u6545\u969c","text":"<p>\u62dc\u5360\u5ead\u6545\u969c\uff08Byzantine fault\uff09\uff1a\u5b58\u5728\u8282\u70b9\u53ef\u80fd \u201c\u6492\u8c0e\u201d\uff08\u53d1\u9001\u4efb\u610f\u9519\u8bef\u6216\u635f\u574f\u7684\u54cd\u5e94\uff09\u3002</p> <p>\u5728\u4e0d\u4fe1\u4efb\u7684\u73af\u5883\u4e2d\u8fbe\u6210\u5171\u8bc6\u7684\u95ee\u9898\u88ab\u79f0\u4e3a\u62dc\u5360\u5ead\u5c06\u519b\u95ee\u9898\\(^{[56]}\\)\u3002</p> <p>\u5f53\u4e00\u4e2a\u7cfb\u7edf\u5728\u90e8\u5206\u8282\u70b9\u53d1\u751f\u6545\u969c\u3001\u4e0d\u9075\u5b88\u534f\u8bae\u3001\u751a\u81f3\u6076\u610f\u653b\u51fb\u3001\u6270\u4e71\u7f51\u7edc\u65f6\u4ecd\u7136\u80fd\u7ee7\u7eed\u6b63\u786e\u5de5\u4f5c\uff0c\u79f0\u4e4b\u4e3a \u62dc\u5360\u5ead\u5bb9\u9519\uff08Byzantine fault-tolerant\uff09\uff0c\u5728\u67d0\u4e9b\u7279\u5b9a\u60c5\u51b5\u4e0b\u662f\u6709\u610f\u4e49\u7684\uff1a</p> <ul> <li>\u822a\u7a7a\u822a\u5929\u73af\u5883\u4e2d\uff0c\u8ba1\u7b97\u673a\u5185\u5b58\u6216 CPU \u5bc4\u5b58\u5668\u4e2d\u7684\u6570\u636e\u53ef\u80fd\u88ab\u8f90\u5c04\u7834\u574f\uff0c\u98de\u884c\u63a7\u5236\u7cfb\u7edf\u5fc5\u987b\u5bb9\u5fcd\u62dc\u5360\u5ead\u6545\u969c\\(^{[57,58]}\\)\u3002</li> <li>\u5728\u591a\u4e2a\u53c2\u4e0e\u7ec4\u7ec7\u7684\u7cfb\u7edf\u4e2d\uff0c\u4e00\u4e9b\u53c2\u4e0e\u8005\u53ef\u80fd\u4f1a\u8bd5\u56fe\u6b3a\u9a97\u6216\u8bc8\u9a97\u4ed6\u4eba\u3002\u5982\u50cf\u6bd4\u7279\u5e01\u548c\u5176\u4ed6\u533a\u5757\u94fe\u4e00\u6837\u7684\u5bf9\u7b49\u7f51\u7edc\u3002</li> </ul> <p>\u5236\u4f5c\u62dc\u5360\u5ead\u5bb9\u9519\u7cfb\u7edf\u7684\u534f\u8bae\u76f8\u5f53\u590d\u6742\\(^{[59]}\\)\uff0c\u800c\u5bb9\u9519\u5d4c\u5165\u5f0f\u7cfb\u7edf\u4f9d\u8d56\u4e8e\u786c\u4ef6\u5c42\u9762\u7684\u652f\u6301\\(^{[57]}\\)\u3002\u5728\u5927\u591a\u6570\u670d\u52a1\u5668\u7aef\u6570\u636e\u7cfb\u7edf\u4e2d\uff0c\u90e8\u7f72\u62dc\u5360\u5ead\u5bb9\u9519\u89e3\u51b3\u65b9\u6848\u7684\u6210\u672c\u4f7f\u5176\u53d8\u5f97\u4e0d\u5207\u5b9e\u9645\u3002</p> <ul> <li>\u5927\u591a\u6570\u62dc\u5360\u5ead\u5f0f\u5bb9\u9519\u7b97\u6cd5\u8981\u6c42\u8d85\u8fc7\u4e09\u5206\u4e4b\u4e8c\u7684\u8282\u70b9\u80fd\u591f\u6b63\u5e38\u5de5\u4f5c\uff08\u5373\uff0c\u5982\u679c\u6709\u56db\u4e2a\u8282\u70b9\uff0c\u6700\u591a\u53ea\u80fd\u6709\u4e00\u4e2a\u6545\u969c\uff09\u3002</li> </ul> <p>Web \u5e94\u7528\u7a0b\u5e8f\u786e\u5b9e\u9700\u8981\u9884\u671f\u53d7\u7ec8\u7aef\u7528\u6237\u63a7\u5236\u7684\u5ba2\u6237\u7aef\uff08\u5982 Web \u6d4f\u89c8\u5668\uff09\u7684\u4efb\u610f\u548c\u6076\u610f\u884c\u4e3a</p> <ul> <li>\u901a\u5e38\u4e0d\u5728\u8fd9\u91cc\u4f7f\u7528\u62dc\u5360\u5ead\u5bb9\u9519\u534f\u8bae\uff0c\u800c\u53ea\u662f\u8ba9\u670d\u52a1\u5668\u6709\u6743\u51b3\u5b9a\u662f\u5426\u5141\u8bb8\u5ba2\u6237\u7aef\u884c\u4e3a\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_27","title":"\u5f31\u8c0e\u8a00\u5f62\u5f0f","text":"<p>\u5c3d\u7ba1\u6211\u4eec\u5047\u8bbe\u8282\u70b9\u901a\u5e38\u662f\u8bda\u5b9e\u7684\uff0c\u4f46\u503c\u5f97\u5411\u8f6f\u4ef6\u4e2d\u6dfb\u52a0\u9632\u6b62 \u201c\u6492\u8c0e\u201d \u5f31\u5f62\u5f0f\u7684\u673a\u5236\uff1a</p> <ul> <li>\u7f51\u7edc\u6570\u636e\u5305\u6709\u65f6\u4f1a\u53d7\u5230\u635f\u574f\uff1a\u9003\u8131\u5185\u5efa\u4e8e TCP \u548c UDP \u4e2d\u7684\u6821\u9a8c\u548c\u68c0\u6d4b\\(^{[60,61,62]}\\)\uff0c\u4f46\u5e94\u7528\u7a0b\u5e8f\u7ea7\u534f\u8bae\u4e2d\u7684\u6821\u9a8c\u548c\u53ef\u4ee5\u9632\u6b62\uff1b</li> <li>\u7528\u6237\u7684\u4efb\u4f55\u8f93\u5165\u6821\u9a8c\uff1a\u53ef\u516c\u5f00\u8bbf\u95ee\u7684\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u4ed4\u7ec6\u6e05\u7406\u6765\u81ea\u7528\u6237\u7684\u4efb\u4f55\u8f93\u5165</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_28","title":"\u7cfb\u7edf\u6a21\u578b\u4e0e\u73b0\u5b9e","text":"<p>\u5173\u4e8e\u65f6\u5e8f\u5047\u8bbe\uff0c\u4e09\u79cd\u7cfb\u7edf\u6a21\u578b\u662f\u5e38\u7528\u7684\uff1a</p> <ul> <li>\u540c\u6b65\u6a21\u578b\uff1a\u5047\u8bbe\u7f51\u7edc\u5ef6\u8fdf\u3001\u8fdb\u7a0b\u6682\u505c\u548c\u548c\u65f6\u949f\u8bef\u5dee\u90fd\u662f\u53d7\u9650\u7684</li> <li>\u5e76\u4e0d\u662f\u5927\u591a\u6570\u5b9e\u9645\u7cfb\u7edf\u7684\u73b0\u5b9e\u6a21\u578b\uff0c\u56e0\u4e3a\u65e0\u9650\u5ef6\u8fdf\u548c\u6682\u505c\u786e\u5b9e\u4f1a\u53d1\u751f\u3002</li> <li>\u90e8\u5206\u540c\u6b65\u6a21\u578b\uff1a\u4e00\u4e2a\u7cfb\u7edf\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u50cf\u4e00\u4e2a\u540c\u6b65\u7cfb\u7edf\u4e00\u6837\u8fd0\u884c\uff0c\u4f46\u6709\u65f6\u5019\u4f1a\u8d85\u51fa\u7f51\u7edc\u5ef6\u8fdf\uff0c\u8fdb\u7a0b\u6682\u505c\u548c\u65f6\u949f\u6f02\u79fb\u7684\u754c\u9650\\(^{[63]}\\)</li> <li>\u5f88\u591a\u7cfb\u7edf\u7684\u73b0\u5b9e\u6a21\u578b\uff0c\u5927\u591a\u6570\u60c5\u51b5\u7f51\u7edc\u548c\u8fdb\u7a0b\u8868\u73b0\u826f\u597d\u3002</li> <li>\u5f02\u6b65\u6a21\u578b\uff1a\u7b97\u6cd5\u4e0d\u5141\u8bb8\u5bf9\u65f6\u5e8f\u505a\u4efb\u4f55\u5047\u8bbe</li> <li>\u4e8b\u5b9e\u4e0a\u5b83\u751a\u81f3\u6ca1\u6709\u65f6\u949f\uff08\u6240\u4ee5\u5b83\u4e0d\u80fd\u4f7f\u7528\u8d85\u65f6\uff09\u3002\u4e00\u4e9b\u7b97\u6cd5\u88ab\u8bbe\u8ba1\u4e3a\u53ef\u7528\u4e8e\u5f02\u6b65\u6a21\u578b\uff0c\u4f46\u975e\u5e38\u53d7\u9650\u3002</li> </ul> <p>\u9664\u4e86\u65f6\u5e8f\u95ee\u9898\uff0c\u6211\u4eec\u8fd8\u8981\u8003\u8651 \u8282\u70b9\u5931\u6548\u3002\u4e09\u79cd\u6700\u5e38\u89c1\u7684\u8282\u70b9\u7cfb\u7edf\u6a21\u578b\u662f\uff1a</p> <ul> <li>\u5d29\u6e83 - \u505c\u6b62\u6545\u969c\uff1a\u7b97\u6cd5\u53ef\u80fd\u4f1a\u5047\u8bbe\u4e00\u4e2a\u8282\u70b9\u53ea\u80fd\u4ee5\u4e00\u79cd\u65b9\u5f0f\u5931\u6548\uff0c\u5373\u901a\u8fc7\u5d29\u6e83</li> <li>\u610f\u5473\u7740\u8282\u70b9\u53ef\u80fd\u5728\u4efb\u610f\u65f6\u523b\u7a81\u7136\u505c\u6b62\u54cd\u5e94\uff0c\u6b64\u540e\u8be5\u8282\u70b9\u6c38\u8fdc\u6d88\u5931 \u2014\u2014 \u5b83\u6c38\u8fdc\u4e0d\u4f1a\u56de\u6765\u3002</li> <li>\u5d29\u6e83 - \u6062\u590d\u6545\u969c\uff1a\u5047\u8bbe\u8282\u70b9\u53ef\u80fd\u4f1a\u5728\u4efb\u4f55\u65f6\u5019\u5d29\u6e83\uff0c\u4f46\u4e5f\u8bb8\u4f1a\u5728\u672a\u77e5\u7684\u65f6\u95f4\u4e4b\u540e\u518d\u6b21\u5f00\u59cb\u54cd\u5e94\u3002</li> <li>\u5047\u8bbe\u8282\u70b9\u5177\u6709\u7a33\u5b9a\u7684\u5b58\u50a8\uff08\u5373\u975e\u6613\u5931\u6027\u78c1\u76d8\u5b58\u50a8\uff09\u4e14\u4f1a\u5728\u5d29\u6e83\u4e2d\u4fdd\u7559\uff0c\u800c\u5185\u5b58\u4e2d\u7684\u72b6\u6001\u4f1a\u4e22\u5931\u3002</li> <li>\u62dc\u5360\u5ead\uff08\u4efb\u610f\uff09\u6545\u969c\uff1a\u8282\u70b9\u53ef\u4ee5\u505a\uff08\u7edd\u5bf9\u610f\u4e49\u4e0a\u7684\uff09\u4efb\u4f55\u4e8b\u60c5\uff0c\u5305\u62ec\u8bd5\u56fe\u620f\u5f04\u548c\u6b3a\u9a97\u5176\u4ed6\u8282\u70b9</li> </ul> <p>\u5bf9\u4e8e\u771f\u5b9e\u7cfb\u7edf\u7684\u5efa\u6a21\uff0c\u5177\u6709\u5d29\u6e83 - \u6062\u590d\u6545\u969c\uff08crash-recovery\uff09 \u7684 \u90e8\u5206\u540c\u6b65\u6a21\u578b\uff08partial synchronous\uff09\u901a\u5e38\u662f\u6700\u6709\u7528\u7684\u6a21\u578b\u3002</p>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_29","title":"\u7b97\u6cd5\u7684\u6b63\u786e\u6027","text":"<p>\u5199\u4e0b\u60f3\u8981\u7684\u5206\u5e03\u5f0f\u7b97\u6cd5\u7684\u5c5e\u6027\u6765\u5b9a\u4e49\u5b83\u7684\u6b63\u786e\u542b\u4e49\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u6b63\u5728\u4e3a\u4e00\u4e2a\u9501\u751f\u6210\u9632\u62a4\u4ee4\u724c\uff0c\u6211\u4eec\u53ef\u80fd\u8981\u6c42\u7b97\u6cd5\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a</p> <ul> <li>\u552f\u4e00\u6027\uff08uniqueness\uff09\uff1a\u6ca1\u6709\u4e24\u4e2a\u9632\u62a4\u4ee4\u724c\u8bf7\u6c42\u8fd4\u56de\u76f8\u540c\u7684\u503c\u3002</li> <li>\u5355\u8c03\u5e8f\u5217\uff08monotonic sequence\uff09\uff1a\u5982\u679c\u8bf7\u6c42 \ud835\udc65 \u8fd4\u56de\u4e86\u4ee4\u724c \ud835\udc61\ud835\udc65\uff0c\u5e76\u4e14\u8bf7\u6c42 \ud835\udc66 \u8fd4\u56de\u4e86\u4ee4\u724c \ud835\udc61\ud835\udc66\uff0c\u5e76\u4e14 \ud835\udc65 \u5728 \ud835\udc66 \u5f00\u59cb\u4e4b\u524d\u5df2\u7ecf\u5b8c\u6210\uff0c\u90a3\u4e48 \ud835\udc61\ud835\udc65&lt;\ud835\udc61\ud835\udc66\u3002</li> <li>\u53ef\u7528\u6027\uff08availability\uff09\uff1a\u8bf7\u6c42\u9632\u62a4\u4ee4\u724c\u5e76\u4e14\u4e0d\u4f1a\u5d29\u6e83\u7684\u8282\u70b9\uff0c\u6700\u7ec8\u4f1a\u6536\u5230\u54cd\u5e94\u3002</li> </ul> <p>\u5982\u679c\u4e00\u4e2a\u7cfb\u7edf\u6a21\u578b\u4e2d\u7684\u7b97\u6cd5\u603b\u662f\u6ee1\u8db3\u5b83\u5728\u6240\u6709\u6211\u4eec\u5047\u8bbe\u53ef\u80fd\u53d1\u751f\u7684\u60c5\u51b5\u4e0b\u7684\u6027\u8d28\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7b97\u6cd5\u662f\u6b63\u786e\u7684\u3002</p>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_30","title":"\u5b89\u5168\u6027\u548c\u6d3b\u6027","text":"<p>\u5b89\u5168\uff08safety\uff09\u5c5e\u6027 \u548c \u6d3b\u6027\uff08liveness\uff09\u5c5e\u6027</p> <ul> <li>\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff1a\u552f\u4e00\u6027 \u548c \u5355\u8c03\u5e8f\u5217 \u662f\u5b89\u5168\u5c5e\u6027\uff0c\u800c \u53ef\u7528\u6027 \u662f\u6d3b\u6027\u5c5e\u6027</li> <li>\u6700\u7ec8\u4e00\u81f4\u6027\u662f\u4e00\u4e2a\u6d3b\u6027\u5c5e\u6027\\(^{[64]}\\)</li> </ul> <p>\u5b89\u5168\u548c\u6d3b\u6027\u7684\u5b9e\u9645\u5b9a\u4e49\u662f\u7cbe\u786e\u7684\u548c\u6570\u5b66\u7684\\(^{[65]}\\)\uff1a</p> <ul> <li>\u5982\u679c\u5b89\u5168\u5c5e\u6027\u88ab\u8fdd\u53cd\uff0c\u6211\u4eec\u53ef\u4ee5\u6307\u5411\u4e00\u4e2a\u7279\u5b9a\u7684\u5b89\u5168\u5c5e\u6027\u88ab\u7834\u574f\u7684\u65f6\u95f4\u70b9\uff08\u4f8b\u5982\uff0c\u5982\u679c\u8fdd\u53cd\u4e86\u552f\u4e00\u6027\u5c5e\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u786e\u5b9a\u91cd\u590d\u7684\u9632\u62a4\u4ee4\u724c\u88ab\u8fd4\u56de\u7684\u7279\u5b9a\u64cd\u4f5c\uff09\u3002\u8fdd\u53cd\u5b89\u5168\u5c5e\u6027\u540e\uff0c\u8fdd\u89c4\u884c\u4e3a\u4e0d\u80fd\u88ab\u64a4\u9500 \u2014\u2014 \u635f\u5931\u5df2\u7ecf\u53d1\u751f\u3002</li> <li>\u6d3b\u6027\u5c5e\u6027\u53cd\u8fc7\u6765\uff1a\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\uff08\u4f8b\u5982\uff0c\u4e00\u4e2a\u8282\u70b9\u53ef\u80fd\u53d1\u9001\u4e86\u4e00\u4e2a\u8bf7\u6c42\uff0c\u4f46\u8fd8\u6ca1\u6709\u6536\u5230\u54cd\u5e94\uff09\uff0c\u5b83\u53ef\u80fd\u4e0d\u6210\u7acb\uff0c\u4f46\u603b\u662f\u5e0c\u671b\u5728\u672a\u6765\u80fd\u6210\u7acb\uff08\u5373\u901a\u8fc7\u63a5\u53d7\u7b54\u590d\uff09\u3002</li> </ul> <p>\u5bf9\u4e8e\u5206\u5e03\u5f0f\u7b97\u6cd5\uff0c\u5728\u7cfb\u7edf\u6a21\u578b\u7684\u6240\u6709\u53ef\u80fd\u60c5\u51b5\u4e0b\uff0c\u8981\u6c42 \u59cb\u7ec8 \u4fdd\u6301\u5b89\u5168\u5c5e\u6027\u662f\u5e38\u89c1\u7684\\(^{[63]}\\)\u3002</p> <ul> <li>\u4f7f\u6240\u6709\u8282\u70b9\u5d29\u6e83\uff0c\u6216\u8005\u6574\u4e2a\u7f51\u7edc\u51fa\u73b0\u6545\u969c\uff0c\u7b97\u6cd5\u4ecd\u7136\u5fc5\u987b\u786e\u4fdd\u5b83\u4e0d\u4f1a\u8fd4\u56de\u9519\u8bef\u7684\u7ed3\u679c\uff08\u5373\u4fdd\u8bc1\u5b89\u5168\u5c5e\u6027\u5f97\u5230\u6ee1\u8db3\uff09</li> </ul> <p>\u5bf9\u4e8e\u6d3b\u6027\u5c5e\u6027\uff0c\u6709\u4e00\u4e9b\u6ce8\u610f\u4e8b\u9879\uff1a</p> <ul> <li>\u53ea\u6709\u5728\u5927\u591a\u6570\u8282\u70b9\u6ca1\u6709\u5d29\u6e83\u7684\u60c5\u51b5\u4e0b\uff0c\u53ea\u6709\u5f53\u7f51\u7edc\u6700\u7ec8\u4ece\u4e2d\u65ad\u4e2d\u6062\u590d\u65f6\uff0c\u6211\u4eec\u624d\u53ef\u4ee5\u8bf4\u8bf7\u6c42\u9700\u8981\u63a5\u6536\u54cd\u5e94\u3002</li> <li>\u90e8\u5206\u540c\u6b65\u6a21\u578b\u7684\u5b9a\u4e49\u8981\u6c42\u7cfb\u7edf\u6700\u7ec8\u8fd4\u56de\u5230\u540c\u6b65\u72b6\u6001 \u2014\u2014 \u5373\u4efb\u4f55\u7f51\u7edc\u4e2d\u65ad\u7684\u65f6\u95f4\u6bb5\u53ea\u4f1a\u6301\u7eed\u4e00\u6bb5\u6709\u9650\u7684\u65f6\u95f4\uff0c\u7136\u540e\u8fdb\u884c\u4fee\u590d\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_31","title":"\u5c06\u7cfb\u7edf\u6a21\u578b\u6620\u5c04\u5230\u73b0\u5b9e\u4e16\u754c","text":"<p>\u5b89\u5168\u5c5e\u6027\u548c\u6d3b\u6027\u5c5e\u6027\u4ee5\u53ca\u7cfb\u7edf\u6a21\u578b\u5bf9\u4e8e\u63a8\u7406\u5206\u5e03\u5f0f\u7b97\u6cd5\u7684\u6b63\u786e\u6027\u975e\u5e38\u6709\u7528\u3002</p> <ul> <li>\u5728\u5b9e\u8df5\u4e2d\u5b9e\u65bd\u7b97\u6cd5\u65f6\uff0c\u73b0\u5b9e\u7684\u6df7\u4e71\u4e8b\u5b9e\u518d\u4e00\u6b21\u5730\u8ba9\u4f60\u54ac\u7259\u5207\u9f7f\uff0c\u5f88\u660e\u663e\u7cfb\u7edf\u6a21\u578b\u662f\u5bf9\u73b0\u5b9e\u7684\u7b80\u5316\u62bd\u8c61\u3002</li> </ul> <p>\u5d29\u6e83 - \u6062\u590d\uff08crash-recovery\uff09\u6a21\u578b\u4e2d\u7684\u7b97\u6cd5\u901a\u5e38\u5047\u8bbe\u7a33\u5b9a\u5b58\u50a8\u5668\u4e2d\u7684\u6570\u636e\u5728\u5d29\u6e83\u540e\u53ef\u4ee5\u5e78\u5b58</p> <ul> <li>\u5982\u679c\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u88ab\u7834\u574f\uff0c\u6216\u8005\u7531\u4e8e\u786c\u4ef6\u9519\u8bef\u6216\u9519\u8bef\u914d\u7f6e\u5bfc\u81f4\u6570\u636e\u88ab\u6e05\u9664\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\u60c5\u51b5\\(^{[66]}\\)\uff1f</li> <li>\u5982\u679c\u670d\u52a1\u5668\u5b58\u5728\u56fa\u4ef6\u9519\u8bef\u5e76\u4e14\u5728\u91cd\u65b0\u542f\u52a8\u65f6\u65e0\u6cd5\u8bc6\u522b\u5176\u786c\u76d8\u9a71\u52a8\u5668\uff0c\u5373\u4f7f\u9a71\u52a8\u5668\u5df2\u6b63\u786e\u8fde\u63a5\u5230\u670d\u52a1\u5668\uff0c\u90a3\u53c8\u4f1a\u53d1\u751f\u4ec0\u4e48\u60c5\u51b5\\(^{[67]}\\)\uff1f</li> </ul> <p>\u6cd5\u5b9a\u4eba\u6570\u7b97\u6cd5\u4f9d\u8d56\u8282\u70b9\u6765\u8bb0\u4f4f\u5b83\u58f0\u79f0\u5b58\u50a8\u7684\u6570\u636e</p> <ul> <li>\u5982\u679c\u4e00\u4e2a\u8282\u70b9\u53ef\u80fd\u60a3\u6709\u5065\u5fd8\u75c7\uff0c\u5fd8\u8bb0\u4e86\u4ee5\u524d\u5b58\u50a8\u7684\u6570\u636e\uff0c\u8fd9\u4f1a\u6253\u7834\u6cd5\u5b9a\u6761\u4ef6\uff0c\u4ece\u800c\u7834\u574f\u7b97\u6cd5\u7684\u6b63\u786e\u6027\u3002</li> <li>\u4e5f\u8bb8\u9700\u8981\u4e00\u4e2a\u65b0\u7684\u7cfb\u7edf\u6a21\u578b\uff0c\u5728\u8fd9\u4e2a\u6a21\u578b\u4e2d\uff0c\u6211\u4eec\u5047\u8bbe\u7a33\u5b9a\u7684\u5b58\u50a8\u5927\u591a\u80fd\u5728\u5d29\u6e83\u540e\u5e78\u5b58\uff0c\u4f46\u6709\u65f6\u4e5f\u53ef\u80fd\u4f1a\u4e22\u5931\u3002\u4f46\u662f\u90a3\u4e2a\u6a21\u578b\u5c31\u53d8\u5f97\u66f4\u96be\u4ee5\u63a8\u7406\u4e86\u3002</li> </ul> <p>\u771f\u5b9e\u4e16\u754c\u7684\u5b9e\u73b0\uff0c\u4ecd\u7136\u4f1a\u5305\u62ec\u5904\u7406\u7b97\u6cd5 \u201c\u5047\u8bbe\u4e0a\u4e0d\u53ef\u80fd\u201d \u60c5\u51b5\u7684\u4ee3\u7801\uff0c\u5373\u4f7f\u4ee3\u7801\u53ef\u80fd\u5c31\u662f <code>printf(\"Sucks to be you\")</code> \u548c <code>exit(666)</code>\uff0c\u5b9e\u9645\u4e0a\u4e5f\u5c31\u662f\u7559\u7ed9\u8fd0\u7ef4\u6765\u64e6\u5c41\u80a1\\(^{[68]}\\)\u3002</p> <ul> <li>\u53ef\u4ee5\u8bf4\u662f\u8ba1\u7b97\u673a\u79d1\u5b66\u548c\u8f6f\u4ef6\u5de5\u7a0b\u95f4\u7684\u4e00\u4e2a\u5dee\u5f02</li> </ul> <p>\u8bc1\u660e\u7b97\u6cd5\u6b63\u786e\u5e76\u4e0d\u610f\u5473\u7740\u5b83\u5728\u771f\u5b9e\u7cfb\u7edf\u4e0a\u7684\u5b9e\u73b0\u5fc5\u7136\u603b\u662f\u6b63\u786e\u7684\u3002</p> <ul> <li>\u8fc8\u51fa\u4e86\u5f88\u597d\u7684\u7b2c\u4e00\u6b65\uff0c\u56e0\u4e3a\u7406\u8bba\u5206\u6790\u53ef\u4ee5\u53d1\u73b0\u7b97\u6cd5\u4e2d\u7684\u95ee\u9898\uff0c\u8fd9\u79cd\u95ee\u9898\u53ef\u80fd\u4f1a\u5728\u73b0\u5b9e\u7cfb\u7edf\u4e2d\u957f\u671f\u6f5c\u4f0f\uff0c\u76f4\u5230\u4f60\u7684\u5047\u8bbe\uff08\u4f8b\u5982\uff0c\u65f6\u5e8f\uff09\u56e0\u4e3a\u4e0d\u5bfb\u5e38\u7684\u60c5\u51b5\u88ab\u6253\u7834\u3002</li> <li>\u7406\u8bba\u5206\u6790\u4e0e\u7ecf\u9a8c\u6d4b\u8bd5\u540c\u6837\u91cd\u8981\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/8_trouble_in_distributed_system.html#_32","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>Jeff Hodges: \u201cNotes on Distributed Systems for Young Bloods,\u201d somethingsimilar.com, January 14, 2013.</li> <li>Frank McSherry, Michael Isard, and Derek G. Murray: \u201cScalability! But at What COST?,\u201d at 15th USENIX Workshop on Hot Topics in Operating Systems (HotOS), May 2015.</li> <li>Mark Cavage: Just No Getting Around It: You\u2019re Building a Distributed System](http://queue.acm.org/detail.cfm?id=2482856),\u201d ACM Queue, volume 11, number 4, pages 80-89, April 2013. doi:10.1145/2466486.2482856</li> <li>Jay Kreps: \u201cGetting Real About Distributed System Reliability,\u201d blog.empathybox.com, March 19, 2012.</li> <li>Sydney Padua: The Thrilling Adventures of Lovelace and Babbage: The (Mostly) True Story of the First Computer. Particular Books, April ISBN: 978-0-141-98151-2</li> <li>Coda Hale: \u201cYou Can\u2019t Sacrifice Partition Tolerance,\u201d codahale.com, October 7, 2010.</li> <li>Jeff Hodges: \u201cNotes on Distributed Systems for Young Bloods,\u201d somethingsimilar.com, January 14, 2013.</li> <li>Antonio Regalado: \u201cWho Coined 'Cloud Computing\u2019?,\u201d technologyreview.com, October 31, 2011.</li> <li>Luiz Andr\u00e9 Barroso, Jimmy Clidaras, and Urs H\u00f6lzle: \u201cThe Datacenter as a Computer: An Introduction to the Design of Warehouse-Scale Machines, Second Edition,\u201d Synthesis Lectures on Computer Architecture, volume 8, number 3, Morgan &amp; Claypool Publishers, July 2013.doi:10.2200/S00516ED2V01Y201306CAC024, ISBN: 978-1-627-05010-4</li> <li>David Fiala, Frank Mueller, Christian Engelmann, et al.: \u201cDetection and Correction of Silent Data Corruption for Large-Scale High-Performance Computing,\u201d at International Conference for High Performance Computing, Networking, Storage and Analysis (SC12), November 2012.</li> <li>Arjun Singh, Joon Ong, Amit Agarwal, et al.: \u201cJupiter Rising: A Decade of Clos Topologies and Centralized Control in Google\u2019s Datacenter Network,\u201d at Annual Conference of the ACM Special Interest Group on Data Communication (SIGCOMM), August 2015. doi:10.1145/2785956.2787508</li> <li>Glenn K. Lockwood: \u201cHadoop's Uncomfortable Fit in HPC,\u201d glennklockwood.blogspot.co.uk, May 16, 2014.</li> <li>John von Neumann: \u201cProbabilistic Logics and the Synthesis of Reliable Organisms from Unreliable Components,\u201d in Automata Studies (AM-34), edited by Claude E. Shannon and John McCarthy, Princeton University Press, 1956. ISBN: 978-0-691-07916-5</li> <li>Richard W. Hamming: The Art of Doing Science and Engineering. Taylor &amp; Francis, 1997. ISBN: 978-9-056-99500-3</li> <li>Claude E. Shannon: \u201cA Mathematical Theory of Communication,\u201d The Bell System Technical Journal, volume 27, number 3, pages 379\u2013423 and 623\u2013656, July 1948.</li> <li>Joshua B. Leners, Trinabh Gupta, Marcos K. Aguilera, and Michael Walfish: \u201cTaming Uncertainty in Distributed Systems with Help from the Network,\u201d at 10th European Conference on Computer Systems (EuroSys), April 2015. doi:10.1145/2741948.2741976</li> <li>Phillipa Gill, Navendu Jain, and Nachiappan Nagappan: \u201cUnderstanding Network Failures in Data Centers: Measurement, Analysis, and Implications,\u201d at ACM SIGCOMM Conference, August 2011. doi:10.1145/2018436.2018477</li> <li>Salvatore Sanfilippo: \u201cA Few Arguments About Redis Sentinel Properties and Fail Scenarios,\u201d antirez.com, October 21, 2014.</li> <li>Bert Hubert: \u201cThe Ultimate SO_LINGER Page, or: Why Is My TCP Not Reliable,\u201d blog.netherlabs.nl, January 18, 2009.</li> <li>Nicolas Liochon: \u201cCAP: If All You Have Is a Timeout, Everything Looks Like a Partition,\u201d blog.thislongrun.com, May 25, 2015.</li> <li>Jerome H. Saltzer, David P. Reed, and David D. Clark: \u201cEnd-To-End Arguments in System Design,\u201d ACM Transactions on Computer Systems, volume 2, number 4, pages 277\u2013288, November 1984. doi:10.1145/357401.357402</li> <li>Matthew P. Grosvenor, Malte Schwarzkopf, Ionel Gog, et al.: \u201cQueues Don\u2019t Matter When You Can JUMP Them!,\u201d at 12th USENIX Symposium on Networked Systems Design and Implementation (NSDI), May 2015.</li> <li>Guohui Wang and T. S. Eugene Ng: \u201cThe Impact of Virtualization on Network Performance of Amazon EC2 Data Center,\u201d at 29th IEEE International Conference on Computer Communications (INFOCOM), March 2010. doi:10.1109/INFCOM.2010.5461931</li> <li>Van Jacobson: \u201cCongestion Avoidance and Control,\u201d at ACM Symposium on Communications Architectures and Protocols (SIGCOMM), August 1988. doi:10.1145/52324.52356</li> <li>Brandon Philips: \u201cetcd: Distributed Locking and Service Discovery,\u201d at Strange Loop, September 2014.</li> <li>Steve Newman: \u201cA Systematic Look at EC2 I/O,\u201d blog.scalyr.com, October 16, 2012.</li> <li>Naohiro Hayashibara, Xavier D\u00e9fago, Rami Yared, and Takuya Katayama: \u201cThe \u03d5 Accrual Failure Detector,\u201d Japan Advanced Institute of Science and Technology, School of Information Science, Technical Report IS-RR-2004-010, May 2004.</li> <li>Srinivasan Keshav: An Engineering Approach to Computer Networking: ATM Networks, the Internet, and the Telephone Network. Addison-Wesley Professional, May 1997. ISBN: 978-0-201-63442-6</li> <li>Cisco, \u201cIntegrated Services Digital Network,\u201d docwiki.cisco.com.</li> <li>Othmar Kyas: ATM Networks. International Thomson Publishing, 1995. ISBN: 978-1-850-32128-6</li> <li>\u201cInfiniBand FAQ,\u201d Mellanox Technologies, December 22, 2014.</li> <li>Ulrich Windl, David Dalton, Marc Martinec, and Dale R. Worley: \u201cThe NTP FAQ and HOWTO,\u201d ntp.org, November 2006.</li> <li>John Graham-Cumming: \u201cHow and why the leap second affected Cloudflare DNS,\u201d blog.cloudflare.com, January 1, 2017.</li> <li>Steve Loughran: \u201cTime on Multi-Core, Multi-Socket Servers,\u201d steveloughran.blogspot.co.uk, September 17, 2015.</li> <li>James C. Corbett, Jeffrey Dean, Michael Epstein, et al.: \u201cSpanner: Google\u2019s Globally-Distributed Database,\u201d at 10th USENIX Symposium on Operating System Design and Implementation (OSDI), October 2012.</li> <li>Poul-Henning Kamp: \u201cThe One-Second War (What Time Will You Die?),\u201d ACM Queue, volume 9, number 4, pages 44\u201348, April 2011. doi:10.1145/1966989.1967009</li> <li>Nelson Minar: \u201cLeap Second Crashes Half the Internet,\u201d somebits.com, July 3, 2012.</li> <li>Luke Bigum: \u201cSolving MiFID II Clock Synchronisation With Minimum Spend (Part 1),\u201d lmax.com, November 27, 2015.</li> <li>Leslie Lamport: \u201cTime, Clocks, and the Ordering of Events in a Distributed System,\u201d Communications of the ACM, volume 21, number 7, pages 558\u2013565, July 1978. doi:10.1145/359545.359563</li> <li>Sandeep Kulkarni, Murat Demirbas, Deepak Madeppa, et al.: \u201cLogical Physical Clocks and Consistent Snapshots in Globally Distributed Databases,\u201d State University of New York at Buffalo, Computer Science and Engineering Technical Report 2014-04, May 2014.</li> <li>Justin Sheehy: \u201cThere Is No Now: Problems With Simultaneity in Distributed Systems,\u201d ACM Queue, volume 13, number 3, pages 36\u201341, March 2015. doi:10.1145/2733108</li> <li>Murat Demirbas: \u201cSpanner: Google's Globally-Distributed Database,\u201d muratbuffalo.blogspot.co.uk, July 4, 2013.</li> <li>Dahlia Malkhi and Jean-Philippe Martin: \u201cSpanner's Concurrency Control,\u201d ACM SIGACT News, volume 44, number 3, pages 73\u201377, September 2013. doi:10.1145/2527748.2527767</li> <li>Manuel Bravo, Nuno Diegues, Jingna Zeng, et al.: \u201cOn the Use of Clocks to Enforce Consistency in the Cloud,\u201d IEEE Data Engineering Bulletin, volume 38, number 1, pages 18\u201331, March 2015.</li> <li>Spencer Kimball: \u201cLiving Without Atomic Clocks,\u201d cockroachlabs.com, February 17, 2016.</li> <li>Cary G. Gray and David R. Cheriton:\u201cLeases: An Efficient Fault-Tolerant Mechanism for Distributed File Cache Consistency,\u201d at 12th ACM Symposium on Operating Systems Principles (SOSP), December 1989. doi:10.1145/74850.74870</li> <li>Martin Thompson: \u201cJava Garbage Collection Distilled,\u201d mechanical-sympathy.blogspot.co.uk, July 16, 2013.</li> <li>Mike Shaver: \u201cfsyncers and Curveballs,\u201d shaver.off.net, May 25, 2008.</li> <li>Zhenyun Zhuang and Cuong Tran: \u201cEliminating Large JVM GC Pauses Caused by Background IO Traffic,\u201d engineering.linkedin.com, February 10, 2016.</li> <li>David Terei and Amit Levy: \u201cBlade: A Data Center Garbage Collector,\u201d arXiv:1504.02578, April 13, 2015.</li> <li>Martin Maas, Tim Harris, Krste Asanovi\u0107, and John Kubiatowicz: \u201cTrash Day: Coordinating Garbage Collection in Distributed Systems,\u201d at 15th USENIX Workshop on Hot Topics in Operating Systems (HotOS), May 2015.</li> <li>\u201cPredictable Low Latency,\u201d Cinnober Financial Technology AB, cinnober.com, November 24, 2013.</li> <li>Martin Fowler: \u201cThe LMAX Architecture,\u201d martinfowler.com, July 12, 2011.</li> <li>Flavio P. Junqueira and Benjamin Reed: ZooKeeper: Distributed Process Coordination. O'Reilly Media, 2013. ISBN: 978-1-449-36130-3</li> <li>Caitie McCaffrey: \u201cClients Are Jerks: AKA How Halo 4 DoSed the Services at Launch &amp; How We Survived,\u201d caitiem.com, June 23, 2015.</li> <li>Leslie Lamport, Robert Shostak, and Marshall Pease: \u201cThe Byzantine Generals Problem,\u201d ACM Transactions on Programming Languages and Systems (TOPLAS), volume 4, number 3, pages 382\u2013401, July 1982. doi:10.1145/357172.357176</li> <li>John Rushby: \u201cBus Architectures for Safety-Critical Embedded Systems,\u201d at 1st International Workshop on Embedded Software (EMSOFT), October 2001.</li> <li>Jake Edge: \u201cELC: SpaceX Lessons Learned,\u201d lwn.net, March 6, 2013.</li> <li>James Mickens: \u201cThe Saddest Moment,\u201d USENIX ;login: logout, May 2013.</li> <li>Evan Gilman: \u201cThe Discovery of Apache ZooKeeper\u2019s Poison Packet,\u201d pagerduty.com, May 7, 2015.</li> <li>Jonathan Stone and Craig Partridge: \u201cWhen the CRC and TCP Checksum Disagree,\u201d at ACM Conference on Applications, Technologies, Architectures, and Protocols for Computer Communication (SIGCOMM), August 2000. doi:10.1145/347059.347561</li> <li>Evan Jones: \u201cHow Both TCP and Ethernet Checksums Fail,\u201d evanjones.ca, October 5, 2015.</li> <li>Cynthia Dwork, Nancy Lynch, and Larry Stockmeyer: \u201cConsensus in the Presence of Partial Synchrony,\u201d Journal of the ACM, volume 35, number 2, pages 288\u2013323, April 1988. doi:10.1145/42282.42283</li> <li>Peter Bailis and Ali Ghodsi: \u201cEventual Consistency Today: Limitations, Extensions, and Beyond,\u201d ACM Queue, volume 11, number 3, pages 55-63, March 2013. doi:10.1145/2460276.2462076</li> <li>Bowen Alpern and Fred B. Schneider: \u201cDefining Liveness,\u201d Information Processing Letters, volume 21, number 4, pages 181\u2013185, October 1985. doi:10.1016/0020-0190(85)90056-0</li> <li>Flavio P. Junqueira: \u201cDude, Where\u2019s My Metadata?,\u201d fpj.me, May 28, 2015.</li> <li>Scott Sanders: \u201cJanuary 28th Incident Report,\u201d github.com, February 3, 2016.</li> <li>Jay Kreps: \u201cA Few Notes on Kafka and Jepsen,\u201d blog.empathybox.com, September 25, 2013.</li> </ol>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html","title":"\u4e00\u81f4\u6027\u4e0e\u5171\u8bc6","text":"<p>\u672c\u7ae0\u5f15\u7528\u4e86\u5927\u91cf\u5173\u4e8e\u5206\u5e03\u5f0f\u7cfb\u7edf\u7406\u8bba\u7684\u7814\u7a76\u3002\u867d\u7136\u7406\u8bba\u8bba\u6587\u548c\u8bc1\u660e\u5e76\u4e0d\u603b\u662f\u5bb9\u6613\u7406\u89e3\uff0c\u6709\u65f6\u4e5f\u4f1a\u505a\u51fa\u4e0d\u5207\u5b9e\u9645\u7684\u5047\u8bbe\uff0c\u4f46\u5b83\u4eec\u5bf9\u4e8e\u6307\u5bfc\u8fd9\u4e00\u9886\u57df\u7684\u5b9e\u8df5\u6709\u7740\u6781\u5176\u91cd\u8981\u7684\u4ef7\u503c\uff1a\u5b83\u4eec\u5e2e\u52a9\u6211\u4eec\u63a8\u7406\u4ec0\u4e48\u53ef\u4ee5\u505a\uff0c\u4ec0\u4e48\u4e0d\u53ef\u4ee5\u505a\uff0c\u5e2e\u52a9\u6211\u4eec\u627e\u5230\u53cd\u76f4\u89c9\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u7f3a\u9677\u3002\u5982\u679c\u4f60\u6709\u65f6\u95f4\uff0c\u8fd9\u4e9b\u53c2\u8003\u8d44\u6599\u503c\u5f97\u63a2\u7d22\u3002</p> <p>\u5728\u672c\u7ae0\u4e2d\uff0c\u6211\u4eec\u5c06\u8ba8\u8bba\u6784\u5efa\u5bb9\u9519\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u7b97\u6cd5\u548c\u534f\u8bae\u7684\u4e00\u4e9b\u4f8b\u5b50\u3002\u5047\u8bbe \u7b2c\u516b\u7ae0 \u7684\u6240\u6709\u95ee\u9898\u90fd\u53ef\u80fd\u53d1\u751f\uff1a</p> <ul> <li>\u7f51\u7edc\u4e2d\u7684\u6570\u636e\u5305\u53ef\u80fd\u4f1a\u4e22\u5931\u3001\u91cd\u65b0\u6392\u5e8f\u3001\u91cd\u590d\u63a8\u9001\u6216\u4efb\u610f\u5ef6\u8fdf\uff1b</li> <li>\u65f6\u949f\u53ea\u662f\u5c3d\u5176\u6240\u80fd\u5730\u8fd1\u4f3c\uff1b</li> <li>\u8282\u70b9\u53ef\u4ee5\u6682\u505c\uff08\u4f8b\u5982\uff0c\u7531\u4e8e\u5783\u573e\u6536\u96c6\uff09\u6216\u968f\u65f6\u5d29\u6e83\u3002</li> </ul> <p>\u6784\u5efa\u5bb9\u9519\u7cfb\u7edf\u7684\u6700\u597d\u65b9\u6cd5\uff0c\u662f\u627e\u5230\u4e00\u4e9b\u5e26\u6709\u5b9e\u7528\u4fdd\u8bc1\u7684\u901a\u7528\u62bd\u8c61\uff0c\u5b9e\u73b0\u4e00\u6b21\uff0c\u7136\u540e\u8ba9\u5e94\u7528\u4f9d\u8d56\u8fd9\u4e9b\u4fdd\u8bc1\u3002</p> <ul> <li>\u7b2c\u4e03\u7ae0\u7684\u4e8b\u52a1\u5904\u7406\u662f\u4e2a\u5b9e\u4f8b\uff1a\u901a\u8fc7\u4f7f\u7528\u4e8b\u52a1\uff0c\u5e94\u7528\u53ef\u4ee5\u5047\u88c5\u6ca1\u6709\u5d29\u6e83\uff08\u539f\u5b50\u6027\uff09\uff0c\u6ca1\u6709\u5176\u4ed6\u4eba\u540c\u65f6\u8bbf\u95ee\u6570\u636e\u5e93\uff08\u9694\u79bb\uff09\uff0c\u5b58\u50a8\u8bbe\u5907\u662f\u5b8c\u5168\u53ef\u9760\u7684\uff08\u6301\u4e45\u6027\uff09\u3002</li> </ul> <p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u6700\u91cd\u8981\u7684\u62bd\u8c61\u4e4b\u4e00\u5c31\u662f \u5171\u8bc6\uff08consensus\uff09\uff1a\u5c31\u662f\u8ba9\u6240\u6709\u7684\u8282\u70b9\u5bf9\u67d0\u4ef6\u4e8b\u8fbe\u6210\u4e00\u81f4\u3002</p> <ul> <li>\u4e00\u65e6\u8fbe\u6210\u5171\u8bc6\uff0c\u5e94\u7528\u53ef\u4ee5\u5c06\u5176\u7528\u4e8e\u5404\u79cd\u76ee\u7684\u3002</li> <li>\u91cd\u8981\u7684\u662f\u53ea\u6709\u4e00\u4e2a\u9886\u5bfc\u8005\uff0c\u4e14\u6240\u6709\u7684\u8282\u70b9\u90fd\u8ba4\u540c\u5176\u9886\u5bfc\u3002</li> </ul> <p>\u5728\u672c\u7ae0\u4e2d\uff0c\u6211\u4eec\u4ece\u51e0\u4e2a\u4e0d\u540c\u7684\u89d2\u5ea6\u5ba1\u89c6\u4e86\u5173\u4e8e\u4e00\u81f4\u6027\u4e0e\u5171\u8bc6\u7684\u8bdd\u9898\u3002</p> <ul> <li>\u7ebf\u6027\u4e00\u81f4\u6027\uff1a\u4f7f\u591a\u526f\u672c\u6570\u636e\u770b\u8d77\u6765\u597d\u50cf\u53ea\u6709\u4e00\u4e2a\u526f\u672c\u4e00\u6837\uff0c\u5e76\u4f7f\u5176\u4e0a\u6240\u6709\u64cd\u4f5c\u90fd\u539f\u5b50\u6027\u5730\u751f\u6548\uff1b</li> <li>\u56e0\u679c\u6027\uff1a\u63d0\u4f9b\u8f83\u5f31\u7684\u4e00\u81f4\u6027\u6a21\u578b\uff1a\u67d0\u4e9b\u4e8b\u4ef6\u53ef\u4ee5\u662f \u5e76\u53d1 \u7684\uff0c\u7248\u672c\u5386\u53f2\u5c31\u50cf\u662f\u4e00\u6761\u4e0d\u65ad\u5206\u53c9\u4e0e\u5408\u5e76\u7684\u65f6\u95f4\u7ebf\u3002</li> </ul> <p>\u5373\u4f7f\u6355\u83b7\u5230\u56e0\u679c\u987a\u5e8f\uff08\u4f8b\u5982\u4f7f\u7528\u5170\u4f2f\u7279\u65f6\u95f4\u6233\uff09\uff0c\u6709\u4e9b\u4e8b\u60c5\u4e5f\u4e0d\u80fd\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u5b9e\u73b0\uff1a</p> <ul> <li>\u9700\u8981\u786e\u4fdd\u7528\u6237\u540d\u662f\u552f\u4e00\u7684\uff0c\u5e76\u62d2\u7edd\u540c\u4e00\u7528\u6237\u540d\u7684\u5176\u4ed6\u5e76\u53d1\u6ce8\u518c\u3002\u5982\u679c\u4e00\u4e2a\u8282\u70b9\u8981\u901a\u8fc7\u6ce8\u518c\uff0c\u5219\u9700\u8981\u77e5\u9053\u5176\u4ed6\u7684\u8282\u70b9\u6ca1\u6709\u5728\u5e76\u53d1\u62a2\u6ce8\u540c\u4e00\u7528\u6237\u540d\u7684\u8fc7\u7a0b\u4e2d\u3002</li> </ul> <p>\u8fd9\u4e2a\u95ee\u9898\u5f15\u9886\u6211\u4eec\u8d70\u5411 \u5171\u8bc6\u3002\u4e0e\u5171\u8bc6\u7b49\u4ef7\u7684\u95ee\u9898\u5305\u62ec\uff1a</p> <ul> <li>\u7ebf\u6027\u4e00\u81f4\u6027\u7684 CAS \u5bc4\u5b58\u5668\uff1a\u5bc4\u5b58\u5668\u9700\u8981\u57fa\u4e8e\u5f53\u524d\u503c\u662f\u5426\u7b49\u4e8e\u64cd\u4f5c\u7ed9\u51fa\u7684\u53c2\u6570\uff0c\u539f\u5b50\u5730 \u51b3\u5b9a \u662f\u5426\u8bbe\u7f6e\u65b0\u503c\u3002</li> <li>\u539f\u5b50\u4e8b\u52a1\u63d0\u4ea4\uff1a\u6570\u636e\u5e93\u5fc5\u987b \u51b3\u5b9a \u662f\u5426\u63d0\u4ea4\u6216\u4e2d\u6b62\u5206\u5e03\u5f0f\u4e8b\u52a1\u3002</li> <li>\u5168\u5e8f\u5e7f\u64ad\uff1a\u6d88\u606f\u7cfb\u7edf\u5fc5\u987b \u51b3\u5b9a \u4f20\u9012\u6d88\u606f\u7684\u987a\u5e8f\u3002</li> <li>\u9501\u548c\u79df\u7ea6\uff1a\u5f53\u51e0\u4e2a\u5ba2\u6237\u7aef\u4e89\u62a2\u9501\u6216\u79df\u7ea6\u65f6\uff0c\u7531\u9501\u6765 \u51b3\u5b9a \u54ea\u4e2a\u5ba2\u6237\u7aef\u6210\u529f\u83b7\u5f97\u9501\u3002</li> <li>\u6210\u5458 / \u534f\u8c03\u670d\u52a1\uff1a\u7ed9\u5b9a\u67d0\u79cd\u6545\u969c\u68c0\u6d4b\u5668\uff08\u4f8b\u5982\u8d85\u65f6\uff09\uff0c\u7cfb\u7edf\u5fc5\u987b \u51b3\u5b9a \u54ea\u4e9b\u8282\u70b9\u6d3b\u7740\uff0c\u54ea\u4e9b\u8282\u70b9\u56e0\u4e3a\u4f1a\u8bdd\u8d85\u65f6\u9700\u8981\u88ab\u5ba3\u544a\u6b7b\u4ea1\u3002</li> <li>\u552f\u4e00\u6027\u7ea6\u675f\uff1a\u5f53\u591a\u4e2a\u4e8b\u52a1\u540c\u65f6\u5c1d\u8bd5\u4f7f\u7528\u76f8\u540c\u7684\u952e\u521b\u5efa\u51b2\u7a81\u8bb0\u5f55\u65f6\uff0c\u7ea6\u675f\u5fc5\u987b \u51b3\u5b9a \u54ea\u4e00\u4e2a\u88ab\u5141\u8bb8\uff0c\u54ea\u4e9b\u56e0\u4e3a\u8fdd\u53cd\u7ea6\u675f\u800c\u5931\u8d25\u3002</li> </ul> <p>\u5355\u9886\u5bfc\u8005\u6570\u636e\u5e93\u4e2d\uff1a\u6240\u6709\u51b3\u7b56\u6743\u5f52\u5c5e\u4e8e\u9886\u5bfc\u8005\uff0c\u63d0\u4f9b\u7ebf\u6027\u4e00\u81f4\u7684\u64cd\u4f5c\uff0c\u552f\u4e00\u6027\u7ea6\u675f\uff0c\u5b8c\u5168\u6709\u5e8f\u7684\u590d\u5236\u65e5\u5fd7\uff0c\u4ee5\u53ca\u66f4\u591a\u3002</p> <p>\u4f46\u5982\u679c\u8be5\u9886\u5bfc\u8005\u5931\u6548\uff0c\u6216\u8005\u5982\u679c\u7f51\u7edc\u4e2d\u65ad\u5bfc\u81f4\u9886\u5bfc\u8005\u4e0d\u53ef\u8fbe\uff0c\u5219\u7cfb\u7edf\u5931\u6548\u3002\u5e94\u5bf9\u65b9\u6cd5\u6709\uff1a</p> <ul> <li>\u7b49\u5f85\u9886\u5bfc\u8005\u6062\u590d\uff0c\u63a5\u53d7\u7cfb\u7edf\u5c06\u5728\u8fd9\u6bb5\u65f6\u95f4\u963b\u585e\u7684\u4e8b\u5b9e\u3002\u8bb8\u591a XA/JTA \u4e8b\u52a1\u534f\u8c03\u8005\u9009\u62e9\u8fd9\u4e2a\u9009\u9879\u3002</li> <li>\u5e76\u4e0d\u80fd\u5b8c\u5168\u8fbe\u6210\u5171\u8bc6\uff0c\u56e0\u4e3a\u5b83\u4e0d\u80fd\u6ee1\u8db3 \u7ec8\u6b62 \u5c5e\u6027\u7684\u8981\u6c42\uff1a\u5982\u679c\u9886\u5bfc\u8005\u7eed\u547d\u5931\u8d25\uff0c\u7cfb\u7edf\u53ef\u80fd\u4f1a\u6c38\u4e45\u963b\u585e\u3002</li> <li>\u4eba\u5de5\u6545\u969c\u5207\u6362\uff0c\u8ba9\u4eba\u7c7b\u9009\u62e9\u4e00\u4e2a\u65b0\u7684\u9886\u5bfc\u8005\u8282\u70b9\uff0c\u5e76\u91cd\u65b0\u914d\u7f6e\u7cfb\u7edf\u4f7f\u4e4b\u751f\u6548\u3002</li> <li>\u4f7f\u7528\u5171\u8bc6\u7b97\u6cd5\u81ea\u52a8\u9009\u62e9\u4e00\u4e2a\u65b0\u7684\u9886\u5bfc\u8005\u3002\u4f7f\u7528\u6210\u719f\u7684\u7b97\u6cd5\u6765\u6b63\u786e\u5904\u7406\u6076\u52a3\u7684\u7f51\u7edc\u6761\u4ef6\u662f\u660e\u667a\u4e4b\u4e3e\u3010107\u3011\u3002</li> </ul> <p>\u5c3d\u7ba1\u5355\u9886\u5bfc\u8005\u6570\u636e\u5e93\u53ef\u4ee5\u63d0\u4f9b\u7ebf\u6027\u4e00\u81f4\u6027\uff0c\u4e14\u65e0\u9700\u5bf9\u6bcf\u4e2a\u5199\u64cd\u4f5c\u90fd\u6267\u884c\u5171\u8bc6\u7b97\u6cd5\uff0c\u4f46\u5171\u8bc6\u5bf9\u4e8e\u4fdd\u6301\u53ca\u53d8\u66f4\u9886\u5bfc\u6743\u4ecd\u7136\u662f\u5fc5\u987b\u7684\u3002</p> <ul> <li>\u4f7f\u7528\u5355\u4e2a\u9886\u5bfc\u8005\u4e0d\u8fc7\u662f \u201c\u7f13\u5175\u4e4b\u8ba1\u201d\uff1a\u5171\u8bc6\u4ecd\u7136\u662f\u9700\u8981\u7684\uff0c\u53ea\u662f\u5728\u53e6\u4e00\u4e2a\u5730\u65b9\uff0c\u800c\u4e14\u6ca1\u90a3\u4e48\u9891\u7e41\u3002</li> </ul> <p>\u50cf ZooKeeper \u8fd9\u6837\u7684\u5de5\u5177\u4e3a\u5e94\u7528\u63d0\u4f9b\u4e86 \u201c\u5916\u5305\u201d \u7684\u5171\u8bc6\u3001\u6545\u969c\u68c0\u6d4b\u548c\u6210\u5458\u670d\u52a1\u3002</p> <ul> <li>\u867d\u8bf4\u4f7f\u7528\u4e0d\u6613\uff0c\u4f46\u603b\u6bd4\u81ea\u5df1\u53bb\u5f00\u53d1\u4e00\u4e2a\u80fd\u7ecf\u53d7 \u7b2c\u516b\u7ae0 \u4e2d\u6240\u6709\u95ee\u9898\u8003\u9a8c\u7684\u7b97\u6cd5\u8981\u597d\u5f97\u591a\u3002</li> </ul> <p>\u4f46\u5e76\u4e0d\u662f\u6240\u6709\u7cfb\u7edf\u90fd\u9700\u8981\u5171\u8bc6\uff1a\u5982\u65e0\u9886\u5bfc\u8005\u590d\u5236\u548c\u591a\u9886\u5bfc\u8005\u590d\u5236\u7cfb\u7edf\u901a\u5e38\u4e0d\u4f1a\u4f7f\u7528\u5168\u5c40\u7684\u5171\u8bc6\u3002</p> <ul> <li>\u8fd9\u4e9b\u7cfb\u7edf\u4e2d\u51fa\u73b0\u7684\u51b2\u7a81\uff08\u8bf7\u53c2\u9605 \u201c\u5904\u7406\u5199\u5165\u51b2\u7a81\u201d\uff09\u6b63\u662f\u4e0d\u540c\u9886\u5bfc\u8005\u4e4b\u95f4\u6ca1\u6709\u8fbe\u6210\u5171\u8bc6\u7684\u7ed3\u679c\uff1b</li> <li>\u4e5f\u8bb8\u6211\u4eec\u53ea\u662f\u9700\u8981\u63a5\u53d7\u6ca1\u6709\u7ebf\u6027\u4e00\u81f4\u6027\u7684\u4e8b\u5b9e\uff0c\u5e76\u5b66\u4f1a\u66f4\u597d\u5730\u4e0e\u5177\u6709\u5206\u652f\u4e0e\u5408\u5e76\u7248\u672c\u5386\u53f2\u7684\u6570\u636e\u6253\u4ea4\u9053\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_2","title":"\u4e00\u81f4\u6027\u4fdd\u8bc1","text":"<p>\u5927\u591a\u6570\u590d\u5236\u7684\u6570\u636e\u5e93\u81f3\u5c11\u63d0\u4f9b\u4e86 \u6700\u7ec8\u4e00\u81f4\u6027\uff1a\u5982\u679c\u505c\u6b62\u5411\u6570\u636e\u5e93\u5199\u5165\u6570\u636e\u5e76\u7b49\u5f85\u4e00\u6bb5\u4e0d\u786e\u5b9a\u7684\u65f6\u95f4\uff0c\u90a3\u4e48\u6700\u7ec8\u6240\u6709\u7684\u8bfb\u53d6\u8bf7\u6c42\u90fd\u4f1a\u8fd4\u56de\u76f8\u540c\u7684\u503c\u30101\u3011\u3002</p> <ul> <li>\u5982\u679c\u4f60\u5728\u540c\u4e00\u65f6\u523b\u67e5\u770b\u4e24\u4e2a\u6570\u636e\u5e93\u8282\u70b9\uff0c\u5219\u53ef\u80fd\u5728\u4e24\u4e2a\u8282\u70b9\u4e0a\u770b\u5230\u4e0d\u540c\u7684\u6570\u636e\uff0c\u56e0\u4e3a\u5199\u8bf7\u6c42\u5728\u4e0d\u540c\u7684\u65f6\u95f4\u5230\u8fbe\u4e0d\u540c\u7684\u8282\u70b9\u3002</li> <li>\u5728\u6536\u655b\u4e4b\u524d\uff0c\u8bfb\u64cd\u4f5c\u53ef\u80fd\u4f1a\u8fd4\u56de\u4efb\u4f55\u4e1c\u897f\u6216\u4ec0\u4e48\u90fd\u6ca1\u6709\uff0c\u4e0d\u5177\u5907\u8bfb\u5df1\u4e4b\u5199\uff1b</li> </ul> <p>\u5177\u6709\u8f83\u5f3a\u4fdd\u8bc1\u7684\u7cfb\u7edf\u53ef\u80fd\u4f1a\u6bd4\u4fdd\u8bc1\u8f83\u5dee\u7684\u7cfb\u7edf\u5177\u6709\u66f4\u5dee\u7684\u6027\u80fd\u6216\u66f4\u5c11\u7684\u5bb9\u9519\u6027\u3002</p> <p>\u5206\u5e03\u5f0f\u4e00\u81f4\u6027\u6a21\u578b \u548c\u6211\u4eec\u4e4b\u524d\u8ba8\u8bba\u7684\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u7684\u5c42\u6b21\u7ed3\u6784\u6709\u4e00\u4e9b\u76f8\u4f3c\u4e4b\u5904\u30104,5\u3011</p> <ul> <li>\u4e8b\u52a1\u9694\u79bb\u4e3b\u8981\u662f\u4e3a\u4e86 \u907f\u514d\u7531\u4e8e\u540c\u65f6\u6267\u884c\u4e8b\u52a1\u800c\u5bfc\u81f4\u7684\u7ade\u4e89\u72b6\u6001</li> <li>\u5206\u5e03\u5f0f\u4e00\u81f4\u6027\u4e3b\u8981\u5173\u4e8e \u5728\u9762\u5bf9\u5ef6\u8fdf\u548c\u6545\u969c\u65f6\u5982\u4f55\u534f\u8c03\u526f\u672c\u95f4\u7684\u72b6\u6001\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_3","title":"\u7ebf\u6027\u4e00\u81f4\u6027","text":"<p>\u7ebf\u6027\u4e00\u81f4\u6027\uff08linearizability\uff09\u30106\u3011\uff08\u4e5f\u79f0\u4e3a \u539f\u5b50\u4e00\u81f4\u6027\uff08atomic consistency\uff09\u30107\u3011\uff0c\u5f3a\u4e00\u81f4\u6027\uff08strong consistency\uff09\uff0c\u7acb\u5373\u4e00\u81f4\u6027\uff08immediate consistency\uff09 \u6216 \u5916\u90e8\u4e00\u81f4\u6027\uff08external consistency \uff09\u30108\u3011\uff09\u3002</p> <ul> <li>\u57fa\u672c\u7684\u60f3\u6cd5\u662f\u8ba9\u4e00\u4e2a\u7cfb\u7edf\u770b\u8d77\u6765\u597d\u50cf\u53ea\u6709\u4e00\u4e2a\u6570\u636e\u526f\u672c\uff0c\u800c\u4e14\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u6027\u7684\u3002</li> </ul> <p>\u7ebf\u6027\u4e00\u81f4\u6027\u662f\u4e00\u4e2a \u65b0\u9c9c\u5ea6\u4fdd\u8bc1\uff08recency guarantee\uff09\uff0c\u4fdd\u969c\u8bfb\u5230\u7684\u503c\u662f\u6700\u8fd1\u7684\u3001\u6700\u65b0\u7684\uff0c\u800c\u4e0d\u662f\u6765\u81ea\u9648\u65e7\u7684\u7f13\u5b58\u6216\u526f\u672c\u3002</p> <p>\u4e0b\u56fe\u5c55\u793a\u4e86\u4e00\u4e2a\u5173\u4e8e\u4f53\u80b2\u7f51\u7ad9\u7684\u975e\u7ebf\u6027\u4e00\u81f4\u4f8b\u5b50\u30109\u3011\uff0cBob \u5728\u542c\u5230 Alice \u60ca\u547c\u6700\u540e\u5f97\u5206 \u4e4b\u540e\uff0c\u5237\u65b0\u7684\u8bf7\u6c42\u8def\u7531\u5230\u4e86\u4e00\u4e2a\u843d\u540e\u7684\u6570\u636e\u5e93\u526f\u672c\u4e0a\uff0c\u624b\u673a\u663e\u793a\u6bd4\u8d5b\u4ecd\u5728\u8fdb\u884c\u3002</p> <p></p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_4","title":"\u4ec0\u4e48\u4f7f\u5f97\u7cfb\u7edf\u7ebf\u6027\u4e00\u81f4\uff1f","text":"<p>\u4e0b\u56fe\u663e\u793a\u4e09\u4e2a\u5ba2\u6237\u7aef\u5728\u7ebf\u6027\u4e00\u81f4\u6570\u636e\u5e93\u4e2d\u540c\u65f6\u8bfb\u5199\u76f8\u540c\u7684\u952e <code>x</code>\uff0c\u79f0\u4e3a \u5bc4\u5b58\u5668\uff08register\uff09</p> <ul> <li><code>x</code> \u88ab\u79f0\u4e3a \u5bc4\u5b58\u5668\uff08register\uff09\uff0c\u4f8b\u5982\uff0c\u5b83\u53ef\u4ee5\u662f\u952e\u503c\u5b58\u50a8\u4e2d\u7684\u4e00\u4e2a \u952e\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u7684\u4e00 \u884c\uff0c\u6216\u6587\u6863\u6570\u636e\u5e93\u4e2d\u7684\u4e00\u4e2a \u6587\u6863</li> <li>\ud835\udc5f\ud835\udc52\ud835\udc4e\ud835\udc51(\ud835\udc65)\u21d2\ud835\udc63\u8868\u793a\u5ba2\u6237\u7aef\u8bf7\u6c42\u8bfb\u53d6\u5bc4\u5b58\u5668 <code>x</code> \u7684\u503c\uff0c\u6570\u636e\u5e93\u8fd4\u56de\u503c <code>v</code>\u3002</li> <li>\ud835\udc64\ud835\udc5f\ud835\udc56\ud835\udc61\ud835\udc52(\ud835\udc65,\ud835\udc63)\u21d2\ud835\udc5f \u8868\u793a\u5ba2\u6237\u7aef\u8bf7\u6c42\u5c06\u5bc4\u5b58\u5668 <code>x</code> \u8bbe\u7f6e\u4e3a\u503c <code>v</code> \uff0c\u6570\u636e\u5e93\u8fd4\u56de\u54cd\u5e94 <code>r</code> \uff08\u53ef\u80fd\u6b63\u786e\uff0c\u53ef\u80fd\u9519\u8bef\uff09\u3002</li> </ul> <p></p> \u5982\u679c\u8bfb\u53d6\u8bf7\u6c42\u4e0e\u5199\u5165\u8bf7\u6c42\u5e76\u53d1\uff0c\u5219\u53ef\u80fd\u4f1a\u8fd4\u56de\u65e7\u503c\u6216\u65b0\u503c <p>\u4e0d\u8db3\u4ee5\u5b8c\u5168\u63cf\u8ff0\u7ebf\u6027\u4e00\u81f4\u6027\uff1a\u5982\u679c\u4e0e\u5199\u5165\u540c\u65f6\u53d1\u751f\u7684\u8bfb\u53d6\u53ef\u4ee5\u8fd4\u56de\u65e7\u503c\u6216\u65b0\u503c\uff0c\u90a3\u4e48\u8bfb\u8005\u53ef\u80fd\u4f1a\u5728\u5199\u5165\u671f\u95f4\u770b\u5230\u6570\u503c\u5728\u65e7\u503c\u548c\u65b0\u503c\u4e4b\u95f4\u6765\u56de\u7ffb\u8f6c\u3002</p> <p>\u4e3a\u4e86\u4f7f\u7cfb\u7edf\u7ebf\u6027\u4e00\u81f4\uff0c\u6211\u4eec\u9700\u8981\u6dfb\u52a0\u53e6\u4e00\u4e2a\u7ea6\u675f\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <ul> <li>\u5ba2\u6237\u7aef A \u662f\u7b2c\u4e00\u4e2a\u8bfb\u53d6\u65b0\u7684\u503c <code>1</code> \u7684\u4f4d\u7f6e\u3002\u5728 A \u7684\u8bfb\u53d6\u8fd4\u56de\u4e4b\u540e\uff0cB \u5f00\u59cb\u65b0\u7684\u8bfb\u53d6\u3002\u7531\u4e8e B \u7684\u8bfb\u53d6\u4e25\u683c\u53d1\u751f\u4e8e A \u7684\u8bfb\u53d6\u4e4b\u540e\uff0c\u56e0\u6b64\u5373\u4f7f C \u7684\u5199\u5165\u4ecd\u5728\u8fdb\u884c\u4e2d\uff0c\u4e5f\u5fc5\u987b\u8fd4\u56de <code>1</code></li> </ul> <p></p> \u4efb\u4f55\u4e00\u4e2a\u8bfb\u53d6\u8fd4\u56de\u65b0\u503c\u540e\uff0c\u6240\u6709\u540e\u7eed\u8bfb\u53d6\uff08\u5728\u76f8\u540c\u6216\u5176\u4ed6\u5ba2\u6237\u7aef\u4e0a\uff09\u4e5f\u5fc5\u987b\u8fd4\u56de\u65b0\u503c\u3002 <p>\u4e0b\u56fe\u663e\u793a\u4e86\u4e00\u4e2a\u66f4\u590d\u6742\u7684\u4f8b\u5b50\u301010\u3011\uff0c\u589e\u52a0\u4e86\u7b2c\u4e09\u79cd\u7c7b\u578b\u7684\u64cd\u4f5c\uff1a</p> <ul> <li>\ud835\udc50\ud835\udc4e\ud835\udc60(\ud835\udc65,\ud835\udc63\ud835\udc5c\ud835\udc59\ud835\udc51,\ud835\udc63\ud835\udc5b\ud835\udc52\ud835\udc64)\u21d2\ud835\udc5f \u8868\u793a\u5ba2\u6237\u7aef\u8bf7\u6c42\u8fdb\u884c\u539f\u5b50\u6027\u7684 \u6bd4\u8f83\u4e0e\u8bbe\u7f6e\u64cd\u4f5c\u3002\u5982\u679c\u5bc4\u5b58\u5668 \ud835\udc65 \u7684\u5f53\u524d\u503c\u7b49\u4e8e \ud835\udc63\ud835\udc5c\ud835\udc59\ud835\udc51 \uff0c\u5219\u5e94\u8be5\u539f\u5b50\u5730\u8bbe\u7f6e\u4e3a \ud835\udc63\ud835\udc5b\ud835\udc52\ud835\udc64 \u3002\u5982\u679c \ud835\udc65 \u4e0d\u7b49\u4e8e \ud835\udc63\ud835\udc5c\ud835\udc59\ud835\udc51 \uff0c\u5219\u64cd\u4f5c\u5e94\u8be5\u4fdd\u6301\u5bc4\u5b58\u5668\u4e0d\u53d8\u5e76\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\u3002\\(r\\) \u662f\u6570\u636e\u5e93\u7684\u54cd\u5e94\uff08\u6b63\u786e\u6216\u9519\u8bef)</li> </ul> <p>\u6bcf\u4e2a\u64cd\u4f5c\u90fd\u5728\u6211\u4eec\u8ba4\u4e3a\u64cd\u4f5c\u88ab\u6267\u884c\u7684\u65f6\u5019\u7528\u7ad6\u7ebf\u6807\u51fa\uff08\u5728\u6bcf\u4e2a\u64cd\u4f5c\u7684\u6a2a\u67f1\u4e4b\u5185\uff09\u3002\u8fd9\u4e9b\u6807\u8bb0\u6309\u987a\u5e8f\u8fde\u5728\u4e00\u8d77\uff0c\u5176\u7ed3\u679c\u5fc5\u987b\u662f\u4e00\u4e2a\u6709\u6548\u7684\u5bc4\u5b58\u5668\u8bfb\u5199\u5e8f\u5217\uff08\u6bcf\u6b21\u8bfb\u53d6\u90fd\u5fc5\u987b\u8fd4\u56de\u6700\u8fd1\u4e00\u6b21\u5199\u5165\u8bbe\u7f6e\u7684\u503c\uff09\u3002</p> <ul> <li>\u7ebf\u6027\u4e00\u81f4\u6027\u7684\u8981\u6c42\u662f\uff0c\u64cd\u4f5c\u6807\u8bb0\u7684\u8fde\u7ebf\u603b\u662f\u6309\u65f6\u95f4\uff08\u4ece\u5de6\u5230\u53f3\uff09\u5411\u524d\u79fb\u52a8\uff0c\u800c\u4e0d\u662f\u5411\u540e\u79fb\u52a8\u3002</li> </ul> <p></p> \u56fe9-4\uff1a\u5c06\u8bfb\u53d6\u548c\u5199\u5165\u770b\u8d77\u6765\u5df2\u7ecf\u751f\u6548\u7684\u65f6\u95f4\u70b9\u8fdb\u884c\u53ef\u89c6\u5316\u3002\u5ba2\u6237\u7aef B \u7684\u6700\u540e\u4e00\u6b21\u8bfb\u53d6\u4e0d\u662f\u7ebf\u6027\u4e00\u81f4\u7684 <p>\u4e0a\u56fe\u6709\u8da3\u7684\u7ec6\u8282\u9700\u8981\u6307\u51fa\uff1a</p> <ul> <li>B \u7684 read(x)\uff0cD \u7684 write(x, 0), A \u7684 write(x, 1)\uff1aB \u7684\u8bfb\u53d6\u503c\u662f1\uff0c\u56e0\u4e3a\u6570\u636e\u5e93\u5148\u5904\u7406D\u7684\u5199\u5165\uff0c\u518d\u662fA\u7684\u5199\u5165\uff0c\u6700\u540e\u662fB\u7684\u8bfb\u53d6\u3002\u8fd9\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u987a\u5e8f\uff0c\u56e0\u4e3a\u4e09\u4e2a\u8bf7\u6c42\u662f\u5e76\u53d1\u7684\uff1b</li> <li>\u5728\u5ba2\u6237\u7aef A \u4ece\u6570\u636e\u5e93\u6536\u5230\u54cd\u5e94\u4e4b\u524d\uff0c\u5ba2\u6237\u7aef B \u7684\u8bfb\u53d6\u8fd4\u56de <code>1</code> \uff0c\u8868\u793a\u5199\u5165\u503c <code>1</code> \u5df2\u6210\u529f\u3002\u8fd9\u4e5f\u662f\u53ef\u4ee5\u7684\uff1a\u8fd9\u5e76\u4e0d\u610f\u5473\u7740\u5728\u5199\u4e4b\u524d\u8bfb\u5230\u4e86\u503c\uff0c\u8fd9\u53ea\u662f\u610f\u5473\u7740\u4ece\u6570\u636e\u5e93\u5230\u5ba2\u6237\u7aef A \u7684\u6b63\u786e\u54cd\u5e94\u5728\u7f51\u7edc\u4e2d\u7565\u6709\u5ef6\u8fdf\u3002</li> <li>\u6b64\u6a21\u578b\u4e0d\u5047\u8bbe\u6709\u4efb\u4f55\u4e8b\u52a1\u9694\u79bb\uff1a\u53e6\u4e00\u4e2a\u5ba2\u6237\u7aef\u53ef\u80fd\u968f\u65f6\u66f4\u6539\u503c\u3002\u53ef\u4ee5\u4f7f\u7528\u539f\u5b50 \u6bd4\u8f83\u5e76\u8bbe\u7f6e\uff08cas\uff09 \u64cd\u4f5c\u6765\u68c0\u67e5\u8be5\u503c\u662f\u5426\u672a\u88ab\u53e6\u4e00\u5ba2\u6237\u7aef\u540c\u65f6\u66f4\u6539\uff1aB \u548c C \u7684 cas \u8bf7\u6c42\u6210\u529f\uff0c\u4f46\u662f D \u7684 cas \u8bf7\u6c42\u5931\u8d25</li> <li>\u5ba2\u6237 B \u7684\u6700\u540e\u4e00\u6b21\u8bfb\u53d6\uff08\u9634\u5f71\u6761\u67f1\u4e2d\uff09\u4e0d\u662f\u7ebf\u6027\u4e00\u81f4\u7684\u3002\u8be5\u64cd\u4f5c\u4e0e C \u7684 cas \u5199\u64cd\u4f5c\u5e76\u53d1\uff08\u5b83\u5c06 <code>x</code> \u4ece <code>2</code> \u66f4\u65b0\u4e3a <code>4</code> \uff09\u3002\u5728 B \u7684\u8bfb\u53d6\u5f00\u59cb\u4e4b\u524d\uff0c\u5ba2\u6237\u7aef A \u5df2\u7ecf\u8bfb\u53d6\u4e86\u65b0\u7684\u503c <code>4</code> \uff0c\u56e0\u6b64\u4e0d\u5141\u8bb8 B \u8bfb\u53d6\u6bd4 A \u66f4\u65e7\u7684\u503c\u3002</li> </ul> <p>\u7ebf\u6027\u4e00\u81f4\u6027\u6b63\u5f0f\u7684\u5b9a\u4e49\u30106\u3011\u66f4\u51c6\u786e\u5730\u63cf\u8ff0\u4e86\u5b83\u3002\u901a\u8fc7\u8bb0\u5f55\u6240\u6709\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u65f6\u5e8f\uff0c\u5e76\u68c0\u67e5\u5b83\u4eec\u662f\u5426\u53ef\u4ee5\u6392\u5217\u6210\u6709\u6548\u7684\u987a\u5e8f\uff0c\u4ee5\u6d4b\u8bd5\u4e00\u4e2a\u7cfb\u7edf\u7684\u884c\u4e3a\u662f\u5426\u7ebf\u6027\u4e00\u81f4\u6027\u662f\u53ef\u80fd\u7684\uff08\u5c3d\u7ba1\u5728\u8ba1\u7b97\u4e0a\u662f\u6602\u8d35\u7684\uff09\u301011\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_5","title":"\u7ebf\u6027\u4e00\u81f4\u6027\u4e0e\u53ef\u4e32\u884c\u5316","text":"<p>\u7ebf\u6027\u4e00\u81f4\u6027 \u5bb9\u6613\u548c \u53ef\u4e32\u884c\u5316 \u76f8\u6df7\u6dc6\uff1a</p> <ul> <li>\u53ef\u4e32\u884c\u5316\uff08Serializability\uff09 \u662f\u4e8b\u52a1\u7684\u9694\u79bb\u5c5e\u6027\uff0c\u6bcf\u4e2a\u4e8b\u52a1\u53ef\u4ee5\u8bfb\u5199\u591a\u4e2a\u5bf9\u8c61\uff08\u884c\uff0c\u6587\u6863\uff0c\u8bb0\u5f55\uff09\u3002\u786e\u4fdd\u4e8b\u52a1\u7684\u884c\u4e3a\uff0c\u4e0e\u5b83\u4eec\u6309\u7167 \u67d0\u79cd \u987a\u5e8f\u4f9d\u6b21\u6267\u884c\u7684\u7ed3\u679c\u76f8\u540c\uff08\u6bcf\u4e2a\u4e8b\u52a1\u5728\u4e0b\u4e00\u4e2a\u4e8b\u52a1\u5f00\u59cb\u4e4b\u524d\u8fd0\u884c\u5b8c\u6210\uff09\u3002\u8fd9\u79cd\u6267\u884c\u987a\u5e8f\u53ef\u4ee5\u4e0e\u4e8b\u52a1\u5b9e\u9645\u6267\u884c\u7684\u987a\u5e8f\u4e0d\u540c\u3002\u301012\u3011</li> <li>\u7ebf\u6027\u4e00\u81f4\u6027\uff08Linearizability\uff09 \u662f\u8bfb\u53d6\u548c\u5199\u5165\u5bc4\u5b58\u5668\uff08\u5355\u4e2a\u5bf9\u8c61\uff09\u7684 \u65b0\u9c9c\u5ea6\u4fdd\u8bc1\u3002\u5b83\u4e0d\u4f1a\u5c06\u64cd\u4f5c\u7ec4\u5408\u4e3a\u4e8b\u52a1\uff0c\u56e0\u6b64\u5b83\u4e5f\u4e0d\u4f1a\u963b\u6b62\u5199\u5165\u504f\u5dee\u7b49\u95ee\u9898\uff08\u8bf7\u53c2\u9605 \u201c\u5199\u5165\u504f\u5dee\u548c\u5e7b\u8bfb\u201d\uff09\uff0c\u9664\u975e\u91c7\u53d6\u5176\u4ed6\u63aa\u65bd\uff08\u4f8b\u5982 \u7269\u5316\u51b2\u7a81\uff09\u3002</li> </ul> <p>\u4e00\u4e2a\u6570\u636e\u5e93\u53ef\u4ee5\u63d0\u4f9b\u53ef\u4e32\u884c\u5316\u548c\u7ebf\u6027\u4e00\u81f4\u6027\uff0c\u8fd9\u79cd\u7ec4\u5408\u88ab\u79f0\u4e3a\u4e25\u683c\u7684\u53ef\u4e32\u884c\u5316\u6216 \u5f3a\u7684\u5355\u526f\u672c\u53ef\u4e32\u884c\u5316\uff08strong-1SR\uff09\u30104,13\u3011\u3002\u57fa\u4e8e\u4e24\u9636\u6bb5\u9501\u5b9a\u7684\u53ef\u4e32\u884c\u5316\u5b9e\u73b0\uff08\u8bf7\u53c2\u9605 \u201c\u4e24\u9636\u6bb5\u9501\u5b9a\u201d \u4e00\u8282\uff09\u6216 \u771f\u7684\u4e32\u884c\u6267\u884c\uff08\u8bf7\u53c2\u9605 \u201c\u771f\u7684\u4e32\u884c\u6267\u884c\u201d\u4e00\u8282\uff09\u901a\u5e38\u662f\u7ebf\u6027\u4e00\u81f4\u6027\u7684\u3002</p> <p>\u53ef\u4e32\u884c\u5316\u7684\u5feb\u7167\u9694\u79bb\uff08\u8bf7\u53c2\u9605 \u201c\u53ef\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb\u201d\uff09\u4e0d\u662f\u7ebf\u6027\u4e00\u81f4\u6027\u7684\uff1a\u6309\u7167\u8bbe\u8ba1\uff0c\u5b83\u4ece\u4e00\u81f4\u7684\u5feb\u7167\u4e2d\u8fdb\u884c\u8bfb\u53d6\uff0c\u4ee5\u907f\u514d\u8bfb\u8005\u548c\u5199\u8005\u4e4b\u95f4\u7684\u9501\u7ade\u4e89\u3002\u4e00\u81f4\u6027\u5feb\u7167\u7684\u8981\u70b9\u5c31\u5728\u4e8e \u5b83\u4e0d\u4f1a\u5305\u62ec\u8be5\u5feb\u7167\u4e4b\u540e\u7684\u5199\u5165\uff0c\u56e0\u6b64\u4ece\u5feb\u7167\u8bfb\u53d6\u4e0d\u662f\u7ebf\u6027\u4e00\u81f4\u6027\u7684\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_6","title":"\u4f9d\u8d56\u7ebf\u6027\u4e00\u81f4\u6027","text":"<p>\u5bf9\u4e8e\u5c11\u6570\u9886\u57df\uff0c\u7ebf\u6027\u4e00\u81f4\u6027\u662f\u7cfb\u7edf\u6b63\u786e\u5de5\u4f5c\u7684\u4e00\u4e2a\u91cd\u8981\u6761\u4ef6\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_7","title":"\u9501\u5b9a\u548c\u9886\u5bfc\u9009\u4e3e","text":"<p>\u4e00\u79cd\u9009\u62e9\u9886\u5bfc\u8005\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u9501\uff1a\u6bcf\u4e2a\u8282\u70b9\u5728\u542f\u52a8\u65f6\u5c1d\u8bd5\u83b7\u53d6\u9501\uff0c\u6210\u529f\u8005\u6210\u4e3a\u9886\u5bfc\u8005\u301014\u3011\u3002\u4e0d\u7ba1\u8fd9\u4e2a\u9501\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff0c\u5b83\u5fc5\u987b\u662f\u7ebf\u6027\u4e00\u81f4\u7684\uff1a\u6240\u6709\u8282\u70b9\u5fc5\u987b\u5c31\u54ea\u4e2a\u8282\u70b9\u62e5\u6709\u9501\u8fbe\u6210\u4e00\u81f4\u3002</p> <ul> <li>Apache ZooKeeper \u301015\u3011\u548c etcd \u301016\u3011\u4e4b\u7c7b\u7684\u534f\u8c03\u670d\u52a1\u901a\u5e38\u7528\u4e8e\u5b9e\u73b0\u5206\u5e03\u5f0f\u9501\u548c\u9886\u5bfc\u8005\u9009\u4e3e\u3002</li> <li>\u4f7f\u7528\u4e00\u81f4\u6027\u7b97\u6cd5\uff0c\u4ee5\u5bb9\u9519\u7684\u65b9\u5f0f\u5b9e\u73b0\u7ebf\u6027\u4e00\u81f4\u7684\u64cd\u4f5c\uff08\u5728\u672c\u7ae0\u540e\u9762\u7684 \u201c\u5bb9\u9519\u5171\u8bc6\u201d \u4e2d\u8ba8\u8bba\u6b64\u7c7b\u7b97\u6cd5\uff09<sup>6</sup></li> <li>Apache Curator \u301017\u3011\u8fd9\u6837\u7684\u5e93\u5219\u901a\u8fc7\u5728 ZooKeeper \u4e4b\u4e0a\u63d0\u4f9b\u66f4\u9ad8\u7ea7\u522b\u7684\u914d\u65b9\u6765\u63d0\u4f9b\u5e2e\u52a9</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_8","title":"\u7ea6\u675f\u548c\u552f\u4e00\u6027\u4fdd\u8bc1","text":"<p>\u552f\u4e00\u6027\u7ea6\u675f\u5728\u6570\u636e\u5e93\u4e2d\u5f88\u5e38\u89c1\uff1a\u4f8b\u5982\uff0c\u7528\u6237\u540d\u6216\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u5fc5\u987b\u552f\u4e00\u6807\u8bc6\u4e00\u4e2a\u7528\u6237\uff1b\u4e0d\u80fd\u6709\u4e24\u4e2a\u5177\u6709\u76f8\u540c\u8def\u5f84\u548c\u6587\u4ef6\u540d\u7684\u6587\u4ef6\u3002</p> <ul> <li>\u5728\u5199\u5165\u6570\u636e\u65f6\u5f3a\u5236\u6267\u884c\u6b64\u7ea6\u675f\uff0c\u5219\u9700\u8981\u7ebf\u6027\u4e00\u81f4\u6027\u3002\u3002</li> </ul> <p>\u8fd9\u79cd\u60c5\u51b5\u5b9e\u9645\u4e0a\u7c7b\u4f3c\u4e8e\u4e00\u4e2a\u9501\uff0c\u4e0e\u539f\u5b50\u6027\u7684\u6bd4\u8f83\u4e0e\u8bbe\u7f6e\uff08CAS\uff09\u975e\u5e38\u76f8\u4f3c\u3002</p> <ul> <li>\u83b7\u5f97\u4e86\u6240\u9009\u7528\u6237\u540d\u7684 \u201c\u9501\u201d\uff1b</li> <li>\u5c06\u7528\u6237\u540d\u8d4b\u4e88\u58f0\u660e\u5b83\u7684\u7528\u6237\uff0c\u524d\u63d0\u662f\u7528\u6237\u540d\u5c1a\u672a\u88ab\u4f7f\u7528\u3002</li> </ul> <p>\u7ea6\u675f\u6761\u4ef6\u90fd\u8981\u6c42\u6240\u6709\u8282\u70b9\u90fd\u540c\u610f\u4e00\u4e2a\u6700\u65b0\u7684\u503c\uff0c\u5982\uff1a</p> <ul> <li>\u94f6\u884c\u8d26\u6237\u4f59\u989d\u6c38\u8fdc\u4e0d\u4f1a\u4e3a\u8d1f\u6570\uff0c\u6216\u8005\u4e24\u4e2a\u4eba\u4e0d\u4f1a\u90fd\u9884\u5b9a\u4e86\u822a\u73ed\u6216\u5267\u9662\u91cc\u540c\u4e00\u65f6\u95f4\u7684\u540c\u4e00\u4e2a\u4f4d\u7f6e</li> </ul> <p>\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u5bbd\u677e\u5730\u5904\u7406\u8fd9\u4e9b\u9650\u5236\u6709\u65f6\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u4e0d\u9700\u8981\u7ebf\u6027\u4e00\u81f4\u6027\uff0c\u6211\u4eec\u5c06\u5728 \u201c\u53ca\u65f6\u6027\u4e0e\u5b8c\u6574\u6027\u201d \u4e2d\u8ba8\u8bba\u8fd9\u79cd\u5bbd\u677e\u7684\u7ea6\u675f\u3002</p> <p>\u4e00\u4e2a\u786c\u6027\u7684\u552f\u4e00\u6027\u7ea6\u675f\uff08\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\u5e38\u89c1\u7684\u90a3\u79cd\uff09\u9700\u8981\u7ebf\u6027\u4e00\u81f4\u6027\u3002\u5176\u4ed6\u7c7b\u578b\u7684\u7ea6\u675f\uff0c\u5982\u5916\u952e\u6216\u5c5e\u6027\u7ea6\u675f\uff0c\u53ef\u4ee5\u4e0d\u9700\u8981\u7ebf\u6027\u4e00\u81f4\u6027\u301019\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_9","title":"\u8de8\u4fe1\u9053\u7684\u65f6\u5e8f\u4f9d\u8d56","text":"<p>\u7531\u4e8e\u7cfb\u7edf\u4e2d\u5b58\u5728\u989d\u5916\u7684\u4fe1\u9053\uff08Alice \u7684\u58f0\u97f3\u4f20\u5230\u4e86 Bob \u7684\u8033\u6735\u4e2d\uff09\uff0c\u7ebf\u6027\u4e00\u81f4\u6027\u7684\u8fdd\u80cc\u624d\u88ab\u6ce8\u610f\u5230\u3002</p> <ul> <li>\u56fe 9-1 \u4e2d\u5982\u679c Alice \u6ca1\u6709\u60ca\u547c\u5f97\u5206\uff0cBob \u5c31\u4e0d\u4f1a\u77e5\u9053\u4ed6\u7684\u67e5\u8be2\u7ed3\u679c\u662f\u9648\u65e7\u7684\u3002</li> </ul> <p>\u5176\u5b83\u7684\u7f51\u7ad9\u793a\u4f8b\uff0c\u67b6\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <ul> <li>\u7528\u6237\u53ef\u4ee5\u4e0a\u4f20\u7167\u7247\uff0c\u4e00\u4e2a\u540e\u53f0\u8fdb\u7a0b\u4f1a\u8c03\u6574\u7167\u7247\u5927\u5c0f\uff0c\u964d\u4f4e\u5206\u8fa8\u7387\u4ee5\u52a0\u5feb\u4e0b\u8f7d\u901f\u5ea6\uff08\u7f29\u7565\u56fe\uff09</li> </ul> <p></p> \u56fe 9-5 Web \u670d\u52a1\u5668\u548c\u56fe\u50cf\u7f29\u653e\u5668\u901a\u8fc7\u6587\u4ef6\u5b58\u50a8\u548c\u6d88\u606f\u961f\u5217\u8fdb\u884c\u901a\u4fe1\uff0c\u6253\u5f00\u7ade\u4e89\u6761\u4ef6\u7684\u53ef\u80fd\u6027\u3002 <p>\u5982\u679c\u6587\u4ef6\u5b58\u50a8\u670d\u52a1\u4e0d\u662f\u7ebf\u6027\u4e00\u81f4\u7684\uff0c\u5219\u5b58\u5728\u7ade\u4e89\u6761\u4ef6\u7684\u98ce\u9669\uff1a</p> <ul> <li>\u6d88\u606f\u961f\u5217\u53ef\u80fd\u6bd4\u5b58\u50a8\u670d\u52a1\u5185\u90e8\u7684\u590d\u5236\uff08replication\uff09\u66f4\u5feb\uff1a\u5f53\u7f29\u653e\u5668\u8bfb\u53d6\u56fe\u50cf\uff08\u6b65\u9aa4 5\uff09\u65f6\uff0c\u53ef\u80fd\u4f1a\u770b\u5230\u56fe\u50cf\u7684\u65e7\u7248\u672c\uff0c\u6216\u8005\u4ec0\u4e48\u90fd\u6ca1\u6709\u3002</li> <li>\u5982\u679c\u5b83\u5904\u7406\u7684\u662f\u65e7\u7248\u672c\u7684\u56fe\u50cf\uff0c\u5219\u6587\u4ef6\u5b58\u50a8\u4e2d\u7684\u5168\u5c3a\u5bf8\u56fe\u548c\u7f29\u7565\u56fe\u5c31\u4ea7\u751f\u4e86\u6c38\u4e45\u6027\u7684\u4e0d\u4e00\u81f4\u3002</li> </ul> <p>\u51fa\u73b0\u8fd9\u4e2a\u95ee\u9898\u662f\u56e0\u4e3a Web \u670d\u52a1\u5668\u548c\u7f29\u653e\u5668\u4e4b\u95f4\u5b58\u5728\u4e24\u4e2a\u4e0d\u540c\u7684\u4fe1\u9053\uff1a\u6587\u4ef6\u5b58\u50a8\u4e0e\u6d88\u606f\u961f\u5217\u3002</p> <ul> <li>\u7ebf\u6027\u4e00\u81f4\u6027\u5e76\u4e0d\u662f\u907f\u514d\u8fd9\u79cd\u7ade\u4e89\u6761\u4ef6\u7684\u552f\u4e00\u65b9\u6cd5\uff0c\u4f46\u5b83\u662f\u6700\u5bb9\u6613\u7406\u89e3\u7684\u3002</li> <li>\u5176\u4ed6\u65b9\u6cd5\u89e3\u51b3\uff1a\u4e0d\u540c\u7684\u6587\u4ef6\u540d/\u6587\u4ef6\u7684\u65f6\u95f4\uff1f\u6587\u4ef6\u5b58\u50a8\u540e\u518d\u5f02\u6b65\u8c03\u7528\u8fdb\u884c\u7f29\u653e\uff1f</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_10","title":"\u5b9e\u73b0\u7ebf\u6027\u4e00\u81f4\u7684\u7cfb\u7edf","text":"<p>\u7ebf\u6027\u4e00\u81f4\u6027\u672c\u8d28\u4e0a\u610f\u5473\u7740 \u201c\u8868\u73b0\u5f97\u597d\u50cf\u53ea\u6709\u4e00\u4e2a\u6570\u636e\u526f\u672c\uff0c\u800c\u4e14\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u7684\u201d</p> <p>\u4f7f\u7cfb\u7edf\u5bb9\u9519\u6700\u5e38\u7528\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u590d\u5236\uff0c\u6bd4\u8f83\u5404\u79cd\u590d\u5236\u65b9\u6cd5\u662f\u5426\u53ef\u4ee5\u6ee1\u8db3\u7ebf\u6027\u4e00\u81f4\u6027\uff1a</p> <ul> <li>\u5355\u4e3b\u590d\u5236\uff08\u53ef\u80fd\u7ebf\u6027\u4e00\u81f4\uff09</li> <li>\u5982\u679c\u4ece\u4e3b\u5e93\u6216\u540c\u6b65\u66f4\u65b0\u7684\u4ece\u5e93\u8bfb\u53d6\u6570\u636e\uff0c\u5b83\u4eec \u53ef\u80fd\uff08potential\uff09 \u662f\u7ebf\u6027\u4e00\u81f4\u6027\u7684<sup>7</sup></li> <li>\u5171\u8bc6\u7b97\u6cd5\uff08\u7ebf\u6027\u4e00\u81f4\uff09</li> <li>\u5171\u8bc6\u534f\u8bae\u5305\u542b\u9632\u6b62\u8111\u88c2\u548c\u9648\u65e7\u526f\u672c\u7684\u63aa\u65bd\uff0c\u5982Zookeeper \u301021\u3011\u548c etcd \u301022\u3011</li> <li>\u591a\u4e3b\u590d\u5236\uff08\u975e\u7ebf\u6027\u4e00\u81f4\uff09</li> <li>\u540c\u65f6\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u5904\u7406\u5199\u5165\uff0c\u5e76\u5c06\u5176\u5f02\u6b65\u590d\u5236\u5230\u5176\u4ed6\u8282\u70b9\u3002</li> <li>\u65e0\u4e3b\u590d\u5236\uff08\u4e5f\u8bb8\u4e0d\u662f\u7ebf\u6027\u4e00\u81f4\u7684\uff09</li> <li>\u901a\u8fc7\u8981\u6c42\u6cd5\u5b9a\u4eba\u6570\u8bfb\u5199\uff08 \ud835\udc64+\ud835\udc5f&gt;\ud835\udc5b \uff09\u53ef\u4ee5\u83b7\u5f97 \u201c\u5f3a\u4e00\u81f4\u6027\u201d\u3002\u8fd9\u53d6\u51b3\u4e8e\u6cd5\u5b9a\u4eba\u6570\u7684\u5177\u4f53\u914d\u7f6e\uff0c\u4ee5\u53ca\u5f3a\u4e00\u81f4\u6027\u5982\u4f55\u5b9a\u4e49\uff08\u901a\u5e38\u4e0d\u5b8c\u5168\u6b63\u786e\uff09\u3002</li> <li>\u57fa\u4e8e\u65e5\u5386\u65f6\u949f\u7684 \u201c\u6700\u540e\u5199\u5165\u80dc\u5229\u201d \u51b2\u7a81\u89e3\u51b3\u65b9\u6cd5\u51e0\u4e4e\u53ef\u4ee5\u786e\u5b9a\u662f\u975e\u7ebf\u6027\u4e00\u81f4\u7684\uff1a\u56e0\u4e3a\u65f6\u949f\u504f\u5dee\u4e0d\u80fd\u4fdd\u8bc1\u65f6\u949f\u7684\u65f6\u95f4\u6233\u4e0e\u5b9e\u9645\u4e8b\u4ef6\u987a\u5e8f\u4e00\u81f4\u3002</li> <li>\u5bbd\u677e\u7684\u6cd5\u5b9a\u4eba\u6570\u4e5f\u7834\u574f\u4e86\u7ebf\u6027\u4e00\u81f4\u7684\u53ef\u80fd\u6027\u3002</li> <li>\u5373\u4f7f\u4f7f\u7528\u4e25\u683c\u7684\u6cd5\u5b9a\u4eba\u6570\uff0c\u975e\u7ebf\u6027\u4e00\u81f4\u7684\u884c\u4e3a\u4e5f\u662f\u53ef\u80fd\u7684\uff0c\u5982\u4e0b\u8282\u6240\u793a\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_11","title":"\u7ebf\u6027\u4e00\u81f4\u6027\u548c\u6cd5\u5b9a\u4eba\u6570","text":"<p>\u5f53\u6211\u4eec\u6709\u53ef\u53d8\u7684\u7f51\u7edc\u5ef6\u8fdf\u65f6\uff0c\u5bf9\u4e8e\u4e25\u683c\u7684\u6cd5\u5b9a\u4eba\u6570\u8bfb\u5199\uff0c\u5c31\u53ef\u80fd\u5b58\u5728\u7ade\u4e89\u6761\u4ef6\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002</p> <ul> <li>\\(x\\) \u7684\u521d\u59cb\u503c\u4e3a 0\uff0c\u5199\u5165\u5ba2\u6237\u7aef\u901a\u8fc7\u5411\u6240\u6709\u4e09\u4e2a\u526f\u672c\uff08 \ud835\udc5b=3,\ud835\udc64=3 \uff09\u53d1\u9001\u5199\u5165\u5c06 \\(x\\) \u66f4\u65b0\u4e3a <code>1</code>\uff1b</li> <li>\u5ba2\u6237\u7aef A \u5e76\u53d1\u5730\u4ece\u4e24\u4e2a\u8282\u70b9\u7ec4\u6210\u7684\u6cd5\u5b9a\u4eba\u7fa4\uff08 \ud835\udc5f=2 \uff09\u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u5e76\u5728\u5176\u4e2d\u4e00\u4e2a\u8282\u70b9\u4e0a\u770b\u5230\u65b0\u503c <code>1</code>\uff1b</li> <li>\u5ba2\u6237\u7aef B \u4e5f\u5e76\u53d1\u5730\u4ece\u4e24\u4e2a\u4e0d\u540c\u7684\u8282\u70b9\u7ec4\u6210\u7684\u6cd5\u5b9a\u4eba\u6570\u4e2d\u8bfb\u53d6\uff0c\u5e76\u4ece\u4e24\u4e2a\u8282\u70b9\u4e2d\u53d6\u56de\u4e86\u65e7\u503c <code>0</code> \u3002</li> </ul> <p>\u6cd5\u5b9a\u4eba\u6570\u6761\u4ef6\u6ee1\u8db3\uff08 \ud835\udc64+\ud835\udc5f&gt;\ud835\udc5b \uff09\uff0c\u4f46\u662f\u8fd9\u4e2a\u6267\u884c\u662f\u975e\u7ebf\u6027\u4e00\u81f4\u7684\uff1aB \u7684\u8bf7\u6c42\u5728 A \u7684\u8bf7\u6c42\u5b8c\u6210\u540e\u5f00\u59cb\uff0c\u4f46\u662f B \u8fd4\u56de\u65e7\u503c\uff0c\u800c A \u8fd4\u56de\u65b0\u503c\u3002</p> <p></p> \u56fe 9-6 \u975e\u7ebf\u6027\u4e00\u81f4\u7684\u6267\u884c\uff0c\u5c3d\u7ba1\u4f7f\u7528\u4e86\u4e25\u683c\u7684\u6cd5\u5b9a\u4eba\u6570 <p>\u901a\u8fc7\u727a\u7272\u6027\u80fd\uff0c\u53ef\u4ee5\u4f7f Dynamo \u98ce\u683c\u7684\u6cd5\u5b9a\u4eba\u6570\u7ebf\u6027\u5316\uff1a</p> <ul> <li>\u8bfb\u53d6\u8005\u5fc5\u987b\u5728\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u5e94\u7528\u4e4b\u524d\uff0c\u540c\u6b65\u6267\u884c\u8bfb\u4fee\u590d\u3002\u5e76\u4e14\u5199\u5165\u8005\u5fc5\u987b\u5728\u53d1\u9001\u5199\u5165\u4e4b\u524d\uff0c\u8bfb\u53d6\u6cd5\u5b9a\u6570\u91cf\u8282\u70b9\u7684\u6700\u65b0\u72b6\u6001\u301024,25\u3011\u3002</li> <li>\u53ea\u80fd\u5b9e\u73b0\u7ebf\u6027\u4e00\u81f4\u7684\u8bfb\u5199\uff1b\u4e0d\u80fd\u5b9e\u73b0\u7ebf\u6027\u4e00\u81f4\u7684\u6bd4\u8f83\u548c\u8bbe\u7f6e\uff08CAS\uff09\u64cd\u4f5c\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u4e00\u4e2a\u5171\u8bc6\u7b97\u6cd5\u301028\u3011\u3002</li> </ul> <p>\u6700\u5b89\u5168\u7684\u505a\u6cd5\u662f\uff1a\u5047\u8bbe\u91c7\u7528 Dynamo \u98ce\u683c\u65e0\u4e3b\u590d\u5236\u7684\u7cfb\u7edf\u4e0d\u80fd\u63d0\u4f9b\u7ebf\u6027\u4e00\u81f4\u6027\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_12","title":"\u7ebf\u6027\u4e00\u81f4\u6027\u7684\u4ee3\u4ef7","text":"<p>\u5bf9\u591a\u6570\u636e\u4e2d\u5fc3\u7684\u590d\u5236\u800c\u8a00\uff0c\u591a\u4e3b\u590d\u5236\u901a\u5e38\u662f\u7406\u60f3\u7684\u9009\u62e9\u3002\u5982\u679c\u4e24\u4e2a\u6570\u636e\u4e2d\u5fc3\u4e4b\u95f4\u53d1\u751f\u7f51\u7edc\u4e2d\u65ad\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f</p> <p></p> \u56fe 9-7 \u7f51\u7edc\u4e2d\u65ad\u8feb\u4f7f\u5728\u7ebf\u6027\u4e00\u81f4\u6027\u548c\u53ef\u7528\u6027\u4e4b\u95f4\u505a\u51fa\u9009\u62e9\u3002"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#cap","title":"CAP\u5b9a\u7406","text":"<p>\u4e00\u81f4\u6027\uff0c\u53ef\u7528\u6027\u548c\u5206\u533a\u5bb9\u9519\u6027\uff1a\u4e09\u8005\u53ea\u80fd\u62e9\u5176\u4e8c\u3002\u4e0d\u5e78\u7684\u662f\u8fd9\u79cd\u8bf4\u6cd5\u5f88\u6709\u8bef\u5bfc\u6027\u301032\u3011\uff0c\u56e0\u4e3a\u7f51\u7edc\u5206\u533a\u662f\u4e00\u79cd\u6545\u969c\u7c7b\u578b\uff0c\u6240\u4ee5\u5b83\u5e76\u4e0d\u662f\u4e00\u4e2a\u9009\u9879\uff1a\u4e0d\u7ba1\u4f60\u559c\u4e0d\u559c\u6b22\u5b83\u90fd\u4f1a\u53d1\u751f\u301038\u3011\u3002</p> <p>CAP \u5b9a\u7406\u301029,30,31,32\u3011\u7531 Eric Brewer \u4e8e 2000 \u5e74\u547d\u540d\uff0c\u5c3d\u7ba1 70 \u5e74\u4ee3\u7684\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u8bbe\u8ba1\u8005\u65e9\u5c31\u77e5\u9053\u4e86\u8fd9\u79cd\u6743\u8861\u301033,34,35,36\u3011\u3002</p> <p>CAP \u66f4\u597d\u7684\u8868\u8ff0\u6210\uff1a\u5728\u5206\u533a\u65f6\u8981\u4e48\u9009\u62e9\u4e00\u81f4\uff0c\u8981\u4e48\u9009\u62e9\u53ef\u7528\u301039\u3011\u3002</p> <ul> <li>\u8bb8\u591a\u6240\u8c13\u7684 \u201c\u9ad8\u53ef\u7528\u201d\uff08\u5bb9\u9519\uff09\u7cfb\u7edf\u5b9e\u9645\u4e0a\u4e0d\u7b26\u5408 CAP \u5bf9\u53ef\u7528\u6027\u7684\u7279\u6b8a\u5b9a\u4e49\u3002</li> <li>\u56f4\u7ed5\u7740 CAP \u6709\u5f88\u591a\u8bef\u89e3\u548c\u56f0\u60d1\uff0c\u5e76\u4e0d\u80fd\u5e2e\u52a9\u6211\u4eec\u66f4\u597d\u5730\u7406\u89e3\u7cfb\u7edf\uff0c\u6240\u4ee5\u6700\u597d\u907f\u514d\u4f7f\u7528 CAP\u3002</li> </ul> <p>CAP \u5b9a\u7406\u7684\u6b63\u5f0f\u5b9a\u4e49\u4ec5\u9650\u4e8e\u5f88\u72ed\u9698\u7684\u8303\u56f4\u301030\u3011\uff0c\u5b83\u53ea\u8003\u8651\u4e86\u4e00\u4e2a\u4e00\u81f4\u6027\u6a21\u578b\uff08\u5373\u7ebf\u6027\u4e00\u81f4\u6027\uff09\u548c\u4e00\u79cd\u6545\u969c\uff08\u7f51\u7edc\u5206\u533a 6\uff0c\u6216\u6d3b\u8dc3\u4f46\u5f7c\u6b64\u65ad\u5f00\u7684\u8282\u70b9\uff09</p> <ul> <li>\u5c3d\u7ba1 CAP \u5728\u5386\u53f2\u4e0a\u6709\u4e00\u4e9b\u5f71\u54cd\u529b\uff0c\u4f46\u5bf9\u4e8e\u8bbe\u8ba1\u7cfb\u7edf\u800c\u8a00\u5e76\u6ca1\u6709\u5b9e\u9645\u4ef7\u503c\u30109,40\u3011\u3002</li> </ul> <p>\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u6709\u66f4\u591a\u6709\u8da3\u7684 \u201c\u4e0d\u53ef\u80fd\u201d \u7684\u7ed3\u679c\u301041\u3011\uff0c\u4e14 CAP \u5b9a\u7406\u73b0\u5728\u5df2\u7ecf\u88ab\u66f4\u7cbe\u786e\u7684\u7ed3\u679c\u53d6\u4ee3\u30102,42\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_13","title":"\u7ebf\u6027\u4e00\u81f4\u6027\u548c\u7f51\u7edc\u5ef6\u8fdf","text":"<p>\u5b9e\u9645\u4e0a\uff0c\u7ebf\u6027\u4e00\u81f4\u7684\u7cfb\u7edf\u60ca\u4eba\u7684\u5c11\u3002\u73b0\u4ee3\u591a\u6838 CPU \u4e0a\u7684\u5185\u5b58\u751a\u81f3\u90fd\u4e0d\u662f\u7ebf\u6027\u4e00\u81f4\u7684\u301043\u3011\uff1a</p> <ul> <li> <p>\u5982\u679c\u4e00\u4e2a CPU \u6838\u4e0a\u8fd0\u884c\u7684\u7ebf\u7a0b\u5199\u5165\u67d0\u4e2a\u5185\u5b58\u5730\u5740\uff0c\u800c\u53e6\u4e00\u4e2a CPU \u6838\u4e0a\u8fd0\u884c\u7684\u7ebf\u7a0b\u4e0d\u4e45\u4e4b\u540e\u8bfb\u53d6\u76f8\u540c\u7684\u5730\u5740\uff0c\u5e76\u6ca1\u6709\u4fdd\u8bc1\u4e00\u5b9a\u80fd\u8bfb\u5230\u7b2c\u4e00\u4e2a\u7ebf\u7a0b\u5199\u5165\u7684\u503c\uff08\u9664\u975e\u4f7f\u7528\u4e86 \u5185\u5b58\u5c4f\u969c\uff08memory barrier\uff09 \u6216 \u56f4\u680f\uff08fence\uff09\u301044\u3011\uff09\u3002</p> </li> <li> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5185\u5b58\u8bbf\u95ee\u9996\u5148\u8d70\u7f13\u5b58\uff0c\u4efb\u4f55\u53d8\u66f4\u4f1a\u5f02\u6b65\u5199\u5165\u4e3b\u5b58\u3002\u56e0\u4e3a\u7f13\u5b58\u8bbf\u95ee\u6bd4\u4e3b\u5b58\u8981\u5feb\u5f97\u591a\u301045\u3011\u3002</p> </li> <li>\u727a\u7272\u7ebf\u6027\u4e00\u81f4\u6027\u7684\u539f\u56e0\u662f \u6027\u80fd\uff08performance\uff09\uff0c\u800c\u4e0d\u662f\u5bb9\u9519\u3002\u4e0d\u6307\u671b\u4e00\u4e2a CPU \u6838\u80fd\u5728\u8131\u79bb\u8ba1\u7b97\u673a\u5176\u4ed6\u90e8\u5206\u7684\u6761\u4ef6\u4e0b\u7ee7\u7eed\u6b63\u5e38\u5de5\u4f5c\u3002</li> </ul> <p>\u8bb8\u591a\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u4e5f\u662f\u5982\u6b64\uff1a\u5b83\u4eec\u662f \u4e3a\u4e86\u63d0\u9ad8\u6027\u80fd \u800c\u9009\u62e9\u4e86\u727a\u7272\u7ebf\u6027\u4e00\u81f4\u6027\uff0c\u800c\u4e0d\u662f\u4e3a\u4e86\u5bb9\u9519\u301046\u3011\u3002</p> <p>Attiya \u548c Welch \u301047\u3011\u8bc1\u660e\uff0c\u5982\u679c\u4f60\u60f3\u8981\u7ebf\u6027\u4e00\u81f4\u6027\uff0c\u8bfb\u5199\u8bf7\u6c42\u7684\u54cd\u5e94\u65f6\u95f4\u81f3\u5c11\u4e0e\u7f51\u7edc\u5ef6\u8fdf\u7684\u4e0d\u786e\u5b9a\u6027\u6210\u6b63\u6bd4\u3002</p> <ul> <li>\u66f4\u5feb\u5730\u7ebf\u6027\u4e00\u81f4\u7b97\u6cd5\u4e0d\u5b58\u5728\uff0c\u4f46\u66f4\u5f31\u7684\u4e00\u81f4\u6027\u6a21\u578b\u53ef\u4ee5\u5feb\u5f97\u591a\uff0c\u6240\u4ee5\u5bf9\u5ef6\u8fdf\u654f\u611f\u7684\u7cfb\u7edf\u800c\u8a00\uff0c\u8fd9\u7c7b\u6743\u8861\u975e\u5e38\u91cd\u8981\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_14","title":"\u987a\u5e8f\u4fdd\u8bc1","text":"<p>\u987a\u5e8f\uff08ordering\uff09 \u8fd9\u4e00\u4e3b\u9898\u5728\u672c\u4e66\u4e2d\u53cd\u590d\u51fa\u73b0\uff0c\u8fd9\u8868\u660e\u5b83\u53ef\u80fd\u662f\u4e00\u4e2a\u91cd\u8981\u7684\u57fa\u7840\u6027\u6982\u5ff5\u3002</p> <ul> <li>\u7b2c\u4e94\u7ae0\uff08\u590d\u5236\uff09\u9886\u5bfc\u8005\u5728\u5355\u4e3b\u590d\u5236\u4e2d\u7684\u4e3b\u8981\u76ee\u7684\u5c31\u662f\uff0c\u5728\u590d\u5236\u65e5\u5fd7\u4e2d\u786e\u5b9a\u5199\u5165\u987a\u5e8f\uff08order of write\uff09\uff08\u4ece\u5e93\u5e94\u7528\u8fd9\u4e9b\u5199\u5165\u7684\u987a\u5e8f\uff09\u3002</li> <li>\u7b2c\u4e03\u7ae0\uff08\u4e8b\u52a1\uff09\u53ef\u4e32\u884c\u5316\uff0c\u662f\u5173\u4e8e\u4e8b\u52a1\u8868\u73b0\u7684\u50cf\u6309 \u67d0\u79cd\u5148\u540e\u987a\u5e8f\uff08some sequential order\uff09 \u6267\u884c\u7684\u4fdd\u8bc1\u3002</li> <li>\u7b2c\u516b\u7ae0\uff08\u5206\u5e03\u5f0f\u7cfb\u7edf\uff09\u4f7f\u7528\u65f6\u95f4\u6233\u548c\u65f6\u949f\u662f\u53e6\u4e00\u79cd\u5c06\u987a\u5e8f\u5f15\u5165\u65e0\u5e8f\u4e16\u754c\u7684\u5c1d\u8bd5\uff0c\u4f8b\u5982\u786e\u5b9a\u4e24\u4e2a\u5199\u5165\u64cd\u4f5c\u54ea\u4e00\u4e2a\u66f4\u665a\u53d1\u751f\u3002</li> </ul> <p>\u4e8b\u5b9e\u8bc1\u660e\uff0c\u987a\u5e8f\u3001\u7ebf\u6027\u4e00\u81f4\u6027\u548c\u5171\u8bc6\u4e4b\u95f4\u6709\u7740\u6df1\u523b\u7684\u8054\u7cfb\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_15","title":"\u987a\u5e8f\u4e0e\u56e0\u679c\u5173\u7cfb","text":"<p>\u987a\u5e8f\u6709\u52a9\u4e8e\u4fdd\u6301 \u56e0\u679c\u5173\u7cfb\uff08causality\uff09\u3002</p> <ul> <li>\u201c\u4e00\u81f4\u524d\u7f00\u8bfb\u201d\uff1a\u5148\u6709\u95ee\u9898\u518d\u6709\u7b54\u6848\uff1b</li> <li>\u5728 \u201c\u68c0\u6d4b\u5e76\u53d1\u5199\u5165\u201d \uff1a\u6709\u4e24\u4e2a\u64cd\u4f5c A \u548c B\uff0c\u5219\u5b58\u5728\u4e09\u79cd\u53ef\u80fd\u6027\uff1aA \u53d1\u751f\u5728 B \u4e4b\u524d\uff0c\u6216 B \u53d1\u751f\u5728 A \u4e4b\u524d\uff0c\u6216\u8005 A \u548c B\u5e76\u53d1\u3002\u6b64\u524d\u53d1\u751f\uff08happened before\uff09 \u5173\u7cfb\u662f\u56e0\u679c\u5173\u7cfb\u7684\u53e6\u4e00\u79cd\u8868\u8ff0\u3002</li> <li>\u5feb\u7167\u9694\u79bb\u63d0\u4f9b\u4e86\u56e0\u679c\u4e00\u81f4\u6027\uff0c\u8bfb\u504f\u5dee\uff08read skew\uff09 \u610f\u5473\u7740\u8bfb\u53d6\u7684\u6570\u636e\u5904\u4e8e\u8fdd\u53cd\u56e0\u679c\u5173\u7cfb\u7684\u72b6\u6001\uff08\u4e0d\u53ef\u91cd\u590d\u8bfb\uff0c\u5982 \u56fe 7-6 \u6240\u793a\uff09\u3002</li> <li>\u4e8b\u52a1\u4e4b\u95f4 \u5199\u504f\u5dee\uff08write skew\uff09 \u7684\u4f8b\u5b50\uff08 \u56fe 7-8 \uff09\u4e5f\u8bf4\u660e\u4e86\u56e0\u679c\u4f9d\u8d56\u3002</li> </ul> <p>\u56e0\u679c\u5173\u7cfb\u5bf9\u4e8b\u4ef6\u65bd\u52a0\u4e86\u4e00\u79cd \u987a\u5e8f\uff1a\u56e0\u5728\u679c\u4e4b\u524d\uff1b\u6d88\u606f\u53d1\u9001\u5728\u6d88\u606f\u6536\u53d6\u4e4b\u524d\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_16","title":"\u56e0\u679c\u987a\u5e8f\u4e0d\u662f\u5168\u5e8f\u7684","text":"<p>\u5168\u5e8f\uff08total order\uff09 \u5141\u8bb8\u4efb\u610f\u4e24\u4e2a\u5143\u7d20\u8fdb\u884c\u6bd4\u8f83\u3002</p> <p>\u504f\u5e8f\u7684\uff08partially ordered\uff09 \uff1a\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u8bf4\u4e00\u4e2a\u96c6\u5408\u5927\u4e8e\u53e6\u4e00\u4e2a\uff08\u5982\u679c\u4e00\u4e2a\u96c6\u5408\u5305\u542b\u53e6\u4e00\u4e2a\u96c6\u5408\u7684\u6240\u6709\u5143\u7d20\uff09\uff0c\u4f46\u5728\u5176\u4ed6\u60c5\u51b5\u4e0b\u5b83\u4eec\u662f\u65e0\u6cd5\u6bd4\u8f83<sup>1</sup>\u3002</p> <p>\u5168\u5e8f\u548c\u504f\u5e8f\u4e4b\u95f4\u7684\u5dee\u5f02\u53cd\u6620\u5728\u4e0d\u540c\u7684\u6570\u636e\u5e93\u4e00\u81f4\u6027\u6a21\u578b\u4e2d\uff1a</p> <ul> <li>\u7ebf\u6027\u4e00\u81f4\u6027\uff1a\u64cd\u4f5c\u662f\u5168\u5e8f\u7684\uff1a\u5982\u679c\u7cfb\u7edf\u8868\u73b0\u7684\u5c31\u597d\u50cf\u53ea\u6709\u4e00\u4e2a\u6570\u636e\u526f\u672c\uff0c\u5e76\u4e14\u6240\u6709\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u6027\u3002\u5168\u5e8f\u5728 \u56fe 9-4 \u4e2d\u4ee5\u65f6\u95f4\u7ebf\u8868\u793a\u3002</li> <li>\u56e0\u679c\u6027\uff1a\u5982\u679c\u4e24\u4e2a\u64cd\u4f5c\u90fd\u6ca1\u6709\u5728\u5f7c\u6b64 \u4e4b\u524d\u53d1\u751f\uff0c\u90a3\u4e48\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u662f\u5e76\u53d1\u7684\u3002</li> </ul> <p>\u5728\u7ebf\u6027\u4e00\u81f4\u7684\u6570\u636e\u5b58\u50a8\u4e2d\u662f\u4e0d\u5b58\u5728\u5e76\u53d1\u64cd\u4f5c\u7684\uff1a\u5fc5\u987b\u6709\u4e14\u4ec5\u6709\u4e00\u6761\u65f6\u95f4\u7ebf\uff0c\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u5728\u8fd9\u6761\u65f6\u95f4\u7ebf\u4e0a\uff0c\u6784\u6210\u4e00\u4e2a\u5168\u5e8f\u5173\u7cfb\u3002</p> <ul> <li>\u53ef\u80fd\u6709\u51e0\u4e2a\u8bf7\u6c42\u5728\u7b49\u5f85\u5904\u7406\uff0c\u4f46\u662f\u6570\u636e\u5b58\u50a8\u786e\u4fdd\u4e86\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u662f\u5728\u552f\u4e00\u65f6\u95f4\u7ebf\u4e0a\u7684\u67d0\u4e2a\u65f6\u95f4\u70b9\u81ea\u52a8\u5904\u7406\u7684\uff0c\u4e0d\u5b58\u5728\u4efb\u4f55\u5e76\u53d1\u3002</li> </ul> <p>\u5e76\u53d1\u610f\u5473\u7740\u65f6\u95f4\u7ebf\u4f1a\u5206\u5c94\u7136\u540e\u5408\u5e76\uff1a</p> <ul> <li>\u4e0d\u540c\u5206\u652f\u4e0a\u7684\u64cd\u4f5c\u662f\u65e0\u6cd5\u6bd4\u8f83\u7684\uff08\u5373\u5e76\u53d1\u64cd\u4f5c\uff09</li> <li>\u56fe 5-14 \u5e76\u4e0d\u662f\u4e00\u6761\u76f4\u7ebf\u7684\u5168\u5e8f\u5173\u7cfb\uff0c\u800c\u662f\u4e00\u5806\u4e0d\u540c\u7684\u64cd\u4f5c\u5e76\u53d1\u8fdb\u884c</li> </ul> <p>Git \u8fd9\u6837\u7684\u5206\u5e03\u5f0f\u7248\u672c\u63a7\u5236\u7cfb\u7edf\uff0c\u90a3\u4e48\u5176\u7248\u672c\u5386\u53f2\u4e0e\u56e0\u679c\u5173\u7cfb\u56fe\u6781\u5176\u76f8\u4f3c:</p> <ul> <li>\u4e00\u4e2a \u63d0\u4ea4\uff08Commit\uff09 \u53d1\u751f\u5728\u53e6\u4e00\u4e2a\u63d0\u4ea4\u4e4b\u540e\uff0c\u5728\u4e00\u6761\u76f4\u7ebf\u4e0a\uff1b</li> <li>\u9047\u5230\u5206\u652f\uff08\u5f53\u591a\u4e2a\u4eba\u540c\u65f6\u5728\u4e00\u4e2a\u9879\u76ee\u4e0a\u5de5\u4f5c\u65f6\uff09\uff0c\u5408\u5e76\uff08Merge\uff09 \u4f1a\u5728\u8fd9\u4e9b\u5e76\u53d1\u521b\u5efa\u7684\u63d0\u4ea4\u76f8\u878d\u5408\u65f6\u521b\u5efa\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_17","title":"\u7ebf\u6027\u4e00\u81f4\u6027\u5f3a\u4e8e\u56e0\u679c\u4e00\u81f4\u6027","text":"<p>\u4efb\u4f55\u7ebf\u6027\u4e00\u81f4\u7684\u7cfb\u7edf\u90fd\u80fd\u6b63\u786e\u4fdd\u6301\u56e0\u679c\u6027\u30107\u3011\u3002</p> <ul> <li> <p>\u5982\u679c\u7cfb\u7edf\u4e2d\u6709\u591a\u4e2a\u901a\u4fe1\u901a\u9053\uff08\u5982 \u56fe 9-5 \u4e2d\u7684\u6d88\u606f\u961f\u5217\u548c\u6587\u4ef6\u5b58\u50a8\u670d\u52a1\uff09\uff0c\u7ebf\u6027\u4e00\u81f4\u6027\u53ef\u4ee5\u81ea\u52a8\u4fdd\u8bc1\u56e0\u679c\u6027\uff0c\u7cfb\u7edf\u65e0\u9700\u4efb\u4f55\u7279\u6b8a\u64cd\u4f5c\uff08\u5982\u5728\u4e0d\u540c\u7ec4\u4ef6\u95f4\u4f20\u9012\u65f6\u95f4\u6233\uff09</p> </li> <li> <p>\u4f7f\u7cfb\u7edf\u7ebf\u6027\u4e00\u81f4\u53ef\u80fd\u4f1a\u635f\u5bb3\u5176\u6027\u80fd\u548c\u53ef\u7528\u6027\uff0c\u5c24\u5176\u662f\u5728\u7cfb\u7edf\u5177\u6709\u4e25\u91cd\u7684\u7f51\u7edc\u5ef6\u8fdf\u7684\u60c5\u51b5\u4e0b</p> </li> </ul> <p>\u7ebf\u6027\u4e00\u81f4\u6027\u5e76\u4e0d\u662f\u4fdd\u6301\u56e0\u679c\u6027\u7684\u552f\u4e00\u9014\u5f84\uff0c\u7cfb\u7edf\u53ef\u4ee5\u662f\u56e0\u679c\u4e00\u81f4\u7684\uff0c\u800c\u65e0\u9700\u627f\u62c5\u7ebf\u6027\u4e00\u81f4\u5e26\u6765\u7684\u6027\u80fd\u6298\u635f\uff08\u5c24\u5176\u5bf9\u4e8e CAP \u5b9a\u7406\u4e0d\u9002\u7528\u7684\u60c5\u51b5\uff09</p> <ul> <li>\u5728\u6240\u6709\u7684\u4e0d\u4f1a\u88ab\u7f51\u7edc\u5ef6\u8fdf\u62d6\u6162\u7684\u4e00\u81f4\u6027\u6a21\u578b\u4e2d\uff0c\u56e0\u679c\u4e00\u81f4\u6027\u662f\u53ef\u884c\u7684\u6700\u5f3a\u7684\u4e00\u81f4\u6027\u6a21\u578b\u3002\u800c\u4e14\u5728\u7f51\u7edc\u6545\u969c\u65f6\u4ecd\u80fd\u4fdd\u6301\u53ef\u7528\u30102,42\u3011</li> </ul> <p>\u65b0\u578b\u7684\u6570\u636e\u5e93\uff0c\u65e2\u80fd\u4fdd\u8bc1\u56e0\u679c\u4e00\u81f4\u6027\uff0c\u4e14\u6027\u80fd\u4e0e\u53ef\u7528\u6027\u4e0e\u6700\u7ec8\u4e00\u81f4\u7684\u7cfb\u7edf\u7c7b\u4f3c\u301049,50,51\u3011\u3002</p> <ul> <li>\u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\uff0c\u770b\u4e0a\u53bb\u9700\u8981\u7ebf\u6027\u4e00\u81f4\u6027\u7684\u7cfb\u7edf\uff0c\u5b9e\u9645\u4e0a\u9700\u8981\u7684\u53ea\u662f\u56e0\u679c\u4e00\u81f4\u6027</li> <li>\u7814\u7a76\u76f8\u5f53\u65b0\u9c9c\uff0c\u5176\u4e2d\u5f88\u591a\u5c1a\u672a\u5e94\u7528\u5230\u751f\u4ea7\u7cfb\u7edf\uff0c\u4ecd\u7136\u6709\u4e0d\u5c11\u6311\u6218\u9700\u8981\u514b\u670d\u301052,53\u3011</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_18","title":"\u6355\u83b7\u56e0\u679c\u5173\u7cfb","text":"<p>\u5f53\u4e00\u4e2a\u526f\u672c\u5904\u7406\u4e00\u4e2a\u64cd\u4f5c\u65f6\uff0c\u5b83\u5fc5\u987b\u786e\u4fdd\u6240\u6709\u56e0\u679c\u524d\u9a71\u7684\u64cd\u4f5c\uff08\u4e4b\u524d\u53d1\u751f\u7684\u6240\u6709\u64cd\u4f5c\uff09\u5df2\u7ecf\u88ab\u5904\u7406</p> <ul> <li>\u5982\u679c\u524d\u9762\u7684\u67d0\u4e2a\u64cd\u4f5c\u4e22\u5931\u4e86\uff0c\u540e\u9762\u7684\u64cd\u4f5c\u5fc5\u987b\u7b49\u5f85\uff0c\u76f4\u5230\u524d\u9762\u7684\u64cd\u4f5c\u88ab\u5904\u7406\u5b8c\u6bd5\u3002</li> </ul> <p>\u7528\u4e8e\u786e\u5b9a \u54ea\u4e9b\u64cd\u4f5c\u53d1\u751f\u5728\u5176\u4ed6\u64cd\u4f5c\u4e4b\u524d \u7684\u6280\u672f\uff0c\u4e0e\u6211\u4eec\u5728 \u201c\u68c0\u6d4b\u5e76\u53d1\u5199\u5165\u201d \u4e2d\u6240\u8ba8\u8bba\u7684\u5185\u5bb9\u7c7b\u4f3c\uff1a</p> <ul> <li>\u90a3\u4e00\u8282\u8ba8\u8bba\u4e86\u65e0\u9886\u5bfc\u8005\u6570\u636e\u5b58\u50a8\u4e2d\u7684\u56e0\u679c\u6027\uff1a\u4e3a\u4e86\u9632\u6b62\u4e22\u5931\u66f4\u65b0\uff0c\u6211\u4eec\u9700\u8981\u68c0\u6d4b\u5230\u5bf9\u540c\u4e00\u4e2a\u952e\u7684\u5e76\u53d1\u5199\u5165\uff1b</li> <li>\u56e0\u679c\u4e00\u81f4\u6027\u5219\u66f4\u8fdb\u4e00\u6b65\uff1a\u5b83\u9700\u8981\u8ddf\u8e2a\u6574\u4e2a\u6570\u636e\u5e93\u4e2d\u7684\u56e0\u679c\u4f9d\u8d56\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u4e00\u4e2a\u952e\u3002\u63a8\u5e7f\u7248\u672c\u5411\u91cf\u4ee5\u89e3\u51b3\u6b64\u7c7b\u95ee\u9898\u301054\u3011</li> </ul> <p>\u4e3a\u4e86\u786e\u5b9a\u56e0\u679c\u987a\u5e8f\uff0c\u6570\u636e\u5e93\u9700\u8981\u77e5\u9053\u5e94\u7528\u8bfb\u53d6\u4e86\u54ea\u4e2a\u7248\u672c\u7684\u6570\u636e\u3002</p> <ul> <li>\u5728 \u56fe 5-13 \u4e2d\uff0c\u6765\u81ea\u5148\u524d\u64cd\u4f5c\u7684\u7248\u672c\u53f7\u5728\u5199\u5165\u65f6\u88ab\u4f20\u56de\u5230\u6570\u636e\u5e93\u7684\u539f\u56e0\uff1b</li> <li>SSI\uff08\u53ef\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb\uff09\uff1a\u5f53\u4e8b\u52a1\u8981\u63d0\u4ea4\u65f6\uff0c\u6570\u636e\u5e93\u5c06\u68c0\u67e5\u5b83\u6240\u8bfb\u53d6\u7684\u6570\u636e\u7248\u672c\u662f\u5426\u4ecd\u7136\u662f\u6700\u65b0\u7684\u3002\u4e3a\u6b64\uff0c\u6570\u636e\u5e93\u8ddf\u8e2a\u54ea\u4e9b\u6570\u636e\u88ab\u54ea\u4e9b\u4e8b\u52a1\u6240\u8bfb\u53d6\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_19","title":"\u5e8f\u5217\u53f7\u987a\u5e8f","text":"<p>\u5b9e\u9645\u4e0a\u8ddf\u8e2a\u6240\u6709\u7684\u56e0\u679c\u5173\u7cfb\u662f\u4e0d\u5207\u5b9e\u9645\u7684\uff1a</p> <ul> <li>\u5ba2\u6237\u7aef\u5728\u5199\u5165\u5185\u5bb9\u4e4b\u524d\u4f1a\u5148\u8bfb\u53d6\u5927\u91cf\u6570\u636e\uff0c\u65e0\u6cd5\u5f04\u6e05\u5199\u5165\u56e0\u679c\u4f9d\u8d56\u4e8e\u5148\u524d\u5168\u90e8\u7684\u8bfb\u53d6\u5185\u5bb9\uff0c\u8fd8\u662f\u4ec5\u5305\u62ec\u5176\u4e2d\u4e00\u90e8\u5206\u3002</li> </ul> <p>\u4f7f\u7528 \u5e8f\u5217\u53f7\uff08sequence number\uff09 \u6216 \u65f6\u95f4\u6233\uff08timestamp\uff09 \u6765\u6392\u5e8f\u4e8b\u4ef6</p> <ul> <li>\u6765\u81ea\u4e00\u4e2a \u903b\u8f91\u65f6\u949f\uff08logical clock\uff09\uff0c\u5178\u578b\u5b9e\u73b0\u662f\u4f7f\u7528\u4e00\u4e2a\u6bcf\u6b21\u64cd\u4f5c\u81ea\u589e\u7684\u8ba1\u6570\u5668\u3002</li> </ul> <p>\u4f7f\u7528 \u4e0e\u56e0\u679c\u4e00\u81f4\uff08consistent with causality\uff09 \u7684\u5168\u5e8f\u6765\u751f\u6210\u5e8f\u5217\u53f7<sup>2</sup>\uff1a</p> <ul> <li>\u5982\u679c\u64cd\u4f5c A \u56e0\u679c\u5730\u53d1\u751f\u5728\u64cd\u4f5c B \u524d\uff0c\u90a3\u4e48\u5728\u8fd9\u4e2a\u5168\u5e8f\u4e2d A \u5728 B \u524d\uff08 A \u5177\u6709\u6bd4 B \u66f4\u5c0f\u7684\u5e8f\u5217\u53f7\uff09\u3002\u5e76\u884c\u64cd\u4f5c\u4e4b\u95f4\u53ef\u4ee5\u4efb\u610f\u6392\u5e8f\u3002</li> <li>\u6355\u83b7\u4e86\u6240\u6709\u5173\u4e8e\u56e0\u679c\u7684\u4fe1\u606f\uff0c\u4f46\u4e5f\u65bd\u52a0\u4e86\u4e00\u4e2a\u6bd4\u56e0\u679c\u6027\u8981\u6c42\u66f4\u4e3a\u4e25\u683c\u7684\u987a\u5e8f\u3002</li> </ul> <p>\u5728\u5355\u4e3b\u590d\u5236\u7684\u6570\u636e\u5e93\u4e2d\uff08\u8bf7\u53c2\u9605 \u201c\u9886\u5bfc\u8005\u4e0e\u8ffd\u968f\u8005\u201d\uff09\uff0c\u590d\u5236\u65e5\u5fd7\u5b9a\u4e49\u4e86\u4e0e\u56e0\u679c\u4e00\u81f4\u7684\u5199\u64cd\u4f5c\u3002</p> <ul> <li>\u4e3b\u5e93\u53ef\u4ee5\u7b80\u5355\u5730\u4e3a\u6bcf\u4e2a\u64cd\u4f5c\u81ea\u589e\u4e00\u4e2a\u8ba1\u6570\u5668\uff0c\u4ece\u800c\u4e3a\u590d\u5236\u65e5\u5fd7\u4e2d\u7684\u6bcf\u4e2a\u64cd\u4f5c\u5206\u914d\u4e00\u4e2a\u5355\u8c03\u9012\u589e\u7684\u5e8f\u5217\u53f7\u3002</li> <li>\u4ece\u5e93\u6309\u7167\u5b83\u4eec\u5728\u590d\u5236\u65e5\u5fd7\u4e2d\u51fa\u73b0\u7684\u987a\u5e8f\u6765\u5e94\u7528\u5199\u64cd\u4f5c\uff0c\u90a3\u4e48\u4ece\u5e93\u7684\u72b6\u6001\u59cb\u7ec8\u662f\u56e0\u679c\u4e00\u81f4\u7684\uff08\u5373\u4f7f\u5b83\u843d\u540e\u4e8e\u9886\u5bfc\u8005\uff09\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_20","title":"\u975e\u56e0\u679c\u5e8f\u5217\u53f7\u751f\u6210\u5668","text":"<p>\u5982\u679c\u4e3b\u5e93\u4e0d\u5b58\u5728\uff08\u53ef\u80fd\u56e0\u4e3a\u4f7f\u7528\u4e86\u591a\u4e3b\u6570\u636e\u5e93\u6216\u65e0\u4e3b\u6570\u636e\u5e93\uff0c\u6216\u8005\u56e0\u4e3a\u4f7f\u7528\u4e86\u5206\u533a\u7684\u6570\u636e\u5e93\uff09\uff0c\u5982\u4f55\u4e3a\u64cd\u4f5c\u751f\u6210\u5e8f\u5217\u53f7\u5c31\u6ca1\u6709\u90a3\u4e48\u660e\u663e\u3002\u5728\u5b9e\u8df5\u4e2d\u6709\u5404\u79cd\u5404\u6837\u7684\u65b9\u6cd5\uff1a</p> <ul> <li>\u6bcf\u4e2a\u8282\u70b9\u90fd\u53ef\u4ee5\u751f\u6210\u81ea\u5df1\u72ec\u7acb\u7684\u4e00\u7ec4\u5e8f\u5217\u53f7\uff1a\u5982\u4e24\u4e2a\u8282\u70b9\u65f6\u4e00\u4e2a\u8282\u70b9\u751f\u6210\u5947\u6570\uff0c\u4e00\u4e2a\u8282\u70b9\u751f\u6210\u5076\u6570\u3002</li> <li>\u53ef\u4ee5\u5c06\u65e5\u5386\u65f6\u949f\uff08\u7269\u7406\u65f6\u949f\uff09\u7684\u65f6\u95f4\u6233\u9644\u52a0\u5230\u6bcf\u4e2a\u64cd\u4f5c\u4e0a\u301055\u3011\u3002\u8fd9\u79cd\u65f6\u95f4\u6233\u5e76\u4e0d\u8fde\u7eed\uff0c\u4f46\u662f\u5982\u679c\u5b83\u5177\u6709\u8db3\u591f\u9ad8\u7684\u5206\u8fa8\u7387\uff0c\u90a3\u4e5f\u8bb8\u8db3\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u64cd\u4f5c\u7684\u5168\u5e8f\u5173\u7cfb\u3002</li> <li>\u53ef\u4ee5\u9884\u5148\u5206\u914d\u5e8f\u5217\u53f7\u533a\u5757\uff1a\u5982\u8282\u70b9A\u62e5\u67091-1000\uff0c\u8282\u70b9B\u62e5\u67091001-2000\u3002\u6bcf\u4e2a\u8282\u70b9\u53ef\u4ee5\u72ec\u7acb\u5206\u914d\u6240\u5c5e\u533a\u5757\u4e2d\u7684\u5e8f\u5217\u53f7\uff0c\u5e76\u5728\u5e8f\u5217\u53f7\u544a\u6025\u65f6\u8bf7\u6c42\u5206\u914d\u4e00\u4e2a\u65b0\u7684\u533a\u5757\u3002</li> </ul> <p>\u5b83\u4eec\u4e3a\u6bcf\u4e2a\u64cd\u4f5c\u751f\u6210\u4e00\u4e2a\u552f\u4e00\u7684\uff0c\u8fd1\u4f3c\u81ea\u589e\u7684\u5e8f\u5217\u53f7\u3002\u7136\u800c\u5b83\u4eec\u90fd\u6709\u540c\u4e00\u4e2a\u95ee\u9898\uff1a\u751f\u6210\u7684\u5e8f\u5217\u53f7\u4e0e\u56e0\u679c\u4e0d\u4e00\u81f4\u3002</p> <ul> <li>\u6bcf\u4e2a\u8282\u70b9\u6bcf\u79d2\u53ef\u4ee5\u5904\u7406\u4e0d\u540c\u6570\u91cf\u7684\u64cd\u4f5c\u3002\u4e00\u4e2a\u5947\u6570\u7f16\u53f7\u7684\u64cd\u4f5c\u548c\u4e00\u4e2a\u5076\u6570\u7f16\u53f7\u7684\u64cd\u4f5c\uff0c\u65e0\u6cd5\u786e\u5b9a\u54ea\u4e00\u4e2a\u64cd\u4f5c\u5728\u56e0\u679c\u4e0a\u5148\u53d1\u751f\u3002</li> <li>\u6765\u81ea\u7269\u7406\u65f6\u949f\u7684\u65f6\u95f4\u6233\u4f1a\u53d7\u5230\u65f6\u949f\u504f\u79fb\u7684\u5f71\u54cd\uff0c\u8fd9\u53ef\u80fd\u4f1a\u4f7f\u5176\u4e0e\u56e0\u679c\u4e0d\u4e00\u81f4\u3002\u5982\u56fe8-3</li> <li>\u5728\u5206\u914d\u533a\u5757\u7684\u60c5\u51b5\u4e0b\uff0c\u67d0\u4e2a\u64cd\u4f5c\u53ef\u80fd\u4f1a\u88ab\u8d4b\u4e88\u4e00\u4e2a\u8303\u56f4\u5728 1,001 \u5230 2,000 \u5185\u7684\u5e8f\u5217\u53f7\uff0c\u7136\u800c\u4e00\u4e2a\u56e0\u679c\u4e0a\u66f4\u665a\u7684\u64cd\u4f5c\u53ef\u80fd\u88ab\u8d4b\u4e88\u4e00\u4e2a\u8303\u56f4\u5728 1 \u5230 1,000 \u4e4b\u95f4\u7684\u6570\u5b57\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_21","title":"\u5170\u4f2f\u7279\u65f6\u95f4\u6233","text":"<p>\u83b1\u65af\u5229\u30fb\u5170\u4f2f\u7279\uff08Leslie Lamport\uff09\u4e8e 1978 \u5e74\u63d0\u51fa\u5170\u4f2f\u7279\u65f6\u95f4\u6233\u301056\u3011\uff0c\u5206\u5e03\u5f0f\u7cfb\u7edf\u9886\u57df\u4e2d\u88ab\u5f15\u7528\u6700\u591a\u7684\u8bba\u6587\u4e4b\u4e00\u3002</p> <ul> <li>\u6bcf\u4e2a\u8282\u70b9\u90fd\u6709\u4e00\u4e2a\u552f\u4e00\u6807\u8bc6\u7b26\uff0c\u548c\u4e00\u4e2a\u4fdd\u5b58\u81ea\u5df1\u6267\u884c\u64cd\u4f5c\u6570\u91cf\u7684\u8ba1\u6570\u5668\uff1b</li> <li>\u5170\u4f2f\u7279\u65f6\u95f4\u6233\u5c31\u662f\u4e24\u8005\u7684\u7b80\u5355\u7ec4\u5408\uff1a\uff08\u8ba1\u6570\u5668\uff0c\u8282\u70b9 ID\uff09\uff1b</li> <li>\u4e24\u4e2a\u8282\u70b9\u6709\u65f6\u53ef\u80fd\u5177\u6709\u76f8\u540c\u7684\u8ba1\u6570\u5668\u503c\uff0c\u4f46\u901a\u8fc7\u5728\u65f6\u95f4\u6233\u4e2d\u5305\u542b\u8282\u70b9 ID\uff0c\u6bcf\u4e2a\u65f6\u95f4\u6233\u90fd\u662f\u552f\u4e00\uff1b</li> </ul> <p>\u5982\u4e0b\u56fe9-8 \u8bf4\u660e\u4e86\u5170\u4f2f\u7279\u65f6\u95f4\u6233\u7684\u5e94\u7528\uff1a</p> <ul> <li>\u5ba2\u6237\u7aef A \u4ece\u8282\u70b9 2 \u63a5\u6536\u8ba1\u6570\u5668\u503c <code>5</code> \uff0c\u7136\u540e\u5c06\u6700\u5927\u503c <code>5</code> \u53d1\u9001\u5230\u8282\u70b9 1 \u3002\u6b64\u65f6\uff0c\u8282\u70b9 1 \u7684\u8ba1\u6570\u5668\u4ec5\u4e3a <code>1</code> \uff0c\u4f46\u662f\u5b83\u7acb\u5373\u524d\u79fb\u81f3 <code>5</code> \uff0c\u6240\u4ee5\u4e0b\u4e00\u4e2a\u64cd\u4f5c\u7684\u8ba1\u6570\u5668\u7684\u503c\u4e3a <code>6</code> \u3002</li> </ul> <p></p> \u56fe 9-8 Lamport \u65f6\u95f4\u6233\u63d0\u4f9b\u4e86\u4e0e\u56e0\u679c\u5173\u7cfb\u4e00\u81f4\u7684\u5168\u5e8f\u3002 <p>\u5170\u4f2f\u7279\u65f6\u95f4\u6233\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5168\u5e8f\uff1a\u5982\u679c\u4f60\u6709\u4e24\u4e2a\u65f6\u95f4\u6233\uff0c\u5219 \u8ba1\u6570\u5668 \u503c\u5927\u8005\u662f\u66f4\u5927\u7684\u65f6\u95f4\u6233\u3002\u5982\u679c\u8ba1\u6570\u5668\u503c\u76f8\u540c\uff0c\u5219\u8282\u70b9 ID \u8d8a\u5927\u7684\uff0c\u65f6\u95f4\u6233\u8d8a\u5927\u3002</p> <ul> <li>\u6bcf\u4e2a\u8282\u70b9\u548c\u6bcf\u4e2a\u5ba2\u6237\u7aef\u8ddf\u8e2a\u8fc4\u4eca\u4e3a\u6b62\u6240\u89c1\u5230\u7684\u6700\u5927 \u8ba1\u6570\u5668 \u503c\uff0c\u5e76\u5728\u6bcf\u4e2a\u8bf7\u6c42\u4e2d\u5305\u542b\u8fd9\u4e2a\u6700\u5927\u8ba1\u6570\u5668\u503c\u3002</li> <li>\u5f53\u4e00\u4e2a\u8282\u70b9\u6536\u5230\u6700\u5927\u8ba1\u6570\u5668\u503c\u5927\u4e8e\u81ea\u8eab\u8ba1\u6570\u5668\u503c\u7684\u8bf7\u6c42\u6216\u54cd\u5e94\u65f6\uff0c\u5b83\u7acb\u5373\u5c06\u81ea\u5df1\u7684\u8ba1\u6570\u5668\u8bbe\u7f6e\u4e3a\u8fd9\u4e2a\u6700\u5927\u503c\u3002</li> </ul> <p>\u5170\u4f2f\u7279\u65f6\u95f4\u6233\u6709\u65f6\u4f1a\u4e0e\u6211\u4eec\u5728 \u201c\u68c0\u6d4b\u5e76\u53d1\u5199\u5165\u201d \u4e2d\u770b\u5230\u7684\u7248\u672c\u5411\u91cf\u76f8\u6df7\u6dc6\u3002</p> <ul> <li>\u7248\u672c\u5411\u91cf\u53ef\u4ee5\u533a\u5206\u4e24\u4e2a\u64cd\u4f5c\u662f\u5e76\u53d1\u7684\uff0c\u8fd8\u662f\u4e00\u4e2a\u56e0\u679c\u4f9d\u8d56\u53e6\u4e00\u4e2a\uff1b</li> <li>\u5170\u4f2f\u7279\u65f6\u95f4\u6233\u603b\u662f\u65bd\u884c\u4e00\u4e2a\u5168\u5e8f\uff0c\u65e0\u6cd5\u5206\u8fa8\u4e24\u4e2a\u64cd\u4f5c\u662f\u5e76\u53d1\u7684\u8fd8\u662f\u56e0\u679c\u4f9d\u8d56\u3002</li> </ul> <p>\u867d\u7136\u5170\u4f2f\u7279\u65f6\u95f4\u6233\u5b9a\u4e49\u4e86\u4e00\u4e2a\u4e0e\u56e0\u679c\u4e00\u81f4\u7684\u5168\u5e8f\uff0c\u4f46\u5b83\u8fd8\u4e0d\u8db3\u4ee5\u89e3\u51b3\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u8bb8\u591a\u5e38\u89c1\u95ee\u9898\u3002</p> <ul> <li>\u4f8b\u5982\uff0c\u8003\u8651\u4e00\u4e2a\u9700\u8981\u786e\u4fdd\u7528\u6237\u540d\u80fd\u552f\u4e00\u6807\u8bc6\u7528\u6237\u5e10\u6237\u7684\u7cfb\u7edf\u3002\u5982\u679c\u4e24\u4e2a\u7528\u6237\u540c\u65f6\u5c1d\u8bd5\u4f7f\u7528\u76f8\u540c\u7684\u7528\u6237\u540d\u521b\u5efa\u5e10\u6237\uff0c\u5219\u5176\u4e2d\u4e00\u4e2a\u5e94\u8be5\u6210\u529f\uff0c\u53e6\u4e00\u4e2a\u5e94\u8be5\u5931\u8d25\u3002</li> </ul> <p>\u5170\u4f2f\u7279\u65f6\u95f4\u6233\u65b9\u6cd5\u9002\u7528\u4e8e\u4e8b\u540e\u786e\u5b9a\u80dc\u5229\u8005\uff1a</p> <ul> <li>\u4e00\u65e6\u4f60\u6536\u96c6\u4e86\u7cfb\u7edf\u4e2d\u7684\u6240\u6709\u7528\u6237\u540d\u521b\u5efa\u64cd\u4f5c\uff0c\u5c31\u53ef\u4ee5\u6bd4\u8f83\u5b83\u4eec\u7684\u65f6\u95f4\u6233\u3002</li> </ul> <p>\u5f53\u67d0\u4e2a\u8282\u70b9\u9700\u8981\u5b9e\u65f6\u5904\u7406\u7528\u6237\u521b\u5efa\u7528\u6237\u540d\u7684\u8bf7\u6c42\u65f6\uff0c\u8fd9\u6837\u7684\u65b9\u6cd5\u5c31\u65e0\u6cd5\u6ee1\u8db3\u4e86\uff1a</p> <ul> <li>\u8282\u70b9\u9700\u8981 \u9a6c\u4e0a\uff08right now\uff09 \u51b3\u5b9a\u8fd9\u4e2a\u8bf7\u6c42\u662f\u6210\u529f\u8fd8\u662f\u5931\u8d25</li> <li>\u8282\u70b9\u5e76\u4e0d\u77e5\u9053\u662f\u5426\u5b58\u5728\u5176\u4ed6\u8282\u70b9\u6b63\u5728\u5e76\u53d1\u6267\u884c\u521b\u5efa\u540c\u6837\u7528\u6237\u540d\u7684\u64cd\u4f5c\uff0c\u7f54\u8bba\u5176\u5b83\u8282\u70b9\u53ef\u80fd\u5206\u914d\u7ed9\u90a3\u4e2a\u64cd\u4f5c\u7684\u65f6\u95f4\u6233\u3002</li> <li>\u4e3a\u4e86\u786e\u4fdd\u6ca1\u6709\u5176\u4ed6\u8282\u70b9\u6b63\u5728\u4f7f\u7528\u76f8\u540c\u7684\u7528\u6237\u540d\u548c\u8f83\u5c0f\u7684\u65f6\u95f4\u6233\u5e76\u53d1\u521b\u5efa\u540c\u540d\u8d26\u6237\uff0c\u4f60\u5fc5\u987b\u68c0\u67e5\u5176\u5b83\u6bcf\u4e2a\u8282\u70b9\uff0c\u770b\u770b\u5b83\u5728\u505a\u4ec0\u4e48\u301056\u3011\u3002</li> <li>\u5982\u679c\u5176\u4e2d\u4e00\u4e2a\u8282\u70b9\u7531\u4e8e\u7f51\u7edc\u95ee\u9898\u51fa\u73b0\u6545\u969c\u6216\u4e0d\u53ef\u8fbe\uff0c\u5219\u6574\u4e2a\u7cfb\u7edf\u53ef\u80fd\u88ab\u62d6\u81f3\u505c\u673a\u3002\u8fd9\u6837\u5e76\u4e0d\u5bb9\u9519\u3002</li> </ul> <p>\u95ee\u9898\u662f\uff0c\u53ea\u6709\u5728\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u88ab\u6536\u96c6\u4e4b\u540e\uff0c\u64cd\u4f5c\u7684\u5168\u5e8f\u624d\u4f1a\u51fa\u73b0\u3002</p> <ul> <li>\u5982\u679c\u53e6\u4e00\u4e2a\u8282\u70b9\u5df2\u7ecf\u4ea7\u751f\u4e86\u4e00\u4e9b\u64cd\u4f5c\uff0c\u4f46\u4f60\u8fd8\u4e0d\u77e5\u9053\u90a3\u4e9b\u64cd\u4f5c\u662f\u4ec0\u4e48\uff0c\u90a3\u5c31\u65e0\u6cd5\u6784\u9020\u6240\u6709\u64cd\u4f5c\u6700\u7ec8\u7684\u5168\u5e8f\u5173\u7cfb\u3002</li> </ul> <p>\u786e\u5b9a\u5168\u5e8f\u5173\u7cfb\u5df2\u7ecf\u5c18\u57c3\u843d\u5b9a\uff0c\u8fd9\u5c06\u5728 \u5168\u5e8f\u5e7f\u64ad \u4e00\u8282\u4e2d\u8be6\u7ec6\u8bf4\u660e\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_22","title":"\u5168\u5e8f\u5e7f\u64ad","text":"<p>\u5355\u4e3b\u590d\u5236\u901a\u8fc7\u9009\u62e9\u4e00\u4e2a\u8282\u70b9\u4f5c\u4e3a\u4e3b\u5e93\u6765\u786e\u5b9a\u64cd\u4f5c\u7684\u5168\u5e8f\uff0c\u5982\u679c\u541e\u5410\u91cf\u8d85\u51fa\u5355\u4e2a\u4e3b\u5e93\u7684\u5904\u7406\u80fd\u529b\uff0c\u5982\u4f55\u6269\u5c55\u7cfb\u7edf\uff1b\u5982\u679c\u4e3b\u5e93\u5931\u6548\uff0c\u5982\u4f55\u5904\u7406\u6545\u969c\u5207\u6362\u3002\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u6587\u732e\u4e2d\uff0c\u8fd9\u4e2a\u95ee\u9898\u88ab\u79f0\u4e3a \u5168\u5e8f\u5e7f\u64ad\uff08total order broadcast\uff09 \u6216 \u539f\u5b50\u5e7f\u64ad\uff08atomic broadcast\uff09<sup>3</sup>\u301025,57,58\u3011\u3002</p> <p>\u5168\u5e8f\u5e7f\u64ad\u901a\u5e38\u88ab\u63cf\u8ff0\u4e3a\u5728\u8282\u70b9\u95f4\u4ea4\u6362\u6d88\u606f\u7684\u534f\u8bae\u3002\u975e\u6b63\u5f0f\u5730\u8bb2\uff0c\u5b83\u8981\u6ee1\u8db3\u4e24\u4e2a\u5b89\u5168\u5c5e\u6027\uff1a</p> <ul> <li>\u53ef\u9760\u4ea4\u4ed8\uff08reliable delivery\uff09\uff1a\u6ca1\u6709\u6d88\u606f\u4e22\u5931\uff1a\u5982\u679c\u6d88\u606f\u88ab\u4f20\u9012\u5230\u4e00\u4e2a\u8282\u70b9\uff0c\u5b83\u5c06\u88ab\u4f20\u9012\u5230\u6240\u6709\u8282\u70b9\u3002</li> <li>\u5168\u5e8f\u4ea4\u4ed8\uff08totally ordered delivery\uff09\uff1a\u6d88\u606f\u4ee5\u76f8\u540c\u7684\u987a\u5e8f\u4f20\u9012\u7ed9\u6bcf\u4e2a\u8282\u70b9\u3002</li> </ul> <p>\u5728\u7f51\u7edc\u4e2d\u65ad\u7684\u65f6\u5019\uff0c\u6d88\u606f\u662f\u4f20\u4e0d\u51fa\u53bb\u7684\uff0c\u4f46\u662f\u7b97\u6cd5\u53ef\u4ee5\u4e0d\u65ad\u91cd\u8bd5\uff0c\u4ee5\u4fbf\u5728\u7f51\u7edc\u6700\u7ec8\u4fee\u590d\u65f6\uff0c\u6d88\u606f\u80fd\u53ca\u65f6\u901a\u8fc7\u5e76\u9001\u8fbe\uff08\u5f53\u7136\u5b83\u4eec\u5fc5\u987b\u4ecd\u7136\u6309\u7167\u6b63\u786e\u7684\u987a\u5e8f\u4f20\u9012\uff09\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_23","title":"\u987a\u5e8f\u4fdd\u8bc1\u7684\u8303\u56f4","text":"<p>\u6bcf\u4e2a\u5206\u533a\u5404\u6709\u4e00\u4e2a\u4e3b\u5e93\u7684\u5206\u533a\u6570\u636e\u5e93\uff0c\u901a\u5e38\u53ea\u5728\u6bcf\u4e2a\u5206\u533a\u5185\u7ef4\u6301\u987a\u5e8f\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u4e0d\u80fd\u63d0\u4f9b\u8de8\u5206\u533a\u7684\u4e00\u81f4\u6027\u4fdd\u8bc1\uff08\u4f8b\u5982\uff0c\u4e00\u81f4\u6027\u5feb\u7167\uff0c\u5916\u952e\u5f15\u7528\uff09\u3002\u8de8\u6240\u6709\u5206\u533a\u7684\u5168\u5e8f\u662f\u53ef\u80fd\u7684\uff0c\u4f46\u9700\u8981\u989d\u5916\u7684\u534f\u8c03\u301059\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_24","title":"\u4f7f\u7528\u5168\u5e8f\u5e7f\u64ad","text":"<p>\u50cf ZooKeeper \u548c etcd \u8fd9\u6837\u7684\u5171\u8bc6\u670d\u52a1\u5b9e\u9645\u4e0a\u5b9e\u73b0\u4e86\u5168\u5e8f\u5e7f\u64ad\u3002\u6697\u793a\u4e86\u5168\u5e8f\u5e7f\u64ad\u4e0e\u5171\u8bc6\u4e4b\u95f4\u6709\u7740\u7d27\u5bc6\u8054\u7cfb\u3002</p> <p>\u5168\u5e8f\u5e7f\u64ad\u6b63\u662f\u6570\u636e\u5e93\u590d\u5236\u6240\u9700\u7684\uff1a\u5982\u679c\u6bcf\u4e2a\u6d88\u606f\u90fd\u4ee3\u8868\u4e00\u6b21\u6570\u636e\u5e93\u7684\u5199\u5165\uff0c\u4e14\u6bcf\u4e2a\u526f\u672c\u90fd\u6309\u76f8\u540c\u7684\u987a\u5e8f\u5904\u7406\u76f8\u540c\u7684\u5199\u5165\uff0c\u90a3\u4e48\u526f\u672c\u95f4\u5c06\u76f8\u4e92\u4fdd\u6301\u4e00\u81f4\uff08\u9664\u4e86\u4e34\u65f6\u7684\u590d\u5236\u5ef6\u8fdf\uff09\u3002\u8fd9\u4e2a\u539f\u7406\u88ab\u79f0\u4e3a \u72b6\u6001\u673a\u590d\u5236\uff08state machine replication\uff09\u301060\u3011\uff0c\u6211\u4eec\u5c06\u5728 \u7b2c\u5341\u4e00\u7ae0 \u4e2d\u91cd\u65b0\u56de\u5230\u8fd9\u4e2a\u6982\u5ff5\u3002</p> <p>\u5168\u5e8f\u5e7f\u64ad\u53ef\u7528\u6765\u5b9e\u73b0\u53ef\u4e32\u884c\u5316\u7684\u4e8b\u52a1\uff1a\u6bcf\u4e2a\u6d88\u606f\u90fd\u8868\u793a\u4e00\u4e2a\u786e\u5b9a\u6027\u4e8b\u52a1\uff0c\u4ee5\u5b58\u50a8\u8fc7\u7a0b\u7684\u5f62\u5f0f\u6765\u6267\u884c\uff0c\u4e14\u6bcf\u4e2a\u8282\u70b9\u90fd\u4ee5\u76f8\u540c\u7684\u987a\u5e8f\u5904\u7406\u8fd9\u4e9b\u6d88\u606f\uff0c\u90a3\u4e48\u6570\u636e\u5e93\u7684\u5206\u533a\u548c\u526f\u672c\u5c31\u53ef\u4ee5\u76f8\u4e92\u4fdd\u6301\u4e00\u81f4\u301061\u3011\u3002</p> <p>\u5168\u5e8f\u5e7f\u64ad\u7684\u4e00\u4e2a\u91cd\u8981\u8868\u73b0\u662f\uff0c\u987a\u5e8f\u5728\u6d88\u606f\u9001\u8fbe\u65f6\u88ab\u56fa\u5316\uff1a\u5982\u679c\u540e\u7eed\u7684\u6d88\u606f\u5df2\u7ecf\u9001\u8fbe\uff0c\u8282\u70b9\u5c31\u4e0d\u5141\u8bb8\u8ffd\u6eaf\u5730\u5c06\uff08\u5148\u524d\uff09\u6d88\u606f\u63d2\u5165\u987a\u5e8f\u4e2d\u7684\u8f83\u65e9\u4f4d\u7f6e\u3002\u8fd9\u4e2a\u4e8b\u5b9e\u4f7f\u5f97\u5168\u5e8f\u5e7f\u64ad\u6bd4\u65f6\u95f4\u6233\u6392\u5e8f\u66f4\u5f3a\u3002</p> <p>\u4f20\u9012\u6d88\u606f\u5c31\u50cf\u8ffd\u52a0\u5199\u5165\u65e5\u5fd7\u3002\u7531\u4e8e\u6240\u6709\u8282\u70b9\u5fc5\u987b\u4ee5\u76f8\u540c\u7684\u987a\u5e8f\u4f20\u9012\u76f8\u540c\u7684\u6d88\u606f\uff0c\u56e0\u6b64\u6240\u6709\u8282\u70b9\u90fd\u53ef\u4ee5\u8bfb\u53d6\u65e5\u5fd7\uff0c\u5e76\u770b\u5230\u76f8\u540c\u7684\u6d88\u606f\u5e8f\u5217\u3002</p> <p>\u5168\u5e8f\u5e7f\u64ad\u5bf9\u4e8e\u5b9e\u73b0\u63d0\u4f9b\u9632\u62a4\u4ee4\u724c\u7684\u9501\u670d\u52a1\u4e5f\u5f88\u6709\u7528\uff1a\u6bcf\u4e2a\u83b7\u53d6\u9501\u7684\u8bf7\u6c42\u90fd\u4f5c\u4e3a\u4e00\u6761\u6d88\u606f\u8ffd\u52a0\u5230\u65e5\u5fd7\u672b\u5c3e\uff0c\u5e76\u4e14\u6240\u6709\u7684\u6d88\u606f\u90fd\u6309\u5b83\u4eec\u5728\u65e5\u5fd7\u4e2d\u51fa\u73b0\u7684\u987a\u5e8f\u4f9d\u6b21\u7f16\u53f7\u3002\u5e8f\u5217\u53f7\u53ef\u4ee5\u5f53\u6210\u9632\u62a4\u4ee4\u724c\u7528\uff0c\u56e0\u4e3a\u5b83\u662f\u5355\u8c03\u9012\u589e\u7684\u3002\u5728 ZooKeeper \u4e2d\uff0c\u8fd9\u4e2a\u5e8f\u5217\u53f7\u88ab\u79f0\u4e3a <code>zxid</code> \u301015\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_25","title":"\u4f7f\u7528\u5168\u5e8f\u5e7f\u64ad\u5b9e\u73b0\u7ebf\u6027\u4e00\u81f4\u7684\u5b58\u50a8","text":"<p>\u5728\u7ebf\u6027\u4e00\u81f4\u7684\u7cfb\u7edf\u4e2d\uff0c\u5b58\u5728\u64cd\u4f5c\u7684\u5168\u5e8f\u3002\u8fd9\u662f\u5426\u610f\u5473\u7740\u7ebf\u6027\u4e00\u81f4\u4e0e\u5168\u5e8f\u5e7f\u64ad\u4e00\u6837\uff1f\u4e0d\u5c3d\u7136\uff0c\u4f46\u4e24\u8005\u4e4b\u95f4\u6709\u7740\u5bc6\u5207\u7684\u8054\u7cfb<sup>4</sup>\u3002</p> <ul> <li> <p>\u5168\u5e8f\u5e7f\u64ad\u662f\u5f02\u6b65\u7684\uff1a\u6d88\u606f\u88ab\u4fdd\u8bc1\u4ee5\u56fa\u5b9a\u7684\u987a\u5e8f\u53ef\u9760\u5730\u4f20\u9001\uff0c\u4f46\u662f\u4e0d\u80fd\u4fdd\u8bc1\u6d88\u606f \u4f55\u65f6 \u88ab\u9001\u8fbe\uff08\u6240\u4ee5\u4e00\u4e2a\u63a5\u6536\u8005\u53ef\u80fd\u843d\u540e\u4e8e\u5176\u4ed6\u63a5\u6536\u8005\uff09\u3002</p> </li> <li> <p>\u7ebf\u6027\u4e00\u81f4\u6027\u662f\u65b0\u9c9c\u6027\u7684\u4fdd\u8bc1\uff1a\u8bfb\u53d6\u4e00\u5b9a\u80fd\u770b\u89c1\u6700\u65b0\u7684\u5199\u5165\u503c\u3002</p> </li> </ul> <p>\u5728\u5168\u5e8f\u5e7f\u64ad\u57fa\u7840\u4e0a\u6784\u5efa\u7ebf\u6027\u4e00\u81f4\u7684\u5b58\u50a8\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u786e\u4fdd\u7528\u6237\u540d\u80fd\u552f\u4e00\u6807\u8bc6\u7528\u6237\u5e10\u6237\uff1a</p> <ul> <li>\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u53ef\u80fd\u7684\u7528\u6237\u540d\uff0c\u90fd\u6709\u4e00\u4e2a\u5e26\u6709 CAS \u539f\u5b50\u64cd\u4f5c\u7684\u7ebf\u6027\u4e00\u81f4\u5bc4\u5b58\u5668\uff1b</li> <li>\u6bcf\u4e2a\u5bc4\u5b58\u5668\u6700\u521d\u7684\u503c\u4e3a\u7a7a\u503c\uff08\u8868\u793a\u672a\u4f7f\u7528\u8be5\u7528\u6237\u540d\uff09\uff0c\u5f53\u7528\u6237\u60f3\u8981\u521b\u5efa\u4e00\u4e2a\u7528\u6237\u540d\u65f6\uff0c\u5bf9\u8be5\u7528\u6237\u540d\u7684\u5bc4\u5b58\u5668\u6267\u884c CAS \u64cd\u4f5c\uff1b</li> <li>\u5982\u679c\u591a\u4e2a\u7528\u6237\u8bd5\u56fe\u540c\u65f6\u83b7\u53d6\u76f8\u540c\u7684\u7528\u6237\u540d\uff0c\u5219\u53ea\u6709\u4e00\u4e2a CAS \u64cd\u4f5c\u4f1a\u6210\u529f\uff0c\u56e0\u4e3a\u5176\u4ed6\u7528\u6237\u4f1a\u770b\u5230\u975e\u7a7a\u7684\u503c\uff08\u7531\u4e8e\u7ebf\u6027\u4e00\u81f4\u6027\uff09\u3002</li> </ul> <p>\u5c06\u5168\u5e8f\u5e7f\u64ad\u5f53\u6210\u4ec5\u8ffd\u52a0\u65e5\u5fd7\u301062,63\u3011\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u8fd9\u79cd\u7ebf\u6027\u4e00\u81f4\u7684 CAS \u64cd\u4f5c\uff1a</p> <ul> <li>\u5728\u65e5\u5fd7\u4e2d\u8ffd\u52a0\u4e00\u6761\u6d88\u606f\uff0c\u8bd5\u63a2\u6027\u5730\u6307\u660e\u4f60\u8981\u58f0\u660e\u7684\u7528\u6237\u540d\u3002</li> <li>\u8bfb\u65e5\u5fd7\uff0c\u5e76\u7b49\u5f85\u4f60\u521a\u624d\u8ffd\u52a0\u7684\u6d88\u606f\u88ab\u8bfb\u56de\u3002<sup>8</sup></li> <li>\u68c0\u67e5\u662f\u5426\u6709\u4efb\u4f55\u6d88\u606f\u58f0\u79f0\u76ee\u6807\u7528\u6237\u540d\u7684\u6240\u6709\u6743\u3002\u5982\u679c\u8fd9\u4e9b\u6d88\u606f\u4e2d\u7684\u7b2c\u4e00\u6761\u5c31\u662f\u4f60\u81ea\u5df1\u7684\u6d88\u606f\uff0c\u90a3\u4e48\u4f60\u5c31\u6210\u529f\u4e86\uff1a\u4f60\u53ef\u4ee5\u63d0\u4ea4\u58f0\u79f0\u7684\u7528\u6237\u540d\uff08\u4e5f\u8bb8\u662f\u901a\u8fc7\u5411\u65e5\u5fd7\u8ffd\u52a0\u53e6\u4e00\u6761\u6d88\u606f\uff09\u5e76\u5411\u5ba2\u6237\u7aef\u786e\u8ba4\u3002\u5982\u679c\u6240\u9700\u7528\u6237\u540d\u7684\u7b2c\u4e00\u6761\u6d88\u606f\u6765\u81ea\u5176\u4ed6\u7528\u6237\uff0c\u5219\u4e2d\u6b62\u64cd\u4f5c\u3002</li> </ul> <p>\u7531\u4e8e\u65e5\u5fd7\u9879\u662f\u4ee5\u76f8\u540c\u987a\u5e8f\u9001\u8fbe\u81f3\u6240\u6709\u8282\u70b9\uff0c\u56e0\u6b64\u5982\u679c\u6709\u591a\u4e2a\u5e76\u53d1\u5199\u5165\uff0c\u5219\u6240\u6709\u8282\u70b9\u4f1a\u5bf9\u6700\u5148\u5230\u8fbe\u8005\u8fbe\u6210\u4e00\u81f4\u3002\u7c7b\u4f3c\u7684\u65b9\u6cd5\u53ef\u4ee5\u5728\u4e00\u4e2a\u65e5\u5fd7\u7684\u57fa\u7840\u4e0a\u5b9e\u73b0\u53ef\u4e32\u884c\u5316\u7684\u591a\u5bf9\u8c61\u4e8b\u52a1\u301062\u3011\u3002</p> <p>\u8fd9\u4e00\u8fc7\u7a0b\u4fdd\u8bc1\u5199\u5165\u662f\u7ebf\u6027\u4e00\u81f4\u7684\uff0c\u4f46\u5b83\u5e76\u4e0d\u4fdd\u8bc1\u8bfb\u53d6\u4e5f\u662f\u7ebf\u6027\u4e00\u81f4\u7684</p> <ul> <li>\u4ece\u4e0e\u65e5\u5fd7\u5f02\u6b65\u66f4\u65b0\u7684\u5b58\u50a8\u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u7ed3\u679c\u53ef\u80fd\u662f\u9648\u65e7\u7684</li> </ul> <p>\u7cbe\u786e\u5730\u8bf4\uff0c\u8fd9\u91cc\u63cf\u8ff0\u7684\u8fc7\u7a0b\u63d0\u4f9b\u4e86 \u987a\u5e8f\u4e00\u81f4\u6027\uff08sequential consistency\uff09\u301047,64\u3011\uff0c\u6709\u65f6\u4e5f\u79f0\u4e3a \u65f6\u95f4\u7ebf\u4e00\u81f4\u6027\uff08timeline consistency\uff09\u301065,66\u3011\uff0c\u6bd4\u7ebf\u6027\u4e00\u81f4\u6027\u7a0d\u5fae\u5f31\u4e00\u4e9b\u7684\u4fdd\u8bc1\u3002</p> <p>\u4f7f\u8bfb\u53d6\u4e5f\u7ebf\u6027\u4e00\u81f4\uff0c\u6709\u51e0\u4e2a\u9009\u9879\uff1a</p> <ul> <li>\u5728\u65e5\u5fd7\u4e2d\u8ffd\u52a0\u4e00\u6761\u6d88\u606f\uff0c\u7136LLLL\u540e\u8bfb\u53d6\u65e5\u5fd7\uff0c\u76f4\u5230\u8be5\u6d88\u606f\u88ab\u8bfb\u56de\u624d\u6267\u884c\u5b9e\u9645\u7684\u8bfb\u53d6\u64cd\u4f5c\u3002\u6d88\u606f\u5728\u65e5\u5fd7\u4e2d\u7684\u4f4d\u7f6e\u56e0\u6b64\u5b9a\u4e49\u4e86\u8bfb\u53d6\u53d1\u751f\u7684\u65f6\u95f4\u70b9\uff08etcd \u7684\u6cd5\u5b9a\u4eba\u6570\u8bfb\u53d6\u6709\u4e9b\u7c7b\u4f3c\u8fd9\u79cd\u60c5\u51b5\u301016\u3011\uff09\u3002</li> <li>\u5982\u679c\u65e5\u5fd7\u5141\u8bb8\u4ee5\u7ebf\u6027\u4e00\u81f4\u7684\u65b9\u5f0f\u83b7\u53d6\u6700\u65b0\u65e5\u5fd7\u6d88\u606f\u7684\u4f4d\u7f6e\uff0c\u5219\u53ef\u4ee5\u67e5\u8be2\u8be5\u4f4d\u7f6e\uff0c\u7b49\u5f85\u8be5\u4f4d\u7f6e\u524d\u7684\u6240\u6709\u6d88\u606f\u90fd\u4f20\u8fbe\u5230\u4f60\uff0c\u7136\u540e\u6267\u884c\u8bfb\u53d6\u3002\uff08\u8fd9\u662f Zookeeper <code>sync()</code> \u64cd\u4f5c\u80cc\u540e\u7684\u601d\u60f3\u301015\u3011\uff09\u3002</li> <li>\u4ece\u540c\u6b65\u66f4\u65b0\u7684\u526f\u672c\u4e2d\u8fdb\u884c\u8bfb\u53d6\uff0c\u56e0\u6b64\u53ef\u4ee5\u786e\u4fdd\u7ed3\u679c\u662f\u6700\u65b0\u7684\uff08\u8fd9\u79cd\u6280\u672f\u7528\u4e8e\u94fe\u5f0f\u590d\u5236\uff08chain replication\uff09\u301063\u3011\uff09</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_26","title":"\u4f7f\u7528\u7ebf\u6027\u4e00\u81f4\u6027\u5b58\u50a8\u5b9e\u73b0\u5168\u5e8f\u5e7f\u64ad","text":"<p>\u5047\u8bbe\u6211\u4eec\u6709\u7ebf\u6027\u4e00\u81f4\u7684\u5b58\u50a8\uff0c\u63a5\u4e0b\u6765\u4f1a\u5c55\u793a\u5982\u4f55\u5728\u6b64\u57fa\u7840\u4e0a\u6784\u5efa\u5168\u5e8f\u5e7f\u64ad\u3002</p> <ul> <li>\u6709\u4e00\u4e2a\u7ebf\u6027\u4e00\u81f4\u7684\u5bc4\u5b58\u5668\u6765\u5b58\u50a8\u4e00\u4e2a\u6574\u6570\uff0c\u5e76\u4e14\u6709\u4e00\u4e2a\u539f\u5b50 \u81ea\u589e\u5e76\u8fd4\u56de\uff08\u6216\u8005CAS\uff09 \u64cd\u4f5c\u301028\u3011\u3002</li> <li>\u6bcf\u4e2a\u8981\u901a\u8fc7\u5168\u5e8f\u5e7f\u64ad\u53d1\u9001\u7684\u6d88\u606f\u9996\u5148\u5bf9\u7ebf\u6027\u4e00\u81f4\u5bc4\u5b58\u5668\u6267\u884c \u81ea\u589e\u5e76\u8fd4\u56de \u64cd\u4f5c\uff1b</li> <li>\u5c06\u4ece\u5bc4\u5b58\u5668\u83b7\u5f97\u7684\u503c\u4f5c\u4e3a\u5e8f\u5217\u53f7\u9644\u52a0\u5230\u6d88\u606f\u4e2d\u3002\u7136\u540e\u4f60\u53ef\u4ee5\u5c06\u6d88\u606f\u53d1\u9001\u5230\u6240\u6709\u8282\u70b9\uff08\u91cd\u65b0\u53d1\u9001\u4efb\u4f55\u4e22\u5931\u7684\u6d88\u606f\uff09\uff0c\u800c\u6536\u4ef6\u4eba\u5c06\u6309\u5e8f\u5217\u53f7\u4f9d\u5e8f\u4f20\u9012\uff08deliver\uff09\u6d88\u606f\u3002</li> </ul> <p>\u5b9e\u73b0\u4e00\u4e2a\u5e26\u6709\u539f\u5b50\u6027 \u81ea\u589e\u5e76\u8fd4\u56de \u64cd\u4f5c\u7684\u7ebf\u6027\u4e00\u81f4\u5bc4\u5b58\u5668\u6709\u591a\u56f0\u96be\uff1f</p> <ul> <li>\u7b80\u5355\u5730\u628a\u5b83\u4fdd\u5b58\u5728\u5355\u4e2a\u8282\u70b9\u5185\u7684\u53d8\u91cf\u4e2d</li> <li>\u5f53\u8be5\u8282\u70b9\u7684\u7f51\u7edc\u8fde\u63a5\u4e2d\u65ad\u65f6\u7684\u60c5\u51b5\uff0c\u5e76\u5728\u8be5\u8282\u70b9\u5931\u6548\u65f6\u80fd\u6062\u590d\u8fd9\u4e2a\u503c\u301059\u3011</li> <li>\u5bf9\u7ebf\u6027\u4e00\u81f4\u6027\u7684\u5e8f\u5217\u53f7\u751f\u6210\u5668\u8fdb\u884c\u8fc7\u8db3\u591f\u6df1\u5165\u7684\u601d\u8003\uff0c\u4f60\u4e0d\u53ef\u907f\u514d\u5730\u4f1a\u5f97\u51fa\u4e00\u4e2a\u5171\u8bc6\u7b97\u6cd5\u3002</li> </ul> <p>\u53ef\u4ee5\u8bc1\u660e\uff0c\u7ebf\u6027\u4e00\u81f4\u7684 CAS\uff08\u6216\u81ea\u589e\u5e76\u8fd4\u56de\uff09\u5bc4\u5b58\u5668\u4e0e\u5168\u5e8f\u5e7f\u64ad\u90fd\u7b49\u4ef7\u4e8e \u5171\u8bc6 \u95ee\u9898\u301028,67\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_27","title":"\u5206\u5e03\u5f0f\u4e8b\u52a1\u4e0e\u5171\u8bc6","text":"<p>\u5171\u8bc6\uff1a\u975e\u6b63\u5f0f\u5730\u8bb2\uff0c\u76ee\u6807\u53ea\u662f \u8ba9\u51e0\u4e2a\u8282\u70b9\u8fbe\u6210\u4e00\u81f4\uff08get serveral nodes to agree on something\uff09\u3002</p> <p>\u8282\u70b9\u80fd\u8fbe\u6210\u4e00\u81f4\uff0c\u5728\u5f88\u591a\u573a\u666f\u4e0b\u90fd\u975e\u5e38\u91cd\u8981\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>\u9886\u5bfc\u9009\u4e3e\uff1a\u5728\u5355\u4e3b\u590d\u5236\u7684\u6570\u636e\u5e93\u4e2d\uff0c\u6240\u6709\u8282\u70b9\u9700\u8981\u5c31\u54ea\u4e2a\u8282\u70b9\u662f\u9886\u5bfc\u8005\u8fbe\u6210\u4e00\u81f4\u3002</li> <li>\u5982\u679c\u4e00\u4e9b\u8282\u70b9\u7531\u4e8e\u7f51\u7edc\u6545\u969c\u800c\u65e0\u6cd5\u4e0e\u5176\u4ed6\u8282\u70b9\u901a\u4fe1\uff0c\u5219\u53ef\u80fd\u4f1a\u5bf9\u9886\u5bfc\u6743\u7684\u5f52\u5c5e\u5f15\u8d77\u4e89\u8bae\u3002</li> <li>\u8111\u88c2\uff1a\u9519\u8bef\u7684\u6545\u969c\u5207\u6362\u4f1a\u5bfc\u81f4\u4e24\u4e2a\u8282\u70b9\u90fd\u8ba4\u4e3a\u81ea\u5df1\u662f\u9886\u5bfc\u8005\uff0c\u5bfc\u81f4\u4e0d\u4e00\u81f4\u548c\u6570\u636e\u4e22\u5931\u3002</li> <li>\u539f\u5b50\u63d0\u4ea4<sup>9</sup>\uff1a\u652f\u6301\u8de8\u591a\u8282\u70b9\u6216\u8de8\u591a\u5206\u533a\u4e8b\u52a1\u7684\u6570\u636e\u5e93\uff0c\u8ba9\u6240\u6709\u8282\u70b9\u5bf9\u4e8b\u52a1\u7684\u7ed3\u679c\u8fbe\u6210\u4e00\u81f4\u3002\u8981\u4e48\u5168\u90e8\u4e2d\u6b62 / \u56de\u6eda\uff08\u5982\u679c\u51fa\u73b0\u4efb\u4f55\u9519\u8bef\uff09\uff0c\u8981\u4e48\u5b83\u4eec\u5168\u90e8\u63d0\u4ea4\uff08\u5982\u679c\u6ca1\u6709\u51fa\u9519\uff09\u3002</li> </ul> <p>\u4e24\u9636\u6bb5\u63d0\u4ea4\uff082PC, two-phase commit\uff09 \u7b97\u6cd5\uff0c\u8fd9\u662f\u89e3\u51b3\u539f\u5b50\u63d0\u4ea4\u95ee\u9898\u6700\u5e38\u89c1\u7684\u529e\u6cd5\uff0c\u5e76\u5728\u5404\u79cd\u6570\u636e\u5e93\u3001\u6d88\u606f\u961f\u5217\u548c\u5e94\u7528\u670d\u52a1\u5668\u4e2d\u88ab\u5b9e\u73b0\u3002\u4e8b\u5b9e\u8bc1\u660e 2PC \u662f\u4e00\u79cd\u5171\u8bc6\u7b97\u6cd5\uff0c\u4f46\u4e0d\u662f\u4e00\u4e2a\u975e\u5e38\u597d\u7684\u5171\u8bc6\u7b97\u6cd5\u301070,71\u3011\u3002</p> <p>\u901a\u8fc7\u5bf9 2PC \u7684\u5b66\u4e60\uff0c\u6211\u4eec\u5c06\u7ee7\u7eed\u52aa\u529b\u5b9e\u73b0\u66f4\u597d\u7684\u4e00\u81f4\u6027\u7b97\u6cd5\uff0c\u6bd4\u5982 ZooKeeper\uff08Zab\uff09\u548c etcd\uff08Raft\uff09\u4e2d\u4f7f\u7528\u7684\u7b97\u6cd5\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_28","title":"\u5171\u8bc6\u7684\u4e0d\u53ef\u80fd\u6027","text":"<p>\u4f5c\u8005 Fischer\uff0cLynch \u548c Paterson \u547d\u540d\u7684 FLP \u7ed3\u679c\u301068\u3011\uff0c\u5b83\u8bc1\u660e\uff0c\u5982\u679c\u5b58\u5728\u8282\u70b9\u53ef\u80fd\u5d29\u6e83\u7684\u98ce\u9669\uff0c\u5219\u4e0d\u5b58\u5728 \u603b\u662f \u80fd\u591f\u8fbe\u6210\u5171\u8bc6\u7684\u7b97\u6cd5\u3002</p> <p>\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u6211\u4eec\u5fc5\u987b\u5047\u8bbe\u8282\u70b9\u53ef\u80fd\u4f1a\u5d29\u6e83\uff0c\u6240\u4ee5\u53ef\u9760\u7684\u5171\u8bc6\u662f\u4e0d\u53ef\u80fd\u7684\u3002</p> <ul> <li>FLP \u7ed3\u679c\u662f\u5728 \u5f02\u6b65\u7cfb\u7edf\u6a21\u578b \u4e2d\u88ab\u8bc1\u660e\u7684\uff08\u8bf7\u53c2\u9605 \u201c\u7cfb\u7edf\u6a21\u578b\u4e0e\u73b0\u5b9e\u201d\uff09\uff0c\u800c\u8fd9\u662f\u4e00\u79cd\u9650\u5236\u6027\u5f88\u5f3a\u7684\u6a21\u578b\uff0c\u5b83\u5047\u5b9a\u786e\u5b9a\u6027\u7b97\u6cd5\u4e0d\u80fd\u4f7f\u7528\u4efb\u4f55\u65f6\u949f\u6216\u8d85\u65f6\u3002</li> <li>\u5982\u679c\u5141\u8bb8\u7b97\u6cd5\u4f7f\u7528 \u8d85\u65f6 \u6216\u5176\u4ed6\u65b9\u6cd5\u6765\u8bc6\u522b\u53ef\u7591\u7684\u5d29\u6e83\u8282\u70b9\uff08\u5373\u4f7f\u6000\u7591\u6709\u65f6\u662f\u9519\u8bef\u7684\uff09\uff0c\u5219\u5171\u8bc6\u53d8\u4e3a\u4e00\u4e2a\u53ef\u89e3\u7684\u95ee\u9898\u301067\u3011\u3002\u5373\u4f7f\u4ec5\u4ec5\u5141\u8bb8\u7b97\u6cd5\u4f7f\u7528\u968f\u673a\u6570\uff0c\u4e5f\u8db3\u4ee5\u7ed5\u8fc7\u8fd9\u4e2a\u4e0d\u53ef\u80fd\u7684\u7ed3\u679c\u301069\u3011\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_29","title":"\u539f\u5b50\u63d0\u4ea4\u4e0e\u4e24\u9636\u6bb5\u63d0\u4ea4","text":"<p>\u539f\u5b50\u6027\u53ef\u4ee5\u9632\u6b62\u5931\u8d25\u7684\u4e8b\u52a1\u6405\u4e71\u6570\u636e\u5e93\uff0c\u907f\u514d\u6570\u636e\u5e93\u9677\u5165\u534a\u6210\u54c1\u7ed3\u679c\u548c\u534a\u66f4\u65b0\u72b6\u6001\u3002\u8fd9\u5bf9\u4e8e\u591a\u5bf9\u8c61\u4e8b\u52a1\uff08\u8bf7\u53c2\u9605 \u201c\u5355\u5bf9\u8c61\u548c\u591a\u5bf9\u8c61\u64cd\u4f5c\u201d\uff09\u548c\u7ef4\u62a4\u6b21\u7ea7\u7d22\u5f15\u7684\u6570\u636e\u5e93\u5c24\u5176\u91cd\u8981\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_30","title":"\u4ece\u5355\u8282\u70b9\u5230\u5206\u5e03\u5f0f\u539f\u5b50\u63d0\u4ea4","text":"<p>\u5355\u4e2a\u6570\u636e\u5e93\u8282\u70b9\u6267\u884c\u7684\u4e8b\u52a1\uff0c\u539f\u5b50\u6027\u901a\u5e38\u7531\u5b58\u50a8\u5f15\u64ce\u5b9e\u73b0\uff1a</p> <ul> <li>\u5f53\u5ba2\u6237\u7aef\u8bf7\u6c42\u6570\u636e\u5e93\u8282\u70b9\u63d0\u4ea4\u4e8b\u52a1\u65f6\uff0c\u6570\u636e\u5e93\u5c06\u4f7f\u4e8b\u52a1\u7684\u5199\u5165\u6301\u4e45\u5316\uff08\u901a\u5e38\u5728\u9884\u5199\u5f0f\u65e5\u5fd7\u4e2d\uff0c\u8bf7\u53c2\u9605 \u201c\u8ba9 B \u6811\u66f4\u53ef\u9760\u201d\uff09\uff0c\u7136\u540e\u5c06\u63d0\u4ea4\u8bb0\u5f55\u8ffd\u52a0\u5230\u78c1\u76d8\u4e2d\u7684\u65e5\u5fd7\u91cc\u3002</li> <li>\u5982\u679c\u6570\u636e\u5e93\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u95f4\u5d29\u6e83\uff0c\u5f53\u8282\u70b9\u91cd\u542f\u65f6\uff0c\u4e8b\u52a1\u4f1a\u4ece\u65e5\u5fd7\u4e2d\u6062\u590d\uff1a\u5982\u679c\u63d0\u4ea4\u8bb0\u5f55\u5728\u5d29\u6e83\u4e4b\u524d\u6210\u529f\u5730\u5199\u5165\u78c1\u76d8\uff0c\u5219\u8ba4\u4e3a\u4e8b\u52a1\u88ab\u63d0\u4ea4\uff1b\u5426\u5219\u6765\u81ea\u8be5\u4e8b\u52a1\u7684\u4efb\u4f55\u5199\u5165\u90fd\u88ab\u56de\u6eda\u3002</li> </ul> <p>\u5728\u5355\u4e2a\u8282\u70b9\u4e0a\uff0c\u4e8b\u52a1\u7684\u63d0\u4ea4\u4e3b\u8981\u53d6\u51b3\u4e8e\u6570\u636e\u6301\u4e45\u5316\u843d\u76d8\u7684 \u987a\u5e8f\uff1a\u9996\u5148\u662f\u6570\u636e\uff0c\u7136\u540e\u662f\u63d0\u4ea4\u8bb0\u5f55\u301072\u3011\u3002</p> <p>\u5982\u679c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u6d89\u53ca\u591a\u4e2a\u8282\u70b9\uff0c\u4ec5\u5411\u6240\u6709\u8282\u70b9\u53d1\u9001\u63d0\u4ea4\u8bf7\u6c42\u5e76\u72ec\u7acb\u63d0\u4ea4\u6bcf\u4e2a\u8282\u70b9\u7684\u4e8b\u52a1\u662f\u4e0d\u591f\u7684\u3002\u63d0\u4ea4\u5728\u67d0\u4e9b\u8282\u70b9\u4e0a\u6210\u529f\uff0c\u800c\u5728\u5176\u4ed6\u8282\u70b9\u4e0a\u5931\u8d25\uff1a</p> <ul> <li>\u67d0\u4e9b\u8282\u70b9\u53ef\u80fd\u4f1a\u68c0\u6d4b\u5230\u8fdd\u53cd\u7ea6\u675f\u6216\u51b2\u7a81\uff0c\u56e0\u6b64\u9700\u8981\u4e2d\u6b62\uff0c\u800c\u5176\u4ed6\u8282\u70b9\u5219\u53ef\u4ee5\u6210\u529f\u8fdb\u884c\u63d0\u4ea4\u3002</li> <li>\u67d0\u4e9b\u63d0\u4ea4\u8bf7\u6c42\u53ef\u80fd\u5728\u7f51\u7edc\u4e2d\u4e22\u5931\uff0c\u6700\u7ec8\u7531\u4e8e\u8d85\u65f6\u800c\u4e2d\u6b62\uff0c\u800c\u5176\u4ed6\u63d0\u4ea4\u8bf7\u6c42\u5219\u901a\u8fc7\u3002</li> <li>\u5728\u63d0\u4ea4\u8bb0\u5f55\u5b8c\u5168\u5199\u5165\u4e4b\u524d\uff0c\u67d0\u4e9b\u8282\u70b9\u53ef\u80fd\u4f1a\u5d29\u6e83\uff0c\u5e76\u5728\u6062\u590d\u65f6\u56de\u6eda\uff0c\u800c\u5176\u4ed6\u8282\u70b9\u5219\u6210\u529f\u63d0\u4ea4\u3002</li> </ul> <p>\u4e8b\u52a1\u63d0\u4ea4\u5fc5\u987b\u662f\u4e0d\u53ef\u64a4\u9500\u7684 \u2014\u2014 \u4e8b\u52a1\u63d0\u4ea4\u4e4b\u540e\uff0c\u4f60\u4e0d\u80fd\u6539\u53d8\u4e3b\u610f\uff0c\u5e76\u8ffd\u6eaf\u6027\u5730\u4e2d\u6b62\u4e8b\u52a1\u3002</p> <ul> <li>\u4e00\u65e6\u6570\u636e\u88ab\u63d0\u4ea4\uff0c\u5176\u7ed3\u679c\u5c31\u5bf9\u5176\u4ed6\u4e8b\u52a1\u53ef\u89c1\uff0c\u56e0\u6b64\u5176\u4ed6\u5ba2\u6237\u7aef\u53ef\u80fd\u4f1a\u5f00\u59cb\u4f9d\u8d56\u8fd9\u4e9b\u6570\u636e\u3002</li> <li>\u5982\u679c\u4e00\u4e2a\u4e8b\u52a1\u5728\u63d0\u4ea4\u540e\u88ab\u5141\u8bb8\u4e2d\u6b62\uff0c\u6240\u6709\u90a3\u4e9b\u8bfb\u53d6\u4e86 \u5df2\u63d0\u4ea4\u5374\u53c8\u88ab\u8ffd\u6eaf\u58f0\u660e\u4e0d\u5b58\u5728\u6570\u636e \u7684\u4e8b\u52a1\u4e5f\u5fc5\u987b\u56de\u6eda\u3002</li> </ul> <p>\u63d0\u4ea4\u4e8b\u52a1\u7684\u7ed3\u679c\u6709\u53ef\u80fd\u901a\u8fc7\u4e8b\u540e\u6267\u884c\u53e6\u4e00\u4e2a\u8865\u507f\u4e8b\u52a1\uff08compensating transaction\uff09\u6765\u53d6\u6d88\u301073,74\u3011\uff0c\u4f46\u4ece\u6570\u636e\u5e93\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u8fd9\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u4e8b\u52a1\uff0c\u56e0\u6b64\u4efb\u4f55\u5173\u4e8e\u8de8\u4e8b\u52a1\u6b63\u786e\u6027\u7684\u4fdd\u8bc1\u90fd\u662f\u5e94\u7528\u81ea\u5df1\u7684\u95ee\u9898\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_31","title":"\u4e24\u9636\u6bb5\u63d0\u4ea4","text":"<p>\u4e24\u9636\u6bb5\u63d0\u4ea4\uff08two-phase commit\uff09 \u662f\u4e00\u79cd\u7528\u4e8e\u5b9e\u73b0\u8de8\u591a\u4e2a\u8282\u70b9\u7684\u539f\u5b50\u4e8b\u52a1\u63d0\u4ea4\u7684\u7b97\u6cd5\uff0c\u5373\u786e\u4fdd\u6240\u6709\u8282\u70b9\u63d0\u4ea4\u6216\u6240\u6709\u8282\u70b9\u4e2d\u6b62\u3002\u5b83\u662f\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u4e2d\u7684\u7ecf\u5178\u7b97\u6cd5\u301013,35,75\u3011\u3002</p> <ul> <li>2PC \u5728\u67d0\u4e9b\u6570\u636e\u5e93\u5185\u90e8\u4f7f\u7528\uff0c\u4e5f\u4ee5 XA \u4e8b\u52a1 \u7684\u5f62\u5f0f\u5bf9\u5e94\u7528\u53ef\u7528\u301076,77\u3011\uff08\u4f8b\u5982 Java Transaction API \u652f\u6301\uff09\u6216\u4ee5 SOAP Web \u670d\u52a1\u7684 <code>WS-AtomicTransaction</code> \u5f62\u5f0f\u63d0\u4f9b\u7ed9\u5e94\u7528\u301078,79\u3011\u3002</li> </ul> <p>\u4e0b\u56fe9-9 \u8bf4\u660e\u4e86 2PC \u7684\u57fa\u672c\u6d41\u7a0b\u30022PC \u4e2d\u7684\u63d0\u4ea4 / \u4e2d\u6b62\u8fc7\u7a0b\u5206\u4e3a\u4e24\u4e2a\u9636\u6bb5</p> <p></p> \u56fe 9-9 \u4e24\u9636\u6bb5\u63d0\u4ea4\uff082PC\uff09\u7684\u6210\u529f\u6267\u884c <p>2PC \u4f7f\u7528\u4e00\u4e2a\u901a\u5e38\u4e0d\u4f1a\u51fa\u73b0\u5728\u5355\u8282\u70b9\u4e8b\u52a1\u4e2d\u7684\u65b0\u7ec4\u4ef6\uff1a\u534f\u8c03\u8005\uff08coordinator\uff0c\u4e5f\u79f0\u4e3a \u4e8b\u52a1\u7ba1\u7406\u5668\uff0c\u5373 transaction manager\uff09\u3002</p> <ul> <li>\u534f\u8c03\u8005\u901a\u5e38\u5728\u8bf7\u6c42\u4e8b\u52a1\u7684\u76f8\u540c\u5e94\u7528\u8fdb\u7a0b\u4e2d\u4ee5\u5e93\u7684\u5f62\u5f0f\u5b9e\u73b0\uff08\u4f8b\u5982\uff0c\u5d4c\u5165\u5728 Java EE \u5bb9\u5668\u4e2d\uff09\uff0c\u4f46\u4e5f\u53ef\u4ee5\u662f\u5355\u72ec\u7684\u8fdb\u7a0b\u6216\u670d\u52a1\u3002\u8fd9\u79cd\u534f\u8c03\u8005\u7684\u4f8b\u5b50\u5305\u62ec Narayana\u3001JOTM\u3001BTM \u6216 MSDTC\u3002</li> </ul> <p>2PC \u4e8b\u52a1\u4ee5\u5e94\u7528\u5728\u591a\u4e2a\u6570\u636e\u5e93\u8282\u70b9\uff08\u79f0\u4e3a\u53c2\u4e0e\u8005\uff08participants\uff09\uff09\u4e0a\u8bfb\u5199\u6570\u636e\u5f00\u59cb\u3002\u5f53\u5e94\u7528\u51c6\u5907\u63d0\u4ea4\u65f6\uff0c\u534f\u8c03\u8005\u5f00\u59cb\u9636\u6bb5 1\uff1a\u53d1\u9001\u4e00\u4e2a \u51c6\u5907\uff08prepare\uff09 \u8bf7\u6c42\u5230\u6bcf\u4e2a\u8282\u70b9\uff0c\u8be2\u95ee\u5b83\u4eec\u662f\u5426\u80fd\u591f\u63d0\u4ea4\u3002\u7136\u540e\u534f\u8c03\u8005\u4f1a\u8ddf\u8e2a\u53c2\u4e0e\u8005\u7684\u54cd\u5e94\uff1a</p> <ul> <li>\u5982\u679c\u6240\u6709\u53c2\u4e0e\u8005\u90fd\u56de\u7b54 \u201c\u662f\u201d\uff0c\u8868\u793a\u5b83\u4eec\u5df2\u7ecf\u51c6\u5907\u597d\u63d0\u4ea4\uff0c\u90a3\u4e48\u534f\u8c03\u8005\u5728\u9636\u6bb5 2 \u53d1\u51fa \u63d0\u4ea4\uff08commit\uff09 \u8bf7\u6c42\uff0c\u7136\u540e\u63d0\u4ea4\u771f\u6b63\u53d1\u751f\u3002</li> <li>\u5982\u679c\u4efb\u610f\u4e00\u4e2a\u53c2\u4e0e\u8005\u56de\u590d\u4e86 \u201c\u5426\u201d\uff0c\u5219\u534f\u8c03\u8005\u5728\u9636\u6bb5 2 \u4e2d\u5411\u6240\u6709\u8282\u70b9\u53d1\u9001 \u4e2d\u6b62\uff08abort\uff09 \u8bf7\u6c42\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#2pc2pl","title":"\u4e0d\u8981\u628a2PC\u548c2PL\u641e\u6df7\u4e86","text":"<p>\u4e24\u9636\u6bb5\u63d0\u4ea4\uff082PC\uff09\u548c\u4e24\u9636\u6bb5\u9501\u5b9a\uff08\u8bf7\u53c2\u9605 \u201c\u4e24\u9636\u6bb5\u9501\u5b9a\u201d\uff09\u662f\u4e24\u4e2a\u5b8c\u5168\u4e0d\u540c\u7684\u4e1c\u897f\u30022PC \u5728\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u4e2d\u63d0\u4f9b\u539f\u5b50\u63d0\u4ea4\uff0c\u800c 2PL \u63d0\u4f9b\u53ef\u4e32\u884c\u5316\u7684\u9694\u79bb\u7b49\u7ea7\u3002\u4e3a\u4e86\u907f\u514d\u6df7\u6dc6\uff0c\u6700\u597d\u628a\u5b83\u4eec\u770b\u4f5c\u5b8c\u5168\u72ec\u7acb\u7684\u6982\u5ff5\uff0c\u5e76\u5ffd\u7565\u540d\u79f0\u4e2d\u4e0d\u5e78\u7684\u76f8\u4f3c\u6027\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_32","title":"\u7cfb\u7edf\u627f\u8bfa","text":"<p>\u5de5\u4f5c\u539f\u7406\uff1a</p> <ul> <li>\u5f53\u5e94\u7528\u60f3\u8981\u542f\u52a8\u4e00\u4e2a\u5206\u5e03\u5f0f\u4e8b\u52a1\u65f6\uff0c\u5b83\u5411\u534f\u8c03\u8005\u8bf7\u6c42\u4e00\u4e2a\u4e8b\u52a1 ID\u3002\u6b64\u4e8b\u52a1 ID \u662f\u5168\u5c40\u552f\u4e00\u7684\u3002</li> <li>\u5e94\u7528\u5728\u6bcf\u4e2a\u53c2\u4e0e\u8005\u4e0a\u542f\u52a8\u5355\u8282\u70b9\u4e8b\u52a1\uff0c\u5e76\u5728\u5355\u8282\u70b9\u4e8b\u52a1\u4e0a\u634e\u5e26\u4e0a\u8fd9\u4e2a\u5168\u5c40\u4e8b\u52a1 ID\u3002\u6240\u6709\u7684\u8bfb\u5199\u90fd\u662f\u5728\u8fd9\u4e9b\u5355\u8282\u70b9\u4e8b\u52a1\u4e2d\u5404\u81ea\u5b8c\u6210\u7684\u3002\u5982\u679c\u5728\u8fd9\u4e2a\u9636\u6bb5\u51fa\u73b0\u4efb\u4f55\u95ee\u9898\uff08\u4f8b\u5982\uff0c\u8282\u70b9\u5d29\u6e83\u6216\u8bf7\u6c42\u8d85\u65f6\uff09\uff0c\u5219\u534f\u8c03\u8005\u6216\u4efb\u4f55\u53c2\u4e0e\u8005\u90fd\u53ef\u4ee5\u4e2d\u6b62\u3002</li> <li>\u5f53\u5e94\u7528\u51c6\u5907\u63d0\u4ea4\u65f6\uff0c\u534f\u8c03\u8005\u5411\u6240\u6709\u53c2\u4e0e\u8005\u53d1\u9001\u4e00\u4e2a \u51c6\u5907 \u8bf7\u6c42\uff0c\u5e76\u6253\u4e0a\u5168\u5c40\u4e8b\u52a1 ID \u7684\u6807\u8bb0\u3002\u5982\u679c\u4efb\u610f\u4e00\u4e2a\u8bf7\u6c42\u5931\u8d25\u6216\u8d85\u65f6\uff0c\u5219\u534f\u8c03\u8005\u5411\u6240\u6709\u53c2\u4e0e\u8005\u53d1\u9001\u9488\u5bf9\u8be5\u4e8b\u52a1 ID \u7684\u4e2d\u6b62\u8bf7\u6c42\u3002</li> <li>\u53c2\u4e0e\u8005\u6536\u5230\u51c6\u5907\u8bf7\u6c42\u65f6\uff0c\u9700\u8981\u786e\u4fdd\u5728\u4efb\u610f\u60c5\u51b5\u4e0b\u90fd\u7684\u786e\u53ef\u4ee5\u63d0\u4ea4\u4e8b\u52a1\u3002</li> <li>\u5305\u62ec\u5c06\u6240\u6709\u4e8b\u52a1\u6570\u636e\u5199\u5165\u78c1\u76d8\uff08\u51fa\u73b0\u5d29\u6e83\u3001\u7535\u6e90\u6545\u969c\u6216\u786c\u76d8\u7a7a\u95f4\u4e0d\u8db3\u90fd\u4e0d\u80fd\u662f\u7a0d\u540e\u62d2\u7edd\u63d0\u4ea4\u7684\u7406\u7531\uff09\u4ee5\u53ca\u68c0\u67e5\u662f\u5426\u5b58\u5728\u4efb\u4f55\u51b2\u7a81\u6216\u8fdd\u53cd\u7ea6\u675f\uff1b</li> <li>\u901a\u8fc7\u5411\u534f\u8c03\u8005\u56de\u7b54 \u201c\u662f\u201d\uff0c\u8282\u70b9\u627f\u8bfa\uff0c\u53ea\u8981\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u4e8b\u52a1\u4e00\u5b9a\u53ef\u4ee5\u4e0d\u51fa\u5dee\u9519\u5730\u63d0\u4ea4\u3002</li> <li>\u5f53\u534f\u8c03\u8005\u6536\u5230\u6240\u6709\u51c6\u5907\u8bf7\u6c42\u7684\u7b54\u590d\u65f6\uff0c\u4f1a\u5c31\u63d0\u4ea4\u6216\u4e2d\u6b62\u4e8b\u52a1\u4f5c\u51fa\u660e\u786e\u7684\u51b3\u5b9a\uff08\u53ea\u6709\u5728\u6240\u6709\u53c2\u4e0e\u8005\u6295\u8d5e\u6210\u7968\u7684\u60c5\u51b5\u4e0b\u624d\u4f1a\u63d0\u4ea4\uff09\u3002</li> <li>\u534f\u8c03\u8005\u5fc5\u987b\u628a\u8fd9\u4e2a\u51b3\u5b9a\u5199\u5230\u78c1\u76d8\u4e0a\u7684\u4e8b\u52a1\u65e5\u5fd7\u4e2d\uff0c\u5982\u679c\u5b83\u968f\u540e\u5c31\u5d29\u6e83\uff0c\u6062\u590d\u540e\u4e5f\u80fd\u77e5\u9053\u81ea\u5df1\u6240\u505a\u7684\u51b3\u5b9a\u3002\u8fd9\u88ab\u79f0\u4e3a \u63d0\u4ea4\u70b9\uff08commit point\uff09\u3002</li> <li>\u4e00\u65e6\u534f\u8c03\u8005\u7684\u51b3\u5b9a\u843d\u76d8\uff0c\u63d0\u4ea4\u6216\u4e2d\u6b62\u8bf7\u6c42\u4f1a\u53d1\u9001\u7ed9\u6240\u6709\u53c2\u4e0e\u8005\u3002\u5982\u679c\u8fd9\u4e2a\u8bf7\u6c42\u5931\u8d25\u6216\u8d85\u65f6\uff0c\u534f\u8c03\u8005\u5fc5\u987b\u6c38\u8fdc\u4fdd\u6301\u91cd\u8bd5\uff0c\u76f4\u5230\u6210\u529f\u4e3a\u6b62\u3002\u5982\u679c\u53c2\u4e0e\u8005\u5728\u6b64\u671f\u95f4\u5d29\u6e83\uff0c\u4e8b\u52a1\u5c06\u5728\u5176\u6062\u590d\u540e\u63d0\u4ea4 \u2014\u2014 \u7531\u4e8e\u53c2\u4e0e\u8005\u6295\u4e86\u8d5e\u6210\uff0c\u56e0\u6b64\u6062\u590d\u540e\u5b83\u4e0d\u80fd\u62d2\u7edd\u63d0\u4ea4\u3002</li> </ul> <p>\u8be5\u534f\u8bae\u5305\u542b\u4e24\u4e2a\u5173\u952e\u7684 \u201c\u4e0d\u5f52\u8def\u201d \u70b9\uff1a\u4fdd\u8bc1\u4e86 2PC \u7684\u539f\u5b50\u6027</p> <ul> <li>\u5f53\u53c2\u4e0e\u8005\u6295\u7968 \u201c\u662f\u201d \u65f6\uff0c\u5b83\u627f\u8bfa\u5b83\u7a0d\u540e\u80af\u5b9a\u80fd\u591f\u63d0\u4ea4\uff08\u5c3d\u7ba1\u534f\u8c03\u8005\u53ef\u80fd\u4ecd\u7136\u9009\u62e9\u653e\u5f03\uff09\uff1b</li> <li>\u4e00\u65e6\u534f\u8c03\u8005\u505a\u51fa\u51b3\u5b9a\uff0c\u8fd9\u4e00\u51b3\u5b9a\u662f\u4e0d\u53ef\u64a4\u9500\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_33","title":"\u534f\u8c03\u8005\u5931\u6548","text":"<p>\u5982\u679c\u534f\u8c03\u8005\u5728\u53d1\u9001 \u51c6\u5907 \u8bf7\u6c42\u4e4b\u524d\u5931\u8d25\uff0c\u53c2\u4e0e\u8005\u53ef\u4ee5\u5b89\u5168\u5730\u4e2d\u6b62\u4e8b\u52a1\u3002\u4e00\u65e6\u53c2\u4e0e\u8005\u6536\u5230\u4e86\u51c6\u5907\u8bf7\u6c42\u5e76\u6295\u4e86 \u201c\u662f\u201d\uff0c\u5c31\u4e0d\u80fd\u518d\u5355\u65b9\u9762\u653e\u5f03\uff1a\u5fc5\u987b\u7b49\u5f85\u534f\u8c03\u8005\u56de\u7b54\u4e8b\u52a1\u662f\u5426\u5df2\u7ecf\u63d0\u4ea4\u6216\u4e2d\u6b62</p> <ul> <li>\u679c\u6b64\u65f6\u534f\u8c03\u8005\u5d29\u6e83\u6216\u7f51\u7edc\u51fa\u73b0\u6545\u969c\uff0c\u53c2\u4e0e\u8005\u4ec0\u4e48\u4e5f\u505a\u4e0d\u4e86\u53ea\u80fd\u7b49\u5f85\u3002\u53c2\u4e0e\u8005\u7684\u8fd9\u79cd\u4e8b\u52a1\u72b6\u6001\u79f0\u4e3a \u5b58\u7591\uff08in doubt\uff09 \u7684\u6216 \u4e0d\u786e\u5b9a\uff08uncertain\uff09 \u7684</li> </ul> <p>\u5982\u4e0b\u56fe9-10\u6240\u793a\u3002\u534f\u8c03\u8005\u5b9e\u9645\u4e0a\u51b3\u5b9a\u63d0\u4ea4\uff0c\u6570\u636e\u5e93 2 \u6536\u5230\u63d0\u4ea4\u8bf7\u6c42\u3002\u4f46\u662f\uff0c\u534f\u8c03\u8005\u5728\u5c06\u63d0\u4ea4\u8bf7\u6c42\u53d1\u9001\u5230\u6570\u636e\u5e93 1 \u4e4b\u524d\u53d1\u751f\u5d29\u6e83\uff0c\u56e0\u6b64\u6570\u636e\u5e93 1 \u4e0d\u77e5\u9053\u662f\u5426\u63d0\u4ea4\u6216\u4e2d\u6b62\u3002</p> <ul> <li>\u5373\u4f7f \u8d85\u65f6 \u5728\u8fd9\u91cc\u4e5f\u6ca1\u6709\u5e2e\u52a9\uff1a\u5982\u679c\u6570\u636e\u5e93 1 \u5728\u8d85\u65f6\u540e\u5355\u65b9\u9762\u4e2d\u6b62\uff0c\u5b83\u5c06\u6700\u7ec8\u4e0e\u6267\u884c\u63d0\u4ea4\u7684\u6570\u636e\u5e93 2 \u4e0d\u4e00\u81f4\u3002\u540c\u6837\uff0c\u5355\u65b9\u9762\u63d0\u4ea4\u4e5f\u662f\u4e0d\u5b89\u5168\u7684\uff0c\u56e0\u4e3a\u53e6\u4e00\u4e2a\u53c2\u4e0e\u8005\u53ef\u80fd\u5df2\u7ecf\u4e2d\u6b62\u4e86\u3002</li> </ul> <p></p> \u56fe 9-10 \u53c2\u4e0e\u8005\u6295\u8d5e\u6210\u7968\u540e\uff0c\u534f\u8c03\u8005\u5d29\u6e83\u3002\u6570\u636e\u5e93 1 \u4e0d\u77e5\u9053\u662f\u5426\u63d0\u4ea4\u6216\u4e2d\u6b62 <p>\u539f\u5219\u4e0a\u53c2\u4e0e\u8005\u53ef\u4ee5\u76f8\u4e92\u6c9f\u901a\uff0c\u627e\u51fa\u6bcf\u4e2a\u53c2\u4e0e\u8005\u662f\u5982\u4f55\u6295\u7968\u7684\uff0c\u5e76\u8fbe\u6210\u4e00\u81f4\uff0c\u4f46\u8fd9\u4e0d\u662f 2PC \u534f\u8bae\u7684\u4e00\u90e8\u5206\u3002</p> <p>\u53ef\u4ee5\u5b8c\u6210 2PC \u7684\u552f\u4e00\u65b9\u6cd5\u662f\u7b49\u5f85\u534f\u8c03\u8005\u6062\u590d\u30022PC \u7684 \u63d0\u4ea4\u70b9 \u5f52\u7ed3\u4e3a\u534f\u8c03\u8005\u4e0a\u7684\u5e38\u89c4\u5355\u8282\u70b9\u539f\u5b50\u63d0\u4ea4\u3002</p> <ul> <li>\u534f\u8c03\u8005\u5fc5\u987b\u5728\u5411\u53c2\u4e0e\u8005\u53d1\u9001\u63d0\u4ea4\u6216\u4e2d\u6b62\u8bf7\u6c42\u4e4b\u524d\uff0c\u5c06\u5176\u63d0\u4ea4\u6216\u4e2d\u6b62\u51b3\u5b9a\u5199\u5165\u78c1\u76d8\u4e0a\u7684\u4e8b\u52a1\u65e5\u5fd7\uff1a\u534f\u8c03\u8005\u6062\u590d\u540e\uff0c\u901a\u8fc7\u8bfb\u53d6\u5176\u4e8b\u52a1\u65e5\u5fd7\u6765\u786e\u5b9a\u6240\u6709\u5b58\u7591\u4e8b\u52a1\u7684\u72b6\u6001\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_34","title":"\u4e09\u9636\u6bb5\u63d0\u4ea4","text":"<p>\u4e24\u9636\u6bb5\u63d0\u4ea4\u88ab\u79f0\u4e3a \u963b\u585e\uff08blocking\uff09- \u539f\u5b50\u63d0\u4ea4\u534f\u8bae\uff0c\u56e0\u4e3a\u5b58\u5728 2PC \u53ef\u80fd\u5361\u4f4f\u5e76\u7b49\u5f85\u534f\u8c03\u8005\u6062\u590d\u7684\u60c5\u51b5\u3002</p> <p>\u4e09\u9636\u6bb5\u63d0\u4ea4\uff083PC\uff09 \u7684\u7b97\u6cd5\u301013,80\u3011\uff0c\u5047\u5b9a\u7f51\u7edc\u5ef6\u8fdf\u6709\u754c\uff0c\u8282\u70b9\u54cd\u5e94\u65f6\u95f4\u6709\u9650\uff1b</p> <ul> <li>\u5728\u5927\u591a\u6570\u5177\u6709\u65e0\u9650\u7f51\u7edc\u5ef6\u8fdf\u548c\u8fdb\u7a0b\u6682\u505c\u7684\u5b9e\u9645\u7cfb\u7edf\u4e2d\uff08\u89c1 \u7b2c\u516b\u7ae0\uff09\uff0c\u5b83\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u539f\u5b50\u6027\u3002</li> </ul> <p>\u975e\u963b\u585e\u539f\u5b50\u63d0\u4ea4\u9700\u8981\u4e00\u4e2a \u5b8c\u7f8e\u7684\u6545\u969c\u68c0\u6d4b\u5668\uff08perfect failure detector\uff09\u301067,71\u3011\u2014\u2014 \u5373\u4e00\u4e2a\u53ef\u9760\u7684\u673a\u5236\u6765\u5224\u65ad\u4e00\u4e2a\u8282\u70b9\u662f\u5426\u5df2\u7ecf\u5d29\u6e83\u3002</p> <ul> <li> <p>\u5728\u5177\u6709\u65e0\u9650\u5ef6\u8fdf\u7684\u7f51\u7edc\u4e2d\uff0c\u8d85\u65f6\u5e76\u4e0d\u662f\u4e00\u79cd\u53ef\u9760\u7684\u6545\u969c\u68c0\u6d4b\u673a\u5236\uff0c\u56e0\u4e3a\u5373\u4f7f\u6ca1\u6709\u8282\u70b9\u5d29\u6e83\uff0c\u8bf7\u6c42\u4e5f\u53ef\u80fd\u7531\u4e8e\u7f51\u7edc\u95ee\u9898\u800c\u8d85\u65f6\u3002</p> </li> <li> <p>\u51fa\u4e8e\u8fd9\u4e2a\u539f\u56e0\uff0c2PC \u4ecd\u7136\u88ab\u4f7f\u7528\uff0c\u5c3d\u7ba1\u5927\u5bb6\u90fd\u6e05\u695a\u53ef\u80fd\u5b58\u5728\u534f\u8c03\u8005\u6545\u969c\u7684\u95ee\u9898\u3002</p> </li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_35","title":"\u5b9e\u8df5\u4e2d\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1","text":"<p>\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u540d\u58f0\u6bc1\u8a89\u53c2\u534a\uff0c\u5c24\u5176\u662f\u90a3\u4e9b\u901a\u8fc7\u4e24\u9636\u6bb5\u63d0\u4ea4\u5b9e\u73b0\u7684\u3002\u8bb8\u591a\u4e91\u670d\u52a1\u7531\u4e8e\u5176\u5bfc\u81f4\u7684\u8fd0\u7ef4\u95ee\u9898\uff0c\u800c\u9009\u62e9\u4e0d\u5b9e\u73b0\u5206\u5e03\u5f0f\u4e8b\u52a1\u301085,86\u3011\u3002</p> <ul> <li>\u4e24\u9636\u6bb5\u88ab\u89c6\u4f5c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u96be\u4ee5\u5b9e\u73b0\u7684\u91cd\u8981\u7684\u5b89\u5168\u6027\u4fdd\u8bc1\uff1b</li> <li>\u5bfc\u81f4\u8fd0\u7ef4\u95ee\u9898\uff0c\u9020\u6210\u6027\u80fd\u4e0b\u964d\uff0c\u505a\u51fa\u8d85\u8fc7\u80fd\u529b\u8303\u56f4\u7684\u627f\u8bfa\u800c\u9971\u53d7\u6279\u8bc4\u301081,82,83,84\u3011\u3002</li> </ul> <p>\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u67d0\u4e9b\u5b9e\u73b0\u4f1a\u5e26\u6765\u4e25\u91cd\u7684\u6027\u80fd\u635f\u5931\uff1a</p> <ul> <li>MySQL \u4e2d\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u6bd4\u5355\u8282\u70b9\u4e8b\u52a1\u6162 10 \u500d\u4ee5\u4e0a\u301087\u3011\uff1b</li> <li>\u4e24\u9636\u6bb5\u63d0\u4ea4\u6240\u56fa\u6709\u7684\u6027\u80fd\u6210\u672c\uff0c\u5927\u90e8\u5206\u662f\u7531\u4e8e\u5d29\u6e83\u6062\u590d\u6240\u9700\u7684\u989d\u5916\u5f3a\u5236\u5237\u76d8\uff08<code>fsync</code>\uff09\u301088\u3011\u4ee5\u53ca\u989d\u5916\u7684\u7f51\u7edc\u5f80\u8fd4\u3002</li> </ul> <p>\u4e24\u79cd\u622a\u7136\u4e0d\u540c\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u7c7b\u578b\u7ecf\u5e38\u88ab\u6df7\u6dc6\uff1a</p> <ul> <li>\u6570\u636e\u5e93\u5185\u90e8\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\uff1a\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u652f\u6301\u6570\u636e\u5e93\u8282\u70b9\u4e4b\u95f4\u7684\u5185\u90e8\u4e8b\u52a1\uff0c\u5982VoltDB\u548c MySQL Cluster\u3002\u6240\u6709\u53c2\u4e0e\u4e8b\u52a1\u7684\u8282\u70b9\u90fd\u8fd0\u884c\u76f8\u540c\u7684\u6570\u636e\u5e93\u8f6f\u4ef6\u3002</li> <li>\u5f02\u6784\u5206\u5e03\u5f0f\u4e8b\u52a1\uff1a\u53c2\u4e0e\u8005\u662f\u7531\u4e24\u79cd\u6216\u4e24\u79cd\u4ee5\u4e0a\u7684\u4e0d\u540c\u6280\u672f\u7ec4\u6210\u3002\u8de8\u7cfb\u7edf\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u5fc5\u987b\u786e\u4fdd\u539f\u5b50\u63d0\u4ea4\u3002</li> </ul> <p>\u6570\u636e\u5e93\u5185\u90e8\u4e8b\u52a1\u4e0d\u5fc5\u4e0e\u4efb\u4f55\u5176\u4ed6\u7cfb\u7edf\u517c\u5bb9\uff0c\u56e0\u6b64\u5b83\u4eec\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55\u534f\u8bae\uff0c\u5e76\u80fd\u9488\u5bf9\u7279\u5b9a\u6280\u672f\u8fdb\u884c\u7279\u5b9a\u7684\u4f18\u5316\u3002\u56e0\u6b64\u6570\u636e\u5e93\u5185\u90e8\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u901a\u5e38\u5de5\u4f5c\u5730\u5f88\u597d\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u8de8\u5f02\u6784\u6280\u672f\u7684\u4e8b\u52a1\u5219\u66f4\u6709\u6311\u6218\u6027\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_36","title":"\u6070\u597d\u4e00\u6b21\u7684\u6d88\u606f\u5904\u7406","text":"<p>\u5f02\u6784\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u5904\u7406\u80fd\u591f\u4ee5\u5f3a\u5927\u7684\u65b9\u5f0f\u96c6\u6210\u4e0d\u540c\u7684\u7cfb\u7edf\u3002\u4f8b\u5982\uff1a\u6d88\u606f\u961f\u5217\u4e2d\u7684\u4e00\u6761\u6d88\u606f\u53ef\u4ee5\u88ab\u786e\u8ba4\u4e3a\u5df2\u5904\u7406\uff0c\u5f53\u4e14\u4ec5\u5f53\u7528\u4e8e\u5904\u7406\u6d88\u606f\u7684\u6570\u636e\u5e93\u4e8b\u52a1\u6210\u529f\u63d0\u4ea4\u3002</p> <ul> <li>\u901a\u8fc7\u5728\u540c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u539f\u5b50\u63d0\u4ea4 \u6d88\u606f\u786e\u8ba4 \u548c \u6570\u636e\u5e93\u5199\u5165 \u4e24\u4e2a\u64cd\u4f5c\u6765\u5b9e\u73b0\u3002</li> <li>\u5373\u4f7f\u6d88\u606f\u4ee3\u7406\u548c\u6570\u636e\u5e93\u662f\u5728\u4e0d\u540c\u673a\u5668\u4e0a\u8fd0\u884c\u7684\u4e24\u79cd\u4e0d\u76f8\u5173\u7684\u6280\u672f\u3002</li> </ul> <p>\u5982\u679c\u6d88\u606f\u4f20\u9012\u6216\u6570\u636e\u5e93\u4e8b\u52a1\u4efb\u610f\u4e00\u8005\u5931\u8d25\uff0c\u4e24\u8005\u90fd\u4f1a\u4e2d\u6b62\uff0c\u56e0\u6b64\u6d88\u606f\u4ee3\u7406\u53ef\u80fd\u4f1a\u5728\u7a0d\u540e\u5b89\u5168\u5730\u91cd\u4f20\u6d88\u606f\u3002</p> <ul> <li>\u901a\u8fc7\u539f\u5b50\u63d0\u4ea4 \u6d88\u606f\u5904\u7406\u53ca\u5176\u526f\u4f5c\u7528\uff0c\u5373\u4f7f\u5728\u6210\u529f\u4e4b\u524d\u9700\u8981\u51e0\u6b21\u91cd\u8bd5\uff0c\u4e5f\u53ef\u4ee5\u786e\u4fdd\u6d88\u606f\u88ab \u6709\u6548\u5730\uff08effectively\uff09 \u6070\u597d\u5904\u7406\u4e00\u6b21\u3002\u4e2d\u6b62\u4f1a\u629b\u5f03\u90e8\u5206\u5b8c\u6210\u4e8b\u52a1\u6240\u5bfc\u81f4\u7684\u4efb\u4f55\u526f\u4f5c\u7528\u3002</li> </ul> <p>\u53ea\u6709\u5f53\u6240\u6709\u53d7\u4e8b\u52a1\u5f71\u54cd\u7684\u7cfb\u7edf\u90fd\u4f7f\u7528\u540c\u6837\u7684 \u539f\u5b50\u63d0\u4ea4\u534f\u8bae\uff08atomic commit protocol\uff09 \u65f6\uff0c\u8fd9\u6837\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u624d\u662f\u53ef\u80fd\u7684\u3002\u5047\u8bbe\u5904\u7406\u6d88\u606f\u7684\u526f\u4f5c\u7528\u662f\u53d1\u9001\u4e00\u5c01\u90ae\u4ef6\uff0c\u800c\u90ae\u4ef6\u670d\u52a1\u5668\u5e76\u4e0d\u652f\u6301\u4e24\u9636\u6bb5\u63d0\u4ea4\uff1a</p> <ul> <li>\u5982\u679c\u6d88\u606f\u5904\u7406\u5931\u8d25\u5e76\u91cd\u8bd5\uff0c\u5219\u53ef\u80fd\u4f1a\u53d1\u9001\u4e24\u6b21\u6216\u66f4\u591a\u6b21\u7684\u90ae\u4ef6\u3002</li> <li>\u5982\u679c\u5904\u7406\u6d88\u606f\u7684\u6240\u6709\u526f\u4f5c\u7528\u90fd\u53ef\u4ee5\u5728\u4e8b\u52a1\u4e2d\u6b62\u65f6\u56de\u6eda\uff0c\u90a3\u4e48\u8fd9\u6837\u7684\u5904\u7406\u6d41\u7a0b\u5c31\u53ef\u4ee5\u5b89\u5168\u5730\u91cd\u8bd5\uff0c\u5c31\u597d\u50cf\u4ec0\u4e48\u90fd\u6ca1\u6709\u53d1\u751f\u8fc7\u4e00\u6837\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#xa","title":"XA\u4e8b\u52a1","text":"<p>X/Open XA\uff08\u6269\u5c55\u67b6\u6784\uff08eXtended Architecture\uff09 \u7684\u7f29\u5199\uff09\u662f\u8de8\u5f02\u6784\u6280\u672f\u5b9e\u73b0\u4e24\u9636\u6bb5\u63d0\u4ea4\u7684\u6807\u51c6\u301076,77\u3011\u3002</p> <ul> <li>\u8bb8\u591a\u4f20\u7edf\u5173\u7cfb\u6570\u636e\u5e93\uff08\u5305\u62ec PostgreSQL\u3001MySQL\u3001DB2\u3001SQL Server \u548c Oracle\uff09\u548c\u6d88\u606f\u4ee3\u7406\uff08\u5305\u62ec ActiveMQ\u3001HornetQ\u3001MSMQ \u548c IBM MQ\uff09 \u90fd\u652f\u6301 XA\u3002</li> </ul> <p>XA \u4e0d\u662f\u4e00\u4e2a\u7f51\u7edc\u534f\u8bae \u2014\u2014 \u5b83\u53ea\u662f\u4e00\u4e2a\u7528\u6765\u4e0e\u4e8b\u52a1\u534f\u8c03\u8005\u8fde\u63a5\u7684 C API\u3002</p> <ul> <li>Java EE \u4e2d\u7684 XA \u4e8b\u52a1\u662f\u4f7f\u7528 Java \u4e8b\u52a1 API\uff08JTA, Java Transaction API\uff09 \u5b9e\u73b0\uff0cJava \u6570\u636e\u5e93\u8fde\u63a5\uff08JDBC, Java Database Connectivity\uff09 \u7684\u6570\u636e\u5e93\u9a71\u52a8\uff0c\u4ee5\u53ca\u8bb8\u591a\u4f7f\u7528 Java \u6d88\u606f\u670d\u52a1\uff08JMS\uff09 API \u7684\u6d88\u606f\u4ee3\u7406\u90fd\u652f\u6301 Java \u4e8b\u52a1 API\uff08JTA\uff09\u3002</li> </ul> <p>XA \u5047\u5b9a\u4f60\u7684\u5e94\u7528\u4f7f\u7528\u7f51\u7edc\u9a71\u52a8\u6216\u5ba2\u6237\u7aef\u5e93\u6765\u4e0e \u53c2\u4e0e\u8005\uff08\u6570\u636e\u5e93\u6216\u6d88\u606f\u670d\u52a1\uff09\u8fdb\u884c\u901a\u4fe1\u3002</p> <ul> <li>\u9a71\u52a8\u6216\u5ba2\u6237\u7aef\u4f1a\u8c03\u7528 XA API \u4ee5\u67e5\u660e\u64cd\u4f5c\u662f\u5426\u4e3a\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u4e00\u90e8\u5206\u3002\u5982\u679c\u662f\uff0c\u5219\u5c06\u5fc5\u8981\u7684\u4fe1\u606f\u53d1\u5f80\u6570\u636e\u5e93\u670d\u52a1\u5668\uff1b</li> <li>\u9a71\u52a8\u8fd8\u4f1a\u5411\u534f\u8c03\u8005\u66b4\u9732\u56de\u8c03\u63a5\u53e3\uff0c\u534f\u8c03\u8005\u53ef\u4ee5\u901a\u8fc7\u56de\u8c03\u6765\u8981\u6c42\u53c2\u4e0e\u8005\u51c6\u5907\u3001\u63d0\u4ea4\u6216\u4e2d\u6b62\u3002</li> </ul> <p>\u4e8b\u52a1\u534f\u8c03\u8005\u9700\u8981\u5b9e\u73b0 XA API\u3002\u6807\u51c6\u6ca1\u6709\u6307\u660e\u5e94\u8be5\u5982\u4f55\u5b9e\u73b0\uff0c\u4f46\u5b9e\u9645\u4e0a\u534f\u8c03\u8005\u901a\u5e38\u53ea\u662f\u4e00\u4e2a\u5e93\uff0c\u88ab\u52a0\u8f7d\u5230\u53d1\u8d77\u4e8b\u52a1\u7684\u5e94\u7528\u7684\u540c\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\uff08\u800c\u4e0d\u662f\u5355\u72ec\u7684\u670d\u52a1\uff09\u3002</p> <ul> <li>\u5728\u4e8b\u52a1\u4e2d\u8ddf\u8e2a\u6240\u6709\u7684\u53c2\u4e0e\u8005\uff0c\u5e76\u5728\u8981\u6c42\u5b83\u4eec \u51c6\u5907 \u4e4b\u540e\u6536\u96c6\u53c2\u4e0e\u8005\u7684\u54cd\u5e94\uff08\u901a\u8fc7\u9a71\u52a8\u56de\u8c03\uff09\uff0c\u5e76\u4f7f\u7528\u672c\u5730\u78c1\u76d8\u4e0a\u7684\u65e5\u5fd7\u8bb0\u5f55\u6bcf\u6b21\u4e8b\u52a1\u7684\u51b3\u5b9a\uff08\u63d0\u4ea4 / \u4e2d\u6b62\uff09\uff1b</li> </ul> <p>\u5982\u679c\u5e94\u7528\u8fdb\u7a0b\u5d29\u6e83\uff0c\u6216\u8005\u8fd0\u884c\u5e94\u7528\u7684\u673a\u5668\u62a5\u9500\u4e86\uff0c\u534f\u8c03\u8005\u4e5f\u4e0d\u518d\u5b58\u5728\uff1a</p> <ul> <li>\u5e26\u6709 \u51c6\u5907\u4e86 \u4f46\u672a\u63d0\u4ea4\u4e8b\u52a1\u7684\u53c2\u4e0e\u8005\u90fd\u4f1a\u5728\u7591\u8651\u4e2d\u5361\u6b7b\uff1b</li> <li>\u5fc5\u987b\u91cd\u542f\u8be5\u670d\u52a1\u5668\uff0c\u534f\u8c03\u7a0b\u5e8f\u5e93\u5fc5\u987b\u8bfb\u53d6\u672c\u5730\u65e5\u5fd7\u4ee5\u6062\u590d\u6bcf\u4e2a\u4e8b\u52a1\u7684\u63d0\u4ea4 / \u4e2d\u6b62\u7ed3\u679c\u3002</li> <li>\u534f\u8c03\u8005\u624d\u80fd\u4f7f\u7528\u6570\u636e\u5e93\u9a71\u52a8\u7684 XA \u56de\u8c03\u6765\u8981\u6c42\u53c2\u4e0e\u8005\u63d0\u4ea4\u6216\u4e2d\u6b62\u3002\u6570\u636e\u5e93\u670d\u52a1\u5668\u4e0d\u80fd\u76f4\u63a5\u8054\u7cfb\u534f\u8c03\u8005\uff0c\u56e0\u4e3a\u6240\u6709\u901a\u4fe1\u90fd\u5fc5\u987b\u901a\u8fc7\u5ba2\u6237\u7aef\u5e93\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_37","title":"\u6000\u7591\u65f6\u6301\u6709\u9501","text":"<p>\u4e3a\u4ec0\u4e48\u6211\u4eec\u8fd9\u4e48\u5173\u5fc3\u5b58\u7591\u4e8b\u52a1\uff1f\u7cfb\u7edf\u7684\u5176\u4ed6\u90e8\u5206\u5c31\u4e0d\u80fd\u7ee7\u7eed\u6b63\u5e38\u5de5\u4f5c\uff0c\u65e0\u89c6\u90a3\u4e9b\u7ec8\u5c06\u88ab\u6e05\u7406\u7684\u5b58\u7591\u4e8b\u52a1\u5417\uff1f</p> <ul> <li>\u5728 \u201c\u8bfb\u5df2\u63d0\u4ea4\u201d \u4e2d\u6240\u8ba8\u8bba\u7684\u90a3\u6837\uff0c\u6570\u636e\u5e93\u4e8b\u52a1\u901a\u5e38\u83b7\u53d6\u5f85\u4fee\u6539\u7684\u884c\u4e0a\u7684 \u884c\u7ea7\u6392\u4ed6\u9501\uff0c\u4ee5\u9632\u6b62\u810f\u5199\u3002</li> <li>\u5982\u679c\u8981\u4f7f\u7528\u53ef\u4e32\u884c\u5316\u7684\u9694\u79bb\u7b49\u7ea7\uff0c\u5219\u4f7f\u7528\u4e24\u9636\u6bb5\u9501\u5b9a\u7684\u6570\u636e\u5e93\u4e5f\u5fc5\u987b\u4e3a\u4e8b\u52a1\u6240\u8bfb\u53d6\u7684\u884c\u52a0\u4e0a\u5171\u4eab\u9501\uff08\u8bf7\u53c2\u9605 \u201c\u4e24\u9636\u6bb5\u9501\u5b9a\u201d\uff09</li> </ul> <p>\u5728\u4e8b\u52a1\u63d0\u4ea4\u6216\u4e2d\u6b62\u4e4b\u524d\uff0c\u6570\u636e\u5e93\u4e0d\u80fd\u91ca\u653e\u8fd9\u4e9b\u9501\uff0c\u5982\u56fe9-9\u5728\u4f7f\u7528\u4e24\u9636\u6bb5\u63d0\u4ea4\u65f6\uff0c\u4e8b\u52a1\u5fc5\u987b\u5728\u6574\u4e2a\u5b58\u7591\u671f\u95f4\u6301\u6709\u8fd9\u4e9b\u9501\u3002</p> <ul> <li>\u5f53\u8fd9\u4e9b\u9501\u88ab\u6301\u6709\u65f6\uff0c\u5176\u4ed6\u4e8b\u52a1\u4e0d\u80fd\u4fee\u6539\u8fd9\u4e9b\u884c\u3002\u6839\u636e\u6570\u636e\u5e93\u7684\u4e0d\u540c\uff0c\u5176\u4ed6\u4e8b\u52a1\u751a\u81f3\u53ef\u80fd\u56e0\u4e3a\u8bfb\u53d6\u8fd9\u4e9b\u884c\u800c\u88ab\u963b\u585e\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_38","title":"\u4ece\u534f\u8c03\u8005\u6545\u969c\u4e2d\u6062\u590d","text":"<p>\u5728\u5b9e\u8df5\u4e2d\uff0c\u5b64\u7acb\uff08orphaned\uff09 \u7684\u5b58\u7591\u4e8b\u52a1\u786e\u5b9e\u4f1a\u51fa\u73b0\u301089,90\u3011\u3002\u8fd9\u4e9b\u4e8b\u52a1\u65e0\u6cd5\u81ea\u52a8\u89e3\u51b3\uff0c\u6240\u4ee5\u5b83\u4eec\u6c38\u8fdc\u5f85\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u6301\u6709\u9501\u5e76\u963b\u585e\u5176\u4ed6\u4e8b\u52a1\u3002</p> <ul> <li>\u552f\u4e00\u7684\u51fa\u8def\u662f\u8ba9\u7ba1\u7406\u5458\u624b\u52a8\u51b3\u5b9a\u63d0\u4ea4\u8fd8\u662f\u56de\u6eda\u4e8b\u52a1\u3002\u7ba1\u7406\u5458\u5fc5\u987b\u68c0\u67e5\u6bcf\u4e2a\u5b58\u7591\u4e8b\u52a1\u7684\u53c2\u4e0e\u8005\uff0c\u786e\u5b9a\u662f\u5426\u6709\u4efb\u4f55\u53c2\u4e0e\u8005\u5df2\u7ecf\u63d0\u4ea4\u6216\u4e2d\u6b62\uff0c\u7136\u540e\u5c06\u76f8\u540c\u7684\u7ed3\u679c\u5e94\u7528\u4e8e\u5176\u4ed6\u53c2\u4e0e\u8005\u3002</li> <li>\u9700\u8981\u5927\u91cf\u7684\u4eba\u529b\uff0c\u5e76\u4e14\u53ef\u80fd\u53d1\u751f\u5728\u4e25\u91cd\u7684\u751f\u4ea7\u4e2d\u65ad\u671f\u95f4\uff08\u4e0d\u7136\u4e3a\u4ec0\u4e48\u534f\u8c03\u8005\u5904\u4e8e\u8fd9\u79cd\u7cdf\u7cd5\u7684\u72b6\u6001\uff09\uff0c\u5e76\u5f88\u53ef\u80fd\u8981\u5728\u5de8\u5927\u7cbe\u795e\u538b\u529b\u548c\u65f6\u95f4\u538b\u529b\u4e0b\u5b8c\u6210\u3002</li> </ul> <p>\u8bb8\u591a XA \u7684\u5b9e\u73b0\u90fd\u6709\u4e00\u4e2a\u53eb\u505a \u542f\u53d1\u5f0f\u51b3\u7b56\uff08heuristic decisions\uff09 \u7684\u7d27\u6025\u9003\u751f\u8231\u53e3\uff1a</p> <ul> <li>\u5141\u8bb8\u53c2\u4e0e\u8005\u5355\u65b9\u9762\u51b3\u5b9a\u653e\u5f03\u6216\u63d0\u4ea4\u4e00\u4e2a\u5b58\u7591\u4e8b\u52a1\uff0c\u800c\u65e0\u9700\u534f\u8c03\u8005\u505a\u51fa\u6700\u7ec8\u51b3\u5b9a\u301076,77,91\u3011\uff1b</li> <li>\u542f\u53d1\u5f0f \u662f \u53ef\u80fd\u7834\u574f\u539f\u5b50\u6027 \u7684\u59d4\u5a49\u8bf4\u6cd5\uff0c\u56e0\u4e3a\u5b83\u8fdd\u80cc\u4e86\u4e24\u9636\u6bb5\u63d0\u4ea4\u7684\u7cfb\u7edf\u627f\u8bfa\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_39","title":"\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u9650\u5236","text":"<p>\u4e8b\u52a1\u534f\u8c03\u8005\u672c\u8eab\u5c31\u662f\u4e00\u79cd\u6570\u636e\u5e93\uff08\u5b58\u50a8\u4e86\u4e8b\u52a1\u7684\u7ed3\u679c\uff09\uff0c\u56e0\u6b64\u9700\u8981\u50cf\u5176\u4ed6\u91cd\u8981\u6570\u636e\u5e93\u4e00\u6837\u5c0f\u5fc3\u5730\u6253\u4ea4\u9053\uff1a</p> <ul> <li> <p>\u5982\u679c\u534f\u8c03\u8005\u6ca1\u6709\u590d\u5236\uff0c\u800c\u662f\u53ea\u5728\u5355\u53f0\u673a\u5668\u4e0a\u8fd0\u884c\uff0c\u90a3\u4e48\u5b83\u662f\u6574\u4e2a\u7cfb\u7edf\u7684\u5931\u6548\u5355\u70b9\uff08\u56e0\u4e3a\u5b83\u7684\u5931\u6548\u4f1a\u5bfc\u81f4\u5176\u4ed6\u5e94\u7528\u670d\u52a1\u5668\u963b\u585e\u5728\u5b58\u7591\u4e8b\u52a1\u6301\u6709\u7684\u9501\u4e0a\uff09\u3002</p> </li> <li> <p>\u8bb8\u591a\u670d\u52a1\u5668\u7aef\u5e94\u7528\u90fd\u662f\u4f7f\u7528\u65e0\u72b6\u6001\u6a21\u5f0f\u5f00\u53d1\uff0c\u6301\u4e45\u72b6\u6001\u90fd\u5b58\u50a8\u5728\u6570\u636e\u5e93\u3002\u5f53\u534f\u8c03\u8005\u6210\u4e3a\u5e94\u7528\u670d\u52a1\u5668\u7684\u4e00\u90e8\u5206\u65f6\uff0c\u5b83\u4f1a\u6539\u53d8\u90e8\u7f72\u7684\u6027\u8d28\u3002</p> </li> <li> <p>\u534f\u8c03\u8005\u7684\u65e5\u5fd7\u6210\u4e3a\u6301\u4e45\u7cfb\u7edf\u72b6\u6001\u7684\u5173\u952e\u90e8\u5206 \u2014\u2014 \u4e0e\u6570\u636e\u5e93\u672c\u8eab\u4e00\u6837\u91cd\u8981\u3002</p> </li> <li> <p>XA \u9700\u8981\u517c\u5bb9\u5404\u79cd\u6570\u636e\u7cfb\u7edf\uff0c\u56e0\u6b64\u5b83\u5fc5\u987b\u662f\u6240\u6709\u7cfb\u7edf\u7684\u6700\u5c0f\u516c\u5206\u6bcd</p> </li> <li> <p>\u4e0d\u80fd\u68c0\u6d4b\u4e0d\u540c\u7cfb\u7edf\u95f4\u7684\u6b7b\u9501\uff08\u56e0\u4e3a\u8fd9\u5c06\u9700\u8981\u4e00\u4e2a\u6807\u51c6\u534f\u8bae\u6765\u8ba9\u7cfb\u7edf\u4ea4\u6362\u6bcf\u4e2a\u4e8b\u52a1\u6b63\u5728\u7b49\u5f85\u7684\u9501\u7684\u4fe1\u606f\uff09</p> </li> <li> <p>\u65e0\u6cd5\u4e0e SSI\uff08\u8bf7\u53c2\u9605 \u53ef\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb\uff09\u534f\u540c\u5de5\u4f5c\uff0c\u56e0\u4e3a\u8fd9\u9700\u8981\u4e00\u4e2a\u8de8\u7cfb\u7edf\u5b9a\u4f4d\u51b2\u7a81\u7684\u534f\u8bae\u3002</p> </li> <li> <p>\u5bf9\u4e8e\u6570\u636e\u5e93\u5185\u90e8\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\uff08\u4e0d\u662f XA\uff09\uff0c\u9650\u5236\u6ca1\u6709\u8fd9\u4e48\u5927\u2014\u2014 \u4f8b\u5982\uff0c\u5206\u5e03\u5f0f\u7248\u672c\u7684 SSI \u662f\u53ef\u80fd\u7684\u3002</p> </li> <li> <p>\u6269\u5927\u5931\u6548\uff08amplifying failures\uff09\uff1a2PC \u6210\u529f\u63d0\u4ea4\u4e00\u4e2a\u4e8b\u52a1\u9700\u8981\u6240\u6709\u53c2\u4e0e\u8005\u7684\u54cd\u5e94\u3002\u56e0\u6b64\uff0c\u5982\u679c\u7cfb\u7edf\u7684 \u4efb\u4f55 \u90e8\u5206\u635f\u574f\uff0c\u4e8b\u52a1\u4e5f\u4f1a\u5931\u8d25\u3002</p> </li> </ul> <p>\u8fd9\u4e9b\u4e8b\u5b9e\u662f\u5426\u610f\u5473\u7740\u6211\u4eec\u5e94\u8be5\u653e\u5f03\u4fdd\u6301\u51e0\u4e2a\u7cfb\u7edf\u76f8\u4e92\u4e00\u81f4\u7684\u6240\u6709\u5e0c\u671b\uff1f\u4e0d\uff0c\u5728\u6ca1\u6709\u5f02\u6784\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u75db\u82e6\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u5b9e\u73b0\u540c\u6837\u7684\u4e8b\u60c5\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_40","title":"\u5bb9\u9519\u5171\u8bc6","text":"<p>\u975e\u6b63\u5f0f\u5730\uff0c\u5171\u8bc6\u610f\u5473\u7740\u8ba9\u51e0\u4e2a\u8282\u70b9\u5c31\u67d0\u4e8b\u8fbe\u6210\u4e00\u81f4\u3002</p> <p>\u5171\u8bc6\u95ee\u9898\u901a\u5e38\u5f62\u5f0f\u5316\u5982\u4e0b\uff1a\u4e00\u4e2a\u6216\u591a\u4e2a\u8282\u70b9\u53ef\u4ee5 \u63d0\u8bae\uff08propose\uff09 \u67d0\u4e9b\u503c\uff0c\u800c\u5171\u8bc6\u7b97\u6cd5 \u51b3\u5b9a\uff08decides\uff09 \u91c7\u7528\u5176\u4e2d\u7684\u67d0\u4e2a\u503c\u3002\u5171\u8bc6\u7b97\u6cd5\u5fc5\u987b\u6ee1\u8db3\u4ee5\u4e0b\u6027\u8d28\u301025\u3011<sup>5</sup>\uff1a</p> <ul> <li>\u4e00\u81f4\u540c\u610f\uff08Uniform agreement\uff09\uff1a\u6ca1\u6709\u4e24\u4e2a\u8282\u70b9\u7684\u51b3\u5b9a\u4e0d\u540c\u3002</li> <li>\u5b8c\u6574\u6027\uff08Integrity\uff09\uff1a\u6ca1\u6709\u8282\u70b9\u51b3\u5b9a\u4e24\u6b21\u3002</li> <li>\u6709\u6548\u6027\uff08Validity\uff09\uff1a\u5982\u679c\u4e00\u4e2a\u8282\u70b9\u51b3\u5b9a\u4e86\u503c <code>v</code> \uff0c\u5219 <code>v</code> \u7531\u67d0\u4e2a\u8282\u70b9\u6240\u63d0\u8bae\u3002</li> <li>\u7ec8\u6b62\uff08Termination\uff09\uff1a\u7531\u6240\u6709\u672a\u5d29\u6e83\u7684\u8282\u70b9\u6765\u6700\u7ec8\u51b3\u5b9a\u503c\u3002</li> </ul> <p>\u6709\u6548\u6027 \u5c5e\u6027\u4e3b\u8981\u662f\u4e3a\u4e86\u6392\u9664\u5e73\u51e1\u7684\u89e3\u51b3\u65b9\u6848\uff1a\u4f8b\u5982\uff0c\u65e0\u8bba\u63d0\u8bae\u4e86\u4ec0\u4e48\u503c\uff0c\u4f60\u90fd\u53ef\u4ee5\u6709\u4e00\u4e2a\u59cb\u7ec8\u51b3\u5b9a\u503c\u4e3a <code>null</code> \u7684\u7b97\u6cd5\u3002</p> <p>\u7ec8\u6b62 \u5c5e\u6027\u5f62\u5f0f\u5316\u4e86\u5bb9\u9519\u7684\u601d\u60f3\u3002\u5373\u4f7f\u90e8\u5206\u8282\u70b9\u51fa\u73b0\u6545\u969c\uff0c\u5176\u4ed6\u8282\u70b9\u4e5f\u5fc5\u987b\u8fbe\u6210\u4e00\u9879\u51b3\u5b9a\uff08\u7ec8\u6b62 \u662f\u4e00\u79cd \u6d3b\u6027\u5c5e\u6027\uff0c\u800c\u53e6\u5916\u4e09\u79cd\u662f \u5b89\u5168\u5c5e\u6027 \u2014\u2014 \u8bf7\u53c2\u9605 \u201c\u5b89\u5168\u6027\u548c\u6d3b\u6027\u201d\uff09\u3002</p> <p>\u5171\u8bc6\u7684\u7cfb\u7edf\u6a21\u578b\u5047\u8bbe\uff0c\u5f53\u4e00\u4e2a\u8282\u70b9 \u201c\u5d29\u6e83\u201d \u65f6\uff0c\u5b83\u4f1a\u7a81\u7136\u6d88\u5931\u800c\u4e14\u6c38\u8fdc\u4e0d\u4f1a\u56de\u6765\u3002</p> <ul> <li>\u4efb\u4f55\u9700\u8981\u7b49\u5f85\u8282\u70b9\u6062\u590d\u7684\u7b97\u6cd5\u90fd\u4e0d\u80fd\u6ee1\u8db3 \u7ec8\u6b62 \u5c5e\u6027\uff0c2PC \u4e0d\u7b26\u5408\u7ec8\u6b62\u5c5e\u6027\u7684\u8981\u6c42\u3002</li> </ul> <p>\u7ec8\u6b62 \u5c5e\u6027\u53d6\u51b3\u4e8e\u4e00\u4e2a\u5047\u8bbe\uff0c\u4e0d\u8d85\u8fc7\u4e00\u534a\u7684\u8282\u70b9\u5d29\u6e83\u6216\u4e0d\u53ef\u8fbe\u3002\u5373\u4f7f\u591a\u6570\u8282\u70b9\u51fa\u73b0\u6545\u969c\u6216\u5b58\u5728\u4e25\u91cd\u7684\u7f51\u7edc\u95ee\u9898\uff0c\u7edd\u5927\u591a\u6570\u5171\u8bc6\u7684\u5b9e\u73b0\u90fd\u80fd\u59cb\u7ec8\u786e\u4fdd\u5b89\u5168\u5c5e\u6027\u5f97\u5230\u6ee1\u8db3 \u2014\u2014 \u4e00\u81f4\u540c\u610f\uff0c\u5b8c\u6574\u6027\u548c\u6709\u6548\u6027\u301092\u3011\u3002</p> <p>\u5927\u591a\u6570\u5171\u8bc6\u7b97\u6cd5\u5047\u8bbe\u4e0d\u5b58\u5728 \u62dc\u5360\u5ead\u5f0f\u9519\u8bef\uff0c\u514b\u670d\u62dc\u5360\u5ead\u6545\u969c\uff0c\u7a33\u5065\u5730\u8fbe\u6210\u5171\u8bc6\u662f\u53ef\u80fd\u7684\uff0c\u53ea\u8981\u5c11\u4e8e\u4e09\u5206\u4e4b\u4e00\u7684\u8282\u70b9\u5b58\u5728\u62dc\u5360\u5ead\u6545\u969c\u301025,93\u3011\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_41","title":"\u5171\u8bc6\u7b97\u6cd5\u548c\u5168\u5e8f\u5e7f\u64ad","text":"<p>\u6700\u8457\u540d\u7684\u5bb9\u9519\u5171\u8bc6\u7b97\u6cd5\u662f \u89c6\u56fe\u6233\u590d\u5236\uff08VSR, Viewstamped Replication\uff09\u301094,95\u3011\uff0cPaxos \u301096,97,98,99\u3011\uff0cRaft \u301022,100,101\u3011\u4ee5\u53ca Zab \u301015,21,102\u3011 \u3002\u8fd9\u4e9b\u7b97\u6cd5\u4e4b\u95f4\u6709\u4e0d\u5c11\u76f8\u4f3c\u4e4b\u5904\uff0c\u4f46\u5b83\u4eec\u5e76\u4e0d\u76f8\u540c\u3010103\u3011\u3002</p> <p>\u672c\u4e66\u4e2d\u6211\u4eec\u4e0d\u4f1a\u4ecb\u7ecd\u5404\u79cd\u7b97\u6cd5\u7684\u8be6\u7ec6\u7ec6\u8282\uff1a\u4e86\u89e3\u4e00\u4e9b\u5b83\u4eec\u5171\u901a\u7684\u9ad8\u7ea7\u601d\u60f3\u901a\u5e38\u5df2\u7ecf\u8db3\u591f\u4e86\uff0c\u9664\u975e\u4f60\u51c6\u5907\u81ea\u5df1\u5b9e\u73b0\u4e00\u4e2a\u5171\u8bc6\u7cfb\u7edf\u3002\uff08\u53ef\u80fd\u5e76\u4e0d\u660e\u667a\uff0c\u76f8\u5f53\u96be\u301098,104\u3011\uff09</p> <p>\u5927\u591a\u6570\u8fd9\u4e9b\u7b97\u6cd5\u5b9e\u9645\u4e0a\u5e76\u4e0d\u76f4\u63a5\u4f7f\u7528\u8fd9\u91cc\u63cf\u8ff0\u7684\u5f62\u5f0f\u5316\u6a21\u578b\uff08\u63d0\u8bae\u4e0e\u51b3\u5b9a\u5355\u4e2a\u503c\uff0c\u5e76\u6ee1\u8db3\u4e00\u81f4\u540c\u610f\u3001\u5b8c\u6574\u6027\u3001\u6709\u6548\u6027\u548c\u7ec8\u6b62\u5c5e\u6027\uff09\u3002\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\uff0c\u5b83\u4eec\u51b3\u5b9a\u4e86\u503c\u7684 \u987a\u5e8f\uff08sequence\uff09\uff0c\u8fd9\u4f7f\u5b83\u4eec\u6210\u4e3a\u5168\u5e8f\u5e7f\u64ad\u7b97\u6cd5\u3002</p> <p>\u5168\u5e8f\u5e7f\u64ad\u8981\u6c42\u5c06\u6d88\u606f\u6309\u7167\u76f8\u540c\u7684\u987a\u5e8f\uff0c\u6070\u597d\u4f20\u9012\u4e00\u6b21\uff0c\u51c6\u786e\u4f20\u9001\u5230\u6240\u6709\u8282\u70b9\u3002\u76f8\u5f53\u4e8e\u8fdb\u884c\u4e86\u51e0\u8f6e\u5171\u8bc6\uff1a\u5728\u6bcf\u4e00\u8f6e\u4e2d\uff0c\u8282\u70b9\u63d0\u8bae\u4e0b\u4e00\u6761\u8981\u53d1\u9001\u7684\u6d88\u606f\uff0c\u7136\u540e\u51b3\u5b9a\u5728\u5168\u5e8f\u4e2d\u4e0b\u4e00\u6761\u8981\u53d1\u9001\u7684\u6d88\u606f\u301067\u3011\u3002</p> <p>\u5168\u5e8f\u5e7f\u64ad\u76f8\u5f53\u4e8e\u91cd\u590d\u8fdb\u884c\u591a\u8f6e\u5171\u8bc6\uff08\u6bcf\u6b21\u5171\u8bc6\u51b3\u5b9a\u4e0e\u4e00\u6b21\u6d88\u606f\u4f20\u9012\u76f8\u5bf9\u5e94\uff09\uff1a</p> <ul> <li>\u7531\u4e8e \u4e00\u81f4\u540c\u610f \u5c5e\u6027\uff0c\u6240\u6709\u8282\u70b9\u51b3\u5b9a\u4ee5\u76f8\u540c\u7684\u987a\u5e8f\u4f20\u9012\u76f8\u540c\u7684\u6d88\u606f\u3002</li> <li>\u7531\u4e8e \u5b8c\u6574\u6027 \u5c5e\u6027\uff0c\u6d88\u606f\u4e0d\u4f1a\u91cd\u590d\u3002</li> <li>\u7531\u4e8e \u6709\u6548\u6027 \u5c5e\u6027\uff0c\u6d88\u606f\u4e0d\u4f1a\u88ab\u635f\u574f\uff0c\u4e5f\u4e0d\u80fd\u51ed\u7a7a\u7f16\u9020\u3002</li> <li>\u7531\u4e8e \u7ec8\u6b62 \u5c5e\u6027\uff0c\u6d88\u606f\u4e0d\u4f1a\u4e22\u5931\u3002</li> </ul> <p>\u89c6\u56fe\u6233\u590d\u5236\uff0cRaft \u548c Zab \u76f4\u63a5\u5b9e\u73b0\u4e86\u5168\u5e8f\u5e7f\u64ad\uff0c\u56e0\u4e3a\u8fd9\u6837\u505a\u6bd4\u91cd\u590d \u4e00\u6b21\u4e00\u503c\uff08one value a time\uff09 \u7684\u5171\u8bc6\u66f4\u9ad8\u6548\u3002\u5728 Paxos \u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u79cd\u4f18\u5316\u88ab\u79f0\u4e3a Multi-Paxos\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_42","title":"\u5355\u4e3b\u590d\u5236\u4e0e\u5171\u8bc6","text":"<p>\u5355\u4e3b\u590d\u5236\u5c06\u6240\u6709\u7684\u5199\u5165\u64cd\u4f5c\u90fd\u4ea4\u7ed9\u4e3b\u5e93\uff0c\u5e76\u4ee5\u76f8\u540c\u7684\u987a\u5e8f\u5c06\u5b83\u4eec\u5e94\u7528\u5230\u4ece\u5e93\uff0c\u4ece\u800c\u4f7f\u526f\u672c\u4fdd\u6301\u5728\u6700\u65b0\u72b6\u6001\u3002\u8fd9\u5b9e\u9645\u4e0a\u4e0d\u5c31\u662f\u4e00\u4e2a\u5168\u5e8f\u5e7f\u64ad\u5417\uff1f\u4e3a\u4ec0\u4e48\u6ca1\u62c5\u5fc3\u8fc7\u5171\u8bc6\u95ee\u9898\u5462\uff1f</p> <ul> <li>\u53d6\u51b3\u4e8e\u5982\u4f55\u9009\u62e9\u9886\u5bfc\u8005\uff1a\u4e3b\u5e93\u662f\u7531\u8fd0\u7ef4\u4eba\u5458\u624b\u52a8\u9009\u62e9\u548c\u914d\u7f6e\uff0c \u72ec\u88c1\u7c7b\u578b \u7684 \u201c\u5171\u8bc6\u7b97\u6cd5\u201d\u3002</li> <li>\u5982\u679c\u8be5\u8282\u70b9\u53d1\u751f\u6545\u969c\uff0c\u5219\u7cfb\u7edf\u5c06\u65e0\u6cd5\u5199\u5165\uff0c\u76f4\u5230\u8fd0\u7ef4\u624b\u52a8\u914d\u7f6e\u5176\u4ed6\u8282\u70b9\u4f5c\u4e3a\u4e3b\u5e93\u3002\u65e0\u6cd5\u6ee1\u8db3\u5171\u8bc6\u7684 \u7ec8\u6b62 \u5c5e\u6027\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u4eba\u4e3a\u5e72\u9884\u624d\u80fd\u53d6\u5f97 \u8fdb\u5c55\u3002</li> </ul> <p>\u4e00\u4e9b\u6570\u636e\u5e93\u4f1a\u81ea\u52a8\u6267\u884c\u9886\u5bfc\u8005\u9009\u4e3e\u548c\u6545\u969c\u5207\u6362\uff0c\u5982\u679c\u65e7\u4e3b\u5e93\u5931\u6548\uff0c\u4f1a\u63d0\u62d4\u4e00\u4e2a\u4ece\u5e93\u4e3a\u65b0\u4e3b\u5e93\uff1a\u9488\u5bf9\u8111\u88c2\u7684\u95ee\u9898</p> <ul> <li>\u9009\u51fa\u4e00\u4f4d\u9886\u5bfc\u8005\u9700\u8981\u5171\u8bc6\uff0c\u5982\u679c\u8fd9\u91cc\u63cf\u8ff0\u7684\u5171\u8bc6\u7b97\u6cd5\u5b9e\u9645\u4e0a\u662f\u5168\u5e8f\u5e7f\u64ad\u7b97\u6cd5\uff0c\u5e76\u4e14\u5168\u5e8f\u5e7f\u64ad\u5c31\u50cf\u5355\u4e3b\u590d\u5236\uff0c\u800c\u5355\u4e3b\u590d\u5236\u9700\u8981\u4e00\u4e2a\u9886\u5bfc\u8005\uff0c\u90a3\u4e48...</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_43","title":"\u7eaa\u5143\u7f16\u53f7\u548c\u6cd5\u5b9a\u4eba\u6570","text":"<p>\u8fc4\u4eca\u4e3a\u6b62\u6240\u8ba8\u8bba\u7684\u6240\u6709\u5171\u8bc6\u534f\u8bae\uff0c\u5728\u5185\u90e8\u90fd\u4ee5\u67d0\u79cd\u5f62\u5f0f\u4f7f\u7528\u4e00\u4e2a\u9886\u5bfc\u8005\uff0c\u4f46\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u9886\u5bfc\u8005\u662f\u72ec\u4e00\u65e0\u4e8c\uff1a</p> <ul> <li>\u66f4\u5f31\u7684\u4fdd\u8bc1\uff1a\u534f\u8bae\u5b9a\u4e49\u4e86\u4e00\u4e2a \u7eaa\u5143\u7f16\u53f7\uff08epoch number\uff0c\u5728 Paxos \u4e2d\u88ab\u79f0\u4e3a \u6295\u7968\u7f16\u53f7\uff0c\u5373 ballot number\uff0c\u5728\u89c6\u56fe\u6233\u590d\u5236\u4e2d\u88ab\u79f0\u4e3a \u89c6\u56fe\u7f16\u53f7\uff0c\u5373 view number\uff0c\u4ee5\u53ca\u5728 Raft \u4e2d\u88ab\u4e3a \u4efb\u671f\u53f7\u7801\uff0c\u5373 term number\uff09\uff0c\u5e76\u786e\u4fdd\u5728\u6bcf\u4e2a\u65f6\u4ee3\u4e2d\uff0c\u9886\u5bfc\u8005\u90fd\u662f\u552f\u4e00\u7684\u3002</li> </ul> <p>\u6bcf\u6b21\u5f53\u73b0\u4efb\u9886\u5bfc\u88ab\u8ba4\u4e3a\u6302\u6389\u7684\u65f6\u5019\uff0c\u8282\u70b9\u95f4\u5c31\u4f1a\u5f00\u59cb\u4e00\u573a\u6295\u7968\uff0c\u4ee5\u9009\u51fa\u4e00\u4e2a\u65b0\u9886\u5bfc\u3002</p> <ul> <li>\u9009\u4e3e\u88ab\u8d4b\u4e88\u4e00\u4e2a\u9012\u589e\u7684\u7eaa\u5143\u7f16\u53f7\uff0c\u56e0\u6b64\u7eaa\u5143\u7f16\u53f7\u662f\u5168\u5e8f\u4e14\u5355\u8c03\u9012\u589e\uff1b</li> <li>\u5982\u679c\u4e24\u4e2a\u4e0d\u540c\u7684\u65f6\u4ee3\u7684\u9886\u5bfc\u8005\u4e4b\u95f4\u51fa\u73b0\u51b2\u7a81\uff08\u4e5f\u8bb8\u662f\u56e0\u4e3a\u524d\u4efb\u9886\u5bfc\u8005\u5b9e\u9645\u4e0a\u5e76\u672a\u6b7b\u4ea1\uff09\uff0c\u90a3\u4e48\u5e26\u6709\u66f4\u9ad8\u7eaa\u5143\u7f16\u53f7\u7684\u9886\u5bfc\u8bf4\u4e86\u7b97\u3002</li> </ul> <p>\u5728\u4efb\u4f55\u9886\u5bfc\u8005\u88ab\u5141\u8bb8\u51b3\u5b9a\u4efb\u4f55\u4e8b\u60c5\u4e4b\u524d\uff0c\u5fc5\u987b\u5148\u68c0\u67e5\u662f\u5426\u5b58\u5728\u5176\u4ed6\u5e26\u6709\u66f4\u9ad8\u7eaa\u5143\u7f16\u53f7\u7684\u9886\u5bfc\u8005\uff0c\u5b83\u4eec\u53ef\u80fd\u4f1a\u505a\u51fa\u76f8\u4e92\u51b2\u7a81\u7684\u51b3\u5b9a\u3002</p> <ul> <li>\u5bf9\u9886\u5bfc\u8005\u60f3\u8981\u505a\u51fa\u7684\u6bcf\u4e00\u4e2a\u51b3\u5b9a\uff0c\u90fd\u5fc5\u987b\u5c06\u63d0\u8bae\u503c\u53d1\u9001\u7ed9\u5176\u4ed6\u8282\u70b9\uff0c\u5e76\u7b49\u5f85\u6cd5\u5b9a\u4eba\u6570\u7684\u8282\u70b9\u54cd\u5e94\u5e76\u8d5e\u6210\u63d0\u6848\u3002</li> <li>\u6cd5\u5b9a\u4eba\u6570\u901a\u5e38\uff08\u4f46\u4e0d\u603b\u662f\uff09\u7531\u591a\u6570\u8282\u70b9\u7ec4\u6210\u3010105\u3011\u3002\u53ea\u6709\u5728\u6ca1\u6709\u610f\u8bc6\u5230\u4efb\u4f55\u5e26\u6709\u66f4\u9ad8\u7eaa\u5143\u7f16\u53f7\u7684\u9886\u5bfc\u8005\u7684\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2a\u8282\u70b9\u624d\u4f1a\u6295\u7968\u8d5e\u6210\u63d0\u8bae\u3002</li> </ul> <p>\u6709\u4e24\u8f6e\u6295\u7968\uff1a\u7b2c\u4e00\u6b21\u662f\u4e3a\u4e86\u9009\u51fa\u4e00\u4f4d\u9886\u5bfc\u8005\uff0c\u7b2c\u4e8c\u6b21\u662f\u5bf9\u9886\u5bfc\u8005\u7684\u63d0\u8bae\u8fdb\u884c\u8868\u51b3\u3002</p> <ul> <li>\u8fd9\u4e24\u6b21\u6295\u7968\u7684 \u6cd5\u5b9a\u4eba\u7fa4 \u5fc5\u987b\u76f8\u4e92 \u91cd\u53e0\uff08overlap\uff09</li> <li>\u5982\u679c\u4e00\u4e2a\u63d0\u6848\u7684\u8868\u51b3\u901a\u8fc7\uff0c\u5219\u81f3\u5c11\u5f97\u6709\u4e00\u4e2a\u53c2\u4e0e\u6295\u7968\u7684\u8282\u70b9\u4e5f\u5fc5\u987b\u53c2\u52a0\u8fc7\u6700\u8fd1\u7684\u9886\u5bfc\u8005\u9009\u4e3e\u3010105\u3011</li> </ul> <p>\u56e0\u6b64\uff0c\u5982\u679c\u5728\u4e00\u4e2a\u63d0\u6848\u7684\u8868\u51b3\u8fc7\u7a0b\u4e2d\u6ca1\u6709\u51fa\u73b0\u66f4\u9ad8\u7684\u7eaa\u5143\u7f16\u53f7\u3002\u90a3\u4e48\u73b0\u4efb\u9886\u5bfc\u8005\u5c31\u53ef\u4ee5\u5f97\u51fa\u8fd9\u6837\u7684\u7ed3\u8bba\uff1a\u6ca1\u6709\u53d1\u751f\u8fc7\u66f4\u9ad8\u65f6\u4ee3\u7684\u9886\u5bfc\u9009\u4e3e\uff0c\u56e0\u6b64\u53ef\u4ee5\u786e\u5b9a\u81ea\u5df1\u4ecd\u7136\u5728\u9886\u5bfc\u3002\u7136\u540e\u5b83\u5c31\u53ef\u4ee5\u5b89\u5168\u5730\u5bf9\u63d0\u8bae\u503c\u505a\u51fa\u51b3\u5b9a\u3002</p> <p>\u8fd9\u4e00\u6295\u7968\u8fc7\u7a0b\u8868\u9762\u4e0a\u770b\u8d77\u6765\u5f88\u50cf\u4e24\u9636\u6bb5\u63d0\u4ea4\u3002\u6700\u5927\u7684\u533a\u522b\u5728\u4e8e\uff1a</p> <ul> <li>2PC \u4e2d\u534f\u8c03\u8005\u4e0d\u662f\u7531\u9009\u4e3e\u4ea7\u751f\u7684\uff0c\u800c\u4e14 2PC \u5219\u8981\u6c42 \u6240\u6709 \u53c2\u4e0e\u8005\u90fd\u6295\u8d5e\u6210\u7968\uff0c\u800c\u5bb9\u9519\u5171\u8bc6\u7b97\u6cd5\u53ea\u9700\u8981\u591a\u6570\u8282\u70b9\u7684\u6295\u7968\u3002</li> <li>\u5171\u8bc6\u7b97\u6cd5\u8fd8\u5b9a\u4e49\u4e86\u4e00\u4e2a\u6062\u590d\u8fc7\u7a0b\uff0c\u8282\u70b9\u53ef\u4ee5\u5728\u9009\u4e3e\u51fa\u65b0\u7684\u9886\u5bfc\u8005\u4e4b\u540e\u8fdb\u5165\u4e00\u4e2a\u4e00\u81f4\u7684\u72b6\u6001\uff0c\u786e\u4fdd\u59cb\u7ec8\u80fd\u6ee1\u8db3\u5b89\u5168\u5c5e\u6027\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_44","title":"\u5171\u8bc6\u7684\u5c40\u9650\u6027","text":"<p>\u5171\u8bc6\u7b97\u6cd5\u4e3a\u5176\u4ed6\u5145\u6ee1\u4e0d\u786e\u5b9a\u6027\u7684\u7cfb\u7edf\u5e26\u6765\u4e86\u57fa\u7840\u7684\u5b89\u5168\u5c5e\u6027\uff08\u4e00\u81f4\u540c\u610f\uff0c\u5b8c\u6574\u6027\u548c\u6709\u6548\u6027\uff09\uff0c\u8fd8\u80fd\u4fdd\u6301\u5bb9\u9519\u3002</p> <ul> <li>\u4f9b\u4e86\u5168\u5e8f\u5e7f\u64ad\uff0c\u56e0\u6b64\u5b83\u4eec\u4e5f\u53ef\u4ee5\u4ee5\u4e00\u79cd\u5bb9\u9519\u7684\u65b9\u5f0f\u5b9e\u73b0\u7ebf\u6027\u4e00\u81f4\u7684\u539f\u5b50\u64cd\u4f5c\u3002</li> </ul> <p>\u8282\u70b9\u5728\u505a\u51fa\u51b3\u5b9a\u4e4b\u524d\u5bf9\u63d0\u8bae\u8fdb\u884c\u6295\u7968\u7684\u8fc7\u7a0b\u662f\u4e00\u79cd\u540c\u6b65\u590d\u5236\u3002</p> <p>\u5171\u8bc6\u7cfb\u7edf\u603b\u662f\u9700\u8981\u4e25\u683c\u591a\u6570\u6765\u8fd0\u8f6c\u3002\u81f3\u5c11\u9700\u8981\u4e09\u4e2a\u8282\u70b9\u624d\u80fd\u5bb9\u5fcd\u5355\u8282\u70b9\u6545\u969c\u3002</p> <p>\u5927\u591a\u6570\u5171\u8bc6\u7b97\u6cd5\u5047\u5b9a\u53c2\u4e0e\u6295\u7968\u7684\u8282\u70b9\u662f\u56fa\u5b9a\u7684\u96c6\u5408\uff0c\u8fd9\u610f\u5473\u7740\u4f60\u4e0d\u80fd\u7b80\u5355\u7684\u5728\u96c6\u7fa4\u4e2d\u6dfb\u52a0\u6216\u5220\u9664\u8282\u70b9\u3002\u5171\u8bc6\u7b97\u6cd5\u7684 \u52a8\u6001\u6210\u5458\u6269\u5c55\uff08dynamic membership extension\uff09 \u5141\u8bb8\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u96c6\u968f\u65f6\u95f4\u63a8\u79fb\u800c\u53d8\u5316\uff0c\u4f46\u662f\u5b83\u4eec\u6bd4\u9759\u6001\u6210\u5458\u7b97\u6cd5\u8981\u96be\u7406\u89e3\u5f97\u591a\u3002</p> <p>\u5171\u8bc6\u7cfb\u7edf\u901a\u5e38\u4f9d\u9760\u8d85\u65f6\u6765\u68c0\u6d4b\u5931\u6548\u7684\u8282\u70b9\u3002\u7279\u522b\u662f\u5728\u5730\u7406\u4e0a\u6563\u5e03\u7684\u7cfb\u7edf\u4e2d\uff0c\u7ecf\u5e38\u53d1\u751f\u4e00\u4e2a\u8282\u70b9\u7531\u4e8e\u6682\u65f6\u7684\u7f51\u7edc\u95ee\u9898\uff0c\u9519\u8bef\u5730\u8ba4\u4e3a\u9886\u5bfc\u8005\u5df2\u7ecf\u5931\u6548\u3002\u867d\u7136\u8fd9\u79cd\u9519\u8bef\u4e0d\u4f1a\u635f\u5bb3\u5b89\u5168\u5c5e\u6027\uff0c\u4f46\u9891\u7e41\u7684\u9886\u5bfc\u8005\u9009\u4e3e\u4f1a\u5bfc\u81f4\u7cdf\u7cd5\u7684\u6027\u80fd\u8868\u73b0\u3002</p> <p>\u6709\u65f6\u5171\u8bc6\u7b97\u6cd5\u5bf9\u7f51\u7edc\u95ee\u9898\u7279\u522b\u654f\u611f\uff1a</p> <ul> <li>\u5982 Raft \u5df2\u88ab\u8bc1\u660e\u5b58\u5728\u8ba9\u4eba\u4e0d\u60a6\u7684\u6781\u7aef\u60c5\u51b5\u3010106\u3011\uff1a\u5982\u679c\u6574\u4e2a\u7f51\u7edc\u5de5\u4f5c\u6b63\u5e38\uff0c\u4f46\u53ea\u6709\u4e00\u6761\u7279\u5b9a\u7684\u7f51\u7edc\u8fde\u63a5\u4e00\u76f4\u4e0d\u53ef\u9760\uff0cRaft \u53ef\u80fd\u4f1a\u8fdb\u5165\u9886\u5bfc\u8005\u5728\u4e24\u4e2a\u8282\u70b9\u95f4\u9891\u7e41\u5207\u6362\u7684\u5c40\u9762\uff0c\u6216\u8005\u5f53\u524d\u9886\u5bfc\u8005\u4e0d\u65ad\u88ab\u8feb\u8f9e\u804c\u4ee5\u81f4\u7cfb\u7edf\u5b9e\u8d28\u4e0a\u6beb\u65e0\u8fdb\u5c55\u3002</li> <li>\u5176\u4ed6\u4e00\u81f4\u6027\u7b97\u6cd5\u4e5f\u5b58\u5728\u7c7b\u4f3c\u7684\u95ee\u9898\uff0c\u800c\u8bbe\u8ba1\u80fd\u5065\u58ee\u5e94\u5bf9\u4e0d\u53ef\u9760\u7f51\u7edc\u7684\u7b97\u6cd5\u4ecd\u7136\u662f\u4e00\u4e2a\u5f00\u653e\u7684\u7814\u7a76\u95ee\u9898\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_45","title":"\u6210\u5458\u4e0e\u534f\u8c03\u670d\u52a1","text":"<p>\u50cf ZooKeeper \u6216 etcd \u8fd9\u6837\u7684\u9879\u76ee\u901a\u5e38\u88ab\u63cf\u8ff0\u4e3a \u201c\u5206\u5e03\u5f0f\u952e\u503c\u5b58\u50a8\u201d \u6216 \u201c\u534f\u8c03\u4e0e\u914d\u7f6e\u670d\u52a1\u201d\u3002\u8fd9\u79cd\u670d\u52a1\u7684 API \u770b\u8d77\u6765\u975e\u5e38\u50cf\u6570\u636e\u5e93\uff1a\u4f60\u53ef\u4ee5\u8bfb\u5199\u7ed9\u5b9a\u952e\u7684\u503c\uff0c\u5e76\u904d\u5386\u952e\u3002\u4e3a\u4ec0\u4e48\u5b83\u4eec\u8981\u628a\u5de5\u592b\u5168\u82b1\u5728\u5b9e\u73b0\u4e00\u4e2a\u5171\u8bc6\u7b97\u6cd5\u4e0a\u5462\uff1f\u662f\u4ec0\u4e48\u4f7f\u5b83\u4eec\u533a\u522b\u4e8e\u5176\u4ed6\u4efb\u610f\u7c7b\u578b\u7684\u6570\u636e\u5e93\uff1f</p> <p>ZooKeeper \u5b9e\u9645\u4e0a\u4e0d\u9002\u5408\u5f53\u6210\u901a\u7528\u6570\u636e\u5e93\u6765\u7528\uff0c\u901a\u8fc7\u5176\u4ed6\u9879\u76ee\u95f4\u63a5\u4f9d\u8d56\u5b83\uff0c\u4f8b\u5982 HBase\u3001Hadoop YARN\u3001OpenStack Nova \u548c Kafka \u90fd\u4f9d\u8d56 ZooKeeper \u5728\u540e\u53f0\u8fd0\u884c\u3002</p> <p>ZooKeeper \u548c etcd \u88ab\u8bbe\u8ba1\u4e3a\u5bb9\u7eb3\u5c11\u91cf\u5b8c\u5168\u53ef\u4ee5\u653e\u5728\u5185\u5b58\u4e2d\u7684\u6570\u636e\uff08\u867d\u7136\u5b83\u4eec\u4ecd\u7136\u4f1a\u5199\u5165\u78c1\u76d8\u4ee5\u4fdd\u8bc1\u6301\u4e45\u6027\uff09</p> <ul> <li>\u4e0d\u4f1a\u60f3\u7740\u628a\u6240\u6709\u5e94\u7528\u6570\u636e\u653e\u5230\u8fd9\u91cc\uff0c\u5c11\u91cf\u6570\u636e\u4f1a\u901a\u8fc7\u5bb9\u9519\u7684\u5168\u5e8f\u5e7f\u64ad\u7b97\u6cd5\u590d\u5236\u5230\u6240\u6709\u8282\u70b9\u4e0a\uff1b</li> </ul> <p>ZooKeeper \u6a21\u4eff\u4e86 Google \u7684 Chubby \u9501\u670d\u52a1\u301014,98\u3011\uff0c\u4e0d\u4ec5\u5b9e\u73b0\u4e86\u5168\u5e8f\u5e7f\u64ad\uff08\u56e0\u6b64\u4e5f\u5b9e\u73b0\u4e86\u5171\u8bc6\uff09\uff0c\u800c\u4e14\u8fd8\u6784\u5efa\u4e86\u4e00\u7ec4\u6709\u8da3\u7684\u5176\u4ed6\u7279\u6027\uff1a</p> <ul> <li>\u7ebf\u6027\u4e00\u81f4\u6027\u7684\u539f\u5b50\u64cd\u4f5c\uff1a\u4f7f\u7528\u539f\u5b50 CAS \u64cd\u4f5c\u53ef\u4ee5\u5b9e\u73b0\u9501\uff0c\u5171\u8bc6\u534f\u8bae\u4fdd\u8bc1\u4e86\u64cd\u4f5c\u7684\u539f\u5b50\u6027\u548c\u7ebf\u6027\u4e00\u81f4\u6027</li> <li>\u5206\u5e03\u5f0f\u9501\u901a\u5e38\u4ee5 \u79df\u7ea6\uff08lease\uff09 \u7684\u5f62\u5f0f\u5b9e\u73b0\uff0c\u79df\u7ea6\u6709\u4e00\u4e2a\u5230\u671f\u65f6\u95f4\uff0c\u4ee5\u4fbf\u5728\u5ba2\u6237\u7aef\u5931\u6548\u7684\u60c5\u51b5\u4e0b\u6700\u7ec8\u80fd\u88ab\u91ca\u653e\uff08\u8bf7\u53c2\u9605 \u201c\u8fdb\u7a0b\u6682\u505c\u201d\uff09\u3002</li> <li>\u64cd\u4f5c\u7684\u5168\u5e8f\u6392\u5e8f\uff1a\u5f53\u67d0\u4e2a\u8d44\u6e90\u53d7\u5230\u9501\u6216\u79df\u7ea6\u7684\u4fdd\u62a4\u65f6\uff0c\u9700\u8981\u4e00\u4e2a\u9632\u62a4\u4ee4\u724c\u6765\u9632\u6b62\u5ba2\u6237\u7aef\u5728\u8fdb\u7a0b\u6682\u505c\u7684\u60c5\u51b5\u4e0b\u5f7c\u6b64\u51b2\u7a81\u3002\u9632\u62a4\u4ee4\u724c\u662f\u6bcf\u6b21\u9501\u88ab\u83b7\u53d6\u65f6\u5355\u8c03\u589e\u52a0\u7684\u6570\u5b57\u3002</li> <li>ZooKeeper \u901a\u8fc7\u5168\u5e8f\u5316\u6240\u6709\u64cd\u4f5c\u6765\u63d0\u4f9b\u8fd9\u4e2a\u529f\u80fd\uff0c\u5b83\u4e3a\u6bcf\u4e2a\u64cd\u4f5c\u63d0\u4f9b\u4e00\u4e2a\u5355\u8c03\u9012\u589e\u7684\u4e8b\u52a1 ID\uff08<code>zxid</code>\uff09\u548c\u7248\u672c\u53f7\uff08<code>cversion</code>\uff09\u301015\u3011</li> <li>\u5931\u6548\u68c0\u6d4b\uff1a\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u5468\u671f\u6027\u5730\u4ea4\u6362\u5fc3\u8df3\u5305\u6765\u68c0\u67e5\u8282\u70b9\u662f\u5426\u8fd8\u6d3b\u7740</li> <li>\u5373\u4f7f\u8fde\u63a5\u6682\u65f6\u4e2d\u65ad\uff0c\u6216\u8005 ZooKeeper \u8282\u70b9\u5931\u6548\uff0c\u4f1a\u8bdd\u4ecd\u4fdd\u6301\u5728\u6d3b\u8dc3\u72b6\u6001\u3002\u4f46\u5982\u679c\u5fc3\u8df3\u505c\u6b62\u7684\u6301\u7eed\u65f6\u95f4\u8d85\u51fa\u4f1a\u8bdd\u8d85\u65f6\uff0cZooKeeper \u4f1a\u5ba3\u544a\u8be5\u4f1a\u8bdd\u5df2\u6b7b\u4ea1\u3002\u5f53\u4f1a\u8bdd\u8d85\u65f6\u65f6\uff08ZooKeeper \u79f0\u8fd9\u4e9b\u8282\u70b9\u4e3a \u4e34\u65f6\u8282\u70b9\uff0c\u5373 ephemeral nodes\uff09\uff0c\u4f1a\u8bdd\u6301\u6709\u7684\u4efb\u4f55\u9501\u90fd\u53ef\u4ee5\u914d\u7f6e\u4e3a\u81ea\u52a8\u91ca\u653e\u3002</li> <li>\u53d8\u66f4\u901a\u77e5\uff1a\u5ba2\u6237\u7aef\u4e0d\u4ec5\u53ef\u4ee5\u8bfb\u53d6\u5176\u4ed6\u5ba2\u6237\u7aef\u521b\u5efa\u7684\u9501\u548c\u503c\uff0c\u8fd8\u53ef\u4ee5\u76d1\u542c\u5b83\u4eec\u7684\u53d8\u66f4\u3002</li> <li>\u5ba2\u6237\u7aef\u53ef\u4ee5\u77e5\u9053\u53e6\u4e00\u4e2a\u5ba2\u6237\u7aef\u4f55\u65f6\u52a0\u5165\u96c6\u7fa4\uff08\u57fa\u4e8e\u65b0\u5ba2\u6237\u7aef\u5199\u5165 ZooKeeper \u7684\u503c\uff09\uff0c\u6216\u53d1\u751f\u6545\u969c\uff08\u56e0\u5176\u4f1a\u8bdd\u8d85\u65f6\uff0c\u800c\u5176\u4e34\u65f6\u8282\u70b9\u6d88\u5931\uff09\u3002</li> </ul> <p>\u5728\u8fd9\u4e9b\u529f\u80fd\u4e2d\uff0c\u53ea\u6709\u7ebf\u6027\u4e00\u81f4\u7684\u539f\u5b50\u64cd\u4f5c\u624d\u771f\u7684\u9700\u8981\u5171\u8bc6\u3002\u662f\u8fd9\u4e9b\u529f\u80fd\u7684\u7ec4\u5408\uff0c\u4f7f\u5f97\u50cf ZooKeeper \u8fd9\u6837\u7684\u7cfb\u7edf\u5728\u5206\u5e03\u5f0f\u534f\u8c03\u4e2d\u975e\u5e38\u6709\u7528\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_46","title":"\u5c06\u5de5\u4f5c\u5206\u914d\u7ed9\u8282\u70b9","text":"<p>ZooKeeper/Chubby \u6a21\u578b\u8fd0\u884c\u826f\u597d\u7684\u4f8b\u5b50\uff1a</p> <ul> <li>\u6709\u51e0\u4e2a\u8fdb\u7a0b\u5b9e\u4f8b\u6216\u670d\u52a1\uff0c\u9700\u8981\u9009\u62e9\u5176\u4e2d\u4e00\u4e2a\u5b9e\u4f8b\u4f5c\u4e3a\u4e3b\u5e93\u6216\u9996\u9009\u670d\u52a1\u3002\u5982\u679c\u9886\u5bfc\u8005\u5931\u8d25\uff0c\u5176\u4ed6\u8282\u70b9\u4e4b\u4e00\u5e94\u8be5\u63a5\u7ba1\u3002</li> <li>\u6709\u4e00\u4e9b\u5206\u533a\u8d44\u6e90\uff08\u6570\u636e\u5e93\u3001\u6d88\u606f\u6d41\u3001\u6587\u4ef6\u5b58\u50a8\u3001\u5206\u5e03\u5f0f Actor \u7cfb\u7edf\u7b49\uff09\uff0c\u5e76\u9700\u8981\u51b3\u5b9a\u5c06\u54ea\u4e2a\u5206\u533a\u5206\u914d\u7ed9\u54ea\u4e2a\u8282\u70b9\u65f6\u3002\u5305\u62ec\u65b0\u8282\u70b9\u52a0\u5165\u548c\u79fb\u9664/\u5931\u6548\u65f6\u7684\u91cd\u65b0\u8d1f\u8f7d\u5e73\u8861\u3002</li> </ul> <p>\u8fd9\u7c7b\u4efb\u52a1\u53ef\u4ee5\u901a\u8fc7\u5728 ZooKeeper \u4e2d\u660e\u667a\u5730\u4f7f\u7528\u539f\u5b50\u64cd\u4f5c\uff0c\u4e34\u65f6\u8282\u70b9\u4e0e\u901a\u77e5\u6765\u5b9e\u73b0\u3002\u5141\u8bb8\u5e94\u7528\u81ea\u52a8\u4ece\u6545\u969c\u4e2d\u6062\u590d\u800c\u65e0\u9700\u4eba\u5de5\u5e72\u9884\u3002</p> <ul> <li>\u4e0d\u5c11\u5728 ZooKeeper \u5ba2\u6237\u7aef API \u57fa\u7840\u4e4b\u4e0a\u63d0\u4f9b\u66f4\u9ad8\u5c42\u5de5\u5177\u7684\u5e93\uff0c\u4f8b\u5982 Apache Curator \u301017\u3011\uff1b</li> <li>\u4ece\u5934\u5b9e\u73b0\u5fc5\u8981\u7684\u5171\u8bc6\u7b97\u6cd5\u7684\u5c1d\u8bd5\u9c9c\u6709\u6210\u529f\u8bb0\u5f55\u3010107\u3011\u3002</li> </ul> <p>\u5e94\u7528\u6700\u521d\u53ea\u80fd\u5728\u5355\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u4f46\u6700\u7ec8\u53ef\u80fd\u4f1a\u589e\u957f\u5230\u6570\u5343\u4e2a\u8282\u70b9\u3002\u8bd5\u56fe\u5728\u5982\u6b64\u4e4b\u591a\u7684\u8282\u70b9\u4e0a\u8fdb\u884c\u591a\u6570\u6295\u7968\u5c06\u662f\u975e\u5e38\u4f4e\u6548\u7684\u3002</p> <p>ZooKeeper \u5728\u56fa\u5b9a\u6570\u91cf\u7684\u8282\u70b9\uff08\u901a\u5e38\u662f\u4e09\u5230\u4e94\u4e2a\uff09\u4e0a\u8fd0\u884c\uff0c\u5e76\u5728\u8fd9\u4e9b\u8282\u70b9\u4e4b\u95f4\u6267\u884c\u5176\u591a\u6570\u7968\uff0c\u540c\u65f6\u652f\u6301\u6f5c\u5728\u7684\u5927\u91cf\u5ba2\u6237\u7aef\u3002\u63d0\u4f9b\u4e86\u4e00\u79cd\u5c06\u534f\u8c03\u8282\u70b9\uff08\u5171\u8bc6\uff0c\u64cd\u4f5c\u6392\u5e8f\u548c\u6545\u969c\u68c0\u6d4b\uff09\u7684\u4e00\u4e9b\u5de5\u4f5c \u201c\u5916\u5305\u201d \u5230\u5916\u90e8\u670d\u52a1\u7684\u65b9\u5f0f\u3002</p> <p>\u901a\u5e38\uff0c\u7531 ZooKeeper \u7ba1\u7406\u7684\u6570\u636e\u7c7b\u578b\u7684\u53d8\u5316\u5341\u5206\u7f13\u6162\uff1a\u4ee3\u8868 \u201c\u5206\u533a 7 \u4e2d\u7684\u8282\u70b9\u8fd0\u884c\u5728 <code>10.1.1.23</code> \u4e0a\u201d \u7684\u4fe1\u606f\u53ef\u80fd\u4f1a\u5728\u51e0\u5206\u949f\u6216\u51e0\u5c0f\u65f6\u7684\u65f6\u95f4\u5185\u53d1\u751f\u53d8\u5316\u3002\u5b83\u4e0d\u662f\u7528\u6765\u5b58\u50a8\u5e94\u7528\u7684\u8fd0\u884c\u65f6\u72b6\u6001\u7684\uff0c\u540e\u8005\u6bcf\u79d2\u53ef\u80fd\u4f1a\u6539\u53d8\u6570\u5343\u751a\u81f3\u6570\u767e\u4e07\u6b21\u3002\u5982\u679c\u5e94\u7528\u72b6\u6001\u9700\u8981\u4ece\u4e00\u4e2a\u8282\u70b9\u590d\u5236\u5230\u53e6\u4e00\u4e2a\u8282\u70b9\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5de5\u5177\uff08\u5982 Apache BookKeeper \u3010108\u3011\uff09\u3002</p>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_47","title":"\u670d\u52a1\u53d1\u73b0","text":"<p>ZooKeeper\u3001etcd \u548c Consul \u4e5f\u7ecf\u5e38\u7528\u4e8e\u670d\u52a1\u53d1\u73b0\uff1a\u914d\u7f6e\u4f60\u7684\u670d\u52a1\uff0c\u4f7f\u5176\u5728\u542f\u52a8\u65f6\u6ce8\u518c\u670d\u52a1\u6ce8\u518c\u8868\u4e2d\u7684\u7f51\u7edc\u7aef\u70b9\uff0c\u7136\u540e\u53ef\u4ee5\u7531\u5176\u4ed6\u670d\u52a1\u627e\u5230\u5b83\u4eec\u3002</p> <p>\u670d\u52a1\u53d1\u73b0\u662f\u5426\u9700\u8981\u8fbe\u6210\u5171\u8bc6\u8fd8\u4e0d\u592a\u6e05\u695a\u3002DNS \u662f\u67e5\u627e\u670d\u52a1\u540d\u79f0\u7684 IP \u5730\u5740\u7684\u4f20\u7edf\u65b9\u5f0f\uff0c\u5b83\u4f7f\u7528\u591a\u5c42\u7f13\u5b58\u6765\u5b9e\u73b0\u826f\u597d\u7684\u6027\u80fd\u548c\u53ef\u7528\u6027\u3002\u4ece DNS \u8bfb\u53d6\u662f\u7edd\u5bf9\u4e0d\u7ebf\u6027\u4e00\u81f4\u6027\u7684\uff0c\u5982\u679c DNS \u67e5\u8be2\u7684\u7ed3\u679c\u6709\u70b9\u9648\u65e7\uff0c\u901a\u5e38\u4e0d\u4f1a\u6709\u95ee\u9898\u3010109\u3011\u3002DNS \u7684\u53ef\u7528\u6027\u548c\u5bf9\u7f51\u7edc\u4e2d\u65ad\u7684\u9c81\u68d2\u6027\u66f4\u91cd\u8981\u3002</p> <p>\u5c3d\u7ba1\u670d\u52a1\u53d1\u73b0\u5e76\u4e0d\u9700\u8981\u5171\u8bc6\uff0c\u4f46\u9886\u5bfc\u8005\u9009\u4e3e\u5374\u9700\u8981\uff1a</p> <ul> <li>\u5982\u679c\u4f60\u7684\u5171\u8bc6\u7cfb\u7edf\u5df2\u7ecf\u77e5\u9053\u9886\u5bfc\u662f\u8c01\uff0c\u90a3\u4e48\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e9b\u4fe1\u606f\u6765\u5e2e\u52a9\u5176\u4ed6\u670d\u52a1\u53d1\u73b0\u9886\u5bfc\u662f\u8c01\uff1b</li> <li>\u4e3a\u6b64\uff0c\u4e00\u4e9b\u5171\u8bc6\u7cfb\u7edf\u652f\u6301\u53ea\u8bfb\u7f13\u5b58\u526f\u672c\uff0c\u5f02\u6b65\u63a5\u6536\u5171\u8bc6\u7b97\u6cd5\u6240\u6709\u51b3\u7b56\u7684\u65e5\u5fd7\uff0c\u4f46\u4e0d\u4e3b\u52a8\u53c2\u4e0e\u6295\u7968\u3002\u63d0\u4f9b\u4e0d\u9700\u8981\u7ebf\u6027\u4e00\u81f4\u6027\u7684\u8bfb\u53d6\u8bf7\u6c42\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_48","title":"\u6210\u5458\u8d44\u683c\u670d\u52a1","text":"<p>ZooKeeper \u548c\u5b83\u7684\u5c0f\u4f19\u4f34\u4eec\u53ef\u4ee5\u770b\u4f5c\u662f\u6210\u5458\u8d44\u683c\u670d\u52a1\uff08membership services\uff09\u7814\u7a76\u7684\u60a0\u4e45\u5386\u53f2\u7684\u4e00\u90e8\u5206\uff0c\u8fd9\u4e2a\u5386\u53f2\u53ef\u4ee5\u8ffd\u6eaf\u5230 20 \u4e16\u7eaa 80 \u5e74\u4ee3\uff0c\u5e76\u4e14\u5bf9\u5efa\u7acb\u9ad8\u5ea6\u53ef\u9760\u7684\u7cfb\u7edf\uff08\u4f8b\u5982\u7a7a\u4e2d\u4ea4\u901a\u7ba1\u5236\uff09\u975e\u5e38\u91cd\u8981\u3010110\u3011\u3002</p> <ul> <li>\u6210\u5458\u8d44\u683c\u670d\u52a1\u786e\u5b9a\u54ea\u4e9b\u8282\u70b9\u5f53\u524d\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\u5e76\u4e14\u662f\u96c6\u7fa4\u7684\u6d3b\u52a8\u6210\u5458\uff1b</li> <li>\u7531\u4e8e\u65e0\u9650\u7684\u7f51\u7edc\u5ef6\u8fdf\uff0c\u65e0\u6cd5\u53ef\u9760\u5730\u68c0\u6d4b\u5230\u53e6\u4e00\u4e2a\u8282\u70b9\u662f\u5426\u53d1\u751f\u6545\u969c\uff1b</li> <li>\u5982\u679c\u901a\u8fc7\u5171\u8bc6\u6765\u8fdb\u884c\u6545\u969c\u68c0\u6d4b\uff0c\u90a3\u4e48\u8282\u70b9\u53ef\u4ee5\u5c31\u54ea\u4e9b\u8282\u70b9\u5e94\u8be5\u88ab\u8ba4\u4e3a\u662f\u5b58\u5728\u6216\u4e0d\u5b58\u5728\u8fbe\u6210\u4e00\u81f4\u3002</li> </ul> <p>\u5373\u4f7f\u5b83\u786e\u5b9e\u5b58\u5728\uff0c\u4ecd\u7136\u53ef\u80fd\u53d1\u751f\u4e00\u4e2a\u8282\u70b9\u88ab\u5171\u8bc6\u9519\u8bef\u5730\u5ba3\u544a\u6b7b\u4ea1\u3002\u4f46\u662f\u5bf9\u4e8e\u4e00\u4e2a\u7cfb\u7edf\u6765\u8bf4\uff0c\u77e5\u9053\u54ea\u4e9b\u8282\u70b9\u6784\u6210\u4e86\u5f53\u524d\u7684\u6210\u5458\u5173\u7cfb\u662f\u975e\u5e38\u6709\u7528\u7684\uff1a</p> <ul> <li>\u9009\u62e9\u9886\u5bfc\u8005\u53ef\u80fd\u610f\u5473\u7740\u7b80\u5355\u5730\u9009\u62e9\u5f53\u524d\u6210\u5458\u4e2d\u7f16\u53f7\u6700\u5c0f\u7684\u6210\u5458\uff0c\u4f46\u5982\u679c\u4e0d\u540c\u7684\u8282\u70b9\u5bf9\u73b0\u6709\u7684\u6210\u5458\u90fd\u6709\u8c01\u6709\u4e0d\u540c\u610f\u89c1\uff0c\u5219\u8fd9\u79cd\u65b9\u6cd5\u5c06\u4e0d\u8d77\u4f5c\u7528\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/9_consistency_consensus.html#_49","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>Peter Bailis and Ali Ghodsi: \u201cEventual Consistency Today: Limitations, Extensions, and Beyond,\u201d ACM Queue, volume 11, number 3, pages 55-63, March 2013. doi:10.1145/2460276.2462076</li> <li>Prince Mahajan, Lorenzo Alvisi, and Mike Dahlin: \u201cConsistency, Availability, and Convergence,\u201d University of Texas at Austin, Department of Computer Science, Tech Report UTCS TR-11-22, May 2011.</li> <li>Alex Scotti: \u201cAdventures in Building Your Own Database,\u201d at All Your Base, November 2015.</li> <li>Peter Bailis, Aaron Davidson, Alan Fekete, et al.: \u201cHighly Available Transactions: Virtues and Limitations,\u201d at 40th International Conference on Very Large Data Bases (VLDB), September 2014. Extended version published as pre-print arXiv:1302.0309 [cs.DB].</li> <li>Paolo Viotti and Marko Vukoli\u0107: \u201cConsistency in Non-Transactional Distributed Storage Systems,\u201d arXiv:1512.00168, 12 April 2016.</li> <li>Maurice P. Herlihy and Jeannette M. Wing: \u201cLinearizability: A Correctness Condition for Concurrent Objects,\u201d ACM Transactions on Programming Languages and Systems (TOPLAS), volume 12, number 3, pages 463\u2013492, July 1990. doi:10.1145/78969.78972</li> <li>Leslie Lamport: \u201cOn interprocess communication,\u201d Distributed Computing, volume 1, number 2, pages 77\u2013101, June 1986. doi:10.1007/BF01786228</li> <li>David K. Gifford: \u201cInformation Storage in a Decentralized Computer System,\u201d Xerox Palo Alto Research Centers, CSL-81-8, June 1981.</li> <li>Martin Kleppmann: \u201cPlease Stop Calling Databases CP or AP,\u201d martin.kleppmann.com, May 11, 2015.</li> <li>Kyle Kingsbury: \u201cCall Me Maybe: MongoDB Stale Reads,\u201d aphyr.com, April 20, 2015.</li> <li>Kyle Kingsbury: \u201cComputational Techniques in Knossos,\u201d aphyr.com, May 17, 2014.</li> <li>Peter Bailis: \u201cLinearizability Versus Serializability,\u201d bailis.org, September 24, 2014.</li> <li>Philip A. Bernstein, Vassos Hadzilacos, and Nathan Goodman: Concurrency Control and Recovery in Database Systems. Addison-Wesley, 1987. ISBN: 978-0-201-10715-9, available online at research.microsoft.com.</li> <li>Mike Burrows: \u201cThe Chubby Lock Service for Loosely-Coupled Distributed Systems,\u201d at 7th USENIX Symposium on Operating System Design and Implementation (OSDI), November 2006.</li> <li>Flavio P. Junqueira and Benjamin Reed: ZooKeeper: Distributed Process Coordination. O'Reilly Media, 2013. ISBN: 978-1-449-36130-3</li> <li>\u201cetcd 2.0.12 Documentation,\u201d CoreOS, Inc., 2015.</li> <li>\u201cApache Curator,\u201d Apache Software Foundation, curator.apache.org, 2015.</li> <li>Morali Vallath: Oracle 10g RAC Grid, Services &amp; Clustering. Elsevier Digital Press, 2006. ISBN: 978-1-555-58321-7</li> <li>Peter Bailis, Alan Fekete, Michael J Franklin, et al.: \u201cCoordination-Avoiding Database Systems,\u201d Proceedings of the VLDB Endowment, volume 8, number 3, pages 185\u2013196, November 2014.</li> <li>Kyle Kingsbury: \u201cCall Me Maybe: etcd and Consul,\u201d aphyr.com, June 9, 2014.</li> <li>Flavio P. Junqueira, Benjamin C. Reed, and Marco Serafini: \u201cZab: High-Performance Broadcast for Primary-Backup Systems,\u201d at 41st IEEE International Conference on Dependable Systems and Networks (DSN), June 2011. doi:10.1109/DSN.2011.5958223</li> <li>Diego Ongaro and John K. Ousterhout: \u201cIn Search of an Understandable Consensus Algorithm (Extended Version),\u201d at USENIX Annual Technical Conference (ATC), June 2014.</li> <li>Hagit Attiya, Amotz Bar-Noy, and Danny Dolev: \u201cSharing Memory Robustly in Message-Passing Systems,\u201d Journal of the ACM, volume 42, number 1, pages 124\u2013142, January 1995. doi:10.1145/200836.200869</li> <li>Nancy Lynch and Alex Shvartsman: \u201cRobust Emulation of Shared Memory Using Dynamic Quorum-Acknowledged Broadcasts,\u201d at 27th Annual International Symposium on Fault-Tolerant Computing (FTCS), June 1997. doi:10.1109/FTCS.1997.614100</li> <li>Christian Cachin, Rachid Guerraoui, and Lu\u00eds Rodrigues: Introduction to Reliable and Secure Distributed Programming, 2nd edition. Springer, 2011. ISBN: 978-3-642-15259-7, doi:10.1007/978-3-642-15260-3</li> <li>Sam Elliott, Mark Allen, and Martin Kleppmann: personal communication, thread on twitter.com, October 15, 2015.</li> <li>Niklas Ekstr\u00f6m, Mikhail Panchenko, and Jonathan Ellis: \u201cPossible Issue with Read Repair?,\u201d email thread on cassandra-dev mailing list, October 2012.</li> <li>Maurice P. Herlihy: \u201cWait-Free Synchronization,\u201d ACM Transactions on Programming Languages and Systems (TOPLAS), volume 13, number 1, pages 124\u2013149, January 1991. doi:10.1145/114005.102808</li> <li>Armando Fox and Eric A. Brewer: \u201cHarvest, Yield, and Scalable Tolerant Systems,\u201d at 7th Workshop on Hot Topics in Operating Systems (HotOS), March 1999. doi:10.1109/HOTOS.1999.798396</li> <li>Seth Gilbert and Nancy Lynch: \u201cBrewer\u2019s Conjecture and the Feasibility of Consistent, Available, Partition-Tolerant Web Services,\u201d ACM SIGACT News, volume 33, number 2, pages 51\u201359, June 2002. doi:10.1145/564585.564601</li> <li>Seth Gilbert and Nancy Lynch: \u201cPerspectives on the CAP Theorem,\u201d IEEE Computer Magazine, volume 45, number 2, pages 30\u201336, February 2012. doi:10.1109/MC.2011.389</li> <li>Eric A. Brewer: \u201cCAP Twelve Years Later: How the 'Rules' Have Changed,\u201d IEEE Computer Magazine, volume 45, number 2, pages 23\u201329, February 2012. doi:10.1109/MC.2012.37</li> <li>Susan B. Davidson, Hector Garcia-Molina, and Dale Skeen: \u201cConsistency in Partitioned Networks,\u201d ACM Computing Surveys, volume 17, number 3, pages 341\u2013370, September 1985. doi:10.1145/5505.5508</li> <li>Paul R. Johnson and Robert H. Thomas: \u201cRFC 677: The Maintenance of Duplicate Databases,\u201d Network Working Group, January 27, 1975.</li> <li>Bruce G. Lindsay, Patricia Griffiths Selinger, C. Galtieri, et al.: \u201cNotes on Distributed Databases,\u201d IBM Research, Research Report RJ2571(33471), July 1979.</li> <li>Michael J. Fischer and Alan Michael: \u201cSacrificing Serializability to Attain High Availability of Data in an Unreliable Network,\u201d at 1st ACM Symposium on Principles of Database Systems (PODS), March 1982. doi:10.1145/588111.588124</li> <li>Eric A. Brewer: \u201cNoSQL: Past, Present, Future,\u201d at QCon San Francisco, November 2012.</li> <li>Henry Robinson: \u201cCAP Confusion: Problems with 'Partition Tolerance,'\u201d blog.cloudera.com, April 26, 2010.</li> <li>Adrian Cockcroft: \u201cMigrating to Microservices,\u201d at QCon London, March 2014.</li> <li>Martin Kleppmann: \u201cA Critique of the CAP Theorem,\u201d arXiv:1509.05393, September 17, 2015.</li> <li>Nancy A. Lynch: \u201cA Hundred Impossibility Proofs for Distributed Computing,\u201d at 8th ACM Symposium on Principles of Distributed Computing (PODC), August 1989. doi:10.1145/72981.72982</li> <li>Hagit Attiya, Faith Ellen, and Adam Morrison: \u201cLimitations of Highly-Available Eventually-Consistent Data Stores,\u201d at ACM Symposium on Principles of Distributed Computing (PODC), July 2015. doi:10.1145/2767386.2767419](http://dx.doi.org/10.1145/2767386.2767419)</li> <li>Peter Sewell, Susmit Sarkar, Scott Owens, et al.: \u201cx86-TSO: A Rigorous and Usable Programmer's Model for x86 Multiprocessors,\u201d Communications of the ACM, volume 53, number 7, pages 89\u201397, July 2010. doi:10.1145/1785414.1785443</li> <li>Martin Thompson: \u201cMemory Barriers/Fences,\u201d mechanical-sympathy.blogspot.co.uk, July 24, 2011.</li> <li>Ulrich Drepper: \u201cWhat Every Programmer Should Know About Memory,\u201d akkadia.org, November 21, 2007.</li> <li>Daniel J. Abadi: \u201cConsistency Tradeoffs in Modern Distributed Database System Design,\u201d IEEE Computer Magazine, volume 45, number 2, pages 37\u201342, February 2012. doi:10.1109/MC.2012.33</li> <li>Hagit Attiya and Jennifer L. Welch: \u201cSequential Consistency Versus Linearizability,\u201d ACM Transactions on Computer Systems (TOCS), volume 12, number 2, pages 91\u2013122, May 1994. doi:10.1145/176575.176576</li> <li>Mustaque Ahamad, Gil Neiger, James E. Burns, et al.: \u201cCausal Memory: Definitions, Implementation, and Programming,\u201d Distributed Computing, volume 9, number 1, pages 37\u201349, March 1995. doi:10.1007/BF01784241</li> <li>Wyatt Lloyd, Michael J. Freedman, Michael Kaminsky, and David G. Andersen: \u201cStronger Semantics for Low-Latency Geo-Replicated Storage,\u201d at 10th USENIX Symposium on Networked Systems Design and Implementation (NSDI), April 2013.</li> <li>Marek Zawirski, Annette Bieniusa, Valter Balegas, et al.: \u201cSwiftCloud: Fault-Tolerant Geo-Replication Integrated All the Way to the Client Machine,\u201d INRIA Research Report 8347, August 2013.</li> <li>Peter Bailis, Ali Ghodsi, Joseph M Hellerstein, and Ion Stoica: \u201cBolt-on Causal Consistency,\u201d at ACM International Conference on Management of Data (SIGMOD), June 2013.</li> <li>Philippe Ajoux, Nathan Bronson, Sanjeev Kumar, et al.: \u201cChallenges to Adopting Stronger Consistency at Scale,\u201d at 15th USENIX Workshop on Hot Topics in Operating Systems (HotOS), May 2015.</li> <li>Peter Bailis: \u201cCausality Is Expensive (and What to Do About It),\u201d bailis.org, February 5, 2014.</li> <li>Ricardo Gon\u00e7alves, Paulo S\u00e9rgio Almeida, Carlos Baquero, and Victor Fonte: \u201cConcise Server-Wide Causality Management for Eventually Consistent Data Stores,\u201d at 15th IFIP International Conference on Distributed Applications and Interoperable Systems (DAIS), June 2015. doi:10.1007/978-3-319-19129-4_6</li> <li>Rob Conery: \u201cA Better ID Generator for PostgreSQL,\u201d rob.conery.io, May 29, 2014.</li> <li>Leslie Lamport: \u201cTime, Clocks, and the Ordering of Events in a Distributed System,\u201d Communications of the ACM, volume 21, number 7, pages 558\u2013565, July 1978. doi:10.1145/359545.359563</li> <li>Xavier D\u00e9fago, Andr\u00e9 Schiper, and P\u00e9ter Urb\u00e1n: \u201cTotal Order Broadcast and Multicast Algorithms: Taxonomy and Survey,\u201d ACM Computing Surveys, volume 36, number 4, pages 372\u2013421, December 2004. doi:10.1145/1041680.1041682</li> <li>Hagit Attiya and Jennifer Welch: Distributed Computing: Fundamentals, Simulations and Advanced Topics, 2nd edition. John Wiley &amp; Sons, 2004. ISBN: 978-0-471-45324-6, doi:10.1002/0471478210</li> <li>Mahesh Balakrishnan, Dahlia Malkhi, Vijayan Prabhakaran, et al.: \u201cCORFU: A Shared Log Design for Flash Clusters,\u201d at 9th USENIX Symposium on Networked Systems Design and Implementation (NSDI), April 2012.</li> <li>Fred B. Schneider: \u201cImplementing Fault-Tolerant Services Using the State Machine Approach: A Tutorial,\u201d ACM Computing Surveys, volume 22, number 4, pages 299\u2013319, December 1990.</li> <li>Alexander Thomson, Thaddeus Diamond, Shu-Chun Weng, et al.: \u201cCalvin: Fast Distributed Transactions for Partitioned Database Systems,\u201d at ACM International Conference on Management of Data (SIGMOD), May 2012.</li> <li>Mahesh Balakrishnan, Dahlia Malkhi, Ted Wobber, et al.: \u201cTango: Distributed Data Structures over a Shared Log,\u201d at 24th ACM Symposium on Operating Systems Principles (SOSP), November 2013. doi:10.1145/2517349.2522732</li> <li>Robbert van Renesse and Fred B. Schneider: \u201cChain Replication for Supporting High Throughput and Availability,\u201d at 6th USENIX Symposium on Operating System Design and Implementation (OSDI), December 2004.</li> <li>Leslie Lamport: \u201cHow to Make a Multiprocessor Computer That Correctly Executes Multiprocess Programs,\u201d IEEE Transactions on Computers, volume 28, number 9, pages 690\u2013691, September 1979. doi:10.1109/TC.1979.1675439</li> <li>Enis S\u00f6ztutar, Devaraj Das, and Carter Shanklin: \u201cApache HBase High Availability at the Next Level,\u201d hortonworks.com, January 22, 2015.</li> <li>Brian F Cooper, Raghu Ramakrishnan, Utkarsh Srivastava, et al.: \u201cPNUTS: Yahoo!\u2019s Hosted Data Serving Platform,\u201d at 34th International Conference on Very Large Data Bases (VLDB), August 2008. doi:10.14778/1454159.1454167</li> <li>Tushar Deepak Chandra and Sam Toueg: \u201cUnreliable Failure Detectors for Reliable Distributed Systems,\u201d Journal of the ACM, volume 43, number 2, pages 225\u2013267, March 1996. doi:10.1145/226643.226647</li> <li>Michael J. Fischer, Nancy Lynch, and Michael S. Paterson: \u201cImpossibility of Distributed Consensus with One Faulty Process,\u201d Journal of the ACM, volume 32, number 2, pages 374\u2013382, April 1985. doi:10.1145/3149.214121</li> <li>Michael Ben-Or: \u201cAnother Advantage of Free Choice: Completely Asynchronous Agreement Protocols,\u201d at 2nd ACM Symposium on Principles of Distributed Computing (PODC), August 1983. doi:10.1145/800221.806707</li> <li>Jim N. Gray and Leslie Lamport: \u201cConsensus on Transaction Commit,\u201d ACM Transactions on Database Systems (TODS), volume 31, number 1, pages 133\u2013160, March 2006. doi:10.1145/1132863.1132867</li> <li>Rachid Guerraoui: \u201cRevisiting the Relationship Between Non-Blocking Atomic Commitment and Consensus,\u201d at 9th International Workshop on Distributed Algorithms (WDAG), September 1995. doi:10.1007/BFb0022140</li> <li>Thanumalayan Sankaranarayana Pillai, Vijay Chidambaram, Ramnatthan Alagappan, et al.: \u201cAll File Systems Are Not Created Equal: On the Complexity of Crafting Crash-Consistent Applications,\u201d at 11th USENIX Symposium on Operating Systems Design and Implementation (OSDI), October 2014.</li> <li>Jim Gray: \u201cThe Transaction Concept: Virtues and Limitations,\u201d at 7th International Conference on Very Large Data Bases (VLDB), September 1981.</li> <li>Hector Garcia-Molina and Kenneth Salem: \u201cSagas,\u201d at ACM International Conference on Management of Data (SIGMOD), May 1987. doi:10.1145/38713.38742</li> <li>C. Mohan, Bruce G. Lindsay, and Ron Obermarck: \u201cTransaction Management in the R* Distributed Database Management System,\u201d ACM Transactions on Database Systems, volume 11, number 4, pages 378\u2013396, December 1986. doi:10.1145/7239.7266</li> <li>\u201cDistributed Transaction Processing: The XA Specification,\u201d X/Open Company Ltd., Technical Standard XO/CAE/91/300, December 1991. ISBN: 978-1-872-63024-3</li> <li>Mike Spille: \u201cXA Exposed, Part II,\u201d jroller.com, April 3, 2004.</li> <li>Ivan Silva Neto and Francisco Reverbel: \u201cLessons Learned from Implementing WS-Coordination and WS-AtomicTransaction,\u201d at 7th IEEE/ACIS International Conference on Computer and Information Science (ICIS), May 2008. doi:10.1109/ICIS.2008.75</li> <li>James E. Johnson, David E. Langworthy, Leslie Lamport, and Friedrich H. Vogt: \u201cFormal Specification of a Web Services Protocol,\u201d at 1st International Workshop on Web Services and Formal Methods (WS-FM), February 2004. doi:10.1016/j.entcs.2004.02.022</li> <li>Dale Skeen: \u201cNonblocking Commit Protocols,\u201d at ACM International Conference on Management of Data (SIGMOD), April 1981. doi:10.1145/582318.582339</li> <li>Gregor Hohpe: \u201cYour Coffee Shop Doesn\u2019t Use Two-Phase Commit,\u201d IEEE Software, volume 22, number 2, pages 64\u201366, March 2005. doi:10.1109/MS.2005.52</li> <li>Pat Helland: \u201cLife Beyond Distributed Transactions: An Apostate\u2019s Opinion,\u201d at 3rd Biennial Conference on Innovative Data Systems Research (CIDR), January 2007.</li> <li>Jonathan Oliver: \u201cMy Beef with MSDTC and Two-Phase Commits,\u201d blog.jonathanoliver.com, April 4, 2011.</li> <li>Oren Eini (Ahende Rahien): \u201cThe Fallacy of Distributed Transactions,\u201d ayende.com, July 17, 2014.</li> <li>Clemens Vasters: \u201cTransactions in Windows Azure (with Service Bus) \u2013 An Email Discussion,\u201d vasters.com, July 30, 2012.</li> <li>\u201cUnderstanding Transactionality in Azure,\u201d NServiceBus Documentation, Particular Software, 2015.</li> <li>Randy Wigginton, Ryan Lowe, Marcos Albe, and Fernando Ipar: \u201cDistributed Transactions in MySQL,\u201d at MySQL Conference and Expo, April 2013.</li> <li>Mike Spille: \u201cXA Exposed, Part I,\u201d jroller.com, April 3, 2004.</li> <li>Ajmer Dhariwal: \u201cOrphaned MSDTC Transactions (-2 spids),\u201d eraofdata.com, December 12, 2008.</li> <li>Paul Randal: \u201cReal World Story of DBCC PAGE Saving the Day,\u201d sqlskills.com, June 19, 2013.</li> <li>\u201cin-doubt xact resolution Server Configuration Option,\u201d SQL Server 2016 documentation, Microsoft, Inc., 2016.</li> <li>Cynthia Dwork, Nancy Lynch, and Larry Stockmeyer: \u201cConsensus in the Presence of Partial Synchrony,\u201d Journal of the ACM, volume 35, number 2, pages 288\u2013323, April 1988. doi:10.1145/42282.42283</li> <li>Miguel Castro and Barbara H. Liskov: \u201cPractical Byzantine Fault Tolerance and Proactive Recovery,\u201d ACM Transactions on Computer Systems, volume 20, number 4, pages 396\u2013461, November 2002. doi:10.1145/571637.571640</li> <li>Brian M. Oki and Barbara H. Liskov: \u201cViewstamped Replication: A New Primary Copy Method to Support Highly-Available Distributed Systems,\u201d at 7th ACM Symposium on Principles of Distributed Computing (PODC), August 1988. doi:10.1145/62546.62549</li> <li>Barbara H. Liskov and James Cowling: \u201cViewstamped Replication Revisited,\u201d Massachusetts Institute of Technology, Tech Report MIT-CSAIL-TR-2012-021, July 2012.</li> <li>Leslie Lamport: \u201cThe Part-Time Parliament,\u201d ACM Transactions on Computer Systems, volume 16, number 2, pages 133\u2013169, May 1998. doi:10.1145/279227.279229</li> <li>Leslie Lamport: \u201cPaxos Made Simple,\u201d ACM SIGACT News, volume 32, number 4, pages 51\u201358, December 2001.</li> <li>Tushar Deepak Chandra, Robert Griesemer, and Joshua Redstone: \u201cPaxos Made Live \u2013 An Engineering Perspective,\u201d at 26th ACM Symposium on Principles of Distributed Computing (PODC), June 2007.</li> <li>Robbert van Renesse: \u201cPaxos Made Moderately Complex,\u201d cs.cornell.edu, March 2011.</li> <li>Diego Ongaro: \u201cConsensus: Bridging Theory and Practice,\u201d PhD Thesis, Stanford University, August 2014.</li> <li>Heidi Howard, Malte Schwarzkopf, Anil Madhavapeddy, and Jon Crowcroft: \u201cRaft Refloated: Do We Have Consensus?,\u201d ACM SIGOPS Operating Systems Review, volume 49, number 1, pages 12\u201321, January 2015. doi:10.1145/2723872.2723876</li> <li>Andr\u00e9 Medeiros: \u201cZooKeeper\u2019s Atomic Broadcast Protocol: Theory and Practice,\u201d Aalto University School of Science, March 20, 2012.</li> <li>Robbert van Renesse, Nicolas Schiper, and Fred B. Schneider: \u201cVive La Diff\u00e9rence: Paxos vs. Viewstamped Replication vs. Zab,\u201d IEEE Transactions on Dependable and Secure Computing, volume 12, number 4, pages 472\u2013484, September 2014. doi:10.1109/TDSC.2014.2355848</li> <li>Will Portnoy: \u201cLessons Learned from Implementing Paxos,\u201d blog.willportnoy.com, June 14, 2012.</li> <li>Heidi Howard, Dahlia Malkhi, and Alexander Spiegelman: \u201cFlexible Paxos: Quorum Intersection Revisited,\u201d arXiv:1608.06696, August 24, 2016.</li> <li>Heidi Howard and Jon Crowcroft: \u201cCoracle: Evaluating Consensus at the Internet Edge,\u201d at Annual Conference of the ACM Special Interest Group on Data Communication (SIGCOMM), August 2015. doi:10.1145/2829988.2790010</li> <li>Kyle Kingsbury: \u201cCall Me Maybe: Elasticsearch 1.5.0,\u201d aphyr.com, April 27, 2015.</li> <li>Ivan Kelly: \u201cBookKeeper Tutorial,\u201d github.com, October 2014.</li> <li>Camille Fournier: \u201cConsensus Systems for the Skeptical Architect,\u201d at Craft Conference, Budapest, Hungary, April 2015.</li> <li>Kenneth P. Birman: \u201cA History of the Virtual Synchrony Replication Model,\u201d in Replication: Theory and Practice, Springer LNCS volume 5959, chapter 6, pages 91\u2013120, 2010. ISBN: 978-3-642-11293-5, doi:10.1007/978-3-642-11294-2_6</li> </ol> <ol> <li> <p>\u8bbe R \u4e3a\u975e\u7a7a\u96c6\u5408 A \u4e0a\u7684\u5173\u7cfb\uff0c\u5982\u679c R \u662f\u81ea\u53cd\u7684\u3001\u53cd\u5bf9\u79f0\u7684\u548c\u53ef\u4f20\u9012\u7684\uff0c\u5219\u79f0 R \u4e3a A \u4e0a\u7684\u504f\u5e8f\u5173\u7cfb\u3002\u7b80\u79f0\u504f\u5e8f\uff0c\u901a\u5e38\u8bb0\u4f5c\u2266\u3002\u4e00\u4e2a\u96c6\u5408 A \u4e0e A \u4e0a\u7684\u504f\u5e8f\u5173\u7cfb R \u4e00\u8d77\u53eb\u4f5c\u504f\u5e8f\u96c6\uff0c\u8bb0\u4f5c \\((A,R)\\) \u6216 \\((A, \u2266)\\)\u3002\u5168\u5e8f\u3001\u504f\u5e8f\u3001\u5173\u7cfb\u3001\u96c6\u5408\uff0c\u8fd9\u4e9b\u6982\u5ff5\u7684\u7cbe\u786e\u5b9a\u4e49\u53ef\u4ee5\u53c2\u8003\u4efb\u610f\u4e00\u672c\u79bb\u6563\u6570\u5b66\u6559\u6750\u3002\u00a0\u21a9</p> </li> <li> <p>\u4e0e\u56e0\u679c\u5173\u7cfb\u4e0d\u4e00\u81f4\u7684\u5168\u5e8f\u5f88\u5bb9\u6613\u521b\u5efa\uff0c\u4f46\u6ca1\u5565\u7528\u3002\u4f8b\u5982\u4f60\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u64cd\u4f5c\u751f\u6210\u968f\u673a\u7684 UUID\uff0c\u5e76\u6309\u7167\u5b57\u5178\u5e8f\u6bd4\u8f83 UUID\uff0c\u4ee5\u5b9a\u4e49\u64cd\u4f5c\u7684\u5168\u5e8f\u3002\u8fd9\u662f\u4e00\u4e2a\u6709\u6548\u7684\u5168\u5e8f\uff0c\u4f46\u662f\u968f\u673a\u7684 UUID \u5e76\u4e0d\u80fd\u544a\u8bc9\u4f60\u54ea\u4e2a\u64cd\u4f5c\u5148\u53d1\u751f\uff0c\u6216\u8005\u64cd\u4f5c\u662f\u5426\u4e3a\u5e76\u53d1\u7684\u3002\u00a0\u21a9</p> </li> <li> <p>\u201c\u539f\u5b50\u5e7f\u64ad\u201d \u662f\u4e00\u4e2a\u4f20\u7edf\u7684\u672f\u8bed\uff0c\u975e\u5e38\u6df7\u4e71\uff0c\u800c\u4e14\u4e0e \u201c\u539f\u5b50\u201d \u4e00\u8bcd\u7684\u5176\u4ed6\u7528\u6cd5\u4e0d\u4e00\u81f4\uff1a\u5b83\u4e0e ACID \u4e8b\u52a1\u4e2d\u7684\u539f\u5b50\u6027\u6ca1\u6709\u4efb\u4f55\u5173\u7cfb\uff0c\u53ea\u662f\u4e0e\u539f\u5b50\u64cd\u4f5c\uff08\u5728\u591a\u7ebf\u7a0b\u7f16\u7a0b\u7684\u610f\u4e49\u4e0a \uff09\u6216\u539f\u5b50\u5bc4\u5b58\u5668\uff08\u7ebf\u6027\u4e00\u81f4\u5b58\u50a8\uff09\u6709\u95f4\u63a5\u7684\u8054\u7cfb\u3002\u5168\u5e8f\u7ec4\u64ad\uff08total order multicast\uff09\u662f\u53e6\u4e00\u4e2a\u540c\u4e49\u8bcd\u3002\u00a0\u21a9</p> </li> <li> <p>\u4ece\u5f62\u5f0f\u4e0a\u8bb2\uff0c\u7ebf\u6027\u4e00\u81f4\u8bfb\u5199\u5bc4\u5b58\u5668\u662f\u4e00\u4e2a \u201c\u66f4\u5bb9\u6613\u201d \u7684\u95ee\u9898\u3002\u5168\u5e8f\u5e7f\u64ad\u7b49\u4ef7\u4e8e\u5171\u8bc6\u301067\u3011\uff0c\u800c\u5171\u8bc6\u95ee\u9898\u5728\u5f02\u6b65\u7684\u5d29\u6e83 - \u505c\u6b62\u6a21\u578b\u301068\u3011\u4e2d\u6ca1\u6709\u786e\u5b9a\u6027\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u800c\u7ebf\u6027\u4e00\u81f4\u7684\u8bfb\u5199\u5bc4\u5b58\u5668 \u53ef\u4ee5 \u5728\u8fd9\u79cd\u6a21\u578b\u4e2d\u5b9e\u73b0\u301023,24,25\u3011\u3002\u7136\u800c\uff0c\u652f\u6301\u8bf8\u5982 \u6bd4\u8f83\u5e76\u8bbe\u7f6e\uff08CAS, compare-and-set\uff09\uff0c\u6216 \u81ea\u589e\u5e76\u8fd4\u56de\uff08increment-and-get\uff09 \u7684\u539f\u5b50\u64cd\u4f5c\u4f7f\u5b83\u7b49\u4ef7\u4e8e\u5171\u8bc6\u95ee\u9898\u301028\u3011\u3002\u56e0\u6b64\uff0c\u5171\u8bc6\u95ee\u9898\u4e0e\u7ebf\u6027\u4e00\u81f4\u5bc4\u5b58\u5668\u95ee\u9898\u5bc6\u5207\u76f8\u5173\u3002\u00a0\u21a9</p> </li> <li> <p>\u8fd9\u79cd\u5171\u8bc6\u7684\u7279\u6b8a\u5f62\u5f0f\u88ab\u79f0\u4e3a \u7edf\u4e00\u5171\u8bc6\uff08uniform consensus\uff09\uff0c\u76f8\u5f53\u4e8e\u5728\u5177\u6709\u4e0d\u53ef\u9760\u6545\u969c\u68c0\u6d4b\u5668\u7684\u5f02\u6b65\u7cfb\u7edf\u4e2d\u7684 \u5e38\u89c4\u5171\u8bc6\uff08regular consensus\uff09\u301071\u3011\u3002\u5b66\u672f\u6587\u732e\u901a\u5e38\u6307\u7684\u662f \u8fdb\u7a0b\uff08process\uff09 \u800c\u4e0d\u662f\u8282\u70b9\uff0c\u4f46\u6211\u4eec\u5728\u8fd9\u91cc\u4f7f\u7528 \u8282\u70b9\uff08node\uff09 \u6765\u4e0e\u672c\u4e66\u7684\u5176\u4f59\u90e8\u5206\u4fdd\u6301\u4e00\u81f4\u3002\u00a0\u21a9</p> </li> <li> <p>\u4e25\u683c\u5730\u8bf4\uff0cZooKeeper \u548c etcd \u63d0\u4f9b\u7ebf\u6027\u4e00\u81f4\u6027\u7684\u5199\u64cd\u4f5c\uff0c\u4f46\u8bfb\u53d6\u53ef\u80fd\u662f\u9648\u65e7\u7684\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b83\u4eec\u53ef\u4ee5\u7531\u4efb\u4f55\u4e00\u4e2a\u526f\u672c\u63d0\u4f9b\u670d\u52a1\u3002\u4f60\u53ef\u4ee5\u9009\u62e9\u8bf7\u6c42\u7ebf\u6027\u4e00\u81f4\u6027\u8bfb\u53d6\uff1aetcd \u79f0\u4e4b\u4e3a \u6cd5\u5b9a\u4eba\u6570\u8bfb\u53d6\uff08quorum read\uff09\u301016\u3011\uff0c\u800c\u5728 ZooKeeper \u4e2d\uff0c\u4f60\u9700\u8981\u5728\u8bfb\u53d6\u4e4b\u524d\u8c03\u7528 <code>sync()</code>\u301015\u3011\u3002\u8bf7\u53c2\u9605 \u201c\u4f7f\u7528\u5168\u5e8f\u5e7f\u64ad\u5b9e\u73b0\u7ebf\u6027\u4e00\u81f4\u7684\u5b58\u50a8\u201d\u3002\u00a0\u21a9</p> </li> <li> <p>\u5bf9\u5355\u4e3b\u6570\u636e\u5e93\u8fdb\u884c\u5206\u533a\uff08\u5206\u7247\uff09\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u5206\u533a\u6709\u4e00\u4e2a\u5355\u72ec\u7684\u9886\u5bfc\u8005\uff0c\u4e0d\u4f1a\u5f71\u54cd\u7ebf\u6027\u4e00\u81f4\u6027\uff0c\u56e0\u4e3a\u7ebf\u6027\u4e00\u81f4\u6027\u53ea\u662f\u5bf9\u5355\u4e00\u5bf9\u8c61\u7684\u4fdd\u8bc1\u3002\u4ea4\u53c9\u5206\u533a\u4e8b\u52a1\u662f\u4e00\u4e2a\u4e0d\u540c\u7684\u95ee\u9898\uff08\u8bf7\u53c2\u9605 \u201c\u5206\u5e03\u5f0f\u4e8b\u52a1\u4e0e\u5171\u8bc6\u201d\uff09\u00a0\u21a9</p> </li> <li> <p>\u5982\u679c\u4f60\u4e0d\u7b49\u5f85\uff0c\u800c\u662f\u5728\u6d88\u606f\u5165\u961f\u4e4b\u540e\u7acb\u5373\u786e\u8ba4\u5199\u5165\uff0c\u5219\u4f1a\u5f97\u5230\u7c7b\u4f3c\u4e8e\u591a\u6838 x86 \u5904\u7406\u5668\u5185\u5b58\u7684\u4e00\u81f4\u6027\u6a21\u578b\u301043\u3011\u3002\u8be5\u6a21\u578b\u65e2\u4e0d\u662f\u7ebf\u6027\u4e00\u81f4\u7684\u4e5f\u4e0d\u662f\u987a\u5e8f\u4e00\u81f4\u7684\u3002\u00a0\u21a9</p> </li> <li> <p>\u539f\u5b50\u63d0\u4ea4\u7684\u5f62\u5f0f\u5316\u4e0e\u5171\u8bc6\u7a0d\u6709\u4e0d\u540c\uff1a\u539f\u5b50\u4e8b\u52a1\u53ea\u6709\u5728 \u6240\u6709 \u53c2\u4e0e\u8005\u6295\u7968\u63d0\u4ea4\u7684\u60c5\u51b5\u4e0b\u624d\u80fd\u63d0\u4ea4\uff0c\u5982\u679c\u6709\u4efb\u4f55\u53c2\u4e0e\u8005\u9700\u8981\u4e2d\u6b62\uff0c\u5219\u5fc5\u987b\u4e2d\u6b62\u3002\u5171\u8bc6\u5219\u5141\u8bb8\u5c31 \u4efb\u610f\u4e00\u4e2a \u88ab\u53c2\u4e0e\u8005\u63d0\u51fa\u7684\u5019\u9009\u503c\u8fbe\u6210\u4e00\u81f4\u3002\u7136\u800c\uff0c\u539f\u5b50\u63d0\u4ea4\u548c\u5171\u8bc6\u53ef\u4ee5\u76f8\u4e92\u7b80\u5316\u4e3a\u5bf9\u65b9\u301070,71\u3011\u3002\u975e\u963b\u585e \u539f\u5b50\u63d0\u4ea4\u5219\u8981\u6bd4\u5171\u8bc6\u66f4\u4e3a\u56f0\u96be \u2014\u2014 \u8bf7\u53c2\u9605 \u201c\u4e09\u9636\u6bb5\u63d0\u4ea4\u201d\u00a0\u21a9</p> </li> </ol>"},{"location":"books/data_intensive_system_book/part2_distributed_data.html","title":"\u7b2c\u4e8c\u90e8\u5206\uff1a\u5206\u5e03\u5f0f\u6570\u636e","text":"<p>\u5982\u679c \u591a\u53f0\u673a\u5668 \u53c2\u4e0e\u6570\u636e\u7684\u5b58\u50a8\u548c\u68c0\u7d22\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f</p> <p>\u51fa\u4e8e\u5404\u79cd\u5404\u6837\u7684\u539f\u56e0\uff0c\u5e0c\u671b\u5c06\u6570\u636e\u5e93\u5206\u5e03\u5230\u591a\u53f0\u673a\u5668\u4e0a</p> <ul> <li>\u53ef\u4f38\u7f29\u6027\uff1a\u8d1f\u8f7d\u5206\u6563\u5230\u591a\u53f0\u8ba1\u7b97\u673a\uff1b</li> <li>\u5bb9\u9519 / \u9ad8\u53ef\u7528\u6027\uff1a\u5355\u53f0\u673a\u5668\uff08\u6216\u591a\u53f0\u673a\u5668\uff0c\u7f51\u7edc\u6216\u6574\u4e2a\u6570\u636e\u4e2d\u5fc3\uff09\u51fa\u73b0\u6545\u969c\u7684\u60c5\u51b5\u4e0b\u4ecd\u7136\u80fd\u7ee7\u7eed\u5de5\u4f5c</li> <li>\u5ef6\u8fdf\uff1a\u5168\u7403\u8303\u56f4\u90e8\u7f72\u591a\u4e2a\u670d\u52a1\u5668\uff0c\u4ece\u5730\u7406\u4e0a\u6700\u8fd1\u7684\u6570\u636e\u4e2d\u5fc3\u83b7\u53d6\u670d\u52a1\u3002</li> </ul>"},{"location":"books/data_intensive_system_book/part2_distributed_data.html#_2","title":"\u4f38\u7f29\u5230\u66f4\u9ad8\u8d1f\u8f7d","text":"<p>\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u8d2d\u4e70\u66f4\u5f3a\u5927\u7684\u673a\u5668\uff08\u6709\u65f6\u79f0\u4e3a \u5782\u76f4\u4f38\u7f29\uff0c\u5373 vertical scaling\uff0c\u6216 \u5411\u4e0a\u4f38\u7f29\uff0c\u5373 scale up\uff09\uff0c\u5373 \u5171\u4eab\u5185\u5b58\u67b6\u6784\uff08shared-memory architecture\uff09\u3002</p> <ul> <li>\u95ee\u9898\uff1a\u6210\u672c\u7684\u589e\u957f\u901f\u5ea6\u5feb\u4e8e\u8d1f\u8f7d\u7684\u7ebf\u6027\u589e\u957f\uff1b\u63d0\u4f9b\u6709\u9650\u7684\u5bb9\u9519\u80fd\u529b</li> </ul> <p>\u53e6\u4e00\u79cd\u662f\u5171\u4eab\u78c1\u76d8\u67b6\u6784\uff08shared-disk architecture\uff09\u201c\uff1a\u591a\u53f0\u5177\u6709\u72ec\u7acb\u5904\u7406\u5668\u548c\u5185\u5b58\u7684\u673a\u5668</p> <ul> <li>\u6570\u636e\u5b58\u50a8\u5728\u673a\u5668\u4e4b\u95f4\u5171\u4eab\u7684\u78c1\u76d8\u9635\u5217\u4e0a\uff0c\u8fd9\u4e9b\u78c1\u76d8\u901a\u8fc7\u5feb\u901f\u7f51\u7edc\u8fde\u63a5</li> <li>\u7ade\u4e89\u548c\u9501\u5b9a\u7684\u5f00\u9500\u9650\u5236\u4e86\u5171\u4eab\u78c1\u76d8\u65b9\u6cd5\u7684\u53ef\u4f38\u7f29\u6027\\(^{[1]}\\)</li> </ul>"},{"location":"books/data_intensive_system_book/part2_distributed_data.html#_3","title":"\u65e0\u5171\u4eab\u67b6\u6784","text":"<p>\u65e0\u5171\u4eab\u67b6\u6784\\(^{[2]}\\)\uff08shared-nothing architecture\uff0c\u6709\u65f6\u88ab\u79f0\u4e3a \u6c34\u5e73\u4f38\u7f29\uff0c\u5373 horizontal scaling\uff0c\u6216 \u5411\u5916\u4f38\u7f29\uff0c\u5373 scaling out\uff09</p> <ul> <li>\u8fd0\u884c\u6570\u636e\u5e93\u8f6f\u4ef6\u7684\u6bcf\u53f0\u673a\u5668 / \u865a\u62df\u673a\u90fd\u79f0\u4e3a \u8282\u70b9\uff08node\uff09\uff1b</li> <li>\u6bcf\u4e2a\u8282\u70b9\u53ea\u4f7f\u7528\u5404\u81ea\u7684\u5904\u7406\u5668\uff0c\u5185\u5b58\u548c\u78c1\u76d8\uff0c\u8282\u70b9\u95f4\u4f7f\u7528\u7f51\u7edc\u8fdb\u884c\u901a\u4fe1\u548c\u534f\u8c03\uff1b</li> </ul> <p>\u867d\u7136\u5206\u5e03\u5f0f\u65e0\u5171\u4eab\u67b6\u6784\u6709\u8bb8\u591a\u4f18\u70b9\uff0c\u4f46\u5b83\u901a\u5e38\u4e5f\u4f1a\u7ed9\u5e94\u7528\u5e26\u6765\u989d\u5916\u7684\u590d\u6742\u5ea6\uff0c\u6709\u65f6\u4e5f\u4f1a\u9650\u5236\u4f60\u53ef\u7528\u6570\u636e\u6a21\u578b\u7684\u8868\u8fbe\u529b\u3002</p> <ul> <li>\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2a\u7b80\u5355\u7684\u5355\u7ebf\u7a0b\u7a0b\u5e8f\u53ef\u4ee5\u6bd4\u4e00\u4e2a\u62e5\u6709\u8d85\u8fc7 100 \u4e2a CPU \u6838\u7684\u96c6\u7fa4\u8868\u73b0\u5f97\u66f4\u597d\\(^{[3]}\\)</li> </ul>"},{"location":"books/data_intensive_system_book/part2_distributed_data.html#vs","title":"\u590d\u5236 vs \u5206\u533a","text":"<p>\u6570\u636e\u5206\u5e03\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u6709\u4e24\u79cd\u5e38\u89c1\u7684\u65b9\u5f0f\uff1a</p> <ul> <li>\u590d\u5236\uff08Replication\uff09\uff1a\u51e0\u4e2a\u4e0d\u540c\u7684\u8282\u70b9\u4e0a\u4fdd\u5b58\u6570\u636e\u7684\u76f8\u540c\u526f\u672c\uff0c\u63d0\u4f9b\u5197\u4f59\uff1b</li> <li>\u5206\u533a (Partitioning)\uff1a\u5c06\u4e00\u4e2a\u5927\u578b\u6570\u636e\u5e93\u62c6\u5206\u6210\u8f83\u5c0f\u7684\u5b50\u96c6\uff0c\u4ece\u800c\u4e0d\u540c\u7684\u5206\u533a\u53ef\u4ee5\u6307\u6d3e\u7ed9\u4e0d\u540c\u7684 \u8282\u70b9\uff08nodes\uff0c\u4ea6\u79f0 \u5206\u7247\uff0c\u5373 sharding\uff09\uff1b</li> </ul> <p>\u590d\u5236\u548c\u5206\u533a\u662f\u4e0d\u540c\u7684\u673a\u5236\uff0c\u4f46\u5b83\u4eec\u7ecf\u5e38\u540c\u65f6\u4f7f\u7528\u3002</p>"},{"location":"books/data_intensive_system_book/part2_distributed_data.html#_4","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>Ben Stopford: \u201cShared Nothing vs. Shared Disk Architectures: An Independent View,\u201d benstopford.com, November 24, 2009.</li> <li>Michael Stonebraker: \u201cThe Case for Shared Nothing,\u201d IEEE Database EngineeringBulletin, volume 9, number 1, pages 4\u20139, March 1986.</li> <li>Frank McSherry, Michael Isard, and Derek G. Murray: \u201cScalability! But at What COST?,\u201d at 15th USENIX Workshop on Hot Topics in Operating Systems (HotOS),May 2015.</li> </ol>"},{"location":"books/data_intensive_system_book/part3_derived_data.html","title":"\u7b2c\u4e09\u90e8\u5206\uff1a\u884d\u751f\u6570\u636e","text":"<p>\u5728\u672c\u4e66\u7684 \u7b2c\u4e00\u90e8\u5206 \u548c \u7b2c\u4e8c\u90e8\u5206 \u4e2d\uff0c\u6211\u4eec\u81ea\u5e95\u5411\u4e0a\u5730\u628a\u6240\u6709\u5173\u4e8e\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u7684\u4e3b\u8981\u8003\u91cf\u90fd\u8fc7\u4e86\u4e00\u904d\uff1a</p> <ul> <li>\u4ece\u6570\u636e\u5728\u78c1\u76d8\u4e0a\u7684\u5e03\u5c40\uff0c\u4e00\u76f4\u5230\u51fa\u73b0\u6545\u969c\u65f6\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e00\u81f4\u6027\u7684\u5c40\u9650\u3002\u4f46\u6240\u6709\u7684\u8ba8\u8bba\u90fd\u5047\u5b9a\u4e86\u5e94\u7528\u4e2d\u53ea\u7528\u4e86\u4e00\u79cd\u6570\u636e\u5e93\u3002</li> </ul> <p>\u5927\u578b\u5e94\u7528\u7a0b\u5e8f\u7ecf\u5e38\u9700\u8981\u4ee5\u591a\u79cd\u65b9\u5f0f\u8bbf\u95ee\u548c\u5904\u7406\u6570\u636e\uff1a\u6570\u636e\u5b58\u50a8\u3001\u7d22\u5f15\u3001\u7f13\u5b58\u3001\u5206\u6790\u7cfb\u7edf\u7b49\u7b49\uff0c\u5e76\u5b9e\u73b0\u5728\u8fd9\u4e9b\u7ec4\u4ef6\u4e2d\u79fb\u52a8\u6570\u636e\u7684\u673a\u5236\u3002</p> <p>\u672c\u4e66\u7684\u6700\u540e\u4e00\u90e8\u5206\uff0c\u4f1a\u7814\u7a76\u5c06\u591a\u4e2a\u4e0d\u540c\u6570\u636e\u7cfb\u7edf\uff08\u53ef\u80fd\u6709\u7740\u4e0d\u540c\u6570\u636e\u6a21\u578b\uff0c\u5e76\u9488\u5bf9\u4e0d\u540c\u7684\u8bbf\u95ee\u6a21\u5f0f\u8fdb\u884c\u4f18\u5316\uff09\u96c6\u6210\u4e3a\u4e00\u4e2a\u534f\u8c03\u4e00\u81f4\u7684\u5e94\u7528\u67b6\u6784\u65f6\uff0c\u4f1a\u9047\u5230\u7684\u95ee\u9898\u3002\u5728\u73b0\u5b9e\u4e16\u754c\u4e2d\uff0c\u96c6\u6210\u4e0d\u540c\u7684\u7cfb\u7edf\u662f\u5b9e\u9645\u5e94\u7528\u4e2d\u6700\u91cd\u8981\u7684\u4e8b\u60c5\u4e4b\u4e00\u3002</p>"},{"location":"books/data_intensive_system_book/part3_derived_data.html#_2","title":"\u8bb0\u5f55\u7cfb\u7edf\u548c\u884d\u751f\u6570\u636e\u7cfb\u7edf","text":"<p>\u4ece\u9ad8\u5c42\u6b21\u4e0a\u770b\uff0c\u5b58\u50a8\u548c\u5904\u7406\u6570\u636e\u7684\u7cfb\u7edf\u53ef\u4ee5\u5206\u4e3a\u4e24\u5927\u7c7b\uff1a</p> <ul> <li>\u8bb0\u5f55\u7cfb\u7edf\uff08System of record\uff09\uff1a\u4e5f\u88ab\u79f0\u4e3a \u771f\u76f8\u6e90\uff08source of truth\uff09\uff0c\u6301\u6709\u6570\u636e\u7684\u6743\u5a01\u7248\u672c\u3002\u5f53\u65b0\u7684\u6570\u636e\u8fdb\u5165\u65f6\uff08\u4f8b\u5982\uff0c\u7528\u6237\u8f93\u5165\uff09\u9996\u5148\u4f1a\u8bb0\u5f55\u5728\u8fd9\u91cc\u3002\u6bcf\u4e2a\u4e8b\u5b9e\u6b63\u6b63\u597d\u597d\u8868\u793a\u4e00\u6b21\uff08\u8868\u793a\u901a\u5e38\u662f \u6b63\u89c4\u5316\u7684\uff0c\u5373 normalized\uff09\u3002\u5982\u679c\u5176\u4ed6\u7cfb\u7edf\u548c \u8bb0\u5f55\u7cfb\u7edf \u4e4b\u95f4\u5b58\u5728\u4efb\u4f55\u5dee\u5f02\uff0c\u90a3\u4e48\u8bb0\u5f55\u7cfb\u7edf\u4e2d\u7684\u503c\u662f\u6b63\u786e\u7684\uff08\u6839\u636e\u5b9a\u4e49\uff09\u3002</li> <li>\u884d\u751f\u6570\u636e\u7cfb\u7edf\uff08Derived data systems\uff09\uff1a\u53e6\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u7684\u73b0\u6709\u6570\u636e\u4ee5\u67d0\u79cd\u65b9\u5f0f\u8fdb\u884c\u8f6c\u6362\u6216\u5904\u7406\u7684\u7ed3\u679c\u3002\u5982\u679c\u4e22\u5931\u884d\u751f\u6570\u636e\uff0c\u53ef\u4ee5\u4ece\u539f\u59cb\u6765\u6e90\u91cd\u65b0\u521b\u5efa\u3002\u5178\u578b\u7684\u4f8b\u5b50\u662f \u7f13\u5b58\uff08cache\uff09\u3002\u975e\u89c4\u8303\u5316\u7684\u503c\uff0c\u7d22\u5f15\u548c\u7269\u5316\u89c6\u56fe\u4ea6\u5c5e\u6b64\u7c7b\u3002\u5728\u63a8\u8350\u7cfb\u7edf\u4e2d\uff0c\u9884\u6d4b\u6c47\u603b\u6570\u636e\u901a\u5e38\u884d\u751f\u81ea\u7528\u6237\u65e5\u5fd7\u3002</li> </ul> <p>\u4ece\u6280\u672f\u4e0a\u8bb2\uff0c\u884d\u751f\u6570\u636e\u662f \u5197\u4f59\u7684\uff08redundant\uff09\uff0c\u56e0\u4e3a\u5b83\u91cd\u590d\u4e86\u5df2\u6709\u7684\u4fe1\u606f\u3002</p> <ul> <li>\u884d\u751f\u6570\u636e\u5bf9\u4e8e\u83b7\u5f97\u826f\u597d\u7684\u53ea\u8bfb\u67e5\u8be2\u6027\u80fd\u901a\u5e38\u662f\u81f3\u5173\u91cd\u8981\u7684\u3002\u5b83\u901a\u5e38\u662f\u975e\u89c4\u8303\u5316\u7684\u3002</li> <li>\u53ef\u4ee5\u4ece\u5355\u4e2a\u6e90\u5934\u884d\u751f\u51fa\u591a\u4e2a\u4e0d\u540c\u7684\u6570\u636e\u96c6\uff0c\u4f7f\u4f60\u80fd\u4ece\u4e0d\u540c\u7684 \u201c\u89c6\u89d2\u201d \u6d1e\u5bdf\u6570\u636e\u3002</li> </ul> <p>\u5e76\u4e0d\u662f\u6240\u6709\u7684\u7cfb\u7edf\u90fd\u5728\u5176\u67b6\u6784\u4e2d\u660e\u786e\u533a\u5206 \u8bb0\u5f55\u7cfb\u7edf \u548c \u884d\u751f\u6570\u636e\u7cfb\u7edf\uff0c\u4f46\u8fd9\u79cd\u533a\u5206\u65b9\u5f0f\u5b83\u660e\u786e\u4e86\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\u6d41\uff1a\u7cfb\u7edf\u7684\u54ea\u4e00\u90e8\u5206\u5177\u6709\u54ea\u4e9b\u8f93\u5165\u548c\u54ea\u4e9b\u8f93\u51fa\uff0c\u4ee5\u53ca\u5b83\u4eec\u5982\u4f55\u76f8\u4e92\u4f9d\u8d56\u3002</p> <p>\u5927\u591a\u6570\u6570\u636e\u5e93\uff0c\u5b58\u50a8\u5f15\u64ce\u548c\u67e5\u8be2\u8bed\u8a00\uff0c\u672c\u8d28\u4e0a\u65e2\u4e0d\u662f\u8bb0\u5f55\u7cfb\u7edf\u4e5f\u4e0d\u662f\u884d\u751f\u7cfb\u7edf\u3002</p> <ul> <li>\u5982\u4f55\u4f7f\u7528\u5b83\u53d6\u51b3\u4e8e\u4f60\u81ea\u5df1\u3002\u8bb0\u5f55\u7cfb\u7edf\u548c\u884d\u751f\u6570\u636e\u7cfb\u7edf\u4e4b\u95f4\u7684\u533a\u522b\u4e0d\u5728\u4e8e\u5de5\u5177\uff0c\u800c\u5728\u4e8e\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u4f7f\u7528\u65b9\u5f0f\u3002</li> </ul>"},{"location":"cloud/index.html","title":"\u4e91\u539f\u751f","text":""},{"location":"cloud/index.html#_2","title":"\u5b9a\u4e49","text":"<p>CNCF\u7684\u5b9a\u4e49</p> <p>\u4e91\u539f\u751f\u6280\u672f\u6709\u5229\u4e8e\u5404\u7ec4\u7ec7\u5728\u516c\u6709\u4e91\u3001\u79c1\u6709\u4e91\u548c\u6df7\u5408\u4e91\u7b49\u65b0\u578b\u52a8\u6001\u73af\u5883\u4e2d\uff0c\u6784\u5efa\u548c\u8fd0\u884c\u53ef\u5f39\u6027\u6269\u5c55\u7684\u5e94\u7528\u3002\u4e91\u539f\u751f\u7684\u4ee3\u8868\u6280\u672f\u5305\u62ec\u5bb9\u5668\u3001\u670d\u52a1\u7f51\u683c\u3001\u5fae\u670d\u52a1\u3001\u4e0d\u53ef\u53d8\u57fa\u7840\u8bbe\u65bd\u548c\u58f0\u660e\u5f0fAPI\u3002</p> <p>\u8fd9\u4e9b\u6280\u672f\u80fd\u591f\u6784\u5efa\u5bb9\u9519\u6027\u597d\u3001\u6613\u4e8e\u7ba1\u7406\u548c\u4fbf\u4e8e\u89c2\u5bdf\u7684\u677e\u8026\u5408\u7cfb\u7edf\u3002\u7ed3\u5408\u53ef\u9760\u7684\u81ea\u52a8\u5316\u624b\u6bb5\uff0c\u4e91\u539f\u751f\u6280\u672f\u4f7f\u5de5\u7a0b\u5e08\u80fd\u591f\u8f7b\u677e\u5730\u5bf9\u7cfb\u7edf\u4f5c\u51fa\u9891\u7e41\u548c\u53ef\u9884\u6d4b\u7684\u91cd\u5927\u53d8\u66f4\u3002</p>"},{"location":"cloud/index.html#_3","title":"\u8bbe\u8ba1\u7406\u5ff5","text":"<ul> <li>\u9762\u5411\u5206\u5e03\u5f0f\u8bbe\u8ba1\uff08Distribution\uff09\uff1a\u5bb9\u5668\u3001\u5fae\u670d\u52a1\u3001API \u9a71\u52a8\u7684\u5f00\u53d1\uff1b</li> <li>\u9762\u5411\u914d\u7f6e\u8bbe\u8ba1\uff08Configuration\uff09\uff1a\u4e00\u4e2a\u955c\u50cf\uff0c\u591a\u4e2a\u73af\u5883\u914d\u7f6e\uff1b</li> <li>\u9762\u5411\u97e7\u6027\u8bbe\u8ba1\uff08Resistancy\uff09\uff1a\u6545\u969c\u5bb9\u5fcd\u548c\u81ea\u6108\uff1b</li> <li>\u9762\u5411\u5f39\u6027\u8bbe\u8ba1\uff08Elasticity\uff09\uff1a\u5f39\u6027\u6269\u5c55\u548c\u5bf9\u73af\u5883\u53d8\u5316\uff08\u8d1f\u8f7d\uff09\u505a\u51fa\u54cd\u5e94\uff1b</li> <li>\u9762\u5411\u4ea4\u4ed8\u8bbe\u8ba1\uff08Delivery\uff09\uff1a\u81ea\u52a8\u62c9\u8d77\uff0c\u7f29\u77ed\u4ea4\u4ed8\u65f6\u95f4\uff1b</li> <li>\u9762\u5411\u6027\u80fd\u8bbe\u8ba1\uff08Performance\uff09\uff1a\u54cd\u5e94\u5f0f\uff0c\u5e76\u53d1\u548c\u8d44\u6e90\u9ad8\u6548\u5229\u7528\uff1b</li> <li>\u9762\u5411\u81ea\u52a8\u5316\u8bbe\u8ba1\uff08Automation\uff09\uff1a\u81ea\u52a8\u5316\u7684 DevOps\uff1b</li> <li>\u9762\u5411\u8bca\u65ad\u6027\u8bbe\u8ba1\uff08Diagnosability\uff09\uff1a\u96c6\u7fa4\u7ea7\u522b\u7684\u65e5\u5fd7\u3001metric \u548c\u8ffd\u8e2a\uff1b</li> <li>\u9762\u5411\u5b89\u5168\u6027\u8bbe\u8ba1\uff08Security\uff09\uff1a\u5b89\u5168\u7aef\u70b9\u3001API Gateway\u3001\u7aef\u5230\u7aef\u52a0\u5bc6\uff1b</li> </ul>"},{"location":"cloud/index.html#_4","title":"\u6280\u672f\u6808","text":"<p>CNCF Landscape</p> <p></p>"},{"location":"cloud/index.html#_5","title":"\u53c2\u8003\u6587\u732e","text":"<p>[1].  Kubernetes \u4e2d\u6587\u6307\u5357/\u4e91\u539f\u751f\u5e94\u7528\u67b6\u6784\u5b9e\u6218\u624b\u518c</p>"},{"location":"cloud/habor.html","title":"Habor","text":"<p>Harbor \u662f\u4e3a\u4f01\u4e1a\u7528\u6237\u8bbe\u8ba1\u7684\u5bb9\u5668\u955c\u50cf\u4ed3\u5e93\u5f00\u6e90\u9879\u76ee\uff0c\u5305\u62ec\u4e86\u6743\u9650\u7ba1\u7406(RBAC)\u3001LDAP\u3001\u5ba1\u8ba1\u3001\u5b89\u5168\u6f0f\u6d1e\u626b\u63cf\u3001 \u955c\u50cf\u9a8c\u771f\u3001\u7ba1\u7406\u754c\u9762\u3001\u81ea\u6211\u6ce8\u518c\u3001HA \u7b49\u4f01\u4e1a\u5fc5\u9700\u7684\u529f\u80fd\uff0c\u540c\u65f6\u9488\u5bf9\u4e2d\u56fd\u7528\u6237\u7684\u7279\u70b9\uff0c\u8bbe\u8ba1\u955c\u50cf\u590d\u5236\u548c\u4e2d\u6587\u652f\u6301\u7b49\u529f\u80fd\u3002</p> <ul> <li>use Harbor to proxy and cache images from a target public or private registry</li> </ul>"},{"location":"cloud/habor.html#_1","title":"\u7ec4\u4ef6","text":"<p>Nginx(Proxy)\uff1a\u7528\u4e8e\u4ee3\u7406Harbor\u7684registry,UI, token\u7b49\u670d\u52a1 </p> <p>db\uff1a\u8d1f\u8d23\u50a8\u5b58\u7528\u6237\u6743\u9650\u3001\u5ba1\u8ba1\u65e5\u5fd7\u3001Dockerimage\u5206\u7ec4\u4fe1\u606f\u7b49\u6570\u636e</p> <p>UI\uff1a\u63d0\u4f9b\u56fe\u5f62\u5316\u754c\u9762\uff0c\u5e2e\u52a9\u7528\u6237\u7ba1\u7406registry\u4e0a\u7684\u955c\u50cf, \u5e76\u5bf9\u7528\u6237\u8fdb\u884c\u6388\u6743 </p> <p>jobsevice\uff1a\u8d1f\u8d23\u955c\u50cf\u590d\u5236\u5de5\u4f5c\u7684\uff0c\u4ed6\u548cregistry\u901a\u4fe1\uff0c\u4ece\u4e00\u4e2aregistry pull\u955c\u50cf\u7136\u540epush\u5230\u53e6\u4e00\u4e2aregistry\uff0c\u5e76\u8bb0\u5f55job_log </p> <p>Adminserver\uff1a\u662f\u7cfb\u7edf\u7684\u914d\u7f6e\u7ba1\u7406\u4e2d\u5fc3\u9644\u5e26\u68c0\u67e5\u5b58\u50a8\u7528\u91cf\uff0cui \u548c jobserver\u542f\u52a8\u65f6\u5019\u56de\u9700\u8981\u52a0\u8f7d adminserver \u7684\u914d\u7f6e</p> <p>Registry\uff1a\u539f\u751f\u7684docker\u955c\u50cf\u4ed3\u5e93\uff0c\u8d1f\u8d23\u5b58\u50a8\u955c\u50cf\u6587\u4ef6</p> <p>Log\uff1a\u4e3a\u4e86\u5e2e\u52a9\u76d1\u63a7Harbor\u8fd0\u884c\uff0c\u8d1f\u8d23\u6536\u96c6\u5176\u4ed6\u7ec4\u4ef6\u7684log\uff0c\u8bb0\u5f55\u5230syslog\u4e2d</p> <p></p>"},{"location":"cloud/habor.html#kubernetes-harbor","title":"Kubernetes \u62c9\u53d6Harbor\u4ed3\u5e93\u79c1\u6709\u9879\u76ee\u955c\u50cf","text":"<p>docker(moby) \u6ca1\u6709\u7c7b\u4f3c yum / npm \u8fd9\u79cd\u5168\u5c40\u914d\u7f6e\u4ee3\u7406\u6e90\u7684\u65b9\u5f0f\u3002</p> <ul> <li>https://github.com/moby/moby/pull/34319</li> </ul> <p>image \u914d\u7f6e harbor \u7684\u5730\u5740</p> <pre><code># docker \u767b\u5f55\uff0c\u62c9\u53bb\u79c1\u6709\u955c\u50cf\ndocker login -u \u7528\u6237\u540d -p \u5bc6\u7801  $Habor_Address\n\ncat ~/.docker/config.json |base64 -w 0\n</code></pre> <p>k8s \u901a\u8fc7\u521b\u5efa  Secret \u4f7f\u7528\u79c1\u6709 Habor \u955c\u50cf</p> <pre><code>apiVersion: v1\nkind: Secret\nmetadata:\n  name: harborlogin\ntype: kubernetes.io/dockerconfigjson\ndata:\n  # \u4e0a\u9762 base64 \u52a0\u5bc6\u7684\u5185\u5bb9\n  .dockerconfigjson: ewoJImF1dGhzIjogewoJCSIxMjcuMC4wLjEiOiB7CgkJCSJhdXRoIjo...\n</code></pre> <p>yaml \u6587\u4ef6\u4e2d\u6ce8\u660e imagePullSecrets \u5c5e\u6027</p>"},{"location":"cloud/habor.html#harbor","title":"\u6784\u5efa\u6307\u5b9a\u547d\u540d\u7a7a\u95f4\u7684Harbor\u4ed3\u5e93\u5bc6\u94a5","text":"<pre><code>kubectl create secret docker-registry hc-secret --docker-server=172.16.2.132:30002 --docker-username=hc --docker-password=Hc123456 -n ai-education\n</code></pre> <ul> <li>docker-registry\uff1a\u5bc6\u94a5\u7c7b\u578b</li> <li>hc-secret\uff1a\u5bc6\u94a5\u540d\u79f0</li> <li>--docker-server\uff1a\u955c\u50cf\u4ed3\u5e93\u5730\u5740</li> <li>--docker-username\uff1a\u955c\u50cf\u4ed3\u5e93\u7528\u6237\u540d</li> <li>--docker-password\uff1a\u955c\u50cf\u4ed3\u5e93\u5bc6\u7801</li> <li>-n\uff1a\u9700\u62c9\u53d6\u955c\u50cf\u5bf9\u5e94\u670d\u52a1\u7684\u547d\u540d\u7a7a\u95f4</li> </ul>"},{"location":"cloud/habor.html#yaml","title":"yaml\u90e8\u7f72\u65f6\u4f7f\u7528\u5bf9\u5e94\u5bc6\u94a5","text":"<pre><code>spec:\n  imagePullSecrets:\n  - name: hc-secret\n</code></pre>"},{"location":"cloud/helm.html","title":"Helm","text":"<p>The package manager for Kubernetes.</p> <p>Helm Charts help you define, install, and upgrade even the most complex Kubernetes application.</p>"},{"location":"cloud/helm.html#_1","title":"\u6982\u5ff5","text":"<p>\u7b80\u5316Kubernetes\u5e94\u7528\u7684\u90e8\u7f72\u548c\u7ba1\u7406\uff0c\u7b49\u4ef7\u4e8eCentOS\u7684yum\uff1b</p> <ul> <li>Chart: \u662fHelm\u7ba1\u7406\u7684\u5b89\u88c5\u5305\uff0c\u91cc\u9762\u5305\u542b\u9700\u8981\u90e8\u7f72\u7684\u5b89\u88c5\u5305\u8d44\u6e90\u3002\u53ef\u4ee5\u628aChart\u6bd4\u4f5cCentOS yum\u4f7f\u7528\u7684rpm\u6587\u4ef6\u3002\u6bcf\u4e2aChart\u5305\u542b\u4e0b\u9762\u4e24\u90e8\u5206\uff1a</li> <li>\u5305\u7684\u57fa\u672c\u63cf\u8ff0\u6587\u4ef6Chart.yaml</li> <li>\u653e\u5728templates\u76ee\u5f55\u4e2d\u7684\u4e00\u4e2a\u6216\u591a\u4e2aKubernetes manifest\u6587\u4ef6\u6a21\u677f</li> <li>Release\uff1a\u662fchart\u7684\u90e8\u7f72\u5b9e\u4f8b\uff0c\u4e00\u4e2achart\u5728\u4e00\u4e2aKubernetes\u96c6\u7fa4\u4e0a\u53ef\u4ee5\u6709\u591a\u4e2arelease\uff0c\u5373\u8fd9\u4e2achart\u53ef\u4ee5\u88ab\u5b89\u88c5\u591a\u6b21\uff1b</li> <li>Repository\uff1achart\u7684\u4ed3\u5e93\uff0c\u7528\u4e8e\u53d1\u5e03\u548c\u5b58\u50a8chart</li> </ul> <p>v3 \u7248\u672c\u4ec5\u6709\u5ba2\u6237\u7aef helm \uff1a</p> <ul> <li>helm\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u53ef\u5728\u672c\u5730\u8fd0\u884c\uff0c\u4e00\u822c\u8fd0\u884c\u5728CI/CD Server\u4e0a\u3002</li> </ul> <p>templates \u76ee\u5f55</p> <ul> <li>Kubernetes \u8d44\u6e90\u7684\u914d\u7f6e\u6a21\u677f\uff0cHelm \u4f1a\u5c06 <code>values.yaml</code> \u4e2d\u7684\u53c2\u6570\u503c\u6ce8\u5165\u5230\u6a21\u677f\u4e2d\u751f\u6210\u6807\u51c6\u7684 YAML \u914d\u7f6e\u6587\u4ef6</li> </ul>"},{"location":"cloud/helm.html#_2","title":"\u7ec4\u6210","text":""},{"location":"cloud/helm.html#chart","title":"Chart\u6a21\u677f","text":"<p>\u53c2\u8003 https://helm.sh/docs/chart_template_guide/</p> <pre><code>$ helm create nginx\n$ tree .\n.\n\u251c\u2500\u2500 charts\n\u251c\u2500\u2500 Chart.yaml\n\u251c\u2500\u2500 templates\n\u2502   \u251c\u2500\u2500 deployment.yaml\n\u2502   \u251c\u2500\u2500 _helpers.tpl\n\u2502   \u251c\u2500\u2500 hpa.yaml\n\u2502   \u251c\u2500\u2500 ingress.yaml\n\u2502   \u251c\u2500\u2500 NOTES.txt\n\u2502   \u251c\u2500\u2500 serviceaccount.yaml\n\u2502   \u251c\u2500\u2500 service.yaml\n\u2502   \u2514\u2500\u2500 tests\n\u2502       \u2514\u2500\u2500 test-connection.yaml\n\u2514\u2500\u2500 values.yaml\n\n3 directories, 10 files\n</code></pre>"},{"location":"cloud/helm.html#_3","title":"\u8d44\u6e90\u5b89\u88c5\u987a\u5e8f","text":"<p>Helm installs resources in the following order:</p> <ul> <li>Namespace</li> <li>NetworkPolicy</li> <li>ResourceQuota</li> <li>LimitRange</li> <li>PodSecurityPolicy</li> <li>PodDisruptionBudget</li> <li>ServiceAccount</li> <li>Secret</li> <li>SecretList</li> <li>ConfigMap</li> <li>StorageClass</li> <li>PersistentVolume</li> <li>PersistentVolumeClaim</li> <li>CustomResourceDefinition</li> <li>ClusterRole</li> <li>ClusterRoleList</li> <li>ClusterRoleBinding</li> <li>ClusterRoleBindingList</li> <li>Role</li> <li>RoleList</li> <li>RoleBinding</li> <li>RoleBindingList</li> <li>Service</li> <li>DaemonSet</li> <li>Pod</li> <li>ReplicationController</li> <li>ReplicaSet</li> <li>Deployment</li> <li>HorizontalPodAutoscaler</li> <li>StatefulSet</li> <li>Job</li> <li>CronJob</li> <li>Ingress</li> <li>APIService</li> </ul>"},{"location":"cloud/helm.html#_4","title":"\u539f\u7406","text":""},{"location":"cloud/helm.html#patch","title":"\u5347\u7ea7Patch","text":"<p>Helm 3 three-way \u5408\u5e76\u7b56\u7565</p> <p>\u8003\u8651 old manifest\uff0clive state \u548c new manifest \u4e09\u8005\uff0c\u751f\u6210 patch\u3002</p> <ul> <li>\u5982\u679c manifest \u524d\u540e\u4e0d\u53d8\uff0chelm 3 \u4f1a\u5c06\u65b0\u7684 mainfest \u8986\u76d6\uff0c\u6b64\u65f6\u5916\u90e8\u7684\u6539\u52a8\u4f1a\u4e22\u5931\uff1b</li> </ul> <p>\u53ef\u4ee5\u901a\u8fc7 lookup \u51fd\u6570\uff0c\u5c06\u539f\u5148\u7684\u914d\u7f6e\u67e5\u51fa\u6765\u4f5c\u4e3a\u914d\u7f6e\u5185\u5bb9\uff0c\u5982\u4e0b\u6240\u793a</p> <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: upgrade-test\n  namespace: default\ndata:\n  content: |\n# \u67e5\u627e config map \u7684\u5f53\u524d\u5185\u5bb9\uff0c\u5e76\u5e94\u7528  \n{{ (lookup \"v1\" \"ConfigMap\" \"default\"  \"upgrade-test\").data.content | indent 4 }}\n</code></pre>"},{"location":"cloud/helm.html#_5","title":"\u5b89\u88c5","text":"<p>\u5b98\u65b9\u9488\u5bf9\u591a\u79cd\u5e73\u53f0\u6709\u9884\u7f16\u8bd1\u597d\u7684\u5b89\u88c5\u5305\uff1a</p> <pre><code>$ tar -zxvf helm-v3.2.1-linux-amd64.tar.gz\n$ cp linux-amd64/helm /usr/local/bin/\n$ helm version\n#\u3000version.BuildInfo{Version:\"v3.2.1\", GitCommit:\"fe51cd1e31e6a202cba7dead9552a6d418ded79a\", GitTreeState:\"clean\", GoVersion:\"go1.13.10\"}\n</code></pre>"},{"location":"cloud/helm.html#_6","title":"\u914d\u7f6e","text":"<p>\u914d\u7f6e\u56fd\u5185Chart\u4ed3\u5e93</p> <ul> <li>\u5fae\u8f6f\u4ed3\u5e93\uff08http://mirror.azure.cn/kubernetes/charts/\uff09</li> <li>\u963f\u91cc\u4e91\u4ed3\u5e93\uff08https://kubernetes.oss-cn-hangzhou.aliyuncs.com/charts \uff09</li> <li>\u5b98\u65b9\u4ed3\u5e93\uff08https://hub.kubeapps.com/charts/incubator\uff09</li> </ul> <pre><code>$ helm repo add stable http://mirror.azure.cn/kubernetes/charts\n$ helm repo add aliyun https://kubernetes.oss-cn-hangzhou.aliyuncs.com/charts \n$ helm repo update\n# \u5220\u9664\u5b58\u50a8\u5e93\n$ helm repo remove aliyun\n</code></pre>"},{"location":"cloud/helm.html#_7","title":"\u547d\u4ee4","text":""},{"location":"cloud/helm.html#search","title":"search","text":"<ul> <li><code>helm search repo mysql</code> \uff1a\u641c\u7d22charts</li> </ul>"},{"location":"cloud/helm.html#install","title":"install","text":"<ul> <li><code>helm install aliyun aliyun/mysql</code>\uff1a\u5b89\u88c5chart</li> </ul>"},{"location":"cloud/helm.html#_8","title":"\u8986\u76d6\u9ed8\u8ba4\u503c","text":"<pre><code>$ echo '{mariadb.auth.database: user0db, mariadb.auth.username: user0}' &gt; values.yaml\n$ helm install -f values.yaml bitnami/wordpress --generate-name\n</code></pre>"},{"location":"cloud/helm.html#status","title":"status","text":"<ul> <li><code>helm status happy-panda</code>\uff1a\u67e5\u770b\u72b6\u6001</li> </ul>"},{"location":"cloud/helm.html#show","title":"show","text":"<ul> <li><code>helm show values bitnami/wordpress</code>\uff1a\u67e5\u770b\u9ed8\u8ba4\u7684\u914d\u7f6e\u503c\uff1b</li> </ul>"},{"location":"cloud/helm.html#create","title":"create","text":"<ul> <li>``\uff1a\u521b\u5efa\u5e94\u7528\u6a21\u677f</li> </ul>"},{"location":"cloud/helm.html#lint","title":"lint","text":"<ul> <li><code>helm lint promocouponsvc/</code></li> <li>\u4f1a\u68c0\u6d4b chart \u7684\u8bed\u6cd5\uff0c\u62a5\u544a\u9519\u8bef\u4ee5\u53ca\u7ed9\u51fa\u5efa\u8bae\uff1b</li> </ul>"},{"location":"cloud/helm.html#package","title":"package","text":"<ul> <li><code>helm package promocouponsvc/</code></li> <li>\u6253\u5305\u540e\u751f\u6210\u4e00\u4e2a tgz\u6587\u4ef6</li> </ul>"},{"location":"cloud/helm.html#_9","title":"\u8bed\u6cd5","text":""},{"location":"cloud/helm.html#lookup-function","title":"lookup Function","text":"<pre><code>data:\n  content: |\n# \u67e5\u627e config map \u7684\u5f53\u524d\u5185\u5bb9\uff0c\u5e76\u5e94\u7528  \n{{ (lookup \"v1\" \"ConfigMap\" \"default\"  \"upgrade-test\").data.content | indent 4 }}\n</code></pre>"},{"location":"cloud/helm.html#include-function","title":"'include' Function","text":"<p>template is an action\uff0c\u65e0\u6cd5\u5c06\u8f93\u51fa\u901a\u8fc7\u7ba1\u9053\u7ed9\u5176\u5b83\u64cd\u4f5c\uff0c\u53ef\u4ee5\u5b8c\u5168\u4f7f\u7528 include \u800c\u4e0d\u662f template.</p> <p>\u8fd4\u56de\u662f\u4e2a\u88ab\u6e32\u67d3\u7684\u5b57\u7b26\u4e32\uff0c\u5373\u4f7f<code>mytpl</code>\u5b9a\u4e49\u7684\u65f6\u5019\u662f bool\uff0c\u4e5f\u4f1a\u88ab\u8f6c\u4e3a\u5b57\u7b26\u4e32\u3002</p> <pre><code># includes a template called mytpl, then lowercases the result, then wraps that in double quotes.\nvalue: {{ include \"mytpl\" . | lower | quote }}\n</code></pre>"},{"location":"cloud/helm.html#required-function","title":"\u2018required' Function","text":"<pre><code># required function declares an entry for .Values.who is required, and will print an error message when that entry is missing\nvalue: {{ required \"A valid .Values.who entry required!\" .Values.who }}\n</code></pre>"},{"location":"cloud/helm.html#tpl-function","title":"'tpl' Function","text":"<p>evaluate strings as templates inside a template</p> <pre><code># values\ntemplate: \"{{ .Values.name }}\"\nname: \"Tom\"\n\n# template\n{{ tpl .Values.template . }}\n\n# output\nTom\n</code></pre>"},{"location":"cloud/helm.html#_10","title":"\u63a7\u5236\u7ed3\u6784","text":""},{"location":"cloud/helm.html#ifelse","title":"if/else","text":"<p>\u521b\u5efa\u6761\u4ef6\u5757\uff0c\u7ed3\u675f\u7528end</p> <pre><code># -\u4ee3\u8868\u5220\u9664\u7a7a\u683c\uff0c\u524d\u9762\u7684\u5220\u9664\u524d\u9762\u7684\u7a7a\u683c\n{{- if values.drink \"ccc\" }}\n{{- end }}\n</code></pre>"},{"location":"cloud/helm.html#range","title":"range","text":""},{"location":"cloud/tools.html","title":"\u955c\u50cf\u5de5\u5177","text":""},{"location":"cloud/tools.html#skopeo","title":"Skopeo","text":"<p>Work with remote images registries - retrieving information, images, signing content</p> <p><code>skopeo</code>\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5b9e\u7528\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u5bf9\u5bb9\u5668\u6620\u50cf\u548c\u6620\u50cf\u5b58\u50a8\u5e93\u6267\u884c\u5404\u79cd\u64cd\u4f5c\u3002</p> <ul> <li>\u4e0d\u7528 root \u6743\u9650\uff0c\u4e0d\u9700\u8981\u5b88\u62a4\u8fdb\u7a0b\uff1b</li> <li>\u652f\u6301 OCI \u548c Docker v2 \u955c\u50cf\u3002</li> </ul> <p>Skopeo\u4e0eAPI V2\u5bb9\u5668\u6620\u50cf\u6ce8\u518c\u8868\u4e00\u8d77\u4f7f\u7528\uff0c\u4f8b\u5982docker.io\u548cquay.io\u6ce8\u518c\u8868\u3001\u79c1\u6709\u6ce8\u518c\u8868\u3001\u672c\u5730\u76ee\u5f55\u548c\u672c\u5730OCI\u5e03\u5c40\u76ee\u5f55\u3002</p> <ul> <li>\u53ef\u4ee5\u4f5c\u4e3a\u955c\u50cf\u642c\u8fd0\u5de5\u5177\uff0c\u5728\u4e0d\u540c\u7684\u5b58\u50a8\u4e2d\u8fdb\u884c\u8fc1\u79fb\u548c\u7ba1\u7406\uff1b</li> </ul>"},{"location":"cloud/tools.html#podman","title":"Podman","text":"<p>Podman: A tool for managing OCI containers and pods.</p> <p>\u50cf Docker \u4e00\u6837\u63d0\u4f9b\u57fa\u672c\u7684\u5bb9\u5668\u7ba1\u7406\uff0c\u8fd8\u53ef\u4ee5\u7ba1\u7406 pod\u3002</p>"},{"location":"cloud/tools.html#buildah","title":"Buildah","text":"<p>Buildah \u76f8\u5bf9\u4e8e Podman \u4e3b\u8981\u7684\u4f18\u52bf\u5728\u4e8e\u53ef\u4ee5\u5728\u6ca1\u6709 Doclerfiles \u7684\u60c5\u51b5\u4e0b\u521b\u5efa\u5bb9\u5668\u955c\u50cf\u3002</p>"},{"location":"cloud/tools.html#kaniko","title":"Kaniko","text":"<p>Build Container Images In Kubernetes.</p> <p>kaniko is a tool to build container images from a Dockerfile, inside a container or Kubernetes cluster.</p> <ul> <li>\u4e0d\u9700\u8981\u5b88\u62a4\u8fdb\u7a0b\uff0c\u7528\u4e8e CI / CD \u4e2d\u6784\u5efa\u955c\u50cf</li> </ul> <p>\u793a\u4f8b\u5982\u4e0b\uff1a</p> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\nname: kaniko\nspec:\n containers:\n - name: kaniko\n   image: gcr.io/kaniko-project/executor:latest\n   # command \u9ed8\u8ba4\u662f /kaniko/executor\n   # Dockerfile(--dockerfile)\uff0c\u4e0a\u4e0b\u6587(--context)\uff0c\u8fdc\u7aef\u955c\u50cf\u4ed3\u5e93(--destination)\n   args: [\"--dockerfile=/workspace/Dockerfile\",\n          \"--context=/workspace/\",\n          \"--destination=dllhb.docker.io/kaniko-test:v0.4\"]\n    volumeMounts:\n      # \u8fdc\u7a0b\u4ed3\u5e93\u7684\u5bc6\u94a5\u6587\u4ef6\n      - name: kaniko-secret\n        mountPath: /kaniko/.docker\n      - name: dockerfile\n        mountPath: /workspace/Dockerfile\n        subPath: Dockerfile\n    restartPolicy: Never\nvolumes:\n  - name: dockerfile\n    configMap:\n      name: dockerfile\n  - name: kaniko-secret\n     projected:\n     sources:\n     - secret:\n        name: regcred\n        items:\n        - key: .dockerconfigjson\n          path: config.json\n</code></pre>"},{"location":"cloud/cloud_edge/kubeedge.html","title":"KubeEdge","text":"<p>\u5c06\u5bb9\u5668\u5316\u5e94\u7528\u7a0b\u5e8f\u7f16\u6392\u529f\u80fd\u6269\u5c55\u5230Edge\u7684\u4e3b\u673a\u3002(CNCF incubating project.)</p>"},{"location":"cloud/cloud_edge/kubeedge.html#_1","title":"\u67b6\u6784","text":"<p>\u4e91\u7aef\u3001\u8fb9\u7f18\u548c\u8bbe\u5907\u5c42\u3002</p> <p></p>"},{"location":"cloud/cloud_edge/kubeedge.html#_2","title":"\u4e91\u7aef\u8fdb\u7a0b","text":"<ul> <li> <p>cloudhub\u90e8\u7f72\u5728\u4e91\u7aef\uff0c\u63a5\u6536edgehub\u540c\u6b65\u5230\u4e91\u7aef\u7684\u4fe1\u606f\uff1b</p> </li> <li> <p>edgecontroller\u90e8\u7f72\u5728\u4e91\u7aef\uff0c\u7528\u4e8e\u63a7\u5236Kubernetes API Server\u4e0e\u8fb9\u7f18\u7684\u8282\u70b9\u3001\u5e94\u7528\u548c\u914d\u7f6e\u7684\u72b6\u6001\u540c\u6b65\u3002</p> </li> </ul> <p>Kubernetes maser\u8fd0\u884c\u5728\u4e91\u7aef\uff0c\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7kubectl\u547d\u4ee4\u884c\u5728\u4e91\u7aef\u7ba1\u7406\u8fb9\u7f18\u8282\u70b9\u3001\u8bbe\u5907\u548c\u5e94\u7528\uff0c\u4f7f\u7528\u4e60\u60ef\u4e0eKubernetes\u539f\u751f\u7684\u5b8c\u5168\u4e00\u81f4\uff0c\u65e0\u9700\u91cd\u65b0\u9002\u5e94\u3002</p>"},{"location":"cloud/cloud_edge/kubeedge.html#_3","title":"\u8fb9\u7f18\u8fdb\u7a0b","text":"<ul> <li> <p>edged\u662f\u4e2a\u91cd\u65b0\u5f00\u53d1\u7684\u8f7b\u91cf\u5316Kubelet\uff0c\u5b9e\u73b0Pod\uff0cVolume\uff0cNode\u7b49Kubernetes\u8d44\u6e90\u5bf9\u8c61\u7684\u751f\u547d\u5468\u671f\u7ba1\u7406\uff1b</p> </li> <li> <p>metamanager\u8d1f\u8d23\u672c\u5730\u5143\u6570\u636e\u7684\u6301\u4e45\u5316\uff0c\u662f\u8fb9\u7f18\u8282\u70b9\u81ea\u6cbb\u80fd\u529b\u7684\u5173\u952e\uff1b</p> </li> <li> <p>edgehub\u662f\u591a\u8def\u590d\u7528\u7684\u6d88\u606f\u901a\u9053\uff0c\u63d0\u4f9b\u53ef\u9760\u548c\u9ad8\u6548\u7684\u4e91\u8fb9\u4fe1\u606f\u540c\u6b65\uff1b</p> </li> <li> <p>devicetwin\u7528\u4e8e\u62bd\u8c61\u7269\u7406\u8bbe\u5907\u5e76\u5728\u4e91\u7aef\u751f\u6210\u4e00\u4e2a\u8bbe\u5907\u72b6\u6001\u7684\u6620\u5c04\uff1b</p> </li> <li> <p>eventbus\u8ba2\u9605\u6765\u81ea\u4e8eMQTT Broker\u7684\u8bbe\u5907\u6570\u636e\u3002</p> </li> </ul>"},{"location":"cloud/cloud_edge/kubeedge.html#_4","title":"\u529f\u80fd","text":""},{"location":"cloud/cloud_edge/kubeedge.html#_5","title":"\u4e91\u8fb9\u534f\u540c","text":"<ul> <li> <p>KubeEdge\u901a\u8fc7Kubernetes\u6807\u51c6API\u5728\u4e91\u7aef\u7ba1\u7406\u8fb9\u7f18\u8282\u70b9\u3001\u8bbe\u5907\u548c\u5de5\u4f5c\u8d1f\u8f7d\u7684\u589e\u5220\u6539\u67e5\uff1b</p> </li> <li> <p>\u8fb9\u7f18\u8282\u70b9\u7684\u7cfb\u7edf\u5347\u7ea7\u548c\u5e94\u7528\u7a0b\u5e8f\u66f4\u65b0\u90fd\u53ef\u4ee5\u76f4\u63a5\u4ece\u4e91\u7aef\u4e0b\u53d1\uff0c\u63d0\u5347\u8fb9\u7f18\u7684\u8fd0\u7ef4\u6548\u7387\uff1b</p> </li> <li>KubeEdge\u5e95\u5c42\u4f18\u5316\u7684\u591a\u8def\u590d\u7528\u6d88\u606f\u901a\u9053\u76f8\u5bf9\u4e8eKubernetes\u57fa\u4e8eHTTP\u957f\u8fde\u63a5\u7684list/watch\u673a\u5236\u6269\u5c55\u6027\u66f4\u597d\uff0c\u5141\u8bb8\u6d77\u91cf\u8fb9\u7f18\u8282\u70b9\u548c\u8bbe\u5907\u7684\u63a5\u5165\uff1b</li> </ul>"},{"location":"cloud/cloud_edge/kubeedge.html#_6","title":"\u8fb9\u7f18\u8282\u70b9\u79bb\u7ebf\u81ea\u6cbb","text":"<ul> <li> <p>\u8fb9\u7f18\u8282\u70b9\u9700\u8981\u5728\u5b8c\u5168\u65ad\u5f00\u8fde\u63a5\u7684\u6a21\u5f0f\u4e0b\u81ea\u4e3b\u5de5\u4f5c\uff0c\u5e76\u4e0d\u4f1a\u5b9a\u671f\u8fdb\u884c\u72b6\u6001\u540c\u6b65\uff0c\u53ea\u6709\u5728\u91cd\u8fde\u65f6\u624d\u4f1a\u4e0e\u63a7\u5236\u9762\u901a\u4fe1\uff1b</p> </li> <li> <p>KubeEdge\u901a\u8fc7\u6d88\u606f\u603b\u7ebf\u548c\u5143\u6570\u636e\u672c\u5730\u5b58\u50a8\u5b9e\u73b0\u4e86\u8282\u70b9\u7684\u79bb\u7ebf\u81ea\u6cbb\u3002\u7528\u6237\u671f\u671b\u7684\u63a7\u5236\u9762\u914d\u7f6e\u548c\u8bbe\u5907\u5b9e\u65f6\u72b6\u6001\u66f4\u65b0\u90fd\u901a\u8fc7\u6d88\u606f\u540c\u6b65\u5230\u672c\u5730\u5b58\u50a8\uff0c\u8fd9\u6837\u8282\u70b9\u5728\u79bb\u7ebf\u60c5\u51b5\u4e0b\u5373\u4f7f\u91cd\u542f\u4e5f\u4e0d\u4f1a\u4e22\u5931\u7ba1\u7406\u5143\u6570\u636e\uff0c\u5e76\u4fdd\u6301\u5bf9\u672c\u8282\u70b9\u8bbe\u5907\u548c\u5e94\u7528\u7684\u7ba1\u7406\u80fd\u529b\u3002</p> </li> </ul>"},{"location":"cloud/cloud_edge/kubeedge.html#_7","title":"\u8bbe\u5907\u7ba1\u7406","text":"<ul> <li>\u53ef\u63d2\u62d4\u5f0f\u7684\u8bbe\u5907\u7edf\u4e00\u7ba1\u7406\u6846\u67b6\uff0c\u5141\u8bb8\u7528\u6237\u5728\u6b64\u6846\u67b6\u4e0a\u6839\u636e\u4e0d\u540c\u7684\u534f\u8bae\u6216\u5b9e\u9645\u9700\u6c42\u5f00\u53d1\u8bbe\u5907\u63a5\u5165\u9a71\u52a8</li> <li> <p>\u76ee\u524d\u652f\u6301\u7684\u534f\u8bae\u6709\uff1aMQTT\uff0cBlueTooth\uff0cOPC UA\uff0cModbus</p> </li> <li> <p>\u901a\u8fc7device twins/digital twins\u5b9e\u73b0\u8bbe\u5907\u72b6\u6001\u7684\u66f4\u65b0\u548c\u540c\u6b65\uff0c\u5e76\u5728\u4e91\u7aef\u63d0\u4f9bKubernetes\u7684\u6269\u5c55API\u62bd\u8c61\u8bbe\u5907\u5bf9\u8c61\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u4e91\u7aef\u4f7f\u7528kubectl\u64cd\u4f5cKubernetes\u8d44\u6e90\u5bf9\u8c61\u7684\u65b9\u5f0f\u7ba1\u7406\u8fb9\u7f18\u8bbe\u5907</p> </li> </ul>"},{"location":"cloud/cloud_edge/kubeedge.html#k3s","title":"\u4e0eK3s\u5bf9\u6bd4","text":"<p>K3S\u4e13\u4e3a\u5728\u8d44\u6e90\u6709\u9650\u7684\u73af\u5883\u4e2d\u8fd0\u884cKubernetes\u7684\u7814\u53d1\u548c\u8fd0\u7ef4\u4eba\u5458\u8bbe\u8ba1\uff0c\u76ee\u7684\u662f\u5728x86\u3001ARM64\u548cARMv7D\u67b6\u6784\u7684\u8fb9\u7f18\u8282\u70b9\u4e0a\u8fd0\u884c\u5c0f\u578b\u7684Kubernetes\u96c6\u7fa4\u3002</p> <p>\u5bf9 K8s \u7684\u4fee\u6539\uff1a</p> <ul> <li>\u5220\u9664\u65e7\u7684\u3001\u975e\u5fc5\u987b\u7684\u4ee3\u7801\uff0c\u4ee5\u53ca\u975e\u9ed8\u8ba4\u7684Admission Controller\uff0cin-tree\u7684cloud provider\u548c\u5b58\u50a8\u63d2\u4ef6\uff1b</li> <li>\u5f15\u5165SQLite\u4ee3\u66ffetcd\u4f5c\u4e3a\u7ba1\u7406\u9762\u6570\u636e\u5b58\u50a8\uff0c\u5e76\u7528SQLite\u5b9e\u73b0\u4e86list/watch\u63a5\u53e3\uff0c\u5373Tunnel Proxy\uff1b</li> <li>\u6574\u5408\u6253\u5305\u8fdb\u7a0b\uff0c\u5c06\u539f\u672c\u4ee5\u591a\u8fdb\u7a0b\u65b9\u5f0f\u8fd0\u884c\u7684Kubernetes\u7ba1\u7406\u9762\u548c\u6570\u636e\u9762\u7684\u591a\u4e2a\u8fdb\u7a0b\u5206\u522b\u5408\u5e76\u6210\u4e00\u4e2a\u6765\u8fd0\u884c\uff1b</li> <li>\u4f7f\u7528containderd\u66ff\u6362Docker\uff0c\u663e\u8457\u51cf\u5c11\u8fd0\u884c\u65f6\u5360\u7528\u7a7a\u95f4\uff1b</li> </ul> <p>K3S\u7684\u6240\u6709\u7ec4\u4ef6\uff08\u5305\u62ecServer\u548cAgent\uff09\u90fd\u8fd0\u884c\u5728\u8fb9\u7f18\uff0c\u56e0\u6b64\u4e0d\u6d89\u53ca\u4e91\u8fb9\u534f\u540c\u3002</p> <p>\u5982\u679cK3S\u8981\u843d\u5230\u751f\u4ea7\uff0c\u5728K3S\u4e4b\u4e0a\u5e94\u8be5\u8fd8\u6709\u4e00\u4e2a\u96c6\u7fa4\u7ba1\u7406\u65b9\u6848\u8d1f\u8d23\u8de8\u96c6\u7fa4\u7684\u5e94\u7528\u7ba1\u7406\u3001\u76d1\u63a7\u3001\u544a\u8b66\u3001\u65e5\u5fd7\u3001\u5b89\u5168\u548c\u7b56\u7565\u7b49\uff0c\u9057\u61be\u7684\u662fRancher\u5c1a\u672a\u5f00\u6e90\u8fd9\u90e8\u5206\u80fd\u529b\u3002</p>"},{"location":"cloud/cloud_edge/mqtt.html","title":"MQTT","text":""},{"location":"cloud/cloud_edge/mqtt.html#mqtt_1","title":"MQTT\u534f\u8bae","text":"<p>MQTT\uff08Message Queuing Telemetry Transport\uff09\u534f\u8bae \u662fISO \u6807\u51c6\u4e0b\u7684\u4e00\u79cd\u57fa\u4e8e\u53d1\u5e03 - \u8ba2\u9605\u6a21\u5f0f\u7684\u6d88\u606f\u534f\u8bae\uff0c\u57fa\u4e8e TCP/IP \u534f\u8bae\u7c07\u3002</p> <p>\u5176\u9002\u7528\u4e8e\u7269\u8054\u7f51\u6d88\u606f\u4f20\u9012\uff0c\u4f8b\u5982\u4f4e\u529f\u7387\u4f20\u611f\u5668\u6216\u79fb\u52a8\u8bbe\u5907\uff0c\u5982\u7535\u8bdd\uff0c\u5d4c\u5165\u5f0f\u8ba1\u7b97\u673a\u6216\u5fae\u63a7\u5236\u5668\u3002</p> <p></p> <p>Apache Pulsar \u539f\u751f\u652f\u6301 MQTT\u3002</p>"},{"location":"cloud/cloud_edge/mqtt.html#mqtt-sn","title":"MQTT-SN","text":"<p>SN\uff1aSensor Networks\uff0cMQTT-SN\u662fMQTT\u534f\u8bae\u7684\u4f20\u611f\u5668\u7248\u672c\u3002</p>"},{"location":"cloud/cloud_edge/mqtt.html#mqtt-client","title":"MQTT Client \u5b9e\u73b0","text":""},{"location":"cloud/cloud_edge/mqtt.html#paho","title":"Paho","text":"<p>MQTT \u4e0d\u540c Client \u7684 \u5bf9\u6bd4</p>"},{"location":"cloud/cloud_edge/mqtt.html#mqtt-broker","title":"MQTT Broker \u5b9e\u73b0","text":"<p>\u5b8c\u6574\u7684\u5217\u8868\u89c1\u8fd9\u91cc</p>"},{"location":"cloud/cloud_edge/mqtt.html#emqxerlangapl-20","title":"EMQX(Erlang\uff0cAPL 2.0)","text":"<ul> <li>\u5b8c\u6574 MQTT 3.x \u548c 5.0 \u89c4\u8303</li> <li>Masterless \u9ad8\u53ef\u7528\u96c6\u7fa4\u67b6\u6784</li> <li>\u9ad8\u5e76\u53d1\u3001\u4f4e\u65f6\u5ef6\u3001\u9ad8\u6027\u80fd</li> <li>\u53ef\u6269\u5c55\u7684\u7f51\u5173\u548c\u63d2\u4ef6\u4f53\u7cfb</li> <li>\u6570\u636e\u5b58\u50a8\u662f\u4f01\u4e1a\u7248\u7684\u529f\u80fd</li> </ul>"},{"location":"cloud/cloud_edge/mqtt.html#eclipse-mosquittocapache-20","title":"Eclipse Mosquitto(C\uff0cApache 2.0)","text":"<p>An open source MQTT broker. https://github.com/eclipse/mosquitto</p> <p>\u4e00\u4e2a\u5f00\u6e90\uff08EPL / EDL\u8bb8\u53ef\uff09\u6d88\u606f\u4ee3\u7406\uff0c\u5b83\u5b9e\u73b0\u4e86MQTT\u534f\u8bae\u7248\u672c 5.0\uff0c3.1\u548c3.1.1\u3002</p> <p>\u91cd\u91cf\u8f7b\uff0c\u9002\u7528\u4e8e\u4ece\u4f4e\u529f\u8017\u5355\u677f\u8ba1\u7b97\u673a\u5230\u5b8c\u6574\u670d\u52a1\u5668\u7684\u6240\u6709\u8bbe\u5907\u3002</p> <p>\u63d0\u4f9b C library Client \u548c CLI\u3002</p>"},{"location":"cloud/cloud_edge/openyurt.html","title":"OpenYurt","text":"<p>OpenYurt - Extending your native Kubernetes to edge(project under CNCF)</p>"},{"location":"cloud/cloud_edge/openyurt.html#_1","title":"\u67b6\u6784","text":""},{"location":"cloud/images/images.html","title":"\u5e38\u7528\u955c\u50cf","text":""},{"location":"cloud/images/images.html#alpine","title":"Alpine","text":"<p>musl libc \u548c BusyBox.</p>"},{"location":"cloud/images/images.html#alpine-dockergcc","title":"Alpine-docker\u5bb9\u5668\u4e2d\u5b89\u88c5GCC","text":"<pre><code>RUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g' /etc/apk/repositories\n\nRUN apt add --update  build-base &amp;&amp; rm -rf /var/cache/apk/*\n</code></pre> <p><code>build-base</code> is a meta-package that will install the GCC, libc-dev and binutils packages (amongst others).</p>"},{"location":"cloud/images/web_centos.html","title":"\u57fa\u4e8e\u6d4f\u89c8\u5668\u4f7f\u7528CentOS\uff08\u591a\u7528\u6237\uff09","text":""},{"location":"cloud/images/web_centos.html#0-novnc","title":"0. noVNC\u5b9a\u5236\u5316\u4ee3\u7801\u90e8\u5206","text":"<ul> <li>noVNC\u7248\u672c\uff1ahttps://github.com/novnc/noVNC/tree/v1.2.0</li> <li>websockify\u7248\u672c\uff1ahttps://github.com/novnc/websockify</li> </ul>"},{"location":"cloud/images/web_centos.html#01-url","title":"0.1 \u8bbe\u7f6e\u4e0d\u540c\u7528\u6237url\u8def\u5f84\u4e0d\u540c","text":"<ul> <li> <p>\u65b0\u589e\u811a\u672c\uff1a<code>/noVNC/app/sed.sh</code></p> </li> <li> <ul> <li><code>WEBSOCK_PATH</code>\u53c2\u6570\u9700\u5728\u542f\u52a8\u955c\u50cf\u7684k8s.yaml\u4e2d\u914d\u7f6e\uff0c\u4e3a\u4e0d\u540c\u7528\u6237\u4e0d\u540curl\u8def\u5f84</li> </ul> </li> <li>1920x1080\u4e3a\u5206\u8fa8\u7387\uff0c\u6839\u636e\u7528\u6237\u673a\u7684\u663e\u793a\u5668\u5927\u5c0f\u81ea\u884c\u8c03\u6574</li> </ul> <pre><code>#!/bin/bash\n\nsed -i \"s#WEBSOCK_PATH#${WEBSOCK_PATH}#g\" /noVNC/app/ui.js\nvncserver -geometry 1920x1080\nnohup /noVNC/./utils/launch.sh --vnc 0.0.0.0:5901 1&gt;/dev/null 2&gt;&amp;1 \n</code></pre> <ul> <li> <p>\u4fee\u6539\u6587\u4ef6\uff1a<code>/noVNC/app/ui.js</code></p> </li> <li> <ul> <li>\u5c06\u6ce8\u91ca\u66ff\u6362\u6210\u4e0b\u4e00\u884c</li> </ul> </li> </ul> <pre><code># UI.initSetting('path', 'websockify');\nUI.initSetting('path', 'WEBSOCK_PATH/websockify');\n</code></pre> <ul> <li> <p>\u4fee\u6539\u6587\u4ef6\uff1a<code>/noVNC/vnc.html</code>\uff0c\u7528\u4e8enginx\u914d\u7f6e\u8f6c\u53d1</p> </li> <li> <ul> <li>\u5c06\u6ce8\u91ca\u66ff\u6362\u6210\u4e0b\u4e00\u884c</li> </ul> </li> </ul> <pre><code>#&lt;input id=\"noVNC_setting_path\" type=\"text\" value=\"websockify\"&gt;\n&lt;input id=\"noVNC_setting_path\" type=\"text\" value=\"/noVNC/websockify\"&gt;\n</code></pre>"},{"location":"cloud/images/web_centos.html#02","title":"0.2 \u514d\u5bc6\u767b\u5f55\u4fee\u6539","text":"<ul> <li> <p>\u4fee\u6539\u6587\u4ef6\uff1a/noVNC/app/ui.js</p> </li> <li> <ul> <li>\u65b0\u589e\u90e8\u5206\uff1a<code>.then(() =&gt; {document.getElementById(\"noVNC_connect_button\").click()});</code></li> </ul> </li> <li> <ul> <li>\u65b0\u589e\u90e8\u5206\uff1a<code>password = \"rootroot\";</code></li> </ul> </li> </ul> <pre><code>prime() {\n  return WebUtil.initSettings().then(() =&gt; {\n    if (document.readyState === \"interactive\" || document.readyState === \"complete\") {\n      return UI.start();\n    }\n\n    return new Promise((resolve, reject) =&gt; {\n      document.addEventListener('DOMContentLoaded', () =&gt; UI.start().then(resolve).catch(reject));\n    });\n  }).then(() =&gt; {\n    document.getElementById(\"noVNC_connect_button\").click()\n    });\n },\n\n    .......\n\n    password = \"rootroot\";\n    UI.hideStatus();\n</code></pre>"},{"location":"cloud/images/web_centos.html#1-dockerfile","title":"1. \u901a\u8fc7Dockerfile\u6784\u5efa\u53ef\u89c6\u5316\u7ec8\u7aef\u955c\u50cf","text":""},{"location":"cloud/images/web_centos.html#11","title":"1.1 \u6587\u4ef6\u76ee\u5f55\u7ec4\u7ec7","text":"<ul> <li> <p>Dockerfile\uff1a\u7528\u4e8e\u6784\u5efa\u53ef\u89c6\u5316\u7ec8\u7aef\u955c\u50cf</p> </li> <li> <p>centos7_vnc_install.sh\uff1a\u7528\u4e8e\u5b89\u88c5centos\u7cfb\u7edf\u76f8\u5173\u7ec4\u4ef6\u7b49</p> </li> <li>noVNC\uff1a\u7528\u4e8e\u63d0\u4f9bvnc\u4ee3\u7406\u670d\u52a1\u5e76\u57fa\u4e8e\u5f00\u6e901.2.0\u7248\u672c\u5b9a\u5236\u4e86\u90e8\u5206\u5185\u5bb9\uff0c\u8be6\u7ec6\u6539\u52a8\u89c1\u7b2c0\u8282</li> <li>setvncpasswd.sh\uff1a\u7528\u4e8e\u81ea\u52a8\u5316\u8bbe\u7f6evnc\u5bc6\u7801</li> <li>vncservers\uff1a\u7528\u4e8e\u542f\u52a8vnc\u670d\u52a1</li> <li>xstartup\uff1a\u7528\u4e8e\u542f\u52a8xfce\u8fdc\u7a0b\u53ef\u89c6\u5316\u684c\u9762\u670d\u52a1</li> </ul> <p></p>"},{"location":"cloud/images/web_centos.html#12-dockerfile","title":"1.2 Dockerfile\u6587\u4ef6","text":"<pre><code># \u57fa\u4e8ecentos7\u955c\u50cf\u6784\u5efa\u672c\u670d\u52a1\uff0c\u4e14\u8be5\u955c\u50cf\u7684yum\u6e90\u5df2\u914d\u7f6e\u4e3a\u56fd\u5185\nFROM centos:7.9.2009\nENV noVNCVersion v1.2\nENV AUTHOR HC\nENV LANG en_US.UTF-8\nENV TZ=Asia/Shanghai\nENV SHELL=/bin/bash\nLABEL maintainer=\"test\"\n# \u8bbe\u7f6e\u5de5\u4f5c\u76ee\u5f55\nWORKDIR /noVNCSet\nCOPY . /noVNCSet\n\n# \u8bbe\u7f6e\u65f6\u533a\uff0c\u8bbe\u7f6eroot\u5bc6\u7801\uff0c\u542f\u52a8centos7_vnc_install.sh\u5b89\u88c5\u811a\u672c\uff0c\u542f\u52a8setvncpasswd.sh\u5bc6\u7801\u8bbe\u7f6e\u811a\u672c\uff0c\u62f7\u8d1dxfce\u914d\u7f6e\u6587\u4ef6xstartup\u5230vnc\u76ee\u5f55\nRUN set -ex &amp;&amp; ln -snf /usr/share/zoneinfo/$TZ /etc/localtime &amp;&amp; echo '$TZ' &gt; /etc/timezone &amp;&amp; mv /noVNCSet/noVNC /noVNC &amp;&amp; echo -e \"root\\nroot\" | passwd &amp;&amp; sh /noVNCSet/centos7_vnc_install.sh &amp;&amp; chmod 755 /noVNCSet/setvncpasswd.sh &amp;&amp;  cd /noVNCSet &amp;&amp;  ./setvncpasswd.sh &amp;&amp; mv /noVNCSet/xstartup /root/.vnc/xstartup &amp;&amp; chmod 755 /root/.vnc/xstartup\n\nEXPOSE 6901\n\nENTRYPOINT sh /noVNC/app/sed.sh\n</code></pre>"},{"location":"cloud/images/web_centos.html#13-centos7_vnc_installsh","title":"1.3 centos7_vnc_install.sh\u6587\u4ef6","text":"<pre><code>#/bin/bash\n\nfunction install_vnc\n{\n        # \u5b89\u88c5wget\u53cacentos\u6e90\u7ba1\u7406\u5de5\u5177\n        yum install -y  wget\n        wget http://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n        rpm -ivh epel-release-latest-7.noarch.rpm\n        yum update\n        yum install deltarpm -y\n        # \u5b89\u88c5vnc\u76f8\u5173\u670d\u52a1\n        yum install -y \"tigervnc-server\"\n        yum install tcl-devel -y\u3001\n        # \u5b89\u88c5\u81ea\u52a8\u5316\u6267\u884c\u547d\u4ee4\u670d\u52a1expect\n        yum install expect -y\n        # \u5b89\u88c5xfce\n        yum install epel-release\n        yum  -y --enablerepo=epel groupinstall xfce\n        # \u5b89\u88c5\u4e2d\u6587\u5b57\u4f53\n        yum -y  --enablerepo=epel groupinstall Fonts\n        # \u5b89\u88c5\u706b\u72d0\u6d4f\u89c8\u5668\n        yum -y install firefox\n        yum -y install python3\n        pip3 install numpy -i https://pypi.douban.com/simple/\n}\n\ninstall_vnc\n</code></pre>"},{"location":"cloud/images/web_centos.html#14-novnc0","title":"1.4 noVNC\u6587\u4ef6\uff08\u5c5e\u4e8e\u5b9a\u5236\u7248\u672c\uff0c\u8be6\u7ec6\u6539\u53d8\u770b\u7b2c0\u8282\uff09","text":""},{"location":"cloud/images/web_centos.html#15-setvncpasswdsh","title":"1.5 setvncpasswd.sh\u6587\u4ef6","text":"<pre><code>#!/usr/bin/expect\nset timeout 10\nspawn vncpasswd\nexpect \"Password:\"\nsend \"rootroot\\n\"\nexpect \"Verify:\"\nsend \"rootroot\\n\"\nexpect \"Would you like to enter a view-only password (y/n)?\"\nsend \"n\\n\"\ninteract\n</code></pre>"},{"location":"cloud/images/web_centos.html#16-vncservers","title":"1.6 vncservers\u6587\u4ef6","text":"<pre><code># THIS FILE HAS BEEN REPLACED BY /lib/systemd/system/vncserver@.service\nVNCSERVERS=\"1:root\"\nVNCSERVERARGS[1]=\"-geometry 1920x1080\"\n</code></pre>"},{"location":"cloud/images/web_centos.html#17-xstartup","title":"1.7 xstartup\u6587\u4ef6","text":"<pre><code>#!/bin/sh\n\nunset SESSION_MANAGER\nunset DBUS_SESSION_BUS_ADDRESS\nexec startxfce4\n#/etc/X11/xinit/xinitrc\n# Assume either Gnome or KDE will be started by default when installed\n# We want to kill the session automatically in this case when user logs out. In case you modify\n# /etc/X11/xinit/Xclients or ~/.Xclients yourself to achieve a different result, then you should\n# be responsible to modify below code to avoid that your session will be automatically killed\nif [ -e /usr/bin/gnome-session -o -e /usr/bin/startkde ]; then\nvncserver -kill $DISPLAY\nfi\n</code></pre>"},{"location":"cloud/images/web_centos.html#2-novnck8syaml","title":"2. \u5c06noVNC\u670d\u52a1\u542f\u52a8\u547d\u4ee4\u52a0\u5230k8s\u7684yaml\u4e2d","text":"<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: hc-terminal-pod\n  namespace: ai-education\n  labels:\n    app: hc-terminal-pod-label\nspec:\n  containers:\n  - name: hc-terminal-container1\n    securityContext:\n      privileged: true\n    image: 172.16.2.131:30002/starfish/hc-terminal:v3.0               # \u7b2c1\u8282\u901a\u8fc7dockerfile\u6784\u5efa\u51fa\u6765\u7684\u955c\u50cf\n    imagePullPolicy: IfNotPresent\n    resources:\n      requests:\n        memory: 100Mi\n      limits:\n        memory: 2000Mi\n      requests:\n        cpu: \"1\"\n      limits:\n        cpu: \"1\"\n    ports:\n    - name: http\n      containerPort: 6901\n    env:\n      - name: WEBSOCK_PATH\n        value: \"001\"\n    command: [\"/bin/bash\"]                        #\u5bb9\u5668\u542f\u52a8\u547d\u4ee4\uff0c\u8fdb\u5165\u5bb9\u5668\u7684shell\u7ec8\u7aef\n    args: [\"-c\",\"su root -s /bin/bash  /noVNC/app/sed.sh\"]  #\u542f\u52a8noVnc\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: hc-terminal-service\n  namespace: ai-education\nspec:\n  ports:\n  - name: http\n    port: 6901                           #terminal\u5bf9\u5916\u66b4\u9732\u670d\u52a1\u7684\u7aef\u53e3\u53f7\n    protocol: TCP\n  selector:\n    app: hc-terminal-pod-label\n  type: NodePort\n</code></pre>"},{"location":"cloud/k8s/cmds.html","title":"\u547d\u4ee4\u53ca\u4f7f\u7528","text":""},{"location":"cloud/k8s/cmds.html#kubectl","title":"kubectl","text":""},{"location":"cloud/k8s/cmds.html#apply","title":"apply","text":"<p>\u90e8\u7f72\u6216\u8005\u66f4\u65b0\uff1a<code>kubectl apply -f app.yaml</code></p>"},{"location":"cloud/k8s/cmds.html#get","title":"get","text":"<p>json \u8def\u5f84\u5339\u914d\uff1a</p> <ul> <li><code>-o jsonpath='{.items[?(@.metadata.uid==\"43504a29-8b72-4304-873c-3fee910374fa\")].metadata.name}'</code></li> </ul> <p><code>\u2013show-labels</code>: \u67e5\u770b\u6807\u7b7e</p> <ul> <li>\u67e5\u770bpod\u670d\u52a1\uff1a<code>kubectl get pod -n cbc-dev | grep router</code></li> <li>\u67e5\u8be2\u670d\u52a1pod \u548c\u6240\u5728\u7684\u8282\u70b9\uff1a<code>kubectl -n cbc-dev get pod -o wide</code></li> <li>\u67e5\u770bdeployment\uff1a<code>kubectl get deployments</code></li> <li>\u67e5\u770breplicaset\uff1a<code>kubectl get rs</code></li> <li>\u67e5\u770bnamespace\uff1a<code>kubectl get ns</code> </li> </ul>"},{"location":"cloud/k8s/cmds.html#describe","title":"describe","text":"<p>\u63cf\u8ff0Pod\u4fe1\u606f\uff1a<code>kubectl -n cbc-dev describe pod podName</code></p>"},{"location":"cloud/k8s/cmds.html#logs","title":"logs","text":"<p>\u67e5\u770bpod \u542f\u52a8\u65e5\u5fd7\uff1a<code>kubectl -n cbc-dev logs podName</code></p>"},{"location":"cloud/k8s/cmds.html#exec","title":"exec","text":"<p>\u8fdb\u5165pod\u67e5\u770b\uff1a<code>kubectl -n cbc-dev exec -it podName bash</code></p>"},{"location":"cloud/k8s/cmds.html#expose","title":"expose","text":"<p>\u5c06\u8d44\u6e90\u66b4\u9732\u4e3aservice\u5bf9\u5916\u8bbf\u95ee\uff0c\u652f\u6301\uff1a pod\uff08po\uff09\uff0cservice\uff08svc\uff09\uff0creplication controller\uff08rc\uff09\uff0cdeployment\uff08deploy\uff09\uff0creplica set\uff08rs\uff09</p> <p><code>kubectl expose  pod hc-base-jupyter-pod --port=8888 --target-port=8888  --type=NodePort -n ai-education</code></p> <ul> <li><code>--port</code>: \u96c6\u7fa4\u5185\u90e8\u670d\u52a1\u8bbf\u95ee\u7aef\u53e3\uff0c\u5373\u901a\u8fc7 clusterip + port \u5728\u5bb9\u5668\u5185\u8bbf\u95ee\uff1b</li> <li><code>--target-port</code>\uff1a\u5bb9\u5668\u5185\u7684\u670d\u52a1\u7aef\u53e3</li> <li><code>--type</code>\uff1a\u670d\u52a1\u66b4\u9732\u7c7b\u578b\uff0c\u4e00\u822c\u9009\u62e9NodePort\uff0c\u4f1a\u81ea\u52a8\u5206\u914d\u4e00\u4e2a\u5916\u90e8\u8bbf\u95ee\u7684port\uff08\u901a\u8fc7<code>kubectl get service</code>\u67e5\u770b\uff09</li> <li><code>--name</code>\uff1a\u540d\u79f0\uff08\u53ef\u9009\uff09</li> </ul>"},{"location":"cloud/k8s/cmds.html#port-forward","title":"port-forward","text":"<p>\u901a\u8fc7\u7aef\u53e3\u8f6c\u53d1\u6620\u5c04\u672c\u5730\u7aef\u53e3\u5230\u6307\u5b9a\u7684\u5e94\u7528\uff08Pod\uff09\u7aef\u53e3\uff1a<code>kubectl port-forward svc/yunikorn-service 9889:9889 -n yunikorn</code></p>"},{"location":"cloud/k8s/cmds.html#delete","title":"delete","text":"<p>\u5220\u9664pods\uff1a<code>kubectl -n cbc-dev delete -f app.yaml</code></p>"},{"location":"cloud/k8s/cmds.html#label","title":"label","text":"<p>\u8282\u70b9\u6253\u6807\u7b7e\uff1a<code>kubectl label nodes kube-node label_name=label_value</code></p> <p>\u5220\u9664\u6807\u7b7e\uff08\u6700\u540e\u6307\u5b9aLabel\u7684key\u540d\u5e76\u4e0e\u4e00\u4e2a\u51cf\u53f7\u76f8\u8fde\uff09\uff1a<code>kubectl label nodes 194.246.9.5 gpu-</code></p>"},{"location":"cloud/k8s/cmds.html#scale","title":"scale","text":"<p>Pod\u4f38\u7f29\uff1a<code>kubectl scale deployment nginx-deployment --replicas=4</code></p>"},{"location":"cloud/k8s/cmds.html#edit","title":"edit","text":"<p>\u7f16\u8f91Yaml\u914d\u7f6e\uff1a<code>kubectl edit deployment/nginx-deployment</code></p>"},{"location":"cloud/k8s/cmds.html#rollout","title":"rollout","text":"<p>\u56de\u6eda\u7248\u672c\uff1a<code>kubectl rollout undo deployment/nginx-deployment</code></p> <p>\u67e5\u770b\u5386\u53f2\uff1a<code>kubectl rollout history deployment/nginx-deployment</code></p> <p>\u67e5\u770b\u6eda\u52a8\u66f4\u65b0\u7684\u72b6\u6001\uff1a<code>kubectl rollout status deployment/nginx-deployment</code></p> <p>\u6682\u505c\uff08\u6279\u91cf\u6539\u914d\u7f6e)\uff0c\u6682\u505c -&gt; \u4fee\u6539\u914d\u7f6e -&gt; \u6062\u590d -&gt; \u6eda\u52a8\u66f4\u65b0\uff1a<code>kubectl rollout pause deployment/nginx-deployment</code></p> <p>\u6062\u590d\uff1a<code>kubectl rollout resume deployment/nginx-deployment</code></p>"},{"location":"cloud/k8s/cmds.html#apiserver","title":"\u5bb9\u5668\u5185\u90e8\u8bbf\u95ee ApiServer","text":""},{"location":"cloud/k8s/cmds.html#_2","title":"\u5b98\u65b9\u5ba2\u6237\u7aef\u5e93","text":"<p>\u9ed8\u8ba4\u7684\u5b98\u65b9\u5ba2\u6237\u7aef\uff0c\u5982 Go \u5ba2\u6237\u7aef\u5e93\uff0c\u901a\u8fc7<code>rest.InClusterConfig()</code>\u81ea\u52a8\u5904\u7406 API Server \u7684\u4e3b\u673a\u53d1\u73b0\u548c\u8eab\u4efd\u8ba4\u8bc1</p> <ul> <li>\u901a\u8fc7 ServiceAccount \u7684\u6302\u8f7d\u4fe1\u606f\u8fdb\u884c\u8ba4\u8bc1\uff0c<code>/var/run/secrets/kubernetes.io/serviceaccount/</code>\u76ee\u5f55\u4e0b</li> <li><code>token</code>\uff0c<code>ca.crt</code>\uff0c<code>namespace</code></li> </ul>"},{"location":"cloud/k8s/cmds.html#restapi","title":"RestAPI\u76f4\u63a5\u8bbf\u95ee","text":"<p>\u4e24\u79cd\u65b9\u5f0f\u83b7\u53d6 REST \u5730\u5740\uff1a</p> <ul> <li><code>KUBERNETES_SERVICE_HOST</code> \u548c <code>KUBERNETES_SERVICE_PORT_HTTPS</code> \u73af\u5883\u53d8\u91cf\u4e3a Kubernetes API \u670d\u52a1\u5668\u751f\u6210\u4e00\u4e2a HTTPS URL\u3002</li> <li>API \u670d\u52a1\u5668\u7684\u96c6\u7fa4\u5185\u5730\u5740\u4e5f\u53d1\u5e03\u5230 <code>default</code> \u547d\u540d\u7a7a\u95f4\u4e2d\u540d\u4e3a <code>kubernetes</code> \u7684 Service \u4e2d\uff08 <code>kubernetes.default.svc</code> \uff09\u3002</li> </ul> <pre><code># \u6307\u5411\u5185\u90e8 API \u670d\u52a1\u5668\u7684\u4e3b\u673a\u540d\nAPISERVER=https://kubernetes.default.svc\n# \u670d\u52a1\u8d26\u53f7\u4ee4\u724c\u7684\u8def\u5f84\nSERVICEACCOUNT=/var/run/secrets/kubernetes.io/serviceaccount\n# \u8bfb\u53d6 Pod \u7684\u540d\u5b57\u7a7a\u95f4\nNAMESPACE=$(cat ${SERVICEACCOUNT}/namespace)\n# \u8bfb\u53d6\u670d\u52a1\u8d26\u53f7\u7684\u6301\u6709\u8005\u4ee4\u724c\nTOKEN=$(cat ${SERVICEACCOUNT}/token)\n# \u5f15\u7528\u5185\u90e8\u8bc1\u4e66\u673a\u6784\uff08CA\uff09\nCACERT=${SERVICEACCOUNT}/ca.crt\n\n# \u4f7f\u7528\u4ee4\u724c\u8bbf\u95ee API\ncurl --cacert ${CACERT} --header \"Authorization: Bearer ${TOKEN}\" -X GET ${APISERVER}/api\n</code></pre>"},{"location":"cloud/k8s/config.html","title":"K8s\u4e2d\u5e38\u7528\u7684\u914d\u7f6e","text":""},{"location":"cloud/k8s/config.html#kubeadm","title":"kubeadm","text":"<p>\u5728\u5bbf\u4e3b\u673a\u4e0a\u8fd0\u884c<code>kubelet</code>\uff0c\u4f7f\u7528\u5bb9\u5668\u90e8\u7f72\u5176\u5b83\u7ec4\u4ef6\u3002</p> <p>kubeadm\u751f\u6210\u7684\u8bc1\u4e66\u6587\u4ef6\u5728Master\u8282\u70b9\u7684<code>/etc/kubernetes/pki</code>\u76ee\u5f55\u4e0b\uff0c\u6700\u4e3b\u8981\u7684\u8bc1\u4e66\u6587\u4ef6\u662f<code>ca.crt</code>\u548c\u5bf9\u5e94\u7684\u79c1\u94a5<code>ca.key</code>\u3002</p> <p>Master\u7ec4\u4ef6\u7684YAML\u6587\u4ef6\u4f1a\u88ab\u751f\u6210\u5728<code>/etc/kubernetes/manifests</code>\u8def\u5f84\u4e0b\uff1b</p>"},{"location":"cloud/k8s/config.html#apiserver","title":"ApiServer","text":""},{"location":"cloud/k8s/config.html#nodeport","title":"\u4fee\u6539NodePort\u8303\u56f4","text":"<p>\u9ed8\u8ba4\u8303\u56f4\u662f 30000-32767\u3002</p> <p>\u4f7f\u7528 kubeadm \u5b89\u88c5 K8S \u96c6\u7fa4\u7684\u60c5\u51b5\u4e0b\uff0c\u4fee\u6539<code>/etc/kubernetes/manifests/kube-apiserver.yaml</code>\u6587\u4ef6\uff0c\u5411\u5176\u4e2d\u6dfb\u52a0 <code>--service-node-port-range=20000-22767</code> \uff08\u5b9a\u4e49\u9700\u8981\u7684\u7aef\u53e3\u8303\u56f4\uff09</p> <p>\u91cd\u542f <code>kube-apiserver</code></p> <pre><code># \u83b7\u5f97 apiserver \u7684 pod \u540d\u5b57\nexport apiserver_pods=$(kubectl get pods --selector=component=kube-apiserver -n kube-system --output=jsonpath={.items..metadata.name})\n# \u5220\u9664 apiserver \u7684 pod\uff0c\u4f1a\u81ea\u52a8\u521b\u5efa\u65b0\u7684 apiserver pod\nkubectl delete pod $apiserver_pods -n kube-system\n</code></pre> <p>\u9a8c\u8bc1\u7ed3\u679c</p> <ul> <li>\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u76f8\u5173pod</li> </ul> <pre><code>kubectl describe pod $apiserver_pods -n kube-system\n</code></pre> <p>\u6ce8\u610f\uff1a</p> <ul> <li>\u5bf9\u4e8e\u5df2\u7ecf\u521b\u5efa\u7684NodePort\u7c7b\u578b\u7684Service\uff0c\u9700\u8981\u5220\u9664\u91cd\u65b0\u521b\u5efa\uff08TODO\uff1a\u7aef\u53e3\u524d\u540e\u8303\u56f4\u51b2\u7a81\u7684\u5904\u7406\uff1f\uff09\uff1b</li> <li>\u5982\u679c\u96c6\u7fa4\u6709\u591a\u4e2a Master \u8282\u70b9\uff0c\u9700\u8981\u9010\u4e2a\u4fee\u6539\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7684 <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code> \u6587\u4ef6\uff0c\u5e76\u91cd\u542f apiserver\u3002</li> </ul>"},{"location":"cloud/k8s/config.html#_1","title":"\u7f51\u7edc","text":""},{"location":"cloud/k8s/config.html#coredns","title":"CoreDNS \u6dfb\u52a0\u57df\u540d\u6620\u5c04","text":"<p><code>kubectl edit configmap coredns -n kube-system</code></p> <ul> <li>\u5728 <code>hosts</code> \u4e2d \u6dfb\u52a0\u4e3b\u673a\u540d\u5230 ip \u7684\u6620\u5c04\uff1b</li> </ul> <pre><code>data:\n  Corefile: |\n    .:53 {\n        ... \n        hosts {\n          172.16.1.129 apiserver.cluster.local\n          # \u6dfb\u52a0\u4e3b\u673a\u540d\u5230 ip \u7684\u6620\u5c04\n          172.16.2.135   node135\n          172.16.2.136   node136\n          172.16.2.137   node137\n          fallthrough\n        }\n\n        ...\n\n        forward . /etc/resolv.conf {\n           max_concurrent 1000\n        }\n    }\n    # \u7279\u5b9aDNS\u670d\u52a1\u5668\u89e3\u6790\u7279\u5b9a\u57df\u540d\n    *.baidu.com:53 {\n        errors\n        cache 30\n        forward . 192.168.8.132\n    }\n</code></pre>"},{"location":"cloud/k8s/crd_index.html","title":"K8s CRD","text":"<p><code>CustomResourceDefinition</code>\uff1aK8s \u7684 CRD \u7684 Yaml \u5b9a\u4e49\uff0ckubebuilder \u7b49\u4e09\u65b9\u8f6f\u4ef6\u6700\u7ec8\u4e5f\u4f1a\u4ea7\u751f\u8fd9\u6837\u7684 Yaml \u6587\u4ef6\u5b9a\u4e49\u3002</p> <p>kubebuilder \u548c operator sdk \u90fd\u662f\u7f16\u5199 K8s Operator\u7684\u5de5\u5177\uff0coperator sdk \u5bf9\u4e8e\u4f7f\u7528helm \u66f4\u9002\u914d\uff0coperator\u5e95\u5c42\u57fa\u4e8ekubebuilder\u5f00\u53d1\u3002</p> <ul> <li>GO \u5f00\u53d1 CRD\uff1akubebuilder</li> <li>Java \u5f00\u53d1 CRD\uff1aJavaOperator</li> </ul>"},{"location":"cloud/k8s/crd_java.html","title":"Java Operator","text":""},{"location":"cloud/k8s/crd_java.html#fabric8-k8s-client","title":"fabric8 k8s client","text":"<p>\u793a\u4f8b\uff1ahttps://github.com/fabric8io/kubernetes-client/blob/master/doc/KubernetesOperatorsInJavaWrittenUsingFabric8.md</p> <ul> <li>Flink Operator</li> </ul>"},{"location":"cloud/k8s/crd_java.html#java-operator-sdk","title":"Java Operator SDK","text":"<p>\u4f9d\u8d56 java-operator-plugin \uff1f\uff1f</p>"},{"location":"cloud/k8s/crd_kubebuilder.html","title":"Kubebuilder","text":"<p>\u4e00\u4e2a\u4f7f\u7528 CRDs\uff08Custom Resource Definition\uff09 \u6784\u5efa K8s API \u7684 SDK\uff0c\u4e3b\u8981\u662f\uff1a</p> <ul> <li>\u63d0\u4f9b\u811a\u624b\u67b6\u5de5\u5177\u521d\u59cb\u5316 CRDs \u5de5\u7a0b\uff0c\u81ea\u52a8\u751f\u6210 boilerplate \u4ee3\u7801\u548c\u914d\u7f6e\uff1b</li> <li>\u63d0\u4f9b\u4ee3\u7801\u5e93\u5c01\u88c5\u5e95\u5c42\u7684 K8s go-client\uff1b</li> </ul> <p>\u65b9\u4fbf\u7528\u6237\u4ece\u96f6\u5f00\u59cb\u5f00\u53d1 CRDs\uff0cControllers \u548c Admission Webhooks \u6765\u6269\u5c55 K8s\u3002</p> <p>kubebuilder\u3001operator-sdk \u8fd9\u4e9b\u6846\u67b6\u5176\u5b9e\u90fd\u662f\u5728 controller-runtime \u57fa\u7840\u4e0a\u505a\u4e86\u4e00\u5c42\u5c01\u88c5\uff0c\u65b9\u4fbf\u5f00\u53d1\u8005\u5feb\u901f\u751f\u6210\u9879\u76ee\u7684\u811a\u624b\u67b6\uff0c\u4ece\u96f6\u5f00\u59cb\u5f00\u53d1 CRDs\uff0cControllers \u548c Admission Webhooks \u6765\u6269\u5c55 K8s\u3002</p>"},{"location":"cloud/k8s/crd_kubebuilder.html#_1","title":"\u67b6\u6784","text":""},{"location":"cloud/k8s/crd_kubebuilder.html#gvksgvrs","title":"GVKs&amp;GVRs","text":"<p>GVK = GroupVersionKind\uff0cGVR = GroupVersionResource\u3002</p>"},{"location":"cloud/k8s/crd_kubebuilder.html#api-group-versionsgv","title":"API Group &amp; Versions\uff08GV\uff09","text":"<p>API Group \u662f\u76f8\u5173 API \u529f\u80fd\u7684\u96c6\u5408\uff0c\u6bcf\u4e2a Group \u62e5\u6709\u4e00\u6216\u591a\u4e2a Versions\uff0c\u7528\u4e8e\u63a5\u53e3\u7684\u6f14\u8fdb\u3002</p>"},{"location":"cloud/k8s/crd_kubebuilder.html#kinds-resources","title":"Kinds &amp; Resources","text":"<p>\u6bcf\u4e2a GV \u90fd\u5305\u542b\u591a\u4e2a API \u7c7b\u578b\uff0c\u79f0\u4e3a Kinds\uff0c\u5728\u4e0d\u540c\u7684 Versions \u4e4b\u95f4\u540c\u4e00\u4e2a Kind \u5b9a\u4e49\u53ef\u80fd\u4e0d\u540c\uff0c Resource \u662f Kind \u7684\u5bf9\u8c61\u6807\u8bc6\uff08resource type\uff09\uff1a</p> <ul> <li>\u4e00\u822c\u6765\u8bf4 Kinds \u548c Resources \u662f 1:1 \u7684\uff0c\u6bd4\u5982 pods Resource \u5bf9\u5e94 Pod Kind\uff1b</li> <li>\u6709\u65f6\u5019\u76f8\u540c\u7684 Kind \u53ef\u80fd\u5bf9\u5e94\u591a\u4e2a Resources\uff0c\u6bd4\u5982 Scale Kind \u53ef\u80fd\u5bf9\u5e94\u5f88\u591a Resources\uff1adeployments/scale\uff0creplicasets/scale\uff1b</li> <li>\u5bf9\u4e8e CRD \u6765\u8bf4\uff0c\u53ea\u4f1a\u662f 1:1 \u7684\u5173\u7cfb\uff1b</li> </ul> <p>\u6bcf\u4e00\u4e2a GVK \u90fd\u5173\u8054\u7740\u4e00\u4e2a package \u4e2d\u7ed9\u5b9a\u7684 root Go type\uff0c\u6bd4\u5982 apps/v1/Deployment \u5c31\u5173\u8054\u7740 K8s \u6e90\u7801\u91cc\u9762 k8s.io/api/apps/v1 package \u4e2d\u7684 Deployment struct\uff0c\u6211\u4eec\u63d0\u4ea4\u7684\u5404\u7c7b\u8d44\u6e90\u5b9a\u4e49 YAML \u6587\u4ef6\u90fd\u9700\u8981\u5199\uff1a</p> <ul> <li>apiVersion\uff1a\u8fd9\u4e2a\u5c31\u662f GV \u3002</li> <li>kind\uff1a\u8fd9\u4e2a\u5c31\u662f K\u3002</li> </ul>"},{"location":"cloud/k8s/crd_kubebuilder.html#_2","title":"\u4f7f\u7528","text":"<p>[Tutorial: Building CronJob](https://book.kubebuilder.io/cronjob-tutorial/cronjob-tutorial.html)</p>"},{"location":"cloud/k8s/crd_kubebuilder.html#_3","title":"\u5b89\u88c5","text":"<p>\u5b89\u88c5 kubebuilder \u548c\u5b83\u4f9d\u8d56\u7684 kustomize</p> <pre><code># download kubebuilder and install locally.\ncurl -L -o kubebuilder https://go.kubebuilder.io/dl/latest/$(go env GOOS)/$(go env GOARCH)\n\nchmod +x kubebuilder &amp;&amp; mv kubebuilder /usr/local/bin/\n</code></pre>"},{"location":"cloud/k8s/crd_kubebuilder.html#_4","title":"\u521b\u5efa\u5de5\u7a0b","text":"<p>\u521b\u5efa\u4e86\u4e00\u4e2a Go module \u5de5\u7a0b\uff0c\u5f15\u5165\u4e86\u5fc5\u8981\u7684\u4f9d\u8d56\uff0c\u521b\u5efa\u4e86\u4e00\u4e9b\u6a21\u677f\u6587\u4ef6</p> <pre><code># create a project directory, and then run the init command.\nmkdir project\ncd project\n# we'll use a domain of test.kubebuild.xliu,\n# so all API groups will be &lt;group&gt;.test.kubebuild.xliu.\n# project's name defaults to that of your current working directory\nkubebuilder init --domain test.kubebuild.xliu --repo test.kubebuild.xliu/kubebuilddemo\n</code></pre> <p>\u5f62\u6210\u7684\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff1a</p> <ul> <li><code>go.mod</code>\uff1a\u9879\u76ee\u7684go \u6a21\u5757\u4fe1\u606f\uff0c\u5305\u542b\u57fa\u672c\u7684\u4f9d\u8d56\u4fe1\u606f</li> <li><code>Makefile</code>\uff1a\u7f16\u8bd1\u548c\u90e8\u7f72controller\u7684make \u4fe1\u606f\uff1b</li> <li><code>PROJECT</code>\uff1a\u7528\u4e8e\u642d\u5efa\u65b0\u7ec4\u4ef6\u7684Kubebuilder\u5143\u6570\u636e</li> </ul> <p></p> <ul> <li><code>main.go</code>\uff1a\u6ce8\u518ccontroller\u7684\u4ee3\u7801</li> </ul>"},{"location":"cloud/k8s/crd_kubebuilder.html#api","title":"\u521b\u5efaAPI","text":"<p>\u521b\u5efa\u4e86\u5bf9\u5e94\u7684 CRD \u548c Controller \u6a21\u677f\u6587\u4ef6</p> <ul> <li><code>group</code>\uff1a\u7ec4\u7ec7\uff0c\u4f1a\u914d\u5408domain\u4f7f\u7528\uff0c\u5982<code>batch.test.kubebuild.xliu</code>\uff1b</li> <li><code>version</code>\uff1a\u7248\u672c\u53f7\uff1b</li> <li><code>kind</code>\u7c7b\u578b\u6709\uff1a\u8d44\u6e90\u7c7b\u578b</li> </ul> <pre><code>kubebuilder create api --group gitop --version v1 --kind DeployWatch\n</code></pre> <p>\u521b\u5efa\u597d\u7684\u76ee\u5f55\u7ec4\u7ec7\u5982\u4e0b\uff1a</p> <ul> <li><code>api/v1</code>\uff1a</li> <li><code>cron_types.go</code>\uff1a\u81ea\u5b9a\u4e49CRD\u7684\u5730\u65b9\uff1b</li> <li><code>groupversion_info.go</code>\uff1aGV\u901a\u7528\u6570\u636e\u751f\u6210CRD\uff0c\u4ee5\u53caSchema\u7684\u521b\u5efa\uff1b</li> <li><code>zz_generated.deeocopy.go</code>\uff1a\u5305\u542b\u4ee3\u7801\u751f\u6210\u7684runtime.Object\u63a5\u53e3\u5b9e\u73b0\uff0cDeepCopy\u662f\u6838\u5fc3\uff1b</li> <li><code>controller</code>\uff1a</li> <li><code>cronjob_controller.go</code>\uff1a\u81ea\u5b9a\u4e49controller\u903b\u8f91\u7684\u5730\u65b9\uff1b</li> </ul> <p>\u4e0b\u56fe\u662f\u4e2a\u793a\u4f8b\uff1a</p> <p></p>"},{"location":"cloud/k8s/crd_kubebuilder.html#crd","title":"\u81ea\u5b9a\u4e49CRD\u5b57\u6bb5","text":"<p>\u5728\u4e2d\u5bf9\u5e94\u7684\u6587\u4ef6\u5b9a\u4e49 Spec \u548c Status\uff0c\u5728<code>api/v1/**_types.go</code>\u4e2d\uff0c</p> <ul> <li><code>DeployWatch</code>\uff1a\u6839\u7c7b\u578b\uff0c\u63cf\u8ff0<code>CronJob</code>\u7c7b\u578b\uff0c\u4e0d\u9700\u8981\u6539\u53d8\uff1b</li> <li><code>TypeMeta</code>\uff1aAPI version \u548c Kind\uff1b</li> <li><code>ObjectMeta</code>\uff1aname\u3001namespace\u3001labels \u7b49\uff1b</li> <li><code>DeployWatchSpec</code>\uff1aspec\uff0c\u9700\u8981\u5bf9\u5e94\u7684 json \u63cf\u8ff0\uff0c\u9700\u8981\u5bf9\u5e94\u8865\u5145\u5b57\u6bb5\uff1b</li> <li><code>DeployWatchSpecStatus</code>\uff1a\u72b6\u6001\u4fe1\u606f\uff0c\u9700\u8981\u5bf9\u5e94\u8865\u5145\u5b57\u6bb5\uff1b</li> <li><code>DeployWatchList</code>\uff1aCRD\u96c6\u5408\uff0c\u7528\u4e8e\u7c7b\u4f3cLIST\u7684\u64cd\u4f5c\uff0c\u4e0d\u9700\u8981\u6539\u53d8\uff1b</li> </ul> <pre><code>// DeployWatchSpec defines the desired state of CronJob\ntype DeployWatchSpec struct {\n    // INSERT ADDITIONAL SPEC FIELDS - desired state of cluster\n    // Important: Run \"make\" to regenerate code after modifying this file\n\n    // Repo is the git repo url\n    Repo string `json:\"repo\"`\n    // Path is the k8s yaml file path, support directory\n    Path string `json:\"path\"`\n    // User the user can access the repo\n    User string `json:\"user,omitempty\"`\n    // Secret the secret for use to access the repo\n    Secret string `json:\"secret,omitempty\"`\n}\n\n// DeployWatchStatus defines the observed state of DeployWatch\ntype DeployWatchStatus struct {\n    // INSERT ADDITIONAL STATUS FIELD - define observed state of cluster\n    // Important: Run \"make\" to regenerate code after modifying this file\n    LastUpdateTime string      `json:\"LastUpdateTime,omitempty\"`\n    Conditions     []Condition `json:\"conditions\"`\n    Phase          Phase       `json:\"phase\"`\n}\n\n//+kubebuilder:object:root=true\n//+kubebuilder:subresource:status\n\n// DeployWatch is the Schema for the deploywatches API\ntype DeployWatch struct {\n    metav1.TypeMeta   `json:\",inline\"`\n    metav1.ObjectMeta `json:\"metadata,omitempty\"`\n\n    Spec   DeployWatchSpec   `json:\"spec,omitempty\"`\n    Status DeployWatchStatus `json:\"status,omitempty\"`\n}\n\n//+kubebuilder:object:root=true\n\n//+kubebuilder:object:root=true\n\n// DeployWatchList contains a list of DeployWatch\ntype DeployWatchList struct {\n    metav1.TypeMeta `json:\",inline\"`\n    metav1.ListMeta `json:\"metadata,omitempty\"`\n    Items           []DeployWatch `json:\"items\"`\n}\n</code></pre> <p>kubebuilder \u4f7f\u7528\u7279\u5b9a\u6ce8\u91ca\u6765\u751f\u6210\u5e76\u7f16\u8bd1\u4ee3\u7801\uff0c\u6709\u4e9b\u7c7b\u4f3c\u4e8e Spring \u4e2d\u7684\u6ce8\u89e3\u3002\u4f8b\u5982<code>kubebuilder:object:root=true</code>\u8868\u793a\u751f\u6210\u6b64\u5bf9\u8c61\u7684api\u3002</p>"},{"location":"cloud/k8s/crd_kubebuilder.html#controller","title":"\u5b8c\u5584 controller \u903b\u8f91","text":"<p>kubebuilder \u4f9d\u8d56\u4e8e <code>controller-runtime</code> \u5b9e\u73b0 controller \u6574\u4e2a\u5904\u7406\u6d41\u7a0b</p> <p>\u5728<code>controllers/**_controller.go</code>\u4e2d\uff0c\u6709\u51fd\u6570</p> <pre><code>//+kubebuilder:rbac:groups=batch.test.kubebuild.xliu,resources=cronjobs,verbs=get;list;watch;create;update;patch;delete\n//+kubebuilder:rbac:groups=batch.test.kubebuild.xliu,resources=cronjobs/status,verbs=get;update;patch\n//+kubebuilder:rbac:groups=batch.test.kubebuild.xliu,resources=cronjobs/finalizers,verbs=update\nfunc (r *CronJobReconciler) Reconcile(ctx context.Context, req ctrl.Request) (ctrl.Result, error) {\n    // context is used to allow cancelation of requests, and potentially things like tracing\n    _ = log.FromContext(ctx)\n\n    // TODO(user): your logic here\n\n    // successfully reconciled this object and don\u2019t need to try again until there\u2019s some changes.\n    return ctrl.Result{}, nil\n}\n</code></pre> <p>\u8fd9\u5c31\u662f\u63a7\u5236\u5668\u7684\u5904\u7406\u51fd\u6570\uff0c\u6bcf\u5f53\u96c6\u7fa4\u4e2d\u6709Sample\u8d44\u6e90\u7684\u53d8\u52a8\uff08CRUD\uff09\uff0c\u90fd\u4f1a\u89e6\u53d1\u8fd9\u4e2a\u51fd\u6570\u8fdb\u884c\u534f\u8c03\u3002\u65b9\u6cd5\u4e0a\u9762\u7684\u6ce8\u89e3\u8868\u660e\u4e86controller rbac\u6240\u9700\u8981\u7684\u6743\u9650\u3002</p> <p>\u6bd4\u5982\u6211\u4eec\u5728Reconcile\u4e2d\u83b7\u53d6\u8fdb\u5165\u534f\u8c03\u7684Sample\u5bf9\u8c61\uff0c\u68c0\u67e5\u5b83\u7684<code>status.phase</code>\u662f\u5426\u4e3a<code>Pending</code>\uff0c\u5982\u679c\u662f\uff0c\u5c31\u6839\u636e\u5b57\u6bb5\u521b\u5efa\u5bf9\u5e94\u7684 <code>deployment</code>\u3002</p>"},{"location":"cloud/k8s/crd_kubebuilder.html#admission-webhooks","title":"Admission Webhooks","text":"<p>\u5bf9CRD\u5b9e\u73b0\u7ba1\u7406\u63a5\u53e3\uff1a</p> <ul> <li>Mutating Admission Webhook</li> <li>Validating Admission Webhook:</li> </ul> <pre><code>kubebuilder create webhook --group gitop --version v1 --kind DeployWatch --defaulting --programmatic-validation\n</code></pre> <ul> <li><code>api/v1/**_webhook.go</code>\uff1a\u5b9a\u4e49webhook\uff1b</li> <li><code>main.go</code>\uff1a\u6ce8\u518cwebhook manager\uff1b</li> </ul> <p>\u5b9e\u73b0\u4ee5\u4e0b\u51fd\u6570</p> <pre><code>//+kubebuilder:webhook:path=/mutate-batch-tutorial-kubebuilder-io-v1-cronjob,mutating=true,failurePolicy=fail,groups=batch.tutorial.kubebuilder.io,resources=cronjobs,verbs=create;update,versions=v1,name=mcronjob.kb.io,sideEffects=None,admissionReviewVersions=v1\n\n// Default implements webhook.Defaulter so a webhook will be registered for the type\nfunc (r *DeployWatch) Default() {\n    deploywatchlog.Info(\"default\", \"name\", r.Name)\n\n    // TODO(user): set defaults to our CRD\n}\n\n//+kubebuilder:webhook:verbs=create;update;delete,path=/validate-batch-tutorial-kubebuilder-io-v1-cronjob,mutating=false,failurePolicy=fail,groups=batch.tutorial.kubebuilder.io,resources=cronjobs,versions=v1,name=vcronjob.kb.io,sideEffects=None,admissionReviewVersions=v1\n\n// ValidateCreate implements webhook.Validator so a webhook will be registered for the type\nfunc (r *DeployWatch) ValidateCreate() error {\n    deploywatchlog.Info(\"validate create\", \"name\", r.Name)\n\n    // TODO(user): fill in your validation logic upon object creation.\n    return nil\n}\n// ValidateUpdate implements webhook.Validator so a webhook will be registered for the type\nfunc (r *DeployWatch) ValidateUpdate(old runtime.Object) error {\n    deploywatchlog.Info(\"validate update\", \"name\", r.Name)\n\n    // TODO(user): fill in your validation logic upon object update.\n    return nil\n}\n// ValidateDelete implements webhook.Validator so a webhook will be registered for the type\nfunc (r *DeployWatch) ValidateDelete() error {\n    deploywatchlog.Info(\"validate delete\", \"name\", r.Name)\n\n    // TODO(user): fill in your validation logic upon object deletion.\n    return nil\n}\n</code></pre>"},{"location":"cloud/k8s/crd_kubebuilder.html#_5","title":"\u6d4b\u8bd5","text":"<p>envtest\uff1ahttps://github.com/kubernetes-sigs/controller-runtime/tree/master/pkg/envtest</p> <p><code>controllers/suite_test.go</code>\uff1a\u6d4b\u8bd5controller</p> <ul> <li>\u4f7f\u7528<code>envtest</code>\u521b\u5efa\u672c\u5730\u7684k8s API server\uff0c\u5b9e\u4f8b\u5316\u548c\u521b\u5efa\u5b9a\u4e49\u7684controller\uff1b</li> </ul> <pre><code>export K8S_VERSION=1.21.2\ncurl -sSLo envtest-bins.tar.gz \"https://go.kubebuilder.io/test-tools/${K8S_VERSION}/$(go env GOOS)/$(go env GOARCH)\"\nmkdir /usr/local/kubebuilder\ntar -C /usr/local/kubebuilder --strip-components=1 -zvxf envtest-bins.tar.gz\n</code></pre>"},{"location":"cloud/k8s/crd_kubebuilder.html#_6","title":"\u90e8\u7f72","text":"<p>\u5b89\u88c5CRDs\uff1a</p> <ul> <li>\u5728\u9879\u76ee\u4e3b\u76ee\u5f55\u4e0b\u6267\u884c<code>make install</code>\uff0c\u4f1a\u81ea\u52a8\u8c03\u7528 <code>kustomize</code> \u521b\u5efa\u90e8\u7f72 crd \u7684yml\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4ece <code>config/crd/bases/</code>\u4e0b\u627e\u5230\u5bf9\u5e94\u7684 crd yaml\u6587\u4ef6\u3002</li> </ul>"},{"location":"cloud/k8s/crd_kubebuilder.html#_7","title":"\u672c\u673a\u96c6\u7fa4","text":"<p>\u672c\u5730\u542f\u52a8 controller \u4e3b\u7a0b\u5e8f\uff1a</p> <ul> <li><code>make run ENABLE_WEBHOOKS=false</code></li> </ul> <p>\u901a\u8fc7kubectl\u90e8\u7f72cronjob\uff0c\u4ee5<code>config/samples/batch_v1_cronjob.yaml</code>\u4e3a\u4f8b</p> <ul> <li><code>kubectl create -f config/samples/batch_v1_cronjob.yaml</code></li> </ul> <pre><code>apiVersion: batch.test.kubebuild.xliu/v1\nkind: CronJob\nmetadata:\n  name: cronjob-sample\nspec:\n  schedule: \"*/1 * * * *\"\n  startingDeadlineSeconds: 60\n  concurrencyPolicy: Allow # explicitly specify, but Allow is also default.\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n            - name: hello\n              image: busybox\n              args:\n                - /bin/sh\n                - -c\n                - date; echo Hello from the Kubernetes cluster\n          restartPolicy: OnFailure\n</code></pre>"},{"location":"cloud/k8s/crd_kubebuilder.html#_8","title":"\u8fdc\u7a0b\u96c6\u7fa4","text":"<p>\u5f53\u6211\u4eec\u60f3\u4ee5deployment\u65b9\u5f0f\u90e8\u7f72controller\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 Dockerfile \u6784\u5efa\u955c\u50cf\uff0c\u4f7f\u7528<code>config/manager/manager.yml</code> \u90e8\u7f72\u3002</p> <pre><code>make docker-build docker-push IMG=&lt;some-registry&gt;/&lt;project-name&gt;:tag\nmake deploy IMG=&lt;some-registry&gt;/&lt;project-name&gt;:tag\n</code></pre>"},{"location":"cloud/k8s/crd_kubebuilder.html#webhooktodo","title":"Webhook\uff08TODO\uff09","text":""},{"location":"cloud/k8s/crd_kubebuilder.html#todo","title":"\u5b9e\u8df5\u6e90\u7801\uff08TODO\uff09","text":"<p>\u53c2\u8003 fluid</p> <ul> <li>\u53ef\u4ee5\u5c06 webhook \u8ddf crd controller \u5206\u6210\u4e24\u4e2a\u955c\u50cf\uff0c\u63d0\u4f9b\u4e0d\u540c\u7684\u5165\u53e3\u548c\u5904\u7406\uff1b</li> <li>\u9488\u5bf9 webhook \u53ef\u4ee5\u5b9e\u73b0\u81ea\u5b9a\u4e49\u6ce8\u518c Handler \u7684\u65b9\u5f0f\uff1b</li> </ul>"},{"location":"cloud/k8s/crd_kubebuilder.html#_9","title":"\u8fdb\u9636","text":""},{"location":"cloud/k8s/crd_kubebuilder.html#statusupdate","title":"Status().Update()","text":"<p>\u5728 Kubebuilder \u81ea\u52a8\u751f\u6210\u7684CR\u7ed3\u6784\u4f53\u4e2d\uff0c\u5df2\u7ecf\u4e3a\u6211\u4eec\u751f\u6210\u4e86 Status \u7684\u7ed3\u6784\u4f53\uff0c\u4f46\u6b64\u65f6 Status \u4ecd\u975e CR \u7684\u5b50\u8d44\u6e90\u3002</p> <p>\u9ed8\u8ba4\u521b\u5efa\u7684SampleSpec \u548c SampleStatus \u90fd\u662f Sample \u7684\u6210\u5458\u53d8\u91cf\uff0cStatus\u5e76\u4e0d\u50cfPod.Status\u4e00\u6837\uff0c\u662fPod\u7684subResource\u3002</p> <p>\u56e0\u6b64\uff0c\u5982\u679c\u6211\u4eec\u5728controller\u7684\u4ee3\u7801\u4e2d\u8c03\u7528\u5230<code>Status().Update()</code>, \u4f1a\u89e6\u53d1<code>panic</code>\uff0c\u5e76\u62a5\u9519\uff1a<code>the server could not find the requested resource</code></p> <p>\u5982\u679c\u6211\u4eec\u60f3\u50cfk8s\u4e2d\u7684\u8bbe\u8ba1\u90a3\u6837\uff0c\u90a3\u4e48\u5c31\u8981\u9075\u5faak8s\u4e2d<code>status subresource</code>\u7684\u4f7f\u7528\u89c4\u8303\uff1a</p> <ul> <li>\u7528\u6237\u53ea\u80fd\u6307\u5b9a\u4e00\u4e2aCRD\u5b9e\u4f8b\u7684spec\u90e8\u5206\uff1b</li> <li>CRD\u5b9e\u4f8b\u7684status\u90e8\u5206\u7531\u63a7\u5236\u5668\u8fdb\u884c\u53d8\u66f4\u3002</li> </ul> <p>\u6b64\u65f6\u6211\u4eec\u9700\u8981\u5728 Sample \u4e2d\u6dfb\u52a0\u4e00\u884c\u6ce8\u89e3<code>// +kubebuilder:subresource:status</code>\uff0c\u6807\u660e status \u662f Sample \u7684\u5b50\u8d44\u6e90\u3002</p>"},{"location":"cloud/k8s/crd_kubebuilder.html#eventrecorder","title":"EventRecorder","text":"<p>Status \u5b57\u6bb5\u7528\u4e8e CR \u7684\u903b\u8f91\u5904\u7406\uff0c\u4f46\u5728\u540e\u671f\u7ef4\u62a4\u8fc7\u7a0b\u4e2d\uff0c\u5219\u4e00\u90e8\u5206\u4f1a\u4f9d\u8d56\u4e8e CR \u6240\u4ea7\u751f\u7684 Event\uff0c\u8fd9\u6709\u4e9b\u7c7b\u4f3c\u4e8e\u5728 CR \u7684\u4e1a\u52a1\u903b\u8f91\u4e2d\u6dfb\u52a0\u90e8\u5206\u91cd\u8981\u7684\u65e5\u5fd7\uff0c\u6700\u7ec8\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5b9a\u4f4d\u95ee\u9898\u3002\u540e\u671f\u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>kubectl describe cr -n xxx</code> \u770b\u5230\u8fd9\u4e9b Event\u3002</p> <p>\u5728 <code>SampleReconciler</code> \u4e2d\u52a0\u5165 <code>recorder.EventRecorder</code> \u6210\u5458\u53d8\u91cf:</p> <pre><code>type SampleReconciler struct {\n    client.Client\n    Log      logr.Logger\n    Scheme   *runtime.Scheme\n    Recorder record.EventRecorder\n}\n// \u5728\u4e1a\u52a1\u903b\u8f91\u4e2d\u8bb0\u5f55\nfunc (r *SampleReconciler) Reconcile(req ctrl.Request) (ctrl.Result, error) {\n    sample := &amp;samplev1.Sample{}\n    _ := r.Get(ctx, client.ObjectKey{Name: req.Name, Namespace: req.Namespace}, sample)\n    // do something\n    r.Recorder.Eventf(sample, corev1.EventTypeWarning, \"Error\", \"some error\")\n}\n</code></pre> <p>K8s \u4e3a\u6211\u4eec\u63d0\u4f9b\u4e862\u79cd\u7b49\u7ea7\u7684 event\uff0c\u5206\u522b\u662f Normal \u548c Warning\u3002</p>"},{"location":"cloud/k8s/crd_kubebuilder.html#finalizer","title":"Finalizer","text":"<p>\u7531\u4e8e\u8fd9\u4e2aObject\u53ef\u80fd\u521b\u5efa\u4e00\u4e9b\u5176\u4ed6\u7684resource(\u6bd4\u5982pod)\uff0c\u5728\u5220\u9664\u4e4b\u524d\uff0c\u9700\u8981\u505a\u4e00\u4e9b\u6e05\u7406\u5de5\u4f5c, finalizer\u5c31\u662f\u5b9e\u73b0\u8fd9\u4e2a\u6e05\u7406\u7684framework\u4ee3\u7801\u3002</p> <p>finalizer\u5373\u7ec8\u7ed3\u5668\uff0c\u5b58\u5728\u4e8e\u6bcf\u4e00\u4e2ak8s\u5185\u7684\u8d44\u6e90\u5b9e\u4f8b\u4e2d\uff0c\u5373<code>**.metadata.finalizers</code>,\u5b83\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u6570\u7ec4\uff0c\u6bcf\u4e00\u4e2a\u6210\u5458\u8868\u793a\u4e00\u4e2afinalizer\u3002</p> <p>\u63a7\u5236\u5668\u5728\u5220\u9664\u67d0\u4e2a\u8d44\u6e90\u65f6\uff0cK8s \u4f1a\u66f4\u65b0 CR \u7684 <code>DeletionTimestamp</code> \u5b57\u6bb5\uff0c\u8fd9\u6837\u4f1a\u89e6\u53d1\u4e00\u4e2a Update \u52a8\u4f5c\uff0c\u6211\u4eec\u7684 controller \u53ef\u4ee5\u76d1\u542c\u8fd9\u4e2a\u5b57\u6bb5\u7684\u53d8\u66f4\uff0c\u5b9e\u73b0 CR \u7684\u9884\u5220\u9664\u5904\u7406\uff0c\u6bd4\u5982\u5220\u9664\u7531 CR \u521b\u5efa\u7684\u67d0\u4e9b\u8d44\u6e90\u3002</p> <p>\u5f53\u6211\u4eec\u9700\u8981\u8bbe\u8ba1\u8fd9\u7c7bfinalizer\u65f6\uff0c\u5c31\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4e00\u4e2acontroller\u6765\u5b9e\u73b0\u3002</p> <pre><code>func (c *SampleReconciler) finalize(ctx context.Context, sample *samplev1.Sample) error {\n    logs := c.getLog(sample)\n    // \u8fd9\u91cc\u6211\u4eec\u81ea\u5b9a\u4e49\u4e00\u4e2a finalizer \u5b57\u6bb5\n    myFinalizerName := \"sample.finalizers.io\"\n\n    if sample.ObjectMeta.DeletionTimestamp.IsZero() {\n        //\u8fd9\u91cc\u7531\u4e8e DeletionTimestamp \u662f0\uff0c\u5373\u6ca1\u6709\u5220\u9664\u64cd\u4f5c\uff0c\u5219\u4e0d\u8fdb\u884c\u5904\u7406\uff0c\u53ea\u68c0\u67e5 CR \u4e2d\u662f\u5426\u542b\u6709\u81ea\u5b9a\u4e49 finalizer \u5b57\u7b26\uff0c\u82e5\u6ca1\u6709\u5219\u589e\u52a0\u3002\n        if !containsString(sample.ObjectMeta.Finalizers, myFinalizerName) {\n            sample.ObjectMeta.Finalizers = append(sample.ObjectMeta.Finalizers, myFinalizerName)\n        }\n    } else {\n        //\u8fdb\u884c\u9884\u5220\u9664\u64cd\u4f5c\n        if containsString(sample.ObjectMeta.Finalizers, myFinalizerName) {\n            // do something \n            // \u4ece CR \u4e2d\u5220\u9664\u81ea\u5b9a\u4e49 finalizer \u5b57\u6bb5\u3002\n            sample.ObjectMeta.Finalizers = removeString(sample.ObjectMeta.Finalizers, myFinalizerName)\n        }\n        return nil\n    }\n    return nil\n}\n</code></pre>"},{"location":"cloud/k8s/crd_kubebuilder.html#_10","title":"\u7d22\u5f15","text":"<p>client-go\u652f\u6301\u6784\u5efa\u5e26\u7d22\u5f15\u7684\u7f13\u5b58\uff0c\u5e76\u4e14\u5141\u8bb8\u7528\u6237\u81ea\u5b9a\u4e49\u7d22\u5f15\u51fd\u6570\u7684\u540d\u79f0\u548c\u5185\u5bb9\u3002\u5f53\u7f13\u5b58\u7684\u6570\u636e\u5e26\u6709\u7d22\u5f15\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u66f4\u5feb\u5730\u901a\u8fc7\u7d22\u5f15List\u5230\u60f3\u8981\u7684\u6570\u636e\uff0c\u65e2\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd\u53c8\u53ef\u4ee5\u51cf\u5c11\u4ee3\u7801\u91cf\u3002</p> <p>kubebuilder 2.0 \u63d0\u4f9b\u4e86\u5f88\u7b80\u5355\u7684\u7d22\u5f15\u6784\u5efa\u65b9\u5f0f\u3002\u6bd4\u5982\u6211\u4eec\u8981\u4ee5pod\u4e2d\u7684spec.NodeName\u4e3a\u7d22\u5f15\uff0c \u65b9\u4fbf\u6211\u4eec\u5feb\u901fList\u67e5\u8be2\u67d0\u4e2a\u8282\u70b9\u4e0a\u7684pod\uff1a</p> <pre><code>// \u8981\u5148\u6784\u5efa\u597dmanager\n\nmgr.GetFieldIndexer().IndexField(context.Background(), &amp;v1.Pod{}, \"indexNodeNameOfPod\", func(o runtime.Object) []string {\n        v := o.(*v1.Pod).Spec.NodeName\n        return []string{v}\n    })\n\n    ...\n\n// \u4f7f\u7528 manager\u7684client\u8fdb\u884cList\uff0c\u6216\u8005 Reconciler\u7684 List \u65b9\u6cd5\npodList := &amp;v1.PodList{}\nerr := mgr.GetClient().List(context.TODO(), podList, &amp;client.MatchingFields{\"indexNodeNameOfPod\": node.Name})\n</code></pre>"},{"location":"cloud/k8s/crd_kubebuilder.html#reconcilertodo","title":"\u6269\u5c55 Reconciler\uff08TODO\uff09","text":"<p>\u5047\u8bbe\u73b0\u5728\u5df2\u7ecf\u76d1\u542c\u5230 CR \u7684\u53d8\u5316\u4e8b\u4ef6\uff08\u5305\u62ec \u521b\u5efa\u3001\u66f4\u65b0\u3001\u5220\u9664\u3001\u6269\u5c55\uff09\uff0c\u8fd9\u4e2a\u4e8b\u4ef6\u5219\u4f1a\u8fdb\u5165 WorkQueue \u4e2d\u3002</p> <p>\u5728\u8fdb\u5165 WorkQueue \u4e4b\u524d\uff0c <code>controller-runtime</code> \u4f1a\u8fdb\u884c\u4e00\u4e9b\u8fc7\u6ee4\u5904\u7406\u548c\u4e1a\u52a1\u5904\u7406\u3002\u4e3b\u8981\u6d89\u53ca\u63a5\u53e3\u662f <code>EventHandler</code> \u548c <code>Predicate</code>\u3002</p> <p>\u5176\u4e2d <code>EventHandler</code> \u53ef\u4ee5\u5728\u4e8b\u4ef6\u5165\u961f\u5217\u4e4b\u524d\u52a0\u5165\u5176\u4ed6\u903b\u8f91\uff0c\u5176\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <pre><code>//controller-runtime@v0.5.0\\pkg\\handler\\eventhandler.go\n//\u6b64\u5904\u5b9a\u4e49\u4e86\u9488\u5bf9\u4e0d\u540c\u4e8b\u4ef6\u7684\u5904\u7406\u63a5\u53e3\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0\u6b64\u63a5\u53e3\u5b8c\u6210\u6269\u5c55\u4e1a\u52a1\u903b\u8f91\ntype EventHandler interface {\n    // Create is called in response to an create event - e.g. Pod Creation.\n    Create(event.CreateEvent, workqueue.RateLimitingInterface)\n\n    // Update is called in response to an update event -  e.g. Pod Updated.\n    Update(event.UpdateEvent, workqueue.RateLimitingInterface)\n\n    // Delete is called in response to a delete event - e.g. Pod Deleted.\n    Delete(event.DeleteEvent, workqueue.RateLimitingInterface)\n\n    // Generic is called in response to an event of an unknown type or a synthetic event triggered as a cron or\n    // external trigger request - e.g. reconcile Autoscaling, or a Webhook.\n    Generic(event.GenericEvent, workqueue.RateLimitingInterface)\n}\n</code></pre> <p><code>Predicate</code> \u5219\u662f\u5bf9\u76d1\u542c\u5230\u7684\u4e8b\u4ef6\u8fdb\u884c\u8fc7\u6ee4\uff0c\u8ba9\u6211\u4eec\u53ea\u5173\u6ce8\u6211\u4eec\u60f3\u8981\u7684\u65f6\u95f4\uff0c\u5176\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a</p> <pre><code>type Predicate interface {\n    // Create returns true if the Create event should be processed\n    Create(event.CreateEvent) bool\n\n    // Delete returns true if the Delete event should be processed\n    Delete(event.DeleteEvent) bool\n\n    // Update returns true if the Update event should be processed\n    Update(event.UpdateEvent) bool\n\n    // Generic returns true if the Generic event should be processed\n    Generic(event.GenericEvent) bool\n}\n</code></pre> <p>\u5728\u5165\u961f\u5217\u4e4b\u524d\uff0ccontroller-runtime \u7684\u5904\u7406\u903b\u8f91\u5982\u4e0b\uff1a</p> <pre><code>//controller-runtime@v0.5.0\\pkg\\source\\internal\\eventsource.go\ntype EventHandler struct {\n    EventHandler handler.EventHandler\n    Queue        workqueue.RateLimitingInterface\n    Predicates   []predicate.Predicate\n}\n\nfunc (e EventHandler) OnAdd(obj interface{}) {\n    c := event.CreateEvent{}\n    ...\n    // \u8fd9\u91cc\u53ef\u4ee5\u81ea\u5b9a\u4e49 Predicates\uff0c\u5c06\u4e8b\u4ef6\u8fdb\u884c\u8fc7\u6ee4\n    for _, p := range e.Predicates {\n        if !p.Create(c) {\n            return\n        }\n    }\n\n    // \u8c03\u7528\u4e86\u4e0a\u9762\u7684 EventHandler \u5bf9\u5e94\u7684\u903b\u8f91\n    e.EventHandler.Create(c, e.Queue)\n}\n\n// \u9664\u4e86 OnAdd \u5916\uff0c\u8fd8\u6709 OnUpdate OnDelete\n</code></pre> <p>\u6ce8\u610f\uff0c\u6700\u7ec8\u5165\u961f\u5217\u7684\u6570\u636e\u7ed3\u6784\u5982\u4e0b\uff0c\u5373\u53ea\u6709 namespace \u548cname\uff0c\u5e76\u6ca1\u6709\u8d44\u6e90\u7684\u7c7b\u578b\u3002</p> <pre><code>type NamespacedName struct {\n    Namespace string\n    Name      string\n}\n</code></pre> <p>\u5728 <code>controller-runtime</code> \u5305\u4e2d\u7684 <code>controller.Start()</code>\u65b9\u6cd5\u4e2d\uff0c\u5219\u4f1a\u5faa\u73af\u4ece\u961f\u5217\u4e2d\u62ff\u53d6\u4e00\u4e2a\u4e8b\u4ef6</p> <pre><code>// controller.go\nfunc (c *Controller) Start(stop &lt;-chan struct{}) error {\n    ...\n        // \u542f\u52a8\u591a\u4e2a worker \u7ebf\u7a0b\uff0c\u5904\u7406\u4e8b\u4ef6\n        log.Info(\"Starting workers\", \"controller\", c.Name, \"worker count\", c.MaxConcurrentReconciles)\n        for i := 0; i &lt; c.MaxConcurrentReconciles; i++ {\n            go wait.Until(c.worker, c.JitterPeriod, stop)\n        }\n    ...\n}\nfunc (c *Controller) worker() {\n    for c.processNextWorkItem() {\n    }\n}\nfunc (c *Controller) processNextWorkItem() bool {\n    // \u62ff\u53d6\u4e00\u4e2a\u4e8b\u4ef6\n    obj, shutdown := c.Queue.Get()\n    if shutdown {\n        // Stop working\n        return false\n    }\n\n    // We call Done here so the workqueue knows we have finished\n    // processing this item. We also must remember to call Forget if we\n    // do not want this work item being re-queued. For example, we do\n    // not call Forget if a transient error occurs, instead the item is\n    // put back on the workqueue and attempted again after a back-off\n    // period.\n    defer c.Queue.Done(obj)\n    //\u5904\u7406\u4e8b\u4ef6\n    return c.reconcileHandler(obj)\n}\n</code></pre>"},{"location":"cloud/k8s/crd_kubebuilder.html#_11","title":"\u76d1\u63a7\u8d44\u6e90\u53d8\u5316","text":""},{"location":"cloud/k8s/crd_kubebuilder.html#operator","title":"Operator\u7ba1\u7406\u7684\u8d44\u6e90","text":"<p>\u5f00\u53d1\u65f6\uff0c\u53ef\u80fd\u4f1a\u9047\u5230 CR -&gt; Deployment -&gt; Pod \u7684\u903b\u8f91\uff0c\u5373\u7531CR \u521b\u5efadeployment\uff0c\u6700\u7ec8\u843d\u5165pod\u3002\u8fd9\u65f6\uff0c\u6211\u4eec\u4e0d\u4ec5\u9700\u8981\u76d1\u542c CR \u7684\u53d8\u5316\uff0c deployment \u4ee5\u53ca pod \u7684\u53d8\u5316\u6211\u4eec\u4e5f\u9700\u8981\u5173\u6ce8\uff0c\u8fd9\u5c31\u610f\u5473\u7740\u6211\u4eec\u5728 reconciler \u4e2d\u4e5f\u9700\u8981\u6839\u636edeployment\u53d8\u5316\u8fdb\u884c\u76f8\u5e94\u7684\u5904\u7406\u3002</p> <p>\u5173\u6ce8\u7531 CR \u521b\u5efa\u7684 Deployment \u91c7\u7528 <code>Owns()</code> \u65b9\u6cd5\u3002</p> <pre><code>// our app will need to be able to use all verbs on a deployment as well as \u201cget\u201d it\u2019s status.\n//+kubebuilder:rbac:groups=apps,resources=deployments,verbs=get;list;watch;create;update;patch;delete\n//+kubebuilder:rbac:groups=apps,resources=deployments/status,verbs=get\nfunc (r *SimpleDeploymentReconciler) Reconcile(ctx context.Context, req ctrl.Request) (ctrl.Result, error) {\n    // \u521b\u5efa Deployment\uff0c\u8bbe\u7f6e\u5176\u76f8\u5173\u53c2\u6570\u5982\u526f\u672c\u6570\n}\n\nfunc (r *SimpleDeploymentReconciler) SetupWithManager(mgr ctrl.Manager) error {\n    return ctrl.NewControllerManagedBy(mgr).\n        For(&amp;samplev1.SimpleDeployment{}).\n        // \u8fd9\u6837\u5728\u76d1\u542c\u65f6\uff0c\u53ea\u4f1a\u76d1\u542c\u5230\u5e26\u6709 OwnerShip \u7684 deployment\u3002\n        Owns(&amp;apps.Deployment{}).\n        Complete(r)\n</code></pre> <p>\u5f53\u6211\u4eec\u4f7f\u7528 CR \u521b\u5efa deployment \u65f6\uff0c\u53ef\u4ee5\u585e\u5165\u4e00\u4e2a\u4ece\u5c5e\u5173\u7cfb\uff0c\u7c7b\u4f3c\u4e8e Pod \u8d44\u6e90\u7684<code>Metadata</code> \u91cc\u4f1a\u6709\u4e00\u4e2a<code>OnwerReference</code>\u5b57\u6bb5\uff0c\u4f1a\u63a5\u6536\u5230\u53d8\u66f4\u901a\u77e5</p> <pre><code>// This will allow for the SimpleDeployment to be reconciled when changes to the Deployment are noticed.\n_ = controllerutil.SetControllerReference(sample, &amp;deployment, r.Scheme)\n</code></pre>"},{"location":"cloud/k8s/crd_kubebuilder.html#_12","title":"\u5916\u90e8\u7ba1\u7406\u7684\u8d44\u6e90","text":"<p>\u8bb8\u591a\u8d44\u6e90\u89c4\u8303\u793a\u4f8b\u5141\u8bb8\u7528\u6237\u5f15\u7528\u5916\u90e8\u8d44\u6e90\uff0c\u5982\uff0c</p> <ul> <li>Ingress \u5f15\u7528\u4e86 Service \u5bf9\u8c61</li> <li>Pod \u6709\u5bf9 ConfigMap\u3001Secrets \u548c Volumes \u7684\u5f15\u7528</li> </ul> <p>\u53ef\u4ee5\u8c03\u7528<code>Watch()</code>\u5b9e\u73b0\u76d1\u542c configmap\uff1a</p> <ul> <li>A Kind (i.e. <code>ConfigMap</code>)</li> <li>A mapping function that converts a <code>ConfigMap</code> object to a list of reconcile requests</li> <li>A list of options for watching the <code>ConfigMaps</code></li> </ul> <pre><code>import {\n    \"context\"\n\n    \"github.com/go-logr/logr\"\n    kapps \"k8s.io/api/apps/v1\"\n    corev1 \"k8s.io/api/core/v1\"\n    \"k8s.io/apimachinery/pkg/fields\" // Required for Watching\n    \"k8s.io/apimachinery/pkg/runtime\"\n    \"k8s.io/apimachinery/pkg/types\" // Required for Watching\n    ctrl \"sigs.k8s.io/controller-runtime\"\n    \"sigs.k8s.io/controller-runtime/pkg/builder\" // Required for Watching\n    \"sigs.k8s.io/controller-runtime/pkg/client\"\n    \"sigs.k8s.io/controller-runtime/pkg/handler\" // Required for Watching\n    \"sigs.k8s.io/controller-runtime/pkg/predicate\" // Required for Watching\n    \"sigs.k8s.io/controller-runtime/pkg/reconcile\" // Required for Watching\n    \"sigs.k8s.io/controller-runtime/pkg/source\" // Required for Watching\n\n    appsv1 \"tutorial.kubebuilder.io/project/api/v1\"\n}\n\nconst (\n    configMapField = \".spec.configMap\"\n)\n\n//+kubebuilder:rbac:groups=apps,resources=deployments,verbs=get;list;watch;create;update;patch;delete\n//+kubebuilder:rbac:groups=apps,resources=deployments/status,verbs=get\n//+kubebuilder:rbac:groups=\"\",resources=configmaps,verbs=get;list;watch\nfunc (r *ConfigDeploymentReconciler) Reconcile(ctx context.Context, req ctrl.Request) (ctrl.Result, error) {\n    var configDeployment appsv1.ConfigDeployment\n    if err := r.Get(ctx, req.NamespacedName, &amp;configDeployment); err != nil {\n        log.Error(err, \"unable to fetch ConfigDeployment\")\n        // we'll ignore not-found errors, since they can't be fixed by an immediate\n        // requeue (we'll need to wait for a new notification), and we can get them\n        // on deleted requests.\n        return ctrl.Result{}, client.IgnoreNotFound(err)\n    }\n    // your logic here\n\n    var configMapVersion string\n    if configDeployment.Spec.ConfigMap != \"\" {\n        configMapName := configDeployment.Spec.ConfigMap\n        foundConfigMap := &amp;corev1.ConfigMap{}\n        err := r.Get(ctx, types.NamespacedName{Name: configMapName, Namespace: configDeployment.Namespace}, foundConfigMap)\n        if err != nil {\n            // If a configMap name is provided, then it must exist\n            // You will likely want to create an Event for the user to understand why their reconcile is failing.\n            return ctrl.Result{}, err\n        }\n\n        // Hash the data in some way, or just use the version of the Object\n        configMapVersion = foundConfigMap.ResourceVersion\n    }\n\n    // Logic here to add the configMapVersion as an annotation on your Deployment Pods.\n\n    return ctrl.Result{}, nil\n}\n\nfunc (r *ConfigDeploymentReconciler) SetupWithManager(mgr ctrl.Manager) error {\n    // The configMap field must be indexed by the manager, so that we will be able to lookup ConfigDeployments by a referenced ConfigMap name.\n    if err := mgr.GetFieldIndexer().IndexField(context.Background(), &amp;appsv1.ConfigDeployment{}, configMapField, func(rawObj client.Object) []string {\n        // Extract the ConfigMap name from the ConfigDeployment Spec, if one is provided\n        configDeployment := rawObj.(*appsv1.ConfigDeployment)\n        if configDeployment.Spec.ConfigMap == \"\" {\n            return nil\n        }\n        return []string{configDeployment.Spec.ConfigMap}\n    }); err != nil {\n        return err\n    }\n\n    return ctrl.NewControllerManagedBy(mgr).\n        For(&amp;appsv1.ConfigDeployment{}).\n        Owns(&amp;kapps.Deployment{}).\n        Watches(\n            &amp;source.Kind{Type: &amp;corev1.ConfigMap{}},\n            handler.EnqueueRequestsFromMapFunc(r.findObjectsForConfigMap),\n            // the watch to be triggered when the ResourceVersion of the ConfigMap is changed.\n            builder.WithPredicates(predicate.ResourceVersionChangedPredicate{}),\n        ).\n        Complete(r)\n}\n\nfunc (r *ConfigDeploymentReconciler) findObjectsForConfigMap(configMap client.Object) []reconcile.Request {\n    attachedConfigDeployments := &amp;appsv1.ConfigDeploymentList{}\n    listOps := &amp;client.ListOptions{\n        FieldSelector: fields.OneTermEqualSelector(configMapField, configMap.GetName()),\n        Namespace:     configMap.GetNamespace(),\n    }\n    err := r.List(context.TODO(), attachedConfigDeployments, listOps)\n    if err != nil {\n        return []reconcile.Request{}\n    }\n\n    requests := make([]reconcile.Request, len(attachedConfigDeployments.Items))\n    for i, item := range attachedConfigDeployments.Items {\n        requests[i] = reconcile.Request{\n            NamespacedName: types.NamespacedName{\n                Name:      item.GetName(),\n                Namespace: item.GetNamespace(),\n            },\n        }\n    }\n    return requests\n}\n</code></pre>"},{"location":"cloud/k8s/crd_kubebuilder.html#eventhandler-reconciler","title":"\u76d1\u542c\u591a\u8d44\u6e90\u4e0beventHandler \u548c Reconciler \u7684\u903b\u8f91","text":"<p>controller Reconciler \u4e1a\u52a1\u903b\u8f91\uff0c\u5b9e\u9645\u4e0a\u53ea\u5e94\u8be5\u5904\u7406 CR \u7684\u53d8\u5316\uff0c\u4f46\u6709\u65f6\u662f CR \u6240\u62e5\u6709\u7684 Deployment \u53d1\u751f\u4e86\u53d8\u5316\uff0c\u4f46\u5bf9\u5e94\u7684 CR \u5e76\u4e0d\u4f1a\u6709\u66f4\u65b0\u4e8b\u4ef6\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u5728\u81ea\u5b9a\u4e49<code>eventHandler</code>\u4e2d\uff0c\u5bf9\u8d44\u6e90\u8fdb\u884c\u5224\u65ad\u3002</p> <ul> <li>\u82e5\u662f CR \u7684\u53d8\u5316\uff0c\u5219\u76f4\u63a5\u5411\u961f\u5217\u5199\u5165 namespace \u548c name\uff1b</li> <li>\u82e5\u662f deployment \u7684\u53d8\u5316\uff0c\u5219\u5411\u961f\u5217\u5199\u5165 deployment \u5bf9\u5e94 CR \u7684namespace \u548cname\uff0c\u4ee5\u89e6\u53d1 Reconciler \u7684\u903b\u8f91\u3002</li> </ul> <pre><code>func (e *EnqueueRequestForDP) Create(evt event.CreateEvent, q workqueue.RateLimitingInterface) {\n    if evt.Meta == nil {\n        enqueueLog.Error(nil, \"CreateEvent received with no metadata\", \"event\", evt)\n        return\n    }\n    _, ok := evt.Object.(*samplev1.Sample)\n    if ok {\n        q.Add(reconcile.Request{NamespacedName: types.NamespacedName{\n                Name:      evt.Meta.Name,\n                Namespace: evt.Meta.GetNamespace(),\n            }})\n        return\n    }\n    deploy ,_:= evt.Object.(*v1.Deployment)\n    for _, owner := range deploy.OwnerReferences {\n        if owner.Kind == \"Sample\" {\n            q.Add(reconcile.Request{NamespacedName: types.NamespacedName{\n                Name:      owner.Name,\n                Namespace: evt.Meta.GetNamespace(),\n            }})\n        }\n    }\n}\n</code></pre>"},{"location":"cloud/k8s/crd_kubebuilder.html#_13","title":"\u5e76\u53d1","text":"<p><code>MaxConcurrentReconciles</code>\u5b57\u6bb5\u914d\u7f6e\uff1a</p> <pre><code>options := controller.Options{\n    MaxConcurrentReconciles: maxConcurrentReconciles,\n}\nctrl.NewControllerManagedBy(mgr).\n        WithOptions(options).\n        For(&amp;datav1alpha1.AlluxioRuntime{}).\n        Complete(r)\n</code></pre>"},{"location":"cloud/k8s/crd_kubebuilder.html#_14","title":"\u76d1\u542c\u6307\u5b9a\u5b57\u6bb5\u53d8\u5316","text":""},{"location":"cloud/k8s/crd_kubebuilder.html#witheventfilter","title":"WithEventFilter","text":"<p>\u5728\u63a7\u5236\u5668watch pod\u8d44\u6e90\u53d8\u66f4\u65f6\uff0c\u68c0\u67e5pod\u662f\u5426\u53d8\u66f4\u4e86label\uff0c\u5982\u679clabel\u6ca1\u6709\u53d8\u66f4\uff0c\u5c31\u4e0d\u53bb\u6267\u884creconcile\u3002</p> <p>\u5b9a\u4e49 predicate \u5373\u53ef\u5b9e\u73b0\u3002 \u6bd4\u5982\u6211\u4eec\u53ea\u5bf9 CR \u6539\u53d8 label \u7684\u4e8b\u4ef6\u611f\u5174\u8da3\uff0c\u6211\u4eec\u6b64\u65f6\u53ef\u4ee5\u81ea\u5b9a\u4e49 Predicate \u4ee5\u53ca\u5176 Update() \u65b9\u6cd5\u3002</p> <p>1\uff09\u901a\u8fc7Builder\u6a21\u5f0f</p> <pre><code>import (\n    \"sigs.k8s.io/controller-runtime/pkg/predicate\"\n    \"sigs.k8s.io/controller-runtime/pkg/event\"\n)\n\ntype ResourceLabelChangedPredicate struct {\n    predicate.Funcs\n}\n\nfunc (rl *ResourceLabelChangedPredicate) Update (e event.UpdateEvent) bool{\n    _, ok1 = e.ObjectOld.(*samplev1.Sample)\n    _, ok2 = e.ObjectNew.(*samplev1.Sample)\n    if ok1 &amp;&amp; ok2 {\n        if !compareMaps(e.ObjectOld.GetLabels(), e.ObjectNew.GetLabels()) {\n            return true\n        }\n    }\n    return false\n}\n\n// \u4fee\u6539\u6ce8\u518c\u63a7\u5236\u5668\u7684\u65b9\u5f0f\uff0cServiceReconciler\u5728\u76d1\u542c\u5176\u5173\u6ce8\u7684\u5bf9\u8c61\u65f6\uff0c\u53ea\u4f1a\u5173\u6ce8\u5bf9\u8c61\u7684label\u662f\u5426\u53d1\u751f\u53d8\u66f4\uff0c\u53ea\u6709\u5f53label\u53d1\u751f\u53d8\u66f4\u65f6\uff0c\u624d\u4f1a\u5165\u961f\u5e76\u8fdb\u5165reconcile\u903b\u8f91\nfunc (r *ServiceReconciler) SetupWithManager(mgr ctrl.Manager) error {\n    return ctrl.NewControllerManagedBy(mgr).\n        For(&amp;opsv1.Service{}).\n        Watches(&amp;source.Kind{Type: &amp;opsv1.Pod{}}, &amp;handler.EnqueueRequestForObject{}).\n        WithEventFilter(&amp;ResourceLabelChangedPredicate{}).\n        Complete(r)\n}\n</code></pre> <p>\u6ce8\u610f\uff0c\u5f53\u6211\u4eec\u76d1\u542c\u591a\u4e2a\u8d44\u6e90\u540e\uff0c deployment \u7684\u66f4\u65b0\u4e8b\u4ef6\u4e5f\u4f1a\u8fdb\u5165\u5230\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u6240\u4ee5\u5728\u65b9\u6cd5\u4e2d\uff0c\u9700\u8981\u901a\u8fc7 <code>_, ok = e.Object(*xxx)</code> \u5224\u65ad\u8d44\u6e90\u7684\u7c7b\u578b\u3002</p> <p>2\uff09\u76f4\u63a5\u5b9e\u4f8b\u5316</p> <pre><code>func (r *FluidAppReconciler) SetupWithManager(mgr ctrl.Manager, options controller.Options) error {\n    options.Reconciler = r\n    c, err := controller.New(r.ControllerName(), mgr, options)\n    if err != nil {\n        return err\n    }\n\n    podEventHandler := &amp;podEventHandler{}\n    // \u5efa\u7acbcontroller\uff0c\u8bbe\u7f6e watch\n    err = c.Watch(&amp;source.Kind{Type: r.ManagedResource()}, &amp;handler.EnqueueRequestForObject{}, predicate.Funcs{\n        CreateFunc: podEventHandler.onCreateFunc(r),\n        UpdateFunc: podEventHandler.onUpdateFunc(r),\n        DeleteFunc: podEventHandler.onDeleteFunc(r),\n    })\n    if err != nil {\n        log.Error(err, \"Failed to watch Pod\")\n        return err\n    }\n    return\n}\n</code></pre>"},{"location":"cloud/k8s/crd_kubebuilder.html#eventhandler","title":"EventHandler","text":"<p><code>Watch</code>\u65b9\u6cd5\u81ea\u5b9a\u4e49<code>handler.EventHandler</code>\u63a5\u53e3\uff0c\u5b9e\u73b0<code>Create</code>,<code>Update</code>,<code>Delete</code>,<code>Generic</code>\u65b9\u6cd5\uff0c\u7528\u6765\u5728\u8d44\u6e90\u5b9e\u4f8b\u7684\u4e0d\u540c\u751f\u547d\u9636\u6bb5\uff0c\u8fdb\u884c\u5224\u65ad\u4e0e\u5165\u961f\u3002</p> <p>1\uff09\u901a\u8fc7Builder\u6a21\u5f0f\uff1a</p> <pre><code>func (e *EnqueueRequestForLabelChanged) Update(evt event.UpdateEvent, q workqueue.RateLimitingInterface) {\n    if !compareMaps(evt.ObjectOld.GetLabels(), evt.ObjectNew.GetLabels()) {\n        q.Add(reconcile.Request{NamespacedName: types.NamespacedName{\n            Name: evt.MetaNew.GetName(),\n            Namespace: evt.MetaNew.GetNamespace(),\n        }})\n    }\n}\n\n// +kubebuilder:rbac:groups=\"\",resources=pods,verbs=get;list;watch;create;update;patch;delete\n\nfunc (r *PlaybookReconciler) SetupWithManager(mgr ctrl.Manager) error {\n    return ctrl.NewControllerManagedBy(mgr).\n        For(&amp;opsv1.Playbook{}).Watches(&amp;source.Kind{Type: &amp;opsv1.Bucket{}}, &amp;EnqueueRequestForLabelChanged{}).\n        Complete(r)\n}\n</code></pre> <p>2\uff09</p>"},{"location":"cloud/k8s/crd_kubebuilder.html#kubebuilder_1","title":"kubebuilder \u6ce8\u89e3","text":"<p>\u6211\u4eec\u5728\u751f\u6210\u7684 CR \u7ed3\u6784\u4f53\u4ee3\u7801\u4e2d\u4f1a\u53d1\u73b0\u7531\u5f88\u591a kubebuilder \u81ea\u5b9a\u4e49\u7684\u6ce8\u89e3\uff0c\u4f8b\u5982<code>// +kubebuilder:object:root=true</code> \u7b49\uff0c\u5176\u5b9e\u8fd9\u4e9b\u5728\u7f16\u8bd1\u65f6\u4f1a\u589e\u52a0\u5bf9\u5e94\u7684\u529f\u80fd</p> <p>https://book.kubebuilder.io/reference/markers.html</p>"},{"location":"cloud/k8s/crd_kubebuilder.html#_15","title":"\u793a\u4f8b","text":"<p><code>XXX_types.go</code></p> <pre><code>//+kubebuilder:object:root=true\n//+kubebuilder:subresource:status\n//+kubebuilder:subresource:scale:specpath=.spec.replicas,statuspath=.status.replicas,selectorpath=.status.selector\n//+kubebuilder:resource:categories=&lt;string&gt;,path=&lt;string&gt;,scope=&lt;string&gt;,shortName=&lt;string&gt;,singular=&lt;string&gt;\n//+kubebuilder:printcolumn:JSONPath=&lt;string&gt;,description=&lt;string&gt;,format=&lt;string&gt;,name=&lt;string&gt;,priority=&lt;int&gt;,type=&lt;string&gt;\ntype AlluxioRuntime struct {\n    metav1.TypeMeta   `json:\",inline\"`\n    metav1.ObjectMeta `json:\"metadata,omitempty\"`\n\n    Spec   AlluxioRuntimeSpec `json:\"spec,omitempty\"`\n    Status RuntimeStatus      `json:\"status,omitempty\"`\n}\ntype AlluxioRuntimeSpec struct {\n    // +kubebuilder:validation:Minimum=1\n    // +optional\n    Replicas int32 `json:\"replicas,omitempty\"`\n}\n</code></pre> <p><code>groupversion_info.go</code></p> <pre><code>//+kubebuilder:object:generate=true\n//+groupName=batch.test.kubebuild.xliu\npackage v1\n\nimport (\n    \"k8s.io/apimachinery/pkg/runtime/schema\"\n    \"sigs.k8s.io/controller-runtime/pkg/scheme\"\n)\n\nvar (\n    // GroupVersion is group version used to register these objects\n    GroupVersion = schema.GroupVersion{Group: \"batch.test.kubebuild.xliu\", Version: \"v1\"}\n\n    // SchemeBuilder is used to add go types to the GroupVersionKind scheme\n    SchemeBuilder = &amp;scheme.Builder{GroupVersion: GroupVersion}\n\n    // AddToScheme adds the types in this group-version to the given scheme.\n    AddToScheme = SchemeBuilder.AddToScheme\n)\n</code></pre>"},{"location":"cloud/k8s/crd_kubebuilder.html#_16","title":"\u751f\u6210","text":"<p>kubebuilder:object:root=true\uff1a\u542f\u7528\u6b64\u7c7b\u578b\u7684\u5bf9\u8c61\u63a5\u53e3\u5b9e\u73b0\u751f\u6210</p> <p>kubebuilder:object:generate=true\uff1a\u542f\u7528\u6b64\u5305\u7684\u5bf9\u8c61\u63a5\u53e3\u6216\u8005\u7279\u5b9a\u7ed3\u6784\u4f53\u548c deepcopy \u5b9e\u73b0\u751f\u6210</p>"},{"location":"cloud/k8s/crd_kubebuilder.html#_17","title":"kubebuilder","text":"<p>kubebuilder:printcolumn\uff1a<code>kubectl get</code>\u65f6\u7684\u663e\u793a\u4fe1\u606f</p> <ul> <li>JSONPath\uff1a\u5b57\u6bb5\u7684json\u7684\u8def\u5f84\uff0c\u5982<code>.spec.info</code>\uff1b</li> </ul> <p>kubebuilder:subresource:status\uff1a\u8bbe\u7f6eStatus\u4e3aSpec\u7684\u5b50\u8d44\u6e90\uff0c\u7531\u63a7\u5236\u5668\u8fdb\u884c\u53d8\u66f4\uff08Status().Update()\uff09\uff1b</p> <ul> <li>\u5f00\u542fstatus\u540e\uff0c\u5916\u90e8\u4fee\u6539\u7684status\u5c06\u4e0d\u4f1a\u88ab\u6355\u83b7\uff0c\u53ea\u80fd\u901a\u8fc7\u63a7\u5236\u5668\u4f7f\u7528<code>status().update()</code>\u6765\u4fee\u6539</li> </ul> <p>kubebuilder:subresource:scale\uff1aCRD \u4e0a\u542f\u7528\u201c/scale\u201d\u5b50\u8d44\u6e90\uff0c\u4f7f\u7528<code>kubectl scale</code>\u547d\u4ee4\u7684\u5f62\u5f0f\u6765\u65b9\u4fbf\u5730\u4fee\u6539CRD\u7684replicas\u503c</p> <ul> <li> <p><code>specpath</code>\uff1a\u5fc5\u9009\uff0c CRD\u5bf9\u8c61\u4e2d\u5bf9\u5e94\u5b57\u6bb5\u7684jsonpath\uff0c\u793a\u4f8b\u4e3a<code>.spec.replicas</code>\uff1b</p> </li> <li> <p>selectorpath\uff1a \u53ef\u9009\uff0c\u793a\u4f8b\u503c\u4e3a<code>.status.selector</code>\uff08\uff1f\uff1f\uff09\uff1b</p> </li> <li> <p><code>statuspath</code>\uff1a\u53ef\u9009\uff0c\u8868\u793a\u5f53\u524d\u7684\u526f\u672c\u6570\uff0cCRD\u5bf9\u8c61\u4e2d\u5bf9\u5e94\u5b57\u6bb5\u7684jsonpath\uff0c\u793a\u4f8b\u4e3a<code>.status.replicas</code>\uff1b</p> </li> </ul> <p>kubebuilder:resource\uff1a\u81ea\u5b9a\u4e49\u8d44\u6e90\u7684\u4fe1\u606f</p> <ul> <li>categories\uff1a\u8d44\u6e90\u7ec4\u7684\u522b\u540d\uff08\uff1f\uff1f\uff09\uff1b</li> <li>shortName \uff1a\u8d44\u6e90\u522b\u540d\uff0c\u53ef\u4ee5\u901a\u8fc7<code>kubectl get {shortName}</code>\u83b7\u53d6\uff1b</li> <li><code>scope</code>\uff1a<code>Cluster</code>\u975e\u547d\u540d\u7a7a\u95f4\u8d44\u6e90\uff08\u4e8enode\u7c7b\u4f3c\uff0c\u4e0d\u9700\u8981\u6307\u5b9a\u547d\u540d\u7a7a\u95f4\uff09\uff0c\u4e0d\u52a0\u6216<code>Namespaced</code>\u5219\u4e3a\u547d\u540d\u7a7a\u95f4\u8d44\u6e90\uff1b</li> <li></li> </ul>"},{"location":"cloud/k8s/crd_kubebuilder.html#_18","title":"\u6821\u9a8c","text":"<p>+optional\uff1a\u5b57\u6bb5\u53ef\u9009\uff0c\u4e0d\u52a0\u8be5\u6ce8\u91ca\uff0c\u5b57\u6bb5\u9ed8\u8ba4\u5fc5\u9009\uff1b</p> <p>kubebuilder:validation\uff1a\u5b57\u6bb5\u6821\u9a8c\u89c4\u5219</p>"},{"location":"cloud/k8s/crd_kubebuilder.html#webhook","title":"WebHook","text":"<p>\u793a\u4f8b</p> <pre><code>// +kubebuilder:webhook:path=/mutate-fluid-io-v1alpha1-schedulepod,mutating=true,failurePolicy=fail,sideEffects=None,admissionReviewVersions=v1;v1beta1,groups=\"\",resources=pods,verbs=create;update,versions=v1,name=schedulepod.fluid.io\n</code></pre> <p>kubebuilder:webhook:</p> <ul> <li><code>path</code>\uff1a\u6307\u5b9a API \u670d\u52a1\u5668\u5e94\u8fde\u63a5\u5230\u6b64 webhook \u7684\u8def\u5f84\u3002\u5fc5\u987b\u4ee5\u201c/validate-\u201d\u6216\u201c/mutate-\u201d\u4f5c\u4e3a\u524d\u7f00</li> <li><code>mutating</code>\uff1a<code>true</code>\u8868\u793a\u542f\u52a8mutating webhook</li> <li><code>failurePolicy</code>\uff1aAPI \u670d\u52a1\u5668\u65e0\u6cd5\u8bbf\u95ee webhook \u65f6\u7684\u7b56\u7565\uff0c\u201cignore\u201d\uff08\u8df3\u8fc7 webhook \u5e76\u7ee7\u7eed\uff09\u6216\u201cfail\u201d\uff08\u62d2\u7edd\u6709\u95ee\u9898\u7684\u5bf9\u8c61\uff09\uff1b</li> <li><code>sideEffects</code>\uff1a\u503c\u4e3a\u201cNone\u201d\uff0c\u5219 Webhook \u6ca1\u6709\u98ce\u9669\uff1b\u503c\u4e3a\u201cNoneOnDryRun\u201d\uff0c\u5219 webhook \u8d1f\u8d23\u68c0\u67e5\u8bf7\u6c42\u4e2d\u53d1\u9001\u7684 AdmissionReview \u7684\u201cdryRun\u201d\u5c5e\u6027\uff0c\u5e76\u5728\u8be5\u503c\u4e3a\u201ctrue\u201d\u65f6\u907f\u514d\u526f\u4f5c\u7528\u3002</li> <li><code>admissionReviewVersions</code>\uff1a\u9996\u9009 <code>AdmissionReview</code> \u7248\u672c\u7684\u6709\u5e8f\u5217\u8868\uff0c\u751f\u6210 v1 {Mutating,Validating}WebhookConfiguration\uff0c\u8fd9\u662f\u5f3a\u5236\u6027\u7684\u3002\u7528\u4e8e\u751f\u6210 v1beta1 {Mutating,Validating}WebhookConfiguration\uff0c\u8fd9\u662f\u53ef\u9009\u7684\uff1b</li> <li><code>groups</code>\uff1a\u6307\u5b9a\u6b64 Webhook \u63a5\u6536\u8bf7\u6c42\u7684 API \u7ec4\u3002</li> <li><code>resources=:&lt;[]string&gt;</code>\uff1a\u76d1\u63a7\u7684api\u8d44\u6e90</li> <li><code>verbs</code>\uff1a\u63a5\u6536\u8bf7\u6c42\u7684 Kubernetes API \u52a8\u4f5c</li> <li><code>version</code>\uff1a\u63a5\u6536\u8bf7\u6c42\u7684 API \u7248\u672c</li> <li><code>name</code>\uff1a\u6b64 webhook \u914d\u7f6e\u7684\u540d\u79f0</li> </ul> <p>\u751f\u6210\u7684Yaml\u5982\u4e0b\u6240\u793a</p> <pre><code>apiVersion: admissionregistration.k8s.io/v1\nkind: MutatingWebhookConfiguration\nmetadata:\n  name: fluid-pod-admission-webhook\nwebhooks:\n  - name: schedulepod.fluid.io\n    rules:\n      - apiGroups:   [\"\"]\n        apiVersions: [\"v1\"]\n        operations:  [\"CREATE\",\"UPDATE\"]\n        resources:   [\"pods\"]\n    clientConfig:\n      service:\n        namespace: fluid-system\n        name: fluid-pod-admission-webhook\n        path: \"/mutate-fluid-io-v1alpha1-schedulepod\"\n        port: 9443\n      caBundle: Cg==\n    timeoutSeconds: 20\n    failurePolicy: Fail\n    sideEffects: None\n    admissionReviewVersions: [\"v1\",\"v1beta1\"]\n    namespaceSelector:\n      matchLabels:\n        fluid.io/enable-injection: \"true\"\n</code></pre>"},{"location":"cloud/k8s/crd_kubebuilder.html#rbac","title":"RBAC","text":"<p>\u5b9a\u4e49\u5728<code>XXX_controller.go</code>\u4e2d\uff0c\u6839\u636e\u914d\u7f6e\u751f\u6210<code>role.yaml</code>\u4ee5\u53ca<code>rolebinding.yaml</code>\u6587\u4ef6\uff0c\u5e76\u751f\u6210sa.yaml\u3002</p> <pre><code>//+kubebuilder:rbac:groups=&lt;[]string&gt;,namespace=&lt;string&gt;,resourceNames=&lt;[]string&gt;,resourcess=&lt;[]tring&gt;,urls=&lt;[]string&gt;,verbs=&lt;[]string&gt;\n\n//+kubebuilder:rbac:groups=batch.test.kubebuild.xliu,resources=cronjobs,verbs=get;list;watch;create;update;patch;delete\n//+kubebuilder:rbac:groups=batch.test.kubebuild.xliu,resources=cronjobs/status,verbs=get;update;patch\n//+kubebuilder:rbac:groups=batch.test.kubebuild.xliu,resources=cronjobs/finalizers,verbs=update\n//+kubebuilder:rbac:groups=batch,resources=jobs,verbs=get;list;watch;create;update;patch;delete\n//+kubebuilder:rbac:groups=batch,resources=jobs/status,verbs=get\n</code></pre> <ul> <li><code>groups:=&lt;[]string&gt;</code>\uff1a\u6307\u5b9aapi \u7ec4 \u6bd4\u5982 deployment \u5c5e\u4e8eapps\u7ec4</li> <li><code>namespace:=</code>\uff1a\u6307\u5b9a\u4f5c\u7528\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u5982\u679c\u672a\u6307\u5b9a\u5219\u662fCluster\uff0c\u8fd9\u5f71\u54cd\u751f\u6210\u7684\u662frole\u8fd8\u662fClusterRole</li> <li><code>resourceNames:=&lt;[]string&gt;</code>\uff1a\u6307\u5b9a\u6b64\u89c4\u5219\u5305\u542b\u7684 API \u8d44\u6e90\u7684\u540d\u79f0\u3002</li> <li><code>resources:=&lt;[]string&gt;</code>\uff1a\u6307\u5b9a\u6b64\u89c4\u5219\u5305\u542b\u7684 API \u8d44\u6e90 \u6bd4\u5982deployments\u8d44\u6e90</li> <li><code>urls:=&lt;[]string&gt;</code>\uff1a\u914d\u7f6e\u8bbf\u95ee\u975e\u8d44\u6e90\u7684URL</li> <li><code>verbs:=&lt;[]string&gt;\uff1a</code>\u5bf9\u8d44\u6e90\u7684\u64cd\u4f5c\uff0c\u6bd4\u5982<code>get;list;watch;create;update;patch</code>\uff1b</li> </ul>"},{"location":"cloud/k8s/crd_kubebuilder.html#metrics","title":"Metrics","text":"<p>By default, controller-runtime builds a global prometheus registry and publishes a collection of performance metrics for each controller.</p> <p>export the metrics using the Prometheus Operator</p> <ul> <li>Uncomment the line <code>- ../prometheus</code> in the <code>config/default/kustomization.yaml</code>\uff1b</li> <li>create the <code>ServiceMonitor</code> to export the metrics\uff1b</li> </ul>"},{"location":"cloud/k8s/crd_kubebuilder.html#api_1","title":"\u591a\u7248\u672cAPI","text":"<p>TODO</p>"},{"location":"cloud/k8s/deploy.html","title":"\u5b89\u88c5\u90e8\u7f72","text":"<ul> <li>Kubernetes\u539f\u751f\u7684\u53ef\u6269\u5c55\u6027\u53d7\u5236\u4e8e<code>list/watch</code>\u7684\u957f\u8fde\u63a5\u6d88\u8017\uff0c\u751f\u4ea7\u73af\u5883\u80fd\u591f\u7a33\u5b9a\u652f\u6301\u7684\u8282\u70b9\u89c4\u6a21\u662f1000\u5de6\u53f3\u3002</li> <li>\u76ee\u524d\u4e3a\u6b62\uff0c\u5728\u5bb9\u5668\u91cc\u8fd0\u884c<code>kubelet</code>\u4f9d\u7136\u6ca1\u6709\u975e\u5e38\u7a33\u59a5\u7684\u89e3\u51b3\u529e\u6cd5\uff08\u56e0\u4e3a<code>kubelet</code>\u9700\u8981\u8bbe\u7f6e\u5bb9\u5668\u7684namespace\uff09\uff0c\u4e0d\u5efa\u8bae\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u76f4\u63a5\u4f7f\u7528\uff08\u6d4b\u8bd5\u73af\u5883\u53ef\u4ee5\u4f7f\u7528KIND\uff09\u3002</li> </ul>"},{"location":"cloud/k8s/deploy.html#_2","title":"\u9ad8\u53ef\u7528\u67b6\u6784","text":"<p>API Server\u6765\u8bf4\uff0c\u5176\u9ad8\u53ef\u7528\u6027\u662f\u901a\u8fc7\u591a\u5b9e\u4f8b\u90e8\u7f72\u3001\u8d1f\u8f7d\u5747\u8861\u3001etcd\u96c6\u7fa4\u3001\u5065\u5eb7\u68c0\u67e5\u548c\u76d1\u63a7\u7b49\u591a\u79cd\u673a\u5236\u5171\u540c\u5b9e\u73b0\u7684\uff0c\u800c\u4e0d\u662f\u901a\u8fc7leader election\u6765\u51b3\u5b9a\u54ea\u4e2a\u5b9e\u4f8b\u53ef\u4ee5\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u3002</p> <p>leader election\u673a\u5236\u66f4\u9002\u7528\u4e8e\u9700\u8981\u786e\u4fdd\u540c\u4e00\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u5b9e\u4f8b\u6267\u884c\u7279\u5b9a\u4efb\u52a1\u7684\u573a\u666f\uff0c\u5982kube-scheduler\u548ckube-controller-manager\u3002</p>"},{"location":"cloud/k8s/deploy.html#stackedetcd","title":"\u5806\u53e0\uff08Stacked\uff09etcd \u62d3\u6251","text":""},{"location":"cloud/k8s/deploy.html#etcd","title":"\u5916\u90e8 etcd \u62d3\u6251","text":""},{"location":"cloud/k8s/deploy.html#kubeadmin","title":"\u57fa\u4e8e kubeadmin \u90e8\u7f72","text":"<p>\u53c2\u770b\u5b98\u65b9\u6587\u6863\uff1a\u4f7f\u7528 kubeadm \u5f15\u5bfc\u96c6\u7fa4 | Kubernetes</p>"},{"location":"cloud/k8s/deploy.html#_3","title":"\u7cfb\u7edf\u914d\u7f6e\uff08\u6240\u6709\u8282\u70b9\uff09","text":""},{"location":"cloud/k8s/deploy.html#_4","title":"\u65f6\u949f\u540c\u6b65","text":"<pre><code>$ yum install chrony -y\n$ systemctl start chronyd\n$ systemctl enable chronyd\n# \u68c0\u67e5\u65f6\u95f4\u6765\u6e90\n$ chronyc sources   \n</code></pre>"},{"location":"cloud/k8s/deploy.html#selinux","title":"\u5173\u95edselinux","text":"<pre><code># 1.\u4e34\u65f6\u5173\u95ed\nsetenforce 0 \n# 2.\u6c38\u4e45\u5173\u95ed\uff0c\u518d\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\nsed -i \"s/SELINUX=enforcing/SELINUX=disabled/g\" /etc/selinux/config\n</code></pre>"},{"location":"cloud/k8s/deploy.html#swap","title":"\u5173\u95edswap\u5206\u533a","text":"<pre><code># 1.\u4e34\u65f6\u5173\u95ed \nswapoff -a \n# 2.\u6c38\u4e45\u5173\u95ed\uff0c\u518d\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u6ce8\u91ca\u6389swap\u7684\u6302\u8f7d\nsed -i 's/.*swap/#&amp;/' /etc/fstab \n</code></pre>"},{"location":"cloud/k8s/deploy.html#_5","title":"\u5173\u95ed\u9632\u706b\u5899","text":"<pre><code>#\u5173\u95ed\u9632\u706b\u5899 \nsystemctl stop firewalld \n#\u8bbe\u7f6e\u4e0d\u81ea\u542f \nsystemctl disable firewalld \n</code></pre>"},{"location":"cloud/k8s/deploy.html#_6","title":"\u7f51\u7edc\u914d\u7f6e","text":"<p>br_netfiler\u4f5c\u7528\uff1abr_netfilter\u6a21\u5757\u53ef\u4ee5\u4f7f iptables \u89c4\u5219\u53ef\u4ee5\u5728 Linux Bridges \u4e0a\u9762\u5de5\u4f5c\uff0c\u7528\u4e8e\u5c06\u6865\u63a5\u7684\u6d41\u91cf\u8f6c\u53d1\u81f3iptables\u94fe\u3002</p> <ul> <li>\u5982\u679c\u6ca1\u52a0\u8f7d\uff0c\u5f71\u54cd\u540cnode\u5185\u7684pod\u4e4b\u95f4\u901a\u8fc7service\u6765\u901a\u4fe1\uff0c\u5177\u4f53\u539f\u56e0\u53ef\u89c1k8s_network</li> </ul> <pre><code># \u52a0\u8f7dbr_netfilter\u6a21\u5757\uff0c\u53ef\u901a\u8fc7lsmod | grep br_netfilter\u68c0\u67e5\u662f\u5426\u52a0\u8f7d\nmodprobe br_netfilter\n\n# \u7ed1\u5b9a\u975e\u672c\u673a IP \uff08ip_nonlocal_bind\uff09\n# \u5c06Linux\u7cfb\u7edf\u4f5c\u4e3a\u8def\u7531\u6216\u8005VPN\u670d\u52a1\u5c31\u5fc5\u987b\u8981\u5f00\u542fIP\u8f6c\u53d1\u529f\u80fd\uff08ip_forward\uff09\n# ip_foward=1 \u5c06\u4e00\u4e2a\u63a5\u53e3\u7684\u6d41\u91cf\u8f6c\u53d1\u5230\u53e6\u5916\u4e00\u4e2a\u63a5\u53e3\uff0c\u8be5\u914d\u7f6e\u662f Linux \u5185\u6838\u5c06\u6d41\u91cf\u4ece\u5bb9\u5668\u8def\u7531\u5230\u5916\u90e8\u6240\u5fc5\u987b\nvim /etc/sysctl.d/kubernetes.conf\n  net.bridge.bridge-nf-call-ip6tables = 1\n  net.bridge.bridge-nf-call-iptables = 1  \n  net.ipv4.ip_nonlocal_bind = 1\n  net.ipv4.ip_forward = 1\n  vm.swappiness = 0  \n\nsysctl -p /etc/sysctl.d/kubernetes.conf  \n</code></pre>"},{"location":"cloud/k8s/deploy.html#ipvs","title":"\u52a0\u8f7dipvs\u6a21\u5757","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0ckube-proxy\u5c06\u5728kubeadm\u90e8\u7f72\u7684\u96c6\u7fa4\u4e2d\u4ee5<code>iptables</code>\u6a21\u5f0f\u8fd0\u884c\uff1b(\u9700\u786e\u8ba4\uff09</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5f53\u5185\u6838\u7248\u672c\u5927\u4e8e4.19\uff08centos 7\u5185\u6838\u7248\u672c\u4e3a3.10\uff09\u65f6\uff0c\u79fb\u9664\u4e86<code>nf_conntrack_ipv4</code>\u6a21\u5757\uff0ckubernetes\u5b98\u65b9\u5efa\u8bae\u4f7f\u7528<code>nf_conntrack</code>\u4ee3\u66ff\uff0c\u5426\u5219\u62a5\u9519\u65e0\u6cd5\u627e\u5230<code>nf_conntrack_ipv4</code>\u6a21\u5757</p> <pre><code>yum install -y ipset ipvsadm \n# nf_conntrack_ipv4 \ncat &gt; /etc/sysconfig/modules/ipvs.modules &lt;&lt;EOF\n #!/bin/bash modprobe -- ip_vs\n modprobe -- ip_vs_rr\n modprobe -- ip_vs_wrr\n modprobe -- ip_vs_sh\n modprobe -- nf_conntrack \n EOF  \nchmod +x /etc/sysconfig/modules/ipvs.modules &amp;&amp; bash /etc/sysconfig/modules/ipvs.modules \n</code></pre>"},{"location":"cloud/k8s/deploy.html#_7","title":"\u5176\u5b83\u914d\u7f6e","text":"<p>\u6240\u6709\u7528\u6237\u7684\u6253\u5f00\u6587\u4ef6\u6570</p> <pre><code>echo \"* soft nofile 65536\" &gt;&gt; /etc/security/limits.conf \necho \"* hard nofile 65536\" &gt;&gt; /etc/security/limits.conf \n</code></pre>"},{"location":"cloud/k8s/deploy.html#_8","title":"\u5b89\u88c5\u5bb9\u5668\u8fd0\u884c\u65f6\uff08\u6240\u6709\u8282\u70b9)","text":""},{"location":"cloud/k8s/deploy.html#docker-engine","title":"Docker Engine","text":"<p>Docker Engine \u6ca1\u6709\u5b9e\u73b0 CRI\uff0c \u800c\u8fd9\u662f\u5bb9\u5668\u8fd0\u884c\u65f6\u5728 Kubernetes \u4e2d\u5de5\u4f5c\u6240\u9700\u8981\u7684\u3002 \u4e3a\u6b64\uff0c\u5fc5\u987b\u5b89\u88c5\u4e00\u4e2a\u989d\u5916\u7684\u670d\u52a1 cri-dockerd\u3002 cri-dockerd \u662f\u4e00\u4e2a\u57fa\u4e8e\u4f20\u7edf\u7684\u5185\u7f6e Docker \u5f15\u64ce\u652f\u6301\u7684\u9879\u76ee\uff0c \u5b83\u5728 1.24 \u7248\u672c\u4ece kubelet \u4e2d\u79fb\u9664\u3002</p> <p>1\uff09\u914d\u7f6eyum\u6e90</p> <pre><code>$ cd /etc/yum.repos.d/ \n$ curl -O http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo \n</code></pre> <p>2\uff09\u5b89\u88c5docker</p> <pre><code>yum -y install docker-ce \n</code></pre> <p>3\uff09\u914d\u7f6edocker</p> <pre><code>mkdir /etc/docker \n# \u4fee\u6539`docker Cgroup Driver`\u4e3a`systemd`,`overlay2`\u9ed8\u8ba4\u5b58\u50a8\u9a71\u52a8\uff1b\nvim /etc/docker/daemon.json\n {   \"exec-opts\": [\"native.cgroupdriver=systemd\"],\n     \"log-driver\": \"json-file\", \n     \"log-opts\": { \n       \"max-size\": \"100m\"\n     },\n    \"storage-driver\": \"overlay2\",\n    \"storage-opts\": [ \n      \"overlay2.override_kernel_check=true\"\n    ],\n     \"registry-mirrors\": [\n        \"http://hub-mirror.c.163.com\",\n        \"https://registry.docker-cn.com\"\n    ]\n\n} \n</code></pre> <p>4\uff09\u542f\u52a8docker</p> <pre><code>systemctl enable docker \nsystemctl start docker \n</code></pre> <p>5\uff09\u5b89\u88c5 cri-dockerd</p> <p>Mirantis/cri-dockerd (github.com)</p>"},{"location":"cloud/k8s/deploy.html#containerd","title":"Containerd","text":"<p>1\uff09\u5b89\u88c5 containerd</p> <p>containerd/getting-started.md at main \u00b7 containerd/containerd (github.com)</p> <p>2\uff09\u914d\u7f6e <code>systemd</code> cgroup \u9a71\u52a8</p> <p>\u5728 <code>/etc/containerd/config.toml</code> \u4e2d\u8bbe\u7f6e\uff1a(\u914d\u7f6e\u5b8c\u540e\u91cd\u542f<code>sudo systemctl restart containerd</code>)</p> <pre><code>[plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes.runc]\n  ...\n  [plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes.runc.options]\n    SystemdCgroup = true\n</code></pre>"},{"location":"cloud/k8s/deploy.html#kubeadmkubeletkubectl","title":"\u5b89\u88c5kubeadm/kubelet/kubectl\uff08\u6240\u6709\u8282\u70b9)","text":"<ul> <li><code>kubeadm</code>\uff1a\u7528\u6765\u521d\u59cb\u5316\u96c6\u7fa4\u7684\u6307\u4ee4\u3002</li> <li><code>kubelet</code>\uff1a\u5728\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7528\u6765\u542f\u52a8 Pod \u548c\u5bb9\u5668\u7b49\u3002</li> <li><code>kubectl</code>\uff1a\u7528\u6765\u4e0e\u96c6\u7fa4\u901a\u4fe1\u7684\u547d\u4ee4\u884c\u5de5\u5177</li> </ul> <ul> <li>\u914d\u7f6e k8s \u7684 yum repo</li> </ul> <pre><code>cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo\n[kubernetes]\nname=Kubernetes\nbaseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64\nenabled=1\ngpgcheck=0\nrepo_gpgcheck=0\ngpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg\n       http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg\nEOF\n\n# \u91cd\u65b0\u6784\u5efa\u7f13\u5b58\u7d22\u5f15\nyum clean all \nyum makecache fast\n</code></pre> <ul> <li>\u5b89\u88c5 kubelet, kubeadm, kubectl</li> </ul> <pre><code>yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes\n# disableexcludes=kubernetes\uff1a\u7981\u6389\u9664\u4e86\u8fd9\u4e2akubernetes\u4e4b\u5916\u7684\u522b\u7684\u4ed3\u5e93\n</code></pre> <ul> <li>\u542f\u52a8 kubelet</li> </ul> <pre><code># \u5f00\u673a\u81ea\u542f\u5e76\u7acb\u5373\u542f\u52a8\nsudo systemctl enable --now kubelet\n# \u91cd\u65b0\u5b89\u88c5\uff08\u6216\u7b2c\u4e00\u6b21\u5b89\u88c5\uff09k8s\uff0c\u672a\u7ecf\u8fc7kubeadm init \u6216\u8005 kubeadm join\u540e\uff0c\n# kubelet\u4f1a\u4e0d\u65ad\u91cd\u542f\uff0c\u8fd9\u4e2a\u662f\u6b63\u5e38\u73b0\u8c61\u2026\u2026\uff0c\u6267\u884cinit\u6216join\u540e\u95ee\u9898\u4f1a\u81ea\u52a8\u89e3\u51b3\n</code></pre>"},{"location":"cloud/k8s/deploy.html#master","title":"\u521d\u59cb\u5316\uff08\u4ec5master\u8282\u70b9\uff09","text":"<p>\u63a8\u8350\u4f7f\u7528yaml\u8fdb\u884c\u521d\u59cb\u5316\uff1a\u793a\u4f8b <code>kubeadm-config.yaml</code></p> <pre><code>apiVersion: kubeadm.k8s.io/v1beta2\nkind: InitConfiguration\nnodeRegistration:\n  kubeletExtraArgs:\n    cgroup-driver: \"systemmd\"\n---\napiVersion: kubeadm.k8s.io/v1beta2\nkind: ClusterConfiguration\n# \u63a7\u5236 kube-apiserver\u3001kube-controller-manager\u3001kube-scheduler \u548c kube-proxy \u7684\u7248\u672c\nkubernetesVersion: v1.21.1\n# kubectl config get-clusters \u67e5\u770b\u7684\u7ed3\u679c\n# \u67e5\u770b kubeconfig \u53ef\u770b\u5230 cluster.name \u7684\u5185\u5bb9\u4e00\u81f4\nclusterName: \"cluster.local\"\n# \u5b9a\u4e49\u63a7\u5236\u9762\u677f\u7684\u5730\u5740\ncontrolPlaneEndpoint: \"node131:6443\"\ncontrollerManager:\n  extraArgs:\n    horizontal-pod-autoscaler-sync-period: \"10s\"\n    node-monitor-grace-pe   riod: \"10s\"\napiServer:\n  exitArgs:\n    runtime-config: \"api/all=true\"\nimageRepository: registry.aliyuncs.com/google_containers  \nnetworking:\n  podSubnet: \"10.10.0.0/16\"\n</code></pre> <p>\u6267\u884c\u547d\u4ee4</p> <pre><code>#kubeadm init \\\n#  --apiserver-advertise-address=192.168.0.113 \\\n#  --image-repository registry.aliyuncs.com/google_containers \\\n#  --kubernetes-version v1.22.1 \\\n#  --service-cidr=10.1.0.0/16 \\\n#  --pod-network-cidr=10.244.0.0/16\n\n# \u5c06\u63a7\u5236\u5e73\u9762\u8bc1\u4e66\u4e0a\u4f20\u5230 kubeadm-certs Secret\u3002\n$ kubeadm init --config=kubeadm-config.yaml --upload-certs\n</code></pre> <ul> <li>\u521d\u59cb\u5316 kubectl \uff0c\u4f9b\u7279\u5b9a\u7528\u6237\u4f7f\u7528</li> </ul> <pre><code>rm -rf $HOME/.kube/\nmkdir -p $HOME/.kube\nsudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\nsudo chown $(id -u):$(id -g) $HOME/.kube/config\n</code></pre>"},{"location":"cloud/k8s/deploy.html#podmaster","title":"Pod\u7f51\u7edc\u63d2\u4ef6\u5b89\u88c5\uff08\u4ec5Master\uff09","text":""},{"location":"cloud/k8s/deploy.html#cni-calico","title":"CNI \u63d2\u4ef6 calico","text":"<p>\u4e0b\u8f7d calico manifests \u6587\u4ef6</p> <pre><code>curl https://docs.projectcalico.org/manifests/calico.yaml -o calico.yaml\n</code></pre> <p>calico \u7684\u6ce8\u610f\u4e8b\u9879</p> <ul> <li>3.x \u7248\u672c\u9ed8\u8ba4\u4f7f\u7528 IPIP \u6a21\u5f0f\uff1a\u5c06 <code>FELIX_INPUTMTU</code>\u503c\u6539\u4e3a 1480 \uff08\u9ed8\u8ba4\u4e3a1440\u4e3b\u8981\u662f\u4e3a\u9002\u914dGoogle\u7684GCE\u73af\u5883\uff09</li> <li>\u9ed8\u8ba4\u4f7f\u7528K8s API \u5b58\u53d6\u6570\u636e\uff1a\u8d85\u8fc750\u4e2a\u8282\u70b9\u7684\u96c6\u7fa4\uff0c\u4e0b\u8f7d<code>calico-typha.yaml</code>\u8fdb\u884c\u90e8\u7f72\uff1b</li> <li>calico-typha Depolyment \u5c06\u6240\u6709Calico\u7684\u901a\u4fe1\u96c6\u4e2d\u8d77\u6765\u4e0eAPI Server\u8fdb\u884c\u7edf\u4e00\u4ea4\u4e92\uff1b</li> <li>\u6bcf\u4e2acalico-typha Pod\u8d44\u6e90\u53ef\u627f\u8f7d100\u5230200\u4e2aCalico\u8282\u70b9\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u6570\u91cf\u5728 3 ~ 20 \u4e4b\u95f4\uff08\u751f\u4ea7\u73af\u5883\uff09\uff1b</li> </ul> <pre><code>kubectl apply -f calico.yaml # configmap/calico-config created \n# \u67e5\u770b\nkubectl get pod --all-namespaces\n</code></pre> <p>\u6210\u529f\u540e\uff0c\u5e94\u8be5\u663e\u793a\u7c7b\u4f3c\u7684\u670d\u52a1\u72b6\u6001\uff1a</p> <p></p>"},{"location":"cloud/k8s/deploy.html#node","title":"\u90e8\u7f72node\u8282\u70b9","text":"<p><code>kubeadm init</code> \u521b\u5efa\u4e86\u4e00\u4e2a\u6709\u6548\u671f\u4e3a 24 \u5c0f\u65f6\u7684\u4ee4\u724c\uff08\u5f15\u5bfc\u4ee4\u724c\u7528\u4e8e\u5728\u5373\u5c06\u52a0\u5165\u96c6\u7fa4\u7684\u8282\u70b9\u548c\u4e3b\u8282\u70b9\u95f4\u5efa\u7acb\u53cc\u5411\u8ba4\u8bc1\uff09\uff0c\u5728\u547d\u4ee4\u7684Output\u4e2d\u663e\u793a\u3002</p> <p>\u4e3b\u8282\u70b9\uff08Master\uff09\u83b7\u53d6 join \u53c2\u6570\uff08\u521b\u5efa\u65b0\u7684\u4ee4\u724c\uff0c\u9ed8\u8ba424\u5c0f\u65f6\u540e\u81ea\u52a8\u5220\u9664\uff09</p> <pre><code>$ kubeadm token create --print-join-command\nkubeadm join 192.168.174.129:6443 --token a95vmc.yy4p8btqoa7e5dwd     --discovery-token-ca-cert-hash sha256:7c43918ee287d21fe9b70e4868e2e0fdd8c5f6b829a825822aecdb8d207494fc \n</code></pre> <p>\u5728 \u4ece\u8282\u70b9 \u8f93\u5165\u521a\u624d\u83b7\u53d6\u7684join\u53c2\u6570\u8f93\u51fa\uff0c\u6267\u884cjoin\u547d\u4ee4</p> <pre><code>kubeadm join 192.168.174.129:6443 --token a95vmc.yy4p8btqoa7e5dwd     --discovery-token-ca-cert-hash sha256:7c43918ee287d21fe9b70e4868e2e0fdd8c5f6b829a825822aecdb8d207494fc \n</code></pre> <p>\u67e5\u770b\u8282\u70b9\u72b6\u6001</p> <pre><code>[root@node131 ~]# kubectl get node\nNAME      STATUS   ROLES                  AGE    VERSION\nnode131   Ready    control-plane,master   18m    v1.21.1\nnode132   Ready    &lt;none&gt;                 105s   v1.21.3\n</code></pre> <p>\u5f85\u6240\u6709\u8282\u70b9\u90fdready\u540e, \u96c6\u7fa4\u90e8\u7f72\u5b8c\u6210\u3002</p>"},{"location":"cloud/k8s/deploy.html#kube-proxyipvsmaster","title":"kube-proxy\u5f00\u542fipvs\uff08master\u8282\u70b9\u6267\u884c\uff09","text":"<p>\u4fee\u6539<code>ConfigMap</code>\u7684<code>kube-system/kube-proxy</code>\u4e2d\u7684<code>config.conf</code>\uff0c<code>mode: \"ipvs\"</code></p> <pre><code>kubectl edit cm kube-proxy -n kube-system \n</code></pre> <p>\u4e4b\u540e\u91cd\u542f\u5404\u4e2a\u8282\u70b9\u4e0a\u7684kube-proxy pod\uff1a</p> <pre><code>kubectl get pod -n kube-system | grep kube-proxy | awk '{system(\"kubectl delete pod \"$1\" -n kube-system\")}'\n</code></pre>"},{"location":"cloud/k8s/deploy.html#cgroup","title":"cgroup \u9a71\u52a8\u914d\u7f6e","text":"<p>\u786e\u4fdd\u5bb9\u5668\u8fd0\u884c\u65f6\u548c kubelet \u6240\u4f7f\u7528\u7684\u662f\u76f8\u540c\u7684 cgroup \u9a71\u52a8\u3002</p> <p>1.22 \u7248\u672c\u4e4b\u540e\uff0ckubeadmin \u5b89\u88c5\u65f6\u9ed8\u8ba4 kubelet \u662f sytemmd cgroup \u9a71\u52a8\uff1b</p>"},{"location":"cloud/k8s/deploy.html#_9","title":"\u5b58\u50a8\u914d\u7f6e","text":"<p>\u89c1 K8s \u90e8\u7f72 CephFS</p>"},{"location":"cloud/k8s/deploy.html#_10","title":"\u95ee\u9898","text":"<p>\u4e0b\u8f7d\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u4f1a\u51fa\u73b0\u62a5\u9519\u4fe1\u606f\u63d0\u793a\u955c\u50cf\uff1a</p> <p><code>docker pull registry.aliyuncs.com/google_containers/coredns/coredns:v1.8.0</code></p> <p>\u6ca1\u6709\u4e0b\u8f7d\u4e0b\u6765\uff0c\u8fd9\u662f\u7531\u4e8e\u963f\u91cc\u4e91\u547d\u540d\u9519\u8bef\uff08\u591a\u4e86\u4e2acoredns\uff09 \uff0c\u5148\u901a\u8fc7docker\u624b\u52a8\u4e0b\u8f7d\u955c\u50cf\u3002</p> <p>\u7136\u540e\u8fdb\u884c\u91cd\u65b0tag\u547d\u540d\uff1a</p> <pre><code>docker tag $IMAGE_ID registry.aliyuncs.com/google_containers/coredns/coredns:v1.8.0\n</code></pre>"},{"location":"cloud/k8s/deploy.html#_11","title":"\u6e05\u7406","text":"<p>1\uff09\u5148\u5c06\u8282\u70b9\u8bbe\u7f6e\u4e3a\u7ef4\u62a4\u6a21\u5f0f(k8s-node1\u662f\u8282\u70b9\u540d\u79f0)</p> <pre><code>$ kubectl drain k8s-node1 --delete-local-data --force --ignore-daemonsets\n</code></pre> <p>2\uff09\u5728\u5220\u9664\u8282\u70b9\u4e4b\u524d\uff0c\u8bf7\u91cd\u7f6e kubeadm \u5b89\u88c5\u7684\u72b6\u6001\uff1a</p> <pre><code>$ kubeadm reset\n</code></pre> <p>3\uff09\u91cd\u7f6e\u8fc7\u7a0b\u4e0d\u4f1a\u91cd\u7f6e\u6216\u6e05\u9664 iptables \u89c4\u5219\u6216 IPVS \u8868\u3002\u5982\u679c\u4f60\u5e0c\u671b\u91cd\u7f6e iptables\uff0c\u5219\u5fc5\u987b\u624b\u52a8\u8fdb\u884c\uff1a</p> <pre><code>$ iptables -F &amp;&amp; iptables -t nat -F &amp;&amp; iptables -t mangle -F &amp;&amp; iptables -X\n</code></pre> <p>4\uff09\u5982\u679c\u8981\u91cd\u7f6e IPVS \u8868\uff0c\u5219\u5fc5\u987b\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>$ ipvsadm -C\n</code></pre> <p>5\uff09\u73b0\u5728\u5220\u9664\u8282\u70b9\uff1a</p> <pre><code>$ kubectl delete node k8s-node1\n</code></pre>"},{"location":"cloud/k8s/deploy.html#_12","title":"\u8282\u70b9\u4e0b\u7ebf","text":"<p>\u505c\u6b62\u8282\u70b9\u8c03\u5ea6\uff08\u5728k8s master\u8282\u70b9\u64cd\u4f5c\uff09</p> <ul> <li>nodeName:  \u5f85\u4e0b\u7ebf\u8282\u70b9</li> </ul> <pre><code>kubectl cordon nodeName\n</code></pre> <p>\u5f3a\u5236\u9a71\u9010\u5f85\u4e0b\u7ebf\u8282\u70b9\u5f53\u524dpod\u53ca\u5220\u9664pod\u672c\u5730\u6570\u636e\uff08\u5728k8s master\u8282\u70b9\u64cd\u4f5c\uff09</p> <ul> <li>nodeName:  \u5f85\u4e0b\u7ebf\u8282\u70b9</li> <li><code>--ignore-daemonsets</code>\uff1a\u5220\u9664 daemonsets\uff1b</li> </ul> <pre><code>kubectl drain nodeName --ignore-daemonsets --delete-local-data --force\n</code></pre> <p>\u5220\u9664\u5f85\u4e0b\u7ebf\u8282\u70b9\uff08\u5728k8s master\u8282\u70b9\u64cd\u4f5c\uff09</p> <ul> <li>nodeName:  \u5f85\u4e0b\u7ebf\u8282\u70b9</li> </ul> <pre><code>kubectl delete nodes nodeName\n</code></pre> <p>\u67e5\u770b\u8282\u70b9\u4e0b\u7ebf\u60c5\u51b5</p> <pre><code>kubectl get nodes\n</code></pre> <p>\u6e05\u7406\u5df2\u4e0b\u7ebf\u8282\u70b9k8s\u7ec4\u4ef6\u53ca\u6570\u636e\uff08\u5728\u5df2\u4e0b\u7ebf\u8282\u70b9\u64cd\u4f5c\uff09</p> <pre><code># \u4f1a\u505c\u6b62 kubelet \u5e76\u6e05\u695a\u76f8\u5173\u914d\u7f6e\nkubeadm reset\n\nrm -rf /var/lib/kubelet/\nrm -rf ~/.kube\nrm -rf /bin/kubelet\nrm /usr/local/bin/kubectl\nrm /usr/local/bin/kubeadm\nrm /usr/local/bin/kubelet\nrm -rf /etc/kubernetes/\n\ndocker rmi $(docker images \u2013qa)\ndocker rmi $(docker images)\ndocker rmi $(docker images | grep \"none\" | awk '{print $3}')\nsystemctl disable docker.service\nsystemctl stop docker\n</code></pre>"},{"location":"cloud/k8s/deploy.html#k8s","title":"K8s\u7248\u672c\u5347\u7ea7","text":"<p>kubeadmin \u5347\u7ea7k8s\uff0c\u53ef\u4ee5\u5347\u7ea7\u4e00\u4e2a\u5c0f\u7248\u672c\uff0c\u53ef\u4ee5\u5347\u7ea7\u4e00\u4e2a\u5927\u7248\u672c\uff0c\u4f46\u662f\u4e0d\u80fd\u8de8\u7248\u672c\u5347\u7ea7\uff0c\u4f1a\u6709\u62a5\u9519\u63d0\u793a\u3002\u5efa\u8bae\u4e00\u4e2a\u7248\u672c\u4e00\u4e2a\u7248\u672c\u5347\u7ea7\u3002</p> <p>\u67e5\u770b\u7248\u672c\u5347\u7ea7\u8ba1\u5212</p> <ul> <li><code>kubeadm  upgrade plan</code></li> </ul> <p>\u5347\u7ea7\u7248\u672c</p> <ul> <li><code>kubeadm upgrade apply [version]</code></li> </ul>"},{"location":"cloud/k8s/deploy.html#_13","title":"\u96c6\u7fa4\u5907\u4efd\u4e0e\u6062\u590d","text":""},{"location":"cloud/k8s/deploy.html#etcd_1","title":"Etcd \u5feb\u7167","text":"<p>\u4e0d\u533a\u5206\u6570\u636e\u7684\u5185\u5728\u903b\u8f91\u5173\u7cfb\uff0c\u628a\u6570\u636e\u5b58\u50a8\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u6765\u5907\u4efd\uff0c\u6062\u590d\u65f6\u4e5f\u662f\u4f5c\u4e3a\u6574\u4f53\u6062\u590d\uff0c\u4e0d\u53ef\u80fd\u53ea\u6062\u590d\u4e00\u90e8\u5206\u6570\u636e\uff0c\u7c7b\u4f3c\u5feb\u7167\u7684\u6982\u5ff5\u3002</p> <p>\u5b89\u88c5 <code>ectdctl</code>\uff1a<code>yum install -y etcd-client</code></p> <p>\u5907\u4efd\uff1a</p> <ul> <li>\u5907\u4efd\uff1a</li> </ul> <pre><code># \u6267\u884c\u5907\u4efd\uff0c\u4ece api-server \u6216\u8005 etcd \u542f\u52a8\u547d\u4ee4\u4e0a\u67e5\u8be2\u8bc1\u4e66\u7684\u8def\u5f84\ndate;\nCACERT=\"/etc/kubernetes/pki/etcd/ca.crt\"\nCERT=\"/etc/kubernetes/pki/etcd/server.crt\"\nEKY=\"/etc/kubernetes/pki/etcd/server.key\"\nENDPOINTS=\"127.0.0.1:2379\"\n\nETCDCTL_API=3 etcdctl \\\n--cacert=\"${CACERT}\" --cert=\"${CERT}\" --key=\"${EKY}\" \\\n--endpoints=${ENDPOINTS} \\\nsnapshot save /backup/etcd-snapshot-`date +%Y%m%d`.db\n</code></pre> <p>\u6062\u590d\uff1a</p> <pre><code># 1.\u505c\u6b62\u6240\u6709 Master \u4e0a kube-apiserver \u670d\u52a1\nsystemctl stop kube-apiserver\n\n# 2.\u505c\u6b62\u96c6\u7fa4\u4e2d\u6240\u6709 ETCD \u670d\u52a1\uff08\u5bbf\u4e3b\u673a\u4e0a\u5b89\u88c5 etcd\uff09\nsystemctl stop etcd\n\n# 3.\u79fb\u9664\u6240\u6709 ETCD \u5b58\u50a8\u76ee\u5f55\u4e0b\u6570\u636e\nmv xxx/etcd/data xxx/etcd/data.bak\n\n# 4.\u4ece\u5907\u4efd\u6587\u4ef6\u4e2d\u6062\u590d\u6570\u636e\nETCDCTL_API=3 etcdctl snapshot restore /backup/etcd-snapshot-xx.db  \n\n# 5.\u542f\u52a8 etcd\nsystemctl start etcd\n\n# 6.\u542f\u52a8 apiserver\nsystemctl start kube-apiserver\n\n# 7.\u68c0\u67e5\u670d\u52a1\u662f\u5426\u6b63\u5e38\n</code></pre>"},{"location":"cloud/k8s/deploy.html#velero","title":"Velero","text":"<p>back up and restore your Kubernetes cluster resources and persistent volumes.</p> <ul> <li>\u6309\u7167\u6570\u636e\u7684\u5185\u5728\u903b\u8f91\u5173\u7cfb\uff0c\u9009\u62e9\u6027\u63d0\u53d6\u90e8\u5206\u6570\u636e\u6216\u5168\u90e8\u6570\u636e\uff0c\u6062\u590d\u65f6\u53ef\u4ee5\u9009\u62e9\u6062\u590d\u4e00\u90e8\u5206\u6570\u636e  </li> </ul> <p>velero\u7684\u4f5c\u7528\uff1a</p> <ul> <li>\u707e\u5907\u80fd\u529b\uff1a\u63d0\u4f9b\u5907\u4efd\u6062\u590dk8s\u96c6\u7fa4\u7684\u80fd\u529b</li> <li>\u8fc1\u79fb\u80fd\u529b\uff1a\u63d0\u4f9b\u62f7\u8d1d\u96c6\u7fa4\u8d44\u6e90\u5230\u5176\u4ed6\u96c6\u7fa4\u7684\u80fd\u529b</li> </ul> <p>\u548c etcd \u5907\u4efd\u7684\u533a\u522b\uff1a</p> <ul> <li>etcd \u7684\u5907\u4efd\u5fc5\u987b\u62e5\u6709 etcd \u8fd0\u7ef4\u6743\u9650\uff0c\u6709\u4e9b\u7528\u6237\u65e0\u6cd5\u64cd\u4f5c etcd\uff0c\u5982\u591a\u79df\u6237\u573a\u666f\u3002</li> <li>etcd \u66f4\u9002\u5408\u5355\u96c6\u7fa4\u5185\u6570\u636e\u5907\u4efd\uff0c\u4e0d\u592a\u9002\u5408\u96c6\u7fa4\u8fc1\u79fb</li> <li>etcd \u662f\u5f53\u524d\u72b6\u6001\u5907\u4efd\uff0cvelero \u53ef\u4ee5\u505a\u5230\u53ea\u5907\u4efd\u96c6\u7fa4\u5185\u7684\u4e00\u90e8\u5206\u8d44\u6e90</li> </ul> <p>\u4f7f\u7528\uff1a</p> <pre><code># \u5907\u4efd\uff0c\u5c06 nginx-example \u540d\u7a7a\u95f4\u4e0b\u7684\u8d44\u6e90\u5907\u4efd\nvelero backup create nginx-backup --include-namespaces nginx-example\n\n\n# \u6062\u590d\n# \u5148\u5220\u9664\u8d44\u6e90\nkubectl delete namespaces nginx-example\n# \u6062\u590d\u8d44\u6e90\nvelero restore create --from-backup nginx-backup\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html","title":"\u57fa\u4e8eK8S\u7684Rook-Ceph\u642d\u5efa","text":"<p>Rook: CNCF Open-Source, Cloud-Native Storage for Kubernetes.</p> <p>TODO: \u66f4\u65b0\u7248\u672c\u548c\u5185\u5bb9\u3002</p>"},{"location":"cloud/k8s/deploy_storage.html#1","title":"1. \u5148\u51b3\u6761\u4ef6","text":""},{"location":"cloud/k8s/deploy_storage.html#11-k8s","title":"1.1 K8S\u96c6\u7fa4","text":"\u4e3b\u673a IP \u89d2\u8272 version \u78c1\u76d8(\u88f8\u76d8,\u5efa\u8bae\u6700\u5c11\u4e09\u5757,\u6784\u5efa\u4e09\u526f\u672c) node131 172.16.2.131 control-plane,master v1.20.10 / node132 172.16.2.132 woker v1.20.10 sda node133 172.16.2.133 woker v1.20.10 sda node134 172.16.2.134 woker v1.20.10 sda"},{"location":"cloud/k8s/deploy_storage.html#12-rook-v181ceph","title":"1.2 Rook v1.8.1\u5bf9\u5e94ceph\u7248\u672c\u53f7","text":"<pre><code>[rook@rook-ceph-tools-74bb778c5-qf8f8 /]$ ceph versions\n{\n    \"mon\": {\n        \"ceph version 16.2.7 (dd0603118f56ab514f133c8d2e3adfc983942503) pacific (stable)\": 3\n    },\n    \"mgr\": {\n        \"ceph version 16.2.7 (dd0603118f56ab514f133c8d2e3adfc983942503) pacific (stable)\": 1\n    },\n    \"osd\": {\n        \"ceph version 16.2.7 (dd0603118f56ab514f133c8d2e3adfc983942503) pacific (stable)\": 1\n    },\n    \"mds\": {\n        \"ceph version 16.2.7 (dd0603118f56ab514f133c8d2e3adfc983942503) pacific (stable)\": 2\n    },\n    \"overall\": {\n        \"ceph version 16.2.7 (dd0603118f56ab514f133c8d2e3adfc983942503) pacific (stable)\": 7\n    }\n}\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#2","title":"2. \u5b89\u88c5","text":""},{"location":"cloud/k8s/deploy_storage.html#21-ceph","title":"2.1 \u62c9\u53d6\u9879\u76ee,\u5e76\u8fdb\u5165ceph\u914d\u7f6e\u76ee\u5f55","text":"<pre><code>git clone --single-branch --branch v1.8.1 https://github.com/rook/rook.git\n\ncd rook/deploy/examples\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#22-operatoryaml","title":"2.2 \u914d\u7f6eoperator.yaml\u7684\u955c\u50cf\u6e90","text":"<ul> <li>\u7531\u4e8e\u56fd\u5185\u73af\u5883\u65e0\u6cd5Pull\u5b98\u65b9\u955c\u50cf\uff0c\u6240\u4ee5\u8981\u4fee\u6539\u9ed8\u8ba4\u955c\u50cf\u5730\u5740\uff0c\u6539\u4e3a\u963f\u91cc\u4e91\u955c\u50cf\u4ed3\u5e93</li> <li><code>registry.aliyuncs.com/it00021hot</code>\u662f\u7f51\u53cb\u7684\u955c\u50cf\u5730\u5740\uff0c\u5229\u7528github action\u6bcf\u5929\u5b9a\u65f6\u540c\u6b65\u5b98\u65b9\u955c\u50cf\uff0c\u6240\u6709\u7248\u672c\u7684\u955c\u50cf\u90fd\u6709</li> </ul> <pre><code>  ROOK_CSI_CEPH_IMAGE: \"registry.aliyuncs.com/it00021hot/cephcsi:v3.4.0\"\n  ROOK_CSI_REGISTRAR_IMAGE: \"registry.aliyuncs.com/it00021hot/csi-node-driver-registrar:v2.3.0\"\n  ROOK_CSI_RESIZER_IMAGE: \"registry.aliyuncs.com/it00021hot/csi-resizer:v1.3.0\"\n  ROOK_CSI_PROVISIONER_IMAGE: \"registry.aliyuncs.com/it00021hot/csi-provisioner:v3.0.0\"\n  ROOK_CSI_SNAPSHOTTER_IMAGE: \"registry.aliyuncs.com/it00021hot/csi-snapshotter:v4.2.0\"\n  ROOK_CSI_ATTACHER_IMAGE: \"registry.aliyuncs.com/it00021hot/csi-attacher:v3.3.0\"\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#23-operator","title":"2.3 \u90e8\u7f72operator","text":"<pre><code>kubectl create -f crds.yaml -f common.yaml -f operator.yaml\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#24-osd","title":"2.4 \u7ed9OSD\u8282\u70b9\u6253\u6807\u7b7e","text":"<p>\u8bbe\u7f6e\u5b58\u50a8\u8282\u70b9\uff0c\u5373ceph\u53ea\u90e8\u7f72\u5728\u5bf9\u5e94\u7684\u6253\u6807\u7b7e\u7684\u8282\u70b9\u4e0a</p> <pre><code>kubectl label nodes node132 ceph-osd=enabled\nkubectl label nodes node133 ceph-osd=enabled\nkubectl label nodes node134 ceph-osd=enabled\n\nkubectl get node --show-labels\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#25-cluser","title":"2.5 \u914d\u7f6ecluser","text":"<ul> <li><code>vim cluster.yaml</code></li> <li>\u5f00\u542f<code>provider: host</code>\uff1b</li> <li>\u4fee\u6539 dashboard \u7684 ssl\u4e3afalse\uff1b</li> <li> <p>\u4f7f\u7528\u7279\u5b9a\u7684\u8282\u70b9\u548c\u78c1\u76d8\uff1a</p> <ul> <li>\u914d\u7f6e<code>placement</code>\uff0c\u9009\u62e9\u6253<code>ceph-osd=enabled</code>\u7684\u8282\u70b9\uff1b</li> <li>\u5c06storage\u7684useAllNodes\u5c5e\u6027\u6539\u4e3afalse</li> <li>\u5728storage\u7684nodes\u4e0b\u589e\u52a0\u9700\u8981\u4f7f\u7528osd\u7684\u8282\u70b9\u53ca\u5bf9\u5e94\u786c\u76d8</li> <li>\u5c06storage\u4e0b\u7684config\u7684<code>osdsPerDevice</code>\u6ce8\u91ca\u6253\u5f00\u5e76\u8bbe\u4e3a1</li> <li>\u8981\u5728\u6bcf\u4e2a\u8bbe\u5907\u4e0a\u521b\u5efa\u7684 OSD \u6570\u3002NVMe\u7b49\u9ad8\u6027\u80fd\u8bbe\u5907\u53ef\u4ee5\u5904\u7406\u8fd0\u884c\u591a\u4e2aOSD\u3002\u5982\u679c\u9700\u8981\uff0c\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u8282\u70b9\u548c\u6bcf\u4e2a\u8bbe\u5907\u8986\u76d6\u6b64\u5185\u5bb9\u3002\u672c\u6b21\u73af\u5883\u4e3a\u673a\u68b0\u786c\u76d8\uff0c\u6545\u91c7\u7528\u53c2\u6570\u8bbe\u7f6e\u4e3a1</li> </ul> </li> </ul> <pre><code>#################################################################################################################\n# Define the settings for the rook-ceph cluster with common settings for a production cluster.\n# All nodes with available raw devices will be used for the Ceph cluster. At least three nodes are required\n# in this example. See the documentation for more details on storage settings available.\n\n# For example, to create the cluster:\n#   kubectl create -f crds.yaml -f common.yaml -f operator.yaml\n#   kubectl create -f cluster.yaml\n#################################################################################################################\n\napiVersion: ceph.rook.io/v1\nkind: CephCluster\nmetadata:\n  name: rook-ceph\n  namespace: rook-ceph # namespace:cluster\nspec:\n  cephVersion:\n    # The container image used to launch the Ceph daemon pods (mon, mgr, osd, mds, rgw).\n    # v15 is octopus, and v16 is pacific.\n    # RECOMMENDATION: In production, use a specific version tag instead of the general v14 flag, which pulls the latest release and could result in different\n    # versions running within the cluster. See tags available at https://hub.docker.com/r/ceph/ceph/tags/.\n    # If you want to be more precise, you can always use a timestamp tag such quay.io/ceph/ceph:v16.2.7-20211208\n    # This tag might not contain a new Ceph version, just security fixes from the underlying operating system, which will reduce vulnerabilities\n    image: quay.io/ceph/ceph:v16.2.7\n    # Whether to allow unsupported versions of Ceph. Currently `octopus` and `pacific` are supported.\n    # Future versions such as `pacific` would require this to be set to `true`.\n    # Do not set to true in production.\n    allowUnsupported: false\n  # The path on the host where configuration files will be persisted. Must be specified.\n  # Important: if you reinstall the cluster, make sure you delete this directory from each host or else the mons will fail to start on the new cluster.\n  # In Minikube, the '/data' directory is configured to persist across reboots. Use \"/data/rook\" in Minikube environment.\n  dataDirHostPath: /var/lib/rook\n  # Whether or not upgrade should continue even if a check fails\n  # This means Ceph's status could be degraded and we don't recommend upgrading but you might decide otherwise\n  # Use at your OWN risk\n  # To understand Rook's upgrade process of Ceph, read https://rook.io/docs/rook/latest/ceph-upgrade.html#ceph-version-upgrades\n  skipUpgradeChecks: false\n  # Whether or not continue if PGs are not clean during an upgrade\n  continueUpgradeAfterChecksEvenIfNotHealthy: false\n  # WaitTimeoutForHealthyOSDInMinutes defines the time (in minutes) the operator would wait before an OSD can be stopped for upgrade or restart.\n  # If the timeout exceeds and OSD is not ok to stop, then the operator would skip upgrade for the current OSD and proceed with the next one\n  # if `continueUpgradeAfterChecksEvenIfNotHealthy` is `false`. If `continueUpgradeAfterChecksEvenIfNotHealthy` is `true`, then opertor would\n  # continue with the upgrade of an OSD even if its not ok to stop after the timeout. This timeout won't be applied if `skipUpgradeChecks` is `true`.\n  # The default wait timeout is 10 minutes.\n  waitTimeoutForHealthyOSDInMinutes: 10\n  mon:\n    # Set the number of mons to be started. Generally recommended to be 3.\n    # For highest availability, an odd number of mons should be specified.\n    count: 3\n    # The mons should be on unique nodes. For production, at least 3 nodes are recommended for this reason.\n    # Mons should only be allowed on the same node for test environments where data loss is acceptable.\n    allowMultiplePerNode: false\n  mgr:\n    # When higher availability of the mgr is needed, increase the count to 2.\n    # In that case, one mgr will be active and one in standby. When Ceph updates which\n    # mgr is active, Rook will update the mgr services to match the active mgr.\n    count: 1\n    modules:\n      # Several modules should not need to be included in this list. The \"dashboard\" and \"monitoring\" modules\n      # are already enabled by other settings in the cluster CR.\n      - name: pg_autoscaler\n        enabled: true\n  # enable the ceph dashboard for viewing cluster status\n  dashboard:\n    enabled: true\n    # serve the dashboard under a subpath (useful when you are accessing the dashboard via a reverse proxy)\n    # urlPrefix: /ceph-dashboard\n    # serve the dashboard at the given port.\n    # port: 8443\n    # serve the dashboard using SSL\n    ssl: false\n  # enable prometheus alerting for cluster\n  monitoring:\n    # requires Prometheus to be pre-installed\n    enabled: false\n    # namespace to deploy prometheusRule in. If empty, namespace of the cluster will be used.\n    # Recommended:\n    # If you have a single rook-ceph cluster, set the rulesNamespace to the same namespace as the cluster or keep it empty.\n    # If you have multiple rook-ceph clusters in the same k8s cluster, choose the same namespace (ideally, namespace with prometheus\n    # deployed) to set rulesNamespace for all the clusters. Otherwise, you will get duplicate alerts with multiple alert definitions.\n    rulesNamespace: rook-ceph\n  network:\n    # enable host networking\n    provider: host\n    # enable the Multus network provider\n    #provider: multus\n    #selectors:\n      # The selector keys are required to be `public` and `cluster`.\n      # Based on the configuration, the operator will do the following:\n      #   1. if only the `public` selector key is specified both public_network and cluster_network Ceph settings will listen on that interface\n      #   2. if both `public` and `cluster` selector keys are specified the first one will point to 'public_network' flag and the second one to 'cluster_network'\n      #\n      # In order to work, each selector value must match a NetworkAttachmentDefinition object in Multus\n      #\n      #public: public-conf --&gt; NetworkAttachmentDefinition object name in Multus\n      #cluster: cluster-conf --&gt; NetworkAttachmentDefinition object name in Multus\n    # Provide internet protocol version. IPv6, IPv4 or empty string are valid options. Empty string would mean IPv4\n    #ipFamily: \"IPv6\"\n    # Ceph daemons to listen on both IPv4 and Ipv6 networks\n    #dualStack: false\n  # enable the crash collector for ceph daemon crash collection\n  crashCollector:\n    disable: false\n    # Uncomment daysToRetain to prune ceph crash entries older than the\n    # specified number of days.\n    #daysToRetain: 30\n  # enable log collector, daemons will log on files and rotate\n  # logCollector:\n  #   enabled: true\n  #   periodicity: 24h # SUFFIX may be 'h' for hours or 'd' for days.\n  # automate [data cleanup process](https://github.com/rook/rook/blob/master/Documentation/ceph-teardown.md#delete-the-data-on-hosts) in cluster destruction.\n  cleanupPolicy:\n    # Since cluster cleanup is destructive to data, confirmation is required.\n    # To destroy all Rook data on hosts during uninstall, confirmation must be set to \"yes-really-destroy-data\".\n    # This value should only be set when the cluster is about to be deleted. After the confirmation is set,\n    # Rook will immediately stop configuring the cluster and only wait for the delete command.\n    # If the empty string is set, Rook will not destroy any data on hosts during uninstall.\n    confirmation: \"\"\n    # sanitizeDisks represents settings for sanitizing OSD disks on cluster deletion\n    sanitizeDisks:\n      # method indicates if the entire disk should be sanitized or simply ceph's metadata\n      # in both case, re-install is possible\n      # possible choices are 'complete' or 'quick' (default)\n      method: quick\n      # dataSource indicate where to get random bytes from to write on the disk\n      # possible choices are 'zero' (default) or 'random'\n      # using random sources will consume entropy from the system and will take much more time then the zero source\n      dataSource: zero\n      # iteration overwrite N times instead of the default (1)\n      # takes an integer value\n      iteration: 1\n    # allowUninstallWithVolumes defines how the uninstall should be performed\n    # If set to true, cephCluster deletion does not wait for the PVs to be deleted.\n    allowUninstallWithVolumes: false\n  # To control where various services will be scheduled by kubernetes, use the placement configuration sections below.\n  # The example under 'all' would have all services scheduled on kubernetes nodes labeled with 'role=storage-node' and\n  # tolerate taints with a key of 'storage-node'.\n   # placement:\n   #   #  osd:\n   #      #   nodeAffinity:\n   #          #    requiredDuringSchedulingIgnoredDuringExecution:\n   #           #         nodeSelectorTerms:\n   #             #        - matchExpressions:\n   #                #         - key: ceph-osd\n   #                    #          operator: In\n   #                         #         values:\n   #                               #        - enabled\n  placement:\n    osd:\n      nodeAffinity:\n        requiredDuringSchedulingIgnoredDuringExecution:\n          nodeSelectorTerms:\n          - matchExpressions:\n            - key: ceph-osd\n              operator: In\n              values:\n              - enabled\n#      podAffinity:\n#      podAntiAffinity:\n#      topologySpreadConstraints:\n#      tolerations:\n#      - key: storage-node\n#        operator: Exists\n# The above placement information can also be specified for mon, osd, and mgr components\n#    mon:\n# Monitor deployments may contain an anti-affinity rule for avoiding monitor\n# collocation on the same node. This is a required rule when host network is used\n# or when AllowMultiplePerNode is false. Otherwise this anti-affinity rule is a\n# preferred rule with weight: 50.\n#    osd:\n#    mgr:\n#    cleanup:\n  annotations:\n#    all:\n#    mon:\n#    osd:\n#    cleanup:\n#    prepareosd:\n# If no mgr annotations are set, prometheus scrape annotations will be set by default.\n#    mgr:\n  labels:\n#    all:\n#    mon:\n#    osd:\n#    cleanup:\n#    mgr:\n#    prepareosd:\n# monitoring is a list of key-value pairs. It is injected into all the monitoring resources created by operator.\n# These labels can be passed as LabelSelector to Prometheus\n#    monitoring:\n#    crashcollector:\n  resources:\n# The requests and limits set here, allow the mgr pod to use half of one CPU core and 1 gigabyte of memory\n#    mgr:\n#      limits:\n#        cpu: \"500m\"\n#        memory: \"1024Mi\"\n#      requests:\n#        cpu: \"500m\"\n#        memory: \"1024Mi\"\n# The above example requests/limits can also be added to the other components\n#    mon:\n#    osd:\n# For OSD it also is a possible to specify requests/limits based on device class\n#    osd-hdd:\n#    osd-ssd:\n#    osd-nvme:\n#    prepareosd:\n#    mgr-sidecar:\n#    crashcollector:\n#    logcollector:\n#    cleanup:\n  # The option to automatically remove OSDs that are out and are safe to destroy.\n  removeOSDsIfOutAndSafeToRemove: false\n#  priorityClassNames:\n#    all: rook-ceph-default-priority-class\n#    mon: rook-ceph-mon-priority-class\n#    osd: rook-ceph-osd-priority-class\n#    mgr: rook-ceph-mgr-priority-class\n  storage: # cluster level storage configuration and selection\n    useAllNodes: false\n    useAllDevices: false \n    nodes:\n    - name: \"node132\"\n      devices: # specific devices to use for storage can be specified for each node\n      - name: \"sda\"  #k8s-node02\u93c2\u677f\u59de\u9428\u52ee\uff18\u9429?    #deviceFilter:\n    - name: \"node133\"\n      devices: \n      - name: \"sda\" \n    - name: \"node134\"\n      devices: \n      - name: \"sda\"  \n    config:\n      # crushRoot: \"custom-root\" # specify a non-default root label for the CRUSH map\n      # metadataDevice: \"md0\" # specify a non-rotational storage so ceph-volume will use it as block db device of bluestore.\n      # databaseSizeMB: \"1024\" # uncomment if the disks are smaller than 100 GB\n      # journalSizeMB: \"1024\"  # uncomment if the disks are 20 GB or smaller\n      osdsPerDevice: \"1\" # this value can be overridden at the node or device level\n      # encryptedDevice: \"true\" # the default value for this option is \"false\"\n# Individual nodes and their config can be specified as well, but 'useAllNodes' above must be set to false. Then, only the named\n# nodes below will be used as storage resources.  Each node's 'name' field should match their 'kubernetes.io/hostname' label.\n    # nodes:\n    #   - name: \"172.17.4.201\"\n    #     devices: # specific devices to use for storage can be specified for each node\n    #       - name: \"sdb\"\n    #       - name: \"nvme01\" # multiple osds can be created on high performance devices\n    #         config:\n    #           osdsPerDevice: \"5\"\n    #       - name: \"/dev/disk/by-id/ata-ST4000DM004-XXXX\" # devices can be specified using full udev paths\n    #     config: # configuration can be specified at the node level which overrides the cluster level config\n    #   - name: \"172.17.4.301\"\n    #     deviceFilter: \"^sd.\"\n    # when onlyApplyOSDPlacement is false, will merge both placement.All() and placement.osd\n    onlyApplyOSDPlacement: false\n  # The section for configuring management of daemon disruptions during upgrade or fencing.\n  disruptionManagement:\n    # If true, the operator will create and manage PodDisruptionBudgets for OSD, Mon, RGW, and MDS daemons. OSD PDBs are managed dynamically\n    # via the strategy outlined in the [design](https://github.com/rook/rook/blob/master/design/ceph/ceph-managed-disruptionbudgets.md). The operator will\n    # block eviction of OSDs by default and unblock them safely when drains are detected.\n    managePodBudgets: true\n    # A duration in minutes that determines how long an entire failureDomain like `region/zone/host` will be held in `noout` (in addition to the\n    # default DOWN/OUT interval) when it is draining. This is only relevant when  `managePodBudgets` is `true`. The default value is `30` minutes.\n    osdMaintenanceTimeout: 30\n    # A duration in minutes that the operator will wait for the placement groups to become healthy (active+clean) after a drain was completed and OSDs came back up.\n    # Operator will continue with the next drain if the timeout exceeds. It only works if `managePodBudgets` is `true`.\n    # No values or 0 means that the operator will wait until the placement groups are healthy before unblocking the next drain.\n    pgHealthCheckTimeout: 0\n    # If true, the operator will create and manage MachineDisruptionBudgets to ensure OSDs are only fenced when the cluster is healthy.\n    # Only available on OpenShift.\n    manageMachineDisruptionBudgets: false\n    # Namespace in which to watch for the MachineDisruptionBudgets.\n    machineDisruptionBudgetNamespace: openshift-machine-api\n\n  # healthChecks\n  # Valid values for daemons are 'mon', 'osd', 'status'\n  healthCheck:\n    daemonHealth:\n      mon:\n        disabled: false\n        interval: 45s\n      osd:\n        disabled: false\n        interval: 60s\n      status:\n        disabled: false\n        interval: 60s\n    # Change pod liveness probe, it works for all mon,mgr,osd daemons\n    livenessProbe:\n      mon:\n        disabled: false\n      mgr:\n        disabled: false\n      osd:\n        disabled: false\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#26-secret","title":"2.6 \u8bbe\u7f6esecret","text":"<p>rook-ceph\u5b89\u88c5\u65f6\u9700\u8981\u4e00\u4e2asecret</p> <pre><code>kubectl -n rook-ceph create secret generic rook-ceph-crash-collector-keyring\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#27-cluster","title":"2.7 \u521b\u5efacluster","text":"<pre><code>kubectl apply -f cluster.yaml\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#28-secretrook-ceph-181-bug","title":"2.8 \u5220\u9664secret\uff08Rook-ceph 1.8.1 BUG\uff09","text":"<p>\u5f53\u524d\u7248\u672cceph bug\uff0c\u9700\u5148\u8bbe\u7f6esecret\u5b8c\u6210cluster\u521b\u5efa\u540e\u518d\u5220\u9664\u4fdd\u8bc1\u540e\u7eed\u64cd\u4f5c\u6210\u529f</p> <pre><code>kubectl -n rook-ceph delete secret  rook-ceph-crash-collector-keyring\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#29-toolbox","title":"2.9 \u5b89\u88c5\u5de5\u5177\u7bb1Toolbox","text":"<ul> <li>Rook\u5de5\u5177\u7bb1\u662f\u4e00\u4e2a\u5bb9\u5668\uff0c\u5176\u4e2d\u5305\u542b\u7528\u4e8erook\u8c03\u8bd5\u548c\u6d4b\u8bd5\u7684\u5e38\u7528\u5de5\u5177\u3002 \u8be5\u5de5\u5177\u7bb1\u57fa\u4e8eCentOS\uff0c\u56e0\u6b64yum\u53ef\u4ee5\u8f7b\u677e\u5b89\u88c5\u60a8\u9009\u62e9\u7684\u66f4\u591a\u5de5\u5177\u3002</li> </ul> <pre><code>kubectl apply -f toolbox.yaml\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#210-rook","title":"2.10 \u6d4b\u8bd5Rook","text":"<ul> <li>\u4e00\u65e6 toolbox \u7684 Pod \u8fd0\u884c\u6210\u529f\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u8fdb\u5165\u5230\u5de5\u5177\u7bb1\u5185\u90e8\u8fdb\u884c\u64cd\u4f5c\uff1a</li> </ul> <pre><code>kubectl -n rook-ceph exec -it $(kubectl -n rook-ceph get pod -l \"app=rook-ceph-tools\" -o jsonpath='{.items[0].metadata.name}') /bin/bash\n</code></pre> <p>\u67e5\u770b\u96c6\u7fa4\u7684\u72b6\u6001\uff1a</p> <pre><code># \u9700\u8981\u6ee1\u8db3\u4e0b\u9762\u7684\u6761\u4ef6\u624d\u8ba4\u4e3a\u662f\u5065\u5eb7\u7684\n# \u6240\u6709 mons \u5e94\u8be5\u8fbe\u5230\u6cd5\u5b9a\u6570\u91cf\n# mgr \u5e94\u8be5\u662f\u6fc0\u6d3b\u72b6\u6001\n# \u81f3\u5c11\u6709\u4e00\u4e2a OSD \u5904\u4e8e\u6fc0\u6d3b\u72b6\u6001\n# \u5982\u679c\u4e0d\u662f HEALTH_OK \u72b6\u6001\uff0c\u5219\u5e94\u8be5\u67e5\u770b\u544a\u8b66\u6216\u8005\u9519\u8bef\u4fe1\u606f\n\n$ ceph status\n\ncluster:\n    id:     feeaeb98-5cce-4a4c-9300-3c784c48f6e4\n    health: HEALTH_OK\n\n  services:\n    mon: 3 daemons, quorum a,b,c (age 9w)\n    mgr: a(active, since 9w)\n    mds: 1/1 daemons up, 1 hot standby\n    osd: 3 osds: 3 up (since 9w), 3 in (since 9w)\n\n  data:\n    volumes: 1/1 healthy\n    pools:   3 pools, 65 pgs\n    objects: 26.32k objects, 41 GiB\n    usage:   127 GiB used, 11 TiB / 11 TiB avail\n    pgs:     65 active+clean\n\n  io:\n    client:   9.2 KiB/s rd, 14 KiB/s wr, 2 op/s rd, 3 op/s wr\n</code></pre> <ul> <li>osd\u72b6\u6001\u67e5\u770b</li> </ul> <pre><code>ceph osd status\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#211","title":"2.11 \u96c6\u7fa4\u5b89\u88c5\u72b6\u6001\u76d1\u63a7","text":"<ul> <li>\u76f4\u5230MESSAGE\u663e\u793aCluster created successfully\u5373\u8868\u793a\u5b89\u88c5\u6210\u529f,\u4f46\u4e0d\u4fdd\u8bc1\u6240\u6709\u7ec4\u4ef6\u5747\u6210\u529f</li> </ul> <pre><code>kubectl -n rook-ceph get cephcluster\n</code></pre> <ul> <li>\u5982\u76d1\u63a7\u65f6\u53d1\u73b0\u957f\u65f6\u95f4\u5361\u5728\u67d0\u4e00\u6b65,\u53ef\u901a\u8fc7describe\u67e5\u770b\u76f8\u5e94bug</li> </ul> <pre><code>kubectl -n rook-ceph describe cephcluster\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#212-ceph-dashboard","title":"2.12 \u914d\u7f6eceph-dashboard","text":"<pre><code>kubectl apply -f dashboard-external-http.yaml\n\n# \u67e5\u770b\u7aef\u53e3\u53f7\nkubectl get svc -n rook-ceph\n\n# \u83b7\u53d6\u5bc6\u7801: \u7528\u6237\u540d: admin\nkubectl -n rook-ceph get secret rook-ceph-dashboard-password -o jsonpath=\"{['data']['password']}\" | base64 --decode &amp;&amp; echo\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#213-cephosd","title":"2.13 ceph\u8fd0\u7ef4\uff1a\u683c\u5f0f\u5316osd\u786c\u76d8\u91cd\u65b0\u6302\u8f7d","text":"<p>\u5f53osd\u51fa\u73b0\u65e0\u6cd5\u4fee\u590d\u7684\u95ee\u9898\u65f6\uff0c\u683c\u5f0f\u5316osd\u786c\u76d8\u91cd\u65b0\u6302\u8f7d\uff08\u5f53\u524d\u96c6\u7fa4OSD\u51fa\u73b0\u6545\u969c\u65f6\u64cd\u4f5c\uff0c\u9700\u5907\u4efd\u76f8\u5173\u6570\u636e\uff09</p>"},{"location":"cloud/k8s/deploy_storage.html#2131-osd","title":"2.13.1 \u5220\u9664osd","text":"<p>\u8fdb\u5165rook ceph toolbox </p> <pre><code>kubectl -n rook-ceph exec -it $(kubectl -n rook-ceph get pod -l \"app=rook-ceph-tools\" -o jsonpath='{.items[0].metadata.name}') bash\n</code></pre> <p>\u7528ceph\u547d\u4ee4\u67e5\u8be2\u5e76\u5220\u9664osd</p> <pre><code>#\u67e5\u8be2\u72b6\u6001\uff0c\u627e\u5230\u8981\u79fb\u9664\u7684osd id\nceph osd status\n#\u6807\u8bb0\u79fb\u9664\u7684osd\nceph osd out osd.1\nceph osd purge 1 --yes-i-really-mean-it\nceph osd crush remove osd.1\nceph auth rm osd.1\nceph osd rm osd.1 \n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#2133-osddeployment","title":"2.13.3 \u5220\u9664\u76f8\u5173osd\u8282\u70b9\u7684deployment","text":"<pre><code>kubectl delete deploy rook-ceph-osd-1 -n rook-ceph\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#2134-osdosd","title":"2.13.4 \u767b\u5f55\u8981\u5220\u9664osd\u6240\u5728\u7684\u670d\u52a1\u5668\uff0c\u683c\u5f0f\u5316osd\u786c\u76d8","text":"<pre><code>#\u68c0\u67e5\u786c\u76d8\u8def\u5f84\nfdisk -l\n#\u5220\u9664\u786c\u76d8\u5206\u533a\u4fe1\u606f\nDISK=\"/dev/sda\"\nsgdisk --zap-all $DISK\n#\u6e05\u7406\u786c\u76d8\u6570\u636e\uff08hdd\u786c\u76d8\u4f7f\u7528dd\uff0cssd\u786c\u76d8\u4f7f\u7528blkdiscard\uff0c\u4e8c\u9009\u4e00\uff09\ndd if=/dev/zero of=\"$DISK\" bs=1M count=100 oflag=direct,dsync\nblkdiscard $DISK\n#\u5220\u9664\u539fosd\u7684lvm\u4fe1\u606f\uff08\u5982\u679c\u5355\u4e2a\u8282\u70b9\u6709\u591a\u4e2aosd\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u7528*\u62fc\u914d\u6a21\u7cca\u5220\u9664\uff0c\u800c\u6839\u636elsblk -f\u67e5\u8be2\u51fa\u660e\u786e\u7684lv\u6620\u5c04\u4fe1\u606f\u518d\u5177\u4f53\u5220\u9664\uff0c\u53c2\u7167\u7b2c5\u9879\u64cd\u4f5c\uff09\nls /dev/mapper/ceph-* | xargs -I% -- dmsetup remove %\nrm -rf /dev/ceph-*\n#\u91cd\u542f\uff0csgdisk \u2013zzap-all\u9700\u8981\u91cd\u542f\u540e\u624d\u751f\u6548\nreboot\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#2135-osdlvm4-cannot-open-devsdb-device-or-resource-busy","title":"2.13.5 \u624b\u52a8\u67e5\u770b\u5e76\u5220\u9664\u539fosd\u521b\u5efa\u7684lvm\u4fe1\u606f\uff08\u53ef\u9009\uff0c\u6839\u636e\u7b2c4\u6b65\u6267\u884c\u60c5\u51b5\u51b3\u5b9a\uff09\uff0c\u5426\u5219\u683c\u5f0f\u5316\u65f6\u4f1a\u62a5 cannot open /dev/sdb: Device or resource busy \u5f02\u5e38","text":"<ul> <li>\u62a5\u9519\u9519\u8bef\uff1acannot open /dev/sdb: Device or resource busy</li> </ul> <pre><code>#\u67e5\u770blvm\u8bbe\u5907\u4fe1\u606f\ndmsetup ls;\n#\u5220\u9664ceph osd lvm\u6620\u5c04\u5173\u7cfb\ndmsetup remove ceph--5a4cb4bb--70b3--40bd--9da7--09d4f264a513-osd-xxxxxxxxx\n#\u79fb\u52a8lv\nlvremove /dev/mapper/ceph--5a4cb4bb--70b3--40bd--9da7--09d4f264a513-osd\u2014xxxxxxxxx\n#\u5220\u9664\u76f8\u5173\u6587\u4ef6\nrm \u2013rf /dev/ceph--5a4cb4bb--70b3--40bd--9da7--09d4f264a513\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#2136-ceph-operatorosdosdceph","title":"2.13.6 \u91cd\u542fceph operator\u8c03\u5ea6\uff0c\u4f7f\u68c0\u6d4b\u5230\u683c\u5f0f\u5316\u540e\u7684osd\u786c\u76d8\uff0cosd\u542f\u52a8\u540eceph\u96c6\u7fa4\u4f1a\u81ea\u52a8\u5e73\u8861\u6570\u636e","text":"<pre><code>kubectl rollout restart deploy rook-ceph-operator -n rook-ceph\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#2137-osd-podosd-prepare","title":"2.13.7 \u5982\u679c\u65b0osd pod\u65e0\u6cd5\u6267\u884c\u8d77\u6765\u53ef\u4ee5\u901a\u8fc7\u67e5\u8be2osd prepare\u65e5\u5fd7\u627e\u95ee\u9898","text":"<pre><code>kubectl -n rook-ceph logs rook-ceph-osd-prepare-node1-fvmrp provision\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#3","title":"3. \u8e29\u5751\u6ce8\u610f","text":""},{"location":"cloud/k8s/deploy_storage.html#31-ceph-ceph","title":"3.1 \u5220\u9664ceph\u96c6\u7fa4\u5361\u4f4f\u65f6, \u5148\u6267\u884c\u5982\u4e0b\u547d\u4ee4,\u518d\u5220\u9664ceph\u96c6\u7fa4","text":"<pre><code>kubectl -n rook-ceph patch cephclusters.ceph.rook.io rook-ceph -p '{\"metadata\":{\"finalizers\": []}}' --type=merge\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#32-podterminatingpod","title":"3.2 \u5220\u9664\u96c6\u7fa4\u540e,\u53d1\u73b0pod\u5747\u5904\u4e8eTerminating\u72b6\u6001,\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u5f3a\u5236\u5220\u9664pod","text":"<pre><code>kubectl delete --force --grace-period=0 -n rook-ceph  pod  csi-cephfsplugin-9gjhb\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#33-cephfsyamlmyfs","title":"3.3 \u5220\u9664cephfs\u7684yaml\u65f6,\u53d1\u73b0\u5361\u4f4f,\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u4fee\u6539myfs\u72b6\u6001\u540e,\u518d\u6b21\u5220\u9664","text":"<ul> <li>\u8fdb\u5165edit\u6a21\u5f0f\u540e\uff0c\u5220\u9664finalizer\u90a3\u4e00\u884c\u4ee5\u53ca\u4e0b\u4e00\u884c</li> </ul> <pre><code>kubectl edit CephFileSyetem myfs -n rook-ceph\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#34-error","title":"3.4 \u5220\u9664\u96c6\u7fa4\u65f6,\u4f1a\u9047\u5230\u76f8\u5173\u670d\u52a1\u5361\u4f4f,\u67e5\u770berror\u65e5\u5fd7,\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u5f3a\u5236\u5220\u9664","text":"<pre><code>kubectl -n rook-ceph patch CustomResourceDefinition cephblockpools.ceph.rook.io   -p '{\"metadata\":{\"finalizers\": []}}' --type=merge\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#35-namespaceterminating","title":"3.5 \u5220\u9664namespace\u72b6\u6001\u4e3aTerminating","text":"<pre><code>1.\u5bfc\u51fa\u914d\u7f6e\nkubectl get ns rook-ceph -o json &gt; tmp.json\n\n2.\u5220\u9664tmp.json\u4e2dspec\u53castatus\u90e8\u5206\u7684\u5185\u5bb9\n\n3.\u542f\u52a8\u4ee3\u7406\nkubectl proxy\n\n4.\u8c03\u7528\u63a5\u53e3\u5220\u9664\ncurl -k -H \"Content-Type: application/json\" -X PUT --data-binary @tmp.json http://127.0.0.1:8001/api/v1/namespaces/rook-ceph/finalize\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#4","title":"4. \u4f7f\u7528","text":""},{"location":"cloud/k8s/deploy_storage.html#41-cephfs","title":"4.1 \u6587\u4ef6\u5b58\u50a8CephFS\u4f7f\u7528","text":""},{"location":"cloud/k8s/deploy_storage.html#411-cephfsmds","title":"4.1.1 \u521b\u5efacephfs\u53camds","text":"<ul> <li>\u914d\u7f6e: filesystem-test.yaml</li> </ul> <pre><code>#################################################################################################################\n# Create a filesystem with settings for a test environment where only a single OSD is required.\n#  kubectl create -f filesystem-test.yaml\n#################################################################################################################\n\napiVersion: ceph.rook.io/v1\nkind: CephFilesystem\nmetadata:\n  name: myfs\n  namespace: rook-ceph # namespace:cluster\nspec:\n  metadataPool:\n    replicated:\n      size: 1\n      requireSafeReplicaSize: false\n  dataPools:\n    - name: replicated\n      failureDomain: osd\n      replicated:\n        size: 1\n        requireSafeReplicaSize: false\n  preserveFilesystemOnDelete: false\n  metadataServer:\n    activeCount: 1\n    activeStandby: true\n</code></pre> <ul> <li>\u90e8\u7f72</li> </ul> <pre><code>kubectl create -f filesystem-test.yaml\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#412-storageclass","title":"4.1.2 \u521b\u5efa\u52a8\u6001\u5b58\u50a8storageclass","text":"<ul> <li>\u914d\u7f6e: <code>csi/cephfs/storageclass.yaml</code></li> <li>\u5982\u9700\u8bbe\u7f6e\u672cstorageclass\u4e3a\u9ed8\u8ba4storageclass\uff0c\u5219\u9700\u5c06<code>storageclass.beta.kubernetes.io/is-default-class</code>\u7684\u503c\u4ece\"false\"\u8bbe\u7f6e\u4e3a\"true\"</li> </ul> <pre><code>apiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: rook-cephfs\n  annotations:\n     storageclass.beta.kubernetes.io/is-default-class: \"false\"\n# Change \"rook-ceph\" provisioner prefix to match the operator namespace if needed\nprovisioner: rook-ceph.cephfs.csi.ceph.com # driver:namespace:operator\nparameters:\n  # clusterID is the namespace where the rook cluster is running\n  # If you change this namespace, also change the namespace below where the secret namespaces are defined\n  clusterID: rook-ceph # namespace:cluster\n\n  # CephFS filesystem name into which the volume shall be created\n  fsName: myfs\n\n  # Ceph pool into which the volume shall be created\n  # Required for provisionVolume: \"true\"\n  pool: myfs-replicated\n\n  # The secrets contain Ceph admin credentials. These are generated automatically by the operator\n  # in the same namespace as the cluster.\n  csi.storage.k8s.io/provisioner-secret-name: rook-csi-cephfs-provisioner\n  csi.storage.k8s.io/provisioner-secret-namespace: rook-ceph # namespace:cluster\n  csi.storage.k8s.io/controller-expand-secret-name: rook-csi-cephfs-provisioner\n  csi.storage.k8s.io/controller-expand-secret-namespace: rook-ceph # namespace:cluster\n  csi.storage.k8s.io/node-stage-secret-name: rook-csi-cephfs-node\n  csi.storage.k8s.io/node-stage-secret-namespace: rook-ceph # namespace:cluster\n\n  # (optional) The driver can use either ceph-fuse (fuse) or ceph kernel client (kernel)\n  # If omitted, default volume mounter will be used - this is determined by probing for ceph-fuse\n  # or by setting the default mounter explicitly via --volumemounter command-line argument.\n  # mounter: kernel\nreclaimPolicy: Delete\nallowVolumeExpansion: true\nmountOptions:\n  # uncomment the following line for debugging\n  #- debug\n</code></pre> <ul> <li>\u90e8\u7f72</li> </ul> <pre><code>kubectl create -f storageclass.yaml\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#413","title":"4.1.3 \u6d4b\u8bd5","text":"<ul> <li>\u90e8\u7f72pvc(\u6b64\u6b65\u9aa4\u4f1a\u81ea\u52a8\u751f\u6210pv): <code>kubectl -f pvc-test.yaml</code></li> </ul> <pre><code>apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: cephfs-pvc\n  namespace: ai-education\nspec:\n  accessModes:\n  - ReadWriteMany\n  resources:\n    requests:\n      storage: 1Gi\n  storageClassName: rook-cephfs\n</code></pre> <ul> <li>pod\u6302\u8f7dpv: kubectl -f pod-test.yaml</li> </ul> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: civilnet-demo-pod\n  namespace: ai-education\nspec:\n  containers:\n   - name: gemfield-server\n     image: nginx\n     volumeMounts:\n       - name: mypvc\n         mountPath: /var/lib/www/html\n  volumes:\n   - name: mypvc\n     persistentVolumeClaim:\n       claimName: cephfs-pvc\n       readOnly: false\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#42-rbd","title":"4.2 \u5757\u5b58\u50a8RBD\u4f7f\u7528","text":"<pre><code>\u4e0d\u63a8\u8350\u4f7f\u7528\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#43-k8scephfs","title":"4.3 \u5c06k8s\u9ed8\u8ba4\u5b58\u50a8\u8bbe\u4e3acephfs","text":""},{"location":"cloud/k8s/deploy_storage.html#431-cephfsmds411","title":"4.3.1 \u521b\u5efacephfs\u53camds\uff08\u82e54.1.1\u64cd\u4f5c\u8fc7\uff0c\u5219\u6b64\u6b65\u9aa4\u7565\u8fc7\uff09","text":"<ul> <li>\u914d\u7f6e: filesystem-test.yaml</li> <li>\u90e8\u7f72: kubectl create -f filesystem-test.yaml</li> </ul> <pre><code>apiVersion: ceph.rook.io/v1\nkind: CephFilesystem\nmetadata:\n  name: myfs\n  namespace: rook-ceph # namespace:cluster\nspec:\n  metadataPool:\n    replicated:\n      size: 3\n      requireSafeReplicaSize: false\n  dataPools:\n    - name: replicated\n      failureDomain: osd\n      replicated:\n        size: 3\n        requireSafeReplicaSize: false\n  preserveFilesystemOnDelete: false\n  metadataServer:\n    activeCount: 1\n    activeStandby: true\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#432-storageclassk8sstorageclass","title":"4.3.2 \u521b\u5efa\u52a8\u6001\u5b58\u50a8storageclass\u5e76\u8bbe\u7f6e\u4e3ak8s\u9ed8\u8ba4storageclass","text":"<ul> <li>\u914d\u7f6e: <code>storageclass.yaml</code></li> <li>\u90e8\u7f72: <code>kubectl create -f storageclass.yaml</code></li> </ul> <p>\u6ce8\uff1a\u5982\u679c\u4f7f\u7528KubeSphere\uff0c\u8bb0\u5f97\u5c06<code>kubesphere</code>\u9ed8\u8ba4<code>storageclas</code>s: \"local\"\u5bf9\u5e94\u884c\u53bb\u6389- <code>storageclass.beta.kubernetes.io/is-default-class: \"true\"</code></p> <pre><code>apiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: rook-cephfs\n  annotations:\n     storageclass.beta.kubernetes.io/is-default-class: \"true\"\n# Change \"rook-ceph\" provisioner prefix to match the operator namespace if needed\nprovisioner: rook-ceph.cephfs.csi.ceph.com # driver:namespace:operator\nparameters:\n  # clusterID is the namespace where the rook cluster is running\n  # If you change this namespace, also change the namespace below where the secret namespaces are defined\n  clusterID: rook-ceph # namespace:cluster\n\n  # CephFS filesystem name into which the volume shall be created\n  fsName: myfs\n\n  # Ceph pool into which the volume shall be created\n  # Required for provisionVolume: \"true\"\n  pool: myfs-replicated\n\n  # The secrets contain Ceph admin credentials. These are generated automatically by the operator\n  # in the same namespace as the cluster.\n  csi.storage.k8s.io/provisioner-secret-name: rook-csi-cephfs-provisioner\n  csi.storage.k8s.io/provisioner-secret-namespace: rook-ceph # namespace:cluster\n  csi.storage.k8s.io/controller-expand-secret-name: rook-csi-cephfs-provisioner\n  csi.storage.k8s.io/controller-expand-secret-namespace: rook-ceph # namespace:cluster\n  csi.storage.k8s.io/node-stage-secret-name: rook-csi-cephfs-node\n  csi.storage.k8s.io/node-stage-secret-namespace: rook-ceph # namespace:cluster\n\n  # (optional) The driver can use either ceph-fuse (fuse) or ceph kernel client (kernel)\n  # If omitted, default volume mounter will be used - this is determined by probing for ceph-fuse\n  # or by setting the default mounter explicitly via --volumemounter command-line argument.\n  # mounter: kernel\nreclaimPolicy: Retain\nallowVolumeExpansion: true\nmountOptions:\n  # uncomment the following line for debugging\n  #- debug\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#433-kubesphere","title":"4.3.3 KubeSphere\u9ed8\u8ba4\u52a8\u6001\u5b58\u50a8\u4fee\u6539","text":"<ul> <li>\u82e5k8s\u96c6\u7fa4\u91c7\u7528kubesphere\u90e8\u7f72\uff0c\u5219\u8bb0\u5f97\u5c06kubesphere\u5bf9\u5e94\u884c\u6539\u4e3a- storageclass.beta.kubernetes.io/is-default-class: \"false\"</li> </ul>"},{"location":"cloud/k8s/deploy_storage.html#5","title":"5. \u5378\u8f7d","text":""},{"location":"cloud/k8s/deploy_storage.html#51-cephpod","title":"5.1 \u5378\u8f7dCeph\u96c6\u7fa4\u524d,\u8bf7\u5148\u6e05\u9664\u76f8\u5173pod","text":"<ul> <li>\u5220\u9664\u5757\u5b58\u50a8\u548c\u6587\u4ef6\u5b58\u50a8</li> </ul> <pre><code>kubectl delete -n rook-ceph cephblockpool replicapool\nkubectl delete storageclass rook-ceph-block\nkubectl delete -f filesystem-test.yaml\nkubectl delete storageclass csi-cephfs rook-ceph-block\nkubectl -n rook-ceph delete cephcluster rook-ceph\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#52-operatorcrd","title":"5.2 \u4e3b\u8282\u70b9\u5220\u9664operator\u548c\u76f8\u5173crd","text":"<pre><code>kubectl delete -f cluster.yaml\nkubectl delete -f operator.yaml\nkubectl delete -f common.yaml\nkubectl delete -f crds.yaml\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#53-ceph","title":"5.3 \u6e05\u9664\u96c6\u7fa4\u4e3b\u673a\u76f8\u5173ceph\u6570\u636e","text":"<pre><code>rm -rf /dev/ceph-*\nrm -rf /run/ceph  /etc/bash_completion.d/ceph /var/lib/ceph  /var/log/ceph  /usr/bin/ceph /usr/lib64/ceph /usr/share/ceph\nrm -rf /var/lib/rook/* /var/lib/kubelet/plugins/ceph* /var/lib/kubelet/plugins_registry/ceph* /usr/share/doc/ceph\nrm -rf /var/lib/kubelet/plugins/rook* /var/lib/kubelet/plugins_registry/rook*\nrm -rf /var/lib/kubelet/plugins/csi* /var/lib/kubelet/plugins_registry/csi*\n</code></pre>"},{"location":"cloud/k8s/deploy_storage.html#54-device","title":"5.4 \u6e05\u9664device","text":"<ul> <li>dd if=/dev/zero of=\"$DISK\" bs=1M count=100 oflag=direct,dsync</li> <li>if\uff1a\u8f93\u5165\u6587\u4ef6\u540d\uff0c\u7f3a\u7701\u4e3a\u6807\u51c6\u8f93\u5165</li> <li>of=file\uff1a\u8f93\u51fa\u6587\u4ef6\u540d\uff0c\u7f3a\u7701\u4e3a\u6807\u51c6\u8f93\u51fa</li> <li>bs\uff1a\u540c\u65f6\u8bbe\u7f6e\u8bfb\u5165/\u8f93\u51fa\u7684\u5757\u5927\u5c0f\u4e3a1M\u4e2a\u5b57\u8282</li> <li>count\uff1a\u4ec5\u62f7\u8d1d100 \u4e2a\u5757\uff0c\u5757\u5927\u5c0f\u7b49\u4e8ebs\u6307\u5b9a\u7684\u5b57\u8282\u6570</li> <li>oflag\uff1a\u6307\u5b9a\u5199\u7684\u65b9\u5f0fFLAGS\uff0cFLAGS\u53c2\u6570\u8bf4\u660e\uff1a<ul> <li>append -append  mode  (makes  sense  only  for output; conv=notrunc sug-gested)</li> <li>direct\uff1a\u8bfb\u5199\u6570\u636e\u91c7\u7528\u76f4\u63a5IO\u65b9\u5f0f\uff1b</li> <li>directory\uff1a\u8bfb\u5199\u5931\u8d25\u9664\u975e\u662fdirectory\uff1b</li> <li>dsync\uff1a\u8bfb\u5199\u6570\u636e\u91c7\u7528\u540c\u6b65IO\uff1b</li> <li>sync\uff1a\u540c\u4e0a\uff0c\u4f46\u662f\u9488\u5bf9\u662f\u5143\u6570\u636e</li> <li>fullblock\uff1a\u5806\u79ef\u6ee1block\uff08accumulate full blocks of input \uff09(iflag only)\uff1b</li> <li>nonblock\uff1a\u8bfb\u5199\u6570\u636e\u91c7\u7528\u975e\u963b\u585eIO\u65b9\u5f0f</li> <li>noatime\uff1a\u8bfb\u5199\u6570\u636e\u4e0d\u66f4\u65b0\u8bbf\u95ee\u65f6\u95f4</li> </ul> </li> </ul> <pre><code>yum install gdisk -y\nexport DISK=\"/dev/sdc\"\nsgdisk --zap-all $DISK\ndd if=/dev/zero of=\"$DISK\" bs=1M count=100 oflag=direct,dsync\nblkdiscard $DISK\nls /dev/mapper/ceph-* | xargs -I% -- dmsetup remove %\nrm -rf /dev/ceph-*\n</code></pre> <ul> <li>\u6b64\u6b65\u9aa4\u5b8c\u6210\u540e,\u4f7f\u7528\u547d\u4ee4: lsblk -f \u67e5\u770b\u78c1\u76d8\u662f\u5426\u56de\u5f52\u5230\u65e0\u7cfb\u7edf\u88f8\u76d8\u72b6\u6001\uff0c\u5982\u65e0\u5219\u9700reboot\u76f8\u5e94\u4e3b\u673a</li> </ul>"},{"location":"cloud/k8s/device_plugin.html","title":"\u8bbe\u5907\u63d2\u4ef6","text":"<p>NVIDIA GPU \u8bbe\u5907\u63d2\u4ef6\uff1ahttps://github.com/NVIDIA/k8s-device-plugin</p> <p>AMD GPU \u8bbe\u5907\u63d2\u4ef6\uff1ahttps://github.com/ROCm/k8s-device-plugin</p> <p>v1.26 [stable]\uff1a\u80fd\u591f\u65b0\u589e\u5176\u5b83\u7684\u8bbe\u5907\u8d44\u6e90\uff08\u5982 GPU/FPGA\uff09\u7b49\u4f5c\u4e3a\u8d44\u6e90\u8c03\u5ea6\uff0c\u4f9b Pod \u4f7f\u7528\u3002</p>"},{"location":"cloud/k8s/device_plugin.html#_2","title":"\u6269\u5c55\u8d44\u6e90","text":"<p><code>Extended Resource</code>\u7279\u6b8a\u5b57\u6bb5\u6765\u8d1f\u8d23\u4f20\u9012\u6240\u6269\u5c55\u7684\u8d44\u6e90\u7684\u4fe1\u606f\uff0c\u4e0b\u9762\u662f\u624b\u52a8\u7ed9<code>Node</code>\u52a0\u4e0a<code>nvidia.com/gpu</code>\u7684\u6269\u5c55\u8d44\u6e90\u3002</p> <pre><code># \u5f00\u542fkube proxy\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7 localhost \u8bf7\u6c42 APIServer\nkubectl proxy\n\n# \u7ed9\u8282\u70b9\u6dfb\u52a0 nvidia.com/gpu \u7684\u8d44\u6e90\uff0c\u53ef\u4ee5\u901a\u8fc7\u8282\u70b9\u7684 Status.Capacity \u67e5\u770b\u3002\ncurl --header \"Content-Type: application/json-patch+json\" \\\n--request PATCH \\\n--data '[{\"op\": \"add\", \"path\": \"/status/capacity/nvidia.com/gpu\", \"value\": \"4\"}]' \\\nhttp://localhost:8001/api/v1/nodes/&lt;your-node-name&gt;/status\n</code></pre>"},{"location":"cloud/k8s/device_plugin.html#_3","title":"\u6ce8\u518c\u8bbe\u5907\u63d2\u4ef6","text":"<p><code>kubelet</code> \u63d0\u4f9b\u4e86\u4e00\u4e2a <code>Registration</code> \u7684 gRPC \u670d\u52a1\uff1a</p> <pre><code>service Registration {\n    // \u6ce8\u518c\u8bbe\u5907\u63d2\u4ef6\u7684 UNIX \u5957\u63a5\u5b57\uff0c\u7248\u672c\u7b49\u4fe1\u606f\n    rpc Register(RegisterRequest) returns (Empty) {}\n}\n</code></pre>"},{"location":"cloud/k8s/device_plugin.html#_4","title":"\u5b9e\u73b0\u8bbe\u5907\u63d2\u4ef6","text":"<p>\u63d2\u4ef6\u4f7f\u7528\u4e3b\u673a\u8def\u5f84 <code>/var/lib/kubelet/device-plugins/</code> \u4e0b\u7684 UNIX \u5957\u63a5\u5b57\u542f\u52a8\u4e00\u4e2a gRPC \u670d\u52a1\uff0c\u8be5\u670d\u52a1\u5b9e\u73b0\u4ee5\u4e0b\u63a5\u53e3</p> <pre><code>service DevicePlugin {\n   // GetDevicePluginOptions \u8fd4\u56de\u4e0e\u8bbe\u5907\u7ba1\u7406\u5668\u6c9f\u901a\u7684\u9009\u9879\u3002\n   rpc GetDevicePluginOptions(Empty) returns (DevicePluginOptions) {}\n\n   // ListAndWatch \u8fd4\u56de Device \u5217\u8868\u6784\u6210\u7684\u6570\u636e\u6d41\u3002\n   // \u5f53 Device \u72b6\u6001\u53d1\u751f\u53d8\u5316\u6216\u8005 Device \u6d88\u5931\u65f6\uff0cListAndWatch \u4f1a\u8fd4\u56de\u65b0\u7684\u5217\u8868\u3002\n   rpc ListAndWatch(Empty) returns (stream ListAndWatchResponse) {}\n\n   // Allocate \u5728\u5bb9\u5668\u521b\u5efa\u671f\u95f4\u8c03\u7528\uff0c\u8fd9\u6837\u8bbe\u5907\u63d2\u4ef6\u53ef\u4ee5\u8fd0\u884c\u4e00\u4e9b\u7279\u5b9a\u4e8e\u8bbe\u5907\u7684\u64cd\u4f5c\uff0c\n   // \u5e76\u544a\u8bc9 kubelet \u5982\u4f55\u4ee4 Device \u53ef\u5728\u5bb9\u5668\u4e2d\u8bbf\u95ee\u7684\u6240\u9700\u6267\u884c\u7684\u5177\u4f53\u6b65\u9aa4\n   rpc Allocate(AllocateRequest) returns (AllocateResponse) {}\n\n   // GetPreferredAllocation \u4ece\u4e00\u7ec4\u53ef\u7528\u7684\u8bbe\u5907\u4e2d\u8fd4\u56de\u4e00\u4e9b\u4f18\u9009\u7684\u8bbe\u5907\u7528\u6765\u5206\u914d\uff0c\n   // \u6240\u8fd4\u56de\u7684\u4f18\u9009\u5206\u914d\u7ed3\u679c\u4e0d\u4e00\u5b9a\u4f1a\u662f\u8bbe\u5907\u7ba1\u7406\u5668\u7684\u6700\u7ec8\u5206\u914d\u65b9\u6848\u3002\n   // \u6b64\u63a5\u53e3\u7684\u8bbe\u8ba1\u4ec5\u662f\u4e3a\u4e86\u8ba9\u8bbe\u5907\u7ba1\u7406\u5668\u80fd\u591f\u5728\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\u505a\u51fa\u66f4\u6709\u610f\u4e49\u7684\u51b3\u5b9a\u3002\n   rpc GetPreferredAllocation(PreferredAllocationRequest) returns (PreferredAllocationResponse) {}\n\n   // PreStartContainer \u5728\u8bbe\u5907\u63d2\u4ef6\u6ce8\u518c\u9636\u6bb5\u6839\u636e\u9700\u8981\u88ab\u8c03\u7528\uff0c\u8c03\u7528\u53d1\u751f\u5728\u5bb9\u5668\u542f\u52a8\u4e4b\u524d\u3002\n   // \u5728\u5c06\u8bbe\u5907\u63d0\u4f9b\u7ed9\u5bb9\u5668\u4f7f\u7528\u4e4b\u524d\uff0c\u8bbe\u5907\u63d2\u4ef6\u53ef\u4ee5\u8fd0\u884c\u4e00\u4e9b\u8bf8\u5982\u91cd\u7f6e\u8bbe\u5907\u4e4b\u7c7b\u7684\u7279\u5b9a\u4e8e\u5177\u4f53\u8bbe\u5907\u7684\u64cd\u4f5c\uff0c\n   rpc PreStartContainer(PreStartContainerRequest) returns (PreStartContainerResponse) {}\n}\n</code></pre> <p>\u63d2\u4ef6\u901a\u8fc7\u4f4d\u4e8e\u4e3b\u673a\u8def\u5f84 <code>/var/lib/kubelet/device-plugins/kubelet.sock</code> \u4e0b\u7684 UNIX \u5957\u63a5\u5b57\u5411 kubelet \u6ce8\u518c\u81ea\u8eab\u3002</p> <p>\u4ee5 GPU \u4e3a\u4f8b\uff1a</p> <ul> <li>\u901a\u8fc7<code>ListAndWatch</code>\u7684API\u5b9a\u671f\u5411 kubelet \u6c47\u62a5\u8be5\u8282\u70b9\u4e0a\u7684 GPU  \u7684\u4fe1\u606f\uff0ckubelet \u901a\u8fc7\u5fc3\u8df3\u5411 API Server \u4ee5 Extended Resource\u7684\u5f62\u5f0f\u52a0\u4e0aGPU\u7684\u6570\u91cf\u4fe1\u606f\uff1b</li> <li>\u8be5\u8282\u70b9\u7684 kubelet\u53d1\u73b0 Pod \u9700\u8981GPU\u65f6\uff0c\u4ece\u6301\u6709\u7684GPU\u5217\u8868\u4e3a\u5bb9\u5668\u5206\u914d GPU\uff08kubelet \u5411\u672c\u673a\u7684 Device Plugin \u53d1\u8d77 Allocate \u8bf7\u6c42\uff09\uff1b</li> <li>Device plugin \u6839\u636e kubelet \u4f20\u6765\u7684\u8bbe\u5907 ID\uff0c\u67e5\u627e\u8bbe\u5907\u5bf9\u5e94\u7684\u8bbe\u5907\u8def\u5f84\u548c\u9a71\u52a8\u76ee\u5f55\uff08\u5982 Nvidia \u5b9a\u671f\u8bbf\u95ee nvidia-docker \u63d2\u4ef6 \u83b7\u53d6\u672c\u673aGPU\u4fe1\u606f\uff09\u3002</li> </ul>"},{"location":"cloud/k8s/device_plugin.html#kubelet","title":"\u5904\u7406 kubelet \u91cd\u542f","text":"<p>\u8bbe\u5907\u63d2\u4ef6\u5e94\u80fd\u76d1\u6d4b\u5230 kubelet \u91cd\u542f\uff0c\u5e76\u4e14\u5411\u65b0\u7684 kubelet \u5b9e\u4f8b\u6765\u91cd\u65b0\u6ce8\u518c\u81ea\u5df1\u3002 \u65b0\u7684 kubelet \u5b9e\u4f8b\u542f\u52a8\u65f6\u4f1a\u5220\u9664 <code>/var/lib/kubelet/device-plugins</code> \u4e0b\u6240\u6709\u5df2\u7ecf\u5b58\u5728\u7684 UNIX \u5957\u63a5\u5b57\u3002 </p> <ul> <li>\u8bbe\u5907\u63d2\u4ef6\u9700\u8981\u80fd\u591f\u76d1\u63a7\u5230\u5b83\u7684 UNIX \u5957\u63a5\u5b57\u88ab\u5220\u9664\uff0c\u5e76\u4e14\u5f53\u53d1\u751f\u6b64\u7c7b\u4e8b\u4ef6\u65f6\u91cd\u65b0\u6ce8\u518c\u81ea\u5df1\u3002</li> </ul>"},{"location":"cloud/k8s/device_plugin.html#gpu","title":"GPU \u4f7f\u7528","text":""},{"location":"cloud/k8s/device_plugin.html#nvidia-device-plugin","title":"NVIDIA device plugin","text":"<p>if you don't request GPUs when using the device plugin with NVIDIA images all the GPUs on the machine will be exposed inside your container.</p> <p>Nvidia \u5b98\u65b9\u5b9e\u73b0 k8s device plugin\uff0c\u4f5c\u4e3a K8s Daemonset\uff1a</p> <ul> <li>\u5bb9\u5668\u4f7f\u7528\u96c6\u7fa4\u4e0a\u8282\u70b9\u7684GPU\uff1b</li> <li>\u8ddf\u8e2aGPU\u7684\u5065\u5eb7\u72b6\u6001\uff1b</li> </ul>"},{"location":"cloud/k8s/device_plugin.html#_5","title":"\u5b89\u88c5","text":"<p>With the release of Docker 19.03, usage of <code>nvidia-docker2</code> packages is deprecated since NVIDIA GPUs are now natively supported as devices in the Docker runtime ( --gpus ).</p> <ul> <li>\u5bbf\u4e3b\u673a\u9700\u8981\u5b89\u88c5 nvidia driver\uff1b</li> <li>\u652f\u6301 docker / containerd / CRI-O\uff1b</li> </ul>"},{"location":"cloud/k8s/device_plugin.html#nvidia-container-toolkit","title":"nvidia-container-toolkit","text":"<ul> <li>nvidia-container-toolkit &gt;= 1.7.0 (nvidia-docker, nvidia-docker2\u88ab\u5f03\u7528)</li> </ul> <pre><code>distribution=$(. /etc/os-release;echo $ID$VERSION_ID)\ncurl -s -L https://nvidia.github.io/libnvidia-container/gpgkey | sudo apt-key add -\ncurl -s -L https://nvidia.github.io/libnvidia-container/$distribution/libnvidia-container.list | sudo tee /etc/apt/sources.list.d/libnvidia-container.list\n\nsudo apt-get update &amp;&amp; sudo apt-get install -y nvidia-container-toolkit\n</code></pre>"},{"location":"cloud/k8s/device_plugin.html#nvidia-container-runtime","title":"nvidia-container-runtime","text":"<ul> <li><code>nvidia-container-runtime</code>\u88ab\u914d\u7f6e\u4e3a\u9ed8\u8ba4\u7684 low-level runtime\uff1b</li> </ul> <p>docker\uff1a  <code>/etc/docker/daemon.json</code></p> <p><code>json {     \"default-runtime\": \"nvidia\",     \"runtimes\": {         \"nvidia\": {             \"path\": \"/usr/bin/nvidia-container-runtime\",             \"runtimeArgs\": []         }     } } // sudo systemctl restart docker</code></p> <p>containerd\uff1a  <code>/etc/containerd/config.toml</code></p> <p>```toml version = 2 [plugins]   [plugins.\"io.containerd.grpc.v1.cri\"]     [plugins.\"io.containerd.grpc.v1.cri\".containerd]       default_runtime_name = \"nvidia\"</p> <pre><code>  [plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes]\n    [plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes.nvidia]\n      privileged_without_host_devices = false\n      runtime_engine = \"\"\n      runtime_root = \"\"\n      runtime_type = \"io.containerd.runc.v2\"\n      [plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes.nvidia.options]\n        BinaryName = \"/usr/bin/nvidia-container-runtime\"\n</code></pre>"},{"location":"cloud/k8s/device_plugin.html#sudo-systemctl-restart-containerd","title":"sudo systemctl restart containerd","text":"<p>```</p>"},{"location":"cloud/k8s/device_plugin.html#gpu-plugin","title":"GPU Plugin","text":"<p>Yaml \u5b89\u88c5</p> <pre><code># \u6700\u65b0\u7248\u89c1 https://github.com/NVIDIA/k8s-device-plugin/releases/\n$ kubectl create -f https://raw.githubusercontent.com/NVIDIA/k8s-device-plugin/v0.14.4/nvidia-device-plugin.yml\n</code></pre> <p>Helm \u5b89\u88c5</p> <pre><code>$ helm repo add nvdp https://nvidia.github.io/k8s-device-plugin\n$ helm repo update\n$ helm search repo nvdp --devel\nNAME                          CHART VERSION  APP VERSION    DESCRIPTION\nnvdp/nvidia-device-plugin     0.12.3         0.12.3         A Helm chart for ...\n\n# installation command without any options is then:\n$ helm upgrade -i nvdp nvdp/nvidia-device-plugin \\\n  --namespace nvidia-device-plugin \\\n  --create-namespace \\\n  --version 0.12.3\n</code></pre>"},{"location":"cloud/k8s/device_plugin.html#_6","title":"\u6d4b\u8bd5","text":"<pre><code>$ cat &lt;&lt;EOF | kubectl apply -f -\napiVersion: v1\nkind: Pod\nmetadata:\n  name: gpu-pod\nspec:\n  restartPolicy: Never\n  containers:\n    - name: cuda-container\n      image: nvcr.io/nvidia/k8s/cuda-sample:vectoradd-cuda10.2\n      resources:\n        limits:\n          nvidia.com/gpu: 1 # requesting 1 GPU\n  tolerations:\n  - key: nvidia.com/gpu\n    operator: Exists\n    effect: NoSchedule\nEOF\n</code></pre>"},{"location":"cloud/k8s/device_plugin.html#_7","title":"\u914d\u7f6e","text":"Flag Envvar Default Value <code>--mig-strategy</code> <code>$MIG_STRATEGY</code> <code>\"none\"</code> <code>--fail-on-init-error</code> <code>$FAIL_ON_INIT_ERROR</code> <code>true</code> <code>--nvidia-driver-root</code> <code>$NVIDIA_DRIVER_ROOT</code> <code>\"/\"</code> <code>--pass-device-specs</code> <code>$PASS_DEVICE_SPECS</code> <code>false</code> <code>--device-list-strategy</code> <code>$DEVICE_LIST_STRATEGY</code> <code>\"envvar\"</code> <code>--device-id-strategy</code> <code>$DEVICE_ID_STRATEGY</code> <code>\"uuid\"</code> <code>--config-file</code> <code>$CONFIG_FILE</code> <code>\"\"</code> <p><code>--pass-device-specs</code>  \uff1a\u662f\u5426\u4e0e CPUManager(cpuset \u51cf\u5c11cpu\u5207\u6362) \u4e00\u8d77\u4f7f\u7528</p>"},{"location":"cloud/k8s/device_plugin.html#helm","title":"helm \u5b89\u88c5\u524d\u914d\u7f6e","text":"<p>https://github.com/NVIDIA/k8s-device-plugin#configuring-the-device-plugins-helm-chart</p>"},{"location":"cloud/k8s/device_plugin.html#amd-gpu","title":"AMD GPU","text":"<p>K8s \u63d2\u4ef6</p>"},{"location":"cloud/k8s/extend_csi.html","title":"CSI","text":"<p>Container Storage Interface</p> <p>\u5f00\u6e90\u7684\u4e00\u822c\u6709</p> <ul> <li>Longhorn\uff1a\u4e91\u539f\u751f\u5206\u5e03\u5f0f\u5757\u5b58\u50a8\uff1b</li> <li>Rook\uff1aCeph\uff0c\u652f\u6301\u5757\u3001\u6587\u4ef6\u3001\u5bf9\u8c61\uff1b</li> <li>GlusterFS\u3001Lustre\u7b49\u3002</li> </ul> <p>\u5bf9\u8c61\u5b58\u50a8\u4e0d\u9700\u8981PV/PVC\u6765\u505a\u8d44\u6e90\u62bd\u8c61\uff0c\u5e94\u7528\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u548c\u4f7f\u7528\u3002</p> <ul> <li>\u5bf9\u8c61\u5b58\u50a8\u7684CSI \u4e00\u822c\u4f7f\u7528S3\u534f\u8bae\uff0c\u5e76\u6302\u8f7d\u6210\u6587\u4ef6\u7cfb\u7edf\uff08\u5982 s3fs-fuse\uff09\uff0c\u4f46\u662f\u517c\u5bb9\u6027\u548c\u6548\u7387\u6709\u9650\u5236\uff08\u5982<code>append</code>, <code>list</code>\u7b49\uff09\u3002</li> <li>JuiceFS \u4f7f\u7528\u5bf9\u8c61\u5b58\u50a8\u548c\u5143\u6570\u636e\u5206\u79bb\uff0c\u53ef\u4ee5\u907f\u514d\u7c7b\u4f3c\u7684\u95ee\u9898\u3002</li> </ul>"},{"location":"cloud/k8s/extend_csi.html#_1","title":"\u670d\u52a1","text":"<p>CSI \u63d2\u4ef6\u4e3b\u8981\u67093\u4e2a\u670d\u52a1\uff1a</p> <ul> <li>CSI Node\uff1a\u5bf9\u4e3b\u673a\u4e0a\u7684\u5b58\u50a8\u5377\u8fdb\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\uff0c\u8d1f\u8d23\u5c06 Volume mount \u5230 pod \u4e2d\uff0c\u4ee5 DaemonSet \u5f62\u5f0f\u90e8\u7f72\u5728\u6bcf\u4e2a node \u4e2d\uff1b</li> <li>CSI Controller\uff1a\u4ece\u5b58\u50a8\u670d\u52a1\u7aef\u89d2\u5ea6\u5bf9\u5b58\u50a8\u5377\u8fdb\u884c\u7ba1\u7406\u548c\u64cd\u4f5c\uff0c\u8d1f\u8d23 Volume \u7684\u7ba1\u7406\uff0c\u4ee5 StatefulSet \u5f62\u5f0f\u90e8\u7f72\u3002</li> <li>CSI Identify\uff1a\u7528\u6765\u83b7\u53d6\u63d2\u4ef6\u7684\u4fe1\u606f\uff0c\u68c0\u67e5\u63d2\u4ef6\u7684\u72b6\u6001\u3002</li> </ul>"},{"location":"cloud/k8s/extend_csi.html#_2","title":"\u63a5\u53e3\u89c4\u8303","text":""},{"location":"cloud/k8s/extend_csi.html#indentity","title":"Indentity\u63a5\u53e3","text":"<p>\u7528\u4e8e\u63d0\u4f9b CSI driver \u7684\u8eab\u4efd\u4fe1\u606f\uff0cController \u548c Node \u90fd\u9700\u8981\u5b9e\u73b0\u3002</p> <pre><code>service Identity {\n  // \u8fd4\u56de\u63d2\u4ef6\u7684\u540d\u5b57\u548c\u7248\u672c\n  rpc GetPluginInfo(GetPluginInfoRequest) returns (GetPluginInfoResponse) {}\n  // \u8fd4\u56de\u63d2\u4ef6\u7684\u529f\u80fd\u70b9\uff0c\u662f\u5426\u652f\u6301\u5b58\u50a8\u5377\u521b\u5efa\u3001\u5220\u9664\u7b49\u529f\u80fd\uff0c\u662f\u5426\u652f\u6301\u5b58\u50a8\u5377\u6302\u8f7d\u7684\u529f\u80fd\n  rpc GetPluginCapabilities(GetPluginCapabilitiesRequest) returns (GetPluginCapabilitiesResponse) {}\n  // \u8fd4\u56de\u63d2\u4ef6\u7684\u5065\u5eb7\u72b6\u6001(\u662f\u5426\u5728\u8fd0\u884c\u4e2d)\n  rpc Probe (ProbeRequest) returns (ProbeResponse) {}\n}\n</code></pre>"},{"location":"cloud/k8s/extend_csi.html#controller","title":"Controller\u63a5\u53e3","text":"<p>\u5c5e\u4e8e K8s\u7684 Volume Controller \u7684\u903b\u8f91\uff0c\u5373\u5c5e\u4e8e Master \u8282\u70b9\u7684\u4e00\u90e8\u5206\u3002</p> <ul> <li>CreateVolume\uff1a\u521b\u5efa\u4e00\u4e2a\u5b58\u50a8\u5377(\u5982EBS\u76d8)</li> <li> <p>\u65e0\u9700\u5728\u5bbf\u4e3b\u673a\u4e0a\u6267\u884c\u7684\u64cd\u4f5c\uff0ck8s \u901a\u8fc7\u8c03\u7528\u8be5\u65b9\u6cd5\u521b\u5efa\u5e95\u5c42\u5b58\u50a8</p> </li> <li> <p>DeleteVolume\uff1a\u5220\u9664\u4e00\u4e2a\u5df2\u521b\u5efa\u7684\u5b58\u50a8\u5377(\u5982EBS\u76d8)</p> </li> <li>ControllerPublishVolume\uff1a\u5c06\u4e00\u4e2a\u5df2\u521b\u5efa\u7684\u5b58\u50a8\u5377\uff0c\u6302\u8f7d(attach)\u5230\u6307\u5b9a\u7684\u8282\u70b9\u4e0a</li> <li>ControllerUnpublishVolume\uff1a\u4ece\u6307\u5b9a\u8282\u70b9\u4e0a\uff0c\u5378\u8f7d(detach)\u6307\u5b9a\u7684\u5b58\u50a8\u5377</li> <li>ValidateVolumeCapabilities\uff1a\u8fd4\u56de\u5b58\u50a8\u5377\u7684\u529f\u80fd\u70b9\uff0c\u5982\u662f\u5426\u652f\u6301\u6302\u8f7d\u5230\u591a\u4e2a\u8282\u70b9\u4e0a\uff0c\u662f\u5426\u652f\u6301\u591a\u4e2a\u8282\u70b9\u540c\u65f6\u8bfb\u5199</li> <li>ListVolumes\uff1a\u8fd4\u56de\u6240\u6709\u5b58\u50a8\u5377\u7684\u5217\u8868</li> <li>GetCapacity\uff1a\u8fd4\u56de\u5b58\u50a8\u8d44\u6e90\u6c60\u7684\u53ef\u7528\u7a7a\u95f4\u5927\u5c0f</li> <li>ControllerGetCapabilities\uff1a\u8fd4\u56decontroller\u63d2\u4ef6\u7684\u529f\u80fd\u70b9\uff0c\u5982\u662f\u5426\u652f\u6301GetCapacity\u63a5\u53e3\uff0c\u662f\u5426\u652f\u6301snapshot\u529f\u80fd\u7b49.</li> </ul>"},{"location":"cloud/k8s/extend_csi.html#node","title":"Node\u63a5\u53e3","text":"<ul> <li> <p>NodeStageVolume\uff1a\u5982\u679c\u5b58\u50a8\u5377\u6ca1\u6709\u683c\u5f0f\u5316\uff0c\u9996\u5148\u8981\u683c\u5f0f\u5316\u3002\u7136\u540e\u628a\u5b58\u50a8\u5377mount\u5230\u4e00\u4e2a\u4e34\u65f6\u7684\u76ee\u5f55(\u8fd9\u4e2a\u76ee\u5f55\u901a\u5e38\u662f\u8282\u70b9\u4e0a\u7684\u4e00\u4e2a\u5168\u5c40\u76ee\u5f55)\u3002\u518d\u901a\u8fc7NodePublishVolume\u5c06\u5b58\u50a8\u5377mount\u5230pod\u7684\u76ee\u5f55\u4e2d\u3002mount\u8fc7\u7a0b\u5206\u4e3a2\u6b65\uff0c\u539f\u56e0\u662f\u4e3a\u4e86\u652f\u6301\u591a\u4e2apod\u5171\u4eab\u540c\u4e00\u4e2avolume(\u5982NFS)\u3002</p> </li> <li> <p>NodePublishVolume\uff1a\u5c06\u5b58\u50a8\u5377\u4ece\u4e34\u65f6\u76ee\u5f55mount\u5230\u76ee\u6807\u76ee\u5f55(pod\u76ee\u5f55)\uff0cPod\u521b\u5efa\u65f6\u624d\u4f1a\u8fdb\u884c\u8be5\u64cd\u4f5c\uff1b</p> </li> <li> <p>NodeUnstageVolume\uff1aNodeStageVolume\u7684\u9006\u64cd\u4f5c\uff0c\u5c06\u4e00\u4e2a\u5b58\u50a8\u5377\u4ece\u4e34\u65f6\u76ee\u5f55umount\u6389\uff08\u4e00\u4e2a\u8282\u70b9\u540c\u4e00\u4e2aPVC\u6ca1\u6709Pod\u6302\u8f7d\u65f6\u624d\u4f1a\u64cd\u4f5c\uff09</p> </li> <li> <p>NodeUnpublishVolume\uff1a\u5c06\u5b58\u50a8\u5377\u4ecepod\u76ee\u5f55umount\u6389\uff0cPod\u5220\u9664\u65f6\u4f1a\u6267\u884c</p> </li> <li> <p>NodeGetId\uff1a\u8fd4\u56de\u63d2\u4ef6\u8fd0\u884c\u7684\u8282\u70b9\u7684ID</p> </li> <li> <p>NodeGetCapabilities\uff1a\u8fd4\u56deNode\u63d2\u4ef6\u7684\u529f\u80fd\u70b9\uff0c\u5982\u662f\u5426\u652f\u6301<code>stage/unstage</code>\u529f\u80fd</p> </li> </ul>"},{"location":"cloud/k8s/extend_csi.html#_3","title":"\u5b58\u50a8\u5377\u7684\u751f\u547d\u5468\u671f","text":""},{"location":"cloud/k8s/extend_csi.html#csi_1","title":"CSI \u5b9e\u73b0","text":"<p>node.yaml\uff08\u5fc5\u9009\uff09</p> <ul> <li> <p>\u901a\u8fc7 DaemonSet \u5728\u6bcf\u4e2a\u8282\u70b9\u542f\u52a8\u4e00\u4e2a CSI \u63d2\u4ef6\uff0c\u4e3a kubelet \u63d0\u4f9b CSI Node \u670d\u52a1\uff1b</p> </li> <li> <p>\u5305\u542b <code>node-driver-registrar</code>\u8fb9\u8f66\u5bb9\u5668\uff0c\u5411 kubelet \u6ce8\u518c CSI \u63d2\u4ef6\uff08\u901a\u8fc7\u8bbf\u95eeCSI Identity \u670d\u52a1\u83b7\u53d6\u63d2\u4ef6\u4fe1\u606f\uff09\uff1b</p> </li> </ul> <p>controller.yaml\uff08\u53ef\u9009\uff09</p> <ul> <li> <p>\u901a\u8fc7 Deployment / StatefulSet \u518d\u542f\u52a8\u4e00\u4e2a\u63d2\u4ef6\uff0c\u63d0\u4f9b CSI Controller \u670d\u52a1\uff1b</p> </li> <li> <p>\u6839\u636e\u6240\u9700\u7684\u63a5\u53e3\uff0c\u5305\u542b<code>external-provisioner</code>\u7b49\u8fb9\u8f66\u5bb9\u5668\uff1b</p> </li> </ul> <p>driver.yaml\uff08\u5fc5\u9009\uff09</p> <pre><code>apiVersion: storage.k8s.io/v1\nkind: CSIDriver\nmetadata:\n  name: testcsidriver.example.com\nspec:\n  # cause Kubernetes to skip attach(ControllerPublishVolume) operations for all CSI Driver testcsidriver.example.com volumes.\n  # controller pod does not need 'external-attach' side car\n  attachRequired: false\n  # CSI driver requires additional pod information (like podName, podUID, etc.) during mount operations\n  # in the NodePublishVolumeRequest.volume_context map\n  podInfoOnMount: true\n</code></pre>"},{"location":"cloud/k8s/extend_csi.html#driver-plugin","title":"\u81ea\u5b9a\u4e49\u7684Driver Plugin\u5bb9\u5668","text":"<p>~~\u5e9f\u5f03\uff1ahttps://github.com/kubernetes-csi/drivers~~\uff0c\u63d0\u4f9b\u4e86\u9ed8\u8ba4\u7684 Identity, Node, Controller\u7684\u7c7b\uff0c\u4e0d\u53ef\u7528\u4e8e\u751f\u4ea7\u3002</p> <p>\u81ea\u5b9e\u73b0\u53ef\u4ee5\u53c2\u8003 NFS Driver</p>"},{"location":"cloud/k8s/extend_csi.html#sidecar","title":"SideCar \u5bb9\u5668","text":"<p>\u8fd9\u4e9b\u5916\u90e8\u7ec4\u4ef6\u4f1a\u4f5c\u4e3a<code>sidecar</code>\u5bb9\u5668\u548c CSI \u63d2\u4ef6\u653e\u7f6e\u5728\u4e00\u4e2a Pod \u4e2d\u3002</p>"},{"location":"cloud/k8s/extend_csi.html#node-driver-registrar","title":"node-driver-registrar","text":"<p>Git Repository: https://github.com/kubernetes-csi/node-driver-registrar</p> <p>\u8d1f\u8d23\u8bf7\u6c42 Identity Service \u6765\u83b7\u53d6\u63d2\u4ef6\u4fe1\u606f\u5e76\u4e14\u6ce8\u518c\u5230 kubelet\uff0c\u521d\u59cb\u5316\u7684\u65f6\u5019\u901a\u8fc7 csi-sock \u7684 RPC \u83b7\u53d6 driver name \u548c node id\u3002\u4e3b\u8981\u529f\u80fd\u7ed9 node \u6253\u4e0a annotations\uff0cdevice-driver-registar \u4e3b\u8981\u662f\u6ce8\u518c Node annotation\u3002</p>"},{"location":"cloud/k8s/extend_csi.html#external-provisioner","title":"external-provisioner","text":"<p>Git Repository: https://github.com/kubernetes-csi/external-provisioner</p> <p>\u9488\u5bf9 <code>Dynamic Provisioning</code>\uff0c\u6839\u636e PVC \u81ea\u52a8\u521b\u5efa\u51fa Volume</p> <ul> <li>\u76d1\u542c\u5230 PVC\u521b\u5efa\uff0c\u4f1a\u8c03\u7528 CSI driver Controller \u670d\u52a1\u7684 <code>CreateVolume</code> \u63a5\u53e3</li> <li>\u7ec4\u4ef6\u76d1\u542c\u5230 PVC \u7684\u5220\u9664\u540e\uff0c\u4f1a\u8c03\u7528 CSI driver Controller \u670d\u52a1\u7684 <code>DeleteVolume</code> \u63a5\u53e3</li> </ul>"},{"location":"cloud/k8s/extend_csi.html#external-attacher","title":"external-attacher","text":"<ul> <li>\u76d1\u542c VolumeAttachment \u5bf9\u8c61\uff0c\u5e76\u8c03\u7528 CSI driver Controller \u670d\u52a1\u7684 <code>ControllerPublishVolume</code> \u548c <code>ControllerUnpublishVolume</code> \u63a5\u53e3\uff0c\u7528\u6765\u5c06 volume \u9644\u7740\u5230 node \u4e0a\uff0c\u6216\u4ece node \u4e0a\u5220\u9664\u3002</li> </ul>"},{"location":"cloud/k8s/extend_csi.html#external-resizer","title":"external-resizer","text":"<p>https://github.com/kubernetes-csi/external-resizer</p> <ul> <li>watches Kubernetes PersistentVolumeClaims objects and triggers controller side expansion operation against a CSI endpoint</li> </ul>"},{"location":"cloud/k8s/extend_csi.html#external-snapshotter","title":"external-snapshotter","text":"<ul> <li>watches Kubernetes Snapshot CRD objects and triggers CreateSnapshot/DeleteSnapshot against a CSI endpoint.</li> </ul>"},{"location":"cloud/k8s/extend_csi.html#livenessprobe","title":"livenessprobe","text":"<p>Git Repository: https://github.com/kubernetes-csi/livenessprobe</p> <ul> <li>monitors the health of the CSI driver and reports it to Kubernetes via the Liveness Probe mechanism</li> </ul>"},{"location":"cloud/k8s/extend_csi.html#external-health-monitor-controller","title":"external-health-monitor-controller","text":"<p>Git Repository: https://github.com/kubernetes-csi/external-health-monitor</p> <ul> <li>deployed together with the CSI controller driver</li> <li>calls the CSI controller RPC <code>ListVolumes</code> or <code>ControllerGetVolume</code> to check the health condition of the CSI volumes and report events on <code>PersistentVolumeClaim</code> if the condition of a volume is <code>abnormal</code>.</li> <li>watches for node failure events (enable-node-watcher<code>flag to</code>true, only have effects on local PVs )</li> </ul>"},{"location":"cloud/k8s/extend_csi.html#_4","title":"\u4e09\u65b9\u793a\u4f8b","text":"<p>Rook\uff1a\u57fa\u4e8eCeph\u7684Kubernetes\u5b58\u50a8\u63d2\u4ef6\uff0c\u52a0\u5165\u6c34\u5e73\u6269\u5c55\u3001\u8fc1\u79fb\u3001\u707e\u96be\u5907\u4efd\u3001\u76d1\u63a7\u7b49\u5927\u91cf\u7684\u4f01\u4e1a\u7ea7\u529f\u80fd\u3002</p>"},{"location":"cloud/k8s/garbage_collect.html","title":"\u5783\u573e\u6536\u96c6","text":"<p>\u5783\u573e\u6536\u96c6\u5141\u8bb8\u7cfb\u7edf\u6e05\u7406\u5982\u4e0b\u8d44\u6e90\uff1a</p> <ul> <li>\u7ec8\u6b62\u7684 Pod\uff08<code>phase</code>\u503c\u4e3a <code>Succeeded</code> \u6216 <code>Failed</code>\uff09</li> <li>\u5df2\u5b8c\u6210\u7684 Job</li> <li>\u4e0d\u518d\u5b58\u5728\u5c5e\u4e3b\u5f15\u7528\u7684\u5bf9\u8c61</li> <li>\u672a\u4f7f\u7528\u7684\u5bb9\u5668\u548c\u5bb9\u5668\u955c\u50cf</li> <li>\u52a8\u6001\u5236\u5907\u7684\u3001StorageClass \u56de\u6536\u7b56\u7565\u4e3a Delete \u7684 PV \u5377</li> <li>\u963b\u6ede\u6216\u8005\u8fc7\u671f\u7684 CertificateSigningRequest (CSR)</li> <li>\u5728\u4ee5\u4e0b\u60c5\u5f62\u4e2d\u5220\u9664\u4e86\u7684\u8282\u70b9\u5bf9\u8c61\uff1a</li> <li>\u5f53\u96c6\u7fa4\u4f7f\u7528\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\u8fd0\u884c\u4e8e\u4e91\u7aef\u65f6\uff1b</li> <li>\u5f53\u96c6\u7fa4\u4f7f\u7528\u7c7b\u4f3c\u4e8e\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\u7684\u63d2\u4ef6\u8fd0\u884c\u5728\u672c\u5730\u73af\u5883\u4e2d\u65f6\u3002</li> <li>\u8282\u70b9\u79df\u7ea6\u5bf9\u8c61</li> </ul>"},{"location":"cloud/k8s/garbage_collect.html#_2","title":"\u5c5e\u4e3b\u4e0e\u4f9d\u8d56","text":"<p>\u5c5e\u4e3b\u5f15\u7528\uff08Owner Reference\uff09\u53ef\u4ee5\u544a\u8bc9\u63a7\u5236\u9762\u54ea\u4e9b\u5bf9\u8c61\u4f9d\u8d56\u4e8e\u5176\u4ed6\u5bf9\u8c61\u3002</p> <ul> <li>\u5220\u9664\u67d0\u5bf9\u8c61\u65f6\u63d0\u4f9b\u4e00\u4e2a\u6e05\u7406\u5173\u8054\u8d44\u6e90\u7684\u673a\u4f1a\u3002</li> <li>\u7cfb\u7edf\u4e0d\u5141\u8bb8\u51fa\u73b0\u8de8\u540d\u5b57\u7a7a\u95f4\u7684\u5c5e\u4e3b\u5f15\u7528\u3002</li> </ul> <p>\u793a\u4f8b\uff1a\u4e00\u4e2aDeployment\u521b\u5efa\u7684 Pod</p> <pre><code>apiVersion: v1\n    ...\n    ownerReferences:\n    - apiVersion: apps/v1\n      blockOwnerDeletion: true\n      controller: true\n      # Deployment \u521b\u5efa ReplicaSet\uff0cReplicaSet\u521b\u5efaPod\n      kind: ReplicaSet\n      name: nginx-deployment-6b474476c4\n      uid: 4fdcd81c-bd5d-41f7-97af-3a3b759af9a7\n    ...\n</code></pre>"},{"location":"cloud/k8s/garbage_collect.html#_3","title":"\u7ea7\u8054\u5220\u9664","text":"<p>\u5f53\u4f60\u5220\u9664\u67d0\u4e2a\u5bf9\u8c61A\u65f6\uff0c\u4f60\u53ef\u4ee5\u63a7\u5236 Kubernetes \u662f\u5426\u53bb\u81ea\u52a8\u5220\u9664\u4f9d\u8d56A\u7684\u76f8\u5173\u5bf9\u8c61\uff0c \u8fd9\u4e2a\u8fc7\u7a0b\u79f0\u4e3a\u7ea7\u8054\u5220\u9664\uff08Cascading Deletion\uff09\u3002</p>"},{"location":"cloud/k8s/garbage_collect.html#_4","title":"\u524d\u53f0\u7ea7\u8054\u5220\u9664","text":"<p>kubectl \u7684 --cascade=foreground \u53c2\u6570\u6307\u5b9a\u3002</p> <p>\u6b63\u5728\u88ab\u4f60\u5220\u9664\u7684\u5c5e\u4e3b\u5bf9\u8c61\u9996\u5148\u8fdb\u5165 deletion in progress \u72b6\u6001\u3002 \u9488\u5bf9\u5c5e\u4e3b\u5bf9\u8c61\u4f1a\u53d1\u751f\u4ee5\u4e0b\u4e8b\u60c5\uff1a</p> <ul> <li>API Server \u5c06\u5bf9\u8c61\u7684 <code>metadata.deletionTimestamp</code> \u5b57\u6bb5\u8bbe\u7f6e\u4e3a\u8be5\u5bf9\u8c61\u88ab\u6807\u8bb0\u4e3a\u8981\u5220\u9664\u7684\u65f6\u95f4\u70b9\uff1b</li> <li>API Server \u5c06\u5bf9\u8c61\u7684<code>metadata.finalizers</code> \u5b57\u6bb5\u8bbe\u7f6e\u4e3a <code>foregroundDeletion</code>\uff1b</li> <li>\u5728\u5220\u9664\u8fc7\u7a0b\u5b8c\u6210\u4e4b\u524d\uff0c\u901a\u8fc7 Kubernetes API \u4ecd\u7136\u53ef\u4ee5\u770b\u5230\u8be5\u5bf9\u8c61\u3002</li> </ul> <p>\u5f53\u5c5e\u4e3b\u5bf9\u8c61\u8fdb\u5165\u5220\u9664\u8fc7\u7a0b\u4e2d\u72b6\u6001\u540e\uff0c\u63a7\u5236\u5668\u5220\u9664\u4f9d\u8d56\u8be5\u5c5e\u4e3b\u7684\u5bf9\u8c61\u3002\u63a7\u5236\u5668\u5728\u5220\u9664\u5b8c\u6240\u6709\u4f9d\u8d56\u5bf9\u8c61\u4e4b\u540e\uff0c \u5220\u9664\u5c5e\u4e3b\u5bf9\u8c61\u3002</p> <ul> <li>\u63a7\u5236\u5668\u5fc5\u987b\u5728\u5220\u9664\u4e86\u62e5\u6709 <code>ownerReferences.blockOwnerDeletion=true</code> \u7684\u9644\u5c5e\u8d44\u6e90\u540e\uff0c\u624d\u80fd\u5220\u9664\u5c5e\u4e3b\u5bf9\u8c61\u3002</li> </ul> <p>\u8fd9\u65f6\uff0c\u901a\u8fc7 Kubernetes API \u5c31\u65e0\u6cd5\u518d\u770b\u5230\u8be5\u5bf9\u8c61\u3002</p>"},{"location":"cloud/k8s/garbage_collect.html#_5","title":"\u540e\u53f0\u7ea7\u8054\u5220\u9664\uff08\u9ed8\u8ba4)","text":"<p>Kubernetes \u670d\u52a1\u5668\u7acb\u5373\u5220\u9664\u5c5e\u4e3b\u5bf9\u8c61\uff0c\u63a7\u5236\u5668\u5728\u540e\u53f0\u6e05\u7406\u6240\u6709\u4f9d\u8d56\u5bf9\u8c61\u3002 </p> <ul> <li>\u4f9d\u8d56\u5bf9\u8c61\u662f\u62e5\u6709 <code>ownerReferences.blockOwnerDeletion=true</code> \u7684\u9644\u5c5e\u8d44\u6e90\u3002</li> </ul>"},{"location":"cloud/k8s/garbage_collect.html#orphan","title":"\u88ab\u9057\u5f03\u7684\u4f9d\u8d56\u5bf9\u8c61\uff08orphan\uff09","text":"<p>kubectl \u7684 --cascade=orphan \u53c2\u6570\u6307\u5b9a\uff0c\u5b64\u7acb \u8fd9\u4e9b\u4f9d\u8d56\u5bf9\u8c61\uff08\u5373\u4fdd\u7559\u4e0d\u5220\u9664\uff09\u3002</p> <p>\u5f53 Kubernetes \u5220\u9664\u67d0\u4e2a\u5c5e\u4e3b\u5bf9\u8c61\u65f6\uff0c\u88ab\u7559\u4e0b\u6765\u7684\u4f9d\u8d56\u5bf9\u8c61\u88ab\u79f0\u4f5c\u88ab\u9057\u5f03\u7684\uff08Orphaned\uff09\u5bf9\u8c61\u3002</p>"},{"location":"cloud/k8s/garbage_collect.html#_6","title":"\u672a\u4f7f\u7528\u7684\u5bb9\u5668\u548c\u955c\u50cf","text":"<p>\u57fa\u4e8e <code>KubeletConfiguration</code> \u8fdb\u884c\u914d\u7f6e\u3002</p> <p>kubelet \u6bcf 5 \u5206\u949f\u5bf9\u672a\u4f7f\u7528\u7684\u955c\u50cf\u6267\u884c\u4e00\u6b21\u5783\u573e\u6536\u96c6\uff0c \u6bcf 1 \u5206\u949f\u5bf9\u672a\u4f7f\u7528\u7684\u5bb9\u5668\u6267\u884c\u4e00\u6b21\u5783\u573e\u6536\u96c6\u3002 </p> <ul> <li>\u907f\u514d\u4f7f\u7528\u5916\u90e8\u7684\u5783\u573e\u6536\u96c6\u5de5\u5177\uff0c\u56e0\u4e3a\u5916\u90e8\u5de5\u5177\u53ef\u80fd\u4f1a\u7834\u574f kubelet \u7684\u884c\u4e3a\uff0c\u79fb\u9664\u5e94\u8be5\u4fdd\u7559\u7684\u5bb9\u5668\u3002</li> <li>\u5468\u671f\u65f6\u95f4\u662f\u5728\u4ee3\u7801\u4e2d\u56fa\u5b9a\u7684\u3002</li> </ul>"},{"location":"cloud/k8s/garbage_collect.html#_7","title":"\u5bb9\u5668\u955c\u50cf\u751f\u547d\u5468\u671f","text":"<p>\u955c\u50cf\u7ba1\u7406\u5668\uff08Image Manager\uff09 \u6765\u7ba1\u7406\u6240\u6709\u955c\u50cf\u7684\u751f\u547d\u5468\u671f\uff0c \u8be5\u7ba1\u7406\u5668\u662f kubelet \u7684\u4e00\u90e8\u5206\uff0c\u5de5\u4f5c\u65f6\u4e0e cadvisor \u534f\u540c\u3002</p> <p>kubelet \u5728\u4f5c\u51fa\u5783\u573e\u6536\u96c6\u51b3\u5b9a\u65f6\u4f1a\u8003\u8651\u5982\u4e0b\u65f6\u95f4\u548c\u78c1\u76d8\u7528\u91cf\u7ea6\u675f\uff1a</p> <ul> <li><code>imageMinimumGCAge</code> \uff1a\u9ed8\u8ba4'2m'\uff0c\u955c\u50cf\u7684\u6700\u5c0f\u5b58\u5728\u65f6\u95f4\uff0c\u907f\u514d\u5728\u5783\u573e\u56de\u6536\u65f6\u5220\u9664\u8fc7\u4e8e\u65b0\u7684\u955c\u50cf\u3002</li> <li> <p><code>imageMaximumGCAge</code> \uff1a\u9ed8\u8ba4\"0s\"\uff08\u5df2\u7981\u7528\uff09\uff0c\u8868\u793a\u955c\u50cf\u81ea\u4e0a\u6b21\u4f7f\u7528\u540e\u7684\u6700\u5927\u5b58\u5728\u65f6\u95f4\uff08v1.30\u5f15\u5165)\u3002</p> </li> <li> <p><code>imageGCHighThresholdPercent</code>\uff1a\u9ed8\u8ba485\uff0c\u8d85\u51fa\u65f6\u51fa\u53d1\u5783\u573e\u6536\u96c6\uff0c\u57fa\u4e8e\u955c\u50cf\u4e0a\u6b21\u88ab\u4f7f\u7528\u7684\u65f6\u95f4\u6765\u6309\u987a\u5e8f\u5220\u9664\u5b83\u4eec\uff1b</p> </li> <li><code>imageGCLowThresholdPercent</code>\uff1a\u9ed8\u8ba480\uff0c\u6301\u7eed\u5220\u9664\u955c\u50cf\uff0c\u76f4\u5230\u78c1\u76d8\u7528\u91cf\u8fbe\u5230\u8be5\u503c\u4e3a\u6b62\uff1b</li> </ul>"},{"location":"cloud/k8s/garbage_collect.html#_8","title":"\u5bb9\u5668\u5783\u573e\u6536\u96c6","text":"<p>kubelet \u4ec5\u4f1a\u56de\u6536\u7531\u5b83\u6240\u7ba1\u7406\u7684\u5bb9\u5668\u3002</p> <p>kubelet \u4f1a\u57fa\u4e8e\u5982\u4e0b\u53d8\u91cf\u5bf9\u6240\u6709\u672a\u4f7f\u7528\u7684\u5bb9\u5668\u6267\u884c\u5783\u573e\u6536\u96c6\u64cd\u4f5c\uff08\u542f\u52a8\u53c2\u6570\uff0c\u800c\u4e0d\u662f\u914d\u7f6e\u6587\u4ef6\uff09\uff1a</p> <ul> <li><code>--minimum-container-ttl-duration</code>\uff1a\u5783\u573e\u56de\u6536\u67d0\u4e2a\u5bb9\u5668\u65f6\u8be5\u5bb9\u5668\u7684\u6700\u5c11\u5b58\u6d3b\u65f6\u95f4\u3002\u8bbe\u7f6e\u4e3a <code>0</code> \u8868\u793a\u6ca1\u6709\u9650\u5236\uff08\u5373\u5bb9\u5668\u53ef\u4ee5\u88ab\u7acb\u5373\u6e05\u7406\uff09\u3002</li> <li><code>--maximum-dead-containers-per-container</code>\uff1a\u6bcf\u4e2a Pod \u53ef\u4ee5\u5305\u542b\u7684\u5df2\u6b7b\u4ea1\u7684\u5bb9\u5668\u4e2a\u6570\u4e0a\u9650\u3002\u9ed8\u8ba4\u503c1\uff0c\u8bbe\u7f6e\u4e3a\u5c0f\u4e8e <code>0</code> \u7684\u503c\u8868\u793a\u7981\u6b62\u4f7f\u7528\u6b64\u89c4\u5219\u3002</li> <li><code>--maximum-dead-containers</code>\uff1a\u96c6\u7fa4\u4e2d\u53ef\u4ee5\u5b58\u5728\u7684\u5df2\u6b7b\u4ea1\u7684\u5bb9\u5668\u4e2a\u6570\u4e0a\u9650\u3002\u9ed8\u8ba4\u503c\uff1a-1\uff0c\u7981\u6b62\u5e94\u7528\u6b64\u89c4\u5219\u3002</li> </ul>"},{"location":"cloud/k8s/garbage_collect.html#_9","title":"\u8282\u70b9\u538b\u529b\u9a71\u9010","text":"<p>\u8282\u70b9\u538b\u529b\u9a71\u9010\u662f kubelet \u4e3b\u52a8\u7ec8\u6b62 Pod \u4ee5\u56de\u6536\u8282\u70b9\u4e0a\u8d44\u6e90\u7684\u8fc7\u7a0b\u3002\uff08v1.31 beta, default enabled)</p>"},{"location":"cloud/k8s/garbage_collect.html#kubelet","title":"\u5f03\u7528\u7684 kubelet \u5783\u573e\u6536\u96c6\u529f\u80fd","text":"<p>\u4e00\u4e9b kubelet \u5783\u573e\u6536\u96c6\u529f\u80fd\u5df2\u88ab\u5f03\u7528\uff0c\u4ee5\u9f13\u52b1\u4f7f\u7528\u9a71\u9010\u673a\u5236\u3002</p> \u73b0\u6709\u6807\u5fd7 \u539f\u56e0 <code>--maximum-dead-containers</code> \u4e00\u65e6\u65e7\u7684\u65e5\u5fd7\u5b58\u50a8\u5728\u5bb9\u5668\u7684\u4e0a\u4e0b\u6587\u4e4b\u5916\u5c31\u4f1a\u88ab\u5f03\u7528 <code>--maximum-dead-containers-per-container</code> \u4e00\u65e6\u65e7\u7684\u65e5\u5fd7\u5b58\u50a8\u5728\u5bb9\u5668\u7684\u4e0a\u4e0b\u6587\u4e4b\u5916\u5c31\u4f1a\u88ab\u5f03\u7528 <code>--minimum-container-ttl-duration</code> \u4e00\u65e6\u65e7\u7684\u65e5\u5fd7\u5b58\u50a8\u5728\u5bb9\u5668\u7684\u4e0a\u4e0b\u6587\u4e4b\u5916\u5c31\u4f1a\u88ab\u5f03\u7528"},{"location":"cloud/k8s/garbage_collect.html#_10","title":"\u53c2\u8003\u6587\u6863","text":"<ol> <li>\u5783\u573e\u6536\u96c6 v.31 | Kubernetes.</li> <li>\u8282\u70b9\u538b\u529b\u9a71\u9010 v.31 | Kubernetes</li> </ol>"},{"location":"cloud/k8s/go_client.html","title":"K8s","text":"<p>\u53c2\u8003\uff1a</p> <ol> <li>k8s-club/articles/Informer\u673a\u5236 - \u6982\u8ff0</li> </ol>"},{"location":"cloud/k8s/go_client.html#k8sioclient-go","title":"k8s.io/client-go","text":"<p>client-go \u7684 ListWatch/informer \u63a5\u53e3\uff0c \u9ed8\u8ba4\u5df2\u7ecf\u8bbe\u7f6e\u4e86 <code>ResourceVersion=0</code>\uff0c\u8d70 apiserver \u7684\u7f13\u5b58\uff0c\u5426\u5219\u4f1a\u8d70 etcd \u83b7\u53d6\uff1b</p> <p></p>"},{"location":"cloud/k8s/go_client.html#informer","title":"Informer","text":"<p><code>Informer</code>\u88ab\u8bbe\u8ba1\u5b9e\u73b0\u4e3a\u4e00\u4e2a\u4f9d\u8d56<code>Kubernetes List/Watch API</code>\u3001<code>\u53ef\u76d1\u542c\u4e8b\u4ef6\u5e76\u89e6\u53d1\u56de\u8c03\u51fd\u6570</code>\u7684<code>\u4e8c\u7ea7\u7f13\u5b58</code>\u5de5\u5177\u5305\u3002</p> <ul> <li>\u66f4\u5feb\u5730\u8fd4\u56de<code>List/Get</code>\u8bf7\u6c42\u7684\u7ed3\u679c\u3001\u51cf\u5c11\u5bf9<code>Kubenetes API</code>\u7684\u76f4\u63a5\u8c03\u7528</li> </ul> <p>Informer<code>\u5b9e\u4f8b\u7684</code>Lister()<code>\u65b9\u6cd5\uff0c</code>List/Get Kubernetes<code>\u4e2d\u7684</code>Object<code>\u65f6\uff0c</code>Informer<code>\u4e0d\u4f1a\u53bb\u8bf7\u6c42</code>Kubernetes API\uff0c\u76f4\u63a5\u67e5\u627e<code>\u7f13\u5b58</code>\u5728\u672c\u5730\u5185\u5b58\u4e2d\u7684\u6570\u636e\u3002</p> <p>\u5c01\u88c5<code>list-watch API</code>\uff0c\u7528\u6237\u53ea\u9700\u8981\u6307\u5b9a\u8d44\u6e90\uff0c\u7f16\u5199\u4e8b\u4ef6\u5904\u7406\u51fd\u6570\uff0c<code>AddFunc</code>,<code>UpdateFunc</code>\u548c<code>DeleteFunc</code>\u7b49\u3002</p> <ul> <li>\u9488\u5bf9 Update \u573a\u666f\uff0c\u53ef\u4ee5\u62ff\u5230 old \u548c new \u7684\u5bf9\u8c61\uff1b</li> <li>list-watch \u5982\u679c\u51fa\u9519\u540e\uff0c\u4f1a\u518d\u6b21\u8c03\u7528 list-watch\uff1b</li> </ul> <p>\u4e8c\u7ea7\u7f13\u5b58<code>DeltaFIFO</code>\u548c<code>Indexer(LocalStore)</code></p> <ul> <li><code>DeltaFIFO</code>\u7528\u6765\u5b58\u50a8<code>Watch API</code>\u8fd4\u56de\u7684\u5404\u79cd\u4e8b\u4ef6 </li> <li><code>LocalStore</code>\u53ea\u4f1a\u88ab<code>Lister</code>\u7684<code>List/Get</code>\u65b9\u6cd5\u8bbf\u95ee</li> </ul>"},{"location":"cloud/k8s/go_client.html#sharedindexinformer","title":"sharedIndexInformer","text":"<p>\u5b9e\u73b0\u4e86 SharedIndexInformer \u63a5\u53e3\u3002</p> <p>\u4e00\u4e2a\u8d44\u6e90\u53ea\u5b9e\u4f8b\u5316\u4e00\u4e2aInformer\uff0c\u540e\u7eed\u6240\u6709\u7684Listener\u90fd\u5171\u4eab\u8fd9\u4e00\u4e2aInformer\u5b9e\u4f8b\uff0c\u901a\u8fc7 \u5de5\u5382\u6a21\u5f0f+map+lock \u5b9e\u73b0\u3002</p>"},{"location":"cloud/k8s/go_client.html#reflector","title":"Reflector","text":"<p>\u8fdc\u7aef\uff08APiServer\uff09\u548c\u672c\u5730\uff08DeltaFIFO\u3001Indexer\u3001Listener\uff09\u4e4b\u95f4\u6570\u636e\u540c\u6b65\u903b\u8f91\u7684\u6838\u5fc3\uff0c\u901a\u8fc7ListAndWatch\u65b9\u6cd5\u6765\u5b9e\u73b0\u3002</p> <p>\u6d41\u7a0b <code>sharedIndexInformer-&gt;controller-&gt;reflector</code>\uff0c\u56e0\u6b64\u4e00\u4e2ainformer\u5c31\u6709\u4e00\u4e2aReflector\u3002</p> <ul> <li>ListWatcher</li> <li>store(DeltaFIFO)</li> </ul>"},{"location":"cloud/k8s/go_client.html#list-watch","title":"List-Watch\u673a\u5236","text":"<p>Etcd\u5b58\u50a8\u96c6\u7fa4\u7684\u6570\u636e\u4fe1\u606f\uff0capiserver\u4f5c\u4e3a\u7edf\u4e00\u5165\u53e3\uff0c\u4efb\u4f55\u5bf9\u6570\u636e\u7684\u64cd\u4f5c\u90fd\u5fc5\u987b\u7ecf\u8fc7apiserver\u3002</p> <ul> <li>api server \u5bf9\u5916\u63d0\u4f9b HTTP \u670d\u52a1\uff1b</li> <li>\u5ba2\u6237\u7aef\uff08kubelet/scheduler/controller-manager\uff09\u901a\u8fc7<code>list-watch</code>\u76d1\u542c\u8d44\u6e90\u7684<code>create, update, delete</code>\u4e8b\u4ef6\uff1b</li> </ul> <p>List\uff1a\u5168\u91cf\u6570\u636e</p> <p>Watch\uff1a\u589e\u91cf\u6570\u636e\uff0c\u540c\u65f6\u5b58\u5728 HTTP 1.1 \u548c Websocket \u7684\u5b9e\u73b0</p> <ul> <li>Http Transfer-Encoding: chunked\uff0c\u901a\u8fc7 <code>curl</code> \u8fdb\u884c watch\uff1b</li> </ul> <p>\u5982\u4f55\u4fdd\u8bc1\u540c\u4e00\u4e2a\u8d44\u6e90\u7684\u53d8\u5316\u4e8b\u4ef6\u7684\u987a\u5e8f\u6027\uff1f</p> <ul> <li>TODO\uff1a\u57fa\u4e8e etcd \u7684 watch \u673a\u5236\uff0c\u7531 etcd \u4fdd\u8bc1\uff1f</li> </ul>"},{"location":"cloud/k8s/go_client.html#deltafifo","title":"DeltaFIFO","text":"<p>\u5b57\u6bb5 knownObjects \u4e3a Indexer \u5b9e\u4f8b\uff08cache \u7ed3\u6784\u4f53\uff09</p> <p>Reflector\u4e2d\u5b58\u50a8\u5f85\u5904\u7406obj(\u786e\u5207\u8bf4\u662fDelta)\u7684\u5730\u65b9\uff0c\u5b58\u50a8\u672c\u5730\u6700\u65b0\u7684\u6570\u636e\uff0c\u63d0\u4f9b\u6570\u636e Add\u3001Delete\u3001Update\u65b9\u6cd5\uff0c\u4ee5\u53ca\u6267\u884c relist \u7684Replace\u65b9\u6cd5</p> <ul> <li>\u6bcf\u4e00\u4e2aDelta\u5305\u542b\u4e00\u4e2a\u64cd\u4f5c\u7c7b\u578b\uff08\"Added\"/\"Updated\"/\"Deleted\"/\"Replaced\"/\"Sync\"\uff09\u548c\u64cd\u4f5c\u5bf9\u8c61</li> </ul>"},{"location":"cloud/k8s/go_client.html#indexer","title":"Indexer","text":"<p>\u5b58\u50a8\u7c7b\u578b\u7684\u63a5\u53e3Store \u548c \u7d22\u5f15\u7c7b\u578b\u7684\u63a5\u53e3\uff0c\u5176\u5b9e\u73b0\u7c7b\u4e3a <code>cache</code>\u3002</p> <p>\u672c\u5730\u6700\u5168\u7684\u6570\u636e\u5b58\u50a8\uff0c\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\u548c\u6570\u636e\u7d22\u5f15\u529f\u80fd\u3002</p> <p>\u7d22\u5f15\u539f\u7406\u89e3\u6790\uff1a</p> <pre><code>Indexers: type Indexers map[string]IndexFunc\nIndexFunc: type IndexFunc func(obj interface{}) ([]string, error)\nIndices: type Indices map[string]Index\nIndex: type Index map[string]sets.String\n\n// cache struct \u4e2d\u6839\u636e obj \u8ba1\u7b97 key\uff0c\u4e00\u822c\u91c7\u7528 namespaced/name\uff08\u5bf9\u4e8e\u540c\u4e00\u79cdResource\uff0c\u5176\u552f\u4e00\uff09\nkeyFunc: type KeyFunc func(obj interface{}) (string, error)\n</code></pre> <pre><code>graph LR\nIndexers --\u6839\u636e name \u83b7\u53d6\u7d22\u5f15\u51fd\u6570--&gt; IndexFunc\nIndexFunc --\"\u6839\u636e (obj interface{})\u8ba1\u7b97 indexValues\"--&gt; indexValue[\"[]string\"]\n\nKeyFunc --\"\u6839\u636eobj \u8ba1\u7b97 key\uff08\u552f\u4e00\uff09\"--&gt; string --map \u6839\u636ekey\u83b7\u53d6 obj--&gt; obj\n\nIndices --\u6839\u636e\u540d\u79f0\u83b7\u53d6\u7d22\u5f15\u96c6\u5408--&gt; Index\nIndex --\"\u6839\u636e indexValue \u83b7\u53d6obj key\"--&gt; sets.string\n\n</code></pre>"},{"location":"cloud/k8s/go_client.html#listener","title":"Listener","text":"<p><code>AddEventHandler</code> \u6216 <code>AddEventHandlerWithResyncPeriod</code> \u6ce8\u518c listener\uff0c<code>sharedIndexInfomer</code>\u4e2d\u7684<code>sharedProcessor</code>\u4f1a\u5c06\u5176\u6dfb\u52a0\u5230<code>listeners</code>\u548c<code>syncingListeners</code>\u3002DeltaType<code>\u548c</code>syncingListeners` \u5217\u8868\u4e2d\uff0c\u5f53 HandleDeltas \u5904\u7406DeltaFIFO\u4e2d\u7684Delta\u65f6\uff0c\u8fdb\u884c\u4e8b\u4ef6\u6d3e\u53d1\uff1a</p> <ul> <li>\u6d3e\u53d1\u7ed9<code>listeners</code>\uff1aDeltaType\u4e3a<code>Added</code>\u3001<code>Updated</code>\u3001<code>Deleted</code>\u3001\u65b0\u65e7\u8d44\u6e90\u7248\u672c\u53f7\u4e0d\u4e00\u81f4\u7684<code>Replaced</code></li> <li>\u6d3e\u53d1\u7ed9<code>syncingListeners</code>\uff1aDeltaType\u4e3a<code>Sync</code>\u3001\u65b0\u65e7\u8d44\u6e90\u7248\u672c\u53f7\u4e00\u81f4\u7684<code>Replaced</code></li> </ul>"},{"location":"cloud/k8s/go_client.html#controller","title":"Controller","text":""},{"location":"cloud/k8s/go_client.html#workqueue","title":"workqueue","text":"<p>Listener\u901a\u8fc7\u56de\u8c03\u51fd\u6570\u63a5\u6536\u5230\u5bf9\u5e94\u7684event\u4e4b\u540e\uff0c\u9700\u8981\u5c06\u5bf9\u5e94\u7684obj-key\u653e\u5165workqueue\u4e2d\uff0c\u4ece\u800c\u65b9\u4fbf\u591a\u4e2aworker\u53bb\u6d88\u8d39\u3002</p> <ul> <li><code>queue\u3001dirty\u3001processing</code>\u4e09\u4e2a\u7ed3\u6784\uff0c\u5176\u4e2dqueue\u4e3aslice\u7c7b\u578b\u4fdd\u8bc1\u6709\u5e8f\u6027\uff0cdirty \u4e0e processing \u4e3a map\uff0c\u63d0\u4f9b\u53bb\u91cd\u5c5e\u6027\u3002</li> </ul> <p>\u4f18\u52bf\uff1a</p> <ul> <li>\u5e76\u53d1\uff1a\u652f\u6301\u591a\u751f\u4ea7\u8005\u3001\u591a\u6d88\u8d39\u8005</li> <li>\u53bb\u91cd\uff1a\u7531dirty\u4fdd\u8bc1\u4e00\u6bb5\u65f6\u95f4\u5185\u7684\u4e00\u4e2a\u5143\u7d20\u53ea\u4f1a\u88ab\u5904\u7406\u4e00\u6b21</li> <li>\u6709\u5e8f\uff1aFIFO\u7279\u6027\uff0c\u4fdd\u8bc1\u5904\u7406\u987a\u5e8f\uff0c\u7531queue\u6765\u63d0\u4f9b</li> <li>\u6807\u8bb0\uff1a\u6807\u793a\u5143\u7d20\u662f\u5426\u6b63\u5728\u88ab\u5904\u7406\uff0c\u7531processing\u6765\u63d0\u4f9b</li> <li>\u5ef6\u8fdf\uff1a\u652f\u6301\u5ef6\u8fdf\u961f\u5217\uff0c\u5ef6\u8fdf\u5c06\u5143\u7d20\u653e\u5165\u961f\u5217</li> <li>\u9650\u901f\uff1a\u652f\u6301\u9650\u901f\u961f\u5217\uff0c\u5bf9\u653e\u5165\u7684\u5143\u7d20\u8fdb\u884c\u901f\u7387\u9650\u5236</li> <li>\u901a\u77e5\uff1aShutDown\u544a\u77e5\u8be5workqueue\u4e0d\u518d\u63a5\u6536\u65b0\u7684\u5143\u7d20</li> </ul>"},{"location":"cloud/k8s/go_client.html#informer_1","title":"Informer \u4e2d\u7684\u6570\u636e\u6d41\u5411","text":"<p>Apiserver\u4fa7\u4e3a\u6700\u6743\u5a01\u7684\u6570\u636e\u3001DeltaFIFO\u4e3a\u672c\u5730\u6700\u65b0\u7684\u6570\u636e\u3001Indexer\u4e3a\u672c\u5730\u6700\u5168\u7684\u6570\u636e\u3001Listener\u4e3a\u7528\u6237\u4fa7\u505a\u903b\u8f91\u7528\u7684\u6570\u636e\u3002</p>"},{"location":"cloud/k8s/go_client.html#_1","title":"\u8fdc\u7aef\u901a\u8def","text":"<p>\u8fdc\u7aef(ApiServer) \u21d4 \u672c\u5730(DeltaFIFO\u3001Indexer\u3001Listener)</p> <p>Reflector\u7684<code>ListAndWatch</code>\u65b9\u6cd5\u5c06 ApiServer \u4fa7\u7684 obj \u540c\u6b65\u5230\u672c\u5730 DeltaFIFO \u4e2d</p> <ul> <li>\u901a\u8fc7<code>List</code>\u884c\u4e3a\u4ea7\u751f\u7684\u540c\u6b65\u884c\u4e3a\uff0c\u8fd9\u7c7bevent\u7684 DeltaType \u4e3a<code>Replaced</code>\uff0c\u540c\u65f6\u53ea\u6709\u5728 Reflector \u521d\u59cb\u542f\u52a8\u65f6\u624d\u4f1a\u4ea7\u751f\uff1b</li> <li>\u901a\u8fc7<code>Watch</code>\u884c\u4e3a\u4ea7\u751f\u7684\u540c\u6b65\u884c\u4e3a\uff0c\u5bf9\u4e8ewatch\u5230\u7684<code>Added\u3001Modified\u3001Deleted</code>\u7c7b\u578b\u7684event\uff0c\u5bf9\u5e94\u7684DeltaType\u4e3a<code>Added\u3001Updated\u3001Deleted</code>\u3002</li> </ul> <p>\u5f53\u5bf9\u5e94event\u7684Delta\u653e\u5165DeltaFIFO\u4e4b\u540e\uff0c\u5c31\u901a\u8fc7<code>HandleDeltas</code> \u65b9\u6cd5\uff0c\u5c06\u5bf9\u5e94\u7684 Delta \u66f4\u65b0\u5230 Indexer \u548c Listener \u4e0a\u3002</p>"},{"location":"cloud/k8s/go_client.html#_2","title":"\u672c\u5730\u901a\u8def","text":"<p>\u672c\u5730(DeltaFIFO\u3001Indexer\u3001SyncingListener\uff09\u4e4b\u95f4\u540c\u6b65</p> <p>\u901a\u8fc7Reflector\u7684<code>ListAndWatch</code>\u65b9\u6cd5\u4e2d\u8fd0\u884c\u4e00\u4e2agoroutine\u6765\u6267\u884c\u5b9a\u671f\u7684<code>Resync</code>\u64cd\u4f5c\u3002</p> <ul> <li>\u901a\u8fc7 <code>ShouldResync</code>\u51fd\u6570\u8ba1\u7b97\u51fa<code>syncingListener</code>\uff0c\u4e4b\u540e\u5176\u4e2d\u7684 store.Resync \u4ece Indexer \u62c9\u4e00\u904d\u6240\u6709objs\u5230 DeltaFIFO\uff0c\u5176\u4e2d\u7684Delta\u4e3a<code>Sync</code>\u72b6\u6001\uff1b</li> <li>\u5982\u679c DeltaFIFO \u7684items\u4e2d\u5b58\u5728\u8be5obj\uff0c\u5c31\u4e0d\u4f1a\u6dfb\u52a0\u8be5obj\u7684 sync delta\u3002</li> </ul> <p>\u4e4b\u540e<code>HandleDeltas</code>\u5c31\u4f1a\u540c\u6b65DeltaFIFO\u4e2d\u7684Sync Delta\u7ed9 <code>syncingListeners</code>\u548c <code>Indexer</code>\u3002</p> <p>\u5f53\u7136\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u522b\u7684\u72b6\u6001\u7684delta\u4f1a\u88ab\u901a\u77e5\u7ed9\u6240\u6709\u7684listener\u548cIndexer\u3002</p>"},{"location":"cloud/k8s/go_client.html#informerresync","title":"Informer\u4e2d\u7684resync","text":"<p>k8s-club/articles/Informer\u673a\u5236 - Resync.md at main \u00b7 k8s-club/k8s-club (github.com)</p> <p><code>Informer</code>\u548c<code>Kubernetes</code>\u4e4b\u95f4\u6ca1\u6709<code>resync</code>\u673a\u5236\uff0c\u4f46<code>Informer</code>\u5185\u90e8\u7684\u8fd9\u4e24\u7ea7\u7f13\u5b58\u4e4b\u95f4\u5b58\u5728<code>resync</code>\u673a\u5236\u3002</p> <ul> <li><code>resync</code>\u5c06 <code>Indexer(LocalStore)</code> \u4e2d\u7684\u5bf9\u8c61\uff0c\u5168\u90e8\u53d1\u9001\u5230 <code>DeltaFIFO</code> \u7684\u961f\u5217\u4e2d\uff1b</li> </ul> <p>\u51e0\u79cd resync \u65f6\u95f4\u53c2\u6570\u8bbe\u7f6e\uff1a</p> <ul> <li><code>NewSharedInformerFactory</code> \u4e2d\u7684 <code>defaultResync</code> \u53c2\u6570</li> <li><code>NewSharedInformerFactoryWithOptions</code>\u4e2d\u9488\u5bf9\u4e0d\u540c\u7684 Resource \u7684 Resync \u65f6\u95f4</li> <li>\u4e0d\u540c\u7684 Listener\uff08eventHandler\uff09\u81ea\u5b9a\u4e49\u5982\u4e0b\u6240\u793a\u7684 resyncPeriod</li> </ul> <pre><code>// 1. defaultResync -&gt; 200 ms\nfactory := informers.NewSharedInformerFactory(kubeClient, 200 * time.Millisecond)\n\n// 2. Pod Resync -&gt; 1 s\nsharedInformerFactory := informers.NewSharedInformerFactoryWithOptions(kubeClient, 200*time.Millisecond,\n    informers.WithCustomResyncConfig(map[metav1.Object]time.Duration{\n        &amp;v1.Pod{}: 1 * time.Second,\n    }))\n\n// 3. event handler resync period\npodInformer.Informer().AddEventHandlerWithResyncPeriod(cache.ResourceEventHandlerFuncs{\n    AddFunc:    nil,\n    UpdateFunc: nil,\n    DeleteFunc: nil,\n}, 3 * time.Second)\n</code></pre>"},{"location":"cloud/k8s/go_client.html#resync","title":"Resync \u6d41\u7a0b","text":"<p>\u4e0b\u56fe\u5c55\u793a\u4e86\u6574\u4e2a informer \u673a\u5236\u7684\u6d41\u7a0b\uff0c\u5bf9\u4e8e ShardIndexInformer \u800c\u8a00\uff0c\u4e3b\u8981\u6d89\u53ca 3 \u4e2a\u7ec4\u4ef6\uff1a</p> <ol> <li>Controller\uff1a\u4e00\u65b9\u9762\u4f7f\u7528  Reflector\u4e2d\u7684ListerWatcher \u4ece ApiServer \u62ff\u53d6\u6700\u65b0\u7684\u4e8b\u4ef6\uff08\u5bf9\u8c61\uff09\uff0c\u5e76\u653e\u5165 DeltaFIFO \u4e2d\uff0c\u53e6\u4e00\u65b9\u9762\u4e0d\u505c\u7684 POP DeltaFIFO \u4e2d\u7684\u5bf9\u8c61\u3002\u6240\u6709 POP \u51fa\u6765\u7684 Deltas \u4e8b\u4ef6\u90fd\u4f1a\u88ab ShardIndexInformer \u5185\u7684 HandleDeltas \u5904\u7406\u3002</li> <li>Indexer\uff1a\u672c\u5730\u5e26\u7d22\u5f15\u7684\u5b58\u50a8\uff0c\u901a\u8fc7 list &amp; watch \u673a\u5236\u5b9e\u65f6\u540c\u6b65 ApiServer \u6d4b\u66f4\u65b0\u7684\u6570\u636e\u3002\u901a\u8fc7\u8bbf\u95ee Indexer \u800c\u4e0d\u662f\u76f4\u63a5\u8bbf\u95ee ApiServer\uff0c\u4e00\u65b9\u9762\u80fd\u591f\u6781\u5927\u7684\u51cf\u8f7b ApiServer \u7684\u8bbf\u95ee\u538b\u529b\uff0c\u53e6\u4e00\u65b9\u9762\u80fd\u591f\u52a0\u5feb\u6570\u636e\u8bbf\u95ee\u901f\u5ea6\u3002</li> <li>sharedProcessor\uff1a\u7ef4\u62a4\u8be5 Infromer \u4e0a\u6240\u6709\u6dfb\u52a0\u7684 Listener\uff0c\u5e76\u8d1f\u8d23\u5c06\u4ece DeltaFIFO \u4e2d POP \u51fa\u7684\u4e8b\u4ef6\u901a\u77e5\u7ed9\u6240\u6709\u7684 Listener\u3002\u8fd9\u91cc\u6709 2 \u79cd\u4e8b\u4ef6\u901a\u77e5\u65b9\u5f0f\uff0c\u5bf9\u4e8e Sync \u7c7b\u578b\u7684\u4e8b\u4ef6\u53ea\u901a\u77e5\u7ed9\u9700\u8981 syncing \u7684 Listener\u3002\u5bf9\u4e8e\u5176\u4f59\u7c7b\u578b\u7684\u4e8b\u4ef6\uff0c\u901a\u77e5\u7ed9\u6240\u6709\u7684 Listener\u3002\uff08NOTE\uff1a\u8fd9\u91cc\u7684 Sync \u4e8b\u4ef6\u662f\u6307 old \u548c new \u5bf9\u8c61\u7684 resourceVersion\u4e00\u81f4\uff0c\u5305\u62ec Sync/Replaced Delta \u7c7b\u578b\uff09</li> </ol> <p></p> <p>\u6574\u4e2a resync \u7684\u6d41\u7a0b\uff0c\u4ece\u903b\u8f91\u4e0a\u6765\u8bf4\u5206\u4e3a\u5982\u4e0a\u56fe\u6240\u793a\u76842\u5c42\u5faa\u73af\uff0c\u5176\u4e2d\u7b2c\u4e8c\u5c42\u5faa\u73af\u901a\u8fc7\u7b2c\u4e00\u5c42\u5faa\u73af\u6765\u9a71\u52a8\uff0c\u5177\u4f53\u5982\u4e0b\uff1a</p> <p>\u7b2c\u4e00\u5c42\u5faa\u73af</p> <p>\u5728 Controller\uff08Reflector\uff09\u7684 ListAndWatch \u5185\u90e8\u5468\u671f\u6027\u6267\u884c\uff0c\u5177\u4f53\u7684\u6267\u884c\u5468\u671f <code>resyncCheckPeriod</code> \u901a\u8fc7 NewSharedInformerFactory \u4e3a\u6240\u6709\u8d44\u6e90\u7684 informer \u8bbe\u7f6e\u9ed8\u8ba4\u503c\uff0c\u53ef\u9009\u7684\u901a\u8fc7 NewSharedInformerFactoryWithOptions \u6765\u4e3a\u67d0\u4e2a\u8d44\u6e90\u8bbe\u7f6e\u7279\u5b9a\u7684\u503c\u3002</p> <ul> <li>\u5b9a\u671f\u904d\u5386\u6240\u6709 listener \u6765\u67e5\u770b\u662f\u5426\u9700\u8981\u771f\u6b63\u542f\u52a8 resync \u6d41\u7a0b\uff0c\u9a71\u52a8\u7b2c\u4e8c\u5c42\u5faa\u73af\uff08\u53ea\u8981\u4e00\u4e2a listener \u9700\u8981 resync\uff0c\u5219\u9a71\u52a8\uff09\uff1b</li> <li>\u6bcf\u4e2a listener \u90fd\u6709\u81ea\u5df1\u7684 <code>resyncPeriod</code>\u65f6\u95f4\uff08\u9ed8\u8ba4\u4e0d\u586b\u7b49\u4e8e<code>NewSharedInformerFactory</code>\u7684defaultResync\uff09\uff1b</li> </ul> <p>\u7b2c\u4e8c\u5c42\u5faa\u73af</p> <p></p> <ul> <li>\u4ece Indexer \u4e2d\u904d\u5386\u6240\u6709\u7684 Obj\uff0c\u5e76\u5c06\u5f53\u524d\u6ca1\u5728DeltaFIFO \u4e2d\u51fa\u73b0\u7684 Obj \u653e\u5165 DeltaFIFO \u4e2d</li> <li>HandleDeltas \u4e0d\u505c\u7684\u5904\u7406\u4ece DeltaFIFO \u4e2d POP \u51fa Deltas</li> <li>\u4f7f\u7528 OnUpdate \u65b9\u5f0f\uff0c\u66f4\u65b0\u81f3 Indexer \uff08\u9700\u8981\u8bf4\u660e\uff0c\u8fd9\u4e2aOnUpdate\u662f\u6ca1\u6709\u526f\u4f5c\u7528\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u65e0\u9650\u91cd\u5165\uff0c\u7b26\u5408 resync \u7684\u573a\u666f\uff09</li> <li>\u5c06 Sync \u4e8b\u4ef6\u5206\u53d1\u7ed9\u5bf9\u5e94\u9700\u8981\u540c\u6b65\u7684 Listener\u3002\u8fd9\u90e8\u5206\u7531 sharedProcessor \u6765\u8d1f\u8d23\u5b8c\u6210\uff0c\u5176\u5185\u90e8\u4f1a\u7ef4\u62a4\u6240\u6709 listener \u5f53\u524d\u662f\u5426\u9700\u8981\u540c\u6b65\u7684\u72b6\u6001\uff08\u8fd9\u4e2a\u72b6\u6001\u8ba1\u7b97\u5728\u7b2c\u4e00\u5c42\u5faa\u73af\u4e2d\u5b8c\u6210\uff09\u3002\u5982\u56fe\u4e2d\u7684 Listener-1\uff0cListener-2\u3002\uff08\u8bf4\u660e\uff1aSync \u4e8b\u4ef6\u6700\u7ec8\u53cd\u5e94\u5230 Listener \u7684 <code>OnUpdate</code> eventHandler \u4e2d\uff09</li> </ul>"},{"location":"cloud/k8s/go_client.html#resync_1","title":"\u4e0d\u540c resync \u65f6\u95f4\u8bf4\u660e","text":"<p>resyncCheckPeriod \uff1areflector \u5b9a\u671f\u68c0\u67e5\u662f\u5426\u9700\u8981\u540c\u6b65\u7684\u65f6\u95f4\u95f4\u9694\uff1b</p> <p>resyncPeriod \uff1a\u6bcf\u4e2a listener \u7528\u4e8e\u5224\u65ad\u81ea\u5df1\u662f\u5426\u9700\u8981\u540c\u6b65\u7684\u65f6\u95f4\u95f4\u9694\uff1b</p> <p>\u7ea6\u675f\uff1a</p> <ul> <li>resyncPeriod \u4e0d\u80fd\u5c0f\u4e8e 1s\uff1b</li> <li>resyncPeriod \u6700\u7ec8\u7684\u7ed3\u679c &gt;= resyncCheckPeriod\uff1b</li> </ul>"},{"location":"cloud/k8s/go_client.html#resync_2","title":"resync \u7684\u7528\u9014","text":"<p>\u9488\u5bf9\u573a\u666f\uff1a\u8bf7\u6c42\u5916\u56f4\u7cfb\u7edf\uff0c\u5e76\u5c06\u5916\u56f4\u7cfb\u7edf\u7684\u72b6\u6001\u63a8\u52a8\u5230\u76ee\u6807\u72b6\u6001</p> <ul> <li>\u5916\u56f4\u7cfb\u7edf\u7684\u53d8\u66f4\uff0cK8s\u4e0d\u4f1a\u611f\u77e5\uff0c\u53ea\u80fd\u901a\u8fc7\u8f6e\u8be2\uff08Resync\uff09\u5bf9\u8c61\uff0c\u5e76\u67e5\u770b\u5916\u56f4\u7cfb\u7edf\u7684\u72b6\u6001\u4fdd\u8bc1\u4e00\u81f4\uff1b</li> <li>\u4f8b\u5982\u5b9a\u4e49CRD\u63cf\u8ff0\u4e91\u78c1\u76d8\uff0c\u4f46\u88ab\u7528\u6237\u65e0\u610f\u5220\u6389\uff0c\u901a\u8fc7 Resync \u673a\u5236\uff0c\u4fdd\u8bc1\u518d\u67e5\u770b\u5bf9\u8c61\u65f6\uff0c\u53d1\u73b0\u5176\u5bf9\u5e94\u78c1\u76d8\u4e0d\u5728\uff1b</li> </ul> <ul> <li>\u8ba9 listener \u80fd\u591f\u5b9a\u671f reconcile Indexer \u5185\u7684\u6240\u6709\u4e8b\u4ef6\uff0c\u6765\u4fdd\u8bc1\u5bf9\u5e94\u4e8b\u4ef6\u5173\u5fc3\u7684\u5bf9\u8c61\uff08\u53ef\u80fd\u662f\u7cfb\u7edf\u5185\uff0c\u4e5f\u53ef\u80fd\u662f\u7cfb\u7edf\u5916\uff09\u72b6\u6001\u90fd\u662f\u9884\u671f\u72b6\u6001\uff1b</li> <li>\u5bf9\u4e8e\u5916\u56f4\u7cfb\u7edf\u7684\u4eba\u4e3a\u4fee\u6539\uff0c\u5b9a\u65f6 resync \u53ef\u4ee5\u4fdd\u8bc1\u5916\u56f4\u7cfb\u7edf\u72b6\u6001\u80fd\u591f\u4e00\u76f4\u4fdd\u6301\u4e0e listener \u5185\u7684\u9884\u671f\u72b6\u6001\u4e00\u81f4\uff1b</li> </ul>"},{"location":"cloud/k8s/go_client.html#k8sioapimachinery","title":"k8s.io/apimachinery","text":"<p>apimachinery  \u89e3\u51b3\u7684\u662f kubernetes \u7684 API Object \u7684 Scheme, typing, encoding, decoding, and conversion\u95ee\u9898\u3002</p> <p>This library is a shared dependency for servers and clients to work with Kubernetes API infrastructure without direct type dependencies. Its first consumers are <code>k8s.io/kubernetes</code>, <code>k8s.io/client-go</code>, and <code>k8s.io/apiserver</code>.</p>"},{"location":"cloud/k8s/go_client.html#sigsk8siocontroller-runtime","title":"sigs.k8s.io/controller-runtime","text":"<p>Repo for the controller-runtime subproject of kubebuilder (sig-apimachinery)</p> <p>a set of go libraries for building Controllers,  leveraged by Kubebuilder and Operator SDK.</p> <p></p> <ul> <li>Controller \u4f1a\u5148\u5411 Informer \u6ce8\u518c\u7279\u5b9a\u8d44\u6e90\u7684 eventHandler\uff1b</li> <li>Cache \u4f1a\u542f\u52a8 Informer\uff0cInformer \u5411 ApiServer \u53d1\u51fa\u8bf7\u6c42\uff0c\u5efa\u7acb\u8fde\u63a5\uff1b</li> <li>Informer \u68c0\u6d4b\u5230\u6709\u8d44\u6e90\u53d8\u52a8\u540e\uff0c\u4f7f\u7528 Controller \u6ce8\u518c\u8fdb\u6765\u7684 eventHandler \u5224\u65ad\u662f\u5426\u63a8\u5165\u961f\u5217\u4e2d\uff1b</li> <li>\u5f53\u961f\u5217\u4e2d\u6709\u5143\u7d20\u88ab\u63a8\u5165\u65f6\uff0cController \u4f1a\u5c06\u5143\u7d20\u53d6\u51fa\uff0c\u5e76\u6267\u884c\u7528\u6237\u4fa7\u7684 Reconciler\uff1b</li> </ul> <pre><code>ctrl.NewManager(controllers.GetConfigOrDieWithQPSAndBurst(kubeClientQPS, kubeClientBurst), ctrl.Options{\n    Scheme:                  scheme,\n    MetricsBindAddress:      metricsAddr,\n    LeaderElection:          enableLeaderElection,\n    LeaderElectionNamespace: leaderElectionNamespace,\n    LeaderElectionID:        \"dataset.data.fluid.io\",\n    Port:                    9443,\n    NewCache:                cache.BuilderWithOptions(cache.Options{\n        Scheme:            scheme,\n        // \u9488\u5bf9 CronJob \uff0c\u53ealist-watch \u7279\u5b9a label\u7684 CronJob\n        SelectorsByObject: cache.SelectorsByObject{\n            &amp;batchv1.CronJob{}: cache.ObjectSelector{Label: labels.SelectorFromSet(labels.Set{\n                common.JobPolicy: common.CronPolicy,\n            })},\n    }),\n    NewClient:               controllers.NewFluidControllerClient,\n})\n</code></pre>"},{"location":"cloud/k8s/go_client.html#cache","title":"Cache","text":"<p>\u8d1f\u8d23\u5728 Controller \u8fdb\u7a0b\u91cc\u9762\u6839\u636e Scheme \u540c\u6b65 Api Server \u4e2d\u6240\u6709\u8be5 Controller \u5173\u5fc3 GVKs \u7684 GVRs\uff0c\u5176\u6838\u5fc3\u662f GVK -&gt; Informer \u7684\u6620\u5c04\uff0cInformer \u4f1a\u8d1f\u8d23\u76d1\u542c\u5bf9\u5e94 GVK \u7684 GVRs \u7684\u521b\u5efa/\u5220\u9664/\u66f4\u65b0\u64cd\u4f5c\uff0c\u4ee5\u89e6\u53d1 Controller \u7684 Reconcile \u903b\u8f91\u3002</p>"},{"location":"cloud/k8s/go_client.html#controller_1","title":"Controller","text":"<p>\u811a\u624b\u67b6\u6587\u4ef6\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5b9e\u73b0 Reconcile \u65b9\u6cd5\u5373\u53ef\u3002</p>"},{"location":"cloud/k8s/go_client.html#clients","title":"Clients","text":"<p>\u901a\u8fc7\u8be5 Clients \u5bf9\u67d0\u4e9b\u8d44\u6e90\u7c7b\u578b\u8fdb\u884c\u521b\u5efa/\u5220\u9664/\u66f4\u65b0\uff0c\u67e5\u8be2\u529f\u80fd\u5b9e\u9645\u67e5\u8be2\u662f\u672c\u5730\u7684 Cache\uff0c\u5199\u64cd\u4f5c\u76f4\u63a5\u8bbf\u95ee Api Server\u3002</p>"},{"location":"cloud/k8s/go_client.html#index","title":"Index","text":"<p>\u7531\u4e8e Controller \u7ecf\u5e38\u8981\u5bf9 Cache \u8fdb\u884c\u67e5\u8be2\uff0cKubebuilder \u63d0\u4f9b Index utility \u7ed9 Cache \u52a0\u7d22\u5f15\u63d0\u5347\u67e5\u8be2\u6548\u7387\u3002</p>"},{"location":"cloud/k8s/go_client.html#ownerreference","title":"OwnerReference","text":"<p>K8s GC \u5728\u5220\u9664\u4e00\u4e2a\u5bf9\u8c61\u65f6\uff0c\u4efb\u4f55 ownerReference \u662f\u8be5\u5bf9\u8c61\u7684\u5bf9\u8c61\u90fd\u4f1a\u88ab\u6e05\u9664\uff0c\u4e0e\u6b64\u540c\u65f6\uff0cKubebuidler \u652f\u6301\u6240\u6709\u5bf9\u8c61\u7684\u53d8\u66f4\u90fd\u4f1a\u89e6\u53d1 Owner \u5bf9\u8c61 controller \u7684 Reconcile \u65b9\u6cd5\u3002</p>"},{"location":"cloud/k8s/k8s.html","title":"Kubernetes","text":"<p>\u5728\u5927\u89c4\u6a21\u96c6\u7fa4\u4e2d\u7684\u5404\u79cd\u4efb\u52a1\u4e4b\u95f4\u8fd0\u884c\uff0c\u5b9e\u9645\u4e0a\u5b58\u5728\u5404\u79cd\u5404\u6837\u7684\u5173\u7cfb\u3002\u8fd9\u4e9b\u5173\u7cfb\u7684\u5904\u7406\u624d\u662f\u4f5c\u4e1a\u7f16\u6392\u548c\u7ba1\u7406\u7cfb\u7edf\u6700\u56f0\u96be\u7684\u5730\u65b9\u3002</p> <p>\u8fc7\u53bb\u5f88\u591a\u96c6\u7fa4\u7ba1\u7406\u9879\u76ee\uff08Yarn/Mesos\uff09\u64c5\u957f\u5c06\u4e00\u4e2a\u5bb9\u5668\u6309\u7167\u67d0\u79cd\u89c4\u5219\u653e\u7f6e\u5728\u67d0\u4e2a\u6700\u4f73\u7684\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u79f0\u4e3a\u8c03\u5ea6\uff1b</p> <p>Kubernetes\u64c5\u957f\u6309\u7528\u6237\u7684\u610f\u613f\u548c\u6574\u4e2a\u7cfb\u7edf\u7684\u89c4\u5219\uff0c\u81ea\u52a8\u5316\u5904\u7406\u597d\u5bb9\u5668\u95f4\u7684\u5404\u79cd\u5173\u7cfb\uff0c\u79f0\u4e3a\u7f16\u6392\u3002</p> <p>\u4ee5\u7edf\u4e00\u7684\u65b9\u5f0f\u62bd\u8c61\u5e95\u5c42\u57fa\u7840\u8bbe\u65bd\u80fd\u529b\uff08\u5982\u8ba1\u7b97\u3001\u7f51\u7edc\u3001\u5b58\u50a8\uff09\uff0c\u5b9a\u4e49\u4efb\u52a1\u7f16\u6392\u7684\u5404\u79cd\u5173\u7cfb\uff08\u5982\u4eb2\u5bc6\u3001\u8bbf\u95ee\u3001\u4ee3\u7406\u5173\u7cfb\uff09\uff0c\u5c06\u62bd\u8c61\u4ee5\u58f0\u660e\u5f0f API \u7684\u65b9\u5f0f\u5bf9\u5916\u66b4\u9732\uff0c\u4ece\u800c\u5141\u8bb8\u5e73\u53f0\u6784\u5efa\u8005\u57fa\u4e8e\u8fd9\u4e9b\u62bd\u8c61\u8fdb\u4e00\u6b65\u6784\u5efa\u81ea\u5df1\u7684 PAAS \u5e73\u53f0\u3002</p>"},{"location":"cloud/k8s/k8s.html#_1","title":"\u7ec4\u4ef6","text":"<p>\u5b98\u65b9\u7f51\u5740\uff1ahttps://kubernetes.io/zh-cn/docs/concepts/overview/components/</p> <p></p>"},{"location":"cloud/k8s/k8s.html#control-plane-components","title":"\u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\uff08Control Plane Components\uff09","text":"<p>\u63a7\u5236\u5e73\u9762\u7684\u7ec4\u4ef6\u5bf9\u96c6\u7fa4\u505a\u51fa\u5168\u5c40\u51b3\u7b56\uff08\u6bd4\u5982\u8c03\u5ea6\uff09\uff0c\u4ee5\u53ca\u68c0\u6d4b\u548c\u54cd\u5e94\u96c6\u7fa4\u4e8b\u4ef6\uff08\u4f8b\u5982\uff0c\u5f53\u4e0d\u6ee1\u8db3\u90e8\u7f72\u7684 <code>replicas</code> \u5b57\u6bb5\u65f6\uff0c\u542f\u52a8\u65b0\u7684 pod\uff09\u3002</p> <p>\u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\u53ef\u4ee5\u5728\u96c6\u7fa4\u4e2d\u7684\u4efb\u4f55\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u4e00\u822c\u800c\u8a00\uff0c\u4f1a\u90e8\u7f72\u5728\u4e00\u4e2a\u8282\u70b9\uff08\u79f0\u4e3aMaster\u8282\u70b9\uff09\uff0c\u540c\u65f6\u8be5\u8282\u70b9\u4e0d\u8fd0\u884c\u7528\u6237\u5bb9\u5668\u3002</p>"},{"location":"cloud/k8s/k8s.html#kube-apiserver","title":"kube-apiserver","text":"<p>\u4ece etcd \u8bfb\u53d6\uff08<code>ListWatch</code>\uff09\u5168\u91cf\u6570\u636e\uff0c\u5e76\u7f13\u5b58\u5728\u5185\u5b58\u4e2d\uff1b\u65e0\u72b6\u6001\u670d\u52a1\uff0c\u53ef\u6c34\u5e73\u6269\u5c55\u3002</p> <p>\u8be5\u7ec4\u4ef6\u516c\u5f00\u4e86 Kubernetes API\uff0c\u652f\u6301\u6c34\u5e73\u4f38\u7f29\uff0c\u6240\u6709\u5176\u4ed6\u7ec4\u4ef6\u90fd\u901a\u8fc7\u8be5\u524d\u7aef\u8fdb\u884c\u4ea4\u4e92\u3002</p>"},{"location":"cloud/k8s/k8s.html#kube-controller-manager","title":"kube-controller-manager","text":"<p>\u8fd0\u884c\u63a7\u5236\u5668\u8fdb\u7a0b\u7684\u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\u3002</p> <p>\u4ece\u903b\u8f91\u4e0a\u8bb2\uff0c\u6bcf\u4e2a\u63a7\u5236\u5668\u90fd\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u8fdb\u7a0b\uff0c \u4f46\u662f\u4e3a\u4e86\u964d\u4f4e\u590d\u6742\u6027\uff0c\u5b83\u4eec\u90fd\u88ab\u7f16\u8bd1\u5230\u540c\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u5728\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u8fd0\u884c\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u793a\u4f8b\uff1a</p> <ul> <li>\u8282\u70b9\u63a7\u5236\u5668\uff08Node Controller\uff09: \u8d1f\u8d23\u5728\u8282\u70b9\u51fa\u73b0\u6545\u969c\u65f6\u8fdb\u884c\u901a\u77e5\u548c\u54cd\u5e94</li> <li>\u4efb\u52a1\u63a7\u5236\u5668\uff08Job controller\uff09: \u76d1\u6d4b\u4ee3\u8868\u4e00\u6b21\u6027\u4efb\u52a1\u7684 Job \u5bf9\u8c61\uff0c\u7136\u540e\u521b\u5efa Pods \u6765\u8fd0\u884c\u8fd9\u4e9b\u4efb\u52a1\u76f4\u81f3\u5b8c\u6210</li> <li>\u7aef\u70b9\u63a7\u5236\u5668\uff08Endpoints Controller\uff09: \u586b\u5145\u7aef\u70b9\uff08Endpoints\uff09\u5bf9\u8c61\uff08\u5373\u52a0\u5165 Service \u4e0e Pod\u4e4b\u95f4\u7684\u94fe\u63a5\uff09</li> <li>\u670d\u52a1\u5e10\u6237\u548c\u4ee4\u724c\u63a7\u5236\u5668\uff08Service Account &amp; Token Controllers\uff09: \u4e3a\u65b0\u7684\u547d\u540d\u7a7a\u95f4\u521b\u5efa\u9ed8\u8ba4\u5e10\u6237\u548c API \u8bbf\u95ee\u4ee4\u724c</li> </ul>"},{"location":"cloud/k8s/k8s.html#kube-scheduler","title":"kube-scheduler","text":"<p>\u8fdb\u4e00\u6b65\u7684\u77e5\u8bc6\u89c1K8s\u8c03\u5ea6\u5668</p> <p>\u8d1f\u8d23\u76d1\u89c6\u65b0\u521b\u5efa\u7684\u3001\u672a\u6307\u5b9a\u8fd0\u884c\u8282\u70b9\uff08node\uff09\u7684 Pods\uff0c\u9009\u62e9\u8282\u70b9\u8ba9 Pod \u5728\u4e0a\u9762\u8fd0\u884c\u3002</p> <p>\u8c03\u5ea6\u51b3\u7b56\u8003\u8651\u7684\u56e0\u7d20\u5305\u62ec\u5355\u4e2a Pod \u53ca Pods \u96c6\u5408\u7684\u8d44\u6e90\u9700\u6c42\u3001\u8f6f\u786c\u4ef6\u53ca\u7b56\u7565\u7ea6\u675f\u3001 \u4eb2\u548c\u6027\u53ca\u53cd\u4eb2\u548c\u6027\u89c4\u8303\u3001\u6570\u636e\u4f4d\u7f6e\u3001\u5de5\u4f5c\u8d1f\u8f7d\u95f4\u7684\u5e72\u6270\u53ca\u6700\u540e\u65f6\u9650\u3002</p>"},{"location":"cloud/k8s/k8s.html#cloud-controller-manager","title":"cloud-controller-manager","text":"<p>\u4e91\u63a7\u5236\u5668\u7ba1\u7406\u5668\uff08Cloud Controller Manager\uff09\u5141\u8bb8\u5c06\u4f60\u7684\u96c6\u7fa4\u8fde\u63a5\u5230\u4e91\u63d0\u4f9b\u5546\u7684 API \u4e4b\u4e0a\uff0c \u5e76\u5c06\u4e0e\u8be5\u4e91\u5e73\u53f0\u4ea4\u4e92\u7684\u7ec4\u4ef6\u540c\u4e0e\u4f60\u7684\u96c6\u7fa4\u4ea4\u4e92\u7684\u7ec4\u4ef6\u5206\u79bb\u5f00\u6765\u3002</p> <ul> <li>\u57fa\u4e8e\u4e00\u79cd\u63d2\u4ef6\u673a\u5236\u6765\u6784\u9020\u7684\uff0c \u8fd9\u79cd\u673a\u5236\u4f7f\u5f97\u4e0d\u540c\u7684\u4e91\u5382\u5546\u90fd\u80fd\u5c06\u5176\u5e73\u53f0\u4e0e Kubernetes \u96c6\u6210\u3002</li> </ul>"},{"location":"cloud/k8s/k8s.html#etcd","title":"etcd","text":"<p>\u53ef\u4ee5\u4f7f\u7528 k8s \u81ea\u8eab\u7684\u5185\u7f6e\u7684 etcd\uff0c\u6216\u8005\u914d\u7f6e\u5916\u90e8\u7684 etcd \u96c6\u7fa4\u3002</p> <p>\u4e00\u81f4\u4e14\u9ad8\u53ef\u7528\u7684\u952e\u503c\u5b58\u50a8\uff0c\u7528\u4f5c Kubernetes \u6240\u6709\u96c6\u7fa4\u6570\u636e\u7684\u540e\u53f0\u6570\u636e\u5e93\u3002</p>"},{"location":"cloud/k8s/k8s.html#node","title":"Node \u7ec4\u4ef6","text":"<p>\u8282\u70b9\u7ec4\u4ef6\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u7ef4\u62a4\u8fd0\u884c\u7684 Pod \u5e76\u63d0\u4f9b Kubernetes \u8fd0\u884c\u73af\u5883\u3002</p>"},{"location":"cloud/k8s/k8s.html#kubelet","title":"kubelet","text":"<p>\u6bcf\u4e2a\u8282\u70b9\uff08node\uff09\u4e0a\u8fd0\u884c\u7684\u4ee3\u7406\u3002 \u5b83\u4fdd\u8bc1\u5bb9\u5668\uff08containers\uff09\u90fd \u8fd0\u884c\u5728 Pod \u4e2d\u3002</p> <ul> <li> <p>\u63a5\u6536\u4e00\u7ec4\u901a\u8fc7\u5404\u7c7b\u673a\u5236\u63d0\u4f9b\u7684 PodSpec\uff0c\u786e\u4fdd PodSpec \u4e2d\u63cf\u8ff0\u7684\u5bb9\u5668\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\u4e14\u5065\u5eb7\u3002</p> </li> <li> <p>kubelet \u4e0d\u4f1a\u7ba1\u7406\u4e0d\u662f\u7531 Kubernetes \u521b\u5efa\u7684\u5bb9\u5668\u3002</p> </li> </ul>"},{"location":"cloud/k8s/k8s.html#kube-proxy","title":"kube-proxy","text":"<p>\u652f\u6301 iptables \u548c ipvs \u6a21\u5f0f\u7684\u4ee3\u7406\u3002</p> <p>\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u7684\u7f51\u7edc\u4ee3\u7406\uff0c \u5b9e\u73b0 Kubernetes \u670d\u52a1\uff08Service\uff09 \u6982\u5ff5\u7684\u4e00\u90e8\u5206\u3002</p> <ul> <li>\u53ef\u4ee5\u63d0\u4f9b\u56fa\u5b9a\u7684 VIP\uff0c\u5c06\u5176\u8f6c\u6362\u4e3a\u540e\u7aef\u7684 Pod \u7684\u771f\u6b63 IP\uff08IP \u7684\u8def\u7531\u7531\u7f51\u7edc\u63d2\u4ef6\u5982 Calico \u63d0\u4f9b\uff09\u3002 </li> </ul> <p>\u7ef4\u62a4\u8282\u70b9\u4e0a\u7684\u7f51\u7edc\u89c4\u5219\uff0c\u5141\u8bb8\u4ece\u96c6\u7fa4\u5185\u90e8\u6216\u5916\u90e8\u7684\u7f51\u7edc\u4f1a\u8bdd\u4e0e Pod \u8fdb\u884c\u7f51\u7edc\u901a\u4fe1\u3002</p> <ul> <li>\u5982\u679c\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u4e86\u53ef\u7528\u7684\u6570\u636e\u5305\u8fc7\u6ee4\u5c42\uff0c\u5219 kube-proxy \u4f1a\u901a\u8fc7\u5b83\u6765\u5b9e\u73b0\u7f51\u7edc\u89c4\u5219\u3002 \u5426\u5219\uff0ckube-proxy \u4ec5\u505a\u6d41\u91cf\u8f6c\u53d1\u3002</li> </ul>"},{"location":"cloud/k8s/k8s.html#container-runtime","title":"Container Runtime","text":"<p>\u5bb9\u5668\u8fd0\u884c\u73af\u5883\u662f\u8d1f\u8d23\u8fd0\u884c\u5bb9\u5668\u7684\u8f6f\u4ef6\u3002Kubernetes CRI (\u5bb9\u5668\u8fd0\u884c\u73af\u5883\u63a5\u53e3) \u7684\u4efb\u4f55\u5b9e\u73b0\uff0c\u5305\u62ec containerd\u3001CRI-O\u3002</p>"},{"location":"cloud/k8s/k8s.html#_2","title":"\u63d2\u4ef6","text":"<p>\u63d2\u4ef6\u4f7f\u7528 Kubernetes \u8d44\u6e90\uff08DaemonSet\u3001Deployment\u7b49\uff09\u5b9e\u73b0\u96c6\u7fa4\u529f\u80fd\u3002\u56e0\u4e3a\u8fd9\u4e9b\u63d2\u4ef6\u63d0\u4f9b\u96c6\u7fa4\u7ea7\u522b\u7684\u529f\u80fd\uff0c\u63d2\u4ef6\u4e2d\u547d\u540d\u7a7a\u95f4\u57df\u7684\u8d44\u6e90\u5c5e\u4e8e <code>kube-system</code> \u547d\u540d\u7a7a\u95f4\u3002</p>"},{"location":"cloud/k8s/k8s.html#_3","title":"\u96c6\u7fa4\u5c42\u9762\u65e5\u5fd7","text":"<p>\u96c6\u7fa4\u5c42\u9762\u65e5\u5fd7 \u673a\u5236\u8d1f\u8d23\u5c06\u5bb9\u5668\u7684\u65e5\u5fd7\u6570\u636e\u4fdd\u5b58\u5230\u4e00\u4e2a\u96c6\u4e2d\u7684\u65e5\u5fd7\u5b58\u50a8\u4e2d\uff0c\u8be5\u5b58\u50a8\u80fd\u591f\u63d0\u4f9b\u641c\u7d22\u548c\u6d4f\u89c8\u63a5\u53e3\u3002</p>"},{"location":"cloud/k8s/k8s.html#_4","title":"\u7f51\u7edc\u63d2\u4ef6","text":"<p>\u7f51\u7edc\u63d2\u4ef6 \u662f\u5b9e\u73b0\u5bb9\u5668\u7f51\u7edc\u63a5\u53e3\uff08CNI\uff09\u89c4\u8303\u7684\u8f6f\u4ef6\u7ec4\u4ef6\u3002\u5b83\u4eec\u8d1f\u8d23\u4e3a Pod \u5206\u914d IP \u5730\u5740\uff0c\u5e76\u4f7f\u8fd9\u4e9b Pod \u80fd\u5728\u96c6\u7fa4\u5185\u90e8\u76f8\u4e92\u901a\u4fe1\u3002</p> <ul> <li> <p>Flannel \u662f\u4e00\u4e2a\u53ef\u4ee5\u7528\u4e8e Kubernetes \u7684 overlay \u7f51\u7edc\u63d0\u4f9b\u8005\u3002</p> </li> <li> <p>Calico \u662f\u4e00\u4e2a\u8054\u7f51\u548c\u7f51\u7edc\u7b56\u7565\u4f9b\u5e94\u5546\u3002 Calico \u652f\u6301\u4e00\u5957\u7075\u6d3b\u7684\u7f51\u7edc\u9009\u9879\uff0c\u5305\u62ec\u975e\u8986\u76d6\u548c\u8986\u76d6\u7f51\u7edc\uff0c\u5e26\u6216\u4e0d\u5e26 BGP\u3002 Calico \u4f7f\u7528\u76f8\u540c\u7684\u5f15\u64ce\u4e3a\u4e3b\u673a\u3001Pod \u548c\uff08\u5982\u679c\u4f7f\u7528 Istio \u548c Envoy\uff09\u5e94\u7528\u7a0b\u5e8f\u5728\u670d\u52a1\u7f51\u683c\u5c42\u6267\u884c\u7f51\u7edc\u7b56\u7565\u3002</p> </li> <li>Canal \u7ed3\u5408 Flannel \u548c Calico\uff0c\u63d0\u4f9b\u8054\u7f51\u548c\u7f51\u7edc\u7b56\u7565\u3002</li> <li> <p>Cilium \u662f\u4e00\u79cd\u7f51\u7edc\u3001\u53ef\u89c2\u5bdf\u6027\u548c\u5b89\u5168\u89e3\u51b3\u65b9\u6848\uff0c\u5177\u6709\u57fa\u4e8e eBPF \u7684\u6570\u636e\u5e73\u9762\u3002 Cilium \u63d0\u4f9b\u4e86\u7b80\u5355\u7684 3 \u5c42\u6241\u5e73\u7f51\u7edc\uff0c \u80fd\u591f\u4ee5\u539f\u751f\u8def\u7531\uff08routing\uff09\u548c\u8986\u76d6/\u5c01\u88c5\uff08overlay/encapsulation\uff09\u6a21\u5f0f\u8de8\u8d8a\u591a\u4e2a\u96c6\u7fa4\uff0c \u5e76\u4e14\u53ef\u4ee5\u4f7f\u7528\u4e0e\u7f51\u7edc\u5bfb\u5740\u5206\u79bb\u7684\u57fa\u4e8e\u8eab\u4efd\u7684\u5b89\u5168\u6a21\u578b\u5728 L3 \u81f3 L7 \u4e0a\u5b9e\u65bd\u7f51\u7edc\u7b56\u7565\u3002</p> </li> <li> <p>Multus \u662f\u4e00\u4e2a\u591a\u63d2\u4ef6\uff0c \u53ef\u5728 Kubernetes \u4e2d\u63d0\u4f9b\u591a\u79cd\u7f51\u7edc\u652f\u6301\uff0c\u4ee5\u652f\u6301\u6240\u6709 CNI \u63d2\u4ef6\uff08\u4f8b\u5982 Calico\u3001Cilium\u3001Contiv\u3001Flannel\uff09\uff0c \u800c\u4e14\u5305\u542b\u4e86\u5728 Kubernetes \u4e2d\u57fa\u4e8e SRIOV\u3001DPDK\u3001OVS-DPDK \u548c VPP \u7684\u5de5\u4f5c\u8d1f\u8f7d\u3002</p> </li> <li> <p>CNI-Genie \u4f7f Kubernetes \u65e0\u7f1d\u8fde\u63a5\u5230 Calico\u3001Canal\u3001Flannel \u6216 Weave \u7b49\u5176\u4e2d\u4e00\u79cd CNI \u63d2\u4ef6\u3002</p> </li> <li> <p>Spiderpool \u4e3a Kubernetes \u63d0\u4f9b\u4e86\u4e0b\u5c42\u7f51\u7edc\u548c RDMA \u9ad8\u901f\u7f51\u7edc\u89e3\u51b3\u65b9\u6848\uff0c\u517c\u5bb9\u88f8\u91d1\u5c5e\u3001\u865a\u62df\u673a\u548c\u516c\u6709\u4e91\u7b49\u8fd0\u884c\u73af\u5883\u3002</p> </li> </ul>"},{"location":"cloud/k8s/k8s.html#_5","title":"\u670d\u52a1\u53d1\u73b0","text":"<p>\u96c6\u7fa4 DNS \u662f\u4e00\u4e2a DNS \u670d\u52a1\u5668\uff0c\u548c\u73af\u5883\u4e2d\u7684\u5176\u4ed6 DNS \u670d\u52a1\u5668\u4e00\u8d77\u5de5\u4f5c\uff0c\u5b83\u4e3a Kubernetes \u670d\u52a1\u63d0\u4f9b DNS \u8bb0\u5f55\u3002</p> <ul> <li>CoreDNS \u662f\u4e00\u79cd\u7075\u6d3b\u7684\uff0c\u53ef\u6269\u5c55\u7684 DNS \u670d\u52a1\u5668\uff0c\u53ef\u4ee5 \u5b89\u88c5\u4e3a\u96c6\u7fa4\u5185\u7684 Pod \u63d0\u4f9b DNS \u670d\u52a1\u3002</li> </ul> <p>Kubernetes \u542f\u52a8\u7684\u5bb9\u5668\u81ea\u52a8\u5c06\u6b64 DNS \u670d\u52a1\u5668\u5305\u542b\u5728\u5176 DNS \u641c\u7d22\u5217\u8868\u4e2d\u3002</p>"},{"location":"cloud/k8s/k8s.html#_6","title":"\u57fa\u7840\u8bbe\u65bd","text":"<ul> <li>KubeVirt \u662f\u53ef\u4ee5\u8ba9 Kubernetes \u8fd0\u884c\u865a\u62df\u673a\u7684 add-on\u3002\u901a\u5e38\u8fd0\u884c\u5728\u88f8\u673a\u96c6\u7fa4\u4e0a\u3002</li> <li>\u8282\u70b9\u95ee\u9898\u68c0\u6d4b\u5668 \u5728 Linux \u8282\u70b9\u4e0a\u8fd0\u884c\uff0c \u5e76\u5c06\u7cfb\u7edf\u95ee\u9898\u62a5\u544a\u4e3a K8s event \u6216 node status condition\u3002</li> </ul>"},{"location":"cloud/k8s/k8s.html#web","title":"Web \u754c\u9762\uff08\u4eea\u8868\u76d8\uff09","text":"<p>Dashboard \u662f Kubernetes \u96c6\u7fa4\u7684\u901a\u7528\u7684\u3001\u57fa\u4e8e Web \u7684\u7528\u6237\u754c\u9762\u3002 \u5b83\u4f7f\u7528\u6237\u53ef\u4ee5\u7ba1\u7406\u96c6\u7fa4\u4e2d\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u4ee5\u53ca\u96c6\u7fa4\u672c\u8eab\u5e76\u8fdb\u884c\u6545\u969c\u6392\u9664\u3002</p>"},{"location":"cloud/k8s/k8s.html#_7","title":"\u5bb9\u5668\u8d44\u6e90\u76d1\u63a7","text":"<p>\u5bb9\u5668\u8d44\u6e90\u76d1\u63a7 \u5c06\u5173\u4e8e\u5bb9\u5668\u7684\u4e00\u4e9b\u5e38\u89c1\u7684\u65f6\u95f4\u5e8f\u5217\u5ea6\u91cf\u503c\u4fdd\u5b58\u5230\u4e00\u4e2a\u96c6\u4e2d\u7684\u6570\u636e\u5e93\u4e2d\uff0c\u5e76\u63d0\u4f9b\u7528\u4e8e\u6d4f\u89c8\u8fd9\u4e9b\u6570\u636e\u7684\u754c\u9762\u3002</p>"},{"location":"cloud/k8s/k8s.html#_8","title":"\u63d2\u6869","text":"<ul> <li>kube-state-metrics\uff1a\u4fa6\u542cKubernetes API\u670d\u52a1\u5668\u5e76\u751f\u6210\u6709\u5173\u5bf9\u8c61\u72b6\u6001\u7684\u6307\u6807\u7684\u63d2\u4ef6\u4ee3\u7406\u3002</li> </ul>"},{"location":"cloud/k8s/k8s.html#_9","title":"\u67b6\u6784","text":"<p>\u5b98\u65b9\u5730\u5740\uff1ahttps://kubernetes.io/zh-cn/docs/concepts/architecture/</p> <p></p>"},{"location":"cloud/k8s/k8s.html#_10","title":"\u8282\u70b9","text":"<p>\u8282\u70b9\u53ef\u4ee5\u662f\u4e00\u4e2a\u865a\u62df\u673a\u6216\u8005\u7269\u7406\u673a\u5668\uff0c\u53d6\u51b3\u4e8e\u6240\u5728\u7684\u96c6\u7fa4\u914d\u7f6e\u3002\u6bcf\u4e2a\u8282\u70b9\u5305\u542b\u8fd0\u884c Pod \u6240\u9700\u7684\u670d\u52a1\uff1b \u8fd9\u4e9b\u8282\u70b9\u7531\u63a7\u5236\u9762\u8d1f\u8d23\u7ba1\u7406\u3002</p> <p>Kubernetes \u4f1a\u4e00\u76f4\u4fdd\u5b58\u7740\u975e\u6cd5\u8282\u70b9\u5bf9\u5e94\u7684\u5bf9\u8c61\uff0c\u5e76\u6301\u7eed\u68c0\u67e5\u8be5\u8282\u70b9\u662f\u5426\u5df2\u7ecf\u53d8\u5f97\u5065\u5eb7\u3002</p> <ul> <li>\u5fc5\u987b\u663e\u5f0f\u5730\u5220\u9664\u8be5 Node \u5bf9\u8c61\u4ee5\u505c\u6b62\u5065\u5eb7\u68c0\u67e5\u64cd\u4f5c\u3002</li> </ul>"},{"location":"cloud/k8s/k8s.html#_11","title":"\u63a7\u5236\u5668","text":"<p>\u901a\u8fc7 Yaml \u63cf\u8ff0\u671f\u671b\u72b6\u6001\uff08Desired State\uff09\uff0c\u63a7\u5236\u5668\u901a\u8fc7\u76d1\u63a7\u96c6\u7fa4\u7684\u516c\u5171\u72b6\u6001\uff0c\u5e76\u81f4\u529b\u4e8e\u5c06\u5f53\u524d\u72b6\u6001\uff08Current State\uff09\u8f6c\u53d8\u4e3a\u671f\u671b\u7684\u72b6\u6001\u3002</p>"},{"location":"cloud/k8s/k8s.html#_12","title":"\u63a7\u5236\u5668\u6a21\u5f0f","text":"<p>\u4e00\u4e2a\u63a7\u5236\u5668\u81f3\u5c11\u8ffd\u8e2a\u4e00\u79cd\u7c7b\u578b\u7684 Kubernetes \u8d44\u6e90\u3002\u8fd9\u4e9b\u5bf9\u8c61\u6709\u4e00\u4e2a\u4ee3\u8868\u671f\u671b\u72b6\u6001\u7684 <code>spec</code> \u5b57\u6bb5\u3002 \u8be5\u8d44\u6e90\u7684\u63a7\u5236\u5668\u8d1f\u8d23\u786e\u4fdd\u5176\u5f53\u524d\u72b6\u6001\u63a5\u8fd1\u671f\u671b\u72b6\u6001\u3002</p> <p>\u901a\u8fc7 API \u670d\u52a1\u5668\u6765\u63a7\u5236</p> <ul> <li>\u5185\u7f6e\u63a7\u5236\u5668\u901a\u8fc7\u548c\u96c6\u7fa4 API \u670d\u52a1\u5668\u4ea4\u4e92\u6765\u7ba1\u7406\u72b6\u6001\uff1b\u5982 Job \u63a7\u5236\u5668\u4e0d\u4f1a\u81ea\u5df1\u8fd0\u884c\u4efb\u4f55\u7684 Pod \u6216\u8005\u5bb9\u5668\uff0cJob \u63a7\u5236\u5668\u662f\u901a\u77e5 API \u670d\u52a1\u5668\u6765\u521b\u5efa\u6216\u8005\u79fb\u9664 Pod\u3002</li> </ul> <p>\u76f4\u63a5\u63a7\u5236</p> <ul> <li>\u548c\u5916\u90e8\u72b6\u6001\u4ea4\u4e92\u7684\u63a7\u5236\u5668\u4ece API \u670d\u52a1\u5668\u83b7\u53d6\u5230\u5b83\u60f3\u8981\u7684\u72b6\u6001\uff0c\u7136\u540e\u76f4\u63a5\u548c\u5916\u90e8\u7cfb\u7edf\u8fdb\u884c\u901a\u4fe1\uff08\u5bf9\u96c6\u7fa4\u5916\u7684\u4e00\u4e9b\u4e1c\u897f\u8fdb\u884c\u4fee\u6539\uff09\u5e76\u4f7f\u5f53\u524d\u72b6\u6001\u66f4\u63a5\u8fd1\u671f\u671b\u72b6\u6001\u3002</li> </ul>"},{"location":"cloud/k8s/k8s.html#_13","title":"\u79df\u7ea6","text":"<p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u901a\u5e38\u9700\u8981\u79df\u7ea6\uff08Lease\uff09\uff1b\u79df\u7ea6\u63d0\u4f9b\u4e86\u4e00\u79cd\u673a\u5236\u6765\u9501\u5b9a\u5171\u4eab\u8d44\u6e90\u5e76\u534f\u8c03\u96c6\u5408\u6210\u5458\u4e4b\u95f4\u7684\u6d3b\u52a8\u3002</p> <p>\u79df\u7ea6\u6982\u5ff5\u8868\u793a\u4e3a <code>coordination.k8s.io</code> API \u7ec4\u4e2d\u7684 Lease \u5bf9\u8c61\uff0c \u5e38\u7528\u4e8e\u7c7b\u4f3c\u8282\u70b9\u5fc3\u8df3\u548c\u7ec4\u4ef6\u7ea7\u9886\u5bfc\u8005\u9009\u4e3e\u7b49\u7cfb\u7edf\u6838\u5fc3\u80fd\u529b\u3002</p>"},{"location":"cloud/k8s/k8s.html#_14","title":"\u8282\u70b9\u5fc3\u8df3","text":"<p>Kubernetes \u4f7f\u7528 Lease API \u5c06 kubelet \u8282\u70b9\u5fc3\u8df3\u4f20\u9012\u5230 Kubernetes API \u670d\u52a1\u5668\u3002</p> <p>\u5bf9\u4e8e\u6bcf\u4e2a <code>Node</code>\uff0c\u5728 <code>kube-node-lease</code> \u540d\u5b57\u7a7a\u95f4\u4e2d\u90fd\u6709\u4e00\u4e2a\u5177\u6709\u5339\u914d\u540d\u79f0\u7684 <code>Lease</code> \u5bf9\u8c61\u3002</p> <ul> <li>\u6bcf\u4e2a kubelet \u5fc3\u8df3\u90fd\u662f\u5bf9\u8be5 <code>Lease</code> \u5bf9\u8c61\u7684 update \u8bf7\u6c42\uff0c\u66f4\u65b0\u8be5 Lease \u7684 <code>spec.renewTime</code> \u5b57\u6bb5\u3002</li> <li>Kubernetes \u63a7\u5236\u5e73\u9762\u4f7f\u7528\u6b64\u5b57\u6bb5\u7684\u65f6\u95f4\u6233\u6765\u786e\u5b9a\u6b64 <code>Node</code> \u7684\u53ef\u7528\u6027\u3002</li> </ul>"},{"location":"cloud/k8s/k8s.html#_15","title":"\u9886\u5bfc\u8005\u9009\u4e3e","text":"<p>\u4f7f\u7528 Lease \u786e\u4fdd\u5728\u4efb\u4f55\u7ed9\u5b9a\u65f6\u95f4\u67d0\u4e2a\u7ec4\u4ef6\u53ea\u6709\u4e00\u4e2a\u5b9e\u4f8b\u5728\u8fd0\u884c\uff0c\u7528\u4e8eActive-Standby\u7684\u9ad8\u53ef\u7528\u573a\u666f\u3002</p>"},{"location":"cloud/k8s/k8s.html#_16","title":"\u5783\u573e\u6536\u96c6","text":"<p>\u5783\u573e\u6536\u96c6\uff08Garbage Collection\uff09\u662f Kubernetes \u7528\u4e8e\u6e05\u7406\u96c6\u7fa4\u8d44\u6e90\u7684\u5404\u79cd\u673a\u5236\u7684\u7edf\u79f0\u3002 \u8be6\u89c1\u5783\u573e\u6536\u96c6</p>"},{"location":"cloud/k8s/k8s_object.html","title":"K8s\u4e2d\u7684\u5bf9\u8c61","text":"<p>Kubernetes \u5bf9\u8c61\u662f\u4e00\u79cd\u201c\u610f\u5411\u8868\u8fbe\uff08Record of Intent\uff09\u201d\u3002\u4e00\u65e6\u521b\u5efa\u8be5\u5bf9\u8c61\uff0c Kubernetes \u7cfb\u7edf\u5c06\u4e0d\u65ad\u5de5\u4f5c\u4ee5\u786e\u4fdd\u8be5\u5bf9\u8c61\u5b58\u5728\u3002</p>"},{"location":"cloud/k8s/k8s_object.html#specstatus","title":"\u5bf9\u8c61\u89c4\u7ea6\uff08Spec\uff09\u4e0e\u72b6\u6001\uff08Status\uff09","text":"<p>\u5bf9\u8c61 <code>spec</code>\uff08\u89c4\u7ea6\uff09\uff1a\u63cf\u8ff0\u5e0c\u671b\u5bf9\u8c61\u6240\u5177\u6709\u7684\u7279\u5f81\uff0c\u5373\u671f\u671b\u72b6\u6001\uff08Desired State\uff09\u3002</p> <p>\u5bf9\u8c61 <code>status</code>\uff08\u72b6\u6001\uff09\uff1a\u63cf\u8ff0\u4e86\u5bf9\u8c61\u7684\u5f53\u524d\u72b6\u6001\uff08Current State\uff09\u3002</p> <p>\u5bf9\u8c61\u7684 Yaml \u5b9a\u4e49\u7684\u6784\u6210\uff1a</p> <ul> <li>TypeMeta\uff1aKind\uff0cApiVersion\uff0c <code>inline</code>\u5bf9\u5e94<code>kind</code>\u548c<code>apiVersion</code>\u4e24\u4e2a\u5b57\u6bb5\uff1b</li> <li>ObjectMeta\uff1a\u5bf9\u5e94\u7684.metadata\uff1b</li> <li>Spec\uff1a\u5bf9\u5e94\u7684 .spec\uff1b</li> <li>Status\uff1a\u5bf9\u5e94\u7684 .status\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_object.html#objectmeta","title":"ObjectMeta","text":""},{"location":"cloud/k8s/k8s_object.html#_1","title":"\u540d\u7a7a\u95f4","text":"<p>\u540d\u5b57\u7a7a\u95f4\uff08Namespace\uff09 \u63d0\u4f9b\u4e00\u79cd\u673a\u5236\uff0c\u5c06\u540c\u4e00\u96c6\u7fa4\u4e2d\u7684\u8d44\u6e90\u5212\u5206\u4e3a\u76f8\u4e92\u9694\u79bb\u7684\u7ec4\u3002 \u540c\u4e00\u540d\u5b57\u7a7a\u95f4\u5185\u7684\u8d44\u6e90\u540d\u79f0\u8981\u552f\u4e00\uff0c\u4f46\u8de8\u540d\u5b57\u7a7a\u95f4\u65f6\u6ca1\u6709\u8fd9\u4e2a\u8981\u6c42\u3002 </p> <ul> <li>\u540d\u5b57\u7a7a\u95f4\u4f5c\u7528\u57df\u4ec5\u9488\u5bf9\u5e26\u6709\u540d\u5b57\u7a7a\u95f4\u7684\u5bf9\u8c61 \uff08\u4f8b\u5982 Deployment\u3001Service \u7b49\uff09\uff0c\u8fd9\u79cd\u4f5c\u7528\u57df\u5bf9\u96c6\u7fa4\u8303\u56f4\u7684\u5bf9\u8c61 \uff08\u4f8b\u5982 StorageClass\u3001Node\u3001PersistentVolume \u7b49\uff09\u4e0d\u9002\u7528\u3002</li> </ul>"},{"location":"cloud/k8s/k8s_object.html#_2","title":"\u6807\u7b7e\u548c\u6ce8\u89e3","text":"<p>\u53ef\u4ee5\u4f7f\u7528\u6807\u7b7e\u6216\u6ce8\u89e3\uff08\u952e\u503c\u5bf9\uff09\u5c06\u5143\u6570\u636e\u9644\u52a0\u5230 Kubernetes \u5bf9\u8c61\u3002</p> <ul> <li>\u6807\u7b7e\u53ef\u4ee5\u7528\u6765\u9009\u62e9\u5bf9\u8c61\u548c\u67e5\u627e\u6ee1\u8db3\u67d0\u4e9b\u6761\u4ef6\u7684\u5bf9\u8c61\u96c6\u5408\uff0c\u80fd\u591f\u652f\u6301\u9ad8\u6548\u7684\u67e5\u8be2\u548c\u76d1\u542c\u64cd\u4f5c\u3002</li> <li>\u6ce8\u89e3\u4e0d\u7528\u4e8e\u6807\u8bc6\u548c\u9009\u62e9\u5bf9\u8c61\u3002 \u6ce8\u89e3\u4e2d\u7684\u5143\u6570\u636e\uff0c\u53ef\u4ee5\u5f88\u5c0f\uff0c\u4e5f\u53ef\u4ee5\u5f88\u5927\uff0c\u53ef\u4ee5\u662f\u7ed3\u6784\u5316\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u975e\u7ed3\u6784\u5316\u7684\uff0c\u80fd\u591f\u5305\u542b\u6807\u7b7e\u4e0d\u5141\u8bb8\u7684\u5b57\u7b26\u3002 </li> </ul> <p>Map \u4e2d\u7684\u952e\u548c\u503c\u5fc5\u987b\u662f\u5b57\u7b26\u4e32\uff1a</p> <ul> <li>\u6807\u7b7e\u548c\u6ce8\u89e3\u7684\u952e\u683c\u5f0f\uff1a\"\u53ef\u9009\u524d\u7f00/\u540d\u79f0\"</li> <li>\u524d\u7f00\u5fc5\u987b\u662f DNS \u5b50\u57df\uff0c\u7531\u70b9\uff08<code>.</code>\uff09\u5206\u9694\u7684\u4e00\u7cfb\u5217 DNS \u6807\u7b7e\uff0c\u603b\u5171\u4e0d\u8d85\u8fc7 253 \u4e2a\u5b57\u7b26\uff1b</li> <li>\u540d\u79f0 &lt;= 63\u5b57\u7b26\uff0c\u5b57\u6bcd\u6570\u5b57\u5f00\u5934\u548c\u7ed3\u5c3e\uff0c\u652f\u6301<code>_-.</code>\u5b57\u7b26\uff1b</li> <li>\u6807\u7b7e\u503c\u683c\u5f0f\uff1a&lt;= 63\u5b57\u7b26\uff0c\u5b57\u6bcd\u6570\u5b57\u5f00\u5934\u548c\u7ed3\u5c3e\uff0c\u652f\u6301<code>_-.</code>\u5b57\u7b26\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_object.html#resourceversion","title":"ResourceVersion","text":"<p>\u5168\u5c40\u552f\u4e00\u7684\u7248\u672c\u53f7\uff08<code>metadata.resourceVersion</code>\uff09\uff0c\u9632\u6b62\u57fa\u4e8e\u540c\u4e00\u4e2a\u7248\u672c\u7684\u5e76\u53d1\u4fee\u6539\u7684\u8986\u76d6\u95ee\u9898\u3002</p> <ul> <li>\u57fa\u4e8e etcd \u7684OptimisticPut \u548c ModRevision \uff08\u4fee\u6539\u8fd9\u4e2a key \u65f6\u96c6\u7fa4\u7684 Revision\uff08\u5168\u5c40\u552f\u4e00\uff0c\u9012\u589e\u5c5e\u6027\uff09\uff09\uff1b</li> </ul> <p>\u6bcf\u4e2a\u8d44\u6e90\u5bf9\u8c61\u4ece\u521b\u5efa\u5f00\u59cb\u5c31\u4f1a\u6709\u4e00\u4e2a\u7248\u672c\u53f7\uff0c\u800c\u540e\u6bcf\u6b21\u88ab\u4fee\u6539\uff08\u4e0d\u7ba1\u662f update \u8fd8\u662f patch \u4fee\u6539\uff09\uff0c\u7248\u672c\u53f7\u90fd\u4f1a\u53d1\u751f\u53d8\u5316\u3002</p> <ul> <li>\u5982\u679c\u4e24\u4e2a\u7528\u6237\u540c\u65f6\u5bf9\u4e00\u4e2a\u8d44\u6e90\u5bf9\u8c61\u505a update\uff0c\u4e0d\u7ba1\u64cd\u4f5c\u7684\u662f\u5bf9\u8c61\u4e2d\u540c\u4e00\u4e2a\u5b57\u6bb5\u8fd8\u662f\u4e0d\u540c\u5b57\u6bb5\uff0c\u90fd\u5b58\u5728\u7248\u672c\u63a7\u5236\u7684\u673a\u5236\u786e\u4fdd\u4e24\u4e2a\u7528\u6237\u7684 update \u8bf7\u6c42\u4e0d\u4f1a\u53d1\u751f\u8986\u76d6\u3002</li> <li>\u540c\u4e00\u4e2a\u7248\u672c\u7684\u5e76\u53d1\u4fee\u6539\uff0c\u53ea\u80fd\u6709\u4e00\u4e2a\u6210\u529f\uff0c\u53e6\u4e00\u4e2a\u518d\u66f4\u6539\u65f6\u4f1a\u53d1\u73b0\u7248\u672c\u53f7\u4e0d\u4e00\u81f4\uff0c\u8fd4\u56de\u51b2\u7a81\u9519\u8bef\uff08409\uff09\uff1b</li> </ul> <p>\u5b98\u65b9\u6587\u6863\u544a\u8bc9\u6211\u4eec\uff0c\u8fd9\u4e2a\u7248\u672c\u53f7\u662f\u4e00\u4e2a K8s \u7684\u5185\u90e8\u673a\u5236\uff0c\u7528\u6237\u4e0d\u5e94\u8be5\u5047\u8bbe\u5b83\u662f\u4e00\u4e2a\u6570\u5b57\u6216\u8005\u901a\u8fc7\u6bd4\u8f83\u4e24\u4e2a\u7248\u672c\u53f7\u5927\u5c0f\u6765\u786e\u5b9a\u8d44\u6e90\u5bf9\u8c61\u7684\u65b0\u65e7\uff0c\u552f\u4e00\u80fd\u505a\u7684\u5c31\u662f\u901a\u8fc7\u6bd4\u8f83\u7248\u672c\u53f7\u76f8\u7b49\u6765\u786e\u5b9a\u5bf9\u8c61\u662f\u5426\u662f\u540c\u4e00\u4e2a\u7248\u672c\uff08\u5373\u662f\u5426\u53d1\u751f\u4e86\u53d8\u5316\uff09\u3002</p>"},{"location":"cloud/k8s/k8s_object.html#generation","title":"Generation","text":"<ul> <li>\u5bf9\u6240\u6709\u53d8\u66f4\u8bf7\u6c42\uff0c\u9664\u975e\u6539\u53d8\u662f\u9488\u5bf9 <code>.metadata</code> \u6216 <code>.status</code>\uff0c<code>.metadata.generation</code> \u7684\u53d6\u503c\u90fd\u4f1a\u589e\u52a0\u3002</li> </ul>"},{"location":"cloud/k8s/k8s_object.html#finalizers","title":"Finalizers","text":"<p><code>Finalizers</code> \u662f\u7531\u5b57\u7b26\u4e32\u7ec4\u6210\u7684\u6570\u7ec4\uff0c\u5f53 <code>Finalizers</code> \u5b57\u6bb5\u4e2d\u5b58\u5728\u5143\u7d20\u65f6\uff0c\u76f8\u5173\u8d44\u6e90\u4e0d\u5141\u8bb8\u88ab\u5220\u9664\u3002</p> <ul> <li>\u4f7f\u7528 Finalizers \u6765\u63a7\u5236\u5bf9\u8c61\u7684\u5783\u573e\u56de\u6536\uff0c \u65b9\u6cd5\u662f\u5728\u5220\u9664\u76ee\u6807\u8d44\u6e90\u4e4b\u524d\u63d0\u9192\u63a7\u5236\u5668\u6267\u884c\u7279\u5b9a\u7684\u6e05\u7406\u4efb\u52a1\u3002</li> </ul> <p>\u6bcf\u5f53\u5220\u9664 namespace \u6216 pod \u7b49\u4e00\u4e9b Kubernetes \u8d44\u6e90\u65f6\uff0c\u6709\u65f6\u8d44\u6e90\u72b6\u6001\u4f1a\u5361\u5728 <code>Terminating</code>\uff0c\u5f88\u957f\u65f6\u95f4\u65e0\u6cd5\u5220\u9664\uff0c\u751a\u81f3\u6709\u65f6\u589e\u52a0 <code>--force</code> flag \u4e4b\u540e\u8fd8\u662f\u65e0\u6cd5\u6b63\u5e38\u5220\u9664\u3002\u8fd9\u65f6\u5c31\u9700\u8981 <code>edit</code> \u8be5\u8d44\u6e90\uff0c\u5c06 <code>finalizers</code> \u5b57\u6bb5\u8bbe\u7f6e\u4e3a []\uff0c\u4e4b\u540e Kubernetes \u8d44\u6e90\u5c31\u6b63\u5e38\u5220\u9664\u4e86\u3002</p> <p>\u5b57\u6bb5\u5c5e\u4e8e Kubernetes GC \u5783\u573e\u6536\u96c6\u5668\uff0c\u662f\u4e00\u79cd\u5220\u9664\u62e6\u622a\u673a\u5236\uff0c\u80fd\u591f\u8ba9\u63a7\u5236\u5668\u5b9e\u73b0\u5f02\u6b65\u7684\u5220\u9664\u524d\uff08Pre-delete\uff09\u56de\u8c03\uff0c\u5b58\u5728\u4e8e\u8d44\u6e90\u5bf9\u8c61\u7684 Meta\u4e2d\u3002</p> <p>\u5bf9\u5e26\u6709 Finalizer \u7684\u5bf9\u8c61\u7684\u7b2c\u4e00\u4e2a\u5220\u9664\u8bf7\u6c42\u4f1a\u4e3a\u5176 <code>metadata.deletionTimestamp</code> \u8bbe\u7f6e\u4e00\u4e2a\u503c\uff0c\u4f46\u4e0d\u4f1a\u771f\u7684\u5220\u9664\u5bf9\u8c61\u3002\u4e00\u65e6\u6b64\u503c\u88ab\u8bbe\u7f6e\uff0cfinalizers \u5217\u8868\u4e2d\u7684\u503c\u5c31\u53ea\u80fd\u88ab\u79fb\u9664\u3002</p> <p>\u5f53 <code>metadata.deletionTimestamp</code> \u5b57\u6bb5\u88ab\u8bbe\u7f6e\u65f6\uff0c\u8d1f\u8d23\u76d1\u6d4b\u8be5\u5bf9\u8c61\u7684\u5404\u4e2a\u63a7\u5236\u5668\u4f1a\u901a\u8fc7\u8f6e\u8be2\u5bf9\u8be5\u5bf9\u8c61\u7684\u66f4\u65b0\u8bf7\u6c42\u6765\u6267\u884c\u5b83\u4eec\u6240\u8981\u5904\u7406\u7684\u6240\u6709 Finalizer\u3002\u5f53\u6240\u6709 Finalizer \u90fd\u88ab\u6267\u884c\u8fc7\uff0c\u8d44\u6e90\u88ab\u5220\u9664\u3002</p> <ul> <li> <p><code>metadata.deletionGracePeriodSeconds</code> \u7684\u53d6\u503c\u63a7\u5236\u5bf9\u66f4\u65b0\u7684\u8f6e\u8be2\u5468\u671f\u3002</p> </li> <li> <p>\u6bcf\u4e2a\u63a7\u5236\u5668\u8981\u8d1f\u8d23\u5c06\u5176 Finalizer \u4ece\u5217\u8868\u4e2d\u53bb\u9664\u3002\u6bcf\u6267\u884c\u5b8c\u4e00\u4e2a\u5c31\u4ece <code>finalizers</code> \u4e2d\u79fb\u9664\u4e00\u4e2a\uff0c\u76f4\u5230 <code>finalizers</code> \u4e3a\u7a7a\uff0c\u4e4b\u540e\u5176\u5bbf\u4e3b\u8d44\u6e90\u624d\u4f1a\u88ab\u771f\u6b63\u7684\u5220\u9664\u3002</p> </li> </ul>"},{"location":"cloud/k8s/k8s_object.html#owner-references","title":"Owner References \u5c5e\u4e3b\u4e0e\u9644\u5c5e","text":"<p>\u4f8b\u5982\uff0cReplicaSet \u662f\u4e00\u7ec4 Pod \u7684\u5c5e\u4e3b\uff0c\u5177\u6709\u5c5e\u4e3b\u7684\u5bf9\u8c61\u662f\u5c5e\u4e3b\u7684\u9644\u5c5e\uff08Dependent\uff09\u3002\u9644\u5c5e\u5bf9\u8c61\u6709\u4e00\u4e2a <code>metadata.ownerReferences</code> \u5b57\u6bb5\uff0c\u7528\u4e8e\u5f15\u7528\u5176\u5c5e\u4e3b\u5bf9\u8c61\u3002\u5728 Kubernetes \u4e2d\u4e0d\u5141\u8bb8\u8de8 namespace \u6307\u5b9a\u5c5e\u4e3b\u3002</p> <p>delete \u7b56\u7565\u8be6\u7ec6\u7684\u5904\u7406\u903b\u8f91\u89c1\u5783\u573e\u56de\u6536</p> <p>Foreground\u7b56\u7565\uff1a\u5148\u5220\u9664\u9644\u5c5e\u5bf9\u8c61\uff0c\u518d\u5220\u9664\u5c5e\u4e3b\u5bf9\u8c61\u3002\u5c06\u5bf9\u8c61\u7684<code>metadata.finalizers</code>\u5b57\u6bb5\u503c\u8bbe\u7f6e\u4e3a<code>foregroundDeletion</code>\uff0c\u63a7\u5236\u5668\u9700\u8981\u4e3b\u52a8\u5904\u7406<code>foregroundDeletion</code>\u7684finalizers\u3002</p> <p>Background\u7b56\u7565\uff08\u9ed8\u8ba4\uff09\uff1a\u5220\u9664\u4e00\u4e2a\u5bf9\u8c61\u540c\u65f6\u4f1a\u5220\u9664\u5b83\u7684\u9644\u5c5e\u5bf9\u8c61\u3002</p> <p>Orphan\u7b56\u7565\uff1a\u4e0d\u4f1a\u81ea\u52a8\u5220\u9664\u5b83\u7684\u9644\u5c5e\u5bf9\u8c61\uff0c\u8fd9\u4e9b\u6b8b\u7559\u7684\u4f9d\u8d56\u88ab\u79f0\u4e3a\u539f\u5bf9\u8c61\u7684\u5b64\u513f\u5bf9\u8c61\u3002</p>"},{"location":"cloud/k8s/k8s_object.html#_3","title":"\u53c2\u8003\u6587\u6863","text":"<ol> <li>Kubernetes API \u6982\u5ff5--ResourceVersion | Kubernetes</li> <li></li> </ol>"},{"location":"cloud/k8s/k8s_resource.html","title":"\u8d44\u6e90\u5bf9\u8c61","text":""},{"location":"cloud/k8s/k8s_resource.html#_2","title":"\u5173\u7cfb","text":"<ul> <li>Pod\uff1a\u5bb9\u5668\u95f4\u7d27\u5bc6\u534f\u4f5c\uff1b</li> <li>Deployment\uff1a\u4f9d\u6b21\u542f\u52a8\u591a\u4e2a\u5e94\u7528\u7684\u5b9e\u4f8b\uff1b</li> <li>Service\uff1a\u56fa\u5b9a\u7684IP\u5730\u5740\u548c\u7aef\u53e3\u4ee5\u8d1f\u8f7d\u5747\u8861\u7684\u5f62\u5f0f\u8bbf\u95ee\uff1b</li> <li>Secret\uff1a\u6388\u6743\u4fe1\u606f\uff0c\u4ee5\u952e\u503c\u5bf9\u6570\u636e\u4fdd\u5b58\u5728etcd\uff1b</li> <li>Job\uff1a\u4e00\u6b21\u6027\u8fd0\u884c\u7684Pod\uff1b</li> <li>DaemonSet\uff1a\u5bbf\u4e3b\u673a\u5fc5\u987b\u4e14\u53ea\u80fd\u8fd0\u884c\u4e00\u4e2a\u526f\u672c\u7684\u5b88\u62a4\u8fdb\u7a0b\u670d\u52a1\uff1b</li> <li>CronJob\uff1a\u5b9a\u65f6\u4efb\u52a1\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#pod","title":"Pod","text":"<p>\u89e3\u51b3\u5bb9\u5668\u95f4\u7d27\u5bc6\u534f\u4f5c\u5173\u7cfb\u7684\u95ee\u9898\u3002</p>"},{"location":"cloud/k8s/k8s_resource.html#pause","title":"\u57fa\u7840\u5bb9\u5668\uff08Pause\uff09","text":"<p>Pod\u91cc\u7684\u5bb9\u5668\u5171\u4eab\u540c\u4e00\u4e2aNetwork Namespace\u3001\u540c\u4e00\u7ec4Volume\uff0c\u5b9e\u73b0\u9ad8\u6548\u7684\u4fe1\u606f\u4ea4\u6362\u3002</p> <p>\u5bb9\u5668\u7684\u201c\u5355\u8fdb\u7a0b\u201d\u6a21\u578b\u4e0d\u662f\u6307\u5bb9\u5668\u91cc\u53ea\u80fd\u8fd0\u884c\u201c\u4e00\u4e2a\u201d\u8fdb\u7a0b\uff0c\u800c\u662f\u6307\u5bb9\u5668\u65e0\u6cd5\u7ba1\u7406\u591a\u4e2a\u8fdb\u7a0b\u3002</p> <ul> <li>\u7528\u6237\u7f16\u5199\u7684\u6b63\u5e38\u7684\u5e94\u7528\u4e0d\u662f\u64cd\u4f5c\u7cfb\u7edf\u91cc\u7684init\u8fdb\u7a0b\u6216\u8005systemmd\u5177\u6709\u8fdb\u7a0b\u7ba1\u7406\u7684\u529f\u80fd\uff0c\u65e0\u6cd5\u89e3\u51b3\u591a\u8fdb\u7a0b\u95f4\u72b6\u6001\u4e00\u81f4\u6027\u7684\u7ba1\u7406\u95ee\u9898\uff1b</li> </ul> <p>Pod\u4e2d\u6709\u57fa\u7840\u5bb9\u5668\uff0c\u79f0\u4e3a <code>pause</code>\u5bb9\u5668\u6216\u8005<code>infra</code>\u5bb9\u5668\uff0cpause\u5bb9\u5668\u4e3b\u8981\u4e3a\u6bcf\u4e2a\u4e1a\u52a1\u5bb9\u5668\u63d0\u4f9b\u4ee5\u4e0b\u529f\u80fd\uff1a</p> <ul> <li>PID\u547d\u540d\u7a7a\u95f4\uff1aPod\u4e2d\u7684\u4e0d\u540c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u770b\u5230\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u7684\u8fdb\u7a0bID\uff1b</li> <li>\u9ed8\u8ba4<code>shareProcessNamespace</code>\u9ed8\u8ba4false\uff0c\u4e0d\u5171\u4eab\u8fdb\u7a0b\u547d\u540d\u7a7a\u95f4\uff1b</li> <li> <p>pause\u8fdb\u7a0b\u4f5c\u4e3a\u6bcf\u4e2a<code>pod</code>\u7684<code>PID 1</code>\u8fdb\u7a0b\uff08\u6839\u8fdb\u7a0b\uff09\uff0c\u5e76\u56de\u6536\u50f5\u5c38\u8fdb\u7a0b\u3002</p> </li> <li> <p>\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\uff1aPod\u4e2d\u7684\u591a\u4e2a\u5bb9\u5668\u80fd\u591f\u8bbf\u95ee\u540c\u4e00\u4e2aIP\u548c\u7aef\u53e3\u8303\u56f4\uff1b</p> </li> <li>IPC\u547d\u540d\u7a7a\u95f4\uff1aPod\u4e2d\u7684\u591a\u4e2a\u5bb9\u5668\u80fd\u591f\u4f7f\u7528SystemV IPC\u6216POSIX\u6d88\u606f\u961f\u5217\u8fdb\u884c\u901a\u4fe1\uff1b</li> <li>UTS\u547d\u540d\u7a7a\u95f4\uff1aPod\u4e2d\u7684\u591a\u4e2a\u5bb9\u5668\u5171\u4eab\u4e00\u4e2a\u4e3b\u673a\u540d\uff1b</li> <li>\u5b58\u50a8\u7a7a\u95f4\uff1aPod\u4e2d\u7684\u5404\u4e2a\u5bb9\u5668\u53ef\u4ee5\u8bbf\u95ee\u5728Pod\u7ea7\u522b\u5b9a\u4e49\u7684Volumes\u3002</li> </ul> <p></p> <p>Pause\u5bb9\u5668\u7684\u6e90\u7801</p> <pre><code>/*\nCopyright 2016 The Kubernetes Authors.\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n    http://www.apache.org/licenses/LICENSE-2.0\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n#include &lt;signal.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\nstatic void sigdown(int signo) {\n  psignal(signo, \"Shutting down, got signal\");\n  exit(0);\n}\n\nstatic void sigreap(int signo) {\n  while (waitpid(-1, NULL, WNOHANG) &gt; 0);\n}\n\nint main() {\n  if (getpid() != 1)\n    /* Not an error because pause sees use outside of infra containers. */\n    fprintf(stderr, \"Warning: pause should be the first process\\n\");\n\n  if (sigaction(SIGINT, &amp;(struct sigaction){.sa_handler = sigdown}, NULL) &lt; 0)\n    return 1;\n  if (sigaction(SIGTERM, &amp;(struct sigaction){.sa_handler = sigdown}, NULL) &lt; 0)\n    return 2;\n  if (sigaction(SIGCHLD, &amp;(struct sigaction){.sa_handler = sigreap,\n                                             .sa_flags = SA_NOCLDSTOP},\n                NULL) &lt; 0)\n    return 3;\n\n  for (;;)\n    pause();\n  fprintf(stderr, \"Error: infinite loop terminated\\n\");\n  return 42;\n}\n</code></pre> <p><code>pause</code>\u5bb9\u5668\u4e0d\u4ec5\u4ec5\u8c03\u7528<code>pause()</code>\u4f7f\u8fdb\u7a0b\u4f11\u7720\uff0c\u5e76\u5047\u5b9a\u81ea\u5df1\u4e3a<code>PID 1</code>\u7684\u89d2\u8272\uff0c\u5f53\u50f5\u5c38\u8fdb\u7a0b\u88ab\u5176\u7236\u8fdb\u7a0b\u5b64\u7acb\u65f6\uff0c\u901a\u8fc7\u8c03\u7528<code>wait</code>\u6765\u83b7\u53d6\u50f5\u5c38\u8fdb\u7a0b(\u89c1<code>sigreap</code>)\u3002 \u8fd9\u6837\u4e00\u6765\u5c31\u4e0d\u4f1a\u5728<code>Kubernetes pod</code>\u7684<code>PID</code>\u547d\u540d\u7a7a\u95f4\u4e2d\u5806\u79ef\u50f5\u5c38\u8fdb\u7a0b\u3002</p>"},{"location":"cloud/k8s/k8s_resource.html#initinitcontainers","title":"Init\u5bb9\u5668\uff08initContainers\uff09","text":"<p>Init \u5bb9\u5668\u662f\u4e00\u79cd\u7279\u6b8a\u5bb9\u5668\uff0c\u5728 Pod \u5185\u7684\u5e94\u7528\u5bb9\u5668\u542f\u52a8\u4e4b\u524d\u8fd0\u884c\u3002Init \u5bb9\u5668\u53ef\u4ee5\u5305\u62ec\u4e00\u4e9b\u5e94\u7528\u955c\u50cf\u4e2d\u4e0d\u5b58\u5728\u7684\u5b9e\u7528\u5de5\u5177\u548c\u5b89\u88c5\u811a\u672c\u3002</p> <p>Init \u5bb9\u5668\u4e0e\u666e\u901a\u7684\u5bb9\u5668\u975e\u5e38\u50cf\uff08\u5305\u62ec\u91cd\u542f\u7b56\u7565\uff09\uff0c\u9664\u4e86\u5982\u4e0b\u4e24\u70b9\uff1a</p> <ul> <li>\u5b83\u4eec\u603b\u662f\u8fd0\u884c\u5230\u5b8c\u6210\u3002</li> <li>\u6bcf\u4e2a\u90fd\u5fc5\u987b\u5728\u4e0b\u4e00\u4e2a\u542f\u52a8\u4e4b\u524d\u6210\u529f\u5b8c\u6210\u3002</li> </ul> <pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: test-init\n  name: test-init\n  namespace: kube-public\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: test-init\n  template:\n    metadata:\n      labels:\n        app: test-init\n    spec:\n      volumes:\n      - name: data\n        emptyDir: {}\n      initContainers:\n      - name: fix-permissions\n        image: busybox\n        command: [\"sh\", \"-c\", \"chown -R 1000:1000 /usr/share/elasticsearch/data\"]\n        securityContext:\n        privileged: true\n        volumeMounts:\n          - name: data\n          mountPath: /usr/share/elasticsearch/data\n      - name: increase-vm-max-map\n        image: busybox\n        command: [\"sysctl\", \"-w\", \"vm.max_map_count=262144\"]\n        securityContext:\n        privileged: true\n      containers:\n      - image: nginx\n        imagePullPolicy: IfNotPresent\n        name: test-init\n        volumeMounts:\n        - name: data\n          mountPath: /mnt\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#sidecar","title":"\u8fb9\u8f66\u5bb9\u5668\uff08sidecar\uff09","text":"<p>\u5bb9\u5668\u8bbe\u8ba1\u6a21\u5f0f\u4e2d\u7684\u7ec4\u5408\u64cd\u4f5c\uff0c\u5728\u4e00\u4e2aPod\u542f\u52a8\u4e00\u4e2a\u8f85\u52a9\u5bb9\u5668\uff08InitContainer\uff09\uff0c\u6765\u5b8c\u6210\u4e00\u4e9b\u72ec\u7acb\u4e8e\u4e3b\u8fdb\u7a0b\uff08\u4e3b\u5bb9\u5668\uff09\u7684\u5de5\u4f5c\u3002</p> <ul> <li>\u5e94\u7528\u670d\u52a1war\u5305\u5bb9\u5668 + tomcat\u5bb9\u5668\uff1b</li> <li>\u65e5\u5fd7\u6536\u96c6\u5bb9\u5668 + \u4e3b\u5e94\u7528\u5bb9\u5668\uff1b</li> <li>Istio\u5fae\u670d\u52a1\u6cbb\u7406\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#_3","title":"\u751f\u547d\u5468\u671f\u548c\u91cd\u542f\u7b56\u7565","text":""},{"location":"cloud/k8s/k8s_resource.html#pod_1","title":"Pod\u9636\u6bb5\u548c\u72b6\u6001","text":"<p>Pod\u7684\u9636\u6bb5( phase \uff09\uff1a<code>pod.status.phase</code></p> <ul> <li>Pending\uff1aPod \u5b9a\u4e49\u6b63\u786e\uff0c\u4f46Pod\u5185\u8fd8\u6709\u81f3\u5c11\u4e00\u4e2a\u5bb9\u5668\u7684\u955c\u50cf\u6ca1\u6709\u521b\u5efa\uff1b</li> <li>Running\uff1aPod\u5185\u5bb9\u5668\u5747\u5df2\u521b\u5efa\uff0c\u4e14\u81f3\u5c11\u4e00\u4e2a\u5bb9\u5668\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\u3001\u6b63\u5728\u542f\u52a8\u72b6\u6001\u6216\u6b63\u5728\u91cd\u542f\u72b6\u6001\uff1b</li> <li>Succeeded\uff1aPod\u5185\u5bb9\u5668\u5747\u6210\u529f\u6267\u884c\u540e\u9000\u51fa\uff0c\u4e14\u4e0d\u4f1a\u518d\u91cd\u542f\uff1b</li> <li>Failed\uff1aPod\u5185\u5bb9\u5668\u5747\u5df2\u9000\u51fa\uff0c\u4f46\u81f3\u5c11\u4e00\u4e2a\u5bb9\u5668\u4e3a\u9000\u51fa\u5931\u8d25\u72b6\u6001\uff1b</li> <li>Unknown\uff1a\u67d0\u79cd\u539f\u56e0\u65e0\u6cd5\u83b7\u53d6Pod\u72b6\u6001\uff0c\u5982\u7f51\u7edc\u901a\u4fe1\u4e0d\u7545\uff1b</li> </ul> <p>Pod\u7684\u72b6\u51b5\uff08condition\uff09\uff1a<code>pod.status.conditions</code></p> <ul> <li> <p><code>Unschedulable</code>\uff1a\u8c03\u5ea6\u5668\u4e0d\u80fd\u6b63\u5e38\u8c03\u5ea6\u5bb9\u5668\uff0c\u4f8b\u5982\u7f3a\u4e4f\u8d44\u6e90\u6216\u5176\u4ed6\u9650\u5236\uff1b</p> </li> <li> <p><code>PodScheduled</code>\uff1aPod \u5df2\u88ab\u8c03\u5ea6\u5230\u4e00\u4e2a\u8282\u70b9\uff1b</p> </li> <li><code>Initialized</code>\uff1a\u6240\u6709 init containers \u6210\u529f\u542f\u52a8\uff1b</li> <li><code>ContainersReady</code>\uff1aPod \u4e2d\u6240\u6709\u5bb9\u5668\u5168\u90e8\u5c31\u7eea\uff1b</li> <li><code>Ready</code>\uff1aPod \u80fd\u591f\u63d0\u4f9b\u8bf7\u6c42( readiness probe \u5b8c\u6210)\uff1b</li> </ul> <p>Pod \u7684\u72b6\u6001\uff08RUNNING\uff09\u8ddf<code>kubectl get pods</code>\u663e\u793a\u7684Status\uff08CrashLoopBackOff\uff09\u4e3a\u4ec0\u4e48\u4e0d\u4e00\u81f4\uff1f</p> <ul> <li>\u5bf9\u4e8e\u5f02\u5e38\u60c5\u51b5\uff0ckubectl\u770b\u5230\u7684\u72b6\u6001\u5c31\u662f<code>containerStatuses</code>\u7684 \u5bb9\u5668\u91cc\u7684<code>state.waiting.reason</code>\uff1b</li> <li>\u6e90\u7801\u89c1<code>pkg/kubectl/resource_printer.go</code>\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#_4","title":"\u5bb9\u5668\u7684\u72b6\u6001","text":"<p>Waiting\uff1a\u5bb9\u5668\u5e76\u4e0d\u5904\u5728 <code>Running</code> \u6216 <code>Terminated</code> \u72b6\u6001\u4e4b\u4e00\uff0c\u5b83\u5c31\u5904\u5728 <code>Waiting</code> \u72b6\u6001</p> <p>Running\uff1a\u5bb9\u5668\u6b63\u5728\u6267\u884c\u72b6\u6001\u5e76\u4e14\u6ca1\u6709\u95ee\u9898\u53d1\u751f</p> <p>Terminated\uff1a\u5df2\u7ecf\u5f00\u59cb\u6267\u884c\u5e76\u4e14\u6216\u8005\u6b63\u5e38\u7ed3\u675f\u6216\u8005\u56e0\u4e3a\u67d0\u4e9b\u539f\u56e0\u5931\u8d25</p>"},{"location":"cloud/k8s/k8s_resource.html#_5","title":"\u5bb9\u5668\u751f\u547d\u5468\u671f\u56de\u8c03","text":"<p>PostStart\uff1a\u5728\u5bb9\u5668\u88ab\u521b\u5efa\u4e4b\u540e\u7acb\u5373\u88ab\u6267\u884c\uff08\u5f02\u6b65\uff09\u3002 \u4f46\u4e0d\u80fd\u4fdd\u8bc1\u56de\u8c03\u4f1a\u5728\u5bb9\u5668\u5165\u53e3\u70b9\uff08ENTRYPOINT\uff09\u4e4b\u524d\u6267\u884c\u3002 </p> <p>PreStop\uff1a\u56e0 API \u8bf7\u6c42\u6216\u8005\u7ba1\u7406\u4e8b\u4ef6\uff08\u8bf8\u5982\u5b58\u6d3b\u6001\u63a2\u9488\u3001\u542f\u52a8\u63a2\u9488\u5931\u8d25\u3001\u8d44\u6e90\u62a2\u5360\u3001\u8d44\u6e90\u7ade\u4e89\u7b49\uff09 \u800c\u88ab\u7ec8\u6b62\u4e4b\u524d</p> <ul> <li><code>Job</code>\u7c7b\u578b\u7684Pod\u5b8c\u6210\u65f6\uff0c\u4e0d\u4f1a\u89e6\u53d1 PreStop\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#container-restart-policy","title":"\u91cd\u542f\u7b56\u7565(Container restart policy)","text":"<p>\u4e0e Pod \u9a71\u9010\u4e0d\u540c\uff0c\u5982\u679c\u5bb9\u5668\u88ab OOM \u6740\u6b7b\uff0c <code>kubelet</code> \u53ef\u4ee5\u6839\u636e\u5176 <code>restartPolicy</code> \u91cd\u65b0\u542f\u52a8\u5b83</p> <p>\u5e94\u7528\u4e8ePod\u5185\u7684\u6240\u6709\u5bb9\u5668\uff0c<code>pod.spec.restartPolicy</code></p> <ul> <li>Always\uff1a\u9ed8\u8ba4\uff0c\u4efb\u4f55\u60c5\u51b5\u4e0b\uff0c\u53ea\u8981\u5bb9\u5668\u4e0d\u5728\u8fd0\u884c\u72b6\u6001\uff0c\u5c31\u81ea\u52a8\u91cd\u542f\u5bb9\u5668\uff1b</li> <li>OnFailure\uff1a\u5bb9\u5668\u4ee5\u975e 0 \u72b6\u6001\u9000\u51fa\u6216\u8005\u88ab\u7cfb\u7edf\u7ec8\u6b62\uff1b\uff08\u6bd4\u5982\u5bf9\u4e8eFAAS\u7b49\u77ed\u65f6\u95f4\u5e94\u7528\uff09</li> <li>Never\uff1a\u4ece\u4e0d\u91cd\u542f\u5bb9\u5668\u3002\uff08\u9700\u8981\u4fdd\u7559\u5bb9\u5668\u9000\u51fa\u540e\u7684\u65e5\u5fd7\u3001\u6587\u4ef6\u3001\u76ee\u5f55\u7b49\u4fe1\u606f\uff09</li> </ul> <p>\u7b80\u8a00\u4e4b\uff1a</p> <ul> <li>Always\u548cOnFailure\uff1a\u5bb9\u5668\u5f02\u5e38\uff0cPod\u4f1a\u4fdd\u6301Running\u7684\u72b6\u6001\u5e76\u91cd\u542f\u5bb9\u5668\uff1b</li> <li>Never\uff1a\u5305\u542b\u591a\u4e2a\u5bb9\u5668\u7684Pod\uff0c\u53ea\u6709\u5176\u4e2d\u6240\u6709\u5bb9\u5668\u90fd\u8fdb\u5165\u5f02\u5e38\u72b6\u6001\u540e\uff0cPod\u624d\u4f1a\u8fdb\u5165Failed\u72b6\u6001\u3002\u5728\u6b64\u4e4b\u524d\uff0cPod\u90fd\u662fRunning\u72b6\u6001\uff0c\u5176Ready\u5b57\u6bb5\u663e\u793a\u6b63\u5e38\u7684\u5bb9\u5668\u4e2a\u6570\u3002</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#_6","title":"\u5bb9\u5668\u7684\u5065\u5eb7\u68c0\u67e5","text":"<p>Pod\u91cc\u7684\u5bb9\u5668\u7684\u5065\u5eb7\u68c0\u67e5\uff1a\u652f\u6301<code>exec</code>\u6267\u884c\u547d\u4ee4\uff08\u8fd4\u56de0\u8868\u793a\u5065\u5eb7\uff09\uff0c\u6216\u8005<code>httpGet</code>\uff0c<code>tcpsocket</code>\u8bf7\u6c42\uff1b</p> <ul> <li><code>livenessProbe</code>\uff1a\u6307\u793a\u5bb9\u5668\u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002</li> <li>\u5b58\u6d3b\u6001\u63a2\u6d4b\u5931\u8d25\uff0c\u5219 kubelet \u4f1a\u6740\u6b7b\u5bb9\u5668\uff0c \u5e76\u4e14\u5bb9\u5668\u5c06\u6839\u636e\u5176\u91cd\u542f\u7b56\u7565\u51b3\u5b9a\uff1b</li> <li>\u5982\u679c\u5bb9\u5668\u4e0d\u63d0\u4f9b\u5b58\u6d3b\u63a2\u9488\uff0c \u5219\u9ed8\u8ba4\u72b6\u6001\u4e3a Success\u3002</li> <li><code>readinessProbe</code>\uff1a\u6307\u793a\u5bb9\u5668\u662f\u5426\u51c6\u5907\u597d\u4e3a\u8bf7\u6c42\u63d0\u4f9b\u670d\u52a1\uff08\u7528\u4e8e Service\u505a\u8d1f\u8f7d\u5747\u8861\uff09</li> <li>\u5c31\u7eea\u6001\u63a2\u6d4b\u5931\u8d25\uff08Pod\u7684\u72b6\u6001\u4e3a NotReady\uff09\uff0c \u7aef\u70b9\u63a7\u5236\u5668\u5c06\u4ece\u4e0e Pod \u5339\u914d\u7684\u6240\u6709Services\u7684\u7aef\u70b9\u5217\u8868\u4e2d\u5220\u9664\u8be5 Pod \u7684 IP \u5730\u5740\uff1b</li> <li>\u5bb9\u5668\u4e0d\u63d0\u4f9b\u5c31\u7eea\u6001\u63a2\u9488\uff0c\u5219\u9ed8\u8ba4\u72b6\u6001\u4e3a <code>Success</code>\u3002</li> <li><code>startupProbe</code>\uff1a\u6307\u793a\u5bb9\u5668\u4e2d\u7684\u5e94\u7528\u662f\u5426\u5df2\u7ecf\u542f\u52a8\uff0c\u53ea\u6267\u884c\u4e00\u6b21\u3002</li> <li>\u63d0\u4f9b\u4e86\u542f\u52a8\u63a2\u9488\uff0c\u5219\u6240\u6709\u5176\u4ed6\u63a2\u9488\u90fd\u4f1a\u88ab\u7981\u7528\uff0c\u76f4\u5230\u6b64\u63a2\u9488\u6210\u529f\u4e3a\u6b62\uff1b</li> <li>\u542f\u52a8\u63a2\u6d4b\u5931\u8d25\uff0c<code>kubelet</code> \u5c06\u6740\u6b7b\u5bb9\u5668\uff0c\u800c\u5bb9\u5668\u4f9d\u5176\u91cd\u542f\u7b56\u7565\u8fdb\u884c\u91cd\u542f\uff1b</li> <li>\u5982\u679c\u5bb9\u5668\u6ca1\u6709\u63d0\u4f9b\u542f\u52a8\u63a2\u6d4b\uff0c\u5219\u9ed8\u8ba4\u72b6\u6001\u4e3a <code>Success</code>\u3002</li> </ul> <p>\u6ce8\u610f\uff1a</p> <ul> <li>\u5982\u679c\u4e0d\u4f7f\u7528Deployment\u8fd9\u6837\u7684\u63a7\u5236\u5668\uff0cPod\u7684\u6062\u590d\uff08\u91cd\u542f\uff09\u6c38\u8fdc\u53d1\u751f\u5728\u5f53\u524d\u8282\u70b9\u4e0a\u800c\u4e0d\u4f1a\u8fc1\u79fb\u3002</li> </ul> <pre><code>spec:\n  containers:\n  - name: liveness\n    image: busybox\n    args:\n    - /bin/sh\n    - -c\n    - touch /tmp/healthy; sleep 30; rm -rf /tmp/healthy; sleep 600\n    # \u5b58\u6d3b\u63a2\u9488\n    livenessProbe:\n      exec:\n        command:\n        - cat\n        - /tmp/healthy\n      initialDelaySeconds: 5\n      periodSeconds: 5\n    # \u542f\u52a8\u63a2\u9488\n    startupProbe:\n      httpGet:\n        path: /healthz\n        port: liveness-port\n      failureThreshold: 30\n      periodSeconds: 10\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#cmdargs","title":"Cmd/Args","text":"<p>\u5efa\u8bae\u5728 K8s \u4e2d\u5b9a\u4e49 command \u548c args\uff0c\u5ffd\u7565 Dockerfile \u4e2d\u7684 ENTRYPOINT \u548c CMD\u3002</p> <ul> <li>K8s \u4e2d command \u4f7f\u7528 exec \u6a21\u5f0f\u542f\u52a8\uff081\u53f7\u8fdb\u7a0b\uff09</li> </ul> <p>\u5728kubernetes\u4e2d\u7684 yaml \u6587\u4ef6\u4e2d\u5199\u4e86<code>command</code>\u548c<code>args</code>\u7684\u65f6\u5019\uff0c\u9ed8\u8ba4\u662f\u4f1a\u8986\u76d6<code>DockerFile</code>\u4e2d\u7684\u547d\u4ee4\u884c\uff08ENTRYPOINT \uff09\u548c\u53c2\u6570\uff08CMD\uff09\uff0c\u5b8c\u6574\u7684\u60c5\u51b5\u5206\u7c7b\u5982\u4e0b\uff1a</p> <ul> <li>\u5982\u679ccommand \u548c args \u90fd\u6ca1\u6709\u5199\uff0c\u90a3\u4e48\u7528<code>DockerFile</code>\u9ed8\u8ba4\u7684\u914d\u7f6e\uff1b</li> <li>\u5982\u679ccommand \u5199\u4e86\uff0c\u4f46 args \u6ca1\u6709\u5199\uff0c\u90a3\u4e48 Docker \u9ed8\u8ba4\u7684\u914d\u7f6e\u4f1a\u88ab\u5ffd\u7565\u800c\u4e14\u4ec5\u4ec5\u6267\u884c<code>.yaml</code>\u6587\u4ef6\u7684command\uff08\u4e0d\u5e26\u4efb\u4f55\u53c2\u6570\u7684\uff09\uff1b</li> <li>\u5982\u679ccommand\u6ca1\u5199\uff0c\u4f46args\u5199\u4e86\uff0c\u90a3\u4e48Docker\u9ed8\u8ba4\u914d\u7f6e\u7684ENTRYPOINT\u7684\u547d\u4ee4\u884c\u4f1a\u88ab\u6267\u884c\uff0c\u4f46\u662f\u8c03\u7528\u7684\u53c2\u6570\u662f<code>.yaml</code>\u4e2d\u7684args\uff1b</li> <li>\u5982\u679ccommand\u548cargs\u90fd\u5199\u4e86\uff0c\u90a3\u4e48Docker\u9ed8\u8ba4\u7684\u914d\u7f6e\u88ab\u5ffd\u7565\uff0c\u4f7f\u7528<code>.yaml</code>\u7684\u914d\u7f6e\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#_7","title":"\u5377\u6302\u8f7d\u4f20\u64ad","text":"<p>\u6302\u8f7d\u4f20\u64ad\u63d0\u4f9b\u5171\u4eab\u5377\u6302\u8f7d\u7684\u80fd\u529b, \u5b83\u5141\u8bb8\u5728\u540c\u4e00\u4e2a Pod\uff0c\u751a\u81f3\u540c\u4e00\u4e2a\u8282\u70b9\u5185\uff0c\u5728\u591a\u4e2a\u5bb9\u5668\u4e4b\u95f4\u5171\u4eab\u5377\u7684\u6302\u8f7d\u3002\u5373\u5728\u5bb9\u5668\u6216 <code>host</code> \u5185\u7684\u6302\u8f7d\u76ee\u5f55\u4e2d \u518d <code>mount</code> \u4e00\u4e2a\u522b\u7684\u6302\u8f7d\u3002</p> <p>\u7531 <code>Container.volumeMounts</code> \u7684 <code>mountPropagation</code> \u5b57\u6bb5\u63a7\u5236\uff1a</p> <ul> <li><code>None:</code> \u5bb9\u5668\u5185\u548c <code>host</code> \u7684\u540e\u7eed\u6302\u8f7d\u5b8c\u5168\u9694\u79bb\uff0c\u8fd9\u79cd\u5377\u6302\u8f7d\u5c06\u4e0d\u4f1a\u6536\u5230\u4efb\u4f55\u540e\u7eed\u7531 <code>host</code> \u521b\u5efa\u7684\u5728\u8fd9\u4e2a\u5377\u4e0a\u6216\u5176\u5b50\u76ee\u5f55\u4e0a\u7684\u6302\u8f7d\u3002\u540c\u6837\u7684, \u7531\u5bb9\u5668\u521b\u5efa\u7684\u6302\u8f7d\u5728 <code>host</code> \u4e0a\u4e5f\u662f\u4e0d\u53ef\u89c1\u3002</li> <li><code>HostToContainer:</code> - \u8fd9\u79cd\u5377\u6302\u8f7d\u5c06\u4f1a\u6536\u5230\u4e4b\u540e\u6240\u6709\u7684\u7531 <code>host</code> \u521b\u5efa\u5728\u8be5\u5377\u4e0a\u6216\u5176\u5b50\u76ee\u5f55\u4e0a\u7684\u6302\u8f7d\u3002\u6362\u53e5\u8bdd\u8bf4, \u5982\u679c <code>host</code> \u5728\u5377\u6302\u8f7d\u5185\u6302\u8f7d\u7684\u4efb\u4f55\u5185\u5bb9, \u5728\u5bb9\u5668\u4e2d\u90fd\u662f\u53ef\u89c1\u7684\u3002\u540c\u6837, \u5982\u679c\u4efb\u4f55\u5177\u6709 <code>Bidirectional</code> \u7684 Pod \u6302\u8f7d\u4f20\u64ad\u5230\u8be5\u5377\u6302\u8f7d\u4e0a, \u5177\u6709 <code>HostToContainer</code> \u7684\u6302\u8f7d\u4f20\u64ad\u90fd\u53ef\u4ee5\u770b\u89c1\u3002</li> <li><code>Bidirectional:</code> - \u8fd9\u79cd\u6302\u8f7d\u673a\u5236\u548c <code>HostToContainer</code> \u7c7b\u4f3c\u3002\u6b64\u5916, \u4efb\u4f55\u5728\u5bb9\u5668\u4e2d\u521b\u5efa\u7684\u6302\u8f7d\u90fd\u4f1a\u4f20\u64ad\u5230 <code>host</code>, \u7136\u540e\u4f20\u64ad\u5230\u4f7f\u7528\u76f8\u540c\u5377\u7684\u6240\u6709 Pod \u7684\u6240\u6709\u5bb9\u5668\u3002\u6ce8\u610f: <code>Bidirectional</code> \u6302\u8f7d\u4f20\u64ad\u662f\u5f88\u5371\u9669\u7684\u3002\u53ef\u80fd\u4f1a\u5371\u5bb3\u5230 <code>host</code> \u7684\u64cd\u4f5c\u7cfb\u7edf\u3002\u56e0\u6b64\u53ea\u6709\u7279\u6743 <code>securityContext: privileged: true</code> \u5bb9\u5668\u5728\u5141\u8bb8\u4f7f\u7528\u5b83\u3002</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#lifecycle","title":"Lifecycle","text":"<p><code>postStart</code>\uff1a\u5728\u5bb9\u5668\u542f\u52a8\u540e\u7acb\u523b\u6267\u884c\u4e00\u4e2a\u6307\u5b9a\u64cd\u4f5c\uff0c\u8ddf<code>ENTRYPOINT</code>\u662f\u5f02\u6b65\u6267\u884c\u7684\uff1b</p> <p><code>preStop</code>\uff1a\u5bb9\u5668\u7ed3\u675f\u524d\u6267\u884c\u64cd\u4f5c\uff0c\u540c\u6b65\u6267\u884c\u5373\u4f1a\u963b\u585e\u5f53\u524d\u7684\u5bb9\u5668\u7ed3\u675f\u6d41\u7a0b\u3002</p>"},{"location":"cloud/k8s/k8s_resource.html#_8","title":"\u914d\u7f6e","text":"<p>\u901a\u5e38\u4e0d\u9700\u8981\u76f4\u63a5\u521b\u5efa Pod\uff0c\u751a\u81f3\u5355\u5b9e\u4f8b Pod\u3002 \u76f8\u53cd\u4f7f\u7528\u8bf8\u5982 Deployment\u6216 Job\u8fd9\u7c7b\u5de5\u4f5c\u8d1f\u8f7d\u8d44\u6e90\u6765\u521b\u5efa Pod\u3002</p> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\n  labels:\n    env: test\nspec:\n  # \u5c06pod\u8c03\u5ea6\u5230kube-01\u8282\u70b9\u4e0a\u8fd0\u884c\uff08\u8c03\u5ea6\u4f18\u5148\u7ea7\u6700\u9ad8\uff09\n  nodeName: kube-01\n  # \u5c06pod\u8c03\u5ea6\u5230\u5177\u6709disktype=ssd\u6807\u7b7e\u7684\u8282\u70b9\u4e0a\uff08\u9884\u88ab\u5e9f\u5f03\uff09\n  nodeSelector:\n    disktype: ssd\n  # \u4eb2\u548c\u6027\n  affinity:\n    # \u8282\u70b9\n    nodeAffinity:\n    # \u5728\u6bcf\u6b21\u8c03\u5ea6\u65f6\u8003\u8651\uff0c\u6267\u884c\u671f\u95f4\u6807\u7b7e\u4e0d\u6ee1\u8db3\u65f6\uff0c\u4e0d\u4f1a\u91cd\u65b0\u8c03\u5ea6\n      requiredDuringSchedulingIgnoredDuringExecution:\n        nodeSelectorTerms:\n        - matchExpressions:\n          - key: kubernetes.io/e2e-az-name\n            operator: In\n            values:\n            - e2e-az1\n            - e2e-az2\n  # \u5728/ect/hosts\u4e2d\u6dfb\u52a0\u57df\u540d\u5230ip\u7684\u6620\u5c04\n  hostAliases:\n    - ip: \"10.2.1.2\"\n      host.names:\n        - \"foo.remote\"\n        - \"bar.remote\"\n  # Pod\u91cc\u7684\u5bb9\u5668\u5171\u4eabPID Namespace\uff08\u9ed8\u8ba4\u662f\u5f00\u542f\uff09\n  shareProcessNamespace: true\n  # \u5bb9\u5668\u91cd\u542f\u7b56\u7565\uff08Always\uff0cNever\uff0cOnFailure\uff09\uff0c\u9ed8\u8ba4\u4e3aAlways\n  restartPolicy: Always\n  # \u8282\u70b9\u5bb9\u5fcd\u6027\uff08\u80fd\u591f\u5728k8s master\u8282\u70b9\u4e0a\u8fd0\u884c\uff09\n  tolerations:\n  - key: node-role.kubernetes.io/master\n    operator: Exists\n    effect: NoSchedule\n  # init\u5bb9\u5668\u7684\u914d\u7f6e\uff08\u4f9d\u6b21\u6267\u884c\u5e76\u9000\u51fa\uff09\n  initContainers:\n  - image: geektime/sample:v2\n    name: war\n    command: [\"cp\", \"/sample.war\", \"/app\"]\n    volumeMounts:\n    - mountPath: /app\n      name: app-volume\n  containers:\n  - name: cat-hosts\n    image: nginx\n    lifecycle:\n      # postStart\u542f\u52a8\u65f6\uff0cENTRYPOINT\u53ef\u80fd\u5c1a\u672a\u7ed3\u675f\n      postStart:\n        exec:\n          command: [\"/bin/bash\", \"-c\", \"echo Hello from the postStart handler &gt; /usr/share/message\"]\n      # \u4f18\u96c5\u9000\u51fa\n      preStop:\n        exec:\n          command: [\"/usr/bin/nginx\", \"-s\", \"quit\"]\n    command:\n    - cat\n    args:\n    - \"/etc/hosts\"\n    ports:\n    - containerPort: 80\n      name: web\n      # \u4e3b\u673a\u7684\u7aef\u53e3\u53f7\uff08\u4e00\u822c\u4e0d\u7528\uff0c\u800c\u662f\u901a\u8fc7Service\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\uff09\n      hostPort: 2039\n    # \u5bb9\u5668\u7684\u5065\u5eb7\u68c0\u67e5\n    livenessProbe:\n      exec:\n        command:\n        - cat\n        - /tmp/healthy\n      initialDelaySeconds: 5\n      periodSeconds: 5\n    # \u5c31\u7eea\u68c0\u6d4b\u8d85\u8fc72s\u540e\uff0ckubelet\u4e0d\u4f1a\u91cd\u65b0\u542f\u52a8Pod\uff0c\u800c\u662f\u5c06\u6d41\u91cf\u8def\u7531\u5230\u5176\u4ed6\u5065\u5eb7\u7684Pod\u4e0a\u3002\n    # \u7b49\u5230Pod\u4e0d\u518d\u8fc7\u8f7d\u540e\uff0ckubelet\u4f1a\u5c06Pod\u91cd\u65b0\u52a0\u56de\u5230\u539f\u6765\u7684Service\u4e2d\u3002\n    readinessProbe:\n      httpGet:\n        path: /\n        port: 8080\n      timeoutSeconds: 2\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#deployment","title":"Deployment","text":""},{"location":"cloud/k8s/k8s_resource.html#replicaset","title":"ReplicaSet","text":"<p><code>Deployment</code>\u7ba1\u7406\u662f<code>ReplicaSet</code>\uff0c<code>ReplicaSet</code>\u7ba1\u7406\u7684\u662f<code>Pod</code>\u3002</p> <p></p> <p>\u53ea\u5141\u8bb8<code>restartPolicy=Always</code></p> <ul> <li>ReplicaSet\u901a\u8fc7\u63a7\u5236\u5668\u6a21\u5f0f\u4fdd\u8bc1\u7cfb\u7edf\u4e2d\u7684Pod\u7684\u4e2a\u6570\u6c38\u8fdc\u7b49\u4e8e\u6307\u5b9a\u4e2a\u6570(replica\u7684\u503c)\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#_9","title":"\u6eda\u52a8\u66f4\u65b0","text":"<p>\u4fee\u6539Deployment\u7684Pod\u6a21\u677f\u540e\uff0c\u81ea\u52a8\u89e6\u53d1\u201c\u6eda\u52a8\u66f4\u65b0\u201d\uff1a\u670d\u52a1\u591a\u5b9e\u4f8b\u90e8\u7f72\u65f6\u5728\u7ebf\u5347\u7ea7</p> <ul> <li>\u6839\u636e\u65b0\u7684Pod\u6a21\u677f\uff0c\u521b\u5efa\u65b0\u7684ReplicaSet\uff0c\u521d\u59cb\u526f\u672c\u6570\u4e3a0\uff1b</li> <li>\u65b0\u7684ReplicaSet\u526f\u672c\u6570\u9010\u6e10\u589e\u591a\uff0c\u65e7\u7684ReplicaSet\u526f\u672c\u6570\u9010\u6e10\u51cf\u5c11\uff1b</li> </ul> <p><code>spec.strategy,type</code>\u5b9a\u4e49\u5347\u7ea7\u7b56\u7565\uff0c\u6eda\u52a8\u5347\u7ea7\u5bf9\u5e94<code>RollingUpdate</code>\uff0c\u914d\u7f6e\uff1a</p> <ul> <li>\u786e\u4fdd\u5728\u4efb\u4f55\u65f6\u95f4\u7a97\u53e3\uff0c\u53ea\u6709\u6307\u5b9a\u6bd4\u4f8bPod\u5904\u4e8e\u79bb\u7ebf\u72b6\u6001\uff0c\u540c\u65f6\u53ea\u6709\u6307\u5b9a\u6bd4\u4f8b\u7684\u65b0Pod\u88ab\u521b\u5efa\u51fa\u6765</li> <li>\u9ed8\u8ba4\u4e3a DESIRED \u7684 25%\uff0c\u59823Pod\u526f\u672c\uff0c\u6eda\u52a8\u66f4\u65b0\u65f6\u81f3\u5c112\u526f\u672c\u53ef\u7528\uff0c4\u526f\u672c\u540c\u65f6\u5b58\u5728\uff1b</li> <li><code>maxSurge</code>\uff1a\u9664\u914d\u7f6e\u7684Pod\u526f\u672c\u6570\u91cf\u5916\uff0c\u4e00\u6b21\u6eda\u52a8\u66f4\u65b0\u4e2dDeployment\u63a7\u5236\u5668\u521b\u5efa\u591a\u5c11\u65b0Pod\uff1b</li> <li><code>maxUnavailable</code>\uff1a\u4e00\u6b21\u6eda\u52a8\u66f4\u65b0\u4e2dDeployment\u63a7\u5236\u5668\u5220\u9664\u591a\u5c11\u65e7Pod\uff1b</li> </ul> <p>ReplicaSet\u7684\u5386\u53f2\u7248\u672c\u4fdd\u7559\u914d\u7f6e\uff1a</p> <ul> <li>\u6bcf\u6b21Deployment\u7684\u66f4\u65b0\uff0c\u90fd\u4f1a\u751f\u6210\u65b0\u7684ReplicaSet\uff1b</li> <li><code>spec.revisionHistoryLimit</code>\u5b57\u6bb5\uff0c\u9650\u5236\u4fdd\u7559\u7684\u5386\u53f2\u7248\u672c\u7684\u4e2a\u6570\uff0c\u8bbe\u7f6e\u4e3a0\uff0c\u5c31\u4e0d\u80fd\u56de\u6eda\u3002</li> </ul> <pre><code># \u67e5\u770b\u6240\u6709\u7684\u7248\u672c\u5386\u53f2\nkubectl rollout history deployment/nginx-deployment\n# \u56de\u6eda\u5230\u6307\u5b9a\u7248\u672c\nkubectl rollout undo deployment/nginx-deployment --revision=2\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#_10","title":"\u914d\u7f6e","text":"<p><code>template</code>\u5b57\u6bb5\u662fPodTemplate\uff0c\u5b9a\u4e49Pod\u7684\u76f8\u5173\u5185\u5bb9\uff08\u8ddfPod\u7684\u5b9a\u4e49\u4e00\u81f4\uff09</p> <pre><code>apiVersion: v1\nkind: Depolyment\nmetadata:\n  name: nginx-deployment\nspec:\n  # \u5e94\u7528\u5230 app:nginx \u6807\u7b7e\u7684Pod\u5bf9\u8c61\u4e2d\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 2\n  # \u6eda\u52a8\u5347\u7ea7\u914d\u7f6e\n  stragegy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavaliable: 1\n  # \u4ee5\u4e0b\u5185\u5bb9\u662fPod\u7684\u6807\u51c6\u5b9a\u4e49\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      container:\n      ...\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#statefulset","title":"StatefulSet","text":"<p>\u6709\u72b6\u6001\u5e94\u7528\uff1a\u5b9e\u4f8b\u4e4b\u95f4\u5173\u7cfb\u4e0d\u5bf9\u7b49\uff0c\u6216\u8005\u5b9e\u4f8b\u5bf9\u5916\u90e8\u6570\u636e\u6709\u4f9d\u8d56\u7684\u5e94\u7528\u3002\uff08\u5982\u4e3b\u4ece\u590d\u5236\u7684mysql\u96c6\u7fa4\uff09</p> <ul> <li>StatefulSet\u63a7\u5236\u5668\u76f4\u63a5\u7ba1\u7406\u7684\u662fPod\uff0c\u5bf9\u6bcf\u4e2aPod\u7684hostname\u3001\u540d\u5b57\u7b49\u90fd\u643a\u5e26\u7f16\u53f7\uff0c\u52a0\u4ee5\u533a\u5206\uff1b</li> <li>\u6309\u5e8f\u6570\u7d22\u5f15\u987a\u5e8f\u5730\u6bcf\u6b21\u542f\u52a8\u4e00\u4e2a Pod\u3002 \u5b83\u4e00\u76f4\u7b49\u5230\u6bcf\u4e2a Pod \u62a5\u544a\u5c31\u7eea\u624d\u518d\u542f\u52a8\u4e0b\u4e00\u4e2a Pod\uff1b</li> <li>\u901a\u8fc7headless service\u4e3a\u6709\u7f16\u53f7\u7684Pod\uff0c\u5728DNS\u4e2d\u751f\u6210\u5e26\u6709\u76f8\u540c\u7f16\u53f7\u7684DNS\u8bb0\u5f55\uff1b</li> <li>\u4e3aPod\u5206\u914d\u4ee5\u989d\u76f8\u540c\u7f16\u53f7\u7684PVC\uff08Persistent Volume Claim\uff09\uff0c\u4fdd\u8bc1\u91cd\u542f\u540e\uff0c\u91cd\u65b0\u5339\u914d\u5230\u76f8\u540c\u7684PVC\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#todo","title":"\u793a\u4f8b\uff08TODO\uff09","text":"<p>\u89c1\u793a\u4f8bMySQL\u96c6\u7fa4yaml</p>"},{"location":"cloud/k8s/k8s_resource.html#daemonset","title":"DaemonSet","text":"<p>Pod\u5728K8s\u7684\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u4e14\u53ea\u8fd0\u884c\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u4e14\u968f\u7740\u65b0\u8282\u70b9\u52a0\u5165\u4f1a\u81ea\u52a8\u521b\u5efa\uff1a</p> <ul> <li>\u7528\u4e8e\u7f51\u7edc\u63d2\u4ef6\uff0c\u5b58\u50a8\u63d2\u4ef6\uff0c\u76d1\u63a7\u548c\u65e5\u5fd7\u7ec4\u4ef6\uff1b</li> </ul> <p>DaemonSet Controller\u4eceetcd\u83b7\u53d6\u6240\u6709\u8282\u70b9\u5217\u8868\uff0c\u904d\u5386\u5224\u65ad\u6bcf\u4e2a\u8282\u70b9\u4e0a\u662f\u5426\u6709\u7279\u5b9a\u6807\u7b7e\u7684Pod\u8fd0\u884c\u3002</p> <ul> <li>\u591a\u5219\u5220\uff0c\u8c03\u7528K8s\u7684API\uff1b</li> <li>\u65e0\u5219\u52a0\uff0c\u901a\u8fc7<code>nodeAffinity</code>\uff0c\u53ea\u5728\u8be5\u8282\u70b9\u4e0a\u8fd0\u884c\uff1b</li> <li>\u901a\u8fc7<code>toleration</code>\u4fdd\u8bc1\u5728\u8282\u70b9\u4e0a\u53ef\u4ee5\u8fd0\u884cPod\uff08\u5982\u7f51\u7edc\u63d2\u4ef6\u5bb9\u5fcd<code>network-unavailable</code>\u6c61\u70b9\uff09\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#_11","title":"\u66f4\u65b0","text":"<p>\u50cfDeployment\u4e00\u6837\u53ef\u4ee5\u5c06DaemonSet\u8fdb\u884c\u6eda\u52a8\u66f4\u65b0\uff0c\u548c\u56de\u6eda\u5230\u5386\u53f2\u7248\u672c\u3002</p> <ul> <li><code>ControllerRevision</code>\uff1a\u4e13\u95e8\u8bb0\u5f55Controller\u5bf9\u8c61\u7684\u7248\u672c\uff0c\u901a\u7528\u7684\u7248\u672c\u7ba1\u7406\u5bf9\u8c61\uff08\u5305\u62ecStatefulSet\u7b49\uff09\u3002</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#_12","title":"\u914d\u7f6e","text":"<pre><code>apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: fluentd-elasticsearch\n  # \u540d\u7a7a\u95f4\n  namespace: kube-system\n  labels:\n    k8s-app: fluentd-logging\nspec:\n  selector:\n    matchLabels:\n      name: fluentd-elasticsearch\n  # Pod\u7684\u5b9a\u4e49\n  template:\n    metadata:\n      labels:\n        name: fluentd-elasticsearch\n    spec:\n    ... \n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#job","title":"Job","text":"<p>Job \u5b8c\u6210\u65f6\u4e0d\u4f1a\u518d\u521b\u5efa\u65b0\u7684 Pod\uff0c\u4e0d\u8fc7\u5df2\u6709\u7684 Pod \u4e5f\u4e0d\u4f1a\u88ab\u5220\u9664\uff0cJob\u5bf9\u8c61\u4e5f\u4f1a\u4fdd\u7559\u3002 </p> <ul> <li>\u4fdd\u7559\u8fd9\u4e9b Pod \u4f7f\u5f97\u4f60\u53ef\u4ee5\u67e5\u770b\u5df2\u5b8c\u6210\u7684 Pod \u7684\u65e5\u5fd7\u8f93\u51fa\uff0c\u4ee5\u4fbf\u68c0\u67e5\u9519\u8bef\u3001\u8b66\u544a \u6216\u8005\u5176\u5b83\u8bca\u65ad\u6027\u8f93\u51fa\u3002</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#_13","title":"\u914d\u7f6e","text":"<p>\u4e0d\u9700\u8981\u5b9a\u4e49<code>spec.selector</code>\u63cf\u8ff0\u9700\u8981\u63a7\u5236\u54ea\u4e9bPods\u3002</p> <ul> <li>Job Controller\u4f1a\u81ea\u52a8\u4e3aPod\u6a21\u677f\u52a0\u4e0a<code>controller-uid=&lt;\u968f\u673a\u5b57\u7b26\u4e32&gt;</code>\u7684\u6807\u7b7e\uff0c\u5e76\u5728Job\u5bf9\u8c61\u672c\u8eab\u6dfb\u52a0\u8be5\u6807\u7b7e\u5bf9\u5e94\u7684selector\u3002</li> <li>pod \u548c job \u7684metadata \u90fd\u4f1a\u81ea\u52a8\u6dfb\u52a0 <code>jobname</code>\u7684\u6807\u7b7e\uff1b</li> </ul> <p>\u91cd\u542f\u7b56\u7565\uff1a <code>RestartPolicy</code> \u53ea\u80fd\u8bbe\u7f6e\u4e3a <code>Never</code> \u6216 <code>OnFailure</code> </p> <ul> <li><code>Never</code>\uff1a\u5931\u8d25\uff0c\u5219\u91cd\u8bd5\u91cd\u65b0\u521b\u5efaPod\uff08<code>spec.backoffLimit</code> \u5b9a\u4e49\u6700\u5927\u6b21\u6570\uff0c\u6307\u6570\u65f6\u95f4\u9012\u589e\uff09\uff1b</li> <li><code>OnFailure</code>\uff1a\u5931\u8d25\u4e0d\u4f1a\u65b0\u5efaPod\uff0c\u800c\u662f\u4e0d\u505c\u5c1d\u8bd5\u91cd\u542fPod\u91cc\u7684\u5bb9\u5668\uff1b</li> </ul> <p>\u6700\u5927\u8fd0\u884c\u65f6\u95f4\uff1a\u9ed8\u8ba4\u4e3a0\uff0c\u4e0d\u9650\u5236\uff1b</p> <ul> <li><code>spec.activeDeadlineSeconds</code>\uff1a\u9650\u5236\u8fd0\u884c\u65f6\u957f\uff0c\u770b\u5230Pod\u7ec8\u6b62\u539f\u56e0\uff08<code>reason: DeadlineExceeded</code>\uff09\uff1b</li> </ul> <p>\u5e76\u884cbatch\uff1a</p> <ul> <li><code>spec.parallelism</code>\uff1a\u4e00\u4e2aJob\u5728\u4efb\u610f\u65f6\u95f4\u6700\u591a\u53ef\u4ee5\u542f\u52a8\u591a\u5c11\u4e2aPod\u540c\u65f6\u8fd0\u884c\uff1b</li> <li><code>spec.completions</code>\uff1aJob\u81f3\u5c11\u8981\u5b8c\u6210\u7684Pod\u6570\u76ee\uff0c\u5373Job\u7684\u6700\u5c0f\u5b8c\u6210\u6570\uff1b</li> </ul> <pre><code>apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: pi\nspec:\n  # Pods\u7684\u914d\u7f6e\n  template:\n    spec:\n      containers:\n      - name: pi\n        image: perl\n        command: [\"perl\",  \"-Mbignum=bpi\", \"-wle\", \"print bpi(2000)\"]\n      restartPolicy: Never\n  # \u4f5c\u4e1a\u5931\u8d25\u7684\u91cd\u8bd5\u6b21\u6570\n  backoffLimit: 4\n  # \u540c\u65f6\u8fd0\u884c\u7684Pod\u7684\u6700\u5927\u6570\u91cf\uff08\u9ed8\u8ba41\uff09\n  parallelism: 4\n  # \u6700\u5c11\u8981\u5b8c\u6210\u7684Pod\u7684\u6570\u91cf\uff08\u9ed8\u8ba41\uff09\n  completions:\n  # \u9650\u5236\u8fd0\u884c\u65f6\u957f\n  activeDeadlineSeconds: 100\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#cronjob","title":"CronJob","text":"<p>\u5b9a\u65f6Job\uff0c\u7ba1\u7406Job\u5bf9\u8c61\u7684\u63a7\u5236\u5668\u3002</p> <p>\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u4f1a\u521b\u5efa\u4e24\u4e2a Job\uff0c\u6216\u8005\u4e0d\u4f1a\u521b\u5efa\u4efb\u4f55 Job\u3002 \u6211\u4eec\u8bd5\u56fe\u4f7f\u8fd9\u4e9b\u60c5\u51b5\u5c3d\u91cf\u5c11\u53d1\u751f\uff0c\u4f46\u4e0d\u80fd\u5b8c\u5168\u675c\u7edd\u3002\u56e0\u6b64\uff0cJob \u5e94\u8be5\u662f \u5e42\u7b49\u7684\u3002</p> <p><code>spec.concurrencyPolicy</code>\uff1a\u89e3\u51b3\u67d0\u4e2ajob\u8fd8\u672a\u8fd0\u884c\u5b8c\uff0c\u53e6\u4e00\u4e2ajob\u5c31\u4ea7\u751f\u7684\u573a\u666f</p> <ul> <li>Allow\uff1aJob\u53ef\u4ee5\u540c\u65f6\u5b58\u5728\uff1b</li> <li>Forbid\uff1a\u4e0d\u4f1a\u521b\u5efa\u65b0Job\uff0c\u8be5\u521b\u5efa\u5468\u671f\u88ab\u8df3\u8fc7\uff1b</li> <li>Replace\uff1a\u4ea7\u751f\u65b0\u7684Job\u66ff\u6362\u65e7\u7684\u3001\u672a\u6267\u884c\u5b8c\u7684Job\u3002</li> </ul> <p>\u672a\u80fd\u5728\u8c03\u5ea6\u65f6\u95f4\u5185\u521b\u5efa CronJob\uff08\u5373\u521b\u5efa\u5931\u8d25\uff09\u5f53\u4f5c\u4e00\u6b21miss\uff0c\uff08\u6307\u5b9a\u7684\u65f6\u95f4\u5185\uff09\u8fde\u7eedmiss\u7684\u6570\u76ee\u8d85\u8fc7100\u65f6\uff0cCronJob\u4f1a\u505c\u6b62\u521b\u5efa\u8be5Job\u3002</p> <ul> <li><code>spec.startingDeadlineSeconds</code>\uff1a\uff08\u6307\u5b9a\u7684\u65f6\u95f4\u5185\uff09</li> </ul> <pre><code># \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u5206\u949f (0 - 59)\n# \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u5c0f\u65f6 (0 - 23)\n# \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u6708\u7684\u67d0\u5929 (1 - 31)\n# \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u6708\u4efd (1 - 12)\n# \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u5468\u7684\u67d0\u5929 (0 - 6) \uff08\u5468\u65e5\u5230\u5468\u4e00\uff1b\u5728\u67d0\u4e9b\u7cfb\u7edf\u4e0a\uff0c7 \u4e5f\u662f\u661f\u671f\u65e5\uff09\n# \u2502 \u2502 \u2502 \u2502 \u2502                                   \n# \u2502 \u2502 \u2502 \u2502 \u2502\n# \u2502 \u2502 \u2502 \u2502 \u2502\n# * * * * *\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#_14","title":"\u914d\u7f6e","text":"<pre><code>apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: hello\nspec:\n  schedule: \"*/1 * * * *\"\n  # \u5e76\u884c\u6267\u884c\u7684\u914d\u7f6e\n  concurrencyPolicy: Forbid\n  # job\u7684\u6a21\u677f\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: hello\n            image: busybox\n            imagePullPolicy: IfNotPresent\n            command:\n            - /bin/sh\n            - -c\n            - date; echo Hello from the Kubernetes cluster\n          restartPolicy: OnFailure\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#service","title":"Service","text":"<p>Service\u7528\u4e8e\u4e3a\u4e00\u7ec4\u63d0\u4f9b\u670d\u52a1\u7684Pod\u62bd\u8c61\u4e00\u4e2a\u7a33\u5b9a\u7684\u7f51\u7edc\u8bbf\u95ee\u5730\u5740\uff1b</p> <ul> <li>\u670d\u52a1\u6ce8\u518c\u3001\u670d\u52a1\u53d1\u73b0\u3001\u670d\u52a1\u8d1f\u8f7d\u5747\u8861\u7b49\uff1b</li> </ul> <p>Pod \u7ed1\u5b9aService\u670d\u52a1\uff0cService\u670d\u52a1\u58f0\u660e\u7684IP\u5730\u5740\u7b49\u4fe1\u606f\u662f\u56fa\u5b9a\u4e0d\u53d8\u7684\uff0cService\u4f5c\u4e3aPod\u7684\u4ee3\u7406\u5165\u53e3\uff08Portal\uff09\u3002</p>"},{"location":"cloud/k8s/k8s_resource.html#_15","title":"\u8d1f\u8f7d\u5747\u8861\u539f\u7406","text":"<p>\u901a\u8fc7kube-proxy\u914d\u7f6eiptables\u6216\u8005\u901a\u8fc7ipvs\u8fdb\u884c\u8f6c\u53d1\u5904\u7406\u3002</p>"},{"location":"cloud/k8s/k8s_resource.html#_16","title":"\u4f1a\u8bdd\u4fdd\u6301\u673a\u5236","text":"<p>\u652f\u6301\u901a\u8fc7<code>sessionAffinity</code>\u5b9e\u73b0\u57fa\u4e8e\u5ba2\u6237\u7aefIP\u7684\u4f1a\u8bdd\u4fdd\u6301\u673a\u5236\uff0c\u5e76\u4e14\u53ef\u4ee5\u914d\u7f6e\u4f1a\u8bdd\u4fdd\u6301\u7684\u6700\u957f\u65f6\u95f4\uff1a</p> <pre><code># ....\nspec:\n  sessionAffinity: CientIP\n  sessionAffinityConfig:\n    clientIP:\n      timeoutSeconds: 10800\n  prots:\n  - protocol: TCP\n    port: 8080\n    targetPort: 8080\n  selector:\n    app: webapp\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#service_1","title":"\u5916\u90e8\u670d\u52a1\u5b9a\u4e49\u4e3aService","text":"<p>\u5e38\u89c1\u5e94\u7528\u573a\u666f\uff1a</p> <ul> <li>\u5df2\u90e8\u7f72\u7684\u96c6\u7fa4\u5916\u670d\u52a1\uff0c\u5982\u6570\u636e\u5e93\u670d\u52a1\u3001\u7f13\u5b58\u670d\u52a1\u7b49\uff1b</li> <li>\u5176\u5b83K8s\u96c6\u7fa4\u7684\u67d0\u4e2a\u670d\u52a1\u7b49\uff1b</li> </ul> <p>\u521b\u5efaService\u65f6\u5019\u4e0d\u8bbe\u7f6eLabel Selector\uff08\u540e\u7aefPod\u4e5f\u4e0d\u5b58\u5728\uff09\uff0c\u540c\u65f6\u5728\u5b9a\u4e49\u4e00\u4e2a\u4e0eService\u5173\u8054\u7684Endpoint\u5bf9\u8c61\uff0c\u5728Endpoint\u4e2d\u8bbe\u7f6e\u5916\u90e8\u670d\u52a1\u7684IP\u548cPort\uff1a</p> <pre><code>apiVersion: v1\nkind: Endpoint\nmetadata:\n  name: my-service\nsubsets:\n- addresses:\n  - IP: 1.2.3.4\n  ports:\n  - port: 80\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#service_2","title":"Service\u7c7b\u578b","text":"<p>\u4e3a\u4e00\u7ec4Pod\u62bd\u8c61\u4e00\u4e2a\u7a33\u5b9a\u7684\u7f51\u7edc\u8bbf\u95ee\u5730\u5740\uff0c\u63d0\u4f9b\u670d\u52a1\u6ce8\u518c\u3001\u670d\u52a1\u53d1\u73b0\u3001\u670d\u52a1\u8d1f\u8f7d\u5747\u8861\u7b49\u3002</p> <ul> <li> <p><code>port</code>\u548c<code>nodePort</code>\u90fd\u662fservice\u7684\u7aef\u53e3\uff0c\u524d\u8005\u66b4\u9732\u7ed9k8s\u96c6\u7fa4\u5185\u90e8\u670d\u52a1\u8bbf\u95ee\uff0c\u540e\u8005\u66b4\u9732\u7ed9k8s\u96c6\u7fa4\u5916\u90e8\u6d41\u91cf\u8bbf\u95ee\u3002</p> </li> <li> <p>\u4ece\u4e0a\u4e24\u4e2a\u7aef\u53e3\u8fc7\u6765\u7684\u6570\u636e\u90fd\u9700\u8981\u7ecf\u8fc7\u53cd\u5411\u4ee3\u7406kube-proxy\uff0c\u6d41\u5165\u540e\u7aefpod\u7684<code>targetPort</code>\u4e0a\uff0c\u6700\u540e\u5230\u8fbepod\u5185\u7684\u5bb9\u5668\u3002</p> </li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#clusterip","title":"ClusterIP\u6a21\u5f0f","text":"<p>\u9ed8\u8ba4\uff0c\u5206\u914d\u4e00\u4e2a\u96c6\u7fa4\u5185\u90e8\u53ef\u4ee5\u8bbf\u95ee\u7684\u865a\u62dfIP\uff08VIP\uff09</p> <ul> <li>Services\u7684VIP\uff08Virtual IP\uff09\u65b9\u5f0f\uff1avip\u5c06\u8bf7\u6c42\u8f6c\u53d1\u5230\u67d0\u4e00\u4e2aPod\u4e0a\uff1b</li> <li>Service\u7684DNS\u65b9\u5f0f\uff1a\u901a\u8fc7\u57df\u540d\u89e3\u6790\u6210\u5bf9\u5e94ip</li> <li>Normal Service\uff1a\u89e3\u6790\u540e\u7684ip\u5c31\u662fService\u7684vip\uff1b</li> <li>Headless Service\uff1a\u6ca1\u6709ClusterIP\uff08None\uff09\uff0c\u89e3\u6790\u51fa\u7684\u662f\u6240\u6709\u7684Pod\u7684 ip:port \u5730\u5740\u5217\u8868\uff1b</li> <li>dns\u8bb0\u5f55\u57df\u540d\u4e3a\uff1a<code>&lt;pod-name&gt;.&lt;svc-name&gt;.&lt;namespace&gt;.svc.cluster.local</code></li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#nodeport","title":"NodePort\u6a21\u5f0f","text":"<p>/etc/kubernetes/manifests/kube-apiserver.yaml</p> <p>\u5728\u6bcf\u4e2aNode\u4e0a\u5206\u914d\u4e00\u4e2a\u7aef\u53e3\u4f5c\u4e3a\u5916\u90e8\u8bbf\u95ee\u5165\u53e3\uff0c\u9ed8\u8ba4kube-proxy\u4f1a\u5728\u5168\u90e8\u7f51\u5361(0.0.0.0)\u7ed1\u5b9aNodePort\u7684\u7aef\u53e3\u53f7\u3002</p> <ul> <li>\u4e0d\u6307\u5b9a\uff0c\u53ef\u4ee5\u81ea\u52a8\u5206\u914d\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#loadbalancer","title":"LoadBalancer\u6a21\u5f0f","text":"<p>\u5de5\u4f5c\u5728\u7279\u5b9a\u7684Cloud Provider\u4e0a\uff0c\u4f8b\u5982Google Cloud\uff0cAWS\uff0cOpenStack</p>"},{"location":"cloud/k8s/k8s_resource.html#externalname","title":"ExternalName\u6a21\u5f0f","text":"<p>\u5c06Service\u6620\u5c04\u4e3a\u4e00\u4e2a\u5916\u90e8\u57df\u540d\u5730\u5740\uff0c\u901a\u8fc7exeternalName\u5b57\u6bb5\u8fdb\u884c\u8bbe\u7f6e</p>"},{"location":"cloud/k8s/k8s_resource.html#_17","title":"\u914d\u7f6e","text":"<p>\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0cservice\u7684port\u548cpod\u955c\u50cf\u5f00\u653e\u7684\u7aef\u53e3\u4e00\u81f4\u3002\u6bd4\u5982nginx\u7684\u955c\u50cf\u662f\u5f00\u653e80\u7aef\u53e3\uff0cservice\u7684port\u6307\u5b9a\u7684\u662f80\u7aef\u53e3\uff0c\u90a3\u4e48pod\u548cpod\u76f4\u63a5\u5c31\u53ef\u4ee5\u8fdb\u884c\u8bbf\u95ee\uff0c\u4e0d\u7528\u6307\u5b9atargetPort\u7aef\u53e3</p> <pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-svc\n  labels:\n    app: nginx\nspec:\n  ports:\n  - protocol: tcp\n    # service\u66b4\u9732\u5728cluster ip\u4e0a\u7684\u7aef\u53e3\uff0c\u670d\u52a1\u95f4\u5185\u90e8\u4f7f\u7528\n    port: 80\n    # \u8282\u70b9\u4e0a\u7684\u7aef\u53e3\uff0c\u7ed9\u5916\u90e8\u76f4\u63a5\u901a\u8fc7\u8282\u70b9ip:port\u8bbf\u95ee\uff08NodePort\u6a21\u5f0f\u4f7f\u7528\uff09\n    nodePort: 8090\n    # \u5bb9\u5668\u91cc\u7684\u7aef\u53e3\n    targetPort: 8081\n    name: web\n  # ClusterIP\u6a21\u5f0f\uff08\u9ed8\u8ba4\uff09\uff1a\u4e0d\u6307\u5b9a\u65f6\uff0c\u81ea\u52a8\u5206\u914d\n  # \u6307\u5b9a\u4e3aNone\u65f6\uff0c\u5c5e\u4e8eHeadless\u6a21\u5f0f\n  clusterIP: None\n  # \u6307\u5b9a\u4e3a NodePort\u6a21\u5f0f\uff0c\u9ed8\u8ba4ClusterIP\n  type: NodePort      \n  # \u9009\u62e9pod(\u6839\u636e\u5bf9\u5e94\u7684label: app=nginx)\n  selector:\n    app: nginx\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#ingress","title":"Ingress","text":"<p>HTTP/HTTPS \u6839\u636e url \u8fdb\u884c\u8f6c\u53d1\uff0c\u4f5c\u4e3aEdge Router\uff0c\u5c06\u96c6\u7fa4\u5916\u7684\u5ba2\u6237\u7aef\u8bf7\u6c42\u8def\u7531\u5230\u96c6\u7fa4\u5185\u90e8\u7684\u670d\u52a1\u4e0a\uff1b</p> <ul> <li><code>ingress controller</code>\u57fa\u4e8e<code>Ingress</code>\u89c4\u5219\u5c06\u5ba2\u6237\u7aef\u8bf7\u6c42\u76f4\u63a5\u8f6c\u53d1\u5230<code>Service</code>\u5bf9\u5e94\u7684\u540e\u7aef<code>Endpoint(Pod)</code>\u4e0a\u3002</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#_18","title":"\u5b9e\u73b0","text":""},{"location":"cloud/k8s/k8s_resource.html#nginx-ingress","title":"NGINX Ingress","text":"<p>\u9ed8\u8ba4\u7684 Ingress \u662f\u57fa\u4e8e NGINX \u5b9e\u73b0\u7684\u3002NGINX Ingress Controller \u5e2e\u52a9\u7ef4\u62a4\u4e86 Kubernetes \u96c6\u7fa4\u4e0e NGINX \u7684\u72b6\u6001\u540c\u6b65\uff0c\u5e76\u4e14\u63d0\u4f9b\u4e86\u57fa\u672c\u7684\u53cd\u5411\u4ee3\u7406\u80fd\u529b\u3002</p> <ul> <li>\u9ed8\u8ba4<code>controller-class=k8s.io/ingress-nginx</code>\uff0c<code>--ingress-class=nginx</code></li> </ul> <p>nginx \u914d\u7f6e\u7684upstream\uff0c\u662f\u901a\u8fc7lua\u811a\u672c\u52a8\u6001\u5904\u7406\uff0c\u9700\u8981\u901a\u8fc7\u76f8\u5e94\u7684 nginx kubectl plugin \u67e5\u770b</p> <p><code>kubectl ingress-nginx backends</code></p> <p>\u914d\u7f6e\u4fee\u6539\uff1a</p> <ul> <li>\u901a\u8fc7\u5bf9<code>Ingress</code>\u7684<code>annotation</code>\u8fdb\u884c\u64cd\u4f5c\uff0c\u5b9e\u73b0\u914d\u7f6e\u4fee\u6539</li> </ul> <p><code>nginx.ingress.kubernetes.io/proxy-body-size: \"50m\"</code></p>"},{"location":"cloud/k8s/k8s_resource.html#apache-apisix-ingress","title":"Apache APISIX Ingress","text":""},{"location":"cloud/k8s/k8s_resource.html#ingressclass","title":"IngressClass","text":"<p>\u9ed8\u8ba4\u7684 IngressClass\uff0c\u9700\u8981\u52a0\u4e0a\u6ce8\u89e3</p> <ul> <li><code>ingressclass.kubernetes.io/is-default-class: \"true\"</code></li> </ul> <p>\u7528\u4e8e\u5728\u96c6\u7fa4\u5185\u6709\u591a\u4e2aingress controller\u65f6\u5019\uff0c\u533a\u5206ingress\u7531\u8c01\u5904\u7406\u3002</p> <ul> <li>\u5982<code>nginx-controller</code>\uff0c\u5176\u542f\u52a8\u547d\u4ee4\u4e2d\uff0c\u67092\u4e2a\u914d\u7f6e\u5728\u6b64\u65f6\u6709\u7528(<code>--ingress-class</code>\u548c<code>--controller-class</code>)\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#default-ingressclass","title":"\u65e0default ingressclass","text":"<pre><code>apiVersion: networking.k8s.io/v1\nkind: IngressClass\nmetadata:\n  name: nginx-example\nspec:\n  controller: k8s.io/ingress-nginx\n</code></pre> <p>\u9488\u5bf9\u4e0d\u540c\u573a\u666f\uff0cIngress \u7684\u5904\u7406\u7b56\u7565\u4e0d\u4e00\u6837\uff1a</p> <ul> <li>ingress\u672a\u8bbe\u7f6eingressClassName\uff0c\u4f1a\u88ab\u5ffd\u7565\uff1b</li> <li>ingress\u8bbe\u7f6e<code>ingressClassName</code>\uff0c\u5bf9\u5e94<code>IngressClass</code>\u7684<code>metadata.name</code>\uff1a</li> <li>\u5bf9\u5e94\u7684 ingressclass \u7684 spec.controller\u5b57\u6bb5\u6240\u5bf9\u5e94\u7684 ingress-controller \u5904\u7406\uff08\u5373\u7b49\u4e8e controller-class \u5b57\u6bb5\u503c \uff09\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#default-ingressclas","title":"\u6709default ingressclas","text":"<pre><code>apiVersion: networking.k8s.io/v1\nkind: IngressClass\nmetadata:\n  annotations:\n    ingressclass.kubernetes.io/is-default-class: \"true\"\n  name: nginx\nspec:\n  controller: k8s.io/ingress-nginx\n</code></pre> <p>\u9488\u5bf9\u4e0d\u540c\u573a\u666f\uff0cIngress \u7684\u5904\u7406\u7b56\u7565\u4e0d\u4e00\u6837\uff1a</p> <ul> <li>ingress\u672a\u8bbe\u7f6eingressClassName\uff0c\u88abdefault ingressclass \u7684 spec.controller \u6307\u5b9a\u7684 ingress-controller \u5904\u7406\uff1b</li> <li>ingress\u8bbe\u7f6e<code>ingressClassName</code>\uff0c\u5bf9\u5e94<code>IngressClass</code>\u7684<code>metadata.name</code>\uff1a</li> <li>\u5bf9\u5e94\u7684 ingressclass \u7684 spec.controller\u5b57\u6bb5\u6240\u5bf9\u5e94\u7684 ingress-controller \u5904\u7406\uff08\u5373\u7b49\u4e8e controller-class \u5b57\u6bb5\u503c \uff09\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#gateway","title":"Gateway","text":"<p>Ingress\u63d0\u4f9b\u4e86\u67d0\u4e9b\u5b57\u6bb5\u914d\u7f6e\uff0c\u901a\u8fc7annotations\u8fdb\u884c\u914d\u7f6e\u4e5f\u5f88\u6709\u6311\u6218\u6027\u3002</p> <p>\u4f7f\u7528Ingress\uff0c\u96c6\u7fa4\u8fd0\u7ef4\u4eba\u5458\u548c\u5e94\u7528\u5f00\u53d1\u4eba\u5458\u5728\u540c\u4e00\u4e2aIngress\u5bf9\u8c61\u4e0a\u64cd\u4f5c\uff0c\u5374\u4e0d\u77e5\u9053\u5f7c\u6b64\u7684\u89d2\u8272\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8bbe\u7f6e\u9519\u8bef\u3002</p> <p><code>GatewayClass</code>\u3001<code>Gateway</code>\u3001<code>HTTPRoute</code>\u3001<code>TCPRoute</code>\u3001<code>Service</code>\u7b49\uff0c\u65e8\u5728\u901a\u8fc7\u8868\u8fbe\u6027\u7684\u3001\u53ef\u6269\u5c55\u7684\u3001\u9762\u5411\u89d2\u8272\u7684\u63a5\u53e3\u6765\u5b9a\u4e49Kubernetes\u670d\u52a1\u7f51\u7edc\u3002</p> <p>\u5728Ingress API\u7684\u57fa\u7840\u4e0a\u589e\u52a0\u4e86\u66f4\u591a\u7279\u6027\uff0c\u4f8b\u5982HTTP\u5934\u5339\u914d\u3001\u52a0\u6743\u6d41\u91cf\u5206\u5272\u3001\u591a\u534f\u8bae\u652f\u6301(\u5982HTTP\u3001gRpc)\u4ee5\u53ca\u5176\u4ed6\u5404\u79cd\u540e\u7aef\u529f\u80fd(\u5982\u6876\u3001\u51fd\u6570)\u3002</p>"},{"location":"cloud/k8s/k8s_resource.html#project-volumes","title":"Project Volumes","text":"<p>\u4e3a\u5bb9\u5668\u63d0\u4f9b\u9884\u5148\u5b9a\u4e49\u597d\u7684\u6570\u636e\uff0c\u88abk8s\u6ce8\u5165\u5230\u5bb9\u5668\u4e2d\u3002</p> <p>Secret\u3001ConfigMap\u3001Downward API\u4e09\u79cd\u4fe1\u606f\uff0c\u53ef\u4ee5\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u7684\u65b9\u5f0f\u51fa\u73b0\u518d\u5bb9\u5668\u91cc\uff0c\u4f46\u662f\u4e0d\u5177\u5907\u81ea\u52a8\u66f4\u65b0\u7684\u80fd\u529b\u3002</p>"},{"location":"cloud/k8s/k8s_resource.html#secret","title":"Secret","text":"<ul> <li> <p>\u901a\u8fc7\u5377\u6302\u8f7d\u65f6\u6216\u8005\u901a\u8fc7 go client \u83b7\u53d6 secret \u65f6\uff0c\u5176\u6570\u636e\u5df2\u7ecf\u8fdb\u884c base64 \u89e3\u7801\u3002</p> </li> <li> <p>Pod \u9ed8\u8ba4\u53ef\u4ee5\u6302\u8f7d\u540c\u540d\u7a7a\u95f4\u7684\u4efb\u610f Secret\uff0c\u4f46\u4e5f\u53ef\u4ee5\u9650\u5236Pod\u8bbf\u95ee\u54ea\u4e9bsecret\u3002</p> </li> </ul> <p>\u628aPod\u60f3\u8981\u8bbf\u95ee\u7684\u52a0\u5bc6\u6570\u636e\u5b58\u50a8\u5230etcd\u4e2d\uff0c\u901a\u8fc7Pod\u7684\u5bb9\u5668\u6302\u8f7dVolume\u7684\u5f62\u5f0f\u8bbf\u95eeSecret\u91cc\u7684\u4fe1\u606f\u3002</p> <ul> <li>Secrent\u7684\u52a0\u5bc6\u662f\u63d2\u4ef6\uff0c\u9700\u8981\u5355\u72ec\u914d\u7f6e\u3002</li> </ul> <p>\u5728\u5bb9\u5668\u4e2d\u4f1a\u751f\u6210<code>${container_mount_path}/${secret_name}</code>\u6587\u4ef6\uff0c\u6587\u4ef6\u5185\u5bb9\u4e3a\u5bf9\u5e94\u7684\u503c\uff0c\u4e14etcd\u4e2d\u503c\u66f4\u65b0\u65f6\uff0c\u6587\u4ef6\u5185\u5bb9\u4e5f\u4f1a\u66f4\u65b0\u3002</p> <ul> <li>\u5bf9\u4e8e\u4ee5 subPath \u5f62\u5f0f\u6302\u8f7d Secret \u5377\u7684\u5bb9\u5668\u800c\u8a00\uff0c \u5b83\u4eec\u65e0\u6cd5\u6536\u5230\u81ea\u52a8\u7684 Secret \u66f4\u65b0\u3002</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#kubernetesiodockerconfigjson","title":"kubernetes.io/dockerconfigjson","text":"<p>\u4f5c\u4e3a docker \u79c1\u6709\u955c\u50cf\u7684\u8ba4\u8bc1\u914d\u7f6e\uff0c\u901a\u8fc7</p> <pre><code>apiVersion: v1\nkind: Secret\ntype: kubernetes.io/dockerconfigjson\n# \u79c1\u6709\u955c\u50cf\u7684\nmetadata:\n  name: hubsecret-go\n  namespace: test\ndata:\n  .dockerconfigjson: eyJhdXRocyI6eyJ1YXQuc2YuZG9ja2VyaHViLnN0Z3dlYmFuayI6eyJ1c2VybmFtZSI6ImJkcCIsInBhc3N3b3JkIjoiYmRwQHdlaHViIiwiZW1haWwiOiJsdWNrbGl1QHdlYmFuay5jb20iLCJhdXRoIjoiWW1Sd09tSmtjRUIzWldoMVlnPT0ifX19\n</code></pre> <p>Pod\u4e2d\u4f7f\u7528\u65f6<code>imagePullSecrets</code>\uff1a</p> <pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: deployment_service\n  namespace: test\nspec:\n  imagePullSecrets:\n  - name: hubsecret-go\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#configmap","title":"ConfigMap","text":"<p>\u4f5c\u4e3a\u5377\u6574\u4f53\u6302\u8f7d\u65f6\uff0c\u6bcf\u4e2a key \u662f\u4ee5\u8f6f\u94fe\u63a5\u7684\u5f62\u5f0f\u3002</p> <pre><code>Oct 31 10:25 ..2023_10_31_10_25_13.340959843\nOct 31 10:25 ..data -&gt; ..2023_10_31_10_25_13.340959843\nOct 31 10:25 aa -&gt; ..data/aa\n</code></pre> <p>\u4e0eSecret\u7684\u533a\u522b\u662f\uff0cConfigMap\u5b58\u50a8\u65e0\u9700\u52a0\u5bc6\u3001\u5e94\u7528\u6240\u9700\u7684\u914d\u7f6e\u4fe1\u606f\uff1a</p> <ul> <li><code>data</code> \u4e0b\u7684\u6bcf\u4e2a\u952e\u7684\u540d\u79f0\u90fd\u5fc5\u987b\u7531\u5b57\u6bcd\u6570\u5b57\u5b57\u7b26\u6216\u8005 <code>-</code>\u3001<code>_</code> \u6216 <code>.</code> \u7ec4\u6210\uff1b</li> <li><code>immutable</code> \u5b57\u6bb5\u5230 ConfigMap \u5b9a\u4e49\u4e2d\uff0c \u521b\u5efa\u4e0d\u53ef\u53d8\u66f4\u7684 ConfigMap (\u53ea\u80fd\u5220\u9664\u5e76\u91cd\u5efa ConfigMap)</li> </ul> <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  # \u914d\u7f6e\u540d\u79f0\u4e3acc-go-config \n  name: cc-go-config\n  namespace: test\n# \u4fdd\u5b58 UTF-8 \u5b57\u7b26\u4e32\ndata\n  application-name: Test\n# \u4e0d\u53ef\u53d8\uff0cv1.21 stable\nimmutable: true\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#_19","title":"\u4f7f\u7528","text":"<p>Pod\u7684\u4f7f\u7528\u65b9\u5f0f\uff1a</p> <ul> <li>\u5c06ConfigMap\u4e2d\u7684\u6570\u636e\u8bbe\u7f6e\u4e3a\u5bb9\u5668\u7684\u73af\u5883\u53d8\u91cf</li> <li>\u5c06ConfigMap\u4e2d\u7684\u6570\u636e\u8bbe\u7f6e\u4e3a\u547d\u4ee4\u884c\u53c2\u6570</li> <li>\u4f7f\u7528Volume\u5c06ConfigMap\u4f5c\u4e3a\u6587\u4ef6\u6216\u76ee\u5f55\u6302\u8f7d\uff08\u53ef\u81ea\u52a8\u66f4\u65b0\uff0c\u4f7f\u7528subpath\u5219\u4e0d\u884c\uff09</li> <li> <p>configmap \u7684\u66f4\u65b0\u5ef6\u8fdf\uff0c\u53ef\u4ee5\u901a\u8fc7\u5bf9Pod \u6dfb\u52a0\u6ce8\u89e3\u7acb\u5373\u89e6\u53d1configmap\u66f4\u65b0\uff1b</p> </li> <li> <p>\u7f16\u5199\u4ee3\u7801\u5728 Pod \u4e2d\u8fd0\u884c\uff0c\u4f7f\u7528 Kubernetes API \u6765\u8bfb\u53d6 ConfigMap</p> </li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#downward-api","title":"Downward API","text":"<p>Pod\u91cc\u7684\u5bb9\u5668\u80fd\u591f\u76f4\u63a5\u83b7\u53d6\u8fd9\u4e2aPod API\u5bf9\u8c61\u672c\u8eab\u7684\u4fe1\u606f\uff08\u5bb9\u5668\u8fdb\u7a0b\u542f\u52a8\u4e4b\u524d\u5c31\u786e\u5b9a\u7684\u4fe1\u606f\uff09\u3002</p> <ul> <li><code>fieldRef</code>\uff1a<code>metadata</code>\u7684<code>name</code>, <code>namespace</code>, <code>label</code>\u7b49\uff1b</li> <li><code>resourceFieldRef</code>\uff1acpu, memory\u7b49\uff1b</li> </ul> <p>\u793a\u4f8b\uff1a\u5c06Pod Labels\u5b57\u6bb5\u7684\u503c\u6302\u8f7d\u5230\u5bb9\u5668\u7684<code>/etc/podinfo/labels</code>\u6587\u4ef6</p> <pre><code>...\nspec:\n  containers:\n  - name: client\n    volumeMounts:\n    - name: podinfo\n      mountPath: /etc/podinfo\n  volumes:\n  - name: podinfo\n    projected:\n      sources:\n      - downwardAPI:\n        items:\n        - path: \"labels\"\n            fieldRef:\n              fieldPath: metadata.labels\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#serviceaccounttoken","title":"ServiceAccountToken","text":"<p>token \u6587\u4ef6\u4e2d\u5b58\u50a8\u7684 k8s api server \u5730\u5740\u662f https://kubernetes.default.svc\uff08\u4e0d\u4f1a\u53d8\uff09</p> <ul> <li>kubectl cluster-info \u663e\u5f0f\u7684\u57df\u540d\u8ddf\u8fd9\u4e2a\u4e0d\u9700\u8981\u4e00\u81f4\uff0c\u4e24\u8005\u4e4b\u95f4\u65e0\u5173\u8054</li> <li>apiserver \u7684 pod \u542f\u52a8\u53c2\u6570\u5b9a\u4e49 <code>- --service-account-issuer=https://kubernetes.default.svc.cluster.local</code></li> </ul> <p>Service Account\u5bf9\u8c61\u7684\u4f5c\u7528\u662fKubernetes\u5185\u7f6e\u7684\u4e00\u79cd\u201c\u670d\u52a1\u8d26\u6237\u201d\uff0c\u662fK8s\u8fdb\u884c\u6743\u9650\u5206\u914d\u7684\u5bf9\u8c61\u3002</p> <p><code>InClusterConfig</code>\uff1a\u5c06K8s\u5ba2\u6237\u7aef\u4ee5\u5bb9\u5668\u65b9\u5f0f\u8fd0\u884c\uff0c\u4f7f\u7528\u9ed8\u8ba4\u7684Service Account\u81ea\u52a8\u6388\u6743</p> <ul> <li> <p>Pods\u4f1a\u81ea\u52a8\u6302\u8f7d\u4e00\u4e2a\u7c7b\u578b\u4e3aSecret\uff0c\u540d\u4e3a<code>default-token-***</code>\u7684Volume\u3002</p> </li> <li> <p>Service Account\u7684\u6388\u6743\u4fe1\u606f\u548c\u6587\u4ef6\u4f5c\u4e3a\u7279\u6b8a\u7684Secret\uff0c\u5b58\u5728\u5bb9\u5668\u91cc\u7684<code>/var/run/secrets/kubernetes.io/serviceaccount</code>\u76ee\u5f55\uff0c\u5305\u542b<code>ca.crt</code>, <code>token</code>\u7b49\uff1b</p> </li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#pv","title":"PV","text":"<p>\u6301\u4e45\u5316\u5377\uff0c \u652f\u6301\u672c\u5730\u5b58\u50a8\u548c\u7f51\u7edc\u5b58\u50a8\uff0c\u652f\u6301\u4e24\u4e2a\u5c5e\u6027\uff0c capacity\u548caccessModes\uff1a</p> <ul> <li><code>accessModes</code>\uff1aReadWriteOnce\uff08\u88ab\u5355\u4e2anode\u8bfb\u5199\uff09\uff0c ReadOnlyMany\uff08\u88ab\u591a\u4e2anodes\u8bfb\uff09\uff0c ReadWriteMany\uff08\u88ab\u591a\u4e2anodes\u8bfb\u5199\uff09\uff1bReadWriteOncePod\uff08\u5355\u4e2aPod\u8bfb\u5199\uff0c\u4ec5 K8s 1.22+ \u7684CSI Volume\u652f\u6301\uff09</li> <li>k8s\u7684\u5b58\u50a8\u7684\u652f\u6301\u7a0b\u5ea6\u89c1 https://kubernetes.io/docs/concepts/storage/persistent-volumes/#access-modes</li> </ul> <p>\u91cd\u58f0\u660e\u7b56\u7565(reclaim policy)\uff1a\u7528\u6237\u5220\u9664PVC\u91ca\u653e\u5bf9PV\u7684\u5360\u7528\u540e\uff0c\u7cfb\u7edf\u6839\u636ePV\u7684\"reclaim policy\"\u51b3\u5b9a\u5bf9PV\u6267\u884c\u4f55\u79cd\u56de\u6536\u64cd\u4f5c</p> <ul> <li>Retain \uff1a\u624b\u52a8\u91cd\u65b0\u4f7f\u7528</li> <li>Recycle \uff1a \u57fa\u672c\u7684\u6570\u636e\u64e6\u9664 (<code>rm -rf /thevolume/*</code>)</li> <li>Delete \uff1a \u9ed8\u8ba4\uff0c\u79fb\u9664PV\u5bf9\u8c61\u548c\u76f8\u5173\u8054\u7684\u540e\u7aef\u5b58\u50a8\u5377\u5220\u9664\uff0c \u540e\u7aef\u5b58\u50a8\u6bd4\u5982<code>AWS EBS, GCE PD, Azure Disk, or OpenStack Cinder</code></li> </ul> <p>\u8282\u70b9\u4eb2\u548c\u6027\uff08NodeAffinity\uff09</p> <ul> <li>\u9650\u5236\u54ea\u4e9b\u8282\u70b9\u80fd\u591f\u8bbf\u95ee\u8be5PV</li> </ul> <p>\u9700\u8981\u7279\u522b\u6ce8\u610f\u7684\u662f\u53ea\u6709\u672c\u5730\u76d8\u548cnfs\u652f\u6301\u6570\u636e\u76d8Recycle \u64e6\u9664\u56de\u6536</p> <pre><code>apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: pv0003\nspec:\n  capacity:\n    storage: 10Gi\n  accessModes:\n    - ReadWriteOnce\n  persistentVolumeReclaimPolicy: Recycle\n  storageClassName: slow\n  nfs:\n    path: /tmp\n    server: 172.17.0.2\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#storageclassdynamic-provisioning","title":"StorageClass(Dynamic Provisioning)","text":"<p>\u81ea\u52a8\u521b\u5efaPV\u7684\u673a\u5236\uff0c<code>StorageClass</code>\u5bf9\u8c61\u7684\u4f5c\u7528\u5c31\u662f\u521b\u5efaPV\u7684\u6a21\u677f\uff1a</p> <ul> <li><code>storageclass.kubernetes.io/is-default-class: \"true\"</code> \u6ce8\u89e3\u8868\u660e\u4f7f\u7528\u8fd9\u4e2aStorageClass\u4f5c\u4e3a\u9ed8\u8ba4\u7684\u6301\u4e45\u5316\u5b58\u50a8\u63d0\u4f9b\u8005\uff1b</li> <li>\u6709\u4e24\u4e2a\u6216\u591a\u4e2a\u88ab\u6807\u8bb0\u4e3a\u9ed8\u8ba4\uff0cKubernetes \u5c06\u5ffd\u7565\u8fd9\u4e2a\u6ce8\u89e3\uff0c \u4e5f\u5c31\u662f\u5b83\u5c06\u8868\u73b0\u4e3a\u6ca1\u6709\u9ed8\u8ba4 StorageClass\u3002</li> </ul> <p>\u793a\u4f8b\uff1a<code>cephfs</code></p> <pre><code>apiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: rook-cephfs\n  annotations:\n    storageclass.kubernetes.io/is-default-class: \"true\"\nprovisioner: rook-ceph.cephfs.csi.ceph.com\nparameters:\n  clusterID: rook-ceph\n  csi.storage.k8s.io/controller-expand-secret-name: rook-csi-cephfs-provisioner\n  csi.storage.k8s.io/controller-expand-secret-namespace: rook-ceph\n  csi.storage.k8s.io/node-stage-secret-name: rook-csi-cephfs-node\n  csi.storage.k8s.io/node-stage-secret-namespace: rook-ceph\n  csi.storage.k8s.io/provisioner-secret-name: rook-csi-cephfs-provisioner\n  csi.storage.k8s.io/provisioner-secret-namespace: rook-ceph\n  fsName: myfs\n  pool: myfs-replicated\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#local-pv","title":"Local PV","text":"<p>\u5e94\u7528\u4e8e\u5206\u5e03\u5f0f\u6570\u636e\u5b58\u50a8\u5982 MongoDB\uff0c\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u5982 Ceph \u7b49\uff0c\u4ee5\u53ca\u9700\u8981\u5728\u672c\u5730\u78c1\u76d8\u7f13\u5b58\u5927\u91cf\u6570\u636e\u7684\u5206\u5e03\u5f0f\u5e94\u7528\u3002</p> <ul> <li>\u4e0d\u5e94\u8be5\u5c06\u5bbf\u4e3b\u673a\u4e0a\u7684\u76ee\u5f55\u7528\u4f5cPV\u3002\u4f1a\u5bf9\u5bbf\u4e3b\u673a\u9020\u6210\u5f71\u54cd\uff0c\u4e14\u4e0d\u540c\u672c\u5730\u76ee\u5f55\u4e4b\u95f4\u7f3a\u4e4f\u54ea\u6015\u6700\u57fa\u7840\u7684I/O\u9694\u79bb\u673a\u5236\uff1b</li> <li>Local PV\u5bf9\u5e94\u7684\u5b58\u50a8\u4ecb\u8d28\uff0c\u4e00\u5b9a\u662f\u4e00\u5757\u989d\u5916\u6302\u8f7d\u5728\u5bbf\u4e3b\u673a\u4e0a\u7684\u78c1\u76d8\u6216\u8005\u5757\u8bbe\u5907\uff08\u5373\u4e0d\u662f\u5bbf\u4e3b\u673a\u6839\u76ee\u5f55\u4f7f\u7528\u7684\u4e3b\u786c\u76d8\uff09\uff1b</li> <li>\u4e0d\u652f\u6301<code>Dynamic Provisioning</code>\uff1b</li> </ul> <pre><code>apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: example-pv\nspec:\n  capacity:\n    storage: 5Gi\n  accessModes:\n    - ReadWriteOnce\n  volumeMode: FileSystem\n  persistentVolumeReclaimPolicy: Delete\n  storageClassName: local-storage\n  local:\n    path: /mnt/disk/vol1\n  nodeAffinity:\n    required:\n      nodeSelectorTerms:\n      - matchExpresssions:\n        - key: kubernetes.io/hostname\n          operator: In\n          values:\n          - node-1\n--------------------------------------\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: local-storage\nprovisioner: kubernetes.io/no-provisioner\nvolumeBindingMode: WaitForFirstConsumer\n-----------------------------------\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: example-local-claim\nspec:\n  resources:\n    requests:\n      storage: 5Gi\n  accessModes:\n    - ReadWriteOnce\n  # \u770b\u5230\u8be5storageClass\uff0c\u53d1\u73b0\u662f\u5ef6\u8fdf\u7ed1\u5b9a\n  storageClassName: local-storage\n</code></pre> <p>volumeBindingMode\uff1a\u5ef6\u8fdf\u7ed1\u5b9a\uff0c\u56e0\u4e3a<code>PV</code>\u5bf9\u8282\u70b9\u6709\u8981\u6c42\uff0c<code>Pod</code>\u5bf9\u8282\u70b9\u4e5f\u6709\u8981\u6c42\uff0c\u5728\u521b\u5efaPVC\u65f6\uff0c\u5982\u679cPVC\u7ed1\u5b9aPV\uff0c\u5219\u4f1a\u51fa\u73b0\u4e0d\u5339\u914d\u7684\u60c5\u51b5</p> <ul> <li>\u5c06\u7ed1\u5b9a\u63a8\u8fdf\u5230\u8c03\u5ea6\u7684\u65f6\u5019\uff0c\u6839\u636ePod\u5bf9\u8282\u70b9\u7684\u8981\u6c42\uff0c\u7ed1\u5b9a\u76f8\u5e94\u7684PVC\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#emptydir","title":"emptyDir","text":"<p>\u5728node\u4e0a\u81ea\u52a8\u5206\u914d \u4e00\u4e2a\u76ee\u5f55\uff0c\u56e0\u6b64\u65e0\u9700\u6307\u5b9a\u5bbf\u4e3b\u673anode\u4e0a\u5bf9\u5e94\u7684\u76ee\u5f55\u6587\u4ef6\u3002\u8fd9\u4e2a\u76ee\u5f55\u7684\u521d\u59cb\u5185\u5bb9\u4e3a\u7a7a\uff0c\u5f53Pod\u4ecenode\u4e0a\u79fb\u9664\u65f6\uff0cemptyDir\u4e2d\u7684\u6570\u636e\u4f1a\u88ab\u5220\u9664\u3002</p> <ul> <li>\u4e3b\u8981\u7528\u4e8e\u67d0\u4e9b\u5e94\u7528\u7a0b\u5e8f\u65e0\u9700\u6c38\u4e45\u4fdd\u5b58\u7684\u4e34\u65f6\u76ee\u5f55\uff0c\u591a\u4e2a\u5bb9\u5668\u7684\u5171\u4eab\u76ee\u5f55\u7b49</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#_20","title":"\u8bbe\u5907\u7c7b\u578b","text":"<p><code>VolumeMode</code>\u5b57\u6bb5\u652f\u6301\uff1a</p> <ul> <li> <p>Block\uff08\u539f\u59cb\u7684\u5757\u8bbe\u5907\uff09\uff1aPod \u4f7f\u7528\u65f6\u5728 container \u4e2d\u8bbe\u7f6e <code>VolumeDevices</code></p> </li> <li> <p>FileSystem\uff08\u683c\u5f0f\u5316\u7684\u6587\u4ef6\u7cfb\u7edf\uff09\uff1aPod \u4f7f\u7528\u65f6\u5728 container \u4e2d\u8bbe\u7f6e <code>VolumeMounts</code></p> </li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#pvc","title":"PVC","text":"<p>PV\u548cPVC\u662f\u4e00\u4e00\u5bf9\u5e94\u7684\u3002</p> <p>pvc \uff0d \u5bf9 pv \u8d44\u6e90\u7684\u8bf7\u6c42</p> <ul> <li><code>resources.requests.storage</code>\u7684\u4f5c\u7528\uff1a\uff1f\uff1f</li> </ul> <pre><code>kind: PersistentVolumeClaim\napiVersion: v1\nmetadata:\n  name: myclaim\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 8Gi\n  storageClassName: slow\n  selector:\n    matchLabels:\n      release: \"stable\"\n    matchExpressions:\n      - {key: environment, operator: In, values: [dev]}\n</code></pre> <p>\u5728PVC\u4e2d\u7ed1\u5b9a\u4e00\u4e2aPV\uff0c\u53ef\u4ee5\u6839\u636e\u4e0b\u9762\u51e0\u79cd\u6761\u4ef6\u7ec4\u5408\u9009\u62e9</p> <ul> <li><code>Access Modes</code>\uff1a\u6309\u7167\u8bbf\u95ee\u6a21\u5f0f\u9009\u62e9pv</li> <li><code>Resources</code>\uff1a\u6309\u7167\u8d44\u6e90\u5c5e\u6027\u9009\u62e9\uff0c \u6bd4\u5982\u8bf4\u8bf7\u6c42\u5b58\u50a8\u5927\u5c0f\u4e3a8\u4e2aG\u7684pv</li> <li><code>Selector</code>\uff1a\u6309\u7167pv\u7684label\u9009\u62e9</li> <li><code>Class</code>\uff1a\u6839\u636eStorageClass\u7684class\u540d\u79f0\u9009\u62e9, \u901a\u8fc7annotation\u6307\u5b9a\u4e86Storage Class\u7684\u540d\u5b57, \u6765\u7ed1\u5b9a\u7279\u5b9a\u7c7b\u578b\u7684\u540e\u7aef\u5b58\u50a8</li> </ul>"},{"location":"cloud/k8s/k8s_resource.html#pvcpartition","title":"PVC\u4fdd\u62a4(partition)","text":"<p>\u6709\u7528\u6237\u5220\u9664\u4e86\u4ecd\u5904\u4e8e\u67d0pod\u8d44\u6e90\u4f7f\u7528\u4e2d\u7684PVC\u65f6\uff0cKubernetes\u4e0d\u4f1a\u7acb\u5373\u4e88\u4ee5\u79fb\u9664\uff0c\u800c\u662f\u63a8\u8fdf\u5230\u4e0d\u518d\u88ab\u4efb\u4f55pod\u8d44\u6e90\u4f7f\u7528\u540e\u65b9\u624d\u6267\u884c\u5220\u9664\u64cd\u4f5c\uff1b</p> <p>\u5904\u4e8e\u6b64\u79cd\u9636\u6bb5\u7684PVC\u8d44\u6e90\u7684status\u5b57\u6bb5\u4e3a<code>termination</code>\u5e76\u4e14\u5176<code>Finalizers</code>\u5b57\u6bb5\u4e2d\u5305\u542b<code>kubernetes.io/pvc-protection</code></p>"},{"location":"cloud/k8s/k8s_resource.html#autoscale","title":"AutoScale","text":""},{"location":"cloud/k8s/k8s_resource.html#hpavap","title":"HPA/VAP","text":"<p>\u6839\u636e\u81ea\u5b9a\u4e49\u7684\u6307\u6807\u89e6\u53d1\u6269\u7f29\u5bb9\uff0c\u6848\u4f8b\u89c1Cache Runtime Auto Scaling | Fluid</p> <pre><code>apiVersion: autoscaling/v2beta2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: spark\nspec:\n  # \u4f38\u7f29\u5bf9\u8c61\u4e3aAlluxioData\uff0c\u6700\u5c0f\u526f\u672c\u6570\u4e3a1\uff0c\u6700\u5927\u526f\u672c\u6570\u4e3a4;\n  scaleTargetRef:\n    apiVersion: data.fluid.io/v1alpha1\n    kind: AlluxioRuntime\n    name: spark\n  minReplicas: 1\n  maxReplicas: 4\n  # \u6839\u636e custom metrics \u89e6\u53d1\u6269\u7f29\u5bb9\uff0c\u6761\u4ef6\u662fDataset\u5bf9\u8c61\u7684\u7f13\u5b58\u6570\u636e\u91cf\u5360\u603b\u7f13\u5b58\u5bb9\u91cf\u768490%\n  metrics:\n  - type: Object\n    object:\n      metric:\n        name: capacity_used_rate\n      describedObject:\n        apiVersion: data.fluid.io/v1alpha1\n        kind: Dataset\n        name: spark\n      target:\n        type: Value\n        value: \"90\"\n  behavior:\n    scaleUp:\n      # \u4e00\u6b21\u6269\u5bb9\u5468\u671f\u4e3a 10 \u5206\u949f(periodSeconds),\u6269\u5bb9\u65f6\u65b0\u589e 2 \u4e2a\u526f\u672c\u6570\n      policies:\n      - type: Pods\n        value: 2\n        periodSeconds: 600\n    scaleDown:\n      selectPolicy: Disabled\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#cron","title":"Cron","text":"<p>https://github.com/AliyunContainerService/kubernetes-cronhpa-controller</p> <p>HPA controller that allows to scale your workload based on time schedule.</p> <p>\u5b9a\u65f6\u6269\u7f29\u5bb9\uff0calibabacloud CRD\u3002</p> <pre><code>apiVersion: autoscaling.alibabacloud.com/v1beta1\nkind: CronHorizontalPodAutoscaler\nmetadata:\n  name: spark\n  namespace: default\nspec:\n  # \u63cf\u8ff0\u4f38\u7f29\u7684\u5bf9\u8c61\n  scaleTargetRef:\n    apiVersion: data.fluid.io/v1alpha1\n    kind: AlluxioRuntime\n    name: spark\n  excludeDates:\n  # \u63d0\u4f9b\u5173\u95ed\u4f38\u7f29\u89c4\u5219\u7684\u65f6\u95f4, exclude May 1st\n  - \"* * * 1 5 *\"\n  jobs:\n  - name: \"scale-down\"\n    schedule: \"0 0 8 ? * 1-6\"\n    targetSize: 0\n  - name: \"scale-up\"\n    schedule: \"0 30 21 ? * 1-5\"\n    targetSize: 3\n</code></pre>"},{"location":"cloud/k8s/k8s_resource.html#volumeattachment","title":"VolumeAttachment","text":""},{"location":"cloud/k8s/k8s_security.html","title":"K8s\u5b89\u5168\u673a\u5236","text":""},{"location":"cloud/k8s/k8s_security.html#pod-security","title":"Pod Security","text":"<p><code>hostPID</code> - Use the host\u2019s pid namespace. Optional: Default to false.</p> <p><code>hostIPC</code> - Use the host\u2019s ipc namespace. Optional: Default to false.</p> <ul> <li>container processes to communicate with processes on the host</li> </ul>"},{"location":"cloud/k8s/k8s_security.html#securitycontext","title":"SecurityContext","text":"<p>\u4e09\u79cd\u7ea7\u522b\u7684\u8bbe\u7f6e\uff1a</p> <ul> <li>Container\u7ea7\u522b\uff1aContainer-level Security Context</li> <li>\u5355Pod\u5185\u6240\u6709\u5bb9\u5668\u548cVolume\uff1aPod-level Security Context</li> <li>\u96c6\u7fa4\u5185\u90e8\u6240\u6709Pod\u548cVolume\uff1aPod Security Policies</li> </ul> <p>\u914d\u7f6e\u5b89\u5168\u4e0a\u4e0b\u6587\u53ef\u4ee5</p> <ul> <li>\u8bbf\u95ee\u6743\u9650\u63a7\u5236\uff1a\u6307\u5b9a\u5bb9\u5668\u4e2d\u8fd0\u884c\u8fdb\u7a0b\u7684\u7528\u6237\u548c\u7528\u6237\u7ec4\uff08\u901a\u8fc7uid\u548cgid\uff09\uff1b</li> <li>\u963b\u6b62\u5bb9\u5668\u4f7f\u7528 root \u6237\u8fd0\u884c\uff08\u5bb9\u5668\u7684\u9ed8\u8ba4\u8fd0\u884c\u7528\u6237\u901a\u5e38\u5728\u5176\u955c\u50cf\u4e2d\u6307\u5b9a\uff0c\u6240\u4ee5\u53ef\u80fd\u9700\u8981\u963b\u6b62\u5bb9\u5668 root \u7528\u6237\u8fd0\u884c\uff1b</li> <li>\u4f7f\u7528\u7279\u6743\u6a21\u5f0f\u8fd0\u884c\u5bb9\u5668\uff0c\u4f7f\u5176\u5bf9\u5bbf\u4e3b\u8282\u70b9\u7684\u5185\u6838\u5177\u6709\u5b8c\u5168\u7684\u8bbf\u95ee\u6743\u9650\uff1b</li> <li>\u4e0e\u4ee5\u4e0a\u76f8\u53cd\uff0c\u901a\u8fc7\u6dfb\u52a0\u6216\u7981\u7528\u5185\u6838\u529f\u80fd\uff0c\u914d\u7f6e\u7ec6\u7c92\u5ea6\u7684\u5185\u6838\u8bbf\u95ee\u6743\u9650\uff1b</li> <li>\u8bbe SELinux C Security aced Linux \u5b89\u5168\u589e\u5f3a\u578b Linux \uff09\u8fb9\u9879\uff0c\u52a0\u5f3a\u5bf9\u5bb9\u5668\u7684\u9650\u5236\uff1b</li> <li>\u963b\u6b62\u8fdb\u7a0b\u5199\u5165\u5bb9\u5668\u7684\u6839\u6587\u4ef6\u7cfb\u7edf</li> </ul> <pre><code>kubectl explain 'pods.spec.securityContext'\n</code></pre> <p>Pod\u7684\u8bbe\u7f6e\uff1a</p> <pre><code>apiVersion: v1 \nkind: Pod \nmetadata: \n  name: pod-as-user-guest \nspec: \n  containers: \n  - name: main\n    image: alpine \n    command: [\"/bin/sleep\",\"99999\"]\n    securityContext: \n      # \u7279\u5b9a\u7528\u6237\uff0c\u53ea\u80fd\u6307\u5b9a\u7528\u6237Id\n      runAsUser: 405\n      # \u7279\u5b9a\u7528\u6237\u7ec4\n      runAsGroup: 1000\n      #\n      fsGroup:\n\n      # \u963b\u6b62\u5bb9\u5668\u4f7f\u7528 root \u7528\u6237\u8fd0\u884c\n      runAsNonRoot: true\n</code></pre>"},{"location":"cloud/k8s/k8s_security.html#api-server","title":"API Server \u8ba4\u8bc1","text":"<p>K8s\u96c6\u7fa4\u4e2d\u6240\u6709\u8d44\u6e90\u8bbf\u95ee\u548c\u53d8\u66f4\u90fd\u662f\u901a\u8fc7k8s API Server\u7684REST API\u5b9e\u73b0\uff0c</p> <p>\u8ba4\u8bc1\uff08Authentication\uff09\uff1a\u8bc6\u522b\u5ba2\u6237\u7aef\u7684\u8eab\u4efd\uff1b</p>"},{"location":"cloud/k8s/k8s_security.html#api","title":"API \u8bbf\u95ee\u65b9\u5f0f","text":"<p>K8s API\u7684\u8bbf\u95ee\u65b9\u5f0f\u5206\u7c7b\uff1a</p> <ul> <li>\u8bc1\u4e66\u65b9\u5f0f\u8bbf\u95ee\u7684\u666e\u901a\u7528\u6237\u6216\u8fdb\u7a0b\uff0c\u5305\u62ec\u8fd0\u7ef4\u4eba\u5458\u3001kubectl\u3001kubelets\u7b49\u8fdb\u7a0b\uff1b</li> <li>Service Account\u65b9\u5f0f\u8bbf\u95ee\u7684K8s\u7684\u5185\u90e8\u670d\u52a1\u8fdb\u7a0b\uff1b</li> <li>\u533f\u540d\u65b9\u5f0f\u8bbf\u95ee\u7684\u8fdb\u7a0b\u3002</li> </ul>"},{"location":"cloud/k8s/k8s_security.html#api_1","title":"API \u8ba4\u8bc1\u65b9\u5f0f","text":"<ul> <li>HTTPS \u8bc1\u4e66\u8ba4\u8bc1\uff1a\u9ed8\u8ba4\uff0c\u57fa\u4e8eCA\u6839\u8bc1\u4e66\u7b7e\u540d\u7684\u53cc\u5411\u6570\u5b57\u8bc1\u4e66\u8ba4\u8bc1\u65b9\u5f0f\uff1b</li> <li>HTTP Bear Token\u8ba4\u8bc1\uff1a\u901a\u8fc7Bearer Token\u8bc6\u522b\u5408\u6cd5\u7528\u6237\uff0c\u6307\u5b9a\u5b58\u50a8\u7684\u6587\u4ef6\uff08\u5b58\u50a8token\u5bf9\u5e94\u7684\u7528\u6237\u4fe1\u606f\uff0ccsv\u683c\u5f0f\uff09\uff1b</li> <li>OpenID Connect Token\u8ba4\u8bc1\uff1a\u901a\u8fc7\u7b2c\u4e09\u65b9OIDC\u534f\u8bae\u8fdb\u884c\u8ba4\u8bc1\uff1b</li> <li>Webhook Token\u8ba4\u8bc1\uff1a\u901a\u8fc7\u5916\u90e8Webhook\u670d\u52a1\u8fdb\u884c\u8ba4\u8bc1\uff1b</li> <li>Authentication Proxy\u8ba4\u8bc1\uff1a\u901a\u8fc7\u8ba4\u8bc1\u4ee3\u7406\u7a0b\u5e8f\u8fdb\u884c\u8ba4\u8bc1\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_security.html#api-server_1","title":"API Server \u6388\u6743","text":""},{"location":"cloud/k8s/k8s_security.html#_1","title":"\u6388\u6743\u7b56\u7565","text":"<p>\u9ed8\u8ba4\u4e3a<code>--authorization-mode=Node,RBAC</code></p> <ul> <li>~~AllowDeny\uff1a\u62d2\u7edd\u6240\u6709\uff0c\u4ec5\u7528\u4e8e\u6d4b\u8bd5\uff1b~~</li> <li>~~AlwaysAllow\uff1a\u5141\u8bb8\u6240\u6709\uff0c\u96c6\u7fa4\u4e0d\u9700\u8981\u6388\u6743\u65f6\u4f7f\u7528\uff1b~~</li> <li>ABAC\uff1a\u57fa\u4e8e\u5c5e\u6027\u7684\u8bbf\u95ee\u63a7\u5236\uff1b</li> <li>RBAC\uff1a\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236\uff1b</li> <li>Webhook\uff1a\u57fa\u4e8e\u5916\u90e8\u7684REST\u670d\u52a1\u8fdb\u884c\u6388\u6743\uff1b</li> <li>Node\uff1a\u5bf9kubelet\u8fdb\u884c\u6388\u6743\u7684\u7279\u6b8a\u6a21\u5f0f\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_security.html#rbac","title":"RBAC","text":"<p>Kubernetes\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u673a\u5236\u4ee5\u6ee1\u8db3\u591a\u7528\u6237\u7684\u4f7f\u7528\uff0c\u5305\u62ec\u591a\u7528\u6237\uff0c\u9274\u6743\uff0c\u547d\u540d\u7a7a\u95f4\uff0c\u8d44\u6e90\u9650\u5236\u7b49\u7b49\u3002</p> <p>RBAC\u662fKubernetes \u9ed8\u8ba4\u8fdb\u884c\u6743\u9650\u63a7\u5236\u7684\u65b9\u5f0f\u3002\u7528\u6237\u4e0e\u89d2\u8272\u7ed1\u5b9a\uff0c\u8d4b\u4e88\u89d2\u8272\u6743\u9650\uff1b</p>"},{"location":"cloud/k8s/k8s_security.html#user","title":"User","text":"<ul> <li>\u5728Kubernetes\u91ccUser\u53ea\u662f\u4e00\u4e2a\u7528\u6237\u8eab\u4efd\u8fa8\u8bc6\u7684ID\uff0c\u6ca1\u6709\u771f\u6b63\u7528\u6237\u7ba1\u7406\uff1b</li> <li> <p>\u901a\u8fc7\u7b2c\u4e09\u65b9\u63d0\u4f9b\u7528\u6237\u7ba1\u7406\u548c\u5b58\u50a8\uff0ck8s\u901a\u8fc7User\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u4e0e\u6743\u9650\u8ba4\u8bc1\uff1b</p> </li> <li> <p>Kubernetes\u7528\u6237\u9a8c\u8bc1\u652f\u6301X509\u8bc1\u4e66\u8ba4\u8bc1\uff0ctoken\u8ba4\u8bc1\u548c\u5bc6\u7801\u9a8c\u8bc1\u51e0\u79cd\u65b9\u5f0f\uff1b</p> </li> </ul> <p><code>User</code>\uff1a\u5b57\u7b26\u4e32\u6807\u8bc6\uff0c\u901a\u5e38\u5e94\u8be5\u5728\u5ba2\u6237\u7aefCA\u8bc1\u4e66\u4e2d\u8fdb\u884c\u8bbe\u7f6e\uff0cK8s\u5185\u7f6e\u7cfb\u7edf\u7ea7\u522b\u7684\u7528\u6237/\u7528\u6237\u7ec4\uff0c\u4ee5\"system:\"\u5f00\u5934\uff1b</p>"},{"location":"cloud/k8s/k8s_security.html#service-account","title":"Service Account","text":"<p>\u6bcf\u4e2a Kubernetes \u540d\u5b57\u7a7a\u95f4\u81f3\u5c11\u5305\u542b\u4e00\u4e2a ServiceAccount\uff1a\u4e5f\u5c31\u662f\u8be5\u540d\u5b57\u7a7a\u95f4\u7684\u9ed8\u8ba4\u670d\u52a1\u8d26\u53f7\uff0c \u540d\u4e3a <code>default</code>\u3002</p> <ul> <li>\u5728\u521b\u5efa Pod \u65f6\u6ca1\u6709\u6307\u5b9a ServiceAccount\uff0c\u81ea\u52a8\u5c06\u8be5\u540d\u5b57\u7a7a\u95f4\u4e2d\u540d\u4e3a <code>default</code> \u7684 ServiceAccount \u5206\u914d\u7ed9\u8be5 Pod\uff1b</li> <li><code>automountServiceAccountToken: false</code>\u5b57\u6bb5\u53ef\u4ee5\u914d\u7f6e\u4e0d\u81ea\u52a8\u8bbe\u7f6e</li> </ul> <p>K8s\u5185\u7f6e\uff0c\u5c5e\u4e8e\u8d26\u53f7\u7684\u4e00\u79cd\uff0c\u4f46\u662f\u4e0d\u662f\u7ed9K8s\u96c6\u7fa4\u7684\u7528\u6237\uff08\u7cfb\u7edf\u7ba1\u7406\u5458\u3001\u8fd0\u7ef4\u4eba\u5458\u3001\u79df\u6237\u7528\u6237\u7b49\uff09\u4f7f\u7528\uff0c\u800c\u662f\u7ed9\u8fd0\u884c\u5728Pod\u4e2d\u7684\u8fdb\u7a0b\u4f7f\u7528\uff0c\u63d0\u4f9b\u5fc5\u8981\u7684\u8eab\u4efd\u8bc1\u660e\u3002</p> <ul> <li>K8s \u4f1a\u4e3a <code>ServiceAccount</code>\u81ea\u52a8\u521b\u5efa \u5e76\u5206\u914d Secret \u5bf9\u8c61\uff08<code>token</code>, <code>ca.crt</code>, <code>namespace</code>\u4e09\u4e2a\u6570\u636e\uff09\uff1b</li> <li> <p>container \u4e2d\u7684\u76ee\u5f55\u4f4d\u4e8e\uff1a<code>/var/run/secrets/kubernetes.io/serviceaccount/token</code>\uff1b</p> </li> <li> <p>Pod \u53ef\u4ee5\u5728<code>spec.ServiceAccountName</code>\u4e2d\u4f7f\u7528<code>ServiceAccount</code>\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\u5219K8s\u4e3aPod\u5206\u914d\u9ed8\u8ba4\u7684<code>ServiceAccount</code>\uff1b</p> </li> <li>\u9ed8\u8ba4\u7684<code>ServiceAccount</code>\u6ca1\u6709\u5173\u8054\u4efb\u4f55Role\uff0c\uff1b</li> <li>\u751f\u4ea7\u73af\u5883\uff0c\u5efa\u8bae\u4e3a\u6240\u6709<code>Namespace</code>\u4e0b\u9ed8\u8ba4\u7684<code>ServiceAccount</code>\u7ed1\u5b9a\u53ea\u8bfb\u6743\u9650\u7684<code>Role</code>\uff1b</li> </ul> <pre><code>apiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: drone\n  namespace: default\n# \u81ea\u52a8\u521b\u5efa\nsecrets:\n- name: drone-token-lrgmd\n</code></pre> <p>ServiceAccount \u4e2d\u7684\u5b57\u6bb5\u8fd8\u6709\uff1a</p> <ul> <li><code>imagePullSecrets</code>\uff1aPod \u4f7f\u7528\u8be5 ServiceAccount \u65f6\uff0c\u53ef\u4ee5\u81ea\u52a8\u4f7f\u7528\u8be5\u5b57\u6bb5\u8fdb\u884c\u955c\u50cf\u62c9\u53d6\uff1b</li> <li><code>secrets</code>\uff1a\u7528\u4e8e\u9650\u5236 Pod \u53ea\u80fd\u8bbf\u95ee\u90a3\u4e9b\u5bc6\u94a5\uff08\u4ec5\u5f53\u8be5 ServiceAccount \u5177\u6709  <code>kubernetes.io/enforce-mountable-secrets</code> \u7684\u6ce8\u89e3\u503c\u4e3a true \u65f6\uff09\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_security.html#group","title":"Group","text":"<p>\u5982\u679c\u4e3aK8s\u914d\u7f6e\u5916\u90e8\u8ba4\u8bc1\u670d\u52a1\uff0c\u5219\u201c\u7528\u6237\u7ec4\u201d\u7684\u6982\u5ff5\u7531\u5916\u90e8\u8ba4\u8bc1\u670d\u52a1\u63d0\u4f9b\uff1b</p> <ul> <li><code>ServiceAccount</code>\u5bf9\u5e94\u7684\u201c\u7528\u6237\u201d\u662f\uff1a<code>system:serviceaccount:&lt;NameSpace \u540d&gt;&lt;ServiceAccount\u540d&gt;</code>\uff0c\u5bf9\u5e94\u7684\u5185\u7f6e\u201c\u7528\u6237\u7ec4\u201d\u662f<code>system:serviceaccounts:&lt;Namespace\u540d&gt;</code></li> <li><code>`Group</code>\uff1a\u4e0e\u7528\u6237\u540d\u7c7b\u4f3c\uff0c\u901a\u5e38\u5e94\u8be5\u5728\u5ba2\u6237\u7aefCA\u8bc1\u4e66\u4e2d\u8fdb\u884c\u8bbe\u7f6e\uff0c\u4e0d\u4ee5\"system:\"\u4e3a\u524d\u7f00\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_security.html#role","title":"Role","text":"<p>\u5b9a\u4e49\u89d2\u8272\uff0c\u53d7\u9650\u4e8e\u540d\u7a7a\u95f4\u3002\u5355\u4e2a\u89c4\u5219\u7684\u5b57\u6bb5\uff1a</p> <ul> <li><code>apigroup</code>\uff1aAPI \u7ec4\uff0c\u6bd4\u5982<code>Pod/Deployment</code>\u7b49\u5728<code>\"\"</code>\u7ec4\u4e0b\uff0c<code>Job/CronJob</code>\u5728<code>batch</code>\u7ec4\u4e0b\uff1b</li> <li><code>resource</code>\uff1a\u5bf9\u5e94API\u7ec4\u4e0b\u7684\u8d44\u6e90\uff0c\u5982 Pod\u7b49\uff1b</li> <li><code>verbs</code>\uff1a\u5141\u8bb8\u7684\u64cd\u4f5c\uff0c\u5982<code>get,list,watch,create,update,patch,delete</code>\uff1b</li> <li><code>resourceName</code>\uff1a\u6570\u636e\u6743\u9650\uff0c\u9650\u5b9a\u53ef\u8bbf\u95ee\u7684\u8d44\u6e90\u540d\u79f0\uff1b \u7a7a\u96c6\u5408\u610f\u5473\u7740\u5141\u8bb8\u6240\u6709\u8d44\u6e90\u3002</li> <li>\u5bf9<code>list</code>, <code>watch</code>, <code>create</code>, <code>deletecollection</code>\u64cd\u4f5c\u65e0\u6548</li> </ul> <p>\u6ce8\uff1aRole\u6216ClusterRole\u4e0eRoleBinding\u6216ClusterRoleBinding\u7ed1\u5b9a\u4e4b\u540e\uff0c\u5219Role/ClusterRole\u65e0\u6cd5\u4fee\u6539\uff1b</p> <pre><code>apiVersion: rbac.authorization.k8s.io/v1\nkind: Role\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: example-role\n  namespace: default\nrules:\n- apiGroups:\n  - \"\"\n  resources:\n  - '*'\n  verbs:\n  - '*'\n</code></pre>"},{"location":"cloud/k8s/k8s_security.html#rolebinding","title":"RoleBinding","text":"<p>\u5c06\u7528\u6237\u548c\u89d2\u8272\u7ed1\u5b9a\uff0c\u5904\u4e8e\u7ed9\u5b9a\u547d\u540d\u7a7a\u95f4\u4e2d\u7684 RoleBinding \u4ec5\u5728\u8be5\u547d\u540d\u7a7a\u95f4\u4e2d\u6709\u6548\u3002</p> <ul> <li>\u53ef\u4ee5\u5f15\u7528\u76f8\u540c\u547d\u540d\u7a7a\u95f4\u4e2d\u7684 Role \u6216\u5168\u5c40\u547d\u540d\u7a7a\u95f4\u4e2d\u7684 ClusterRole\uff1b</li> </ul> <p>subjects \u5b57\u6bb5\uff1a</p> <ul> <li> <p>subjects.kind \uff1a\u5fc5\u9700\uff0c\u88ab\u5f15\u7528\u7684\u5bf9\u8c61\u7684\u7c7b\u522b\u3002 \u8fd9\u4e2a API \u7ec4\u5b9a\u4e49\u7684\u503c\u662f <code>User</code>\u3001<code>Group</code> \u548c <code>ServiceAccount</code>\u3002 </p> </li> <li> <p>subjects.name \uff1a\u5fc5\u9700\u88ab\u5f15\u7528\u7684\u5bf9\u8c61\u7684\u540d\u79f0\u3002</p> </li> <li>subjects.apiGroup\uff1aapiGroup \u5305\u542b\u88ab\u5f15\u7528\u4e3b\u4f53\u7684 API \u7ec4\u3002 \u5bf9\u4e8e ServiceAccount \u4e3b\u4f53\u9ed8\u8ba4\u4e3a \"\"\u3002 \u5bf9\u4e8e User \u548c Group \u4e3b\u4f53\uff0c\u9ed8\u8ba4\u4e3a \"rbac.authorization.k8s.io\"\u3002</li> <li>subjects.namespace\uff1a\u88ab\u5f15\u7528\u7684\u5bf9\u8c61\u7684\u547d\u540d\u7a7a\u95f4\u3002 \u201cUser\u201d \u6216 \u201cGroup\u201d \u4e0d\u652f\u6301\u8be5\u5b57\u6bb5\u3002</li> </ul> <pre><code>apiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: example-rolebinding\n  namespace: default\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: drone\nsubjects:\n- kind: User\n  name: drone\n  apigroup: rbac.authorization.k8s.io\n- kind: ServiceAccount\n  name: drone\n  namespace: default\n# \u5e94\u7528\u4e8e`default`\u540d\u7a7a\u95f4\u4e0b\u7684\u6240\u6709ServiceAccount\n- kind: Group\n  name: system:serviceaccounts:default\n  apiGroup: rbac.authorization.k8s.io\n</code></pre>"},{"location":"cloud/k8s/k8s_security.html#clusterrole","title":"ClusterRole","text":"<p>\u5b9a\u4e49\u96c6\u7fa4\u89d2\u8272\uff0c\u4e0d\u53d7\u540d\u7a7a\u95f4\u9650\u5236\u3002</p> <ul> <li>K8s\u5185\u7f6eClusterRole\uff0c\u5305\u62ecadmin\uff0cview\uff0cedit\u7b49</li> </ul>"},{"location":"cloud/k8s/k8s_security.html#clusterrolebinding","title":"ClusterRoleBinding","text":"<p>\u5c06\u7528\u6237\u548c\u96c6\u7fa4\u89d2\u8272\u7ed1\u5b9a\uff0c\u4e0d\u53d7\u9650\u4e8e\u540d\u7a7a\u95f4\u3002</p>"},{"location":"cloud/k8s/k8s_security.html#kubeconfig","title":"\u793a\u4f8b\uff1a\u521b\u5efa\u6743\u9650\u9650\u5b9a\u7684 kubeconfig","text":"<p>\u63a5\u4e0b\u6765\u5c06\u521b\u5efa\u4e00\u4e2a\u540d\u4e3atest\u7684\u7528\u6237\uff0c\u5176\u62e5\u6709test\u547d\u540d\u7a7a\u95f4\u4e0b\u7684\u7ba1\u7406\u5458\u6743\u9650\uff0c\u8be5\u547d\u540d\u7a7a\u95f4\u6709\u7740CPU\uff0c\u5185\u5b58\uff0cPod\u6570\u91cf\u7b49\u9650\u5236\u3002</p>"},{"location":"cloud/k8s/k8s_security.html#serviceaccount","title":"\u521b\u5efaServiceAccount","text":"<p>\u521b\u5efa<code>namespace/test</code>\uff1a\u6bcf\u521b\u5efa\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\uff0c\u90fd\u4f1a\u4e3a\u5176\u65b0\u5efa\u4e00\u4e2a\u540d\u4e3adefault\u7684serviceaccount</p> <pre><code>apiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: starfish1\n  namespace: ai-education\n</code></pre>"},{"location":"cloud/k8s/k8s_security.html#role_1","title":"\u521b\u5efaRole","text":"<p><code>kubectl apply -f role-ai-education.yaml</code></p> <pre><code>kind: Role\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  namespace: ai-education\n  name: starfish1-role\nrules:\n  - apiGroups: [\"\", \"extensions\", \"apps\"]\n    resources: [\"*\"]\n    verbs: [\"*\"]\n  - apiGroups: [\"batch\"]\n    resources:\n      - jobs\n      - cronjobs\n    verbs: [\"*\"]\n</code></pre>"},{"location":"cloud/k8s/k8s_security.html#rolebinding_1","title":"\u521b\u5efa RoleBinding","text":"<p><code>kubectl apply -f rolebinding-ai-education.yaml</code></p> <pre><code>kind: RoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: starfish1-rolebinding\n  namespace: ai-education\nsubjects:\n- kind: ServiceAccount\n  name: starfish1\n  namespace: ai-education\nroleRef:\n  kind: Role\n  name: starfish1-role\n  apiGroup: rbac.authorization.k8s.io\n</code></pre>"},{"location":"cloud/k8s/k8s_security.html#kubeconfig_1","title":"\u521b\u5efakubeconfig","text":"<p>\u83b7\u53d6token\u76f8\u5173\u4fe1\u606f\uff0c\u5229\u7528\u6700\u540e\u4e00\u884c\u7684secrets\u521b\u5efa\u8ba4\u8bc1\u4fe1\u606f</p> <pre><code>kubectl get serviceaccount starfish1 -n ai-education -o yaml \n</code></pre> <p>\u6307\u5b9aserver\u3001name\uff082.4.1\u8282\u7684token\u540d\uff09\u3001namespace\u4fe1\u606f</p> <pre><code>server=https://172.16.2.132:6443\nname=starfish1-token-m4bdx\nnamespace=ai-education\n\ntoken=$(kubectl get secret/$name -n $namespace -o jsonpath='{.data.token}' | base64 --decode)\nca=$(kubectl get secret/$name -n $namespace -o jsonpath=\"{['data']['ca\\.crt']}\")\n\necho \"apiVersion: v1\nkind: Config\nclusters:\n- name: cluster.local\n  cluster:\n    certificate-authority-data: ${ca}\n    server: ${server}\ncontexts:\n- name: cluster.local\n  context:\n    cluster: cluster.local\n    user: starfish1\ncurrent-context: cluster.local\nusers:\n- name: starfish1\n  user:\n    token: ${token}\n\" &gt; starfish1.kubeconfig\n</code></pre>"},{"location":"cloud/k8s/k8s_security.html#kubeconfig_2","title":"\u4f7f\u7528KubeConfig","text":""},{"location":"cloud/k8s/k8s_security.html#1kubeconfig","title":"\u53ef\u90091\uff1a\u6307\u5b9akubeconfig\u8def\u5f84","text":"<pre><code>export KUBECONFIG=/path/starfish1.kubeconfig\n</code></pre>"},{"location":"cloud/k8s/k8s_security.html#2context","title":"\u53ef\u90092\uff1a\u8bbe\u7f6econtext","text":"<p>\u8bbe\u7f6ekubeconfig\u7684user\uff0c\u5176\u540d\u79f0\u4e3atest\uff08\u5c31\u662f<code>serviceaccount/starfish1</code>\u7684token\uff09\uff1a <pre><code>kubectl config set-credentials test --token=&lt;TOKEN_CONTENT&gt;\n</code></pre> <p>\u7136\u540e\u8bbe\u7f6econtext\uff0c\u540d\u79f0\u4e3a<code>test-context</code>\uff0c\u5f15\u7528user\u4e3atest\uff0ccluster\u8bbe\u7f6ekuebconfig\u914d\u7f6e\u6587\u4ef6\u4e2d\u73af\u5883\u9009\u9879\u4e2d\u7684\u96c6\u7fa4\uff0c\u547d\u540d\u7a7a\u95f4\u4e3atest\uff1a</p> <ul> <li>\u4f1a\u5728<code>~/.kube/config</code>\u4e2d\u6dfb\u52a0<code>test-context</code>\u7684\u4fe1\u606f\uff1b</li> </ul> <pre><code>kubectl config set-context test-context --user=test --cluster=&lt;Cluster Name&gt; --namespace=test\n</code></pre> <p>\u6700\u540e\uff0c\u5207\u6362\u81f3\u8be5context\uff1a</p> <pre><code>kubectl config use-context test-context\n</code></pre>"},{"location":"cloud/k8s/k8s_security.html#admission-control","title":"Admission Control","text":"<p>\u51c6\u5165\u63a7\u5236\u5668\u7684\u63d2\u4ef6\u5217\u8868\uff0c\u652f\u6301\u7528\u6237\u81ea\u5b9a\u4e49\u6269\u5c55\u3002</p> <ul> <li>Mutating Admission Webhook\uff0cValidating Admission Webhook</li> </ul>"},{"location":"cloud/k8s/k8s_security.html#_2","title":"\u591a\u79df\u6237\u7ba1\u7406","text":""},{"location":"cloud/k8s/k8s_security.html#hnck8s-builtin","title":"\u591a\u79df\u6237\u65b9\u6848 HNC\uff08K8s-builtin\uff09","text":"<ul> <li>\u5c42\u7ea7\u5316\u7684 Namespace \u7684\u7ed3\u6784\uff1b</li> </ul>"},{"location":"cloud/k8s/k8s_security.html#operator","title":"Operator\u5b9e\u73b0\u7528\u6237\u7ba1\u7406","text":"<p>\u53c2\u8003\uff1aKubernetes Operator\u5b9e\u73b0\u7528\u6237\u7ba1\u7406</p> <ul> <li>\u5728Kubernetes\u91cc\u521b\u5efaUser\u81ea\u5b9a\u4e49\u8d44\u6e90\uff0c\u4f7f\u7528LDAP\u5b58\u50a8\u7528\u6237\u5e10\u53f7\u4fe1\u606f\uff1b</li> <li>\u901a\u8fc7Kubernets CertificateSigningRequest\u8bf7\u6c42X509\u8bc1\u4e66\uff0c\u751f\u6210Kubeconfig\uff1b</li> <li>\u901a\u8fc7\u5404\u79cd\u81ea\u5b9a\u4e49Role\u8d44\u6e90\u6765\u521b\u5efaKubernetes Role\u4e0e\u7528\u6237\u7ed1\u5b9a\uff0c\u5206\u914d\u7528\u6237\u6743\u9650\uff1b</li> <li>\u6700\u7ec8\u7528\u6237\u901a\u8fc7\u5ba2\u6237\u7aef\u4f7f\u7528kubeconfig\u6765\u8bbf\u95eeKubernetes\u8d44\u6e90\u3002</li> </ul> <p>\u4e3b\u8981\u6d41\u7a0b</p> <ol> <li> <p>User\u63a7\u5236\u5668\u8c03\u8c10\uff0c\u521b\u5efaLDAP\u7528\u6237\uff0c\u521b\u5efa\u7528\u6237KubeConfig\u7684Configmap\uff1b</p> </li> <li> <p>\u5728CreateKubeConfig\u751f\u6210kubeconfig\u7528\u6237\u4fe1\u606f\uff0c\u521b\u5efaCertificateSigningRequest\uff1b</p> </li> <li> <p>\u5728Informer\u4e2d\u76d1\u542cCertificateSigningRequest\u4e8b\u4ef6\uff0cApprove\u8bf7\u6c42\uff0c\u66f4\u65b0Configmap\u4e2d\u7528\u6237kubeconfig\u7684\u8bc1\u4e66\u3002</p> </li> </ol>"},{"location":"cloud/k8s/k8s_security.html#kubezoo-","title":"\u8f7b\u91cf\u7ea7\u591a\u79df\u6237\uff08KubeZoo-\u5b57\u8282-\u975e\u5f00\u6e90\uff09","text":"<p>\u8f7b\u91cf\u7ea7 Kubernetes \u591a\u79df\u6237\u65b9\u6848\u7684\u63a2\u7d22\u4e0e\u5b9e\u8df5</p> <p>\u5728\u4e91\u8ba1\u7b97\u65f6\u4ee3\uff0c\u5c31\u51fa\u73b0\u4e86\u591a\u4e2a\u79df\u6237\u5171\u4eab\u540c\u4e00\u4e2a Kubernetes  \u96c6\u7fa4\u7684\u9700\u6c42\u3002</p> <p>\u5728\u8fd9\u65b9\u9762\uff0c\u793e\u533a\u7684<code>Kubernetes Multi-tenancy Working Group</code>\u5b9a\u4e49\u4e86\u4e09\u79cd Kubernetes \u7684\u591a\u79df\u6237\u6a21\u578b\uff1a</p> <ul> <li><code>Namespaces as a Service</code>\uff1a\u591a\u4e2a\u79df\u6237\u5171\u4eab\u4e00\u4e2a Kubernetes \u96c6\u7fa4\uff0c\u6bcf\u4e2a\u79df\u6237\u88ab\u9650\u5b9a\u5728\u81ea\u5df1\u7684 Namespace </li> <li>\u53ea\u80fd\u4f7f\u7528 Namespace \u7ea7\u522b\u7684\u8d44\u6e90\uff0c\u4e0d\u80fd\u4f7f\u7528\u96c6\u7fa4\u7ea7\u522b\u7684\u8d44\u6e90\uff0c\u5b83\u7684 API \u517c\u5bb9\u6027\u6bd4\u8f83\u53d7\u9650\u3002</li> <li><code>Clusters as a Service</code>\u6216<code>Control planes as a Service</code>\uff1a\u79df\u6237\u95f4\u505a\u7269\u7406\u96c6\u7fa4\u9694\u79bb\u7684\u65b9\u6848\u3002\u6bcf\u4e2a\u79df\u6237\u90fd\u6709\u72ec\u7acb\u7684 Master\uff0c\u901a\u8fc7 Cluster API \u6216 Virtual Cluster \u7b49\u9879\u76ee\u5b8c\u6210\u5b83\u7684\u751f\u547d\u5468\u671f\u7ba1\u7406\u3002</li> <li>\u6bcf\u4e2a\u79df\u6237\u90fd\u4f1a\u6709\u4e00\u5957\u72ec\u7acb\u7684\u63a7\u5236\u9762\u7ec4\u4ef6\uff0c\u5305\u62ec API Server\u3001Controller Manager \u4ee5\u53ca\u81ea\u5df1\u7684 Scheduler</li> </ul> <p></p> <p>KubeZoo \u76ee\u7684\uff1a\u5728\u4e00\u4e2aK8s\u96c6\u7fa4\u4e2d\uff0c\u5b9e\u73b0\u591a\u79df\u6237\u9694\u79bb\uff0c\u79df\u6237\u53ef\u4ee5\u521b\u5efa\u96c6\u7fa4\u7ea7\u522b\u7684\u8d44\u6e90\uff08\u5982Namespace\u7b49\uff09</p>"},{"location":"cloud/k8s/k8s_security.html#_3","title":"\u67b6\u6784\u548c\u539f\u7406","text":"<p>KubeZoo \u4f5c\u4e3a\u4e00\u4e2a\u7f51\u5173\u670d\u52a1\uff0c\u90e8\u7f72\u5728 API Server \u7684\u524d\u7aef\u3002\u5b83\u4f1a\u6293\u53d6\u6240\u6709\u6765\u81ea\u79df\u6237\u7684 API \u8bf7\u6c42\uff0c\u7136\u540e\u6ce8\u5165\u79df\u6237\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u6700\u540e\u628a\u8bf7\u6c42\u8f6c\u53d1\u7ed9 API Server\uff0c\u540c\u65f6\u4e5f\u4f1a\u5904\u7406 API Server \u7684\u54cd\u5e94\uff0c\u628a\u54cd\u5e94\u518d\u8fd4\u56de\u7ed9\u79df\u6237\u3002</p> <p>KubeZoo \u7684\u6838\u5fc3\u529f\u80fd\u662f\u5bf9\u79df\u6237\u7684\u8bf7\u6c42\u8fdb\u884c\u534f\u8bae\u8f6c\u6362\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u79df\u6237\u770b\u5230\u7684\u90fd\u662f\u72ec\u5360\u7684 Kubernetes \u96c6\u7fa4\u3002\u5bf9\u4e8e\u540e\u7aef\u96c6\u7fa4\u6765\u8bf4\uff0c\u591a\u4e2a\u79df\u6237\u5b9e\u9645\u4e0a\u662f\u5229\u7528\u4e86 Namespace \u7684\u539f\u751f\u9694\u79bb\u6027\u673a\u5236\u800c\u5171\u4eab\u4e86\u540c\u4e00\u4e2a\u96c6\u7fa4\u7684\u8d44\u6e90\u3002</p> <p>\u9650\u5236\uff1a</p> <ul> <li>\u9488\u5bf9 Daemonset \u548c Node \u7b49\u96c6\u7fa4\u5171\u4eab\u8d44\u6e90\u5bf9\u8c61\u662f\u53d7\u9650\u5236\uff1b</li> </ul>"},{"location":"cloud/k8s/kubelet.html","title":"Kubelet","text":"<p>\u914d\u7f6e\u6587\u4ef6Yaml\u683c\u5f0f\uff1a<code>KubeletConfiguration</code></p> <ul> <li> <p>\u5bbf\u4e3b\u673a\u8fdb\u7a0b\uff1a\u6ce8\u518c\u5230<code>/etc/systemd/system/kubelet.service</code></p> </li> <li> <p><code>syncFrequency</code>\uff1a\u9ed8\u8ba4<code>1min</code>\uff0c\u8868\u793a\u5728\u8fd0\u884c\u4e2d\u7684\u5bb9\u5668\u4e0e\u5176\u914d\u7f6e\u4e4b\u95f4\u6267\u884c\u540c\u6b65\u64cd\u4f5c\u7684\u6700\u957f\u65f6\u95f4\u95f4\u9694\uff1b</p> </li> </ul>"},{"location":"cloud/k8s/kubelet.html#static-pod","title":"Static Pod","text":"<p>Kubernetes\u4e2d\u6709\u4e00\u79cd\u7279\u6b8a\u7684\u5bb9\u5668\u542f\u52a8\u65b9\u6cd5\uff0c\u79f0\u4e3a<code>Static Pod</code>\uff0c\u5141\u8bb8\u628aPod\u7684Yaml\u653e\u5728\u6307\u5b9a\u76ee\u5f55\uff0c\u5f53<code>kubelet</code>\u542f\u52a8\u65f6\uff0c\u4f1a\u81ea\u52a8\u68c0\u67e5\u8be5\u76ee\u5f55\uff0c\u52a0\u8f7d\u6240\u6709\u7684Pod YAML\u5e76\u542f\u52a8\u3002</p> <p>kubeadm \u521b\u5efa\u7684 K8s \u96c6\u7fa4\uff0cMaster\u7ec4\u4ef6\u7684 Yaml \u4f1a\u88ab\u751f\u6210\u5728<code>/etc/kubernetes/manifests</code>\u8def\u5f84\u4e0b\uff1a</p> <ul> <li><code>etcd.yaml</code>\u3001<code>kube-apiserver.yaml</code>\u3001<code>kube-controller-manager.yaml</code>\u3001<code>kube-scheduler.yaml</code>\uff1b</li> </ul>"},{"location":"cloud/k8s/kubelet.html#_1","title":"\u914d\u7f6e","text":""},{"location":"cloud/k8s/kubelet.html#_2","title":"\u7aef\u53e3","text":"<p>10250\uff08kubelet API\uff09\uff1akubectl\u67e5\u770bpod\u7684\u65e5\u5fd7\u548ccmd\u547d\u4ee4\uff0c\u90fd\u662f\u901a\u8fc7kubelet\u7aef\u53e310250\u8bbf\u95ee\u3002</p>"},{"location":"cloud/k8s/kubelet.html#_3","title":"\u5e38\u7528\u547d\u4ee4","text":""},{"location":"cloud/k8s/kubelet.html#_4","title":"\u6807\u8bb0\u8282\u70b9\u4e0d\u53ef\u8c03\u5ea6","text":"<pre><code>$ kubectl cordon $NODENAME\n</code></pre>"},{"location":"cloud/k8s/log_arch.html","title":"\u65e5\u5fd7\u67b6\u6784","text":"<p>\u9488\u5bf9\u5bb9\u5668\u5316\u5e94\u7528\uff0c\u6700\u7b80\u5355\u4e14\u6700\u5e7f\u6cdb\u91c7\u7528\u7684\u65e5\u5fd7\u8bb0\u5f55\u65b9\u5f0f\u5c31\u662f\u5199\u5165\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u6d41\u3002\u4f46\u662f\uff0c\u7531\u5bb9\u5668\u5f15\u64ce\u6216\u8fd0\u884c\u65f6\u63d0\u4f9b\u7684\u539f\u751f\u529f\u80fd\u901a\u5e38\u4e0d\u8db3\u4ee5\u6784\u6210\u5b8c\u6574\u7684\u65e5\u5fd7\u8bb0\u5f55\u65b9\u6848\u3002</p> <ul> <li>\u4f8b\u5982\uff0c\u5982\u679c\u53d1\u751f\u5bb9\u5668\u5d29\u6e83\u3001Pod \u88ab\u9010\u51fa\u6216\u8282\u70b9\u5b95\u673a\u7b49\u60c5\u51b5\uff0c\u4f60\u53ef\u80fd\u60f3\u8bbf\u95ee\u5e94\u7528\u65e5\u5fd7\u3002</li> </ul> <p>\u5728\u96c6\u7fa4\u4e2d\uff0c\u65e5\u5fd7\u5e94\u8be5\u5177\u6709\u72ec\u7acb\u7684\u5b58\u50a8\u548c\u751f\u547d\u5468\u671f\uff0c\u4e0e\u8282\u70b9\u3001Pod \u6216\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\u76f8\u72ec\u7acb\u3002 \u8fd9\u4e2a\u6982\u5ff5\u53eb \u96c6\u7fa4\u7ea7\u7684\u65e5\u5fd7 \u3002</p>"},{"location":"cloud/k8s/log_arch.html#pod","title":"Pod \u548c\u5bb9\u5668\u65e5\u5fd7","text":""},{"location":"cloud/k8s/log_arch.html#_2","title":"\u8282\u70b9\u5bf9\u5bb9\u5668\u65e5\u5fd7\u7684\u5904\u7406\u65b9\u5f0f","text":"<p>\u5bb9\u5668\u5316\u5e94\u7528\u5199\u5165 <code>stdout</code> \u548c <code>stderr</code> \u7684\u4efb\u4f55\u6570\u636e\uff0c\u90fd\u4f1a\u88ab\u5bb9\u5668\u5f15\u64ce\u6355\u83b7\u5e76\u88ab\u91cd\u5b9a\u5411\u5230\u67d0\u4e2a\u4f4d\u7f6e\u3002</p> <p>\u4e0d\u540c\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\u4ee5\u4e0d\u540c\u7684\u65b9\u5f0f\u5b9e\u73b0\u8fd9\u4e00\u70b9\uff1b\u4e0d\u8fc7\u5b83\u4eec\u4e0e kubelet \u7684\u96c6\u6210\u90fd\u88ab\u6807\u51c6\u5316\u4e3a CRI \u65e5\u5fd7\u683c\u5f0f\u3002</p> <ul> <li>Pod\u7684\u65e5\u5fd7\u4f4d\u7f6e\uff1a<code>/var/log/pods/*/*.log</code>\uff1b</li> </ul>"},{"location":"cloud/k8s/log_arch.html#_3","title":"\u65e5\u5fd7\u8f6e\u8f6c","text":"<p><code>kubectl logs</code> \u4ec5\u53ef\u67e5\u8be2\u5230\u6700\u65b0\u7684\u65e5\u5fd7\u5185\u5bb9\uff0c\u6eda\u52a8\u7684\u65e5\u5fd7\u65e0\u6cd5\u67e5\u770b\uff1b</p> <p>\u8282\u70b9\u7ea7\u65e5\u5fd7\u8bb0\u5f55\u4e2d\uff0c\u9700\u8981\u91cd\u70b9\u8003\u8651\u5b9e\u73b0\u65e5\u5fd7\u7684\u8f6e\u8f6c\uff0c\u4ee5\u6b64\u6765\u4fdd\u8bc1\u65e5\u5fd7\u4e0d\u4f1a\u6d88\u8017\u8282\u70b9\u4e0a\u5168\u90e8\u53ef\u7528\u7a7a\u95f4\u3002</p> <p>kubelet \u8d1f\u8d23\u8f6e\u6362\u5bb9\u5668\u65e5\u5fd7\u5e76\u7ba1\u7406\u65e5\u5fd7\u76ee\u5f55\u7ed3\u6784\u3002</p> <ul> <li>kubelet\uff08\u4f7f\u7528 CRI\uff09\u5c06\u6b64\u4fe1\u606f\u53d1\u9001\u5230\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u800c\u8fd0\u884c\u65f6\u5219\u5c06\u5bb9\u5668\u65e5\u5fd7\u5199\u5230\u7ed9\u5b9a\u4f4d\u7f6e\u3002</li> <li><code>containerLogMaxSize</code> \uff08\u9ed8\u8ba4 10Mi\uff09\u548c <code>containerLogMaxFiles</code>\uff08\u9ed8\u8ba4 5\uff09</li> </ul>"},{"location":"cloud/k8s/log_arch.html#_4","title":"\u7cfb\u7edf\u7ec4\u4ef6\u65e5\u5fd7","text":"<p>\u7cfb\u7edf\u7ec4\u4ef6\u6709\u4e24\u79cd\u7c7b\u578b\uff1a\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\u7684\u548c\u4e0d\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\u7684\u3002\u4f8b\u5982\uff1a</p> <ul> <li>\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\u7684 kube-scheduler, kube-proxy, kube-apiserver, kube-controller-manager\uff1b</li> <li>\u5c06\u65e5\u5fd7\u5199\u5230 <code>/var/log</code> \u76ee\u5f55\uff0c\u7ed5\u8fc7\u4e86\u9ed8\u8ba4\u7684\u65e5\u5fd7\u673a\u5236\uff0c\u4f7f\u7528 klog \u65e5\u5fd7\u5e93\uff1b</li> <li>\u4e0d\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\u7684 kubelet \u548c\u5bb9\u5668\u8fd0\u884c\u65f6\uff1b</li> <li>\u4f7f\u7528 systemd \u673a\u5236\u7684Linux\u4e0a\uff0ckubelet \u548c\u5bb9\u5668\u5bb9\u5668\u8fd0\u884c\u65f6\u5c06\u65e5\u5fd7\u5199\u5165\u5230 journald \u4e2d\u3002 \u4f7f\u7528<code>journalctl -u kubelet</code>\u67e5\u770b\u65e5\u5fd7\u3002</li> <li>\u5982\u679c\u6ca1\u6709 systemd\uff0c\u5b83\u4eec\u5c06\u65e5\u5fd7\u5199\u5165\u5230 <code>/var/log</code> \u76ee\u5f55\u4e0b\u7684 <code>.log</code> \u6587\u4ef6\u4e2d</li> <li><code>/var/log</code> \u76ee\u5f55\u4e2d\u7684\u7cfb\u7edf\u7ec4\u4ef6\u65e5\u5fd7\uff0c\u88ab\u5de5\u5177 <code>logrotate</code> \u6267\u884c\u6bcf\u65e5\u8f6e\u8f6c\uff0c\u6216\u8005\u65e5\u5fd7\u5927\u5c0f\u8d85\u8fc7 100MB \u65f6\u89e6\u53d1\u8f6e\u8f6c\uff1b</li> </ul>"},{"location":"cloud/k8s/log_arch.html#_5","title":"\u96c6\u7fa4\u7ea7\u65e5\u5fd7\u67b6\u6784","text":"<ul> <li> <p>\u5e94\u7528\u65e5\u5fd7\u8f93\u51fa\u5230 stdout/stderr\uff0c\u5728\u5bbf\u4e3b\u673a\u90e8\u7f72 logging-agent \u96c6\u4e2d\u5904\u7406\u65e5\u5fd7\uff1b</p> </li> <li> <p>\u6216 sidecar\u5f62\u5f0f\u76f4\u63a5\u5c06\u65e5\u5fd7\u53d1\u9001\u5230\u6307\u5b9a\u597d\u7684\u65e5\u5fd7\u7684\u5b58\u50a8\u540e\u7aef\uff1b</p> </li> </ul> <p>\u867d\u7136 Kubernetes \u6ca1\u6709\u4e3a\u96c6\u7fa4\u7ea7\u65e5\u5fd7\u8bb0\u5f55\u63d0\u4f9b\u539f\u751f\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e9b\u9009\u9879\uff1a</p> <ul> <li>\u4f7f\u7528\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u7684\u8282\u70b9\u7ea7\u65e5\u5fd7\u8bb0\u5f55\u4ee3\u7406\u3002</li> <li>\u5728\u5e94\u7528\u7a0b\u5e8f\u7684 Pod \u4e2d\uff0c\u5305\u542b\u4e13\u95e8\u8bb0\u5f55\u65e5\u5fd7\u7684\u8fb9\u8f66\uff08Sidecar\uff09\u5bb9\u5668\u3002</li> <li>\u5c06\u65e5\u5fd7\u76f4\u63a5\u4ece\u5e94\u7528\u7a0b\u5e8f\u4e2d\u63a8\u9001\u5230\u65e5\u5fd7\u8bb0\u5f55\u540e\u7aef\u3002</li> </ul>"},{"location":"cloud/k8s/log_arch.html#_6","title":"\u4f7f\u7528\u8282\u70b9\u7ea7\u65e5\u5fd7\u4ee3\u7406","text":"<p>\u6bcf\u4e2a\u8282\u70b9\u4e0a\u4f7f\u7528\u8282\u70b9\u7ea7\u7684\u65e5\u5fd7\u8bb0\u5f55\u4ee3\u7406\u6765\u5b9e\u73b0\u96c6\u7fa4\u7ea7\u65e5\u5fd7\u8bb0\u5f55\u3002</p> <ul> <li>\u63a8\u8350\u4ee5 <code>DaemonSet</code> \u7684\u5f62\u5f0f\u8fd0\u884c\u8be5\u4ee3\u7406\u3002</li> <li>\u5bb9\u5668\u5411\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u5199\u51fa\u6570\u636e\uff0c\u4f46\u5728\u683c\u5f0f\u4e0a\u5e76\u4e0d\u7edf\u4e00\u3002 \u8282\u70b9\u7ea7\u4ee3\u7406\u6536\u96c6\u8fd9\u4e9b\u65e5\u5fd7\u5e76\u5c06\u5176\u8fdb\u884c\u8f6c\u53d1\u4ee5\u5b8c\u6210\u6c47\u603b\u3002</li> </ul> <p></p>"},{"location":"cloud/k8s/log_arch.html#_7","title":"\u4f7f\u7528\u8fb9\u8f66\u5bb9\u5668\u8fd0\u884c\u65e5\u5fd7\u4ee3\u7406","text":"<p>\u4ee5\u4e0b\u65b9\u5f0f\u4e4b\u4e00\u4f7f\u7528\u8fb9\u8f66\uff08Sidecar\uff09\u5bb9\u5668\uff1a</p> <ul> <li>\u8fb9\u8f66\u5bb9\u5668\u5c06\u5e94\u7528\u7a0b\u5e8f\u65e5\u5fd7\u4f20\u9001\u5230\u81ea\u5df1\u7684\u6807\u51c6\u8f93\u51fa\u3002</li> <li>\u8fb9\u8f66\u5bb9\u5668\u8fd0\u884c\u4e00\u4e2a\u65e5\u5fd7\u4ee3\u7406\uff0c\u914d\u7f6e\u8be5\u65e5\u5fd7\u4ee3\u7406\u4ee5\u4fbf\u4ece\u5e94\u7528\u5bb9\u5668\u6536\u96c6\u65e5\u5fd7\u3002</li> </ul>"},{"location":"cloud/k8s/log_arch.html#_8","title":"\u4f20\u8f93\u6570\u636e\u6d41\u7684\u8fb9\u8f66\u5bb9\u5668","text":"<p>\u5e94\u7528\u7a0b\u5e8f\u5c06\u65e5\u5fd7\u5199\u5230\u6587\u4ef6\u4e2d\uff0c\u8fb9\u8f66\u5bb9\u5668\u8bfb\u53d6\u8be5\u6587\u4ef6\u5e76\u8f93\u51fa\u5230 <code>stdout</code>\u548c<code>stderr</code>\u4e2d</p> <ul> <li>\u5141\u8bb8\u4f60\u5c06\u65e5\u5fd7\u6d41\u4ece\u5e94\u7528\u7a0b\u5e8f\u7684\u4e0d\u540c\u90e8\u5206\u5206\u79bb\u5f00\uff0c\u5982\u5b58\u5728\u591a\u79cd\u4e0d\u540c\u683c\u5f0f\u7684\u8f93\u51fa\u6587\u4ef6\uff1b</li> <li>\u53ef\u4ee5\u4f7f\u7528\u5185\u7f6e\u7684\u5de5\u5177 <code>kubectl logs</code>\uff0c\u67e5\u770b\u7684\u662f\u8fb9\u8f66\u5bb9\u5668\u7684\u7684<code>stdout</code>\u548c<code>stderr</code>\uff1b</li> </ul> <p>\u96c6\u7fa4\u4e2d\u5b89\u88c5\u7684\u8282\u70b9\u7ea7\u4ee3\u7406\u4f1a\u81ea\u52a8\u83b7\u53d6\u8fd9\u4e9b\u65e5\u5fd7\u6d41\uff0c\u800c\u65e0\u9700\u8fdb\u4e00\u6b65\u914d\u7f6e\u3002</p> <p></p>"},{"location":"cloud/k8s/log_arch.html#_9","title":"\u5177\u6709\u65e5\u5fd7\u4ee3\u7406\u529f\u80fd\u7684\u8fb9\u8f66\u5bb9\u5668","text":"<p>\u521b\u5efa\u4e00\u4e2a\u5e26\u6709\u5355\u72ec\u65e5\u5fd7\u8bb0\u5f55\u4ee3\u7406\u7684\u8fb9\u8f66\u5bb9\u5668\uff0c\u5c06\u4ee3\u7406\u7a0b\u5e8f\u4e13\u95e8\u914d\u7f6e\u4e3a\u4e0e\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u4e00\u8d77\u8fd0\u884c\u3002</p> <ul> <li>\u5728\u8fb9\u8f66\u5bb9\u5668\u4e2d\u4f7f\u7528\u65e5\u5fd7\u4ee3\u7406\u4f1a\u5e26\u6765\u4e25\u91cd\u7684\u8d44\u6e90\u635f\u8017\uff1b</li> <li>\u4e0d\u80fd\u4f7f\u7528 <code>kubectl logs</code> \u8bbf\u95ee\u65e5\u5fd7\uff0c\u56e0\u4e3a\u65e5\u5fd7\u5e76\u6ca1\u6709\u88ab kubelet \u7ba1\u7406\u3002</li> </ul> <p></p>"},{"location":"cloud/k8s/log_arch.html#_10","title":"\u4ece\u5e94\u7528\u4e2d\u76f4\u63a5\u66b4\u9732\u65e5\u5fd7\u76ee\u5f55","text":"<p>\u4ece\u5404\u4e2a\u5e94\u7528\u4e2d\u76f4\u63a5\u66b4\u9732\u548c\u63a8\u9001\u65e5\u5fd7\u6570\u636e\u7684\u96c6\u7fa4\u65e5\u5fd7\u673a\u5236\u5df2\u8d85\u51fa Kubernetes \u7684\u8303\u56f4\u3002</p> <p></p>"},{"location":"cloud/k8s/log_arch.html#_11","title":"\u53c2\u8003\u6587\u6863","text":"<ol> <li>\u65e5\u5fd7\u67b6\u6784 | Kubernetes \u5b98\u65b9</li> </ol>"},{"location":"cloud/k8s/metrics.html","title":"\u6307\u6807\u76d1\u63a7","text":""},{"location":"cloud/k8s/metrics.html#k8s","title":"K8s\u8d44\u6e90\u76d1\u63a7\u6307\u6807","text":"<p>Metrics API \u53ca\u5176\u542f\u7528\u7684\u6307\u6807\u7ba1\u9053\u4ec5\u63d0\u4f9b\u6700\u5c11\u7684 CPU \u548c\u5185\u5b58\u6307\u6807\uff0c\u4ee5\u542f\u7528\u4f7f\u7528 HPA \u548c/\u6216 VPA \u7684\u81ea\u52a8\u6269\u5c55\u3002 \u5982\u679c\u4f60\u60f3\u63d0\u4f9b\u66f4\u5b8c\u6574\u7684\u6307\u6807\u96c6\uff0c\u53ef\u4ee5\u901a\u8fc7\u90e8\u7f72\u7b2c\u4e8c\u4e2a\u6307\u6807\u7ba1\u9053\uff08\u4f7f\u7528 Custom Metrics API \uff09\u6765\u4f5c\u4e3a\u7b80\u5355\u7684 Metrics API \u7684\u8865\u5145\u3002</p> <p></p>"},{"location":"cloud/k8s/metrics.html#cadvisor","title":"cAdvisor","text":"<p>Analyzes resource usage and performance characteristics of running containers.</p> <p>\u7528\u4e8e\u6536\u96c6\u3001\u805a\u5408\u548c\u516c\u5f00 Kubelet \u4e2d\u5305\u542b\u7684\u5bb9\u5668\u6307\u6807\u7684\u5b88\u62a4\u7a0b\u5e8f\u3002</p> <p>\u76ee\u524d cAdvisor\u96c6\u6210\u5230kubelet\u7ec4\u4ef6\u5185\uff0c\u53ef\u4ee5\u5728kubernetes\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u542f\u52a8\u4e86kubelet\u7684\u8282\u70b9\u4f7f\u7528cAdvisor\u63d0\u4f9b\u7684metrics\u63a5\u53e3\u83b7\u53d6\u8be5\u8282\u70b9\u6240\u6709\u5bb9\u5668\u76f8\u5173\u7684\u6027\u80fd\u6307\u6807\u6570\u636e\u3002</p> <p>\u4eceapi server\u8bbf\u95eecadvisor\u7684\u5730\u5740\uff1a</p> <ul> <li>cAdvisor\u7684metrics\u5730\u5740: <code>/api/v1/nodes/[\u8282\u70b9\u540d\u79f0]/proxy/metrics/cadvisor</code></li> </ul> <p>\u76f4\u63a5\u4ece\u5404\u4e2anode\u7684 kubelet \u8bbf\u95eecadvisor\u7684\u5730\u5740\uff1a</p> <ul> <li>cAdvisor\u7684metrics\u5730\u5740: <code>node_ip:10250/metrics/cadvisor</code></li> </ul>"},{"location":"cloud/k8s/metrics.html#aggregator","title":"Aggregator","text":"<p>kubeadm \u90e8\u7f72\u7684 K8s \u96c6\u7fa4\uff0cAggregator \u6a21\u5f0f\u9ed8\u8ba4\u5f00\u542f\u3002</p> <ul> <li>kube-aggregator \u6839\u636eURL\u9009\u62e9\u5177\u4f53\u7684API\u540e\u7aef\u7684\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u5c06\u7b2c\u4e09\u65b9\u670d\u52a1\u6ce8\u518c\u5230 Kubernetes API \u4e2d\u3002</li> </ul> <pre><code>--requestheader-client-ca-file=&lt;path to aggregator CA cert&gt;\n--requestheader-allowed-names=front-proxy-client\n--requestheader-extra-headers-prefix=X-Remote-Extra-\n--requestheader-group-headers=X-Remote-Group\n--requestheader-username-headers=X-Remote-User\n--proxy-client-cert-file=&lt;path to aggregator proxy cert&gt;\n--proxy-client-key-file=&lt;path to aggregator proxy key&gt;\n</code></pre> <p>\u5bf9\u4e8e<code>metrics.k8s.io</code>\u7684\u6307\u6807\uff0c\u4ee3\u7406\u5230\u540e\u7aef\u7684<code>metrics-server</code></p> <p></p>"},{"location":"cloud/k8s/metrics.html#metrics-server","title":"Metrics Server","text":"<ul> <li>Metrics Server is a scalable, efficient source of container resource metrics for Kubernetes built-in autoscaling pipelines. Metrics Server is meant only for autoscaling purposes. </li> </ul> <p>Metrics-serve \u57fa\u4e8ecAdvisor \u6536\u96c6\u6307\u6807\u6570\u636e\uff0c\u83b7\u53d6\u3001\u683c\u5f0f\u5316\u540e\u4ee5 metrics API \u7684\u5f62\u5f0f\u4ece apiserver \u5bf9\u5916\u66b4\u9732\uff0c\u6838\u5fc3\u4f5c\u7528\u662f\u4e3a kubectl top \u4ee5\u53ca HPA/VPA \u7b49\u7ec4\u4ef6\u63d0\u4f9b\u51b3\u7b56\u6307\u6807\u652f\u6301\u3002</p> <ul> <li>\u6bcf15\u79d2\u6536\u96c6\u4e00\u6b21\u6307\u6807\uff0c\u6bcf\u4e2a\u8282\u70b9\u4f7f\u7528 1 mili core CPU\u548c 2 MB\u5185\u5b58\u3002</li> <li>\u8f7b\u91cf\u7ea7\u7684\u3001\u77ed\u671f\u3001\u5185\u5b58\u5b58\u50a8\u3002</li> </ul> <p>\u901a\u8fc7\u6807\u51c6\u7684 K8s API \u8bbf\u95ee\u76d1\u63a7\u6570\u636e\uff1a</p> <ul> <li>Pod\u7684\u76d1\u63a7\uff1a<code>/apis/metrics.k8s.io/v1beta1/namespaces/&lt;namespace-name&gt;/pods/&lt;pod-name&gt;</code></li> </ul> <p>\u5982\u679c metrics server \u7684 pod \u5b58\u5728\uff0c\u4f46\u662f <code>kubectl top pods</code> \u62a5\u9519\uff1a\u201cNo Metrics for pods ...\u201d</p> <ul> <li><code>kubectl get --raw /api/v1/nodes/${nodeIP}/proxy/metrics/resource</code> \u67e5\u770b\u662f\u5426\u6709 pod \u7684 cpu / memory \u7684\u6307\u6807\uff1b</li> <li>\u5982\u679c\u6ca1\u6709\uff0c\u5219\u91cd\u542f kubelet\uff1a<code>systemctl restart kubelet.service</code></li> </ul>"},{"location":"cloud/k8s/metrics.html#_2","title":"\u5b89\u88c5","text":"<p>Metrics Server \u5e76\u4e0d\u662f kube-apiserver\u7684\u4e00\u90e8\u5206\uff0c\u800c\u662f\u901a\u8fc7 Aggregator \u63d2\u4ef6\u673a\u5236\u3002</p> <ul> <li>\u8981\u6c42 k8s apiserver \u5fc5\u987b\u542f\u7528\u805a\u5408\u5c42\uff0cK8s \u7248\u672c\u517c\u5bb9\u6027\u77e9\u9635</li> </ul> <pre><code>kubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml\n</code></pre>"},{"location":"cloud/k8s/metrics.html#custom-metrics","title":"Custom Metrics","text":"<p>\u901a\u8fc7\u67e5\u8be2 Prometheus \u7684\u6307\u6807\uff0c\u66b4\u9732 custom metrics\u3002</p>"},{"location":"cloud/k8s/metrics.html#k8s_1","title":"K8s\u5bf9\u8c61\u72b6\u6001\u76d1\u63a7","text":"<p>kube-state-metrics\u63d2\u4ef6\u4ee3\u7406\u53ef\u4ee5\u8fde\u63a5\u5230 Kubernetes API \u670d\u52a1\u5668\u5e76\u516c\u5f00\u4e00\u4e2a HTTP \u7aef\u70b9\uff0c\u63d0\u4f9b\u96c6\u7fa4\u4e2d\u5404\u4e2a\u5bf9\u8c61\u7684\u72b6\u6001\u6240\u751f\u6210\u7684\u6307\u6807\u3002 </p> <p>\u6b64\u4ee3\u7406\u516c\u5f00\u4e86\u5173\u4e8e\u5bf9\u8c61\u72b6\u6001\u7684\u5404\u79cd\u4fe1\u606f\uff0c\u5982\u6807\u7b7e\u548c\u6ce8\u89e3\u3001\u542f\u52a8\u548c\u7ec8\u6b62\u65f6\u95f4\u3001\u5bf9\u8c61\u5f53\u524d\u6240\u5904\u7684\u72b6\u6001\u6216\u9636\u6bb5\u3002</p> <p>\u4f8b\u5982\uff0c\u9488\u5bf9\u8fd0\u884c\u5728 Pod \u4e2d\u7684\u5bb9\u5668\u4f1a\u521b\u5efa\u4e00\u4e2a <code>kube_pod_container_info</code> \u6307\u6807\u3002 \u5176\u4e2d\u5305\u62ec\u5bb9\u5668\u7684\u540d\u79f0\u3001\u6240\u5c5e\u7684 Pod \u7684\u540d\u79f0\u3001Pod \u6240\u5728\u7684\u547d\u540d\u7a7a\u95f4\u3001 \u5bb9\u5668\u955c\u50cf\u7684\u540d\u79f0\u3001\u955c\u50cf\u7684 ID\u3001\u5bb9\u5668\u89c4\u7ea6\u4e2d\u7684\u955c\u50cf\u540d\u79f0\u3001\u8fd0\u884c\u4e2d\u5bb9\u5668\u7684 ID \u548c\u7528\u4f5c\u6807\u7b7e\u7684 Pod ID\u3002</p>"},{"location":"cloud/k8s/metrics.html#nvidia-gpu-metrics","title":"NVIDIA GPU Metrics","text":"<p>NVIDIA/dcgm-exporter: NVIDIA GPU metrics exporter for Prometheus leveraging DCGM</p>"},{"location":"cloud/k8s/metrics.html#goglient","title":"GoGlient\u4f7f\u7528","text":""},{"location":"cloud/k8s/metrics.html#_3","title":"\u96c6\u7fa4\u603b\u7684\u8d44\u6e90\u4fe1\u606f/\u8282\u70b9\u7684\u603b\u8d44\u6e90\u4fe1\u606f","text":"<p>\u901a\u8fc7 client-go \u83b7\u53d6\u6240\u6709\u7684 Nodes \u4fe1\u606f\uff0c\u5c06\u8d44\u6e90\u8fdb\u884c\u6c47\u805a</p> <pre><code>// this code is copied from kubedl project.\nfunc (ov *DataHandler) GetClusterTotalResource() (model.ClusterTotalResource, error) {\n    nodes := &amp;corev1.NodeList{}\n    err := client.List(context.TODO(), nodes)\n    if err != nil {\n        klog.Errorf(\"GetClusterTotalResource Failed to list nodes\")\n        return model.ClusterTotalResource{}, err\n    }\n    totalResource := corev1.ResourceList{}\n    for _, node := range nodes.Items {\n        allocatable := node.Status.Allocatable.DeepCopy()\n        totalResource = resources.Add(totalResource, allocatable)\n    }\n    clusterTotal := model.ClusterTotalResource{\n        TotalCPU:    totalResource.Cpu().MilliValue(),\n        TotalMemory: totalResource.Memory().Value(),\n        TotalGPU:    getGpu(totalResource).MilliValue()}\n    return clusterTotal, nil\n}\n// get gpu from custom resource map\nfunc getGpu(resourceList corev1.ResourceList) *resource.Quantity {\n    if val, ok := (resourceList)[\"nvidia.com/gpu\"]; ok {\n        return &amp;val\n    }\n    return &amp;resource.Quantity{Format: resource.DecimalSI}\n}\n</code></pre>"},{"location":"cloud/k8s/metrics.html#_4","title":"\u96c6\u7fa4\u5df2\u4f7f\u7528\u7684\u8d44\u6e90\u4fe1\u606f/\u8282\u70b9\u5df2\u4f7f\u7528\u7684\u8d44\u6e90\u4fe1\u606f","text":"<p>\u83b7\u53d6\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7684Pod\uff0c\u5bf9\u4e8e Phase \u4e3a Running \u7684 Pod \u8ba1\u7b97\u603b\u7684\u8d44\u6e90\u7533\u8bf7\uff1a</p> <ul> <li>\u901a\u8fc7 controller-runtime \u7684 client \u5bf9 <code>pod.spec.nodeName</code>\u8fdb\u884c index\uff0c\u63d0\u5347 List \u6548\u7387\uff0c\u53ef\u53c2\u8003 kubedl\uff1b</li> </ul>"},{"location":"cloud/k8s/metrics.html#pod","title":"\u8fd0\u884c\u4e2d\u7684 Pod \u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5","text":"<p>\u901a\u8fc7 Metrics Server \u53ef\u4ee5\u83b7\u53d6 Pod \u7684 CPU/Memory \u7684\u5b9e\u65f6\u4f7f\u7528\u4fe1\u606f\u3002</p> <ul> <li>\u6216\u8005\u901a\u8fc7go pkg metrics api\u8bbf\u95ee</li> </ul> <pre><code>$ curl -ik -H \"Authorization: Bearer $TOKEN\" https://k8s.hc.cn:6443/apis/metrics.k8s.io/v1beta1/namespaces/default/pods/\n</code></pre> <p>\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>{\n  \"kind\": \"PodMetricsList\",\n  \"apiVersion\": \"metrics.k8s.io/v1beta1\",\n  \"metadata\": {\n    \"selfLink\": \"/apis/metrics.k8s.io/v1beta1/namespaces/default/pods/\"\n  },\n  \"items\": [\n    // \u6bcf\u4e2a Pod \u7684 CPU / GPU \u4f7f\u7528\u60c5\u51b5\n    {\n      \"metadata\": {\n        \"name\": \"minio-7d66769f84-4qw52\",\n        \"namespace\": \"default\",\n        \"selfLink\": \"/apis/metrics.k8s.io/v1beta1/namespaces/default/pods/minio-7d66769f84-4qw52\",\n        \"creationTimestamp\": \"2024-02-20T07:03:29Z\"\n      },\n      \"timestamp\": \"2024-02-20T07:02:49Z\",\n      \"window\": \"30s\",\n      \"containers\": [\n        {\n          \"name\": \"minio\",\n          \"usage\": {\n            \"cpu\": \"201812n\",\n            \"memory\": \"92596Ki\"\n          }\n        }\n      ]\n    },\n    ...\n  ]\n}\n</code></pre>"},{"location":"cloud/k8s/metrics.html#_5","title":"\u53c2\u8003\u6587\u6863","text":"<ol> <li>\u8d44\u6e90\u76d1\u63a7\u5de5\u5177 | Kubernetes</li> <li>Kubernetes \u5bf9\u8c61\u72b6\u6001\u7684\u6307\u6807 | Kubernetes</li> </ol>"},{"location":"cloud/k8s/network.html","title":"k8s \u7f51\u7edc\u6a21\u578b","text":"<p>\"\u7f51\u7edc\u6808\"\u5305\u62ec\u7f51\u5361\uff0c\u56de\u73af\u8bbe\u5907\uff0c\u8def\u7531\u8868\uff0ciptables\u89c4\u5219\u3002</p> <p>\u4e8c\u5c42\u7f51\u7edc\uff1a\u6839\u636e MAC\u5730\u5740\u8868\u8fdb\u884c\u6570\u636e\u5305\u7684\u8f6c\u53d1\uff1b</p> <p>\u4e09\u5c42\u7f51\u7edc\uff1a\u901a\u8fc7 IP \u8def\u7531\u5b9e\u73b0\u8de8\u7f51\u6bb5\u7684\u901a\u8baf\uff1b</p> <p>\u7f51\u7edc\u7cfb\u7edf\u7684\u7684\u56db\u4e2a\u4e3b\u8981\u95ee\u9898\uff1a</p> <ol> <li>\u9ad8\u5ea6\u8026\u5408\u7684\u5bb9\u5668\u95f4\u901a\u4fe1\uff1a\u8fd9\u4e2a\u5df2\u7ecf\u88ab Pod \u548c <code>localhost</code> \u901a\u4fe1\u89e3\u51b3\u4e86\u3002</li> <li>Pod \u95f4\u901a\u4fe1\uff1a\u8fd9\u662f\u672c\u6587\u6863\u8bb2\u8ff0\u7684\u91cd\u70b9\u3002</li> <li>Pod \u4e0e Service \u95f4\u901a\u4fe1\uff1a\u6db5\u76d6\u5728 Service \u4e2d\u3002</li> <li>\u5916\u90e8\u4e0e Service \u95f4\u901a\u4fe1\uff1a\u4e5f\u6db5\u76d6\u5728 Service \u4e2d\u3002</li> </ol>"},{"location":"cloud/k8s/network.html#cni","title":"CNI","text":"<p>Container Network Interface</p> <ul> <li>Weave\u3001Calico\u3001Flannel\u3001Canal\u3001Romana\u3001kube-router \u7b49\u5b9e\u73b0\u3002</li> <li>K8s 1.24 \u7248\u672c\u53ca\u4ee5\u540e\uff0c CNI \u7684\u7ba1\u7406\u4e0d\u518d\u662f kubelet \u7684\u5de5\u4f5c\u3002</li> </ul> <p>CNI \u7f51\u6865\uff1a\u63a5\u7ba1K8s\u521b\u5efa\u7684Pod</p> <ul> <li>\u57fa\u7840\u53ef\u6267\u884c\u6587\u4ef6\u5728<code>/opt/cni/bin</code>\u76ee\u5f55\u4e0b\uff1b</li> </ul> <p>CNI\u63d2\u4ef6\uff1a</p> <ul> <li>ADD\u64cd\u4f5c\uff1a\u5c06\u5bb9\u5668\u6dfb\u52a0\u5230 CNI \u7f51\u7edc\u91cc\uff1b</li> <li>DEL\u64cd\u4f5c\uff1a\u4ece CNI \u7f51\u7edc\u91cc\u79fb\u9664\u5bb9\u5668\uff1b</li> </ul> <p>\u6bcf\u4e00\u4e2aPod\u90fd\u62e5\u6709\u4e00\u4e2a\u6241\u5e73\u5316\u5171\u4eab\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\u7684\u300cPodIP\u300d\u3002</p> <ul> <li>\u901a\u8fc7PodIP\u8de8\u8d8a\u7f51\u7edc\u4e0e\u5176\u4ed6\u7269\u7406\u673a\u548cPod\u8fdb\u884c\u901a\u4fe1\u3002</li> <li>IP-Per-Pod \u6a21\u578b\u521b\u5efa\u4e86\u4e00\u4e2a\u5e72\u51c0\u7684\u3001\u53cd\u5411\u517c\u5bb9\u7684\u6a21\u578b\u3002</li> </ul> <p>\u8be5\u6a21\u578b\u4e2d\uff0c\u4ece\u7aef\u53e3\u5206\u914d\u3001\u7f51\u7edc\u3001\u57df\u540d\u89e3\u6790\u3001\u670d\u52a1\u53d1\u73b0\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u5e94\u7528\u914d\u7f6e\u548c\u8fc1\u79fb\u7b49\u89d2\u5ea6\uff0cPod\u90fd\u80fd\u88ab\u770b\u4f5c\u662f\u865a\u62df\u673a\u6216\u8005\u7269\u7406\u673a\uff0c\u5e94\u7528\u53ef\u4ee5\u5e73\u6ed1\u5730\u4ece\u975e\u5bb9\u73af\u5883\u8fc1\u79fb\u5230\u540c\u4e00\u4e2aPod\u5185\u7684\u5bb9\u5668\u73af\u5883\u3002</p>"},{"location":"cloud/k8s/network.html#pod","title":"Pod\u5185\u901a\u4fe1","text":"<p>Pod\uff1aPod\u662f\u5bb9\u5668\u7684\u96c6\u5408\uff1b</p> <ul> <li>Pod\u5305\u542b\u7684\u5bb9\u5668\u90fd\u8fd0\u884c\u5728\u540c\u4e00\u4e2a\u5bbf\u4e3b\u673a\uff0c\u62e5\u6709\u76f8\u540c\u7f51\u7edc\u7a7a\u95f4\uff0c\u5bb9\u5668\u4e4b\u95f4\u53ef\u4ee5\u4e92\u76f8\u901a\u4fe1\uff1b</li> <li>Pod\u8fd0\u884c\u7684\u5bb9\u5668\u4e2d\u5305\u542b\u4e1a\u52a1\u5bb9\u5668\u548c\u7f51\u7edc\u5bb9\u5668 \u300cpause\u300d\uff1b</li> <li>\u300cpause\u300d\u5168\u79f0infrastucture container\uff08\u53c8\u53ebinfra\uff09\u57fa\u7840\u5bb9\u5668\u3002</li> <li>\u7f51\u7edc\u5bb9\u5668\u53ea\u7528\u6765\u63a5\u7ba1Pod\u7684\u7f51\u7edc\uff0c\u4e1a\u52a1\u5bb9\u5668\u901a\u8fc7\u52a0\u5165\u7f51\u7edc\u5bb9\u5668\u7684\u7f51\u7edc\u5b9e\u73b0\u7f51\u7edc\u5171\u4eab</li> </ul> <p>Pod\u5185\u5bb9\u5668\u7c7b\u4f3c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u8fd0\u884c\uff1a</p> <pre><code>docker run -p 80:80 -p 8080:8080 --name network-container -d gcr.io/google_container/pause:3.1\ndocker run --net container:network-container -d jonlangemak/docker:web_container_8080\n</code></pre> <p>Pod\u4e2d\u7684\u5bb9\u5668\u7f51\u7edc\u62d3\u6251</p> <p></p>"},{"location":"cloud/k8s/network.html#pod_1","title":"Pod\u95f4\u901a\u4fe1","text":"<p>k8s\u7f51\u7edc\u6a21\u578b\u662f\u4e00\u4e2a\u6241\u5e73\u5316\u7684\u7f51\u7edc\u5e73\u9762\uff0cPod\u4f5c\u4e3a\u4e00\u4e2a\u7f51\u7edc\u5355\u5143\u540ck8s Node\u7f51\u7edc\u5904\u4e8e\u4e00\u4e2a\u5c42\u7ea7</p> <p>\u793a\u4f8b\uff1a\u6700\u5c0f\u7684k8s\u7f51\u7edc\u62d3\u6251</p> <ul> <li>Pod\u95f4\u901a\u4fe1\uff1aPod1\u548cPod2\uff08\u540c\u4e3b\u673a\uff09\uff0c Pod1\u548cPod3\uff08\u8de8\u4e3b\u673a\u901a\u4fe1\uff09</li> <li>Node\u4e0ePod\u95f4\u901a\u4fe1\uff1aNode1\u4e0ePod1/Pod2\uff08\u540c\u4e3b\u673a\uff09\uff0cPod3\uff08\u8de8\u4e3b\u673a\u80fd\u591f\u901a\u4fe1\uff09</li> </ul> <p></p> <p>\u95ee\u9898\uff1a</p> <ol> <li>\u5982\u4f55\u4fdd\u8bc1Pod\u7684PodIP\u662f\u5168\u5c40\u552f\u4e00\u7684\uff1f</li> <li>Pod\u7684PodIP\u662fDocker\u7f51\u6865\u5206\u914d\u7684\uff0c\u6240\u4ee5\u5c06\u4e0d\u540c k8s Node\u7684Docker\u7f51\u6865\u914d\u7f6e\u6210\u4e0d\u540c\u7684IP\u7f51\u6bb5\u5373\u53ef\u3002</li> <li>\u540c\u4e00\u4e2ak8s Node\u4e0a\u7684Pod/\u5bb9\u5668\u539f\u751f\u80fd\u901a\u4fe1\uff0c\u4e0d\u901aNode\u4e4b\u95f4\u7684Pod\u5982\u4f55\u901a\u4fe1\uff1f</li> <li>\u5bf9Docker\u8fdb\u884c\u589e\u5f3a\uff0c\u5728\u5bb9\u5668\u96c6\u7fa4\u4e2d\u521b\u5efa\u4e00\u4e2a\u8986\u76d6\u7f51\u7edc\uff08Overlay Network\uff09\uff0c\u8054\u901a\u5404\u8282\u70b9\uff0c\u5982Flannel \uff0cCalico\uff1b</li> <li>Overlay Network \u672c\u8eab\uff0c\u53ef\u4ee5\u7531\u6bcf\u53f0\u5bbf\u4e3b\u673a\u4e0a\u7684\u4e00\u4e2a\u201c\u7279\u6b8a\u7f51\u6865\u201d\u5171\u540c\u7ec4\u6210 \u6216\u8005 \u901a\u8fc7\u914d\u7f6e\u5bbf\u4e3b\u673a\u7684\u8def\u7531\u8868\u5b9e\u73b0\uff1b</li> </ol> <p></p>"},{"location":"cloud/k8s/network.html#flannel","title":"Flannel \u7f51\u7edc\u6a21\u578b","text":"<p>Flannel \u662f\u7531 CoreOS \u56e2\u961f\u8bbe\u8ba1\u7684\u8986\u76d6\u7f51\u7edc\u5de5\u5177</p> <ul> <li>UDP\u6a21\u5f0f\uff1a\u6027\u80fd\u6700\u5dee\uff0c\u5df2\u5e9f\u5f03\uff1b</li> <li>VXLAN\u6a21\u5f0f\uff1a</li> <li>HOST_GW\u6a21\u5f0f\uff1a</li> </ul>"},{"location":"cloud/k8s/network.html#udp","title":"UDP","text":"<ul> <li>Flannel\u4e3a\u4e3b\u673a\u8bbe\u5b9a\u4e00\u4e2a\u5b50\u7f51\uff0c\u901a\u8fc7\u96a7\u9053\u534f\u8bae\u5c01\u88c5\u5bb9\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u62a5\u6587\uff0c\u5b9e\u73b0\u5bb9\u5668\u7684\u8de8\u4e3b\u673a\u901a\u4fe1\u3002</li> <li>Flannel\u4f1a\u4e3a\u6bcf\u4e00\u53f0\u5bbf\u4e3b\u673a\u5206\u914d\u4e00\u4e2a\u201c\u5b50\u7f51\u201d\uff0c\u4e00\u53f0\u5bbf\u4e3b\u673a\u4e0a\u7684\u6240\u6709\u5bb9\u5668\uff0c\u90fd\u5c5e\u4e8e\u8fd9\u4e2a\u201c\u5b50\u7f51\u201d\uff0c\u5373\u90fd\u5c5e\u4e8e\u540c\u4e00\u4e2a\u7f51\u6bb5\uff0c\u5b50\u7f51\u4e0e\u5bbf\u4e3b\u673a\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u4fdd\u5b58\u5728 Etcd</li> </ul> <pre><code>$ etcdctl ls /coreos.com/network/subnets\n/coreos.com/network/subnets/100.96.1.0-24\n/coreos.com/network/subnets/100.96.2.0-24\n/coreos.com/network/subnets/100.96.3.0-24 \n# \u5b50\u7f51\u5bf9\u5e94\u7684\u5bbf\u4e3b\u673a\u7684 IP \u5730\u5740\n$ etcdctl get /coreos.com/network/subnets/100.96.2.0-24\n{\"PublicIP\":\"10.168.0.3\"}\n</code></pre> <ul> <li> <p>\u914d\u7f6e\u5b8c\u6210\uff0c\u6bcf\u4e2a\u4e0a\u8fd0\u884c<code>flanneld</code>\u8fdb\u7a0b\uff0c\u521b\u5efa\u4e00\u4e2a\u53eb\u505aflannel0\u7684\u8bbe\u5907\uff0c\u6dfb\u52a0\u4e00\u7cfb\u5217\u7684\u8def\u7531\u89c4\u5219\uff0c\u7528\u6765\u6307\u5b9a\u6570\u636e\u5305\u7684\u4e0b\u4e00\u8df3</p> </li> <li> <p>flannel0 \u8bbe\u5907\u662f\u4e00\u4e2aTUN \u8bbe\u5907\uff08Tunnel \u8bbe\u5907\uff09\uff0cTUN \u8bbe\u5907\u662f\u4e00\u79cd\u5de5\u4f5c\u5728\u4e09\u5c42\u7684\u865a\u62df\u7f51\u7edc\u8bbe\u5907\uff1b</p> </li> <li>TUN\u8bbe\u5907\uff1a\u5728\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u548c\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u4f20\u9012 IP \u5305\u3002\u800c\u6dfb\u52a0\u7684\u8def\u7531\u89c4\u5219\u5219\u5305\u542b\u4e86\u6d41\u5165flannel0 \u8bbe\u5907\u548c\u6d41\u51faflannel0 \u8bbe\u5907\u7684\u8def\u7531\u3002</li> </ul> <p>\u7f51\u7edc\u6d41\u8f6c\uff1a</p> <ul> <li>\u5f53 IP \u5305\u4ece\u5bb9\u5668\u7ecf\u8fc7 docker0 \u51fa\u73b0\u5728\u5bbf\u4e3b\u673a\u540e\uff0c\u5c31\u4f1a\u6839\u636e\u8def\u7531\u8868\u8fdb\u5165 flannel0 \u8bbe\u5907\uff1b</li> <li>\u5bbf\u4e3b\u673a\u4e0a\u7684 flanneld \u8fdb\u7a0b\u5c31\u4f1a\u6536\u5230\u8fd9\u4e2a IP \u5305\uff0c\u6839\u636e\u8fd9\u4e2a IP \u5305\u7684\u76ee\u7684\u5730\u5740\uff0c\u5339\u914d\u5230\u5bf9\u5e94\u7684\u5b50\u7f51\uff0c\u4ece Etcd \u4e2d\u627e\u5230\u8fd9\u4e2a\u5b50\u7f51\u5bf9\u5e94\u7684\u5bbf\u4e3b\u673a\u7684 IP \u5730\u5740\uff1b</li> <li>flanneld\u5c06\u8fd9\u4e2aIP\u5305\u76f4\u63a5\u5c01\u88c5\u5728\u4e00\u4e2a UDP \u5305\u91cc\uff0c\u901a\u8fc7\u7269\u7406\u7f51\u7edc\u53d1\u9001\u7ed9\u76ee\u7684\u5bbf\u4e3b\u673a\u7684 flanneld\uff08\u76d1\u542c8285 \u7aef\u53e3\uff09\uff1b</li> <li>\u76ee\u7684\u5bbf\u4e3b\u673a\u7684flanneld \u5c31\u53ef\u4ee5\u4ece\u8fd9\u4e2a UDP \u5305\u91cc\u89e3\u6790\u51fa\u5c01\u88c5\u5728\u91cc\u9762\u7684\u6e90\u5bb9\u5668\u53d1\u6765\u7684\u539f IP \u5305\uff0c\u76f4\u63a5\u628a\u8fd9\u4e2a IP \u5305\u53d1\u9001\u7ed9\u5b83\u6240\u7ba1\u7406\u7684 TUN \u8bbe\u5907\uff1b</li> <li>Linux\u5185\u6838\u4f1a\u6839\u636e\u8def\u7531\u89c4\u5219\uff0c\u628a\u8fd9\u4e2a IP \u5305\u8f6c\u53d1\u7ed9 docker0 \u7f51\u6865\uff08\u4f5c\u4e3a\u4e8c\u5c42\u4ea4\u6362\u673a\uff09\uff0c\u5c06\u6570\u636e\u5305\u53d1\u9001\u7ed9\u6b63\u786e\u7684\u7aef\u53e3\uff0c\u8fdb\u800c\u901a\u8fc7 Veth Pair \u8bbe\u5907\u8fdb\u5165\u5230\u76ee\u7684\u5bb9\u5668\u91cc</li> </ul> <p></p> <p>\u603b\u7ed3\uff1a</p> <ul> <li> <p>\u5de5\u4f5c\u5728\u4e09\u5c42\u7684overlay\u7f51\u7edc\uff1b</p> </li> <li> <p>\u5728\u53d1\u51fa IP \u5305\u7684\u8fc7\u7a0b\uff0c\u9700\u8981\u4e09\u6b21\u7528\u6237\u6001\u4e0e\u5185\u6838\u6001\u4e4b\u95f4\u7684\u6570\u636e\u62f7\u8d1d\uff1b</p> </li> </ul> <p></p>"},{"location":"cloud/k8s/network.html#vxlan","title":"VXLAN","text":"<p>VXLAN\u5373Virtual Extensible LAN\uff08\u865a\u62df\u53ef\u6269\u5c55\u5c40\u57df\u7f51\uff09\uff0c\u662f Linux \u5185\u6838\u672c\u8eab\u5c31\u652f\u6301\u7684\u4e00\u79cd\u7f51\u7edc\u865a\u4f3c\u5316\u6280\u672f\u3002</p> <ul> <li>\u5728\u73b0\u6709\u7684\u4e09\u5c42\u7f51\u7edc\u4e4b\u4e0a\uff0c\u201c\u8986\u76d6\u201d\u4e00\u5c42\u865a\u62df\u7684\u3001\u7531\u5185\u6838 VXLAN \u6a21\u5757\u8d1f\u8d23\u7ef4\u62a4\u7684\u4e8c\u5c42\u7f51\u7edc\uff0c\u4f7f\u5f97\u8fde\u63a5\u5728\u8fd9\u4e2a VXLAN \u4e8c\u5c42\u7f51\u7edc\u4e0a\u7684\u201c\u4e3b\u673a\u201d\uff08\u865a\u62df\u673a\u6216\u8005\u5bb9\u5668\u90fd\u53ef\u4ee5\uff09\u4e4b\u95f4\uff0c\u50cf\u5728\u540c\u4e00\u4e2a\u5c40\u57df\u7f51\uff08LAN\uff09\u91cc\u90a3\u6837\u81ea\u7531\u901a\u4fe1\uff1b</li> <li>\u5728\u5bbf\u4e3b\u673a\u4e0a\u8bbe\u7f6e\u4e00\u4e2a\u7279\u6b8a\u7684\u7f51\u7edc\u8bbe\u5907 VTEP\uff0c\u5373\uff1aVXLAN Tunnel End Point\uff08\u865a\u62df\u96a7\u9053\u7aef\u70b9\uff09</li> <li>\u5185\u6838\u91cc\u5b8c\u6210\u5bf9\u4e8c\u5c42\u6570\u636e\u5e27\u8fdb\u884c\u5c01\u88c5\u548c\u89e3\u5c01\u88c5\uff1b</li> </ul> <p>Flannel \u7684\u6d41\u7a0b\uff1a</p> <ul> <li>\u5728\u5404\u8282\u70b9\u4e0a\u6dfb\u52a0\u76f8\u5e94\u7684\u8def\u7531\u89c4\u5219\uff0c\u7528\u6765\u6307\u5b9a\u6570\u636e\u5305\u7684\u4e0b\u4e00\u8df3\uff1b</li> <li>\u7ef4\u62a4\u4e00\u4e2aARP\u8868\uff0c\u5b58\u50a8\u5404\u8282\u70b9\u7684VTEP\u8bbe\u5907\u7684MAC\u5730\u5740\uff1b</li> <li>\u7ef4\u62a4\u4e00\u4e2aFDP\u8f6c\u53d1\u6570\u636e\u5e93\uff0c\u5b58\u50a8\u5404VTEP\u8bbe\u5907\u6240\u5728\u7684\u5bbf\u4e3b\u673aip\uff1b</li> </ul> <p></p> <p>\u901a\u4fe1\u6d41\u7a0b\uff1a\u6bcf\u53f0\u8bbe\u5907\u4e0a\u5df2\u7ecf\u6709\u4e86VTEP\u8bbe\u5907\uff08\u5373\u4e0a\u56fe\u4e2d\u7684flannel.1 \u7684\u8bbe\u5907\uff09\u548c\u76f8\u5e94\u7684\u8def\u7531\u89c4\u5219</p> <ul> <li>\u6e90\u5bb9\u5668\u53d1\u51fa\u8bf7\u6c42\u540e\uff0c\u6570\u636e\u5305\u5305\u542b\u4e86\u6e90\u5bb9\u5668ip\u548c\u76ee\u7684\u5bb9\u5668ip\uff1b</li> <li>\u6570\u636e\u5305\u901a\u8fc7\u865a\u62df\u7f51\u5361\u5bf9\u51fa\u73b0\u5728docker0\u7f51\u6865\u4e0a\uff0c\u7136\u540e\u6839\u636e\u8def\u7531\u89c4\u5219\u5230\u8fbeVTEP\u8bbe\u5907\uff0c\u8981\u53d1\u5f80\u7684\u7f51\u5173\u5730\u5740\u4e3a\u76ee\u7684VTEP\u8bbe\u5907\u7684ip\uff1b</li> <li>VTEP\u4f1a\u4eceARP\u8868\u91cc\u83b7\u53d6\u5230\u5bf9\u5e94\u7684MAC\u5730\u5740\uff0c\u5e76\u8fdb\u884c\u4e8c\u5c42\u5c01\u5305\uff0c\u5f97\u5230\u4e00\u4e2a\u4e8c\u5c42\u6570\u636e\u5e27\uff0c\u79f0\u4e3a\u201c\u5185\u90e8\u6570\u636e\u5e27\u201d\uff1b</li> <li>Linux \u5185\u6838\u4f1a\u5728\u201c\u5185\u90e8\u6570\u636e\u5e27\u201d\u524d\u9762\uff0c\u52a0\u4e0a\u4e00\u4e2a\u7279\u6b8a\u7684 VXLAN \u5934\uff1b</li> <li>Linux \u5185\u6838\u4f1a\u4eceFDB\u6570\u636e\u5e93\u91cc\u8bfb\u53d6\u5230\u5bf9\u5e94\u7684\u76ee\u7684\u5bbf\u4e3b\u673aip\uff0c\u628a\u201c\u5185\u90e8\u6570\u636e\u5e27\u201d\u548c\u76ee\u7684\u5bbf\u4e3b\u673aip\u5c01\u88c5\u8fdb\u4e00\u4e2a UDP \u5305\u91cc\uff0c\u79f0\u4e3a\u201c\u5916\u90e8\u6570\u636e\u5e27\u201d\uff1b</li> <li>Linux\u5185\u6838\u4f1a\u5728\u8fd9\u4e2a\u201c\u5916\u90e8\u6570\u636e\u5e27\u201d\u524d\u9762\u52a0\u4e0a\u76ee\u7684\u5bbf\u4e3b\u673a\u7684MAC\u5730\u5740\uff1b</li> <li>\u6e90\u5bbf\u4e3b\u673a\u4e0a\u7684 flannel.1 \u8bbe\u5907\u5c31\u53ef\u4ee5\u628a\u8fd9\u4e2a\u6570\u636e\u5e27\u4ece\u6e90\u5bbf\u4e3b\u673a\u7684 eth0 \u7f51\u5361\u53d1\u51fa\u53bb\uff0c\u5230\u76ee\u7684\u5bbf\u4e3b\u673a\u7684 eth0 \u7f51\u5361\uff1b</li> <li>\u76ee\u7684\u5bbf\u4e3b\u673a\u7684\u5185\u6838\u7f51\u7edc\u6808\u4f1a\u53d1\u73b0\u8fd9\u4e2a\u6570\u636e\u5e27\u91cc\u6709 VXLAN Header\uff0c\u5e76\u4e14 VNI=1\uff1b</li> <li>\u76ee\u7684\u5bbf\u4e3b\u673a\u7684Linux \u5185\u6838\u4f1a\u5bf9\u5b83\u8fdb\u884c\u62c6\u5305\uff0c\u62ff\u5230\u91cc\u9762\u7684\u5185\u90e8\u6570\u636e\u5e27\uff0c\u7136\u540e\u6839\u636e VNI \u7684\u503c\uff0c\u628a\u5b83\u4ea4\u7ed9 flannel.1 \u8bbe\u5907\uff1b</li> <li>flannel.1 \u8bbe\u5907\u5219\u4f1a\u8fdb\u4e00\u6b65\u62c6\u5305\uff0c\u53d6\u51fa\u201c\u539f\u59cb IP \u5305\u201d\uff0c\u7136\u540e\u6839\u636e\u8def\u7531\u89c4\u5219\uff0c\u5c06\u5b83\u4ea4\u7ed9docker0\u7f51\u6865\u3002</li> </ul>"},{"location":"cloud/k8s/network.html#host_gw","title":"HOST_GW","text":"<p>\u5c06\u6bcf\u4e2a Flannel \u5b50\u7f51\u7684\u201c\u4e0b\u4e00\u8df3\u201d\uff0c\u8bbe\u7f6e\u6210\u4e86\u8be5\u5b50\u7f51\u5bf9\u5e94\u7684\u5bbf\u4e3b\u673a\u7684 IP \u5730\u5740\u3002</p> <ul> <li>\u4e3b\u673a\u201d\uff08Host\uff09\u4f1a\u5145\u5f53\u8fd9\u6761\u5bb9\u5668\u901a\u4fe1\u8def\u5f84\u91cc\u7684\u201c\u7f51\u5173\u201d\uff08Gateway\uff09;</li> <li>flanneld\u4f1a\u5728\u5bbf\u4e3b\u673a\u4e0a\u521b\u5efa\u76f8\u5e94\u7684\u8def\u7531\u89c4\u5219\uff0c\u8bbe\u7f6e\u5230\u67d0\u4e00\u76ee\u7684\u7f51\u6bb5\u7684\u7684\u6570\u636e\u5305\uff0c\u5e94\u8be5\u7ecf\u8fc7\u672c\u673a\u7684 eth0 \u8bbe\u5907\u53d1\u51fa\u53bb\uff0c\u4e14\u4e0b\u4e00\u8df3\u5730\u5740\u662f\u76ee\u7684\u4e3b\u673aip\u3002</li> <li>Flannel \u5b50\u7f51\u548c\u4e3b\u673a\u7684\u4fe1\u606f\uff0c\u90fd\u662f\u4fdd\u5b58\u5728 Etcd \u5f53\u4e2d\uff0cflanneld \u53ea\u9700\u8981 WACTH \u8fd9\u4e9b\u6570\u636e\u7684\u53d8\u5316\uff0c\u7136\u540e\u5b9e\u65f6\u66f4\u65b0\u8def\u7531\u8868\u5373\u53ef\uff1b</li> </ul> <p></p> <p>\u5bb9\u5668\u901a\u4fe1\u7684\u8fc7\u7a0b\u5c31\u514d\u9664\u4e86\u989d\u5916\u7684\u5c01\u5305\u548c\u89e3\u5305\u5e26\u6765\u7684\u6027\u80fd\u635f\u8017\u3002</p> <ul> <li>\u6839\u636e\u5b9e\u9645\u7684\u6d4b\u8bd5\uff0chost-gw \u7684\u6027\u80fd\u635f\u5931\u5927\u7ea6\u5728 10% \u5de6\u53f3\uff0c\u800c\u5176\u4ed6\u6240\u6709\u57fa\u4e8e VXLAN\u201c\u96a7\u9053\u201d\u673a\u5236\u7684\u7f51\u7edc\u65b9\u6848\uff0c\u6027\u80fd\u635f\u5931\u90fd\u5728 20%~30% \u5de6\u53f3\u3002</li> </ul>"},{"location":"cloud/k8s/network.html#calico","title":"Calico \u7f51\u7edc\u6a21\u578b","text":"<p>\u5176\u89e3\u51b3\u65b9\u6848\u8ddf Flannel \u7684 host-gw \u6a21\u5f0f\u51e0\u4e4e\u5b8c\u5168\u4e00\u6837\uff1a</p> <ul> <li>\u6bcf\u53f0\u5bbf\u4e3b\u673a\u6dfb\u52a0\u4e00\u6761\u683c\u5f0f\u5982\u4e0b\u7684\u8def\u7531\u89c4\u5219\uff1a\u7f51\u5173\u7684ip\u5730\u5740\u662f\u76ee\u7684\u5bb9\u5668\u6240\u5728\u7684ip\u5730\u5740\uff1b</li> </ul> <pre><code>&lt;\u76ee\u7684\u5bb9\u5668IP\u5730\u5740\u6bb5&gt; via &lt;\u7f51\u5173\u7684IP\u5730\u5740&gt; dev eth0\n</code></pre> <ul> <li> <p>\u4e0d\u4f1a\u5728\u5bbf\u4e3b\u673a\u521b\u5efa\u4efb\u4f55\u7f51\u6865\u8bbe\u5907\uff1b</p> </li> <li> <p>\u4f46\u91c7\u7528 BGP \u81ea\u52a8\u5728\u96c6\u7fa4\u4e2d\u5206\u53d1\u8def\u7531\u6d88\u606f\uff0c\u800c\u4e0d\u662f\u91c7\u7528 etcd + flanneld \u7ef4\u62a4\u8def\u7531\u4fe1\u606f\uff1b</p> </li> </ul> <p>BGP\uff08border gateway protocol\uff09\uff1a\u8fb9\u754c\u7f51\u5173\u534f\u8bae\uff0cLinux \u5185\u6838\u539f\u751f\u652f\u6301\u3001\u4e13\u95e8\u7528\u4e8e\u5927\u89c4\u6a21\u6570\u636e\u4e2d\u5fc3\u7ef4\u62a4\u4e0d\u540c\u201c\u81ea\u6cbb\u7cfb\u7edf\u201d\u4e4b\u95f4\u8def\u7531\u4fe1\u606f\u7684\u65e0\u4e2d\u5fc3\u7684\u8def\u7531\u534f\u8bae\u3002</p> <p>Calico \u7ec4\u6210\uff1a</p> <ul> <li> <p><code>calico/node</code>\uff08\u4f5c\u4e3aDaemonSet\uff09\u662f\u4e00\u4e2a\u7531\u4e24\u4e2a\u5bb9\u5668\u7ec4\u6210\u7684Pod</p> </li> <li> <p>Felix\uff08\u5b88\u62a4\u8fdb\u7a0b\uff09\uff1a\u8d1f\u8d23\u5728\u5bbf\u4e3b\u673a\u63d2\u5165\u8def\u7531\u89c4\u5219\uff08\u5199\u5165Linux\u5185\u6838\u7684FIB\u8f6c\u53d1\u4fe1\u606f\u5e93\uff09\uff0c\u7ef4\u62a4Calico\u6240\u9700\u7684\u7f51\u7edc\u8bbe\u5907\uff1b</p> </li> <li> <p>BIRD\uff08\u5b88\u62a4\u8fdb\u7a0b\uff09\uff1aBGP\u7684\u5ba2\u6237\u7aef\uff0c\u8d1f\u8d23\u5728\u96c6\u7fa4\u603b\u5206\u53d1\u8def\u7531\u89c4\u5219\u4fe1\u606f\uff1b</p> </li> <li> <p>CNI \u63d2\u4ef6\uff1a\u4e0e K8s \u5bf9\u63a5\uff1b</p> </li> <li> <p>\u4f7f\u7528 Kubernetes API \u670d\u52a1\u5668\u4f5c\u4e3a\u5206\u5e03\u5f0f\u6570\u636e\u5b58\u50a8\uff0c\u6d88\u9664\u4e86\u6784\u5efa\u548c\u7ef4\u62a4etcd\u6570\u636e\u5b58\u50a8\u7684\u9700\u8981\u3002</p> </li> </ul>"},{"location":"cloud/k8s/network.html#bgp","title":"BGP \u6a21\u5f0f","text":"<p>\u4fee\u6539 calico.yaml \u90e8\u7f72\u6587\u4ef6\u4e2d\u7684<code>CALICO_IPV4POOL_IPIP</code>\u548c<code>CALICO_IPV4POOL_VXLAN</code> \u503c\u4fee\u6539\u6210<code>Never</code>\uff0c\u5219\u5207\u6362\u5230BGP\u7f51\u7edc\u3002</p> <ul> <li>\u786e\u4fdd\u6240\u6709\u7269\u7406\u8282\u70b9\u5728\u540c\u4e00\u4e2a\u4e8c\u5c42\u7f51\u7edc\uff1b</li> </ul> <p>Calico\u7684CNI\u63d2\u4ef6\u4e3a\u6bcf\u4e2a\u5bb9\u5668\u8bbe\u7f6e\u4e00\u4e2a Veth Pair \u8bbe\u5907\uff0c\u4e00\u7aef\u653e\u5728\u5bbf\u4e3b\u673a\u4e0a\uff08\u4ee5cali\u4e3a\u524d\u7f00\uff09\uff1a</p> <ul> <li> <p>\u5728\u5bbf\u4e3b\u673a\u4e0a\u4e3a\u6bcf\u4e2a\u5bb9\u5668\u7684Veth Pair\u8bbe\u7f6e\u914d\u7f6e\u4e00\u6761\u8def\u7531\u89c4\u5219\uff08\u672a\u91c7\u7528\u7f51\u6865\uff09\uff0c\u7528\u4e8e\u63a5\u6536\u4f20\u5165\u7684IP\u5305\uff1b</p> </li> <li> <p>\u53d1\u5f80 10.233.2.3 \u7684 IP \u5305\u5e94\u8be5\u8fdb\u5165cali5863f3 \u8bbe\u5907</p> </li> </ul> <pre><code>10.233.2.3  dev cali5863f3 scope link\n</code></pre> <p>\u5168\u4e92\u8054\u6a21\u5f0f\uff1a\u4e00\u4e2a BGP Speaker \u9700\u8981\u4e0e\u5176\u5b83\u6240\u6709\u7684 BGP Speaker \u5efa\u7acb bgp \u8fde\u63a5\uff08\u5f62\u6210\u4e00\u4e2abgp mesh\uff09\uff0c\u590d\u6742\u5ea6 O(N^2)</p> <ul> <li>\u7528\u4e8e\u5c11\u4e8e 100 \u4e2a\u8282\u70b9\u7684\u96c6\u7fa4\uff1b</li> </ul> <p>RR \u6a21\u5f0f\uff1a\u9009\u62e9\u4e00\u90e8\u5206\u8282\u70b9\uff08\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\uff09\u4f5c\u4e3a Global BGP Peer\uff0c\u5b83\u4eec\u548c\u6240\u6709\u7684\u5176\u4ed6\u8282\u70b9\u4e92\u8054\u6765\u4ea4\u6362\u8def\u7531\u4fe1\u606f\uff0c\u5176\u4ed6\u7684\u8282\u70b9\u53ea\u548c Global BGP Peer \u76f8\u8fde\u3002</p> <ul> <li>\u590d\u6742\u5ea6 O(N)</li> </ul> <p></p>"},{"location":"cloud/k8s/network.html#ipip","title":"IPIP\u6a21\u5f0f\uff08\u9ed8\u8ba4\uff09","text":"<p>IPIP\u7684\u5305\u5934\u975e\u5e38\u5c0f\uff0c\u800c\u4e14\u4e5f\u662f\u5185\u7f6e\u5728\u5185\u6838\u4e2d\uff0c\u56e0\u6b64\u7406\u8bba\u4e0a\u5b83\u7684\u901f\u5ea6\u8981\u6bd4VxLAN\u5feb\u4e00\u70b9\uff0c\u4f46\u5b89\u5168\u6027\u66f4\u5dee\u3002</p> <p>Calico 3.x\u7684\u9ed8\u8ba4\u914d\u7f6e\u4f7f\u7528\u7684\u662f IPIP \u7c7b\u578b\u7684\u4f20\u8f93\u65b9\u6848\u800c\u975eBGP\u3002</p> <p>CALICO_IPV4POOL_IPIP \u7684\u503c\uff0c\u53ef\u7528\u503c\u5982\u4e0b\uff1a(CALICO_IPV4POOL_VXLAN \u53ef\u66ff\u4ee3 IPIP \u6a21\u5f0f)</p> <ul> <li>Always\uff1a\u53ea\u4f7f\u7528 IPIP \u96a7\u9053\u7f51\u7edc\uff0c\u9ed8\u8ba4\u503c</li> <li>Never\uff1a\u4e0d\u4f7f\u7528 IPIP \u96a7\u9053\u7f51\u7edc</li> <li>CrossSubnet\uff1a\u542f\u7528\u6df7\u5408\u7f51\u7edc\u6a21\u5f0f</li> </ul> <p>\u5047\u8bbe\u4e24\u53f0\u5904\u4e8e\u4e0d\u540c\u5b50\u7f51\u7684\u5bbf\u4e3b\u673a Node 1 \u548c Node 2\uff0c\u5bf9\u5e94 IP \u5206\u522b\u4e3a 102.168.1.1 \u548c 192.168.2.1\uff0c\u901a\u8fc7\u8def\u7531\u5668\u5b9e\u73b0\u4e09\u5c42\u8f6c\u53d1\uff08\u53ef\u4e92\u76f8\u901a\u4fe1\uff09\uff1a</p> <ul> <li> <p>Calico \u5c1d\u8bd5\u5728 Node 1 \u6dfb\u52a0\u5982\u4e0b\u4e00\u6761\u89c4\u5219\uff1a</p> </li> <li> <p>Node 2 \u548c Node 1 \u4e0d\u5728\u4e00\u4e2a\u5b50\u7f51\u91cc\uff0c\u65e0\u6cd5\u901a\u8fc7\u4e8c\u5c42\u7f51\u7edc\u5c06 IP \u5305\u53d1\u9001\u7ed9\u4e0b\u4e00\u8df3\u5730\u5740\uff1b</p> </li> </ul> <pre><code>10.233.2.0/16 via 192.168.2.2 eth0\n</code></pre> <ul> <li> <p>\u5f00\u542f IPIP \u6a21\u5f0f\uff0c\u8def\u7531\u89c4\u5219\u53d8\u66f4\u5982\u4e0b</p> </li> <li> <p>tunl0 \u8bbe\u5907\u662f IP \u96a7\u9053 \u8bbe\u5907\uff0c\u9700\u8981\u989d\u5916\u7684\u5c01\u5305/\u89e3\u5305\uff0c\u4e09\u5c42\u8f6c\u53d1\uff0c\u6027\u80fd\u4e0e Flannel VXLAN \u76f8\u5f53\uff1b</p> </li> <li>IPIP\u96a7\u9053\u7f51\u7edc\u4e5f\u662f\u4f9d\u8d56BGP\u6765\u7ef4\u62a4\u8282\u70b9\u7684\u8def\u7531\u4fe1\u606f\uff08<code>ip r</code>\u53ef\u67e5\u770b\u76f8\u5173\u7684\u4fe1\u606f\uff09\uff1b</li> </ul> <pre><code>10.233.2.0/16 via 192.168.2.2 dev tunl0 proto bird onlink\n</code></pre> <p></p> <ul> <li>\u6216\u8bbe\u6cd5\u5c06\u5bbf\u4e3b\u673a\u7f51\u5173\u4e5f\u52a0\u5165 BGP Mesh \u4ece\u800c\u907f\u514d\u4f7f\u7528 IPIP</li> <li>\u4f7f\u7528\u4e00\u4e2a\u6216\u591a\u4e2a\u72ec\u7acb\u7ec4\u4ef6\u8d1f\u8d23\u641c\u96c6\u6574\u4e2a\u96c6\u7fa4\u91cc\u7684\u6240\u6709\u8def\u7531\u4fe1\u606f\uff0c\u7136\u540e\u901a\u8fc7 BGP \u534f\u8bae\u540c\u6b65\u7ed9\u7f51\u5173\uff1b</li> </ul>"},{"location":"cloud/k8s/network.html#kube-router","title":"kube-router","text":"<p>\u7b49\u4ef7\u4e8e calico + kube-proxy\u3002</p> <p>\u91c7\u7528\u4e86\u4e09\u5c42\u8def\u7531\uff08Layer 3 Routing\uff09\u7684\u65b9\u5f0f\uff0c\u4ee5\u5b9e\u73b0Kubernetes\u96c6\u7fa4\u4e2d\u7684\u7f51\u7edc\u901a\u4fe1\u3002</p>"},{"location":"cloud/k8s/network.html#servicepod","title":"Service\u5230Pod\u7684\u901a\u4fe1","text":"<p>Service\u5728Pod\u4e4b\u95f4\u8d77\u300c\u670d\u52a1\u4ee3\u7406\u300d\u7684\u4f5c\u7528\uff0c\u5bf9\u5916\u8868\u73b0\u4e3a\u4e00\u4e2a\u5355\u4e00\u8bbf\u95ee\u63a5\u53e3\uff0c\u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9Pod\u3002</p> <pre><code>$ kubectl decsribe service myservice\nName: myservice\nNamespace: default\nLables: &lt;none&gt;\nSelector: name=mypod\nType: ClusterIP\nIP: 10.254.206.220\nPort: http 80/TCP\nEndpoints: 10.0.62.87:80,10.0.62.88:80,10.0.62.89:80\n\nSession Affinity: None\nNo evevts.\n</code></pre> <p>\u89e3\u8bfb\u5982\u4e0b\uff1a</p> <ul> <li>Service\u7684\u865a\u62dfIP\u662f 10.254.206.220</li> <li>\u7aef\u53e380/TCP\u5bf9\u5e943\u4e2a\u540e\u7aef\uff1a10.0.62.87:80,10.0.62.88:80,10.0.62.89:80</li> <li>\u8bf7\u6c42 10.254.206.220:80 \u65f6\u4f1a\u8f6c\u53d1\u5230\u8fd9\u4e9b\u540e\u7aef\u4e4b\u4e00</li> <li>\u865a\u62dfIP\u662fK8s\u521b\u5efa\u7684\uff0c\u865a\u62df\u7f51\u6bb5\u662fAPI server\u542f\u52a8\u53c2\u6570 <code>--service-cluster-ip-range=10.254.0.0/16</code> \u914d\u7f6e\u7684</li> </ul>"},{"location":"cloud/k8s/network.html#br_netfilter","title":"br_netfilter","text":"<p><code>br_netfilter</code>\u4f5c\u7528\uff1a<code>br_netfilter</code>\u6a21\u5757\u53ef\u4ee5\u4f7f iptables \u89c4\u5219\u53ef\u4ee5\u5728 Linux Bridges \u4e0a\u9762\u5de5\u4f5c\uff0c\u7528\u4e8e\u5c06\u6865\u63a5\u7684\u6d41\u91cf\u8f6c\u53d1\u81f3iptables\u94fe\u3002</p> <ul> <li> <p>\u5982\u679c\u6ca1\u52a0\u8f7d\uff0c\u5f71\u54cd\u540cnode\u5185\u7684pod\u4e4b\u95f4\u901a\u8fc7service\u6765\u901a\u4fe1\uff1b</p> </li> <li> <p>\u56e0\u4e3aiptables\u662f\u5728\u4e09\u5c42\u7684\uff0c\u800clinux bridge\u662f\u5728\u4e8c\u5c42\u7684\u3002\u5f53pod\u53d1\u51fa\u7684\u6d41\u91cf\u7ecf\u8fc7service\u6765\u8f6c\u53d1\u540e\u662f\u5230\u540c\u4e00\u4e2anode\u4e0a\u7684pod\uff0c\u90a3\u4e48\u6b64\u65f6\u4e24\u4e2apod\u90fd\u662f\u6865\u63a5\u5728cni\u7f51\u6865\u4e0a\u7684\uff0c\u90a3\u4e48\u5c31\u4f1a\u76f4\u63a5\u901a\u8fc7\u7f51\u6865\u6765\u4f20\u9012\u6d41\u91cf\uff0c\u4f46\u662f\u6b64\u65f6\u6d41\u91cf\u7684\u5904\u7406\u5c31\u4e0d\u4f1aup call\u5230\u4e09\u5c42\u7684iptables\u89c4\u5219\uff0c\u4ece\u800c\u5bfc\u81f4\u8f6c\u53d1\u5f02\u5e38\uff1b</p> </li> </ul> <p>\u542f\u7528 <code>bridge-nf-call-iptables</code> \u8fd9\u4e2a\u5185\u6838\u53c2\u6570 (\u7f6e\u4e3a 1)\uff0c\u8868\u793a bridge \u8bbe\u5907\u5728\u4e8c\u5c42\u8f6c\u53d1\u65f6\u4e5f\u53bb\u8c03\u7528 iptables \u914d\u7f6e\u7684\u4e09\u5c42\u89c4\u5219 (\u5305\u542b conntrack)</p> <ul> <li> <p>\u6bcf\u4e2a Pod \u7684\u7f51\u5361\u90fd\u662f veth \u8bbe\u5907\uff0cveth pair \u7684\u53e6\u4e00\u7aef\u8fde\u4e0a\u5bbf\u4e3b\u673a\u4e0a\u7684\u7f51\u6865\uff1b</p> </li> <li> <p>\u7531\u4e8e\u7f51\u6865\u662f\u865a\u62df\u7684\u4e8c\u5c42\u8bbe\u5907\uff0c\u540c\u8282\u70b9\u7684 Pod \u4e4b\u95f4\u901a\u4fe1\u76f4\u63a5\u8d70\u4e8c\u5c42\u8f6c\u53d1\uff0c\u8de8\u8282\u70b9\u901a\u4fe1\u624d\u4f1a\u7ecf\u8fc7\u5bbf\u4e3b\u673a eth0\uff1b</p> </li> </ul> <p>\u4e0d\u7ba1\u662f iptables \u8fd8\u662f ipvs \u8f6c\u53d1\u6a21\u5f0f\uff0cKubernetes \u4e2d\u8bbf\u95ee Service \u90fd\u4f1a\u8fdb\u884c DNAT\uff0c\u5c06\u539f\u672c\u8bbf\u95ee ClusterIP:Port \u7684\u6570\u636e\u5305 DNAT \u6210 Service \u7684\u67d0\u4e2a Endpoint (PodIP:Port)\uff0c\u7136\u540e\u5185\u6838\u5c06\u8fde\u63a5\u4fe1\u606f\u63d2\u5165 conntrack \u8868\u4ee5\u8bb0\u5f55\u8fde\u63a5\uff0c\u76ee\u7684\u7aef\u56de\u5305\u7684\u65f6\u5019\u5185\u6838\u4ece conntrack \u8868\u5339\u914d\u8fde\u63a5\u5e76\u53cd\u5411 NAT\uff0c\u8fd9\u6837\u539f\u8def\u8fd4\u56de\u5f62\u6210\u4e00\u4e2a\u5b8c\u6574\u7684\u8fde\u63a5\u94fe\u8def:</p> <p></p> <p>\u5bfc\u81f4\u95ee\u9898\uff1a\uff08\u5e38\u89c1\u7684\u95ee\u9898\u73b0\u8c61\u5c31\u662f\u5076\u73b0 DNS \u89e3\u6790\u5931\u8d25\uff09</p> <p>1\u3001Pod \u8bbf\u95ee Service\uff0c\u76ee\u7684 IP \u662f Cluster IP\uff0c\u4e0d\u662f\u7f51\u6865\u5185\u7684\u5730\u5740\uff0c\u8d70\u4e09\u5c42\u8f6c\u53d1\uff0c\u4f1a\u88ab DNAT \u6210 PodIP:Port\uff1b 2\u3001\u5982\u679c DNAT \u540e\u662f\u8f6c\u53d1\u5230\u4e86\u540c\u8282\u70b9\u4e0a\u7684 Pod\uff0c\u76ee\u7684 Pod \u56de\u5305\u65f6\u53d1\u73b0\u76ee\u7684 IP \u5728\u540c\u4e00\u7f51\u6865\u4e0a\uff0c\u5c31\u76f4\u63a5\u8d70\u4e8c\u5c42\u8f6c\u53d1\uff0c\u6ca1\u6709\u8c03\u7528 conntrack\uff0c\u5bfc\u81f4\u56de\u5305\u65f6\u6ca1\u6709\u539f\u8def\u8fd4\u56de\uff0c\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u7aef\u7684\u901a\u4fe1\u5c31\u4e0d\u5728\u4e00\u4e2a \u201c\u9891\u9053\u201d \u4e0a\uff0c\u4e0d\u8ba4\u4e3a\u5904\u5728\u540c\u4e00\u4e2a\u8fde\u63a5\uff0c\u4e5f\u5c31\u65e0\u6cd5\u6b63\u5e38\u901a\u4fe1\u3002</p>"},{"location":"cloud/k8s/network.html#kube-proxy","title":"kube-proxy","text":"<p>kube-proxy\u7ec4\u4ef6\u8d1f\u8d23\u865a\u62dfIP\u8def\u7531\u548c\u8f6c\u53d1\uff0c\u5728\u5bb9\u5668\u8986\u76d6\u7f51\u7edc\u4e4b\u4e0a\u5b9e\u73b0\u7684\u865a\u62df\u8f6c\u53d1\u7f51\u7edc\uff0c\u529f\u80fd\u5982\u4e0b\uff1a</p> <ul> <li>\u76d1\u63a7Service\u548cEndpoints\u7684\u53d8\u5316\uff0c\u5b9e\u73b0\u5237\u65b0\u8f6c\u53d1\u89c4\u5219</li> <li>\u63d0\u4f9b\u8d1f\u8f7d\u5747\u8861\u80fd\u529b</li> </ul> <p>kube-proxy\u7684\u4ee3\u7406\u6a21\u5f0f\uff1a~~userspace\u6a21\u5f0f\u4e0d\u518d\u63a8\u8350~~</p> <ul> <li><code>iptables</code>\u6a21\u5f0f\uff1a\u8bbe\u7f6eiptables\u89c4\u5219\uff0c\u6548\u7387\u9ad8\uff0c\u4f46\u5931\u8d25\u54cd\u5e94\u4e0d\u53cb\u597d\uff0c\u53ef\u4ee5\u901a\u8fc7Pod\u7684readinessprobe\u63a7\u5236\u53ea\u6709ready\u72b6\u6001\u7684pod\u53ef\u4ee5\u54cd\u5e94\uff1b</li> <li> <p>\u5927\u91cfPod\u65f6\u5728\u5bbf\u4e3b\u673a\u8bbe\u7f6e\u76f8\u5f53\u591a\u7684 iptables \u89c4\u5219\uff0c\u5927\u91cf\u5360\u7528\u5bbf\u4e3b\u673a CPU \u8d44\u6e90\uff1b</p> </li> <li> <p><code>ipvs</code>\u6a21\u5f0f\uff1a\u901a\u8fc7Linux kernel\u7684<code>netlink</code>\u63a5\u53e3\u8bbe\u7f6eIPVS\u89c4\u5219\uff0c\u8f6c\u53d1\u6548\u7387\u548c\u541e\u5410\u91cf\u90fd\u662f\u6700\u9ad8\uff1b</p> </li> <li>\u8981\u6c42Linux Kernel\u542f\u7528 IPVS \u6a21\u5757\uff0c\u672a\u542f\u7528\u4f1a\u81ea\u52a8\u5207\u6362\u5230iptables\u6a21\u5f0f\uff1b</li> <li>\u4e0d\u9700\u8981\u8bbe\u7f6e iptables \u89c4\u5219\uff0c\u800c\u662f\u5c06\u89c4\u5219\u7684\u5904\u7406\u653e\u5728\u5185\u6838\u6001\uff1b</li> <li>\u652f\u6301\u66f4\u591a\u8d1f\u8f7d\u5747\u8861\u6a21\u5f0f\uff1arr\uff08\u8f6e\u8be2\uff09\uff0clc\uff08\u6700\u5c0f\u8fde\u63a5\u6570\uff09\uff0cdh\uff08\u76ee\u6807\u5730\u5740hash\uff09\uff0csh\uff08\u6e90\u5730\u5740hash\uff09\uff0csed\uff08\u6700\u77ed\u671f\u671b\u5ef6\u8fdf\uff09\uff0cnq\uff08\u6c38\u4e0d\u6392\u961f\uff09</li> <li><code>kernelspace</code>\u6a21\u5f0f\uff1aWindows Server\u7684\u4ee3\u7406\u6a21\u5f0f\uff1b</li> </ul>"},{"location":"cloud/k8s/network.html#iptables","title":"iptables","text":"<p>\u5b8c\u5168\u901a\u8fc7\u521b\u5efaiptables\u89c4\u5219\uff0c\u76f4\u63a5\u91cd\u5b9a\u5411\u8bbf\u95eeService\u7684\u865a\u62dfIP\u7684\u8bf7\u6c42\u5230endpoints;\u5f53Endpoints\u53d1\u751f\u53d8\u5316\u7684\u65f6\u5019\uff0ckube-proxy\u4f1a\u5237\u65b0\u76f8\u5173\u7684iptables\u89c4\u5219\uff0c\u5728\u6b64\u6a21\u5f0f\u4e0b\uff0ckube-proxy\u53ea\u8d1f\u8d23\u76d1\u63a7Service\u548cEndpoints\uff0c\u66f4\u65b0iptables\u89c4\u5219\uff0c\u62a5\u6587\u7684\u8f6c\u53d1\u4f9d\u8d56\u4e8eLinux\u5185\u6838\uff0c\u9ed8\u8ba4\u7684\u8d1f\u8f7d\u5747\u8861\u65b9\u5f0f\u662f\u968f\u673a\u65b9\u5f0f\u3002</p> <p></p> <p>\u67e5\u8be2\u5173\u4e8eService myservice\u7684iptables\u89c4\u5219</p> <pre><code>iptables-save | grep myservice\n</code></pre> <p>kube-proxy\u4f1a\u4e3aService\u521b\u5efa\u4e00\u7cfb\u5217iptables\u89c4\u5219\uff0c\u5176\u4e2d\u5305\u542biptables\u81ea\u5b9a\u4e49\u94fe\uff1a</p> <ul> <li>KUBE-SERVICES: \u7ed1\u5b9a\u5728NAT\u8868PREROUTING\u94fe\u548cOUTPUT\u94fe</li> <li>KUBE-SVC-*: \u4ee3\u8868\u4e00\u4e2aService , \u7ed1\u5b9a\u5728KUBE-SERVICES</li> <li>KUBE-SEP-: \u4ee3\u8868Endpoints\u7684\u6bcf\u4e00\u4e2a\u540e\u7aef\uff0c\u7ed1\u5b9a\u5728KUBE-SVC-</li> </ul> <p>\u67e5\u8be2\u8f6c\u53d1\u89c4\u5219</p> <pre><code>iptables -t nat -L -n\n</code></pre>"},{"location":"cloud/k8s/network.html#networkpolicy","title":"\u7f51\u7edc\u9694\u79bb\uff08NetworkPolicy\uff09","text":"<p>calico \u9ed8\u8ba4\u652f\u6301\uff0c flannel \u4e0d\u652f\u6301\u3002</p> <ul> <li>\u901a\u8fc7 iptables \u5b9e\u73b0\u9694\u79bb</li> </ul> <p>\u914d\u7f6e\uff1a\uff08\u767d\u540d\u5355\u673a\u5236\uff09</p> <ul> <li><code>spec.PodSelector</code>\uff1a\u4f5c\u7528\u4e8e\u7684Pod\uff0c\u5982\u679c\u4e3a<code>{}</code>\uff0c\u5219\u8868\u793a\u4e3a\u6240\u6709pod\uff1b</li> <li><code>spec.policyTypes</code>\uff1aIngress(\u5165\u6240\u9009 Pod \u7684\u5165\u53e3\u6d41\u91cf)\uff0cEgress\uff08\u6765\u81ea\u6240\u9009 Pod\u7684\u51fa\u53e3\u6d41\u91cf\uff09\uff1b</li> <li><code>spec.ingress</code>\uff1a\u5141\u8bb8\u7684\u767d\u540d\u5355</li> <li><code>from</code>\uff1a\u5141\u8bb8\u7684\u8bbf\u95ee\u6240\u9009Pod\u7684\u6765\u6e90\uff0c\u652f\u6301 IP\uff0cNamespace \u548c Pod\uff1b</li> <li><code>ports</code>\uff1a\u5141\u8bb8\u8bbf\u95ee\u6240\u9009Pod\u7684\u7aef\u53e3\uff1b</li> <li><code>spec.egress</code>\uff1a\u5141\u8bb8\u7684\u767d\u540d\u5355</li> <li><code>to</code>\uff1a\u5141\u8bb8\u6240\u9009Pod\u6240\u8bbf\u95ee\u7684\u76ee\u6807\uff0c\u652f\u6301 IP\uff0cNamespace \u548c Pod\uff1b</li> <li><code>ports</code>\uff1a\u5141\u8bb8\u8bbf\u95ee\u76ee\u6807\u7684\u7aef\u53e3</li> </ul> <pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: test-network-policy\n  namespace: default\nspec:\n  podSelector:\n    matchLabels:\n      role: db\n  policyTypes:\n - Ingress\n - Egress\n  ingress:\n - from:\n    - ipBlock:\n        cidr: 172.17.0.0/16\n        except:\n        - 172.17.1.0/24\n    - namespaceSelector:\n        matchLabels:\n          project: myproject\n    - podSelector:\n        matchLabels:\n          role: frontend\n    ports:\n    - protocol: TCP\n      port: 6379\n  egress:\n - to:\n    - ipBlock:\n        cidr: 10.0.0.0/24\n    ports:\n    - protocol: TCP\n      port: 5978\n</code></pre>"},{"location":"cloud/k8s/network.html#_1","title":"\u591a\u5bb9\u5668\u591a\u7f51\u7edc\u65b9\u6848","text":"<p>\u5f53\u4e00\u4e2a\u5e94\u7528\u6216\u670d\u52a1\u65e2\u9700\u8981\u5bf9\u5916\u63d0\u4f9b API \u8c03\u7528\u670d\u52a1\uff0c\u4e5f\u9700\u8981\u6ee1\u8db3\u81ea\u8eab\u57fa\u4e8e\u5206\u5e03\u5f0f\u7279\u6027\u4ea7\u751f\u7684\u6570\u636e\u540c\u6b65\uff08\u4e00\u4e9b\u4e1a\u52a1\u573a\u666f\u7684\u63a7\u5236\u9762\u548c\u6570\u636e\u9762\u7684\u5206\u79bb\u573a\u666f\uff09\uff0c\u90a3\u4e48\u8fd9\u65f6\u5019\u4e00\u5f20\u7f51\u5361\u7684\u6027\u80fd\u663e\u7136\u5f88\u96be\u8fbe\u5230\u751f\u4ea7\u7ea7\u522b\u7684\u8981\u6c42\uff0c\u7f51\u7edc\u6d41\u91cf\u5ef6\u65f6\u3001\u963b\u585e\u4fbf\u6210\u4e3a\u6b64\u5e94\u7528\u7684\u4e00\u9879\u74f6\u9888\u3002</p>"},{"location":"cloud/k8s/network.html#multus-cni","title":"multus-cni","text":"<p>Multus CNI enables attaching multiple network interfaces to pods in Kubernetes.</p> <p>Multus CNI \u672c\u8eab\u4e0d\u63d0\u4f9b\u7f51\u7edc\u914d\u7f6e\u529f\u80fd\uff0c\u5b83\u662f\u901a\u8fc7\u7528\u5176\u4ed6\u6ee1\u8db3 CNI \u89c4\u8303\u7684\u63d2\u4ef6\u8fdb\u884c\u5bb9\u5668\u7684\u7f51\u7edc\u914d\u7f6e\u3002</p>"},{"location":"cloud/k8s/notes.html","title":"\u6ce8\u610f\u4e8b\u9879","text":""},{"location":"cloud/k8s/notes.html#_2","title":"\u672c\u5730\u78c1\u76d8\u9650\u5236","text":"<p>\u9632\u6b62\u5c06\u5bbf\u4e3b\u673a\u7684\u78c1\u76d8\u6491\u6ee1\uff0c\u5bfc\u81f4\u5bbf\u4e3b\u673a\u4e0d\u53ef\u7528\u3002</p>"},{"location":"cloud/k8s/notes.html#ephemeral-storage","title":"ephemeral-storage","text":"<p>ephemeral-storage \u5305\u62ec\uff1a</p> <ul> <li><code>emptyDir</code> volumes, except tmpfs <code>emptyDir</code> volumes</li> <li>directories holding node-level logs</li> <li>writeable container layers</li> </ul> <p>\u5728\u6bcf\u4e2aKubernetes\u7684\u8282\u70b9\u4e0a\uff0ckubelet\u7684\u6839\u76ee\u5f55(\u9ed8\u8ba4\u662f/var/lib/kubelet)\u548c\u65e5\u5fd7\u76ee\u5f55(/var/log)\u4fdd\u5b58\u5728\u8282\u70b9\u7684\u4e3b\u5206\u533a\u4e0a\uff0c\u8fd9\u4e2a\u5206\u533a\u540c\u65f6\u4e5f\u4f1a\u88abPod\u7684EmptyDir\u7c7b\u578b\u7684volume\u3001\u5bb9\u5668\u65e5\u5fd7\u3001\u955c\u50cf\u7684\u5c42\u3001\u5bb9\u5668\u7684\u53ef\u5199\u5c42\u6240\u5360\u7528\u3002</p> <ul> <li>kubelet\u4f1a\u7edf\u8ba1\u5f53\u524d\u8282\u70b9\u7684\u4e3b\u5206\u533a\u7684\u53ef\u5206\u914d\u7684\u78c1\u76d8\u8d44\u6e90\uff0c\u6216\u8005\u53ef\u4ee5\u8986\u76d6\u8282\u70b9\u4e0akubelet\u7684\u914d\u7f6e\u6765\u81ea\u5b9a\u4e49\u53ef\u5206\u914d\u7684\u8d44\u6e90\u3002</li> <li>\u5728\u521b\u5efaPod\u65f6\u4f1a\u6839\u636e\u5b58\u50a8\u9700\u6c42\u8c03\u5ea6\u5230\u6ee1\u8db3\u5b58\u50a8\u7684\u8282\u70b9\uff0c\u5728Pod\u4f7f\u7528\u8d85\u8fc7\u9650\u5236\u7684\u5b58\u50a8\u65f6\u4f1a\u5bf9\u5176\u505a\u9a71\u9010\u7684\u5904\u7406\u6765\u4fdd\u8bc1\u4e0d\u4f1a\u8017\u5c3d\u8282\u70b9\u4e0a\u7684\u78c1\u76d8\u7a7a\u95f4\u3002</li> </ul> <p>\u6ce8\u610f\u4e8b\u9879\uff1a</p> <ul> <li>\u5982\u679ck8s\u7684\u6839\u76ee\u5f55\uff08kubelet root-dir\uff09\u8ddf\u5bb9\u5668\u955c\u50cf\u5b58\u50a8\u6839\u76ee\u5f55\uff08/var/lib/{docker}\uff09\u662f\u5355\u72ec\u6302\u8f7d\u7684\u78c1\u76d8\uff08\u975eroot\u76d8\uff09\uff0c\u5219\u901a\u8fc7 kubectl \u67e5\u770b node \u7684 ephemeral-storage \u53ea\u4f1a\u663e\u793a\u6839\u5206\u533a(/) \u7684\u5b58\u50a8\u7a7a\u95f4\u3002</li> <li>The kubelet will only track the root filesystem for ephemeral storage. OS layouts that mount a separate disk to <code>/var/lib/kubelet</code> or <code>/var/lib/containers</code> will not report ephemeral storage correctly.</li> <li> <p>\u5728\u7533\u8bf7\u8d44\u6e90\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u4f1a\u51fa\u95ee\u9898\uff08\u56e0\u4e3a\u603b\u7684\u8d44\u6e90\u91cf\u7ed3\u679c\u4e0d\u5bf9\uff09</p> </li> <li> <p>K8s 1.22 \u7248\u672c\u53ca\u4e4b\u540e\uff0c\u5141\u8bb8\u5bb9\u5668\u955c\u50cf\u5b58\u50a8\u6839\u76ee\u5f55\uff08/var/lib/{docker}\uff09\u5355\u72ec\u6302\u8f7d\u76d8\uff0c\u5982\u679c\u955c\u50cf\u53ef\u5199\u5c42\u8d85\u8fc7\u9650\u5236\uff0c\u53ef\u4ee5\u6b63\u5e38\u88ab\u9a71\u9664\uff1b</p> </li> </ul> <p>\u4f7f\u7528\u793a\u4f8b Pod\uff1a</p> <pre><code>resources:\n  requests:\n    cpu: 1\n    memory: 2048Mi\n    # k8s 1.8\u5f00\u59cb\u5f15\u5165\u7684\u7279\u6027\uff0c\u9650\u5236\u5bb9\u5668\u5b58\u50a8\u7a7a\u95f4\u7684\u4f7f\u7528\n    ephemeral-storage: 2Gi\n  limits:\n    cpu: 2\n    memory: 2048Mi\n    ephemeral-storage: 5Gi\n</code></pre> <p>\u5f53ephemeral-storage\u8d85\u51fa\u9650\u5236\u65f6\uff0ckublet\u4f1a\u9a71\u9664\u5f53\u524d\u5bb9\u5668</p> <p>Pod \u5185\u7684\u5bb9\u5668\u4e0d\u4f1a\u88ab\u91cd\u542f\uff08\u4e0d\u4f1a\u53d7 restartPolicy \u5f71\u54cd\uff0c\u4e5f\u4e0d\u4f1a\u53d7\u5b58\u6d3b\u7b49\u63a2\u9488\u5f71\u54cd\uff09\uff0c\u56e0\u6b64\u9700\u8981\u914d\u5408 deployment \u7b49\u4f7f\u7528\uff0c\u7531 deployment \u91cd\u65b0\u521b\u5efa Pod\uff1b</p> <ul> <li>\u5df2\u7ecf restart \u8fc7\uff0c\u4f46\u662f\u6709\u9519\u8bef\u4fe1\u606f\uff0c<code>reason</code>\u72b6\u6001\u5bfc\u81f4\u4e0d\u4f1a\u7ee7\u7eed\u91cd\u542f\uff08k8s 1.22\u7248\u672c\uff09\uff0c\u53c2\u8003Pod\u9a71\u9664\uff1b</li> </ul> <ul> <li><code>get pods -o yaml</code>\u4fe1\u606f\u5982\u4e0b\uff1a</li> </ul> <pre><code>status:\n  - lastProbeTime: null\n    lastTransitionTime: \"2024-02-04T09:31:31Z\"\n    reason: PodFailed\n    status: \"False\"\n    type: Ready\n  - ...\n  containerStatuses:\n  - image: nginx\n    ...\n    ready: false\n    restartCount: 1\n    started: false\n    state:\n      terminated:\n        exitCode: 137\n        finishedAt: null\n        message: The container could not be located when the pod was terminated\n        reason: ContainerStatusUnknown\n        startedAt: null\n  message: 'Pod ephemeral local storage usage exceeds the total limit of containers 1Gi. '\n  phase: Failed\n  qosClass: Burstable\n  reason: Evicted\n</code></pre> <p>\u67e5\u770b\u4e8b\u4ef6\u65f6\u5982\u4e0b\uff1a</p> <pre><code>  Warning  Evicted    27s    kubelet            Pod ephemeral local storage usage exceeds the total limit of containers 1Gi.\n  Normal   Killing    27s    kubelet            Stopping container nginx\n</code></pre>"},{"location":"cloud/k8s/notes.html#event","title":"Event \u6301\u4e45\u5316","text":"<p>Event\u4f5c\u4e3akubernetes\u7684\u4e00\u4e2a\u5bf9\u8c61\u8d44\u6e90\uff0c\u8bb0\u5f55\u4e86\u96c6\u7fa4\u8fd0\u884c\u6240\u9047\u5230\u7684\u5404\u79cd\u5927\u4e8b\u4ef6,\u6709\u52a9\u4e8e\u6392\u9519\uff0c\u4f46\u5927\u91cf\u7684\u4e8b\u4ef6\u5982\u679c\u90fd\u5b58\u50a8\u5728etcd\u4e2d\uff0c\u4f1a\u5e26\u6765\u8f83\u5927\u7684\u6027\u80fd\u4e0e\u5bb9\u91cf\u538b\u529b\uff0c\u6240\u4ee5 etcd \u4e2d\u9ed8\u8ba4\u53ea\u4fdd\u5b58\u6700\u8fd11\u5c0f\u65f6\u7684\u3002</p> <p>k8s\u96c6\u7fa4\u89c4\u6a21\u7684\u589e\u52a0\uff0c\u96c6\u7fa4\u5185\u7684object\u6570\u91cf\u4e5f\u4e0e\u65e5\u4ff1\u589e\uff0c\u90a3\u4e48events\u7684\u6570\u91cf\u4e5f\u4f1a\u4f34\u968f\u5176\u5927\u91cf\u589e\u52a0\uff0c\u90a3\u4e48\u5f53\u7528\u6237\u8bf7\u6c42\u8fd9\u4e9bevents\u7684\u65f6\u5019apiserver\u7684\u8d1f\u8f7d\u538b\u529b\u5c31\u4f1a\u589e\u52a0\uff0c\u5f88\u53ef\u80fd\u9020\u6210 apiserver \u5904\u7406\u8bf7\u6c42\u5ef6\u8fdf\uff0c\u53ef\u4ee5\u5c06 events \u6301\u4e45\u5316\uff0c\u901a\u8fc7 webhook \u62e6\u622a\u7528\u6237\u8bf7\u6c42\u3002</p>"},{"location":"cloud/k8s/notes.html#eventrouter","title":"eventrouter","text":"<p>A simple introspective kubernetes service that forwards events to a specified sink.</p> <p>\u5c06 <code>ADD</code>\u6216\u8005 <code>Update</code>\u7684\u4e8b\u4ef6\uff0c\u4ee5\u53ca\u5bf9\u5e94\u7684 <code>newEvent</code>\u548c <code>oldEvent</code>\uff0c\u53d1\u9001\u7ed9Sink\u3002</p> <ul> <li>\u901a\u8fc7 <code>informers.NewSharedInformerFactory</code>\u8fdb\u884c\u76d1\u542c\u548c\u5904\u7406\uff1b</li> <li>\u7edf\u8ba1 <code>Normal</code>\uff0c<code>WARNING</code>\u76f8\u540c\u7684\u6b21\u6570\uff0c\u7ed9prometheus\u4f7f\u7528\uff1b</li> </ul>"},{"location":"cloud/k8s/notes.html#kubewatch","title":"kubewatch","text":"<p>kubewatch is a Kubernetes watcher that currently publishes notification to available collaboration hubs/notification channels. Run it in your k8s cluster, and you will get event notifications through webhooks.</p> <p>supported webhooks:</p> <ul> <li>slack, slackwebhook, hipchat, mattermost, flock, cloudevent</li> <li>webhook</li> <li>smtp</li> </ul> <p>\u53ef\u4ee5\u914d\u7f6e\u76d1\u542c\u4e0d\u540c\u7684\u8d44\u6e90\uff0c</p> <pre><code>resource:\n  deployment: false\n  replicationcontroller: false\n  replicaset: false\n  daemonset: false\n  services: true\n  pod: true\n  job: false\n  node: false\n  clusterrole: false\n  clusterrolebinding: false\n  serviceaccount: false\n  persistentvolume: false\n  namespace: false\n  secret: false\n  configmap: false\n  ingress: false\n</code></pre> <p>kube-eventer</p> <p>kube-eventer emit kubernetes events to sinks.</p> <p>\u652f\u6301\u7684Sink</p> Sink Name Description dingtalk sink to dingtalk bot sls sink to alibaba cloud sls service elasticsearch sink to elasticsearch honeycomb sink to honeycomb influxdb sink to influxdb kafka sink to kafka mysql sink to mysql database wechat sink to wechat webhook sink to webhook mongodb sink to mongodb"},{"location":"cloud/k8s/pod_inplace_upgrade.html","title":"Pod \u539f\u5730\u5347\u7ea7","text":""},{"location":"cloud/k8s/pod_inplace_upgrade.html#_1","title":"\u91cd\u5efa\u5347\u7ea7\u4e0e\u539f\u5730\u5347\u7ea7","text":"<p>\u5f53\u6211\u4eec\u8981\u5347\u7ea7\u4e00\u4e2a\u5b58\u91cf Pod \u4e2d\u7684\u955c\u50cf\u65f6\uff0c\u8fd9\u662f \u91cd\u5efa\u5347\u7ea7 \u548c \u539f\u5730\u5347\u7ea7 \u7684\u533a\u522b\uff1a</p> <p>\u91cd\u5efa\u5347\u7ea7\u65f6\u6211\u4eec\u8981\u5220\u9664\u65e7 Pod\u3001\u521b\u5efa\u65b0 Pod</p> <ul> <li>Pod \u540d\u5b57\u548c uid \u53d1\u751f\u53d8\u5316\uff0c\u56e0\u4e3a\u5b83\u4eec\u662f\u5b8c\u5168\u4e0d\u540c\u7684\u4e24\u4e2a Pod \u5bf9\u8c61\uff08\u6bd4\u5982 Deployment \u5347\u7ea7\uff09</li> <li>Pod \u540d\u5b57\u53ef\u80fd\u4e0d\u53d8\u3001\u4f46 uid \u53d8\u5316\uff0c\u56e0\u4e3a\u5b83\u4eec\u662f\u4e0d\u540c\u7684 Pod \u5bf9\u8c61\uff0c\u53ea\u662f\u590d\u7528\u4e86\u540c\u4e00\u4e2a\u540d\u5b57\uff08\u6bd4\u5982 StatefulSet \u5347\u7ea7\uff09</li> <li>Pod \u6240\u5728 Node \u540d\u5b57\u53d1\u751f\u53d8\u5316\uff0c\u56e0\u4e3a\u65b0 Pod \u5f88\u5927\u53ef\u80fd\u6027\u662f\u4e0d\u4f1a\u8c03\u5ea6\u5230\u4e4b\u524d\u6240\u5728\u7684 Node \u8282\u70b9\u7684</li> <li>Pod IP \u53d1\u751f\u53d8\u5316\uff0c\u56e0\u4e3a\u65b0 Pod \u5f88\u5927\u53ef\u80fd\u6027\u662f\u4e0d\u4f1a\u88ab\u5206\u914d\u5230\u4e4b\u524d\u7684 IP \u5730\u5740\u7684</li> </ul> <p>\u4f46\u662f\u5bf9\u4e8e\u539f\u5730\u5347\u7ea7\uff0c\u4ecd\u7136\u590d\u7528\u540c\u4e00\u4e2a Pod \u5bf9\u8c61\uff0c\u53ea\u662f\u4fee\u6539\u5b83\u91cc\u9762\u7684\u5b57\u6bb5\u3002\u56e0\u6b64\uff1a</p> <ul> <li>\u53ef\u4ee5\u907f\u514d\u5982 \u8c03\u5ea6\u3001\u5206\u914d IP\u3001*\u5206\u914d\u3001\u6302\u8f7d\u76d8* \u7b49\u989d\u5916\u7684\u64cd\u4f5c\u548c\u4ee3\u4ef7</li> <li>\u66f4\u5feb\u7684\u955c\u50cf\u62c9\u53d6\uff0c\u56e0\u4e3a\u5f00\u6e90\u590d\u7528\u5df2\u6709\u65e7\u955c\u50cf\u7684\u5927\u90e8\u5206 layer \u5c42\uff0c\u53ea\u9700\u8981\u62c9\u53d6\u65b0\u955c\u50cf\u53d8\u5316\u7684\u4e00\u4e9b layer</li> <li>\u5f53\u4e00\u4e2a\u5bb9\u5668\u5728\u539f\u5730\u5347\u7ea7\u65f6\uff0cPod \u4e2d\u7684\u5176\u4ed6\u5bb9\u5668\u4e0d\u4f1a\u53d7\u5230\u5f71\u54cd\uff0c\u4ecd\u7136\u7ef4\u6301\u8fd0\u884c</li> </ul> <p></p>"},{"location":"cloud/k8s/pod_inplace_upgrade.html#k8s","title":"K8s \u652f\u6301\u7684\u539f\u5730\u5347\u7ea7","text":"<p>K8s \u652f\u6301\u7684Pod \u539f\u5730\u5347\u7ea7\u4ec5\u9650\u4e8e\uff1a</p> <ul> <li>kubectl<code>patch</code>  replace \u6216\u8005 apply \u4fee\u6539 Pod \u5b9a\u4e49\u4e2d\u7684 <code>image</code> \u5b57\u6bb5\uff0c\u6216\u8005 <code>metadata</code>\u4e2d\u7684 <code>label</code>\u548c <code>annotation</code>\uff1b</li> <li>\u5bf9\u4e8e deployment \u8fd9\u4e9b\u7ba1\u7406 pod \u7684\u8d44\u6e90\uff0c\u9700\u8981\u627e\u5230\u5176 Pod\uff0c\u518d\u8fdb\u884c patch\uff0c\u76f4\u63a5\u5bf9 deployment \u4fee\u6539\u4e0d\u662f\u539f\u5730\u5347\u7ea7\uff1b</li> </ul>"},{"location":"cloud/k8s/pod_inplace_upgrade.html#openkruise","title":"\u5f00\u6e90\u5b9e\u73b0OpenKruise","text":"<p>\u4e0d\u80fd\u8131\u79bb K8s \u5bf9 Pod \u539f\u5730\u5347\u7ea7\u7684\u9650\u5236\uff0c\u53ea\u80fd\u4fee\u6539 image \u548c annotation / label \u8fd9\u4e9b\u5b57\u6bb5\uff1b</p> <p>\u5bf9 OpenKruise \u7684 Workload \u652f\u6301<code>InPlaceIfPossible</code>\uff0c\u5b83\u610f\u5473\u7740 Kruise \u4f1a\u5c3d\u91cf\u5bf9 Pod \u91c7\u53d6\u539f\u5730\u5347\u7ea7\uff0c\u5982\u679c\u4e0d\u80fd\u5219\u9000\u5316\u5230\u91cd\u5efa\u5347\u7ea7\u3002</p> <p>\u4ee5\u4e0b\u7684\u6539\u52a8\u4f1a\u88ab\u5141\u8bb8\u6267\u884c\u539f\u5730\u5347\u7ea7\uff1a</p> <ul> <li>\u66f4\u65b0 workload \u4e2d\u7684 <code>spec.template.metadata.*</code>\uff0c\u6bd4\u5982 <code>labels/annotations</code>\uff1b</li> <li>\u5982\u679c env from \u8fd9\u4e9b\u6539\u52a8\u7684 labels/anntations\uff0cKruise \u4f1a\u539f\u5730\u5347\u7ea7\u8fd9\u4e9b\u5bb9\u5668\u6765\u751f\u6548\u65b0\u7684 env \u503c\uff1b</li> <li>\u66f4\u65b0 workload \u4e2d\u7684 <code>spec.template.spec.containers[x].image</code>\uff1b</li> </ul> <p>SidecarSet \u7684\u539f\u5730\u5347\u7ea7\u6d41\u7a0b\u548c\u5176\u4ed6 workloads \u4e0d\u592a\u4e00\u6837\uff0c\u6bd4\u5982\u5b83\u5728\u5347\u7ea7 Pod \u4e4b\u524d\u5e76\u4e0d\u4f1a\u628a Pod \u8bbe\u7f6e\u4e3a not-ready \u72b6\u6001\u3002\u56e0\u6b64\uff0c\u4e0b\u6587\u4e2d\u8ba8\u8bba\u7684\u5185\u5bb9\u5e76\u4e0d\u5b8c\u5168\u9002\u7528\u4e8e SidecarSet\u3002</p> <p>\u4ee5 CloneSet \u4e3a\u4f8b\uff0c\u5176\u6267\u884c\u6d41\u7a0b\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"cloud/k8s/release_compare.html","title":"K8s\u7684\u53ef\u9009\u53d1\u884c\u7248","text":""},{"location":"cloud/k8s/release_compare.html#k8sminikube","title":"k8s/MiniKube\uff08\u5f00\u53d1\u73af\u5883\uff09","text":"<p>minikube quickly sets up a local Kubernetes cluster on macOS, Linux, and Windows. We proudly focus on helping application developers and new Kubernetes users.</p> <ul> <li>\u57fa\u4e8e VM/Container \u542f\u52a8\u7684 K8s \u96c6\u7fa4\uff1b</li> <li>\u652f\u6301\u591a\u8282\u70b9\u96c6\u7fa4\uff08\u5728\u4e00\u4e2a\u7269\u7406\u8282\u70b9\u542f\u52a8\u4e24\u4e2aVM\u7ec4\u6210K8s\uff09\uff0c\u800c\u4e0d\u662f\u591a\u4e2a\u7269\u7406\u8282\u70b9\u7ec4\u6210K8s\u96c6\u7fa4\uff1b</li> </ul>"},{"location":"cloud/k8s/release_compare.html#_1","title":"\u5b89\u88c5","text":"<p>https://minikube.sigs.k8s.io/docs/start/</p> <p>https://github.com/kubernetes/minikube/releases/latest</p>"},{"location":"cloud/k8s/release_compare.html#linux","title":"Linux","text":"<pre><code>curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64\nsudo install minikube-linux-amd64 /usr/local/bin/minikube &amp;&amp; rm minikube-linux-amd64\n</code></pre>"},{"location":"cloud/k8s/release_compare.html#windows","title":"Windows","text":"<p>\u5b89\u88c5 Hyper-V</p> <p>\u3010\u63a7\u5236\u9762\u677f\u3011-&gt;\u3010\u7a0b\u5e8f\u3011-&gt;\u3010\u6253\u5f00\u548c\u5173\u95ed windows \u529f\u80fd\u3011-&gt; \u52fe\u9009 Hyper-V \u7684\u9009\u9879\uff08\u5305\u62ec\u6240\u6709\u5b50\u9879\uff09-&gt; \u91cd\u542f\u7535\u8111</p> <p>\u542f\u7528 Hyper-V</p> <pre><code>Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All\n</code></pre> <pre><code>minikube start --driver=hyperv \n# To make hyperv the default driver:\nminikube config set driver hyperv\n</code></pre>"},{"location":"cloud/k8s/release_compare.html#_2","title":"\u4f7f\u7528","text":"<pre><code># minikube \u4f1a\u81ea\u52a8\u4e0b\u8f7d kubectl\nalias kubectl=\"minikube kubectl --\"\n# \u542f\u52a8 minikube\uff0c\u4f7f\u7528\u56fd\u5185\u7684\u955c\u50cf\nminikube start --image-repository='registry.cn-hangzhou.aliyuncs.com/google_containers' --base-image=registry.cn-hangzhou.aliyuncs.com/google_containers/kicbase:v0.0.44\n</code></pre>"},{"location":"cloud/k8s/release_compare.html#_3","title":"\u672c\u5730\u955c\u50cf\u4f7f\u7528","text":"<p>minikube\u63a8\u9001\u955c\u50cf\u5230\u672c\u673a</p> <p>\u4f7f\u7528 docker driver\uff0c\u56e0\u4e3a docker daemon \u5b58\u5728\uff0c\u53ef\u4ee5\u5171\u4eab docker sock\uff1b</p> <p>podman driver \u9700\u8981\u914d\u5408 cri-o \u800c\u975e docker \uff0c\u56e0\u4e3a podman \u4e0d\u5b58\u5728 daemon \u8fdb\u7a0b\u3002</p>"},{"location":"cloud/k8s/release_compare.html#kind","title":"Kind","text":"<p>Kubernetes IN Docker - local clusters for testing Kubernetes.</p> <p>kind is a tool for running local Kubernetes clusters using Docker container \"nodes\". kind was primarily designed for testing Kubernetes itself, but may be used for local development or CI.</p> <p>\u6d4b\u8bd5\u73af\u5883</p>"},{"location":"cloud/k8s/release_compare.html#microk8s","title":"MicroK8s","text":"<p>MicroK8s is a low-ops, minimal production Kubernetes.</p> <p>MicroK8s is a small, fast, single-package Kubernetes for developers, IoT and edge.</p>"},{"location":"cloud/k8s/release_compare.html#k3s","title":"K3s","text":"<p>Lightweight Kubernetes. The certified Kubernetes distribution built for IoT &amp; Edge computing.</p>"},{"location":"cloud/k8s/scheduler.html","title":"K8s\u8c03\u5ea6\u5668","text":""},{"location":"cloud/k8s/scheduler.html#_1","title":"\u6c61\u70b9\u4e0e\u5bb9\u5fcd\u5ea6","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cMaster\u8282\u70b9\u662f\u4e0d\u5141\u8bb8\u8fd0\u884c\u7528\u6237Pod\u7684\u3002\u901a\u8fc7<code>Taint/Toleration</code>\u673a\u5236\uff0c\u53ef\u4ee5\u5728Master\u8282\u70b9\u90e8\u7f72\u7528\u6237Pods\u3002</p> <p>\u539f\u7406\uff1a\u8282\u70b9\u88ab\u52a0\u4e0a\u4e00\u4e2aTaint\uff08\u67d3\u4e0a\u201c\u6c61\u70b9\u201c\uff09\uff0c\u5982\u679c\u8282\u70b9\u672a\u58f0\u660e\u81ea\u5df1\u80fd\u591f\u5bb9\u5fcd\u8be5\u201d\u6c61\u70b9\u201d\uff08Toleration\uff09\uff0c\u5219Pod\u4e0d\u80fd\u5728\u4e0a\u9762\u8fd0\u884c\u3002</p> <p>\u8282\u70b9\u52a0\u4e0a\u201c\u6c61\u70b9\u201d\u7684\u547d\u4ee4\uff1a</p> <ul> <li>NoSchedule\u610f\u5473\u7740\u8be5Taint\u53ea\u4f1a\u5728\u8c03\u5ea6\u65b0\u7684Pod\u65f6\u4ea7\u751f\u4f5c\u7528\uff0c\u4e0d\u4f1a\u5f71\u54cdnode1\u4e0a\u5df2\u7ecf\u8fd0\u884c\u7684Pods</li> </ul> <pre><code>$ kubectl taint nodes node1 foo=bar:NoSchedule\n</code></pre> <p>Pod\u58f0\u660eToleartion\uff1a</p> <pre><code># \u80fd\u591f\u5bb9\u5fcd\u6240\u6709\u952e\u503c\u5bf9\u4e3afoo=bar\u7684Taint\napiVersion: v1\nkind: Pod\n...\nspec:\n  toleartions:\n    - key: \"foo\"\n      operation: \"Equal\"\n      value: \"bar\"\n      effect: \"NoSchedule\"\n</code></pre> <p>\u8282\u70b9\u5220\u9664\u201c\u6c61\u70b9\u201d\u7684\u547d\u4ee4\uff1a\u8ba9Master\u8282\u70b9\u53ef\u4ee5\u8fd0\u884cPod</p> <pre><code># \u5220\u9664\u6240\u6709\u8282\u70b9\u7684node-role.kubernetes.io/master\u7684Taint\uff08\u6700\u540e\u7684\u51cf\u53f7\u8868\u793a\u5220\u9664\uff09\n$ kubectl taint nodes --all node-role.kubernetes.io/master -\n</code></pre>"},{"location":"cloud/k8s/scheduler.html#_2","title":"\u8d44\u6e90\u9650\u5236","text":"<p>requests + limits : \u5927\u591a\u6570\u4f5c\u4e1a\u7528\u5230\u7684\u8d44\u6e90\u5176\u5b9e\u8fdc\u5c11\u4e8e\u5b83\u6240\u8bf7\u6c42\u7684\u8d44\u6e90\u9650\u989d</p> <ul> <li>\u58f0\u660e\u8f83\u5c0f\u7684requests\u503c\u4f9b\u8c03\u5ea6\u5668\u4f7f\u7528\uff1b</li> <li>\u7ed9\u5bb9\u5668Cgroups\u8bbe\u7f6e\u7684limits\u503c\u76f8\u5bf9\u8f83\u5927\uff1b</li> </ul>"},{"location":"cloud/k8s/scheduler.html#_3","title":"\u8d44\u6e90\u7c7b\u578b","text":"<p>\u9488\u5bf9\u6bcf\u4e2acontainer\uff0c\u90fd\u53ef\u4ee5\u914d\u7f6e:</p> <pre><code>spec.containers[].resources.limits.cpu\nspec.containers[].resources.limits.memory\nspec.containers[].resources.limits.ephemeral-storage\nspec.containers[].resources.requests.cpu\nspec.containers[].resources.requests.memory\nspec.containers[].resources.requests.ephemeral-storage\n</code></pre>"},{"location":"cloud/k8s/scheduler.html#qos","title":"Qos\u6a21\u578b","text":"<p>\u6839\u636e requests \u548c limits\uff0c\u5c06 Pod \u5212\u5206\u4e3a\u4e0d\u540c\u7684 Qos \u7ea7\u522b\u3002</p> <ul> <li>\u914d\u7f6eDaemonSet\u65f6\u8d44\u6e90\u526f\u672c\u63a7\u5236\u5668\uff0cQos\u7684\u7b49\u7ea7\u52a1\u5fc5\u4e3aGuaranteed</li> </ul> <p>Guaranteed\uff1arequests \u548c limits \u76f8\u7b49\u65f6\uff08\u5982\u679c\u53ea\u8bbe\u7f6elimits\uff0c\u5219requests\u7b49\u4e8elimits\uff09\uff1b</p> <p>Burstable\uff1a\u4e0d\u6ee1\u8db3 Guaranteed \u6761\u4ef6\uff0c\u4f46\u81f3\u5c11\u4e00\u4e2aContainer\u8bbe\u7f6e requests\uff1b</p> <p>BestEffort\uff1a\u65e2\u6ca1\u6709 requests\uff0c\u4e5f\u6ca1\u6709 limits\uff1b</p> <p>\u5f53\u5bbf\u4e3b\u673a\u5f53\u4e0d\u53ef\u538b\u7f29\u8d44\u6e90\u77ed\u7f3a\u65f6\uff08\u5982\u5185\u5b58\uff0c\u78c1\u76d8\uff09\u65f6\uff0ckubelet \u5bf9 Pod \u8fdb\u884c Eviction\uff08\u8d44\u6e90\u56de\u6536\uff09\uff1a</p> <ul> <li>Soft Eviction\uff1a\u5230\u8fbe\u9608\u503c\u4e00\u6bb5\u65f6\u95f4\u540e\u624d\u4f1a\u8fdb\u884c Eviction\uff1b</li> <li>Hard Eviction\uff1a\u5230\u8fbe\u9608\u503c\u540e\u7acb\u5373\u5f00\u59cb\uff1b</li> </ul> <pre><code># \u9ed8\u8ba4\u914d\u7f6e\uff0ckubelet \u542f\u52a8\u65f6\u53ef\u914d\nmemory.available &lt; 100Mi\nnodefs.available &lt; 10&amp;\nnodefs.inodesFree &lt; 5%\niamgefs.available &lt; 15%\n</code></pre> <p>\u5f53\u5bbf\u4e3b\u673a\u7684 Eviction \u9608\u503c\u8fbe\u5230\u540e\uff0c\u8fdb\u5165 MemoryPressure \u6216 DiskPressure \u72b6\u6001\uff0c\u907f\u514d\u65b0\u7684 Pod \u88ab\u8c03\u5ea6\u5230\u8be5\u5bbf\u4e3b\u673a\uff0c\u5220\u9664Pod\u7684\u4f18\u5148\u7ea7\uff1a</p> <ul> <li>\u9996\u5148\uff0cBestEffort \u7c7b\u522b Pod \u4f18\u5148\u5220\u9664\uff1b</li> <li>\u5176\u6b21\uff0cBurstable\u7c7b\u522b\uff0c\u4e14\u53d1\u751f\u201c\u9965\u997f\u201d\u7684\u8d44\u6e90\u4f7f\u7528\u91cf\u8d85\u51fa requests \u7684 Pod\uff1b</li> <li>\u6700\u540e\uff0cGuaranteed\u7c7b\u522b\uff0c\u4e14\u53ea\u6709\u5f53 Guaranteed \u7c7b\u522b\u7684 Pod \u7684\u8d44\u6e90\u4f7f\u7528\u91cf\u8d85\u8fc7 limits \u9650\u5236\uff0c\u6216\u8005\u5bbf\u4e3b\u673a\u672c\u8eab\u5904\u4e8e Memory Pressure \u72b6\u6001\u65f6\uff0cGuaranteed \u7c7b\u522b\u7684 Pod \u624d\u53ef\u80fd\u88ab\u9009\u4e2d\u8fdb\u884c Eviction \u64cd\u4f5c\uff1b</li> </ul> <p>\u8d44\u6e90\u4f7f\u7528\u91cf\u8d85\u51fa <code>limits</code> \u7684\u540e\u679c</p> <p>CPU\uff1a</p> <ul> <li>Container CPU \u4f7f\u7528\u91cf\u53ef\u80fd\u5141\u8bb8\u8d85\u8fc7 limit\uff0c\u4e5f\u53ef\u80fd\u4e0d\u5141\u8bb8\uff1b</li> <li>Container CPU \u4f7f\u7528\u91cf\u8d85\u8fc7 limit \u4e4b\u540e\uff0c\u5e76\u4e0d\u4f1a\u88ab\u5e72\u6389\u3002</li> </ul> <p>Memory\uff1a</p> <ul> <li>\u5982\u679c container \u7684\u5185\u5b58\u4f7f\u7528\u91cf\u8d85\u8fc7 request\uff0c\u90a3\u8fd9\u4e2a node \u5185\u5b58\u4e0d\u8db3\u65f6\uff0c \u8fd9\u4e2a Pod \u53ef\u80fd\u4f1a\u88ab\u9a71\u9010\uff1b</li> <li>Container \u7684\u5185\u5b58\u4f7f\u7528\u91cf\u8d85\u8fc7 limit \u65f6\uff0c\u53ef\u80fd\u4f1a\u88ab\u5e72\u6389\uff08OOMKilled\uff09\u3002\u5982\u679c\u53ef\u91cd\u542f\uff0ckubelet \u4f1a\u91cd\u542f\u5b83\u3002</li> </ul> <p>Node \u8d44\u6e90\u7d27\u5f20\u65f6\uff0c\u6309 QoS \u5206\u914d\u8d44\u6e90\u6bd4\u4f8b</p> <p>\u4f46\u53ea\u8981 Guaranteed pods \u9700\u8981\u8d44\u6e90\uff0c\u8fd9\u4e9b\u4f4e\u4f18\u5148\u7ea7\u7684 pods \u5c31\u5fc5\u987b\u53ca\u65f6\u91ca\u653e\u8d44\u6e90\u3002 \u5982\u4f55\u91ca\u653e\u5462\uff1f</p> <p>\u5bf9\u4e8e CPU \u7b49 compressible resources\uff0c\u53ef\u4ee5\u901a\u8fc7 CPU CFS shares\uff0c\u9488\u5bf9\u6bcf\u4e2a QoS \u5206\u914d\u4e00\u5b9a\u6bd4\u4f8b\u7684\u8d44\u6e90\uff0c\u786e\u4fdd\u5728 CPU \u8d44\u6e90\u53d7\u9650\u65f6\uff0c\u6bcf\u4e2a pod \u80fd\u83b7\u5f97\u5b83\u6240\u7533\u8bf7\u7684 CPU \u8d44\u6e90\u3002</p> <p>\u5bf9\u4e8e <code>burstable</code> cgroup,</p> <pre><code>/burstable/cpu.shares            = max(sum(Burstable pods cpu requests), MinShares) # MinShares == 2\nburstableLimit                  := allocatable \u2014 qosMemoryRequests[PodQOSGuaranteed]*percentReserve/100\n/burstable/memory.limit_in_bytes = burstableLimit\n</code></pre> <p>\u5bf9\u4e8e <code>bestEffort</code> cgroup,</p> <pre><code>/besteffort/cpu.shares            = MinShares # MinShares == 2\nbestEffortLimit                  := burstableLimit \u2014 qosMemoryRequests[PodQOSBurstable]*percentReserve/100\n/besteffort/memory.limit_in_bytes = bestEffortLimit\n</code></pre> <p>\u8fd9\u51e0\u4e2a cgroup \u521d\u59cb\u5316\u4e4b\u540e, kubelet \u4f1a\u8c03\u7528 <code>UpdateCgroups()</code> \u65b9\u6cd5\u6765\u5b9a\u671f\u66f4\u65b0\u8fd9\u4e09\u4e2a cgroup \u7684 resource limit\u3002</p>"},{"location":"cloud/k8s/scheduler.html#cpuset","title":"cpuset","text":"<p>\u5c06\u5bb9\u5668\u7ed1\u5b9a\u5230\u67d0\u4e2a CPU \u6838\u4e0a\uff0c\u51cf\u5c11CPU\u4e4b\u95f4\u7684\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u63d0\u5347\u5bb9\u5668\u6027\u80fd\u3002</p> <p>\u901a\u8fc7\u5c06 Pod \u7684 CPU \u8d44\u6e90\u7684 requests \u548c limits \u7684\u503c\u8bbe\u7f6e\u4e3a\u76f8\u7b49\u5373\u53ef\u8fbe\u5230 cpuset\uff0c\u5177\u4f53\u7ed1\u5b9a\u7684\u6838\u7531 kubelet \u51b3\u5b9a\u3002</p>"},{"location":"cloud/k8s/scheduler.html#_4","title":"\u8282\u70b9\u8d44\u6e90\u5207\u5206\uff08\u9884\u7559\uff09","text":"<p>\u4e0d\u662f\u4e00\u53f0 node \u7684\u6240\u6709\u8d44\u6e90\u90fd\u80fd\u7ed9 k8s \u521b\u5efa pod \u7528</p> <p><code>[Allocatable] = [NodeCapacity] - [KubeReserved] - [SystemReserved] - [HardEvictionThreshold]</code></p> <ul> <li>Allocatable\uff1a\u53ef\u4ee5\u5206\u914d\u7ed9 Pod \u7684\u8d44\u6e90\u4fe1\u606f</li> <li>NodeCapacity\uff1a\u8282\u70b9\u7684\u8d44\u6e90\u4fe1\u606f</li> </ul> <p>\u8d44\u6e90\u9884\u7559\uff08\u5207\u5206\uff09\u76f8\u5173\u7684 kubelet \u547d\u4ee4\u53c2\u6570\uff1a</p> <ul> <li><code>--system-reserved=\"\"</code></li> <li><code>--kube-reserved=\"\"</code></li> <li><code>--qos-reserved=\"\"</code></li> <li><code>--reserved-cpus=\"\"</code></li> </ul> <p>\u662f\u5426\u9700\u8981\u5bf9\u8fd9\u4e9b reserved \u8d44\u6e90\u7528\u4e13\u95e8\u7684 cgroup \u6765\u505a\u8d44\u6e90\u9650\u989d\uff08\u9ed8\u8ba4\u4e0d\u542f\u7528\uff09\uff0c\u4ee5\u786e\u4fdd\u5f7c\u6b64\u4e92\u4e0d\u5f71\u54cd\uff1a</p> <ul> <li><code>--kube-reserved-cgroup=\"\"</code></li> <li><code>--system-reserved-cgroup=\"\"</code></li> </ul> <p>\u901a\u8fc7 kubelet \u7684config\u6587\u4ef6<code>/var/lib/kubelet/config.yaml</code>\uff0c\u53ef\u4ee5\u67e5\u770b\u76f8\u5173\u53c2\u6570\u4fe1\u606f</p>"},{"location":"cloud/k8s/scheduler.html#cgroup-runtime-driver","title":"Cgroup Runtime Driver","text":"<p>k8s \u901a\u8fc7\u914d\u7f6e cgroup \u6765\u9650\u5236 container/pod \u80fd\u4f7f\u7528\u7684\u6700\u5927\u8d44\u6e90\u91cf\u3002\u8fd9\u4e2a\u914d\u7f6e\u6709\u4e24\u79cd\u5b9e\u73b0\u65b9\u5f0f\uff0c \u5728 k8s \u4e2d\u79f0\u4e3a cgroup runtime driver\uff1a</p> <ol> <li><code>cgroupfs</code></li> </ol> <p>\u8fd9\u79cd\u6bd4\u8f83\u7b80\u5355\u76f4\u63a5\uff0ckubelet \u5f80 cgroup \u6587\u4ef6\u7cfb\u7edf\u4e2d\u5199 limit \u5c31\u884c\u3002 \u8fd9\u4e5f\u662f\u76ee\u524d k8s \u7684\u9ed8\u8ba4\u65b9\u5f0f\u3002</p> <ol> <li><code>systemd</code></li> </ol> <p>\u6240\u6709 cgroup-writing \u64cd\u4f5c\u90fd\u5fc5\u987b\u901a\u8fc7 systemd \u7684\u63a5\u53e3\uff0c\u4e0d\u80fd\u624b\u52a8\u4fee\u6539 cgroup \u6587\u4ef6\u3002 \u9002\u7528\u4e8e k8s cgroup v2 \u6a21\u5f0f\u3002</p>"},{"location":"cloud/k8s/scheduler.html#kubelet-cgroup","title":"kubelet Cgroup \u5c42\u7ea7","text":"<p>cgroup v1 \u7684\u8bf4\u660e\u3002</p> <p>kubelet \u4f1a\u5728 node \u4e0a\u521b\u5efa\u4e86 4 \u4e2a cgroup \u5c42\u7ea7\uff0c\u4ece node \u7684 root cgroup \uff08\u4e00\u822c\u90fd\u662f <code>/sys/fs/cgroup</code>\uff09\u5f80\u4e0b\uff1a</p> <ol> <li>Node \u7ea7\u522b\uff1a\u9488\u5bf9 SystemReserved\u3001KubeReserved \u548c k8s pods \u5206\u522b\u521b\u5efa\u7684\u4e09\u4e2a cgroup\uff1b</li> <li>QoS \u7ea7\u522b\uff1a\u5728 <code>kubepods</code> cgroup \u91cc\u9762\uff0c\u53c8\u9488\u5bf9\u4e09\u79cd pod QoS \u5206\u522b\u521b\u5efa\u4e00\u4e2a sub-cgroup\uff1a</li> <li>Pod \u7ea7\u522b\uff1a\u6bcf\u4e2a pod \u521b\u5efa\u4e00\u4e2a cgroup\uff0c\u7528\u6765\u9650\u5236\u8fd9\u4e2a pod \u4f7f\u7528\u7684\u603b\u8d44\u6e90\u91cf\uff1b</li> <li>Container \u7ea7\u522b\uff1a\u5728 pod cgroup \u5185\u90e8\uff0c\u9650\u5236\u5355\u4e2a container \u7684\u8d44\u6e90\u4f7f\u7528\u91cf\u3002</li> </ol> <p></p>"},{"location":"cloud/k8s/scheduler.html#pod-cgroup","title":"Pod \u7ea7\u522b Cgroup","text":"<p>\u4e3a\u4e86\u9632\u6b62\u4e00\u4e2a pod \u7684\u591a\u4e2a\u5bb9\u5668\u4f7f\u7528\u8d44\u6e90\u8d85\u6807\uff0ck8s \u5f15\u5165\u4e86 \u5f15\u5165\u4e86 pod-level cgroup\uff0c\u6bcf\u4e2a pod \u90fd\u6709\u81ea\u5df1\u7684 cgroup</p> <ul> <li>\u67d0\u4e9b\u8d44\u6e90\u662f\u8fd9\u4e2a pod \u7684\u6240\u6709 container \u5171\u4eab\u7684\uff1b</li> <li>\u6bcf\u4e2a pod \u4e5f\u6709\u81ea\u5df1\u7684\u4e00\u4e9b\u5f00\u9500\uff0c\u4f8b\u5982 sandbox container\uff1b</li> <li>Pod \u7ea7\u522b\u8fd8\u6709\u4e00\u4e9b\u5185\u5b58\u7b49\u989d\u5916\u5f00\u9500\uff1b</li> </ul>"},{"location":"cloud/k8s/scheduler.html#qos-cgroup","title":"QoS \u7ea7\u522b cgroup","text":"<p>kubelet <code>--cgroups-per-qos=true</code> \u53c2\u6570\uff08\u9ed8\u8ba4\u4e3a true\uff09\uff0c \u5c31\u4f1a\u5c06\u6240\u6709 pod \u5206\u6210\u4e09\u79cd QoS\uff0c\u4f18\u5148\u7ea7\u4ece\u9ad8\u5230\u4f4e\uff1a<code>Guaranteed &gt; Burstable &gt; BestEffort</code>\u3002 </p> <p>\u6bcf\u4e2a QoS \u5bf9\u5e94\u4e00\u4e2a\u5b50 cgroup\uff0c\u8bbe\u7f6e\u8be5 QoS \u7c7b\u578b\u7684\u6240\u6709 pods \u7684\u603b\u8d44\u6e90\u9650\u989d\uff0c \u4e09\u4e2a cgroup \u5171\u540c\u6784\u6210\u4e86 <code>kubepods</code> cgroup\u3002 </p> <p>\u6bcf\u4e2a QoS cgroup \u53ef\u4ee5\u8ba4\u4e3a\u662f\u4e00\u4e2a\u8d44\u6e90\u6c60\uff0c\u6bcf\u4e2a\u6c60\u5b50\u5185\u7684 pod \u5171\u4eab\u8d44\u6e90\u3002</p>"},{"location":"cloud/k8s/scheduler.html#node-cgroup","title":"Node \u7ea7\u522b cgroup","text":"<p>\u6240\u6709\u7684 k8s pod \u90fd\u4f1a\u843d\u5165 <code>kubepods</code> cgroup\uff1b</p> <ul> <li>\u6240\u6709 k8s pods \u5360\u7528\u7684\u8d44\u6e90\u90fd\u5df2\u7ecf\u901a\u8fc7 cgroup \u6765\u63a7\u5236\uff0c\u5269\u4e0b\u7684\u662f k8s \u7ec4\u4ef6\u81ea\u8eab\u548c\u64cd\u4f5c\u7cfb\u7edf\u57fa\u7840\u670d\u52a1\u6240\u5360\u7528\u7684\u8d44\u6e90\uff0c\u5373 <code>KubeReserved</code> \u548c <code>SystemReserved</code></li> <li>k8s \u65e0\u6cd5\u7ba1\u7406\u8fd9\u4e24\u79cd\u670d\u52a1\u7684\u8d44\u6e90\u5206\u914d\uff0c\u4f46\u80fd\u7ba1\u7406\u5b83\u4eec\u7684\u9650\u989d\uff1a\u6709\u8db3\u591f\u6743\u9650\u7ed9\u5b83\u4eec\u521b\u5efa\u5e76\u8bbe\u7f6e cgroup \uff08kubelet \u7684\u53c2\u6570\uff09</li> <li><code>--kube-reserved-cgroup=\"\"</code>\u548c<code>--system-reserved-cgroup=\"\"</code>\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\uff0c\u8868\u793a\u4e0d\u521b\u5efa\uff0c\u4e5f\u5c31\u662f\u7cfb\u7edf\u7ec4\u4ef6\u548c pod \u4e4b\u95f4\u5e76\u6ca1\u6709\u4e25\u683c\u9694\u79bb\u3002</li> </ul>"},{"location":"cloud/k8s/scheduler.html#cgroup-v1","title":"cgroup (v1) \u914d\u7f6e\u76ee\u5f55","text":"<p>cgroup root\uff1a<code>sys/fs/cgroup</code></p> <p>/kubepods\uff08node \u7ea7\u522b\u914d\u7f6e\uff09\uff1a\u6309 resource controller \u7c7b\u578b</p> <ul> <li><code>/sys/fs/cgroup/cpu/kubepods/</code></li> <li><code>/sys/fs/cgroup/memory/kubepods/</code></li> </ul> <p>Qos \u7ea7\u522b\u914d\u7f6e</p> <ul> <li>Burstable\u6216BestEffort\uff1a<code>/sys/fs/cgroup/{controller}/kubepods/{burstable|besteffort}</code></li> <li>Guaranteed \uff1a\u76f4\u63a5\u5c31\u662f <code>/sys/fs/cgroup/{controller}/kubepods/</code>\uff0c \u6ca1\u6709\u5355\u72ec\u7684\u5b50\u76ee\u5f55</li> <li>\u8fd9\u79cd\u7c7b\u578b\u7684 pod \u90fd\u8bbe\u7f6e\u4e86 limits\uff0c \u5c31\u65e0\u9700\u518d\u5f15\u5165\u4e00\u5c42 wrapper \u6765\u9632\u6b62\u8fd9\u79cd\u7c7b\u578b\u7684 pods \u7684\u8d44\u6e90\u4f7f\u7528\u603b\u91cf\u8d85\u51fa\u9650\u989d</li> </ul> <p>Pod\u7ea7\u522b\u914d\u7f6e\uff1a\u914d\u7f6e\u5728Qos cgroup \u914d\u7f6e\u7684\u4e0b\u4e00\u7ea7</p> <ul> <li>\u5982 <code>/sys/fs/cgroup/{controller}/kubepods/burstable/{pod_id}/</code></li> </ul> <p>Container\u7ea7\u522b\u914d\u7f6e\uff1aPod \u7684\u4e0b\u4e00\u7ea7</p> <ul> <li>\u5982 <code>/sys/fs/cgroup/{controller}/kubepods/{pod_id}/{container_id}/</code></li> </ul>"},{"location":"cloud/k8s/scheduler.html#pod-requetslimits","title":"pod\u7684 <code>requets/limits</code> \u7684\u8ba1\u7b97","text":"<p>\u4ee3\u7801\uff1a<code>ResourceConfigForPod()</code></p> <p>pod \u7684 requests/limits \u9700\u8981\u7531 kubelet \u7efc\u5408\u7edf\u8ba1 pod \u7684\u6240\u6709 container \u7684 request/limits \u8ba1\u7b97\u5f97\u5230\u3002 CPU \u548c\u5185\u5b58\u7684\u8ba1\u7b97\u65b9\u5f0f\u5982\u4e0b\uff1a</p> <pre><code># \u8ba1\u7b97 pod \u7684 CPU request\uff0c\u901a\u8fc7 cpu.shares \u80fd\u5b9e\u73b0\u6700\u5c0f\u503c\u63a7\u5236\npod&lt;pod_id&gt;/cpu.shares            = sum(pod.spec.containers.resources.requests[cpu])\n# \u8ba1\u7b97 pod \u7684 CPU limit\uff0c\u901a\u8fc7 cpu.cfs_quota_us \u80fd\u5b9e\u73b0\u6700\u5927\u503c\u63a7\u5236\npod&lt;pod_id&gt;/cpu.cfs_quota_us      = sum(pod.spec.containers.resources.limits[cpu])\n\n# \u8ba1\u7b97 pod \u7684 Memory limit\npod&lt;pod_id&gt;/memory.limit_in_bytes = sum(pod.spec.containers.resources.limits[memory])\n</code></pre> <p>\u6ce8\u610f\uff0c</p> <ol> <li> <p>\u5982\u679c\u5176\u4e2d\u67d0\u4e2a container \u7684 cpu \u5b57\u6bb5\u53ea\u8bbe\u7f6e\u4e86 request \u6ca1\u8bbe\u7f6e limit\uff0c \u5219 pod \u5c06\u53ea\u8bbe\u7f6e <code>cpu.shares</code>\uff0c\u4e0d\u8bbe\u7f6e <code>cpu.cfs_quota_us</code>\u3002</p> </li> <li> <p>\u5982\u679c\u6240\u6709 container \u90fd\u6ca1\u6709\u8bbe\u7f6e cpu request/limit\uff08\u7b49\u6548\u4e8e <code>requests==limits==0</code>\uff09\uff0c \u5219\u5c06 pod cpu.share \u5c06\u8bbe\u7f6e\u4e3a k8s \u5b9a\u4e49\u7684\u6700\u5c0f\u503c 2\u3002</p> </li> </ol> <pre><code> pod&lt;pod_id&gt;/cpu.shares = MinShares # const value 2\n</code></pre> <p>\u8fd9\u79cd pod \u5728 node \u7a7a\u95f2\u65f6\u6700\u591a\u80fd\u4f7f\u7528\u6574\u4e2a node \u7684\u8d44\u6e90\uff1b\u4f46 node \u8d44\u6e90\u7d27\u5f20\u65f6\uff0c\u4e5f\u6700\u5148\u88ab\u9a71\u9010\u3002</p>"},{"location":"cloud/k8s/scheduler.html#_5","title":"\u8d44\u6e90\u914d\u989d","text":"<p>\u8d44\u6e90\u914d\u989d\u662f\u4e00\u4e2a\u7528\u4e8e\u9650\u5236\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u4e0b\u8d44\u6e90\u4f7f\u7528\u7684\u673a\u5236\uff0c\u5176\u5305\u62ec\u5982\u4e0b\u4e24\u4e2a\u5bf9\u8c61\uff1a</p> <p><code>ResourceQuota</code>\uff1a\u9650\u5236\u5355\u4e2a\u547d\u540d\u7a7a\u95f4\u4e0b\u7684\u8d44\u6e90\u4f7f\u7528\u91cf\u3002\u5305\u62ecCPU\uff0c\u5185\u5b58\uff0c\u5b58\u50a8\uff0c\u8d44\u6e90\u5bf9\u8c61\u7684\u4e2a\u6570\u7b49\u7b49\u3002</p> <p><code>LimitRanger</code>\uff1a\u4e3a\u5bb9\u5668\u7684Limits\u548cRequests\u8bbe\u7f6e\u9ed8\u8ba4\u503c\u548c\u8303\u56f4\u7ea6\u675f\u3002</p>"},{"location":"cloud/k8s/scheduler.html#resourcequota","title":"ResourceQuota","text":"<p>resourcequota\u5bf9\u76f8\u5f53\u591a\u7684\u8d44\u6e90\u63d0\u4f9b\u9650\u5236\uff0c\u8be6\u7ec6\u5185\u5bb9\u53ef\u53c2\u8003\u6587\u6863\uff1ahttps://kubernetes.io/docs/concepts/policy/resource-quotas/#compute-resource-quota\u3002</p> <ul> <li>\u793a\u4f8b\uff1a\u4e3atest\u547d\u540d\u7a7a\u95f4\u8bbe\u7f6e\u8d44\u6e90\u914d\u989d</li> </ul> <pre><code>kubectl apply -f resource.yaml\n</code></pre> <p>resource.yaml\u7684\u4fe1\u606f\u5982\u4e0b\uff1a</p> <pre><code>apiVersion: v1\nkind: ResourceQuota\nmetadata:\n  name: compute-resources\n  namespace: test\nspec:\n  hard:\n    pods: \"2\"\n    requests.cpu: \"1\"\n    requests.memory: 1Gi\n    limits.cpu: \"2\"\n    limits.memory: 2Gi\n</code></pre> <ul> <li>\u5982\u4e0a\uff0c\u5bf9pod\u6570\u91cf\u548c\u4f7f\u7528\u7684requests\u4e0elimits\u503c\u505a\u4e86\u9650\u5236\u3002\u53ef\u4ee5\u4f7f\u7528describe\u547d\u4ee4\u67e5\u770b\u76ee\u524d\u7684\u8d44\u6e90\u4f7f\u7528\u91cf\u548c\u9650\u5236\uff1a</li> </ul> <pre><code>kubectl describe resourcequotas -n test\n</code></pre> <p></p> <ul> <li>\u5c1d\u8bd5\u521b\u5efa\u4e24\u4e2aPod\uff0c\u518d\u6b21\u521b\u5efa\u540e\u62a5\u9519\uff1a\u8bb0\u5f97\u518d\u6b21\u521b\u5efa\u65f6\u4fee\u6539pod\u540d\u79f0</li> </ul> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: high-priority\n  namespace: test\nspec:\n  containers:\n  - name: high-priority\n    image: ubuntu\n    command: [\"/bin/sh\"]\n    args: [\"-c\", \"while true; do echo hello; sleep 10;done\"]\n    resources:\n      requests:\n        memory: \"1Gi\"\n        cpu: \"500m\"\n      limits:\n        memory: \"1Gi\"\n        cpu: \"500m\"\n</code></pre> <p></p>"},{"location":"cloud/k8s/scheduler.html#limitranger","title":"LimitRanger","text":"<p>LimitRanger\u7528\u4e8e\u4e3a\u5bb9\u5668\u8bbe\u7f6e\u9ed8\u8ba4\u7684requests\u548climits\u503c\uff0c\u4ee5\u53ca\u9650\u5236\u5176\u8303\u56f4\u3002</p> <ul> <li>\u793a\u4f8b\uff1a\u9650\u5236test\u547d\u540d\u7a7a\u95f4\u4e0b\u5bb9\u5668\u7684requests\u503c\u548climits\u503c    </li> <li>kubectl config use-context kubernetes-admin@kubernetes</li> <li>kubectl apply -f limit.yaml</li> </ul> <pre><code>apiVersion: v1\nkind: LimitRange\nmetadata:\n  name: memory-range\n  namespace: test\nspec:\n  limits:\n  - max: # \u9650\u5236\u5bb9\u5668\u6700\u5927limits\u503c\n      memory: 20Mi\n    min: # \u9650\u5236\u5bb9\u5668\u6700\u5c0flimits\u503c\n      memory: 10Mi\n    default: # \u9ed8\u8ba4limits\u503c\n      memory: 10Mi\n    defaultRequest: # \u9ed8\u8ba4requests\u503c\n      memory: 10Mi\n    type: Container\n</code></pre> <ul> <li>\u5982\u4e0a\uff0c\u5982\u521b\u5efaPod\u65f6\u672a\u6307\u5b9alimits\u548crequests\u503c\uff0c\u5219\u81ea\u52a8\u4e3a\u5176\u6dfb\u52a0requests.memory: 10Mi\uff0climits.memory: 10Mi\uff1b</li> <li>\u5982\u521b\u5efa\u65f6limits.memory\u503c\u5c0f\u4e8e10Mi\u6216\u5927\u4e8e20Mi\uff0c\u5219\u4f1a\u62d2\u7edd\u8be5\u8bf7\u6c42\u3002</li> </ul>"},{"location":"cloud/k8s/scheduler.html#pod","title":"Pod \u5f00\u9500","text":"<p>Pod \u5f00\u9500 | Kubernetes</p> <p>Pod \u672c\u8eab\u5360\u7528\u5927\u91cf\u7cfb\u7edf\u8d44\u6e90\u3002\u8fd9\u4e9b\u662f\u8fd0\u884c Pod \u5185\u5bb9\u5668\u6240\u9700\u8d44\u6e90\u4e4b\u5916\u7684\u8d44\u6e90\u3002</p> <p>Pod \u7684\u5f00\u9500\u662f\u6839\u636e\u4e0e Pod \u7684 RuntimeClass \u76f8\u5173\u8054\u7684\u5f00\u9500\u5728\u51c6\u5165\u65f6\u8bbe\u7f6e\u7684</p>"},{"location":"cloud/k8s/scheduler.html#_6","title":"\u9ed8\u8ba4\u8c03\u5ea6\u5668","text":"<p>\u804c\u8d23\uff1a\u4e3a\u65b0\u521b\u5efa\u51fa\u6765\u7684Pod\u5bfb\u627e\u4e00\u4e2a\u5408\u9002\u7684\u8282\u70b9\u3002</p> <p></p> <p>Kubernetes \u8c03\u5ea6\u5668\u7684\u6838\u5fc3\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u4e24\u4e2a\u76f8\u4e92\u72ec\u7acb\u7684\u63a7\u5236\u5faa\u73af\u3002</p> <ul> <li><code>Informer Path</code>\uff1a\u542f\u52a8\u4e00\u7cfb\u5217 informer\uff0c\u6765\u76d1\u542c Etcd \u4e2d Pod\u3001Node\u3001Service \u7b49\u4e0e\u8c03\u5ea6\u76f8\u5173\u7684\u5bf9\u8c61\u7684\u53d8\u5316\uff0c\u52a0\u5165\u8c03\u5ea6\u961f\u5217\uff1b</li> <li>\u8d1f\u8d23\u5bf9\u8c03\u5ea6\u5668\u7f13\u5b58( scheduler cache\uff09\u8fdb\u884c\u66f4\u65b0\uff0c\u901a\u8fc7\u7f13\u5b58\u63d0\u5347\u7b97\u6cd5\u6267\u884c\u6548\u7387\uff1b</li> <li><code>Scheduling Path</code>\uff1a\u4e0d\u65ad\u5730\u4ece\u8c03\u5ea6\u961f\u5217\u91cc\u51fa\u961f\u4e00\u4e2a Pod</li> <li>Predicate\uff1a\u4ece\u96c6\u7fa4\u6240\u6709\u7684\u8282\u70b9\u4e2d\u6839\u636e\u8c03\u5ea6\u7b97\u6cd5\u9009\u51fa\u6240\u6709\u53ef\u4ee5\u8fd0\u884c\u8be5Pod\u7684\u8282\u70b9\uff1b</li> <li>Priority \uff1a\u4ece\u7b2c\u4e00\u6b65\u7ed3\u679c\u4e2d\uff0c\u518d\u6839\u636e\u8c03\u5ea6\u7b97\u6cd5\u6311\u9009\u4e00\u4e2a\u6700\u7b26\u5408\u6761\u4ef6\u7684\u8282\u70b9\u4f5c\u4e3a\u6700\u7ec8\u7ed3\u679c\uff1b</li> <li>Bind\uff1a\u5c06pod\u7684<code>spec.nodeNmae</code>\u5b57\u6bb5\u586b\u4e0a\u8c03\u5ea6\u7ed3\u679c\u7684\u8282\u70b9\u540d\u79f0\u3002</li> </ul> <p>\u4e50\u89c2\u7ed1\u5b9a\uff08Assume\uff09\uff1a\u4e0d\u5728\u8fd9\u4e2a\u5173\u952e\u8c03\u5ea6\u6b65\u9aa4\u4e2d\u8fdc\u7a0b\u8bbf\u95ee API server\uff0c\u5728 Bind \u9636\u6bb5\uff0c\u8c03\u5ea6\u5668\u53ea\u4f1a\u66f4\u65b0 Scheduler Cache \u91cc\u7684 Pod \u548c Node \u4fe1\u606f</p> <ul> <li> <p>\u518d\u521b\u5efa\u4e00\u4e2a Goroutine \u6765\u5f02\u6b65\u5411 API server \u53d1\u8d77\u66f4\u65b0 Pod \u7684\u8bf7\u6c42\uff0c\u6765\u5b8c\u6210\u771f\u6b63\u7684 Bind \u64cd\u4f5c\u3002</p> </li> <li> <p>\u5bf9\u5e94\u8282\u70b9\u7684 kubelet \u4f1a\u8fdb\u884c\u4e00\u4e2a Admit \u7684\u64cd\u4f5c\uff0c\u518d\u6b21\u786e\u8ba4\u8be5 pod \u80fd\u5426\u8fd0\u884c\u5728\u8be5\u8282\u70b9\u4e0a\u3002</p> </li> </ul>"},{"location":"cloud/k8s/scheduler.html#_7","title":"\u4f18\u5148\u7ea7\u548c\u62a2\u5360","text":"<p>\u89e3\u51b3 Pod \u8c03\u5ea6\u5931\u8d25\u65f6\u8be5\u600e\u4e48\u529e\u7684\u95ee\u9898\u3002</p> <p>\u4f18\u5148\u7ea7\u8d8a\u9ad8\u7684Pod\u5728\u8c03\u5ea6\u65f6\u4f1a\u4f18\u5148\u51fa\u961f\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cPod\u8c03\u5ea6\u5931\u8d25\u540e\uff0c\u4f1a\u88ab\u6682\u65f6\u201c\u6401\u7f6e\u201d\uff0c\u76f4\u5230 Pod \u88ab\u66f4\u65b0\u6216\u8005\u96c6\u7fa4\u72b6\u6001\u53d1\u751f\u53d8\u5316\uff0c\u8c03\u5ea6\u5668\u624d\u4f1a\u5bf9 Pod \u8fdb\u884c\u91cd\u65b0\u8c03\u5ea6\u3002</p> <p>\u5f53\u9ad8\u4f18\u5148\u7ea7\u7684Pod\u8c03\u5ea6\u5931\u8d25\u540e\uff0c\u89e6\u53d1\u201c\u62a2\u5360\u201d\uff0c\u8c03\u5ea6\u5668\u5728\u96c6\u7fa4\u4e2d\u5bfb\u627e\u4e00\u4e2a\u8282\u70b9\uff1a</p> <ul> <li>\u8be5\u8282\u70b9\u4e0a\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u4f4e\u4f18\u5148\u7ea7\u7684Pod\u88ab\u5220\u9664\u540e\uff0c\u9ad8\u4f18\u5148\u7ea7\u7684Pod\u53ef\u4ee5\u88ab\u8c03\u5ea6\u5230\u8be5\u8282\u70b9\uff1b</li> <li>\u4ec5\u8bbe\u7f6e<code>spec.nominatedNodeName</code>\u5b57\u6bb5\uff0c\u4e0b\u4e00\u4e2a\u5468\u671f\u8fdb\u884c\u8c03\u5ea6\uff1b</li> </ul> <pre><code># \u5b9a\u4e49 PriorityClass\napiVersion: scheduling.k8s.io/v1\nkind: PriorityClass\nmetadata:\n  name: high-priority\nvalue: 1000000\nglobalDefault: false  # \u662f\u5426\u4f5c\u4e3a\u7cfb\u7edf\u7684\u9ed8\u8ba4\u4f18\u5148\u7ea7\ndescription: \"This priority class should be used for high priority service pods only.\"\n-----\n# Pod\u4f7f\u7528PriorityClass\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\nlabels:\n  env: test\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n    imagePullPolicy: IfNotPresent\n  priorityClassName: high-priority\n</code></pre>"},{"location":"cloud/k8s/scheduler.html#_8","title":"\u9ed8\u8ba4\u7684\u8c03\u5ea6\u914d\u7f6e","text":"<p>\u9ed8\u8ba4\u63d2\u4ef6 | Kubernetes \u5305\u62ec\uff1a</p> <ul> <li>\u6c61\u70b9\u548c\u5bb9\u5fcd\uff1b</li> <li>\u8282\u70b9\u9009\u62e9\u5668\u548c\u4eb2\u548c\u6027\uff1b</li> <li>Pod \u95f4\u4eb2\u548c\u6027\u4e0e\u53cd\u4eb2\u548c\u6027\uff1b</li> <li>Pod\u62d3\u6734\u5206\u5e03\uff1b</li> <li>Pod \u8bf7\u6c42\u7684\u6240\u6709\u8d44\u6e90\u68c0\u67e5\uff1b</li> <li><code>NodeResourcesBalancedAllocation</code>\uff1a\u8c03\u5ea6 Pod \u65f6\uff0c\u9009\u62e9\u8d44\u6e90\u4f7f\u7528\u66f4\u4e3a\u5747\u8861\u7684\u8282\u70b9</li> </ul>"},{"location":"cloud/k8s/scheduler.html#_9","title":"\u5b98\u65b9\u8c03\u5ea6\u63d2\u4ef6","text":"<p>\u652f\u6301\uff1a</p> <ul> <li>Capacity Scheduling\uff1a\u5bb9\u91cf\u8c03\u5ea6\u5668\uff1b</li> <li>Coscheduling\uff1aGang Scheduling\uff0c\u6279\u91cf\u534f\u540c\u8c03\u5ea6</li> <li> <p>\u901a\u8fc7Pod\u7684\u8c03\u5ea6\u72b6\u6001 Wait \u4fdd\u8bc1\u81f3\u5c11N\u4e2aPod\u53ef\u4ee5\u88ab\u4e00\u8d77\u8c03\u5ea6\uff1b</p> </li> <li> <p>Node Resources</p> </li> <li>Node Resource Topology</li> <li>Preemption Toleration</li> <li>Trimaran</li> </ul> <p>\u81ea\u5b9a\u4e49\u8c03\u5ea6\u5668\u89c1 \u81ea\u5b9a\u4e49\u8c03\u5ea6</p>"},{"location":"cloud/k8s/scheduler_plugin.html","title":"K8s \u81ea\u5b9a\u4e49\u8c03\u5ea6","text":"<p>scheduler plugin \u5b98\u65b9 repo </p> <p>\u9ed8\u8ba4\u8c03\u5ea6\u5668\u7684\u53ef\u6269\u5c55\u673a\u5236\uff0c\u5728 Kubernetes \u91cc\u9762\u53eb\u4f5c Scheduler Framework\u3002</p> <ul> <li>\u5c06\u63d2\u4ef6\u548c\u539f\u751f\u8c03\u5ea6\u5668\u7edf\u4e00\u6784\u5efa\u6210\u65b0\u955c\u50cf\u4f7f\u7528\uff1b</li> </ul> <p>\u5728\u8c03\u5ea6\u5668\u751f\u547d\u5468\u671f\u7684\u5404\u4e2a\u5173\u952e\u70b9\u4e0a\uff0c\u4e3a\u7528\u6237\u66b4\u9732\u51fa\u53ef\u4ee5\u8fdb\u884c\u6269\u5c55\u548c\u5b9e\u73b0\u7684\u63a5\u53e3\uff0c\u4ece\u800c\u5b9e\u73b0\u7528\u6237\u81ea\u5b9a\u4e49\u8c03\u5ea6\u3002</p>"},{"location":"cloud/k8s/scheduler_plugin.html#_1","title":"\u8c03\u5ea6\u7684\u751f\u547d\u5468\u671f","text":"<p>\u5728\u6267\u884c\u8c03\u5ea6\u6d41\u7a0b\u65f6\uff0c\u8fd0\u884c\u5230\u76f8\u5e94\u7684\u6269\u5c55\u70b9\u65f6\u4f1a\u8c03\u7528\u7528\u6237\u6ce8\u518c\u7684\u63d2\u4ef6\uff0c\u5f71\u54cd\u8c03\u5ea6\u51b3\u7b56\u7684\u7ed3\u679c\u3002\u5c06\u7528\u6237\u7684\u8c03\u5ea6\u903b\u8f91\u96c6\u6210\u5230 Scheduling Framework \u4e2d\u3002</p> <p>\u5206\u4e3a\u4e24\u4e2a\u9636\u6bb5 scheduling cycle \u548c binding cycle\u3002</p> <ul> <li>scheduling cycle \u662f\u540c\u6b65\u6267\u884c\u7684\uff0c\u540c\u4e00\u4e2a\u65f6\u95f4\u53ea\u6709\u4e00\u4e2a scheduling cycle\uff0c\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff1b</li> <li>binding cycle \u662f\u5f02\u6b65\u6267\u884c\u7684\uff0c\u540c\u4e00\u4e2a\u65f6\u95f4\u4e2d\u53ef\u80fd\u4f1a\u6709\u591a\u4e2a binding cycle\u5728\u8fd0\u884c\uff0c\u662f\u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684\u3002</li> </ul> <p></p>"},{"location":"cloud/k8s/scheduler_plugin.html#schedule-status","title":"Schedule Status","text":"<p>Status \u4e2d\u7684 Code\uff08int\uff09 \u5b57\u6bb5\u7684\u679a\u4e3e\u5b9a\u4e49\uff1a</p> <ul> <li>Success \uff1aplugin \u6b63\u5e38\u8fd0\u884c\uff0c\u4e14pod \u53ef\u8c03\u5ea6\uff1b</li> <li>Error \uff1ainternal plugin errors, unexpected input, etc\uff1b</li> <li>Unschedulable \uff1aplugin \u53d1\u73b0 pod \u4e0d\u53ef\u8c03\u5ea6\uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u5176\u5b83\u7684 postFilter \u63d2\u4ef6\uff08\u5982\u62a2\u5360\uff09\u4f7f\u5f97 Pod \u53ef\u8c03\u5ea6\uff1b</li> <li>UnschedulableAndUnresolvable \uff1aplugin \u53d1\u73b0 pod \u4e0d\u53ef\u8c03\u5ea6\uff0c\u4e5f\u4e0d\u80fd\u901a\u8fc7\u8fd0\u884c\u5176\u5b83\u7684 postFilter \u63d2\u4ef6\uff08\u5982\u62a2\u5360\uff09\u4f7f\u5f97 Pod \u53ef\u8c03\u5ea6\uff08\u4f1a\u8df3\u8fc7\uff09\uff1b</li> <li>Wait\uff1a<code>Permit</code> \u63d2\u4ef6\u53d1\u73b0 Pod \u9700\u8981\u7b49\u5f85\u65f6\uff0c\u8fd4\u56de\u8be5\u503c\uff1b</li> <li>Skip\uff1a\u7528\u4e8e\u4ee5\u4e0b\u573a\u666f\uff1a</li> <li><code>Bind</code> \u63d2\u4ef6\u9009\u62e9\u8df3\u8fc7\uff1b</li> <li><code>PreFilter</code>\u63d2\u4ef6\u8fd4\u56de Skip\uff0c\u4f7f\u5f97 <code>Filter</code>\u63d2\u4ef6/<code>PreFilterExtensions</code>\u5c06\u4f1a\u88ab\u8df3\u8fc7\uff1b</li> <li><code>PreScore</code>\u63d2\u4ef6\u8fd4\u56deSkip\uff0c\u4f7f\u5f97<code>Score</code>\u63d2\u4ef6\u8df3\u8fc7\uff1b</li> </ul>"},{"location":"cloud/k8s/scheduler_plugin.html#plugin-interface","title":"Plugin Interface","text":"<p>\u63a5\u53e3\u5b9a\u4e49 interface</p> <p>Scheduling Cycle</p> <ul> <li><code>QueueSortPlugin</code>\uff1a\u5bf9 scheduling queue \u4e2d\u7684 pod \u6392\u5e8f\uff0c\u4e00\u6b21\u53ea\u80fd\u542f\u7528\u4e00\u4e2a\u961f\u5217\u6392\u5e8f\u63d2\u4ef6\uff08\u5177\u4f53\u914d\u7f6e\u89c1\u4e0b\u9762\u914d\u7f6e\u6587\u4ef6\u7ae0\u8282\u5185\u5bb9\uff09</li> </ul> <pre><code>// Less are used to sort pods in the scheduling queue.\nLess(*QueuedPodInfo, *QueuedPodInfo) bool\n</code></pre> <ul> <li><code>PreFilterPlugin</code>\uff1a\u4e0d\u542b\u8282\u70b9\u4fe1\u606f\uff0c\u5728\u8fc7\u6ee4\u4e4b\u524d\u9884\u5904\u7406\u6216\u68c0\u67e5 Pod \u6216\u96c6\u7fa4\u7684\u4fe1\u606f\u3002 \u5b83\u4eec\u53ef\u4ee5\u5c06 Pod \u6807\u8bb0\u4e3a\u4e0d\u53ef\u8c03\u5ea6\u3002</li> </ul> <pre><code>// \u53ef\u4ee5\u8fd4\u56de PreFilterResult to influence which nodes to evaluate downstream\nPreFilter(ctx context.Context, state *CycleState, p *v1.Pod) (*PreFilterResult, *Status)\n// called after PreFilter(TODO ? how to use ?)\nPreFilterExtensions() PreFilterExtensions\n</code></pre> <ul> <li><code>FilterPlugin</code>\uff1a\u542b\u8282\u70b9\u4fe1\u606f\uff0c\u8fc7\u6ee4\u4e0d\u80fd\u8fd0\u884c Pod \u7684\u8282\u70b9\u3002 \u8fc7\u6ee4\u5668\u7684\u8c03\u7528\u987a\u5e8f\u662f\u53ef\u914d\u7f6e\u7684</li> </ul> <pre><code>// return \"Success\" to declare that the given node fits the pod\nFilter(ctx context.Context, state *CycleState, pod *v1.Pod, nodeInfo *NodeInfo) *Status\n</code></pre> <ul> <li> <p><code>PostFilterPlugin</code>\uff1a\u5f53 pod \u4e0d\u80fd\u88ab\u8c03\u5ea6\u65f6\uff0c\u88ab\u8c03\u7528\uff1b</p> </li> <li> <p><code>ReservePlugin</code>\uff1a\u4fe1\u606f\u6269\u5c55\u70b9\uff0c\u5f53\u8d44\u6e90\u5df2\u7ecf\u9884\u7559\u7ed9 Pod \u65f6\uff0c\u4f1a\u901a\u77e5\u63d2\u4ef6\u3002 \u8fd9\u4e9b\u63d2\u4ef6\u8fd8\u5b9e\u73b0\u4e86 <code>Unreserve</code> \u63a5\u53e3\uff0c\u5728 <code>Reserve</code> \u671f\u95f4\u6216\u4e4b\u540e\u51fa\u73b0\u6545\u969c\u65f6\u8c03\u7528\u3002</p> </li> </ul> <pre><code>// called when the scheduler cache is updated. If return failed status, the scheduler will call the Unreserve method for all enabled ReservePlugins\nReserve(ctx context.Context, state *CycleState, p *v1.Pod, nodeName string) *Status\n// called by the scheduling framework when a reserved pod was rejected ...\nUnreserve(ctx context.Context, state *CycleState, p *v1.Pod, nodeName string)\n</code></pre> <ul> <li> <p><code>PermitPlugin</code>\uff1a\u4e0d\u6ee1\u8db3\u6761\u4ef6\u65f6\uff0c\u8fd4\u56de WAIT \u72b6\u6001\uff08\u7b49\u5f85\u591a\u4e45\u540e\u91cd\u65b0\u8c03\u5ea6\uff09\uff0c\u7528\u4e8eGang/Co-Scheduler\u573a\u666f\uff1b</p> </li> <li> <p>\u8fd4\u56de WAIT \u72b6\u6001\uff0c\u8be5 Pod \u4f1a\u88ab\u8bb0\u5f55\u5230waitingPods\u4e2d\u4fdd\u5b58\uff1b</p> </li> <li> <p>\u901a\u8fc7 <code>IterateOverWaitingPods</code> \u65b9\u6cd5\u5bf9\u6240\u6709\u7684 waitingPod \u8c03\u7528 <code>waitingPod.Allow(cs.Name())</code>\u65b9\u6cd5\uff08\u53d1\u9001chan\uff09\uff0c\u5141\u8bb8\u8c03\u5ea6\uff0c\u4e0d\u518d\u7b49\u5f85\uff1b</p> </li> <li> <p><code>WaitOnPermit</code>\u5728 bind \u9636\u6bb5\u8c03\u7528\uff0c\u4f1a\u7b49\u5f85 waitPod \u7684 chan\uff0c\u4ecewaitingPods\u4e2d\u5220\u9664\uff1b</p> </li> </ul> <pre><code>Permit(ctx context.Context, state *CycleState, p *v1.Pod, nodeName string) (*Status, time.Duration)\n</code></pre> <ul> <li>\u76f8\u5173\u7684 Score \u63d2\u4ef6\uff0c\u7528\u4e8e\u4ece\u4e00\u5806\u8282\u70b9\u4e2d\u9009\u53d6\u6700\u5408\u9002\u7684\u8282\u70b9\u8c03\u5ea6 Pod\uff1b</li> </ul> <p>Binding Cycle</p> <ul> <li> <p><code>PreBindPlugin</code>\uff1a\u63d2\u4ef6\u5728 Pod \u7ed1\u5b9a\u8282\u70b9\u4e4b\u524d\u6267\u884c</p> </li> <li> <p><code>BingPlugin</code>\uff1a\u5c06 Pod \u4e0e\u8282\u70b9\u7ed1\u5b9a\u3002<code>bind</code> \u63d2\u4ef6\u662f\u6309\u987a\u5e8f\u8c03\u7528\u7684\uff0c\u53ea\u8981\u6709\u4e00\u4e2a\u63d2\u4ef6\u5b8c\u6210\u4e86\u7ed1\u5b9a\uff0c\u5176\u4f59\u63d2\u4ef6\u90fd\u4f1a\u8df3\u8fc7</p> </li> <li> <p><code>PostBindPlugin</code>\uff1a\u4fe1\u606f\u6269\u5c55\u70b9\uff0c\u5728 Pod \u7ed1\u5b9a\u4e86\u8282\u70b9\u4e4b\u540e\u8c03\u7528\u3002</p> </li> </ul>"},{"location":"cloud/k8s/scheduler_plugin.html#_2","title":"\u81ea\u5b9a\u4e49\u63d2\u4ef6\u5b9e\u73b0","text":""},{"location":"cloud/k8s/scheduler_plugin.html#_3","title":"\u7f16\u5199\u63d2\u4ef6\u4ee3\u7801","text":"<p>\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u793a\u4f8b\uff1acoscheduler plugin code</p> <p>\u7f16\u5199plugin\u4ee3\u7801\u4e3b\u8981\u5206\u4e3a\u4e09\u4e2a\u6b65\u9aa4\uff1a</p> <ul> <li>\u7f16\u5199plugin\u7684\u4e3b\u903b\u8f91</li> <li>\u7f16\u5199plugin\u7684\u6ce8\u518c\u903b\u8f91</li> <li>\u7f16\u5199plugin\u7684\u914d\u7f6e\u6587\u4ef6\uff1aKubeSchedulerConfiguration</li> </ul>"},{"location":"cloud/k8s/scheduler_plugin.html#_4","title":"\u8c03\u5ea6\u5668\u914d\u7f6e","text":"<p><code>scheduler-config.yaml</code>\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\uff08\u793a\u4f8b coscheduling \u63d2\u4ef6\uff09</p> <pre><code>apiVersion: kubescheduler.config.k8s.io/v1beta2\nkind: KubeSchedulerConfiguration\nleaderElection:\n  # \u4f7f\u80fdLeader\u9009\u4e3e\n  leaderElect: true\nclientConnection:\n  # \u6307\u5b9a\u4e86kubeconfig\u6587\u4ef6\u8def\u5f84\n  kubeconfig: /etc/kubernetes/scheduler.conf\nprofiles:\n# \u9ed8\u8ba4\u8c03\u5ea6\u5668\uff0c\u542f\u52a8\u5982\u4e0b\u5185\u5bb9\n- schedulerName: default-scheduler\n  plugins:\n    # Required\uff0c\u542f\u7528 Coscheduling \u7684\u961f\u5217\u4e2d pod \u7684\u6392\u5e8f\u7b97\u6cd5\uff0c\u53ea\u80fd\u6709\u4e00\u79cd\u7b97\u6cd5\u5b9e\u73b0\n    queueSort:\n      enabled:\n      - name: Coscheduling\n      disabled:\n      - name: \"*\"\n    preFilter:\n      enabled:\n      - name: Coscheduling\n    postFilter:\n      enabled:\n      - name: Coscheduling\n    # Required\n    permit:\n      enabled:\n      - name: Coscheduling\n    # Required\uff0c\n    reserve:\n      enabled:\n      - name: Coscheduling\n  # \u63d2\u4ef6\u7684\u914d\u7f6e\n  pluginConfig:\n  - name: Coscheduling\n    args:\n      permitWaitingTimeSeconds: 10\n      deniedPGExpirationTimeSeconds: 3\n</code></pre>"},{"location":"cloud/k8s/scheduler_plugin.html#_5","title":"\u672c\u5730\u8c03\u8bd5","text":"<p>\u672c\u5730\u542f\u52a8\u8c03\u5ea6\u5668\u8fdb\u884c\u6d4b\u8bd5\uff0c\u542f\u52a8\u811a\u672c\u5982\u4e0b\u6240\u793a\uff1a</p> <ul> <li><code>/etc/kubernetes/scheduler-conf</code> \u4e3a\u8fde\u63a5Kubernetes\u4f7f\u7528\u7684config\u6587\u4ef6</li> <li><code>/etc/kubernetes/scheduler-config.yaml</code> \u4e3a\u4e0a\u4e00\u8282\u7f16\u5199\u7684\u914d\u7f6e\u6587\u4ef6</li> </ul> <pre><code>go run  cmd/scheduler/main.go  \\\n --kube-api-qps=200 \\\n --kube-api-burst=300 \\\n --leader-elect=false \\\n --profiling=false \\\n --authentication-kubeconfig=/etc/kubernetes/scheduler-conf \\\n --authorization-kubeconfig=/etc/kubernetes/scheduler-conf  \\\n --kubeconfig=/etc/kubernetes/scheduler-conf  \\\n --config=/etc/kubernetes/scheduler-config.yaml \\\n --v=5\n</code></pre> <p>Pod \u9700\u8981\u914d\u7f6e <code>schedulerName</code></p>"},{"location":"cloud/k8s/scheduler_plugin.html#_6","title":"\u96c6\u7fa4\u90e8\u7f72\u4f7f\u7528","text":"<p>\u5982\u679c plugin \u5f15\u5165\u81ea\u5b9a\u4e49\u7684 CRD\uff0c\u5219\u9700\u8981\u5b89\u88c5\u76f8\u5173\u7684 controller \u548c rbac \u914d\u7f6e\u3002</p> <p>\u89c1\uff1ascheduler-plugins/doc/insall.md </p>"},{"location":"cloud/k8s/scheduler_plugin.html#kube-scheduler","title":"\u6784\u5efakube-scheduler \u955c\u50cf","text":"<pre><code>make build-scheduler.amd64\n</code></pre>"},{"location":"cloud/k8s/scheduler_plugin.html#schedulermaster","title":"\u5c06scheduler\u914d\u7f6e\u6587\u4ef6\u4f20\u9012\u5230master\u8282\u70b9","text":"<p>\u5c06scheduler\u7684\u914d\u7f6e\u6587\u4ef6 <code>scheduler-config.yaml</code> \u4f20\u9012\u5230master\u8282\u70b9\u7684<code>/etc/kubernetes</code> \u76ee\u5f55\u4e0b\u3002</p>"},{"location":"cloud/k8s/scheduler_plugin.html#masterkube-schedulerpod-yaml","title":"\u4fee\u6539master\u4e0akube-scheduler\u7684pod yaml","text":"<p>Kubernetes scheduler \u662f\u4ee5static pod\u7684\u5f62\u5f0f\u5728master\u8282\u70b9\u4e0a\u8fd0\u884c\u7684\uff0c\u56e0\u6b64\u53ea\u8981\u4fee\u6539\u5728<code>/etc/kubernetes/manifests/kube-scheduler.yaml</code>\uff0ckubelet\u5c31\u4f1a\u91cd\u65b0\u542f\u52a8kube-scheduler\u3002</p> <p>kube-scheduler.yaml \u7684\u4fee\u6539\u6d89\u53ca\u5230\u4e09\u5904\u5730\u65b9\uff1a</p> <ul> <li>kube-scheder\u542f\u52a8\u53c2\u6570\u4e2d\u6dfb\u52a0<code>--config</code> \u53c2\u6570\u6307\u5b9a<code>kube-scheduler.yaml</code></li> <li>\u6dfb\u52a0<code>hostPath volumes</code>\u5c06 <code>kube-scheduler.yaml</code> \u6620\u5c04\u5230\u5bb9\u5668\u4e2d</li> <li>\u66f4\u6539<code>kube-scheduler image</code>\u4e3a\u6211\u4eec\u7684\u65b0\u521b\u5efa\u7684image</li> </ul> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  creationTimestamp: null\n  labels:\n    component: kube-scheduler\n    tier: control-plane\n  name: kube-scheduler\n  namespace: kube-system\nspec:\n  containers:\n  - command:\n    - kube-scheduler\n    - --authentication-kubeconfig=/etc/kubernetes/scheduler.conf\n    - --authorization-kubeconfig=/etc/kubernetes/scheduler.conf\n    - --bind-address=127.0.0.1\n    - --feature-gates=IPv6DualStack=true\n    - --port=0\n    - --profiling=false\n    # \u8fd9\u4e24\u4e2a\u914d\u7f6e\u53ef\u80fd\u9700\u8981\u53bb\u6389\uff0c\u56e0\u4e3ascheduler-config.yaml\u53ef\u80fd\u4f1a\u914d\u7f6e leader-elect \u548c kube config \u4fe1\u606f\n    # - --kubeconfig=/etc/kubernetes/scheduler.conf\n    # - --leader-elect=true\n    # 1. \u6307\u5b9akube-scheduler.yaml\n    - --config=/etc/kubernetes/scheduler-config.yaml\n    # 2. \u66f4\u6539\u955c\u50cf\n    image: tingshuai.yts/kubernetes/scheduler:v20220822-v0.0.1\n    imagePullPolicy: IfNotPresent\n    livenessProbe:\n      failureThreshold: 7\n      httpGet:\n        host: 127.0.0.1\n        path: /healthz\n        port: 10259\n        scheme: HTTPS\n      initialDelaySeconds: 10\n      periodSeconds: 10\n      timeoutSeconds: 15\n    name: kube-scheduler\n    resources:\n      requests:\n        cpu: 100m\n    startupProbe:\n      failureThreshold: 24\n      httpGet:\n        host: 127.0.0.1\n        path: /healthz\n        port: 10259\n        scheme: HTTPS\n      initialDelaySeconds: 10\n      periodSeconds: 10\n      timeoutSeconds: 15\n    volumeMounts:\n    - mountPath: /etc/kubernetes/scheduler.conf\n      name: kubeconfig\n      readOnly: true\n    # 3. \u6dfb\u52a0hostPath volumes\n    - mountPath: /etc/kubernetes/scheduler-config.yaml\n      name: scheduler-config\n      readOnly: true\n    - mountPath: /etc/localtime\n      name: localtime\n  hostNetwork: true\n  priorityClassName: system-node-critical\n  securityContext:\n    seccompProfile:\n      type: RuntimeDefault\n  volumes:\n  - hostPath:\n      path: /etc/kubernetes/scheduler.conf\n      type: FileOrCreate\n    name: kubeconfig\n  # 3. \u6dfb\u52a0hostPath volumes\n  - hostPath:\n      path: /etc/kubernetes/scheduler-config.yaml\n      type: FileOrCreate\n    name: scheduler-config\n  - hostPath:\n      path: /etc/localtime\n      type: \"\"\n    name: localtime\n</code></pre>"},{"location":"cloud/k8s/scheduler_plugin.html#scheduler","title":"\u5355 Scheduler \u591a\u914d\u7f6e\u6587\u4ef6","text":"<p>\u6240\u6709profile\u5fc5\u987b\u5728 <code>queueSort</code> \u6269\u5c55\u70b9\u4f7f\u7528\u76f8\u540c\u7684\u63d2\u4ef6\uff0c\u5e76\u5177\u6709\u76f8\u540c\u7684\u914d\u7f6e\u53c2\u6570\uff08\u5982\u679c\u9002\u7528\uff09\u3002 \u8fd9\u662f\u56e0\u4e3a\u8c03\u5ea6\u5668\u53ea\u6709\u4e00\u4e2a\u4fdd\u5b58 pending \u72b6\u6001 Pod \u7684\u961f\u5217\u3002</p> <p>\u53ef\u4ee5\u914d\u7f6e <code>kube-scheduler</code> \u8fd0\u884c\u591a\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u5373\u540c\u4e00\u4e2a<code>KubeSchedulerConfiguration</code>\u7684<code>profiles</code> \u6709\u591a\u4e2a<code>schedulerName</code></p> <p>\u793a\u4f8b\uff1a\u8c03\u5ea6\u5668\u5c06\u8fd0\u884c\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\uff1a\u4e00\u4e2a\u4f7f\u7528\u9ed8\u8ba4\u63d2\u4ef6\uff0c\u53e6\u4e00\u4e2a\u7981\u7528\u6240\u6709\u6253\u5206\u63d2\u4ef6\u3002</p> <pre><code>apiVersion: kubescheduler.config.k8s.io/v1\nkind: KubeSchedulerConfiguration\nprofiles:\n  - schedulerName: default-scheduler\n  - schedulerName: no-scoring-scheduler\n    plugins:\n      preScore:\n        disabled:\n        - name: '*'\n      score:\n        disabled:\n        - name: '*'\n</code></pre>"},{"location":"cloud/k8s/scheduler_plugin.html#schduler","title":"\u591aSchduler\u6a21\u5f0f","text":"<p><code>Kubernetes</code> \u5141\u8bb8\u5728\u4e00\u4e2a\u96c6\u7fa4\u4e2d\u8fd0\u884c\u591a\u4e2a\u8c03\u5ea6\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u544a\u8bc9 Kubernetes \u4e3a\u6bcf\u4e2a Pod \u4f7f\u7528\u54ea\u4e2a\u8c03\u5ea6\u5668\u3002</p> <ul> <li>\u793a\u4f8b</li> </ul> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: no-annotation\n  labels:\n    name: multischeduler-example\nspec:\n  # \u672a\u63d0\u4f9b\u8c03\u5ea6\u5668\u540d\u79f0\uff0c\u5219\u4f1a\u4f7f\u7528 default-scheduler \u81ea\u52a8\u8c03\u5ea6 pod\n  schedulerName: my-scheduler\n  containers:\n  - name: pod-with-no-annotation-container\n    image: registry.k8s.io/pause:2.0\n</code></pre>"},{"location":"cloud/k8s/scheduler_plugin.html#_7","title":"\u4e09\u65b9\u8c03\u5ea6\u5668","text":"<p>Volcano\uff1a\u57fa\u4e8e kube-batch</p> <p>kueue\uff1akubernetes \u5b98\u65b9\u7ef4\u62a4\u7684\u961f\u5217\u7cfb\u7edf</p> <p>Yunikorn\uff1aApache Yunikorn</p>"},{"location":"cloud/k8s/ui_manager.html","title":"UI\u548c\u7ba1\u7406","text":""},{"location":"cloud/k8s/ui_manager.html#dashborad","title":"Dashborad","text":""},{"location":"cloud/k8s/ui_manager.html#_1","title":"\u90e8\u7f72","text":"<p>\u6d89\u53ca\u5230\u7684\u56fd\u5916\u955c\u50cf\uff0c\u5982\u679c\u65e0\u6cd5\u8bbf\u95ee\uff0c\u4e0b\u8f7d\u4e0b\u6765\u4e4b\u540e\uff0c\u6539\u955c\u50cf\u5730\u5740\u3002</p> <pre><code># \u6dfb\u52a0\u5728\u7ebf Helm Repo\uff0c\u6216\u8005\u4e0b\u8f7d Helm \u5305 https://github.com/kubernetes/dashboard/releases\nhelm repo add kubernetes-dashboard https://kubernetes.github.io/dashboard/\n\n# Deploy a Helm Release named \"kubernetes-dashboard\" using the kubernetes-dashboard chart\nhelm upgrade --install kubernetes-dashboard kubernetes-dashboard/kubernetes-dashboard --create-namespace --namespace kubernetes-dashboard\n\n# helm upgrade --install kubernetes-dashboard kubernetes-dashboard-XX --create-namespace --namespace kubernetes-dashboard\n\n# \u67e5\u770b\nkubectl get pods -n kubernetes-dashboard\n</code></pre>"},{"location":"cloud/k8s/ui_manager.html#_2","title":"\u4f7f\u7528","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cDashboard \u4f1a\u4f7f\u7528\u6700\u5c11\u7684 RBAC \u914d\u7f6e\u8fdb\u884c\u90e8\u7f72\u3002 </p> <ul> <li>\u4f7f\u7528 ClusterIP\uff0c\u5916\u90e8\u65e0\u6cd5\u8bbf\u95ee\uff1b</li> <li>\u9ed8\u8ba4\u7684 kubernetes-dashboard \u7684 ServiceAccount \u7684\u6743\u9650\u4e0d\u591f\uff0c\u754c\u9762\u6570\u636e\u6ca1\u6709\u6743\u9650\u3002</li> </ul> <pre><code># \u914d\u7f6e\u4ee3\u7406\uff0c\u63a5\u53d7\u6240\u6709\u5730\u5740\u7684\u8bbf\u95ee\nkubectl  proxy --address=\"172.16.2.131\" --port=8001 --accept-hosts=\"^.*\"\n\n# \u67e5\u770bkubernetes-dashboard\u7684token\nkubectl -n kubernetes-dashboard describe secret $(kubectl -n kubernetes-dashboard get secret | grep kubernetes-dashboard | awk '{print $1}')\n</code></pre> <p>kubernetes-dashboard \u540d\u7a7a\u95f4\u4e0b\uff0c\u521b\u5efa admin-user \u7684 Service Account\uff0c\u5e76\u7ed1\u5b9a cluster-admin \u7684\u89d2\u8272\u3002</p> <ul> <li>yaml \u5b9a\u4e49\u5982\u4e0b</li> </ul> <pre><code>cat &gt; dashboard-adminuser.yaml &lt;&lt; EOF\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: admin-user\n  namespace: kubernetes-dashboard\n\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: admin-user\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: cluster-admin\nsubjects:\n- kind: ServiceAccount\n  name: admin-user\n  namespace: kubernetes-dashboard  \nEOF\n</code></pre> <p>\u6267\u884c\u547d\u4ee4\uff0c\u521b\u5efa\u89d2\u8272\uff0c\u83b7\u53d6 token\u3002</p> <pre><code># \u521b\u5efa\u4e86\u4e00\u4e2a\u53eb admin-user \u7684\u670d\u52a1\u8d26\u53f7\uff0c\u5e76\u653e\u5728kubernetes-dashboard \u547d\u540d\u7a7a\u95f4\u4e0b\uff0c\u5e76\u5c06 cluster-admin \u89d2\u8272\u7ed1\u5b9a\u5230admin-user\u8d26\u6237\uff0c\u8fd9\u6837admin-user\u8d26\u6237\u5c31\u6709\u4e86\u7ba1\u7406\u5458\u7684\u6743\u9650\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0ckubeadm\u521b\u5efa\u96c6\u7fa4\u65f6\u5df2\u7ecf\u521b\u5efa\u4e86cluster-admin\u89d2\u8272\uff0c\u6211\u4eec\u76f4\u63a5\u7ed1\u5b9a\u5373\u53ef\u3002\nkubectl apply -f dashboard-adminuser.yaml\n# \u67e5\u770badmin-user\u8d26\u6237\u7684token\nkubectl -n kubernetes-dashboard describe secret $(kubectl -n kubernetes-dashboard get secret | grep admin-user | awk '{print $1}')\n</code></pre>"},{"location":"cloud/k8s/ui_manager.html#kubesphere","title":"KubeSphere","text":"<p>kubesphere 4.x \u4ee5\u540e\u7684\u7248\u672c\u5546\u7528\u53d7\u9650\u3002</p> <p>KubeSphere \u662f\u5728 Kubernetes\u4e4b\u4e0a\u6784\u5efa\u7684\u9762\u5411\u4e91\u539f\u751f\u5e94\u7528\u7684 \u5bb9\u5668\u6df7\u5408\u4e91\uff0c\u652f\u6301\u591a\u4e91\u4e0e\u591a\u96c6\u7fa4\u7ba1\u7406\uff0c\u63d0\u4f9b\u5168\u6808\u7684 IT \u81ea\u52a8\u5316\u8fd0\u7ef4\u7684\u80fd\u529b\uff0c\u7b80\u5316\u4f01\u4e1a\u7684 DevOps \u5de5\u4f5c\u6d41\u3002</p> \u5de5\u4f5c\u53f0 \u9879\u76ee\u8d44\u6e90 CI/CD \u6d41\u6c34\u7ebf \u5e94\u7528\u5546\u5e97"},{"location":"cloud/k8s/ui_manager.html#_3","title":"\u67b6\u6784","text":""},{"location":"cloud/k8s/ui_manager.html#_4","title":"\u90e8\u7f72\u4f7f\u7528","text":"<p>\u5feb\u901f\u5165\u95e8</p>"},{"location":"cloud/k8s/ui_manager.html#rancher","title":"Rancher","text":"<p>Rancher\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5bb9\u5668\u7ba1\u7406\u5e73\u53f0\uff0c\u4e3a\u5728\u751f\u4ea7\u4e2d\u90e8\u7f72\u5bb9\u5668\u7684\u7ec4\u7ec7\u6784\u5efa\u3002Rancher\u53ef\u4ee5\u8f7b\u677e\u5730\u5728\u4efb\u4f55\u5730\u65b9\u8fd0\u884cKubernetes\uff0c\u6ee1\u8db3IT\u9700\u6c42\uff0c\u5e76\u4e3aDevOps\u56e2\u961f\u63d0\u4f9b\u652f\u6301\u3002</p>"},{"location":"cloud/k8s/ui_manager.html#_5","title":"\u67b6\u6784","text":""},{"location":"cloud/k8s/ui_manager.html#_6","title":"\u5b89\u88c5","text":"<p>\u9ad8\u53ef\u7528\u5b89\u88c5\u6307\u5357 | Rancher\u6587\u6863</p>"},{"location":"cloud/k8s/webhook.html","title":"Webhook","text":"<p>Webhook \u9ed8\u8ba4\u6309\u7167\u5b57\u6bcd\u5e8f\u8fdb\u884c\u5404\u4e2a Webhook \u7684\u8c03\u7528\u3002</p> <p>k8s apiserver \u5728\u5904\u7406\u6bcf\u4e00\u4e2a\u64cd\u4f5c\u8d44\u6e90\u5bf9\u8c61\u7684\u8bf7\u6c42\u65f6\uff0c\u5728\u7ecf\u8fc7\u8ba4\u8bc1\uff08\u662f\u5426\u4e3a\u5408\u6cd5\u7528\u6237\uff09/ \u9274\u6743\uff08\u7528\u6237\u662f\u5426\u62e5\u6709\u6743\u9650\uff09\u540e\uff0c\u5e76\u4e0d\u4f1a\u76f4\u63a5\u6839\u636e\u7aef\u70b9\u8d44\u6e90\u7c7b\u578b\u548c rest \u52a8\u4f5c\u76f4\u63a5\u6267\u884c\u64cd\u4f5c\uff0c\u5728\u8fd9\u4e2d\u95f4\uff0c\u8bf7\u6c42\u4f1a\u88ab\u4e00\u7cfb\u5217\u51c6\u5165\u63a7\u5236\u5668\u63d2\u4ef6\uff08Admission Controller\uff09\u8fdb\u884c\u62e6\u622a\uff0c\u6821\u9a8c\u5176\u662f\u5426\u5408\u4e4e\u8981\u6c42\uff0c\u4ea6\u6216\u662f\u5bf9\u7279\u5b9a\u8d44\u6e90\u8fdb\u884c\u914d\u7f6e\u3002</p>"},{"location":"cloud/k8s/webhook.html#_1","title":"\u51c6\u5165\u673a\u5236","text":"<ul> <li>\u5982\u679c\u6240\u6709\u7684 webhooks \u6279\u51c6\u8bf7\u6c42\uff0c\u51c6\u5165\u63a7\u5236\u94fe\u7ee7\u7eed\u6d41\u8f6c\uff1b</li> <li>\u5982\u679c\u6709\u4efb\u610f\u4e00\u4e2a webhooks \u963b\u6b62\u8bf7\u6c42\uff0c\u90a3\u4e48\u51c6\u5165\u63a7\u5236\u8bf7\u6c42\u7ec8\u6b62\uff0c\u5e76\u8fd4\u56de\u7b2c\u4e00\u4e2a webhook \u963b\u6b62\u7684\u539f\u56e0\u3002\u5176\u4e2d\uff0c\u591a\u4e2a webhooks \u963b\u6b62\u4e5f\u53ea\u4f1a\u8fd4\u56de\u7b2c\u4e00\u4e2a webhook \u963b\u6b62\u7684\u539f\u56e0\uff1b</li> <li>\u5982\u679c\u5728\u8c03\u7528 webhook \u8fc7\u7a0b\u4e2d\u53d1\u751f\u9519\u8bef\uff0c\u90a3\u4e48\u8bf7\u6c42\u4f1a\u88ab\u7ec8\u6b62\u6216\u8005\u5ffd\u7565 webhook</li> </ul>"},{"location":"cloud/k8s/webhook.html#_2","title":"\u51c6\u5165\u63a7\u5236\u5668\u7c7b\u578b","text":"<ol> <li>\u53d8\u66f4 (Mutating)\uff1a\u89e3\u6790\u8bf7\u6c42\u5e76\u5728\u8bf7\u6c42\u5411\u4e0b\u53d1\u9001\u4e4b\u524d\u5bf9\u8bf7\u6c42\u8fdb\u884c\u66f4\u6539\uff1b\u7b2c\u4e00\u9636\u6bb5</li> <li>\u9a8c\u8bc1 (Validating)\uff1a\u89e3\u6790\u8bf7\u6c42\u5e76\u6839\u636e\u7279\u5b9a\u6570\u636e\u8fdb\u884c\u9a8c\u8bc1\uff1b\u7b2c\u4e8c\u9636\u6bb5</li> </ol>"},{"location":"cloud/k8s/webhook.html#_3","title":"\u52a8\u6001\u51c6\u5165\u63a7\u5236","text":"<p>\u4ee5 Webhook \u7684\u5f62\u5f0f\u53bb\u7f16\u5199\u81ea\u5b9a\u4e49\u7684\u51c6\u5165\u63a7\u5236\u5668\uff0c\u5bf9\u7279\u5b9a\u8d44\u6e90\u7684\u8bf7\u6c42\u8fdb\u884c\u5b9a\u5236\u4fee\u6539\u548c\u9a8c\u8bc1\uff0c\u5178\u578b\u7684\u573a\u666f\u6709\u901a\u8fc7 mutating \u7c7b\u578b Webhook \u6ce8\u5165 side-car \u5230 pod\u3002</p> <p>\u4ee5 kubebuilder \u811a\u624b\u67b6\u4e3a\u4f8b\uff0c\u5b9e\u73b0<code>Handler</code>\u63a5\u53e3<code>Handle(context.Context, Request) Response</code></p> <pre><code>import (\n    \"github.com/go-logr/logr\"\n    \"sigs.k8s.io/controller-runtime/pkg/client\"\n    \"sigs.k8s.io/controller-runtime/pkg/manager\"\n    \"sigs.k8s.io/controller-runtime/pkg/webhook\"\n)\n\n// \u5b9a\u4e49webhook\u7684path\u548c\u5904\u7406\u7684\u8d44\u6e90\uff0c\u9488\u5bf9create\u548cupdate\u7684pods\n\n// +kubebuilder:webhook:path=/mutate-fluid-io-v1alpha1-schedulepod,mutating=true,failurePolicy=fail,sideEffects=None,admissionReviewVersions=v1;v1beta1,groups=\"\",resources=pods,verbs=create;update,versions=v1,name=schedulepod.fluid.io\nvar (\n    // HandlerMap contains admission webhook handlers\n    HandlerMap = map[string]common.AdmissionHandler{\n        common.WebhookSchedulePodPath: &amp;CreateUpdatePodForSchedulingHandler{},\n    }\n)\n\nfunc Register(mgr manager.Manager, client client.Client, log logr.Logger) {\n    server := mgr.GetWebhookServer()\n    for path, handler := range HandlerMap {\n        handler.Setup(client)\n        // \u6ce8\u518c handler\n        server.Register(path, &amp;webhook.Admission{Handler: handler})\n        log.Info(\"Registered webhook handler\", \"path\", path)\n    }\n}\n</code></pre>"},{"location":"cloud/k8s/webhook.html#mutatingwebhookconfiguration","title":"MutatingWebhookConfiguration","text":"<p>Webhook \u9ed8\u8ba4\u6309\u7167\u5b57\u6bcd\u5e8f\u8fdb\u884c\u5404\u4e2a Webhook \u7684\u8c03\u7528\uff0c\u4e3a\u4e86\u4fdd\u8bc1 Webhook \u80fd\u591f\u5728\u6700\u540e\u4e00\u4e2a\u8c03\u7528\uff0c\u8bbe\u7f6e <code>reinvocationPolicy: IfNeeded</code>\uff08\u5728 Webhook \u9636\u6bb5\uff0c\u5982\u679c\u5728\u8c03\u7528\u540e\u5176\u88ab\u5176\u4ed6 Webhook \u4fee\u6539\uff0c\u5219\u518d\u6b21\u8c03\u7528\u8be5 Webhook\uff09\u5373\u53ef\u3002</p> <p>\u793a\u4f8b</p> <pre><code>apiVersion: admissionregistration.k8s.io/v1\nkind: MutatingWebhookConfiguration\nmetadata:\n  name: fluid-pod-admission-webhook\nwebhooks:\n  - name: schedulepod.fluid.io\n    rules:\n      - apiGroups:   [\"\"]\n        apiVersions: [\"v1\"]\n        operations:  [\"CREATE\",\"UPDATE\"]\n        resources:   [\"pods\"]\n    clientConfig:\n      service:\n        namespace: fluid-system\n        name: fluid-pod-admission-webhook\n        path: \"/mutate-fluid-io-v1alpha1-schedulepod\"\n        port: 9443\n      caBundle: Cg==\n    timeoutSeconds: 20\n    failurePolicy: Fail\n    sideEffects: None   # \u8bf4\u660e\u6b64 Webhook \u662f\u5426\u6709\u526f\u4f5c\u7528\n    admissionReviewVersions: [\"v1\",\"v1beta1\"]\n    reinvocationPolicy: Never #\u5728\u4e00\u6b21\u5f55\u53d6\u8bc4\u4f30\u4e2d\uff0cWebhook \u88ab\u8c03\u7528\u7684\u6b21\u6570\u4e0d\u4f1a\u8d85\u8fc7\u4e00\u6b21\n    namespaceSelector:\n      matchLabels:\n        fluid.io/enable-injection: \"true\"\n</code></pre>"},{"location":"cloud/projects/HAMi.html","title":"HAMI","text":"<p>Open, Device Virtualization, VGPU, Heterogeneous AI Computing</p> <p>\u5f02\u6784AI\u8ba1\u7b97\u865a\u62df\u5316\u4e2d\u95f4\u4ef6</p> <p></p>"},{"location":"cloud/projects/HAMi.html#_1","title":"\u67b6\u6784","text":"<p>\u6709\u4e09\u90e8\u5206\u7ec4\u6210\uff1a</p> <ul> <li>HAMi Scheduler\uff1a\u8c03\u5ea6\u5668\u6269\u5c55</li> <li>HAMi vGPU Device Plugin\uff1a\u8bbe\u5907\u63d2\u4ef6</li> <li>HAMi Core\uff1a\u5bb9\u5668\u5185\u8d44\u6e90\u63a7\u5236</li> </ul> <p></p>"},{"location":"cloud/projects/HAMi.html#hami-scheduler","title":"HAMi Scheduler","text":"<p><code>MutatingWebhook</code>\u8bc6\u522b\u7531 HAMi \u5904\u7406\u7684Pod\uff0c\u5c06 pod\u7684<code>scheduelrName</code>\u8bbe\u7f6e\u4e3a<code>HAMi-scheduler</code>\u3002</p> <p><code>HAMi Scheduler</code>\u8d1f\u8d23\u5c06\u4efb\u52a1\u5206\u914d\u7ed9\u9002\u5f53\u7684\u8282\u70b9\u548c\u8bbe\u5907\u3002\u540c\u65f6\uff0c\u8c03\u5ea6\u5668\u9700\u8981\u7ef4\u62a4\u5f02\u6784\u8ba1\u7b97\u8bbe\u5907\u7684\u5168\u5c40\u89c6\u56fe\u4ee5\u8fdb\u884c\u76d1\u89c6\u3002</p>"},{"location":"cloud/projects/HAMi.html#hamic-device-plugin","title":"HAMic Device Plugin","text":"<p>\u8bbe\u5907\u63d2\u4ef6\u5c42\u4ece\u4efb\u52a1\u7684\u6ce8\u91ca\u5b57\u6bb5\u4e2d\u83b7\u53d6\u8c03\u5ea6\u7ed3\u679c\uff0c\u5e76\u5c06\u76f8\u5e94\u7684\u8bbe\u5907\u6620\u5c04\u5230\u5bb9\u5668\u3002</p>"},{"location":"cloud/projects/HAMi.html#hami-core","title":"HAMi Core","text":"<p>HAMi \u5b9e\u73b0 GPU core \u548c memory \u9694\u79bb\u3001\u9650\u5236\u662f\u4f7f\u7528\u7684 vCUDA \u65b9\u6848\uff08Cuda API \u52ab\u6301\uff09\uff0c\u6d41\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>\u68c0\u6d4b\u5230 Pod \u4e2d\u4f7f\u7528\u7684\u5185\u5b58\u8d85\u8fc7\u4e86 Resource \u4e2d\u7684\u7533\u8bf7\u91cf\u5c31\u76f4\u63a5\u8fd4\u56de OOM\uff0c\u4ece\u800c\u5b9e\u73b0\u8d44\u6e90\u7684\u4e00\u4e2a\u9650\u5236\uff1b</li> <li>nvidia-smi \u547d\u4ee4\u67e5\u770b GPU \u4fe1\u606f\u65f6\uff0c\u4e5f\u53ea\u8fd4\u56de Pod Resource \u4e2d\u7533\u8bf7\u7684\u8d44\u6e90\uff0c\u8fd9\u6837\u5728\u67e5\u770b\u65f6\u4e5f\u8fdb\u884c\u9694\u79bb\u3002</li> </ul> <p></p>"},{"location":"cloud/projects/HAMi.html#_2","title":"\u4f7f\u7528","text":""},{"location":"cloud/projects/HAMi.html#_3","title":"\u793a\u4f8b","text":"<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: gpu-pod\nspec:\n  containers:\n    - name: ubuntu-container\n      image: ubuntu:18.04\n      command: [\"bash\", \"-c\", \"sleep 86400\"]\n      resources:\n        limits:\n          nvidia.com/gpu: 1 # \u8bf7\u6c421\u4e2avGPUs\n          nvidia.com/gpumem: 3000 # \u6bcf\u4e2avGPU\u7533\u8bf73000m\u663e\u5b58 \uff08\u53ef\u9009\uff0c\u6574\u6570\u7c7b\u578b\uff09\n          nvidia.com/gpucores: 30 # \u6bcf\u4e2avGPU\u7684\u7b97\u529b\u4e3a30%\u5b9e\u9645\u663e\u5361\u7684\u7b97\u529b \uff08\u53ef\u9009\uff0c\u6574\u6570\u7c7b\u578b\uff09\n</code></pre>"},{"location":"cloud/projects/HAMi.html#volcano","title":"\u8ddf Volcano \u96c6\u6210","text":"<p>How to use volcano vgpu | HAMi</p> <p>\u4f7f\u7528volcano-vgpu\u65f6\u4e0d\u9700\u8981\u5b89\u88c5HAMi\uff0c\u53ea\u9700\u4f7f\u7528 Volcano vgpu device-plugin \u3002\u5b83\u53ef\u4ee5\u4e3aVolcano\u7ba1\u7406\u7684NVIDIA\u8bbe\u5907\u63d0\u4f9b\u8bbe\u5907\u5171\u4eab\u673a\u5236\u3002</p>"},{"location":"cloud/projects/fluid.html","title":"Fluid","text":"<p>Fluid\u662f\u4e00\u4e2a\u5f00\u6e90\u7684Kubernetes\u539f\u751f\u7684\u5206\u5e03\u5f0f\u6570\u636e\u96c6\u7f16\u6392\u548c\u52a0\u901f\u5f15\u64ce\uff0c\u4e3b\u8981\u670d\u52a1\u4e8e\u4e91\u539f\u751f\u573a\u666f\u4e0b\u7684\u6570\u636e\u5bc6\u96c6\u578b\u5e94\u7528\uff0c\u4f8b\u5982\u5927\u6570\u636e\u5e94\u7528\u3001AI\u5e94\u7528\u7b49\u3002</p>"},{"location":"cloud/projects/fluid.html#_1","title":"\u573a\u666f","text":"<p>\u4e3b\u8981\u5173\u6ce8\u6570\u636e\u96c6\u7f16\u6392\u548c\u5e94\u7528\u7f16\u6392\u8fd9\u4e24\u4e2a\u91cd\u8981\u573a\u666f</p> <ul> <li>\u6570\u636e\u96c6\u7f16\u6392\u53ef\u4ee5\u5c06\u6307\u5b9a\u6570\u636e\u96c6\u7684\u6570\u636e\u7f13\u5b58\u5230\u6307\u5b9a\u7279\u6027\u7684Kubernetes\u8282\u70b9\uff1b</li> <li>\u800c\u5e94\u7528\u7f16\u6392\u5c06\u6307\u5b9a\u8be5\u5e94\u7528\u8c03\u5ea6\u5230\u53ef\u4ee5\u6216\u5df2\u7ecf\u5b58\u50a8\u4e86\u6307\u5b9a\u6570\u636e\u96c6\u7684\u8282\u70b9\u4e0a\uff1b</li> </ul>"},{"location":"cloud/projects/fluid.html#_2","title":"\u67b6\u6784","text":""},{"location":"cloud/projects/fluid.html#fluid-controller-manager","title":"\u63a7\u5236\u5668(Fluid-controller-manager)","text":"<p>\u903b\u8f91\u4e0a\u76f8\u5173\u7684\u4e00\u7ec4\u6570\u636e\u7684\u96c6\u5408</p>"},{"location":"cloud/projects/fluid.html#fluid-scheduler","title":"\u8c03\u5ea6\u5668(Fluid-scheduler)","text":"<p>\u652f\u6301\u6570\u636e\u96c6\u7684\u7ba1\u7406\u548c\u52a0\u901f</p>"},{"location":"cloud/projects/fluid.html#_3","title":"\u539f\u7406","text":""},{"location":"cloud/projects/fluid.html#_4","title":"\u539f\u7406\u548c\u6d41\u7a0b","text":"<ul> <li>DataSet\u58f0\u660e\u6570\u636e\u96c6\u7684\u6765\u6e90\uff0cRuntime\u9009\u62e9node\u6253\u6807\u7b7e\u7531K8s\u8fdb\u884cworker\u8c03\u5ea6\uff1b</li> <li>CSI-Plugin\u4f5c\u4e3aDeamonset\u6302\u8f7d\u5bbf\u4e3b\u673a\u7684<code>/runtime-mnt</code>\uff0c\u5f53Pod\u6302\u8f7dPVC\u65f6\uff0c\u5c06\u5bf9\u5e94\u7684<code>/runtime-mnt</code>\u7684\u5b50\u76ee\u5f55bind\u6302\u8f7d\u5230\u5bb9\u5668\uff1b</li> <li>APP Pod \u83b7\u53d6\u6570\u636e\u662f\uff0c\u4f1a\u89e6\u53d1\u5bbf\u4e3b\u673a<code>/runtime-mnt</code>\u7684\u6587\u4ef6\u64cd\u4f5c\uff0c\u89e6\u53d1FUSE\u5bb9\u5668\u901a\u8fc7Alluxio Worker\u4e2d\u83b7\u53d6\u6570\u636e\uff1b</li> <li>PVC\u7684\u6570\u636e\u8bfb\u53d6\u901a\u8fc7CSI-Plugin\u548cFUSE\u5b9e\u73b0\uff0cCSI-Plugin \u548c FUSE DaemonSet\u90fd\u6302\u8f7d\u5bbf\u4e3b\u673a\u7684\u76f8\u540c\u76ee\u5f55\uff08/runtime-mnt\uff09\uff1b</li> <li>FUSE DaemonSet\u7684\u672c\u5730\u6302\u8f7d\u76ee\u5f55\u4e3a<code>/runtime-mnt/alluxio/default/demo</code>\uff0c\u540e\u4e24\u4e2a\u4e3adataset  namespace\u548cname\uff1b</li> <li>Alluxio Worker \u6839\u636e DataSet \u4e2d\u58f0\u660e\u7684\u8fdc\u7a0b\u8def\u5f84\uff0c\u8fdb\u884c\u6570\u636e\u64cd\u4f5c\uff1b</li> <li>Pod\u9009\u5b9aRuntime\u7684\u8282\u70b9\uff0c\u901a\u8fc7webhook\u901a\u8fc7\u8282\u70b9\u4eb2\u548c\u6027\u8fdb\u884c\u5904\u7406\uff1b</li> </ul> <p>Alluxio Runtime\u4f1a\u521b\u5efa<code>**-config</code>\u5b58\u50a8Alluxio\u96c6\u7fa4\u7684\u76f8\u5173\u914d\u7f6e\u4fe1\u606f\uff0c\u4f9bFUSE\u4f7f\u7528\uff1b</p> <p>App Pod \u6307\u5b9a PVC\uff0cPV \u548c PVC \u7531\u5bf9\u5e94\u7684 Cache Runtime \u521b\u5efa\uff08\u901a\u8fc7\u6307\u5b9aLabel\uff08\u8ddfDataSet\u7684name/namespace\uff09\u8fdb\u884c\u7ed1\u5b9a\uff0cAnnotation\u5224\u65ad\u662f\u5426\u521b\u5efa\uff09\uff1b</p> <ul> <li>pv\u7684\u540d\u5b57\u7531dataset\u7684namespace-name\u6784\u6210\uff1b</li> <li>pvc\u7684name/namespace \u8ddf dataset\u4e00\u81f4\uff1b</li> </ul> <p>\u7ec6\u8282</p> <ul> <li>Cache Runtime\u7684master/worker\u7684\u8282\u70b9\u9009\u62e9\uff1b</li> <li>FUSE \u7684\u8282\u70b9\u9009\u62e9\uff1b</li> <li>\u5177\u5907CSI\u63d2\u4ef6\u7684\u8282\u70b9\uff1a\u901a\u8fc7<code>Node-Selector:  fluid.io/f-default-demo=true</code></li> <li> <p>Pod \u548c FUSE \u9700\u8981\u5728\u4e00\u4e2a\u8282\u70b9\uff0cCSI\u5c06\u672c\u5730\u7684\u5bf9\u5e94\u7684\u76ee\u5f55\u6302\u8f7d\u5230Pod\u4e2d\uff1b</p> </li> <li> <p>FUSE \u548c Worker \u4e0d\u9700\u8981\u5728\u4e00\u4e2a\u8282\u70b9\u4e0a\uff0c\u6839\u636eRuntime\u7684Global\u5b57\u6bb5\u8fdb\u884c\u8bbe\u7f6e\uff1f\uff1b</p> </li> </ul> <p>Runtime\u548cDataSet\u662f\u4e00\u5bf9\u4e00\u7684\u5173\u7cfb\uff0c\u901a\u8fc7name\u8fdb\u884c\u5173\u8054\uff01</p> <ul> <li>Alluxio Runtime worker \u6302\u6389\u65f6\uff0c\u5176\u5bbf\u4e3b\u673a\u7684\u7f13\u5b58(<code>/dev/shm</code>)\u4e0d\u4f1a\u88ab\u6e05\u7406\uff08\uff1f\u5982\u679cPod\u98d8\u9038\uff0c\u6570\u636e\u65e0\u6cd5\u5220\u9664\uff09</li> </ul>"},{"location":"cloud/projects/fluid.html#faq","title":"FAQ","text":"<p>Dataset \u652f\u6301 Spec\u5b57\u6bb5\u7684 update \u4e48\uff1f\uff08\u90e8\u5206\u652f\u6301\uff0c\u5982 AlluxioRuntime \u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u65b0\u589e WebUFS\uff09</p> <p>dataloader\u4e2dexecuting\u9636\u6bb5\uff0c\u5b9a\u65f620s\uff08\u5f88\u591a\u5904\uff09\u8fdb\u884c\u66f4\u65b0\uff1f</p> <p>AlluxioRuntime\u7533\u8bf7\u7684pod\uff08master\uff0cworker\uff0cfuse\uff09\u7684\u7f51\u7edc\u662fHostNetWork\uff0c\u610f\u4e49\u662f\u5565\uff1f\uff08\u4f7f\u7528\u5bbf\u4e3b\u673a\u7f51\u7edc\uff0c\u6027\u80fd\uff09</p> <p>Runtime\u521b\u5efa\u7684PV\u7684\u5927\u5c0f\uff0c\u5e38\u91cf100Gi\uff1f</p> <p>ObjectMeta\u7684Generation\u4e3a\u4ec0\u4e48\u88ab\u7528\u6765\u505aDataSetController\u7684AddFinalizer\u7684\u5224\u65ad\uff1f</p> <p>AssignNodesToCache \u6ca1\u6709\u8c03\u7528\u65b9\uff1f\uff08worker \u7684\u653e\u7f6e\u7531 k8s\u7684\u4eb2\u548c\u6027\u914d\u7f6e\uff09</p> <ul> <li>\u641c\u7d22\u8282\u70b9\u653e\u503cworker\uff0c\u73b0\u5728alluxio\u7684worker\u901a\u8fc7helm\u5b89\u88c5\u7684\uff0c\u8c03\u5ea6\u4fe1\u606f\u5728\u54ea\u91cc\uff1f</li> <li>\u8282\u70b9\u6253\u6807\u7b7e\uff0c\u901a\u8fc7Engine::SyncScheduleInfoToCacheNodes\u51fd\u6570\u8bbe\u7f6e\uff1b</li> </ul> <p>DataSet\u7684\u4eb2\u548c\u6027\u548cPod\u7684\u4eb2\u548c\u6027\u51b2\u7a81\u4e86\u600e\u4e48\u5904\u7406\uff1f</p> <ul> <li>DataSet\u7684\u4eb2\u548c\u6027\u5e94\u8be5\u4fdd\u8bc1\u548cPod\u4e00\u81f4\uff0c\u5373\u5c06Pod\u7684\u8282\u70b9\u4eb2\u548c\u6027\u914d\u7f6e\u5e94\u7528\u5230DataSet\u4e2d\uff1b</li> </ul>"},{"location":"cloud/projects/fluid.html#_5","title":"\u6570\u636e","text":""},{"location":"cloud/projects/fluid.html#dataset","title":"DataSet\uff08\u6570\u636e\u96c6\uff09","text":"<p>Dataset\u7684\u751f\u547d\u5468\u671f\u6d41\u7a0b\u5982\u56fe\u6240\u793a\uff1a</p> <p></p>"},{"location":"cloud/projects/fluid.html#spec","title":"Spec","text":"<ul> <li> <p><code>mounts</code>\uff1a\u5b9a\u4e49\u6765\u6e90\uff0c\u652f\u6301 https://, http://, local:// \u548c pvc:// \u7b49\uff08\u4f9d\u636e\u5e95\u5c42\u7684\u5b58\u50a8\uff09\uff1b</p> </li> <li> <p>\u652f\u6301\u591a\u4e2aMount\uff0c\u4f1a\u6839\u636e\u540d\u5b57\uff0c\u5efa\u7acb\u4e0d\u540c\u7684\u6587\u4ef6\u76ee\u5f55\uff1b</p> </li> <li> <p><code>owner</code>\uff1a\u5b9a\u4e49\u7528\u6237\uff0c\u8bbe\u7f6e\u6743\u9650\uff0cuid/gid\uff1b</p> </li> <li> <p><code>nodeAffinity</code>\uff1a\u7f13\u5b58\u7684\u8282\u70b9\u4eb2\u548c\u6027\uff08\u9650\u5236runtime\u7684worker\u7684\u8282\u70b9\u9009\u62e9\uff09\uff1b</p> </li> <li> <p><code>tolerations</code>\uff1apod's tolerations\uff1b</p> </li> <li> <p><code>accessModes</code>\uff1aArray\uff0c\"ReadWriteOnce\"\u3001\"ReadOnlyMany\"\u3001\"ReadWriteMany\"</p> </li> <li> <p><code>runtimes</code>\uff1a\u652f\u6301\u6570\u636e\u96c6\u7684\u8fd0\u884c\u65f6\uff0c\u5982AlluxioRuntimes\uff1b</p> </li> <li> <p><code>placement</code>\uff1a</p> </li> <li> <p><code>dataRestoreLocation</code>\uff1a\u52a0\u8f7dbackuped\u7684dataset\u7684\u8def\u5f84\uff1b</p> </li> <li> <p>\u6570\u636e\u96c6\u52a0\u8f7d\u65f6\uff0c\u5c06\u4e0d\u518d\u4eceUFS\u4e2d\u52a0\u8f7dmetadata\u5e76\u7edf\u8ba1UFS TOTAL SIZE\u7b49\u4fe1\u606f\uff0c\u800c\u662f\u4ece\u5907\u4efd\u6587\u4ef6\u4e2d\u6062\u590d</p> </li> <li> <p><code>mounts</code>\uff1a<code>path</code>\u5b57\u6bb5\u8868\u793a runtime \u7684mount\u8def\u5f84\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\u5219\u4e3a <code>/{name}</code></p> </li> <li> <p>\u4e0b\u4f8b\u4e2d\uff1a<code>alluxio mount fs</code>\u770b\u5230</p> <pre><code>https://mirrors.bit.edu.cn/apache/spark  on  /spark  (web, ...)\n/underFSStorage                          on  /       (local, ...)\n</code></pre> </li> <li> <p>\u5982\u679c\u6307\u5b9a <code>path='/'</code>\uff0c\u5219</p> <pre><code>https://mirrors.bit.edu.cn/apache/spark  on  /  (web ...)\n</code></pre> </li> <li> <p>\u5982\u679c\u6307\u5b9a<code>path='/for'</code>\uff0c\u5219</p> <pre><code>https://mirrors.bit.edu.cn/apache/spark  on  /for  (web, ...)\n/underFSStorage                          on  /       (local, ...)\n</code></pre> </li> </ul> <pre><code>apiVersion: data.fluid.io/v1alpha1\nkind: Dataset\nmetadata:\n  name: demo\nspec:\n  mounts:\n    - mountPoint: https://mirrors.bit.edu.cn/apache/spark/\n      name: spark\n---------------------------------------------------------------   \napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\n  labels:\n    fluid.io/dataset.fusedemo.sched: required\nspec:\n  containers:\n    - name: nginx\n      image: nginx\n      volumeMounts:\n        - mountPath: /datahbase\n          name: hbase-vol\n  volumes:\n    - name: hbase-vol\n      persistentVolumeClaim:\n        claimName: fusedemo\n</code></pre> <p>\u5bf9\u4e8enginx pod\uff0c\u5176<code>/datahbase</code>\u4e0b\u6709\u76ee\u5f55<code>/spark</code>\u3002</p>"},{"location":"cloud/projects/fluid.html#status","title":"Status","text":"<ul> <li><code>Runtimes</code>\uff1aArray\uff0c\u652f\u6301\u7684\u8fd0\u884c\u65f6</li> <li>Runtime\u548cDataSet\u5982\u4f55\u7ed1\u5b9a\u4e0a\uff1f</li> <li><code>Conditions</code>\uff1aArray\uff0c\u72b6\u6001\uff08\u5386\u53f2\uff09\u4fe1\u606f\uff0c\u5982Ready\u3001Updating\u3001Initialized\u7b49\uff1b</li> <li><code>DataLoadRef</code>\uff1a\u4f7f\u7528\u8be5\u6570\u636e\u96c6\u7684DataLoad\u6807\u8bc6\uff0c\u7528\u4f5c\u9501\uff1b\uff08\u53ea\u652f\u6301\u4e00\u4e2aDataLoad\uff09</li> <li><code>DataBackupRef</code>\uff1a\u4f7f\u7528\u8be5\u6570\u636e\u96c6\u7684DataBackup\u7684\u6807\u8bc6\uff1b</li> </ul>"},{"location":"cloud/projects/fluid.html#controller","title":"Controller","text":"<ul> <li>DataSet Kind\u7684\u7533\u8bf7\u3001\u5220\u9664\uff0cFinalizer\u7684\u6dfb\u52a0\u548c\u5220\u9664\uff1b</li> <li>Pod\u4f7f\u7528DataSet\uff0c\u5219\u4e0d\u80fd\u5220\u9664\uff08PVC\u5b58\u5728\u4e14Pod\u6b63\u5728\u4f7f\u7528\uff09\uff1b</li> <li>\u4ece<code>NoneDatasetPhase</code> \u9636\u6bb5\u8f6c\u6362\u5230 <code>NotBoundDatasetPhase</code>\uff1b</li> </ul>"},{"location":"cloud/projects/fluid.html#dataloader","title":"DataLoader\uff08\u6570\u636e\u9884\u52a0\u8f7d\uff09","text":"<p>DataLoader\u524d\u7f6e\uff1a\u521b\u5efaDataSet\u548cRuntime\uff0c\u901a\u8fc7\u521b\u5efaRuntime\u7684DataLoad Job\u5b9e\u73b0\u3002</p>"},{"location":"cloud/projects/fluid.html#spec_1","title":"Spec","text":"<ul> <li><code>dataset</code>\uff1a\u5b9a\u4e49\u76ee\u6807\u6570\u636e\u96c6\uff0c\u5f53\u524d\u53ea\u5141\u8bb8\u5728\u4e00\u4e2a\u540d\u7a7a\u95f4\u4e0b\uff1b</li> <li><code>loadMetadata</code>\uff1a\u6570\u636e\u52a0\u8f7d\u524d\u9996\u5148\u8fdb\u884c\u5143\u6570\u636e\u540c\u6b65\uff1b</li> <li><code>target</code>\uff1a\u52a0\u8f7d\u6307\u5b9a\u7684\u5b50\u76ee\u5f55(\u6216\u6587\u4ef6)\uff0c\u800c\u4e0d\u662f\u6574\u4e2a\u6570\u636e\u96c6\uff0c\u4ee5\u53ca\u526f\u672c\u6570\uff1b</li> <li> <p>path\uff1a\u52a0\u8f7d\u7684\u5b50\u76ee\u5f55\u6216\u6587\u4ef6</p> </li> <li> <p><code>options</code>\uff1a\u5176\u5b83\u5c5e\u6027\uff1b</p> </li> </ul>"},{"location":"cloud/projects/fluid.html#status_1","title":"Status","text":"<ul> <li><code>phase</code>\uff1a\u4efb\u52a1\u7684\u9636\u6bb5\uff0c\u5206\u4e3a\u201d\u201c\uff0c \"Pending\"\uff0c\"Executing\"\uff0c\"Complete\"\uff0c\"Failed\"\uff1b</li> <li>\u6b63\u5e38\u751f\u547d\u5468\u671f\uff1a\u201d\u201c -&gt; \"Pending\" -&gt; \"Executing\" -&gt; \"Complete\"</li> <li>Executing \u901a\u8fc7 Engine \u52a0\u8f7d\u6570\u636e\u96c6\uff0c\u901a\u8fc7 K8s Job \u8fdb\u884c\uff1b</li> <li><code>Conditions</code>\uff1aArray\uff0c\u72b6\u6001\uff08\u5386\u53f2\uff09\u4fe1\u606f\uff1b</li> <li><code>Duration</code>\uff1a\u52a0\u8f7d\u6570\u636e\u96c6\u7684\u65f6\u95f4\uff1b</li> </ul>"},{"location":"cloud/projects/fluid.html#controller_1","title":"Controller","text":"<ul> <li>DataSetLoader\uff08Finalizer\u5b57\u6bb5\uff09\u7684\u7533\u8bf7\u548c\u5220\u9664\uff1b</li> <li>DataSet \u83b7\u53d6\uff0cDataSet\u652f\u6301\u7684Runtime\u83b7\u53d6\uff0c\u521b\u5efa/\u83b7\u53d6/\u5220\u9664Engine\uff1b</li> <li>Runtime\u521b\u5efa\uff1acase \u8bed\u53e5\uff0c\u6269\u5c55\u9700\u8981\u6539\u6e90\u7801\uff1b</li> <li> <p>Engine\uff1aDataloader\u533f\u540d\u5b57\u6bb5\uff0c\u68c0\u67e5Runtime\u53ef\u7528\uff08CheckRuntimeReady\uff09\uff0c\u76ee\u6807\u8def\u5f84\u5b58\u5728\uff08CheckExistenceOfPath\uff09\uff0c\u52a0\u8f7d\u6570\u636e\uff08LoadData\uff09</p> </li> <li> <p>\u5bf9DataLoad\u6784\u5efaOwnerReference\u4e3a\u5bf9\u5e94\u7684DataSet\uff0cUID\u4e3aDataSet\u7684UID\uff08Meta\uff09\u4fe1\u606f\uff1b</p> </li> </ul>"},{"location":"cloud/projects/fluid.html#databackup","title":"DataBackup\uff08\u6570\u636e\u5907\u4efd\uff09","text":"<p>\u76ee\u524d\u652f\u6301\u4e24\u79cd\u6570\u636e\u7684\u5907\u4efd\uff1aAlluxio\u901a\u8fc7<code>alluxio fsadmin backup</code>\u5907\u4efd</p> <ul> <li>\u6570\u636e\u96c6\u7684metadata\uff0c\u5305\u62ec\u6587\u4ef6\u7cfb\u7edfmetadata\uff08\u4f8b\u5982\u6587\u4ef6\u7cfb\u7edfinode tree\uff09\u7b49</li> <li>\u6570\u636e\u96c6\u7684\u4e00\u4e9b\u5173\u952e\u7edf\u8ba1\u4fe1\u606f\uff0c\u5305\u62ec\u6570\u636e\u91cf\u5927\u5c0f\u548c\u6587\u4ef6\u6570\u91cf</li> </ul>"},{"location":"cloud/projects/fluid.html#spec_2","title":"Spec","text":""},{"location":"cloud/projects/fluid.html#status_2","title":"Status","text":"<ul> <li> <p><code>phase</code>\uff1a\u4efb\u52a1\u7684\u9636\u6bb5\uff0c\u5206\u4e3a\u201d\u201c\uff0c \"Pending\"\uff0c\"Executing\"\uff0c\"Complete\"\uff0c\"Failed\"\uff1b</p> </li> <li> <p>\u6b63\u5e38\u751f\u547d\u5468\u671f\uff1a\u201d\u201c -&gt; \"Pending\" -&gt; \"Executing\" -&gt; \"Complete\"</p> </li> <li> <p>Executing \u901a\u8fc7 Engine \u52a0\u8f7d\u6570\u636e\u96c6\uff0c\u901a\u8fc7 K8s Job \u8fdb\u884c\uff1b</p> </li> </ul>"},{"location":"cloud/projects/fluid.html#controller_2","title":"Controller","text":"<p>\u4fdd\u5b58metadata\uff08TODO\uff09</p> <p>Executing\u9636\u6bb5</p>"},{"location":"cloud/projects/fluid.html#_6","title":"\u8fd0\u884c\u65f6","text":"<p>node \u7684 labels\u7684\u521b\u5efa\u65f6\u673a\uff1aSync()\u51fd\u6570\u4f1a\u5b9a\u671f\u7684\u8fdb\u884c\u8bbe\u7f6e\uff0c\u5373\u4f7f\u4e0d\u521b\u5efaApp Pod\uff1b</p> <p>Setup\u65f6\uff0c\u521b\u5efaWorker\uff1a</p> <ul> <li><code>alluxio.node.go</code>\u4e2d<code>AssignNodesToCache</code>\u51fd\u6570\uff08\u5e9f\u5f03\u4e0d\u7528\uff09\uff0c\u5bfb\u627e node \u8fdb\u884c worker\u7684\u653e\u7f6e\uff08\u8003\u8651\u6570\u636e\u96c6\u7684\u4eb2\u548c\u6027\uff09\uff1b</li> <li><code>LabelCacheNode\u548cUnlabelCacheNode</code>\uff1a\u5728Sync\u7684\u65f6\u5019\uff0c\u5bf9Node\u8bbe\u7f6e\u548c\u53d6\u6d88\u8bbe\u7f6e\u6807\u7b7e\uff1b</li> </ul> <pre><code># \u8bbe\u7f6e\u6570\u636e\u96c6\u4e2a\u6570\nfluid.io/dataset-num=1\n# runtime label\uff08namespace:default, name: demo)\nfluid.io/s-alluxio-default-demo=true\n# common label\nfluid.io/s-default-demo=true\n# \u8bbe\u7f6e\u5b58\u50a8\u5bb9\u91cf\uff08memory\uff0cdisk\uff0ctotal\uff09\nfluid.io/s-h-alluxio-m-default-demo=2GiB\nfluid.io/s-h-alluxio-d-default-demo=1GiB\nfluid.io/s-h-alluxio-t-default-demo=3GiB\n# \u6392\u4ed6\u6027\nfluid_exclusive=default_demo\n\n## yaml\u4e2d\u4f1a\u8bbe\u7f6e\u8fd9\u4e24\u4e2a\u503c\uff0c\u7528\u4f5cDataset\u7684\u6392\u4ed6/\u5171\u4eab\u6a21\u5f0f\nfluid.io/dataset: {{ .Release.Namespace }}-{{ .Release.Name }}\nfluid.io/dataset-placement: {{ .Values.placement }}\n</code></pre>"},{"location":"cloud/projects/fluid.html#alluxioruntime","title":"AlluxioRuntime","text":"<p>\u9ed8\u8ba4<code>20000~25000</code>\u7684\u7aef\u53e3\u8303\u56f4\uff0cMaster/Worker/Fuse \u4f7f\u7528\u7684\u662f HostNetWork\u3002</p>"},{"location":"cloud/projects/fluid.html#spec_3","title":"Spec","text":"<ul> <li><code>Replicas</code>\uff1aWorker\u7684\u526f\u672c\u6570\u91cf\uff1b</li> <li><code>FUSE</code>\uff1aFUSE\u7684\u914d\u7f6e\uff0c\u6709\u4e24\u4e2aDaemonSet\uff08\u9ed8\u8ba4enabled\u4e3atrue\uff0cclientEnabled\u4e3afalse\uff09\uff1b</li> <li><code>Global</code>\uff1a\u5e38\u91cf\u4e3atrue\uff0cFUSE \u4ee5 Global \u5f62\u5f0f\u90e8\u7f72\uff08\u53ef\u914d\u7f6e\u8282\u70b9\u4eb2\u548c\u6027NodeSelector\uff09\uff1b</li> <li><code>NodeSelector</code>\uff1a\u914d\u7f6e\u7684\u8282\u70b9\u4eb2\u548c\u6027NodeSelector\uff1b</li> <li><code>APIGateway</code>\uff1a\u8bbe\u7f6e<code>alluxio.proxy.web.port</code>\uff1b</li> </ul>"},{"location":"cloud/projects/fluid.html#status_3","title":"Status","text":"<ul> <li><code>MasterPhase</code>\uff1aMaster\u7684\u9636\u6bb5\uff0c\u5982Ready\uff1b</li> <li><code>WorkerPhase</code>\uff1aWorker\u7684\u9636\u6bb5\uff0c\u5982Ready\uff1b</li> <li><code>CacheStates</code>\uff1a\u7f13\u5b58\u7684\u72b6\u6001\u4fe1\u606f</li> </ul>"},{"location":"cloud/projects/fluid.html#reconcilercontroller","title":"ReconcilerController","text":"<ul> <li>\u521b\u5efa\u548c\u5220\u9664Runtime\u7684Finalizer\u5b57\u6bb5\uff1b</li> <li>\u521b\u5efa/\u5220\u9664Engine\uff1b</li> </ul> <p>Dataset\u8fdb\u5165Ready\u72b6\u6001</p> <ul> <li> <p><code>engine#setup</code>\uff1a\u521b\u5efa Master/Worker/Fuse\uff0c\u68c0\u67e5UFS\uff08\u5143\u6570\u636e\u540c\u6b65\uff09\uff0c\u68c0\u67e5Runtime Ready\uff0c\u7ed1\u5b9a\u5230DataSet</p> </li> <li> <p>FUSE DaemonSet\uff1a\u5c06\u5bbf\u4e3b\u673a\u7684/dev/fuse \u548c /runtime-mnt/alluxio \u6302\u8f7d\u5230Pod\u4e2d\uff1b</p> </li> <li> <p>Worker\uff1a\u5c06\u5bbf\u4e3b\u673a\u7684 /dev/shm/ \u6302\u8f7d\u5728Pod\u4e2d\uff08\u7528\u4e8emount\uff09\uff1b</p> </li> <li> <p><code>engine#CreateVolume</code>\uff1a\u521b\u5efaFuse PV / PVC\uff0c\u521b\u5efaHCFS PV\uff1b</p> </li> <li> <p>\u901a\u8fc7Annotation\u786e\u5b9aPV\u662fFluid\u521b\u5efa\uff1b</p> </li> </ul> <pre><code>Name:            default-demo\n# \u5b9a\u5236\u7684label \u548c Annotations\nLabels:          fluid.io/s-default-demo=true\nAnnotations:     CreatedBy: fluid\n                 pv.kubernetes.io/bound-by-controller: yes\nFinalizers:      [kubernetes.io/pv-protection]\nStorageClass:    fluid\nStatus:          Bound\nClaim:           default/demo\nReclaim Policy:  Retain\nAccess Modes:    ROX\nVolumeMode:      Filesystem\nCapacity:        100Gi\nNode Affinity:   &lt;none&gt;\nMessage:\nSource:\n    Type:              CSI (a Container Storage Interface (CSI) volume source)\n    Driver:            fuse.csi.fluid.io\n    FSType:\n    VolumeHandle:      default-demo\n    ReadOnly:          false\n    # \u6302\u8f7d\u7684\u8def\u5f84\uff0c\u5728FUSE\u7684pod\u4e2d\n    VolumeAttributes:      fluid_path=/runtime-mnt/alluxio/default/demo/alluxio-fuse\n                           mount_type=fuse.alluxio-fuse\nEvents:                &lt;none&gt;\n</code></pre> <ul> <li><code>engine#Sync</code>\uff1a\u5143\u6570\u636e\u540c\u6b65</li> </ul> <p>Runtime\u5305\u542bDelete\u65f6\u95f4\u6233\uff1a</p> <ul> <li>engine#DeleteVolume\uff1a</li> <li>engine#Shutdown\uff1a</li> </ul>"},{"location":"cloud/projects/fluid.html#engine","title":"Engine","text":"<p>\u6bcf\u4e00\u4e2anamespace:name\u90fd\u4f1a\u751f\u6210\u4e00\u4e2aEngine\uff0c\u8fdb\u884c\u5904\u7406</p> <p>\u751f\u547d\u5468\u671f\uff1a</p> <ul> <li> <p>\u521b\u5efa\uff1asetup -&gt; CreateVolume -&gt; Sync\uff08\u8fdb\u884cnode label\uff09</p> </li> <li> <p>\u5220\u9664\uff1aDeleteVolume -&gt; Shutdown</p> </li> </ul> <p>engine#setup\uff1a\u521b\u5efa Master/Worker\u7684StatefulSet\uff0cFUSE\u7684 DaemonSet\uff0c\u68c0\u67e5UFS\uff08\u540c\u6b65\u5143\u6570\u636e\uff09\uff0c\u68c0\u67e5Runtime Ready\uff0c\u7ed1\u5b9a\u5230DataSet</p> <ul> <li> <p>\u5143\u6570\u636e\uff08\u901a\u8fc7alluxio master\u7684alluxio fs\u547d\u4ee4\uff09\uff1a\u6587\u4ef6\u603b\u6570\uff0c\u6587\u4ef6\u603b\u5927\u5c0f</p> </li> <li> <p>DataSet \u9636\u6bb5\u8bbe\u4e3a<code>BoundDatasetPhase</code>\uff0c\u72b6\u6001\u8bbe\u4e3a<code>DatasetReady</code>\uff1b</p> </li> <li> <p>FUSE Pod\u5982\u4f55\u521b\u5efa\u7684\uff1a</p> </li> <li> <p><code>DaemonSet</code>\u7533\u8bf7\uff1aNodeSelector \u6ee1\u8db3<code>fluid.io/f-{ns}-{ds_name}= \"true\"</code></p> </li> <li>CSI NodeStageVolume\u91cc\u8bbe\u7f6e\u8be5\u503c\uff1b</li> </ul> <p>\u5bf9\u4e8e\u4e0d\u540c\u7c7b\u578b\u7684Mount\u5982\u4f55\u5904\u7406\uff1a</p> <ul> <li> <p>Local\u548cPVC\u8f6c\u6362\u4e3aUFSPaths \u548c UFSVolumes\uff0c\u6302\u8f7d\u5230Runtime\u7684Master/Worker Pod\u4e2d\"/underFSStorage\"\uff0c\u5373Alluxio root ufs\uff1b</p> </li> <li> <p>master/worker \u7684yaml \u4f1a\u81ea\u52a8\u6dfb\u52a0 volumeMount \u5408 volume \u4fe1\u606f\uff1b</p> </li> <li> <p>HTTP\u7b49\u5f62\u5f0f\u901a\u8fc7\u5728MasterPod\u4e2d\u6267\u884c<code>alluxio fs mount</code>\uff1b</p> </li> <li> <p>\u5728 Engine \u7684  PrepareUFS \u7684 mountUFS \u51fd\u6570\u5185\u6267\u884c\u547d\u4ee4</p> </li> </ul>"},{"location":"cloud/projects/fluid.html#runtimeportallocator","title":"RuntimePortAllocator","text":"<p>\u8fd0\u884c\u65f6\u7aef\u53e3\u5206\u914d\uff08<code>portallocator</code>\u5305\uff09</p>"},{"location":"cloud/projects/fluid.html#fluidapp","title":"FluidApp","text":"<p>\u7528\u4f5c\u5173\u95ed FUSE sidecar\uff08\u9488\u5bf9 serverless \u573a\u666f\uff09\uff0c\u5f53 \u4e3b Pod\u5b8c\u6210\u540e\uff0csidecar \u7684Pod \u5e94\u8be5\u540c\u6837\u7ed3\u675f</p> <ul> <li>Pod \u9700\u8981\u6709\u6807\u7b7e\uff0c<code>fuse.serverful.fluid.io/inject=true</code></li> </ul> <p>\u4f5c\u4e3a Serverless \u96c6\u7fa4\u7684Controller\uff0cPod Fuse Sidecar\u7684\u72b6\u6001\u5224\u65ad\u3002</p> <ul> <li>Update\u7684Watch Filter\uff0c\u8fc7\u6ee4Pod\u662f\u5426\u9700\u8981\u8c03\u8c10\uff1b</li> <li>\u8c03\u8c10\uff1a\u8fdb\u884cumount\u64cd\u4f5c\uff1b</li> </ul>"},{"location":"cloud/projects/fluid.html#webhook","title":"Webhook","text":"<p>Fluid \u9ed8\u8ba4\u5b89\u88c5webhook\u7684Deployment\uff0c\u5bf9Pods\u7684create/update\u8fdb\u884c\u56de\u8c03\uff0c\u8fdb\u884cFUSE sidecar\u7684\u6ce8\u5165/Pod\u7684\u4eb2\u548c\u6027\u8c03\u5ea6\u3002</p> <p><code>Controller</code></p> <ul> <li>Patch \u8bc1\u4e66\u5230<code>MutatingWebhookConfiguration</code></li> </ul> <p><code>main.go</code>\uff1a\u6ce8\u518c<code>CreateUpdatePodForSchedulingHandler</code>\uff0c\u9488\u5bf9 \u58f0\u660e DataSet \u7684 Pod (\u6839\u636ePod\u7ed1\u5b9a\u7684PVC\u7684label\u5224\u65ad)</p> <ul> <li>\u901a\u8fc7WebhookServer\u6ce8\u518cHandler</li> </ul> <p>Registered webhook handler      {\"path\": \"/mutate-fluid-io-v1alpha1-schedulepod\"}</p> <ul> <li> <p>\u5982\u679c\u662f serverlesss \u6a21\u5f0f\uff0c\u5219\u8fdb\u884c FUSE \u5bb9\u5668\u6ce8\u5165\uff1b</p> </li> <li> <p>\u5c06 PVC \u7684 volume \u66ff\u6362\u6210Fuse\u5bb9\u5668\u7684\u8def\u5f84\uff1b</p> </li> <li> <p>\u5982\u679c\u4e0d\u662f serverless \u6a21\u5f0f\uff0c\u5219\u8fdb\u884c<code>NodeAffinityWithCache</code>\uff0c<code>PreferNodesWithCache</code>\uff0c<code>MountPropagationInjector</code>\uff1b</p> </li> <li> <p><code>NodeAffinityWithCache</code>\uff1afuse\u7684global \u548c selector\u7684\u6ce8\u5165Pod\uff1b</p> </li> <li><code>PreferNodesWithCache</code>\uff1apod\u7684\u8282\u70b9\u4eb2\u548c\u6027\u8c03\u5ea6\u8bbe\u7f6e\uff0c\u8c03\u5ea6\u5230\u5177\u5907<code>commonLabel\uff08fluid.io/s-default-demo=true\uff09</code>\u7684\u8282\u70b9\uff1b</li> <li><code>MountPropagationInjector</code>\uff1apod\u8fdb\u884c<code>MountPropagation</code>\u914d\u7f6e\u4e3a<code>HostToContainer</code></li> </ul>"},{"location":"cloud/projects/fluid.html#csi","title":"CSI","text":"<p>Serverless \u6a21\u5f0f\u4e0b\uff0c\u4e0d\u89e6\u53d1 CSI::NodeStageVolume\uff0c\u56e0\u4e3a\u4f1a\u5c06 PVC \u7684 volume \u91cd\u5199\u4e3a hostPath\uff1b</p> <p>\u914d\u7f6e FuseRecovery\uff0cFUSE \u7684\u81ea\u52a8\u6062\u590d\uff1b</p> <p>\u9009\u62e9<code>fluid.io/s-default-fusedemo: \"true\"</code>\u7684Volume\u7ed1\u5b9a\uff1b</p> <ul> <li>fuse pod \u521b\u5efa\u89c1 <code>NodeStageVolume</code>\u9636\u6bb5\uff1b</li> </ul> <p>\u914d\u7f6e Fluid Driver\uff0c\u8fdb\u884c\u81ea\u5b9a\u4e49\u5b58\u50a8\u9a71\u52a8\uff1b</p> <ul> <li> <p>Unix Sock\uff1a<code>unix:///var/lib/kubelet/csi-plugins/fuse.csi.fluid.io/csi.sock</code></p> </li> <li> <p>CSI Driver DaemonSet \u6302\u8f7d\u5bbf\u4e3b\u673a\u7684<code>/runtime</code>\u76ee\u5f55\uff1b</p> </li> </ul> <pre><code># \u5c06alluxio\u7684\u76ee\u5f55\uff0c\u6302\u8f7d\u5230pod\u4e2d\uff0c\u5bf9 pod \u8be5\u8def\u5f84\u7684\u8bfb\u5199\uff0c\u89e6\u53d1 fuse \u64cd\u4f5c\uff0c\u8fdb\u800c\u8ddf Alluxio \u901a\u4fe1\n# fuse daemonset \u5c06 hostpah \u7684 /runtime-mnt/alluxio/default/demo/ \u6302\u8f7d\u5230\u5bb9\u5668\n/bin/mount --bind -o ro /runtime-mnt/alluxio/default/demo/alluxio-fuse /var/lib/kubelet/pods/9b5bdfd5-7510-4d50-9246-8f7ebce12a80/volumes/kubernetes.io~csi/default-demo/mount\n</code></pre> <p><code>NodeStageVolume</code>\u9636\u6bb5\uff1a</p> <ul> <li>Pod \u4f7f\u7528 Dataset Volume \u65f6\uff0cCSI \u63d2\u4ef6\u6267\u884c\u5230\u8be5\u9636\u6bb5\uff0c\u8868\u660e Pod \u8c03\u5ea6\u5728\u8be5\u8282\u70b9\uff1b</li> <li>\u8bbe\u7f6e<code>fluid.io/f-default-demo=true</code> \u6807\u7b7e\uff0c\u5373\u8282\u70b9\u4e0a\u5177\u5907\u8be5CSI\u63d2\u4ef6\uff0c\u4f9bFUSE\u4f7f\u7528\uff08\u6b64\u65f6Fuse daemonset\u6ee1\u8db3\u8c03\u5ea6\u6761\u4ef6\uff0c\u624d\u4f1a\u8fdb\u884c\u8c03\u5ea6\uff09\uff1b</li> </ul> <p><code>NodePublishVolume</code>\u9636\u6bb5\uff1a</p> <ul> <li>\u5c06 fluid fuse path \u6302\u8f7d\u5230 pod \u7684\u76ee\u5f55\u4e2d\uff1b</li> </ul> <pre><code>NodePublishVolumeRequest is volume_id:\"default-phy\" \nstaging_target_path:\"/var/lib/kubelet/plugins/kubernetes.io/csi/pv/refdemo-ai-education/globalmount\"\ntarget_path:\"/var/lib/kubelet/pods/63403007-a2d6-49ae-a9b4-92988e58427b/volumes/kubernetes.io~csi/refdemo-ai-education/mount\" volume_capability:&lt;mount:&lt;&gt; access_mode:&lt;mode:MULTI_NODE_READER_ONLY &gt; &gt; \nvolume_context:&lt;key:\"csi.storage.k8s.io/ephemeral\" value:\"false\" &gt; \nvolume_context:&lt;key:\"csi.storage.k8s.io/pod.name\" value:\"nginx\" &gt; \nvolume_context:&lt;key:\"csi.storage.k8s.io/pod.namespace\" value:\"ai-education\" &gt; \nvolume_context:&lt;key:\"csi.storage.k8s.io/pod.uid\" value:\"63403007-a2d6-49ae-a9b4-92988e58427b\" &gt; \nvolume_context:&lt;key:\"csi.storage.k8s.io/serviceAccount.name\" value:\"default\" &gt; \nvolume_context:&lt;key:\"fluid_path\" value:\"/runtime-mnt/alluxio/default/phy/alluxio-fuse\" &gt; \nvolume_context:&lt;key:\"mount_type\" value:\"fuse.alluxio-fuse\" &gt; \nvolume_context:&lt;key:\"runtime_name\" value:\"phy\" &gt;\nvolume_context:&lt;key:\"runtime_namespace\" value:\"default\" &gt;\n</code></pre>"},{"location":"cloud/projects/fluid.html#_7","title":"\u4f7f\u7528","text":""},{"location":"cloud/projects/fluid.html#dataset_1","title":"DataSet","text":""},{"location":"cloud/projects/fluid.html#dataset_2","title":"\u5b9a\u4e49 DataSet","text":"<pre><code>apiVersion: data.fluid.io/v1alpha1\nkind: Dataset\nmetadata:\n  name: hbase\nspec:\n  mounts:\n    - mountPoint: https://mirrors.tuna.tsinghua.edu.cn/apache/hbase/stable/\n      name: hbase\n</code></pre>"},{"location":"cloud/projects/fluid.html#runtime","title":"\u5b9a\u4e49 Runtime","text":"<p>metadata\u7684name\u5b57\u6bb5\u9700\u8981\u8ddfDataSet\u7684metadata\u7684name\u5b57\u6bb5\u76f8\u540c\uff1b</p> <pre><code>apiVersion: data.fluid.io/v1alpha1\nkind: AlluxioRuntime\nmetadata:\n  name: hbase\nspec:\n  replicas: 2\n  tieredstore:\n    levels:\n      - mediumtype: MEM\n        path: /dev/shm\n        quota: 2Gi\n        high: \"0.95\"\n        low: \"0.7\"\n</code></pre>"},{"location":"cloud/projects/fluid.html#app","title":"\u5b9a\u4e49 App","text":"<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\nspec:\n  containers:\n    - name: nginx\n      image: nginx\n      volumeMounts:\n        - mountPath: /data\n          name: hbase-vol\n  volumes:\n    - name: hbase-vol\n      persistentVolumeClaim:\n        claimName: hbase\n</code></pre>"},{"location":"cloud/projects/fluid.html#backup","title":"Backup","text":""},{"location":"cloud/projects/fluid.html#backup_1","title":"\u5b9a\u4e49Backup","text":"<pre><code>apiVersion: data.fluid.io/v1alpha1\nkind: DataBackup\nmetadata:\n  name: hbase-backup\nspec:\n  dataset: hbase\n  backupPath: pvc://&lt;pvcName&gt;/subpath1/subpath2/\n</code></pre>"},{"location":"cloud/projects/fluid.html#_8","title":"\u6062\u590d","text":"<pre><code>apiVersion: data.fluid.io/v1alpha1\nkind: Dataset\nmetadata:\n  name: hbase\nspec:\n  dataRestoreLocation:\n    path: pvc://pvc-local/subpath1/\n  mounts:\n    - mountPoint:  https://mirrors.tuna.tsinghua.edu.cn/apache/hbase/2.2.6/\n</code></pre>"},{"location":"cloud/projects/istio.html","title":"Istio","text":""},{"location":"cloud/projects/istio.html#_1","title":"\u67b6\u6784","text":""},{"location":"cloud/projects/istio.html#_2","title":"\u6570\u636e\u5e73\u9762","text":"<p>Istio\u7684\u6570\u636e\u5e73\u9762\u4e3b\u8981\u5305\u62ecEnvoy\u4ee3\u7406\u7684\u6269\u5c55\u7248\u672c\u3002 Envoy\u662f\u4e00\u4e2a\u5f00\u6e90\u8fb9\u7f18\u548c\u670d\u52a1\u4ee3\u7406\uff0c\u53ef\u5e2e\u52a9\u5c06\u7f51\u7edc\u95ee\u9898\u4e0e\u5e95\u5c42\u5e94\u7528\u7a0b\u5e8f\u5206\u79bb\u5f00\u6765\u3002\u5e94\u7528\u7a0b\u5e8f\u4ec5\u5411localhost\u53d1\u9001\u6d88\u606f\u6216\u4ecelocalhost\u63a5\u6536\u6d88\u606f\uff0c\u800c\u65e0\u9700\u4e86\u89e3\u7f51\u7edc\u62d3\u6251\u3002</p> <ul> <li>\u5728OSI\u6a21\u578b\u7684L3\u548cL4\u5c42\u8fd0\u884c\u7684\u7f51\u7edc\u4ee3\u7406\uff1b</li> <li>\u652f\u6301\u7528\u4e8e\u57fa\u4e8eHTTP\u7684\u6d41\u91cf\u7684\u9644\u52a0L7\u5c42\u8fc7\u6ee4\u5668\uff1b</li> <li>HTTP/2\u548cgRPC\u4f20\u8f93\u5177\u6709\u4e00\u6d41\u7684\u652f\u6301\uff1b</li> </ul>"},{"location":"cloud/projects/istio.html#_3","title":"\u63a7\u5236\u9762","text":"<p>\u63a7\u5236\u5e73\u9762\u8d1f\u8d23\u7ba1\u7406\u548c\u914d\u7f6e\u6570\u636e\u5e73\u9762\u4e2d\u7684Envoy\u4ee3\u7406\u3002</p> <p>\u5728Istio\u67b6\u6784\u4e2d\uff0c\u63a7\u5236\u9762\u6838\u5fc3\u7ec4\u4ef6\u662fistiod\uff0cIstiod\u8d1f\u8d23\u5c06\u9ad8\u7ea7\u8def\u7531\u89c4\u5219\u548c\u6d41\u91cf\u63a7\u5236\u884c\u4e3a\u8f6c\u6362\u4e3a\u7279\u5b9a\u4e8eEnvoy\u7684\u914d\u7f6e\uff0c\u5e76\u5728\u8fd0\u884c\u65f6\u5c06\u5176\u4f20\u64ad\u5230Sidecar\u3002</p>"},{"location":"cloud/projects/istio.html#_4","title":"\u7ec4\u4ef6","text":""},{"location":"cloud/projects/istio.html#envoy","title":"Envoy","text":"<p>Istio\u4f5c\u4e3a\u670d\u52a1\u7f51\u683c\u63d0\u4f9b\u7684\u8bb8\u591a\u529f\u80fd\u5b9e\u9645\u4e0a\u662f\u7531Envoy\u4ee3\u7406\u7684\u57fa\u7840\u5185\u7f6e\u529f\u80fd\u542f\u7528\u7684\uff1a</p> <ul> <li>\u6d41\u91cf\u63a7\u5236\uff1aEnvoy\u901a\u8fc7HTTP\uff0cgRPC\uff0cWebSocket\u548cTCP\u6d41\u91cf\u7684\u4e30\u5bcc\u8def\u7531\u89c4\u5219\u542f\u7528\u7ec6\u7c92\u5ea6\u7684\u6d41\u91cf\u63a7\u5236\u5e94\u7528\uff0c\u5982\u8d1f\u8f7d\u5747\u8861\uff0c\u767e\u5206\u6bd4\u6d41\u91cf\u5206\u5272\u7b49\uff1b</li> <li>\u7f51\u7edc\u5f39\u6027\uff1aEnvoy\u5305\u62ec\u5bf9\u81ea\u52a8\u91cd\u8bd5\uff0c\u65ad\u8def\u548c\u6545\u969c\u6ce8\u5165\u7684\u5f00\u7bb1\u5373\u7528\u652f\u6301</li> <li>\u5b89\u5168\u6027\uff1aEnvoy\u8fd8\u53ef\u4ee5\u5b9e\u65bd\u5b89\u5168\u7b56\u7565\uff0c\u5e76\u5bf9\u57fa\u7840\u670d\u52a1\u4e4b\u95f4\u7684\u901a\u4fe1\u5e94\u7528\u8bbf\u95ee\u63a7\u5236\u548c\u901f\u7387\u9650\u5236</li> <li>\u57fa\u4e8e WebAssembly \u7684\u53ef\u63d2\u62d4\u6269\u5c55\u6a21\u578b\uff0c\u5141\u8bb8\u901a\u8fc7\u81ea\u5b9a\u4e49\u7b56\u7565\u6267\u884c\u548c\u751f\u6210\u7f51\u683c\u6d41\u91cf\u7684\u9065\u6d4b\u3002</li> </ul>"},{"location":"cloud/projects/istio.html#istiod","title":"Istiod","text":"<p>\u7ec4\u4ef6 Istiod \u63d0\u4f9b\u670d\u52a1\u53d1\u73b0\u3001\u914d\u7f6e\u548c\u8bc1\u4e66\u7ba1\u7406\u3002</p> <p>Istio \u53ef\u4ee5\u652f\u6301\u53d1\u73b0\u591a\u79cd\u73af\u5883\uff0c\u5982 Kubernetes \u6216 VM\u3002</p>"},{"location":"cloud/projects/istio.html#_5","title":"\u5b89\u88c5","text":"<pre><code># \u4e0b\u8f7d\nwget https://github.com/istio/istio/releases/download/1.16.1/istio-1.16.1-linux-amd64.tar.gz\n\ntar -xzf istioctl-1.16.1-linux-amd64.tar.gz\n\ncp istioctl-1.16.1/bin/istioctl /usr/local/bin/istioctl\n\n# \u5b89\u88c5\nistioctl install --set profile=demo -y\n\n# \u67e5\u770b istio-system \u547d\u540d\u7a7a\u95f4\u4e0b\u9762\u7684 Pod \u8fd0\u884c\u72b6\u6001\nkubectl get pods -n istio-system\n</code></pre>"},{"location":"cloud/projects/istio.html#_6","title":"\u4f7f\u7528","text":""},{"location":"cloud/projects/istio.html#sidecar","title":"sidecar\u6ce8\u5165","text":"<p>\u81ea\u52a8\u6ce8\u5165\uff1a\u540d\u7a7a\u95f4\u5141\u8bb8\u81ea\u52a8\u6ce8\u5165sidecar</p> <p><code>kubectl label namespace default istio-injection=enabled</code></p> <p>\u624b\u52a8\u6ce8\u5165\uff1a\u8f93\u51fa\u6ce8\u5165sidecar\u4e4b\u540e\u7684 yaml</p> <pre><code>istioctl kube-inject -f samples/bookinfo/platform/kube/bookinfo.yaml\n</code></pre>"},{"location":"cloud/projects/istio.html#_7","title":"\u7f51\u5173","text":"<p>\u5728\u96c6\u7fa4\u5916\u90e8\u8bbf\u95ee\uff0c\u5c31\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a istio gateway\uff0cgateway \u76f8\u5f53\u4e8e k8s \u7684 ingress controller \u548c ingress\u3002</p>"},{"location":"cloud/projects/istio.html#_8","title":"\u4eea\u8868\u76d8","text":""},{"location":"cloud/projects/istio.html#_9","title":"\u914d\u7f6e","text":""},{"location":"cloud/projects/istio.html#virtualservice","title":"VirtualService","text":"<p>\u5728 Istio \u4e2d\u5b9a\u4e49\u8def\u7531\u89c4\u5219\uff0c\u63a7\u5236\u6d41\u91cf\u8def\u7531\u5230\u670d\u52a1\u4e0a\u7684\u5404\u79cd\u884c\u4e3a\u3002</p> <p>\u793a\u4f8b\uff1a\u5b9a\u4e49\u4e00\u4e2a\u865a\u62df\u670d\u52a1\uff0c\u6839\u636e\u8bf7\u6c42\u662f\u5426\u6765\u81ea\u67d0\u4e2a\u7279\u5b9a\u7528\u6237\uff0c\u628a\u5b83\u4eec\u8def\u7531\u5230\u670d\u52a1\u7684\u4e0d\u540c\u7248\u672c\u53bb\u3002</p> <pre><code>apiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: reviews\nspec:\n  hosts: # \u5217\u51faVirtualService\u7684hosts\uff0c\u53ef\u4ee5\u662fIP\u3001DNS\u540d\u79f0\u3001FQDN\u6216*\n  - reviews\n  http: # \u5728\u4e0b\u9762\u914d\u7f6eVirtualService\u7684\u8def\u7531\u89c4\u5219\uff0c\u6307\u5b9a\u7b26\u5408\u54ea\u4e9b\u89c4\u5219\u7684\u6d41\u91cf\u6253\u5230\u54ea\u4e9bDestination\uff0c\u652f\u6301HTTP/1.1\uff0cHTTP2\uff0c\u53cagRPC\u7b49\u534f\u8bae\n  - match: # \u6307\u5b9a\u5177\u4f53\u7684\u5339\u914d\u89c4\u5219\n    - headers:\n        end-user:\n          exact: jason\n    route:\n    - destination: # \u6307\u5b9a\u6ee1\u8db3\u89c4\u5219\u540e\u5c06\u6d41\u91cf\u6253\u5230\u54ea\u4e2a\u5177\u4f53\u7684Destination\n        host: reviews  # Kubernetes Service \u77ed\u540d\u79f0\n        subset: v2\n  - route:  # \u6d41\u91cf\u89c4\u5219\u6309\u4ece\u4e0a\u5230\u4e0b\u7684\u4f18\u5148\u7ea7\u53bb\u5339\u914d\uff0c\u82e5\u4e0d\u6ee1\u8db3\u4e0a\u8ff0\u89c4\u5219\u65f6\uff0c\u8fdb\u5165\u8be5\u9ed8\u8ba4\u89c4\u5219\n    - destination:\n        host: reviews\n        subset: v3\n</code></pre>"},{"location":"cloud/projects/istio.html#destinationrule","title":"DestinationRule","text":"<p>\u5b9a\u4e49\u5c06\u6d41\u91cf\u5982\u4f55\u8def\u7531\u5230\u6307\u5b9a\u76ee\u6807\u5730\u5740\uff0c\u7136\u540e\u4f7f\u7528\u76ee\u6807\u89c4\u5219\u6765\u914d\u7f6e\u8be5\u76ee\u6807\u7684\u6d41\u91cf\u3002</p> <p>\u5c06\u865a\u62df\u670d\u52a1\u770b\u6210\u5c06\u6d41\u91cf\u5982\u4f55\u8def\u7531\u5230\u6307\u5b9a\u76ee\u6807\u5730\u5740\uff0c\u7136\u540e\u4f7f\u7528\u76ee\u6807\u89c4\u5219\u6765\u914d\u7f6e\u8be5\u76ee\u6807\u7684\u6d41\u91cf\u3002\u76ee\u6807\u89c4\u5219\u5c06\u5e94\u7528\u4e8e\u6d41\u91cf\u7684\u201c\u771f\u5b9e\u201d\u76ee\u6807\u5730\u5740\u3002</p> <p>\u4f7f\u7528\u76ee\u6807\u89c4\u5219\u6765\u6307\u5b9a\u547d\u540d\u7684\u670d\u52a1\u5b50\u96c6\uff0c\u4f8b\u5982\u6309\u7248\u672c\u4e3a\u6240\u6709\u6307\u5b9a\u670d\u52a1\u7684\u5b9e\u4f8b\u5206\u7ec4\uff0c\u7136\u540e\u53ef\u4ee5\u5728\u865a\u62df\u670d\u52a1\u7684\u8def\u7531\u89c4\u5219\u4e2d\u4f7f\u7528\u8fd9\u4e9b\u670d\u52a1\u5b50\u96c6\u6765\u63a7\u5236\u5230\u670d\u52a1\u4e0d\u540c\u5b9e\u4f8b\u7684\u6d41\u91cf\u3002</p> <p>\u793a\u4f8b\uff1a\u76ee\u6807\u89c4\u5219\u4e3a <code>my-svc</code> \u76ee\u6807\u670d\u52a1\u914d\u7f6e\u4e86 3 \u4e2a\u5177\u6709\u4e0d\u540c\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u7684\u5b50\u96c6\u3002</p> <pre><code>apiVersion: networking.istio.io/v1alpha3\nkind: DestinationRule\nmetadata:\n  name: my-destination-rule\nspec:\n  host: my-svc\n  trafficPolicy:\n    loadBalancer:\n      simple: RANDOM  # \u968f\u673a\u7684\u7b56\u7565\n  subsets:\n  - name: v1\n    labels:\n      version: v1\n  - name: v2\n    labels:\n      version: v2\n    trafficPolicy:\n      loadBalancer:\n        simple: ROUND_ROBIN  # \u8f6e\u8be2\n  - name: v3\n    labels:\n      version: v3\n</code></pre>"},{"location":"cloud/projects/kubevela.html","title":"KubeVela","text":"<p>KubeVela \u7b80\u4ecb | KubeVela</p> <p>\u5f00\u7bb1\u5373\u7528\u7684\u73b0\u4ee3\u5316\u5e94\u7528\u4ea4\u4ed8\u4e0e\u7ba1\u7406\u5e73\u53f0\uff0c\u5b83\u4f7f\u5f97\u5e94\u7528\u5728\u9762\u5411\u6df7\u5408\u4e91\u73af\u5883\u4e2d\u7684\u4ea4\u4ed8\u66f4\u7b80\u5355\u3001\u5feb\u6377\u3002</p> <ul> <li>\u901a\u8fc7 \u5f00\u653e\u5e94\u7528\u6a21\u578b\uff08OAM\uff09\u6765\u4f5c\u4e3a\u5e94\u7528\u4ea4\u4ed8\u7684\u9876\u5c42\u62bd\u8c61\uff1b</li> </ul> <p></p>"},{"location":"cloud/projects/kubevela.html#oam","title":"OAM","text":""},{"location":"cloud/projects/kubevela.html#application","title":"\u5e94\u7528\uff08Application\uff09","text":"<p>\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5fae\u670d\u52a1\u4e1a\u52a1\u5355\u5143\u6240\u5305\u62ec\u7684\u5236\u54c1\uff08\u4e8c\u8fdb\u5236\u3001Docker \u955c\u50cf\u3001Helm Chart...\uff09\uff0c\u7531\u7ec4\u4ef6\uff08Component\uff09\u3001\u8fd0\u7ef4\u7279\u5f81\uff08Trait\uff09\u3001\u5de5\u4f5c\u6d41\uff08Workflow\uff09\u3001\u5e94\u7528\u7b56\u7565\uff08Policy\uff09\u56db\u90e8\u5206\u7ec4\u6210\u3002</p>"},{"location":"cloud/projects/kubevela.html#_1","title":"\u793a\u4f8b","text":"<pre><code>apiVersion: core.oam.dev/v1beta1\nkind: Application\nmetadata:\n  name: first-vela-app\nspec:\n  components:\n    - name: express-server\n      type: webservice\n      properties:\n        image: oamdev/hello-world\n        ports:\n         - port: 8000\n           expose: true\n      traits:\n        - type: scaler\n          properties:\n            replicas: 1\n  policies:\n    - name: target-default\n      type: topology\n      properties:\n        # local \u96c6\u7fa4\u5373 Kubevela \u6240\u5728\u7684\u96c6\u7fa4\n        clusters: [\"local\"]\n        namespace: \"default\"\n    - name: target-prod\n      type: topology\n      properties:\n        clusters: [\"local\"]\n        # \u6b64\u547d\u540d\u7a7a\u95f4\u9700\u8981\u5728\u5e94\u7528\u90e8\u7f72\u524d\u5b8c\u6210\u521b\u5efa\n        namespace: \"prod\"\n    - name: deploy-ha\n      type: override\n      properties:\n        components:\n          - type: webservice\n            traits:\n              - type: scaler\n                properties:\n                  replicas: 2\n  workflow:\n    steps:\n      - name: deploy2default\n        type: deploy\n        properties:\n          policies: [\"target-default\"]\n      - name: manual-approval\n        type: suspend\n      - name: deploy2prod\n        type: deploy\n        properties:\n          policies: [\"target-prod\", \"deploy-ha\"]\n</code></pre>"},{"location":"cloud/serverless/knative.html","title":"Knative","text":"<p>Knative \u662f\u4ee5 Kubernetes \u7684\u4e00\u7ec4\u81ea\u5b9a\u4e49\u8d44\u6e90\u7c7b\u578b\uff08CRD\uff09\u7684\u65b9\u5f0f\u6765\u5b89\u88c5</p> <ul> <li>\u81ea\u52a8\u5b8c\u6210\u4ee3\u7801\u5230\u5bb9\u5668\u7684\u6784\u5efa</li> <li>\u628a\u5e94\u7528\uff08\u6216\u8005\u51fd\u6570\uff09\u548c\u7279\u5b9a\u7684\u4e8b\u4ef6\u8fdb\u884c\u7ed1\u5b9a\uff1a\u5f53\u4e8b\u4ef6\u53d1\u751f\u65f6\uff0c\u81ea\u52a8\u89e6\u53d1\u5e94\u7528\uff08\u6216\u8005\u51fd\u6570\uff09</li> <li>\u7f51\u7edc\u7684\u8def\u7531\u548c\u6d41\u91cf\u63a7\u5236</li> <li>\u51fd\u6570\u7684\u81ea\u52a8\u4f38\u7f29</li> </ul> <p>Knative \u5c06 kubernetes \u548c istio \u7684\u590d\u6742\u5ea6\u8fdb\u884c\u62bd\u8c61\u548c\u9694\u79bb\uff0c\u89e3\u51b3\u4e86\u7e41\u7410\u7684\u6784\u5efa\uff0c\u90e8\u7f72\uff0c\u670d\u52a1\u6cbb\u7406\u6b65\u9aa4\uff0c\u5e76\u4e14\u57fa\u4e8e\u5f00\u653e\u6807\u51c6\u4f7f\u5f97\u670d\u52a1\u53d8\u5f97\u53ef\u79fb\u690d\u3002</p>"},{"location":"cloud/serverless/knative.html#_1","title":"\u7ec4\u4ef6","text":"<ol> <li>\u670d\u52a1\u7684\u7f16\u6392\u8981\u5b9e\u73b0\u8ba1\u7b97\u8d44\u6e90\u5f39\u6027\u5316</li> <li>\u670d\u52a1\u7684\u6784\u5efa\u548c\u90e8\u7f72\u8981\u5b9e\u73b0\u9ad8\u5ea6\u81ea\u52a8\u5316</li> <li>\u4e8b\u4ef6\u9a71\u52a8\u57fa\u7840\u8bbe\u65bd\u6807\u51c6\u5316</li> </ol>"},{"location":"cloud/serverless/knative.html#build","title":"Build","text":"<p>Knative build\u4f5c\u4e3aKnative\u7684CI/CD\u57fa\u7840\u7ec4\u4ef6\uff0c\u5b9e\u73b0\u4e86\u670d\u52a1\u7684\u81ea\u52a8\u5316\u6784\u5efa\u548c\u90e8\u7f72\u80fd\u529b\u3002\u5728v0.8.0\u540e\u7531Tekton Pipelines\u9879\u76ee\u66ff\u4ee3\u3002</p>"},{"location":"cloud/serverless/knative.html#serving","title":"Serving","text":"<p>\u670d\u52a1\u7cfb\u7edf\uff0c\u7528\u6765\u914d\u7f6e\u5e94\u7528\u7684\u8def\u7531\u3001\u5347\u7ea7\u7b56\u7565\u3001\u81ea\u52a8\u6269\u7f29\u5bb9\u7b49\u529f\u80fd.</p>"},{"location":"cloud/serverless/knative.html#eventing","title":"Eventing","text":"<p>KNative\u81ea\u7136\u4e5f\u4f1a\u5b9a\u4e49\u81ea\u5df1\u7684\u4e8b\u4ef6\u7c7b\u578b\uff0c\u9664\u6b64\u4e4b\u5916\uff0cKNative\u8fd8\u8054\u5408CNCF\u5728\u505a\u4e8b\u4ef6\u6807\u51c6\u5316\u7684\u5de5\u4f5c\uff0c\u76ee\u524d\u7684\u4ea7\u51fa\u662fCloudEvents\u8fd9\u4e2a\u9879\u76ee\u3002</p> <p>\u4e8b\u4ef6\u7cfb\u7edf\uff0c\u7528\u6765\u81ea\u52a8\u5b8c\u6210\u4e8b\u4ef6\u7684\u7ed1\u5b9a\u548c\u89e6\u53d1\u3002</p>"},{"location":"cloud/serverless/openfaas.html","title":"OpenFaas","text":"<p>Serverless Functions, Made Simple. OpenFaaS\u00ae makes it simple to deploy both functions and existing code to Kubernetes.</p> <p>OpenFaaS \u51fd\u6570\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\uff0c\u5e76\u4e14\u6bcf\u4e2a\u5bb9\u5668\u5fc5\u987b\u9075\u5b88\u7b80\u5355\u7684\u7ea6\u5b9a \uff1a\u5b83\u4f5c\u4e3a\u76d1\u542c\u5728\u9884\u8bbe\u7aef\u53e3\uff08\u9ed8\u8ba4\u4e3a 8080\uff09\u4e0a\u7684 HTTP \u670d\u52a1\u5668\uff0c\u4e34\u65f6\u5b58\u50a8\u5e76\u4e14\u662f\u65e0\u72b6\u6001\u7684\u3002</p> <ul> <li>\u652f\u6301 K8s / OpenShift / Faasd\uff08\u5355\u673a\uff09\uff1b</li> </ul>"},{"location":"cloud/serverless/openfaas.html#_1","title":"\u539f\u7406","text":"<p>\u901a\u8fc7\u6dfb\u52a0Watchdog\u7a0b\u5e8f(\u4e00\u4e2a\u5c0f\u578b\u7684Golang HTTP\u670d\u52a1\u5668)\uff0c\u5c06\u4efb\u4f55Docker\u955c\u50cf\u90fd\u6dfb\u52a0\u5230\u4e00\u4e2aserverless\u51fd\u6570\u4e2d\u3002</p>"},{"location":"cloud/serverless/openfaas.html#watchdog","title":"\u7ecf\u5178 watchdog","text":"<ul> <li>\u6bcf\u6b21\u51fd\u6570\u8c03\u7528\u90fd\u542f\u52a8\u5355\u72ec\u7684\u8fdb\u7a0b\uff1b</li> <li>\u4efb\u4f55\u4f7f\u7528 *stdio* \u6d41\u8fdb\u884c I/O \u5904\u7406\u7684\u7a0b\u5e8f\uff08\u5305\u62ec\u6700\u559c\u6b22\u7684 CLI \u5de5\u5177\uff09\u90fd\u53ef\u4ee5\u90e8\u7f72\u4e3a OpenFaaS \u51fd\u6570</li> </ul>"},{"location":"cloud/serverless/openfaas.html#watchdog_1","title":"\u53cd\u5411\u4ee3\u7406 watchdog","text":"<ul> <li>watchdog \u53ea\u521b\u5efa\u4e00\u6b21\u51fd\u6570\u7684\u8fdb\u7a0b\uff0c\u5e76\u5c06\u5176\u5f53\u6210\uff08\u957f\u671f\u8fd0\u884c\u7684\uff09\u4e0a\u6e38\u670d\u52a1\u5668\uff1b</li> </ul>"},{"location":"cloud/serverless/openfaas.html#_2","title":"\u5176\u4ed6\u8fd0\u884c\u65f6\u6a21\u5f0f","text":"<p>\u95ee\u98981\uff1a\u7ecf\u5178\u8fd0\u884c\u65f6\u6a21\u5f0f\u5728\u5c06\u51fd\u6570\u7ed3\u679c\u53d1\u9001\u56de\u8c03\u7528\u65b9\u4e4b\u524d\u7f13\u51b2\u4e86\u51fd\u6570\u7684\u6574\u4e2a\u54cd\u5e94\u3002\u4f46\u5982\u679c\u54cd\u5e94\u7684\u5927\u5c0f\u8d85\u51fa\u4e86\u5bb9\u5668\u7684\u5185\u5b58\u600e\u4e48\u529e\uff1f</p> <ul> <li>OpenFaaS \u63d0\u4f9b\u4e86Streaming\u6a21\u5f0f\uff0c\u8be5\u6a21\u5f0f\u4ecd\u7136\u4e3a\u6bcf\u4e2a\u8c03\u7528\u521b\u5efa\u8fdb\u7a0b\uff0c\u4f46\u6dfb\u52a0\u4e86\u54cd\u5e94\u6d41\u3002</li> </ul> <p>\u95ee\u98982\uff1a\u7ecf\u5178\u8fd0\u884c\u6a21\u5f0f\u5982\u4f55\u63d0\u4f9b\u6587\u4ef6\u670d\u52a1\uff1b</p> <ul> <li>OpenFaaS \u63d0\u4f9b\u4e86Static\u6a21\u5f0f\uff0c\u63d0\u4f9bHTTP\u6587\u4ef6\u670d\u52a1</li> </ul>"},{"location":"cloud/serverless/openfaas.html#_3","title":"\u67b6\u6784","text":""},{"location":"cloud/serverless/openfaas.html#kubernetes-openfaasfaas-nets","title":"Kubernetes \u4e0a\u7684 OpenFaaS\uff08faas-nets\uff09","text":"<ul> <li>API \u7f51\u5173\u6210\u4e3a\u6807\u51c6\uff08\u90e8\u7f72+\u670d\u52a1\uff09\u5bf9\uff1b</li> <li>\u6bcf\u4e2a\u51fd\u6570\u4e5f\u6210\u4e3a\uff08\u90e8\u7f72+\u670d\u52a1\uff09\u5bf9\uff1b</li> <li>Kubernetes \u4f5c\u4e3a\u4e00\u4e2a\u6570\u636e\u5e93\u5de5\u4f5c\uff0c\u6bd4\u5982\u5217\u51fa\u6240\u6709\u7684\u90e8\u7f72\u51fd\u6570\u5217\u8868\uff1b</li> </ul>"},{"location":"cloud/serverless/openfaas.html#containerd-openfaasfaasd","title":"Containerd \u4e0a\u7684 OpenFaaS\uff08faasd\uff0c\u5355\u673a\uff09","text":"<ul> <li>\u88ab\u8bbe\u8ba1\u4e3a\u5728 IoT \u8bbe\u5907\u4e0a\u6216 VM \u4e2d\u8fd0\u884c\uff1b</li> <li>\u4f7f\u7528 containerd \u7684\u539f\u751f <code>pause</code> \uff08\u901a\u8fc7cgroup freezers\uff09\u548c\u8d85\u5feb\u901f\u51fd\u6570\u51b7\u542f\u52a8\u5feb\u901f\u6269\u5c55\u5230\u96f6\uff1b</li> <li>containerd \u548c faasd \u4f5c\u4e3a systemd \u670d\u52a1\u8fdb\u884c\u7ba1\u7406\uff0c\u56e0\u6b64\u4f1a\u81ea\u52a8\u5904\u7406\u65e5\u5fd7\u3001\u91cd\u542f\u7b49\uff1b</li> <li>\u6ca1\u6709 Kubernetes DNS\uff0c\u4f46 faasd \u786e\u4fdd DNS \u5728\u51fd\u6570\u4e4b\u95f4\u5171\u4eab\u4ee5\u7b80\u5316\u4e92\u64cd\u4f5c\uff1b</li> <li>containerd \u626e\u6f14\u7740\u6570\u636e\u5e93\u7684\u89d2\u8272\uff08\u5982\u679c\u670d\u52a1\u5668\u6302\u4e86\uff0c\u72b6\u6001\u4e22\u5931\uff0c\u51fd\u6570\u9700\u8981\u91cd\u65b0\u90e8\u7f72\uff09\uff1b</li> <li>\u6ca1\u6709\u5f00\u7bb1\u5373\u7528\u7684\u9ad8\u53ef\u7528\u6027\u6216\u6c34\u5e73\u6269\u5c55\uff08\u53c2\u89c1 issue/225\uff09</li> </ul>"},{"location":"cloud/serverless/serverless.html","title":"Serverless","text":"<p>\u65e0\u670d\u52a1\u5668\u8ba1\u7b97\u53ef\u4ee5\u63d0\u4f9b\u4ee5\u4e0b\u4e00\u79cd\u6216\u4e24\u79cd\u670d\u52a1\uff1a</p> <ul> <li>\u51fd\u6570\u5373\u670d\u52a1 (Functions-as-a-Service\uff0dFaaS\uff09;</li> <li>\u540e\u7aef\u5373\u670d\u52a1(Backend-as-a-Service\uff0dBaaS\uff09\u3002</li> </ul> <p>\u65e0\u670d\u52a1\u5668\u8ba1\u7b97\u6240\u63d0\u4f9b\u7684\u670d\u52a1\u5305\u62ec\uff1a</p> <ul> <li> <p>\u6709\u65f6\u95f4\u9650\u5236\u7684\u65e0\u72b6\u6001\u51fd\u6570\u4f5c\u4e3a\u6267\u884c\u7a0b\u5e8f\u903b\u8f91\u7684\u670d\u52a1 API\uff1b</p> </li> <li> <p>\u4e00\u79cd\u7ba1\u7406\u7a0b\u5e8f\u72b6\u6001\u7684\u5bf9\u8c61\u5b58\u50a8\u7cfb\u7edf\u3002</p> </li> </ul>"},{"location":"cloud/serverless/serverless.html#_1","title":"\u4f7f\u7528\u573a\u666f","text":"<ul> <li>\u5f02\u6b65\u3001\u5e76\u53d1\u3001\u6613\u4e8e\u5e76\u884c\u5316\u6210\u72ec\u7acb\u5de5\u4f5c\u5355\u5143\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff1b</li> <li>\u4f4e\u9891\u6216\u6709\u96f6\u661f\u8bf7\u6c42\uff0c\u4f46\u5177\u6709\u8f83\u5927\u4e0d\u53ef\u9884\u6d4b\u6269\u5bb9\u53d8\u5316\u9700\u6c42\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff1b</li> <li>\u65e0\u72b6\u6001\uff0c\u77ed\u671f\u8fd0\u884c\uff0c\u5bf9\u51b7\u542f\u52a8\u5ef6\u8fdf\u4e0d\u654f\u611f\u7684\u5de5\u4f5c\u8d1f\u8f7d\uff1b</li> <li>\u4e1a\u52a1\u9700\u6c42\u53d8\u5316\u8fc5\u901f\uff0c\u8981\u6c42\u5feb\u901f\u5f00\u53d1\u5b9e\u73b0\u7684\u573a\u666f\uff1b</li> </ul>"},{"location":"cloud/serverless/serverless.html#_2","title":"\u5f00\u6e90\u6846\u67b6","text":"<p>Apache OpenWhisk</p> <p>OpenFaaS</p> <p>Knative</p>"},{"location":"cloud/virtualize/index.html","title":"\u865a\u62df\u5316","text":""},{"location":"cloud/virtualize/index.html#kvm","title":"KVM","text":"<p>KVM\u662flinux\u5185\u6838\u7684\u6a21\u5757\uff0c\u5b83\u9700\u8981CPU\u7684\u652f\u6301\uff0c\u91c7\u7528\u786c\u4ef6\u8f85\u52a9\u865a\u62df\u5316\u6280\u672fIntel-VT\uff0cAMD-V\uff0c \u5185\u5b58\u7684\u76f8\u5173\u5982Intel\u7684EPT\u548cAMD\u7684RVI\u6280\u672f\uff0cGuest OS\u7684CPU\u6307\u4ee4\u4e0d\u7528\u518d\u7ecf\u8fc7Qemu\u8f6c\u8bd1\uff0c\u76f4\u63a5\u8fd0\u884c\uff0c\u5927\u5927\u63d0\u9ad8\u4e86\u901f\u5ea6\uff0c KVM\u901a\u8fc7/dev/kvm\u66b4\u9732\u63a5\u53e3\uff0c\u7528\u6237\u6001\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7ioctl\u51fd\u6570\u6765\u8bbf\u95ee\u8fd9\u4e2a\u63a5\u53e3\u3002</p> <ul> <li>\u53ea\u80fd\u63d0\u4f9bCPU\u548c\u5185\u5b58\u7684\u865a\u62df\u5316\uff0c\u5fc5\u987b\u7ed3\u5408QEMU\u624d\u80fd\u6784\u6210\u4e00\u4e2a\u5b8c\u6210\u7684\u865a\u62df\u5316\u6280\u672f\uff1b</li> <li>\u7b80\u5355\u76f4\u63a5\u7684\u7406\u89e3\u5c31\u662f\uff1aQEMU\u662f\u4e2a\u8ba1\u7b97\u673a\u6a21\u62df\u5668\uff0c\u800cKVM\u4e3a\u8ba1\u7b97\u673a\u7684\u6a21\u62df\u63d0\u4f9b\u52a0\u901f\u529f\u80fd\u3002</li> </ul>"},{"location":"cloud/virtualize/index.html#qemu","title":"Qemu","text":"<p>A generic and open source machine emulator and virtualizer.</p> <p>Qemu \u662f\u7eaf\u8f6f\u4ef6\u5b9e\u73b0\u7684\u865a\u62df\u5316\u6a21\u62df\u5668\uff0c\u51e0\u4e4e\u53ef\u4ee5\u6a21\u62df\u4efb\u4f55\u786c\u4ef6\u8bbe\u5907\u3002</p> <ul> <li> <p>\u6240\u6709\u7684\u6307\u4ee4\u90fd\u8981\u7ecf Qemu \u8fc7\u4e00\u624b\uff0c\u6027\u80fd\u975e\u5e38\u4f4e\uff1b</p> </li> <li> <p>\u751f\u4ea7\u73af\u5883\u4e2d\u914d\u5408 KVM \u6765\u5b8c\u6210\u865a\u62df\u5316\uff08\u786c\u4ef6\u8f85\u52a9\u7684\u865a\u62df\u5316\uff0c\u8d1f\u8d23 \u6bd4\u8f83\u7e41\u7410\u7684 CPU \u548c\u5185\u5b58\u865a\u62df\u5316\uff09\uff0c\u800c Qemu \u5219\u8d1f\u8d23 I/O \u865a\u62df\u5316\uff1b</p> </li> </ul>"},{"location":"cloud/virtualize/index.html#_2","title":"\u67b6\u6784","text":"<p>\u4ece\u672c\u8d28\u4e0a\u770b\uff0c\u865a\u62df\u51fa\u7684\u6bcf\u4e2a\u865a\u62df\u673a\u5bf9\u5e94 host \u4e0a\u7684\u4e00\u4e2a Qemu \u8fdb\u7a0b\uff0c\u800c\u865a\u62df\u673a\u7684\u6267\u884c\u7ebf\u7a0b\uff08\u5982 CPU \u7ebf\u7a0b\u3001I/O \u7ebf\u7a0b\u7b49\uff09\u5bf9\u5e94 Qemu \u8fdb\u7a0b\u7684\u4e00\u4e2a\u7ebf\u7a0b\u3002</p> <p></p> <p>\u601d\u8def\u662f\u91c7\u7528\u4e8c\u8fdb\u5236\u6307\u4ee4\u7ffb\u8bd1\u6280\u672f\uff0c\u4e3b\u8981\u662f\u63d0\u53d6 guest \u4ee3\u7801\uff0c\u7136\u540e\u5c06\u5176\u7ffb\u8bd1\u6210 TCG \u4e2d\u95f4\u4ee3\u7801\uff0c\u6700\u540e\u518d\u5c06\u4e2d\u95f4\u4ee3\u7801\u7ffb\u8bd1\u6210 host \u6307\u5b9a\u67b6\u6784\u7684\u4ee3\u7801\u3002</p> <p></p>"},{"location":"cloud/virtualize/index.html#qemu-kvm","title":"Qemu-kvm","text":"<p>Qemu\u5c06KVM\u6574\u5408\u8fdb\u6765\uff0c\u901a\u8fc7ioctl\u8c03\u7528/dev/kvm\u63a5\u53e3\uff0c\u5c06\u6709\u5173CPU\u6307\u4ee4\u7684\u90e8\u5206\u4ea4\u7531\u5185\u6838\u6a21\u5757\u6765\u505a\u3002</p> <p>Qemu\u6a21\u62df\u5176\u4ed6\u7684\u786c\u4ef6\uff0c\u5982Network, Disk\uff0c\u540c\u6837\u4f1a\u5f71\u54cd\u8fd9\u4e9b\u8bbe\u5907\u7684\u6027\u80fd\uff0c \u4e8e\u662f\u53c8\u4ea7\u751f\u4e86pass through\u534a\u865a\u62df\u5316\u8bbe\u5907virtio_blk, virtio_net\uff0c\u63d0\u9ad8\u8bbe\u5907\u6027\u80fd\u3002</p> <p></p>"},{"location":"cloud/virtualize/index.html#libvirt","title":"Libvirt","text":"<p>libvirt\u662f\u76ee\u524d\u4f7f\u7528\u6700\u4e3a\u5e7f\u6cdb\u7684\u5bf9KVM\u865a\u62df\u673a\u8fdb\u884c\u7ba1\u7406\u7684\u5de5\u5177\u548cAPI\u3002Libvirtd\u662f\u4e00\u4e2adaemon\u8fdb\u7a0b\uff0c \u53ef\u4ee5\u88ab\u672c\u5730\u7684virsh\u8c03\u7528\uff0c\u4e5f\u53ef\u4ee5\u88ab\u8fdc\u7a0b\u7684virsh\u8c03\u7528\uff0cLibvirtd\u8c03\u7528qemu-kvm\u64cd\u4f5c\u865a\u62df\u673a\u3002</p> <ul> <li>libvirt \u7ba1\u7406\u8bf8\u5982QEMU/KVM\uff0cXen,VMWare\u3001Microsoft Hyper-V\u3001IBM PowerVM\u7b49\u5e73\u53f0\u7684hypervisor\u3002\u4e5f\u53ef\u4ee5\u7ba1\u7406LXC\u3001OpenVZ\u5bb9\u5668\u7b49</li> </ul> <p></p>"},{"location":"cloud/virtualize/index.html#_3","title":"\u5bb9\u5668\u751f\u6001","text":"<p>\u5bb9\u5668\u955c\u50cf\u6807\u51c6\uff08image spec\uff09\u3002</p>"},{"location":"cloud/virtualize/index.html#_4","title":"\u5bb9\u5668\u8fd0\u884c\u65f6\u6807\u51c6","text":"<p>\u5bb9\u5668\u8fd0\u884c\u65f6\u6807\u51c6 \uff08runtime spec\uff09\u7684\u5b9e\u73b0\uff1a</p> <ul> <li>Low-Level \u5bb9\u5668\u8fd0\u884c\u65f6\uff1a\u8d1f\u8d23\u4e3a\u5bb9\u5668\u5efa\u7acbnamespaces\u548ccgroups</li> <li>runc\uff1a\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u5982runc</li> <li>runv\uff1a\u57fa\u4e8e\u865a\u62df\u673a\u7684\u8fd0\u884c\u65f6\uff0c\u901a\u8fc7\u865a\u62df\u5316 guest kernel\uff0c\u5c06\u5bb9\u5668\u548c\u4e3b\u673a\u9694\u79bb\u5f00\u6765\uff0c\u5982 kata, Firecracker</li> <li>runsc\uff1arunc + safety\uff0c\u5982gvisor\uff0c\u901a\u8fc7\u62e6\u622a\u5e94\u7528\u7a0b\u5e8f\u7684\u6240\u6709\u7cfb\u7edf\u8c03\u7528\uff0c\u63d0\u4f9b\u5b89\u5168\u9694\u79bb\u7684\u8f7b\u91cf\u7ea7\u5bb9\u5668\u8fd0\u884c\u65f6\u6c99\u7bb1\u3002</li> <li>High-Level\u5bb9\u5668\u8fd0\u884c\u65f6\uff1a\u9664\u4e86LowLevel\uff0c\u8fd8\u9700\u955c\u50cf\u683c\u5f0f\u3001\u955c\u50cf\u7ba1\u7406\u548c\u5171\u4eab\u955c\u50cf\u76f8\u5173\u7684API\u63a5\u53e3\u548c\u7279\u6027</li> <li>dockershim</li> <li>containerd</li> <li>cri-o</li> </ul> <p>Kubernetes \u53ea\u9700\u652f\u6301 containerd \u7b49high-level container runtime\u5373\u53ef\u3002</p> <p></p> <p>Docker Vs ContainerD Vs crio</p> <p></p>"},{"location":"cloud/virtualize/index.html#runc","title":"Runc","text":"<p>CLI tool for spawning and running containers according to the OCI specification.</p> <p>Please note that runc is a low level tool not designed with an end user in mind. </p> <ul> <li>runc fully supports cgroup v2 (unified mode) since v1.0.0-rc93</li> </ul> <p>In order to enable seccomp support you will need to install libseccomp on your platform.</p> <p>\u2014runc\u9700\u8981seccomp\u7684\u652f\u6301\uff0cseccomp\u662f\u4e00\u4e2aLinux\u7cfb\u7edf\u8c03\u7528\u7684\u201c\u7ba1\u7406\u8fc7\u6ee4\u201d\u5de5\u5177\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u5b83\u9650\u5236\u5e94\u7528\u7684\u6743\u9650</p> <p>\u5bb9\u5668\u8fd0\u884c\u65f6\u6807\u51c6\u7684\u53c2\u8003\u5b9e\u73b0\uff1a</p> <ul> <li>\u4ece Docker \u7684 libcontainer \u4e2d\u8fc1\u79fb\u800c\u6765\u7684\uff0c\u5b9e\u73b0\u4e86\u5bb9\u5668\u542f\u505c\u3001\u8d44\u6e90\u9694\u79bb\u7b49\u529f\u80fd\u3002</li> </ul>"},{"location":"cloud/virtualize/index.html#containerd","title":"Containerd","text":"<p>An open and reliable container runtime. CNCF gradulated project.</p> <p>containerd \u662f\u4e00\u4e2a\u5de5\u4e1a\u7ea7\u6807\u51c6\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u5b83\u5f3a\u8c03\u7b80\u5355\u6027\u3001\u5065\u58ee\u6027\u548c\u53ef\u79fb\u690d\u6027\uff0c\u5176\u529f\u80fd\u5305\u62ec\uff1a</p> <ul> <li>\u7ba1\u7406\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\uff08\u4ece\u521b\u5efa\u5bb9\u5668\u5230\u9500\u6bc1\u5bb9\u5668\uff09</li> <li>\u62c9\u53d6/\u63a8\u9001\u5bb9\u5668\u955c\u50cf</li> <li>\u5b58\u50a8\u7ba1\u7406\uff08\u7ba1\u7406\u955c\u50cf\u53ca\u5bb9\u5668\u6570\u636e\u7684\u5b58\u50a8\uff09</li> <li>\u8c03\u7528 runc \u8fd0\u884c\u5bb9\u5668\uff08\u4e0e runc \u7b49\u5bb9\u5668\u8fd0\u884c\u65f6\u4ea4\u4e92\uff09</li> <li>\u7ba1\u7406\u5bb9\u5668\u7f51\u7edc\u63a5\u53e3\u53ca\u7f51\u7edc</li> </ul>"},{"location":"cloud/virtualize/index.html#cri-o","title":"cri-o","text":"<p>Open Container Initiative-based implementation of Kubernetes Container Runtime Interface.</p>"},{"location":"cloud/virtualize/index.html#kata","title":"Kata","text":"<p>Kata Containers is an open source project and community working to build a standard implementation of lightweight Virtual Machines (VMs) that feel and perform like containers, but provide the workload isolation and security advantages of VMs.</p>"},{"location":"cloud/virtualize/index.html#gvisor","title":"Gvisor","text":"<p>Application Kernel for Containers.</p> <p>gVisor is an application kernel, written in Go, that implements a substantial portion of the Linux system call interface. It provides an additional layer of isolation between running applications and the host operating system.</p> <p>gVisor includes an Open Container Initiative (OCI) runtime called <code>runsc</code> that makes it easy to work with existing container tooling. The <code>runsc</code> runtime integrates with Docker and Kubernetes, making it simple to run sandboxed containers.</p>"},{"location":"cloud/virtualize/index.html#_5","title":"\u5176\u5b83","text":""},{"location":"cloud/virtualize/index.html#podman","title":"Podman","text":"<p>Podman \u53ef\u4ee5\u7ba1\u7406\u548c\u8fd0\u884c\u4efb\u4f55\u7b26\u5408 OCI\uff08Open Container Initiative\uff09\u89c4\u8303\u7684\u5bb9\u5668\u548c\u5bb9\u5668\u955c\u50cf\u3002Podman \u63d0\u4f9b\u4e86\u4e00\u4e2a\u4e0e Docker \u517c\u5bb9\u7684\u547d\u4ee4\u884c\u524d\u7aef\u6765\u7ba1\u7406 Docker \u955c\u50cf\u3002</p> <ul> <li>\u4e0d\u9700\u8981\u5728\u4f60\u7684\u7cfb\u7edf\u4e0a\u8fd0\u884c\u4efb\u4f55\u5b88\u62a4\u8fdb\u7a0b\uff0c\u5e76\u4e14\u5b83\u4e5f\u53ef\u4ee5\u5728\u6ca1\u6709 root \u6743\u9650\u7684\u60c5\u51b5\u4e0b\u8fd0\u884c\u3002</li> </ul>"},{"location":"cloud/virtualize/containerd.html","title":"Containerd","text":"<p>An open and reliable container runtime. CNCF gradulated project.</p> <p>containerd \u662f\u4e00\u4e2a\u5de5\u4e1a\u7ea7\u6807\u51c6\u7684\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u5b83\u5f3a\u8c03\u7b80\u5355\u6027\u3001\u5065\u58ee\u6027\u548c\u53ef\u79fb\u690d\u6027\uff0c\u5176\u529f\u80fd\u5305\u62ec\uff1a</p> <ul> <li>\u7ba1\u7406\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\uff08\u4ece\u521b\u5efa\u5bb9\u5668\u5230\u9500\u6bc1\u5bb9\u5668\uff09</li> <li>\u62c9\u53d6/\u63a8\u9001\u5bb9\u5668\u955c\u50cf</li> <li>\u5b58\u50a8\u7ba1\u7406\uff08\u7ba1\u7406\u955c\u50cf\u53ca\u5bb9\u5668\u6570\u636e\u7684\u5b58\u50a8\uff09</li> <li>\u8c03\u7528 runc \u8fd0\u884c\u5bb9\u5668\uff08\u4e0e runc \u7b49\u5bb9\u5668\u8fd0\u884c\u65f6\u4ea4\u4e92\uff09</li> <li>\u7ba1\u7406\u5bb9\u5668\u7f51\u7edc\u63a5\u53e3\u53ca\u7f51\u7edc</li> </ul>"},{"location":"cloud/virtualize/containerd.html#_1","title":"\u67b6\u6784","text":""},{"location":"cloud/virtualize/containerd.html#_2","title":"\u914d\u7f6e","text":"<p>containerd \u53ef\u4ee5\u4fee\u6539 http://docker.io \u5bf9\u5e94\u7684 endpoint\uff08\u9ed8\u8ba4\u4e3ahttps://registry-1.docker.io\uff09\uff0c\u800c docker \u65e0\u6cd5\u4fee\u6539\u3002</p>"},{"location":"cloud/virtualize/docker.html","title":"Moby(Docker)","text":"<p>Docker\u516c\u53f8\u76f4\u63a5\u628a\u539fDocker\u9879\u76ee\u6539\u540d\u6210\u4e86Moby\uff1ahttps://github.com/moby/moby</p> <p>\u53c2\u8003\u4e66\u7c4d\uff1a\u300aDocker \u5bb9\u5668\u4e0e\u5bb9\u5668\u4e91\u300b\uff0c\u300a\u6df1\u5165\u5256\u6790Kubenetes\u300b</p> <p>docker  =  image + cgroup + namespace</p> <ul> <li>image \u89e3\u51b3\u7684\u662f\u6253\u5305\u95ee\u9898\uff0c\u76f8\u5bf9\u4e8e\u4f20\u7edfPaas\uff0c\u4fdd\u8bc1\u5f00\u53d1/\u751f\u4ea7\u73af\u5883\u7684\u4e00\u81f4\u6027\uff1b</li> <li>\u5b8c\u6574\u7684\u6587\u4ef6\u7cfb\u7edf\uff1arootfs\uff08chroot\uff09\uff1b</li> <li>\u81ea\u5b9a\u4e49\u7684\u6253\u5305\u6d41\u7a0b\uff1aDockerfile\uff1b</li> <li>cgroup \u548c namespace \u63d0\u4f9b\u8fd0\u884c\u7684\u6c99\u76d2\uff0c\u662fLinux\u7684\u673a\u5236\uff0c\u8ddf\u4f20\u7edfPaas\u4e00\u81f4\uff1b</li> </ul>"},{"location":"cloud/virtualize/docker.html#_1","title":"\u57fa\u7840\u77e5\u8bc6","text":"<ul> <li>\u955c\u50cf\u662f\u591a\u5c42\u5b58\u50a8\uff0c\u6bcf\u4e00\u5c42\u7684\u4e1c\u897f\u5e76\u4e0d\u4f1a\u5728\u4e0b\u4e00\u5c42\u88ab\u5220\u9664\uff0c\u4f1a\u4e00\u76f4\u8ddf\u968f\u7740\u955c\u50cf\uff1b</li> <li>\u547d\u4ee4\u884c\u5de5\u5177docker\u4e0eDocker daemon\u5efa\u7acb\u901a\u4fe1\uff0cDocker daemon\u662fDocker\u5b88\u62a4\u8fdb\u7a0b\uff0c\u8d1f\u8d23\u63a5\u6536\u5e76\u5206\u53d1\u6267\u884cDocker\u547d\u4ee4\uff1b</li> <li>docker\u547d\u4ee4\u6267\u884c\u9700\u8981\u83b7\u53d6root\u6743\u9650\uff0c\u7ed1\u5b9a\u5c5e\u4e8eroot\u7684Unix Socket\uff1b</li> <li> <p>\u540c\u4e00\u53f0\u673a\u5668\u4e0a\u7684\u6240\u6709\u5bb9\u5668\u5171\u4eab\u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u6838\u3002</p> </li> <li> <p>\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u914d\u7f6e\u5185\u6838\u53c2\u6570\u3001\u52a0\u8f7d\u989d\u5916\u5185\u6838\u6a21\u5757\u3001\u4e0e\u5185\u6838\u76f4\u63a5\u4ea4\u4e92\uff0c\u662f\u5168\u5c40\u53ef\u89c1\u7684\u3002</p> </li> <li> <p>docker\u955c\u50cf\u8fd0\u884c\u65f6\uff0c\u4f1a\u5148\u521b\u5efa\u4e00\u4e2a\u5bb9\u5668\u521d\u59cb\u5316\u8fdb\u7a0b\uff08dockerinit\uff09\uff0c\u5b8c\u6210\u6839\u76ee\u5f55\u51c6\u5907\u3001\u8bbe\u5907\u6302\u8f7d\u7b49\u521d\u59cb\u5316\u64cd\u4f5c\uff0c\u5728\u901a\u8fc7<code>execv()</code>\u7cfb\u7edf\u8c03\u7528\u8ba9\u5e94\u7528\u8fdb\u7a0b\u53d6\u4ee3\u81ea\u5df1\u6210\u4e3a\u5bb9\u5668<code>PID=1</code>\u7684\u8fdb\u7a0b\uff1b</p> </li> </ul>"},{"location":"cloud/virtualize/docker.html#_2","title":"\u955c\u50cf\u6587\u4ef6","text":"<p>Docker\u4f7f\u7528\u4e86Linux\u672c\u8eab\u7684bootfs\uff0c\u53ea\u9700\u8981\u5b89\u88c5\u81ea\u5df1\u6240\u9700\u7684rootfs\u3002</p> <ul> <li> <p>\u5bb9\u5668Volume\u91cc\u7684\u4fe1\u606f\u4e0d\u4f1a\u88ab<code>docker commit</code>\u63d0\u4ea4\uff0c\u4f46\u662f\u6302\u8f7d\u70b9\u76ee\u5f55\u4f1a\u51fa\u73b0\u5728\u65b0\u7684\u955c\u50cf\u4e2d\u3002</p> </li> <li> <p>\u955c\u50cf\u7684\u5c42\u653e\u5728<code>/var/lib/docker/aufs/diff</code>\u76ee\u5f55\u4e0b\uff0c\u88ab\u8054\u5408\u6302\u8f7d\u5728<code>/var/lib/docker/aufs/mnt</code>\u4e2d\u3002</p> </li> </ul>"},{"location":"cloud/virtualize/docker.html#_3","title":"\u8054\u5408\u6302\u8f7d","text":"<p>\u955c\u50cf\u8bbe\u8ba1\u8fc7\u7a0b\u4e2d\u5f15\u5165\u4e86\u5c42\uff08layer\uff09\u7684\u6982\u5ff5\uff0c\u5236\u4f5c\u955c\u50cf\u7684\u6bcf\u4e00\u6b65\u90fd\u4f1a\u751f\u6210\u4e00\u4e2a\u5c42\uff0c\u5f62\u6210\u589e\u91cf\u7684rootfs\uff1b</p> <ul> <li>UnionFS\uff1a\u5c06\u4e0d\u540c\u4f4d\u7f6e\u7684\u76ee\u5f55\u8054\u5408\u6302\u8f7d\uff08union mount\uff09\u5230\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\uff1b</li> </ul>"},{"location":"cloud/virtualize/docker.html#_4","title":"\u8bfb\u5199\u5c42","text":"<p>readwrite\u5c42\uff0c\u5220\u9664foo\u6587\u4ef6\u4f1a\u901a\u8fc7\u65b0\u589e<code>.wh.foo</code>\u6587\u4ef6\uff0c\u8fdb\u884c\"\u906e\u6321\"\u3002</p> <p>docker commit\u548cpush\u6307\u4ee4\u4fdd\u5b58\u4fee\u6539\u8fc7\u7684\u53ef\u8bfb\u5199\u5c42\uff0c\u5f62\u6210\u65b0\u7684\u955c\u50cf\uff0c\u5171\u522b\u4eba\u4f7f\u7528\u3002</p>"},{"location":"cloud/virtualize/docker.html#init","title":"Init\u5c42","text":"<p>Init\u5c42\u662f\u4e00\u4e2a\u4ee5<code>-init</code>\u7ed3\u5c3e\u7684\u5c42\uff0c\u5939\u5728\u53ea\u8bfb\u5c42\u548c\u53ef\u8bfb\u5199\u5c42\u4e4b\u95f4\uff0c\u7528\u4e8e\u5b58\u653e<code>/etc/hosts</code>\u3001<code>/etc/resolv.conf</code>\u7b49\u4fe1\u606f\uff1b</p> <ul> <li>\u8fd9\u4e9b\u6587\u4ef6\u672c\u6765\u5c5e\u4e8eUbuntu\u955c\u50cf\u7684\u4e00\u90e8\u5206\uff0c\u4f46\u662f\u7528\u6237\u4f1a\u5728\u542f\u52a8\u5bb9\u5668\u65f6\u4fee\u6539\u4ed6\u4eec\uff0c\u4f46\u662f\u8fd9\u4e9b\u4fee\u6539\u4e0d\u5177\u5907\u666e\u9002\u6027\uff0c\u4e0d\u5e94\u8be5\u88abcommit\u3002</li> </ul>"},{"location":"cloud/virtualize/docker.html#_5","title":"\u53ea\u8bfb\u5c42","text":"<p>readonly + whiteout</p>"},{"location":"cloud/virtualize/docker.html#_6","title":"\u5b58\u50a8\u9a71\u52a8","text":"<p>\u652f\u6301\uff1aaufs, brtfs, device mapper, vfs, overlay2</p> <ul> <li>\u901a\u8fc7<code>docker info</code>\u67e5\u770b\u5e95\u5c42<code>Storage Driver</code>\uff0ccentos\u4e0a\u4e3a<code>overlay2</code>\uff1b</li> </ul> <p>docker\u4e2d\u4f7f\u7528overlay2\u5b58\u50a8\u7684\u539f\u7406\uff1ahttps://zhuanlan.zhihu.com/p/41958018</p> <p>overlay2\u6bd4overlay\u66f4\u5c11\u6d88\u8017inode\uff1a</p> <ul> <li>\u76ee\u5f55\u672c\u8eab\u4e5f\u662f\u4e2a\u6587\u4ef6\uff0c\u4e14\u4e0d\u53ef\u8fdb\u884chardlink\uff0c\u4e8e\u662f\u4e0a\u5c42\u5bf9\u4e0b\u5c42\u7684\u5f15\u7528\u5fc5\u987b\u65b0\u5efa\u4e00\u4e2a\u76ee\u5f55\uff0c\u4e5f\u5360\u7528\u4e00\u4e2ainode\u3002\u76ee\u5f55\u91cc\u53ea\u6709\u76ee\u5f55\u9879\uff0c\u672c\u8eab\u4f53\u79ef\u5f88\u5c0f\uff0c\u5c5e\u4e8e\u5178\u578b\u7684\u5c0f\u6587\u4ef6\u3002\u5982\u679c\u4e0b\u5c42\u7684\u6587\u4ef6\u7ed3\u6784\u4e00\u590d\u6742\uff0c\u5c31\u8981\u521b\u5efa\u51fa\u5f88\u591a\u540c\u6b3e\u7684\u76ee\u5f55\u6765\uff0c\u5bf9inode\u8d44\u6e90\u6765\u8bf4\u662f\u4e2a\u5de8\u5927\u7684\u6d88\u8017\uff1b</li> <li><code>overlay2</code>\u4f7f\u7528\u4e86id\uff08\u5c42\u6587\u4ef6\u5939\u4e0b\u7684lower\u6587\u4ef6\uff09\u6620\u5c04\u4e0b\u5c42\u7684\u65b9\u5f0f\u53bb\u67e5\u627e\u4e0b\u5c42\u6587\u4ef6\u3002\u67e5\u627e\u7684\u8fc7\u7a0b\u4e2d\uff0c\u7f13\u5b58\u5176\u7ed3\u679c\u5230\u5185\u5b58\u91cc\u51cf\u5c11\u4e0b\u6b21\u67e5\u627e\u7684\u65f6\u95f4\uff0c\u51cf\u8f7b\u4e86inode\u521b\u5efa\u7684\u5927\u91cf\u6d88\u8017\u3002</li> </ul>"},{"location":"cloud/virtualize/docker.html#_7","title":"\u8d44\u6e90\u9694\u79bb","text":"<p>\u57fa\u4e8eLinux\u4e2d\u7684<code>Namespace</code>\u673a\u5236\u3002</p>"},{"location":"cloud/virtualize/docker.html#user-namespace","title":"\u7528\u6237\uff08User Namespace\uff09","text":"<p>\u672c\u8282\u638c\u63e1\u7528\u6237\u540d\u3001\u7ec4\u540d\u3001\u7528\u6237 id(uid)\u548c\u7ec4 id(gid)\u5982\u4f55\u5728\u5bb9\u5668\u5185\u7684\u8fdb\u7a0b\u548c\u4e3b\u673a\u7cfb\u7edf\u4e4b\u95f4\u6620\u5c04\u3002</p> <p>docker \u9ed8\u8ba4\u5e76\u6ca1\u6709\u542f\u7528 user namesapce\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5bb9\u5668\u4e2d\u7684\u8fdb\u7a0b\u4ee5 root \u7528\u6237\u6743\u9650\u8fd0\u884c\uff0c\u5e76\u4e14\u8fd9\u4e2a root \u7528\u6237\u548c\u5bbf\u4e3b\u673a\u4e2d\u7684 root \u662f\u540c\u4e00\u4e2a\u7528\u6237\u3002</p> <p>\u5185\u6838\u4f7f\u7528\u7684\u662f uid \u548c gid\uff0c\u800c\u4e0d\u662f\u7528\u6237\u540d\u548c\u7ec4\u540d\uff0c\u5224\u65ad\u5bf9\u6587\u4ef6\u7684\u8bbf\u95ee\u6743\u9650\u3002</p> <ul> <li>\u5185\u6838\u63a7\u5236\u7684 uid \u548c gid \u5219\u4ecd\u7136\u53ea\u6709\u4e00\u5957\uff0c\u540c\u4e00\u4e2a uid \u5728\u5bbf\u4e3b\u673a\u548c\u5bb9\u5668\u4e2d\u4ee3\u8868\u7684\u662f\u540c\u4e00\u4e2a\u7528\u6237\uff08\u5373\u4fbf\u5728\u4e0d\u540c\u7684\u5730\u65b9\u663e\u793a\u4e86\u4e0d\u540c\u7684\u7528\u6237\u540d\uff09\uff1b</li> </ul> <p>\u901a\u8fc7 docker run \u547d\u4ee4\u7684<code>--user</code> \u53c2\u6570\u6307\u5b9a\u5bb9\u5668\u4e2d\u8fdb\u7a0b\u7684\u7528\u6237\u8eab\u4efd\uff1b</p> <p>\u901a\u8fc7 Dockerfile \u4e2d\u7684<code>RUN useradd -r -u 1000 -g appuser; USER appuser</code> \u6dfb\u52a0\u548c\u6307\u5b9a\u5bb9\u5668\u5185\u7684\u7528\u6237\uff1b</p>"},{"location":"cloud/virtualize/docker.html#_8","title":"\u914d\u7f6e","text":"<p>\u521b\u5efa /etc/docker/daemon.json \u6587\u4ef6\uff1a</p> <pre><code>$ sudo touch /etc/docker/daemon.json\n</code></pre> <p>\u7136\u540e\u7f16\u8f91\u5176\u5185\u5bb9\u5982\u4e0b(\u5982\u679c\u8be5\u6587\u4ef6\u5df2\u7ecf\u5b58\u5728\uff0c\u4ec5\u6dfb\u52a0\u4e0b\u9762\u7684\u914d\u7f6e\u9879\u5373\u53ef)\uff0c\u5e76\u91cd\u542f docker \u670d\u52a1\uff1a</p> <pre><code>{\n  \"userns-remap\": \"default\"\n}\n</code></pre> <pre><code># docker \u4f1a\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3a dockremap \u7684\u7528\u6237\n# /etc/subuid \u548c /etc/subgid \u6587\u4ef6\u4e2d\u4f1a\u6dfb\u52a0\u4e86\u65b0\u7528\u6237 dockremap\n# /var/lib/docker \u76ee\u5f55\u4e0b\u4f1a\u65b0\u5efa\u4e86\u5bf9\u5e94\u7684dockremap\u7684\u76ee\u5f55\n$ sudo systemctl restart docker.service\n</code></pre>"},{"location":"cloud/virtualize/docker.html#capability","title":"Capability\u9650\u5236","text":"<p><code>--cap-add=[] --cap-drop=[]</code></p> <p>\u8d85\u7ea7\u7528\u6237\u6743\u9650\u88ab\u5206\u4e3a\u82e5\u5e72\u7ec4\uff0c\u6bcf\u7ec4\u4ee3\u8868\u6240\u80fd\u6267\u884c\u7684\u7cfb\u7edf\u8c03\u7528\u64cd\u4f5c\u3002</p> <p>\u5bb9\u5668\u9ed8\u8ba4\u62e5\u6709\u7684\u80fd\u529b\u5305\u62ec\uff1a</p> <ul> <li>CHOWN\uff1a\u66f4\u6539\u6587\u4ef6UID\u548cGID\uff1b</li> <li>DAC_OVERRIDE\uff1a\u5ffd\u7565\u6587\u4ef6\u7684\u8bfb\u3001\u5199\u3001\u6267\u884c\u8bbf\u95ee\u6743\u9650\u68c0\u67e5\uff1b</li> <li>FSETID\uff1a\u6587\u4ef6\u4fee\u6539\u540e\u4fdd\u7559setuid/setgid\u6807\u5fd7\u4f4d\uff1b</li> <li>MKNOD\uff1a\u4f7f\u7528<code>mknod</code>\u521b\u5efa\u6307\u5b9a\u6587\u4ef6\uff1b</li> <li>NET_RAW\uff1a\u521b\u5efaRAW\u548cPACKET\u5957\u63a5\u5b57\uff1b</li> <li>SETGID\uff1a\u6539\u53d8\u8fdb\u7a0b\u7ec4ID\uff1b</li> <li>SETUID\uff1a\u6539\u53d8\u8fdb\u7a0b\u7528\u6237ID\uff1b</li> <li>SETFCAP\uff1a\u5411\u5176\u4ed6\u8fdb\u7a0b\u8f6c\u79fb\u6216\u5220\u9664\u80fd\u529b\uff1b</li> <li>SYS_REBOOT\uff1a\u4f7f\u7528<code>reboot</code>\u6216<code>kexec_load</code>\uff1b</li> <li>SYS_CHROOT\uff1a\u4f7f\u7528chroot\uff1b</li> <li>KILL\uff1a\u53d1\u9001\u4fe1\u53f7\uff1b</li> <li>NET_BIND_SERVICE\uff1a\u7ed1\u5b9a\u5e38\u7528\u7aef\u53e3\uff08&lt; 1024\uff09</li> <li>AUDIT_EDIT\uff1a\u5ba1\u8ba1\u65e5\u5fd7\u5199\u5165</li> </ul>"},{"location":"cloud/virtualize/docker.html#_9","title":"\u8d44\u6e90\u9650\u5236","text":"<p>CPU/Memroy \u5728\u5bb9\u5668\u5185\u662f\u770b\u5230\u9650\u5236\u7684\uff0c\u8fd8\u662f\u5bbf\u4e3b\u673a\u7684\u6240\u6709\u4fe1\u606f\uff1f</p>"},{"location":"cloud/virtualize/docker.html#cgroup","title":"\u57fa\u4e8e<code>cgroup</code>\u9650\u5236","text":"<ul> <li>Docker daemon \u4f1a\u5728\u5355\u72ec\u6302\u8f7d\u6bcf\u4e00\u4e2a\u5b50\u7cfb\u7edf\u7684\u63a7\u5236\u7ec4\u76ee\u5f55\uff08\u5982<code>/sys/fs/cgroup/cpu</code>\uff09\u4e0b\u521b\u5efa\u540d\u4e3adocker\u7684\u63a7\u5236\u7ec4\uff1b</li> <li>\u5728docker\u63a7\u5236\u7ec4\u91cc\uff0c\u4e3a\u6bcf\u4e2a\u5bb9\u5668\u521b\u5efa\u4e00\u4e2a\u4ee5\u5bb9\u5668ID\u4e3a\u540d\u79f0\u7684\u5bb9\u5668\u63a7\u5236\u7ec4\uff0c\u5bb9\u5668\u5185\u7684\u6240\u6709\u8fdb\u7a0b\u53f7\u4f1a\u5199\u5230\u8be5\u63a7\u5236\u7ec4tasks\u4e2d\uff0c\u5e76\u5728\u63a7\u5236\u6587\u4ef6\u4e2d\uff08\u5982<code>cpu.cfs_quota_us</code>\u5199\u5165\u9884\u8bbe\u7f6e\u7684\u503c\uff09\uff1b</li> </ul>"},{"location":"cloud/virtualize/docker.html#_10","title":"\u78c1\u76d8\u8d44\u6e90\u9650\u5236","text":"<p>cgroup\u4e0d\u652f\u6301\u5bf9\u78c1\u76d8\u8d44\u6e90\u8fdb\u884c\u9650\u5236\uff0c\u800c<code>Quota</code>\u6280\u672f\u57fa\u4e8e\u7528\u6237\u548c\u6587\u4ef6\u7cfb\u7edf\uff0c\u800c\u4e0d\u662f\u57fa\u4e8e\u8fdb\u7a0b\u6216\u8005\u76ee\u5f55\u78c1\u76d8\u9650\u989d\u3002</p> <p>\u53ef\u884c\u65b9\u6848\uff1a</p> <ol> <li>\u6bcf\u4e2a\u5bb9\u5668\u4e00\u4e2a\u7528\u6237\uff0c\u6240\u6709\u7528\u6237\u5171\u4eab\u5bbf\u4e3b\u673a\u4e00\u5757\u78c1\u76d8\uff0c\u4ec5\u5bf9\u666e\u901a\u7528\u6237\u6709\u6548\uff1b</li> <li>\u9009\u62e9\u652f\u6301\u5bf9\u67d0\u4e00\u4e2a\u76ee\u5f55\u53ef\u4ee5\u9650\u989d\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u5982XFS\uff1b</li> <li>\u521b\u5efa\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff0c\u6b64\u6587\u4ef6\u7cfb\u7edf\u4ec5\u4f9b\u67d0\u4e00\u4e2a\u5bb9\u5668\u4f7f\u7528\u3002</li> </ol>"},{"location":"cloud/virtualize/docker.html#_11","title":"\u5bb9\u5668\u6d41\u91cf\u9650\u5236","text":"<p>Trafic Controller \u662fLinux\u7684\u6d41\u91cf\u63a7\u5236\u6a21\u5757\uff0c\u539f\u7406\u662f\u4e3a\u6570\u636e\u5305\u5efa\u7acb\u961f\u5217\uff0c\u5e76\u4e14\u5b9a\u4e49\u961f\u5217\u4e2d\u6570\u636e\u5305\u7684\u53d1\u9001\u89c4\u5219\u3002</p>"},{"location":"cloud/virtualize/docker.html#fork","title":"Fork\u70b8\u5f39","text":"<p>\u5feb\u901f\u521b\u5efa\u5927\u91cf\u8fdb\u7a0b\uff08\u6307\u6570\u5e42\uff09\uff0c\u6d88\u8017\u7cfb\u7edf\u5206\u914d\u8fdb\u7a0b\u7684\u53ef\u7528\u7a7a\u95f4\u4f7f\u8fdb\u7a0b\u8868\u9971\u548c\uff0c\u7cfb\u7edf\u65e0\u6cd5\u8fd0\u884c\u65b0\u7a0b\u5e8f</p> <ul> <li><code>ulimit</code>\u9650\u5236\u6700\u5927\u8fdb\u7a0b\u6570\uff1b</li> <li>\u5bf9\u7528\u6237UID\u8fdb\u884c\u9650\u5236\uff0c\u800c\u4e0d\u662f\u5bf9\u6bcf\u4e2a\u5bb9\u5668\u91cc\u80fd\u591f\u521b\u5efa\u7684\u8fdb\u7a0b\u6570\u9650\u5236\uff1b</li> <li>\u9650\u5236\u5185\u6838\u5185\u5b58\u4f7f\u7528\uff1bCgroup\u7684<code>memory.kmem.limit_in_bytes</code></li> <li>kmen\u8fd8\u4fdd\u5b58\u6587\u4ef6\u7cfb\u7edf\u76f8\u5173\u3001\u5185\u6838\u52a0\u5bc6\u7b49\u5185\u6838\u6570\u636e\uff0c\u9650\u5236\u53ef\u80fd\u5f71\u54cd\u5176\u4ed6\u6b63\u5e38\u64cd\u4f5c\uff1b</li> <li>cgroup pid\u5b50\u7cfb\u7edf\uff1b</li> </ul>"},{"location":"cloud/virtualize/docker.html#_12","title":"\u7f51\u7edc","text":""},{"location":"cloud/virtualize/docker.html#_13","title":"\u5355\u673a\u901a\u4fe1","text":"<p>docker \u63d0\u4f9b\u7ed9\u6211\u4eec\u591a\u79cd(4\u79cd)\u7f51\u7edc\u6a21\u5f0f\uff1a</p> <ul> <li>\u9ed8\u8ba4\u7f51\u7edc\u6a21\u5f0f \uff1a bridge\uff1b</li> <li>\u65e0\u7f51\u7edc\u6a21\u5f0f \uff1anone\uff0c\u6709\u72ec\u7acb\u7684network ns\uff0c\u4f46\u662f\u9700\u8981\u7528\u6237\u5355\u72ec\u914d\u7f6e\uff1b</li> <li>\u5bbf\u4e3b\u7f51\u7edc\u6a21\u5f0f \uff1ahost\uff0c\u4e0d\u5177\u5907\u72ec\u7acb\u7684network ns\uff1b</li> <li>\u5bb9\u5668\u7f51\u7edc\u6a21\u5f0f\uff1acontainer\uff0c\u65b0\u5bb9\u5668\u4e0e\u67d0\u4e2a\u5df2\u5b58\u5728\u7684\u5bb9\u5668\u5171\u4eabnetwork ns\uff0c\u5bb9\u5668\u95f4\u53ef\u901a\u8fc7\u56de\u73af\u7f51\u5361\u901a\u4fe1\uff1b</li> </ul>"},{"location":"cloud/virtualize/docker.html#bridge","title":"Bridge\u6a21\u5f0f","text":"<p>docker0 \u7f51\u5361/\u7f51\u6865\uff1a</p> <ul> <li>\u7f51\u6865\u7684\u6982\u5ff5\u7b49\u540c\u4e8e\u4ea4\u6362\u673a\uff0c\u4e3a\u8fde\u5728\u5176\u4e0a\u7684\u8bbe\u5907\u8f6c\u53d1\u6570\u636e\u5e27\uff0cveth\u76f8\u5f53\u4e8e\u7aef\u53e3\uff0c\u5de5\u4f5c\u5728\u4e8c\u5c42\uff0c\u4e0d\u9700\u8981IP\u4fe1\u606f\uff1b</li> <li>docker0\u4e5f\u662f\u4e8c\u5c42\u8bbe\u5907\uff0c\u4f46\u4e3a\u666e\u901a\u7684Linux\u7f51\u6865\uff0c\u53ef\u4ee5\u914d\u7f6eIP\uff0c\u4f5c\u4e3a\u5bb9\u5668\u7684\u9ed8\u8ba4\u7f51\u5173\uff1b</li> </ul> <p></p> <p>Docker\u5b89\u88c5\u597d\u65f6\uff0c\u5728iptables\u914d\u7f6eSNAT\u89c4\u5219\uff08\u6e90\u5730\u5740\u8f6c\u6362\uff09\uff0c\u53ef\u4ee5\u8bbf\u95ee\u5916\u90e8</p> <pre><code># \u5c06\u6e90\u5730\u5740172.17.0.0/16\u7684\u6570\u636e\u5305\uff08\u5bb9\u5668\u5185\u53d1\u51fa\u7684\u6570\u636e\uff09\u4e14\u4e0d\u662f\u4ecedocker0\u7f51\u5361\u53d1\u51fa\u65f6\u505aSNAT\u8f6c\u6362\n# \u8fd9\u6837\u4ece\u5bb9\u5668\u8bbf\u95ee\u5916\u7f51\u6d41\u91cf\u65f6\uff0c\u5916\u90e8\u770b\u6765\u5c31\u662f\u4ece\u5bbf\u4e3b\u673a\u53d1\u51fa\uff0c\u4e0d\u611f\u77e5\u5bb9\u5668\n-A POSTROUTING -s 172.17.0.0/16 ! -o docker0 -j MASQUEADE\n</code></pre> <p>\u5bb9\u5668\u4e0e\u5916\u90e8\u901a\u4fe1\u8fc7\u7a0b\u4e2d\uff0c\u6570\u636e\u5305\u5728\u591a\u4e2a\u7f51\u5361\u95f4\u7684\u8f6c\u53d1\uff08\u5982\u4ecedocker0\u7f51\u5361\u5230\u5bbf\u4e3b\u673aeth0\uff09\uff0c\u9700\u8981\u5f00\u542f\u5185\u6838\u7684<code>ip-forward</code>\u529f\u80fd\uff1a</p> <pre><code>echo 1 &gt; /proc/sys/net/ipv4/ip_forward\n</code></pre> <p>\u65b0\u589e\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u6dfb\u52a0iptables\u89c4\u5219\uff08\u8ba9\u5916\u90e8\u53ef\u4ee5\u8bbf\u95ee\u5bb9\u5668\u670d\u52a1\uff09\u505aDNAT\uff08\u76ee\u7684\u5730\u5740\u8f6c\u6362\uff09\uff1a</p> <ul> <li>\u8bb2\u8bbf\u95ee\u5bbf\u4e3b\u673a\u76845000\u7aef\u53e3\u7684\u6d41\u91cf\u8f6c\u53d1\u5230172.17.0.4:5000\u7684\u7aef\u53e3\uff08\u5bb9\u5668\u7684IP\u7aef\u53e3\uff09\uff1b</li> </ul> <pre><code># \u542f\u52a8 web \u5bb9\u5668\n$ sudo docker run -d -p 5000:5000 traning/webapp python app.py\n# \u67e5\u770b iptalbes \u89c4\u5219\n$ sudo iptables-save\n...\n*nat\n-A DOCKER ! -i docker0 -p tcp -m tcp --dport 5000 -j DNAT --to-destination 172.17.0.4:5000\n...\n*filter\n-A DOCKER -d 172.17.0.4/32 ! -i docker0 -o docker0 -p tcp -m tcp --dport 5000 -j ACCEPT\n</code></pre> <p>\u5bb9\u5668\u95f4\u4e92\u76f8\u901a\u4fe1\uff1a</p> <ul> <li>\u540c\u4e00\u53f0\u5bbf\u4e3b\u673a\u7684\u5bb9\u5668\u90fd\u9ed8\u8ba4\u8fde\u5728docker0\u7f51\u6865\u4e0a\uff0c\u5c5e\u4e8e\u4e00\u4e2a\u5b50\u7f51\uff1b</li> <li>Docker\u5728filter\u7684FORWARD\u94fe\u4e2d\u589e\u52a0\u4e00\u6761ACCEPT\u7684\u89c4\u5219\uff08--icc-true\uff09\uff1a</li> </ul> <pre><code>-A FORWARD -i docker0 -o docker0 -j ACCEPT\n</code></pre>"},{"location":"cloud/virtualize/docker.html#link","title":"Link\u6a21\u5f0f","text":"<p>\u7981\u7528icc\uff0c\u5bb9\u5668\u95f4\u4e0d\u80fd\u901a\u4fe1\uff0c\u540c\u65f6\u5bb9\u5668\u4ec5\u5141\u8bb8\u7279\u5b9a\u7684\u5176\u4ed6\u5bb9\u5668\u8bbf\u95ee\uff0c\u91c7\u7528\u7aef\u53e3\u6620\u5c04\u65b9\u5f0f\u4f1a\u88ab\u6240\u6709\u5bb9\u5668\u53ef\u8bbf\u95ee\u4e14\u9700\u8981\u505aNAT\u8f6c\u6362\uff0c\u6548\u7387\u4e0d\u9ad8\u3002</p> <p>\u5bb9\u5668\u521b\u5efa\u7684\u65f6\u5019\u901a\u8fc7<code>--link &lt;name or id&gt;:alias</code>\u53c2\u6570\uff0c\u5141\u8bb8\u7279\u5b9a\u5bb9\u5668\u95f4\u7684\u901a\u4fe1\uff1a</p> <pre><code>$ sudo docker run -d --name db training/postgres\n$ sudo docker run -d -P --name web --link db:webdb training/webapp python app.py\n</code></pre> <ul> <li>\u8bbe\u7f6e\u63a5\u53d7\u5bb9\u5668\u7684\u73af\u5883\u53d8\u91cf\uff1b</li> <li>\u66f4\u65b0\u63a5\u53d7\u5bb9\u5668\u7684<code>/etc/hosts</code>\u6587\u4ef6\uff1b</li> <li>\u6dfb\u52a0iptables\u89c4\u5219\u4f7f\u5bb9\u5668\u8fde\u63a5\u7684\u4e24\u4e2a\u5bb9\u5668\u53ef\u4ee5\u901a\u4fe1\uff1b</li> </ul>"},{"location":"cloud/virtualize/docker.html#_14","title":"\u8de8\u673a\u901a\u4fe1","text":""},{"location":"cloud/virtualize/docker.html#overlay","title":"overlay","text":"<p>\u5b9e\u73b0docker \u5bb9\u5668\u8de8\u4e3b\u673a\u4e92\u901a\u3002 \u63a8\u8350\u4f7f\u7528 overlay \u7f51\u7edc\u7c7b\u578b\u3002</p> <p>swarm\u5728\u8bbe\u8ba1\u4e4b\u521d\u662f\u4e3a\u4e86service(\u4e00\u7ec4container)\u800c\u670d\u52a1\u7684\uff0c\u56e0\u6b64\u901a\u8fc7swarm\u521b\u5efa\u7684overlay\u7f51\u7edc\u5728\u4e00\u5f00\u59cb\u5e76\u4e0d\u652f\u6301\u5355\u72ec\u7684container\u52a0\u5165\u5176\u4e2d\u3002\u4f46\u662f\u5728docker1.13, \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u201c--attach\u201d \u53c2\u6570\u58f0\u660e\u5f53\u524d\u521b\u5efa\u7684overlay\u7f51\u7edc\u53ef\u4ee5\u88abcontainer\u76f4\u63a5\u52a0\u5165\u3002</p> <pre><code>$ docker network create --driver=overlay --attachable name=myOverlayNe\n</code></pre> <p>swarm\u521b\u5efaoverlay\u7f51\u7edc\uff1a</p> <pre><code># Create swarm in one docker host\n$ docker swarm init \u2013advertise-address 172.100.1.17\n# Wait for worker node joined\n$ docker swarm join-token worker\n# docker swarm join-token worker\n$ docker swarm join --token SWMTKN-1-4kaj1vanh45ihjfgud7nfgaj099gtvrgssg4dxp4rikd1kt1p1-6bwep9vx83oppouz0rfz5scf9 172.100.1.17:2377\n# Create network on manager node --attachable \u662f\u5173\u952e\uff0c\u5b83\u8868\u660e\u8fd9\u4e2a\u7f51\u7edc\u662f\u53ef\u4ee5\u88abcontainer\u6240\u52a0\u5165\u3002\n$ docker network create -d overlay --attachable qrtOverlayNet\n</code></pre>"},{"location":"cloud/virtualize/docker.html#_15","title":"\u65e5\u5fd7","text":"<p>Docker \u5bb9\u5668\u5f15\u64ce\u5c06 stdout/stderr \u8f93\u51fa\u6d41\u91cd\u5b9a\u5411\u5230\u67d0\u4e2a \u65e5\u5fd7\u9a71\u52a8\uff08Logging Driver\uff09 \uff0c \u4ee5 JSON \u683c\u5f0f\uff08\u9ed8\u8ba4\uff09\u5199\u5165\u6587\u4ef6\uff08/var/lib/docker/containers/&lt;\u5bb9\u5668id&gt;/&lt;\u5bb9\u5668id&gt;-json.log\uff0c\u4e14\u4e0d\u4f1a\u9650\u5236\u5927\u5c0f\uff09\u3002</p>"},{"location":"cloud/virtualize/docker_cmds.html","title":"\u4f7f\u7528","text":""},{"location":"cloud/virtualize/docker_cmds.html#dockerfile","title":"Dockerfile","text":"<p>\u4e24\u79cd\u8fd0\u884c\u6a21\u5f0f\uff1a\u5efa\u8bae ENTRYPOINT \u548c CMD \u90fd\u4f7f\u7528 Exec \u6a21\u5f0f</p> <ul> <li>Shell \u6a21\u5f0f\uff1a\u4ee5<code>/bin/sh -c \"task command\"</code>\u7684\u65b9\u5f0f\u6267\u884c\u4efb\u52a1\u547d\u4ee4\uff0c\u5373\u7b49\u4ef7\u4e8e <code>[\"/bin/sh\", \"-c\", \"task command\"]</code></li> <li>\u6b64\u65f6<code>sh</code>\u662f\u7236\u8fdb\u7a0b\uff0c\u800c<code>task command</code>\u662f\u5b50\u8fdb\u7a0b\uff0c<code>sh</code>\u63a5\u53d7\u5230\u7684\u4fe1\u53f7\uff0c\u9ed8\u8ba4\u65e0\u6cd5\u4f20\u7ed9\u5b50\u8fdb\u7a0b\uff0c\u53ea\u80fd\u8d85\u65f6\u5f3a\u884cKill\uff1b</li> <li>Exec \u6a21\u5f0f\uff1a\u53ea\u6709\u4e00\u4e2a\u5355\u72ec\u7684\u8fdb\u7a0b</li> </ul> <pre><code># /bin/sh -c \"sleep 100\"  # \u547d\u4ee4\u6240\u542f\u52a8\u7684\u8fdb\u7a0b\u5173\u7cfb\n$ ps -ef |grep 500109 | grep -v grep\nroot      500109  500096  0 May21 pts/2    00:00:00 -bash\nroot     2356429  500109  0 09:26 pts/2    00:00:00 sleep 100\n# ps -ef |grep 500109 | grep -v grep # \u76f4\u63a5\u66ff\u6362\u5f53\u524d shell\uff0c\u9000\u51fa\u540e\u5f53\u524dshell\u9000\u51fa\uff1b\nroot      500109  500096  0 May21 pts/2    00:00:00 sleep 100\n</code></pre> <p><code>docker build</code> \u6839\u636e Dockerfile \u6784\u5efa\u955c\u50cf\uff1b</p>"},{"location":"cloud/virtualize/docker_cmds.html#_2","title":"\u6307\u4ee4\u96c6","text":"<pre><code># scratch\u662f\u7a7a\u767d\u955c\u50cf\n# FROM &lt;image&gt;:&lt;tag&gt;\n\n# MAINTAINER \n\n# \u5b9a\u4e49\u53d8\u91cf\uff0c\u5bb9\u5668\u8fd0\u884c\u65f6\u65e0\u7528\uff0c\u7c7b\u4f3c\u4e8e\u5b9a\u4e49\u5c40\u90e8\u53d8\u91cf\uff0c\u5728 docker build \u4e2d\u7528 --build-arg &lt;\u53c2\u6570\u540d&gt;=&lt;\u503c&gt; \u6765\u8986\u76d6\n# ARG &lt;key&gt;=&lt;value&gt;\n\n# \u73af\u5883\u53d8\u91cf\n# ENV &lt;key&gt;=&lt;value&gt;\n\n# \u6587\u4ef6\u62f7\u8d1d\uff0c&lt;src&gt; \u652f\u6301\u901a\u914d\u7b26\u548c\u591a\u4e2a\u6e90\n# COPY &lt;src&gt; &lt;dst&gt;\n\n# \u6240\u6709\u7684\u6587\u4ef6\u590d\u5236\u5747\u4f7f\u7528 COPY \u6307\u4ee4\uff0c\u4ec5\u5728\u9700\u8981\u672c\u5730\u6587\u4ef6\u81ea\u52a8\u89e3\u538b\u7f29\u7684\u573a\u5408\u4f7f\u7528 ADD\n# ADD &lt;src&gt; &lt;dst&gt;\n\n# RUN &lt;command&gt; (shell\u683c\u5f0f)\n# RUN  [\"executable\", \"param1\", \"param2\"] \uff08exec\u683c\u5f0f\uff0c\u63a8\u8350\uff09\n# \u5728\u524d\u4e00\u4e2a\u547d\u4ee4\u521b\u5efa\u51fa\u7684\u955c\u50cf\u57fa\u7840\u4e0a\u521b\u5efa\u4e00\u4e2a\u5bb9\u5668\uff0c\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\u547d\u4ee4\uff0c\u547d\u4ee4\u7ed3\u675f\u540e\u63d0\u4ea4\u5bb9\u5668\u4e3a\u65b0\u955c\u50cf\n\n# CMD &lt;command&gt; (shell\u683c\u5f0f)\n# CMD  [\"executable\", \"param1\", \"param2\"] \uff08exec\u683c\u5f0f\uff0c\u63a8\u8350\uff09\n# \u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u9ed8\u8ba4\u503c\uff0c\u914d\u5408ENTRYPOINT\u4f7f\u7528\uff0c\u4f1a\u88abdocker run\u547d\u4ee4\u65f6\u6307\u5b9a\u7684\u547d\u4ee4\u53c2\u6570\u8986\u76d6\n\n# \u8868\u793a\u8868\u793a\u9ed8\u8ba4\u7a0b\u5e8f\uff0cdocker run \u65f6\u6307\u5b9a\u7684 CMD \u547d\u4ee4\u4f1a\u88ab\u5f53\u505a\u53c2\u6570\u4f20\u5165\n# ENTRYPOINT &lt;command&gt; (shell\u683c\u5f0f)\n# ENTRYPOINT  [\"executable\", \"param1\", \"param2\"] \uff08exec\u683c\u5f0f\uff0c\u63a8\u8350\uff09\n# shell\u683c\u5f0f\u65f6\uff0c\u4f1a\u5ffd\u7565 CMD \u548c docker run\u7684\u547d\u4ee4\u7684\u53c2\u6570\uff0c\u8fd0\u884c\u5728 /bin.sh -c \u4e2d\uff0c\u975e1\u53f7\u8fdb\u7a0b\n\n# ONBUILD [INSTRUCTION]\n# \u6dfb\u52a0\u4e00\u4e2a\u5c06\u6765\u6267\u884c\u7684\u89e6\u53d1\u5668\u6307\u4ee4\u5230\u955c\u50cf\u4e2d\u3002\n\n# \u6307\u5b9a\u5f53\u524d\u7528\u6237\n# USER\n\n# \u6307\u5b9a\u5de5\u4f5c\u76ee\u5f55\n# WORKDIR\n\n# \u7aef\u53e3\u6620\u5c04\uff0c\u4e00\u822c\u4e0d\u5728 Dockerfile \u4e2d\u6307\u5b9a\uff0c\u800c\u662f docker \u547d\u4ee4\u884c\u4e2d\u4f7f\u7528\n# EXPOSE\n\n# \u6302\u8f7d\u5377\uff0c\u4e00\u822c\u4e0d\u5728 Dockerfile \u4e2d\u6307\u5b9a\uff0c\u800c\u662f docker \u547d\u4ee4\u884c\u4e2d\u4f7f\u7528\n# VOLUME\n</code></pre>"},{"location":"cloud/virtualize/docker_cmds.html#_3","title":"\u5b9e\u8df5","text":"<p>RUN\uff1a</p> <ul> <li> <p><code>RUN apt-get update &amp;&amp; apt-get install -y foo</code>\u5e94\u8be5\u653e\u4e00\u8d77\uff0c\u907f\u514d\u7f13\u5b58\u95ee\u9898\uff1b</p> </li> <li> <p>\u4e0d\u8981\u5c06\u6240\u6709\u7684\u547d\u4ee4\u5199\u5728\u4e00\u4e2aRUN\u6307\u4ee4\u4e2d\uff08\u9664\u975e\u7528\u4e8e\u7cbe\u7b80\u955c\u50cf\u5927\u5c0f\uff09\uff1b</p> </li> </ul> <p>Expose\uff1a</p> <ul> <li>\u4e0d\u8981\u5728Dockerfile\u4e2d\u505a\u7aef\u53e3\u6620\u5c04\uff0c\u7f3a\u4e4f\u53ef\u79fb\u690d\u6027\uff1b</li> </ul>"},{"location":"cloud/virtualize/docker_cmds.html#_4","title":"\u57fa\u672c\u547d\u4ee4","text":""},{"location":"cloud/virtualize/docker_cmds.html#exec","title":"exec","text":"<pre><code># \u5728\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u4e2d\u6267\u884c\u547d\u4ee4\n$ docker exec [OPTIONS] Container  Commands [Args]\n# \u4ea4\u4e92\u5f0f\n$ docker exec -it [OPTIONS] Container  Commands [Args]  \n</code></pre>"},{"location":"cloud/virtualize/docker_cmds.html#run","title":"run","text":"<pre><code>$ docker run [OPTION] [imageName] [shellCmds]\n# \u5982\u4e0b\uff0ccat /etc/os-release \u662f\u6267\u884c\u7684CMD\uff0c\u4f1a\u8986\u76d6DockerFile\u4e2d\u7684CMD\n$ docker run -it ubuntu cat /etc/os-release\n$ docker run -d -p 127.0.0.1:5000:5000/udp training/webapp python app.py\n</code></pre> <ul> <li>-t \uff1a \u5728\u5bb9\u5668\u5185\u6307\u5b9a\u4e00\u4e2a\u4f2a\u7ec8\u7aef\u6216\u8005\u7ec8\u7aef\uff1b  </li> <li>-i \uff1a \u5bf9\u5bb9\u5668\u5185\u7684\u6807\u51c6\u8f93\u5165\u8fdb\u884c\u4ea4\u4e92</li> <li>-d \uff1a \u540e\u53f0\u8fd0\u884c\uff0c\u8fd4\u56de\u552f\u4e00\u7684\u5bb9\u5668ID\uff1b     </li> <li>-v\uff1a\u6302\u8f7dvolume,     [host-dir]:[container-dir]:[rw|ro]</li> <li>-c\uff1a\u5206\u914d\u5bb9\u5668\u4e2d\u6240\u6709\u8fdb\u7a0b\u7684CPU\u7684share\u503c  </li> <li>-m\uff1a\u5206\u914d\u5bb9\u5668\u7684\u5185\u5b58\u603b\u91cf\uff0cB\u3001K\u3001M\u3001G\u5355\u4f4d</li> <li>-P :\u662f\u5bb9\u5668\u5185\u90e8\u7aef\u53e3\u968f\u673a\u6620\u5c04\u5230\u4e3b\u673a\u7684\u9ad8\u7aef\u53e3\uff1b    </li> <li>-p : \u662f\u5bb9\u5668\u5185\u90e8\u7aef\u53e3\u7ed1\u5b9a\u5230\u6307\u5b9a\u7684\u4e3b\u673a\u7aef\u53e3\u3002</li> <li>--rm\uff1a\u5bb9\u5668\u8fd0\u884c\u9000\u51fa\u540e\u81ea\u52a8\u5220\u9664</li> <li>--runtime string\uff1aRuntime to use for this container</li> </ul>"},{"location":"cloud/virtualize/docker_cmds.html#images","title":"images","text":"<p>docker images \u6765\u5217\u51fa\u672c\u5730\u4e3b\u673a\u4e0a\u7684\u955c\u50cf</p>"},{"location":"cloud/virtualize/docker_cmds.html#commit","title":"commit","text":"<p>\u5c06\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u5236\u4f5c\u65b0\u7684\u955c\u50cf\uff1b</p> <pre><code>$ docker commit [OPTIONS] Container [Reopsitory[:TAG]]\n</code></pre>"},{"location":"cloud/virtualize/docker_cmds.html#build","title":"build","text":"<p>\u6839\u636eDockerfile\u751f\u6210\u955c\u50cf</p> <pre><code># \u6839\u636e\u5f53\u524d\u76ee\u5f55\u4e0b\u7684Dockerfile\u751f\u6210helloworld\u955c\u50cf\n$ docker build -t helloworld .\n</code></pre>"},{"location":"cloud/virtualize/docker_cmds.html#tag","title":"tag","text":"<p>\u7ed9\u5bb9\u5668\u955c\u50cf\u8d77\u5b8c\u6574\u7684\u540d\u5b57</p> <pre><code>$ docker tag helloworld lzq/helloworld:v1\n</code></pre>"},{"location":"cloud/virtualize/docker_cmds.html#push","title":"push","text":"<p>\u5c06\u955c\u50cf\u63a8\u9001\u5230\u8fdc\u7a0b\u4ed3\u5e93</p> <pre><code>$ docker push lzq/helloworld:v1\n</code></pre>"},{"location":"cloud/virtualize/docker_cmds.html#rmi","title":"rmi","text":"<pre><code>$ docker rmi f8ab12e03d53\nError response from daemon: conflict: unable to delete f8ab12e03d53 (must be forced) - image is referenced in multiple repositories\n</code></pre> <p>\u5220\u9664\u65f6\u53ef\u4ee5\u7528repository\u548ctag\u7684\u65b9\u5f0f\u6765\u5220\u9664</p> <pre><code>$ docker rmi 192.168.0.1/you/tom:1.0.8\nUntagged:192.168.0.1/you/tom:1.0.8\n</code></pre>"},{"location":"cloud/virtualize/docker_cmds.html#exportsave","title":"export/save","text":"<p><code>docker export</code>\uff1a\u5c06\u5bb9\u5668\u7684\u6587\u4ef6\u7cfb\u7edf\u5bfc\u51fa\u4e3a<code>tar</code>\uff0c\u52a0\u8f7d\u4e3a<code>docker import</code></p> <ul> <li>\u5bb9\u5668\u6301\u4e45\u5316\uff08\u5355\u5c42Linux\u6587\u4ef6\u7cfb\u7edf\uff09\uff0c\u4e22\u5931\u5386\u53f2\uff0c\u52a0\u8f7d\u65f6\u53ef\u4ee5\u6307\u5b9a\u955c\u50cf\u540d\u79f0\uff1b</li> <li>\u9002\u5408\u57fa\u7840\u955c\u50cf\uff1b</li> </ul> <p><code>docker save</code>\uff1a\u955c\u50cf\u5bfc\u51fa\u4e3a <code>tar</code>\uff0c\u52a0\u8f7d\u4e3a<code>docker load</code></p> <ul> <li>\u955c\u50cf\u6301\u4e45\u5316\uff08\u5206\u5c42\u6587\u4ef6\u7cfb\u7edf\uff09\uff0c\u4e0d\u4e22\u5931\u5386\u53f2\u548c\u5c42\uff0c\u53ef\u901a\u8fc7<code>docker tag</code>\u547d\u4ee4\u5b9e\u73b0\u5c42\u56de\u6eda\uff1b</li> <li>\u52a0\u8f7d\u65f6\u4e0d\u53ef\u6307\u5b9a\u955c\u50cf\u540d\u79f0\uff1b</li> </ul>"},{"location":"cloud/virtualize/docker_deploy.html","title":"\u4f7f\u7528","text":""},{"location":"cloud/virtualize/docker_deploy.html#_2","title":"\u90e8\u7f72","text":"<pre><code># yum\u66f4\u65b0\nyum update\n\n# \u5b89\u88c5\u5fc5\u5907\u7cfb\u7edf\u8f6f\u4ef6\nyum install -y yum-utils device-mapper-persistent-data lvm2\n\n# \u6dfb\u52a0repo\nyum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n\n# \u66f4\u65b0yum\u7f13\u5b58\nyum makecache fast\n\n# \u5b89\u88c5docker\nyum -y install docker-ce\n\n# \u542f\u52a8 Docker \u540e\u53f0\u670d\u52a1\nsystemctl start docker\nsystemctl enable docker\n\n# \u6d4b\u8bd5\u8fd0\u884c hello-world\ndocker run hello-world\n</code></pre>"},{"location":"cloud/virtualize/docker_deploy.html#_3","title":"\u6e90\u4fee\u6539","text":"<p>\u4fee\u6539\u6216\u65b0\u589e <code>/etc/docker/daemon.json</code></p> <pre><code>{\n\"registry-mirrors\": \"https://docker.linkedbus.com\"\n}\n</code></pre> <p>\u7136\u540e\u6267\u884c\uff1a</p> <pre><code>systemctl daemon-reload\nsystemctl restart docker\n</code></pre>"},{"location":"cloud/virtualize/docker_deploy.html#faq","title":"FAQ","text":""},{"location":"cloud/virtualize/docker_deploy.html#no-route-to-host","title":"No route to host","text":""},{"location":"cloud/virtualize/docker_deploy.html#_4","title":"\u95ee\u9898\u63cf\u8ff0","text":"<p>\u5728centos\u90e8\u7f72docker\u955c\u50cf\u65f6\uff0c\u9047\u5230docker\u5bb9\u5668\u65e0\u6cd5\u8bbf\u95ee\u5bbf\u4e3b\u673aip\u7684\u95ee\u9898(\u7528\u7684wget\u5de5\u5177)\uff0c\u62a5\u9519\u4fe1\u606f\u4e3a\uff1aNo route to host\u3002\u800c\u4ecedocker\u5bb9\u5668\u4e2d\u8bbf\u95ee\u5bbf\u4e3b\u673a\u6240\u5728\u5c40\u57df\u7f51\u7684\u5176\u4ed6\u4e3b\u673a\u7684\u670d\u52a1\u662f\u53ef\u4ee5\u8bbf\u95ee\u7684\u3002</p>"},{"location":"cloud/virtualize/docker_deploy.html#_5","title":"\u539f\u56e0","text":"<p>docker\u5bb9\u5668\uff0c\u5176\u9ed8\u8ba4\u7f51\u7edc\u6a21\u5f0f\u91c7\u7528\u7684\u662fbridger\u6a21\u5f0f\u3002</p> <p>\u542f\u52a8docker\u65f6\uff0cdocker\u8fdb\u7a0b\u4f1a\u521b\u5efa\u4e00\u4e2a\u540d\u4e3adocker0\u7684\u865a\u62df\u7f51\u6865\uff0c\u7528\u4e8e\u5bbf\u4e3b\u673a\u4e0e\u5bb9\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u3002\u5f53\u542f\u52a8\u4e00\u4e2adocker\u5bb9\u5668\u65f6\uff0cdocker\u5bb9\u5668\u5c06\u4f1a\u9644\u52a0\u5230\u865a\u62df\u7f51\u6865\u4e0a\uff0c\u5bb9\u5668\u5185\u7684\u62a5\u6587\u901a\u8fc7docker0\u5411\u5916\u8f6c\u53d1\u3002</p> <p>\u5982\u679cdocker\u5bb9\u5668\u8bbf\u95ee\u5bbf\u4e3b\u673a\uff0c\u90a3\u4e48docker0\u7f51\u6865\u5c06\u62a5\u6587\u76f4\u63a5\u8f6c\u53d1\u5230\u672c\u673a\uff0c\u62a5\u6587\u7684\u6e90\u5730\u5740\u662fdocker0\u7f51\u6bb5\u7684\u5730\u5740\u3002</p> <p>\u800c\u5982\u679cdocker\u5bb9\u5668\u8bbf\u95ee\u5bbf\u4e3b\u673a\u4ee5\u5916\u7684\u673a\u5668\uff0cdocker\u7684SNAT\u7f51\u6865\u4f1a\u5c06\u62a5\u6587\u7684\u6e90\u5730\u5740\u8f6c\u6362\u4e3a\u5bbf\u4e3b\u673a\u7684\u5730\u5740\uff0c\u901a\u8fc7\u5bbf\u4e3b\u673a\u7684\u7f51\u5361\u5411\u5916\u53d1\u9001\u3002</p> <p>\u56e0\u6b64\uff0c\u5f53docker\u5bb9\u5668\u8bbf\u95ee\u5bbf\u4e3b\u673a\u65f6\uff0c\u5bbf\u4e3b\u673a\u670d\u52a1\u7aef\u53e3\u4f1a\u88ab\u9632\u706b\u5899\u62e6\u622a\uff0c\u4ece\u800c\u65e0\u6cd5\u8fde\u901a\u5bbf\u4e3b\u673a\uff0c\u51fa\u73b0No route to host\u7684\u9519\u8bef\u3002\u800c\u8bbf\u95ee\u5bbf\u4e3b\u673a\u6240\u5728\u5c40\u57df\u7f51\u5185\u7684\u5176\u4ed6\u673a\u5668\uff0c\u7531\u4e8e\u62a5\u6587\u7684\u6e90\u5730\u5740\u662f\u5bbf\u4e3b\u673aip\uff0c\u56e0\u6b64\uff0c\u4e0d\u4f1a\u88ab\u76ee\u7684\u673a\u5668\u9632\u706b\u5899\u62e6\u622a\uff0c\u6240\u4ee5\u53ef\u4ee5\u8bbf\u95ee\u3002</p>"},{"location":"cloud/virtualize/docker_deploy.html#_6","title":"\u89e3\u51b3\u65b9\u6848","text":"<p>\u65b9\u6cd5\u4e00\uff1a\u5173\u95ed\u9632\u706b\u5899</p> <p>centos\u5173\u95ed\u9632\u706b\u5899\u7684\u64cd\u4f5c\u4e3a</p> <p><code>systemctl stop firewalld</code></p> <p>\u65b9\u6cd5\u4e8c\uff1a \u5728\u9632\u706b\u5899\u4e0a\u5f00\u53d1\u6307\u5b9a\u7aef\u53e3</p> <pre><code>firewall-cmd --zone=public --add-port=8090/tcp --permanent\nfirewall-cmd --reload\n</code></pre>"},{"location":"cloud/virtualize/gpu.html","title":"GPU \u865a\u62df\u5316\u548c\u5171\u4eab","text":"<p>docker \u539f\u751f\u53ef\u4ee5\u901a\u8fc7 <code>`--device /dev/nvidia0:/dev/nvidia0</code>\u7684\u65b9\u5f0f\uff0c\u652f\u6301GPU\u4f7f\u7528\u548c\u9694\u79bb\uff0c\u4f46\u662f\u65e0\u6cd5\u5bf9GPU \u53ef\u7528\u6027\u505a\u5224\u65ad\u3002</p>"},{"location":"cloud/virtualize/gpu.html#_1","title":"\u865a\u62df\u5316","text":""},{"location":"cloud/virtualize/gpu.html#nvidia-gpu","title":"Nvidia GPU","text":""},{"location":"cloud/virtualize/gpu.html#_2","title":"\u5b89\u88c5\u4f7f\u7528","text":"<p>Installing the NVIDIA Container Toolkit \u2014 NVIDIA Container Toolkit 1.17.0 documentation</p>"},{"location":"cloud/virtualize/gpu.html#_3","title":"\u539f\u7406","text":"<p>libnvidia-container</p> <ul> <li>\u63d0\u4f9b\u4e00\u4e2a\u5e93\u548c\u7b80\u5355\u7684CLI\u5de5\u5177\uff0c\u4ee5\u5b9e\u73b0\u5728\u5bb9\u5668\u5f53\u4e2d\u652f\u6301\u4f7f\u7528GPU\u8bbe\u5907\u7684\u76ee\u6807\u3002</li> </ul> <p>nvidia-container-toolkit</p> <ul> <li>\u5305\u542b nvidia-container-runtime \u548c nvidia-docker\uff1b</li> <li>\u5b9e\u73b0<code>runC prestart hook</code>\u63a5\u53e3\u7684\u811a\u672c\uff1a\u8be5\u811a\u672c\u5728runC\u521b\u5efa\u4e00\u4e2a\u5bb9\u5668\u4e4b\u540e\uff0c\u542f\u52a8\u8be5\u5bb9\u5668\u4e4b\u524d\u8c03\u7528\uff0c\u5176\u4e3b\u8981\u4f5c\u7528\u5c31\u662f\u4fee\u6539\u4e0e\u5bb9\u5668\u76f8\u5173\u8054\u7684config.json\uff0c\u6ce8\u5165\u4e00\u4e9b\u5728\u5bb9\u5668\u4e2d\u4f7f\u7528NVIDIA GPU\u8bbe\u5907\u6240\u9700\u8981\u7684\u4e00\u4e9b\u4fe1\u606f\uff08\u6bd4\u5982\uff1a\u9700\u8981\u6302\u8f7d\u54ea\u4e9bGPU\u8bbe\u5907\u5230\u5bb9\u5668\u5f53\u4e2d\uff09\uff1b</li> <li>\u5c06\u5bb9\u5668runC spec\u4f5c\u4e3a\u8f93\u5165\uff0c\u7136\u540e\u5c06<code>nvidia-container-toolkit</code>\u811a\u672c\u4f5c\u4e3a\u4e00\u4e2a<code>prestart hook</code>\u6ce8\u5165\u5230runC spec\u4e2d\uff0c\u5c06\u4fee\u6539\u540e\u7684runC spec\u4ea4\u7ed9runC\u5904\u7406\u3002</li> <li>CUDA Runtime API\u548cCUDA Libraries\u901a\u5e38\u8ddf\u5e94\u7528\u7a0b\u5e8f\u4e00\u8d77\u6253\u5305\u5230\u955c\u50cf\u91cc\uff0c\u800cCUDA Driver API\u662f\u5728\u5bbf\u4e3b\u673a\u91cc\uff0c\u9700\u8981\u5c06\u5176\u6302\u8f7d\u5230\u5bb9\u5668\u91cc\u624d\u80fd\u88ab\u4f7f\u7528\u3002</li> </ul> <p></p> <p>\u6b63\u5e38\u521b\u5efa\u4e00\u4e2a\u5bb9\u5668\u7684\u6d41\u7a0b\uff1a</p> <p>docker --&gt; dockerd --&gt; containerd\u2013&gt; containerd-shim --&gt;runc --&gt; container-process</p> <p>\u521b\u5efa\u4e00\u4e2a\u4f7f\u7528GPU\u7684\u5bb9\u5668</p> <p>docker\u2013&gt; dockerd --&gt; containerd --&gt; containerd-shim\u2013&gt; nvidia-container-runtime --&gt; nvidia-container-runtime-hook --&gt; libnvidia-container --&gt; runc \u2013 &gt; container-process</p>"},{"location":"cloud/virtualize/gpu.html#amd-gpu","title":"AMD GPU","text":"<p>ROCm/ROCm-docker: Dockerfiles for the various software layers defined in the ROCm software platform</p>"},{"location":"cloud/virtualize/gpu.html#_4","title":"\u5171\u4eab","text":"<p>GPU \u5929\u7136\u9002\u5408\u5411\u91cf\u8ba1\u7b97\u3002\u5e38\u7528\u573a\u666f\u53ca API\uff1a</p> \u573a\u666f API \u6e38\u620f\u6e32\u67d3 OpenGL\uff0cDirectX\uff0cMetal \u5a92\u4f53\u7f16\u89e3\u7801 VAAPI\uff0cVDPAU \u6df1\u5ea6\u5b66\u4e60\u8ba1\u7b97 Cuda\uff0cOpenCL <p>\u57fa\u672c\u75db\u70b9\uff1a</p> <ul> <li>\u5bb9\u5668\u7684GPU\u5229\u7528\u7387\u4e0d\u591f\u9ad8\uff0c\u7279\u522b\u662f\u63a8\u7406\u4efb\u52a1\uff1b</li> <li>\u4e3a\u4e86\u63d0\u9ad8GPU\u7684\u5229\u7528\u7387\u3001\u907f\u514d\u7b97\u529b\u6d6a\u8d39\uff0c\u9700\u8981\u5728\u5355\u4e2aGPU\u4e0a\u8fd0\u884c\u591a\u4e2a\u5bb9\u5668\uff1b</li> </ul>"},{"location":"cloud/virtualize/gpu.html#nvidia","title":"Nvidia \u65b9\u6848","text":""},{"location":"cloud/virtualize/gpu.html#_5","title":"\u5206\u65f6\u5171\u4eab","text":"<p>Time-Slicing GPUs in Kubernetes \u2014 NVIDIA GPU Operator 23.9.1 documentation</p> <p>NVIDIA/k8s-device-plugin: NVIDIA device plugin for Kubernetes (github.com)</p> <p>\u65f6\u95f4\u7247\u5229\u7528 GPU \u65f6\u95f4\u7247\u8c03\u5ea6\u7a0b\u5e8f\uff0c\u5b83\u901a\u8fc7\u65f6\u95f4\u5171\u4eab\u5e76\u53d1\u6267\u884c\u591a\u4e2a CUDA \u8fdb\u7a0b\u3002</p> <ul> <li>\u57fa\u672c\u4e0a\u6bcf\u4e2a GPU \u67b6\u6784\u90fd\u652f\u6301\u65f6\u95f4\u5206\u7247\uff1b</li> <li>\u8fdb\u7a0b\u4e4b\u95f4\u7684\u4e0d\u65ad\u5207\u6362\u4f1a\u4ea7\u751f\u8ba1\u7b97\u65f6\u95f4\u5f00\u9500\uff1b</li> <li>\u5171\u4eab GPU \u7684\u8fdb\u7a0b\u4e4b\u95f4\u4e0d\u63d0\u4f9b\u4efb\u4f55\u7ea7\u522b\u7684\u5185\u5b58\u9694\u79bb\uff0c\u4e5f\u4e0d\u4f1a\u63d0\u4f9b\u4efb\u4f55\u5185\u5b58\u5206\u914d\u9650\u5236\uff0c\u5bfc\u81f4OOM\u3002</li> </ul> <p>\u90e8\u7f72 nvidia gpu plugin \u65f6\uff0c\u5c06 gpu \u5212\u5206\u4e3a 100 \u4efd</p> <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: nvidia-config\n  namespace: kube-system\ndata:\n  config: |\n    {\n       \"version\": \"v1\",\n       \"sharing\": {\n         \"timeSlicing\": {\n           \"resources\": [\n             {\n               \"name\": \"nvidia.com/gpu\",\n               \"replicas\": 10,\n             }\n           ]\n         }\n       }\n    }\n</code></pre>"},{"location":"cloud/virtualize/gpu.html#gpu_1","title":"\u591a\u5b9e\u4f8b GPU","text":"<p>NVIDIA Ampere\u548cHopper\u67b6\u6784\u4e0a\u53ef\u7528\u7684\u4e00\u9879\u6280\u672f\uff0c\u5b83\u5141\u8bb8\u5c06 GPU \u5b89\u5168\u5730\u5212\u5206\u4e3a\u6700\u591a\u4e03\u4e2a\u72ec\u7acb\u7684 GPU \u5b9e\u4f8b\uff0c\u6bcf\u4e2a\u5b9e\u4f8b\u90fd\u5b8c\u5168\u9694\u79bb\uff0c\u5177\u6709\u81ea\u5df1\u7684\u9ad8\u5e26\u5bbd\u5185\u5b58\u3001\u7f13\u5b58\u548c\u8ba1\u7b97\u6838\u5fc3\u3002</p> <p>\u5b64\u7acb\u7684 GPU \u5207\u7247\u79f0\u4e3a MIG \u8bbe\u5907\uff0c\u5b83\u4eec\u7684\u547d\u540d\u91c7\u7528\u6307\u793a\u8bbe\u5907\u7684\u8ba1\u7b97\u548c\u5185\u5b58\u8d44\u6e90\u7684\u683c\u5f0f</p> <ul> <li><code>2g.20gb</code> \u5bf9\u5e94\u5177\u6709 20 GB \u5185\u5b58\u7684 GPU \u5207\u7247\uff1b</li> <li>\u7f3a\u4e4f\u7075\u6d3b\u6027\uff0c\u5e76\u4e14\u4ec5\u4e0e\u5c11\u6570 GPU \u67b6\u6784\uff08Ampere \u548c Hopper\uff09\u517c\u5bb9\uff1b</li> </ul>"},{"location":"cloud/virtualize/gpu.html#mps","title":"\u591a\u8fdb\u7a0b\u670d\u52a1MPS","text":"<p>\u5c06\u591a\u4e2a\u8fdb\u7a0b\u7684 CUDA Context\uff0c\u5408\u5e76\u5230\u4e00\u4e2a CUDA Context \u4e2d\uff1a</p> <ul> <li>\u7701\u53bb Context Switch \u7684\u5f00\u9500\uff1b</li> <li>Context \u5185\u90e8\u5b9e\u73b0\u4e86\u7b97\u529b\u9694\u79bb\uff1b</li> <li>\u65e0\u663e\u5b58\u9694\u79bb\uff0c\u5bfc\u81f4\u989d\u5916\u7684\u6545\u969c\u4f20\u64ad\uff1b</li> </ul>"},{"location":"cloud/virtualize/gpu.html#vgpu","title":"vGPU\uff08\u4e0d\u5f00\u6e90\uff09","text":"<p>\u4e0d\u652f\u6301\u5bb9\u5668\u3002</p> <p>\u5177\u6709\u5b8c\u5168\u8f93\u5165\u8f93\u51fa\u5185\u5b58\u7ba1\u7406\u5355\u5143\uff08 IOMMU \uff09\u4fdd\u62a4\u7684\u865a\u62df\u673a\u80fd\u591f\u540c\u65f6\u76f4\u63a5\u8bbf\u95ee\u5355\u4e2a\u7269\u7406 GPU \u3002</p>"},{"location":"cloud/virtualize/gpu.html#_6","title":"\u5185\u6838\u7b49\u52ab\u6301\u65b9\u6848","text":"<p>\u5206\u4e3a\uff1aCUDA API \u5c42\u52ab\u6301 \u548c GPU \u9a71\u52a8\u5c42\uff08Nvidia Driver\uff09\u52ab\u6301</p> <ul> <li>cGPU\uff08\u963f\u91cc\u4e91\uff09\uff1a\u5185\u6838\u52ab\u6301\uff08\u5728Nvidia Driver\u5c42\uff09\uff0c\u4e0d\u5f00\u6e90\uff1b</li> <li>qGPU\uff08\u817e\u8baf\uff09\uff1a\u5185\u6838\u52ab\u6301\uff0cGPU\u5171\u4eab\u548c\u7b97\u529b\u9694\u79bb\uff0c\u4e0d\u5f00\u6e90\uff1b</li> <li>vCUDA\uff08\u817e\u8bafTKE\uff09\uff1aCUDA\u52ab\u6301\uff0cGPU\u5171\u4eab\u548c\u7b97\u529b\u9694\u79bb\uff1b</li> <li>vGPU\uff08\u7b2c\u56db\u8303\u5f0f\uff09\uff1aCUDA\u52ab\u6301\uff0cGPU\u5171\u4eab\u548c\u7b97\u529b\u9694\u79bb\uff1b</li> <li>AliyunContainerService/gpushare-scheduler-extender\uff1aGPU\u5171\u4eab\uff0c\u4e0d\u652f\u6301\u7b97\u529b\u9694\u79bb\uff1b</li> <li>elastic-ai/elastic-gpu\uff1a\u7edf\u4e00\u7684\u865a\u62df\u5316gpu\u8c03\u5ea6\u65b9\u5f0f\uff0c\u652f\u6301 qGPU\uff0cvCuda\u7b49\uff1b</li> </ul> <p></p>"},{"location":"cloud/virtualize/gpu.html#tkevcuda","title":"\u817e\u8bafTKE\u7684vCUDA\uff08\u5f00\u6e90\uff09","text":"<p>https://github.com/tkestack/vcuda-controller</p> <p>https://github.com/tkestack/gpu-manager</p> <p>https://github.com/tkestack/gpu-admission</p>"},{"location":"cloud/virtualize/gpu.html#_7","title":"\u8d44\u6e90\u9694\u79bb","text":"<p>\u5728Cuda driver API\u4e4b\u4e0a\uff0c\u5b83\u901a\u8fc7\u52ab\u6301\u5bf9Cuda driver API\u7684\u8c03\u7528\u6765\u505a\u5230\u8d44\u6e90\u9694\u79bb\u3002</p> <p>1\uff09\u5bf9\u4e8e\u663e\u5b58\uff0c\u4e00\u65e6\u8be5\u4efb\u52a1\u7533\u8bf7\u663e\u5b58\u540e\u5360\u7528\u7684\u663e\u5b58\u5927\u5c0f\u5927\u4e8econfig\u4e2d\u7684\u8bbe\u7f6e\uff0c\u5c31\u62a5\u9519\u3002</p> <p>2\uff09\u5bf9\u4e8e\u8ba1\u7b97\u8d44\u6e90\uff0c\u5b58\u5728\u786c\u9694\u79bb\u548c\u8f6f\u9694\u79bb\u4e24\u79cd\u65b9\u5f0f\uff0c\u5171\u540c\u70b9\u662f\u5f53\u4efb\u52a1\u4f7f\u7528\u7684GPU SM\u5229\u7528\u7387\u8d85\u51fa\u8d44\u6e90\u4e0a\u9650\uff0c\u5219\u6682\u7f13\u4e0b\u53d1API\u8c03\u7528\u3002\u4e0d\u540c\u70b9\u662f\u5982\u679c\u6709\u8d44\u6e90\u7a7a\u95f2\uff0c\u8f6f\u9694\u79bb\u5141\u8bb8\u4efb\u52a1\u8d85\u8fc7\u8bbe\u7f6e\uff0c\u52a8\u6001\u8ba1\u7b97\u8d44\u6e90\u4e0a\u9650\u3002\u800c\u786c\u9694\u79bb\u5219\u4e0d\u5141\u8bb8\u8d85\u51fa\u8bbe\u7f6e\u91cf\u3002</p> <p></p>"},{"location":"cloud/virtualize/gpu.html#_8","title":"\u5e76\u884c\u6a21\u5f0f","text":"<p>\u5206\u65f6\u590d\u7528\u7684\u6a21\u5f0f\uff0c\u5355\u4e2a\u4efb\u52a1\u5b8c\u6210\u65f6\u95f4\uff08JCT\uff09\u90fd\u4f1a\u53d7\u5230\u8f83\u5927\u7684\u5f71\u54cd\u3002</p>"},{"location":"cloud/virtualize/gpu.html#hami-4vgpu","title":"HAMi \u7b2c4\u8303\u5f0fvGPU\uff08\u5f00\u6e90\uff09","text":"<p>\u5305\u542b vgpu-device-plugin \u548c vgpu-scheduler\u3002</p> <p>\u73b0\u5df2\u6539\u540d HAMi \u540c\u65f6\u4e5f\u5c06\u6838\u5fc3\u7684 vCUDA \u5e93 libvgpu.so\u5f00\u6e90\u3002</p> <p>vgpu-device-plugin\uff1a\u57fa\u4e8eNVIDIA\u5b98\u65b9\u63d2\u4ef6(NVIDIA/k8s-device-plugin)\uff0c\u5728\u4fdd\u7559\u5b98\u65b9\u529f\u80fd\u7684\u57fa\u7840\u4e0a\uff0c\u5b9e\u73b0\u4e86\u5bf9\u7269\u7406GPU\u8fdb\u884c\u5207\u5206\uff0c\u5e76\u5bf9\u663e\u5b58\u548c\u8ba1\u7b97\u5355\u5143\u8fdb\u884c\u9650\u5236\uff0c\u4ece\u800c\u6a21\u62df\u51fa\u591a\u5f20\u5c0f\u7684vGPU\u5361\u3002</p> <ul> <li>\u663e\u5b58\u9694\u79bb\u4f7f\u7528\u7684\u662f\u7ecf\u5178CUDA\u52ab\u6301\u65b9\u6cd5\uff0c\u901a\u8fc7\u9884\u4f30\u83b7\u5f97context\u5927\u5c0f\uff1b\u4f7f\u7528\u76d1\u63a7\u9694\u79bb\u7684\u65b9\u6848\u9694\u79bb\u7b97\u529b</li> </ul> <p>vgpu-scheduler\uff1a\u5728\u539f\u6709\u663e\u5361\u5206\u914d\u65b9\u5f0f\u7684\u57fa\u7840\u4e0a\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u6839\u636e\u663e\u5b58\u548c\u7b97\u529b\u6765\u5207\u5206\u663e\u5361\uff0c\u5e76\u5b9e\u73b0\u591a\u4e2aGPU\u8282\u70b9\u95f4\u7684\u8d1f\u8f7d\u5747\u8861\u3002</p> <p>\u5728k8s\u96c6\u7fa4\u4e2d\uff0c\u57fa\u4e8e\u8fd9\u4e9b\u5207\u5206\u540e\u7684vGPU\u8fdb\u884c\u8c03\u5ea6\uff0c\u4f7f\u4e0d\u540c\u7684\u5bb9\u5668\u53ef\u4ee5\u5b89\u5168\u7684\u5171\u4eab\u540c\u4e00\u5f20\u7269\u7406GPU\uff0c\u63d0\u9ad8GPU\u7684\u5229\u7528\u7387\u3002</p> <p>\u6b64\u5916\uff0c\u63d2\u4ef6\u8fd8\u53ef\u4ee5\u5bf9\u663e\u5b58\u505a\u865a\u62df\u5316\u5904\u7406\uff08\u4f7f\u7528\u5230\u7684\u663e\u5b58\u53ef\u4ee5\u8d85\u8fc7\u7269\u7406\u4e0a\u7684\u663e\u5b58\uff09\uff0c\u8fd0\u884c\u4e00\u4e9b\u8d85\u5927\u663e\u5b58\u9700\u6c42\u7684\u4efb\u52a1\uff0c\u6216\u63d0\u9ad8\u5171\u4eab\u7684\u4efb\u52a1\u6570\uff0c\u53ef\u53c2\u8003\u6027\u80fd\u6d4b\u8bd5\u62a5\u544a\u3002</p>"},{"location":"cloud/virtualize/gpu.html#_9","title":"\u4f7f\u7528\u573a\u666f","text":"<ol> <li>\u663e\u5b58\u3001\u8ba1\u7b97\u5355\u5143\u5229\u7528\u7387\u4f4e\u7684\u60c5\u51b5\uff0c\u5982\u5728\u4e00\u5f20GPU\u5361\u4e0a\u8fd0\u884c10\u4e2atf-serving\uff1b</li> <li>\u9700\u8981\u5927\u91cf\u5c0f\u663e\u5361\u7684\u60c5\u51b5\uff0c\u5982\u6559\u5b66\u573a\u666f\u628a\u4e00\u5f20GPU\u63d0\u4f9b\u7ed9\u591a\u4e2a\u5b66\u751f\u4f7f\u7528\u3001\u4e91\u5e73\u53f0\u63d0\u4f9b\u5c0fGPU\u5b9e\u4f8b\uff1b</li> <li>\u7269\u7406\u663e\u5b58\u4e0d\u8db3\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u5f00\u542f\u865a\u62df\u663e\u5b58\uff08\u8d85\u8fc7\u7684\u90e8\u5206\u4f1a\u653e\u5230\u5185\u5b58\u91cc\uff0c\u5bf9\u6027\u80fd\u6709\u4e00\u5b9a\u7684\u5f71\u54cd\uff09\uff0c\u5982\u5927batch\u3001\u5927\u6a21\u578b\u7684\u8bad\u7ec3\uff1b</li> <li>\u9700\u8981\u5b9a\u5236GPU\u7533\u8bf7\u7684\u573a\u5408\uff0c\u5982\u7533\u8bf7\u7279\u5b9a\u5927\u5c0f\u7684vGPU\uff0c\u6bcf\u4e2avGPU\u4f7f\u7528\u7279\u5b9a\u6bd4\u4f8b\u7684\u7b97\u529b\u3002</li> <li>\u5728\u591a\u4e2aGPU\u8282\u70b9\u7ec4\u6210\u7684\u96c6\u7fa4\u4e2d\uff0c\u4efb\u52a1\u9700\u8981\u6839\u636e\u81ea\u8eab\u7684\u663e\u5361\u9700\u6c42\u5206\u914d\u5230\u5408\u9002\u7684\u8282\u70b9\u6267\u884c\u3002</li> </ol>"},{"location":"cloud/virtualize/gpu.html#_10","title":"\u529f\u80fd","text":"<ul> <li>\u6307\u5b9a\u6bcf\u5f20\u7269\u7406GPU\u5207\u5206\u7684\u6700\u5927vGPU\u7684\u6570\u91cf</li> <li>\u9650\u5236vGPU\u7684\u663e\u5b58</li> <li>\u5141\u8bb8\u901a\u8fc7\u6307\u5b9a\u663e\u5b58\u6765\u7533\u8bf7GPU</li> <li>\u9650\u5236vGPU\u7684\u8ba1\u7b97\u5355\u5143</li> <li>\u5141\u8bb8\u901a\u8fc7\u6307\u5b9avGPU\u4f7f\u7528\u6bd4\u4f8b\u6765\u7533\u8bf7GPU</li> <li>\u5bf9\u5df2\u6709\u7a0b\u5e8f\u96f6\u6539\u52a8</li> </ul>"},{"location":"cloud/virtualize/gpu.html#_11","title":"\u5df2\u77e5\u95ee\u9898","text":"<ul> <li>\u76ee\u524d\u4ec5\u652f\u6301\u8ba1\u7b97\u4efb\u52a1\uff0c\u4e0d\u652f\u6301\u89c6\u9891\u7f16\u89e3\u7801\u5904\u7406\u3002</li> <li>\u6682\u65f6\u4ec5\u652f\u6301MIG\u7684\"none\"\u548c\"mixed\"\u6a21\u5f0f\uff0c\u6682\u65f6\u4e0d\u652f\u6301single\u6a21\u5f0f</li> <li>\u5f53\u4efb\u52a1\u6709\u5b57\u6bb5\u201cnodeName\u201c\u65f6\u4f1a\u51fa\u73b0\u65e0\u6cd5\u8c03\u5ea6\u7684\u60c5\u51b5\uff0c\u6709\u7c7b\u4f3c\u9700\u6c42\u7684\u8bf7\u4f7f\u7528\"nodeSelector\"\u4ee3\u66ff</li> </ul>"},{"location":"cloud/virtualize/lxcfs.html","title":"LXCFS","text":""},{"location":"cloud/virtualize/lxcfs.html#_1","title":"\u89e3\u51b3\u7684\u95ee\u9898","text":"<p>Linuxs \u5229\u7528 Cgroup \u5b9e\u73b0\u5bf9\u5bb9\u5668\u7684\u8d44\u6e90\u9650\u5236\uff0c\u4f46\u5728\u5bb9\u5668\u5185\u90e8\u7f3a\u7701\u6302\u8f7d\u5bbf\u4e3b\u673a\u4e0a\u7684<code>procfs</code>\u7684 <code>/proc</code>\u76ee\u5f55\uff0c\u5305\u542b\u5982\uff1a<code>meminfo,cpuinfo,stat,uptime</code>\u7b49\u8d44\u6e90\u4fe1\u606f\u3002</p> <ul> <li>\u4e00\u4e9b\u76d1\u63a7\u5de5\u5177\u5982 <code>free/top</code>\u6216\u9057\u7559\u5e94\u7528\u4f9d\u8d56\u4e0a\u8ff0\u6587\u4ef6\u5185\u5bb9\u83b7\u53d6\u8d44\u6e90\u914d\u7f6e\u548c\u4f7f\u7528\u60c5\u51b5\u3002\u5f53\u5b83\u4eec\u5728\u5bb9\u5668\u4e2d\u8fd0\u884c\u65f6\uff0c\u4f1a\u8bfb\u53d6\u5bbf\u4e3b\u673a\u7684\u8d44\u6e90\u72b6\u6001\uff0c\u5f15\u8d77\u9519\u8bef\u3002</li> </ul> <p>\u793e\u533a\u4e2d\u5e38\u89c1\u7684\u505a\u6cd5\u662f\u5229\u7528 lxcfs\u6765\u63d0\u4f9b\u5bb9\u5668\u4e2d\u7684\u8d44\u6e90\u53ef\u89c1\u6027\u3002lxcfs \u662f\u4e00\u4e2a\u5f00\u6e90\u7684FUSE\uff08\u7528\u6237\u6001\u6587\u4ef6\u7cfb\u7edf\uff09\u5b9e\u73b0\u6765\u652f\u6301LXC\u5bb9\u5668\uff0c\u5b83\u4e5f\u53ef\u4ee5\u652f\u6301Docker\u5bb9\u5668\u3002</p>"},{"location":"cloud/virtualize/lxcfs.html#_2","title":"\u529f\u80fd","text":"<p>LXCFS \u901a\u8fc7\u7528\u6237\u6001\u6587\u4ef6\u7cfb\u7edf\uff0c\u5728\u5bb9\u5668\u4e2d\u63d0\u4f9b\u4e0b\u5217 <code>procfs</code> \u7684\u6587\u4ef6\u3002</p> <pre><code>/proc/cpuinfo\n/proc/diskstats\n/proc/meminfo\n/proc/stat\n/proc/swaps\n/proc/uptime\n</code></pre> <p>\u628a\u5bbf\u4e3b\u673a\u7684 <code>/var/lib/lxcfs/proc/memoinfo</code> \u6587\u4ef6\u6302\u8f7d\u5230Docker\u5bb9\u5668\u7684 <code>/proc/meminfo</code>\u4f4d\u7f6e\u540e\u3002\u5bb9\u5668\u4e2d\u8fdb\u7a0b\u8bfb\u53d6\u76f8\u5e94\u6587\u4ef6\u5185\u5bb9\u65f6\uff0cLXCFS\u7684FUSE\u5b9e\u73b0\u4f1a\u4ece\u5bb9\u5668\u5bf9\u5e94\u7684Cgroup\u4e2d\u8bfb\u53d6\u6b63\u786e\u7684\u5185\u5b58\u9650\u5236\u3002</p> <p></p>"},{"location":"cloud/virtualize/lxcfs.html#_3","title":"\u4f7f\u7528","text":""},{"location":"cloud/virtualize/lxcfs.html#_4","title":"\u5b89\u88c5\u548c\u6d4b\u8bd5","text":"<p>\u5b89\u88c5 lxcfs</p> <pre><code>$ wget https://copr-be.cloud.fedoraproject.org/results/ganto/lxd/epel-7-x86_64/00486278-lxcfs/lxcfs-2.0.5-3.el7.centos.x86_64.rpm\n$ yum install lxcfs-2.0.5-3.el7.centos.x86_64.rpm  \n</code></pre> <p>\u542f\u52a8 lxcfs</p> <pre><code>$ lxcfs /var/lib/lxcfs &amp;  \n</code></pre> <p>\u6d4b\u8bd5</p> <pre><code>$ docker run -it -m 256m \\\n      -v /var/lib/lxcfs/proc/cpuinfo:/proc/cpuinfo:rw \\\n      -v /var/lib/lxcfs/proc/diskstats:/proc/diskstats:rw \\\n      -v /var/lib/lxcfs/proc/meminfo:/proc/meminfo:rw \\\n      -v /var/lib/lxcfs/proc/stat:/proc/stat:rw \\\n      -v /var/lib/lxcfs/proc/swaps:/proc/swaps:rw \\\n      -v /var/lib/lxcfs/proc/uptime:/proc/uptime:rw \\\n      ubuntu:16.04 /bin/bash\n\n$ free\n              total        used        free      shared  buff/cache   available\nMem:         262144         708      261436        2364           0      261436\nSwap:             0           0           0\n</code></pre>"},{"location":"cloud/virtualize/lxcfs.html#k8s","title":"K8s\u9002\u914d","text":"<p>\u5728\u96c6\u7fa4\u8282\u70b9\u4e0a\u5b89\u88c5\u5e76\u542f\u52a8lxcfs\uff0c\u5229\u7528 Webhook \u548c DaemonSet\u65b9\u5f0f\u6765\u8fd0\u884c lxcfs FUSE\u6587\u4ef6\u7cfb\u7edf\u3002</p> <ul> <li>\u53c2\u8003\uff1adenverdino/lxcfs-admission-webhook</li> </ul>"},{"location":"code_guide/clean_code.html","title":"\u4ee3\u7801\u6574\u6d01\u4e4b\u9053","text":"<ul> <li>\u4e66\u7c4d\uff1aRobertC.Martin. \u4ee3\u7801\u6574\u6d01\u4e4b\u9053[M]. \u4eba\u6c11\u90ae\u7535\u51fa\u7248\u793e, 2010.</li> <li>\u7b2c14-16\u7ae0\u5206\u522b\u5bf9\u4ee3\u7801\u505a\u4e86\u91cd\u6784\u7684\u793a\u4f8b\uff0c\u8fd9\u91cc\u4e0d\u505a\u5c55\u793a\u3002</li> </ul>"},{"location":"code_guide/clean_code.html#1","title":"1. \u6574\u6d01\u4ee3\u7801","text":"<p>\u4ec0\u4e48\u662f\u6574\u6d01\u4ee3\u7801\uff1a</p> <ul> <li>\uff08C++\u8bed\u8a00\u53d1\u660e\u8005\uff0cBjarne Stroustrup\uff09\u4f18\u96c5\u548c\u9ad8\u6548\uff1a\u4ee3\u7801\u903b\u8f91\u76f4\u63a5\u4e86\u5f53\uff0c\u53eb\u7f3a\u9677\u96be\u4ee5\u9690\u85cf\uff1b\u5c3d\u91cf\u51cf\u5c11\u4f9d\u8d56\u5173\u7cfb\uff1b\u4f9d\u8d56\u67d0\u79cd\u5206\u5c42\u6218\u7565\u5b8c\u5584\u9519\u8bef\u5904\u7406\u4ee3\u7801\uff1b\u6027\u80fd\u8c03\u5236\u6700\u4f18\uff0c\u7701\u7684\u5f15\u8bf1\u522b\u4eba\u505a\u6ca1\u89c4\u77e9\u7684\u4f18\u5316\uff0c\u641e\u51fa\u4e00\u5806\u6df7\u4e71\u6765\u3002\u6574\u6d01\u7684\u4ee3\u7801\u53ea\u505a\u597d\u4e00\u4ef6\u4e8b\u3002</li> </ul> <ul> <li>\u4ee3\u7801\u6c38\u5b58\uff1a\u4ee3\u7801\u662f\u6700\u7ec8\u7528\u6765\u8868\u8fbe\u9700\u6c42\u7684\u8bed\u8a00\uff1b</li> <li>\u6df7\u4e71\u7684\u4ee3\u7801\uff1a\u65ad\u8a00\u70c2\u7a0b\u5e8f\u603b\u6bd4\u4ec0\u4e48\u6ca1\u6709\u5f3a\uff1b</li> <li> <p>\u56de\u5934\u6e05\u7406\uff1a\u7a0d\u540e\u7b49\u4e8e\u6c38\u4e0d\uff08Later equals never\uff09</p> </li> <li> <p>\u6df7\u4e71\u7684\u4ee3\u4ef7\uff1a\u5feb\u901f\u7814\u53d1-&gt;\u6548\u7387\u4f4e\u4e0b-&gt;\u91cd\u65b0\u8bbe\u8ba1-&gt;\u5feb\u901f\u7814\u53d1\uff0c\u9677\u5165\u5faa\u73af\uff1b</p> </li> <li>\u82b1\u65f6\u95f4\u4fdd\u6301\u4ee3\u7801\u6574\u6d01\u4e0d\u4f46\u6709\u5173\u6548\u7387\uff0c\u8fd8\u6709\u5173\u751f\u5b58\uff1b</li> <li> <p>\u5236\u9020\u6df7\u4e71\u65e0\u52a9\u4e8e\u8d76\u4e0a\u671f\u9650\uff0c\u552f\u4e00\u7684\u505a\u6cd5\u662f\u59cb\u7ec8\u5c3d\u53ef\u80fd\u4fdd\u6301\u4ee3\u7801\u6574\u6d01\u3002</p> </li> <li> <p>\u4e13\u4e1a\u6001\u5ea6\uff1a\u9879\u76ee\u7ecf\u7406\u4ece\u6211\u4eec\u8fd9\u91cc\u5f97\u5230\u4fe1\u606f\uff0c\u624d\u80fd\u4f5c\u51fa\u627f\u8bfa\u548c\u4fdd\u8bc1\uff1b</p> </li> <li>\u7a0b\u5e8f\u5458\u9075\u4ece\u4e0d\u4e86\u89e3\u6df7\u4e71\u98ce\u9669\u7684\u7ecf\u7406\u7684\u610f\u613f\uff0c\u4e5f\u662f\u4e0d\u4e13\u4e1a\u7684\u505a\u6cd5\u3002</li> <li> <p>\u7ecf\u9a8c\u4e0e\u6559\u8bad\uff1a\u75c5\u4eba\u8bf7\u6c42\u533b\u751f\u505a\u624b\u672f\u524d\u522b\u6d17\u624b\uff0c\u90a3\u6837\u4f1a\u82b1\u592a\u591a\u65f6\u95f4<sup>1</sup>\uff1b</p> </li> <li> <p>\u4ee3\u7801\u611f\uff1a\u4ece\u6df7\u4e71\u4e2d\u770b\u51fa\u5176\u4ed6\u7684\u53ef\u80fd\u4e0e\u53d8\u5316\uff0c\u8d2f\u5f7b\u6280\u5de7\u4e60\u5f97\u7684\u201c\u6574\u6d01\u611f\u201d\uff1b</p> </li> <li> <p>\u80fd\u5206\u8fa8\u6574\u6d01\u4ee3\u7801\u548c\u80ae\u810f\u4ee3\u7801\u6bb5\uff0c\u4e5f\u4e0d\u610f\u5473\u8fd9\u4f1a\u5199\u6574\u6d01\u4ee3\u7801\uff08\u793a\u4f8b\uff1a\u7ed8\u753b\uff09\u3002</p> </li> <li> <p>\u8bfb\u5199\u6bd4\u4f8b\uff1a\u8bfb\u5199\u82b1\u8d39\u65f6\u95f4\u7684\u6bd4\u4f8b\u8d85\u8fc710:1\u3002\u5199\u65b0\u4ee3\u7801\u65f6\uff0c\u4e00\u76f4\u5728\u8bfb\u65e7\u4ee3\u7801\uff1b</p> </li> <li> <p>\u7f16\u8f91\u5668\u56de\u653e\uff1a\u8bb0\u5f55\u6bcf\u6b21\u51fb\u952e\u52a8\u4f5c\uff0c\u591a\u6570\u65f6\u95f4\u90fd\u5728\u6eda\u52a8\u5c4f\u5e55\u548c\u6d4f\u89c8\u5176\u4ed6\u6a21\u5757\u3002</p> </li> <li> <p>\u7ae5\u5b50\u519b\u519b\u89c4\uff1a\u8ba9\u8425\u5730\u6bd4\u4f60\u6765\u65f6\u66f4\u5e72\u51c0\uff1b</p> </li> </ul>"},{"location":"code_guide/clean_code.html#2","title":"2. \u6709\u610f\u4e49\u7684\u547d\u540d","text":"<ul> <li>\u540d\u526f\u5176\u5b9e\uff1a\u4f53\u73b0\u672c\u610f\u7684\u540d\u79f0\uff0c\u4e0d\u5e94\u8be5\u7528\u6ce8\u91ca\u6765\u9610\u8ff0\u53d8\u91cf\u7684\u610f\u4e49\uff1b</li> <li>\u907f\u514d\u8bef\u5bfc\uff1a\u540d\u79f0\u5305\u542b\u7684\u7c7b\u578b\uff08\u5982List\uff09\u8ddf\u5b9e\u9645\u4e0d\u4e00\u81f4\uff0c\u63d0\u653e\u4f7f\u7528\u4e0d\u540c\u4e4b\u5904\u8f83\u5c0f\u7684\u540d\u79f0\uff08\u5982\u53ea\u6709\u4e2d\u95f4\u4e2a\u522b\u5b57\u7b26\u7684\u53d8\u5316\uff09\uff1b</li> <li>\u505a\u6709\u610f\u4e49\u7684\u533a\u5206\uff1a\u9519\u8bef\u793a\u4f8b\u5982<code>Product</code>\u3001<code>ProductInfo</code>\u3001<code>ProductData</code>\uff1b</li> <li>\u53ef\u8bfb\u6027\u5f3a\uff1a<code>genymddhms</code>\uff08\u751f\u6210\u65e5\u671f\uff09 =&gt; <code>generationTimeStamp</code>\uff1b</li> <li>\u53ef\u641c\u7d22\u6027\u5f3a\uff1a\u957f\u540d\u79f0\u80dc\u4e8e\u77ed\u540d\u79f0(\u6807\u5fd7\u6027\uff0c\u4e0d\u91cd\u590d)\uff0c\u540d\u79f0\u957f\u77ed\u5e94\u4e0e\u4f5c\u7528\u57df\u5927\u5c0f\u76f8\u5bf9\u5e94\u3002</li> <li>\u907f\u514d\u4f7f\u7528\u7f16\u7801\uff1a\u4e0d\u8981\u628a\u7c7b\u578b\u548c\u4f5c\u7528\u57df\u7f16\u8fdb\u540d\u79f0\u91cc\u9762</li> <li> <p>\u4e0d\u8981\u7c7b\u578b\u7f16\u7801\uff08\u5f3a\u7c7b\u578b\u8bed\u8a00\uff09\uff0c\u65e0\u9700<code>m_</code>\u6210\u5458\u524d\u7f00\uff08\u66f4\u597d\u7684IDE\uff09\u00b7\u00b7\u00b7</p> </li> <li> <p>\u7c7b\u540d\uff1a\u540d\u8bcd\u6216\u8005\u540d\u8bcd\u77ed\u8bed\uff0c\u907f\u514d<code>Manager, Processor, Data, Info</code>\u8fd9\u6837\u7684\u7c7b\u540d</p> </li> <li>\u65b9\u6cd5\u540d\uff1a\u52a8\u8bcd\u6216\u8005\u52a8\u8bcd\u77ed\u8bed\uff0cJavaBean\u89c4\u8303\uff08<code>get</code>,<code>set</code>\uff09\uff1b</li> <li> <p>\u91cd\u8f7d\u6784\u9020\u5668\u65f6\uff0c\u63d0\u4f9b\u63cf\u8ff0\u53c2\u6570\u7684\u9759\u6001\u5de5\u5382\u65b9\u6cd5\u540d\uff08\u540c\u65f6\u6784\u9020\u51fd\u6570\u79c1\u6709\u5316\uff09\u3002</p> </li> <li> <p>\u4e00\u4ee5\u8d2f\u4e4b\uff1a\u6bcf\u4e2a\u62bd\u8c61\u6982\u5ff5\u5bf9\u5e94\u4e00\u4e2a\u8bcd\uff0c\u540c\u540d\u8bcd\u4fdd\u6301\u4f7f\u7528\u540c\u4e00\u4e2a</p> </li> <li> <p>\u5982 <code>fetch, get, retrieve</code>\uff0c<code>controller,manager,driver</code></p> </li> <li> <p>\u89e3\u51b3\u65b9\u6848\u9886\u57df\u540d\u79f0\u4f18\u5148\uff1a\u5c3d\u7ba1\u4f7f\u7528CS\u672f\u8bed\u3001\u7b97\u6cd5\u3001\u6a21\u5f0f\u540d\uff0c\u53ea\u6709\u7a0b\u5e8f\u5458\u624d\u4f1a\u9605\u8bfb\u4ee3\u7801</p> </li> <li> <p>\u5176\u6b21\uff0c\u624d\u662f\u4f7f\u7528\u95ee\u9898\u9886\u57df\u7684\u540d\u79f0\uff0c\u81f3\u5c11\u7ef4\u62a4\u8005\u53ef\u4ee5\u95ee\u9886\u57df\u4e13\u5bb6\u3002</p> </li> <li> <p>\u5408\u9002\u7684\u8bed\u5883\uff1a\u826f\u597d\u547d\u540d\u7684\u7c7b\u3001\u51fd\u6570\u6216\u540d\u7a7a\u95f4\u6765\u653e\u7f6e\u540d\u79f0\uff0c\u63d0\u4f9b\u8bed\u5883\uff0c\u6700\u5dee\u662f\u63d0\u4f9b\u8bed\u5883\u524d\u7f00\u3002</p> </li> <li>\u6dfb\u52a0\u8bed\u5883\uff1a\u591a\u4e2a\u53d8\u91cf\u76f8\u5173\u8054\uff0c\u53ef\u4ee5\u653e\u5230\u4e00\u4e2a\u7c7b\u4e2d\uff08\u7ec4\u6210\u5173\u7cfb\uff09</li> <li>\u65e0\u7528\u8bed\u5883\uff1a\u5bf9\u7c7b\u4f7f\u7528\u5305\u7684\u524d\u7f00\uff0c\u5982\u7ed9\u6bcf\u4e2a\u7c7b\u4e2d\u6dfb\u52a0GSD\u524d\u7f00</li> </ul>"},{"location":"code_guide/clean_code.html#3","title":"3. \u51fd\u6570","text":"<p>\u5982\u4f55\u5199\u51fa\u8fd9\u6837\u7684\u51fd\u6570\uff1a\u6ca1\u6709\u4eba\u80fd\u591f\u4e00\u5f00\u59cb\u5c31\u6309\u7167\u89c4\u5219\u5199\u51fd\u6570 </p> <ul> <li>\u5148\u5199\uff1a\u5197\u957f\u800c\u590d\u6742\uff0c\u4e0d\u6ee1\u8db3\u8981\u6c42\uff1b</li> <li>\u6d4b\u8bd5\uff1a\u914d\u4e0a\u4e00\u5957\u5355\u5143\u6d4b\u8bd5\uff0c\u8986\u76d6\u6bcf\u884c\u4e11\u964b\u7684\u4ee3\u7801\uff1b</li> <li>\u6253\u78e8\uff1a\u5206\u89e3\u51fd\u6570\u3001\u4fee\u6539\u540d\u79f0\u3001\u6d88\u9664\u91cd\u590d\uff0c\u4fdd\u8bc1\u6d4b\u8bd5\u901a\u8fc7\u3002</li> </ul> <ul> <li>\u77ed\u5c0f\uff1a\u51fd\u6570\u7684\u7f29\u8fdb\u4e0d\u8be5\u591a\u4e8e\u4e00\u5c42\u6216\u8005\u4e24\u5c42\u3002</li> <li>\u53ea\u505a\u4e00\u4ef6\u4e8b\uff1a\u51fd\u6570\u4e2d\u7684\u4ee3\u7801\u5e94\u8be5\u5904\u4e8e\u540c\u4e00\u62bd\u8c61\u5c42\u4e0a\uff0c\u6bcf\u4e2a\u51fd\u6570\u4e00\u4e2a\u62bd\u8c61\u5c42\u7ea7</li> <li>\u53ef\u4ee5\u4f7f\u7528 TO \u8d77\u5934\u6bb5\u843d\u6765\u63cf\u8ff0\u51fd\u6570\uff0c\u81ea\u9876\u5411\u4e0b\u7684 TO\u8d77\u5934\u6bb5\u843d</li> <li>Switch\u8bed\u53e5\uff1a\u786e\u4fddswitch\u57cb\u85cf\u5728\u8f83\u4f4e\u7684\u62bd\u8c61\u5c42\u7ea7\uff0c\u5e76\u6c38\u4e0d\u91cd\u590d\u3002</li> <li>\u5229\u7528\u591a\u6001\u5b9e\u73b0\uff1aswitch \u8bed\u53e5\u57cb\u5728\u62bd\u8c61\u5de5\u5382\u5e95\u4e0b\u3002</li> <li>\u51fd\u6570\u53c2\u6570\uff1a\u53c2\u6570\u5c3d\u91cf\u53ef\u80fd\u5c11\uff0c\u5c3d\u91cf\u907f\u514d\u8f93\u51fa\u53c2\u6570</li> <li>\u4e0d\u8981\u4f20\u5165\u6807\u8bc6\u53c2\u6570\uff1a\u51fd\u6570\u4e0d\u6b62\u5e72\u4e00\u4ef6\u4e8b</li> <li>\u4e09\u4e2a\u4ee5\u4e0a\u53c2\u6570\u65f6\uff0c\u9700\u8981\u5c06\u90e8\u5206\u53c2\u6570\uff08\u6709\u6240\u5173\u8054\uff09\u5c01\u88c5\u6210\u7c7b</li> <li>\u53ef\u53d8\u53c2\u6570\u7b49\u4ef7\u4e8e\u7c7b\u578b\u4e3a List \u7684\u5355\u4e2a\u53c2\u6570\uff1b</li> <li>\u65e0\u526f\u4f5c\u7528\uff1a\u51fd\u6570\u5c3d\u91cf\u65e0\u526f\u4f5c\u7528\uff0c\u5426\u5219\u51fd\u6570\u540d\u5e94\u8be5\u6807\u8bc6\u5177\u5907\u526f\u4f5c\u7528</li> <li>\u5206\u9694\u6307\u4ee4\u4e0e\u8be2\u95ee\uff1a\u51fd\u6570\u5e94\u8be5\u4fee\u6539\u67d0\u5bf9\u8c61\u7684\u72b6\u6001\u6216\u8005\u8fd4\u56de\u8be5\u5bf9\u8c61\u7684\u6709\u5173\u4fe1\u606f</li> <li>\u5e76\u53d1\u7a0b\u5e8f\uff0c\u9700\u8981\u4fdd\u8bc1<code>check-then-set</code>\u539f\u5b50\u6027\uff0c\u53ef\u4ee5\u8fdd\u53cd\u8be5\u539f\u5219</li> <li>\u5f02\u5e38\u66ff\u4ee3\u8fd4\u56de\u7801\uff1a\u9519\u8bef\u5904\u7406\u4ee3\u7801\uff0c\u80fd\u4ece\u4e3b\u8def\u5f84\u4ee3\u7801\u4e2d\u5206\u79bb\u51fa\u6765</li> <li>\u62bd\u79bb<code>Try-Catch</code>\u4ee3\u7801\u5757\uff1a\u9519\u8bef\u5904\u7406\u5c31\u662f\u4e00\u4ef6\u4e8b\uff0c\u5355\u72ec\u7684\u51fd\u6570\u5904\u7406</li> <li>\u5f00\u95ed\u539f\u5219\uff1a\u65b0\u7684\u5f02\u5e38\u53ef\u4ee5\u6d3e\u751f\u51fa\u6765\uff0c\u65e0\u9700\u91cd\u65b0\u7f16\u8bd1\u6216\u8005\u91cd\u65b0\u90e8\u7f72</li> </ul>"},{"location":"code_guide/clean_code.html#4","title":"4. \u6ce8\u91ca","text":"<p>\u522b\u7ed9\u7cdf\u7cd5\u7684\u4ee3\u7801\u52a0\u6ce8\u91ca\u2014\u2014\u91cd\u65b0\u5199\u5427\u3002            \u2014\u2014Brian W.Kernighan \u4e0e P.J.Plaugher</p> <ul> <li>\u6ce8\u91ca\u4e0d\u80fd\u7f8e\u5316\u7cdf\u7cd5\u7684\u4ee3\u7801\uff1a\u91cd\u6784\u4ee3\u7801\uff0c\u63d0\u4f9b\u53ef\u89e3\u91ca\u7684\u540d\u79f0\u800c\u4e0d\u662f\u6ce8\u91ca\uff1b</li> <li>\u5fc5\u8981\u7684\u6ce8\u91ca\uff1a</li> <li>\u6cd5\u5f8b\u4fe1\u606f\uff08\u5982\u5f00\u6e90\u534f\u8bae\uff09\uff0c\u6b63\u5219\u7684\u89e3\u91ca\u548c\u793a\u4f8b\uff0c\u65e0\u6cd5\u4fee\u6539\u7684\u4ee3\u7801\uff08\u5982\u4e09\u65b9\u5e93\uff09</li> <li>\u5bf9\u610f\u56fe\u7684\u89e3\u91ca\uff1a\u67d0\u4e2a\u51b3\u5b9a\u540e\u9762\u7684\u610f\u56fe\uff08\u9610\u8ff0\u4e3a\u4ec0\u4e48\u8981\u505a\u8fd9\u4e48\u505a\uff09</li> <li>\u8b66\u793a\uff1a\u9632\u6b62\u522b\u4eba\u8bef\u7528\u6216\u8005\u4f18\u5316\uff08\u5982\u7ebf\u7a0b\u5b89\u5168\u8981\u6c42<code>SimpleDataFormat</code>\u975e\u9759\u6001\uff09</li> <li>TODO\u6ce8\u91ca\uff1a\u5408\u7406\u4f7f\u7528\uff0c\u5b9a\u671f\u67e5\u770b\uff0c\u5220\u9664\u4e0d\u518d\u9700\u8981\u7684</li> <li>\u516c\u5171API\u7684 Javadoc\uff1a\u8981\u4fdd\u6301\u8ddf\u4ee3\u7801\u7684\u4e00\u81f4\u6027</li> <li>\u574f\u6ce8\u91ca\uff1a\u5927\u591a\u6570\u6ce8\u91ca\u90fd\u5c5e\u4e8e\u6b64\u7c7b\uff0c\u662f\u7cdf\u7cd5\u7684\u4ee3\u7801\u7684\u652f\u6491\u6216\u63a5\u53e3\u3002</li> <li>\u591a\u4f59\u7684\u6ce8\u91ca\uff1a\u4e0d\u80fd\u63d0\u4f9b\u6bd4\u4ee3\u7801\u672c\u8eab\u66f4\u591a\u7684\u4fe1\u606f\uff08\u5982\u53ea\u662f\u5bf9\u540d\u79f0\u7684\u53d9\u8ff0\uff09\u3002</li> <li>\u65e5\u5fd7\u5f0f\u6ce8\u91ca\uff1a\u4f7f\u7528\u6e90\u7801\u7ba1\u7406\u7cfb\u7edf\uff08\u5305\u62ec\u4f5c\u8005\u3001\u6ce8\u91ca\u6389\u7684\u4ee3\u7801\u7b49\uff09\u3002</li> <li>\u975e\u672c\u5730\u4fe1\u606f\uff1a\u522b\u5728\u672c\u5730\u6ce8\u91ca\u7684\u4e0a\u4e0b\u6587\u73af\u5883\u7ed9\u51fa\u7cfb\u7edf\u7ea7\u7684\u4fe1\u606f\uff08\u540c\u6b65\u56f0\u96be\uff09\u3002</li> <li>\u5e9f\u5f03\u7684\u6ce8\u91ca\uff1a\u5305\u62ec\u6ce8\u91ca\u7684\u4ee3\u7801\uff1b</li> </ul>"},{"location":"code_guide/clean_code.html#5","title":"5. \u683c\u5f0f","text":"<ul> <li>\u5782\u76f4\u5c3a\u5bf8\uff1a\u7528\u5927\u591a\u6570200\u884c\uff0c\u6700\u957f500\u884c\u7684\u5355\u4e2a\u6587\u4ef6\uff0c\u6784\u5efa\u51fa\u8272\u7684\u7cfb\u7edf\uff1b</li> <li>\u7a7a\u767d\u884c\uff1a\u5bf9\u4e0d\u540c\u7684\u903b\u8f91\u533a\u5757\u8fdb\u884c\u5206\u79bb\uff1b</li> <li>\u5173\u7cfb\u5bc6\u5207\u7684\u6982\u5ff5\u5e94\u8be5\u4e92\u76f8\u9760\u8fd1\uff1b</li> <li>\u81ea\u4e0a\u800c\u4e0b\u5c55\u793a\u51fd\u6570\u8c03\u7528\u4f9d\u8d56\u987a\u5e8f\uff1b</li> <li>\u6a2a\u5411\u683c\u5f0f\uff1a\u4e00\u822c\u4e0d\u8d85\u8fc780\u5b57\u7b26\uff0c\u4e0a\u9650\u4e3a 120 \u5b57\u7b26\uff1b</li> <li>\u56e2\u961f\u89c4\u5219\uff1a\u5b9a\u4e49\u7edf\u4e00\u7684\u89c4\u8303\uff0c\u5e76\u901a\u8fc7 IDE/\u7f16\u8bd1\u811a\u672c\u7b49\u5f3a\u5236\u6267\u884c\u3002</li> </ul>"},{"location":"code_guide/clean_code.html#6","title":"6. \u5bf9\u8c61\u548c\u6570\u636e\u7ed3\u6784","text":"<ul> <li>\u5bf9\u8c61\u66b4\u9732\u884c\u4e3a\uff0c\u9690\u85cf\u6570\u636e\uff1b</li> <li> <p>\u6dfb\u52a0\u65b0\u7684\u5bf9\u8c61\u7c7b\u578b\u65f6\uff0c\u65e0\u9700\u4fee\u6539\u65e2\u6709\u884c\u4e3a\uff1b\u4f46\u96be\u4ee5\u5728\u65e2\u6709\u5bf9\u8c61\u4e2d\u6dfb\u52a0\u65b0\u884c\u4e3a\uff1b</p> </li> <li> <p>\u6570\u636e\u7ed3\u6784\u66b4\u9732\u6570\u636e\uff0c\u6ca1\u6709\u660e\u663e\u7684\u884c\u4e3a\uff1b</p> </li> <li>\u4fbf\u4e8e\u5411\u65e2\u6709\u6570\u636e\u7ed3\u6784\u6dfb\u52a0\u65b0\u884c\u4e3a\uff0c\u4f46\u96be\u4ee5\u5411\u65e2\u6709\u51fd\u6570\u6dfb\u52a0\u65b0\u7684\u6570\u636e\u7ed3\u6784\uff1b</li> </ul> <ul> <li>\u9690\u85cf\u5b9e\u73b0\u5173\u4e4e\u62bd\u8c61\uff1a\u9690\u85cf\u5b9e\u73b0\u5e76\u975e\u53ea\u662f\u5728\u53d8\u91cf\u4e4b\u95f4\u653e\u4e0a\u4e00\u4e2a\u51fd\u6570\u5c42\u90a3\u4e48\u7b80\u5355\uff1b</li> <li>\u66b4\u9732\u62bd\u8c61\u63a5\u53e3\uff0c\u4ee5\u4fbf\u7528\u6237\u65e0\u9700\u4e86\u89e3\u6570\u636e\u7ed3\u6784\u7684\u5b9e\u73b0\u5c31\u80fd\u64cd\u4f5c\u6570\u636e\u672c\u4f53\uff1b</li> <li>\u4ee5\u62bd\u8c61\u5f62\u6001\u8868\u8ff0\u6570\u636e\uff0c\u800c\u4e0d\u662f\u7528\u63a5\u53e3\u548c/\u6216\u8d4b\u503c\u5668\u3001\u53d6\u503c\u5668\u5c31\u4e07\u4e8b\u5927\u5409\u3002</li> <li>\u6570\u636e\u3001\u5bf9\u8c61\u7684\u53cd\u5bf9\u79f0\u6027\uff1a\u8fc7\u7a0b\u5f0f\u4ee3\u7801\u96be\u4ee5\u6dfb\u52a0\u65b0\u7684\u6570\u636e\u7ed3\u6784\uff08\u5fc5\u987b\u4fee\u6539\u6240\u6709\u51fd\u6570\uff09\uff0c\u9762\u5411\u5bf9\u8c61\u4ee3\u7801\u96be\u4ee5\u6dfb\u52a0\u65b0\u51fd\u6570\uff08\u5fc5\u987b\u4fee\u6539\u6240\u6709\u7c7b\uff09\u3002</li> <li>Demeter \u5f8b\uff1a\u6a21\u5757\u4e0d\u5e94\u4e86\u89e3\u5b83\u6240\u64cd\u4f5c\u5bf9\u8c61\u7684\u5185\u90e8\u60c5\u5f62\uff0c\u907f\u514d\u8fc7\u591a\u7684\u94fe\u5f0f\u8c03\u7528\uff0c\u5c3d\u91cf\u51cf\u5c11\u6a21\u5757\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb</li> <li>\u7c7b C \u7684\u65b9\u6cd5 <code>f</code>\u4e4b\u5e94\u8be5\u8c03\u7528\u4ee5\u4e0b\u5bf9\u8c61\u7684\u65b9\u6cd5\uff08\u4e0d\u5e94\u8be5\u55f2\u7528\u7531\u4efb\u4f55\u51fd\u6570\u8fd4\u56de\u7684\u5bf9\u8c61\u7684\u65b9\u6cd5\uff09\uff1a<ul> <li><code>C</code>\u3001<code>C</code>\u7684\u6210\u5458\u5bf9\u8c61\u3001<code>f</code>\u521b\u5efa\u7684\u5bf9\u8c61\u3001<code>f</code>\u7684\u53c2\u6570\u5bf9\u8c61</li> </ul> </li> <li>\u5bf9\u8c61\u5e94\u8be5\u9690\u85cf\u5176\u5185\u90e8\u7ed3\u6784\uff08getter/setter\uff09\uff0c\u66b4\u9732\u884c\u4e3a\uff08\u8981\u505a\u4ec0\u4e48\u4e8b\uff09\uff1b</li> <li>\u6570\u636e\u4f20\u8f93\u5bf9\u8c61\uff1aDTO\uff08Data Transfer Object\uff09\uff0c\u5373 <code>bean</code>\u7ed3\u6784\uff0c\u53ea\u62e5\u6709\u6570\u636e\uff0c\u6ca1\u6709\u884c\u4e3a\u3002</li> <li>\u4e0d\u8981\u521b\u5efa\u6570\u636e\u7ed3\u6784\u548c\u5bf9\u8c61\u7684\u6df7\u5408\u4f53\u3002</li> </ul>"},{"location":"code_guide/clean_code.html#7","title":"7. \u9519\u8bef\u5904\u7406","text":"<ul> <li>\u4f7f\u7528\u5f02\u5e38\u800c\u4e0d\u662f\u8fd4\u56de\u7801\uff1a\u5c06\u5f02\u5e38\u5904\u7406\u903b\u8f91\uff0c\u4e0e\u4e1a\u52a1\u903b\u8f91\u5206\u79bb\uff1b</li> <li>\u5148\u5199Try-Catch-Finally\u8bed\u53e5\uff1a\u6d4b\u8bd5\u9a71\u52a8\uff0c\u6ee1\u8db3\u6d4b\u8bd5\u8981\u6c42\uff1b</li> <li>\u4f7f\u7528\u4e0d\u53ef\u63a7\u5f02\u5e38\uff1a\u53ef\u63a7\u5f02\u5e38\u8fdd\u53cd\u5f00\u95ed\u539f\u5219\uff0c\u5728\u4e2d\u95f4\u7684\u6bcf\u4e2a\u65b9\u6cd5\u90fd\u8981\u58f0\u660e\u8be5\u5f02\u5e38\uff1b</li> <li>\u7ed9\u51fa\u5f02\u5e38\u53d1\u751f\u7684\u73af\u5883\u8bf4\u660e\uff1a\u521b\u5efa\u4fe1\u606f\u5145\u5206\u7684\u9519\u8bef\u6d88\u606f\uff0c\u5305\u62ec\u5931\u8d25\u7684\u64cd\u4f5c\u548c\u5931\u8d25\u7c7b\u578b\u7b49\uff1b</li> <li>\u81ea\u5b9a\u4e49\u5f02\u5e38\u7c7b\uff1a\u5982\u5bf9\u7b2c\u4e09\u65b9API\u8fdb\u884c\u6253\u5305\uff0c\u6355\u83b7\u5f02\u5e38\u5e76\u8fd4\u56de\u81ea\u5b9a\u4e49\u5f02\u5e38\uff0c\u907f\u514d\u8026\u5408\uff1b</li> <li>\u5b9a\u4e49\u5e38\u89c4\u6d41\u7a0b\uff1a\u7279\u4f8b\u6a21\u5f0f\uff0c\u7528\u4e8e\u5f02\u5e38\u65f6\u9700\u8981\u5904\u7406\u7279\u6b8a\u60c5\u51b5\uff1b</li> <li>\u521b\u5efa\u7c7b\u6216\u914d\u7f6e\u5bf9\u8c61\u6765\u5904\u7406\u7279\u4f8b\uff0c\u8c03\u7528\u8005\u4e0d\u9700\u8981\u5e94\u4ed8\u5f02\u5e38\u884c\u4e3a\u3002</li> <li>\u522b\u8fd4\u56deNULL\u503c\uff1a\u629b\u51fa\u5f02\u5e38\uff0c\u6216\u8005\u8fd4\u56de\u7279\u4f8b\u5bf9\u8c61\uff08\u5982\u7a7a\u96c6\u5408\uff09</li> <li>\u522b\u4f20\u9012NULL\u503c\uff1a\u907f\u514d\u7a7a\u6307\u9488\u5904\u7406\uff0c\u80fd\u591f\u660e\u786e\u53c2\u6570\u5217\u8868\u4f20\u9012 NULL \u503c\u610f\u5473\u7740\u51fa\u95ee\u9898\uff1b</li> </ul>"},{"location":"code_guide/clean_code.html#8","title":"8. \u8fb9\u754c","text":"<p>\u8fb9\u754c\u4e0a\u7684\u4ee3\u7801\u6e05\u6670\u7684\u5206\u5272\u548c\u5b9a\u4e49\u4e86\u671f\u671b\u7684\u6d4b\u8bd5\uff0c\u5e76\u4e14\u53ef\u4ee5\u5207\u6362\u7b2c\u4e09\u65b9\u7684\u5b9e\u73b0\u3002</p> <ul> <li>\u4f7f\u7528\u7b2c\u4e09\u65b9\u4ee3\u7801\uff1a</li> <li>\u4e0d\u8981\u5c06<code>Map</code>\uff08\u6216\u5728\u8fb9\u754c\u4e0a\u7684\u5176\u4ed6\u63a5\u53e3\uff09\u5728\u7cfb\u7edf\u4e2d\u4f20\u9012\uff0c\u5c06\u5176\u4fdd\u7559\u5728\u7c7b\u4e2d\u3002</li> <li>\u5b66\u4e60\u6027\u6d4b\u8bd5\uff1a\u901a\u8fc7\u6d4b\u8bd5\u7528\u4f8b\uff0c\u7406\u89e3\u7b2c\u4e09\u65b9\u4ee3\u7801\u5e93\u7684\u7528\u6cd5\uff0c\u4fdd\u8bc1\u5176\u517c\u5bb9\u6027</li> <li>\u4f7f\u7528\u5c1a\u4e0d\u5b58\u5728\u7684\u4ee3\u7801\uff1a\u8fd8\u672a\u5f00\u53d1\u5b8c\u6210\u7684\u672a\u77e5\u8fb9\u754c</li> <li>\u5047\u5b9a\u63a5\u53e3\u5f62\u5f0f\uff0c\u4ee5\u53ca\u4f7f\u7528\u9002\u914d\u5668\u9002\u914d\u6700\u7ec8\u7684\u8fb9\u754c\u63a5\u53e3\uff1b</li> </ul>"},{"location":"code_guide/clean_code.html#9","title":"9. \u5355\u5143\u6d4b\u8bd5","text":"<p>\u6d4b\u8bd5\u4ee3\u7801\u548c\u751f\u4ea7\u4ee3\u7801\u4e00\u6837\u91cd\u8981\uff0c\u5355\u5143\u6d4b\u8bd5\u4f7f\u5f97\u4ee3\u7801\u53ef\u6269\u5c55\u3001\u53ef\u7ef4\u62a4\u548c\u53ef\u590d\u7528\u3002</p> <ul> <li>TDD\u4e09\u5b9a\u5f8b\uff1a</li> <li>\u5b9a\u5f8b\u4e00\uff1a\u5728\u7f16\u5199\u4e0d\u80fd\u901a\u8fc7\u7684\u5355\u5143\u6d4b\u8bd5\u524d\uff0c\u4e0d\u53ef\u7f16\u5199\u751f\u4ea7\u4ee3\u7801\uff1b</li> <li>\u5b9a\u5f8b\u4e8c\uff1a\u53ea\u53ef\u7f16\u5199\u521a\u597d\u65e0\u6cd5\u901a\u8fc7\u7684\u5355\u5143\u6d4b\u8bd5\uff0c\u4e0d\u80fd\u7f16\u8bd1\u4e5f\u7b97\u4e0d\u901a\u8fc7\uff1b</li> <li>\u5b9a\u5f8b\u4e09\uff1a\u53ea\u53ef\u7f16\u5199\u521a\u597d\u8db3\u4ee5\u901a\u8fc7\u5f53\u524d\u5931\u8d25\u6d4b\u8bd5\u7684\u751f\u4ea7\u4ee3\u7801\uff1b</li> <li>\u4fdd\u6301\u6d4b\u8bd5\u6574\u6d01\uff1a\u6d4b\u8bd5\u4ee3\u7801\u5fc5\u987b\u968f\u7740\u751f\u4ea7\u4ee3\u7801\u7684\u6f14\u8fdb\u800c\u4fee\u6539</li> <li>\u6d4b\u8bd5\u4ee3\u7801\u8d8a\u810f\uff0c\u8d8a\u96be\u4ee5\u4fee\u6539\uff0c\u5bfc\u81f4\u79fb\u9664\u6d4b\u8bd5\u4ee3\u7801\uff0c\u6700\u7ec8\u751f\u4ea7\u4ee3\u7801\u4e0d\u7a33\u5b9a\uff1b</li> <li>\u6574\u6d01\u7684\u6d4b\u8bd5\u4ee3\u7801\uff1a\u53ef\u8bfb\u6027\u8981\u5f3a\uff08\u7ec6\u8282\u8981\u5c11\uff09</li> <li>\u5448\u73b0\u6784\u9020-\u64cd\u4f5c-\u68c0\u9a8c\uff08BUILD-OPERATE-CHECK\uff09\u6a21\u5f0f</li> <li>\u6bcf\u4e2a\u6d4b\u8bd5\u4e00\u4e2a\u6982\u5ff5\uff1a\u5c3d\u53ef\u80fd\u51cf\u5c11\u6bcf\u4e2a\u6982\u5ff5\u7684\u65ad\u8a00\u6570\u91cf\uff0c\u6bcf\u4e2a\u6d4b\u8bd5\u51fd\u6570\u53ea\u6d4b\u8bd5\u4e00\u4e2a\u6982\u5ff5\u3002</li> <li>F.I.R.S.T\uff1a\u6d4b\u8bd5\u9075\u5faa\u7684\u89c4\u5219</li> <li>Fast\uff1a\u8fd0\u884c\u8981\u5feb</li> <li>Independent\uff1a\u4e92\u76f8\u72ec\u7acb</li> <li>Repeatable\uff1a\u53ef\u91cd\u590d\u8fd0\u884c</li> <li>Self-Validating\uff1a\u5e03\u5c14\u503c\u8f93\u51fa</li> <li>Timely\uff08\u53ca\u65f6\uff09\uff1a\u53ca\u65f6\u7f16\u5199\uff0c\u5728\u5199\u751f\u4ea7\u4ee3\u7801\u524d\u7f16\u5199\uff0c\u4fdd\u8bc1\u53ef\u6d4b\u8bd5\u3002</li> </ul>"},{"location":"code_guide/clean_code.html#10","title":"10. \u7c7b","text":"<ul> <li>\u7c7b\u7684\u7ec4\u7ec7\uff1a\u9759\u6001\u53d8\u91cf\u3001\u53d8\u91cf\u3001\u9759\u6001\u51fd\u6570\u3001\u516c\u5171\u51fd\u6570\u3001\u79c1\u6709\u51fd\u6570</li> <li>\u6d4b\u8bd5\u6240\u4f7f\u7528\uff1a\u53ef\u4ee5\u4f7f\u7528\u5305\u79c1\u6709\u53d8\u91cf\uff0c\u6216\u8005 protected\uff1b</li> <li>\u7c7b\u5e94\u8be5\u77ed\u5c0f\uff1a\u7c7b\u7684\u540d\u79f0\u5e94\u8be5\u63cf\u8ff0\u5176\u6743\u8d23</li> <li>\u5982\u679c\u65e0\u6cd5\u4e3a\u67d0\u4e2a\u7c7b\u547d\u4ee5\u7cbe\u786e\u7684\u540d\u79f0\uff0c\u5219\u8fd9\u4e2a\u7c7b\u5927\u6982\u5c31\u592a\u957f\uff1b</li> <li>\u5982\u679c\u7c7b\u540d\u4e2d\u5305\u62ec\u542b\u4e49\u6a21\u7cca\u7684\u8bcd\uff0c\u5982 Processor\u6216Manager\u6216Super\uff0c\u5219\u5b58\u5728\u6743\u8d23\u805a\u96c6\u7684\u60c5\u51b5\u3002</li> <li>\u5355\u4e00\u804c\u8d23\u539f\u5219\uff1a\u7c7b\u5e94\u8be5\u4e14\u6709\u4e00\u4e2a\u52a0\u4ee5\u4fee\u6539\u7684\u539f\u56e0</li> <li>\u5f52\u7f6e\u5de5\u5177\u793a\u4f8b\uff1a\u8bb8\u591a\u62bd\u5c49\u4e14\u6bcf\u4e2a\u62bd\u5c49\u5177\u6709\u826f\u597d\u7684\u5b9a\u4e49\u548c\u6807\u8bb0\uff0c\u800c\u4e0d\u662f\u5c11\u6570\u51e0\u4e2a\u968f\u4fbf\u628a\u6240\u6709\u4e1c\u897f\u6254\u8fdb\u53bb\u7684\u62bd\u5c49\u3002</li> <li>\u5185\u805a\uff1a\u4fdd\u6301\u5185\u805a\u4f1a\u5f97\u5230\u8bb8\u591a\u77ed\u5c0f\u7684\u7c7b\uff1b</li> <li>\u5c06\u5927\u51fd\u6570\u62c6\u4e3a\u5c0f\u51fd\u6570\uff0c\u5f80\u5f80\u4e5f\u662f\u5c06\u7c7b\u62c6\u5206\u4e3a\u8bb8\u591a\u5c0f\u7c7b\u7684\u65f6\u673a\uff1b</li> <li>\u4e3a\u4e86\u4fee\u6539\u800c\u7ec4\u7ec7\uff1a\u5bf9\u7c7b\u52a0\u4ee5\u7ec4\u7ec7\uff0c\u964d\u4f4e\u4fee\u6539\u7684\u98ce\u9669</li> <li>\u51fa\u73b0\u53ea\u4e0e\u7c7b\u7684\u4e00\u5c0f\u90e8\u5206\u6709\u5173\u7684\u79c1\u6709\u65b9\u6cd5\u884c\u4e3a\uff0c\u610f\u5473\u7740\u5b58\u5728\u6539\u8fdb\u7a7a\u95f4\uff1b</li> <li>\u4f9d\u8d56\u5012\u7f6e\u539f\u5219\uff1a\u7c7b\u5e94\u8be5\u4f9d\u8d56\u4e8e\u62bd\u8c61\u63a5\u53e3\u800c\u4e0d\u662f\u5177\u4f53\u7ec6\u8282\uff0c\u964d\u4f4e\u7ec6\u8282\u6539\u52a8\u7684\u5f71\u54cd\u3002</li> <li>\u4e0d\u63a9\u853d\u65f6\u5e8f\u8026\u5408\uff1a\u9488\u5bf9\u6709\u8c03\u7528\u987a\u5e8f\u4f9d\u8d56\u7684\u51fd\u6570\uff0c\u901a\u8fc7\u7b2c\u4e00\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u53c2\u6570\u662f\u7b2c\u4e8c\u4e2a\u51fd\u6570\u7684\u8f93\u5165\u53c2\u6570\uff0c\u5f3a\u8c03\u65f6\u5e8f\u6027\u7684\u8026\u5408\uff0c\u53d8\u5f97\u53ef\u89c1\u3002</li> </ul>"},{"location":"code_guide/clean_code.html#11","title":"11. \u7cfb\u7edf","text":"<p>\u65e0\u8bba\u662f\u8bbe\u8ba1\u7cfb\u7edf\u6216\u5355\u72ec\u7684\u6a21\u5757\uff0c\u522b\u5fd8\u4e86\u4f7f\u7528\u5927\u6982\u53ef\u5de5\u4f5c\u7684\u6700\u7b80\u5355\u7684\u65b9\u6848\u3002</p> <ul> <li> <p>\u5c06\u7cfb\u7edf\u7684\u6784\u9020\u548c\u4f7f\u7528\u5206\u5f00\uff1a  \u5c06\u542f\u59cb\u8fc7\u7a0b\u548c\u542f\u59cb\u8fc7\u7a0b\u540e\u7684\u8fd0\u884c\u65f6\u903b\u8f91\u5206\u5f00\uff1b</p> </li> <li> <p>\u5206\u89e3main\uff1a\u5c06\u5168\u90e8\u6784\u9020\u642c\u8fc1\u5230 main \u6216\u8005\u88ab\u79f0\u4e4b\u4e3a main \u7684\u6a21\u5757\u4e2d\uff1b</p> </li> <li>\u5de5\u5382\uff1a\u5e94\u7528\u7a0b\u5e8f\u8d1f\u8d23\u786e\u5b9a\u4f55\u65f6\u521b\u5efa\u5bf9\u8c61\uff0c\u4f7f\u7528\u5de5\u5382\u7c7b\uff1b</li> </ul> <p></p> <ul> <li> <p>\u4f9d\u8d56\u6ce8\u5165\uff1a\u63a7\u5236\u53cd\u8f6c\uff0c\u5206\u79bb\u6784\u9020\u4e0e\u4f7f\u7528\u3002</p> </li> <li> <p>\u9762\u5411\u65b9\u9762\u7f16\u7a0b\uff1a\u5207\u5206\u5173\u6ce8\u9762\uff0c\u5bb9\u6613\u6269\u5bb9\uff08Scaling Up\uff09</p> </li> <li> <p>Java \u4ee3\u7406\uff1aJDK\u7684\u52a8\u6001\u4ee3\u7406\u53ea\u80fd\u4ee3\u7406\u63a5\u53e3\uff0c\u5b57\u8282\u7801\u64cd\u4f5c\u5982CGLIB\u3001ASM\u7b49\u53ef\u4ee5\u4ee3\u7406\u7c7b\uff1b</p> </li> <li> <p>\u7eaf Java AOP \u6846\u67b6\uff1aSpring AOP\uff0c Google Guice\uff1b</p> </li> <li> <p>AspectJ \u7684\u529f\u80fd\u66f4\u5f3a\u5927\uff1b</p> </li> <li> <p>\u6d4b\u8bd5\u9a71\u52a8\u7cfb\u7edf\u67b6\u6784\uff1a\u6a21\u5757\u5316\u548c\u5173\u6ce8\u9762\u7684\u5207\u5206\u3002\u5728\u5de8\u5927\u7684\u7cfb\u7edf\u4e2d\uff0c\u6ca1\u4eba\u80fd\u505a\u6240\u6709\u51b3\u7b56\u3002</p> </li> </ul>"},{"location":"code_guide/clean_code.html#12","title":"12. \u8fed\u8fdb","text":"<p>\u6d4b\u8bd5\u6d88\u9664\u4e86\u5bf9\u6e05\u7406\u4ee3\u7801\u5c31\u4f1a\u7834\u574f\u4ee3\u7801\u7684\u6050\u60e7\u3002</p> <ul> <li>\u901a\u8fc7\u8fed\u8fdb\u8bbe\u8ba1\u8fbe\u5230\u6574\u6d01\u76ee\u7684\uff1aKent Back \u5173\u4e8e\u7b80\u5355\u8bbe\u8ba1\u7684\u56db\u6761\u89c4\u5219</li> <li>\u8fd0\u884c\u6240\u6709\u6d4b\u8bd5\uff1a\u7d27\u8026\u5408\u7684\u4ee3\u7801\u96be\u4ee5\u7f16\u5199\u6d4b\u8bd5\u3002\u7f16\u5199\u6d4b\u8bd5\u5f15\u81f4\u66f4\u597d\u7684\u8bbe\u8ba1\uff1b</li> <li>\u4e0d\u53ef\u91cd\u590d\uff1a\u6a21\u677f\u65b9\u6cd5\u6a21\u5f0f\u7b49\u53ef\u4ee5\u7528\u4e8e\u79fb\u9664\u91cd\u590d\u4ee3\u7801\uff1b</li> <li>\u8868\u8fbe\u7a0b\u5e8f\u5458\u7684\u610f\u56fe\uff1a\u4ee3\u7801\u5e94\u6e05\u6670\u8868\u8fbe\u4f5c\u8005\u7684\u610f\u56fe\uff08\u597d\u7684\u547d\u540d\uff0c\u77ed\u5c0f\u7684\u7c7b\u548c\u5c3a\u5bf8\uff09\uff1b</li> <li>\u5c3d\u53ef\u80fd\u51cf\u5c11\u7c7b\u548c\u65b9\u6cd5\u7684\u6570\u91cf\uff1a\u907f\u514d\u592a\u591a\u7684\u7ec6\u5c0f\u7c7b\u548c\u65b9\u6cd5\uff0c\u8f83\u4ee5\u4e0a\u4e09\u70b9\u4f18\u5148\u7ea7\u6700\u4f4e\u3002</li> </ul>"},{"location":"code_guide/clean_code.html#13","title":"13. \u5e76\u53d1\u7f16\u7a0b","text":"<ul> <li>\u5e76\u53d1\u9632\u5fa1\u539f\u5219\uff1a</li> <li>\u5355\u4e00\u6743\u8d23\u539f\u5219\uff1a\u5e76\u53d1\u8bbe\u8ba1\u81ea\u8eab\u8db3\u591f\u590d\u6742\u5230\u6210\u4e3a\u4fee\u6539\u7684\u7406\u7531\uff0c\u5206\u79bb\u5e76\u53d1\u76f8\u5173\u4ee3\u7801\u4e0e\u5176\u4ed6\u4ee3\u7801\uff1b</li> <li>\u9650\u5236\u6570\u636e\u4f5c\u7528\u57df\uff1a\u4e25\u683c\u9650\u5236\u5bf9\u53ef\u80fd\u88ab\u5171\u4eab\u7684\u6570\u636e\u7684\u8bbf\u95ee\uff1b</li> <li>\u4f7f\u7528\u6570\u636e\u526f\u672c\uff1a\u590d\u5236\u5bf9\u8c61\u4ee5\u53ea\u8bfb\u7684\u65b9\u6cd5\u4f7f\u7528\uff0c\u7ebf\u7a0b\u540c\u6b65\u5f00\u9500\u53ef\u4ee5\u8865\u507f\u521b\u5efa\u5bf9\u8c61\u7684\u5f00\u9500\uff1b</li> <li>\u7ebf\u7a0b\u5c3d\u53ef\u80fd\u72ec\u7acb\uff1a\u5c1d\u8bd5\u5c06\u6570\u636e\u5206\u89e3\u5230\u53ef\u88ab\u72ec\u7acb\u7ebf\u7a0b\u64cd\u4f5c\u7684\u72ec\u7acb\u5b50\u96c6\uff1b</li> <li>\u8b66\u60d5\u540c\u6b65\u65b9\u6cd5\u4e4b\u95f4\u7684\u4f9d\u8d56\uff1a\u907f\u514d\u4f7f\u7528\u4e00\u4e2a\u5171\u4eab\u5bf9\u8c61\u7684\u591a\u4e2a\u65b9\u6cd5\uff0c\u5982<code>getThenSet, checkThenSet</code>\uff1b</li> <li>\u57fa\u4e8e\u5ba2\u6237\u7aef\u7684\u9501\u5b9a\uff1a\u8c03\u7528\u591a\u4e2a\u65b9\u6cd5\u524d\uff0c\u5148\u5bf9\u670d\u52a1\u7aef\u52a0\u9501\uff1b</li> <li>\u57fa\u4e8e\u670d\u52a1\u7aef\u7684\u9501\u5b9a\uff1a\u670d\u52a1\u7aef\u5185\u521b\u5efa\u9501\u5b9a\u670d\u52a1\u7aef\u7684\u65b9\u6cd5\uff0c\u8c03\u7528\u6240\u6709\u65b9\u6cd5\uff0c\u7136\u540e\u91ca\u653e\u9501\uff1b</li> <li>\u9002\u914d\u670d\u52a1\u7aef\uff1a\u521b\u5efa\u6267\u884c\u9501\u5b9a\u7684\u4e2d\u95f4\u5c42\uff0c\u4e0d\u4fee\u6539\u539f\u59cb\u670d\u52a1\u7aef\u7684\u4ee3\u7801\u3002</li> <li>\u4fdd\u6301\u540c\u6b65\u533a\u5fae\u5c0f\uff1a\u5c3d\u53ef\u80fd\u51cf\u5c0f\u540c\u6b65\u533a\u57df\uff0c\u907f\u514d\u8d44\u6e90\u4e89\u7528\u548c\u63d0\u5347\u6267\u884c\u6548\u7387\uff1b</li> <li>\u7f16\u5199\u6b63\u786e\u7684\u5173\u95ed\u4ee3\u7801\uff1a\u7f16\u5199\u4e00\u6bb5\u65f6\u95f4\u540e\u5e73\u9759\u5730\u5173\u95ed\u7684\u7cfb\u7edf\uff0c\u5c3d\u65e9\u8003\u8651\u5173\u95ed\u95ee\u9898\uff0c\u5c3d\u65e9\u4ee4\u5176\u5de5\u4f5c\u6b63\u5e38\u3002</li> <li>\u6d4b\u8bd5\u7ebf\u7a0b\u4ee3\u7801\uff1a\u7f16\u5199\u6709\u6f5c\u529b\u66b4\u9732\u95ee\u9898\u7684\u6d4b\u8bd5</li> <li>\u4e0d\u8981\u5c06\u7cfb\u7edf\u9519\u8bef\u5f52\u548e\u4e8e\u5076\u53d1\u4e8b\u4ef6\uff1b</li> <li>\u5148\u4f7f\u975e\u7ebf\u7a0b\u4ee3\u7801\u53ef\u5de5\u4f5c\uff1a\u4e0d\u8981\u540c\u65f6\u8ffd\u8e2a\u975e\u7ebf\u7a0b\u7f3a\u9677\u548c\u7ebf\u7a0b\u7f3a\u9677\uff1b</li> <li>\u7f16\u5199\u53ef\u63d2\u62d4\u7684\u73b0\u6210\u4ee3\u7801\uff1a\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u914d\u7f6e\u73af\u5883\u4e0b\u8fd0\u884c\uff1b</li> <li>\u7f16\u5199\u53ef\u8c03\u6574\u7684\u7ebf\u7a0b\u4ee3\u7801\uff1a\u5141\u8bb8\u7ebf\u7a0b\u6570\u91cf\u53ef\u8c03\u6574\uff1b</li> <li>\u8fd0\u884c\u591a\u4e8e\u5904\u7406\u5668\u6570\u636e\u91cf\u7684\u7ebf\u7a0b\uff1a\u4efb\u52a1\u4ea4\u6362\u8d8a\u9891\u7e41\uff0c\u8d8a\u6709\u53ef\u80fd\u4f7f\u5f97\u9519\u8bef\u4ee3\u7801\u51fa\u9519\uff1b</li> <li>\u88c5\u7f6e\u8bd5\u9519\u4ee3\u7801\uff1a\u6dfb\u52a0\u7ebf\u7a0b\u8c03\u5ea6\u7b49\u4ee3\u7801\uff0c\u6539\u53d8\u6267\u884c\u987a\u5e8f\uff0c\u589e\u52a0\u51fa\u9519\u51e0\u7387<ul> <li>\u786c\u7f16\u7801\uff1a\u624b\u52a8\u52a0\u5165<code>wait()\u3001sleep()\u3001yield()\u3001priority()</code>\u7b49\u8c03\u7528\uff1b</li> <li>\u81ea\u52a8\u5316\uff1aC++ \u53ef\u4ee5\u4f7f\u7528\u5b8f\u5b9a\u4e49\uff0c\u5bf9\u65b9\u6cd5\u6bcf\u6761\u8bed\u53e5\u5b9a\u4e49\u5b8f\uff0c\u6d4b\u8bd5\u65f6\u5f00\u542f\u5e76\u7f16\u8bd1\u8be5\u5b8f\u5b9a\u4e49\uff1b</li> </ul> </li> </ul>"},{"location":"code_guide/clean_code.html#17","title":"17. \u5473\u9053\u4e0e\u542f\u53d1","text":"<ol> <li> <p>1847\u5e74\u5f53\u4f0a\u683c\u7eb3\u5179\u00b7\u585e\u9ea6\u5c14\u7ef4\u65af\uff08Ignaz Semmelweis\uff09\u63d0\u51fa\u533b\u751f\u5e94\u6d17\u624b\u7684\u5efa\u8bae\u65f6\uff0c\u906d\u5230\u4e86\u53cd\u5bf9\uff0c\u4eba\u4eec\u8ba4\u4e3a\u533b\u751f\u592a\u5fd9\uff0c\u63a5\u8bca\u65f6\u65e0\u6687\u6d17\u624b\u3002\u00a0\u21a9</p> </li> </ol>"},{"location":"code_guide/code_refactor.html","title":"\u91cd\u6784","text":"<p>\u4ee5\u4e0b\u5185\u5bb9\u90e8\u5206\u6765\u6e90\u4e8e\u4e66\u7c4d \u300a\u91cd\u6784\uff1a\u6539\u5584\u65e2\u6709\u4ee3\u7801\u7684\u8bbe\u8ba1\u300b</p>"},{"location":"code_guide/code_refactor.html#_2","title":"\u57fa\u672c\u8981\u6c42","text":"\u7c7b\u578b \u8981\u6c42 \u53d8\u91cf\u540d \u8bf4\u660e\u53d8\u91cf\u4ee3\u8868\u7684\u542b\u4e49 \u51fd\u6570\u540d \u8bf4\u660e\u51fd\u6570\u5185\u90e8\u505a\u7684\u4e8b\u60c5 \u7c7b\u540d \u8bf4\u660e\u7c7b\u7684\u529f\u80fd"},{"location":"code_guide/code_refactor.html#_3","title":"\u4ee3\u7801\u574f\u5473\u9053","text":""},{"location":"code_guide/code_refactor.html#_4","title":"\u57fa\u672c","text":""},{"location":"code_guide/code_refactor.html#_5","title":"\u91cd\u590d\u4ee3\u7801","text":"<p>\u68c0\u67e5\uff1aIDEA\u6709\u63d0\u793a</p> <p>\u91cd\u6784\uff1a\u62bd\u53d6\u51fa\u540c\u6837\u4ee3\u7801\u4e3a\u51fd\u6570\uff08\u653e\u5230\u65b0\u7c7b\u6216\u8005\u63d0\u53d6\u5230\u7236\u7c7b\u4e2d\uff09\uff0c\u8fdb\u4e00\u6b65\u53ef\u4ee5\u4f7f\u7528\u6a21\u677f\u65b9\u6cd5\u7684\u8bbe\u8ba1\u6a21\u5f0f\u3002</p>"},{"location":"code_guide/code_refactor.html#_6","title":"\u51fd\u6570","text":""},{"location":"code_guide/code_refactor.html#long-method","title":"\u8fc7\u957f\u7684\u51fd\u6570(Long Method)","text":"<p>\u68c0\u67e5\uff1a\u914d\u7f6eCheckStyle\u7b49\u89c4\u5219\uff0c\u4e00\u822c\u572880\u884c\u4ee5\u5185</p> <p>\u91cd\u6784\uff1a\u4ee3\u7801\u5207\u5206\uff0c\u62bd\u8c61\u51fa\u903b\u8f91\u5c42\u6b21\u4e00\u81f4\u7684\u5b50\u51fd\u6570\uff08\u5982<code>if/else</code>\u4ee3\u7801\u5757\u53ef\u4ee5\u63d0\u70bc\u6210\u51fd\u6570\uff09</p>"},{"location":"code_guide/code_refactor.html#long-parameter-list","title":"\u8fc7\u957f\u7684\u53c2\u6570(Long Parameter List)","text":"<p>\u68c0\u67e5\uff1a\u914d\u7f6eCheckStyle\u7b49\u89c4\u5219\uff0c\u4e00\u822c\u4e0d\u8d85\u8fc75\u4e2a</p> <p>\u91cd\u6784\uff1a\u591a\u4e2a\u53c2\u6570\u7528\u53c2\u6570\u5bf9\u8c61/\u6570\u636e\u7c7b\uff08POJO\uff09\u8fdb\u884c\u66ff\u4ee3</p>"},{"location":"code_guide/code_refactor.html#_7","title":"\u7c7b","text":""},{"location":"code_guide/code_refactor.html#large-class","title":"\u8fc7\u5927\u7684\u7c7b(Large Class)","text":"<p>\u68c0\u67e5\uff1a\u6587\u4ef6\u957f\u5ea6\u8fc7\u5927\uff1f\uff08\u4e0d\u662f\u5f88\u7cbe\u786e\uff09</p> <p>\u91cd\u6784\uff1a\u5355\u4e00\u804c\u8d23\u5bf9\u7c7b\u7684\u529f\u80fd\u8fdb\u884c\u5212\u5206\uff0c\u62c6\u5206\u6210\u591a\u4e2a\u7c7b</p>"},{"location":"code_guide/code_refactor.html#divergent-change","title":"\u53d1\u6563\u5f0f\u53d8\u5316(Divergent Change)","text":"<p>\u68c0\u67e5\uff1a\u7c7b\u56e0\u4e3a\u4e0d\u540c\u65b9\u5411\u7684\u539f\u56e0\u53d8\u5316\u800c\u4fee\u6539</p> <p>\u91cd\u6784\uff1a\u5355\u4e00\u804c\u8d23\u5bf9\u7c7b\u7684\u529f\u80fd\u8fdb\u884c\u5212\u5206\uff0c\u62c6\u5206\u6210\u591a\u4e2a\u7c7b</p>"},{"location":"code_guide/code_refactor.html#shotgun-surgery","title":"\u9730\u5f39\u5f0f\u4fee\u6539(Shotgun Surgery)","text":"<p>\u68c0\u67e5\uff1a\u4fee\u6539\u67d0\u4e2a\u529f\u80fd\uff0c\u8981\u5728\u4e0d\u540c\u7684\u7c7b\u4e2d\u505a\u51fa\u6108\u591a\u5c0f\u4fee\u6539</p> <p>\u91cd\u6784\uff1a\u628a\u6240\u6709\u9700\u8981\u4fee\u6539\u7684\u4ee3\u7801\u653e\u8fdb\u540c\u4e00\u4e2a\u7c7b\u4e2d\uff08\u9700\u8981\u4e0e\u53d1\u6563\u5f0f\u53d8\u5316\u8fdb\u884c\u6743\u8861\uff09</p> <p>\u76ee\u6807\uff1a\u4f7f\u5916\u754c\u53d8\u5316 \u4e0e \u9700\u8981\u4fee\u6539\u7684\u7c7b \u8d8b\u4e8e\u4e00\u4e00\u5bf9\u5e94</p>"},{"location":"code_guide/code_refactor.html#feature-envy","title":"\u4f9d\u604b\u60c5\u7ed3(Feature Envy)","text":"<p>\u5c06\u6570\u636e\u548c\u52a0\u8bf8\u5176\u4e0a\u7684\u64cd\u4f5c\u884c\u4e3a\u5305\u88c5\u5728\u4e00\u8d77</p> <p>\u68c0\u67e5\uff1a\u67d0\u4e2a\u51fd\u6570\u4e3a\u4e86\u8ba1\u7b97\u67d0\u503c\uff0c\u4ece\u53e6\u4e00\u4e2a\u5bf9\u8c61\u90a3\u513f\u8c03\u7528\u51e0\u4e4e\u534a\u6253\u7684\u53d6\u503c\u51fd\u6570\uff08getting method\uff09</p> <p>\u91cd\u6784\uff1a\u5224\u65ad\u54ea\u4e2aclass\u62e5\u6709\u6700\u591a\u300c\u88ab\u6b64\u51fd\u6570\u4f7f\u7528\u300d\u7684\u6570\u636e\uff0c\u7136\u540e\u5c31\u628a\u8fd9\u4e2a\u51fd\u6570\u548c\u90a3\u4e9b\u6570\u636e\u6446\u5728\u4e00\u8d77</p> <p>\u8bf4\u660e\uff1a\u7b56\u7565\u6a21\u5f0f\u3001\u8bbf\u95ee\u8005\u6a21\u5f0f\u3001\u4ee3\u7406\u6a21\u5f0f\uff0c\u867d\u7136\u8fdd\u6cd5\u8be5\u89c4\u5219\uff0c\u4f46\u662f\u662f\u4e3a\u4e86\u89e3\u51b3\u53d1\u6563\u5f0f\u53d8\u5316</p>"},{"location":"code_guide/code_refactor.html#data-clumps","title":"\u6570\u636e\u6ce5\u56e2(Data Clumps)","text":"<p>\u68c0\u67e5\uff1a\u4e24\u4e2a\u7c7b\u4e2d\u6709\u5f88\u591a\u76f8\u540c\u7684\u5b57\u6bb5\uff0c\u51fd\u6570\u7b7e\u540d\u4e2d\u6709\u76f8\u540c\u7684\u53c2\u6570</p> <p>\u91cd\u6784\uff1a\u300c\u603b\u662f\u7ed1\u5728\u4e00\u8d77\u51fa\u73b0\u7684\u6570\u636e\u300d\u771f\u5e94\u8be5\u653e\u8fdb\u5c5e\u4e8e\u5b83\u4eec\u81ea\u5df1\u7684\u5bf9\u8c61\u4e2d</p>"},{"location":"code_guide/code_refactor.html#primitive-obsession","title":"\u57fa\u672c\u7c7b\u578b\u504f\u6267(Primitive Obsession)","text":"<p>\u68c0\u67e5\uff1a\u5bf9\u4e8e\u4e00\u4e9b\u6709\u7269\u7406\u610f\u4e49\u7684\u53d8\u91cf\uff0c\u4f7f\u7528\u57fa\u672c\u7c7b\u578b\uff0c\u5982\u8d77\u59cb\u503c\u3001\u5730\u5740\uff08String\uff09</p> <p>\u91cd\u6784\uff1a\u901a\u8fc7\u5c0f\u5bf9\u8c61\u91cd\u6784\uff0c\u7c7b\u540d\u8868\u793a\u5177\u4f53\u7684\u7269\u7406\u542b\u4e49\uff0c\u6bd4\u5982Range\uff0cAddress\uff08\u91cc\u9762\u53ef\u80fd\u5c31\u4e00\u4e2aString\uff09</p>"},{"location":"code_guide/code_refactor.html#switch","title":"Switch\u8bed\u53e5","text":"<p>\u68c0\u67e5\uff1a\u591a\u5904switch\u8bed\u53e5\uff0c\u540c\u6837\u7684\u679a\u4e3e\u5b57\u6bb5\uff08\u6216<code>type code</code>\uff09\u5224\u65ad</p> <p>\u91cd\u6784\uff1a\u6700\u591a\u4e00\u5904switch\u8bed\u53e5\uff08\u6216\u8005\u5c06switch\u6362\u6210\u53cd\u5c04\uff09\uff0c\u7136\u540e\u7528\u591a\u6001\u5b9a\u4e49\u4e0d\u540c\u7c7b\u578b\u7684\u4e0d\u540c\u5b9e\u73b0</p>"},{"location":"code_guide/code_refactor.html#parallel-inheritance-hierarchies","title":"\u5e73\u884c\u7ee7\u627f\u4f53\u7cfb(Parallel Inheritance Hierarchies)","text":"<p>\u68c0\u67e5\uff1a\u4e3a\u67d0\u4e2aclass\u589e\u52a0\u4e00\u4e2asubclass\uff0c\u5fc5\u987b\u4e5f\u4e3a\u53e6\u4e00\u4e2aclass\u76f8\u5e94\u589e\u52a0\u4e00\u4e2asubclass</p> <p>\u91cd\u6784\uff1a\u8ba9\u4e00\u4e2a\u7ee7\u627f\u4f53\u7cfb\u7684\u5b9e\u4f53\uff08instance\uff09\u5f15\u7528\u53e6\u4e00\u4e2a\u7ee7\u627f\u4f53\u7cfb\u7684\u5b9e\u4f53</p>"},{"location":"code_guide/code_refactor.html#lazy-class","title":"\u5197\u8d58\u7c7b(Lazy Class)","text":"<p>\u68c0\u67e5\uff1a\u4e00\u4e2a\u7c7b\u7528\u5904\u5c11\u6216\u8005\u5df2\u7ecf\u65e0\u7528</p> <p>\u91cd\u6784\uff1a\u5220\u9664\u6216\u8005\u5c06\u5176\u52a0\u5165\u8c03\u7528\u7c7b\u4e2d(Inline Class)\uff0c\u5982\u679c\u662f\u67d0\u4e9b\u5b50\u7c7b\u6ca1\u6709\u505a\u8db3\u591f\u7684\u5de5\u4f5c\uff0c\u4f7f\u7528Collapse Hierarchy (\u6298\u53e0\u7ee7\u627f\u4f53\u7cfb)</p>"},{"location":"code_guide/code_refactor.html#speculative-generality","title":"\u5938\u5938\u5176\u8c08\u672a\u6765\u6027(Speculative Generality)","text":"<p>\u68c0\u67e5\uff1a\u5f53\u524d\u7528\u4e0d\u5230\uff0c\u4ee5\u672a\u6765\u4f1a\u4f7f\u7528\u4e3a\u501f\u53e3</p> <p>\u91cd\u6784\uff1a\u5220\u9664\uff0c\u5982\u679c\u67d0\u4e2aabstract class\u6ca1\u6709\u592a\u5927\u4f5c\u7528\uff0c\u8bf7\u8fd0\u7528Collapse Hierarchy(\u6298\u53e0\u7ee7\u627f\u4f53\u7cfb)</p>"},{"location":"code_guide/code_refactor.html#temporary-field","title":"\u4e34\u65f6\u5b57\u6bb5(Temporary Field)","text":"<p>\u68c0\u67e5\uff1a\u7c7b\u4e2d\u53d8\u91cf\u4ec5\u4e3a\u67d0\u79cd\u7279\u5b9a\u60c5\u52bf\u800c\u8bbe\uff08\u4ece\u7c7b\u7684\u751f\u547d\u5468\u671f\uff09\uff0c\u6bd4\u5982\u53ea\u53c2\u4e0e\u5230\u67d0\u4e2a\u7b97\u6cd5\u51fd\u6570\u4e2d</p> <p>\u91cd\u6784\uff1a\u53d8\u91cf\u548c\u5176\u76f8\u5173\u51fd\u6570\u63d0\u70bc\u5230\u4e00\u4e2a\u72ec\u7acbclass\u4e2d\uff0c\u63d0\u70bc\u540e\u7684\u65b0\u5bf9\u8c61\u5c06\u662f\u4e00\u4e2amethod object</p>"},{"location":"code_guide/code_refactor.html#message-chains","title":"\u8fc7\u5ea6\u8026\u5408\u7684\u6d88\u606f\u94fe(Message Chains)","text":"<p>\u68c0\u67e5\uff1a<code>a.getB().getC().getD()</code></p> <p>\u91cd\u6784\uff1a\u59d4\u6258\u51fd\u6570\uff0c\u4e0e<code>\u4e2d\u95f4\u4eba\u95ee\u9898</code>\u662f\u4e2a\u6743\u8861</p> <p>\u8bf4\u660e\uff1a\u8fea\u7c73\u7279\u6cd5\u5219</p>"},{"location":"code_guide/code_refactor.html#middle-man","title":"\u4e2d\u95f4\u4eba(Middle Man)","text":"<p>\u68c0\u67e5\uff1a\u67d0\u4e2aclass\u63a5\u53e3\u6709\u4e00\u534a\u7684\u51fd\u6570\u90fd\u59d4\u6258\u7ed9\u5176\u4ed6class</p> <p>\u91cd\u6784\uff1aRemove Middle Man\uff0c\u76f4\u63a5\u548c\u5b9e\u8d23\u5bf9\u8c61\u6253\u4ea4\u9053</p>"},{"location":"code_guide/code_refactor.html#inappropriate-intimacy","title":"\u72ce\u6635\u5173\u7cfb(Inappropriate Intimacy)","text":"<p>\u68c0\u67e5\uff1a\u4e24\u4e2aclasses\u8fc7\u4e8e\u4eb2\u5bc6\uff0c\u82b1\u8d39\u592a\u591a\u65f6\u95f4\u53bb\u63a2\u7a76\u5f7c\u6b64\u7684private\u6210\u5206</p> <p>\u91cd\u6784\uff1a</p> <ul> <li> <p>\u5c06\u53cc\u5411\u5173\u8054\u6539\u4e3a\u5355\u5411\u5173\u8054\uff08Change Bidirectional Association to Unidirectional\uff09\u3002</p> </li> <li> <p>\u63d0\u70bc\u7c7b\uff0c\u5c06\u4e24\u4e2a\u7c7b\u7684\u5171\u540c\u70b9\u63d0\u70bc\u5230\u65b0\u7c7b\u4e2d\uff0c\u8ba9\u5b83\u4eec\u5171\u540c\u4f7f\u7528\u65b0\u7c7b\u3002</p> </li> <li> <p>\u7ee7\u627f\u5f80\u5f80\u9020\u6210\u8fc7\u5ea6\u4eb2\u5bc6\uff0c\u8fd0\u7528\u4ee5\u59d4\u6258\u53d6\u4ee3\u7ee7\u627f\uff08Replace Inheritance with Delegate\uff09</p> </li> </ul>"},{"location":"code_guide/code_refactor.html#alternative-classes-with-different-interfaces","title":"\u5f02\u66f2\u540c\u5de5\u7684\u7c7b(Alternative Classes with Different Interfaces)","text":"<p>\u68c0\u67e5\uff1a\u4e24\u4e2a\u51fd\u6570\u505a\u540c\u4e00\u4ef6\u4e8b\uff0c\u5374\u6709\u7740\u4e0d\u540c\u7684\u7b7e\u540d\u5f0f\uff08signatures\uff09</p> <p>\u91cd\u6784\uff1a\u62bd\u8c61\u5e76\u7edf\u4e00</p>"},{"location":"code_guide/code_refactor.html#incomplete-library-class","title":"\u4e0d\u5b8c\u7f8e\u7684\u7a0b\u5e8f\u5e93\u7c7b(Incomplete Library Class)","text":"<p>\u68c0\u67e5\uff1a\u5916\u90e8\u7684\u7c7b\u5e93\u65e0\u6cd5\u6ee1\u8db3\u5b9e\u9645\u7684\u9700\u6c42\uff0c\u9700\u8981\u989d\u5916\u7684\u65b9\u6cd5</p> <p>\u91cd\u6784\uff1a</p> <ul> <li>\u4fee\u6539\u7c7b\u5e93\u7684\u4e00\u4e24\u4e2a\u51fd\u6570 - \u5f15\u5165\u5916\u90e8\u51fd\u6570\uff08Introduce Foreign Method\uff09</li> <li>\u6dfb\u52a0\u4e00\u5927\u5806\u989d\u5916\u884c\u4e3a - \u6dfb\u52a0\u672c\u5730\u6269\u5c55\uff08Introduce Local Extension\uff09</li> </ul>"},{"location":"code_guide/code_refactor.html#data-class","title":"Data Class(\u7eaf\u7a1a\u7684\u6570\u636e\u7c7b)","text":"<p>\u68c0\u67e5\uff1a\u6570\u636e\u7c7b\u628a\u5168\u90e8\u5b57\u6bb5\u5355\u7eaf\u7684\u901a\u8fc7getter/setter\u66b4\u9732\u51fa\u6765</p> <p>\u91cd\u6784\uff1a</p> <ul> <li>\u4e0d\u8be5\u88ab\u5176\u4ed6classes\u4fee\u6539\u7684\u503c\u57df\uff0c\u8bf7\u8fd0\u7528 Remove Setting Method\u3002</li> <li>\u66b4\u9732\u62bd\u8c61\u63a5\u53e3\uff08\u5c06\u8c03\u7528\u884c\u4e3a\u4ee3\u7801\u79fb\u5230Data Class\u4e2d\uff09\uff0c\u5c01\u88c5\u5185\u90e8\u7ed3\u6784\u3002</li> </ul>"},{"location":"code_guide/code_refactor.html#refused-bequest","title":"\u88ab\u62d2\u7edd\u7684\u9057\u8d60(Refused Bequest)","text":"<p>\u68c0\u67e5\uff1a1\uff09\u5b50\u7c7b\u7ee7\u627f\u7236\u7c7b\u7684\u6240\u6709\u51fd\u6570\u548c\u6570\u636e\uff0c\u5b50\u7c7b\u53ea\u6311\u9009\u51e0\u6837\u6765\u4f7f\u7528\uff1b2\uff09\u5b50\u7c7b\u53ea\u590d\u7528\u4e86\u7236\u7c7b\u7684\u884c\u4e3a\uff0c\u5374\u4e0d\u60f3\u652f\u6301\u7236\u7c7b\u7684\u63a5\u53e3</p> <p>\u91cd\u6784\uff1a1\uff09\u4e3a\u5b50\u7c7b\u65b0\u5efa\u4e00\u4e2a\u5144\u5f1f\u7c7b\uff0c\u518d\u8fd0\u7528\u4e0b\u79fb\u65b9\u6cd5\uff08Push Down Method\uff09\u548c\u4e0b\u79fb\u5b57\u6bb5\uff08Push Down Field\uff09\u628a\u7528\u4e0d\u5230\u7684\u51fd\u6570\u4e0b\u63a8\u4e2a\u5144\u5f1f\u7c7b\uff1b</p> <p>2\uff09\u8fd0\u7528\u59d4\u6258\u66ff\u4ee3\u7ee7\u627f\uff08Replace Inheritance with Delegation\uff09\u6765\u8fbe\u5230\u76ee\u7684\u3002</p>"},{"location":"code_guide/code_refactor.html#comments","title":"\u8fc7\u591a\u7684\u6ce8\u91ca(Comments)","text":"<p>\u68c0\u67e5\uff1a\u9700\u8981\u6ce8\u91ca\u6765\u89e3\u91ca\u4e00\u5757\u4ee3\u7801\u505a\u4e86\u4ec0\u4e48</p> <p>\u91cd\u6784\uff1a\u62bd\u8c61\u4ee3\u7801\u5b9e\u73b0\u4e3a\u51fd\u6570\uff0c\u901a\u8fc7\u597d\u7684\u547d\u540d\u65b9\u5f0f\u9610\u8ff0\u4ee3\u7801\u7684\u529f\u80fd</p>"},{"location":"code_guide/code_refactor.html#_8","title":"\u91cd\u65b0\u7ec4\u7ec7\u51fd\u6570","text":""},{"location":"code_guide/code_refactor.html#extract-method","title":"\u63d0\u70bc\u51fd\u6570\uff08Extract Method\uff09","text":"<p>\u4e00\u6bb5\u4ee3\u7801\u53ef\u4ee5\u88ab\u7ec4\u7ec7\u5728\u4e00\u8d77\u5e76\u72ec\u7acb\u51fa\u6765\u3002</p> <p>\u51fd\u6570\u6df1\u5ea6\uff08\u5c42\u6b21\uff09\u5e94\u8be5\u4fdd\u6301\u7edf\u4e00\u7ea7\u522b\u3002</p> <pre><code>void printOwing(double amount) {\n    printBanner();          // \u540c\u4e00\u8c03\u7528\u5c42\u6b21\u7ea7\u522b\n    System.out.println(\"amount\" + amount); // \u4e0d\u662f\u540c\u4e00\u8c03\u7528\u5c42\u6b21\n    printDetailer();        // \u540c\u4e00\u8c03\u7528\u5c42\u6b21\u7ea7\u522b\n}\n</code></pre>"},{"location":"code_guide/design_principle.html","title":"\u8bbe\u8ba1\u539f\u5219","text":"<p>\u9762\u5411\u5bf9\u8c61\u7279\u6027\uff1a</p> <ul> <li>\u62bd\u8c61\uff1a\u5bf9\u4e1a\u52a1\u7684\u5efa\u6a21\uff0c\u5bf9\u67b6\u6784\u7684\u5b8f\u89c2\u638c\u63a7\uff1b</li> <li>\u5c01\u88c5\uff1a\u7ef4\u62a4\u6027\uff0c\u5bf9\u8c61\u529f\u80fd\u5185\u805a\uff0c\u6a21\u5757\u8026\u5408\u53d8\u4f4e\uff1b</li> <li>\u7ee7\u627f\uff1a\u590d\u7528\u6027\uff0c\u5b50\u7c7b\u7ee7\u627f\u7236\u7c7b\u7684\u65b9\u6cd5\uff1b</li> <li>\u591a\u6001\uff1a\u6269\u5c55\u6027\uff0c\u6307\u8986\u76d6\uff08override\uff09\uff0c\u5b50\u7c7b\u8986\u5199\u7236\u7c7b\u7684\u65b9\u6cd5\uff1b</li> </ul>"},{"location":"code_guide/design_principle.html#srp","title":"\u5355\u4e00\u804c\u8d23\u539f\u5219\uff08SRP\uff09","text":"<p>Single Responsbility Principle\uff1a\u4e00\u4e2a\u7c7b\u66f4\u6539\u7684\u539f\u56e0\u4e0d\u5e94\u8d85\u8fc7\u4e00\u4e2a\u3002</p> <p>\u9ad8\u5185\u805a</p> <ul> <li>\u4e8b\u5b9e\u4e0a\uff0c\u7531\u4e8e\u4e00\u4e9b\u5176\u4ed6\u7684\u56e0\u7d20\u5f71\u54cd\uff0c\u7c7b\u7684\u5355\u4e00\u804c\u8d23\u5728\u9879\u76ee\u4e2d\u662f\u5f88\u96be\u4fdd\u8bc1\u7684\uff1b</li> <li>\u901a\u5e38\uff0c\u63a5\u53e3\u548c\u65b9\u6cd5\u7684\u5355\u4e00\u804c\u8d23\u66f4\u5bb9\u6613\u5b9e\u73b0\u3002</li> </ul>"},{"location":"code_guide/design_principle.html#ocp","title":"\u5f00\u653e\u5c01\u95ed\u539f\u5219\uff08OCP\uff09","text":"<p>Open Close Principle\uff1a\u4e00\u4e2a\u8f6f\u4ef6\u5b9e\u4f53\uff0c\u5982\u7c7b\u3001\u6a21\u5757\u548c\u51fd\u6570\uff0c\u5bf9\u6269\u5c55\u5f00\u653e\uff0c\u5bf9\u4fee\u6539\u5173\u95ed\u3002\uff08\u53ea\u52a0\u4e0d\u6539\uff09</p> <ul> <li>\u4e00\u4e2a\u8f6f\u4ef6\u5b9e\u4f53\u5982\u7c7b\uff0c\u6a21\u5757\u548c\u51fd\u6570\u5e94\u8be5\u5bf9\u6269\u5c55\u5f00\u653e\uff08\u5bf9\u4e8e\u63d0\u4f9b\u65b9\u6765\u8bf4\uff09\uff0c\u5bf9\u4fee\u6539\u5173\u95ed\uff08\u5bf9\u4e8e\u4f7f\u7528\u65b9\u6765\u8bf4\uff09;</li> <li>\u7528\u62bd\u8c61\u6784\u5efa\u6846\u67b6\uff0c\u7528\u5b9e\u73b0\u6269\u5c55\u7ec6\u8282\uff1b</li> <li>\u5f53\u8f6f\u4ef6\u9700\u8981\u53d8\u5316\u65f6\uff0c\u5c3d\u91cf\u901a\u8fc7\u6269\u5c55\u8f6f\u4ef6\u5b9e\u4f53\u7684\u884c\u4e3a\u6765\u5b9e\u73b0\u53d8\u5316\uff0c\u800c\u4e0d\u662f\u901a\u8fc7\u4fee\u6539\u5df2\u6709\u7684\u4ee3\u7801\u6765\u5b9e\u73b0\u53d8\u5316\u3002</li> </ul>"},{"location":"code_guide/design_principle.html#lsp","title":"\u91cc\u6c0f\u66ff\u6362\u539f\u5219\uff08LSP\uff09","text":"<p>Liskov ubstitution Principle\uff1a\u5982\u679cS\u662fT\u7684\u5b50\u7c7b\u578b\uff0c\u5bf9\u4e8eS\u7c7b\u578b\u7684\u4efb\u610f\u5bf9\u8c61\uff0c\u5982\u679c\u5c06\u4ed6\u4eec\u770b\u4f5c\u662fT\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u5219\u5bf9\u8c61\u7684\u884c\u4e3a\u4e5f\u7406\u5e94\u4e0e\u671f\u671b\u7684\u884c\u4e3a\u4e00\u81f4\u3002</p> <p>\u6240\u6709\u5f15\u7528\u57fa\u7c7b\u7684\u5730\u65b9\u5fc5\u987b\u80fd\u900f\u660e\u5730\u4f7f\u7528\u5176\u5b50\u7c7b\u7684\u5bf9\u8c61</p> <ul> <li>\u5b50\u7c7b\u5b9e\u73b0\u7236\u7c7b\u65b9\u6cd5\u65f6\uff0c\u4e0d\u80fd\u8fdd\u53cd\u7236\u7c7b\u5bf9\u4e8e\u65b9\u6cd5\u7684\u5b9a\u4e49\u8bf4\u660e\uff0c\u5982\u629b\u51fa\u57fa\u7c7b\u672a\u5b9a\u4e49\u7684\u5f02\u5e38\uff0c\u6539\u53d8\u51fd\u6570\u8bed\u4e49\u7b49\uff1b</li> </ul>"},{"location":"code_guide/design_principle.html#lod","title":"\u8fea\u7c73\u7279\u6cd5\u5219\uff08Lod\uff09","text":"<p>Law of Demeter\uff1a\u53ea\u4e0e\u4f60\u7684\u76f4\u63a5\u670b\u53cb\u4ea4\u8c08\uff0c\u4e0d\u8ddf\u201c\u964c\u751f\u4eba\u201d\u8bf4\u8bdd\u3002\uff08\u6700\u5c0f\u77e5\u8bc6\u539f\u5219\uff09</p> <p>\u5f3a\u8c03\u4ee5\u4e0b\u4e24\u70b9\uff1a</p> <ul> <li>\u4ece\u4f9d\u8d56\u8005\u7684\u89d2\u5ea6\u6765\u8bf4\uff0c\u53ea\u4f9d\u8d56\u5e94\u8be5\u4f9d\u8d56\u7684\u5bf9\u8c61\u3002</li> <li>\u4ece\u88ab\u4f9d\u8d56\u8005\u7684\u89d2\u5ea6\u8bf4\uff0c\u53ea\u66b4\u9732\u5e94\u8be5\u66b4\u9732\u7684\u65b9\u6cd5\u3002</li> </ul> <p>\u5728\u91c6\u7528\u8fea\u7c73\u7279\u6cd5\u5219\u65f6\u9700\u8981\u53cd\u590d\u6743\u8861\uff0c\u786e\u4fdd\u9ad8\u5185\u805a\u548c\u4f4e\u8026\u5408\u7684\u540c\u65f6\uff0c\u4fdd\u8bc1\u7cfb\u7edf\u7684\u7ed3\u6784\u6e05\u6670\u3002</p> <p>\u4f18\u70b9\uff1a</p> <ul> <li>\u907f\u514d\u5ba2\u6237\u7aef\u4ee3\u7801\u5c06\u4e0e\u67e5\u627e\u8fc7\u7a0b\u4e2d\u7684\u94fe\u6761\u7ed3\u6784\u7d27\u5bc6\u8026\u5408\uff0c\u4e00\u65e6\u94fe\u6761\u95f4\u7684\u4efb\u4f55\u5bf9\u8c61\u53d1\u751f\u53d8\u5316\uff0c\u5ba2\u6237\u7aef\u5c31\u4e0d\u5f97\u4e0d\u505a\u51fa\u76f8\u5e94\u4fee\u6539\u8fd9\u6837\u7684\u8bdd\u65e0\u5f62\u4e2d\u589e\u52a0\u4e86\u5f00\u53d1\u6210\u672c\u3002</li> </ul> <p>\u7f3a\u70b9</p> <ul> <li>\u5728\u7cfb\u7edf\u91cc\u9020\u51fa\u5927\u91cf\u7684\u5c0f\u65b9\u6cd5\uff08\u4e2d\u4ecb\u7c7b\uff09\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u4ec5\u4ec5\u662f\u4f20\u9012\u95f4\u63a5\u7684\u8c03\u7528\uff0c\u4e0e\u7cfb\u7edf\u7684\u4e1a\u52a1\u903b\u8f91\u65e0\u5173\u3002</li> </ul>"},{"location":"code_guide/design_principle.html#isp","title":"\u63a5\u53e3\u9694\u79bb\u539f\u5219\uff08ISP\uff09","text":"<p>Interface Segregation Principle\uff1a\u9488\u5bf9\u63a5\u53e3\u7f16\u7a0b</p> <p>\u8981\u4e3a\u5404\u4e2a\u7c7b\u5efa\u7acb\u5b83\u4eec\u9700\u8981\u7684\u4e13\u7528\u63a5\u53e3\uff0c\u800c\u4e0d\u8981\u8bd5\u56fe\u53bb\u5efa\u7acb\u4e00\u4e2a\u5f88\u5e9e\u5927\u7684\u63a5\u53e3\u4f9b\u6240\u6709\u4f9d\u8d56\u5b83\u7684\u7c7b\u53bb\u8c03\u7528\u3002</p> <ul> <li>\u5ba2\u6237\u7aef\u4e0d\u5e94\u8be5\u4f9d\u8d56\u5b83\u4e0d\u9700\u8981\u7684\u63a5\u53e3\u3002</li> <li>\u7c7b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u5e94\u8be5\u5efa\u7acb\u5728\u6700\u5c0f\u7684\u63a5\u53e3\u4e0a</li> </ul>"},{"location":"code_guide/design_principle.html#dip","title":"\u4f9d\u8d56\u5012\u7f6e\u539f\u5219\uff08DIP\uff09","text":"<p>Dependence Inversion Principle\uff1a\u4f9d\u8d56\u4e8e\u62bd\u8c61\u800c\u4e0d\u662f\u5b9e\u73b0\u7c7b</p> <ul> <li>\u4e0a\u5c42\u6a21\u5757\u4e0d\u5e94\u8be5\u4f9d\u8d56\u5e95\u5c42\u6a21\u5757\uff0c\u5b83\u4eec\u90fd\u5e94\u8be5\u4f9d\u8d56\u4e8e\u62bd\u8c61\u3002</li> <li>\u62bd\u8c61\u4e0d\u5e94\u8be5\u4f9d\u8d56\u4e8e\u7ec6\u8282\uff0c\u7ec6\u8282\u5e94\u8be5\u4f9d\u8d56\u4e8e\u62bd\u8c61</li> </ul>"},{"location":"code_guide/algs/index.html","title":"\u7b97\u6cd5","text":""},{"location":"code_guide/algs/index.html#master","title":"Master \u5b9a\u7406","text":"<p>\\(O\\)\uff1a\u8868\u793a\u4e0a\u754c\uff08tightness unknown\uff09\uff0c\u5373\u5c0f\u4e8e\u7b49\u4e8e</p> <p>\\(\\Theta\\)\uff1a\u8be5\u65f6\u95f4\u590d\u6742\u5ea6\u65e2\u662f\u4e0a\u754c\u4e5f\u662f\u4e0b\u754c\uff08tight\uff09\uff0c\u5373\u7b49\u4e8e\u7684\u610f\u601d</p> <p>\\(\\Omega\\)\uff1a\u8868\u793a\u4e0b\u754c\uff08tightness unknown\uff09\uff0c\u5373\u5927\u4e8e\u7b49\u4e8e\u7684\u610f\u601d</p> <p>\u9012\u63a8\u516c\u5f0f\u7684\u590d\u6742\u5ea6\u8ba1\u7b97\uff0cn \u662f\u95ee\u9898\u89c4\u6a21\uff0cb \u662f\u9012\u5f52\u5b50\u95ee\u9898\u7684\u6570\u91cf\uff0cn/c \u4e3a\u6bcf\u4e2a\u5b50\u95ee\u9898\u7684\u89c4\u6a21\uff08\u5047\u8bbe\u6bcf\u4e2a\u5b50\u95ee\u9898\u7684\u89c4\u6a21\u57fa\u672c\u4e00\u6837\uff09\uff0cf(n) \u4e3a\u9012\u5f52\u4ee5\u5916\u8fdb\u884c\u7684\u8ba1\u7b97\u5de5\u4f5c\u3002</p> <p>\\(T(n)=b*T(\\frac{n}{c})+f(n)\\)</p> <p>\u5982\u679c\u5bf9\u4efb\u610f\u6b63\u6570 \\(\\epsilon \\(\uff0c\\)E = lg(b) / lg(c) = lg_c{b}\\)</p> <ul> <li>\\(f(n) = O(n^{(E\u2212\\epsilon)})\uff0c\u5219T(n) = \\Theta(n^E)\\)\uff1b</li> <li>\\(f(n)= \\Theta(n^E)\uff0c\u5219T(n)=\u0398(f(n)log\u2061(n))\\)\uff1b</li> <li>\\(f(n)=\u03a9(n^{(E\u2212\u03f5)}), \u4e14\u5bf9\u67d0\u4e2a\u03b4\u2265\u03f5\u6709f(n)=\u039f(n^{(E+\u03b4))}\uff0c\u5219T(n)=\u0398(f(n))\\)\uff1b</li> </ul> <p>\u793a\u4f8b\uff1a</p> <ul> <li>\u4e8c\u53c9\u6811\u904d\u5386\uff1a\\(T(n)=2*T(\\frac{n}{2}) + \\Omega(1)=\\Theta(n)\\)</li> <li>\u5f52\u5e76\u6392\u5e8f\uff1a\\(T(n)=2T(\\frac{n}{2}) + \\Omega(n)=\\Theta(nlog n)\\)</li> </ul>"},{"location":"code_guide/algs/index.html#_2","title":"\u9012\u5f52\u8f6c\u5faa\u73af","text":"<p>\u4ee3\u7801\u5b9e\u73b0\u89c1 \u9012\u5f52\u53d8\u5faa\u73af\u901a\u7528\u65b9\u6cd5\u3002</p> <p>\u9012\u5f52\u8f6c\u5faa\u73af\u7684\u901a\u7528\u65b9\u6cd5\uff1a\u901a\u8fc7\u624b\u52a8\u6a21\u62df\u6808\u5e27\u7684\u6267\u884c\u3002</p> <pre><code>// \u6811\u7684\u540e\u5e8f\u904d\u5386\uff1a\u9012\u5f52\u7248\npublic static &lt;E&gt; void postOrderRecursive(BinaryTreeNode&lt;E&gt; root, List&lt;E&gt; store) {\n    if (root == null) {\n        return;\n    }\n    if (root.getLeft() != null) postOrderRecursive(root.getLeft(), store);\n    if (root.getRight() != null) postOrderRecursive(root.getRight(), store);\n    store.add(root.getVal());\n}\n\n// \u6811\u7684\u540e\u5e8f\u904d\u5386\uff1a\u975e\u9012\u5f52\u7248\npublic static &lt;E&gt; void postOrder(BinaryTreeNode&lt;E&gt; root, List&lt;E&gt; store) {\n    if (root == null) {\n        return;\n    }\n    Deque&lt;Frame&lt;E&gt;&gt; stack = new LinkedList&lt;&gt;();\n    stack.add(new Frame&lt;&gt;(root, store));\n    while (!stack.isEmpty()) {\n        Frame&lt;E&gt; current = stack.getLast();\n        switch (current.pc) {\n            case 0:\n                if (current.node == null) stack.removeLast();\n                break;\n            case 1:\n                if (current.node.getLeft() != null) stack.add(new Frame&lt;&gt;(current.node.getLeft(), store));\n                break;\n            case 2:\n                if (current.node.getRight() != null) stack.add(new Frame&lt;&gt;(current.node.getRight(), store));\n                break;\n            case 3:\n                store.add(current.node.getVal());\n                break;\n            case 4:\n                stack.removeLast();\n                break;\n        }\n        current.pc += 1;\n    }\n}\n// \u6808\u5e27\u4fdd\u5b58\u7684\u5185\u5bb9\nprivate static class Frame&lt;E&gt; {\n    int pc;\n    BinaryTreeNode&lt;E&gt; node;\n    List&lt;E&gt; store;\n    public Frame(BinaryTreeNode&lt;E&gt; node, List&lt;E&gt; store) {\n        this.pc = 0;\n        this.node = node;\n        this.store = store;\n    }\n}\n</code></pre>"},{"location":"code_guide/algs/index.html#_3","title":"\u6781\u5927\u6781\u5c0f\u7b97\u6cd5","text":"<p>\u6781\u5c0f\u6781\u5927\u5b9e\u9645\u4e0a\u4f7f\u7528\u4e86DFS\u6765\u904d\u5386\u5f53\u524d\u5c40\u52bf\u4ee5\u540e\u6240\u6709\u53ef\u80fd\u7684\u7ed3\u679c\uff0c\u901a\u8fc7\u300e\u6700\u5927\u5316\u300f\u81ea\u5df1\u548c\u300e\u6700\u5c0f\u5316\u300f\u5bf9\u624b\u7684\u65b9\u6cd5\u83b7\u53d6\u4e0b\u4e00\u6b65\u7684\u52a8\u4f5c\u3002</p> <ul> <li>\u9700\u8981\u4e00\u4e2a\u5c40\u9762\u8bc4\u4f30\u5668\uff0c\u8bc4\u4f30\u5f53\u524d\u6b65\u9aa4\u7684\u5f97\u5206\uff0c\u542f\u53d1\u5f0f\u7b97\u6cd5\uff1b</li> <li>\u03b1-\u03b2\u526a\u679d\u4e5f\u662f\u7c7b\u4f3c\u7684\u601d\u60f3\uff0c\u53ea\u4e0d\u8fc7\u6548\u7387\u66f4\u9ad8\uff0c\u56e0\u4e3a\u5b83\u5220\u51cf\u4e86\u4e00\u4e9b\u4e0d\u9700\u8981\u904d\u5386\u7684\u7ed3\u70b9\u3002</li> </ul>"},{"location":"code_guide/algs/async_distributed_dataflow_snapshots.html","title":"Lightweight Asynchronous Snapshots for Distributed Dataflows","text":"<p>TODO: \u963f\u91cc\u4e91\u76d8\u6587\u7ae0\u9605\u8bfb\u548c\u5206\u4eab</p>"},{"location":"code_guide/algs/bloom_filter.html","title":"\u5e03\u9686\u8fc7\u6ee4\u5668","text":""},{"location":"code_guide/algs/bloom_filter.html#_2","title":"\u539f\u7406","text":"<p>\u5f53\u4e00\u4e2a\u5143\u7d20\u88ab\u52a0\u5165\u96c6\u5408\u65f6\uff0c\u901a\u8fc7 <code>K</code>\u4e2a Hash \u51fd\u6570\u5c06\u8fd9\u4e2a\u5143\u7d20\u6620\u5c04\u6210\u4e00\u4e2a\u4f4d\u9635\u5217\uff08Bit array\uff09\u4e2d\u7684 K \u4e2a\u70b9\uff0c\u628a\u5b83\u4eec\u7f6e\u4e3a 1\u3002\u68c0\u7d22\u65f6\uff0c\u6211\u4eec\u53ea\u8981\u770b\u770b\u8fd9\u4e9b\u70b9\u662f\u4e0d\u662f\u90fd\u662f 1 \u5c31\uff08\u5927\u7ea6\uff09\u77e5\u9053\u96c6\u5408\u4e2d\u6709\u6ca1\u6709\u5b83\u4e86\uff1a</p> <ul> <li>\u5982\u679c\u8fd9\u4e9b\u70b9\u6709\u4efb\u4f55\u4e00\u4e2a 0\uff0c\u5219\u88ab\u68c0\u7d22\u5143\u7d20\u4e00\u5b9a\u4e0d\u5728\uff1b</li> <li>\u5982\u679c\u90fd\u662f 1\uff0c\u5219\u88ab\u68c0\u7d22\u5143\u7d20\u5f88\u53ef\u80fd\u5728\u3002</li> </ul>"},{"location":"code_guide/algs/bloom_filter.html#_3","title":"\u8bef\u7b97\u7387","text":"<p>\u5047\u8bbeBit Array\u4f4d\u6570\u4e3a<code>m</code>\uff0c \u63d2\u5165\u5143\u7d20\u4e2a\u6570\u4e3a<code>n</code>\uff0cHash\u51fd\u6570\u4e2a\u6570\u4e3a<code>k</code></p> \u8bf4\u660e \u8ba1\u7b97\u516c\u5f0f n\u6b21\u63d2\u5165\uff0c\u67d0\u4e2a\u4f4d\u7f6e\u88ab\u7f6e\u62101\u7684\u6982\u7387 \\(P=1-(1-\\frac{1}{m})^{kn}=1-(1-\\frac{1}{m})^{m(\\frac{kn}{m})} \\approx 1-e^\\frac{-kn}{m}\\) \u8bef\u5224\u7684\u6982\u7387 \\(p^k=(1-e^\\frac{-kn}{m})^k\\)\uff0c\u5f53 \\(k = m /n * ln 2 = 0.7m/n\\) \u65f6\uff0c\u6982\u7387\u6700\u5c0f(\u53d6\u5bf9\u6570\uff0c\u6c42\u5bfc=0\uff09 \u8bef\u5224\u7387 &lt; 1 / 2\uff0c\u5219 \\(ln 2 * \\frac{m}{n}  &gt; 1\\) <p>\u6ce8\uff1a \\(lim (1+\\frac{1}{x})^x = e\\)</p> <p>\u7f3a\u70b9\uff1a</p> <ul> <li> <p>\u968f\u7740\u5b58\u5165\u7684\u5143\u7d20\u6570\u91cf\u589e\u52a0\uff0c\u8bef\u7b97\u7387\u968f\u4e4b\u589e\u52a0\uff1b\uff08\u5efa\u7acb\u767d\u540d\u5355\uff09</p> </li> <li> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u80fd\u4ece\u5e03\u9686\u8fc7\u6ee4\u5668\u4e2d\u5220\u9664\u5143\u7d20\uff1b</p> </li> </ul> <p>\u8bef\u7b97\u7387\u8868</p> m/n k k=1 k=2 k=3 k=4 k=5 k=6 k=7 k=8 2 1.39 0.393 0.400 3 2.08 0.283 0.237 0.253 4 2.77 0.221 0.155 0.147 0.160 5 3.46 0.181 0.109 0.092 0.092 0.101 6 4.16 0.154 0.0804 0.0609 0.0561 0.0578 0.0638 7 4.85 0.133 0.0618 0.0423 0.0359 0.0347 0.0364 8 5.55 0.118 0.0489 0.0306 0.024 0.0217 0.0216 0.0229 9 6.24 0.105 0.0397 0.0228 0.0166 0.0141 0.0133 0.0135 0.0145 10 6.93 0.0952 0.0329 0.0174 0.0118 0.00943 0.00844 0.00819 0.00846 11 7.62 0.0869 0.0276 0.0136 0.00864 0.0065 0.00552 0.00513 0.00509 12 8.32 0.08 0.0236 0.0108 0.00646 0.00459 0.00371 0.00329 0.00314 13 9.01 0.074 0.0203 0.00875 0.00492 0.00332 0.00255 0.00217 0.00199 14 9.7 0.0689 0.0177 0.00718 0.00381 0.00244 0.00179 0.00146 0.00129 15 10.4 0.0645 0.0156 0.00596 0.003 0.00183 0.00128 0.001 0.000852 16 11.1 0.0606 0.0138 0.005 0.00239 0.00139 0.000935 0.000702 0.000574 17 11.8 0.0571 0.0123 0.00423 0.00193 0.00107 0.000692 0.000499 0.000394 18 12.5 0.054 0.0111 0.00362 0.00158 0.000839 0.000519 0.00036 0.000275 19 13.2 0.0513 0.00998 0.00312 0.0013 0.000663 0.000394 0.000264 0.000194 20 13.9 0.0488 0.00906 0.0027 0.00108 0.00053 0.000303 0.000196 0.00014 21 14.6 0.0465 0.00825 0.00236 0.000905 0.000427 0.000236 0.000147 0.000101 22 15.2 0.0444 0.00755 0.00207 0.000764 0.000347 0.000185 0.000112 7.46e-05 23 15.9 0.0425 0.00694 0.00183 0.000649 0.000285 0.000147 8.56e-05 5.55e-05 24 16.6 0.0408 0.00639 0.00162 0.000555 0.000235 0.000117 6.63e-05 4.17e-05 25 17.3 0.0392 0.00591 0.00145 0.000478 0.000196 9.44e-05 5.18e-05 3.16e-05 26 18 0.0377 0.00548 0.00129 0.000413 0.000164 7.66e-05 4.08e-05 2.42e-05 27 18.7 0.0364 0.0051 0.00116 0.000359 0.000138 6.26e-05 3.24e-05 1.87e-05 28 19.4 0.0351 0.00475 0.00105 0.000314 0.000117 5.15e-05 2.59e-05 1.46e-05 29 20.1 0.0339 0.00444 0.000949 0.000276 9.96e-05 4.26e-05 2.09e-05 1.14e-05 30 20.8 0.0328 0.00416 0.000862 0.000243 8.53e-05 3.55e-05 1.69e-05 9.01e-06"},{"location":"code_guide/algs/bloom_filter.html#khash","title":"k\u4e2aHash\u51fd\u6570\u7684\u9009\u62e9","text":"<p>\u300aLess Hashing, Same Performance: Building a Better Bloom Filter\u300b\u63d0\u51fa\u7684\u4e00\u4e2a\u6280\u5de7\uff0c\u53ef\u4ee5\u75282\u4e2a\u54c8\u5e0c\u51fd\u6570\u6765\u6a21\u62dfk\u4e2a\u54c8\u5e0c\u51fd\u6570\uff0c\u5373<code>gi(x) = h1(x) + i * h2(x)</code>\uff0c\u5176\u4e2d<code>0&lt;=i&lt;=k-1</code>\uff0c\u53ef\u4ee5\u53c2\u8003<code>Google Guava</code>\u4e2d\u7684Bloom Filter\u7684\u5b9e\u73b0\u3002</p> <p>\u5047\u5982\uff0c\u4f60\u6709\u4e00\u4e2a\u54c8\u5e0c\u51fd\u6570f\uff0c\u5b83\u7684\u8f93\u51fa\u57df\u662f\\(2^{64}\\)\uff0c\u4e5f\u5c31\u662f16\u5b57\u8282\u7684\u5b57\u7b26\u4e32\uff0c\u6bcf\u4e2a\u4f4d\u7f6e\u4e0a\u662f16\u8fdb\u5236\u7684\u6570\u5b57<code>0-9\uff0ca-f</code>\u3002\u6211\u4eec\u5c06\u8fd916\u5b57\u8282\u7684\u8f93\u51fa\u57df\u5206\u4e3a\u4e24\u534a\uff0c\u9ad8\u516b\u4f4d\u548c\u4f4e\u516b\u4f4d\u662f\u76f8\u4e92\u72ec\u7acb\u7684\uff08\u8fd916\u4f4d\u90fd\u76f8\u4e92\u72ec\u7acb\uff09\u3002\u8fd9\u6837\uff0c\u6211\u4eec\u5c06\u9ad8\u516b\u4f4d\u4f5c\u4e3a\u65b0\u7684\u54c8\u5e0c\u51fd\u6570f1\u7684\u8f93\u51fa\u57df\uff0c\u4f4e\u516b\u4f4d\u4f5c\u4e3a\u65b0\u7684\u54c8\u5e0c\u51fd\u6570f2\u7684\u8f93\u51fa\u57df\uff0c\u5f97\u5230\u4e24\u4e2a\u65b0\u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u5b83\u4eec\u4e4b\u95f4\u76f8\u4e92\u72ec\u7acb\u3002\u6545\u6b64\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u7b97\u5f0f\u5f97\u52301000\u4e2a\u54c8\u5e0c\u51fd\u6570\uff1a</p> <pre><code>f1+1*f2=f3\nf1+2*f2=f4\nf1+3*f2=f5\n</code></pre>"},{"location":"code_guide/algs/cache.html","title":"\u7f13\u5b58\u7b97\u6cd5","text":""},{"location":"code_guide/algs/cache.html#window-tinylfu","title":"Window-TinyLFU","text":"<p>LFU\uff08Least Frequecy Use\uff09\u7684\u7f3a\u70b9\uff1a</p> <ul> <li>\u4e3a\u6bcf\u4e00\u4e2a\u7f13\u5b58\u9879\u7ef4\u62a4\u76f8\u5e94\u7684\u9891\u7387\u7edf\u8ba1\u4fe1\u606f\uff0c\u4e00\u5b9a\u7684\u5b58\u50a8\u548c\u6027\u80fd\u5f00\u9500\uff1b</li> <li>\u65e0\u6cd5\u5904\u7406\u7a00\u758f\u6d41\u91cf\uff08sparse burst\uff09\u7684\u573a\u666f\uff0c\u7a00\u758f\u6d41\u91cf\u7f13\u5b58\u9879\u9891\u7e41\u88ab\u6dd8\u6c70\u65e0\u6cd5\u547d\u4e2d\uff1b</li> </ul>"},{"location":"code_guide/algs/cache.html#count-min-sketch","title":"<code>Count-Min Sketch</code>\u9891\u7387\u7edf\u8ba1\u7b97\u6cd5","text":"<p>bloom\u7684\u53d8\u5f62\uff0c\u5bf9\u5143\u7d20\u8fdb\u884c\u8ba1\u6570\u3002</p> <ul> <li>\u56db\u4e2ahash\u51fd\u6570\uff0c\u5176hash\u503c\u5bf9\u5e94\u8ba1\u6570\u5668+1\uff0c\u4e14\u8ba1\u6570\u5668\u53ea\u67094bit\uff08\u6700\u592715\uff09</li> <li>\u56e0\u5b58\u5728positive false\u95ee\u9898\uff0c\u7f13\u5b58\u9879\u7684\u9891\u7387\u503c\u53d6\u56db\u4e2a\u8ba1\u6570\u5668\u7684\u6700\u5c0f\u503c</li> <li>\u5f53\u6240\u6709\u8ba1\u6570\u5668\u503c\u7684\u548c\u8d85\u8fc7\u8bbe\u5b9a\u7684\u9608\u503c\uff08\u9ed8\u8ba4\u662f\u7f13\u5b58\u9879\u6700\u5927\u6570\u91cf\u768410\u500d\uff09\u65f6\uff0c\u6240\u6709\u7684\u8ba1\u6570\u5668\u503c\u90fd\u51cf\u5230\u539f\u6765\u7684\u4e00\u534a\u3002</li> </ul> <p>\u4f4d\u7f6e\u8ba1\u7b97\u903b\u8f91\uff1a<code>long[] table</code>\u6570\u7ec4\uff0c\u5927\u5c0f\u4e3a\u7f13\u5b58\u7a7a\u95f4\u5bb9\u91cf\uff08\u7f13\u5b58\u9879\u6700\u5927\u6570\u91cf\uff09\u5411\u4e0a\u53d6\u6574\u4e3a2\u7684n\u6b21\u65b9</p> <ul> <li>\u4e00\u4e2a long \u5206\u4e3a 4 \u4e2a group\uff1b</li> <li>hash \u503c\u8ba1\u7b97\u6570\u7ec4\u4e0b\u6807\uff0c\u6839\u636e\u503c\u4f4e 2 bit \u786e\u5b9a group\uff0c\u7b2c X \u4e2a\u8ba1\u6570\u5668\u4f4d\u7f6e\u4e3a\u5bf9\u5e94 group \u7684\u7b2cX\u4e2a\u4f4d\u7f6e\uff1b</li> </ul> <p></p>"},{"location":"code_guide/algs/cache.html#w-tinylfu","title":"W-TinyLFU \u7b97\u6cd5","text":"<p>\u5c06\u7f13\u5b58\u5b58\u50a8\u7a7a\u95f4\u5206\u4e3a\u4e24\u4e2a\u5927\u7684\u533a\u57df\uff1a</p> <ul> <li>Window Cache\uff1a\u6807\u51c6\u7684 LRU cache\uff1b</li> <li>Main Cache\uff1aSLRU\uff08Segmemted LRU\uff09 cache\uff1b</li> <li>\u8fdb\u4e00\u6b65\u5212\u5206\u4e3a Protected Cache\uff08\u4fdd\u62a4\u533a\uff09\u548c Probation Cache\uff08\u89c2\u5bdf\u533a\uff09\u4e24\u4e2a\u533a\u57df</li> <li>Protected\uff1a\u7f13\u5b58\u9879\u4e0d\u4f1a\u88ab\u6dd8\u6c70</li> <li>Probation\uff1a\u6839\u636eLRU\u8fdb\u884c\u6dd8\u6c70</li> </ul> <p></p> <p>\u6d41\u7a0b\uff1a</p> <ul> <li>\u6709\u65b0\u7684\u7f13\u5b58\u9879\u5199\u5165\u7f13\u5b58\u65f6\uff0c\u4f1a\u5148\u5199\u5165Window Cache\u533a\u57df</li> <li>\u5f53Window Cache\u7a7a\u95f4\u6ee1\u65f6\uff0c\u6700\u65e7\u7684\u7f13\u5b58\u9879\u4f1a\u88ab\u79fb\u51faWindow Cache</li> <li>\u5982\u679cProbation Cache\u672a\u6ee1\uff0c\u4eceWindow Cache\u79fb\u51fa\u7684\u7f13\u5b58\u9879\u4f1a\u76f4\u63a5\u5199\u5165Probation Cache</li> <li>\u5982\u679cProbation Cache\u5df2\u6ee1\uff0c\u5219\u4f1a\u6839\u636eTinyLFU\u7b97\u6cd5\u786e\u5b9a\u4eceWindow Cache\u79fb\u51fa\u7684\u7f13\u5b58\u9879\u662f\u4e22\u5f03\uff08\u6dd8\u6c70\uff09\u8fd8\u662f\u5199\u5165Probation Cache</li> <li>Probation Cache\u4e2d\u7684\u7f13\u5b58\u9879\u5982\u679c\u8bbf\u95ee\u9891\u7387\u8fbe\u5230\u4e00\u5b9a\u6b21\u6570\uff0c\u4f1a\u63d0\u5347\u5230Protected Cache</li> <li>\u5982\u679cProtected Cache\u4e5f\u6ee1\u4e86\uff0c\u6700\u65e7\u7684\u7f13\u5b58\u9879\u4e5f\u4f1a\u79fb\u51faProtected Cache\uff0c\u7136\u540e\u6839\u636eTinyLFU\u7b97\u6cd5\u786e\u5b9a\u662f\u4e22\u5f03\uff08\u6dd8\u6c70\uff09\u8fd8\u662f\u5199\u5165Probation Cache\u3002</li> </ul> <p>TinyLFU\uff08\u53734bits\u8ba1\u6570\u5668\u7684Count-Min Sketch\uff09\u6dd8\u6c70\u673a\u5236\u4e3a\uff1a\u56fe\u4e2d\u7684Candidate\u548cVictim</p> <ul> <li>\u5982\u679cCandidate\u7f13\u5b58\u9879\u7684\u8bbf\u95ee\u9891\u7387\u5927\u4e8eVictim\u7f13\u5b58\u9879\u7684\u8bbf\u95ee\u9891\u7387\uff0c\u5219\u6dd8\u6c70\u6389Victim\uff1b</li> <li>\u5982\u679cCandidate\u5c0f\u4e8e\u6216\u7b49\u4e8eVictim\u7684\u9891\u7387\uff0c\u4e14\u5982\u679cCandidate\u7684\u9891\u7387\u5c0f\u4e8e5\uff0c\u5219\u6dd8\u6c70\u6389Candidate\uff1b</li> <li>\u5426\u5219\uff0c\u5219\u5728Candidate\u548cVictim\u4e24\u8005\u4e4b\u4e2d\u968f\u673a\u5730\u6dd8\u6c70\u4e00\u4e2a\uff1b</li> </ul> <p>\u7279\u6027</p> <ul> <li>\u6700\u8fd1\u521a\u4ea7\u751f\u7684\u7f13\u5b58\u9879\u8fdb\u5165Window\u533a\uff0c\u4e0d\u4f1a\u88ab\u6dd8\u6c70\uff1b</li> <li>\u8bbf\u95ee\u9891\u7387\u9ad8\u7684\u7f13\u5b58\u9879\u8fdb\u5165Protected\u533a\uff0c\u4e5f\u4e0d\u4f1a\u6dd8\u6c70\uff1b</li> </ul>"},{"location":"code_guide/algs/distributed_algs.html","title":"\u5206\u5e03\u5f0f\u7b97\u6cd5","text":""},{"location":"code_guide/algs/distributed_algs.html#_2","title":"\u805a\u7c7b\u7b97\u6cd5","text":""},{"location":"code_guide/algs/distributed_algs.html#_3","title":"\u8fd1\u90bb\u4f20\u64ad\u7b97\u6cd5","text":""},{"location":"code_guide/algs/distributed_snapshots.html","title":"\u5206\u5e03\u5f0f\u5feb\u7167 Chandy-Lamport \u7b97\u6cd5","text":""},{"location":"code_guide/algs/distributed_snapshots.html#1-overview","title":"1. Overview","text":"<p>A snapshot algorithm is used to create a consistent snapshot of the global state of a distributed system. Due to the lack of globally shared memory and a global clock, this isn't trivially possible.</p> <p>\u5206\u5e03\u5f0f\u5feb\u7167\u7b97\u6cd5\u7528\u6765\u5728\u7f3a\u4e4f\u7c7b\u4f3c\u5168\u5c40\u65f6\u949f\u6216\u8005\u5168\u5c40\u65f6\u949f\u4e0d\u53ef\u9760\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u6765\u786e\u5b9a\u4e00\u79cd\u5168\u5c40\u72b6\u6001\u3002</p> <p>\u5206\u5e03\u5f0f\u5feb\u7167\u7b97\u6cd5\u5e94\u7528\u5230\u6d41\u5f0f\u7cfb\u7edf\u4e2d\u5c31\u662f\u786e\u5b9a\u4e00\u4e2a Global \u7684 Snapshot\uff0c\u9519\u8bef\u5904\u7406\u7684\u65f6\u5019\u5404\u4e2a\u8282\u70b9\u6839\u636e\u4e0a\u4e00\u6b21\u7684 Global Snapshot \u6765\u6062\u590d\u3002</p>"},{"location":"code_guide/algs/distributed_snapshots.html#2-global-snapshot","title":"2. Global Snapshot","text":"<p>Global Snapshot\uff0c\u5373 Global State\uff08\u5168\u5c40\u72b6\u6001\uff09\uff0c\u5e38\u7528\u4e8e\u5728\u7cfb\u7edf\u505a Failure Recovery \u7684\u65f6\u5019\u3002</p> <p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u5168\u5c40\u72b6\u6001\u7684\u5b9a\u4e49\uff1a\u5148\u5c06\u5206\u5e03\u5f0f\u7cfb\u7edf\u7b80\u5316\u6210\u6709\u9650\u4e2a\u8fdb\u7a0b\u548c\u8fdb\u7a0b\u4e4b\u95f4\u7684 channel \u7ec4\u6210\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u6709\u5411\u56fe</p> <ul> <li>\u8282\u70b9\u662f\u8fdb\u7a0b\uff0c\u8fb9\u662f channel\uff08\u5206\u4e3a input channel \u548c output channel\uff09\uff1b</li> <li>\u4e00\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u5168\u5c40\u72b6\u6001\u5c31\u662f\u7531\u8fdb\u7a0b\u7684\u72b6\u6001\u548c channel \u4e2d\u7684 message \u7ec4\u6210\uff1b</li> </ul> <p>channel \u8868\u793a\u7684\u662f\u53d1\u9001\u6d88\u606f\u7684\u901a\u9053\uff08\u53ef\u4ee5\u7b49\u4ef7\u4e8eTCP\u8fde\u63a5\uff09\uff0c\u5e76\u4e0d\u662f\u53d1\u9001\u6d88\u606f\u548c\u63a5\u53d7\u54cd\u5e94\u6d88\u606f\u662f\u4e24\u4e2achannel\u3002</p>"},{"location":"code_guide/algs/distributed_snapshots.html#3-chandy-lamport","title":"3. Chandy-Lamport \u7b97\u6cd5","text":"<p>\u53ef\u4ee5\u5904\u7406\u73af\u5f62\u7684\u56fe\u3002</p> <p>\u7b97\u6cd5\u5047\u5b9a\uff1a</p> <ul> <li>Channel \u662f\u4e00\u4e2a\u5bb9\u91cf\u65e0\u9650\u5927\u7684 FIFO \u961f\u5217</li> <li>\u6536\u5230\u7684 message \u90fd\u662f\u6709\u5e8f\u4e14\u65e0\u91cd\u590d\u7684</li> </ul> <p>\u5c40\u90e8\u5feb\u7167\uff1a\u6bcf\u4e2a\u8fdb\u7a0b\u7684 local state \u548c\u5b83\u7684 input channel \u4e2d\u6709\u5e8f\u7684 message\u3002</p> <p>\u5168\u5c40\u5feb\u7167\uff1a\u6240\u6709\u7684\u8fdb\u7a0b\u7684\u5c40\u90e8\u5feb\u7167\u5408\u5e76\u8d77\u6765\u3002</p> <ul> <li>\u552f\u4e00\u7684\u95ee\u9898\u662f\u5982\u4f55\u786e\u5b9a\u540c\u4e00\u65f6\u523b\u7684\u5c40\u90e8\u5feb\u7167\uff1b</li> </ul> <p>\u7b97\u6cd5\u6d41\u7a0b\u5206\u4e3a\u4ee5\u4e0b\u4e09\u90e8\u5206\uff1a</p> <ul> <li>Initiating a snapshot: \u4e5f\u5c31\u662f\u5f00\u59cb\u521b\u5efa snapshot\uff0c\u53ef\u4ee5\u7531\u7cfb\u7edf\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u8fdb\u7a0b\u53d1\u8d77</li> <li>Propagating a snapshot: \u7cfb\u7edf\u4e2d\u5176\u4ed6\u8fdb\u7a0b\u5f00\u59cb\u9010\u4e2a\u521b\u5efa snapshot \u7684\u8fc7\u7a0b</li> <li>Terminating a snapshot: \u7b97\u6cd5\u7ed3\u675f\u6761\u4ef6</li> </ul>"},{"location":"code_guide/algs/distributed_snapshots.html#_1","title":"\u521d\u59cb\u5316\u5feb\u7167","text":"<p>\u8fdb\u7a0b \\(P_i\\) \u53d1\u8d77\uff1a\u8bb0\u5f55\u81ea\u5df1\u7684\u8fdb\u7a0b\u72b6\u6001\uff0c\u540c\u65f6\u751f\u4ea7\u4e00\u4e2a\u6807\u8bc6\u4fe1\u606f marker\uff0cmarker \u548c\u8fdb\u7a0b\u901a\u4fe1\u7684 message \u4e0d\u540c</p> <ul> <li>\u5c06 marker \u4fe1\u606f\u901a\u8fc7 ouput channel \u53d1\u9001\u7ed9\u7cfb\u7edf\u91cc\u9762\u7684\u5176\u4ed6\u8fdb\u7a0b</li> <li>\u5f00\u59cb\u8bb0\u5f55\u6240\u6709 input channel \u63a5\u6536\u5230\u7684 message</li> </ul>"},{"location":"code_guide/algs/distributed_snapshots.html#_2","title":"\u4f20\u64ad\u5feb\u7167","text":"<p>marker \u5f53\u4f5c\u4e00\u4e2a\u5206\u9694\u7b26\uff0c\u5206\u5272\u8fdb\u7a0b\u505a local snapshot\uff08\u8bb0\u5f55\u8fdb\u7a0b\u72b6\u6001\uff09\u7684message\uff1b</p> <p>\u8fdb\u7a0b \\(P_j\\)\uff1a\u4ece input channel \\(C_{kj}\\)\uff08\u6765\u81ea\u4e8e\u8fdb\u7a0b\\(P_k\\)\uff09\u63a5\u6536\u5230 marker \u4fe1\u606f</p> <ul> <li> <p>\u5982\u679c\uff0c\\(P_j\\)\u8fd8\u6ca1\u6709\u8bb0\u5f55\u81ea\u5df1\u7684\u8fdb\u7a0b\u72b6\u6001</p> </li> <li> <p>Pj \u8bb0\u5f55\u81ea\u5df1\u7684\u8fdb\u7a0b\u72b6\u6001\uff0c\u540c\u65f6\u5c06 input channel \\(C_{kj}\\) \u7f6e\u4e3a\u7a7a</p> </li> <li> <p>\u5411 output channel \u53d1\u9001 marker \u4fe1\u606f</p> </li> <li> <p>\u5426\u5219</p> </li> <li>\u66f4\u65b0 input channel \\(C_{kj}\\)\u7684\u72b6\u6001\u4e3a\uff1a\u4ece\\(P_j\\)\u8bb0\u5f55\u81ea\u5df1\u7684\u72b6\u6001\u540e\u6536\u5230\u7684\u7b2c\u4e00\u6761\u6d88\u606f\uff0c\u5230\u6536\u5230marker\u4e4b\u524d\u7684\u6700\u540e\u4e00\u6761 message</li> </ul>"},{"location":"code_guide/algs/distributed_snapshots.html#_3","title":"\u7ed3\u675f\u5feb\u7167","text":"<p>\u6240\u6709\u7684\u8fdb\u7a0b\u90fd\u6536\u5230 marker \u4fe1\u606f\u5e76\u4e14\u8bb0\u5f55\u4e0b\u81ea\u5df1\u7684\u72b6\u6001\u548c channel \u7684\u72b6\u6001\uff08\u5305\u542b\u7684 message\uff09\u3002</p> <ul> <li>\u6bcf\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u5c06\u72b6\u6001\u5b58\u50a8\u5728 DB/FS \u4e0a\u3002</li> </ul>"},{"location":"code_guide/algs/distributed_snapshots.html#_4","title":"\u7591\u95ee","text":"<ol> <li>\u6709\u5411\u56fe\uff0c\u5feb\u7167\u662f\u4ece\u54ea\u4e00\u4e2a\u8282\u70b9\u53d1\u8d77\uff1f</li> <li>\u65e0\u73af\u7684\u56fe\uff1a\u4ece\u6839\u8282\u70b9\u53d1\u9001\uff08DAG\u62d3\u6251\u5e8f\uff09\uff1b</li> <li>\u6709\u73af\u7684\u56fe\uff1a\u4efb\u610f\u4e00\u4e2a\u8282\u70b9\uff0c\u90fd\u53ef\u4ee5\u53d1\u8d77\uff0c\u56e0\u4e3a\u56fe\u662f\u8fde\u901a\u7684\uff1b</li> <li>\u5982\u679c\\(P_j\\)\u4ece\u591a\u4e2a\u94fe\u8def\u6536\u5230\u4e86\u540c\u6837\u7684marker\uff0c\u5e94\u8be5\u5982\u4f55\u5904\u7406\u81ea\u8eab\u7684\u72b6\u6001\uff1f</li> <li>\u6536\u5230\u7b2c\u4e00\u4e2amarker\u65f6\uff0c\u5c31\u8bb0\u5f55\u81ea\u8eab\u7684\u72b6\u6001\uff08\u4e14\u5c06\u63a5\u53d7\u5230\u7b2c\u4e00\u4e2amarker\u7684input channel-x\u7684channel snapshot\u8bb0\u4e3a\u7a7a)\uff1b</li> </ol>"},{"location":"code_guide/algs/distributed_snapshots.html#4","title":"4. \u793a\u4f8b","text":"<p>\u5047\u8bbe\u7cfb\u7edf\u4e2d\u5305\u542b\u4e24\u4e2a\u8fdb\u7a0b \\(P_1\\) \u548c \\(P_2\\)\uff0c\u521d\u59cb\u72b6\u6001\u5982\u4e0b\uff1a</p> <ul> <li>\\(P_1\\) \u8fdb\u7a0b\u72b6\u6001\u5305\u62ec\u4e09\u4e2a\u53d8\u91cf \\(X_1,Y_1,Z_1\\)\uff1b \\(P_2\\) \u8fdb\u7a0b\u5305\u62ec\u4e09\u4e2a\u53d8\u91cf \\(X_2,Y_2,Z_2\\)\uff1b</li> </ul> <p></p> <p>\u7531 \\(P_1\\) \u53d1\u8d77\u5168\u5c40 Snapshot \u8bb0\u5f55\uff0c\\(P_1\\) \u5148\u8bb0\u5f55\u672c\u8eab\u7684\u8fdb\u7a0b\u72b6\u6001\uff0c\u7136\u540e\u5411  \\(P_2\\) \u53d1\u9001 marker \u4fe1\u606f\u3002\u5728 marker \u4fe1\u606f\u5230\u8fbe  \\(P_2\\) \u4e4b\u524d\uff0c \\(P_2\\) \u5411 \\(P_1\\) \u53d1\u9001 message: M\u3002</p> <p></p> <p>\\(P_2\\) \u6536\u5230 \\(P_1\\) \u53d1\u9001\u8fc7\u6765\u7684 marker \u4fe1\u606f</p> <ul> <li>\u8bb0\u5f55\u81ea\u5df1\u7684\u72b6\u6001\u3002</li> </ul> <p>\\(P_1\\) \u6536\u5230  \\(P_2\\) \u4e4b\u524d\u53d1\u9001\u8fc7\u6765\u7684 message: M</p> <ul> <li>\u5bf9\u4e8e\\(P_1\\) \u6765\u8bf4\uff0c\u4ece  \\(P_2\\) channel \u53d1\u9001\u8fc7\u6765\u7684\u4fe1\u606f\u76f8\u5f53\u4e8e\u662f [M, marker]\uff0c\u7531\u4e8e  \\(P_1\\) \u5df2\u7ecf\u505a\u4e86 local snapshot\uff0c\u6240\u4ee5 \\(P_1\\) \u9700\u8981\u8bb0\u5f55 message M\u3002</li> </ul> <p></p> <p>\u90a3\u4e48\u5168\u5c40 Snapshot \u5c31\u76f8\u5f53\u4e8e\u4e0b\u56fe\u4e2d\u7684\u84dd\u8272\u90e8\u5206\u3002</p> <p></p>"},{"location":"code_guide/algs/distributed_snapshots.html#5","title":"5. \u53c2\u8003\u6587\u732e","text":"<ol> <li>Distributed Snapshots: Determining Global States of a Distributed System, https://lamport.azurewebsites.net/pubs/chandy.pdf</li> <li>\u5206\u5e03\u5f0f\u5feb\u7167\u7b97\u6cd5 Chandy-Lamport\uff1ahttps://github.com/legendtkl/paper_reading/blob/main/realtime-compute/Chandy-Lamport.md</li> </ol>"},{"location":"code_guide/algs/graph.html","title":"\u56fe\u7b97\u6cd5","text":""},{"location":"code_guide/algs/graph.html#_2","title":"\u56fe\u904d\u5386","text":""},{"location":"code_guide/algs/graph.html#_3","title":"\u62d3\u6251\u5e8f\u4e0e\u5173\u952e\u8def\u5f84","text":""},{"location":"code_guide/algs/graph.html#_4","title":"\u6b27\u62c9(\u56de)\u8def","text":""},{"location":"code_guide/algs/graph.html#_5","title":"\u6700\u5c0f\u751f\u6210\u6811","text":""},{"location":"code_guide/algs/hash.html","title":"\u6563\u5217(Hash)\u7b97\u6cd5","text":"<p>\u4ee3\u7801\u5b9e\u73b0\u89c1\uff1aDataStructureAndAlgorithm: \u6570\u636e\u7ed3\u6784\u4e0e\u7b97\u6cd5\uff08Java\u8bed\u8a00\uff09</p>"},{"location":"code_guide/algs/hash.html#hash_1","title":"Hash\u51fd\u6570","text":"<p>\u54c8\u5e0c\uff08Hash\uff09\u7b97\u6cd5\uff0c\u5373\u6563\u5217\u51fd\u6570\u3002\u4e00\u79cd\u5355\u5411\u5bc6\u7801\u4f53\u5236\uff0c\u5373\u5b83\u662f\u4e00\u4e2a\u4ece\u660e\u6587\u5230\u5bc6\u6587\u7684\u4e0d\u53ef\u9006\u7684\u6620\u5c04\uff0c\u53ea\u6709\u52a0\u5bc6\u8fc7\u7a0b\uff0c\u6ca1\u6709\u89e3\u5bc6\u8fc7\u7a0b\u3002</p> <p>\u5e38\u89c1\u7684Hash\u51fd\u6570(<code>int hash(bytes[])</code>\uff09\uff1a\u6e90\u7801\u89c1</p> <ul> <li> <p>Java Hash\uff1ac = c * 31 + b[i]\uff1b</p> </li> <li> <p>Crc32 Hash\uff1a\u5faa\u73af\u5197\u4f59\u6821\u9a8c\u7801\u7684\u7ed3\u679c\u505aHash\uff1b</p> </li> <li>Ketama Hash\uff1a\u57fa\u4e8e MD5 \u6458\u8981\uff0c\u53d6\u6700\u540e4\u5b57\u8282\uff1b</li> <li>MurMur Hash\uff1a\u975e\u52a0\u5bc6HASH\u7b97\u6cd5\uff0c\u6027\u80fd\u5f88\u9ad8</li> <li> <p>\u57fa\u672c\u601d\u60f3\u5c31\u662f\u628akey\u5206\u6210n\u7ec4\uff0c\u6bcf\u7ec44\u4e2a\u5b57\u7b26\uff0c\u628a\u8fd94\u4e2a\u5b57\u7b26\u770b\u6210\u662f\u4e00\u4e2auint_32\uff0c\u8fdb\u884cn\u6b21\u8fd0\u7b97\uff0c\u5f97\u5230\u4e00\u4e2ah\uff0c\u7136\u4f1a\u5728\u5bf9h\u8fdb\u884c\u5904\u7406\uff0c\u5f97\u5230\u4e00\u4e2a\u76f8\u5bf9\u79bb\u6563\u7684hash code;</p> </li> <li> <p>fnv1/fnv1A Hash\uff1a\u9ad8\u6548\u6027\u548c\u4f4e\u51b2\u7a81\u7387\uff0c\u9002\u7528\u4e8e\u54c8\u5e0c\u4e00\u4e9b\u76f8\u8fd1\u7684\u5b57\u7b26\u4e32\uff0c\u5982IP\u5730\u5740\u3001URL\u548c\u6587\u4ef6\u540d\u7b49</p> </li> </ul>"},{"location":"code_guide/algs/hash.html#hash_2","title":"\u5206\u5e03\u5f0fHash","text":"<p>\u5206\u5e03\u5f0fHash\u4e00\u822c\u7528\u4f5c\u5206\u5e03\u5f0f\u7684\u7f13\u5b58\u670d\u52a1\uff0c\u6bd4\u5982Redis\u548cMemcache\u3002</p> <p>\u5224\u5b9a\u54c8\u5e0c\u7b97\u6cd5\u597d\u574f\u7684\u56db\u4e2a\u5b9a\u4e49\uff1a</p> <ul> <li> <p>\u5e73\u8861\u6027\uff08Balance\uff09\uff1a\u54c8\u5e0c\u7684\u7ed3\u679c\u80fd\u591f\u5c3d\u53ef\u80fd\u5206\u5e03\u5230\u6240\u6709\u7684\u7f13\u51b2\u4e2d\u53bb\uff0c\u5927\u90e8\u5206Hash\u7b97\u6cd5\u90fd\u6ee1\u8db3\uff1b</p> </li> <li> <p>\u5355\u8c03\u6027\uff08Monotonicity\uff09\uff1a\u5f53\u7f13\u51b2\u589e\u52a0\u65f6\uff0c\u4fdd\u8bc1\u539f\u6709\u5df2\u5206\u914d\u7684\u5185\u5bb9\u53ef\u4ee5\u88ab\u6620\u5c04\u5230\u539f\u6709\u7684\u6216\u8005\u65b0\u7684\u7f13\u51b2\u4e2d\u53bb\uff0c\u800c\u4e0d\u4f1a\u88ab\u6620\u5c04\u5230\u65e7\u7684\u7f13\u51b2\u96c6\u5408\u4e2d\u7684\u5176\u4ed6\u7f13\u51b2\u533a\uff1b</p> </li> <li>\u5206\u6563\u6027\uff08Spread\uff09\uff1a\u76f8\u540c\u7684\u5185\u5bb9\u88ab\u4e0d\u540c\u7684\u7ec8\u7aef\u6620\u5c04\u5230\u4e0d\u540c\u7684\u7f13\u51b2\u533a\u4e2d\uff0c\u5206\u6563\u6027\u7684\u5b9a\u4e49\u5c31\u662f\u4e0a\u8ff0\u60c5\u51b5\u53d1\u751f\u7684\u4e25\u91cd\u7a0b\u5ea6\uff1b\u5e94\u8be5\u907f\u514d\u5206\u6563\u6027\uff1b</li> <li>\u8d1f\u8f7d\uff08Load\uff09\uff1a\u7279\u5b9a\u7684\u7f13\u51b2\u533a\u800c\u8a00\uff0c\u4e5f\u53ef\u80fd\u88ab\u4e0d\u540c\u7684\u7528\u6237\u6620\u5c04\u4e3a\u4e0d\u540c\u7684\u5185\u5bb9\uff0c\u5e94\u8be5\u5c3d\u91cf\u964d\u4f4e\u7f13\u51b2\u7684\u8d1f\u8377\uff1b</li> </ul>"},{"location":"code_guide/algs/hash.html#_1","title":"\u7b80\u5355\u54c8\u5e0c\u7b97\u6cd5","text":"<p>\u5047\u8bbe\u6709\u4e09\u53f0\u673a\uff0c\u6570\u636e\u843d\u5728\u54ea\u53f0\u673a\u7684\u7b97\u6cd5\u4e3a</p> <pre><code>  c = Hash(key) % 3\n</code></pre> <p>\u4f8b\u5982key A\u7684\u54c8\u5e0c\u503c\u4e3a4\uff0c4%3=1\uff0c\u5219\u843d\u5728\u7b2c\u4e8c\u53f0\u673a\u3002Key ABC\u54c8\u5e0c\u503c\u4e3a11\uff0c11%3=2\uff0c\u5219\u843d\u5728\u7b2c\u4e09\u53f0\u673a\u4e0a\u3002</p> <p>\u5229\u7528\u8fd9\u6837\u7684\u7b97\u6cd5\uff0c\u5047\u8bbe\u73b0\u5728\u6570\u636e\u91cf\u592a\u5927\u4e86\uff0c\u9700\u8981\u589e\u52a0\u4e00\u53f0\u673a\u5668\u3002A\u539f\u672c\u843d\u5728\u7b2c\u4e8c\u53f0\u4e0a\uff0c\u73b0\u5728\u6839\u636e\u7b97\u6cd54%4=0\uff0c\u843d\u5230\u4e86\u7b2c\u4e00\u53f0\u673a\u5668\u4e0a\u4e86\uff0c\u4f46\u662f\u7b2c\u4e00\u53f0\u673a\u5668\u4e0a\u6839\u672c\u6ca1\u6709A\u7684\u503c\u3002\u8fd9\u6837\u7684\u7b97\u6cd5\u4f1a\u5bfc\u81f4\u589e\u52a0\u673a\u5668\u6216\u51cf\u5c11\u673a\u5668\u7684\u65f6\u5019\uff0c\u5f15\u8d77\u5927\u91cf\u7684\u7f13\u5b58\u7a7f\u900f\uff0c\u9020\u6210\u96ea\u5d29\u3002</p>"},{"location":"code_guide/algs/hash.html#hash_3","title":"\u4e00\u81f4\u6027Hash\u7b97\u6cd5","text":"<p>\u8bba\u6587\uff1a Consistent hashing and random trees:Distributed Caching Protocols for Relieving Hot Spots on the World Wide Web </p> <p>\u7b97\u6cd5\u6d41\u7a0b\uff1a</p> <ul> <li>\u73af\u5f62Hash\u7a7a\u95f4\uff1a\u5c06value\u6620\u5c04\u6210 0 ~ 2^32 - 1\u7684\u73af\u5f62\u7a7a\u95f4\uff0c\u5c06\u5bf9\u8c61object\u548ccache\u90fd\u6620\u5c04\u5230\u540c\u4e00\u4e2aHash\u7a7a\u95f4\u4e2d\uff0c\u4f7f\u7528\u540c\u6837\u7684Hash\u7b97\u6cd5\uff1b</li> <li>object -&gt; cache\uff1a\u4eceobject\u7684hash\u503c\u987a\u65f6\u9488\u51fa\u53d1\uff0c\u5339\u914d\u5230\u6700\u8fd1\u7684cache\u7684hash\u503c\u3002</li> </ul> <p></p> <p>\u89e3\u51b3\u5355\u8c03\u6027\uff1a</p> <ul> <li>\u79fb\u9664/\u6dfb\u52a0\u8282\u70b9Cache B\u65f6\uff0c\u53d7\u5f71\u54cd\u7684\u5c06\u4ec5\u662f\u90a3\u4e9b\u6cbf cache B \u9006\u65f6\u9488\u904d\u5386\u76f4\u5230\u4e0b\u4e00\u4e2a cache A\u4e4b\u95f4\u7684\u5bf9\u8c61\uff0c\u5373\u662f\u672c\u6765\u6620\u5c04\u5230 cache B \u4e0a\u7684\u90a3\u4e9b\u5bf9\u8c61\uff1b</li> </ul> <p>\u6ee1\u8db3\u8d1f\u8f7d\u5747\u8861\uff0c\u89e3\u51b3\u5e73\u8861\u6027\uff1a</p> <ul> <li>\u89e3\u51b3cache\u6570\u8fc7\u5c11\u5bfc\u81f4\u5206\u5e03\u4e0d\u5e73\u8861\u7684\u95ee\u9898\u3002\u201c\u865a\u62df\u8282\u70b9\u201d\uff08virtual node\uff09\u662f\u5b9e\u9645\u8282\u70b9\u5728 hash \u7a7a\u95f4\u7684\u590d\u5236\u54c1\uff08replica\uff09\uff0c\u4e00\u4e2a\u5b9e\u9645\u4e2a\u8282\u70b9\u5bf9\u5e94\u4e86\u82e5\u5e72\u4e2a\u201c\u865a\u62df\u8282\u70b9\u201d\uff0c\u8fd9\u4e2a\u5bf9\u5e94\u4e2a\u6570\u4e5f\u6210\u4e3a\u201c\u590d\u5236\u4e2a\u6570\u201d\uff0c\u201c\u865a\u62df\u8282\u70b9\u201d\u5728 hash \u7a7a\u95f4\u4e2d\u4ee5 hash \u503c\u6392\u5217\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li> <p>\u65e0\u6cd5\u63a7\u5236\u8282\u70b9\u5b58\u50a8\u6570\u636e\u7684\u5206\u914d\uff0c\u9700\u8981\u5b9e\u9645\u8bc4\u4f30\u6bcf\u4e2a\u8282\u70b9\u5206\u914d\u7684hash\u7a7a\u95f4\u8303\u56f4\u662f\u5426\u5747\u5300\uff1b</p> </li> <li> <p>\u5bf9 Hash \u7b97\u6cd5\u6709\u8981\u6c42\uff0c\u5bf9\u8fd1\u4f3c\u7684 key \u5176Hash\u7684\u7ed3\u679c\u5e94\u8be5\u5747\u5300\u5206\u5e03\u5728\u4e0d\u540c\u7a7a\u95f4\uff1a</p> </li> <li>\u6bd4\u5982\u5bf9 \u5c40\u57df\u7f51\u7684IP \u8fdb\u884c Hash\uff0c\u5219  Java String <code>hashcode</code>\u51fa\u6765\u7684\u503c\u4f1a\u5206\u5e03\u5728\u4e00\u4e2a\u7a7a\u95f4\uff1b</li> </ul>"},{"location":"code_guide/algs/hash.html#hash_4","title":"Hash\u69fd","text":"<p>Redis Cluster\u91c7\u7528\u7684\u65b9\u6848\uff0cRedis Cluster\u7684hash\u7b97\u6cd5\u662fcrc16\u7b97\u6cd5\uff0c\u4e00\u79cd\u6821\u9a8c\u7b97\u6cd5\u3002</p> <p>Redis Cluster\u5305\u542b\u4e8616384\u4e2a\u54c8\u5e0c\u69fd\uff0c\u6bcf\u4e2aKey\u901a\u8fc7\u8ba1\u7b97\u540e\u90fd\u4f1a\u843d\u5728\u5177\u4f53\u4e00\u4e2a\u69fd\u4f4d\uff0c\u54ea\u4e2a\u8282\u70b9\u8d1f\u8d23\u54ea\u4e9b\u69fd\u4f4d\uff0c\u53ef\u4ee5\u81ea\u884c\u6307\u5b9a\u6216\u8005\u81ea\u52a8\u751f\u6210\u3002</p> <p>\u6570\u636e\u7ed3\u6784</p> <ul> <li>\u6bcf\u4e2a\u8282\u70b9\u901a\u8fc716384/8\u4e2abyte\u4fdd\u5b58\u5176\u8d1f\u8d23\u7684\u69fd\u4f4d\uff08\u5bf9\u5e94bit\u4e3a1\uff09\uff1b</li> <li>\u8282\u70b9\u540c\u65f6\u7ef4\u62a416384\u957f\u5ea6\u7684\u6570\u7ec4\u8868\u793a\u69fd\u4f4d\u5230\u96c6\u7fa4\u8282\u70b9\u7684\u6620\u5c04\u3002</li> </ul>"},{"location":"code_guide/algs/load_balance.html","title":"\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5","text":"<p>\u5904\u7406\u8d1f\u8f7d\u5747\u8861\u7684\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <p>\u9759\u6001\u5904\u7406\uff1aConsistent hash\uff0c\u5f15\u5165virtual nodes\u5b9e\u73b0\u73af\u72b6 hash \u7a7a\u95f4\u7684\u5747\u5300\u6563\u5217\uff1b</p> <p>\u52a8\u6001\u5904\u7406\uff1aRandom\u3001Round-robin\u3001Least connection\u3001Two random choices</p>"},{"location":"code_guide/algs/load_balance.html#the-power-of-two-random-choices","title":"The Power of Two Random Choices","text":"<p>Mitzenmacher M. The power of two choices in randomized load balancing[J]. IEEE Transactions on Parallel and Distributed Systems, 2001, 12(10): 1094-1104.</p> <p>\u7b97\u6cd5\u6d41\u7a0b\u662f\uff1a</p> <ol> <li>\u4ece\u53ef\u7528\u8282\u70b9\u5217\u8868\u4e2d\u505a\u4e24\u6b21\u968f\u673a\u9009\u62e9\u64cd\u4f5c\uff0c\u5f97\u5230\u8282\u70b9 A\u3001B</li> <li>\u6bd4\u8f83 A\u3001B \u4e24\u4e2a\u8282\u70b9\uff0c\u9009\u51fa\u8d1f\u8f7d\u6700\u4f4e\uff08\u4e00\u822c\u662f\u6b63\u5728\u5904\u7406\u7684\u8fde\u63a5\u6570/\u8bf7\u6c42\u6570\u6700\u5c11\uff09\u7684\u8282\u70b9\u4f5c\u4e3a\u88ab\u9009\u4e2d\u7684\u8282\u70b9</li> </ol> <p>Balls into Bins\u95ee\u9898\uff1aN\u4e2a\u7403\u5206\u914d\u5230N\u4e2a\u6876</p> <p>\u95ee\u98981\uff1a \u6bcf\u6b21\u968f\u673a\u72ec\u7acb\u9009\u62e9\u4e00\u4e2a\u6876\uff0c\u6700\u540e\uff0c\u6876\u91cc\u7684\u7403\u7684\u6700\u5927\u4e2a\u6570\uff1f</p> <p>\u7b54\u6848\uff1a<code>1-\uff4f(1)</code> \u7684\u6982\u7387\uff0c\u6700\u5927\u4e2a\u6570\u662f<code>(1+\uff4f(1))log(n)/log(log(n))</code>\uff0c<code>o(1)</code>\u6307\u7684\u662f\u9ad8\u9636\u65e0\u7a77\u5c0f\u3002</p> <p>\u95ee\u98982\uff1a \u6bcf\u6b21\u968f\u673aD\u6b21\u6311\u51faD\u4e2a\u6876\uff0c\u5e76\u4ece\u4e2d\u9009\u62e9\u7403\u4e2a\u6570\u5c11\u7684\u6876\u5462\uff1f</p> <p>\u7b54\u6848\uff1a<code>1-\uff4f(1)</code> \u7684\u6982\u7387\uff0c\u6700\u5927\u4e2a\u6570\u662f<code>(1+\uff4f(1))log(log(n))/log(d)+\uff2f(1)</code>\uff0c<code>o(1)</code>\u6307\u7684\u662f\u9ad8\u9636\u65e0\u7a77\u5c0f\u3002</p> <p>\u95ee\u98983\uff1am\u4e2a\u7403\uff0cn\u4e2a\u6876\uff0c\u6bcf\u6b21\u968f\u673a\u72ec\u7acb\u9009\u62e9d\u4e2a\u6876\uff0c\u9009\u62e9\u6700\u5c11\u7684\u6876\u653e\u5165\uff0c\u5176\u4e2d <code>m&gt;=n,d&gt;=2</code></p> <ul> <li>n \u4e2a\u6876\u4e2d\u6700\u5927\u8d1f\u8f7d\u4e3a\\(\\frac{log(log(n))}{log(d)}+\\frac{m}{n}+\\theta(1)\\)</li> </ul>"},{"location":"code_guide/algs/load_balance.html#small-cache-big-effect","title":"Small Cache, Big Effect","text":"<p>Fan B, Lim H, Andersen D G, et al. Small cache, big effect: Provable load balancing for randomly partitioned cluster services[C]//Proceedings of the 2nd ACM Symposium on Cloud Computing. ACM, 2011: 23.</p> <p>\u5728 load balancer \u4e2d\u96c6\u6210\u4e00\u5c42\u7a7a\u95f4\u590d\u6742\u5ea6\u4e0b\u754c\u4e3a O(nlogn) \u7684cache\uff08n\u4e3a\u540e\u7aef\u8282\u70b9\u6570\uff09\u6765\u7f13\u5b58\u70ed\u70b9\u6570\u636e\uff0c\u5373\u53ef\u5728\u663e\u8457\u63d0\u5347load balancer\u541e\u5410\u91cf\u7684\u540c\u65f6\uff0c\u4fdd\u8bc1\u5230\u8fbe\u540e\u7aef\u8282\u70b9\u7684\u8bf7\u6c42\u8d1f\u8f7d\u662f\u5747\u5300\u5206\u5e03\u7684\u3002</p> <ul> <li>\u9700\u8981\u7f13\u5b58\u7684\u70ed\u70b9\u6570\u636e\u91cf\u53ea\u4e0e\u5b58\u50a8\u8282\u70b9\u6570\u76een\u6709\u5173\uff0c\u4e0e\u5b58\u50a8\u7684\u6570\u636e\u91cf\u65e0\u5173</li> </ul>"},{"location":"code_guide/algs/load_balance.html#distcache-provable-load-balancing-for-large-scale-storage-systems-with-distributed-caching","title":"Distcache: Provable load balancing for large-scale storage systems with distributed caching","text":"<p>\u4e00\u4e2a\u96c6\u7fa4\u4e00\u4e2aCache\u8282\u70b9\u53ea\u80fd\u4fdd\u8bc1\u96c6\u7fa4\u5185\u7684\u8d1f\u8f7d\u5747\u8861\uff0c\u800c\u96c6\u7fa4\u95f4\u7684\u8d1f\u8f7d\u5747\u8861\u65e0\u6cd5\u4fdd\u8bc1\u3002</p> <p>\u96c6\u7fa4\u95f4\u9700\u8981\u4e00\u5c42\u5206\u5e03\u5f0f\u7684Cache\u3002</p> <ul> <li>\u901a\u8fc7\u4e24\u5c42hash\u6765partition Cache\u4e2d\u7684\u6570\u636e\uff0c\u4fdd\u8bc1\u5176\u4e00\u5c42\u4e2d\u6709\u70ed\u70b9\u7684\u8282\u70b9\u4f1a\u88ab\u6563\u5217\u5230\u53e6\u5916\u4e00\u5c42\u3002\u7136\u540e\u901a\u8fc7power-of-two-choices\u6765\u9009\u62e9\u8d1f\u8f7d\u8f83\u4f4e\u7684\u8282\u70b9\u8bbf\u95ee\u3002</li> <li>\u4fdd\u8bc1\u8981\u7ef4\u62a4\u7684\u4e00\u81f4\u6027\u5f00\u9500\u6700\u5c0f\u5316\uff0c\u540c\u65f6\u8bba\u6587\u7406\u8bba\u8bc1\u660e\u4e86\u8fd9\u4e2a\u505a\u6cd5\u662f\u4e0d\u4f1a\u5bfc\u81f4\u4efb\u4f55\u4e00\u4e2aCache\u5f15\u70ed\u70b9\u6570\u636e\u8fc7\u8f7d\u3002</li> </ul>"},{"location":"code_guide/algs/math.html","title":"\u6570\u5b66","text":""},{"location":"code_guide/algs/math.html#_2","title":"\u56db\u5e73\u65b9\u548c\u4e09\u5e73\u65b9\u5b9a\u7406","text":"<ul> <li>\u56db\u5e73\u65b9\u5b9a\u7406\uff1a\u4efb\u610f\u81ea\u7136\u6570\u90fd\u53ef\u4ee5\u8868\u793a\u6210\u56db\u4e2a\u6574\u578b\u7684\u5e73\u65b9\u548c\uff1b</li> <li>\u4e09\u5e73\u65b9\u5b9a\u7406\uff1a\u5f62\u5f0f\u4e0d\u4e3a<code>4^n * ( 8 * k + 7)</code>\u7684\u81ea\u7136\u6570\u53ef\u4ee5\u8868\u793a\u6210\u4e09\u4e2a\u6574\u578b\u7684\u5e73\u65b9\u548c\uff1b</li> </ul>"},{"location":"code_guide/algs/math.html#fisher-yates-shuffle","title":"\u6d17\u724c\u7b97\u6cd5\uff08Fisher-Yates shuffle\uff09","text":"<p>\u6982\u7387\u5747\u7b49</p> <p>\u9009\u51fa\u7b2c\u4e00\u5f20\u548c\u4efb\u610f\u4e00\u4e2a1\u5230n\u7684\u724c\u6362\uff1b\u9009\u51fa\u7b2c\u4e8c\u5f20\u548c\u4efb\u610f2-n\u7684\u724c\u6362\uff1b\u4f9d\u6b21\u76f4\u5230n-1\u9009\u51fan-1\u5230n\u7684\u724c\u6362\uff1b\u5171n-1\u6b21\u4ea4\u6362\uff1b</p> <pre><code>// To shuffle an array a of n elements (indices 0..n-1):\nfor i from n\u22121 downto 1 do\n     j \u2190 random integer such that 0 \u2264 j \u2264 i\n     exchange a[j] and a[i]\n\n// To shuffle an array a of n elements (indices 0..n-1):\nfor i from 0 to n\u22122 do\n     j \u2190 random integer such that i \u2264 j \u2264 n-1\n     exchange a[i] and a[j]\n</code></pre>"},{"location":"code_guide/algs/math.html#_3","title":"\u5b8c\u7f8e\u6d17\u724c\u7b97\u6cd5","text":"<p>\u53c2\u8003\u6587\u732e\uff1aA Simple In-Place Algorithm for In-Shuffle</p> <p>\u6709\u4e2a\u957f\u5ea6\u4e3a2n\u7684\u6570\u7ec4<code>{a1,a2,a3,\u2026,an,b1,b2,b3,\u2026,bn}</code>\uff0c\u5e0c\u671b\u6392\u5e8f\u540e<code>{b1, a1, b2, a2,\u2026., bn, an}</code>\uff0c\u65f6\u95f4\u590d\u6742\u5ea6<code>O(n)</code>\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6<code>O(1)</code>\u7684\u89e3\u6cd5\u3002</p> <p>\u4ee5 n = 4 \u4e3a\u4f8b\uff0c\u770b\u5230\u4e0b\u6807\u7684\u53d8\u5316\uff1a\u539f\u4e0b\u6807 i =&gt; \u65b0\u4e0b\u6807 ( 2 * i ) % ( 2 * n + 1)</p> \u5e8f\u53f7 1 2 3 4 5 6 7 8 \u539f\u6570\u7ec4 a1 a2 a3 a4 b1 b2 b3 b4 \u6392\u5e8f\u540e\u6570\u7ec4 b1 a1 b2 a2 b3 a3 b4 a4 <p>\u53ef\u4ee5\u770b\u51fa\u4e24\u4e2a\u5faa\u73af\uff0c\u6bcf\u4e2a\u5faa\u73af\u53ef\u4ee5O(1)\u65f6\u95f4\u66ff\u6362\uff1b</p> <ul> <li>1 -&gt; 2 -&gt; 4 -&gt; 8 -&gt; 7 -&gt; 5 -&gt; 1</li> <li>3 -&gt; 6 -&gt; 3</li> </ul> <p>\u5982\u4f55\u5bfb\u627e\u6bcf\u4e2a\u5faa\u73af\u7684\u5f00\u59cb\uff1a</p> <ul> <li> <p>\u5bf9\u4e8e 2 * n =\uff083^k-1\uff09\u8fd9\u79cd\u957f\u5ea6\u7684\u6570\u7ec4\uff0c\u6070\u597d\u53ea\u6709k\u4e2a\u73af\uff0c\u4e14\u6bcf\u4e2a\u73af\u7684\u8d77\u59cb\u4f4d\u7f6e\u5206\u522b\u662f 1, 3, 9\uff0c\u20263^(k-1) \u3002 </p> </li> <li> <p>\u5982\u679c 2 * n \u4e0d\u662f 3^k-1 \u7684\u500d\u6570\uff0c\u603b\u53ef\u4ee5\u627e\u5230\u6700\u5927\u7684\u6574\u6570m\uff0c\u4f7f\u5f97m&lt; n\uff0c\u5e76\u4e142 * m=\uff083^k-1\uff09\uff1b</p> </li> <li> <p>\u524d2m\u4e2a\u5143\u7d20\uff1a\u5c06m \u5230m+n\u7684\u6570\u7ec4\u5faa\u73af\u5de6\u79fbn-m\u6b21\uff08\u901a\u8fc7\u4e09\u6b21\u6570\u7ec4\u53cd\u8f6c\u5b9e\u73b0\uff09\uff1b</p> <ul> <li>\u524d2m\u4e2a\u5143\u7d20\u9700\u8981\u5206\u522b\u4e3a<code>a1,a2...am,b1,b2...bm</code></li> </ul> </li> </ul> <p></p> <ul> <li>2 * (n-m) \u7684\u89c4\u6a21\u53ef\u4ee5\u901a\u8fc7\u5faa\u73af\u66ff\u4ee3\u5f97\u5230\uff0cn = n -  m\uff0c \u7ee7\u7eed\u5904\u7406\uff0c\u81f3 n &lt;1</li> </ul>"},{"location":"code_guide/algs/sort.html","title":"\u6392\u5e8f\u7b97\u6cd5","text":""},{"location":"code_guide/algs/sort.html#_2","title":"\u57fa\u4e8e\u6bd4\u8f83\u7684\u6392\u5e8f\u7b97\u6cd5","text":"<p>\u65f6\u95f4\u590d\u6742\u5ea6\u57fa\u4e8e\u6bd4\u8f83\u6b21\u6570\uff0c\u57fa\u4e8e\u6bd4\u8f83\u7684\u6392\u5e8f\u7b97\u6cd5\u6700\u597d\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a<code>O(nlog(n))</code>\uff1a</p> <ul> <li><code>stable</code>\uff1a\u4fdd\u7559\u7b49\u503c\u5143\u7d20\u5728\u8f93\u5165\u4e2d\u7684\u76f8\u5bf9\u987a\u5e8f</li> <li><code>in-place</code>\uff1a\u4e0d\u989d\u5916\u6d88\u8017\u5185\u5b58\uff08\u7a7a\u95f4\uff09\uff1b</li> </ul> \u5178\u578b\u5b9e\u73b0 \u65f6\u95f4\u590d\u6742\u5ea6 best, worst, average \u7a7a\u95f4\u590d\u6742\u5ea6 \u7a33\u5b9a\u6027 \u7279\u70b9 \u9009\u62e9\u6392\u5e8f \\(O(n2), O(n^2), O(n^2)\\) O(1) Not Stable in-place sort\uff0c\u6700\u591an-1\u6b21\u4ea4\u6362 \u63d2\u5165\u6392\u5e8f \\(O(n), O(n^2), O(n^2)\\) O(1) Stable in-place sort\uff0c\u9002\u7528small data \u5feb\u901f\u6392\u5e8f \\(O(nlog(n)), O(n^2),  O(nlog(n))\\) O(1) Not Stable in-place sort \u5f52\u5e76\u6392\u5e8f \\(O(nlog(n))\\) O(n) Stable Not in-place sort \u5f52\u5e76\u6392\u5e8f \\(O(nlog(n))\\) O(1) Stable in-place sort \u5806\u6392\u5e8f \\(O(nlog(n))\\) O(1) Not Stable in-place sort \u5192\u6ce1\u6392\u5e8f \\(O(n),O(n^2),O(n^2)\\) O(1) Stable in-place sort <p>\u5feb\u901f\u6392\u5e8fA[a, b]</p> <ul> <li> <p>\u968f\u673a\u9009\u62e9\u521d\u59cb\u7684\u6bd4\u8f83\u503c\uff1b</p> </li> <li> <p>\u5355\u4e2a\u6307\u9488\uff0c[a, low]\u548c[low, b]\uff1b\uff08\u65e0\u6cd5\u5904\u7406\u5143\u7d20\u4e0d\u968f\u673a\u60c5\u51b5\uff0c\u5982\u5143\u7d20\u5168\u90e8\u76f8\u7b49O(n2\uff09</p> </li> <li> <p>\u53cc\u5411\u6307\u9488\uff0c[a, low]\u548c[high, b]\uff1b\uff08\u5f53\u9047\u5230\u76f8\u540c\u7684\u5143\u7d20\u65f6\u505c\u6b62\u626b\u63cf\u89e3\u51b3\u5143\u7d20\u5168\u90e8\u76f8\u7b49O(nlog(n))\uff09</p> </li> </ul> <pre><code>void qsort(x, a, b) {\n    if (a &gt;= b) return\n    t = x[a];i = a; j = b;\n    while (true) {   \n        do i++ whi1e(i &lt;= b &amp;&amp; x[il &lt; t);    \n        do j-- whi1e(x[j] &gt; t);\n        if (i &gt; j) break;\n        swap(x[i], x[j]);\n    }\n    swap(x[a], x[j]);\n    qsort(x, a, j-l);\n    qsort(x, j+1, b);  \n}     \n</code></pre>"},{"location":"code_guide/algs/sort.html#_3","title":"\u975e\u6bd4\u8f83\u6392\u5e8f\u7b97\u6cd5","text":""},{"location":"code_guide/algs/sort.html#_4","title":"\u6876\u6392\u5e8f","text":"<p>\u7a33\u5b9a\uff0c\u5206\u6210m\u4e2a\u6876</p>"},{"location":"code_guide/algs/sort.html#_5","title":"\u8ba1\u6570\u6392\u5e8f","text":"<p>\u7a33\u5b9a\uff0c\u4fdd\u5b58[max-min]\u7684\u6570\u7ec4\u4e2a\u6570\uff0c\u7d2f\u52a0\uff0c\u5012\u5e8f\uff1b </p> <ul> <li>n \u4e2a 0 \u5230 k \u4e4b\u95f4\u7684\u6574\u6570\u65f6\uff0c\u8fd0\u884c\u65f6\u95f4\u662f \u0398(n + k)\uff1b\u7a7a\u95f4\u590d\u6742\u5ea6\u662f\u0398(n+k)\uff1b</li> </ul>"},{"location":"code_guide/algs/sort.html#_6","title":"\u57fa\u6570\u6392\u5e8f","text":"<p>\u7a33\u5b9a\uff0c\u5c06\u5f85\u6392\u6570\u636e\u4e2d\u7684\u6bcf\u7ec4\u5173\u952e\u5b57\uff08\u5982\u4f4d\u4e0a\u7684\u6570\u5b57\uff09\u4f9d\u6b21\u8fdb\u884c\u6876\u5206\u914d\uff1b</p> <ul> <li> <p>MSD\uff1a\u6700\u9ad8\u4f4d\u4f18\u5148\uff0c\u5206\u6210\u4e0d\u540c\u7684\u6876(\u8ba1\u6570\u6392\u5e8f)\uff0c\u6876\u5185\u518d\u6392\u5e8f\uff1bO(d(n+r))\uff0cr\u4e3a\u57fa\u6570\uff0cd\u4e3a\u4f4d\u6570\uff1b</p> </li> <li> <p>LSD\uff1a\u6700\u4f4e\u4f4d\u4f18\u5148\uff0c\u91c7\u7528\u8ba1\u6570\u6392\u5e8f\uff0c\u6bcf\u6b21\u6839\u636e\u5f53\u524d\u4f4d\u5bf9\u6570\u7ec4\u91cd\u6392\uff1bO(d(n+r))\uff0cr\u4e3a\u57fa\u6570\uff0cd\u4e3a\u4f4d\u6570\uff1b</p> </li> </ul>"},{"location":"code_guide/data_structure/READMD.html","title":"\u6570\u636e\u7ed3\u6784","text":""},{"location":"code_guide/data_structure/READMD.html#_2","title":"\u53c2\u8003\u8d44\u6599","text":"<ol> <li>Hello \u7b97\u6cd5</li> </ol>"},{"location":"code_guide/data_structure/array.html","title":"\u6570\u7ec4","text":"<p>\u6240\u6709\u4ee3\u7801\u5b9e\u73b0\u89c1 Java\u6570\u636e\u7ed3\u6784\u4e0e\u7b97\u6cd5</p>"},{"location":"code_guide/data_structure/array.html#_2","title":"\u5806","text":"<p>\u5806\u662f\u4e2a\u5b8c\u5168\u4e8c\u53c9\u6811\uff0c\u56e0\u6b64\u5e95\u5c42\u53ef\u4ee5\u7528\u6570\u7ec4\u6765\u8868\u793a\u3002\u6700\u5c0f\u5806\uff1a</p> <ul> <li>\u63d2\u5165\u65f6\uff0c\u653e\u5230\u6700\u540e\u9762\uff0c\u7136\u540e\u4e0e\u7236\u8282\u70b9\u6bd4\u8f83\u5bf9\u8c03\uff0c\u76f4\u5230 &gt;= \u7236\u8282\u70b9\uff1b</li> <li>\u5220\u9664\u65f6\uff0c\u5c06\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u653e\u5230\u4e00\u4e2a\u5143\u7d20\uff08\u6700\u540e\u7f6e\u4e3aNULL\uff09\uff0c\u4e0e\u5b50\u8282\u70b9\u6bd4\u8f83\u5bf9\u8c03\uff0c\u76f4\u81f3 &lt;= \u5b50\u8282\u70b9\uff1b</li> </ul> <p></p>"},{"location":"code_guide/data_structure/array.html#_3","title":"\u5e76\u67e5\u96c6","text":"<p>\u5047\u8bbe\u5143\u7d20\u95f4\u6709\u5173\u8054\uff0c\u4e14\u5b58\u5728\u4f20\u9012\u5173\u7cfb\uff0c\u5982\u4f55\u5feb\u901f\u5224\u65ad\u4e24\u4e2a\u5143\u7d20\u662f\u5426\u6709\u5173\u8054\u3002</p> <p>\u7528\u9014</p> <p>1\u3001\u7ef4\u62a4\u65e0\u5411\u56fe\u7684\u8fde\u901a\u6027\u3002\u652f\u6301\u5224\u65ad\u4e24\u4e2a\u70b9\u662f\u5426\u5728\u540c\u4e00\u8fde\u901a\u5757\u5185\uff1b 2\u3001\u5224\u65ad\u589e\u52a0\u4e00\u6761\u8fb9\u662f\u5426\u4f1a\u4ea7\u751f\u73af\uff1a\u7528\u5728\u6c42\u89e3\u6700\u5c0f\u751f\u6210\u6811\u7684Kruskal\u7b97\u6cd5\u91cc\uff1b</p> <p>\u5b9a\u4e49\uff1a\u7ba1\u7406\u4e00\u7cfb\u5217\u4e0d\u76f8\u4ea4\u7684\u96c6\u5408\uff0c\u53ea\u652f\u6301\u4e24\u79cd\u64cd\u4f5c\uff1a</p> <ul> <li>\u5408\u5e76\uff08Union\uff09\uff1a\u628a\u4e24\u4e2a\u4e0d\u76f8\u4ea4\u7684\u96c6\u5408\u5408\u5e76\u4e3a\u4e00\u4e2a\u96c6\u5408\u3002</li> <li>\u67e5\u8be2\uff08Find\uff09\uff1a\u67e5\u8be2\u4e24\u4e2a\u5143\u7d20\u662f\u5426\u5728\u540c\u4e00\u4e2a\u96c6\u5408\u4e2d\u3002</li> </ul> <p>\u521d\u59cb\u7248\u672c\uff08\u5408\u5e76\u590d\u6742\u5ea6/\u67e5\u8be2\u590d\u6742\u5ea6\uff1aO(h)\uff0ch\u8868\u793a\u6811\u7684\u9ad8\u5ea6\uff0c\u6700\u5dee\u4e3a\u94fe\u8868\uff09</p> <p>\u7b97\u6cd5\u8fc7\u7a0b\uff1a\u6bcf\u4e2a\u5143\u7d20\u53ea\u77e5\u9053\u81ea\u5df1\u7684\u7236\u8282\u70b9\uff1b</p> <ul> <li> <p>\u521d\u59cb\u6bcf\u4e2a\u5143\u7d20\u7236\u8282\u70b9\u5373\u81ea\u8eab\u6216\u8005 -1\uff0c<code>ids[i] = i</code>\uff1b</p> </li> <li> <p>\u67e5\u627e\u5143\u7d20\u6240\u5c5e\u7684\u96c6\u5408</p> </li> </ul> <pre><code>int find(i) {\n    while (ids[i] != i) {\n        i = ids[i];\n    }\n    return i;\n}\n</code></pre> <ul> <li> <p>\u5408\u5e76\u4e24\u4e2a\u5143\u7d20\u65f6\uff0c\u5c06\u5176\u4e2d\u4e00\u4e2a\u8282\u70b9\u7684\u96c6\u5408\u6307\u5411\u53e6\u4e00\u4e2a\u8282\u70b9\uff0c<code>ids[find(i)]=j</code>\uff1b</p> </li> <li> <p>\u5224\u65ad\u4e24\u4e2a\u662f\u5426\u5904\u4e8e\u540c\u4e00\u4e2a\u96c6\u5408\uff0c<code>find(i)==find(j)</code>\uff1b</p> </li> </ul> <p>\u8def\u5f84\u538b\u7f29</p> <ul> <li>\u89e3\u51b3\u67e5\u627e\u65f6\u6b21\u6570\u8fc7\u591a\u7684\u95ee\u9898\uff0c\u9632\u6b62\u6811\u53d8\u6210\u94fe\u8868\uff0c\u67e5\u627e\u590d\u6742\u5ea6\u53d8\u4e3aO(n)\uff1b</li> <li>\u67e5\u627e\u65f6\u5c06x\u5230\u6839\u8282\u70b9\u8def\u5f84\u4e0a\u7684\u6240\u6709\u70b9\u7684<code>parent</code>\u8bbe\u4e3a\u6839\u8282\u70b9\uff0c\u8be5\u4f18\u5316\u65b9\u6cd5\u79f0\u4e3a\u538b\u7f29\u8def\u5f84</li> </ul> <p>\u6309\u79e9\u5408\u5e76</p> <ul> <li>\u7ef4\u62a4\u6bcf\u4e2a\u5b50\u6811\u7684\u8282\u70b9\u4e2a\u6570\uff0c\u5408\u5e76\u65f6\u5c06\u5c0f\u7684\u5b50\u6811\u5408\u5e76\u5230\u5927\u7684\u5b50\u6811\u4e0a</li> <li>\u5982\u679c\u662f\u7ef4\u62a4\u5b50\u6811\u7684\u9ad8\u5ea6\uff0c\u5219\u8def\u5f84\u538b\u7f29\u4f1a\u9020\u6210rank\u4e0d\u51c6\u786e\uff0c\u56e0\u6b64\u6309\u7167 size \u8fdb\u884c\u5408\u5e76\uff1b</li> </ul> <p></p>"},{"location":"code_guide/data_structure/array.html#_4","title":"\u6811\u72b6\u6570\u7ec4","text":"<p>\u6811\u72b6\u6570\u7ec4\uff08Binary Index Tree, BIT\uff09\uff0c\u6700\u7b80\u5355\u7684\u6811\u72b6\u6570\u7ec4\u652f\u6301\u4e24\u79cd\u64cd\u4f5c\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5747\u4e3a Olg(n)\uff1a</p> <ul> <li>\u5355\u70b9\u4fee\u6539\uff1a\u66f4\u6539\u6570\u7ec4\u4e2d\u4e00\u4e2a\u5143\u7d20\u7684\u503c</li> <li>\u533a\u95f4\u67e5\u8be2\uff1a\u67e5\u8be2\u4e00\u4e2a\u533a\u95f4\u5185\u6240\u6709\u5143\u7d20\u7684\u548c</li> </ul> <p>\u5bf9\u4e8e\u666e\u901a\u6570\u7ec4\u800c\u8a00\uff0c\u5355\u70b9\u4fee\u6539\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(1)\uff0c\u4f46\u533a\u95f4\u6c42\u548c\u7684\u590d\u6742\u5ea6\u662fO(n)\u3002</p>"},{"location":"code_guide/data_structure/array.html#_5","title":"\u539f\u7406","text":"<p>\u6811\u72b6\u6570\u7ec4\u7684\u5b9a\u4e49\uff1a</p> <ul> <li>\u4e8c\u8fdb\u5236\u6570\u6700\u53f3\u8fb9\u7684\u4e00\u4e2a1\uff0c\u8fde\u5e26\u7740\u5b83\u4e4b\u540e\u76840\u4e3a\\(lowbit(x)\\)\uff0c\u7528\\(C(i)\\)\u7ef4\u62a4\u533a\u95f4\\((A_i-lowbit(A_i), Ai]\\)\uff0c\u8fd9\u6837\u67e5\u8be2\u524dn\u9879\u548c\u65f6\u9700\u8981\u5408\u5e76\u7684\u533a\u95f4\u6570\u662f\u5c11\u4e8e\\(log_2(n)\\)\uff1a</li> </ul> <p></p> <p>\u66f4\u65b0\u5c31\u662f\u4e00\u4e2a\u201c\u722c\u6811\u201d\u7684\u8fc7\u7a0b\u3002\u4e00\u8def\u5f80\u4e0a\u66f4\u65b0\uff0c\u76f4\u5230MAXN\uff08\u6811\u72b6\u6570\u7ec4\u7684\u5bb9\u91cf\uff09\u3002</p> <p></p> <p>\\(lowbit(x)=(x)\\&amp;(-x)\\)</p>"},{"location":"code_guide/data_structure/hashmap.html","title":"Hash \u8868","text":"<p>\u54c8\u5e0c\u8868\u662f\u6839\u636e\u8bbe\u5b9a\u7684\u54c8\u5e0c\u51fd\u6570H\uff08key\uff09\u548c\u5904\u7406\u51b2\u7a81\u65b9\u6cd5\u5c06\u4e00\u7ec4\u5173\u952e\u5b57\u6620\u5c04\u5230\u4e00\u4e2a\u6709\u9650\u7684\u5730\u5740\u533a\u95f4\u4e0a\uff0c\u5e76\u4ee5\u5173\u952e\u5b57\u5728\u5730\u5740\u533a\u95f4\u4e2d\u7684\u8c61\u4f5c\u4e3a\u8bb0\u5f55\u5728\u8868\u4e2d\u7684\u5b58\u50a8\u4f4d\u7f6e\uff0c\u8fd9\u79cd\u8868\u79f0\u4e3a\u54c8\u5e0c\u8868\u6216\u6563\u5217\uff0c\u6240\u5f97\u5b58\u50a8\u4f4d\u7f6e\u79f0\u4e3a\u54c8\u5e0c\u5730\u5740\u6216\u6563\u5217\u5730\u5740\u3002</p>"},{"location":"code_guide/data_structure/hashmap.html#hash_1","title":"\u70ed\u70b9Hash","text":"<p>[1] Chen J ,  Chen L ,  Wang S , et al. HotRing: a hotspot-aware in-memory key-value store[C]// File and Storage Technologies. 2020.</p> <p>\u5185\u5b58KVS\u5f15\u64ce\u901a\u5e38\u91c7\u7528\u94fe\u5f0f\u54c8\u5e0c\u4f5c\u4e3a\u7d22\u5f15\uff0c\u8bbf\u95ee\u4f4d\u4e8e\u51b2\u7a81\u94fe\u5c3e\u90e8\u7684\u6570\u636e\uff0c\u9700\u8981\u7ecf\u8fc7\u66f4\u591a\u7684\u7d22\u5f15\u8df3\u6570\uff1a</p> <ul> <li>\u5c06\u70ed\u70b9\u6570\u636e\u653e\u7f6e\u5728\u51b2\u7a81\u94fe\u5934\u90e8\uff0c\u90a3\u4e48\u7cfb\u7edf\u5bf9\u4e8e\u70ed\u70b9\u6570\u636e\u7684\u8bbf\u95ee\u5c06\u4f1a\u6709\u66f4\u5feb\u7684\u54cd\u5e94\u901f\u5ea6\u3002</li> </ul>"},{"location":"code_guide/data_structure/hashmap.html#_1","title":"\u6709\u5e8f\u73af\u5f0f\u54c8\u5e0c\u7d22\u5f15","text":"<ul> <li>\u5c06\u51b2\u7a81\u94fe\u9996\u5c3e\u8fde\u63a5\u5f62\u5f0f\u51b2\u7a81\u73af\uff0c\u4fdd\u8bc1\u5934\u6307\u9488\u6307\u5411\u4efb\u4f55\u4e00\u4e2aitem\u90fd\u53ef\u4ee5\u904d\u5386\u73af\u4e0a\u6240\u6709\u6570\u636e</li> <li>\u901a\u8fc7lock-free\u79fb\u52a8\u5934\u6307\u9488\uff0c\u52a8\u6001\u6307\u5411\u70ed\u5ea6\u8f83\u9ad8\u7684item\uff08\u6216\u6839\u636e\u7b97\u6cd5\u8ba1\u7b97\u51fa\u7684\u6700\u4f18item\u4f4d\u7f6e\uff09</li> </ul>"},{"location":"code_guide/data_structure/hashmap.html#_2","title":"\u6709\u5e8f\u73af","text":"<p>\u5728\u73af\u4e0a\uff0c\u6240\u6709\u6570\u636e\u90fd\u4f1a\u52a8\u6001\u53d8\u5316(\u66f4\u65b0\u6216\u5220\u9664)\uff0c\u5934\u6307\u9488\u540c\u6837\u4e5f\u4f1a\u52a8\u6001\u79fb\u52a8\uff0c\u6ca1\u6709\u6807\u5fd7\u53ef\u4ee5\u4f5c\u4e3a\u904d\u5386\u7684\u7ec8\u6b62\u5224\u65ad\u3002</p> <ul> <li>key\u6392\u5e8f\uff1a\u82e5\u76ee\u6807key\u4ecb\u4e8e\u8fde\u7eed\u4e24\u4e2aitem\u7684key\u4e4b\u95f4\uff0c\u8bf4\u660e\u4e3aread miss\u64cd\u4f5c\uff0c\u5373\u53ef\u7ec8\u6b62\u8fd4\u56de\uff1b</li> <li>key\u7b80\u5316\uff1a\u5229\u7528tag\u6765\u51cf\u5c11key\u7684\u6bd4\u8f83\u5f00\u9500\uff0c\u5b57\u5178\u5e8f\uff1aorder = (tag, key)</li> <li>tag\u662f\u54c8\u5e0c\u503c\u7684\u4e00\u90e8\u5206\uff0c\u6bcf\u4e2akey\u8ba1\u7b97\u7684\u54c8\u5e0c\u503c\uff0c\u524dk\u4f4d\u7528\u6765\u54c8\u5e0c\u8868\u7684\u5b9a\u4f4d\uff0c\u540en-k\u4f4d\u4f5c\u4e3atag\uff1b</li> </ul> <p></p> <p>\u4ee5 itemB \u4e3e\u4f8b\uff1a</p> <ul> <li>\u94fe\u5f0f\u54c8\u5e0c\u9700\u8981\u904d\u5386\u6240\u6709\u6570\u636e\u624d\u80fd\u8fd4\u56deread miss\u3002\u800cHotRing\u5728\u8bbf\u95eeitemA\u4e0eC\u540e\uff0c\u5373\u53ef\u786e\u8ba4B read miss\u3002</li> </ul>"},{"location":"code_guide/data_structure/hashmap.html#_3","title":"\u52a8\u6001\u8bc6\u522b\u4e0e\u8c03\u6574","text":"<p>\u6bcfR\u6b21\u8bbf\u95ee\u4e3a\u4e00\u4e2a\u5468\u671f(R\u901a\u5e38\u8bbe\u7f6e\u4e3a5)\uff0c\u7b2cR\u6b21\u8bbf\u95ee\u7684\u7ebf\u7a0b\u5c06\u8fdb\u884c\u5934\u6307\u9488\u7684\u8c03\u6574\uff1a</p> <ul> <li> <p>\u968f\u673a\u79fb\u52a8\u7b56\u7565\uff1a\u6bcfR\u6b21\u8bbf\u95ee\uff0c\u79fb\u52a8\u5934\u6307\u9488\u6307\u5411\u7b2cR\u6b21\u8bbf\u95ee\u7684item\u3002\u82e5\u5df2\u7ecf\u6307\u5411\u8be5item\uff0c\u5219\u5934\u6307\u9488\u4e0d\u79fb\u52a8\u3002\u8be5\u7b56\u7565\u7684\u4f18\u52bf\u662f\uff0c \u4e0d\u9700\u8981\u989d\u5916\u7684\u5143\u6570\u636e\u5f00\u9500\uff0c\u4e14\u4e0d\u9700\u8981\u91c7\u6837\u8fc7\u7a0b\uff0c\u54cd\u5e94\u901f\u5ea6\u6781\u5feb\u3002</p> </li> <li> <p>\u91c7\u6837\u5206\u6790\u7b56\u7565\uff1a\u6bcfR\u6b21\u8bbf\u95ee\uff0c\u5c1d\u8bd5\u542f\u52a8\u5bf9\u5e94\u51b2\u7a81\u73af\u7684\u91c7\u6837\uff0c\u7edf\u8ba1item\u7684\u8bbf\u95ee\u9891\u7387\u3002\u82e5\u7b2cR\u6b21\u8bbf\u95ee\u7684item\u5df2\u7ecf\u662f\u5934\u6307\u9488\u6307\u5411\u7684item\uff0c\u5219\u4e0d\u542f\u52a8\u91c7\u6837\u3002</p> </li> </ul> <p>\u91c7\u6837\u5206\u6790\u7b56\u7565\uff1a\u5229\u7528\u4e86head pointer / next pointer\u7684\u5269\u4f59\u7a7a\u95f4\uff0c\u56e0\u4e3a\u6307\u793a\u5730\u5740\u752848\u4f4d\u5c31\u591f\u4e86\uff0c\u8fd9\u6837\u8fd8\u670916\u4f4d\uff1a</p> <ul> <li>head pointer\uff1a16\u4f4d\u5206\u62101 bit\u7684active\u4f4d\u4ee5\u53ca15\u4f4d\u7684total counter\u4f4d\uff08\u8bb0\u5f55\u5f53\u524d\u8fd9\u4e2abucket\u7684\u8bbf\u95ee\u6b21\u6570\uff09\uff1b</li> <li>next pointer\uff1a1 bit Rehash\u4f4d\uff0c1bit Occupied\u4f4d\u548c14 bit\u7684counter\u4f4d\uff0cRehash\u548cCounter\u5206\u522b\u7528\u4e8e\u5e76\u53d1\u7684rehash\u548cupdate\u64cd\u4f5c\u3002</li> </ul> <p></p> <p>TODO\uff1a\u6027\u80fd\u63d0\u53472.58\u500d\uff01\u963f\u91cc\u6700\u5febKV\u5b58\u50a8\u5f15\u64ce\u63ed\u79d8 (qq.com)</p>"},{"location":"code_guide/data_structure/hashmap.html#_4","title":"\u65e0\u9501\u5e76\u53d1\u8bbf\u95ee","text":"<p>\u4fee\u6539\u548c\u66f4\u65b0\u5e76\u53d1\u6b63\u786e\u6027\u95ee\u9898\uff1a</p> <ul> <li>\u5728\u94feA-&gt;B-&gt;D\u4e0a\uff0c\u7ebf\u7a0b1\u8fdb\u884c\u63d2\u5165C\u7684\u64cd\u4f5c\uff0c\u540c\u65f6\u7ebf\u7a0b2\u8fdb\u884cRCU\u66f4\u65b0B\u7684\u64cd\u4f5c\uff0c\u5c1d\u8bd5\u66f4\u65b0\u4e3aB'\u3002\u7ebf\u7a0b1\u4fee\u6539B\u7684\u6307\u9488\u6307\u5411C\uff0c\u5b8c\u6210\u63d2\u5165\u3002\u800c\u7ebf\u7a0b2\u4fee\u6539A\u7684\u6307\u9488\u6307\u5411B'\u5b8c\u6210\u66f4\u65b0\u3002\u4e24\u4e2a\u7ebf\u7a0b\u5e76\u53d1\u4fee\u6539\u4e0d\u540c\u7684\u5185\u5b58\uff0c\u5747\u53ef\u6210\u529f\u8fd4\u56de\u3002\u4f46\u662f\u8fd9\u65f6\u904d\u5386\u6574\u6761\u94fe(A-&gt;B'-&gt;D)\uff0c\u5c06\u53d1\u73b0C\u65e0\u6cd5\u88ab\u904d\u5386\u5230\uff0c\u5bfc\u81f4\u6b63\u786e\u6027\u95ee\u9898\u3002</li> </ul> <p>\u89e3\u51b3\u63aa\u65bd</p> <ul> <li>\u5229\u7528Item\u7684Occupied\u6807\u5fd7\u4f4d\u3002\u5f53\u7ebf\u7a0b2\u66f4\u65b0B\u65f6\uff0c\u9996\u5148\u9700\u8981\u5c06B\u7684Occupied\u6807\u5fd7\u4f4d\u7f6e\u4f4d\u3002\u7ebf\u7a0b1\u63d2\u5165C\u9700\u8981\u4fee\u6539B\u7684\u6307\u9488(Next Item Address)\uff0c\u82e5\u53d1\u73b0Occupied\u6807\u5fd7\u4f4d\u5df2\u7f6e\u4f4d\uff0c\u5219\u9700\u8981\u91cd\u65b0\u904d\u5386\u94fe\u8868\uff0c\u5c1d\u8bd5\u63d2\u5165\u3002\u901a\u8fc7\u4f7f\u5e76\u53d1\u64cd\u4f5c\u7ade\u4e89\u4fee\u6539\u540c\u4e00\u5185\u5b58\u5730\u5740\uff0c\u4fdd\u8bc1\u5e76\u53d1\u64cd\u4f5c\u7684\u6b63\u786e\u6027\u3002</li> </ul> <p></p>"},{"location":"code_guide/data_structure/hashmap.html#rehash","title":"\u9002\u5e94\u70ed\u70b9\u6570\u636e\u91cf\u7684\u65e0\u9501rehash","text":"<p>\u5f15\u64ce\u6027\u80fd\u7684\u964d\u4f4e\uff0c\u5fc5\u7136\u662f\u56e0\u4e3a\u51b2\u7a81\u73af\u4e0a\u5b58\u5728\u591a\u4e2a\u70ed\u70b9\u3002</p> <ul> <li>\u5229\u7528\u8bbf\u95ee\u6240\u9700\u5e73\u5747\u5185\u5b58\u8bbf\u95ee\u6b21\u6570(access overhead)\u6765\u66ff\u4ee3\u4f20\u7edfrehash\u7b56\u7565\u7684\u8d1f\u8f7d\u56e0\u5b50(load factor)\u3002</li> </ul> <p>\u5728\u5e42\u7387\u5206\u5e03\u573a\u666f\uff0c\u82e5\u6bcf\u4e2a\u51b2\u7a81\u73af\u53ea\u6709\u4e00\u4e2a\u70ed\u70b9\uff0cHotRing\u53ef\u4ee5\u4fdd\u8bc1access overhead &lt; 2\uff0c\u5373\u5e73\u5747\u6bcf\u6b21\u8bbf\u95ee\u6240\u9700\u5185\u5b58\u8bbf\u95ee\u6b21\u6570\u5c0f\u4e8e2\u3002</p> <ul> <li>\u8bbe\u5b9aaccess overhead\u9608\u503c\u4e3a2\uff0c\u5f53\u5927\u4e8e2\u65f6\uff0c\u89e6\u53d1rehash\u3002</li> </ul> <p>rehash\u8fc7\u7a0b\u5206\u4e3a3\u6b65\u8fdb\u884c\uff1a\u56fe\u4e00\u4e3a\u54c8\u5e0c\u8868\uff0c\u54c8\u5e0c\u503c\u5728rehash\u524d\u540e\u7684\u53d8\u5316\u3002\u5269\u4f59\u4e09\u56fe\u4e3arehash\u4e09\u4e2a\u8fc7\u7a0b\u3002</p> <p></p> <p></p> <ul> <li>\u521d\u59cb\u5316\uff1a\u521b\u5efa\u540e\u53f0rehash\u7ebf\u7a0b\uff0c\u521b\u5efa2\u500d\u7a7a\u95f4\u7684\u65b0\u54c8\u5e0c\u8868\uff0c\u901a\u8fc7\u590d\u7528tag\u7684\u6700\u9ad8\u4e00\u4f4d\u6765\u8fdb\u884c\u7d22\u5f15\uff1b</li> <li>\u65b0\u8868\u4e2d\u5c06\u4f1a\u6709\u4e24\u4e2a\u5934\u6307\u9488\u4e0e\u65e7\u8868\u4e2d\u7684\u4e00\u4e2a\u5934\u6307\u9488\u5bf9\u5e94\uff1b</li> <li>\u5047\u8bbetag\u6700\u5927\u503c\u4e3aT\uff0ctag\u8303\u56f4\u4e3a[0,T)\uff0c\u5219\u4e24\u4e2a\u65b0\u7684\u5934\u6307\u9488\u5bf9\u5e94tag\u8303\u56f4\u4e3a[0,T/2)\u548c[T/2,T)\uff1b</li> <li>rehash\u7ebf\u7a0b\u521b\u5efa\u4e00\u4e2arehash\u8282\u70b9(\u5305\u542b\u4e24\u4e2a\u7a7a\u6570\u636e\u7684\u5b50item\u8282\u70b9)\uff0c\u5b50item\u8282\u70b9\u5206\u522b\u5bf9\u5e94\u4e24\u4e2a\u65b0\u5934\u6307\u9488\uff0c\u5229\u7528item\u4e2d\u7684Rehash\u6807\u5fd7\u4f4d\u8bc6\u522brehash\u8282\u70b9\u7684\u5b50item\u8282\u70b9\u3002</li> <li>\u5206\u88c2\uff1arehash\u7ebf\u7a0b\u901a\u8fc7\u5c06rehash\u8282\u70b9\u7684\u4e24\u4e2a\u5b50item\u8282\u70b9\u63d2\u5165\u73af\u4e2d\u5b8c\u6210\u73af\u7684\u5206\u88c2\u3002</li> <li>\u5982\u56fe(Split)\u6240\u793a\uff0c\u56e0\u4e3aitemB\u548cE\u662ftag\u7684\u8303\u56f4\u8fb9\u754c\uff0c\u6240\u4ee5\u5b50item\u8282\u70b9\u5206\u522b\u63d2\u5165\u5230itemB\u548cE\u4e4b\u524d\u3002</li> <li>\u5b8c\u6210\u4e24\u4e2a\u63d2\u5165\u64cd\u4f5c\u540e\uff0c\u65b0\u54c8\u5e0c\u8868\u5c06\u6fc0\u6d3b\uff0c\u6240\u6709\u7684\u8bbf\u95ee\u90fd\u5c06\u901a\u8fc7\u65b0\u54c8\u5e0c\u8868\u8fdb\u884c\u8bbf\u95ee\uff1b</li> <li>\u903b\u8f91\u4e0a\u5c06\u51b2\u7a81\u73af\u4e00\u5206\u4e3a\u4e8c\u3002\u5f53\u6211\u4eec\u67e5\u627e\u6570\u636e\u65f6\uff0c\u6700\u591a\u53ea\u9700\u8981\u626b\u63cf\u4e00\u534a\u7684item\u3002</li> <li>\u5220\u9664\uff1a\u6536\u5c3e\u5de5\u4f5c\uff0c\u5305\u62ec\u65e7\u54c8\u5e0c\u8868\u7684\u56de\u6536\u548crehash\u8282\u70b9\u7684\u5220\u9664\u56de\u6536\u3002</li> </ul> <p>\u5206\u88c2\u9636\u6bb5\u548c\u5220\u9664\u9636\u6bb5\u95f4\uff0c\u5fc5\u987b\u6709\u4e00\u4e2aRCU\u9759\u9ed8\u671f(transition period)\u3002</p> <ul> <li>\u9759\u9ed8\u671f\u4fdd\u8bc1\u6240\u6709\u4ece\u65e7\u54c8\u5e0c\u8868\u8fdb\u5165\u7684\u8bbf\u95ee\u5747\u5df2\u7ecf\u8fd4\u56de\u3002\u5426\u5219\uff0c\u76f4\u63a5\u56de\u6536\u65e7\u54c8\u5e0c\u8868\u53ef\u80fd\u5bfc\u81f4\u5e76\u53d1\u9519\u8bef\u3002</li> </ul>"},{"location":"code_guide/data_structure/list.html","title":"List","text":""},{"location":"code_guide/data_structure/list.html#_1","title":"\u94fe\u8868","text":"<p>\u5355\u94fe\u8868\uff0c\u53cc\u94fe\u8868</p> <ul> <li>\u5224\u65ad\u5355\u5411\u94fe\u8868\u4e2d\u662f\u5426\u6709\u73af\uff1a\u5feb\u6162\u6307\u9488\u7b97\u6cd5\uff1b</li> </ul>"},{"location":"code_guide/data_structure/list.html#skiplist","title":"\u8df3\u8868(SkipList)","text":"<p>\u8df3\u8868\uff08Skiplist\uff09\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u94fe\u8868\uff0c\u76f8\u6bd4\u4e00\u822c\u7684\u94fe\u8868\uff0c\u6709\u66f4\u9ad8\u7684\u67e5\u627e\u6548\u7387\uff0c\u53ef\u6bd4\u62df\u4e8c\u53c9\u67e5\u627e\u6811\uff0c\u5e73\u5747\u671f\u671b\u7684\u67e5\u627e\u3001\u63d2\u5165\u3001\u5220\u9664\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662fO(logn)\u3002</p> <ul> <li>\u5efa\u7acb\u5c42\u7ea7\u7d22\u5f15\uff0c\u51cf\u5c11\u6bd4\u8f83\u7684\u6b21\u6570\uff0c\u589e\u52a0\u641c\u7d22\u6548\u7387\uff1b</li> <li>\u7a7a\u95f4\u589e\u52a0\u4e00\u500d\uff1b</li> </ul>"},{"location":"code_guide/data_structure/list.html#_2","title":"\u793a\u610f\u56fe","text":""},{"location":"code_guide/data_structure/list.html#_3","title":"\u7b97\u6cd5\u6d41\u7a0b","text":"<ol> <li>\u65b0\u8282\u70b9\u548c\u5404\u5c42\u7d22\u5f15\u8282\u70b9\u9010\u4e00\u6bd4\u8f83\uff0c\u786e\u5b9a\u539f\u94fe\u8868\u7684\u63d2\u5165\u4f4d\u7f6e\u3002O\uff08logN\uff09</li> <li>\u628a\u7d22\u5f15\u63d2\u5165\u5230\u539f\u94fe\u8868\u3002O\uff081\uff09</li> <li>\u5229\u7528\u629b\u786c\u5e01\u7684\u968f\u673a\u65b9\u5f0f\uff0c\u51b3\u5b9a\u65b0\u8282\u70b9\u662f\u5426\u63d0\u5347\u4e3a\u4e0a\u4e00\u7ea7\u7d22\u5f15\u3002\u7ed3\u679c\u4e3a\u201c\u6b63\u201d\u5219\u63d0\u5347\u5e76\u7ee7\u7eed\u629b\u786c\u5e01\uff0c\u7ed3\u679c\u4e3a\u201c\u8d1f\u201d\u5219\u505c\u6b62\u3002O\uff08logN\uff09</li> </ol>"},{"location":"code_guide/data_structure/list.html#rcu","title":"RCU\u65e0\u9501\u94fe\u8868","text":"<p>\u5728\u66f4\u65b0\u7684\u8fc7\u7a0b\u4e2d\uff0c\u8fd0\u884c\u591a\u4e2areader\u8fdb\u884c\u8bfb\u64cd\u4f5c\uff0c\u5199\u5c11\u8bfb\u591a\u7684\u573a\u666f\u3002</p> <p>\u4e00\u4e2a\u5199\u591a\u4e2a\u8bfb\u7684\u540c\u6b65\u673a\u5236\uff0c\u800c\u4e0d\u662f\u591a\u4e2a\u5199\u591a\u4e2a\u8bfb\u7684\u540c\u6b65\u673a\u5236\uff08\u591a\u5199\u65f6\u9700\u8981\u52a0\u9501\uff09\u3002</p> <ul> <li>RCU\u662f\u7531<code>RCU-sync</code>\u548c<code>COW(Copy-On-Write)</code>\u4e24\u90e8\u5206\u7ec4\u6210\u7684\uff0cJava\u4e2d\u6709GC\u56e0\u6b64\u53ea\u6709COW\uff1b</li> <li><code>RCU-sync</code>\uff1a\u89e3\u51b3\u62f7\u8d1d\u51fa\u6765\u7684\u5bf9\u8c61\u4ec0\u4e48\u65f6\u5019\u56de\u6536\u7684\u95ee\u9898\uff08\u6838\u5fc3\u90e8\u5206\uff09\uff1b</li> </ul> <p>\u5178\u578b\u7684RCU\u66f4\u65b0\u65f6\u5e8f\u5982\u4e0b:</p> <ul> <li> <p>\u590d\u5236\uff1a\u5c06\u9700\u8981\u66f4\u65b0\u7684\u6570\u636e\u590d\u5236\u5230\u65b0\u5185\u5b58\u5730\u5740\uff1b</p> </li> <li> <p>\u66f4\u65b0\uff1a\u66f4\u65b0\u590d\u5236\u6570\u636e\uff0c\u8fd9\u65f6\u5019\u64cd\u4f5c\u7684\u65b0\u7684\u5185\u5b58\u5730\u5740\uff1b</p> </li> <li> <p>\u66ff\u6362\uff1a\u4f7f\u7528\u65b0\u5185\u5b58\u5730\u5740\u6307\u9488\u66ff\u6362\u65e7\u6570\u636e\u5185\u5b58\u5730\u5740\u6307\u9488</p> </li> </ul> <p>\u6b64\u540e\u65e7\u6570\u636e\u5c06\u65e0\u6cd5\u88ab\u540e\u7eed\u8bfb\u8005\u8bbf\u95ee\uff1b</p> <ul> <li> <p>\u7b49\u5f85\uff0c\u6240\u6709\u8bbf\u95ee\u65e7\u6570\u636e\u7684\u8bfb\u8005\u8fdb\u5165\u9759\u9ed8\u671f\uff0c\u5373\u8bbf\u95ee\u65e7\u6570\u636e\u5b8c\u6210\uff1b</p> </li> <li> <p>\u56de\u6536\uff1a\u5f53\u6ca1\u6709\u4efb\u4f55\u6301\u6709\u65e7\u6570\u636e\u7ed3\u6784\u5f15\u7528\u7684\u8bfb\u8005\u540e\uff0c\u5b89\u5168\u5730\u56de\u6536\u65e7\u6570\u636e\u5185\u5b58\u3002</p> </li> </ul>"},{"location":"code_guide/data_structure/list.html#_4","title":"\u8bfb\u64cd\u4f5c","text":"<ul> <li>\u76f4\u63a5\u5bf9\u5171\u4eab\u8d44\u6e90\u8fdb\u884c\u8bbf\u95ee\uff0c\u73b0\u4ee3<code>CPU</code>\u652f\u6301\u8bbf\u5b58\u64cd\u4f5c\u7684\u539f\u5b50\u5316\uff1b</li> <li>\u8bfb\u64cd\u4f5c\u4e0a\u4e0b\u6587\u662f\u4e0d\u53ef\u62a2\u5360\u7684\uff0c\u8bfb\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u65f6\u53ef\u4ee5\u91c7\u7528<code>read_rcu_lock()</code>\uff0c\u8be5\u51fd\u6570\u7684\u5de5\u4f5c\u662f\u505c\u6b62\u62a2\u5360\uff1b</li> </ul>"},{"location":"code_guide/data_structure/list.html#_5","title":"\u5199\u64cd\u4f5c","text":"<ul> <li>\u590d\u5236 -&gt; \u66f4\u65b0 -&gt; \u66ff\u6362\uff1a\u66ff\u6362\u65e7\u6570\u636e\u7684\u6307\u9488\u65f6\uff0c\u9700\u8981\u5185\u5b58\u5c4f\u969c\uff0c\u907f\u514d\u6307\u4ee4\u91cd\u6392\u5e8f\uff1b</li> </ul>"},{"location":"code_guide/data_structure/list.html#_6","title":"\u5783\u573e\u56de\u6536","text":"<p><code>daemon</code>\uff0c\u5f53\u5171\u4eab\u8d44\u6e90\u88ab<code>update</code>\u4e4b\u540e\uff0c\u53ef\u4ee5\u91c7\u7528\u8be5<code>daemon</code>\u5b9e\u73b0\u8001\u6570\u636e\u8d44\u6e90\u7684\u56de\u6536\uff1a</p> <ul> <li>\u5728<code>update</code>\u4e4b\u524d\u7684\u6240\u6709\u7684\u8bfb\u8005\u5168\u90e8\u9000\u51fa\uff1b</li> <li>\u5199\u8005\u5728update\u4e4b\u540e\u662f\u9700\u8981\u7761\u7720\u7b49\u5f85\u7684\uff0c\u9700\u8981\u7b49\u5f85\u8bfb\u8005\u5b8c\u6210\u64cd\u4f5c\uff0c\u5982\u679c\u5728\u8fd9\u4e2a\u65f6\u523b\u8bfb\u8005\u88ab\u62a2\u5360\u6216\u8005\u7761\u7720\uff0c\u90a3\u4e48\u5f88\u53ef\u80fd\u4f1a\u5bfc\u81f4\u7cfb\u7edf\u6b7b\u9501\uff1b</li> </ul> <p>\u5bbd\u9650\u671f\uff08Grace period\uff1a\u5728\u8bfb\u53d6\u8fc7\u7a0b\u4e2d\uff0c\u53e6\u5916\u4e00\u4e2a\u7ebf\u7a0b\u5220\u9664\u4e00\u4e2a\u8282\u70b9\u3002\u5220\u9664\u7ebf\u7a0b\u53ef\u4ee5\u628a\u8fd9\u4e2a\u8282\u70b9\u4ece\u94fe\u8868\u4e2d\u79fb\u9664\uff0c\u4f46\u5b83\u4e0d\u80fd\u76f4\u63a5\u9500\u6bc1\u8fd9\u4e2a\u8282\u70b9\uff0c\u5fc5\u987b\u7b49\u5230\u6240\u6709\u7684\u8bfb\u53d6\u7ebf\u7a0b\u8bfb\u53d6\u5b8c\u6210\u4ee5\u540e\uff0c\u624d\u8fdb\u884c\u9500\u6bc1\u64cd\u4f5c\u3002</p> <ul> <li>\u5bbd\u9650\u671f\u7684\u610f\u4e49\u662f\uff0c\u5728\u4e00\u4e2a\u5220\u9664\u52a8\u4f5c\u53d1\u751f\u540e\uff0c\u5b83\u5fc5\u987b\u7b49\u5f85\u6240\u6709\u5728\u5bbd\u9650\u671f\u5f00\u59cb\u524d\u5df2\u7ecf\u5f00\u59cb\u7684\u8bfb\u7ebf\u7a0b\u7ed3\u675f\uff0c\u624d\u53ef\u4ee5\u8fdb\u884c\u9500\u6bc1\u64cd\u4f5c</li> </ul>"},{"location":"code_guide/data_structure/list.html#api","title":"API","text":"<ul> <li><code>rcu_read_lock</code>\u548c<code>rcu_read_unlock</code>\u5fc5\u987b\u662f\u6210\u5bf9\u51fa\u73b0\u7684\uff0c\u5e76\u4e14<code>synchronize_rcu</code>\u4e0d\u80fd\u51fa\u73b0\u5728<code>rcu_read_lock</code>\u548c<code>rcu_read_unlock</code>\u4e4b\u95f4\uff1b</li> </ul> <pre><code>// lock, unlock \u5e2e\u52a9\u68c0\u6d4b\u5bbd\u9650\u671f\u662f\u5426\u7ed3\u675f\n#define rcu_read_lock() __rcu_read_lock()\n#define rcu_read_unlock() __rcu_read_unlock()\n#define __rcu_read_lock() \n    do { \n        preempt_disable(); \n        __acquire(RCU); \n        rcu_read_acquire(); \n    } while (0)\n\n#define __rcu_read_unlock() \n    do { \n        rcu_read_release(); \n        __release(RCU); \n        preempt_enable(); \n    } while (0)\n</code></pre> <ul> <li>RCU\u540c\u65f6\u53ea\u5141\u8bb8\u4e00\u4e2a<code>synchronize_rcu</code>\u64cd\u4f5c\uff0c\u6240\u4ee5\u9700\u8981\u6211\u4eec\u81ea\u5df1\u6765\u5b9e\u73b0synchronize_rcu\u7684\u6392\u5b83\u9501\u64cd\u4f5c\uff1b</li> </ul> <pre><code>// \u8c03\u7528\u8be5\u51fd\u6570\u610f\u5473\u7740\u4e00\u4e2a\u5bbd\u9650\u671f\u7684\u5f00\u59cb\uff0c\u800c\u76f4\u5230\u5bbd\u9650\u671f\u7ed3\u675f\uff0c\u8be5\u51fd\u6570\u624d\u4f1a\u8fd4\u56de\n// \u901a\u8fc7\u963b\u585e\u6765\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u76f4\u5230\u6240\u6709cpu\u4e0a\u6240\u6709\u9884\u5148\u5b58\u5728\u7684RCU\u8bfb\u7aef\u4e34\u754c\u533a\u90fd\u5b8c\u6210\nsynchronize_rcu()\n</code></pre> <ul> <li><code>rcu_assign_pointer</code>\u4fee\u6539\u65e7\u6570\u636e\u7684\u6307\u9488\uff1b</li> </ul> <pre><code>// \u65b0\u6570\u636e\n#define rcu_assign_pointer(p, v) __rcu_assign_pointer((p), (v), __rcu)\n\n#define __rcu_assign_pointer(p, v, space) \n    do { \n        smp_wmb();  // \u5185\u5b58\u5c4f\u853d\u969c\n\n        (p) = (typeof(*v) __force space *)(v); \n    } while (0)\n</code></pre> <ul> <li></li> </ul> <pre><code>// \u7528\u4e8e\u8bfb\u4e34\u754c\u533a\nrcu_dereference\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>rcu_read_lock();\nlist_for_each_entry_rcu(pos, head, member) {\n    // do something with `pos`\n}\nrcu_read_unlock();\n\n/* p \u6307\u5411\u4e00\u5757\u53d7 RCU \u4fdd\u62a4\u7684\u5171\u4eab\u6570\u636e */\n/* reader */\nrcu_read_lock();\np1 = rcu_dereference(p);\nif (p1 != NULL) {\n    printk(\"%d\\n\", p1-&gt;field);\n}\nrcu_read_unlock();\n\n/* free the memory */\np2 = p;\nif (p2 != NULL) {\n    p = NULL;\n    synchronize_rcu();\n    kfree(p2);\n}\n</code></pre>"},{"location":"code_guide/data_structure/ping_pong_buffer.html","title":"Ping pong buffer","text":""},{"location":"code_guide/data_structure/ping_pong_buffer.html#ping-pong-buffer","title":"Ping-Pong Buffer","text":"<p>ping-pong buffer \u4e5f\u53eb\u53cc\u7f13\u5b58 double buffer\uff0c(\u5fc5\u987b\u662f\u4e24\u4e2a) \u5c31\u662f\u4e00\u4e2a\u7f13\u5b58\u5728\u5199\u5165\u7684\u65f6\u5019\uff0c\u53e6\u4e00\u4e2a\u7f13\u5b58\u540c\u65f6\u5728\u5904\u7406\u7684\u7ed3\u6784\u3002</p> <ul> <li> <p>\u6700\u5e38\u89c1\u7684\u4f8b\u5b50\u662f\u663e\u793a\u7f13\u5b58\u53ef\u4ee5\u7528 ping-pong buffer \u7ed3\u6784, \u7528\u4e24\u4e2a\u76f8\u540c\u7684\u5e27\u5b58\u50a8\u5668 frame buffers, \u5f53\u4e00\u4e2a\u5728\u626b\u63cf\u8f93\u51fa\u7684\u65f6\u5019\uff0c\u53e6\u4e00\u4e2a\u5728\u6539\u5199\u6570\u636e\u3002\u5230\u4e0b\u4e00\u4e2a\u5468\u671f\u6539\u5199\u597d\u6570\u636e\u7684\u4e00\u5e27\u4f5c\u626b\u63cf\u8f93\u51fa,\uff0c\u800c\u53e6\u4e00\u4e2a\u5e27\u7f13\u5b58\u6539\u5199\u6570\u636e\u3002\u603b\u4e4b\u662f\u4e00\u4e2a\u5728\u63a5\u6536\u6570\u636e\u4e00\u4e2a\u5728\u5904\u7406\uff0c\u5904\u7406\u5b8c\u540e\u4e24\u4e2a\u518d\u4ea4\u6362\u3002</p> </li> <li> <p>\u5b58\u5728\u5199\u963b\u585e\u95ee\u9898\uff0c\u6240\u4ee5\u4e00\u822c\u7528\u4e8e\u201c\u4e00\u5199\u591a\u8bfb\u201d\u914d\u7f6e\u70ed\u66f4\u65b0\u573a\u666f\uff0c\u4e14\u5199\u7ebf\u7a0b\u5f80\u5f80\u662f\u5f02\u6b65\u7684\u5bf9\u963b\u585e\u65f6\u957f\u5bb9\u5fcd\u5ea6\u9ad8\u3002</p> </li> </ul>"},{"location":"code_guide/data_structure/ping_pong_buffer.html#_1","title":"\u53cc\u7f13\u51b2\u961f\u5217","text":"<p>\u5728\u670d\u52a1\u5668\u5f00\u53d1\u4e2d \u901a\u5e38\u7684\u505a\u6cd5\u662f\u628a\u903b\u8f91\u5904\u7406\u7ebf\u7a0b\u548cIO\u5904\u7406\u7ebf\u7a0b\u5206\u79bb\u3002 </p> <ul> <li>I/O \u5904\u7406\u7ebf\u7a0b\u8d1f\u8d23\u7f51\u7edc\u6570\u636e\u7684\u53d1\u9001\u548c\u63a5\u6536\uff0c\u8fde\u63a5\u7684\u5efa\u7acb\u548c\u7ef4\u62a4\u3002 </li> <li>\u903b\u8f91\u5904\u7406\u7ebf\u7a0b\u5904\u7406\u4eceIO\u7ebf\u7a0b\u63a5\u6536\u5230\u7684\u5305\u3002</li> </ul> <p>\u901a\u5e38\u903b\u8f91\u5904\u7406\u7ebf\u7a0b\u548cIO\u5904\u7406\u7ebf\u7a0b\u662f\u901a\u8fc7\u6570\u636e\u961f\u5217\u6765\u4ea4\u6362\u6570\u636e\uff0c\u5c31\u662f\u751f\u4ea7\u8005--\u6d88\u8d39\u8005\u6a21\u578b\u3002</p> <p>\u53cc\u7f13\u51b2\u6570\u636e\u5c31\u662f\u4e24\u4e2a\u961f\u5217\uff1a\u4e00\u4e2a\u8d1f\u8d23\u4ece\u91cc\u5199\u5165\u6570\u636e\uff0c\u4e00\u4e2a\u8d1f\u8d23\u8bfb\u53d6\u6570\u636e\u3002\u5f53\u903b\u8f91\u7ebf\u7a0b\u8bfb\u5b8c\u6570\u636e\u540e\u8d1f\u8d23\u5c06\u81ea\u5df1\u7684\u961f\u5217\u548cIO\u7ebf\u7a0b\u7684\u961f\u5217\u8fdb\u884c\u4ea4\u6362\u3002</p> <p>\u8fd9\u79cd\u64cd\u4f5c\u9700\u8981\u5728\u4e24\u4e2a\u5730\u65b9\u52a0\u9501\uff1a</p> <ul> <li>IO\u7ebf\u7a0b\u5411\u961f\u5217\u5199\u5165\u6570\u636e\u3002</li> <li>\u4e24\u4e2a\u961f\u5217\u8fdb\u884c\u4ea4\u6362\u65f6\u3002</li> </ul> <p>\u53cc\u7f13\u51b2\u533a\u8282\u7701\u4e86\u5355\u7f13\u51b2\u533a\u65f6\u8bfb\u90e8\u5206\u64cd\u4f5c\u4e92\u65a5/\u540c\u6b65\u7684\u5f00\u9500\u3002</p> <p>\u4e24\u4e2a\u7f13\u51b2\u533a\u5206\u522b\u5bf9\u5e94\u7740\u4e24\u4e2a\u4e92\u65a5\u9501LockA\uff0cLockB\u3002</p>"},{"location":"code_guide/data_structure/queue.html","title":"\u961f\u5217","text":""},{"location":"code_guide/data_structure/queue.html#_2","title":"\u5e76\u53d1\u961f\u5217","text":"<p>\u5355\u4e2a\u751f\u4ea7-\u6d88\u8d39\u8005\u961f\u5217\uff0c\u53ef\u4ee5\u901a\u8fc7\u5185\u5b58\u5c4f\u969c\uff08Java volatile\uff09\u5b9e\u73b0\uff0c\u800c\u4e0d\u9700\u8981CAS\u548c\u9501\u3002</p>"},{"location":"code_guide/data_structure/queue.html#_3","title":"\u9501\u7684\u4ee3\u4ef7","text":"<p>\u81ea\u589e 64-bit \u4f4d\u8ba1\u6570\u5668 500,000,000 \u6b21\uff0c\u4e0d\u540c\u5b9e\u73b0\u7684\u6027\u80fd\u3002</p> Method Time (ms) Single thread 32 Single thread with lock 8200 Two threads with lock 44,000 Single thread with CAS 2,700 Two threads with CAS 11,000 Single thread with volatile write 2,700"},{"location":"code_guide/data_structure/queue.html#cas","title":"CAS\u4ee3\u4ef7","text":"<p>CAS\u65b9\u6cd5\u6bd4\u9501\u6709\u6548\u5f97\u591a\uff0c\u56e0\u4e3a\u5b83\u4e0d\u9700\u8981\u5207\u6362\u5230\u5185\u6838\u8fdb\u884c\u4ef2\u88c1\u3002\u9501\u5b9a\u5b83\u7684\u6307\u4ee4\u7ba1\u9053\u4ee5\u786e\u4fdd\u539f\u5b50\u6027\uff0c\u5e76\u4f7f\u7528\u5185\u5b58\u5c4f\u969c\u4f7f\u66f4\u6539\u5bf9\u5176\u4ed6\u7ebf\u7a0b\u53ef\u89c1\u3002</p> <p>\u5982\u679c\u7a0b\u5e8f\u7684\u5173\u952e\u90e8\u5206\u6bd4\u8ba1\u6570\u5668\u7684\u7b80\u5355\u589e\u91cf\u66f4\u590d\u6742\uff0c\u5219\u53ef\u80fd\u9700\u8981\u4f7f\u7528\u4f7f\u7528\u591a\u4e2aCAS\u64cd\u4f5c\u7684\u590d\u6742\u72b6\u6001\u673a\u6765\u7f16\u6392\u4e89\u7528\u3002</p>"},{"location":"code_guide/data_structure/queue.html#_4","title":"\u5185\u5b58\u5c4f\u969c","text":"<p>\u73b0\u4ee3\u5904\u7406\u5668\u6267\u884c\u6307\u4ee4\u7684\u4e71\u5e8f\u6267\u884c\u4ee5\u53ca\u5185\u5b58\u548c\u6267\u884c\u5355\u5143\u4e4b\u95f4\u7684\u4e71\u5e8f\u52a0\u8f7d\u548c\u6570\u636e\u5b58\u50a8\uff0c\u5904\u7406\u5668\u53ea\u9700\u8981\u4fdd\u8bc1\u4e0d\u7ba1\u6267\u884c\u987a\u5e8f\u5982\u4f55\uff0c\u7a0b\u5e8f\u903b\u8f91\u90fd\u4f1a\u4ea7\u751f\u76f8\u540c\u7684\u7ed3\u679c\u3002</p> <p>cpu\u4f7f\u7528\u590d\u6742\u7684\u9ad8\u901f\u7f13\u5b58\u7cfb\u7edf\uff0c\u7f13\u5b58\u901a\u8fc7\u6d88\u606f\u4f20\u9012\u534f\u8bae\u4e0e\u5176\u4ed6\u5904\u7406\u5668\u7f13\u5b58\u7cfb\u7edf\u4fdd\u6301\u4e00\u81f4\u3002\u5904\u7406\u5668\u6709\u201c\u5b58\u50a8\u7f13\u51b2\u533a\u201d\u6765\u5378\u8f7d\u5bf9\u8fd9\u4e9b\u7f13\u5b58\u7684\u5199\u64cd\u4f5c\uff0c\u5e76\u201c\u4f7f\u961f\u5217\u5931\u6548\u201d\u3002</p> <p>\u5bf9\u4e8e\u6570\u636e\u6765\u8bf4\uff0c\u8fd9\u610f\u5473\u7740\u4efb\u4f55\u503c\u7684\u6700\u65b0\u7248\u672c\uff0c\u5728\u5199\u5165\u540e\u7684\u4efb\u4f55\u9636\u6bb5\uff0c\u90fd\u53ef\u4ee5\u5728\u5bc4\u5b58\u5668\u3001\u5b58\u50a8\u7f13\u51b2\u533a\u3001\u591a\u5c42\u7f13\u5b58\u4e2d\u7684\u4e00\u4e2a\u6216\u4e3b\u5b58\u4e2d\u3002</p> <p>\u5982\u679c\u7ebf\u7a0b\u8981\u5171\u4eab\u8fd9\u4e2a\u503c\uff0c\u5c31\u9700\u8981\u4ee5\u6709\u5e8f\u7684\u65b9\u5f0f\u4f7f\u5176\u53ef\u89c1\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u7f13\u5b58\u4e00\u81f4\u6027\u6d88\u606f\u7684\u534f\u8c03\u4ea4\u6362\u6765\u5b9e\u73b0\u3002\u8fd9\u4e9b\u6d88\u606f\u7684\u53ca\u65f6\u751f\u6210\u53ef\u4ee5\u901a\u8fc7\u5185\u5b58\u5c4f\u969c\u6765\u63a7\u5236\u3002</p> <p>A read memory barrier orders load instructions on the CPU that executes it by marking a point in the invalidate queue for changes coming into its cache. This gives it a consistent view of the world for write operations ordered before the read barrier.</p> <p>A write barrier orders store instructions on the CPU that executes it by marking a point in the store buffer, thus flushing writes out via its cache. This barrier gives an ordered view to the world of what store operations happen before the write barrier.</p> <p>A full memory barrier orders both loads and stores but only on the CPU that executes it.</p> <p>\u5728Java\u5185\u5b58\u6a21\u578b\u4e2d(\u4eceJava 5\u5f00\u59cb)\uff0cvolatile\u5b57\u6bb5\u7684\u8bfb\u548c\u5199\u5206\u522b\u5b9e\u73b0\u4e86\u8bfb\u548c\u5199\u5c4f\u969c\u3002</p>"},{"location":"code_guide/data_structure/queue.html#_5","title":"\u7f13\u5b58\u884c","text":""},{"location":"code_guide/data_structure/queue.html#_6","title":"\u4f2a\u5171\u4eab","text":"<p>\u4e3a\u4e86\u63d0\u9ad8\u6548\u7387\uff0c\u7f13\u5b58\u88ab\u7ec4\u7ec7\u6210\u5927\u5c0f\u901a\u5e38\u4e3a32-256\u5b57\u8282\u7684\u7f13\u5b58\u884c\uff0c\u6700\u5e38\u89c1\u7684\u7f13\u5b58\u884c\u662f64\u5b57\u8282\u3002\u8fd9\u662f\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u64cd\u4f5c\u7684\u7c92\u5ea6\u7ea7\u522b\u3002</p> <p>\u5982\u679c\u4e24\u4e2a\u53d8\u91cf\u5728\u540c\u4e00\u7f13\u5b58\u884c\u4e2d\uff0c\u5e76\u4e14\u5b83\u4eec\u88ab\u4e0d\u540c\u7684\u7ebf\u7a0b\u5199\u5165\uff0c\u90a3\u4e48\u5b83\u4eec\u5c31\u4f1a\u50cf\u5355\u4e2a\u53d8\u91cf\u4e00\u6837\u51fa\u73b0\u5199\u4e89\u7528\u7684\u95ee\u9898\u3002</p> <p>\u5982\u679c\u8981\u5c3d\u91cf\u51cf\u5c11\u4e89\u7528\uff0c\u786e\u4fdd\u72ec\u7acb\u4f46\u5e76\u53d1\u5199\u5165\u7684\u53d8\u91cf\u4e0d\u5171\u4eab\u76f8\u540c\u7684\u7f13\u5b58\u884c\u662f\u5f88\u91cd\u8981\u7684\u3002</p> <p>\u5728jdk1.8\u4e2d\uff0c\u6709\u4e13\u95e8\u7684\u6ce8\u89e3@Contended\u6765\u907f\u514d\u4f2a\u5171\u4eab\uff0c\u66f4\u4f18\u96c5\u5730\u89e3\u51b3\u95ee\u9898\u3002</p>"},{"location":"code_guide/data_structure/queue.html#_7","title":"\u961f\u5217\u7684\u95ee\u9898","text":"<p>\u4e00\u822c\u6765\u8bf4\uff0c\u961f\u5217\u662f\u88ab\u9650\u5236\u4e3a\u6709\u9650\u961f\u5217\uff0c\u9632\u6b62\u51fa\u73b0\u707e\u96be\u6027\u7684\u5f02\u5e38\u3002</p> <p>\u961f\u5217\u5b9e\u73b0\u5f80\u5f80\u5728\u5934\u90e8\uff08head\uff09\u3001\u5c3e\u90e8\uff08tail\uff09\u548c\u5927\u5c0f\u53d8\u91cf\uff08size\uff09\u4e0a\u5b58\u5728\u5199\u4e89\u7528\u3002</p> <p>\u961f\u5217\u5728\u4f7f\u7528\u7684\u65f6\u5019\uff0c\u5f80\u5f80\u662f\u7a7a\u7684\u6216\u8005\u6ee1\u7684\uff0c\u5f88\u5c11\u5728\u751f\u4ea7\u548c\u6d88\u8d39\u901f\u5ea6\u76f8\u7b49\u7684\u5e73\u8861\u4e2d\u95f4\u5730\u5e26\u8fd0\u4f5c\u3002</p> <p>\u5373\u4f7f\u4f7f\u7528\u4e0d\u540c\u7684\u5e76\u53d1\u5bf9\u8c61(\u5982\u9501\u6216CAS\u53d8\u91cf)\u5c06\u5934\u90e8\u548c\u5c3e\u90e8\u673a\u5236\u5206\u79bb\uff0c\u5b83\u4eec\u901a\u5e38\u4e5f\u4f1a\u5360\u7528\u76f8\u540c\u7684\u7f13\u5b58\u884c\u3002</p>"},{"location":"code_guide/data_structure/queue.html#java","title":"Java\u5185\u7f6e\u961f\u5217","text":"\u961f\u5217 \u6709\u754c\u6027 \u9501 \u6570\u636e\u7ed3\u6784 ArrayBlockingQueue bounded \u52a0\u9501 arraylist LinkedBlockingQueue optionally-bounded \u52a0\u9501 linkedlist ConcurrentLinkedQueue unbounded \u65e0\u9501\uff08CAS\uff09 linkedlist LinkedTransferQueue unbounded \u65e0\u9501\uff08CAS\uff09 linkedlist PriorityBlockingQueue unbounded \u52a0\u9501 heap DelayQueue unbounded \u52a0\u9501 heap"},{"location":"code_guide/data_structure/queue.html#lamx-disruptor","title":"LAMX Disruptor","text":"<p>High Performance Inter-Thread Messaging Library.</p> <p>\u8bbe\u8ba1\u76ee\u6807\uff1amaximize the efficiency of memory allocation, and operate in a cache-friendly manner.</p> <p>\u6838\u5fc3\u5b9e\u73b0\uff1apre-allocated bounded data structure in the form of a ring-buffer.</p>"},{"location":"code_guide/data_structure/queue.html#_8","title":"\u5185\u5b58\u5206\u914d","text":"<p>\u6240\u6709\u7528\u4e8e\u73af\u7f13\u51b2\u533a\uff08ring-buffer\uff09\u7684\u5185\u5b58\u90fd\u662f\u5728\u542f\u52a8\u65f6\u9884\u5148\u5206\u914d\u3002</p> <ul> <li>\u8fd9\u79cd\u9884\u5206\u914d\u6761\u76ee\u6d88\u9664\u4e86\u652f\u6301\u5783\u573e\u6536\u96c6\u7684\u8bed\u8a00\u4e2d\u7684\u95ee\u9898\uff0c\u56e0\u4e3a\u6761\u76ee\u5c06\u88ab\u91cd\u7528\uff0c\u5e76\u4e14\u5728Disruptor\u5b9e\u4f8b\u7684\u6301\u7eed\u65f6\u95f4\u5185\u5b58\u5728\uff1b</li> <li>\u6761\u76ee\u7684\u5185\u5b58\u662f\u540c\u65f6\u5206\u914d\u7684\uff0c\u5f88\u6709\u53ef\u80fd\u5728\u4e3b\u5b58\u4e2d\u8fde\u7eed\u5206\u5e03\uff0c\u4ece\u800c\u652f\u6301cache striding\uff1b</li> <li>value types: Java\u5f15\u5165\uff0c\u652f\u6301arrays of tuples\uff0c\u4fdd\u8bc1\u5185\u5b58\u53ef\u4ee5\u6301\u7eed\u5206\u914d\uff0c\u907f\u514d\u95f4\u63a5\u6307\u9488\u3002</li> </ul>"},{"location":"code_guide/data_structure/queue.html#_9","title":"\u4f18\u5316\u65b9\u6cd5","text":"<p>\u5728\u5927\u591a\u6570\u5904\u7406\u5668\u4e0a\uff0c\u5bf9\u5e8f\u5217\u53f7\u8fdb\u884c\u53d6\u4f59\u8ba1\u7b97\u7684\u6210\u672c\u975e\u5e38\u9ad8\uff1a</p> <ul> <li>\u901a\u8fc7\u8bbe\u7f6ering-size\u4e3a2\u7684\u5e42\u6b21\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f4d\u64cd\u4f5c\u8ba1\u7b97\u53d6\u4f59\uff1b</li> <li>\u4e0b\u6807\u91c7\u53d6\u9012\u589e\u7684\u5f62\u5f0f\u3002\u4e0d\u7528\u62c5\u5fc3index\u6ea2\u51fa\u7684\u95ee\u9898\u3002index\u662flong\u7c7b\u578b\uff0c\u5373\u4f7f100\u4e07QPS\u7684\u5904\u7406\u901f\u5ea6\uff0c\u4e5f\u9700\u898130\u4e07\u5e74\u624d\u80fd\u7528\u5b8c\u3002</li> </ul> <p>\u6bcf\u4e2a\u751f\u4ea7\u8005\u6216\u8005\u6d88\u8d39\u8005\u7ebf\u7a0b\uff0c\u4f1a\u5148\u7533\u8bf7\u53ef\u4ee5\u64cd\u4f5c\u7684\u5143\u7d20\u5728\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\uff0c\u7533\u8bf7\u5230\u4e4b\u540e\uff0c\u76f4\u63a5\u5728\u8be5\u4f4d\u7f6e\u5199\u5165\u6216\u8005\u8bfb\u53d6\u6570\u636e\u3002</p> <p>\u751f\u4ea7\u8005\u5c06\u76f8\u4e92\u7ade\u4e89\u6765\u58f0\u660e\u73af\u7f13\u51b2\u533a\u4e2d\u7684\u4e0b\u4e00\u4e2a\u6761\u76ee\uff1a</p> <ul> <li>\u901a\u8fc7 CAS \u64cd\u4f5c\u6765\u7ba1\u7406\u58f0\u660e\u4e0b\u4e00\u4e2a\u53ef\u7528\u6761\u76ee\u7684\u4e89\u7528\u3002</li> </ul> <p>\u6d88\u8d39\u8005\u5728\u8bfb\u53d6\u8be5\u6761\u76ee\u4e4b\u524d\uff0c\u8981\u7b49\u5f85\u4e00\u4e2a\u5e8f\u5217\u5728\u73af\u7f13\u51b2\u533a\u4e2d\u53ef\u7528\uff0c\u5728\u7b49\u5f85\u7684\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u4f7f\u7528\u5404\u79cd\u7b56\u7565\uff1a</p> <ul> <li>\u5982\u679cCPU\u8d44\u6e90\u5f88\u5b9d\u8d35\uff0c\u5b83\u4eec\u53ef\u4ee5\u7b49\u5f85\u4e00\u4e2a\u9501\u5185\u7684\u6761\u4ef6\u53d8\u91cf\uff0c\u8fd9\u4e2a\u9501\u7531\u751f\u4ea7\u8005\u53d1\u51fa\u4fe1\u53f7\uff1b</li> <li>\u53ef\u4ee5\u5faa\u73af\u68c0\u67e5\u8868\u793a\u73af\u7f13\u51b2\u533a\u4e2d\u5f53\u524d\u53ef\u7528\u5e8f\u5217\u7684\u6e38\u6807\u3002</li> </ul> <p>\u6ca1\u6709\u9501\u7684\u591a\u751f\u4ea7\u8005-\u591a\u6d88\u8d39\u8005\u961f\u5217\u786e\u5b9e\u5b58\u5728\uff0c\u4f46\u5b83\u4eec\u9700\u8981\u5bf9\u5934\u90e8\u3001\u5c3e\u90e8\u548c\u5927\u5c0f\u8ba1\u6570\u5668\u8fdb\u884c\u591a\u4e2aCAS\u64cd\u4f5c\uff0cDisruptor\u5e76\u6ca1\u6709\u4f7f\u7528\u3002</p>"},{"location":"code_guide/data_structure/queue.html#_10","title":"\u5b9e\u73b0","text":""},{"location":"code_guide/data_structure/queue.html#_11","title":"\u591a\u4e2a\u751f\u4ea7\u8005","text":"<p>\u9047\u5230\u201c\u5982\u4f55\u9632\u6b62\u591a\u4e2a\u7ebf\u7a0b\u91cd\u590d\u5199\u540c\u4e00\u4e2a\u5143\u7d20\u201d\u7684\u95ee\u9898</p> <ul> <li>\u6bcf\u4e2a\u7ebf\u7a0b\u83b7\u53d6\u4e0d\u540c\u7684\u4e00\u6bb5\u6570\u7ec4\u7a7a\u95f4\u8fdb\u884c\u64cd\u4f5c\u3002\u5728\u5206\u914d\u5143\u7d20\u7684\u65f6\u5019\uff0c\u901a\u8fc7CAS\u5224\u65ad\u4e00\u4e0b\u8fd9\u6bb5\u7a7a\u95f4\u662f\u5426\u5df2\u7ecf\u5206\u914d\u51fa\u53bb\u5373\u53ef\u3002</li> </ul> <p>\u5982\u4f55\u9632\u6b62\u8bfb\u53d6\u7684\u65f6\u5019\uff0c\u8bfb\u5230\u8fd8\u672a\u5199\u7684\u5143\u7d20\u3002</p> <ul> <li>\u5f15\u5165\u4e00\u4e2a\u4e0eRing Buffer\u5927\u5c0f\u76f8\u540c\u7684buffer\uff1aAvailable Buffer\u3002\u5f53\u67d0\u4e2a\u4f4d\u7f6e\u5199\u5165\u6210\u529f\u7684\u65f6\u5019\uff0c\u4fbf\u628aAvailable Buffer\u76f8\u5e94\u7684\u4f4d\u7f6e\u7f6e\u4f4d\uff0c\u6807\u8bb0\u4e3a\u5199\u5165\u6210\u529f\u3002\u8bfb\u53d6\u7684\u65f6\u5019\uff0c\u4f1a\u904d\u5386available Buffer\uff0c\u6765\u5224\u65ad\u5143\u7d20\u662f\u5426\u5df2\u7ecf\u5c31\u7eea\u3002</li> </ul>"},{"location":"code_guide/data_structure/queue.html#_12","title":"\u8bfb\u6570\u636e","text":"<p>\u751f\u4ea7\u8005\u591a\u7ebf\u7a0b\u5199\u5165\u7684\u60c5\u51b5\u4f1a\u590d\u6742\u5f88\u591a\uff1a</p> <ol> <li>\u7533\u8bf7\u8bfb\u53d6\u5230\u5e8f\u53f7n\uff1b</li> <li>\u82e5writer cursor &gt;= n\uff0c\u8fd9\u65f6\u4ecd\u7136\u65e0\u6cd5\u786e\u5b9a\u8fde\u7eed\u53ef\u8bfb\u7684\u6700\u5927\u4e0b\u6807\u3002\u4ecereader cursor\u5f00\u59cb\u8bfb\u53d6available Buffer\uff0c\u4e00\u76f4\u67e5\u5230\u7b2c\u4e00\u4e2a\u4e0d\u53ef\u7528\u7684\u5143\u7d20\uff0c\u7136\u540e\u8fd4\u56de\u6700\u5927\u8fde\u7eed\u53ef\u8bfb\u5143\u7d20\u7684\u4f4d\u7f6e\uff1b</li> <li>\u6d88\u8d39\u8005\u8bfb\u53d6\u5143\u7d20\u3002</li> </ol> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u8bfb\u7ebf\u7a0b\u8bfb\u5230\u4e0b\u6807\u4e3a2\u7684\u5143\u7d20\uff0c\u4e09\u4e2a\u7ebf\u7a0bWriter1/Writer2/Writer3\u6b63\u5728\u5411RingBuffer\u76f8\u5e94\u4f4d\u7f6e\u5199\u6570\u636e\uff0c\u5199\u7ebf\u7a0b\u88ab\u5206\u914d\u5230\u7684\u6700\u5927\u5143\u7d20\u4e0b\u6807\u662f11\u3002</p> <p>\u8bfb\u7ebf\u7a0b\u7533\u8bf7\u8bfb\u53d6\u5230\u4e0b\u6807\u4ece3\u523011\u7684\u5143\u7d20\uff0c\u5224\u65adwriter cursor&gt;=11\u3002\u7136\u540e\u5f00\u59cb\u8bfb\u53d6availableBuffer\uff0c\u4ece3\u5f00\u59cb\uff0c\u5f80\u540e\u8bfb\u53d6\uff0c\u53d1\u73b0\u4e0b\u6807\u4e3a7\u7684\u5143\u7d20\u6ca1\u6709\u751f\u4ea7\u6210\u529f\uff0c\u4e8e\u662fWaitFor(11)\u8fd4\u56de6\u3002</p> <p>\u7136\u540e\uff0c\u6d88\u8d39\u8005\u8bfb\u53d6\u4e0b\u6807\u4ece3\u52306\u5171\u8ba14\u4e2a\u5143\u7d20\u3002</p> <p></p>"},{"location":"code_guide/data_structure/queue.html#_13","title":"\u5199\u6570\u636e","text":"<p>\u591a\u4e2a\u751f\u4ea7\u8005\u5199\u5165\u7684\u65f6\u5019\uff1a</p> <ol> <li>\u7533\u8bf7\u5199\u5165m\u4e2a\u5143\u7d20\uff1b</li> <li>\u82e5\u662f\u6709m\u4e2a\u5143\u7d20\u53ef\u4ee5\u5199\u5165\uff0c\u5219\u8fd4\u56de\u6700\u5927\u7684\u5e8f\u5217\u53f7\u3002\u6bcf\u4e2a\u751f\u4ea7\u8005\u4f1a\u88ab\u5206\u914d\u4e00\u6bb5\u72ec\u4eab\u7684\u7a7a\u95f4\uff1b</li> <li>\u751f\u4ea7\u8005\u5199\u5165\u5143\u7d20\uff0c\u5199\u5165\u5143\u7d20\u7684\u540c\u65f6\u8bbe\u7f6eavailable Buffer\u91cc\u9762\u76f8\u5e94\u7684\u4f4d\u7f6e\uff0c\u4ee5\u6807\u8bb0\u81ea\u5df1\u54ea\u4e9b\u4f4d\u7f6e\u662f\u5df2\u7ecf\u5199\u5165\u6210\u529f\u7684\u3002</li> </ol> <p>\u5982\u4e0b\u56fe\u6240\u793a\uff0cWriter1\u548cWriter2\u4e24\u4e2a\u7ebf\u7a0b\u5199\u5165\u6570\u7ec4\uff0c\u90fd\u7533\u8bf7\u53ef\u5199\u7684\u6570\u7ec4\u7a7a\u95f4\u3002Writer1\u88ab\u5206\u914d\u4e86\u4e0b\u68073\u5230\u4e0b\u88685\u7684\u7a7a\u95f4\uff0cWriter2\u88ab\u5206\u914d\u4e86\u4e0b\u68076\u5230\u4e0b\u68079\u7684\u7a7a\u95f4\u3002</p> <p>Writer1\u5199\u5165\u4e0b\u68073\u4f4d\u7f6e\u7684\u5143\u7d20\uff0c\u540c\u65f6\u628aavailable Buffer\u76f8\u5e94\u4f4d\u7f6e\u7f6e\u4f4d\uff0c\u6807\u8bb0\u5df2\u7ecf\u5199\u5165\u6210\u529f\uff0c\u5f80\u540e\u79fb\u4e00\u4f4d\uff0c\u5f00\u59cb\u5199\u4e0b\u68074\u4f4d\u7f6e\u7684\u5143\u7d20\u3002Writer2\u540c\u6837\u7684\u65b9\u5f0f\u3002\u6700\u7ec8\u90fd\u5199\u5165\u5b8c\u6210\u3002</p> <p></p>"},{"location":"code_guide/data_structure/queue.html#_14","title":"\u7b49\u5f85\u7b56\u7565","text":""},{"location":"code_guide/data_structure/queue.html#_15","title":"\u751f\u4ea7\u8005\u7684\u7b49\u5f85\u7b56\u7565","text":"<p>\u6682\u65f6\u53ea\u6709\u4f11\u77201ns\u3002</p> <pre><code>LockSupport.parkNanos(1);\n</code></pre>"},{"location":"code_guide/data_structure/queue.html#_16","title":"\u6d88\u8d39\u8005\u7684\u7b49\u5f85\u7b56\u7565","text":"\u540d\u79f0 \u63aa\u65bd \u9002\u7528\u573a\u666f BlockingWaitStrategy \u52a0\u9501 CPU\u8d44\u6e90\u7d27\u7f3a\uff0c\u541e\u5410\u91cf\u548c\u5ef6\u8fdf\u5e76\u4e0d\u91cd\u8981\u7684\u573a\u666f BusySpinWaitStrategy \u81ea\u65cb \u901a\u8fc7\u4e0d\u65ad\u91cd\u8bd5\uff0c\u51cf\u5c11\u5207\u6362\u7ebf\u7a0b\u5bfc\u81f4\u7684\u7cfb\u7edf\u8c03\u7528\uff0c\u800c\u964d\u4f4e\u5ef6\u8fdf\u3002\u63a8\u8350\u5728\u7ebf\u7a0b\u7ed1\u5b9a\u5230\u56fa\u5b9a\u7684CPU\u7684\u573a\u666f\u4e0b\u4f7f\u7528 PhasedBackoffWaitStrategy \u81ea\u65cb + yield + \u81ea\u5b9a\u4e49\u7b56\u7565 CPU\u8d44\u6e90\u7d27\u7f3a\uff0c\u541e\u5410\u91cf\u548c\u5ef6\u8fdf\u5e76\u4e0d\u91cd\u8981\u7684\u573a\u666f SleepingWaitStrategy \u81ea\u65cb + yield + sleep \u6027\u80fd\u548cCPU\u8d44\u6e90\u4e4b\u95f4\u6709\u5f88\u597d\u7684\u6298\u4e2d\u3002\u5ef6\u8fdf\u4e0d\u5747\u5300 TimeoutBlockingWaitStrategy \u52a0\u9501\uff0c\u6709\u8d85\u65f6\u9650\u5236 CPU\u8d44\u6e90\u7d27\u7f3a\uff0c\u541e\u5410\u91cf\u548c\u5ef6\u8fdf\u5e76\u4e0d\u91cd\u8981\u7684\u573a\u666f YieldingWaitStrategy \u81ea\u65cb + yield + \u81ea\u65cb \u6027\u80fd\u548cCPU\u8d44\u6e90\u4e4b\u95f4\u6709\u5f88\u597d\u7684\u6298\u4e2d\u3002\u5ef6\u8fdf\u6bd4\u8f83\u5747\u5300"},{"location":"code_guide/data_structure/queue.html#_17","title":"\u6848\u4f8b","text":"<p><code>Log4j 2</code>\u76f8\u5bf9\u4e8e<code>Log4j 1</code>\u6700\u5927\u7684\u4f18\u52bf\u5728\u4e8e\u591a\u7ebf\u7a0b\u5e76\u53d1\u573a\u666f\u4e0b\u6027\u80fd\u66f4\u4f18\u3002\u8be5\u7279\u6027\u6e90\u81ea\u4e8e<code>Log4j 2</code>\u7684\u5f02\u6b65\u6a21\u5f0f\u91c7\u7528\u4e86Disruptor\u6765\u5904\u7406\u3002 \u5728<code>Log4j 2</code>\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u53ef\u4ee5\u914d\u7f6eWaitStrategy\uff0c\u9ed8\u8ba4\u662fTimeout\u7b56\u7565\u3002</p>"},{"location":"code_guide/data_structure/queue.html#_18","title":"\u793a\u4f8b","text":"<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.lmax&lt;/groupId&gt;\n    &lt;artifactId&gt;disruptor&lt;/artifactId&gt;\n    &lt;version&gt;3.4.4&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u5355\u751f\u4ea7\u8005\u548c\u5355\u6d88\u8d39\u8005\u793a\u4f8b\uff1a</p> <pre><code>// Callback handler which can be implemented by consumers\nfinal BatchHandler&lt;ValueEntry&gt; batchHandler = new BatchHandler&lt;ValueEntry&gt;() {\n    public void onAvailable(final ValueEntry entry) throws Exception {\n        // process a new entry as it becomes available.\n    }\n    public void onEndOfBatch() throws Exception {\n        // useful for flushing results to an IO device if necessary.\n    }\n    public void onCompletion() {\n        // do any necessary clean up before shutdown\n    }\n};\nRingBuffer&lt;ValueEntry&gt; ringBuffer = new RingBuffer&lt;ValueEntry&gt;(ValueEntry.ENTRY_FACTORY, SIZE, ClaimStrategy.Option.SINGLE_THREADED, WaitStrategy.Option.YIELDING);\nConsumerBarrier&lt;ValueEntry&gt; consumerBarrier = ringBuffer.createConsumerBarrier();\nBatchConsumer&lt;ValueEntry&gt; batchConsumer = new BatchConsumer&lt;ValueEntry&gt;(consumerBarrier, batchHandler);\nProducerBarrier&lt;ValueEntry&gt; producerBarrier = ringBuffer.createProducerBarrier(batchConsumer);\n// Each consumer can run on a separate thread\nEXECUTOR.submit(batchConsumer);\n// Producers claim entries in sequence\nValueEntry entry = producerBarrier.nextEntry();\n// copy data into the entry container\n// make the entry available to consumers\nproducerBarrier.commit(entry);\n</code></pre>"},{"location":"code_guide/data_structure/queue.html#_19","title":"\u6027\u80fd","text":"<p>\u541e\u5410\u91cf</p> <p></p> <p>\u5ef6\u8fdf</p> <p></p> <p>loggers all async\u91c7\u7528\u7684\u662fDisruptor\uff0c\u800cAsync Appender\u91c7\u7528\u7684\u662fArrayBlockingQueue\u961f\u5217\u3002</p> <p>\u7531\u56fe\u53ef\u89c1\uff0c\u5355\u7ebf\u7a0b\u60c5\u51b5\u4e0b\uff0cloggers all async\u4e0eAsync Appender\u541e\u5410\u91cf\u76f8\u5dee\u4e0d\u5927\uff0c\u4f46\u662f\u572864\u4e2a\u7ebf\u7a0b\u7684\u65f6\u5019\uff0cloggers all async\u7684\u541e\u5410\u91cf\u6bd4Async Appender\u589e\u52a0\u4e8612\u500d\uff0c\u662fSync\u6a21\u5f0f\u768468\u500d\u3002</p> <p></p>"},{"location":"code_guide/data_structure/tree.html","title":"\u6811\u7ed3\u6784","text":"<p>\u6240\u6709\u4ee3\u7801\u5b9e\u73b0\u89c1 Java\u6570\u636e\u7ed3\u6784\u4e0e\u7b97\u6cd5</p>"},{"location":"code_guide/data_structure/tree.html#_2","title":"\u4e8c\u53c9\u6811","text":"<p>\u4e8c\u53c9\u6811\uff1a\u6bcf\u4e2a\u8282\u70b9\u6700\u591a\u53ea\u6709\u5de6\u3001\u53f3\u4e24\u4e2a\u5b50\u8282\u70b9\u3002</p> <p>\u5b8c\u5168\u4e8c\u53c9\u6811\uff1a\u53ea\u6709\u6700\u540e\u4e00\u5c42\u7684\u4e5f\u5728</p> <p>\u6811\u7684\u904d\u5386\uff1a</p> <ul> <li>\u524d\u5e8f\uff1a\u6839 -&gt; \u5de6 -&gt; \u53f3</li> <li>\u4e2d\u5e8f\uff1a\u5de6 -&gt; \u6839 -&gt; \u53f3</li> <li>\u540e\u5e8f\uff1a\u5de6 -&gt; \u6839 -&gt; \u53f3</li> </ul>"},{"location":"code_guide/data_structure/tree.html#avl","title":"AVL\u6811","text":""},{"location":"code_guide/data_structure/tree.html#huffman","title":"Huffman\u6811","text":"<p>\u7ed9\u5b9an\u4e2a\u6743\u503c\u4f5c\u4e3an\u4e2a\u53f6\u5b50\u7ed3\u70b9\uff0c\u6784\u9020\u4e00\u68f5\u4e8c\u53c9\u6811\uff0c\u82e5\u8be5\u6811\u7684\u5e26\u6743\u8def\u5f84\u957f\u5ea6\u8fbe\u5230\u6700\u5c0f\uff0c\u79f0\u8fd9\u6837\u7684\u4e8c\u53c9\u6811\u4e3a\u6700\u4f18\u4e8c\u53c9\u6811\uff0c\u4e5f\u79f0\u4e3a\u54c8\u592b\u66fc\u6811(Huffman Tree)\u3002\u54c8\u592b\u66fc\u6811\u662f\u5e26\u6743\u8def\u5f84\u957f\u5ea6\u6700\u77ed\u7684\u6811\uff0c\u6743\u503c\u8f83\u5927\u7684\u7ed3\u70b9\u79bb\u6839\u8f83\u8fd1\u3002</p> <p>\u6bcf\u6b21\u9009\u53d6\u6743\u503c\u6700\u5c0f\u7684\u4e24\u4e2a\u8282\u70b9\uff0c\u6784\u9020\u6811\uff08\u5de6\u8282\u70b9 &lt; \u53f3\u8282\u70b9\uff09</p> <p>Huffman\u7f16\u7801</p>"},{"location":"code_guide/data_structure/tree.html#_3","title":"\u7ea2\u9ed1\u6811","text":"<p>\u5b9a\u4e49\uff1a</p> <ul> <li>\u8282\u70b9\u662f\u7ea2\u8272\u6216\u9ed1\u8272\uff1b</li> <li>\u6839\u8282\u70b9\u662f\u9ed1\u8272\uff1b</li> <li>\u6bcf\u4e2a\u53f6\u8282\u70b9\uff08NIL\u8282\u70b9\uff0c\u7a7a\u8282\u70b9\uff09\u662f\u9ed1\u8272\u7684\uff1b</li> <li>\u6bcf\u4e2a\u7ea2\u8272\u8282\u70b9\u7684\u4e24\u4e2a\u5b50\u8282\u70b9\u90fd\u662f\u9ed1\u8272\u3002(\u4ece\u6bcf\u4e2a\u53f6\u5b50\u5230\u6839\u7684\u6240\u6709\u8def\u5f84\u4e0a\u4e0d\u80fd\u6709\u4e24\u4e2a\u8fde\u7eed\u7684\u7ea2\u8272\u8282\u70b9)\uff1b</li> <li>\u4ece\u4efb\u4e00\u8282\u70b9\u5230\u5176\u6bcf\u4e2a\u53f6\u5b50\u7684\u6240\u6709\u8def\u5f84\u90fd\u5305\u542b\u76f8\u540c\u6570\u76ee\u7684\u9ed1\u8272\u8282\u70b9\u3002</li> </ul>"},{"location":"code_guide/data_structure/tree.html#_4","title":"\u7ebf\u6bb5\u6811","text":"<p>\u80fd\u7528\u6811\u72b6\u6570\u7ec4\u89e3\u51b3\u7684\uff0c\u7ebf\u6bb5\u6811\u90fd\u53ef\u4ee5\uff1b\u53cd\u4e4b\u4e0d\u7136\u3002\u6811\u72b6\u6570\u7ec4\u8282\u7701\u7a7a\u95f4\u5f00\u9500\uff0c\u6811\u72b6\u6570\u7ec4\u76f8\u5f53\u4e8e\u7ebf\u6bb5\u6811\u4e2d\u6bcf\u4e2a\u8282\u70b9\u53bb\u6389\u53f3\u513f\u5b50\u3002</p> <p>\u7528\u4e8e\u7ef4\u62a4\u533a\u95f4\u4fe1\u606f\uff08\u8981\u6c42\u6ee1\u8db3\u7ed3\u5408\u5f8b\uff09\u3002\u4e0e\u6811\u72b6\u6570\u7ec4\u76f8\u6bd4\uff0c\u5b83\u53ef\u4ee5\u5b9e\u73b0 Olg(n) \u7684\u533a\u95f4\u4fee\u6539\uff0c\u8fd8\u53ef\u4ee5\u540c\u65f6\u652f\u6301\u591a\u79cd\u64cd\u4f5c\uff08\u52a0\u3001\u4e58)\uff0c\u66f4\u5177\u901a\u7528\u6027\u3002\u7ebf\u6bb5\u6811\u662f\u4e00\u68f5\u5e73\u8861\u4e8c\u53c9\u6811\uff1a</p> <ul> <li>\u6bcd\u7ed3\u70b9\u4ee3\u8868\u6574\u4e2a\u533a\u95f4\u7684\u548c\uff0c\u8d8a\u5f80\u4e0b\u533a\u95f4\u8d8a\u5c0f\uff1b</li> <li>\u7ebf\u6bb5\u6811\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u5bf9\u5e94\u4e00\u6761\u7ebf\u6bb5\uff08\u533a\u95f4\uff09\uff0c\u4f46\u5e76\u4e0d\u4fdd\u8bc1\u6240\u6709\u7684\u7ebf\u6bb5\uff08\u533a\u95f4\uff09\u90fd\u662f\u7ebf\u6bb5\u6811\u7684\u8282\u70b9</li> <li>\u5bf9\u4e8e\u7ebf\u6bb5\u6811\u4e2d\u7684\u6bcf\u4e00\u4e2a\u975e\u53f6\u5b50\u8282\u70b9[a,b]\uff0c\u5b83\u7684\u5de6\u513f\u5b50\u8868\u793a\u7684\u533a\u95f4\u4e3a[a,(a+b)/2]\uff0c\u53f3\u513f\u5b50\u8868\u793a\u7684\u533a\u95f4\u4e3a[(a+b)/2+1,b]</li> </ul>"},{"location":"code_guide/data_structure/tree.html#_5","title":"\u539f\u7406","text":"<p>\u7a7a\u95f4\u6362\u65f6\u95f4\uff0c\u53c2\u8003\uff1ahttps://zhuanlan.zhihu.com/p/106118909</p> <p>\u5c31\u662f\u5c06[1,n]\u5206\u89e3\u6210\u82e5\u5e72\u7279\u5b9a\u7684\u5b50\u533a\u95f4\uff08\u6570\u91cf\u4e0d\u8d85\u8fc74*n\uff09\uff0c\u7136\u540e\uff0c\u5c06\u6bcf\u4e2a\u533a\u95f4[L,R]\u90fd\u5206\u89e3\u4e3a\u5c11\u91cf\u7279\u5b9a\u7684\u5b50\u533a\u95f4\uff0c\u901a\u8fc7\u5bf9\u8fd9\u4e9b\u5c11\u91cf\u5b50\u533a\u95f4\u7684\u4fee\u6539\u6216\u8005\u7edf\u8ba1\uff0c\u6765\u5b9e\u73b0\u5feb\u901f\u5bf9[L,R]\u7684\u4fee\u6539\u6216\u8005\u7edf\u8ba1\u3002</p> <p>\u7528\u7ebf\u6bb5\u6811\u7edf\u8ba1\u7684\u4e1c\u897f\uff0c\u5fc5\u987b\u7b26\u5408\u533a\u95f4\u52a0\u6cd5\uff0c\u5426\u5219\uff0c\u4e0d\u53ef\u80fd\u901a\u8fc7\u5206\u6210\u7684\u5b50\u533a\u95f4\u6765\u5f97\u5230[L,R]\u7684\u7edf\u8ba1\u7ed3\u679c\u3002</p> <p>\u7b26\u5408\u533a\u95f4\u52a0\u6cd5\u7684\u4f8b\u5b50\uff1a</p> <ul> <li> <p>\u6570\u5b57\u4e4b\u548c\u2014\u2014\u603b\u6570\u5b57\u4e4b\u548c = \u5de6\u533a\u95f4\u6570\u5b57\u4e4b\u548c + \u53f3\u533a\u95f4\u6570\u5b57\u4e4b\u548c</p> </li> <li> <p>\u6700\u5927\u516c\u56e0\u6570(GCD)\u2014\u2014\u603bGCD = gcd(\u5de6\u533a\u95f4GCD , \u53f3\u533a\u95f4GCD);</p> </li> <li> <p>\u6700\u5927\u503c\u2014\u2014\u603b\u6700\u5927\u503c=max(\u5de6\u533a\u95f4\u6700\u5927\u503c\uff0c\u53f3\u533a\u95f4\u6700\u5927\u503c)</p> </li> </ul> <p>\u4e0d\u7b26\u5408\u533a\u95f4\u52a0\u6cd5\u7684\u4f8b\u5b50\uff1a</p> <ul> <li>\u4f17\u6570\u2014\u2014\u53ea\u77e5\u9053\u5de6\u53f3\u533a\u95f4\u7684\u4f17\u6570\uff0c\u6ca1\u6cd5\u6c42\u603b\u533a\u95f4\u7684\u4f17\u6570</li> <li>01\u5e8f\u5217\u7684\u6700\u957f\u8fde\u7eed\u96f6\u2014\u2014\u53ea\u77e5\u9053\u5de6\u53f3\u533a\u95f4\u7684\u6700\u957f\u8fde\u7eed\u96f6\uff0c\u6ca1\u6cd5\u77e5\u9053\u603b\u7684\u6700\u957f\u8fde\u7eed\u96f6</li> </ul> <p></p> <p>\u201c\u61d2\u6807\u8bb0\u201d\uff08\u6216\u5ef6\u8fdf\u6807\u8bb0\uff09\uff1a\u533a\u95f4\u4fee\u6539</p> <ul> <li>\u6734\u7d20\u7684\u60f3\u6cd5\u662f\u7528\u9012\u5f52\u7684\u65b9\u5f0f\u4e00\u5c42\u5c42\u4fee\u6539\uff08\u7c7b\u4f3c\u4e8e\u7ebf\u6bb5\u6811\u7684\u5efa\u7acb\uff09\uff0c\u4f46\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u6bd4\u8f83\u9ad8\uff1b</li> <li>\u4f7f\u7528\u61d2\u6807\u8bb0\uff0c\u5bf9\u4e8e\u90a3\u4e9b\u6b63\u597d\u662f\u7ebf\u6bb5\u6811\u8282\u70b9\u7684\u533a\u95f4\uff0c\u6211\u4eec\u4e0d\u7ee7\u7eed\u9012\u5f52\u4e0b\u53bb\uff0c\u800c\u662f\u6253\u4e0a\u4e00\u4e2a\u6807\u8bb0\uff0c\u5c06\u6765\u8981\u7528\u5230\u5b83\u7684\u5b50\u533a\u95f4\u7684\u65f6\u5019\uff0c\u518d\u5411\u4e0b\u4f20\u9012\uff1b</li> <li>\u5411\u4e0b\u5ef6\u8fdf\u4fee\u6539\uff0c\u4f46\u662f\u5411\u4e0a\u663e\u793a\u7684\u4fe1\u606f\u662f\u4fee\u6539\u4ee5\u540e\u7684\u4fe1\u606f</li> </ul> <p>\u6807\u8bb0\u6709\u76f8\u5bf9\u6807\u8bb0\u548c\u7edd\u5bf9\u6807\u8bb0\u4e4b\u5206\uff1a\u975e\u9012\u5f52\u7ebf\u6bb5\u6811\u53ea\u80fd\u7ef4\u62a4\u76f8\u5bf9\u6807\u8bb0\u3002</p> <p>\u76f8\u5bf9\u6807\u8bb0\u662f\u5c06\u533a\u95f4\u7684\u6240\u6709\u6570+a\u4e4b\u7c7b\u7684\u64cd\u4f5c\uff0c\u6807\u8bb0\u4e4b\u95f4\u53ef\u4ee5\u5171\u5b58\uff0c\u8ddf\u6253\u6807\u8bb0\u7684\u987a\u5e8f\u65e0\u5173\uff08\u8ddf\u987a\u5e8f\u65e0\u5173\u624d\u662f\u91cd\u70b9\uff09\u3002</p> <p>\u6240\u4ee5\uff0c\u53ef\u4ee5\u5728\u533a\u95f4\u4fee\u6539\u7684\u65f6\u5019\u4e0d\u4e0b\u63a8\u6807\u8bb0\uff0c\u7559\u5230\u67e5\u8be2\u7684\u65f6\u5019\u518d\u4e0b\u63a8\u3002</p> <p>\u7edd\u5bf9\u6807\u8bb0\u662f\u5c06\u533a\u95f4\u7684\u6240\u6709\u6570\u53d8\u6210a\u4e4b\u7c7b\u7684\u64cd\u4f5c\uff0c\u6253\u6807\u8bb0\u7684\u987a\u5e8f\u76f4\u63a5\u5f71\u54cd\u7ed3\u679c\uff0c</p> <p>\u6240\u4ee5\u8fd9\u79cd\u6807\u8bb0\u5728\u533a\u95f4\u4fee\u6539\u7684\u65f6\u5019\u5fc5\u987b\u4e0b\u63a8\u65e7\u6807\u8bb0\uff0c\u4e0d\u7136\u4f1a\u51fa\u9519\u3002</p>"},{"location":"code_guide/data_structure/tree.html#bbb","title":"B/B+/B*\u6811","text":"<p>\u67e5\u627e\u78c1\u76d8\u7684\u8fc7\u7a0b\u4e2d\u51cf\u5c11IO\u7684\u6b21\u6570\u3002\u6bcf\u4e2a\u8282\u70b9\u5bf9\u5e94\u4e00\u4e2aPage\uff0c\u6570\u636e\u4ee5Page\u4e3a\u5355\u4f4d\u5728\u5185\u5b58\u548c\u78c1\u76d8\u95f4\u8fdb\u884c\u8c03\u5ea6\u3002</p>"},{"location":"code_guide/data_structure/tree.html#bb-tree","title":"B\u6811(B-tree)","text":"<p>\u6ce8\u610f:\u4e4b\u524d\u6709\u770b\u5230\u6709\u5f88\u591a\u6587\u7ae0\u628aB\u6811\u548cB-tree\u7406\u89e3\u6210\u4e86\u4e24\u79cd\u4e0d\u540c\u7c7b\u522b\u7684\u6811\uff0c\u5176\u5b9e\u8fd9\u4e24\u4e2a\u662f\u540c\u4e00\u79cd\u6811;</p> <p>\u5e73\u8861\u591a\u8def\u67e5\u627e\u6811\uff0cm\u9636\u7684B\u6811\u6ee1\u8db3\u4e0b\u5217\u6761\u4ef6\uff1a</p> <ul> <li>\u6811\u4e2d\u6bcf\u4e2a\u7ed3\u70b9\u81f3\u591a\u6709m\u4e2a\u5b69\u5b50\uff1b</li> <li>\u9664\u6839\u7ed3\u70b9\u548c\u53f6\u5b50\u7ed3\u70b9\u5916\uff0c\u5176\u5b83\u6bcf\u4e2a\u7ed3\u70b9\u81f3\u5c11\u6709m/2\u4e2a\u5b69\u5b50\uff1b</li> <li>\u82e5\u6839\u7ed3\u70b9\u4e0d\u662f\u53f6\u5b50\u7ed3\u70b9\uff0c\u5219\u81f3\u5c11\u67092\u4e2a\u5b69\u5b50\uff1b</li> <li>\u6240\u6709\u53f6\u5b50\u7ed3\u70b9(\u5931\u8d25\u8282\u70b9)\u90fd\u51fa\u73b0\u5728\u540c\u4e00\u5c42\uff0c\u53f6\u5b50\u7ed3\u70b9\u4e0d\u5305\u542b\u4efb\u4f55\u5173\u952e\u5b57\u4fe1\u606f\uff1b</li> <li>\u975e\u53f6\u5b50\u7ed3\u70b9\u7684\u6307\u9488\uff1aP[1], P[2], \u2026, P[M]\uff1b\u5176\u4e2dP[1]\u6307\u5411\u5173\u952e\u5b57\u5c0f\u4e8eK[1]\u7684\u5b50\u6811\uff0cP[M]\u6307\u5411\u5173\u952e\u5b57\u5927\u4e8eK[M-1]\u7684\u5b50\u6811\uff0c\u5176\u5b83P[i]\u6307\u5411\u5173\u952e\u5b57\u5c5e\u4e8e(K[i-1], K[i])\u7684\u5b50\u6811\uff1b</li> </ul> <p>B\u6811\u6bcf\u4e2a\u8282\u70b9\u90fd\u5b58\u50a8\u6570\u636e\uff0c\u6240\u6709\u8282\u70b9\u7ec4\u6210\u8fd9\u68f5\u6811\u3002</p> <p></p>"},{"location":"code_guide/data_structure/tree.html#b","title":"B+\u6811","text":"<p>B+\u6811\u53ea\u6709\u53f6\u5b50\u8282\u70b9\u5b58\u50a8\u6570\u636e\u3002</p> <p>\u6240\u6709\u5173\u952e\u5b57\u90fd\u51fa\u73b0\u5728\u53f6\u5b50\u7ed3\u70b9\u7684\u94fe\u8868\u4e2d\uff08\u7a20\u5bc6\u7d22\u5f15\uff09\uff0c\u4e14\u94fe\u8868\u4e2d\u7684\u5173\u952e\u5b57\u662f\u6709\u5e8f\u7684\u3002</p> <p>\u975e\u53f6\u5b50\u7ed3\u70b9\u7684\u5b50\u6811\u6307\u9488P[i]\uff0c\u6307\u5411\u5173\u952e\u5b57\u503c\u5c5e\u4e8e [K[i], K[i+1]) \u7684\u5b50\u6811\uff08B-\u6811\u662f\u5f00\u533a\u95f4\uff09\uff1b</p> <p>\u66f4\u9002\u5408\u6587\u4ef6\u7d22\u5f15\u7cfb\u7edf\uff1f</p> <p></p> <ul> <li>B+\u6811\u7684\u5c42\u7ea7\u66f4\u5c11\uff1a\u76f8\u8f83\u4e8eB\u6811B+\u6bcf\u4e2a\u975e\u53f6\u5b50\u8282\u70b9\u5b58\u50a8\u7684\u5173\u952e\u5b57\u6570\u66f4\u591a\uff0c\u6811\u7684\u5c42\u7ea7\u66f4\u5c11\u6240\u4ee5\u67e5\u8be2\u6570\u636e\u66f4\u5feb\uff1b</li> <li>B+\u6811\u67e5\u8be2\u901f\u5ea6\u66f4\u7a33\u5b9a\uff1aB+\u6240\u6709\u5173\u952e\u5b57\u6570\u636e\u5730\u5740\u90fd\u5b58\u5728\u53f6\u5b50\u8282\u70b9\u4e0a\uff0c\u6240\u4ee5\u6bcf\u6b21\u67e5\u627e\u7684\u6b21\u6570\u90fd\u76f8\u540c\u6240\u4ee5\u67e5\u8be2\u901f\u5ea6\u8981\u6bd4B\u6811\u66f4\u7a33\u5b9a;</li> <li>B+\u6811\u5929\u7136\u5177\u5907\u6392\u5e8f\u529f\u80fd\uff1aB+\u6811\u6240\u6709\u7684\u53f6\u5b50\u8282\u70b9\u6570\u636e\u6784\u6210\u4e86\u4e00\u4e2a\u6709\u5e8f\u94fe\u8868\uff0c\u5728\u67e5\u8be2\u5927\u5c0f\u533a\u95f4\u7684\u6570\u636e\u65f6\u5019\u66f4\u65b9\u4fbf\uff0c\u6570\u636e\u7d27\u5bc6\u6027\u5f88\u9ad8\uff0c\u7f13\u5b58\u7684\u547d\u4e2d\u7387\u4e5f\u4f1a\u6bd4B\u6811\u9ad8\u3002</li> <li>B+\u6811\u5168\u8282\u70b9\u904d\u5386\u66f4\u5feb\uff1aB+\u6811\u904d\u5386\u6574\u68f5\u6811\u53ea\u9700\u8981\u904d\u5386\u6240\u6709\u7684\u53f6\u5b50\u8282\u70b9\u5373\u53ef\uff0c\u800c\u4e0d\u9700\u8981\u50cfB\u6811\u4e00\u6837\u9700\u8981\u5bf9\u6bcf\u4e00\u5c42\u8fdb\u884c\u904d\u5386\uff0c\u8fd9\u6709\u5229\u4e8e\u6570\u636e\u5e93\u505a\u5168\u8868\u626b\u63cf\u3002</li> </ul>"},{"location":"code_guide/data_structure/tree.html#b_1","title":"B*\u6811","text":"<p>B\u6811\u5b9a\u4e49\u4e86\u975e\u53f6\u5b50\u7ed3\u70b9\u5173\u952e\u5b57\u4e2a\u6570\u81f3\u5c11\u4e3a(2/3)M\uff0c\u5373\u5757\u7684\u6700\u4f4e\u4f7f\u7528\u7387\u4e3a2/3\uff08\u4ee3\u66ffB+\u6811\u76841/2\uff09\uff1b</p> <p>\u5728B+\u6811\u7684\u975e\u6839\u548c\u975e\u53f6\u5b50\u7ed3\u70b9\u518d\u589e\u52a0\u6307\u5411\u5144\u5f1f\u7684\u6307\u9488\uff1b</p> <ul> <li>B+\u6811\u8282\u70b9\u6ee1\u65f6\u5c31\u4f1a\u5206\u88c2\uff0c\u800cB*\u6811\u8282\u70b9\u6ee1\u65f6\u4f1a\u68c0\u67e5\u5144\u5f1f\u8282\u70b9\u662f\u5426\u6ee1\uff08\u56e0\u4e3a\u6bcf\u4e2a\u8282\u70b9\u90fd\u6709\u6307\u5411\u5144\u5f1f\u7684\u6307\u9488\uff09\uff0c\u5982\u679c\u5144\u5f1f\u8282\u70b9\u672a\u6ee1\u5219\u5411\u5144\u5f1f\u8282\u70b9\u8f6c\u79fb\u5173\u952e\u5b57\u3002</li> </ul> <p></p> <p>\u5728B+\u6811\u7684\u57fa\u7840\u4e0a\u56e0\u5176\u521d\u59cb\u5316\u7684\u5bb9\u91cf\u53d8\u5927\uff0c\u4f7f\u5f97\u8282\u70b9\u7a7a\u95f4\u4f7f\u7528\u7387\u66f4\u9ad8\uff0c\u800c\u53c8\u5b58\u6709\u5144\u5f1f\u8282\u70b9\u7684\u6307\u9488\uff0c\u53ef\u4ee5\u5411\u5144\u5f1f\u8282\u70b9\u8f6c\u79fb\u5173\u952e\u5b57\u7684\u7279\u6027\u4f7f\u5f97B*\u6811\u989d\u5916\u5206\u89e3\u6b21\u6570\u53d8\u5f97\u66f4\u5c11\uff1b</p>"},{"location":"code_guide/data_structure/tree.html#lsm","title":"LSM\u6811","text":"<ul> <li>\u5c06\u8bfb\u5199\u5206\u79bb\uff0c\u8bfb\u64cd\u4f5c\u5148\u5185\u5b58\u540e\u78c1\u76d8\u3001\u6570\u636e\u5199\u64cd\u4f5c\uff08\u5305\u62ec\u63d2\u5165\u3001\u4fee\u6539\u3001\u5220\u9664\u4e5f\u662f\u5199\uff09\u90fd\u5728\u5185\u5b58\u4e2d\u8fdb\u884c\u3002\u5230\u8fbe\u4e00\u5b9a\u9608\u503c\u7684\u65f6\u5019\u624d\u4f1a\u5237\u65b0\u5230\u78c1\u76d8\u4e0a\u3002\u5728\u5927\u89c4\u6a21\u60c5\u51b5\u4e0b\uff0c\u5bfb\u9053\u660e\u663e\u6bd4\u4f20\u8f93\u4f4e\u6548\u3002</li> <li>LSM\u6811\u539f\u7406\u628a\u4e00\u68f5\u5927\u6811\u62c6\u5206\u6210N\u68f5\u5c0f\u6811\uff0c\u5b83\u9996\u5148\u5199\u5165\u5185\u5b58\u4e2d\uff0c\u968f\u7740\u5c0f\u6811\u8d8a\u6765\u8d8a\u5927\uff0c\u5185\u5b58\u4e2d\u7684\u5c0f\u6811\u4f1aflush\u5230\u78c1\u76d8\u4e2d\uff0c\u78c1\u76d8\u4e2d\u7684\u6811\u5b9a\u671f\u53ef\u4ee5\u505amerge\u64cd\u4f5c\uff0c\u5408\u5e76\u6210\u4e00\u68f5\u5927\u6811\uff0c\u4ee5\u4f18\u5316\u8bfb\u6027\u80fd\u3002</li> <li>LSM\u6811\uff08Log-Structured Merge Tree\uff09\u5b58\u50a8\u5f15\u64ce\u540c\u6837\u652f\u6301\u589e\u3001\u5220\u3001\u8bfb\u3001\u6539\u3001\u987a\u5e8f\u626b\u63cf\u64cd\u4f5c\u3002\u800c\u4e14\u901a\u8fc7\u6279\u91cf\u5b58\u50a8\u6280\u672f\u89c4\u907f\u78c1\u76d8\u968f\u673a\u5199\u5165\u95ee\u9898\u3002\u5f53\u7136\u51e1\u4e8b\u6709\u5229\u6709\u5f0a\uff0cLSM\u6811\u548cB+\u6811\u76f8\u6bd4\uff0cLSM\u6811\u727a\u7272\u4e86\u90e8\u5206\u8bfb\u6027\u80fd\uff0c\u7528\u6765\u5927\u5e45\u63d0\u9ad8\u5199\u6027\u80fd\u3002</li> </ul>"},{"location":"code_guide/data_structure/tree.html#_6","title":"\u5185\u5b58","text":"<p>\u53ef\u4ee5\u4f7f\u7528\u5e73\u8861\u4e8c\u53c9\u6811\uff08\u5982\u7ea2\u9ed1\u6811\uff09\u3001\u8df3\u8868\uff08skiplist\uff09\u7b49\u7ef4\u62a4\u6709\u5e8f\u7684\u6570\u636e\u7ed3\u6784\uff0c\u8003\u8651\u5230\u5e76\u53d1\u6027\u80fd\uff0cHBase\u4f7f\u7528\u8df3\u8868\u3002</p>"},{"location":"code_guide/data_structure/tree.html#_7","title":"\u78c1\u76d8","text":"<p>\u591a\u4e2a\u5185\u90e8KeyValue\u6709\u5e8f\u7684\u6587\u4ef6\u7ec4\u6210</p>"},{"location":"code_guide/data_structure/tree.html#compaction","title":"Compaction","text":"<p>compaction\u7684\u4e24\u4e2a\u6781\u7aef\uff1a</p> <ul> <li>\u7b2c\u4e00\u79cd\u6781\u7aef\uff08\u5de6\u4e0alog\u65b9\u6848\uff09\uff0c\u6839\u672c\u4e0d\u505acompaction\uff0c\u6240\u6709\u7684\u6570\u636e\u5168\u90e8\u5199\u5230Log\u7136\u540e\u704c\u5165SStable\uff0c</li> <li>update cost\u6700\u4f4e\uff0c\u4e0d\u9700compaction\uff0c\u76f4\u63a5Disk\uff1b</li> <li>\u67e5\u8be2\u4e00\u4e2aK/V\uff0c\u7ebf\u6027\u67e5\uff0c\u6548\u7387\u975e\u5e38\u4f4e\uff0c\u4e14\u6ca1\u6709compaction\u7684\u8bdd\u6570\u636e\u4f1a\u968f\u7740\u5199\u5165\u7ebf\u6027\u589e\u957f\uff1b</li> <li>\u7b2c\u4e8c\u79cd\u6781\u7aef\uff08\u53f3\u4e0bsorted array\u65b9\u6848\uff09, \u6bcf\u6b21\u5199\u65b0\u7684\uff0c\u7acb\u9a6c\u5c31\u53bb\u505acompaction\uff0c\u6c38\u8fdc\u7ef4\u6301\u6574\u4e2a\u6570\u636e\u66f4\u65b0\u5230\u6700\u65b0\u503c\u5e76\u4e14sorted\u72b6\u6001\uff0c</li> <li>\u67e5\u8be2\u56fa\u7136\u6548\u7387\u6700\u9ad8\uff0c\u76f4\u63a5\u6309\u7167index\u5c31\u884c\uff1b</li> <li>\u6bcf\u6b21\u5199\u5165\u6574\u4e2a\u6570\u636e\u90fd\u53bb\u8c03\u6574\u3001sort\uff0cupdate\u7684\u82b1\u9500\u592a\u5927\u3002\u5199\u5165KPS\u4e00\u9ad8\uff0c\u673a\u5668\u6491\u4e0d\u4f4f\u3002</li> </ul> <p></p>"},{"location":"code_guide/data_structure/tree.html#tiering-compaction","title":"tiering compaction","text":"<ul> <li>\u6bcf\u5c42\u5141\u8bb8\u7684SST\u6587\u4ef6\u6700\u5927\u6570\u91cf\u90fd\u6709\u4e2a\u76f8\u540c\u7684\u9608\u503c\uff1b</li> <li>memtables \u9996\u5148\u4f1a\u4e0d\u505cflush \u5230\u7b2c\u4e00\u5c42\u5f88\u5c0f\u7684sstables\uff0c\u7b49\u5230sstable\u6570\u91cf\u591f\u4e86\uff08\u56fe\u91cc4\u4e2a\uff09\uff0ccompaction\u6210\u4e00\u4e2asstable\u5199\u5230\u4e0b\u4e00\u5c42\uff0c\u4e0b\u4e00\u5c42sstable\u5199\u6ee14\u4e2a\uff0c\u518dcompact\uff0c\u5982\u6b64\u4ee5\u5f80\uff1b</li> <li>\u80fd\u591f\u4fdd\u8bc1\u6bcf\u4e2asstable\u662fsorted\uff0c\u4f46\u662f\u540c\u4e00\u5c42 sstable \u7684 key \u4f1a\u4e92\u76f8\u8986\u76d6\uff08overlapping\uff09 </li> </ul>"},{"location":"code_guide/data_structure/tree.html#level-compaction","title":"Level compaction","text":"<p>\u5728Disk \u91cc\u9762\u7ef4\u6301\u4e86\u591a\u7ea7level\u7684SStable\uff0c\u800c\u4e14\u6bcf\u5c42\u7ef4\u6301\u201c\u552f\u4e00\u4e00\u4e2a\u201dRun\u3002</p> <p>Each run contains data sorted by the index key. A run can be represented on disk as a single file, or alternatively as a collection of files with non-overlapping key ranges.</p> <p>compaction\u7684\u8fc7\u7a0b\u53ef\u4ee5\u7b80\u5316\u6210\uff1ain memory\u7684table\u5199\u6ee1\u4e86\uff0c\u90a3\u4e48\u5c31flush\u5230\u7b2c\u4e00\u7ea7\u7684Disk SStable\u5e76\u4e14\u505acompaction\uff0c\u8981\u662f\u7b2c\u4e00\u7ea7\u53c8\u6ee1\u4e86\uff0c\u5c31\u53c8\u5f00\u59cbflush\u5230\u7b2c\u4e8c\u7ea7\u505acompaction\uff0c\u4ee5\u6b64\u7c7b\u63a8\u76f4\u5230max level</p> <p></p> <ul> <li>\u5199\u6ee1\u7684\u5b9a\u4e49\uff1asstables\u7684\u5927\u5c0f\u57fa\u672c\u56fa\u5b9a\uff0c\u9650\u5236\u6bcf\u4e00\u5c42\u7684sstables\u7684\u4e2a\u6570\uff0c\u8d85\u8fc7\u9608\u503c\u540e\uff0c\u9009\u62e9\u4e00\u4e2asstable\u4e0e\u4e0b\u4e00\u5c42\u8fdb\u884c\u5408\u5e76\uff08L1\u7684\u4e00\u4e2asstable\u5927\u81f4\u5bf9\u5e94L2\u768410\u4e2asstable)\uff1b</li> </ul> <p>tiering\u8ddfleveling\u7684compaction\u7684\u5bf9\u6bd4\uff1a</p> <p></p> \u4f18\u70b9 \u7f3a\u70b9 tiering compaction \u7b80\u5355\u4e14\u6613\u4e8e\u5b9e\u73b0\uff1bSST\u6570\u76ee\u5c11\uff0c\u5b9a\u4f4d\u5230\u6587\u4ef6\u7684\u901f\u5ea6\u5feb\u5199\u653e\u5927\u8f83\u5c0f \u9700\u8981\u67e5\u8be2\u591a\u4e2a\u6587\u4ef6\u5355\u4e2aSST\u7684\u5927\u5c0f\u6709\u53ef\u80fd\u4f1a\u5f88\u5927\uff0c\u7a7a\u95f4\u653e\u5927\u4e25\u91cd\u8bfb\u653e\u5927\u4e25\u91cd leveling compaction \u7a7a\u95f4\u653e\u5927\u8f83\u5c0f\u8bfb\u653e\u5927\u8f83\u5c0f \u5199\u653e\u5927\u4e25\u91cd <p>\u7a7a\u95f4\u653e\u5927\uff08space amplification\uff09:</p> <ul> <li> <p>\u6307\u5b58\u50a8\u5f15\u64ce\u4e2d\u7684\u6570\u636e\u5b9e\u9645\u5360\u7528\u7684\u78c1\u76d8\u7a7a\u95f4\u6bd4\u6570\u636e\u7684\u771f\u6b63\u5927\u5c0f\u504f\u591a\u7684\u60c5\u51b5\uff1b</p> </li> <li> <p>\u4f8b\u5982\uff0c\u6570\u636e\u7684\u771f\u6b63\u5927\u5c0f\u662f10MB\uff0c\u4f46\u5b9e\u9645\u5b58\u50a8\u65f6\u8017\u6389\u4e8625MB\u7a7a\u95f4\uff0c\u90a3\u4e48\u7a7a\u95f4\u653e\u5927\u56e0\u5b50\uff08space amplification factor\uff09\u5c31\u662f2.5\u3002</p> </li> <li> <p>tiering compaction \u56e0\u4e3a\u5927\u7684SSTable\uff0c\u9700\u8981\u66f4\u591a\u7684\u4e34\u65f6\u7a7a\u95f4\u53bb\u5408\u5e76\uff1b</p> </li> <li> <p>leveling compaction\uff0c\u4e0d\u5fc5\u518d\u9009\u53d6\u4e00\u5c42\u5185\u6240\u6709\u7684\u6570\u636e\uff0c\u5e76\u4e14\u6bcf\u5c42\u4e2dSST\u7684key\u533a\u95f4\u90fd\u662f\u4e0d\u76f8\u4ea4\u7684</p> </li> </ul> <p>\u5199\u653e\u5927\uff08write amplification\uff09</p> <ul> <li>\u6307\u5b9e\u9645\u5199\u5165\u78c1\u76d8\u7684\u8bb0\u5f55\u6570\u8ddf\u5199\u5165\u8bb0\u5f55\u7684\u6bd4\u4f8b\uff0c\u5373\u540c\u4e00\u4e2a\u8bb0\u5f55\u9700\u8981\u88ab\u591a\u6b21\u5199\u5165Disk\uff1b</li> <li>\u8017\u8d39\u78c1\u76d8\u5e26\u5bbd\uff1b\u5b58\u50a8\u4ecb\u8d28\u7684\u5bff\u547d\u964d\u4f4e\uff1b</li> <li>leveling compaction\u5199\u653e\u5927\u4e25\u91cd\uff1aLn\u5c42SST\u5728\u5408\u5e76\u5230Ln+1\u5c42\u65f6\u662f\u4e00\u5bf9\u591a\u7684\uff0c\u6545\u91cd\u590d\u5199\u5165\u7684\u6b21\u6570\u4f1a\u66f4\u591a\uff1b</li> </ul> <p>\u8bfb\u653e\u5927</p> <p>\u6bcf\u6b21\u8bfb\u8bf7\u6c42\u5e26\u6765\u7684\u8bfb\u76d8\u6b21\u6570</p>"},{"location":"code_guide/data_structure/tree.html#rocksdbcompactionleveled-compaction","title":"RocksDB\u7684\u6df7\u5408compaction\u7b56\u7565\uff08leveled compaction\uff09","text":"<p>\u5f53L0\u5c42\u7684\u6587\u4ef6\u6570\u76ee\u8fbe\u5230<code>level0_file_num_compaction_trigger</code>\u9608\u503c\u65f6\uff0c\u5c31\u4f1a\u89e6\u53d1L0\u5c42SST\u5408\u5e76\u5230L1\u3002</p> <p></p> <p>L1\u5c42\u53ca\u4ee5\u540e\u7684compaction\u8fc7\u7a0b\u5b8c\u5168\u7b26\u5408\u524d\u6587\u6240\u8ff0\u7684leveled compaction\u903b\u8f91\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u5f88\u5bb9\u6613\u7406\u89e3\u3002</p> <p></p> <p></p> <p></p> <p></p> <p>\u591a\u4e2acompaction\u8fc7\u7a0b\u662f\u53ef\u4ee5\u5e76\u884c\u8fdb\u884c\u3002</p>"},{"location":"code_guide/data_structure/tree.html#fractal-tree","title":"Fractal Tree(\u5206\u5f62\u6811)","text":"<p>\u7d22\u5f15\u7ed3\u6784\u6765\u89e3\u51b3\u968f\u673aIO\u7684\u95ee\u9898\uff0c\u80fd\u8ba9\u968f\u673aIO\u53d8\u6210\u987a\u5e8fIO\u3002</p>"},{"location":"code_guide/data_structure/tree.html#_8","title":"\u8df3\u8868","text":"<p>\u9ad8\u6548\u5b9e\u73b0\u63d2\u5165\u3001\u5220\u9664\u3001\u67e5\u627e\u7684\u5185\u5b58\u6570\u636e\u7ed3\u6784\u3002\u590d\u6742\u5ea6\u671f\u671b\u4e3aO(logN)</p> <ul> <li>\u5b9e\u73b0\u7b80\u5355\uff0c\u5e76\u53d1\u573a\u666f\u4e0b\u52a0\u9501\u7684\u7c92\u5ea6\u66f4\u5c0f\uff1b\uff08HBase\u3001Redis\u3001LevelDB\uff09</li> </ul>"},{"location":"code_guide/data_structure/tree.html#_9","title":"\u589e","text":""},{"location":"code_guide/data_structure/tree.html#_10","title":"\u5220","text":""},{"location":"code_guide/data_structure/tree.html#_11","title":"\u6539/\u67e5","text":""},{"location":"code_guide/design_pattern/index.html","title":"\u8bbe\u8ba1\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/index.html#_2","title":"\u521b\u5efa\u578b\u6a21\u5f0f","text":"<p>\u62bd\u8c61\u5b9e\u4f8b\u5316\u7684\u8fc7\u7a0b\uff0c\u7c7b\u521b\u5efa\u578b\u6a21\u5f0f\u4f7f\u7528\u7ee7\u627f\u6539\u53d8\u88ab\u5b9e\u4f8b\u5316\u7684\u7c7b\uff0c\u5bf9\u8c61\u521b\u5efa\u578b\u6a21\u5f0f\u5c06\u5b9e\u4f8b\u5316\u59d4\u6258\u7ed9\u53e6\u4e00\u4e2a\u5bf9\u8c61\u3002</p> <p>\u521b\u5efa\u578b\u6a21\u5f0f\u5728\u4ec0\u4e48\u88ab\u521b\u5efa\uff0c\u8c01\u521b\u5efa\u5b83\uff0c\u5b83\u662f\u600e\u4e48\u88ab\u521b\u5efa\u7684\uff0c\u4ee5\u53ca\u4f55\u65f6\u521b\u5efa\u65b9\u9762\u6709\u5f88\u5927\u7684\u7075\u6d3b\u6027\u3002</p> <ul> <li>\u5de5\u5382\u6a21\u5f0f\uff08Factory\uff09</li> <li>\u62bd\u8c61\u5de5\u5382\uff08Abstract Factory\uff09</li> <li>\u6784\u9020\u8005\u6a21\u5f0f\uff08Builder\uff09</li> <li>\u5355\u4f8b\u6a21\u5f0f\uff08Singleton\uff09</li> </ul> <p>\u901a\u5e38\uff0c\u8bbe\u8ba1\u4ee5\u4f7f\u7528Factory Method\u5f00\u59cb\uff0c\u5e76\u4e14\u5f53\u8bbe\u8ba1\u8005\u53d1\u73b0\u9700\u8981\u66f4\u5927\u7684\u7075\u6d3b\u6027\u65f6\uff0c\u8bbe\u8ba1\u4fbf\u4f1a\u5411\u5176\u5b83\u521b\u5efa\u578b\u6a21\u5f0f\u6f14\u5316\u3002</p>"},{"location":"code_guide/design_pattern/index.html#_3","title":"\u7ed3\u6784\u578b\u6a21\u5f0f","text":"<ul> <li>\u9002\u914d\u5668\uff08Adapter\uff09</li> <li>\u6865\u63a5\uff08Bridge\uff09</li> <li>\u7ec4\u5408\uff08Composite\uff09</li> <li>\u88c5\u9970\uff08Decorator\uff09</li> <li>\u5916\u89c2\uff08Facade\uff09</li> <li>\u4eab\u5143\uff08Flyweight\uff09</li> <li>\u4ee3\u7406\uff08Proxy\uff09</li> </ul> <p>\u6a21\u5f0f\u76f8\u5173\u6027\uff1a</p> <ul> <li>\u5bf9\u8c61\u9002\u914d\u5668\u6a21\u5f0f\u8ddf\u6865\u63a5\u6a21\u5f0f\u7c7b\u4f3c\uff0c\u4f46\u662f\u6865\u63a5\u6a21\u5f0f\u76ee\u7684\u662f\u5c06\u63a5\u53e3\u90e8\u5206\u548c\u5b9e\u73b0\u90e8\u5206\u5206\u79bb\uff0c\u8f83\u4e3a\u5bb9\u6613\u5e76\u76f8\u5bf9\u72ec\u7acb\u8fdb\u884c\u6539\u53d8\uff1b\u9002\u914d\u5668\u6a21\u5f0f\u5219\u662f\u6539\u53d8\u4e00\u4e2a\u5df2\u6709\u5bf9\u8c61\u7684\u63a5\u53e3\u3002</li> <li>\u88c5\u9970\u8005\u6a21\u5f0f\u589e\u5f3a\u5176\u4ed6\u5bf9\u8c61\u7684\u529f\u80fd\u800c\u540c\u65f6\u4e0d\u6539\u53d8\u5b83\u7684\u63a5\u53e3\uff0c\u5176\u5e94\u7528\u7a0b\u5e8f\u7684\u900f\u660e\u6027\u6bd4\u9002\u914d\u5668\u597d\u3002</li> <li>\u4ee3\u7406\u6a21\u5f0f\u5728\u4e0d\u6539\u53d8\u5b83\u7684\u63a5\u53e3\u7684\u6761\u4ef6\u4e0b\uff0c\u4e3a\u53e6\u4e00\u4e2a\u5bf9\u8c61\u5b9a\u4e49\u4e86\u4e00\u4e2a\u4ee3\u7406\u3002</li> <li>\u88c5\u9970\u53ef\u4ee5\u6539\u53d8\u5bf9\u8c61\u7684\u5916\u8868\uff0c\u800c\u7b56\u7565\u6a21\u5f0f\u53ef\u4ee5\u6539\u53d8\u5bf9\u8c61\u7684\u5185\u6838\uff0c\u8fd9\u662f\u6539\u53d8\u5bf9\u8c61\u7684\u4e24\u79cd\u9014\u5f84\u3002</li> <li>\u53ef\u4ee5\u5c06\u88c5\u9970\u89c6\u4e3a\u9000\u5316\u3001\u4ec5\u4e00\u4e2a\u7ec4\u4ef6\u7684\u7ec4\u5408\uff0c\u4f46\u88c5\u9970\u7684\u76ee\u7684\u4e0d\u5728\u4e8e\u5bf9\u8c61\u805a\u96c6\uff0c\u800c\u662f\u6dfb\u52a0\u989d\u5916\u7684\u804c\u8d23\u3002</li> <li>Flyweight\u7ecf\u5e38\u548cComposite\u6a21\u5f0f\u7ed3\u5408\u8d77\u6765\uff0c\u7528\u5171\u4eab\u53f6\u8282\u70b9\u7684\u6709\u5411\u65e0\u73af\u56fe\u5b9e\u73b0\u4e00\u4e2a\u903b\u8f91\u4e0a\u7684\u5c42\u6b21\u7ed3\u6784\uff1b</li> <li>\u6700\u597d\u7528Flyweight\u5b9e\u73b0State\u6a21\u5f0f\u548c\u7b56\u7565\u6a21\u5f0f\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/index.html#_4","title":"\u884c\u4e3a\u578b\u6a21\u5f0f","text":"<ul> <li> <p>\u804c\u8d23\u94fe\uff08chain\uff09</p> </li> <li> <p>\u547d\u4ee4\uff08command\uff09</p> </li> <li> <p>\u89e3\u91ca\u5668\uff08interpret\uff09</p> </li> <li> <p>\u8fed\u4ee3\u5668\uff08iterator\uff09</p> </li> <li> <p>\u4e2d\u4ecb\u8005\uff08medium\uff09</p> </li> <li> <p>\u5907\u5fd8\u5f55\uff08memento\uff09</p> </li> <li> <p>\u89c2\u5bdf\u8005\uff08observer\uff09</p> </li> <li> <p>\u72b6\u6001\uff08state\uff09</p> </li> <li> <p>\u7b56\u7565\uff08strategy\uff09</p> </li> <li> <p>\u6a21\u677f\u65b9\u6cd5\uff08template\uff09</p> </li> <li> <p>\u8bbf\u95ee\u8005\uff08visitor\uff09</p> </li> </ul>"},{"location":"code_guide/design_pattern/index.html#_5","title":"\u5206\u5e03\u5f0f\u7cfb\u7edf\u5e94\u7528\u8bbe\u8ba1\uff08\u5bb9\u5668\u8bbe\u8ba1\u6a21\u5f0f\uff09","text":"<ul> <li>\u5355\u8282\u70b9\u6a21\u5f0f\uff1a</li> <li>\u8fb9\u8f66\u6a21\u5f0f</li> <li>\u5927\u4f7f\u6a21\u5f0f</li> <li>\u9002\u914d\u5668\u6a21\u5f0f</li> <li>\u670d\u52a1\uff08\u591a\u8282\u70b9\uff09\u6a21\u5f0f\uff1a</li> <li>\u590d\u5236\u670d\u52a1</li> <li>\u5206\u7247\u670d\u52a1</li> <li>\u5206\u6563/\u805a\u96c6\u6a21\u5f0f</li> <li>\u51fd\u6570\u548c\u4e8b\u4ef6\u9a71\u52a8</li> <li> <p>\u6240\u6709\u6743\u9009\u4e3e</p> </li> <li> <p>\u6279\u5904\u7406\u8ba1\u7b97\u6a21\u5f0f\uff1a</p> </li> <li>\u5de5\u4f5c\u961f\u5217\u7cfb\u7edf</li> <li>\u4e8b\u4ef6\u9a71\u52a8\u7684\u6279\u5904\u7406</li> <li>\u534f\u8c03\u6279\u5904\u7406</li> </ul>"},{"location":"code_guide/design_pattern/abstract_factory.html","title":"\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/abstract_factory.html#_2","title":"\u610f\u56fe","text":"<p>\u63d0\u4f9b\u4e00\u4e2a\u63a5\u53e3\u4ee5\u521b\u5efa\u4e00\u7cfb\u5217\u76f8\u5173\u6216\u76f8\u4e92\u4f9d\u8d56\u7684\u5bf9\u8c61\uff0c\u800c\u65e0\u987b\u6267\u884c\u4ed6\u4eec\u5177\u4f53\u7684\u7c7b\uff08\u56f4\u7ed5\u4e00\u4e2a\u8d85\u7ea7\u5de5\u5382\u521b\u5efa\u5176\u4ed6\u5de5\u5382\uff09\u3002</p>"},{"location":"code_guide/design_pattern/abstract_factory.html#_3","title":"\u52a8\u673a","text":"<p>\u9488\u5bf9\u4ea7\u54c1C\uff08\u5982\u4e00\u5957\u8863\u670d\u642d\u914d\uff0c\u5305\u62ec\u5e3d\u5b50\u3001\u4e0a\u8863\u3001\u88e4\u5b50\u3001\u978b\u7b49\uff09\uff0c\u6709\u591a\u79cd\u5b9e\u73b0\uff08\u5546\u52a1\u98ce\u3001\u8fd0\u52a8\u98ce\u3001\u53e4\u98ce\u7b49\uff09\uff0c\u5982\uff1a</p> <p>A\u7cfb\u5217\uff1aA_C1\uff0cA_C2\uff0c...\uff1b</p> <p>B\u7cfb\u5217\uff1aB_C1\uff0cB_C2\uff0c...\uff1b</p> <p>A\u7cfb\u5217\u548cB\u7cfb\u5217\u4e0d\u53ef\u7ec4\u5408\uff0c\u5fc5\u987b\u5168\u90e8\u7528A\uff0c\u6216\u8005\u5168\u90e8\u7528B\uff1a</p> <ul> <li>\u5b9a\u4e49\u62bd\u8c61\u7684\u5de5\u5382\uff0c\u5b9a\u4e49\u5176A\u548cB\u7cfb\u5217\u7684\u5b9e\u73b0\u5de5\u5382\u7c7b\uff0c\u7528\u6237\u53ea\u64cd\u4f5c\u8fd9\u4e9b\u5de5\u5382\u7c7b\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/abstract_factory.html#_4","title":"\u7c7b\u56fe","text":"<p>\u4ea7\u54c1 A\uff0cB\u3002</p> <p></p>"},{"location":"code_guide/design_pattern/abstract_factory.html#_5","title":"\u9002\u7528\u573a\u666f","text":"<ul> <li>\u4e00\u4e2a\u7cfb\u7edf\u72ec\u7acb\u4e8e\u5b83\u7684\u4ea7\u54c1\u7684\u521b\u5efa\u3001\u7ec4\u5408\u548c\u8868\u793a\uff1b</li> <li>\u4e00\u4e2a\u7cfb\u7edf\u7531\u591a\u4e2a\u4ea7\u54c1\u7cfb\u5217\u4e2d\u7684\u4e00\u4e2a\u6765\u914d\u7f6e\uff1b</li> <li>\u5f3a\u8c03\u4e00\u7cfb\u5217\u76f8\u5173\u7684\u4ea7\u54c1\u5bf9\u8c61\u7684\u8bbe\u8ba1\u4ee5\u4fbf\u8fdb\u884c\u8054\u5408\u4f7f\u7528\uff1b</li> <li>\u63d0\u4f9b\u4e00\u4e2a\u4ea7\u54c1\u7c7b\u5e93\uff0c\u4f46\u53ea\u60f3\u663e\u793a\u5b83\u4eec\u7684\u63a5\u53e3\u800c\u4e0d\u662f\u5b9e\u73b0\uff1b</li> <li>\u7cfb\u7edf\u7684\u4ea7\u54c1\u6709\u591a\u4e8e\u4e00\u4e2a\u7684\u4ea7\u54c1\u65cf\uff0c\u800c\u7cfb\u7edf\u53ea\u6d88\u8d39\u5176\u4e2d\u67d0\u4e00\u65cf\u7684\u4ea7\u54c1\u3002</li> </ul>"},{"location":"code_guide/design_pattern/abstract_factory.html#_6","title":"\u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a</p> <ul> <li>\u5177\u6709\u5de5\u5382\u65b9\u6cd5\u7684\u53ef\u6269\u5c55\u6027\uff1b</li> <li>\u5177\u6709\u521b\u5efa\u4e00\u7ec4\u76f8\u5173\u5bf9\u8c61\u7684\u80fd\u529b\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u4ea7\u54c1\u65cf\u6269\u5c55(\u7eb5\u5411\u6269\u5c55\uff09\u56f0\u96be\uff0c\u8981\u589e\u52a0\u4e00\u4e2a\u7cfb\u5217\u7684\u67d0\u4e00\u4ea7\u54c1\uff0c\u5728\u62bd\u8c61\u7684\u5de5\u5382/\u5177\u4f53\u7684\u5de5\u5382\u52a0\u4ee3\u7801\u3002</li> </ul>"},{"location":"code_guide/design_pattern/abstract_factory.html#_7","title":"\u5b9e\u4f8b","text":"<ol> <li> <p>QQ \u6362\u76ae\u80a4\uff0c\u4e00\u6574\u5957\u4e00\u8d77\u6362\uff1b</p> </li> <li> <p>\u751f\u6210\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u7684\u7a0b\u5e8f\u3002</p> </li> </ol>"},{"location":"code_guide/design_pattern/adapter.html","title":"\u9002\u914d\u5668","text":""},{"location":"code_guide/design_pattern/adapter.html#_2","title":"\u610f\u56fe","text":"<p>\u5c06\u4e00\u4e2a\u7c7b\u7684\u63a5\u53e3\u8f6c\u6362\u4e3a\u5ba2\u6237\u5e0c\u671b\u7684\u53e6\u5916\u4e00\u4e2a\u63a5\u53e3\u3002</p> <p>\u5982\uff1a\u4e2d\u6587\u7684\u4eba\u540c\u8bb2\u82f1\u6587\u7684\u4eba\u5bf9\u8bdd\u65f6\u9700\u8981\u4e00\u4e2a\u7ffb\u8bd1\uff1b\u7528\u76f4\u6d41\u7535\u7684\u7b14\u8bb0\u672c\u7535\u8111\u63a5\u4ea4\u6d41\u7535\u6e90\u65f6\u9700\u8981\u4e00\u4e2a\u7535\u6e90\u9002\u914d\u5668\uff1b\u7528\u8ba1\u7b97\u673a\u8bbf\u95ee\u7167\u76f8\u673a\u7684 SD \u5185\u5b58\u5361\u65f6\u9700\u8981\u4e00\u4e2a\u8bfb\u5361\u5668\uff1bslf4j-log4j-adapter</p>"},{"location":"code_guide/design_pattern/adapter.html#_3","title":"\u9002\u7528\u6027","text":"<ul> <li>\u60f3\u4f7f\u7528\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u7c7b\uff0c\u4f46\u5b83\u7684\u63a5\u53e3\u4e0d\u7b26\u5408\u4f60\u7684\u9700\u6c42\uff1b</li> <li>\u521b\u5efa\u4e00\u4e2a\u53ef\u4ee5\u590d\u7528\u7684\u7c7b\uff0c\u8be5\u7c7b\u53ef\u4ee5\u4e0e\u5176\u4ed6\u4e0d\u76f8\u5173\u7684\u7c7b\u6216\u4e0d\u53ef\u9884\u89c1\u7684\u7c7b\u534f\u540c\u5de5\u4f5c\uff1b</li> <li>\u60f3\u4f7f\u7528\u4e00\u4e9b\u5df2\u7ecf\u5b58\u5728\u7684\u5b50\u7c7b\uff0c\u4f46\u4e0d\u53ef\u80fd\u5bf9\u6bcf\u4e00\u4e2a\u90fd\u8fdb\u884c\u5b50\u7c7b\u5316\u4ee5\u5339\u914d\u5b83\u4eec\u7684\u63a5\u53e3\u3002</li> </ul>"},{"location":"code_guide/design_pattern/adapter.html#_4","title":"\u7c7b\u56fe","text":"<p>\u7c7b\u9002\u914d\u5668/\u63a5\u53e3\u9002\u914d\u5668\uff0c\u6bd4\u5982 Java \u4e2d\u7684KeyListener\u548cKeyAdapter\uff08Adaptee\u548cTarget\u90fd\u662fKeyListener\uff09\uff1b</p> <p></p> <p>\u5bf9\u8c61\u9002\u914d\u5668\u6a21\u5f0f\uff08Adapter\u4e2d\u542b\u6709Adaptee\u7684\u5bf9\u8c61\uff09</p> <p></p> <p>\u9002\u914d\u5668\u6a21\u5f0f\uff08Adapter\uff09\u53ef\u6269\u5c55\u4e3a\u53cc\u5411\u9002\u914d\u5668\u6a21\u5f0f\uff0c\u53cc\u5411\u9002\u914d\u5668\u7c7b\u65e2\u53ef\u4ee5\u628a\u9002\u914d\u8005\u63a5\u53e3\u8f6c\u6362\u6210\u76ee\u6807\u63a5\u53e3\uff0c\u4e5f\u53ef\u4ee5\u628a\u76ee\u6807\u63a5\u53e3\u8f6c\u6362\u6210\u9002\u914d\u8005\u63a5\u53e3\u3002</p> <p></p>"},{"location":"code_guide/design_pattern/adapter.html#_5","title":"\u4f18\u7f3a\u70b9","text":"<p>\u8be5\u6a21\u5f0f\u7684\u4e3b\u8981\u4f18\u70b9\u5982\u4e0b\uff1a</p> <ul> <li>\u5ba2\u6237\u7aef\u901a\u8fc7\u9002\u914d\u5668\u53ef\u4ee5\u900f\u660e\u5730\u8c03\u7528\u76ee\u6807\u63a5\u53e3\uff1b</li> <li>\u590d\u7528\u73b0\u5b58\u7684\u7c7b\uff0c\u7a0b\u5e8f\u5458\u4e0d\u9700\u8981\u4fee\u6539\u539f\u6709\u4ee3\u7801\u800c\u91cd\u7528\u73b0\u6709\u7684\u9002\u914d\u8005\u7c7b\uff1b</li> <li>\u5c06\u76ee\u6807\u7c7b\u548c\u9002\u914d\u8005\u7c7b\u89e3\u8026\uff0c\u89e3\u51b3\u4e86\u76ee\u6807\u7c7b\u548c\u9002\u914d\u8005\u7c7b\u63a5\u53e3\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\uff1b</li> <li>\u5728\u5f88\u591a\u4e1a\u52a1\u573a\u666f\u4e2d\u7b26\u5408\u5f00\u95ed\u539f\u5219\u3002</li> </ul> <p>\u5176\u7f3a\u70b9\u662f\uff1a</p> <ul> <li>\u9002\u914d\u5668\u7f16\u5199\u8fc7\u7a0b\u9700\u8981\u7ed3\u5408\u4e1a\u52a1\u573a\u666f\u5168\u9762\u8003\u8651\uff0c\u53ef\u80fd\u4f1a\u589e\u52a0\u7cfb\u7edf\u7684\u590d\u6742\u6027\uff1b</li> <li>\u589e\u52a0\u4ee3\u7801\u9605\u8bfb\u96be\u5ea6\uff0c\u964d\u4f4e\u4ee3\u7801\u53ef\u8bfb\u6027\uff0c\u8fc7\u591a\u4f7f\u7528\u9002\u914d\u5668\u4f1a\u4f7f\u7cfb\u7edf\u4ee3\u7801\u53d8\u5f97\u51cc\u4e71\u3002</li> </ul>"},{"location":"code_guide/design_pattern/adapter.html#_6","title":"\u793a\u4f8b","text":"<p>Java\u7684 InputStreamReader\uff0c\u5c06InputStream\u5b9e\u4f8b\u9002\u914d\u4e3aReader\u7684\u63a5\u53e3\u3002</p>"},{"location":"code_guide/design_pattern/bridge.html","title":"\u6865\u63a5\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/bridge.html#_2","title":"\u610f\u56fe","text":"<p>\u5c06\u62bd\u8c61\u90e8\u5206\u4e0e\u5b83\u7684\u5b9e\u73b0\u90e8\u5206\u5206\u79bb\uff0c\u4f7f\u5b83\u4eec\u53ef\u4ee5\u72ec\u7acb\u5730\u53d8\u5316\u3002</p> <ul> <li>\u591a\u4e2a\u7ef4\u5ea6\u8fdb\u884c\u6269\u5c55\uff0c\u4f7f\u7528\u7ec4\u5408\u66ff\u4ee3\u7ee7\u627f\u3002</li> </ul>"},{"location":"code_guide/design_pattern/bridge.html#_3","title":"\u9002\u7528\u6027","text":"<p>\u7ee7\u627f\u673a\u5236\u5c06\u62bd\u8c61\u90e8\u5206\u4e0e\u5b83\u7684\u5b9e\u73b0\u90e8\u5206\u56fa\u5b9a\u5728\u4e00\u8d77\uff0c\u4f7f\u5f97\u96be\u4ee5\u5bf9\u62bd\u8c61\u90e8\u5206\u548c\u5b9e\u73b0\u90e8\u5206\u5206\u522b\u72ec\u7acb\u5730\u8fdb\u884c\u4fee\u6539\u3001\u6269\u5145\u548c\u590d\u7528\u3002</p> <ul> <li>\u5728\u6709\u591a\u79cd\u53ef\u80fd\u4f1a\u53d8\u5316\u7684\u60c5\u51b5\u4e0b\uff0c\u7528\u7ee7\u627f\u4f1a\u9020\u6210\u7c7b\u7206\u70b8\u95ee\u9898\uff0c\u6269\u5c55\u8d77\u6765\u4e0d\u7075\u6d3b\uff1b</li> <li>\u4e0d\u5e0c\u671b\u62bd\u8c61\u548c\u5b9e\u73b0\u90e8\u5206\u6709\u4e00\u4e2a\u56fa\u5b9a\u7684\u7ed1\u5b9a\u5173\u7cfb\uff0c\u5982\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u5b9e\u73b0\u90e8\u5206\u5e94\u8be5\u53ef\u4ee5\u88ab\u9009\u62e9\u6216\u8005\u5207\u6362\uff1b</li> <li>\u5bf9\u4e00\u4e2a\u62bd\u8c61\u7684\u5b9e\u73b0\u90e8\u5206\u7684\u4fee\u6539\u5e94\u5bf9\u5ba2\u6237\u4e0d\u4ea7\u751f\u5f71\u54cd\uff0c\u5373\u5ba2\u6237\u7684\u4ee3\u7801\u4e0d\u5fc5\u91cd\u65b0\u7f16\u8bd1\uff1b</li> <li>\u4e00\u4e2a\u7c7b\u5b58\u5728\u4e24\u4e2a\u72ec\u7acb\u53d8\u5316\u7684\u7ef4\u5ea6\uff0c\u4e14\u8fd9\u4e24\u4e2a\u7ef4\u5ea6\u90fd\u9700\u8981\u8fdb\u884c\u6269\u5c55\uff1a</li> <li>\u4e09\u79cd\u989c\u8272\u3001\u4e09\u79cd\u5f62\u72b6\uff0c\u7ee7\u627f\u9700\u89819\u4e2a\u5b50\u7c7b\uff0c\u7ec4\u5408\u9700\u89816\u4e2a\u5b50\u7c7b\uff1b</li> </ul> <p>\u793a\u4f8b\uff1a\u8003\u8651\u5361\u8f66\u3001\u5df4\u58eb\uff0c\u6c7d\u6cb9\u578b\u548c\u67f4\u6cb9\u578b\u3002\u4e24\u4e24\u7ec4\u5408\u4e4b\u540e\uff0c\u5c31\u4f1a\u6709\u56db\u79cd\u8f66\u578b\uff1a\u6c7d\u6cb9\u578b\u5361\u8f66\uff0c\u67f4\u6cb9\u578b\u5361\u8f66\uff0c\u6c7d\u6cb9\u578b\u5df4\u58eb\u548c\u67f4\u6cb9\u578b\u5df4\u58eb\u3002</p> <p></p>"},{"location":"code_guide/design_pattern/bridge.html#_4","title":"\u7c7b\u56fe","text":"<ul> <li>Abstraction\uff1a\u5b9a\u4e49\u62bd\u8c61\u7c7b\u7684\u63a5\u53e3\uff0c\u7ef4\u62a4\u4e00\u4e2a\u6307\u5411 Implemetor \u7c7b\u578b\u5bf9\u8c61\u7684\u6307\u9488\uff1b</li> <li>RefinedAbstraction\uff1a\u6269\u5145\u7531Abstraction\u5b9a\u4e49\u7684\u63a5\u53e3\uff1b</li> <li>Implementor\uff1a\u5b9a\u4e49\u5b9e\u73b0\u7c7b\u7684\u63a5\u53e3\uff08\u4e0d\u9700\u8981\u4e0eAbstraction\u4e00\u81f4\uff09\uff1b</li> <li>ConcreteImplementor\uff1a\u5b9e\u73b0Implementor\u63a5\u53e3\u5e76\u5b9a\u4e49\u5177\u4f53\u5b9e\u73b0\u3002</li> </ul>"},{"location":"code_guide/design_pattern/bridge.html#_5","title":"\u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a 1\u3001\u62bd\u8c61\u548c\u5b9e\u73b0\u7684\u5206\u79bb\u3002 2\u3001\u4f18\u79c0\u7684\u6269\u5c55\u80fd\u529b\u3002 3\u3001\u5b9e\u73b0\u7ec6\u8282\u5bf9\u5ba2\u6237\u900f\u660e\u3002</p> <p>\u7f3a\u70b9\uff1a\u6865\u63a5\u6a21\u5f0f\u7684\u5f15\u5165\u4f1a\u589e\u52a0\u7cfb\u7edf\u7684\u7406\u89e3\u4e0e\u8bbe\u8ba1\u96be\u5ea6\uff0c\u7531\u4e8e\u805a\u5408\u5173\u8054\u5173\u7cfb\u5efa\u7acb\u5728\u62bd\u8c61\u5c42\uff0c\u8981\u6c42\u5f00\u53d1\u8005\u9488\u5bf9\u62bd\u8c61\u8fdb\u884c\u8bbe\u8ba1\u4e0e\u7f16\u7a0b\u3002</p>"},{"location":"code_guide/design_pattern/builder.html","title":"\u6784\u9020\u8005\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/builder.html#_2","title":"\u610f\u56fe","text":"<p>\u5c06\u590d\u6742\u5bf9\u8c61\u7684\u6784\u5efa\u4e0e\u5b83\u7684\u8868\u793a\u5206\u79bb\uff0c\u4f7f\u5f97\u540c\u6837\u7684\u6784\u5efa\u8fc7\u7a0b\u53ef\u4ee5\u521b\u5efa\u4e0d\u540c\u7684\u8868\u793a\u3002</p>"},{"location":"code_guide/design_pattern/builder.html#_3","title":"\u9002\u7528\u6027","text":"<ul> <li>\u591a\u4e2a\u90e8\u4ef6\u6216\u8005\u96f6\u4ef6\uff0c\u90fd\u53ef\u4ee5\u88c5\u914d\u5230\u4e00\u4e2a\u5bf9\u8c61\u4e2d\uff0c\u4f46\u662f\u4ea7\u751f\u7684\u8fd0\u884c\u7ed3\u679c\u53c8\u76f8\u540c\uff1b</li> <li>\u4ea7\u54c1\u7c7b\u975e\u5e38\u590d\u6742\uff0c\u6216\u8005\u4ea7\u54c1\u7c7b\u4e2d\u8c03\u7528\u987a\u5e8f\u4e0d\u540c\u4ea7\u751f\u4e86\u4e0d\u540c\u7684\u4f5c\u7528\uff1b</li> <li>\u521d\u59cb\u5316\u590d\u6742\u5bf9\u8c61\uff0c\u5982\u8bf4\u6709\u5f88\u591a\u53c2\u6570\uff0c\u5e76\u4e14\u90fd\u6709\u9ed8\u8ba4\u503c\u65f6\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/builder.html#_4","title":"\u7c7b","text":"<ul> <li>Product\uff1a\u6700\u7ec8\u8981\u751f\u6210\u7684\u5bf9\u8c61\uff0c\u4f8b\u5982 HttpClient \u5b9e\u4f8b\uff1b</li> <li>Builder\uff1a \u6784\u5efa\u8005\u7684\u62bd\u8c61\u57fa\u7c7b\uff08\u6709\u65f6\u4f1a\u4f7f\u7528\u63a5\u53e3\u4ee3\u66ff\uff09\uff0c\u5b9a\u4e49\u4e86\u6784\u5efaProduct\u7684\u62bd\u8c61\u6b65\u9aa4\uff0c\u548c\u6700\u7ec8\u4ea7\u54c1\u7684\u65b9\u6cd5<code>getProduct</code>\uff1b</li> <li>ConcreteBuilder\uff1aBuilder\u7684\u5b9e\u73b0\u7c7b\uff0c\u5b9e\u73b0Builder\u7684\u62bd\u8c61\u63a5\u53e3\uff1b</li> <li>Director\uff1a\u51b3\u5b9a\u5982\u4f55\u6784\u5efa\u6700\u7ec8\u4ea7\u54c1\u7684\u7b97\u6cd5\uff0c \u5176\u4f1a\u5305\u542b\u4e00\u4e2a\u8d1f\u8d23\u7ec4\u88c5\u7684\u65b9\u6cd5<code>void Construct(Builder builder)</code>\uff0c \u5728\u8fd9\u4e2a\u65b9\u6cd5\u4e2d\u901a\u8fc7\u8c03\u7528builder\u7684\u65b9\u6cd5\uff0c\u5c31\u53ef\u4ee5\u8bbe\u7f6ebuilder\uff0c\u7b49\u8bbe\u7f6e\u5b8c\u6210\u540e\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7builder\u7684 <code>getProduct()</code>\u65b9\u6cd5\u83b7\u5f97\u6700\u7ec8\u7684\u4ea7\u54c1\u3002</li> </ul>"},{"location":"code_guide/design_pattern/builder.html#_5","title":"\u4f18\u7f3a\u70b9","text":"<p>\u76f8\u5bf9\u4e8e\u4f7f\u7528\u4e0d\u540c\u7684\u6784\u9020\u51fd\u6570\u548c\u901a\u8fc7getter/setter\u6784\u5efa\u5b9e\u4f8b\uff0c\u4f18\u52bf\uff1a</p> <ul> <li>\u591a\u4e2a\u53c2\u6570\u65f6\uff0c\u6784\u9020\u65f6\u7684\u53c2\u6570\u7684\u987a\u5e8f\u5bb9\u6613\u51fa\u9519\uff1b</li> <li>setter\u65b9\u5f0f\u5bf9\u8c61\u7684\u72b6\u6001\u5bb9\u6613\u53d1\u751f\u53d8\u5316\uff0c\u56e0\u4e3a\u5df2\u7ecf\u6709\u4e86\u5bf9\u8c61\u5b9e\u4f8b\uff0c\u5f88\u96be\u9650\u5236\u7528\u6237\u7684setter\u7684\u4e0a\u4e0b\u6587\u3002</li> </ul> <p>\u4f18\u70b9\uff1a</p> <ul> <li>\u6539\u53d8\u4ea7\u54c1\u7684\u5185\u90e8\u8868\u793a\uff0cbuilder\u9690\u85cf\u4ea7\u54c1\u7684\u8868\u793a\u548c\u5185\u90e8\u7ed3\u6784\uff1b</li> <li>\u5c06\u6784\u9020\u4ee3\u7801\u548c\u8868\u793a\u4ee3\u7801\u5206\u5f00\uff1b</li> <li>\u5bf9\u6784\u9020\u8fc7\u7a0b\u66f4\u7cbe\u7ec6\u7684\u63a7\u5236\uff1b</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u5fc5\u8981\u7684\u53c2\u6570\uff0c\u65e0\u6cd5\u5728\u7f16\u8bd1\u671f\u62a5\u9519\uff0c\u53ea\u80fd\u5728\u8fd0\u884c\u671f<code>builder</code></li> </ul>"},{"location":"code_guide/design_pattern/builder.html#_6","title":"\u76f8\u5173\u8bbe\u8ba1\u6a21\u5f0f","text":"<p>\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u548cBuilder\u7c7b\u4f3c\uff0c\u53ef\u4ee5\u521b\u5efa\u590d\u6742\u5bf9\u8c61\uff1a</p> <ul> <li>Builder\u6a21\u5f0f\u7740\u91cd\u4e00\u6b65\u4e00\u6b65\u6784\u9020\u4e00\u4e2a\u590d\u6742\u5bf9\u8c61\uff0c\u6700\u540e\u4e00\u6b65\u8fd4\u56de\u4ea7\u54c1\uff1b</li> <li>\u62bd\u8c61\u5de5\u5382\u6a21\u5f0f\u7740\u91cd\u591a\u4e2a\u7cfb\u5217\u7684\u4ea7\u54c1\u5bf9\u8c61\uff08\u7b80\u5355\u6216\u8005\u590d\u6742\u7684\uff09\uff0c\u4ea7\u54c1\u662f\u7acb\u5373\u8fd4\u56de\u7684\u3002</li> </ul>"},{"location":"code_guide/design_pattern/chain.html","title":"\u804c\u8d23\u94fe\u6a21\u5f0f","text":"<p>\u8d23\u4efb\u94fe\uff0c\u7528\u6765\u5904\u7406\u76f8\u5173\u4e8b\u52a1\u8d23\u4efb\u7684\u4e00\u6761\u6267\u884c\u94fe\uff0c\u6267\u884c\u94fe\u4e0a\u6709\u591a\u4e2a\u8282\u70b9\uff0c\u6bcf\u4e2a\u8282\u70b9\u90fd\u6709\u673a\u4f1a\uff08\u6761\u4ef6\u5339\u914d\uff09\u5904\u7406\u8bf7\u6c42\u4e8b\u52a1\uff0c\u5982\u679c\u67d0\u4e2a\u8282\u70b9\u5904\u7406\u5b8c\u4e86\u5c31\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u4e1a\u52a1\u9700\u6c42\u4f20\u9012\u7ed9\u4e0b\u4e00\u4e2a\u8282\u70b9\u7ee7\u7eed\u5904\u7406\u6216\u8005\u8fd4\u56de\u5904\u7406\u5b8c\u6bd5\u3002</p>"},{"location":"code_guide/design_pattern/chain.html#_2","title":"\u610f\u56fe","text":"<p>\u907f\u514d\u8bf7\u6c42\u53d1\u9001\u8005\u4e0e\u63a5\u6536\u8005\u8026\u5408\u5728\u4e00\u8d77\uff0c\u8ba9\u591a\u4e2a\u5bf9\u8c61\u90fd\u6709\u53ef\u80fd\u63a5\u6536\u8bf7\u6c42\uff0c\u5c06\u8fd9\u4e9b\u5bf9\u8c61\u8fde\u63a5\u6210\u4e00\u6761\u94fe\uff0c\u5e76\u4e14\u6cbf\u7740\u8fd9\u6761\u94fe\u4f20\u9012\u8bf7\u6c42\uff0c\u76f4\u5230\u6709\u5bf9\u8c61\u5904\u7406\u5b83\u4e3a\u6b62\uff08\u5e76\u4e14\u53ef\u4ee5\u9009\u62e9\u662f\u5426\u7ee7\u7eed\u5411\u540e\u5904\u7406\uff09\u3002</p>"},{"location":"code_guide/design_pattern/chain.html#_3","title":"\u9002\u7528\u6027","text":"<p>\u9002\u7528\u573a\u666f\uff1a</p> <ul> <li>Web\u670d\u52a1\uff1a\u8fc7\u6ee4\u5668\uff0c\u5ba1\u6279</li> </ul>"},{"location":"code_guide/design_pattern/chain.html#_4","title":"\u7c7b\u56fe","text":"<p>\u89e3\u8d23\u4efb\u94fe\u6a21\u5f0f\u5e94\u5f53\u7406\u89e3\u5176\u6a21\u5f0f\uff0c\u800c\u4e0d\u662f\u5176\u5177\u4f53\u5b9e\u73b0\u3002\u8d23\u4efb\u94fe\u6a21\u5f0f\u7684\u72ec\u5230\u4e4b\u5904\u662f\u5c06\u5176\u8282\u70b9\u5904\u7406\u8005\u7ec4\u5408\u6210\u4e86\u94fe\u5f0f\u7ed3\u6784\uff0c\u5e76\u5141\u8bb8\u8282\u70b9\u81ea\u8eab\u51b3\u5b9a\u662f\u5426\u8fdb\u884c\u8bf7\u6c42\u5904\u7406\u6216\u8f6c\u53d1\uff0c\u76f8\u5f53\u4e8e\u8ba9\u8bf7\u6c42\u6d41\u52a8\u8d77\u6765\u3002\uff08Spring\u4e2d\u7684filter\u6a21\u5f0f\u5bf9\u5176\u505a\u4e86\u6539\u52a8\uff0c\u7528\u6237\u4e0d\u9700\u8981\u663e\u793a\u521b\u5efa\u94fe\u7684\u64cd\u4f5c\uff09</p> <p></p> <p></p> <ol> <li>\u62bd\u8c61\u5904\u7406\u8005\uff08Handler\uff09\u89d2\u8272\uff1a\u5b9a\u4e49\u4e00\u4e2a\u5904\u7406\u8bf7\u6c42\u7684\u63a5\u53e3\uff0c\u5305\u542b\u62bd\u8c61\u5904\u7406\u65b9\u6cd5\u548c\u4e00\u4e2a\u540e\u7ee7\u8fde\u63a5\u3002</li> <li>\u5177\u4f53\u5904\u7406\u8005\uff08Concrete Handler\uff09\u89d2\u8272\uff1a\u5b9e\u73b0\u62bd\u8c61\u5904\u7406\u8005\u7684\u5904\u7406\u65b9\u6cd5\uff0c\u5224\u65ad\u80fd\u5426\u5904\u7406\u672c\u6b21\u8bf7\u6c42\uff0c\u5982\u679c\u53ef\u4ee5\u5904\u7406\u8bf7\u6c42\u5219\u5904\u7406\uff0c\u5426\u5219\u5c06\u8be5\u8bf7\u6c42\u8f6c\u7ed9\u5b83\u7684\u540e\u7ee7\u8005\u3002</li> <li>\u5ba2\u6237\u7c7b\uff08Client\uff09\u89d2\u8272\uff1a\u521b\u5efa\u5904\u7406\u94fe\uff0c\u5e76\u5411\u94fe\u5934\u7684\u5177\u4f53\u5904\u7406\u8005\u5bf9\u8c61\u63d0\u4ea4\u8bf7\u6c42\uff0c\u5b83\u4e0d\u5173\u5fc3\u5904\u7406\u7ec6\u8282\u548c\u8bf7\u6c42\u7684\u4f20\u9012\u8fc7\u7a0b\u3002</li> </ol>"},{"location":"code_guide/design_pattern/chain.html#_5","title":"\u4f18\u52a3\u52bf","text":"<p>\u4f18\u70b9\uff1a </p> <ul> <li>\u964d\u4f4e\u8026\u5408\u5ea6\uff1a\u5b83\u5c06\u8bf7\u6c42\u7684\u53d1\u9001\u8005\u548c\u63a5\u6536\u8005\u89e3\u8026\uff1b</li> <li>\u7b80\u5316\u5bf9\u8c61\uff1a\u4f7f\u5f97\u5bf9\u8c61\u4e0d\u9700\u8981\u77e5\u9053\u94fe\u7684\u7ed3\u6784\uff1b</li> <li>\u589e\u5f3a\u7ed9\u5bf9\u8c61\u6307\u6d3e\u804c\u8d23\u7684\u7075\u6d3b\u6027\u3002\u901a\u8fc7\u6539\u53d8\u94fe\u5185\u7684\u6210\u5458\u6216\u8005\u8c03\u52a8\u5b83\u4eec\u7684\u6b21\u5e8f\uff0c\u5141\u8bb8\u52a8\u6001\u5730\u65b0\u589e\u6216\u8005\u5220\u9664\u8d23\u4efb\uff1b</li> <li>\u589e\u52a0\u65b0\u7684\u8bf7\u6c42\u5904\u7406\u7c7b\u5f88\u65b9\u4fbf\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a </p> <ul> <li>\u4e0d\u80fd\u4fdd\u8bc1\u8bf7\u6c42\u4e00\u5b9a\u88ab\u63a5\u6536\uff1b</li> <li>\u7cfb\u7edf\u6027\u80fd\u5c06\u53d7\u5230\u4e00\u5b9a\u5f71\u54cd\uff0c\u800c\u4e14\u5728\u8fdb\u884c\u4ee3\u7801\u8c03\u8bd5\u65f6\u4e0d\u592a\u65b9\u4fbf\uff0c\u53ef\u80fd\u4f1a\u9020\u6210\u5faa\u73af\u8c03\u7528\uff1b</li> <li>\u53ef\u80fd\u4e0d\u5bb9\u6613\u89c2\u5bdf\u8fd0\u884c\u65f6\u7684\u7279\u5f81\uff0c\u6709\u788d\u4e8e\u9664\u9519\u3002</li> </ul>"},{"location":"code_guide/design_pattern/command.html","title":"\u547d\u4ee4\u6a21\u5f0f","text":"<p>\u5c06\u8bf7\u6c42\u5c01\u88c5\u6210\u547d\u4ee4\uff0c\u5e76\u8bb0\u5f55\u4e0b\u6765\uff0c\u80fd\u591f\u64a4\u9500\u4e0e\u91cd\u505a\u3002</p>"},{"location":"code_guide/design_pattern/command.html#_2","title":"\u610f\u56fe","text":"<p>\u5c06\u4e00\u4e2a\u8bf7\u6c42\u5c01\u88c5\u6210\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4ece\u800c\u4f7f\u60a8\u53ef\u4ee5\u7528\u4e0d\u540c\u7684\u8bf7\u6c42\u5bf9\u5ba2\u6237\u8fdb\u884c\u53c2\u6570\u5316\u3002</p> <p>\u5728\u67d0\u4e9b\u573a\u5408\uff0c\u6bd4\u5982\u8981\u5bf9\u884c\u4e3a\u8fdb\u884c\"\u8bb0\u5f55\u3001\u64a4\u9500/\u91cd\u505a\u3001\u4e8b\u52a1\"\u7b49\u5904\u7406\uff0c\u8fd9\u79cd\u65e0\u6cd5\u62b5\u5fa1\u53d8\u5316\u7684\u7d27\u8026\u5408\u662f\u4e0d\u5408\u9002\u7684\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5982\u4f55\u5c06\"\u884c\u4e3a\u8bf7\u6c42\u8005\"\u4e0e\"\u884c\u4e3a\u5b9e\u73b0\u8005\"\u89e3\u8026\uff1f\u5c06\u4e00\u7ec4\u884c\u4e3a\u62bd\u8c61\u4e3a\u5bf9\u8c61\uff0c\u53ef\u4ee5\u5b9e\u73b0\u4e8c\u8005\u4e4b\u95f4\u7684\u677e\u8026\u5408\u3002</p>"},{"location":"code_guide/design_pattern/command.html#_3","title":"\u9002\u7528\u6027","text":"<p>\u8f6f\u4ef6\u7cfb\u7edf\u7684\u547d\u4ee4\u884c\u6a21\u5f0f\uff0c\u4e00\u822c\u91c7\u7528Command\u6a21\u5f0f\u5b9e\u73b0\u3002</p> <p>\u573a\u666f\uff1a</p> <ol> <li>\u8bf7\u6c42\u8c03\u7528\u8005\u9700\u8981\u4e0e\u8bf7\u6c42\u63a5\u6536\u8005\u89e3\u8026\uff0c\u547d\u4ee4\u6a21\u5f0f\u53ef\u4ee5\u4f7f\u8c03\u7528\u8005\u548c\u63a5\u6536\u8005\u4e0d\u76f4\u63a5\u4ea4\u4e92\uff1b</li> <li>\u7cfb\u7edf\u968f\u673a\u8bf7\u6c42\u547d\u4ee4\u6216\u7ecf\u5e38\u589e\u52a0\u3001\u5220\u9664\u547d\u4ee4\u65f6\uff0c\u547d\u4ee4\u6a21\u5f0f\u53ef\u4ee5\u65b9\u4fbf\u5730\u5b9e\u73b0\u8fd9\u4e9b\u529f\u80fd\uff1b</li> <li>\u5f53\u7cfb\u7edf\u9700\u8981\u6267\u884c\u4e00\u7ec4\u64cd\u4f5c\u65f6\uff0c\u547d\u4ee4\u6a21\u5f0f\u53ef\u4ee5\u5b9a\u4e49\u5b8f\u547d\u4ee4\u6765\u5b9e\u73b0\u8be5\u529f\u80fd\uff1b</li> <li>\u5f53\u7cfb\u7edf\u9700\u8981\u652f\u6301\u547d\u4ee4\u7684\u64a4\u9500\uff08Undo\uff09\u64cd\u4f5c\u548c\u6062\u590d\uff08Redo\uff09\u64cd\u4f5c\u65f6\uff0c\u53ef\u4ee5\u5c06\u547d\u4ee4\u5bf9\u8c61\u5b58\u50a8\u8d77\u6765\uff0c\u91c7\u7528\u5907\u5fd8\u5f55\u6a21\u5f0f\u6765\u5b9e\u73b0\uff1b</li> </ol>"},{"location":"code_guide/design_pattern/command.html#_4","title":"\u7c7b","text":"<ol> <li>\u62bd\u8c61\u547d\u4ee4\u7c7b\uff08Command\uff09\u89d2\u8272\uff1a\u58f0\u660e\u6267\u884c\u547d\u4ee4\u7684\u63a5\u53e3\uff0c\u62e5\u6709\u6267\u884c\u547d\u4ee4\u7684\u62bd\u8c61\u65b9\u6cd5 execute()\u3002</li> <li>\u5177\u4f53\u547d\u4ee4\u7c7b\uff08Concrete Command\uff09\u89d2\u8272\uff1a\u662f\u62bd\u8c61\u547d\u4ee4\u7c7b\u7684\u5177\u4f53\u5b9e\u73b0\u7c7b\uff0c\u5b83\u62e5\u6709\u63a5\u6536\u8005\u5bf9\u8c61\uff0c\u5e76\u901a\u8fc7\u8c03\u7528\u63a5\u6536\u8005\u7684\u529f\u80fd\u6765\u5b8c\u6210\u547d\u4ee4\u8981\u6267\u884c\u7684\u64cd\u4f5c\u3002</li> <li>\u5b9e\u73b0\u8005/\u63a5\u6536\u8005\uff08Receiver\uff09\u89d2\u8272\uff1a\u6267\u884c\u547d\u4ee4\u529f\u80fd\u7684\u76f8\u5173\u64cd\u4f5c\uff0c\u662f\u5177\u4f53\u547d\u4ee4\u5bf9\u8c61\u4e1a\u52a1\u7684\u771f\u6b63\u5b9e\u73b0\u8005\u3002</li> <li>\u8c03\u7528\u8005/\u8bf7\u6c42\u8005\uff08Invoker\uff09\u89d2\u8272\uff1a\u662f\u8bf7\u6c42\u7684\u53d1\u9001\u8005\uff0c\u5b83\u901a\u5e38\u62e5\u6709\u5f88\u591a\u7684\u547d\u4ee4\u5bf9\u8c61\uff0c\u5e76\u901a\u8fc7\u8bbf\u95ee\u547d\u4ee4\u5bf9\u8c61\u6765\u6267\u884c\u76f8\u5173\u8bf7\u6c42\uff0c\u5b83\u4e0d\u76f4\u63a5\u8bbf\u95ee\u63a5\u6536\u8005\u3002</li> </ol>"},{"location":"code_guide/design_pattern/command.html#_5","title":"\u4f18\u52a3\u52bf","text":"<p>\u4f18\u70b9\uff1a </p> <ul> <li>\u964d\u4f4e\u4e86\u7cfb\u7edf\u8026\u5408\u5ea6\uff1b</li> <li>\u65b0\u7684\u547d\u4ee4\u53ef\u4ee5\u5f88\u5bb9\u6613\u6dfb\u52a0\u5230\u7cfb\u7edf\u4e2d\u53bb\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a </p> <ul> <li>\u4f7f\u7528\u547d\u4ee4\u6a21\u5f0f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u67d0\u4e9b\u7cfb\u7edf\u6709\u8fc7\u591a\u7684\u5177\u4f53\u547d\u4ee4\u7c7b\u3002</li> </ul>"},{"location":"code_guide/design_pattern/composite.html","title":"\u539f\u578b\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/composite.html#_2","title":"\u610f\u56fe","text":"<p>\u90e8\u5206-\u6574\u4f53\u6a21\u5f0f\uff0c\u5b83\u662f\u4e00\u79cd\u5c06\u5bf9\u8c61\u7ec4\u5408\u6210\u6811\u72b6\u7684\u5c42\u6b21\u7ed3\u6784\u7684\u6a21\u5f0f\uff0c\u7528\u6765\u8868\u793a\u201c\u90e8\u5206-\u6574\u4f53\u201d\u7684\u5173\u7cfb\uff0c\u4f7f\u7528\u6237\u5bf9\u5355\u4e2a\u5bf9\u8c61\u548c\u7ec4\u5408\u5bf9\u8c61\u5177\u6709\u4e00\u81f4\u7684\u8bbf\u95ee\u6027\u3002</p> <p>\u7ec4\u5408\u7684\u7236\u5b50\u7c7b\u5173\u7cfb\u6bd4\u805a\u5408\u8981\u5f3a\uff1a</p> <ul> <li>\u805a\u5408\uff1ahas-a\u5173\u7cfb\uff0c\u7236\u7c7b\u5305\u542b\u5b50\u7c7b\uff0c\u5b50\u7c7b\u53ef\u4ee5\u72ec\u7acb\u4e8e\u7236\u7c7b\u5b58\u5728</li> <li>\u7ec4\u5408\uff1apart-of\u5173\u7cfb\uff0c\u7236\u7c7b\u62e5\u6709\u5b50\u7c7b\uff0c\u5b50\u7c7b\u4e0d\u80fd\u72ec\u7acb\u4e8e\u7236\u7c7b\u5b58\u5728</li> </ul>"},{"location":"code_guide/design_pattern/composite.html#_3","title":"\u9002\u7528\u6027","text":"<ul> <li>\u5f53\u9700\u8981\u8868\u793a\u5bf9\u8c61\u7684\u5c42\u6b21\u7ed3\u6784\u65f6\uff0c\u5982\u6587\u4ef6\u7cfb\u7edf\u6216\u7ec4\u7ec7\u7ed3\u6784\u3002</li> <li>\u5f53\u5e0c\u671b\u5ba2\u6237\u7aef\u4ee3\u7801\u80fd\u591f\u4ee5\u4e00\u81f4\u7684\u65b9\u5f0f\u5904\u7406\u6811\u5f62\u7ed3\u6784\u4e2d\u7684\u6240\u6709\u5bf9\u8c61\u65f6\u3002</li> </ul> <p>\u5e94\u7528\u5b9e\u4f8b</p> <ul> <li>JSON \u89e3\u6790\uff0c\u53f6\u5b50\u8282\u70b9\uff1b</li> <li>\u7b97\u672f\u8868\u8fbe\u5f0f\uff1a\u6784\u5efa\u4e00\u4e2a\u7531\u64cd\u4f5c\u6570\u3001\u64cd\u4f5c\u7b26\u548c\u5b50\u8868\u8fbe\u5f0f\u7ec4\u6210\u7684\u6811\u5f62\u7ed3\u6784\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/composite.html#_4","title":"\u7c7b\u56fe","text":"<p>\u900f\u660e\u65b9\u5f0f\uff1a\u62bd\u8c61\u6784\u4ef6\u58f0\u660e\u4e86\u6240\u6709\u5b50\u7c7b\u4e2d\u7684\u5168\u90e8\u65b9\u6cd5\uff0c\u4f46\u53f6\u5b50\u6784\u4ef6\u6ca1\u6709<code>Add</code>\u7b49\u65b9\u6cd5\uff0c\u5374\u9700\u8981\u5b9e\u73b0\u3002</p> <ul> <li>Component\u63a5\u53e3\uff1a\u5b9a\u4e49\u4e86\u6240\u6709\u5bf9\u8c61\u5fc5\u987b\u5b9e\u73b0\u7684\u64cd\u4f5c\u3002</li> <li>Leaf\u7c7b\uff1a\u5b9e\u73b0Component\u63a5\u53e3\uff0c\u4ee3\u8868\u6811\u4e2d\u7684\u53f6\u5b50\u8282\u70b9\u3002</li> <li>Composite\u7c7b\uff1a\u4e5f\u5b9e\u73b0Component\u63a5\u53e3\uff0c\u5e76\u5305\u542b\u5176\u4ed6Component\u5bf9\u8c61\u7684\u96c6\u5408\u3002</li> </ul> <p></p>"},{"location":"code_guide/design_pattern/composite.html#_5","title":"\u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a</p> <ul> <li>\u5ba2\u6237\u7aef\u4e00\u81f4\u5730\u5904\u7406\u5355\u4e2a\u5bf9\u8c61/\u7ec4\u5408\u5bf9\u8c61\uff0c\u65e0\u987b\u5173\u5fc3\u5904\u7406\u7684\u662f\u5355\u4e2a\u5bf9\u8c61\u6216\u7ec4\u5408\u5bf9\u8c61\uff0c\u8fd9\u7b80\u5316\u4e86\u5ba2\u6237\u7aef\u4ee3\u7801\uff1b</li> <li>\u66f4\u5bb9\u6613\u5728\u7ec4\u5408\u4f53\u5185\u52a0\u5165\u65b0\u7684\u5bf9\u8c61\uff0c\u5ba2\u6237\u7aef\u4e0d\u4f1a\u56e0\u4e3a\u52a0\u5165\u4e86\u65b0\u7684\u5bf9\u8c61\u800c\u66f4\u6539\u6e90\u4ee3\u7801\uff0c\u6ee1\u8db3\u201c\u5f00\u95ed\u539f\u5219\u201d\uff1b\u3000\u3000</li> </ul> <p>\u5176\u4e3b\u8981\u7f3a\u70b9\u662f\uff1a</p> <ul> <li>\u8bbe\u8ba1\u8f83\u590d\u6742\uff0c\u5ba2\u6237\u7aef\u9700\u8981\u82b1\u66f4\u591a\u65f6\u95f4\u7406\u6e05\u7c7b\u4e4b\u95f4\u7684\u5c42\u6b21\u5173\u7cfb\uff1b</li> <li>\u4e0d\u5bb9\u6613\u9650\u5236\u5bb9\u5668\u4e2d\u7684\u6784\u4ef6\uff1b</li> <li>\u4e0d\u5bb9\u6613\u7528\u7ee7\u627f\u7684\u65b9\u6cd5\u6765\u589e\u52a0\u6784\u4ef6\u7684\u65b0\u529f\u80fd\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/container_distributed.html","title":"\u5206\u5e03\u5f0f\u7cfb\u7edf\u5e94\u7528\u8bbe\u8ba1\uff08\u5bb9\u5668\u8bbe\u8ba1\u6a21\u5f0f\uff09","text":""},{"location":"code_guide/design_pattern/container_distributed.html#_2","title":"\u5355\u8282\u70b9\u6a21\u5f0f","text":"<p>\u5bb9\u5668\u5316\u7684\u76ee\u6807\u662f\u56f4\u7ed5\u7279\u5b9a\u8d44\u6e90\u5efa\u7acb\u8fb9\u754c\uff08\u5173\u6ce8\u70b9\u7684\u5206\u79bb\uff09\uff1a\u5c06\u4e00\u53f0\u673a\u5668\u8fd0\u884c\u7684\u7ec4\u4ef6\u5206\u89e3\u4e3a\u4e0d\u540c\u7684\u5bb9\u5668\u8fd0\u884c\uff1b</p> <ul> <li>\u8d44\u6e90\u9694\u79bb\uff1a\u533a\u5206\u5e94\u7528\u670d\u52a1\u548c\u914d\u7f6e\u670d\u52a1\uff0c\u4e0d\u540c\u7684\u8d44\u6e90\u914d\u7f6e\u548c\u54cd\u5e94\u8981\u6c42\uff1b</li> <li>\u6a21\u5757\u590d\u7528\uff1a\u7ec4\u4ef6\u53ef\u590d\u7528\uff0c\u51cf\u5c11\u8026\u5408\uff1b</li> </ul> <p>\u7531\u4e24\u4e2a\u5bb9\u5668\uff08\u5e94\u7528\u7a0b\u5e8f+\u8f85\u52a9\u7a0b\u5e8f\uff09\u7ec4\u6210\u7684\u5355\u8282\u70b9\u6a21\u5f0f\u3002</p>"},{"location":"code_guide/design_pattern/container_distributed.html#_3","title":"\u8fb9\u8f66\u6a21\u5f0f","text":"<p>\u6269\u5c55\u548c\u589e\u5f3a\u5df2\u5b58\u5728\u7684\u5bb9\u5668\uff08\u5165\uff09\u3002</p> <p></p> <p>\u8fb9\u8f66\u5bb9\u5668\u7684\u4f5c\u7528\u662f\u589e\u52a0\u548c\u6539\u8fdb\u5e94\u7528\u7a0b\u5e8f\u5bb9\u5668\uff0c\u901a\u5e38\u65e0\u9700\u77e5\u9053\u5e94\u7528\u7a0b\u5e8f\u5bb9\u5668\u7684\u76f8\u5173\u4fe1\u606f\u3002</p> <ul> <li>\u5e94\u7528\u5bb9\u5668\u548c\u8fb9\u8f66\u5bb9\u5668\u5171\u4eab\u5305\u62ec\u90e8\u5206\u6587\u4ef6\u7cfb\u7edf\u3001\u4e3b\u673a\u540d\u3001\u7f51\u7edc\u7b49\u8d44\u6e90\uff1b</li> </ul> <p>\u5e94\u7528\u573a\u666f\uff0c\u5982\uff1a\u9057\u7559\u7cfb\u7edf\u7684\u6539\u9020\u548c\u6a21\u5757\u5316\u548c\u53ef\u91cd\u7528\u7ec4\u4ef6\u5c01\u88c5\u7b49</p> <ul> <li>\u7f51\u7edc\uff1a\u5165\u53e3\uff08\u5411\u4f20\u7edf\u670d\u52a1\u6dfb\u52a0HTTPS\uff09\uff1b</li> <li>\u6587\u4ef6\u7cfb\u7edf\uff1a\u521d\u59cb\u5316\u914d\u7f6e\uff0c\u914d\u7f6e\u540c\u6b65 \uff1b</li> </ul> <p>\u8fb9\u8f66\u5bb9\u5668\u7684\u8bbe\u8ba1\uff1a</p> <ul> <li>\u53c2\u6570\u5316\u5bb9\u5668\uff1a\u88ab\u590d\u7528\u7684\u57fa\u7840\uff0c\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u8fdb\u884c\u4f20\u9012 \uff1b</li> <li>\u521b\u5efa\u5bb9\u5668\u7684\u5bf9\u5916API\uff1a\u5bb9\u5668\u4e0e\u5916\u90e8\u4ea4\u4e92\u7684\u6240\u6709\u65b9\u9762\u7684\u90fd\u662f\u53ef\u91cd\u7528\u5bb9\u5668\u5b9a\u4e49\u7684API\u7684\u4e00\u90e8\u5206\uff1b</li> <li>\u6587\u6863\u5316\u5bb9\u5668\uff1a\u901a\u8fc7Dockerfile \u4e2d\u7684 LABEL \u6307\u4ee4\u7ef4\u62a4\u955c\u50cf\uff08\u8865\u5145\uff1aGIT \u5de5\u7a0b\u8bf4\u660e\u7528\u6cd5\uff09\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/container_distributed.html#_4","title":"\u9002\u914d\u5668\u6a21\u5f0f","text":"<p>\u4fee\u6539\u5e94\u7528\u5bb9\u5668\u7684\u63a5\u53e3\uff0c\u7b26\u5408\u7b2c\u4e09\u65b9\u5e94\u7528\u6240\u9700\u7684\u683c\u5f0f\u5b9a\u4e49\u3002</p> <p></p> <p>\u5e94\u7528\u573a\u666f\uff0c\u5982\uff1a\u76d1\u63a7\u3001\u65e5\u5fd7\u7b49\u8ddf\u7b2c\u4e09\u65b9\u7cfb\u7edf\u5bf9\u63a5\u65f6</p> <ul> <li>\u5e94\u7528\u5bb9\u5668\u66b4\u9732\u7edf\u4e00\u7684Prometheus\u76d1\u63a7\u63a5\u53e3\uff1b</li> <li> <p>\u5c06\u7531\u5e94\u7528\u7a0b\u5e8f\u5bb9\u5668\u516c\u5f00\u7684\u76d1\u89c6\u63a5\u53e3\u8f6c\u6362\u4e3a\u901a\u7528\u76d1\u89c6\u7cfb\u7edf\u671f\u671b\u7684\u63a5\u53e3\u5de5\u5177</p> </li> <li> <p>\u5e94\u7528\u5bb9\u5668\u65e5\u5fd7\u6d41\u6807\u51c6\u5316\u4e3a\u6807\u51c6\u4e8b\u4ef6\u96c6\uff1b</p> </li> <li>\u4e0d\u540c\u7684\u65e5\u5fd7\u8bb0\u5f55\u5e93\u4e4b\u95f4\u5dee\u5f02\u5f88\u5927\uff08\u4f8b\u5982\uff0cJava\u7684\u5185\u7f6e\u65e5\u5fd7\u8bb0\u5f55\u4e0eGo\u7684glog\u8f6f\u4ef6\u5305\uff09\uff0c\u9002\u914d\u5668\u8f6c\u6210\u5355\u4e00\u7ed3\u6784\uff1b</li> <li>\u5e94\u7528\u7a0b\u5e8f\u5bb9\u5668\u53ef\u80fd\u4f1a\u8bb0\u5f55\u65e5\u5fd7\u5230\u6587\u4ef6\uff0c\u4f46\u9002\u914d\u5668\u5bb9\u5668\u53ef\u4ee5\u5c06\u8be5\u6587\u4ef6\u91cd\u5b9a\u5411\u5230stdout</li> </ul> <p>\u4e3a\u4ec0\u4e48\u4e0d\u7b80\u5355\u5730\u4fee\u6539\u5e94\u7528\u7a0b\u5e8f\u5bb9\u5668\u672c\u8eab\uff1f</p> <ul> <li>\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u6b63\u5728\u91cd\u590d\u4f7f\u7528\u53e6\u4e00\u65b9\u751f\u4ea7\u7684\u5bb9\u5668\uff0c\u4fee\u6539\uff08\u6d3e\u751f\uff09\u6bd4\u9002\u914d\u7684\u4ee3\u4ef7\u8981\u6602\u8d35\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/container_distributed.html#_5","title":"\u5927\u4f7f\u6a21\u5f0f","text":"<p>\u4ee3\u7406\u5e94\u7528\u5bb9\u5668\u4e0e\u5916\u90e8\u4e4b\u95f4\uff08\u51fa\uff09\u7684\u4ea4\u4e92\u3002</p> <p></p> <p>\u5e94\u7528\u573a\u666f\uff0c\u5982\uff1a\uff08\u5c06\u4f9d\u8d56\u4ece\u5305\u5f15\u5165\u53d8\u6210\u672c\u5730\u7f51\u8def\u8c03\u7528\uff0c\u5173\u6ce8\u70b9\u5206\u79bb\uff09</p> <ul> <li>\u5916\u51fa\u6d41\u91cf\u7684\u8d1f\u8f7d\u5747\u8861\uff08\u5982Redis \u5206\u7247\uff09\uff1b</li> <li>\u5916\u51fa\u6d41\u91cf\u7684\u670d\u52a1\u4ee3\u7406\uff08\u89e3\u8026\u670d\u52a1\u53d1\u73b0\uff09\uff1b</li> <li>\u5916\u51fa\u6d41\u91cf\u7684\u62c6\u5206\uff08\u84dd\u7eff\u90e8\u7f72\uff0c\u8bf7\u6c42\u91cd\u653e\u7b49\uff09\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/container_distributed.html#_6","title":"\u670d\u52a1\uff08\u591a\u8282\u70b9\uff09\u6a21\u5f0f","text":"<p>\u5fae\u670d\u52a1\u7684\u4f18\u70b9\uff1a</p> <ul> <li>\u5c06\u5e94\u7528\u7a0b\u5e8f\u5206\u89e3\u4e3a\u66f4\u5c0f\u7684\u6a21\u5757\uff0c\u6bcf\u4e2a\u5c0f\u6a21\u5757\u4e13\u6ce8\u4e8e\u63d0\u4f9b\u7279\u5b9a\u7684\u670d\u52a1\uff1b</li> <li>\u4e0d\u540c\u7684\u5fae\u670d\u52a1\u95f4\u5f15\u5165\u6b63\u5f0fAPI\u4f7f\u56e2\u961f\u5f7c\u6b64\u8d1f\u8d23\uff0c\u540c\u65f6\u63d0\u4f9b\u53ef\u9760\u7684\u7ea6\u5b9a\uff1b</li> <li>\u5b9e\u73b0\u66f4\u9ad8\u7684\u6269\u5c55\u6027\uff0c\u4e0d\u540c\u7684\u7ec4\u4ef6\u670d\u52a1\u5176\u6269\u5c55\u6027\u901f\u7387\u8981\u6c42\u4e0d\u4e00\u6837\uff1b</li> </ul> <p>\u5fae\u670d\u52a1\u7684\u7f3a\u70b9\uff1a</p> <ul> <li>\u7cfb\u7edf\u677e\u8026\u5408\uff0c\u6545\u969c\u65f6\u7684\u8c03\u8bd5\u8981\u66f4\u56f0\u96be\uff1b</li> <li>\u57fa\u4e8e\u5fae\u670d\u52a1\u7684\u7cfb\u7edf\u4e5f\u5f88\u96be\u8bbe\u8ba1\u548c\u67b6\u6784\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/container_distributed.html#_7","title":"\u590d\u5236\u670d\u52a1","text":"<p>\u57fa\u4e8e\u526f\u672c\u7684\u8d1f\u8f7d\u5747\u8861\uff0c\u63d0\u9ad8\u6bcf\u79d2\u7684\u8bf7\u6c42\u6570\u91cf\u3002</p> <p>\u65e0\u72b6\u6001\u670d\u52a1\uff08Serverless\uff09\uff1a\u4e0d\u9700\u8981\u4fdd\u5b58\u72b6\u6001\u5373\u53ef\u6b63\u5e38\u8fd0\u884c\u7684\u670d\u52a1\u3002</p> <p>\u4f1a\u8bdd\u8ddf\u8e2a\u670d\u52a1\uff1a\u786e\u4fdd\u7528\u6237\u7684\u6240\u6709\u8bf7\u6c42\u90fd\u56fa\u5b9a\u6620\u5c04\u5230\u540c\u4e00\u90e8\u5206\u3002</p> <p>\u5f00\u53d1\u548c\u90e8\u7f72\u5c31\u7eea\u63a2\u6d4b\u5668\u4ee5\u534f\u8c03\u8d1f\u8f7d\u5747\u8861\u5f88\u91cd\u8981\uff1a</p> <ul> <li>\u786e\u5b9a\u670d\u52a1\u90e8\u5206\u662f\u5426\u51c6\u5907\u597d\u4e3a\u7528\u6237\u8bf7\u6c42\u63d0\u4f9b\u670d\u52a1\uff1b</li> </ul> <p>\u4f1a\u8bdd\u8ddf\u8e2a\uff1a\u96c6\u7fa4\u5185\u4f1a\u8bdd\u53ef\u91c7\u7528 IP Hash\uff0c\u5916\u90e8\u4f1a\u8bdd\uff08\u5b58\u5728NAT\uff09\u91c7\u7528\u5e94\u7528\u7ea7\u8ddf\u8e2a\uff08\u5982\u901a\u8fc7Cookie\uff09\uff1a</p> <ul> <li>\u57fa\u4e8e\u4e00\u81f4\u6027Hash\uff0c\u670d\u52a1\u589e/\u51cf\u65f6\u6700\u5927\u9650\u5ea6\u51cf\u5c11\u9700\u8981\u91cd\u65b0\u8bbe\u8ba1\u7684\u8bf7\u6c42\u6570\uff1b</li> <li>nginx\u7684\u8d1f\u8f7d\u5747\u8861 upstream \u652f\u6301 \u4e00\u81f4\u6027 hash\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/container_distributed.html#_8","title":"\u5206\u7247\u670d\u52a1","text":"<p>\u8bbe\u8ba1\u5206\u7247\u51fd\u6570\u7684\u952e\u5bf9\u4e8e\u8bbe\u8ba1\u5206\u7247\u7cfb\u7edf\u81f3\u5173\u91cd\u8981\u3002</p> <p>\u652f\u6491\u66f4\u5927\u7684\u6570\u636e\u3002</p> <p>\u5206\u7247\u670d\u52a1\u591a\u7528\u4e8e\u6784\u5efa\u4e8e\u6709\u72b6\u6001\u670d\u52a1\uff0c\u6bcf\u4e2a\u5206\u7247\u53ea\u80fd\u4e3a\u7279\u5b9a\u7684\u4e00\u90e8\u5206\u8bf7\u6c42\u63d0\u4f9b\u670d\u52a1\u3002</p> <ul> <li>\u6570\u636e\u91cf\u592a\u5927\uff0c\u5355\u8282\u70b9\u65e0\u6cd5\u5904\u7406\uff0c\u5982 Redis \u96c6\u7fa4\uff1b</li> </ul> <p>\u5206\u7247\u7f13\u5b58\u670d\u52a1\uff1a</p> <ul> <li>\u7f13\u5b58\u672a\u547d\u4e2d\u4e0d\u662f\u672c\u8d28\u95ee\u9898\uff0c\u7cfb\u7edf\u4f1a\u91cd\u65b0\u8ba1\u7b97\u5f97\u5230\u6570\u636e\uff0c\u4f46\u4f1a\u9020\u6210\u6027\u80fd\u5f71\u54cd\uff1b</li> <li>\u652f\u6301\u591a\u526f\u672c\u7684\u7f13\u5b58\u5206\u7247\uff1b</li> <li>\u70ed\u5206\u7247\uff1a\u67d0\u4e2a\u7279\u5b9a\u7684\u5206\u7247\u627f\u62c5\u5f02\u5e38\u5e9e\u5927\u7684\u8d1f\u8f7d\uff0c\u4e3a\u6bcf\u4e2a\u5206\u7247\u8bbe\u7f6e\u81ea\u52a8\u4f38\u7f29\u3002</li> </ul>"},{"location":"code_guide/design_pattern/container_distributed.html#_9","title":"\u5206\u6563\u6a21\u5f0f\u548c\u805a\u96c6\u6a21\u5f0f","text":"<p>\u65f6\u95f4\u89d2\u5ea6\u4f7f\u7528\u590d\u5236\u6280\u672f\u63d0\u9ad8\u53ef\u6269\u5c55\u6027\u3002</p> <p>\u6bcf\u4e2a\u526f\u672c\u6267\u884c\u5c11\u91cf\u5904\u7406\uff0c\u7ed3\u679c\u8fd4\u56de\u6839\u8282\u70b9\uff0c\u6839\u8282\u70b9\u5c06\u90e8\u5206\u7ed3\u679c\u7ec4\u5408\u5f62\u6210\u5b8c\u6574\u54cd\u5e94\u8fd4\u56de\u7ed9\u524d\u7aef\u3002</p> <p>\u573a\u666f\uff1a\u5982 HBase</p> <ul> <li>\u5206\u5e03\u5f0f\u6587\u6863\u641c\u7d22\uff0c\u5982\u591a\u4e2a\u5173\u952e\u5b57\u5e76\u884c\u641c\u7d22\uff0c\u7ed3\u679c\u805a\u5408\uff1b</li> <li>\u590d\u5236\u7684\u5206\u6563/\u6536\u96c6\u7cfb\u7edf\uff0c\u603b\u6570\u636e\u91cf\u8d85\u8fc7\u5355\u8282\u70b9\u5185\u5b58/\u78c1\u76d8\u65f6\uff0c\u5f15\u5165\u5206\u7247\uff1b</li> <li>\u4e0e\u5206\u7247\u670d\u52a1\u4e0d\u540c\uff0c\u8fd9\u91cc\u6240\u6709\u7684\u5206\u7247\u90fd\u9700\u8981\u8fdb\u884c\u8bf7\u6c42\u54cd\u5e94\uff1b</li> <li>\u8bbe\u7f6e\u5408\u7406\u7684\u53f6\u8282\u70b9\uff08\u5206\u7247\uff09\u6570\uff0c\u52a0\u901f\u6bd4\u6536\u76ca\u3001straggler\u95ee\u9898\u3001\u53ef\u7528\u6027\u95ee\u9898\uff1b</li> <li>\u5206\u7247\u7684\u5206\u6563/\u805a\u96c6\u7cfb\u7edf\uff0c\u91c7\u7528\u591a\u526f\u672c\u4fdd\u8bc1\u53ef\u7528\u6027\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/container_distributed.html#_10","title":"\u51fd\u6570\u4e0e\u4e8b\u4ef6\u9a71\u52a8\u5904\u7406","text":"<p>Function as a Service, FaaS.</p> <p>\u4e8b\u4ef6\u9a71\u52a8\u7684FaaS\u548c\u66f4\u5e7f\u6cdb\u7684\u65e0\u670d\u52a1\u5668\u8ba1\u7b97\u6982\u5ff5\u662f\u6709\u533a\u522b\uff1a</p> <ul> <li>\u591a\u79df\u6237\u5bb9\u5668\u7f16\u6392\u5668\uff08container-as-a-service\uff09\u662f\u65e0\u670d\u52a1\u5668\uff0c\u4f46\u4e0d\u662f\u4e8b\u4ef6\u9a71\u52a8\uff1b</li> <li>\u7269\u7406\u96c6\u7fa4\u7684\u5f00\u6e90Faas\u662f\u4e8b\u4ef6\u9a71\u52a8\uff0c\u4f46\u4e0d\u662f\u65e0\u670d\u52a1\u5668\uff1b</li> </ul> <p>\u4f18\u52bf\uff1a</p> <ul> <li>\u7b80\u5316\u4ee3\u7801\u5f00\u53d1\u5230\u670d\u52a1\u53d1\u5e03\u7684\u6574\u4e2a\u6d41\u7a0b\uff1b</li> <li>\u826f\u597d\u7684\u53ef\u7ba1\u7406\u6027\u548c\u81ea\u52a8\u4f38\u7f29\u80fd\u529b\uff1b</li> <li>\u66f4\u52a0\u6a21\u5757\u5316\u548c\u7ed3\u6784\u3002</li> </ul> <p>\u6311\u6218\uff1a</p> <ul> <li>\u670d\u52a1\u64cd\u4f5c\u66f4\u52a0\u590d\u6742\uff0c\u72b6\u6001\u5b58\u50a8\u5728\u67d0\u4e2a\u5b58\u50a8\u670d\u52a1\u4e2d\uff1b</li> <li>\u5f88\u96be\u83b7\u5f97\u5bf9\u670d\u52a1\u5168\u9762\u638c\u63a7\uff0c\u5982Faas\u4ea7\u751f\u5faa\u73af\u8c03\u7528\uff1b</li> </ul> <p>\u4e0d\u9002\u7528\uff1a</p> <ul> <li>\u5927\u91cf\u5904\u7406\u5f00\u9500\u7684\u573a\u666f\u548c\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u540e\u53f0\u8ba1\u7b97\uff08Faas\u4e00\u822c\u6309\u8bf7\u6c42\u6b21\u6570\u8ba1\u8d39\uff09\uff1b</li> <li>\u5c06\u5927\u91cf\u6570\u636e\u52a0\u8f7d\u5230\u5185\u5b58\u4ee5\u5904\u7406\u7528\u6237\u8bf7\u6c42\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/container_distributed.html#_11","title":"\u6240\u6709\u6743\u9009\u4e3e","text":"<p>\u9ad8\u53ef\u7528\u95ee\u9898\uff0c\u4e3b\u526f\u672c\u9009\u4e3e\uff1a</p> <ul> <li>\u5b9e\u73b0\u7c7b\u4f3c Paxos/Raft \u7684\u5206\u5e03\u5f0f\u4e00\u81f4\u6027\u7b97\u6cd5\uff1b</li> <li>\u57fa\u4e8e\u5df2\u6709\u7684\u5206\u5e03\u5f0f\u952e\u503c\u5b58\u50a8\uff0c\u5982<code>etcd</code>, <code>Zookeeper</code>\uff0c\u901a\u8fc7\u9501\u670d\u52a1\uff0c\u5b9e\u73b0\u4e3b/\u526f\uff1b</li> </ul> <p>\u9501\u670d\u52a1\uff1a</p> <ul> <li>\u901a\u8fc7TTL\u907f\u514d\u8fdb\u7a0b\u5728\u6301\u6709\u9501\u671f\u95f4\u5931\u8d25\u65f6\u65e0\u4eba\u53ef\u4ee5\u91ca\u653e\u9501\u7684\u95ee\u9898\uff1b</li> <li>\u63d0\u4f9b\u5e26\u7248\u672c\u4fe1\u606f\u7684\u652f\u6301\uff0c\u907f\u514d\u9501\u7684TTL\u8fc7\u671f\u5bfc\u81f4\u591a\u8fdb\u7a0b\u7533\u8bf7\u9501\u6210\u529f\uff1b</li> <li>\u8fdb\u7a0b1 \u83b7\u53d6\u9501\uff08TTL\uff09\uff0c\u6267\u884c\u8d85\u65f6\uff0c\u91ca\u653e\u9501\uff1b</li> <li>\u8fdb\u7a0b2 \u518d\u8d85\u65f6\u540e\u83b7\u53d6\u9501\uff0c\u8fdb\u7a0b1\u91ca\u653e\u7684\u662f\u8fdb\u7a0b2\u83b7\u53d6\u7684\u9501\uff1b</li> <li> <p>\u8fdb\u7a0b3 \u83b7\u53d6\u8fdb\u7a0b1\u91ca\u653e\u7684\u9501\uff0c\u6b64\u65f6\u8fdb\u7a0b2\u548c\u8fdb\u7a0b3\u90fd\u8ba4\u4e3a\u81ea\u5df1\u83b7\u53d6\u9501\uff1b</p> </li> <li> <p>\u6301\u7eed\u8fd0\u884c\u4e8b\u4ef6\u83b7\u53d6\u6240\u6709\u6743\u65f6\uff0c\u901a\u8fc7\u5355\u72ec\u7684\u7ebf\u7a0b\u6bcfTTL/2\u7684\u65f6\u95f4\u66f4\u65b0\u9501\u7684TTL\uff1b</p> </li> <li>\u53d1\u9001\u8bf7\u6c42\u65f6\u9644\u5e26\u5f53\u524d\u7684\u8d44\u6e90\u7248\u672c\u53f7\uff0c\u907f\u514d\u6240\u6709\u6743\u83b7\u53d6\uff08\u6b64\u65f6\u53d1\u9001\u8bf7\u6c42\uff09\u3001\u4e22\u5931\u3001\u518d\u83b7\u5f97\uff08\u6b64\u65f6\u8bf7\u6c42\u624d\u5904\u7406\uff09\u7684\u95ee\u9898</li> </ul>"},{"location":"code_guide/design_pattern/container_distributed.html#_12","title":"\u6279\u5904\u7406\u8ba1\u7b97\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/container_distributed.html#_13","title":"\u5de5\u4f5c\u961f\u5217\u7cfb\u7edf","text":"<p>\u6700\u7b80\u5355\u7684\u6279\u5904\u7406\u5f62\u5f0f\u662f\u5de5\u4f5c\u961f\u5217\uff0c\u5de5\u4f5c\u961f\u5217\u7cfb\u7edf\u5305\u542b\u4e00\u7ec4\u8981\u88ab\u6267\u884c\u7684\u6279\u5904\u7406\u4efb\u52a1\u3002</p> <p>\u5de5\u4f5c\u961f\u5217\u7cfb\u7edf\u7684\u76ee\u7684\u662f\u786e\u4fdd\u961f\u5217\u4e2d\u7684\u5de5\u4f5c\u7684\u6bcf\u9879\u4efb\u52a1\u80fd\u591f\u5728\u6307\u5b9a\u65f6\u95f4\u5185\u6267\u884c\u5b8c\u6210\u3002</p> <ul> <li>\u6267\u884c\u5668\u6570\u91cf\u53ef\u4ee5\u4f38\u7f29\uff0c\u786e\u4fdd\u5de5\u4f5c\u53ef\u88ab\u6309\u65f6\u5b8c\u6210\uff1b</li> </ul> <p>\u6784\u5efa\u57fa\u4e8e\u5bb9\u5668\u7684\u53ef\u91cd\u7528\u5de5\u4f5c\u961f\u5217\u9700\u8981\u5b9a\u4e49\u901a\u7528\u5e93\u5bb9\u5668\u548c\u7528\u6237\u5b9a\u4e49\u7684\u5e94\u7528\u903b\u8f91\u4e4b\u95f4\u7684\u63a5\u53e3\u3002</p> <ul> <li> <p>\u6e90\u5bb9\u5668\u63a5\u53e3\uff1a\u63d0\u4f9b\u9700\u8981\u5904\u7406\u7684\u5de5\u4f5c\u9879\u6d41\uff08\u5bf9\u63a5\u5916\u90e8\u5de5\u4f5c\u961f\u5217\u6e90\uff0c\u5982Kafka/Redis\uff09\uff1b</p> </li> <li> <p>\u6267\u884c\u5668\u5bb9\u5668\u63a5\u53e3\uff1a\u5904\u7406\u5b9e\u9645\u5de5\u4f5c\u9879\uff1b</p> </li> </ul> <p>\u5c06\u7279\u5b9a\u4e8e\u5e94\u7528\u7684\u961f\u5217\u6e90\u903b\u8f91\uff08\u8bf7\u6c42\u4ee3\u7406\u5230\u5916\u90e8\uff09\u4e0e\u901a\u7528\u961f\u5217\u5904\u7406\u903b\u8f91\uff08\u4e3b\u5bb9\u5668\uff09\u5206\u5f00\uff08\u5927\u4f7f\u6a21\u5f0f\uff09\uff1a</p> <ul> <li>\u5927\u4f7f\u5bb9\u5668\u867d\u7136\u7279\u5b9a\u4e8e\u5e94\u7528\uff0c\u4f46\u6e90API\u4e5f\u6709\u901a\u7528\u5b9e\u73b0\uff08\u5982Kafka\uff0c\u53ef\u4ee5\u91cd\u7528\u5bb9\u5668\u7b80\u5316\u5de5\u4f5c\uff09</li> <li>\u5de5\u4f5c\u961f\u5217\u7ba1\u7406\u5668\u672c\u8eab\u8d1f\u8d23\u8ddf\u8e2a\u54ea\u4e9b\u9879\u76ee\u5df2\u5904\u7406\u5b8c\u6bd5\u548c\u9700\u8981\u88ab\u5904\u7406\uff1b</li> </ul> <p>\u5de5\u4f5c\u961f\u5217\u7684\u57fa\u672c\u6d41\u7a0b\uff1a(\u901a\u8fc7 K8s Job\u53ef\u4ee5\u83b7\u53d6\u6b63\u5728\u5904\u7406\u4e2d\u7684\u5de5\u4f5c\u9879\u6216\u8005\u6210\u529f/\u5931\u8d25\u7684\u5de5\u4f5c\u9879\u3002)</p> <ol> <li>\u8c03\u7528\u6e90\u5bb9\u5668\u63a5\u53e3\u52a0\u8f7d\u53ef\u7528\u7684\u5de5\u4f5c\uff1b</li> <li>\u67e5\u8be2\u5de5\u4f5c\u961f\u5217\u72b6\u6001\u786e\u5b9a\u5df2\u5904\u7406\u6216\u76ee\u524d\u6b63\u5728\u5904\u7406\u7684\u5de5\u4f5c\u9879\uff1b</li> <li>\u5bf9\u4e8e\u8981\u5904\u7406\u7684\u5de5\u4f5c\u9879\uff0c\u751f\u6210\u8c03\u7528\u6267\u884c\u5668\u5bb9\u5668\u63a5\u53e3\u5904\u7406\u5de5\u4f5c\u9879\u7684\u4f5c\u4e1a\uff1b</li> <li>\u5f53\u5176\u4e2d\u4e00\u4e2a\u6267\u884c\u5668\u5bb9\u5668\u6210\u529f\u5b8c\u6210\u65f6\uff0c\u8bb0\u5f55\u5df2\u5b8c\u6210\u7684\u5de5\u4f5c\u3002</li> </ol> <p>\u7a33\u5b9a\u7684\u5de5\u4f5c\u961f\u5217\uff1a</p> <ul> <li>\u65b0\u5de5\u4f5c\u5230\u8fbe\u7684\u95f4\u9694\u65f6\u95f4\uff08\u8bb0\u5f55\u8f83\u957f\u65f6\u95f4\u5185\u6536\u5230\u7684\u5de5\u4f5c\u9879\u6570\u91cf\u8ba1\u7b97\uff09\uff1b</li> <li>\u5de5\u4f5c\u5904\u7406\u7684\u5e73\u5747\u65f6\u95f4\uff1b</li> <li>\u6269\u5bb9\uff1a\u8c03\u6574\u8d44\u6e90\u4f7f\u5f97\uff0c\u5de5\u4f5c\u9879\u5904\u7406\u5e73\u5747\u65f6\u95f4 &lt; \u65b0\u5de5\u4f5c\u5230\u8fbe\u7684\u95f4\u9694\u65f6\u95f4</li> <li>\u7f29\u5bb9\uff1a\u8c03\u6574\u8d44\u6e90\u4f7f\u5f97\uff0c\u5de5\u4f5c\u9879\u5904\u7406\u5e73\u5747\u65f6\u95f4 = 90% \u00d7 \u65b0\u5de5\u4f5c\u5230\u8fbe\u7684\u95f4\u9694\u65f6\u95f4</li> </ul>"},{"location":"code_guide/design_pattern/container_distributed.html#_14","title":"\u4e8b\u4ef6\u9a71\u52a8\u7684\u6279\u5904\u7406","text":"<p>\u5de5\u4f5c\u6d41\u7cfb\u7edf\uff0c\u5305\u542b\u4e00\u4e2a\u6709\u5411\u65e0\u73af\u56fe\u7684\u5de5\u4f5c\u6d41\u7a0b\uff0c\u63cf\u8ff0\u6d41\u7a0b\u5404\u4e2a\u9636\u6bb5\u53ca\u5176\u76f8\u4e92\u534f\u4f5c\u3002</p> <ul> <li>\u5982\u679c\u6ca1\u6709\u5173\u4e8e\u5404\u4e2a\u4e8b\u4ef6\u961f\u5217\u5982\u4f55\u76f8\u4e92\u5173\u8054\u7684\u603b\u4f53\u84dd\u56fe\uff0c\u5219\u5f88\u96be\u5b8c\u5168\u7406\u89e3\u7cfb\u7edf\u7684\u8fd0\u884c\u65b9\u5f0f\uff1b</li> </ul> <p>\u591a\u4e2a\u4e0d\u540c\u961f\u5217\u7684\u534f\u4f5c\u6216\u4fee\u6539\u4e00\u4e2a/\u591a\u4e2a\u5de5\u4f5c\u961f\u5217\u8f93\u51fa\u7684\u6a21\u5f0f\uff1a</p> <ul> <li>\u590d\u5236\u5668\uff1a\u83b7\u53d6\u5355\u4e2a\u5de5\u4f5c\u9879\u6d41\u51b0\u5c06\u5176\u590d\u5236\u5230\u4e24\u4e2a/\u591a\u4e2a\u6d41\u4e2d\uff0c\u5982\u89c6\u9891\u6e32\u67d3\uff0c\u539f\u89c6\u9891\u6e32\u67d3\u4e3a\u4e0d\u540c\u5206\u7247\u7387\u7684\u683c\u5f0f\uff1b</li> <li>\u8fc7\u6ee4\u5668\uff1a\u8fc7\u6ee4\u6389\u4e0d\u7b26\u5408\u7279\u5b9a\u6761\u4ef6\u7684\u5de5\u4f5c\u9879\uff1b</li> <li>\u5206\u79bb\u5668\uff1a\u5c06\u5de5\u4f5c\u9879\u7684\u4e24\u4e2a\u4e0d\u540c\u7684\u8f93\u5165\u5206\u6210\u4e24\u4e2a\u72ec\u7acb\u7684\u961f\u5217\uff1b</li> <li>\u5206\u7247\u5668\uff1a\u7279\u6b8a\u7684\u5206\u79bb\u5668\uff0c\u6309\u7167\u67d0\u79cd\u5206\u7247\u7b97\u6cd5\u5c06\u5355\u4e2a\u961f\u5217\u5212\u5206\u4e3a\u5747\u5300\u5206\u5e03\u7684\u5de5\u4f5c\u96c6\u5408\uff1b</li> <li>\u5408\u5e76\u5668\uff1a\u590d\u5236\u5668\u76f8\u53cd\uff0c\u5c06\u4e24\u4e2a\u4e0d\u540c\u7684\u5de5\u4f5c\u961f\u5217\u8f6c\u6362\u4e3a\u5355\u4e2a\u5de5\u4f5c\u961f\u5217\u3002</li> </ul> <p>\u7ba1\u7406\u901a\u8fc7\u4e8b\u4ef6\u9a71\u52a8\u5de5\u4f5c\u6d41\u4f20\u9012\u7684\u6570\u636e\u6d41\uff1a\u53d1\u5e03\u8005/\u8ba2\u9605\u8005\u670d\u52a1\uff1b</p>"},{"location":"code_guide/design_pattern/container_distributed.html#_15","title":"\u534f\u8c03\u6279\u5904\u7406","text":"<p>\u5c06\u591a\u4e2a\u8f93\u51fa\u5408\u5e76\u5230\u4e00\u8d77\u751f\u6210\u67d0\u79cd\u805a\u5408\u8f93\u51fa\uff08Reduce\uff09\uff0c\u8fdb\u5165\u5de5\u4f5c\u6d41\u4e0b\u4e00\u4e2a\u9636\u6bb5\u4e4b\u524d\u62e5\u6709\u5b8c\u6574\u7684\u5de5\u4f5c\u96c6\u3002</p> <p>\u8fde\u63a5\u6a21\u5f0f\uff1a\u5e76\u53d1\u8fc7\u7a0b\u4e2d\u7684\u6805\u680f\u540c\u6b65\u3002</p> <ul> <li>\u6240\u6709\u5de5\u4f5c\u90fd\u662f\u5e76\u884c\u7684\uff0c\u4f46\u662f\u5b8c\u6210\u5e76\u884c\u5904\u7406\u7684\u6240\u6709\u5de5\u4f5c\u9879\u4e4b\u524d\uff0c\u5de5\u4f5c\u9879\u4e0d\u4f1a\u4ece\u8fde\u63a5\u4e2d\u91ca\u653e\u51fa\u6765\uff1b</li> <li>\u53ef\u786e\u4fdd\u5728\u6267\u884c\u67d0\u79cd\u805a\u5408\u9636\u6bb5\u4e4b\u524d\u6ca1\u6709\u6570\u636e\u4e22\u5931\uff1b</li> </ul> <p>Reduce\uff1a\u4e0d\u662f\u7b49\u5230\u6240\u6709\u6570\u636e\u90fd\u88ab\u5904\u7406\uff0c\u800c\u4ee5\u4e50\u89c2\u65b9\u5f0f\u5c06\u6240\u6709\u5e76\u884c\u6570\u636e\u9879\u5408\u5e76\u5230\u4e00\u4e2a\u5b8c\u6574\u96c6\u5408\u7684\u5355\u4e2a\u7efc\u5408\u8868\u793a\u4e2d\uff1b</p> <ul> <li>\u53ef\u4ee5\u5e76\u884c\u542f\u52a8reduce\uff0c\u6b64\u65f6\u4f5c\u4e3amap/shard\u9636\u6bb5\u7684\u4e00\u90e8\u5206\u4ecd\u7136\u5728\u8fdb\u884c\uff1b</li> <li>\u867d\u7136\u5fc5\u987b\u5904\u7406\u6240\u6709\u7684\u6570\u636e\uff0c\u4f46\u662f\u63d0\u524d\u5f00\u59cb\u53ef\u8ba9\u6574\u4f53\u6392\u91cf\u8ba1\u7b97\u6267\u884c\u66f4\u5feb\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/container_distributed.html#_16","title":"\u53c2\u8003\u6587\u732e","text":"<p>[1] Burns B, Oppenheimer D. Design patterns for container-based distributed systems.[C]//8th USENIX Workshop on Hot Topics in Cloud Computing (HotCloud 16). 2016.</p> <p>[2] Burns B. Designing distributed systems: patterns and paradigms for scalable, reliable services[M]. \" O'Reilly Media, Inc.\", 2018.</p>"},{"location":"code_guide/design_pattern/decorator.html","title":"\u88c5\u9970\u5668\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/decorator.html#_2","title":"\u610f\u56fe","text":"<p>\u52a8\u6001\u5730\u7ed9\u4e00\u4e2a\u5bf9\u8c61\u6dfb\u52a0\u4e00\u4e9b\u989d\u5916\u7684\u804c\u8d23\u3002\u5c31\u589e\u52a0\u529f\u80fd\u6765\u8bf4\uff0cDecorator\u6a21\u5f0f\u76f8\u6bd4\u751f\u6210\u5b50\u7c7b\u66f4\u7075\u6d3b\u3002</p>"},{"location":"code_guide/design_pattern/decorator.html#_3","title":"\u9002\u7528\u6027","text":"<ul> <li>\u5728\u4e0d\u5f71\u54cd\u5176\u4ed6\u5bf9\u8c61\u7684\u60c5\u51b5\u4e0b\uff0c\u4ee5\u52a8\u6001\u3001\u900f\u660e\u7684\u65b9\u5f0f\u7ed9\u5355\u4e2a\u5bf9\u8c61\u6dfb\u52a0\u804c\u8d23\uff1b</li> <li>\u5904\u7406\u90a3\u4e9b\u53ef\u4ee5\u64a4\u9500\u7684\u804c\u8d23\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/decorator.html#_4","title":"\u7c7b","text":"<p>Decator\u7ee7\u627fComponent\uff0c\u4f7f\u7528Component\u5bf9\u8c61\uff0c\u5e76\u6dfb\u52a0\u989d\u5916\u7684\u65b9\u6cd5\u3002\uff08\u5b9e\u4f8b\uff1aJava\u79cd\u7684\u6d41\uff09</p> <p></p> <ol> <li>\u62bd\u8c61\u6784\u4ef6(Component)\u89d2\u8272\uff1a\u7ed9\u51fa\u4e00\u4e2a\u62bd\u8c61\u63a5\u53e3\uff0c\u4ee5\u89c4\u8303\u51c6\u5907\u63a5\u6536\u9644\u52a0\u8d23\u4efb\u7684\u5bf9\u8c61\u3002</li> <li>\u5177\u4f53\u6784\u4ef6(ConcreteComponent)\u89d2\u8272\uff1a\u5b9a\u4e49\u4e00\u4e2a\u5c06\u8981\u63a5\u6536\u9644\u52a0\u8d23\u4efb\u7684\u7c7b\u3002</li> <li>\u88c5\u9970(Decorator)\u89d2\u8272\uff1a\u6301\u6709\u4e00\u4e2a\u6784\u4ef6(Component)\u5bf9\u8c61\u7684\u5b9e\u4f8b\uff0c\u5e76\u5b9a\u4e49\u4e00\u4e2a\u4e0e\u62bd\u8c61\u6784\u4ef6\u63a5\u53e3\u4e00\u81f4\u7684\u63a5\u53e3\u3002</li> <li>\u5177\u4f53\u88c5\u9970(ConcreteDecorator)\u89d2\u8272\uff1a\u8d1f\u8d23\u7ed9\u6784\u4ef6\u5bf9\u8c61\u201c\u8d34\u4e0a\u201d\u9644\u52a0\u7684\u8d23\u4efb\u3002</li> </ol>"},{"location":"code_guide/design_pattern/decorator.html#_5","title":"\u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a</p> <ul> <li>\u88c5\u9970\u6a21\u5f0f\u53ef\u4ee5\u63d0\u4f9b\u6bd4\u7ee7\u627f\u66f4\u591a\u7684\u7075\u6d3b\u6027\u3002\u88c5\u9970\u6a21\u5f0f\u5141\u8bb8\u7cfb\u7edf\u52a8\u6001\u51b3\u5b9a\u201c\u8d34\u4e0a\u201d\u4e00\u4e2a\u9700\u8981\u7684\u201c\u88c5\u9970\u201d\uff0c\u6216\u8005\u9664\u6389\u4e00\u4e2a\u4e0d\u9700\u8981\u7684\u201c\u88c5\u9970\u201d\u3002\u7ee7\u627f\u5173\u7cfb\u5219\u4e0d\u540c\uff0c\u7ee7\u627f\u5173\u7cfb\u662f\u9759\u6001\u7684\uff0c\u5b83\u5728\u7cfb\u7edf\u8fd0\u884c\u524d\u5c31\u51b3\u5b9a\uff1b</li> <li>\u907f\u514d\u5728\u5c42\u6b21\u7ed3\u6784\u9ad8\u5c42\u7684\u7c7b\u6709\u592a\u591a\u7684\u7279\u5f81\uff1b</li> <li>\u6bd4\u4f7f\u7528\u7ee7\u627f\u5173\u7cfb\u9700\u8981\u8f83\u5c11\u6570\u76ee\u7684\u7c7b\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u4f7f\u7528\u88c5\u9970\u6a21\u5f0f\u4f1a\u4ea7\u751f\u6bd4\u4f7f\u7528\u7ee7\u627f\u5173\u7cfb\u66f4\u591a\u7684\u5bf9\u8c61\uff0c\u591a\u7684\u5bf9\u8c61\u4f1a\u4f7f\u5f97\u67e5\u9519\u53d8\u5f97\u56f0\u96be\uff0c\u7279\u522b\u662f\u8fd9\u4e9b\u5bf9\u8c61\u770b\u4e0a\u53bb\u90fd\u5f88\u76f8\u50cf\u3002</li> </ul>"},{"location":"code_guide/design_pattern/decorator.html#_6","title":"\u793a\u4f8b","text":"<p>Java\u6e90\u7801\u4e2d\u6587\u4ef6\u6d41\u7684\u76f8\u5173\u8bbe\u8ba1\uff08\u591a\u79cd\u8bfb\u53d6\u3001\u6027\u80fd\u65b9\u5f0f\u7684\u7ec4\u5408\uff09\uff1a</p> <ul> <li>java.io.BufferedReade\uff08Decorator Implementation\uff09;  </li> <li>java.io.FileReader\uff08ConcrentComponent\uff09;   </li> <li>java.io.Reader\uff08Component\uff09;</li> </ul> <p>AOP\uff0c\u5207\u9762\u7684\u5b9e\u73b0\uff0c\u4e5f\u79f0\u4e3a\u88c5\u9970\u5668\u3002</p>"},{"location":"code_guide/design_pattern/facade.html","title":"\u5916\u89c2\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/facade.html#_2","title":"\u610f\u56fe","text":"<p>\u4e3a\u5b50\u7cfb\u7edf\u79cd\u7684\u4e00\u7ec4\u63a5\u53e3\u63d0\u4f9b\u4e00\u4e2a\u4e00\u81f4\u7684\u754c\u9762\uff0cFacade\u6a21\u5f0f\u5b9a\u4e49\u4e00\u4e2a\u9ad8\u5c42\u7684\u63a5\u53e3\uff0c\u4f7f\u5f97\u8fd9\u4e00\u5b50\u7cfb\u7edf\u66f4\u5bb9\u6613\u4f7f\u7528\u3002</p>"},{"location":"code_guide/design_pattern/facade.html#_3","title":"\u9002\u7528\u6027","text":"<ul> <li>\u4e3a\u590d\u6742\u7684\u5b50\u7cfb\u7edf\u63d0\u4f9b\u7b80\u5355\u63a5\u53e3\u65f6\uff1b</li> <li>\u5ba2\u6237\u7a0b\u5e8f\u548c\u62bd\u8c61\u7c7b\u7684\u5b9e\u73b0\u90e8\u5206\u5b58\u5728\u5f88\u5927\u7684\u4f9d\u8d56\u6027\uff1b</li> <li>\u6784\u5efa\u5c42\u6b21\u7ed3\u6784\u7684\u5b50\u7cfb\u7edf\u65f6\uff0c\u5b50\u7cfb\u7edf\u95f4\u901a\u8fc7Facade\u901a\u4fe1\uff0c\u7b80\u5316\u4f9d\u8d56\u5173\u7cfb\uff1b</li> </ul> <p>\u4f7f\u7528\u573a\u666f\uff1a\u5982MVC\u4e09\u5c42\u67b6\u6784\uff0c\u5728\u6570\u636e\u8bbf\u95ee\u5c42\u548c\u4e1a\u52a1\u903b\u8f91\u5c42\u3001\u4e1a\u52a1\u903b\u8f91\u5c42\u548c\u8868\u793a\u5c42\u7684\u5c42\u4e0e\u5c42\u4e4b\u95f4\u5efa\u7acb\u5916\u89c2Facade\uff0c\u964d\u4f4e\u8026\u5408</p>"},{"location":"code_guide/design_pattern/facade.html#_4","title":"\u7c7b\u56fe","text":"<p>\u5173\u952e\u4ee3\u7801\uff1a\u5728\u5ba2\u6237\u7aef\u548c\u590d\u6742\u7cfb\u7edf\u4e4b\u95f4\u518d\u52a0\u4e00\u5c42\uff0c\u8fd9\u4e00\u5c42\u5c06\u8c03\u7528\u987a\u5e8f\u3001\u4f9d\u8d56\u5173\u7cfb\u7b49\u5904\u7406\u597d\u3002</p> <p></p> <ul> <li>Facade\uff1a\u5982Compiler</li> <li>\u77e5\u9053\u54ea\u4e9b\u5b50\u7cfb\u7edf\u7c7b\u5904\u7406\u8bf7\u6c42\uff1b</li> <li>\u5c06\u5ba2\u6237\u7684\u8bf7\u6c42\u4ee3\u7406\u7ed9\u9002\u5f53\u7684\u5b50\u7cfb\u7edf\u5bf9\u8c61\uff1b</li> <li>Subsystem classes\uff1a\u5982Scanner\u3001Parser\u3001ProgramNode\u7b49</li> <li>\u5b9e\u73b0\u5b50\u7cfb\u7edf\u7684\u529f\u80fd\uff1b</li> <li>\u5904\u7406\u7531Facade\u5bf9\u8c61\u6307\u6d3e\u7684\u4efb\u52a1\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/facade.html#_5","title":"\u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a 1\u3001\u51cf\u5c11\u7cfb\u7edf\u76f8\u4e92\u4f9d\u8d56\u3002 2\u3001\u63d0\u9ad8\u7075\u6d3b\u6027\u3002 3\u3001\u63d0\u9ad8\u4e86\u5b89\u5168\u6027\u3002</p> <p>\u7f3a\u70b9\uff1a</p> <ul> <li> <p>\u4e0d\u7b26\u5408\u5f00\u95ed\u539f\u5219\uff0c\u5982\u679c\u8981\u6539\u4e1c\u897f\u5f88\u9ebb\u70e6\uff0c\u7ee7\u627f\u91cd\u5199\u90fd\u4e0d\u5408\u9002\u3002</p> </li> <li> <p>\u4e0d\u5f15\u5165\u62bd\u8c61\u5916\u89c2\u7c7b\u7684\u60c5\u51b5\u4e0b\uff0c\u589e\u52a0\u65b0\u7684\u5b50\u7cfb\u7edf\u9700\u8981\u4fee\u6539\u73b0\u6709\u4ee3\u7801\uff0c\u4e0d\u7b26\u5408\u5f00\u95ed\u539f\u5219</p> </li> </ul>"},{"location":"code_guide/design_pattern/factory.html","title":"\u5de5\u5382\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/factory.html#_2","title":"\u610f\u56fe","text":"<p>\u5b9a\u4e49\u4e00\u4e2a\u7528\u4e8e\u521b\u5efa\u5bf9\u8c61\u7684\u63a5\u53e3\u770b\uff0c\u8ba9\u5b50\u7c7b\u51b3\u5b9a\u5b9e\u4f8b\u5316\u54ea\u4e00\u4e2a\u7c7b\u3002</p> <p>\u7b80\u5355\u5de5\u5382</p> <ul> <li>\u5355\u4e2a\u5de5\u5382\uff0c\u9759\u6001\u65b9\u6cd5\uff1a\u6839\u636e\u7c7b\u578b\u521b\u5efa\u4e0d\u540c\u7684\u62bd\u8c61\u5bf9\u8c61\u7684\u5b9e\u73b0\uff1b</li> <li>\u5b9e\u4f8b\u5316\u5bf9\u8c61\uff0c\u7528\u5de5\u5382\u65b9\u6cd5\u4ee3\u66ffnew\u64cd\u4f5c\uff1b</li> </ul> <p>\u5de5\u5382\u65b9\u6cd5</p> <ul> <li>\u5b9a\u4e49\u4e86\u4e00\u4e2a\u521b\u5efa\u5bf9\u8c61\u7684\u63a5\u53e3\uff0c\u4f46\u7531\u5b50\u7c7b\u51b3\u5b9a\u5b9e\u4f8b\u5316\u54ea\u4e2a\u7c7b\u3002\u5de5\u5382\u65b9\u6cd5\u5c06\u5bf9\u8c61\u7684\u521b\u5efa\u5ef6\u8fdf\u5230\u5b50\u7c7b\u3002</li> </ul>"},{"location":"code_guide/design_pattern/factory.html#_3","title":"\u9002\u7528\u6027","text":"<ul> <li> <p>\u5728\u4e0d\u540c\u6761\u4ef6\u4e0b\u521b\u5efa\u4e0d\u540c\u5b9e\u4f8b\u65f6\u3002</p> </li> <li> <p>\u5de5\u5382\u6a21\u5f0f\u6700\u57fa\u672c\u7684\u7684\u52a8\u673a\u662f\u5f3a\u5236\u5ba2\u6237\u7aef\u4f7f\u7528\u63a5\u53e3\uff0c\u800c\u4e0d\u662f\u5177\u4f53\u7684\u5bf9\u8c61\uff1b</p> </li> </ul>"},{"location":"code_guide/design_pattern/factory.html#_4","title":"\u7c7b\u56fe","text":"<p>\u5de5\u5382\u65b9\u6cd5</p> <p></p>"},{"location":"code_guide/design_pattern/factory.html#_5","title":"\u4f18\u7f3a\u70b9","text":"<p>\u7b80\u5355\u5de5\u5382</p> <ul> <li> <p>\u4f18\u70b9\uff1a\u89e3\u8026\uff1a\u8c03\u7528\u65b9\u4e0d\u7528\u8d1f\u8d23\u5bf9\u8c61\u7684\u521b\u5efa\uff0c\u53ea\u9700\u8981\u4f7f\u7528\uff0c\u660e\u786e\u5404\u81ea\u7684\u804c\u8d23</p> </li> <li> <p>\u7f3a\u70b9\uff1a\u8fdd\u53cd\u5f00\u95ed\u539f\u5219\uff0c\u6dfb\u52a0\u65b0\u7684\u5b9e\u73b0\uff0c\u4f1a\u6539\u52a8\u5de5\u5382\u65b9\u6cd5\u7684\u5185\u90e8\u5b9e\u73b0\uff08\u7b80\u5355\u7684switch-case\u7684\u6539\u52a8\u53ef\u63a5\u53d7\uff09\uff1b</p> </li> </ul> <p>\u5de5\u5382\u65b9\u6cd5\uff1a</p> <ul> <li>\u4e0d\u786e\u5b9a</li> <li>\u7f3a\u70b9\uff1a\u6bcf\u589e\u52a0\u4e00\u79cd\u4ea7\u54c1\u5c31\u8981\u76f8\u5e94\u7684\u589e\u52a0\u4e00\u4e2a\u5de5\u5382\u7c7b\uff0c\u7c7b\u589e\u591a</li> </ul>"},{"location":"code_guide/design_pattern/flyweight.html","title":"\u4eab\u5143\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/flyweight.html#_2","title":"\u610f\u56fe","text":"<p>\u8fd0\u7528\u5171\u4eab\u6280\u672f\u6709\u6548\u5730\u652f\u6301\u5927\u91cf\u7ec6\u7c92\u5ea6\u7684\u5bf9\u8c61\u3002</p> <p>\u4eab\u5143\u6a21\u5f0f\u7684\u672c\u8d28\u662f\u5206\u79bb\u4e0e\u5171\u4eab \uff1a \u5206\u79bb\u53d8\u4e0e\u4e0d\u53d8\uff0c\u5e76\u4e14\u5171\u4eab\u4e0d\u53d8\u3002</p>"},{"location":"code_guide/design_pattern/flyweight.html#_3","title":"\u9002\u7528\u6027","text":"<p>1\u3001\u7cfb\u7edf\u4e2d\u6709\u5927\u91cf\u5bf9\u8c61\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u6d88\u8017\u5927\u91cf\u5185\u5b58\uff1b</p> <p>2\u3001\u8fd9\u4e9b\u5bf9\u8c61\u7684\u72b6\u6001\u5927\u90e8\u5206\u53ef\u4ee5\u5916\u90e8\u5316\uff08\u6ce8\u610f\u5212\u5206\u5916\u90e8\u72b6\u6001\u548c\u5185\u90e8\u72b6\u6001\uff0c\u5426\u5219\u53ef\u80fd\u4f1a\u5f15\u8d77\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898\uff09\u3002</p> <p>\u5982 Java \u4e2d\u7684String\uff0c\u4f7f\u7528\u5b57\u7b26\u4e32\u7f13\u5b58\u6c60\uff0c\u4ee5\u53ca\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7b49\u3002</p> <p>\u6251\u514b\u724c\uff1a\u9700\u8981\u786e\u5b9a\u9700\u6c42\u573a\u666f\u662f\u5426\u9002\u7528</p> <ul> <li>\u82b1\u82724\uff0c\u6570\u5b5713\uff0c\u4f9b52\u4e2a\u5b9e\u4f8b\u5bf9\u8c61\uff1b</li> <li>Card\u57fa\u7c7b\uff0c4\u79cd\u82b1\u8272\u5b50\u7c7b\uff0c\u6570\u5b57\u4f5c\u4e3a\u5916\u90e8\u72b6\u6001\u4f20\u5165\uff0c\u53ea\u9700\u89814\u4e2a\u5bf9\u8c61\u3002</li> </ul>"},{"location":"code_guide/design_pattern/flyweight.html#_4","title":"\u7c7b\u56fe","text":"<p>\u5728\u4eab\u5143\u6a21\u5f0f\u4e2d\u53ef\u4ee5\u5171\u4eab\u7684\u76f8\u540c\u5185\u5bb9\u79f0\u4e3a \u5185\u90e8\u72b6\u6001(Intrinsic State)\uff0c\u800c\u90a3\u4e9b\u9700\u8981\u5916\u90e8\u73af\u5883\u6765\u8bbe\u7f6e\u7684\u4e0d\u80fd\u5171\u4eab\u7684\u5185\u5bb9\u79f0\u4e3a \u5916\u90e8\u72b6\u6001(Extrinsic State)\u3002</p> <p></p> <ul> <li>\u62bd\u8c61\u4eab\u5143\uff08Flyweight\uff09\uff1a\u662f\u6240\u6709\u7684\u5177\u4f53\u4eab\u5143\u7c7b\u7684\u57fa\u7c7b\uff0c\u4e3a\u5177\u4f53\u4eab\u5143\u89c4\u8303\u9700\u8981\u5b9e\u73b0\u7684\u516c\u5171\u63a5\u53e3\uff0c\u975e\u4eab\u5143\u7684\u5916\u90e8\u72b6\u6001\u4ee5\u53c2\u6570\u7684\u5f62\u5f0f\u901a\u8fc7\u65b9\u6cd5\u4f20\u5165\u3002</li> <li>\u5177\u4f53\u4eab\u5143\uff08Concrete Flyweight\uff09\uff1a\u5b9e\u73b0\u62bd\u8c61\u4eab\u5143\u89d2\u8272\u4e2d\u6240\u89c4\u5b9a\u7684\u63a5\u53e3\u3002</li> <li>\u975e\u4eab\u5143\uff08Unsharable Flyweight\uff09\uff1a\u662f\u4e0d\u53ef\u4ee5\u5171\u4eab\u7684\u5916\u90e8\u72b6\u6001\uff0c\u5b83\u4ee5\u53c2\u6570\u7684\u5f62\u5f0f\u6ce8\u5165\u5177\u4f53\u4eab\u5143\u7684\u76f8\u5173\u65b9\u6cd5\u4e2d\u3002</li> <li>\u4eab\u5143\u5de5\u5382\uff08Flyweight Factory\uff09\uff1a\u8d1f\u8d23\u521b\u5efa\u548c\u7ba1\u7406\u4eab\u5143\u89d2\u8272\u3002\u5f53\u5ba2\u6237\u5bf9\u8c61\u8bf7\u6c42\u4e00\u4e2a\u4eab\u5143\u5bf9\u8c61\u65f6\uff0c\u4eab\u5143\u5de5\u5382\u68c0\u67fb\u7cfb\u7edf\u4e2d\u662f\u5426\u5b58\u5728\u7b26\u5408\u8981\u6c42\u7684\u4eab\u5143\u5bf9\u8c61\uff0c\u5982\u679c\u5b58\u5728\u5219\u63d0\u4f9b\u7ed9\u5ba2\u6237\uff1b\u5982\u679c\u4e0d\u5b58\u5728\u7684\u8bdd\uff0c\u5219\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4eab\u5143\u5bf9\u8c61\u3002</li> </ul>"},{"location":"code_guide/design_pattern/flyweight.html#_5","title":"\u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a\u5927\u5927\u51cf\u5c11\u5bf9\u8c61\u7684\u521b\u5efa\uff0c\u964d\u4f4e\u7cfb\u7edf\u7684\u5185\u5b58\uff0c\u4f7f\u6548\u7387\u63d0\u9ad8\u3002</p> <p>\u7f3a\u70b9\uff1a\u63d0\u9ad8\u4e86\u7cfb\u7edf\u7684\u590d\u6742\u5ea6\uff0c\u9700\u8981\u5206\u79bb\u51fa\u5916\u90e8\u72b6\u6001\u548c\u5185\u90e8\u72b6\u6001\uff0c\u800c\u4e14\u5916\u90e8\u72b6\u6001\u5177\u6709\u56fa\u6709\u5316\u7684\u6027\u8d28\uff0c\u4e0d\u5e94\u8be5\u968f\u7740\u5185\u90e8\u72b6\u6001\u7684\u53d8\u5316\u800c\u53d8\u5316\uff0c\u5426\u5219\u4f1a\u9020\u6210\u7cfb\u7edf\u7684\u6df7\u4e71\u3002</p>"},{"location":"code_guide/design_pattern/interpret.html","title":"\u89e3\u91ca\u5668\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/interpret.html#_2","title":"\u610f\u56fe","text":"<p>\u7ed9\u5b9a\u4e00\u4e2a\u8bed\u8a00\uff0c\u5b9a\u4e49\u5b83\u7684\u6587\u6cd5\u8868\u793a\uff0c\u5e76\u5b9a\u4e49\u4e00\u4e2a\u89e3\u91ca\u5668\uff0c\u8fd9\u4e2a\u89e3\u91ca\u5668\u4f7f\u7528\u8be5\u6807\u8bc6\u6765\u89e3\u91ca\u8bed\u8a00\u4e2d\u7684\u53e5\u5b50\u3002</p> <p>\u89e3\u51b3\uff1a\u5bf9\u4e8e\u4e00\u4e9b\u56fa\u5b9a\u6587\u6cd5\u6784\u5efa\u4e00\u4e2a\u89e3\u91ca\u53e5\u5b50\u7684\u89e3\u91ca\u5668\u3002</p>"},{"location":"code_guide/design_pattern/interpret.html#_3","title":"\u9002\u7528\u6027","text":"<p>\u5e94\u7528\u5b9e\u4f8b\uff1a\u7f16\u8bd1\u5668\u3001\u8fd0\u7b97\u8868\u8fbe\u5f0f\u8ba1\u7b97\u3002</p> <p>1\u3001\u53ef\u4ee5\u5c06\u4e00\u4e2a\u9700\u8981\u89e3\u91ca\u6267\u884c\u7684\u8bed\u8a00\u4e2d\u7684\u53e5\u5b50\u8868\u793a\u4e3a\u4e00\u4e2a\u62bd\u8c61\u8bed\u6cd5\u6811\uff1b</p> <p>2\u3001\u4e00\u4e9b\u91cd\u590d\u51fa\u73b0\u7684\u95ee\u9898\u53ef\u4ee5\u7528\u4e00\u79cd\u7b80\u5355\u7684\u8bed\u8a00\u6765\u8fdb\u884c\u8868\u8fbe\uff1b</p> <p>3\u3001\u4e00\u4e2a\u7b80\u5355\u8bed\u6cd5\u9700\u8981\u89e3\u91ca\u7684\u573a\u666f\uff1b</p>"},{"location":"code_guide/design_pattern/interpret.html#_4","title":"\u7c7b\u56fe","text":"<ul> <li>\u62bd\u8c61\u8868\u8fbe\u5f0f\uff08Abstract Expression\uff09\u89d2\u8272\uff1a\u5b9a\u4e49\u89e3\u91ca\u5668\u7684\u63a5\u53e3\uff0c\u7ea6\u5b9a\u89e3\u91ca\u5668\u7684\u89e3\u91ca\u64cd\u4f5c\uff0c\u4e3b\u8981\u5305\u542b\u89e3\u91ca\u65b9\u6cd5 interpret()\u3002</li> <li>\u7ec8\u7ed3\u7b26\u8868\u8fbe\u5f0f\uff08Terminal Expression\uff09\u89d2\u8272\uff1a\u662f\u62bd\u8c61\u8868\u8fbe\u5f0f\u7684\u5b50\u7c7b\uff0c\u7528\u6765\u5b9e\u73b0\u6587\u6cd5\u4e2d\u4e0e\u7ec8\u7ed3\u7b26\u76f8\u5173\u7684\u64cd\u4f5c\uff0c\u6587\u6cd5\u4e2d\u7684\u6bcf\u4e00\u4e2a\u7ec8\u7ed3\u7b26\u90fd\u6709\u4e00\u4e2a\u5177\u4f53\u7ec8\u7ed3\u8868\u8fbe\u5f0f\u4e0e\u4e4b\u76f8\u5bf9\u5e94\u3002</li> <li>\u975e\u7ec8\u7ed3\u7b26\u8868\u8fbe\u5f0f\uff08Nonterminal Expression\uff09\u89d2\u8272\uff1a\u4e5f\u662f\u62bd\u8c61\u8868\u8fbe\u5f0f\u7684\u5b50\u7c7b\uff0c\u7528\u6765\u5b9e\u73b0\u6587\u6cd5\u4e2d\u4e0e\u975e\u7ec8\u7ed3\u7b26\u76f8\u5173\u7684\u64cd\u4f5c\uff0c\u6587\u6cd5\u4e2d\u7684\u6bcf\u6761\u89c4\u5219\u90fd\u5bf9\u5e94\u4e8e\u4e00\u4e2a\u975e\u7ec8\u7ed3\u7b26\u8868\u8fbe\u5f0f\u3002</li> <li>\u73af\u5883\uff08Context\uff09\u89d2\u8272\uff1a\u901a\u5e38\u5305\u542b\u5404\u4e2a\u89e3\u91ca\u5668\u9700\u8981\u7684\u6570\u636e\u6216\u662f\u516c\u5171\u7684\u529f\u80fd\uff0c\u4e00\u822c\u7528\u6765\u4f20\u9012\u88ab\u6240\u6709\u89e3\u91ca\u5668\u5171\u4eab\u7684\u6570\u636e\uff0c\u540e\u9762\u7684\u89e3\u91ca\u5668\u53ef\u4ee5\u4ece\u8fd9\u91cc\u83b7\u53d6\u8fd9\u4e9b\u503c\u3002</li> <li>\u5ba2\u6237\u7aef\uff08Client\uff09\uff1a\u4e3b\u8981\u4efb\u52a1\u662f\u5c06\u9700\u8981\u5206\u6790\u7684\u53e5\u5b50\u6216\u8868\u8fbe\u5f0f\u8f6c\u6362\u6210\u4f7f\u7528\u89e3\u91ca\u5668\u5bf9\u8c61\u63cf\u8ff0\u7684\u62bd\u8c61\u8bed\u6cd5\u6811\uff0c\u7136\u540e\u8c03\u7528\u89e3\u91ca\u5668\u7684\u89e3\u91ca\u65b9\u6cd5\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u901a\u8fc7\u73af\u5883\u89d2\u8272\u95f4\u63a5\u8bbf\u95ee\u89e3\u91ca\u5668\u7684\u89e3\u91ca\u65b9\u6cd5\u3002</li> </ul>"},{"location":"code_guide/design_pattern/interpret.html#_5","title":"\u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a 1\u3001\u53ef\u6269\u5c55\u6027\u6bd4\u8f83\u597d\uff0c\u7075\u6d3b\u3002 2\u3001\u589e\u52a0\u4e86\u65b0\u7684\u89e3\u91ca\u8868\u8fbe\u5f0f\u7684\u65b9\u5f0f\u3002 3\u3001\u6613\u4e8e\u5b9e\u73b0\u7b80\u5355\u6587\u6cd5\u3002</p> <p>\u7f3a\u70b9\uff1a 1\u3001\u53ef\u5229\u7528\u573a\u666f\u6bd4\u8f83\u5c11\u3002 2\u3001\u5bf9\u4e8e\u590d\u6742\u7684\u6587\u6cd5\u6bd4\u8f83\u96be\u7ef4\u62a4\u3002 3\u3001\u89e3\u91ca\u5668\u6a21\u5f0f\u4f1a\u5f15\u8d77\u7c7b\u81a8\u80c0\u3002 4\u3001\u89e3\u91ca\u5668\u6a21\u5f0f\u91c7\u7528\u9012\u5f52\u8c03\u7528\u65b9\u6cd5\u3002</p>"},{"location":"code_guide/design_pattern/interpret.html#_6","title":"\u5b9e\u73b0","text":""},{"location":"code_guide/design_pattern/interpret.html#fel2013-08","title":"~~fel\uff082013 0.8\uff09~~","text":""},{"location":"code_guide/design_pattern/interpret.html#expression4j","title":"~~expression4j\uff08\u975e\u751f\u4ea7\u5546\u7528\uff09~~","text":""},{"location":"code_guide/design_pattern/interpret.html#java-expression-parser","title":"Java expression parser","text":"<p>Jep\u662f\u4e00\u4e2a\u7528\u6765\u8f6c\u6362\u548c\u8ba1\u7b97\u6570\u5b66\u8868\u8fbe\u5f0f\u7684java\u5e93\uff0c\u652f\u6301\u7528\u6237\u81ea\u5b9a\u4e49\u53d8\u91cf\u3001\u5e38\u91cf\u548c\u51fd\u6570\u3002</p>"},{"location":"code_guide/design_pattern/interpret.html#groovy","title":"Groovy","text":""},{"location":"code_guide/design_pattern/iterator.html","title":"\u8fed\u4ee3\u5668\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/iterator.html#_2","title":"\u610f\u56fe","text":"<p>\u63d0\u4f9b\u4e00\u79cd\u65b9\u6cd5\u987a\u5e8f\u8bbf\u95ee\u4e00\u4e2a\u805a\u5408\u5bf9\u8c61\u4e2d\u5404\u4e2a\u5143\u7d20, \u800c\u53c8\u65e0\u987b\u66b4\u9732\u8be5\u5bf9\u8c61\u7684\u5185\u90e8\u8868\u793a\u3002\u3002</p> <p>\u89e3\u51b3\uff1a\u4e0d\u540c\u7684\u65b9\u5f0f\u6765\u904d\u5386\u6574\u4e2a\u6574\u5408\u5bf9\u8c61\u3002</p>"},{"location":"code_guide/design_pattern/iterator.html#_3","title":"\u9002\u7528\u6027","text":"<p>Java\u7684 Iterator \u904d\u5386\u4e00\u4e2a\u805a\u5408\u5bf9\u8c61\u3002</p> <p>1\u3001\u8bbf\u95ee\u4e00\u4e2a\u805a\u5408\u5bf9\u8c61\u7684\u5185\u5bb9\u800c\u65e0\u987b\u66b4\u9732\u5b83\u7684\u5185\u90e8\u8868\u793a\u3002</p> <p>2\u3001\u9700\u8981\u4e3a\u805a\u5408\u5bf9\u8c61\u63d0\u4f9b\u591a\u79cd\u904d\u5386\u65b9\u5f0f\u3002</p> <p>3\u3001\u4e3a\u904d\u5386\u4e0d\u540c\u7684\u805a\u5408\u7ed3\u6784\u63d0\u4f9b\u4e00\u4e2a\u7edf\u4e00\u7684\u63a5\u53e3\u3002</p>"},{"location":"code_guide/design_pattern/iterator.html#_4","title":"\u7c7b\u56fe","text":"<ol> <li>\u62bd\u8c61\u805a\u5408\uff08Aggregate\uff09\u89d2\u8272\uff1a\u5b9a\u4e49\u5b58\u50a8\u3001\u6dfb\u52a0\u3001\u5220\u9664\u805a\u5408\u5bf9\u8c61\u4ee5\u53ca\u521b\u5efa\u8fed\u4ee3\u5668\u5bf9\u8c61\u7684\u63a5\u53e3\u3002</li> <li>\u5177\u4f53\u805a\u5408\uff08ConcreteAggregate\uff09\u89d2\u8272\uff1a\u5b9e\u73b0\u62bd\u8c61\u805a\u5408\u7c7b\uff0c\u8fd4\u56de\u4e00\u4e2a\u5177\u4f53\u8fed\u4ee3\u5668\u7684\u5b9e\u4f8b\u3002</li> <li>\u62bd\u8c61\u8fed\u4ee3\u5668\uff08Iterator\uff09\u89d2\u8272\uff1a\u5b9a\u4e49\u8bbf\u95ee\u548c\u904d\u5386\u805a\u5408\u5143\u7d20\u7684\u63a5\u53e3\uff0c\u901a\u5e38\u5305\u542b hasNext()\u3001first()\u3001next() \u7b49\u65b9\u6cd5\u3002</li> <li>\u5177\u4f53\u8fed\u4ee3\u5668\uff08Concretelterator\uff09\u89d2\u8272\uff1a\u5b9e\u73b0\u62bd\u8c61\u8fed\u4ee3\u5668\u63a5\u53e3\u4e2d\u6240\u5b9a\u4e49\u7684\u65b9\u6cd5\uff0c\u5b8c\u6210\u5bf9\u805a\u5408\u5bf9\u8c61\u7684\u904d\u5386\uff0c\u8bb0\u5f55\u904d\u5386\u7684\u5f53\u524d\u4f4d\u7f6e\u3002</li> </ol>"},{"location":"code_guide/design_pattern/iterator.html#_5","title":"\u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a 1\u3001\u5b83\u652f\u6301\u4ee5\u4e0d\u540c\u7684\u65b9\u5f0f\u904d\u5386\u4e00\u4e2a\u805a\u5408\u5bf9\u8c61\u3002 2\u3001\u8fed\u4ee3\u5668\u7b80\u5316\u4e86\u805a\u5408\u7c7b\u3002 3\u3001\u5728\u540c\u4e00\u4e2a\u805a\u5408\u4e0a\u53ef\u4ee5\u6709\u591a\u4e2a\u904d\u5386\u3002 4\u3001\u5728\u8fed\u4ee3\u5668\u6a21\u5f0f\u4e2d\uff0c\u589e\u52a0\u65b0\u7684\u805a\u5408\u7c7b\u548c\u8fed\u4ee3\u5668\u7c7b\u90fd\u5f88\u65b9\u4fbf\uff0c\u65e0\u987b\u4fee\u6539\u539f\u6709\u4ee3\u7801\u3002</p> <p>\u7f3a\u70b9\uff1a\u7531\u4e8e\u8fed\u4ee3\u5668\u6a21\u5f0f\u5c06\u5b58\u50a8\u6570\u636e\u548c\u904d\u5386\u6570\u636e\u7684\u804c\u8d23\u5206\u79bb\uff0c\u589e\u52a0\u65b0\u7684\u805a\u5408\u7c7b\u9700\u8981\u5bf9\u5e94\u589e\u52a0\u65b0\u7684\u8fed\u4ee3\u5668\u7c7b\uff0c\u7c7b\u7684\u4e2a\u6570\u6210\u5bf9\u589e\u52a0\uff0c\u8fd9\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u589e\u52a0\u4e86\u7cfb\u7edf\u7684\u590d\u6742\u6027\u3002</p>"},{"location":"code_guide/design_pattern/medium.html","title":"\u4e2d\u4ecb\u8005\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/medium.html#_2","title":"\u610f\u56fe","text":"<p>\u7528\u4e00\u4e2a\u4e2d\u4ecb\u5bf9\u8c61\u6765\u5c01\u88c5\u4e00\u7cfb\u5217\u7684\u5bf9\u8c61\u4ea4\u4e92\uff0c\u4e2d\u4ecb\u8005\u4f7f\u5404\u5bf9\u8c61\u4e0d\u9700\u8981\u663e\u5f0f\u5730\u76f8\u4e92\u5f15\u7528\uff0c\u4ece\u800c\u4f7f\u5176\u8026\u5408\u677e\u6563\uff0c\u800c\u4e14\u53ef\u4ee5\u72ec\u7acb\u5730\u6539\u53d8\u5b83\u4eec\u4e4b\u95f4\u7684\u4ea4\u4e92\u3002</p> <p>\u591a\u5bf9\u591a  &lt;-&gt; \u4e00\u5bf9\u591a</p>"},{"location":"code_guide/design_pattern/medium.html#_3","title":"\u9002\u7528\u6027","text":"<p>QQ\u6e38\u620f\u5e73\u53f0\uff0c\u804a\u5929\u5ba4\u3001QQ\u7fa4\u3001\u77ed\u4fe1\u5e73\u53f0\u548c\u623f\u4ea7\u4e2d\u4ecb</p> <p>1\u3001\u7cfb\u7edf\u4e2d\u5bf9\u8c61\u4e4b\u95f4\u5b58\u5728\u6bd4\u8f83\u590d\u6742\u7684\u5f15\u7528\u5173\u7cfb\uff0c\u5bfc\u81f4\u5b83\u4eec\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u7ed3\u6784\u6df7\u4e71\u800c\u4e14\u96be\u4ee5\u590d\u7528\u8be5\u5bf9\u8c61\u3002</p> <p>2\u3001\u60f3\u901a\u8fc7\u4e00\u4e2a\u4e2d\u95f4\u7c7b\u6765\u5c01\u88c5\u591a\u4e2a\u7c7b\u4e2d\u7684\u884c\u4e3a\uff0c\u800c\u53c8\u4e0d\u60f3\u751f\u6210\u592a\u591a\u7684\u5b50\u7c7b\u3002</p>"},{"location":"code_guide/design_pattern/medium.html#_4","title":"\u7c7b\u56fe","text":"<ol> <li>\u62bd\u8c61\u4e2d\u4ecb\u8005\uff08Mediator\uff09\u89d2\u8272\uff1a\u5b83\u662f\u4e2d\u4ecb\u8005\u7684\u63a5\u53e3\uff0c\u63d0\u4f9b\u4e86\u540c\u4e8b\u5bf9\u8c61\u6ce8\u518c\u4e0e\u8f6c\u53d1\u540c\u4e8b\u5bf9\u8c61\u4fe1\u606f\u7684\u62bd\u8c61\u65b9\u6cd5\u3002</li> <li>\u5177\u4f53\u4e2d\u4ecb\u8005\uff08Concrete Mediator\uff09\u89d2\u8272\uff1a\u5b9e\u73b0\u4e2d\u4ecb\u8005\u63a5\u53e3\uff0c\u5b9a\u4e49\u4e00\u4e2a List \u6765\u7ba1\u7406\u540c\u4e8b\u5bf9\u8c61\uff0c\u534f\u8c03\u5404\u4e2a\u540c\u4e8b\u89d2\u8272\u4e4b\u95f4\u7684\u4ea4\u4e92\u5173\u7cfb\uff0c\u56e0\u6b64\u5b83\u4f9d\u8d56\u4e8e\u540c\u4e8b\u89d2\u8272\u3002</li> <li>\u62bd\u8c61\u540c\u4e8b\u7c7b\uff08Colleague\uff09\u89d2\u8272\uff1a\u5b9a\u4e49\u540c\u4e8b\u7c7b\u7684\u63a5\u53e3\uff0c\u4fdd\u5b58\u4e2d\u4ecb\u8005\u5bf9\u8c61\uff0c\u63d0\u4f9b\u540c\u4e8b\u5bf9\u8c61\u4ea4\u4e92\u7684\u62bd\u8c61\u65b9\u6cd5\uff0c\u5b9e\u73b0\u6240\u6709\u76f8\u4e92\u5f71\u54cd\u7684\u540c\u4e8b\u7c7b\u7684\u516c\u5171\u529f\u80fd\u3002</li> <li>\u5177\u4f53\u540c\u4e8b\u7c7b\uff08Concrete Colleague\uff09\u89d2\u8272\uff1a\u662f\u62bd\u8c61\u540c\u4e8b\u7c7b\u7684\u5b9e\u73b0\u8005\uff0c\u5f53\u9700\u8981\u4e0e\u5176\u4ed6\u540c\u4e8b\u5bf9\u8c61\u4ea4\u4e92\u65f6\uff0c\u7531\u4e2d\u4ecb\u8005\u5bf9\u8c61\u8d1f\u8d23\u540e\u7eed\u7684\u4ea4\u4e92\u3002</li> </ol>"},{"location":"code_guide/design_pattern/medium.html#_5","title":"\u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a 1\u3001\u964d\u4f4e\u4e86\u7c7b\u7684\u590d\u6742\u5ea6\uff0c\u5c06\u4e00\u5bf9\u591a\u8f6c\u5316\u6210\u4e86\u4e00\u5bf9\u4e00\u3002 2\u3001\u5404\u4e2a\u7c7b\u4e4b\u95f4\u7684\u89e3\u8026\u3002 3\u3001\u7b26\u5408\u8fea\u7c73\u7279\u539f\u5219\u3002</p> <p>\u7f3a\u70b9\uff1a\u4e2d\u4ecb\u8005\u4f1a\u5e9e\u5927\uff0c\u53d8\u5f97\u590d\u6742\u96be\u4ee5\u7ef4\u62a4\u3002</p>"},{"location":"code_guide/design_pattern/memento.html","title":"\u5907\u5fd8\u5f55\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/memento.html#_2","title":"\u610f\u56fe","text":"<p>\u5728\u4e0d\u7834\u574f\u5c01\u88c5\u6027\u7684\u524d\u63d0\u4e0b\uff0c\u6355\u83b7\u4e00\u4e2a\u5bf9\u8c61\u7684\u5185\u90e8\u72b6\u6001\uff0c\u5e76\u5728\u8be5\u5bf9\u8c61\u4e4b\u5916\u4fdd\u5b58\u8fd9\u4e2a\u72b6\u6001\u3002</p>"},{"location":"code_guide/design_pattern/memento.html#_3","title":"\u9002\u7528\u6027","text":"<p>1\u3001\u9700\u8981\u4fdd\u5b58/\u6062\u590d\u6570\u636e\u7684\u76f8\u5173\u72b6\u6001\u573a\u666f\u3002</p> <p>2\u3001\u63d0\u4f9b\u4e00\u4e2a\u53ef\u56de\u6eda\u7684\u64cd\u4f5c\u3002</p>"},{"location":"code_guide/design_pattern/memento.html#_4","title":"\u7c7b\u56fe","text":"<ol> <li>\u53d1\u8d77\u4eba\uff08Originator\uff09\u89d2\u8272\uff1a\u8bb0\u5f55\u5f53\u524d\u65f6\u523b\u7684\u5185\u90e8\u72b6\u6001\u4fe1\u606f\uff0c\u63d0\u4f9b\u521b\u5efa\u5907\u5fd8\u5f55\u548c\u6062\u590d\u5907\u5fd8\u5f55\u6570\u636e\u7684\u529f\u80fd\uff0c\u5b9e\u73b0\u5176\u4ed6\u4e1a\u52a1\u529f\u80fd\uff0c\u53ef\u4ee5\u8bbf\u95ee\u5907\u5fd8\u5f55\u91cc\u7684\u6240\u6709\u4fe1\u606f\u3002</li> <li>\u5907\u5fd8\u5f55\uff08Memento\uff09\u89d2\u8272\uff1a\u8d1f\u8d23\u5b58\u50a8\u53d1\u8d77\u4eba\u7684\u5185\u90e8\u72b6\u6001\uff0c\u5728\u9700\u8981\u7684\u65f6\u5019\u63d0\u4f9b\u8fd9\u4e9b\u5185\u90e8\u72b6\u6001\u7ed9\u53d1\u8d77\u4eba\u3002</li> <li>\u7ba1\u7406\u8005\uff08Caretaker\uff09\u89d2\u8272\uff1a\u5bf9\u5907\u5fd8\u5f55\u8fdb\u884c\u7ba1\u7406\uff0c\u63d0\u4f9b\u4fdd\u5b58\u4e0e\u83b7\u53d6\u5907\u5fd8\u5f55\u7684\u529f\u80fd\uff0c\u4f46\u5176\u4e0d\u80fd\u5bf9\u5907\u5fd8\u5f55\u7684\u5185\u5bb9\u8fdb\u884c\u8bbf\u95ee\u4e0e\u4fee\u6539\u3002</li> </ol>"},{"location":"code_guide/design_pattern/memento.html#_5","title":"\u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a 1\u3001\u7ed9\u7528\u6237\u63d0\u4f9b\u4e86\u4e00\u79cd\u53ef\u4ee5\u6062\u590d\u72b6\u6001\u7684\u673a\u5236\uff0c\u53ef\u4ee5\u4f7f\u7528\u6237\u80fd\u591f\u6bd4\u8f83\u65b9\u4fbf\u5730\u56de\u5230\u67d0\u4e2a\u5386\u53f2\u7684\u72b6\u6001\u3002 2\u3001\u5b9e\u73b0\u4e86\u4fe1\u606f\u7684\u5c01\u88c5\uff0c\u4f7f\u5f97\u7528\u6237\u4e0d\u9700\u8981\u5173\u5fc3\u72b6\u6001\u7684\u4fdd\u5b58\u7ec6\u8282\u3002</p> <p>\u7f3a\u70b9\uff1a\u6d88\u8017\u8d44\u6e90\u3002\u5982\u679c\u7c7b\u7684\u6210\u5458\u53d8\u91cf\u8fc7\u591a\uff0c\u52bf\u5fc5\u4f1a\u5360\u7528\u6bd4\u8f83\u5927\u7684\u8d44\u6e90\uff0c\u800c\u4e14\u6bcf\u4e00\u6b21\u4fdd\u5b58\u90fd\u4f1a\u6d88\u8017\u4e00\u5b9a\u7684\u5185\u5b58\u3002</p> <p>\u6ce8\u610f\u4e8b\u9879\uff1a 1\u3001\u4e3a\u4e86\u7b26\u5408\u8fea\u7c73\u7279\u539f\u5219\uff0c\u8fd8\u8981\u589e\u52a0\u4e00\u4e2a\u7ba1\u7406\u5907\u5fd8\u5f55\u7684\u7c7b\u3002 2\u3001\u4e3a\u4e86\u8282\u7ea6\u5185\u5b58\uff0c\u53ef\u4f7f\u7528\u539f\u578b\u6a21\u5f0f+\u5907\u5fd8\u5f55\u6a21\u5f0f\u3002</p>"},{"location":"code_guide/design_pattern/observer.html","title":"\u89c2\u5bdf\u8005","text":""},{"location":"code_guide/design_pattern/observer.html#_2","title":"\u610f\u56fe","text":"<p>\u5b9a\u4e49\u5bf9\u8c61\u95f4\u7684\u4e00\u79cd\u4e00\u5bf9\u591a\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u5f53\u4e00\u4e2a\u5bf9\u8c61\u7684\u72b6\u6001\u53d1\u751f\u6539\u53d8\u65f6\uff0c\u6240\u6709\u4f9d\u8d56\u4e8e\u5b83\u7684\u5bf9\u8c61\u90fd\u5f97\u5230\u901a\u77e5\u5e76\u88ab\u81ea\u52a8\u66f4\u65b0\u3002</p> <p>\u89e3\u51b3\uff1a\u4e00\u4e2a\u5bf9\u8c61\u72b6\u6001\u6539\u53d8\u7ed9\u5176\u4ed6\u5bf9\u8c61\u901a\u77e5\u7684\u95ee\u9898\uff0c\u800c\u4e14\u8981\u8003\u8651\u5230\u6613\u7528\u548c\u4f4e\u8026\u5408\uff0c\u4fdd\u8bc1\u9ad8\u5ea6\u7684\u534f\u4f5c\u3002</p>"},{"location":"code_guide/design_pattern/observer.html#_3","title":"\u9002\u7528\u6027","text":"<p>\u5404\u79cdListener\uff0c Zookeeper\u7684\u901a\u77e5\u673a\u5236\u3002</p> <ul> <li>\u4e00\u4e2a\u62bd\u8c61\u6a21\u578b\u6709\u4e24\u4e2a\u65b9\u9762\uff0c\u5176\u4e2d\u4e00\u4e2a\u65b9\u9762\u4f9d\u8d56\u4e8e\u53e6\u4e00\u4e2a\u65b9\u9762\u3002\u5c06\u8fd9\u4e9b\u65b9\u9762\u5c01\u88c5\u5728\u72ec\u7acb\u7684\u5bf9\u8c61\u4e2d\u4f7f\u5b83\u4eec\u53ef\u4ee5\u5404\u81ea\u72ec\u7acb\u5730\u6539\u53d8\u548c\u590d\u7528\u3002</li> <li>\u4e00\u4e2a\u5bf9\u8c61\u7684\u6539\u53d8\u5c06\u5bfc\u81f4\u5176\u4ed6\u4e00\u4e2a\u6216\u591a\u4e2a\u5bf9\u8c61\u4e5f\u53d1\u751f\u6539\u53d8\uff0c\u800c\u4e0d\u77e5\u9053\u5177\u4f53\u6709\u591a\u5c11\u5bf9\u8c61\u5c06\u53d1\u751f\u6539\u53d8\uff0c\u53ef\u4ee5\u964d\u4f4e\u5bf9\u8c61\u4e4b\u95f4\u7684\u8026\u5408\u5ea6\u3002</li> <li>\u4e00\u4e2a\u5bf9\u8c61\u5fc5\u987b\u901a\u77e5\u5176\u4ed6\u5bf9\u8c61\uff0c\u800c\u5e76\u4e0d\u77e5\u9053\u8fd9\u4e9b\u5bf9\u8c61\u662f\u8c01\u3002</li> <li>\u9700\u8981\u5728\u7cfb\u7edf\u4e2d\u521b\u5efa\u4e00\u4e2a\u89e6\u53d1\u94fe\uff0cA\u5bf9\u8c61\u7684\u884c\u4e3a\u5c06\u5f71\u54cdB\u5bf9\u8c61\uff0cB\u5bf9\u8c61\u7684\u884c\u4e3a\u5c06\u5f71\u54cdC\u5bf9\u8c61\u2026\u2026\uff0c\u53ef\u4ee5\u4f7f\u7528\u89c2\u5bdf\u8005\u6a21\u5f0f\u521b\u5efa\u4e00\u79cd\u94fe\u5f0f\u89e6\u53d1\u673a\u5236\u3002</li> </ul>"},{"location":"code_guide/design_pattern/observer.html#_4","title":"\u7c7b\u56fe","text":"<ol> <li>\u62bd\u8c61\u4e3b\u9898\uff08Subject\uff09\u89d2\u8272\uff1a\u4e5f\u53eb\u62bd\u8c61\u76ee\u6807\u7c7b\uff0c\u5b83\u63d0\u4f9b\u4e00\u4e2a\u7528\u4e8e\u4fdd\u5b58\u89c2\u5bdf\u8005\u5bf9\u8c61\u7684\u805a\u96c6\u7c7b\u548c\u589e\u52a0\u3001\u5220\u9664\u89c2\u5bdf\u8005\u5bf9\u8c61\u7684\u65b9\u6cd5\uff0c\u4ee5\u53ca\u901a\u77e5\u6240\u6709\u89c2\u5bdf\u8005\u7684\u62bd\u8c61\u65b9\u6cd5\u3002</li> <li>\u5177\u4f53\u4e3b\u9898\uff08Concrete Subject\uff09\u89d2\u8272\uff1a\u4e5f\u53eb\u5177\u4f53\u76ee\u6807\u7c7b\uff0c\u5b83\u5b9e\u73b0\u62bd\u8c61\u76ee\u6807\u4e2d\u7684\u901a\u77e5\u65b9\u6cd5\uff0c\u5f53\u5177\u4f53\u4e3b\u9898\u7684\u5185\u90e8\u72b6\u6001\u53d1\u751f\u6539\u53d8\u65f6\uff0c\u901a\u77e5\u6240\u6709\u6ce8\u518c\u8fc7\u7684\u89c2\u5bdf\u8005\u5bf9\u8c61\u3002</li> <li>\u62bd\u8c61\u89c2\u5bdf\u8005\uff08Observer\uff09\u89d2\u8272\uff1a\u5b83\u662f\u4e00\u4e2a\u62bd\u8c61\u7c7b\u6216\u63a5\u53e3\uff0c\u5b83\u5305\u542b\u4e86\u4e00\u4e2a\u66f4\u65b0\u81ea\u5df1\u7684\u62bd\u8c61\u65b9\u6cd5\uff0c\u5f53\u63a5\u5230\u5177\u4f53\u4e3b\u9898\u7684\u66f4\u6539\u901a\u77e5\u65f6\u88ab\u8c03\u7528\u3002</li> <li>\u5177\u4f53\u89c2\u5bdf\u8005\uff08Concrete Observer\uff09\u89d2\u8272\uff1a\u5b9e\u73b0\u62bd\u8c61\u89c2\u5bdf\u8005\u4e2d\u5b9a\u4e49\u7684\u62bd\u8c61\u65b9\u6cd5\uff0c\u4ee5\u4fbf\u5728\u5f97\u5230\u76ee\u6807\u7684\u66f4\u6539\u901a\u77e5\u65f6\u66f4\u65b0\u81ea\u8eab\u7684\u72b6\u6001\u3002</li> </ol>"},{"location":"code_guide/design_pattern/observer.html#_5","title":"\u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a </p> <ul> <li>\u89c2\u5bdf\u8005\u548c\u88ab\u89c2\u5bdf\u8005\u662f\u62bd\u8c61\u8026\u5408\u7684\uff1b</li> <li>\u5efa\u7acb\u4e00\u5957\u89e6\u53d1\u673a\u5236\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a </p> <ul> <li>\u5982\u679c\u4e00\u4e2a\u88ab\u89c2\u5bdf\u8005\u5bf9\u8c61\u6709\u5f88\u591a\u7684\u76f4\u63a5\u548c\u95f4\u63a5\u7684\u89c2\u5bdf\u8005\u7684\u8bdd\uff0c\u5c06\u6240\u6709\u7684\u89c2\u5bdf\u8005\u90fd\u901a\u77e5\u5230\u4f1a\u82b1\u8d39\u5f88\u591a\u65f6\u95f4\uff1b</li> <li>\u5982\u679c\u5728\u89c2\u5bdf\u8005\u548c\u89c2\u5bdf\u76ee\u6807\u4e4b\u95f4\u6709\u5faa\u73af\u4f9d\u8d56\u7684\u8bdd\uff0c\u89c2\u5bdf\u76ee\u6807\u4f1a\u89e6\u53d1\u5b83\u4eec\u4e4b\u95f4\u8fdb\u884c\u5faa\u73af\u8c03\u7528\uff0c\u53ef\u80fd\u5bfc\u81f4\u7cfb\u7edf\u5d29\u6e83\uff1b</li> <li>\u89c2\u5bdf\u8005\u6a21\u5f0f\u6ca1\u6709\u76f8\u5e94\u7684\u673a\u5236\u8ba9\u89c2\u5bdf\u8005\u77e5\u9053\u6240\u89c2\u5bdf\u7684\u76ee\u6807\u5bf9\u8c61\u662f\u600e\u4e48\u53d1\u751f\u53d8\u5316\u7684\uff0c\u800c\u4ec5\u4ec5\u53ea\u662f\u77e5\u9053\u89c2\u5bdf\u76ee\u6807\u53d1\u751f\u4e86\u53d8\u5316\u3002</li> </ul>"},{"location":"code_guide/design_pattern/prototype.html","title":"\u539f\u578b\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/prototype.html#_2","title":"\u610f\u56fe","text":"<p>\u7528\u4e00\u4e2a\u5df2\u7ecf\u521b\u5efa\u7684\u5b9e\u4f8b\u4f5c\u4e3a\u539f\u578b\uff0c\u901a\u8fc7\u590d\u5236\u8be5\u539f\u578b\u5bf9\u8c61\u6765\u521b\u5efa\u4e00\u4e2a\u548c\u539f\u578b\u76f8\u540c\u6216\u76f8\u4f3c\u7684\u65b0\u5bf9\u8c61\u3002</p> <ul> <li>\u5f53\u76f4\u63a5\u521b\u5efa\u5bf9\u8c61\u7684\u4ee3\u4ef7\u6bd4\u8f83\u5927\u65f6\uff0c\u5219\u91c7\u7528\u8fd9\u79cd\u6a21\u5f0f\u3002</li> </ul>"},{"location":"code_guide/design_pattern/prototype.html#_3","title":"\u9002\u7528\u6027","text":"<ul> <li>\u7cfb\u7edf\u5e94\u72ec\u7acb\u4e8e\u4ea7\u54c1\u7684\u521b\u5efa\u3001\u6784\u6210\u548c\u8868\u793a\u3002</li> <li>\u9700\u8981\u5728\u8fd0\u884c\u65f6\u6307\u5b9a\u5b9e\u4f8b\u5316\u7684\u7c7b\uff0c\u4f8b\u5982\u901a\u8fc7\u52a8\u6001\u52a0\u8f7d\u3002</li> <li>\u907f\u514d\u521b\u5efa\u4e0e\u4ea7\u54c1\u7c7b\u5c42\u6b21\u5e73\u884c\u7684\u5de5\u5382\u7c7b\u5c42\u6b21\u3002</li> <li>\u7c7b\u7684\u5b9e\u4f8b\u53ea\u80fd\u6709\u51e0\u79cd\u4e0d\u540c\u72b6\u6001\u7ec4\u5408\uff0c\u514b\u9686\u539f\u578b\u6bd4\u624b\u5de5\u5b9e\u4f8b\u5316\u66f4\u65b9\u4fbf\u3002</li> </ul> <p>\u5e94\u7528\u5b9e\u4f8b</p> <ul> <li>\u7ec6\u80de\u5206\u88c2</li> <li>Java \u4e2d\u7684 <code>Object.clone()</code> \u65b9\u6cd5</li> </ul>"},{"location":"code_guide/design_pattern/prototype.html#_4","title":"\u7c7b\u56fe","text":"<ul> <li>\u62bd\u8c61\u539f\u578b\u7c7b\uff1a\u89c4\u5b9a\u4e86\u5177\u4f53\u539f\u578b\u5bf9\u8c61\u5fc5\u987b\u5b9e\u73b0\u7684\u63a5\u53e3\u3002</li> <li>\u5177\u4f53\u539f\u578b\u7c7b\uff1a\u5b9e\u73b0\u62bd\u8c61\u539f\u578b\u7c7b\u7684 clone() \u65b9\u6cd5\uff0c\u5b83\u662f\u53ef\u88ab\u590d\u5236\u7684\u5bf9\u8c61\u3002</li> <li>\u8bbf\u95ee\u7c7b\uff1a\u4f7f\u7528\u5177\u4f53\u539f\u578b\u7c7b\u4e2d\u7684 clone() \u65b9\u6cd5\u6765\u590d\u5236\u65b0\u7684\u5bf9\u8c61\u3002</li> </ul>"},{"location":"code_guide/design_pattern/prototype.html#_5","title":"\u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9</p> <ul> <li>\u6027\u80fd\u63d0\u9ad8\uff0c\u907f\u514d\u6784\u9020\u51fd\u6570\u7684\u7ea6\u675f</li> </ul> <p>\u7f3a\u70b9</p> <ul> <li>\u914d\u5907\u514b\u9686\u65b9\u6cd5\u9700\u8981\u5168\u9762\u8003\u8651\u7c7b\u7684\u529f\u80fd\uff0c\u5bf9\u5df2\u6709\u7c7b\u53ef\u80fd\u8f83\u96be\u5b9e\u73b0\uff0c\u7279\u522b\u662f\u5904\u7406\u4e0d\u652f\u6301\u4e32\u884c\u5316\u7684\u95f4\u63a5\u5bf9\u8c61\u6216\u542b\u6709\u5faa\u73af\u7ed3\u6784\u7684\u5f15\u7528\u65f6\u3002</li> <li>\u6ce8\u610f\u6d45\u62f7\u8d1d\u548c\u6df1\u62f7\u8d1d\u3002</li> </ul>"},{"location":"code_guide/design_pattern/proxy.html","title":"\u4ee3\u7406\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/proxy.html#_2","title":"\u610f\u56fe","text":"<p>\u4e3a\u5176\u5b83\u5bf9\u8c61\u63d0\u4f9b\u4e00\u79cd\u4ee3\u7406\u4ee5\u63a7\u5236\u5bf9\u8fd9\u4e2a\u5bf9\u8c61\u7684\u8bbf\u95ee\u3002</p>"},{"location":"code_guide/design_pattern/proxy.html#_3","title":"\u9002\u7528\u6027","text":"<ul> <li>\u8fdc\u7a0b\u4ee3\u7406\uff1a\u4ee3\u7406\u8fdc\u7a0b\u7684\u5bf9\u8c61\uff0c\u5c4f\u853d\u7f51\u7edc\u7b49\u7ec6\u8282\uff0c\u6bd4\u5982RPC\uff1b</li> <li>\u865a\u4ee3\u7406\uff1a\u9700\u8981\u521b\u5efa\u5f00\u9500\u5f88\u5927\u7684\u5bf9\u8c61\uff0c\u8ba9\u8c03\u7528\u8005\u5148\u6301\u6709\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\uff0c\u4f46\u771f\u6b63\u7684\u5bf9\u8c61\u5c1a\u672a\u521b\u5efa\uff1b</li> <li>\u4fdd\u62a4\u4ee3\u7406\uff1a\u63a7\u5236\u5bf9\u539f\u59cb\u5bf9\u8c61\u7684\u8bbf\u95ee\uff0c\u7528\u4e8e\u6743\u9650\u63a7\u5236\u7b49\uff1b</li> <li>\u667a\u80fd\u6307\u5f15\uff1a\u8bbf\u95ee\u5bf9\u8c61\u65f6\u6267\u884c\u9644\u52a0\u64cd\u4f5c\uff0c\u6bd4\u5982\u5f15\u7528\u8ba1\u6570\u7b49\uff1b</li> <li>Copy-on-write\u4ee3\u7406\uff1a\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u62f7\u8d1d\uff0c\u53ea\u6709\u5728\u4fee\u6539\u65f6\u624d\u771f\u6b63\u62f7\u8d1d\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/proxy.html#_4","title":"\u7c7b\u56fe","text":""},{"location":"code_guide/design_pattern/proxy.html#_5","title":"\u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a 1\u3001\u804c\u8d23\u6e05\u6670\u3002 2\u3001\u9ad8\u6269\u5c55\u6027\u3002 3\u3001\u667a\u80fd\u5316\u3002</p> <p>\u7f3a\u70b9\uff1a 1\u3001\u7531\u4e8e\u5728\u5ba2\u6237\u7aef\u548c\u771f\u5b9e\u4e3b\u9898\u4e4b\u95f4\u589e\u52a0\u4e86\u4ee3\u7406\u5bf9\u8c61\uff0c\u56e0\u6b64\u6709\u4e9b\u7c7b\u578b\u7684\u4ee3\u7406\u6a21\u5f0f\u53ef\u80fd\u4f1a\u9020\u6210\u8bf7\u6c42\u7684\u5904\u7406\u901f\u5ea6\u53d8\u6162\u3002 2\u3001\u5b9e\u73b0\u4ee3\u7406\u6a21\u5f0f\u9700\u8981\u989d\u5916\u7684\u5de5\u4f5c\uff0c\u6709\u4e9b\u4ee3\u7406\u6a21\u5f0f\u7684\u5b9e\u73b0\u975e\u5e38\u590d\u6742\u3002</p>"},{"location":"code_guide/design_pattern/singleton.html","title":"\u5355\u4f8b\u6a21\u5f0f(Singleton)","text":""},{"location":"code_guide/design_pattern/singleton.html#_1","title":"\u610f\u56fe","text":"<p>\u4fdd\u8bc1\u4e00\u4e2a\u7c7b\u53ea\u6709\u4e00\u4e2a\u5b9e\u73b0\uff0c\u4e14\u63d0\u4f9b\u4e00\u4e2a\u8bbf\u95ee\u5b83\u7684\u5168\u5c40\u8bbf\u95ee\u70b9\u3002</p>"},{"location":"code_guide/design_pattern/singleton.html#_2","title":"\u9002\u7528\u6027","text":"<p>\u7cfb\u7edf\u4e2d\u6709\u7684\u7c7b\u5e94\u8be5\u53ea\u6709\u4e00\u4efd\u5b9e\u4f8b\uff0c\u6bd4\u5982\u4e00\u4e2a\u5168\u5c40\u7684\u914d\u7f6e\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u548c\u7a97\u53e3\u7ba1\u7406\u5668\u7b49\u3002</p>"},{"location":"code_guide/design_pattern/singleton.html#_3","title":"\u7c7b\u56fe","text":""},{"location":"code_guide/design_pattern/singleton.html#_4","title":"\u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a</p> <ul> <li>\u5bf9\u552f\u4e00\u5b9e\u4f8b\u7684\u53d7\u63a7\u8bbf\u95ee\uff1b</li> <li>\u5728\u5185\u5b58\u91cc\u53ea\u6709\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u51cf\u5c11\u4e86\u5185\u5b58\u7684\u5f00\u9500\uff0c\u5c24\u5176\u662f\u9891\u7e41\u7684\u521b\u5efa\u548c\u9500\u6bc1\u5b9e\u4f8b\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u5355\u4f8b\u6a21\u5f0f\u4e2d\u6ca1\u6709\u62bd\u8c61\u5c42\uff0c\u56e0\u6b64\u5355\u4f8b\u7c7b\u7684\u6269\u5c55\u6709\u5f88\u5927\u7684\u56f0\u96be\uff08\u5355\u4f8b\u53ef\u4ee5\u4f18\u5316\u4e3a\u8fd4\u56de\u63a5\u53e3\uff09\uff1b</li> <li>\u4e0d\u9002\u7528\u4e8e\u53d8\u5316\u7684\u5bf9\u8c61\uff0c\u591a\u7ebf\u7a0b\u73af\u5883\u9700\u8981\u5c0f\u5fc3</li> </ul>"},{"location":"code_guide/design_pattern/singleton.html#java","title":"\u5b9e\u73b0\uff08Java\uff09","text":"<p>\u4ee5\u4e0b\u65b9\u6848\uff0c\u5747\u8003\u8651\u7ebf\u7a0b\u5b89\u5168\uff1a</p>"},{"location":"code_guide/design_pattern/singleton.html#_5","title":"\u997f\u6c49\u5f0f\uff08\u63a8\u8350\uff0c\u9759\u6001\u6210\u5458\u53d8\u91cf\u521d\u59cb\u5316\uff09","text":"<pre><code>//\u997f\u6c49\u5f0f\npublic class Singleton {\n    private static Singleton instance = new Singleton();\n    private Singleton() {}\n\n    public static Singleton getInstance() {\n        return instance;\n    }\n}\n</code></pre>"},{"location":"code_guide/design_pattern/singleton.html#volatile","title":"\u61d2\u6c49\u5f0f\uff08\u53cc\u91cd\u68c0\u67e5\u65b9\u5f0f+volatile\uff09","text":"<pre><code>//\u53cc\u91cd\u6821\u9a8c\u9501\npublic class Singleton {\n    private volatile static Singleton instance;\n    private Singleton() {}\n\n    public static Singleton getInstance() {\n        if (instance == null) {\n            synchronized (Singleton.class) {\n                if (instance == null) {\n                    instance = new Singleton();\n                }\n            }\n        }\n        return instance;\n    }\n}\n</code></pre>"},{"location":"code_guide/design_pattern/singleton.html#_6","title":"\u5185\u90e8\u7c7b\uff08\u63a8\u8350\uff09","text":"<p>\u4e0d\u4f7f\u7528\uff0c\u5f15\u5165Singleton\u4e0d\u4f1a\u521d\u59cb\u5316\uff0c\u4f7f\u7528\u65f6\u901a\u8fc7\u5185\u90e8\u9759\u6001\u7c7b\u7684\u5168\u5c40\u9501\u521d\u59cb\u5316\uff0c\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\uff1b</p> <pre><code>//\u9759\u6001\u5185\u90e8\u7c7b\npublic class Singleton {\n    private static class SingletonHolder {\n        private static final Singleton INSTANCE = new Singleton();\n    }\n    private Singleton() {}\n\n    public static final Singleton getInstance() {\n        return SingletonHolder.INSTANCE;\n    }\n}\n</code></pre>"},{"location":"code_guide/design_pattern/singleton.html#_7","title":"\u6ce8\u610f\u4e8b\u9879","text":"<ul> <li>\u7ebf\u7a0b\u5b89\u5168\u7684\u8003\u8651\uff0c\u6784\u9020\u5668\u79c1\u6709\u5316\uff1b</li> <li>\u5f53\u6709\u591a\u4e2a\u53ef\u9009\u7684\u552f\u4e00\u5b9e\u4f8b\u65f6\uff0c\u901a\u8fc7\u5b50\u7c7b\u7684\u65b9\u5f0f\uff0c\u53ef\u4ee5\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u914d\u7f6e\u6216\u8005\u6ce8\u518c\u8868\u7684\u5f62\u5f0f\uff0c\u8fdb\u884c\u52a8\u6001\u521b\u5efa\u5177\u4f53\u5b50\u7c7b\u5b9e\u73b0\uff1b</li> <li>\u53cd\u5e8f\u5217\u5316\u65f6\uff0c\u53ef\u80fd\u4f1a\u91cd\u65b0\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u5b9e\u4f8b\uff1b</li> <li>\u5b9e\u73b0<code>readResolve</code>\u65b9\u6cd5\uff0c\u8fd4\u56de\u9759\u6001\u5b9e\u4f8b\uff1b</li> <li>\u4eab\u6709\u7279\u6743\u7684\u5ba2\u6237\u7aef\uff0c\u901a\u8fc7<code>AccessibleObject.setAccessible</code>\u65b9\u6cd5\u548c\u53cd\u5c04\u673a\u5236\u53ef\u4ee5\u8c03\u7528\u79c1\u6709\u6784\u9020\u5668\uff1b</li> <li>\u65b9\u6848\uff1a\u521b\u5efa\u7b2c\u4e8c\u4e2a\u5b9e\u4f8b\u7684\u65f6\u5019\u629b\u51fa\u5f02\u5e38</li> </ul>"},{"location":"code_guide/design_pattern/singleton.html#c","title":"\u5b9e\u73b0\uff08C++\uff09","text":"<p>\u4ee5\u4e0b\u65b9\u6848\uff0c\u5747\u8003\u8651\u7ebf\u7a0b\u5b89\u5168\uff1a</p>"},{"location":"code_guide/design_pattern/singleton.html#_8","title":"\u61d2\u6c49\u5f0f\uff08\u63a8\u8350\uff0c\u51fd\u6570\u9759\u6001\u5c40\u90e8\u53d8\u91cf\uff09","text":"<p>C++11 \u6807\u51c6\u662f\u7ebf\u7a0b\u5b89\u5168\u7684</p> <pre><code>// .h\nclass Single {\npublic:\n    // \u83b7\u53d6\u5355\u5b9e\u4f8b\u5bf9\u8c61\n    static Single&amp; GetInstance();\nprivate:\n    // \u7981\u6b62\u5916\u90e8\u6784\u9020\n    Single();\n    // \u7981\u6b62\u5916\u90e8\u6790\u6784\n    ~Single();\n    // \u7981\u6b62\u5916\u90e8\u62f7\u8d1d\u6784\u9020\n    Single(const Single &amp;single) = delete;\n    // \u7981\u6b62\u5916\u90e8\u8d4b\u503c\u64cd\u4f5c\n    const Single &amp;operator=(const Single &amp;single) = delete;\n}; \n// .cpp\nSingle&amp; Single::GetInstance()\n{\n    /**\n     * \u5c40\u90e8\u9759\u6001\u7279\u6027\u7684\u65b9\u5f0f\u5b9e\u73b0\u5355\u5b9e\u4f8b\u3002\n     * \u9759\u6001\u5c40\u90e8\u53d8\u91cf\u53ea\u5728\u5f53\u524d\u51fd\u6570\u5185\u6709\u6548\uff0c\u5176\u4ed6\u51fd\u6570\u65e0\u6cd5\u8bbf\u95ee\u3002\n     * \u9759\u6001\u5c40\u90e8\u53d8\u91cf\u53ea\u5728\u7b2c\u4e00\u6b21\u88ab\u8c03\u7528\u7684\u65f6\u5019\u521d\u59cb\u5316\uff0c\u4e5f\u5b58\u50a8\u5728\u9759\u6001\u5b58\u50a8\u533a\uff0c\u751f\u547d\u5468\u671f\u4ece\u7b2c\u4e00\u6b21\u88ab\u521d\u59cb\u5316\u8d77\u81f3\u7a0b\u5e8f\u7ed3\u675f\u6b62\u3002\n     */\n    static Single single;\n    return single;\n}\n</code></pre>"},{"location":"code_guide/design_pattern/singleton.html#_9","title":"\u997f\u6c49\u5f0f","text":"<pre><code>class Singleton {\npublic:\n    // \u83b7\u53d6\u5355\u5b9e\u4f8b\n    static Singleton* GetInstance();\nprivate:\n    // \u5c06\u5176\u6784\u9020\u548c\u6790\u6784\u6210\u4e3a\u79c1\u6709\u7684, \u7981\u6b62\u5916\u90e8\u6784\u9020\u548c\u6790\u6784\n    Singleton();\n    ~Singleton();\n    // \u5c06\u5176\u62f7\u8d1d\u6784\u9020\u548c\u8d4b\u503c\u6784\u9020\u6210\u4e3a\u79c1\u6709\u51fd\u6570, \u7981\u6b62\u5916\u90e8\u62f7\u8d1d\u548c\u8d4b\u503c\n    Singleton(const Singleton &amp;signal);\n    const Singleton &amp;operator=(const Singleton &amp;signal);\nprivate:\n    // \u552f\u4e00\u5355\u5b9e\u4f8b\u5bf9\u8c61\u6307\u9488\n    static Singleton *g_pSingleton;\n}\n\n// cpp\n// \u4ee3\u7801\u4e00\u8fd0\u884c\u5c31\u521d\u59cb\u5316\u521b\u5efa\u5b9e\u4f8b \uff0c\u672c\u8eab\u5c31\u7ebf\u7a0b\u5b89\u5168\nSingleton* Singleton::g_pSingleton = new (std::nothrow) Singleton();\n\nSingleton* Singleton::GetInstance() {\n    return g_pSingleton;\n}\n</code></pre>"},{"location":"code_guide/design_pattern/state.html","title":"\u72b6\u6001\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/state.html#_2","title":"\u610f\u56fe","text":"<p>\u5141\u8bb8\u5bf9\u8c61\u5728\u5185\u90e8\u72b6\u6001\u53d1\u751f\u6539\u53d8\u65f6\u6539\u53d8\u5b83\u7684\u884c\u4e3a\uff0c\u5bf9\u8c61\u770b\u8d77\u6765\u597d\u50cf\u4fee\u6539\u4e86\u5b83\u7684\u7c7b\u3002</p> <p>\u89e3\u51b3\uff1a\u5bf9\u8c61\u7684\u884c\u4e3a\u4f9d\u8d56\u4e8e\u5b83\u7684\u72b6\u6001\uff08\u5c5e\u6027\uff09\uff0c\u5e76\u4e14\u53ef\u4ee5\u6839\u636e\u5b83\u7684\u72b6\u6001\u6539\u53d8\u800c\u6539\u53d8\u5b83\u7684\u76f8\u5173\u884c\u4e3a\u3002</p>"},{"location":"code_guide/design_pattern/state.html#_3","title":"\u9002\u7528\u6027","text":"<p>1\u3001\u884c\u4e3a\u968f\u72b6\u6001\u6539\u53d8\u800c\u6539\u53d8\u7684\u573a\u666f\u3002 </p> <p>2\u3001\u6761\u4ef6\u3001\u5206\u652f\u8bed\u53e5\u7684\u4ee3\u66ff\u8005\u3002</p> <p>\u901a\u5e38\u5728\u4ee5\u4e0b\u60c5\u51b5\u4e0b\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u72b6\u6001\u6a21\u5f0f\u3002</p> <ul> <li>\u5f53\u4e00\u4e2a\u5bf9\u8c61\u7684\u884c\u4e3a\u53d6\u51b3\u4e8e\u5b83\u7684\u72b6\u6001\uff0c\u5e76\u4e14\u5b83\u5fc5\u987b\u5728\u8fd0\u884c\u65f6\u6839\u636e\u72b6\u6001\u6539\u53d8\u5b83\u7684\u884c\u4e3a\u65f6\uff0c\u5c31\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u72b6\u6001\u6a21\u5f0f\u3002</li> <li>\u4e00\u4e2a\u64cd\u4f5c\u4e2d\u542b\u6709\u5e9e\u5927\u7684\u5206\u652f\u7ed3\u6784\uff0c\u5e76\u4e14\u8fd9\u4e9b\u5206\u652f\u51b3\u5b9a\u4e8e\u5bf9\u8c61\u7684\u72b6\u6001\u65f6</li> </ul>"},{"location":"code_guide/design_pattern/state.html#_4","title":"\u7c7b","text":"<ol> <li>\u73af\u5883\u7c7b\uff08Context\uff09\u89d2\u8272\uff1a\u4e5f\u79f0\u4e3a\u4e0a\u4e0b\u6587\uff0c\u5b83\u5b9a\u4e49\u4e86\u5ba2\u6237\u7aef\u9700\u8981\u7684\u63a5\u53e3\uff0c\u5185\u90e8\u7ef4\u62a4\u4e00\u4e2a\u5f53\u524d\u72b6\u6001\uff0c\u5e76\u8d1f\u8d23\u5177\u4f53\u72b6\u6001\u7684\u5207\u6362\u3002</li> <li>\u62bd\u8c61\u72b6\u6001\uff08State\uff09\u89d2\u8272\uff1a\u5b9a\u4e49\u4e00\u4e2a\u63a5\u53e3\uff0c\u7528\u4ee5\u5c01\u88c5\u73af\u5883\u5bf9\u8c61\u4e2d\u7684\u7279\u5b9a\u72b6\u6001\u6240\u5bf9\u5e94\u7684\u884c\u4e3a\uff0c\u53ef\u4ee5\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u884c\u4e3a\u3002</li> <li>\u5177\u4f53\u72b6\u6001\uff08Concrete State\uff09\u89d2\u8272\uff1a\u5b9e\u73b0\u62bd\u8c61\u72b6\u6001\u6240\u5bf9\u5e94\u7684\u884c\u4e3a\uff0c\u5e76\u4e14\u5728\u9700\u8981\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u72b6\u6001\u5207\u6362\u3002</li> </ol>"},{"location":"code_guide/design_pattern/state.html#_5","title":"\u4f18\u52a3\u52bf","text":"<p>\u4f18\u70b9\uff1a </p> <ul> <li>\u7ed3\u6784\u6e05\u6670\uff0c\u72b6\u6001\u6a21\u5f0f\u5c06\u4e0e\u7279\u5b9a\u72b6\u6001\u76f8\u5173\u7684\u884c\u4e3a\u5c40\u90e8\u5316\u5230\u4e00\u4e2a\u72b6\u6001\u4e2d\uff0c\u5e76\u4e14\u5c06\u4e0d\u540c\u72b6\u6001\u7684\u884c\u4e3a\u5206\u5272\u5f00\u6765\uff0c\u6ee1\u8db3\u201c\u5355\u4e00\u804c\u8d23\u539f\u5219\u201d\u3002</li> <li>\u5c06\u72b6\u6001\u8f6c\u6362\u663e\u793a\u5316\uff0c\u51cf\u5c11\u5bf9\u8c61\u95f4\u7684\u76f8\u4e92\u4f9d\u8d56\u3002\u5c06\u4e0d\u540c\u7684\u72b6\u6001\u5f15\u5165\u72ec\u7acb\u7684\u5bf9\u8c61\u4e2d\u4f1a\u4f7f\u5f97\u72b6\u6001\u8f6c\u6362\u53d8\u5f97\u66f4\u52a0\u660e\u786e\uff0c\u4e14\u51cf\u5c11\u5bf9\u8c61\u95f4\u7684\u76f8\u4e92\u4f9d\u8d56\u3002</li> <li>\u72b6\u6001\u7c7b\u804c\u8d23\u660e\u786e\uff0c\u6709\u5229\u4e8e\u7a0b\u5e8f\u7684\u6269\u5c55\u3002\u901a\u8fc7\u5b9a\u4e49\u65b0\u7684\u5b50\u7c7b\u5f88\u5bb9\u6613\u5730\u589e\u52a0\u65b0\u7684\u72b6\u6001\u548c\u8f6c\u6362\u3002</li> <li>\u53ef\u4ee5\u8ba9\u591a\u4e2a\u73af\u5883\u5bf9\u8c61\u5171\u4eab\u4e00\u4e2a\u72b6\u6001\u5bf9\u8c61\uff0c\u4ece\u800c\u51cf\u5c11\u7cfb\u7edf\u4e2d\u5bf9\u8c61\u7684\u4e2a\u6570\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a </p> <ul> <li>\u72b6\u6001\u6a21\u5f0f\u7684\u4f7f\u7528\u5fc5\u7136\u4f1a\u589e\u52a0\u7cfb\u7edf\u7c7b\u548c\u5bf9\u8c61\u7684\u4e2a\u6570\uff1b</li> <li>\u72b6\u6001\u6a21\u5f0f\u7684\u7ed3\u6784\u4e0e\u5b9e\u73b0\u90fd\u8f83\u4e3a\u590d\u6742\uff0c\u5982\u679c\u4f7f\u7528\u4e0d\u5f53\u5c06\u5bfc\u81f4\u7a0b\u5e8f\u7ed3\u6784\u548c\u4ee3\u7801\u7684\u6df7\u4e71\uff1b</li> <li>\u72b6\u6001\u6a21\u5f0f\u5bf9\"\u5f00\u95ed\u539f\u5219\"\u7684\u652f\u6301\u5e76\u4e0d\u592a\u597d\uff0c\u5bf9\u4e8e\u53ef\u4ee5\u5207\u6362\u72b6\u6001\u7684\u72b6\u6001\u6a21\u5f0f\uff0c\u589e\u52a0\u65b0\u7684\u72b6\u6001\u7c7b\u9700\u8981\u4fee\u6539\u90a3\u4e9b\u8d1f\u8d23\u72b6\u6001\u8f6c\u6362\u7684\u6e90\u4ee3\u7801\uff0c\u5426\u5219\u65e0\u6cd5\u5207\u6362\u5230\u65b0\u589e\u72b6\u6001\uff0c\u800c\u4e14\u4fee\u6539\u67d0\u4e2a\u72b6\u6001\u7c7b\u7684\u884c\u4e3a\u4e5f\u9700\u4fee\u6539\u5bf9\u5e94\u7c7b\u7684\u6e90\u4ee3\u7801\u3002</li> </ul>"},{"location":"code_guide/design_pattern/strategy.html","title":"\u7b56\u7565\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/strategy.html#_2","title":"\u610f\u56fe","text":"<p>\u5b9a\u4e49\u4e00\u7cfb\u5217\u7684\u7b97\u6cd5,\u628a\u5b83\u4eec\u4e00\u4e2a\u4e2a\u5c01\u88c5\u8d77\u6765, \u5e76\u4e14\u4f7f\u5b83\u4eec\u53ef\u76f8\u4e92\u66ff\u6362\u3002</p> <p>\u89e3\u51b3\uff1a\u5728\u6709\u591a\u79cd\u7b97\u6cd5\u76f8\u4f3c\u7684\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528 if...else \u6240\u5e26\u6765\u7684\u590d\u6742\u548c\u96be\u4ee5\u7ef4\u62a4\u3002</p>"},{"location":"code_guide/design_pattern/strategy.html#_3","title":"\u9002\u7528\u6027","text":"<p>1\u3001\u5982\u679c\u5728\u4e00\u4e2a\u7cfb\u7edf\u91cc\u9762\u6709\u8bb8\u591a\u7c7b\uff0c\u5b83\u4eec\u4e4b\u95f4\u7684\u533a\u522b\u4ec5\u5728\u4e8e\u5b83\u4eec\u7684\u884c\u4e3a\uff0c\u90a3\u4e48\u4f7f\u7528\u7b56\u7565\u6a21\u5f0f\u53ef\u4ee5\u52a8\u6001\u5730\u8ba9\u4e00\u4e2a\u5bf9\u8c61\u5728\u8bb8\u591a\u884c\u4e3a\u4e2d\u9009\u62e9\u4e00\u79cd\u884c\u4e3a\u3002</p> <p>2\u3001\u4e00\u4e2a\u7cfb\u7edf\u9700\u8981\u52a8\u6001\u5730\u5728\u51e0\u79cd\u7b97\u6cd5\u4e2d\u9009\u62e9\u4e00\u79cd\u3002 </p> <p>3\u3001\u5982\u679c\u4e00\u4e2a\u5bf9\u8c61\u6709\u5f88\u591a\u7684\u884c\u4e3a\uff0c\u5982\u679c\u4e0d\u7528\u6070\u5f53\u7684\u6a21\u5f0f\uff0c\u8fd9\u4e9b\u884c\u4e3a\u5c31\u53ea\u597d\u4f7f\u7528\u591a\u91cd\u7684\u6761\u4ef6\u9009\u62e9\u8bed\u53e5\u6765\u5b9e\u73b0\u3002</p>"},{"location":"code_guide/design_pattern/strategy.html#_4","title":"\u7c7b","text":"<ol> <li>\u62bd\u8c61\u7b56\u7565\uff08Strategy\uff09\u7c7b\uff1a\u5b9a\u4e49\u4e86\u4e00\u4e2a\u516c\u5171\u63a5\u53e3\uff0c\u5404\u79cd\u4e0d\u540c\u7684\u7b97\u6cd5\u4ee5\u4e0d\u540c\u7684\u65b9\u5f0f\u5b9e\u73b0\u8fd9\u4e2a\u63a5\u53e3\uff0c\u73af\u5883\u89d2\u8272\u4f7f\u7528\u8fd9\u4e2a\u63a5\u53e3\u8c03\u7528\u4e0d\u540c\u7684\u7b97\u6cd5\uff0c\u4e00\u822c\u4f7f\u7528\u63a5\u53e3\u6216\u62bd\u8c61\u7c7b\u5b9e\u73b0\u3002</li> <li>\u5177\u4f53\u7b56\u7565\uff08Concrete Strategy\uff09\u7c7b\uff1a\u5b9e\u73b0\u4e86\u62bd\u8c61\u7b56\u7565\u5b9a\u4e49\u7684\u63a5\u53e3\uff0c\u63d0\u4f9b\u5177\u4f53\u7684\u7b97\u6cd5\u5b9e\u73b0\u3002</li> <li>\u73af\u5883\uff08Context\uff09\u7c7b\uff1a\u6301\u6709\u4e00\u4e2a\u7b56\u7565\u7c7b\u7684\u5f15\u7528\uff0c\u6700\u7ec8\u7ed9\u5ba2\u6237\u7aef\u8c03\u7528\u3002</li> </ol>"},{"location":"code_guide/design_pattern/strategy.html#_5","title":"\u4f18\u52a3\u52bf","text":"<p>\u4f18\u70b9\uff1a 1\u3001\u7b97\u6cd5\u53ef\u4ee5\u81ea\u7531\u5207\u6362\u3002 2\u3001\u907f\u514d\u4f7f\u7528\u591a\u91cd\u6761\u4ef6\u5224\u65ad\u3002 3\u3001\u6269\u5c55\u6027\u826f\u597d\u3002</p> <p>\u7f3a\u70b9\uff1a 1\u3001\u7b56\u7565\u7c7b\u4f1a\u589e\u591a\u3002 2\u3001\u6240\u6709\u7b56\u7565\u7c7b\u90fd\u9700\u8981\u5bf9\u5916\u66b4\u9732\u3002</p>"},{"location":"code_guide/design_pattern/template.html","title":"\u6a21\u677f\u65b9\u6cd5\u6a21\u5f0f","text":"<p>\u5b9a\u4e49\u4e00\u5957\u6d41\u7a0b\u6a21\u677f\uff0c\u6839\u636e\u9700\u8981\u5b9e\u73b0\u6a21\u677f\u4e2d\u7684\u64cd\u4f5c\u3002</p>"},{"location":"code_guide/design_pattern/template.html#_2","title":"\u610f\u56fe","text":"<p>\u5b9a\u4e49\u4e00\u4e2a\u64cd\u4f5c\u4e2d\u7684\u7b97\u6cd5\u7684\u9aa8\u67b6\uff0c\u800c\u5c06\u4e00\u4e9b\u6b65\u9aa4\u5ef6\u8fdf\u5230\u5b50\u7c7b\u4e2d\u3002\u6a21\u677f\u65b9\u6cd5\u4f7f\u5f97\u5b50\u7c7b\u53ef\u4ee5\u4e0d\u6539\u53d8\u4e00\u4e2a\u7b97\u6cd5\u7684\u7ed3\u6784\u5373\u53ef\u91cd\u5b9a\u4e49\u8be5\u7b97\u6cd5\u7684\u67d0\u4e9b\u7279\u5b9a\u6b65\u9aa4\u3002</p>"},{"location":"code_guide/design_pattern/template.html#_3","title":"\u9002\u7528\u6027","text":"<p>\u9002\u7528\u4e8e\u4ee5\u4e0b\u573a\u666f\u3002</p> <ol> <li>\u7b97\u6cd5\u7684\u6574\u4f53\u6b65\u9aa4\u5f88\u56fa\u5b9a\uff0c\u4f46\u5176\u4e2d\u4e2a\u522b\u90e8\u5206\u6613\u53d8\u65f6\uff0c\u8fd9\u65f6\u5019\u53ef\u4ee5\u4f7f\u7528\u6a21\u677f\u65b9\u6cd5\u6a21\u5f0f\uff0c\u5c06\u5bb9\u6613\u53d8\u7684\u90e8\u5206\u62bd\u8c61\u51fa\u6765\uff0c\u4f9b\u5b50\u7c7b\u5b9e\u73b0\u3002</li> <li>\u5f53\u591a\u4e2a\u5b50\u7c7b\u5b58\u5728\u516c\u5171\u7684\u884c\u4e3a\u65f6\uff0c\u53ef\u4ee5\u5c06\u5176\u63d0\u53d6\u51fa\u6765\u5e76\u96c6\u4e2d\u5230\u4e00\u4e2a\u516c\u5171\u7236\u7c7b\u4e2d\u4ee5\u907f\u514d\u4ee3\u7801\u91cd\u590d\u3002\u9996\u5148\uff0c\u8981\u8bc6\u522b\u73b0\u6709\u4ee3\u7801\u4e2d\u7684\u4e0d\u540c\u4e4b\u5904\uff0c\u5e76\u4e14\u5c06\u4e0d\u540c\u4e4b\u5904\u5206\u79bb\u4e3a\u65b0\u7684\u64cd\u4f5c\u3002\u6700\u540e\uff0c\u7528\u4e00\u4e2a\u8c03\u7528\u8fd9\u4e9b\u65b0\u7684\u64cd\u4f5c\u7684\u6a21\u677f\u65b9\u6cd5\u6765\u66ff\u6362\u8fd9\u4e9b\u4e0d\u540c\u7684\u4ee3\u7801\u3002</li> <li>\u5f53\u9700\u8981\u63a7\u5236\u5b50\u7c7b\u7684\u6269\u5c55\u65f6\uff0c\u6a21\u677f\u65b9\u6cd5\u53ea\u5728\u7279\u5b9a\u70b9\u8c03\u7528\u94a9\u5b50\u64cd\u4f5c\uff0c\u8fd9\u6837\u5c31\u53ea\u5141\u8bb8\u5728\u8fd9\u4e9b\u70b9\u8fdb\u884c\u6269\u5c55\u3002</li> </ol>"},{"location":"code_guide/design_pattern/template.html#_4","title":"\u7c7b","text":""},{"location":"code_guide/design_pattern/template.html#_5","title":"\u4f18\u52a3\u52bf","text":"<p>\u4f18\u70b9\uff1a </p> <ul> <li>\u5c01\u88c5\u4e0d\u53d8\u90e8\u5206\uff0c\u6269\u5c55\u53ef\u53d8\u90e8\u5206\uff1b</li> <li>\u63d0\u53d6\u516c\u5171\u4ee3\u7801\uff0c\u4fbf\u4e8e\u7ef4\u62a4\uff1b</li> <li>\u884c\u4e3a\u7531\u7236\u7c7b\u63a7\u5236\uff0c\u5b50\u7c7b\u5b9e\u73b0\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u7236\u7c7b\u4e2d\u7684\u62bd\u8c61\u65b9\u6cd5\u7531\u5b50\u7c7b\u5b9e\u73b0\uff0c\u5b50\u7c7b\u6267\u884c\u7684\u7ed3\u679c\u4f1a\u5f71\u54cd\u7236\u7c7b\u7684\u7ed3\u679c\uff0c\u8fd9\u5bfc\u81f4\u4e00\u79cd\u53cd\u5411\u7684\u63a7\u5236\u7ed3\u6784\uff1b</li> <li>\u7ee7\u627f\u5173\u7cfb\u81ea\u8eab\u7684\u7f3a\u70b9\uff0c\u5982\u679c\u7236\u7c7b\u6dfb\u52a0\u65b0\u7684\u62bd\u8c61\u65b9\u6cd5\uff0c\u5219\u6240\u6709\u5b50\u7c7b\u90fd\u8981\u4fee\u6539\uff1b</li> </ul>"},{"location":"code_guide/design_pattern/visitor.html","title":"\u8bbf\u95ee\u8005\u6a21\u5f0f","text":""},{"location":"code_guide/design_pattern/visitor.html#_2","title":"\u610f\u56fe","text":"<p>\u4e3b\u8981\u5c06\u6570\u636e\u7ed3\u6784\u4e0e\u6570\u636e\u64cd\u4f5c\u5206\u79bb\u3002</p> <p>\u89e3\u51b3\uff1a\u7a33\u5b9a\u7684\u6570\u636e\u7ed3\u6784\u548c\u6613\u53d8\u7684\u64cd\u4f5c\u8026\u5408\u95ee\u9898\u3002</p> <p>\u5982\u4f55\u89e3\u51b3\uff1a\u5728\u88ab\u8bbf\u95ee\u7684\u7c7b\u91cc\u9762\u52a0\u4e00\u4e2a\u5bf9\u5916\u63d0\u4f9b\u63a5\u5f85\u8bbf\u95ee\u8005\u7684\u63a5\u53e3\u3002</p>"},{"location":"code_guide/design_pattern/visitor.html#_3","title":"\u9002\u7528\u6027","text":"<p>1\u3001\u5bf9\u8c61\u7ed3\u6784\u4e2d\u5bf9\u8c61\u5bf9\u5e94\u7684\u7c7b\u5f88\u5c11\u6539\u53d8\uff0c\u4f46\u7ecf\u5e38\u9700\u8981\u5728\u6b64\u5bf9\u8c61\u7ed3\u6784\u4e0a\u5b9a\u4e49\u65b0\u7684\u64cd\u4f5c\u3002 </p> <p>2\u3001\u9700\u8981\u5bf9\u4e00\u4e2a\u5bf9\u8c61\u7ed3\u6784\u4e2d\u7684\u5bf9\u8c61\u8fdb\u884c\u5f88\u591a\u4e0d\u540c\u7684\u5e76\u4e14\u4e0d\u76f8\u5173\u7684\u64cd\u4f5c\uff0c\u800c\u9700\u8981\u907f\u514d\u8ba9\u8fd9\u4e9b\u64cd\u4f5c\"\u6c61\u67d3\"\u8fd9\u4e9b\u5bf9\u8c61\u7684\u7c7b\uff0c\u4e5f\u4e0d\u5e0c\u671b\u5728\u589e\u52a0\u65b0\u64cd\u4f5c\u65f6\u4fee\u6539\u8fd9\u4e9b\u7c7b\u3002</p>"},{"location":"code_guide/design_pattern/visitor.html#_4","title":"\u7c7b","text":""},{"location":"code_guide/design_pattern/visitor.html#_5","title":"\u4f18\u52a3\u52bf","text":"<p>\u4f18\u70b9\uff1a 1\u3001\u7b26\u5408\u5355\u4e00\u804c\u8d23\u539f\u5219\u3002 2\u3001\u4f18\u79c0\u7684\u6269\u5c55\u6027\u3002 3\u3001\u7075\u6d3b\u6027\u3002</p> <p>\u7f3a\u70b9\uff1a 1\u3001\u5177\u4f53\u5143\u7d20\u5bf9\u8bbf\u95ee\u8005\u516c\u5e03\u7ec6\u8282\uff0c\u8fdd\u53cd\u4e86\u8fea\u7c73\u7279\u539f\u5219\u3002 2\u3001\u5177\u4f53\u5143\u7d20\u53d8\u66f4\u6bd4\u8f83\u56f0\u96be\u3002 3\u3001\u8fdd\u53cd\u4e86\u4f9d\u8d56\u5012\u7f6e\u539f\u5219\uff0c\u4f9d\u8d56\u4e86\u5177\u4f53\u7c7b\uff0c\u6ca1\u6709\u4f9d\u8d56\u62bd\u8c61\u3002</p>"},{"location":"courses/learning_deep_cs/cs.html","title":"\u6df1\u5165\u7406\u89e3\u8ba1\u7b97\u673a\u7cfb\u7edf","text":"<p>\u7f16\u8bd1\u5668</p> <p></p> <p>\u89e3\u91ca\u5668</p> <p></p>"},{"location":"courses/os_lab/index.html","title":"OS Lab 2023","text":"<p>\u5b98\u65b9\u7f51\u7ad9\uff1ahttps://jyywiki.cn/OS/2023/</p> <p>\u53c2\u8003\u4e66\u7c4d\uff1a</p> <ul> <li>The Hitchhiker\u2019s Guide to Operating Systems</li> <li>Parallel and Distributed Computation: Numerical Methods</li> </ul> <p>\u53c2\u8003\u4e66\uff1a</p> <ul> <li>[OSTEP] Remzi H. Arpaci-Dusseau and Andrea C. Arpaci-Dusseau. Operating Systems: Three Easy Pieces. Arpaci-Dusseau Books, 2018.</li> <li>[CSAPP] Randal E. Bryant and David R. O'Hallaron. Computer Systems: A Programmer's Perspective (3ed). Pearson, 2017. (\u4f5c\u4e3a\u624b\u518c\u548c\u53c2\u8003\u4e66\u67e5\u9605)</li> </ul> <p>https://jyywiki.cn/os-demos</p>"},{"location":"courses/os_lab/index.html#_1","title":"\u8bfe\u7a0b\u5927\u7eb2","text":"<p>\u968f\u5802\uff08\u8bfe\u4ef6\u4e2d\u7684\uff09\u4ee3\u7801\uff1aOS_LAB_CODE </p>"},{"location":"courses/os_lab/index.html#_2","title":"\u8bfe\u540e\u5b9e\u9a8c","text":"<p>\u5b9e\u9a8c\u90e8\u5206\uff0c\u8986\u76d6\u4e862022/2023/2024\u7684\u6240\u6709\u5b9e\u9a8c\u3002</p> <p>MiniLab \u548c OSLab \u5e94\u8981\u6c42\uff0c\u4e0d\u8fdb\u884c\u5f00\u6e90\u3002\u6846\u67b6\u4ee3\u7801\u89c1 Yanyan Jiang / os-workbench</p> <p>Mini Lab</p> <ul> <li>M1\uff1a\u6253\u5370\u8fdb\u7a0b\u6811</li> <li>M2\uff1a\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\u7684\u5e76\u884c\u5316</li> <li>M2: \u534f\u7a0b\u5e93</li> <li>M3\uff1a\u7cfb\u7edf\u8c03\u7528 Profiler</li> <li>M4\uff1aC\u8bed\u8a00\u7684REPL</li> <li>M5:\u5e76\u884c\u5185\u5b58\u5206\u914d\u5668</li> <li>M6:GPT-2 \u5e76\u884c\u63a8\u7406</li> <li>M7: httpd</li> <li>M8\uff1a\u6587\u4ef6\u4fee\u590d</li> <li>M9:Key-value Database</li> </ul> <p>OS Lab</p> <ul> <li>L0: \u4e3a\u8ba1\u7b97\u673a\u786c\u4ef6\u7f16\u7a0b</li> <li>L1: \u7269\u7406\u5185\u5b58\u7ba1\u7406 (pmm)</li> <li>L2: \u5185\u6838\u7ebf\u7a0b\u7ba1\u7406 (kmt)</li> <li>L3: \u7528\u6237\u6001\u8fdb\u7a0b (uproc)</li> <li>L4: \u865a\u62df\u6587\u4ef6\u7cfb\u7edf (vfs)</li> </ul>"},{"location":"courses/os_lab/01-os_introduction.html","title":"\u64cd\u4f5c\u7cfb\u7edf\u6982\u8ff0","text":"<p>\u9605\u8bfb\u6750\u6599 </p> <p>\u6559\u79d1\u4e66 Operating Systems: Three Easy Pieces\uff08V1.00\uff09 </p> <ul> <li> <p>Preface \u524d\u8a00</p> </li> <li> <p>\u7b2c 1 \u7ae0 - Dialogue on the Book</p> </li> <li> <p>\u7b2c 2 \u7ae0 - Introduction to Operating Systems</p> </li> </ul> <p>\u5ef6\u4f38\u9605\u8bfb\uff1a</p> <ul> <li>Harley Hahn's Guide to Unix and Linux</li> </ul> <p>\u865a\u62df\u5316\uff1aCPU \u5206\u65f6\u5171\u4eab\uff0c\u865a\u62df\u5316\u5185\u5b58\uff08\u865a\u62df\u5730\u5740\u7a7a\u95f4\uff09</p> <p>\u5e76\u53d1\uff1a\u591a\u7ebf\u7a0b</p> <p>\u6301\u4e45\u5316\uff1aIO</p>"},{"location":"courses/os_lab/01-os_introduction.html#_2","title":"\u4ec0\u4e48\u662f\u64cd\u4f5c\u7cfb\u7edf\uff1f","text":"<p>\u201c\u7ba1\u7406\u8f6f/\u786c\u4ef6\u8d44\u6e90\u3001\u4e3a\u7a0b\u5e8f\u63d0\u4f9b\u670d\u52a1\u201d \u7684\u7a0b\u5e8f\uff1f</p> <p></p>"},{"location":"courses/os_lab/01-os_introduction.html#_3","title":"\u72ed\u4e49\u7684\u64cd\u4f5c\u7cfb\u7edf","text":"<p>\u672c\u8bfe\u7a0b\u8ba8\u8bba\u72ed\u4e49\u7684\u64cd\u4f5c\u7cfb\u7edf</p> <ul> <li>\u64cd\u4f5c\u7cfb\u7edf\uff1a\u786c\u4ef6\u548c\u8f6f\u4ef6\u7684\u4e2d\u95f4\u5c42</li> <li>\u5bf9\u5355\u673a (\u591a\u5904\u7406\u5668) \u4f5c\u51fa\u62bd\u8c61</li> <li>\u652f\u6491\u591a\u4e2a\u7a0b\u5e8f\u6267\u884c</li> <li>\u5b66\u672f\u754c\u8c08\u8bba\u7684 \u201c\u64cd\u4f5c\u7cfb\u7edf\u201d \u662f\u66f4\u5e7f\u4e49\u7684 \u201cSystem\u201d</li> <li>\u4f8b\u5b50\uff1a\u5bf9\u591a\u53f0\u8ba1\u7b97\u673a\u62bd\u8c61 (\u5206\u5e03\u5f0f\u7cfb\u7edf)</li> </ul> <p>\u64cd\u4f5c\u7cfb\u7edf\uff1a\u8f6f\u4ef6\u786c\u4ef6\u4e4b\u95f4\u7684\u6865\u6881</p> <ul> <li>\u672c\u8bfe\u7a0b\u4e2d\u7684\u8f6f\u4ef6\uff1a\u591a\u7ebf\u7a0b Linux \u5e94\u7528\u7a0b\u5e8f</li> <li>\u672c\u8bfe\u7a0b\u4e2d\u7684\u786c\u4ef6\uff1a\u73b0\u4ee3\u591a\u5904\u7406\u5668\u7cfb\u7edf</li> </ul>"},{"location":"courses/os_lab/01-os_introduction.html#_4","title":"\u4e0d\u540c\u89c6\u89d2\u7684\u64cd\u4f5c\u7cfb\u7edf","text":"<p>(\u8bbe\u8ba1/\u5e94\u7528\u89c6\u89d2) \u64cd\u4f5c\u7cfb\u7edf\u4e3a\u5e94\u7528\u63d0\u4f9b\u4ec0\u4e48\u670d\u52a1\uff1f</p> <ul> <li>\u64cd\u4f5c\u7cfb\u7edf = \u5bf9\u8c61 + API</li> <li>\u8bfe\u7a0b\u6d89\u53ca\uff1aPOSIX + \u90e8\u5206 Linux \u7279\u6027</li> </ul> <p>(\u5b9e\u73b0/\u786c\u4ef6\u89c6\u89d2) \u5982\u4f55\u5b9e\u73b0\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u670d\u52a1\uff1f</p> <ul> <li>\u64cd\u4f5c\u7cfb\u7edf = C \u7a0b\u5e8f</li> <li>\u5b8c\u6210\u521d\u59cb\u5316\u540e\u5c31\u6210\u4e3a <code>interrupt/trap/fault handler</code></li> <li>\u8bfe\u7a0b\u6d89\u53ca\uff1axv6, \u81ea\u5236\u8ff7\u4f60\u64cd\u4f5c\u7cfb\u7edf</li> </ul>"},{"location":"courses/os_lab/01-os_introduction.html#_5","title":"\u5386\u53f2\u53d1\u5c55","text":""},{"location":"courses/os_lab/01-os_introduction.html#eniac-1946214","title":"ENIAC: 1946.2.14","text":"<p>\u201c\u56fe\u7075\u673a\u201d \u7684\u6570\u5b57\u7535\u8def\u5b9e\u73b0</p> <ul> <li>\u6267\u884c\u5b8c\u4e00\u6761\u6307\u4ee4\u540e\uff0c\u53ef\u4ee5\u6839\u636e\u7ed3\u679c\u8df3\u8f6c\u5230\u4efb\u610f\u4e00\u6761\u6307\u4ee4 (\u7528\u7269\u7406\u7ebf\u8def \u201chard-wire\u201d)</li> <li>\u91cd\u7f16\u7a0b\u9700\u8981\u91cd\u65b0\u63a5\u7ebf\uff1aEmulator and Programming the ENIAC</li> </ul>"},{"location":"courses/os_lab/01-os_introduction.html#1940s","title":"1940s","text":""},{"location":"courses/os_lab/01-os_introduction.html#_6","title":"\u8ba1\u7b97\u673a\u786c\u4ef6","text":"<p>\u7535\u5b50\u8ba1\u7b97\u673a\u7684\u5b9e\u73b0</p> <ul> <li>\u903b\u8f91\u95e8\uff1a\u771f\u7a7a\u7535\u5b50\u7ba1</li> <li>\u5b58\u50a8\u5668\uff1a\u5ef6\u8fdf\u7ebf (delay lines)</li> <li>\u8f93\u5165/\u8f93\u51fa\uff1a\u6253\u5b54\u7eb8\u5e26/\u6307\u793a\u706f</li> </ul> <p></p>"},{"location":"courses/os_lab/01-os_introduction.html#_7","title":"\u8ba1\u7b97\u673a\u8f6f\u4ef6","text":"<p>\u6253\u5370\u5e73\u65b9\u6570\u3001\u7d20\u6570\u8868\u3001\u8ba1\u7b97\u5f39\u9053</p> <ul> <li>\u5927\u5bb6\u8fd8\u5728\u548c\u771f\u6b63\u7684 \u201cbugs\u201d \u6218\u6597</li> </ul> <p></p>"},{"location":"courses/os_lab/01-os_introduction.html#_8","title":"\u64cd\u4f5c\u7cfb\u7edf","text":"<p>\u6ca1\u6709\u64cd\u4f5c\u7cfb\u7edf\u3002</p> <p>\u80fd\u628a\u7a0b\u5e8f\u653e\u4e0a\u53bb\u5c31\u5f88\u4e86\u4e0d\u8d77\u4e86</p> <ul> <li>\u7a0b\u5e8f\u76f4\u63a5\u7528\u6307\u4ee4\u64cd\u4f5c\u786c\u4ef6</li> <li>\u4e0d\u9700\u8981\u753b\u86c7\u6dfb\u8db3\u7684\u7a0b\u5e8f\u6765\u7ba1\u7406\u5b83</li> </ul>"},{"location":"courses/os_lab/01-os_introduction.html#1950s","title":"1950S","text":"<p>\u66f4\u5feb\u66f4\u5c0f\u7684\u903b\u8f91\u95e8 (\u6676\u4f53\u7ba1)\u3001\u66f4\u5927\u7684\u5185\u5b58 (\u78c1\u82af)\u3001\u4e30\u5bcc\u7684 I/O \u8bbe\u5907</p> <ul> <li>I/O \u8bbe\u5907\u7684\u901f\u5ea6\u5df2\u7ecf\u4e25\u91cd\u4f4e\u4e8e\u5904\u7406\u5668\u7684\u901f\u5ea6\uff0c\u4e2d\u65ad\u673a\u5236\u51fa\u73b0 (1953)</li> </ul> <p></p>"},{"location":"courses/os_lab/01-os_introduction.html#_9","title":"\u8ba1\u7b97\u673a\u8f6f\u4ef6","text":"<p>\u66f4\u590d\u6742\u7684\u901a\u7528\u7684\u6570\u503c\u8ba1\u7b97</p> <ul> <li>\u9ad8\u7ea7\u8bed\u8a00\u548c API \u8bde\u751f (Fortran, 1957)\uff1a\u4e00\u884c\u4ee3\u7801\uff0c\u4e00\u5f20\u5361\u7247</li> <li>80 \u884c\u7684\u89c4\u8303\u6cbf\u7528\u81f3\u4eca (\u7ec6\u8282\uff1a\u6253\u5370\u673a\u4f1a\u5370\u5237\u672c\u884c\u4ee3\u7801)</li> </ul> <p></p> <p>Fortran \u5df2\u7ecf \u201c\u8db3\u591f\u597d\u7528\u201d</p> <ul> <li>\u81ea\u7136\u79d1\u5b66\u3001\u5de5\u7a0b\u673a\u68b0\u3001\u519b\u4e8b\u2026\u2026\u5bf9\u8ba1\u7b97\u673a\u7684\u9700\u6c42\u66b4\u6da8</li> </ul> <pre><code>C---- THIS PROGRAM READS INPUT FROM THE CARD READER,\nC---- 3 INTEGERS IN EACH CARD, CALCULATE AND OUTPUT\nC---- THE SUM OF THEM.\n  100 READ(5,10) I1, I2, I3\n   10 FORMAT(3I5)\n      IF (I1.EQ.0 .AND. I2.EQ.0 .AND. I3.EQ.0) GOTO 200\n      ISUM = I1 + I2 + I3\n      WRITE(6,20) I1, I2, I3, ISUM\n   20 FORMAT(7HSUM OF , I5, 2H, , I5, 5H AND , I5,\n     *   4H IS , I6)\n      GOTO 100\n  200 STOP\n      END\n</code></pre>"},{"location":"courses/os_lab/01-os_introduction.html#_10","title":"\u64cd\u4f5c\u7cfb\u7edf","text":"<p>\u5e93\u51fd\u6570 + \u7ba1\u7406\u7a0b\u5e8f\u6392\u961f\u8fd0\u884c\u7684\u8c03\u5ea6\u4ee3\u7801\u3002</p> <p>\u5199\u7a0b\u5e8f (\u6233\u7eb8\u5e26)\u3001\u8dd1\u7a0b\u5e8f\u90fd\u662f\u975e\u5e38\u8d39\u4e8b\u7684</p> <ul> <li> <p>\u8ba1\u7b97\u673a\u975e\u5e38\u8d35 (\\(\\$50,000\u2212\\$1,000,000\\))\uff0c\u4e00\u4e2a\u5b66\u6821\u53ea\u6709\u4e00\u53f0</p> </li> <li> <p>\u7b97\u529b\u6210\u4e3a\u4e00\u79cd\u670d\u52a1\uff1a\u591a\u7528\u6237\u8f6e\u6d41\u5171\u4eab\u8ba1\u7b97\u673a\uff0chunman operator \u8d1f\u8d23\u8c03\u5ea6</p> </li> </ul> <p>\u64cd\u4f5c\u7cfb\u7edf\u7684\u6982\u5ff5\u5f00\u59cb\u5f62\u6210</p> <ul> <li>\u64cd\u4f5c (operate) \u4efb\u52a1 (jobs) \u7684\u7cfb\u7edf (system)</li> <li>\u201c\u6279\u5904\u7406\u7cfb\u7edf\u201d = \u7a0b\u5e8f\u7684\u81ea\u52a8\u5207\u6362 (\u6362\u5361) + \u5e93\u51fd\u6570 API</li> <li>Disk Operating Systems (DOS)<ul> <li>\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5f00\u59cb\u51fa\u73b0 \u201c\u8bbe\u5907\u201d\u3001\u201c\u6587\u4ef6\u201d\u3001\u201c\u4efb\u52a1\u201d \u7b49\u5bf9\u8c61\u548c API</li> </ul> </li> </ul>"},{"location":"courses/os_lab/01-os_introduction.html#1960s","title":"1960S","text":""},{"location":"courses/os_lab/01-os_introduction.html#_11","title":"\u8ba1\u7b97\u673a\u786c\u4ef6","text":"<p>\u96c6\u6210\u7535\u8def\u3001\u603b\u7ebf\u51fa\u73b0</p> <ul> <li>\u66f4\u5feb\u7684\u5904\u7406\u5668</li> <li>\u66f4\u5feb\u3001\u66f4\u5927\u7684\u5185\u5b58\uff1b\u865a\u62df\u5b58\u50a8\u51fa\u73b0</li> <li>\u53ef\u4ee5\u540c\u65f6\u8f7d\u5165\u591a\u4e2a\u7a0b\u5e8f\u800c\u4e0d\u7528 \u201c\u6362\u5361\u201d \u4e86</li> <li>\u66f4\u4e30\u5bcc\u7684 I/O \u8bbe\u5907\uff1b\u5b8c\u5584\u7684\u4e2d\u65ad/\u5f02\u5e38\u673a\u5236</li> </ul> <p></p>"},{"location":"courses/os_lab/01-os_introduction.html#_12","title":"\u8ba1\u7b97\u673a\u8f6f\u4ef6","text":"<p>\u66f4\u591a\u7684\u9ad8\u7ea7\u8bed\u8a00\u548c\u7f16\u8bd1\u5668\u51fa\u73b0</p> <ul> <li>COBOL (1960), APL (1962), BASIC (1965)</li> <li>Bill Gates \u548c Paul Allen \u5728 1975 \u5e74\u5b9e\u73b0\u4e86 Altair 8800 \u4e0a\u7684 BASIC \u89e3\u91ca\u5668</li> </ul> <p>\u8ba1\u7b97\u673a\u79d1\u5b66\u5bb6\u4eec\u5df2\u7ecf\u5728\u4eca\u5929\u96be\u4ee5\u60f3\u8c61\u7684\u8ba1\u7b97\u529b\u4e0b\u5f00\u53d1\u60ca\u5947\u7684\u7a0b\u5e8f</p> <p></p>"},{"location":"courses/os_lab/01-os_introduction.html#_13","title":"\u64cd\u4f5c\u7cfb\u7edf","text":"<p>\u80fd\u8f7d\u5165\u591a\u4e2a\u7a0b\u5e8f\u5230\u5185\u5b58\u4e14\u8c03\u5ea6\u5b83\u4eec\u7684\u7ba1\u7406\u7a0b\u5e8f\u3002</p> <p>\u4e3a\u9632\u6b62\u7a0b\u5e8f\u4e4b\u95f4\u5f62\u6210\u5e72\u6270\uff0c\u64cd\u4f5c\u7cfb\u7edf\u81ea\u7136\u5730\u5c06\u5171\u4eab\u8d44\u6e90 (\u5982\u8bbe\u5907) \u4ee5 API \u5f62\u5f0f\u7ba1\u7406\u8d77\u6765</p> <ul> <li>\u6709\u4e86\u8fdb\u7a0b (process) \u7684\u6982\u5ff5</li> <li>\u8fdb\u7a0b\u5728\u6267\u884c I/O \u65f6\uff0c\u53ef\u4ee5\u5c06 CPU \u8ba9\u7ed9\u53e6\u4e00\u4e2a\u8fdb\u7a0b</li> <li>\u5728\u591a\u4e2a\u5730\u5740\u7a7a\u95f4\u9694\u79bb\u7684\u7a0b\u5e8f\u4e4b\u95f4\u5207\u6362</li> <li>\u865a\u62df\u5b58\u50a8\u4f7f\u4e00\u4e2a\u7a0b\u5e8f\u51fa bug \u4e0d\u4f1a crash \u6574\u4e2a\u7cfb\u7edf</li> </ul> <p>\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u81ea\u7136\u5730\u589e\u52a0\u8fdb\u7a0b\u7ba1\u7406 API</p> <ul> <li>\u65e2\u7136\u53ef\u4ee5\u5728\u7a0b\u5e8f\u4e4b\u95f4\u5207\u6362\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u8ba9\u5b83\u4eec\u5b9a\u65f6\u5207\u6362\u5462\uff1f</li> <li>Multics (MIT, 1965)\uff1a\u73b0\u4ee3\u5206\u65f6\u64cd\u4f5c\u7cfb\u7edf\u8bde\u751f</li> </ul>"},{"location":"courses/os_lab/01-os_introduction.html#1970s","title":"1970s+","text":""},{"location":"courses/os_lab/01-os_introduction.html#_14","title":"\u8ba1\u7b97\u673a\u786c\u4ef6","text":"<p>\u96c6\u6210\u7535\u8def\u7a7a\u524d\u53d1\u5c55\uff0c\u4e2a\u4eba\u7535\u8111\u5174\u8d77\uff0c\u201c\u8ba1\u7b97\u673a\u201d \u5df2\u4e0e\u4eca\u65e5\u65e0\u5927\u5f02</p> <ul> <li>CISC \u6307\u4ee4\u96c6\uff1b\u4e2d\u65ad\u3001I/O\u3001\u5f02\u5e38\u3001MMU\u3001\u7f51\u7edc</li> <li>\u4e2a\u4eba\u8ba1\u7b97\u673a (PC \u673a)\u3001\u8d85\u7ea7\u8ba1\u7b97\u673a\u2026\u2026</li> </ul> <p></p>"},{"location":"courses/os_lab/01-os_introduction.html#_15","title":"\u8ba1\u7b97\u673a\u8f6f\u4ef6","text":"<p>PASCAL (1970), C (1972), \u2026</p> <ul> <li>\u4eca\u5929\u80fd\u529e\u5230\u7684\uff0c\u90a3\u4e2a\u65f6\u4ee3\u5df2\u7ecf\u90fd\u80fd\u529e\u5230\u4e86\u2014\u2014\u4e0a\u5929\u5165\u5730\u3001\u56fe\u50cf\u58f0\u97f3\u89c6\u9891\u3001\u4eba\u5de5\u667a\u80fd\u2026\u2026</li> <li>\u4e2a\u4eba\u5f00\u53d1\u8005 (Geek Network) \u8d70\u4e0a\u821e\u53f0</li> </ul> <p></p>"},{"location":"courses/os_lab/01-os_introduction.html#_16","title":"\u64cd\u4f5c\u7cfb\u7edf","text":"<p>\u5206\u65f6\u7cfb\u7edf\u8d70\u5411\u6210\u719f\uff0cUNIX \u8bde\u751f\u5e76\u8d70\u5411\u5b8c\u5584\uff0c\u5960\u5b9a\u4e86\u73b0\u4ee3\u64cd\u4f5c\u7cfb\u7edf\u7684\u5f62\u6001\u3002</p> <ul> <li>1973: \u4fe1\u53f7 API\u3001\u7ba1\u9053 (\u5bf9\u8c61)\u3001grep (\u5e94\u7528\u7a0b\u5e8f)</li> <li>1983: BSD socket (\u5bf9\u8c61)</li> <li>1984: procfs (\u5bf9\u8c61)\u2026\u2026</li> <li>UNIX \u884d\u751f\u51fa\u7684\u5927\u5bb6\u65cf</li> <li>1BSD (1977), GNU (1983), MacOS (1984), AIX (1986), Minix (1987), Windows (1985), Linux 0.01 (1991), Windows NT (1993), Debian (1996), Windows XP (2002), Ubuntu (2004), iOS (2007), Android (2008), Windows 10 (2015), \u2026\u2026</li> </ul>"},{"location":"courses/os_lab/01-os_introduction.html#_17","title":"\u4eca\u5929\u7684\u64cd\u4f5c\u7cfb\u7edf","text":"<p>\u901a\u8fc7 \u201c\u865a\u62df\u5316\u201d \u786c\u4ef6\u8d44\u6e90\u4e3a\u7a0b\u5e8f\u8fd0\u884c\u63d0\u4f9b\u670d\u52a1\u7684\u8f6f\u4ef6\u3002</p> <p>\u7a7a\u524d\u590d\u6742\u7684\u7cfb\u7edf\u4e4b\u4e00</p> <ul> <li>\u66f4\u590d\u6742\u7684\u5904\u7406\u5668\u548c\u5185\u5b58</li> <li>\u975e\u5bf9\u79f0\u591a\u5904\u7406\u5668 (ARM big.LITTLE; Intel P/E-cores)</li> <li>Non-uniform Memory Access (NUMA)</li> <li>\u66f4\u591a\u7684\u786c\u4ef6\u673a\u5236 Intel-VT/AMD-V, TrustZone/~~SGX~~, TSX, ...</li> <li>\u66f4\u591a\u7684\u8bbe\u5907\u548c\u8d44\u6e90</li> <li>\u7f51\u5361\u3001SSD\u3001GPU\u3001FPGA...</li> <li>\u590d\u6742\u7684\u5e94\u7528\u9700\u6c42\u548c\u5e94\u7528\u73af\u5883</li> <li>\u670d\u52a1\u5668\u3001\u4e2a\u4eba\u7535\u8111\u3001\u667a\u80fd\u624b\u673a\u3001\u624b\u8868\u3001\u624b\u73af\u3001IoT/\u5fae\u63a7\u5236\u5668\u2026\u2026</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html","title":"\u5e94\u7528\u89c6\u89d2\u7684\u64cd\u4f5c\u7cfb\u7edf","text":"<p>STFW: Search The Friendly Website.</p> <p>RTFM: Read The Friendly Manual.</p> <p>\u5e94\u7528\u7a0b\u5e8f\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u6c9f\u901a\u7684\u552f\u4e00\u6865\u6881\u662f\u7cfb\u7edf\u8c03\u7528\u6307\u4ee4 (\u4f8b\u5982 x86-64 \u7684 syscall)\u3002</p> <p>\u672c\u8bb2\u5185\u5bb9\uff1a\u6307\u4ee4\u5e8f\u5217\u548c\u9ad8\u7ea7\u8bed\u8a00\u7684\u72b6\u6001\u673a\u6a21\u578b\uff1b\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898\uff1a</p> <ul> <li>\u4ec0\u4e48\u662f\u8f6f\u4ef6 (\u7a0b\u5e8f)\uff1f</li> <li>\u5982\u4f55\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u6784\u9020\u6700\u5c0f/\u4e00\u822c/\u56fe\u5f62\u754c\u9762\u5e94\u7528\u7a0b\u5e8f\uff1f</li> <li>\u4ec0\u4e48\u662f\u7f16\u8bd1\u5668\uff1f\u7f16\u8bd1\u5668\u628a\u4e00\u6bb5\u7a0b\u5e8f\u7ffb\u8bd1\u6210\u4ec0\u4e48\u6837\u7684\u6307\u4ee4\u5e8f\u5217\u624d\u7b97 \u201c\u6b63\u786e\u201d\uff1f</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html#_2","title":"\u6c47\u7f16\u4ee3\u7801\u548c\u6700\u5c0f\u53ef\u6267\u884c\u6587\u4ef6","text":""},{"location":"courses/os_lab/02-os_appview.html#hello-world","title":"\u6784\u9020\u6700\u5c0f\u7684 Hello, World \u201c\u5e94\u7528\u7a0b\u5e8f\u201d","text":"<pre><code>int main() {\n  printf(\"Hello, World\\n\");\n}\n</code></pre> <p>gcc \u7f16\u8bd1\u51fa\u6765\u7684\u6587\u4ef6\u4e00\u70b9\u4e5f\u4e0d\u5c0f</p> <ul> <li><code>objdump -d</code>\u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u5bf9\u5e94\u7684\u6c47\u7f16\u4ee3\u7801\uff1b</li> <li><code>printf</code> \u88ab\u7f16\u8bd1\u5668\u4f18\u5316\u53d8\u6210\u4e86 <code>puts@plt</code></li> <li><code>-Wl,--verbose</code> \u53ef\u4ee5\u67e5\u770bgcc \u7f16\u8bd1\u65f6\u7684\u6240\u6709\u94fe\u63a5\u9009\u9879 (\u771f\u4e0d\u5c11)\uff1b</li> <li>gcc\u91c7\u7528<code>-static</code> \u9009\u9879\u7f16\u8bd1\uff0c\u4f1a\u94fe\u63a5 libc (\u5927\u91cf\u7684\u4ee3\u7801)\uff1b</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html#hello-world_1","title":"\u5f3a\u884c\u6784\u9020\u6700\u5c0f\u7684 Hello, World\uff1f","text":"<p><code>gcc hello.c</code>\u7684\u7f16\u8bd1\u6d41\u7a0b</p> <pre><code>graph LR\n    c(.c) --cc--&gt;s(.s) \n    s --as--&gt;O(.o) \n    O  --ld--&gt; E(a.out)</code></pre> <p>\u5c1d\u8bd5\u4ee5\u4e0b\u6b65\u9aa4\uff1a</p> <ol> <li> <p><code>gcc -c hello.c</code> \u751f\u6210 <code>hello.o</code>\uff0c<code>ld hello.o</code> \u62a5\u9519</p> </li> <li> <p><code>undefined reference to 'puts'</code> \u62a5\u9519\uff0c\u8fde\u63a5\u65f6\u65e0\u6cd5\u627e\u5230\uff1b</p> </li> <li> <p>\u5220\u9664 <code>printf</code>\u4ee3\u7801\uff0c<code>ld hello.o -e main</code></p> </li> <li> <p>\u6267\u884c\u65f6<code>./a.out</code>\uff0c<code>Segmentation Fault</code>\u62a5\u9519\uff1b</p> </li> <li> <p><code>main</code>\u4ee3\u7801\u91cc\u6539\u6210\u6b7b\u5faa\u73af\uff0c \u7a0b\u5e8f\u53ef\u4ee5\u6b63\u5e38\u6267\u884c\uff08\uff09\uff1b</p> </li> <li> <p>\u901a\u8fc7<code>a.out</code>\u6c47\u7f16\u4ee3\u7801\uff0c\u731c\u6d4b<code>ret</code>\u6307\u4ee4\u51fa\u73b0\u95ee\u9898\uff0c\u9a8c\u8bc1 ret \u5730\u5740\u4e3a 0x1</p> </li> <li> <p>gdb \u8c03\u8bd5\uff0c\u5355\u6b65\u6267\u884c\uff0c\u5728\u7b2c\u4e00\u6761\u6307\u4ee4\u65f6\u505c\u4e0b\u6765\uff1b</p> </li> <li> <p><code>starti</code>, <code>layout asm</code>\u7b49\u547d\u4ee4\uff0c\u6267\u884c\u7ed3\u679c<code>Cannot access memory at address 0x1</code>\uff1b</p> </li> <li> <p>\u7528\u4e00\u6761\u7279\u6b8a\u7684\u6307\u4ee4\u8bf7\u64cd\u4f5c\u7cfb\u7edf\u5e2e\u5fd9\uff0c<code>syscall</code></p> </li> <li> <p>\u7a0b\u5e8f\u628a\u63a7\u5236\u6743\u5b8c\u5168\u4ea4\u7ed9\u64cd\u4f5c\u7cfb\u7edf\uff0c\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u6539\u53d8\u7a0b\u5e8f\u72b6\u6001\u751a\u81f3\u7ec8\u6b62\u7a0b\u5e8f</p> </li> </ol> <pre><code>movq $SYS_exit,  %rax   # exit(\nmovq $1,         %rdi   #   status=1\nsyscall                 # );\n</code></pre>"},{"location":"courses/os_lab/02-os_appview.html#_3","title":"\u6c47\u7f16\u4ee3\u7801\u7684\u72b6\u6001\u673a\u6a21\u578b","text":"<p>Everything is a state machine: \u8ba1\u7b97\u673a = \u6570\u5b57\u7535\u8def = \u72b6\u6001\u673a</p> <ul> <li>\u72b6\u6001 = \u5185\u5b58 M + \u5bc4\u5b58\u5668 R</li> <li>\u521d\u59cb\u72b6\u6001 = ABI \u89c4\u5b9a (\u4f8b\u5982\u6709\u4e00\u4e2a\u5408\u6cd5\u7684 %rsp)</li> <li>\u72b6\u6001\u8fc1\u79fb = \u6267\u884c\u4e00\u6761\u6307\u4ee4</li> <li>gdb \u540c\u6837\u53ef\u4ee5\u89c2\u5bdf\u72b6\u6001\u548c\u6267\u884c</li> </ul> <p>\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u7a0b\u5e8f</p> <ul> <li>\u6240\u6709\u7684\u6307\u4ee4\u90fd\u53ea\u80fd\u8ba1\u7b97</li> <li>deterministic: mov, add, sub, call, ...</li> <li>non-deterministic: rdrand, ...</li> <li>syscall \u628a (M,R) \u5b8c\u5168\u4ea4\u7ed9\u64cd\u4f5c\u7cfb\u7edf</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html#_4","title":"\u7406\u89e3\u9ad8\u7ea7\u8bed\u8a00\u7a0b\u5e8f","text":"<p>\u201c\u89e3\u91ca\u5668\u201d \u7684\u4f8b\u5b50\uff1a\u7528\u57fa\u7840\u7ed3\u6784\u6a21\u62df\u51fd\u6570\u8c03\u7528\u548c\u9012\u5f52\u3002</p>"},{"location":"courses/os_lab/02-os_appview.html#_5","title":"\u9012\u5f52\u8f6c\u975e\u9012\u5f52\u7684\u8f6c\u6362","text":"<p>\u6a21\u62df\u6808\u6267\u884c\uff0c\u5c06\u975e\u9012\u5f52\u8f6c\u4e3a\u9012\u5f52\u3002</p> <p>\u628a C \u8bed\u8a00\u6539\u5199\u6210\u4ec5\u5305\u542b\u987a\u5e8f\u6267\u884c\u7684\u7b80\u5355\u8bed\u53e5\u548c\u6761\u4ef6\u8df3\u8f6c <code>if (cond) goto</code> \u7684 \u201c\u7b80\u5316 C \u8bed\u8a00\u4ee3\u7801\u201d\u2014\u2014\u5faa\u73af\u3001\u5206\u652f\u548c\u51fd\u6570\u8c03\u7528\u90fd\u88ab\u6d88\u706d\u4e86\u3002</p> <ul> <li>\u8be6\u7ec6\u601d\u8def\uff0c\u53ef\u4ee5\u89c1\u914d\u5957\u5b9e\u9a8c\u4ee3\u7801\u4e2d\u7684\u6c49\u8bfa\u5854\u7b49\u7a0b\u5e8f\u793a\u4f8b</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html#c","title":"\u7b80\u5355 C \u7a0b\u5e8f\u7684\u72b6\u6001\u673a\u6a21\u578b (\u8bed\u4e49)","text":"<p>\u72b6\u6001</p> <ul> <li>Stack frame \u7684\u5217\u8868 + \u5168\u5c40\u53d8\u91cf</li> </ul> <p>\u521d\u59cb\u72b6\u6001</p> <ul> <li>\u4ec5\u6709\u4e00\u4e2a frame: <code>main(argc, argv)</code> \uff1b\u5168\u5c40\u53d8\u91cf\u4e3a\u521d\u59cb\u503c</li> </ul> <p>\u72b6\u6001\u8fc1\u79fb</p> <ul> <li>\u6267\u884c frames.top.PC \u5904\u7684\u7b80\u5355\u8bed\u53e5</li> <li>\u51fd\u6570\u8c03\u7528 = push frame (frame.PC = \u5165\u53e3)</li> <li>\u51fd\u6570\u8fd4\u56de = pop frame</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html#_6","title":"\u7406\u89e3\u7f16\u8bd1\u5668","text":"<p>\u6709\u4e24\u79cd\u72b6\u6001\u673a</p> <ul> <li>\u9ad8\u7ea7\u8bed\u8a00\u4ee3\u7801.c</li> <li>\u72b6\u6001\uff1a\u6808\u3001\u5168\u5c40\u53d8\u91cf\uff1b\u72b6\u6001\u8fc1\u79fb\uff1a\u8bed\u53e5\u6267\u884c</li> <li>\u6c47\u7f16\u6307\u4ee4\u5e8f\u5217.s</li> <li>\u72b6\u6001\uff1a(M,R*)\uff1b\u72b6\u6001\u8fc1\u79fb\uff1a\u6307\u4ee4\u6267\u884c</li> <li>\u7f16\u8bd1\u5668\u662f\u4e8c\u8005\u4e4b\u95f4\u7684\u6865\u6881\uff1a\\(.s=compile(.c)\\)</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html#_7","title":"\u7f16\u8bd1\u5668\u7684\u6b63\u786e\u6027","text":"<p>.c \u6267\u884c\u4e2d\u6240\u6709\u5916\u90e8\u89c2\u6d4b\u8005\u53ef\u89c1\u7684\u884c\u4e3a\uff0c\u5fc5\u987b\u5728 .s \u4e2d\u4fdd\u6301\u4e00\u81f4</p> <ul> <li>External function calls (\u94fe\u63a5\u65f6\u786e\u5b9a)</li> <li>\u5982\u4f55\u8c03\u7528\u7531 Application Binary Interface (ABI) \u89c4\u5b9a</li> <li>\u53ef\u80fd\u5305\u542b\u7cfb\u7edf\u8c03\u7528\uff0c\u56e0\u6b64\u4e0d\u53ef\u66f4\u6539\u3001\u4e0d\u53ef\u4ea4\u6362</li> <li>\u7f16\u8bd1\u5668\u63d0\u4f9b\u7684 \u201c\u4e0d\u53ef\u4f18\u5316\u201d \u6807\u6ce8</li> <li><code>volatile</code> [load | store | inline assembly]</li> <li>Termination</li> <li>.c \u7ec8\u6b62\u5f53\u4e14\u4ec5\u5f53 .s \u7ec8\u6b62</li> </ul> <p>\u5728\u6b64\u524d\u63d0\u4e0b\uff0c\u4efb\u4f55\u7ffb\u8bd1\u90fd\u662f\u5408\u6cd5\u7684 (\u4f8b\u5982\u6211\u4eec\u671f\u671b\u66f4\u5feb\u6216\u66f4\u77ed\u7684\u4ee3\u7801)</p> <ul> <li>\u7f16\u8bd1\u4f18\u5316\u7684\u5b9e\u9645\u5b9e\u73b0\uff1a(context-sensitive) rewriting rules</li> <li>\u4ee3\u7801\u793a\u4f8b\uff1a\u89c2\u6d4b\u7f16\u8bd1\u5668\u4f18\u5316\u884c\u4e3a\u548c compiler barrier</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html#_8","title":"\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u8f6f\u4ef6\uff08\u5e94\u7528\u7a0b\u5e8f\uff09","text":""},{"location":"courses/os_lab/02-os_appview.html#_9","title":"\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u4efb\u4f55\u7a0b\u5e8f","text":"<p>\u4efb\u4f55\u7a0b\u5e8f = minimal.S = \u8c03\u7528 syscall \u7684\u72b6\u6001\u673a</p> <p>\u53ef\u6267\u884c\u6587\u4ef6\u662f\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u5bf9\u8c61</p> <ul> <li>\u4e0e\u5927\u5bb6\u65e5\u5e38\u4f7f\u7528\u7684\u6587\u4ef6 (a.c, README.txt) \u6ca1\u6709\u672c\u8d28\u533a\u522b</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b API \u6253\u5f00\u3001\u8bfb\u53d6\u3001\u6539\u5199 (\u90fd\u9700\u8981\u76f8\u5e94\u7684\u6743\u9650)</li> </ul> <p>\u67e5\u770b\u53ef\u6267\u884c\u6587\u4ef6\uff1a<code>vim,cat,xxd</code>\u90fd\u53ef\u4ee5\u76f4\u63a5 \u201c\u67e5\u770b\u201d \u53ef\u6267\u884c\u6587\u4ef6</p> <ul> <li><code>vim</code> \u4e2d\u4e8c\u8fdb\u5236\u7684\u90e8\u5206\u65e0\u6cd5 \u201c\u9605\u8bfb\u201d\uff0c\u4f46\u53ef\u4ee5\u770b\u5230\u5b57\u7b26\u4e32\u5e38\u91cf</li> <li>\u4f7f\u7528 <code>xxd</code> \u53ef\u4ee5\u770b\u5230\u6587\u4ef6\u4ee5 <code>\"\\x7f\" \"ELF\"</code> \u5f00\u5934</li> <li>Vscode \u6709 binary editor \u63d2\u4ef6</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html#_10","title":"\u7cfb\u7edf\u4e2d\u5e38\u89c1\u7684\u5e94\u7528\u7a0b\u5e8f","text":"<p>Core Utilities (coreutils)</p> <ul> <li>Standard programs for text and file manipulation</li> <li>\u7cfb\u7edf\u4e2d\u5b89\u88c5\u7684\u662f  GNU Coreutils</li> <li>\u6709\u8f83\u5c0f\u7684\u66ff\u4ee3\u54c1 busybox</li> <li>\u5e95\u5c42\u7cfb\u7edf\u5b9e\u73b0\uff08\u901a\u8fc7\u9605\u8bfb busybox \u7684\u65e9\u671f\u7248\u672c\u7684\u6e90\u4ee3\u7801\uff09</li> </ul> <p>\u7cfb\u7edf/\u5de5\u5177\u7a0b\u5e8f</p> <ul> <li>bash,binutils, apt, ip, ssh, vim, tmux, jdk, python, ...</li> <li>\u8fd9\u4e9b\u5de5\u5177\u7684\u539f\u7406\u4e0d\u590d\u6742 (\u4f8b\u5982 apt \u662f dpkg \u7684\u5957\u58f3)\uff0c\u4f46\u7410\u788e</li> <li>Ubuntu Packages (\u548c apt-file \u5de5\u5177) \u652f\u6301\u6587\u4ef6\u540d\u68c0\u7d22</li> </ul> <p>\u5176\u4ed6\u5404\u79cd\u5e94\u7528\u7a0b\u5e8f</p> <ul> <li>Vscode, \u6d4f\u89c8\u5668\u3001\u97f3\u4e50\u64ad\u653e\u5668\u2026\u2026</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html#trace","title":"\u6253\u5f00\u7a0b\u5e8f\u7684\u6267\u884c\uff1aTrace (\u8ffd\u8e2a)","text":"<p><code>strace</code>\uff1aSystem call trace\uff0c\u53ef\u4ee5\u89c2\u6d4b\u72b6\u6001\u673a\u7684\u6267\u884c\u8fc7\u7a0b</p> <ul> <li>\u7406\u89e3 strace \u7684\u8f93\u51fa\u5e76\u5728\u4f60\u81ea\u5df1\u7684\u64cd\u4f5c\u7cfb\u7edf\u91cc\u5b9e\u73b0\u76f8\u5f53\u4e00\u90e8\u5206\u7cfb\u7edf\u8c03\u7528 (mmap, execve, ...)</li> <li>Demo: \u8bd5\u4e00\u8bd5\u6700\u5c0f\u7684 Hello World\uff08<code>strace -f gcc hello.c</code>\uff09</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html#_11","title":"\u64cd\u4f5c\u7cfb\u7edf\u4e2d \u201c\u4efb\u4f55\u7a0b\u5e8f\u201d \u7684\u4e00\u751f","text":"<p>\u4efb\u4f55\u7a0b\u5e8f = minimal.S = \u8c03\u7528 syscall \u7684\u72b6\u6001\u673a</p> <ul> <li>\u88ab\u64cd\u4f5c\u7cfb\u7edf\u52a0\u8f7d</li> <li>\u901a\u8fc7\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u6267\u884c execve \u8bbe\u7f6e\u4e3a\u521d\u59cb\u72b6\u6001</li> <li>\u72b6\u6001\u673a\u6267\u884c</li> <li>\u8fdb\u7a0b\u7ba1\u7406\uff1afork, execve, exit, ...</li> <li>\u6587\u4ef6/\u8bbe\u5907\u7ba1\u7406\uff1aopen, close, read, write, ...</li> <li>\u5b58\u50a8\u7ba1\u7406\uff1ammap, brk, ...</li> <li>\u8c03\u7528 _exit (exit_group) \u9000\u51fa</li> </ul> <p>(\u521d\u5b66\u8005\u5bf9\u8fd9\u4e00\u70b9\u4f1a\u611f\u5230\u6709\u4e00\u70b9\u60ca\u8bb6)</p> <ul> <li>\u8bf4\u597d\u7684\u6d4f\u89c8\u5668\u3001\u6e38\u620f\u3001\u6740\u6bd2\u8f6f\u4ef6\u3001\u75c5\u6bd2\u5462\uff1f\u90fd\u662f\u8fd9\u4e9b API \u5417\uff1f</li> <li>\u6211\u4eec\u6709 strace\uff0c\u5c31\u53ef\u4ee5\u81ea\u5df1\u505a\u5b9e\u9a8c\u4e86\uff01</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html#_12","title":"\u52a8\u624b\u5b9e\u9a8c\uff1a\u89c2\u5bdf\u7a0b\u5e8f\u7684\u6267\u884c","text":"<p>\u5de5\u5177\u7a0b\u5e8f\u4ee3\u8868\uff1a\u7f16\u8bd1\u5668 (gcc)</p> <ul> <li>\u4e3b\u8981\u7684\u7cfb\u7edf\u8c03\u7528\uff1a<code>execve, read, write</code></li> <li><code>strace -f gcc a.c</code>(gcc \u4f1a\u542f\u52a8\u5176\u4ed6\u8fdb\u7a0b)</li> <li>\u53ef\u4ee5\u7ba1\u9053\u7ed9\u7f16\u8f91\u5668 <code>vim -</code></li> <li>\u7f16\u8f91\u5668\u91cc\u8fd8\u53ef\u4ee5 <code>%!grep</code> (\u7ec6\u8282/\u6280\u5de7)</li> </ul> <p>\u56fe\u5f62\u754c\u9762\u7a0b\u5e8f\u4ee3\u8868\uff1a\u7f16\u8f91\u5668 (xedit)</p> <ul> <li>\u4e3b\u8981\u7684\u7cfb\u7edf\u8c03\u7528\uff1a<code>poll, recvmsg, writev</code></li> <li><code>strace xedit</code></li> <li>\u56fe\u5f62\u754c\u9762\u7a0b\u5e8f\u548c X-Window \u670d\u52a1\u5668\u6309\u7167 X11 \u534f\u8bae\u901a\u4fe1</li> <li>\u865a\u62df\u673a\u4e2d\u7684 xedit \u5c06 X11 \u547d\u4ee4\u901a\u8fc7 ssh (X11 forwarding) \u8f6c\u53d1\u5230 Host</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html#_13","title":"\u5404\u5f0f\u5404\u6837\u7684\u5e94\u7528\u7a0b\u5e8f","text":"<p>\u90fd\u5728\u64cd\u4f5c\u7cfb\u7edf API (syscall) .\u548c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u5bf9\u8c61\u4e0a\u6784\u5efa</p> <ul> <li>\u7a97\u53e3\u7ba1\u7406\u5668</li> <li>\u7ba1\u7406\u8bbe\u5907\u548c\u5c4f\u5e55 (read/write/mmap)</li> <li> <p>\u8fdb\u7a0b\u95f4\u901a\u4fe1 (send, recv)</p> </li> <li> <p>\u4efb\u52a1\u7ba1\u7406\u5668</p> </li> <li>\u8bbf\u95ee\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u8fdb\u7a0b\u5bf9\u8c61 (readdir/read)</li> <li> <p>\u53c2\u8003 gdb \u91cc\u7684 <code>info proc *</code></p> </li> <li> <p>\u6740\u6bd2\u8f6f\u4ef6</p> </li> <li>\u6587\u4ef6\u9759\u6001\u626b\u63cf (read)</li> <li>\u4e3b\u52a8\u9632\u5fa1 (ptrace)</li> <li>\u5176\u4ed6\u66f4\u590d\u6742\u7684\u5b89\u5168\u673a\u5236\u2026\u2026</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html#_14","title":"\u603b\u7ed3","text":"<p>\u65e0\u8bba\u662f\u6c47\u7f16\u4ee3\u7801\u8fd8\u662f\u9ad8\u7ea7\u8bed\u8a00\u7a0b\u5e8f\uff0c\u5b83\u4eec\u90fd\u53ef\u4ee5\u8868\u793a\u6210\u72b6\u6001\u673a\uff1a</p> <ul> <li>\u9ad8\u7ea7\u8bed\u8a00\u4ee3\u7801 .c</li> <li>\u72b6\u6001\uff1a\u6808\u3001\u5168\u5c40\u53d8\u91cf\uff1b\u72b6\u6001\u8fc1\u79fb\uff1a\u8bed\u53e5\u6267\u884c</li> <li>\u6c47\u7f16\u6307\u4ee4\u5e8f\u5217 .s</li> <li>\u72b6\u6001\uff1a\\((M,R)\\)\uff1b\u72b6\u6001\u8fc1\u79fb\uff1a\u6307\u4ee4\u6267\u884c</li> <li>\u7f16\u8bd1\u5668\u5b9e\u73b0\u4e86\u4e24\u79cd\u72b6\u6001\u673a\u4e4b\u95f4\u7684\u7ffb\u8bd1</li> </ul> <p>\u5e94\u7528\u7a0b\u5e8f\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u6c9f\u901a\u7684\u552f\u4e00\u6865\u6881\u662f\u7cfb\u7edf\u8c03\u7528\u6307\u4ee4 (\u4f8b\u5982 x86-64 \u7684 syscall)\u3002</p> <ul> <li>\u7406\u89e3\u64cd\u4f5c\u7cfb\u7edf\u7684\u91cd\u8981\u5de5\u5177\uff1agcc, binutils, gdb, strace</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html#_15","title":"\u8bfe\u540e\u4e60\u9898/\u7f16\u7a0b\u4f5c\u4e1a","text":""},{"location":"courses/os_lab/02-os_appview.html#1","title":"1. \u9605\u8bfb\u6750\u6599","text":"<ul> <li>\u6d4f\u89c8 GNU Coreutils \u548c GNU Binutils \u7684\u7f51\u7ad9\uff0c\u5efa\u7acb \u201c\u624b\u8fb9\u6709\u54ea\u4e9b\u53ef\u7528\u7684\u547d\u4ee4\u884c\u5de5\u5177\u201d \u7684\u4e00\u4e9b\u5370\u8c61\u3002</li> <li>\u6d4f\u89c8 gdb \u6587\u6863\u7684\u76ee\u5f55\uff0c\u627e\u5230\u4f60\u611f\u5174\u8da3\u7684\u7ae0\u8282\u4e86\u89e3\uff0c\u4f8b\u5982\u2014\u2014\u201cReverse Execution\u201d\u3001\u201cTUI: GDB Text User Interface\u201d\u2026\u2026</li> <li>\u5bf9\u4e8e\u4f60\u6709\u5174\u8da3\u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u53ef\u4ee5\u53c2\u8003 busybox \u548c toybox \u9879\u76ee\u4e2d\u4e0e\u4e4b\u5bf9\u5e94\u7684\u7b80\u5316\u5b9e\u73b0\u3002Toybox \u73b0\u5728\u5df2\u7ecf\u6210\u4e3a\u4e86 Android \u81ea\u5e26\u7684\u547d\u4ee4\u884c\u5de5\u5177\u96c6\u3002</li> </ul>"},{"location":"courses/os_lab/02-os_appview.html#2","title":"2. \u7f16\u7a0b\u5b9e\u8df5","text":"<p>\u5728\u4f60\u7684 Linux \u4e2d\u8fd0\u884c\u8bfe\u5802\u4e0a\u7684\u4ee3\u7801\u793a\u4f8b\uff0c\u5305\u62ec\uff1a</p> <ul> <li>\u7f16\u8bd1\u94fe\u63a5\u6700\u5c0f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528 strace \u67e5\u770b\u6267\u884c\u7684\u7cfb\u7edf\u8c03\u7528\u5e8f\u5217\u3002</li> <li>\u6c47\u7f16\u5199\u7684minimal \u5176\u7cfb\u7edf\u8c03\u7528\u5f88\u5c11\uff08execve, write, exit\uff09\uff1b</li> <li>\u5c1d\u8bd5\u5c06\u975e\u9012\u5f52\u6c49\u8bfa\u5854\u6269\u5c55\u5230 f \u548c g \u4e24\u4e2a\u51fd\u6570\u4e92\u76f8\u8c03\u7528\u7684\u60c5\u51b5\u3002</li> <li>\u4f7f\u7528 strace \u67e5\u770b\u66f4\u591a\u7a0b\u5e8f\u7684\u7cfb\u7edf\u8c03\u7528\u5e8f\u5217\uff0c\u5e76\u5728\u597d\u5947\u5fc3\u7684\u9a71\u4f7f\u4e0b\u4e86\u89e3\u4e00\u90e8\u5206\u7cfb\u7edf\u8c03\u7528\u7684\u4f5c\u7528\u3002\u53ef\u4ee5\u501f\u52a9\u4e92\u8054\u7f51\u3001Stackoverflow \u6216\u662f ChatGPT (\u4f46\u5728\u4f7f\u7528\u65f6\uff0c\u8981\u5c0f\u5fc3\u6c42\u8bc1\u7ed3\u679c)\u3002</li> </ul>"},{"location":"courses/os_lab/03-os_hardware_view.html","title":"\u786c\u4ef6\u89c6\u89d2\u7684\u64cd\u4f5c\u7cfb\u7edf","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u6709\u4e09\u6761\u4e3b\u7ebf\uff1a\u201c\u8f6f\u4ef6 (\u5e94\u7528)\u201d\u3001\u201c\u786c\u4ef6 (\u8ba1\u7b97\u673a)\u201d\u3001\u201c\u64cd\u4f5c\u7cfb\u7edf (\u8f6f\u4ef6\u76f4\u63a5\u8bbf\u95ee\u786c\u4ef6\u5e26\u6765\u9ebb\u70e6\u592a\u591a\u800c\u5f15\u5165\u7684\u4e2d\u95f4\u4ef6)\u201d\u3002\u7b2c\u4e8c\u7ae0\u8bb2\u89e3\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u672c\u8d28 (\u72b6\u6001\u673a)\u3002\u800c\u7a0b\u5e8f\u6700\u7ec8\u662f\u8fd0\u884c\u5728\u8ba1\u7b97\u673a\u786c\u4ef6\u4e0a\u7684\uff0c\u672c\u7ae0\u8bb2\u89e3\u4ec0\u4e48\u662f\u8ba1\u7b97\u673a\u786c\u4ef6\uff0c\u4ee5\u53ca\u5982\u4f55\u4e3a\u8ba1\u7b97\u673a\u786c\u4ef6\u7f16\u7a0b\u3002</p> <p>\u672c\u8bb2\u5185\u5bb9\uff1a\u8ba1\u7b97\u673a\u786c\u4ef6\u7684\u72b6\u6001\u673a\u6a21\u578b\uff1b\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898\uff1a</p> <ul> <li>\u4ec0\u4e48\u662f\u8ba1\u7b97\u673a\u786c\u4ef6\uff1f</li> <li>\u8ba1\u7b97\u673a\u786c\u4ef6\u548c\u7a0b\u5e8f\u5458\u4e4b\u95f4\u662f\u5982\u4f55\u7ea6\u5b9a\u7684\uff1f</li> <li>\u542c\u8bf4\u64cd\u4f5c\u7cfb\u7edf\u4e5f\u662f\u7a0b\u5e8f\u3002\u90a3\u5230\u5e95\u662f\u9e21\u751f\u86cb\u8fd8\u662f\u86cb\u751f\u9e21\uff1f</li> </ul>"},{"location":"courses/os_lab/03-os_hardware_view.html#_2","title":"\u56de\u987e\uff1a\u8ba1\u7b97\u673a\u786c\u4ef6","text":""},{"location":"courses/os_lab/03-os_hardware_view.html#_3","title":"\u8ba1\u7b97\u673a\u786c\u4ef6 = \u6570\u5b57\u7535\u8def","text":"<p>\u8ba1\u7b97\u673a\u786c\u4ef6 = \u6570\u5b57\u7535\u8def\uff0c\u6570\u5b57\u7535\u8def\u6a21\u62df\u5668 (<code>Logisim</code>\u4ee3\u7801\u6a21\u62df\u8f93\u51fa<code>0,1,2</code>)\uff0c\u5b9e\u73b0\u601d\u8def\uff1a</p> <ul> <li>\u57fa\u672c\u6784\u4ef6\uff1a<code>wire, reg, NAND</code></li> <li>\u6bcf\u4e00\u4e2a\u65f6\u949f\u5468\u671f</li> <li>\u5148\u8ba1\u7b97 wire \u7684\u503c</li> <li>\u5728\u5468\u671f\u7ed3\u675f\u65f6\u628a\u503c\u9501\u5b58\u81f3 reg</li> </ul> <p>\u201c\u6a21\u62df\u201d \u7684\u610f\u4e49</p> <ul> <li>\u7a0b\u5e8f\u662f \u201c\u4e25\u683c\u7684\u6570\u5b66\u5bf9\u8c61\u201d</li> <li>\u5b9e\u73b0\u6a21\u62df\u5668\u610f\u5473\u7740 \u201c\u5b8c\u5168\u638c\u63e1\u7cfb\u7edf\u884c\u4e3a\u201d</li> </ul>"},{"location":"courses/os_lab/03-os_hardware_view.html#_4","title":"\u8ba1\u7b97\u673a\u786c\u4ef6\u7684\u72b6\u6001\u673a\u6a21\u578b","text":"<p>\u4e0d\u4ec5\u662f\u7a0b\u5e8f\uff0c\u6574\u4e2a\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e5f\u662f\u4e00\u4e2a\u72b6\u6001\u673a</p> <ul> <li>\u72b6\u6001\uff1a\u5185\u5b58\u548c\u5bc4\u5b58\u5668\u6570\u503c</li> <li>\u521d\u59cb\u72b6\u6001\uff1a\u624b\u518c\u89c4\u5b9a (CPU Reset)</li> <li>\u72b6\u6001\u8fc1\u79fb</li> <li>\u4efb\u610f\u9009\u62e9\u4e00\u4e2a\u5904\u7406\u5668 cpu</li> <li>\u54cd\u5e94\u5904\u7406\u5668\u5916\u90e8\u4e2d\u65ad</li> <li>\u4ece <code>cpu.PC</code> \u53d6\u6307\u4ee4\u6267\u884c</li> </ul> <p>\u5230\u5e95\u8c01\u5b9a\u4e49\u4e86\u72b6\u6001\u673a\u7684\u884c\u4e3a\uff1f</p> <ul> <li>\u6211\u4eec\u5982\u4f55\u63a7\u5236 \u201c\u4ec0\u4e48\u7a0b\u5e8f\u8fd0\u884c\u201d\uff1f</li> </ul>"},{"location":"courses/os_lab/03-os_hardware_view.html#_5","title":"\u786c\u4ef6\u4e0e\u7a0b\u5e8f\u5458\u7684\u7ea6\u5b9a","text":""},{"location":"courses/os_lab/03-os_hardware_view.html#bare-metal","title":"Bare-metal \u4e0e\u7a0b\u5e8f\u5458\u7684\u7ea6\u5b9a","text":"<p>Bare-metal \u4e0e\u5382\u5546\u7684\u7ea6\u5b9a\uff1a</p> <ul> <li>CPU Reset \u540e\u7684\u72b6\u6001 (\u5373\u5bc4\u5b58\u5668\u503c\uff0c\u5305\u62ec PC)</li> <li>\u5382\u5546\u81ea\u7531\u5904\u7406\u8fd9\u4e2a\u5730\u5740\u4e0a\u7684\u503c\uff08\u5728 PC \u7684\u4f4d\u7f6e\uff0c\u5199\u5165\u4ee3\u7801\uff0cCPU\u53d6\u6307\u4ee4\u8bd1\u7801\u6267\u884c\uff09</li> <li>Memory-mapped I/O</li> </ul> <p>\u5382\u5546\uff08\u4e3b\u677f/CPU\uff09 \u4e3a\u64cd\u4f5c\u7cfb\u7edf\u5f00\u53d1\u8005\u63d0\u4f9b Firmware\uff08\u9a71\u52a8\u548c\u56fa\u4ef6\uff09</p> <ul> <li>\u7ba1\u7406\u786c\u4ef6\u548c\u7cfb\u7edf\u914d\u7f6e</li> <li>\u628a\u5b58\u50a8\u8bbe\u5907\u4e0a\u7684\u4ee3\u7801\u52a0\u8f7d\u5230\u5185\u5b58\uff0c\u5e76\u4e14\u8df3\u8f6c\u5230\u5b83\u7684\u67d0\u4e2a\u5730\u5740\u5f00\u59cb\u6267\u884c\u3002</li> <li>\u4f8b\u5982\u5b58\u50a8\u4ecb\u8d28\u4e0a\u7684\u7b2c\u4e8c\u7ea7 loader (\u52a0\u8f7d\u5668)</li> <li>\u6216\u8005\u76f4\u63a5\u52a0\u8f7d\u64cd\u4f5c\u7cfb\u7edf (\u5d4c\u5165\u5f0f\u7cfb\u7edf)</li> </ul>"},{"location":"courses/os_lab/03-os_hardware_view.html#x86-family-cpu-reset","title":"x86 Family: CPU Reset","text":"<ul> <li>Intel\u00ae 64 and IA-32 Architectures Software Developer\u2019s Manual, Volume 3A/3B \u7684\u89c4\u5b9a</li> </ul> <p>\u5bc4\u5b58\u5668\u4f1a\u6709\u786e\u5b9a\u7684\u521d\u59cb\u72b6\u6001</p> <ul> <li><code>EIP = 0x0000fff0</code></li> <li><code>CR0 = 0x60000010</code></li> <li>\u5904\u7406\u5668\u5904\u4e8e 16-bit \u6a21\u5f0f</li> <li><code>EFLAGS = 0x00000002</code></li> <li>Interrupt disabled</li> </ul> <p>TFM (5,000 \u9875+)</p> <ul> <li>\u6700\u9700\u8981\u7684 Volume 3A \u53ea\u6709 ~400 \u9875 (\u6211\u4eec\u66f4\u9700\u8981 AI)</li> </ul>"},{"location":"courses/os_lab/03-os_hardware_view.html#cpu-reset","title":"\u5176\u4ed6\u5e73\u53f0\u4e0a\u7684 CPU Reset","text":"<p>Reset \u540e\u5904\u7406\u5668\u90fd\u4ece\u56fa\u5b9a\u5730\u5740 (Reset Vector) \u542f\u52a8</p> <ul> <li>MIPS: 0xbfc00000</li> <li>Specification \u89c4\u5b9a</li> <li>ARM: 0x00000000</li> <li>Specification \u89c4\u5b9a</li> <li>\u5141\u8bb8\u914d\u7f6e Reset Vector Base Address Register</li> <li>RISC-V: Implementation defined</li> <li>\u7ed9\u5382\u5546\u6700\u5927\u7a0b\u5ea6\u7684\u81ea\u7531</li> </ul> <p>Firmware \u8d1f\u8d23\u52a0\u8f7d\u64cd\u4f5c\u7cfb\u7edf</p> <ul> <li>\u5f00\u53d1\u677f\uff08\u7269\u7406\uff09\uff1a\u76f4\u63a5\u628a\u52a0\u8f7d\u5668\u5199\u5165 ROM</li> <li>QEMU\uff08\u6a21\u62df\uff09\uff1a<code>-kernel</code> \u53ef\u4ee5\u7ed5\u8fc7 Firmware \u76f4\u63a5\u52a0\u8f7d\u5185\u6838 (RTFM)</li> </ul>"},{"location":"courses/os_lab/03-os_hardware_view.html#x86-cpu-reset","title":"x86 CPU Reset \u4e4b\u540e\uff1a\u5230\u5e95\u6267\u884c\u4e86\u4ec0\u4e48\uff1f","text":"<p>\u72b6\u6001\u673a (\u521d\u59cb\u72b6\u6001) \u5f00\u59cb\u6267\u884c</p> <ul> <li>\u4ece PC \u53d6\u6307\u4ee4\u3001\u8bd1\u7801\u3001\u6267\u884c\u2026\u2026</li> <li>\u5f00\u59cb\u6267\u884c\u5382\u5546 \u201c\u5b89\u6392\u597d\u201d \u7684 Firmware \u4ee3\u7801</li> <li>x86 Reset Vector \u662f\u4e00\u6761\u5411 Firmware \u8df3\u8f6c\u7684 jmp \u6307\u4ee4</li> </ul> <p>Firmware\u7684\u5206\u7c7b\uff1aBIOS vs. UEFI</p> <ul> <li>\u4e00\u4e2a\u5c0f \u201c\u64cd\u4f5c\u7cfb\u7edf\u201d</li> <li>\u7ba1\u7406\u3001\u914d\u7f6e\u786c\u4ef6\uff1b\u52a0\u8f7d\u64cd\u4f5c\u7cfb\u7edf</li> <li>Legacy BIOS (Basic I/O System)</li> <li>IBM PC \u6240\u6709\u8bbe\u5907/BIOS \u4e2d\u65ad\u662f\u6709 specification \u7684 (\u6210\u5c31\u4e86 \u201c\u517c\u5bb9\u673a\u201d)</li> </ul> <p> - UEFI(Unified Extensible Firmware Interface)</p>"},{"location":"courses/os_lab/03-os_hardware_view.html#uefi","title":"\u4e3a\u4ec0\u4e48\u9700\u8981 UEFI\uff1f","text":"<p>\u5e94\u5bf9\u8d8a\u6765\u8d8a\u591a\u7684\u786c\u4ef6\uff08\u6307\u7eb9\u9501\u3001USB \u8f6c\u63a5\u5668\u4e0a\u7684 Linux-to-Go \u4f18\u76d8\u3001\u5c71\u5be8\u7f51\u5361\u4e0a\u7684 PXE \u7f51\u7edc\u542f\u52a8\u3001USB \u84dd\u7259\u8f6c\u63a5\u5668\u8fde\u63a5\u7684\u84dd\u7259\u952e\u76d8\uff09</p> <ul> <li>\u5404\u79cd\u9a71\u52a8\u7a0b\u5e8f\uff1a\u8bbe\u5907\u90fd\u9700\u8981 \u201c\u9a71\u52a8\u7a0b\u5e8f\u201d \u624d\u80fd\u8bbf\u95ee\uff1b</li> <li>\u89e3\u51b3BIOS\u9010\u6e10\u788e\u7247\u5316\u7684\u95ee\u9898\uff1b</li> </ul> <p></p>"},{"location":"courses/os_lab/03-os_hardware_view.html#legacy-bios","title":"\u56de\u5230 Legacy BIOS: \u7ea6\u5b9a","text":"<p>Legacy BIOS\u7684\u7ea6\u5b9a\uff0c\u63d0\u4f9b\u673a\u5236\uff0c\u5c06\u7a0b\u5e8f\u5458\u7684\u4ee3\u7801\u8f7d\u5165\u5185\u5b58</p> <ul> <li> <p>Legacy BIOS \u628a\u7b2c\u4e00\u4e2a\u53ef\u5f15\u5bfc\u8bbe\u5907\uff08A\u76d8\u3001B\u76d8\u3001C\u76d8\u7b49\uff09\u7684\u7b2c\u4e00\u4e2a 512 \u5b57\u8282\u52a0\u8f7d\u5230\u7269\u7406\u5185\u5b58\u7684 <code>7c00</code> \u4f4d\u7f6e</p> </li> <li> <p>\u6b64\u65f6\u5904\u7406\u5668\u5904\u4e8e 16-bit \u6a21\u5f0f</p> </li> <li> <p>\u89c4\u5b9a <code>CS:IP = 0x7c00</code>, <code>(R[CS] &lt;&lt; 4) | R[IP] == 0x7c00</code></p> <ul> <li> <p>\u53ef\u80fd\u60271\uff1a<code>CS = 0x07c0, IP = 0</code></p> </li> <li> <p>\u53ef\u80fd\u60272\uff1a<code>CS = 0, IP = 0x7c00</code></p> </li> </ul> </li> <li> <p>\u5176\u4ed6\u6ca1\u6709\u4efb\u4f55\u7ea6\u675f</p> </li> </ul> <p>MBR(master boot record) \u7684 512\u5b57\u8282\uff0c\u867d\u7136\u6700\u591a\u53ea\u6709 446 \u5b57\u8282\u4ee3\u7801 (64B \u5206\u533a\u8868 + 2B \u6807\u8bc6\uff080x55 0xAA\uff09)</p> <ul> <li>\u4f46\u63a7\u5236\u6743\u5df2\u7ecf\u56de\u5230\u7a0b\u5e8f\u5458\u624b\u4e2d\u4e86\uff01\u4f60\u751a\u81f3\u53ef\u4ee5\u8ba9 ChatGPT \u7ed9\u4f60\u5199\u4e00\u4e2a Hello World</li> </ul>"},{"location":"courses/os_lab/03-os_hardware_view.html#_6","title":"\u80fd\u4e0d\u80fd\u770b\u4e00\u4e0b\u4ee3\u7801\uff1f","text":"<p>\u6709\u6ca1\u6709\u53ef\u80fd\u6211\u4eec\u771f\u7684\u53bb\u770b\u4ece CPU Reset \u4ee5\u540e\u6bcf\u4e00\u6761\u6307\u4ee4\u7684\u6267\u884c\uff1f</p> <p>\u8bfe\u5802\u4ee3\u7801\uff1a\u5199\u4e00\u6bb5 BIOS \u7a0b\u5e8f\uff0c\u6253\u5370\u5b57\u7b26\u4e32\uff0cqemu \u8fd0\u884c\u5b83\u5e76\u901a\u8fc7 gdb \u8c03\u8bd5</p> <ul> <li>MBR \u662f\u7531 Firmware \u52a0\u8f7d\uff1a\u68c0\u67e5 CPU Reset \u65f6\u6574\u4e2a\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684\u72b6\u6001\uff0c\u53d1\u73b0 0x7c00 \u4f4d\u7f6e\u5e76\u6ca1\u6709\u51fa\u73b0 MBR \u7684\u5185\u5bb9\uff1b</li> </ul> <p>\u8ba1\u7b97\u673a\u7cfb\u7edf\u516c\u7406\uff1a\u4f60\u60f3\u5230\u7684\u5c31\u4e00\u5b9a\u6709\u4eba\u505a\u5230</p> <ul> <li>\u6a21\u62df\u65b9\u6848\uff1aQEMU</li> <li>\u4f20\u5947\u9ed1\u5ba2\u3001\u5929\u624d\u7a0b\u5e8f\u5458 Fabrice Bellard \u7684\u6770\u4f5c<ul> <li>QEMU, A fast and portable dynamic translator (USENIX ATC'05)</li> <li>Android Virtual Device, VirtualBox, ... \u80cc\u540e\u90fd\u662f QEMU</li> </ul> </li> <li>\u771f\u673a\u65b9\u6848\uff1aJTAG (Joint Test Action Group) debugger</li> <li>\u4e00\u7cfb\u5217 (\u7269\u7406) \u8c03\u8bd5\u5bc4\u5b58\u5668\uff0c\u53ef\u4ee5\u5b9e\u73b0 gdb \u63a5\u53e3 (!!!) </li> </ul>"},{"location":"courses/os_lab/03-os_hardware_view.html#hacking-firmware-1998","title":"\u5c0f\u63d2\u66f2\uff1aHacking Firmware (1998)","text":"<p>Firmware \u901a\u5e38\u662f\u53ea\u8bfb\u7684 (\u5f53\u7136\u2026\u2026)</p> <ul> <li>Intel 430TX (Pentium) \u82af\u7247\u7ec4\u5141\u8bb8\u5199\u5165 Flash ROM</li> <li>\u53ea\u8981\u5411 Flash BIOS \u5199\u5165\u7279\u5b9a\u5e8f\u5217\uff0cFlash ROM \u5c31\u53d8\u4e3a\u53ef\u5199<ul> <li>\u7559\u7ed9 Firmware \u66f4\u65b0\u7684\u901a\u9053</li> </ul> </li> <li>\u8981\u5f97\u5230\u8fd9\u4e2a\u5e8f\u5217\u5176\u5b9e\u5e76\u4e0d\u56f0\u96be<ul> <li>\u4f3c\u4e4e\u6587\u6863\u91cc\u5c31\u6709 \ud83e\udd14 Boom\u2026\u2026</li> </ul> </li> </ul> <p>CIH \u75c5\u6bd2\u7684\u4f5c\u8005\u9648\u76c8\u8c6a\u88ab\u902e\u6355\uff0c\u4f46\u5e76\u672a\u88ab\u5b9a\u7f6a</p> <p></p>"},{"location":"courses/os_lab/03-os_hardware_view.html#uefi_1","title":"UEFI \u4e0a\u7684\u64cd\u4f5c\u7cfb\u7edf\u52a0\u8f7d","text":"<p>\u6807\u51c6\u5316\u7684\u52a0\u8f7d\u6d41\u7a0b</p> <ul> <li>\u78c1\u76d8\u5fc5\u987b\u6309 <code>GPT (GUID Partition Table)</code> \u65b9\u5f0f\u683c\u5f0f\u5316</li> <li>\u9884\u7559\u4e00\u4e2a FAT32 \u5206\u533a (<code>lsblk/fdisk</code> \u53ef\u4ee5\u770b\u5230)</li> <li>Firmware \u80fd\u591f\u52a0\u8f7d\u4efb\u610f\u5927\u5c0f\u7684 PE \u53ef\u6267\u884c\u6587\u4ef6 <code>.efi</code></li> <li>\u6ca1\u6709 legacy boot 512 \u5b57\u8282\u9650\u5236</li> <li>EFI \u5e94\u7528\u53ef\u4ee5\u8fd4\u56de firmware</li> </ul> <p>\u66f4\u597d\u7684\u7a0b\u5e8f\u652f\u6301</p> <ul> <li>\u8bbe\u5907\u9a71\u52a8\u6846\u67b6</li> <li>\u66f4\u591a\u7684\u529f\u80fd\uff0c\u4f8b\u5982 Secure Boot\uff0c\u53ea\u80fd\u542f\u52a8 \u201c\u4fe1\u4efb\u201d \u7684\u64cd\u4f5c\u7cfb\u7edf</li> </ul>"},{"location":"courses/os_lab/03-os_hardware_view.html#_7","title":"\u5b9e\u73b0\u6700\u5c0f\u64cd\u4f5c\u7cfb\u7edf","text":""},{"location":"courses/os_lab/03-os_hardware_view.html#_8","title":"\u6211\u4eec\u5df2\u7ecf\u83b7\u5f97\u7684\u80fd\u529b","text":"<p>\u4e3a\u786c\u4ef6\u76f4\u63a5\u7f16\u7a0b</p> <ul> <li>\u53ef\u4ee5\u8ba9\u673a\u5668\u8fd0\u884c\u4efb\u610f\u4e0d\u8d85\u8fc7 510 \u5b57\u8282\u7684\u6307\u4ee4\u5e8f\u5217</li> <li>\u7f16\u5199\u4efb\u4f55\u6307\u4ee4\u5e8f\u5217 (\u72b6\u6001\u673a)</li> <li>\u53ea\u8981\u80fd\u95ee\u51fa\u95ee\u9898\uff0c\u5c31\u53ef\u4ee5 RTFM/STFW/ChatGPT \u627e\u5230\u7b54\u6848<ul> <li>\u201c\u5982\u4f55\u5728\u6c47\u7f16\u91cc\u751f\u6210 n \u4e2a\u5b57\u8282\u7684 0\u201d</li> <li>\u201c\u5982\u4f55\u5728 x86 16-bit mode \u6253\u5370\u5b57\u7b26\u201d</li> </ul> </li> </ul> <p>\u64cd\u4f5c\u7cfb\u7edf\uff1a\u5c31\u4e00\u4e2a C \u7a0b\u5e8f</p> <ul> <li>\u7528 510 \u5b57\u8282\u7684\u6307\u4ee4\u5b8c\u6210\u78c1\u76d8 \u2192 \u5185\u5b58\u7684\u52a0\u8f7d</li> <li>\u521d\u59cb\u5316 C \u7a0b\u5e8f\u7684\u6267\u884c\u73af\u5883</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u5c31\u5f00\u59cb\u8fd0\u884c\u4e86\uff01</li> </ul>"},{"location":"courses/os_lab/03-os_hardware_view.html#bare-metal-c","title":"Bare-metal \u4e0a\u7684 C \u4ee3\u7801","text":"<p>\u4e3a\u4e86\u8ba9\u4e0b\u5217\u7a0b\u5e8f\u80fd\u591f \u201c\u8fd0\u884c\u8d77\u6765\u201d\uff1a</p> <pre><code>int main() {\n  printf(\"Hello, World\\n\");\n}\n</code></pre> <p>\u9700\u8981\u51c6\u5907</p> <ul> <li>MBR \u4e0a\u7684 \u201c\u542f\u52a8\u52a0\u8f7d\u5668\u201d (Boot Loader)</li> <li>\u901a\u8fc7\u7f16\u8bd1\u5668\u63a7\u5236 C \u7a0b\u5e8f\u7684\u884c\u4e3a</li> <li>\u9759\u6001\u94fe\u63a5/PIC (\u4f4d\u7f6e\u65e0\u5173\u4ee3\u7801)</li> <li>Freestanding (\u4e0d\u4f7f\u7528\u4efb\u4f55\u6807\u51c6\u5e93)</li> <li>\u81ea\u5df1\u624b\u5de5\u5b9e\u73b0\u5e93\u51fd\u6570 (putch, printf, ...)</li> </ul>"},{"location":"courses/os_lab/03-os_hardware_view.html#abstractmachine-repo","title":"AbstractMachine Repo","text":"<p>\u8bfe\u7a0b\u63d0\u4f9b\u7684\u8fd0\u884c C \u7a0b\u5e8f\u7684\u6846\u67b6\u4ee3\u7801\u548c\u5e93\uff0c\u9488\u5bf9\u88f8\u673a\u4e0a\u7684 C \u8bed\u8a00\u8fd0\u884c\u73af\u5883\u3002</p> <p>\u63d0\u4f9b 5 \u7ec4 (15 \u4e2a) \u4e3b\u8981 API\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5404\u7c7b\u7cfb\u7edf\u8f6f\u4ef6 (\u5982\u64cd\u4f5c\u7cfb\u7edf)\uff1a</p> <ul> <li>(TRM) <code>putch</code>/<code>halt</code> - \u6700\u57fa\u7840\u7684\u8ba1\u7b97\u3001\u663e\u793a\u548c\u505c\u673a</li> <li>(IOE) <code>ioe_read/ioe_write</code> - I/O \u8bbe\u5907\u7ba1\u7406</li> <li>(CTE) <code>ienabled</code>/<code>iset</code>/<code>yield</code>/<code>kcontext</code> - \u4e2d\u65ad\u548c\u5f02\u5e38</li> <li>(VME) <code>protect</code>/<code>unprotect</code>/<code>map</code>/<code>ucontext</code> - \u865a\u5b58\u7ba1\u7406</li> <li>(MPE) <code>cpu_count</code>/<code>cpu_current</code>/<code>atomic_xchg</code> - \u591a\u5904\u7406\u5668</li> </ul>"},{"location":"courses/os_lab/04-os_python_modeling.html","title":"Python \u5efa\u6a21\u64cd\u4f5c\u7cfb\u7edf","text":"<p>\u5728\u4e2d\u65ad\u6216\u662f trap \u6307\u4ee4\u540e\uff0c\u901a\u5e38\u7531\u4e00\u6bb5\u6c47\u7f16\u4ee3\u7801\u5c06\u5f53\u524d\u72b6\u6001\u673a (\u6267\u884c\u6d41) \u7684\u5bc4\u5b58\u5668\u4fdd\u5b58\u5230\u5185\u5b58\u4e2d\uff0c\u5b8c\u6210\u72b6\u6001\u7684 \u201c\u5c01\u5b58\u201d\u3002</p> <p>\u672c\u8bb2\u5185\u5bb9\uff1a\u4e00\u4e2a Python \u201c\u64cd\u4f5c\u7cfb\u7edf\u73a9\u5177\u201d \u7684\u8bbe\u8ba1\u4e0e\u5b9e\u73b0\uff0c\u5e2e\u52a9\u5927\u5bb6\u5728\u66f4\u9ad8\u7684 \u201c\u62bd\u8c61\u5c42\u6b21\u201d \u4e0a\u7406\u89e3\u64cd\u4f5c\u7cfb\u7edf\u7684\u884c\u4e3a\u3002\u8fd9\u4e2a \u201c\u73a9\u5177\u201d \u5c06\u8d2f\u7a7f\u6574\u4e2a\u8bfe\u7a0b</p>"},{"location":"courses/os_lab/04-os_python_modeling.html#_1","title":"\u7406\u89e3\u64cd\u4f5c\u7cfb\u7edf\u7684\u65b0\u9014\u5f84","text":""},{"location":"courses/os_lab/04-os_python_modeling.html#_2","title":"\u56de\u987e\uff1a\u7a0b\u5e8f/\u786c\u4ef6\u7684\u72b6\u6001\u673a\u6a21\u578b","text":"<p>\u8ba1\u7b97\u673a\u8f6f\u4ef6</p> <ul> <li>\u72b6\u6001\u673a (C/\u6c47\u7f16)</li> <li>\u5141\u8bb8\u6267\u884c\u7279\u6b8a\u6307\u4ee4 (syscall) \u8bf7\u6c42\u64cd\u4f5c\u7cfb\u7edf</li> <li>\u64cd\u4f5c\u7cfb\u7edf = API + \u5bf9\u8c61</li> </ul> <p>\u8ba1\u7b97\u673a\u786c\u4ef6</p> <ul> <li>\u201c\u65e0\u60c5\u6267\u884c\u6307\u4ee4\u7684\u673a\u5668\u201d</li> <li>\u4ece CPU Reset \u72b6\u6001\u5f00\u59cb\u6267\u884c Firmware \u4ee3\u7801</li> <li>\u64cd\u4f5c\u7cfb\u7edf = C \u7a0b\u5e8f</li> </ul>"},{"location":"courses/os_lab/04-os_python_modeling.html#_3","title":"\u753b\u72b6\u6001\u673a","text":"<p>\u72b6\u6001\u548c\u72b6\u6001\u7684\u8fc1\u79fb\u662f\u53ef\u4ee5 \u201c\u753b\u201d \u51fa\u6765\u7684\uff01</p> <ul> <li>\u7406\u8bba\u4e0a\u8bf4\uff0c\u53ea\u9700\u8981\u4e24\u4e2a API</li> <li><code>dump_state()</code> - \u83b7\u53d6\u5f53\u524d\u7a0b\u5e8f\u72b6\u6001</li> <li><code>single_step()</code> - \u6267\u884c\u4e00\u6b65</li> </ul> <p>GDB \u53ef\u4ee5\u505a\u8fd9\u4e8b\uff0c\u4f46\u68c0\u67e5\u72b6\u6001\u6709\u7f3a\u9677\uff0c\u4e3b\u8981\u662f\u592a\u590d\u6742\uff1a</p> <ul> <li>\u72b6\u6001\u592a\u591a\uff08\u6307\u4ee4\u6570\u5f88\u591a\uff09</li> <li>\u72b6\u6001\u592a\u5927\uff08\u5f88\u591a\u5e93\u51fd\u6570\u72b6\u6001\uff09</li> </ul> <p>\u7b80\u5316\uff1a\u628a\u590d\u6742\u7684\u4e1c\u897f\u5206\u89e3\u6210\u7b80\u5355\u7684\u4e1c\u897f\u00a0</p> <ul> <li><code>strace</code>\uff1a\u53ea\u5173\u6ce8\u7cfb\u7edf\u8c03\u7528</li> </ul> <p>\u91cd\u8981\u7684\u6982\u5ff5</p> <ul> <li>\u5e94\u7528\u7a0b\u5e8f (\u9ad8\u7ea7\u8bed\u8a00\u72b6\u6001\u673a) + \u7cfb\u7edf\u8c03\u7528 (\u64cd\u4f5c\u7cfb\u7edf API) + \u64cd\u4f5c\u7cfb\u7edf\u5185\u90e8\u5b9e\u73b0</li> </ul> <p>\u901a\u5e38\u7684\u5b9e\u73b0\u601d\u8def\uff1a\u771f\u5b9e\u7684\u64cd\u4f5c\u7cfb\u7edf + QEMU/NEMU \u6a21\u62df\u5668</p> <p>\u6211\u4eec\u7684\u601d\u8def - \u5e94\u7528\u7a0b\u5e8f = \u7eaf\u7cb9\u8ba1\u7b97\u7684 Python \u4ee3\u7801 + \u7cfb\u7edf\u8c03\u7528</p> <ul> <li>\u64cd\u4f5c\u7cfb\u7edf = Python \u7cfb\u7edf\u8c03\u7528\u5b9e\u73b0\uff0c\u6709 \u201c\u5047\u60f3\u201d \u7684 I/O \u8bbe\u5907</li> </ul> <pre><code>def main():\n    sys_write('Hello, OS World')\n</code></pre>"},{"location":"courses/os_lab/04-os_python_modeling.html#_4","title":"\u64cd\u4f5c\u7cfb\u7edf \u201c\u73a9\u5177\u201d\uff1a\u8bbe\u8ba1\u4e0e\u5b9e\u73b0","text":"<p>Python \u662f\u5355\u7ebf\u7a0b\u6267\u884c\u7684\uff0c\u5373\u4f7f\u7528 Thread \u4e5f\u56e0\u4e3a\u6709\u5168\u5c40\u9501\u3002</p>"},{"location":"courses/os_lab/04-os_python_modeling.html#api","title":"\u64cd\u4f5c\u7cfb\u7edf\u73a9\u5177\uff1aAPI","text":"<p>\u56db\u4e2a \u201c\u7cfb\u7edf\u8c03\u7528\u201d API</p> <ul> <li>choose(xs): \u8fd4\u56de <code>xs</code> \u4e2d\u7684\u4e00\u4e2a\u968f\u673a\u9009\u9879</li> <li>write(s): \u8f93\u51fa\u5b57\u7b26\u4e32 <code>s</code></li> <li>spawn(fn): \u521b\u5efa\u4e00\u4e2a\u53ef\u8fd0\u884c\u7684\u72b6\u6001\u673a <code>fn</code></li> <li>sched(): \u968f\u673a\u5207\u6362\u5230\u4efb\u610f\u72b6\u6001\u673a\u6267\u884c</li> </ul> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u6240\u6709\u7684\u4ee3\u7801\u90fd\u662f\u786e\u5b9a (deterministic) \u7684\u7eaf\u7cb9\u8ba1\u7b97</p> <ul> <li>\u5141\u8bb8\u4f7f\u7528 list, dict \u7b49\u6570\u636e\u7ed3\u6784</li> </ul>"},{"location":"courses/os_lab/04-os_python_modeling.html#_5","title":"\u64cd\u4f5c\u7cfb\u7edf\u73a9\u5177\uff1a\u5e94\u7528\u7a0b\u5e8f","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u73a9\u5177\uff1a\u6211\u4eec\u53ef\u4ee5\u52a8\u624b\u628a\u72b6\u6001\u673a\u753b\u51fa\u6765\uff01</p> <pre><code>count = 0\n\ndef Tprint(name):\n    global count\n    for i in range(3):\n        count += 1\n        sys_write(f'#{count:02} Hello from {name}{i+1}\\n')\n        sys_sched()\n\ndef main():\n    n = sys_choose([3, 4, 5])\n    sys_write(f'#Thread = {n}\\n')\n    for name in 'ABCDE'[:n]:\n        sys_spawn(Tprint, name)\n    sys_sched()\n</code></pre>"},{"location":"courses/os_lab/04-os_python_modeling.html#_6","title":"\u5b9e\u73b0\u7cfb\u7edf\u8c03\u7528","text":"<p>\u968f\u5802\u4ee3\u7801\uff1aos-model.py</p> <ul> <li>\u4e0d\u652f\u6301 <code>sys_*</code>\u7684\u7cfb\u7edf\u8c03\u7528\u7684\u8fd4\u56de\u503c\uff1b</li> </ul> <p>\u6709\u4e9b \u201c\u7cfb\u7edf\u8c03\u7528\u201d \u7684\u5b9e\u73b0\u662f\u663e\u800c\u6613\u89c1\u7684</p> <pre><code>def sys_write(s): print(s)\ndef sys_choose(xs): return random.choice(xs)\ndef sys_spawn(t): runnables.append(t)\n</code></pre> <p>sys_sched() \u7684\u96be\u70b9\uff1a</p> <ul> <li>\u5c01\u5b58\u5f53\u524d\u72b6\u6001\u673a\u7684\u72b6\u6001</li> <li>\u6062\u590d\u53e6\u4e00\u4e2a \u201c\u88ab\u5c01\u5b58\u201d \u72b6\u6001\u673a\u7684\u6267\u884c</li> </ul> <p>Python \u8bed\u8a00\u673a\u5236\uff1aGenerator objects (\u65e0\u6808\u534f\u7a0b/\u8f7b\u91cf\u7ea7\u7ebf\u7a0b/...)</p> <pre><code>def numbers():\n    i = 0\n    while True:\n        # f'{i:b}' \u5c06i\u8f6c\u4e3a2\u8fdb\u5236\n        # send \u4e2d\u53c2\u6570\u4f1a\u66ff\u4ee3 yield \u8d4b\u503c\u7ed9 ret\n        ret = yield f'{i:b}'  # \u201c\u5c01\u5b58\u201d \u72b6\u6001\u673a\u72b6\u6001\n        i += ret\n</code></pre> <p>\u4f7f\u7528\u65b9\u6cd5\uff1a</p> <pre><code>n = numbers()  # \u5c01\u5b58\u72b6\u6001\u673a\u521d\u59cb\u72b6\u6001\nn.send(None)   # \u6062\u590d\u5c01\u5b58\u7684\u72b6\u6001(\u6216\u8005 next(gen))\uff0c\u5f00\u59cb\u65f6\u53ea\u80fd\u53d1\u9001 None\uff0c\u8f93\u51fa \u20180\u2019\nn.send(0)      # \u6062\u590d\u5c01\u5b58\u7684\u72b6\u6001 (\u5e76\u4f20\u5165\u8fd4\u56de\u503c\uff0c\u7528\u4e8e\u8d4b\u503c\u7ed9 ret)\n</code></pre> <p>\u5982\u679c<code>send()</code>\u6ca1\u6709\u4ea7\u751f\u4e0b\u4e00\u4e2a\u503c\uff0c\u5219\u629b\u51fa <code>StopIteration</code>\uff1b</p>"},{"location":"courses/os_lab/04-os_python_modeling.html#_7","title":"\u73a9\u5177\u7684\u610f\u4e49","text":"<p>\u5e76\u6ca1\u6709\u8131\u79bb\u771f\u5b9e\u7684\u64cd\u4f5c\u7cfb\u7edf</p> <ul> <li>\u201c\u7b80\u5316\u201d \u4e86\u64cd\u4f5c\u7cfb\u7edf\u7684 API</li> <li>\u5728\u6682\u65f6\u4e0d\u8981\u8fc7\u5ea6\u5173\u6ce8\u7ec6\u8282\u7684\u65f6\u5019\u7406\u89e3\u64cd\u4f5c\u7cfb\u7edf</li> <li>\u7ec6\u8282\u4e5f\u4f1a\u6709\u7684\uff0c\u4f46\u4e0d\u662f\u73b0\u5728</li> <li>\u5b66\u4e60\u8def\u7ebf\uff1a\u5148 100% \u7406\u89e3\u73a9\u5177\uff0c\u518d\u7406\u89e3\u771f\u5b9e\u7cfb\u7edf\u548c\u73a9\u5177\u7684\u5dee\u5f02</li> </ul> <pre><code>void sys_write(const char *s) { printf(\"%s\", s); }\nvoid sys_sched() { usleep(rand() % 10000); }\nint sys_choose(int x) { return rand() % x; }\n\nvoid sys_spawn(void *(*fn)(void *), void *args) {\n    pthread_create(&amp;threads[nthreads++], NULL, fn, args);\n}\n</code></pre>"},{"location":"courses/os_lab/04-os_python_modeling.html#_8","title":"\u5efa\u6a21\u64cd\u4f5c\u7cfb\u7edf","text":""},{"location":"courses/os_lab/04-os_python_modeling.html#_9","title":"\u4e00\u4e2a\u66f4 \u201c\u5168\u9762\u201d \u7684\u64cd\u4f5c\u7cfb\u7edf\u6a21\u578b","text":"<p>\u8fdb\u7a0b + \u7ebf\u7a0b + \u7ec8\u7aef + \u5b58\u50a8 (\u5d29\u6e83\u4e00\u81f4\u6027)</p> \u7cfb\u7edf\u8c03\u7528/Linux \u5bf9\u5e94 \u884c\u4e3a sys_spawn(fn)/pthread_create \u521b\u5efa\u4ece fn \u5f00\u59cb\u6267\u884c\u7684\u7ebf\u7a0b sys_fork()/fork \u521b\u5efa\u5f53\u524d\u72b6\u6001\u673a\u7684\u5b8c\u6574\u590d\u5236\uff08\u8fdb\u7a0b\uff09 sys_sched()/\u5b9a\u65f6\u88ab\u52a8\u8c03\u7528 \u5207\u6362\u5230\u968f\u673a\u7684\u7ebf\u7a0b/\u8fdb\u7a0b\u6267\u884c sys_choose(xs)/rand \u8fd4\u56de\u4e00\u4e2a xs \u4e2d\u7684\u968f\u673a\u7684\u9009\u62e9 sys_write(s)/printf \u5411\u8c03\u8bd5\u7ec8\u7aef\u8f93\u51fa\u5b57\u7b26\u4e32 s sys_bread(k)/read \u8bfb\u53d6\u865a\u62df\u8bbe\u78c1\u76d8\u5757 *k \u7684\u6570\u636e sys_bwrite(k, v)/write \u5411\u865a\u62df\u78c1\u76d8\u5757 k \u5199\u5165\u6570\u636e v sys_sync()/sync \u5c06\u6240\u6709\u5411\u865a\u62df\u78c1\u76d8\u7684\u6570\u636e\u5199\u5165\u843d\u76d8 sys_crash()/\u957f\u6309\u7535\u6e90\u6309\u952e \u6a21\u62df\u7cfb\u7edf\u5d29\u6e83"},{"location":"courses/os_lab/04-os_python_modeling.html#_10","title":"\u6a21\u578b\u7684\u7b80\u5316","text":"<p>\u88ab\u52a8\uff08\u901a\u8fc7<code>sys_sched</code>\uff09\u8fdb\u884c\u8fdb\u7a0b/\u7ebf\u7a0b\u5207\u6362</p> <ul> <li>\u5b9e\u9645\u7a0b\u5e8f\u968f\u65f6\u90fd\u53ef\u80fd\u88ab\u52a8\u8c03\u7528 <code>sys_sched()</code> \u5207\u6362</li> </ul> <p>\u53ea\u6709\u4e00\u4e2a\u7ec8\u7aef</p> <ul> <li>\u6ca1\u6709 <code>read()</code> (\u7528 choose \u66ff\u4ee3 \u201c\u5141\u8bb8\u8bfb\u5230\u4efb\u610f\u503c\u201d)</li> </ul> <p>\u78c1\u76d8\u662f\u4e00\u4e2a <code>dict</code></p> <ul> <li>\u628a\u4efb\u610f key \u6620\u5c04\u5230\u4efb\u610f value</li> <li>\u5b9e\u9645\u7684\u78c1\u76d8</li> <li>key \u4e3a\u6574\u6570</li> <li>value \u662f\u56fa\u5b9a\u5927\u5c0f (\u4f8b\u5982 4KB) \u7684\u6570\u636e</li> <li>\u4e8c\u8005\u5728\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u662f\u53ef\u4ee5 \u201c\u4e92\u76f8\u8f6c\u6362\u201d \u7684</li> </ul>"},{"location":"courses/os_lab/04-os_python_modeling.html#_11","title":"\u6a21\u578b\u5b9e\u73b0","text":"<p>\u968f\u5802\u4ee3\u7801\uff1amosaic.py - 500 \u884c\u5efa\u6a21\u64cd\u4f5c\u7cfb\u7edf</p> <ul> <li>\u539f\u7406\u4e0e\u521a\u624d\u7684 \u201c\u6700\u5c0f\u64cd\u4f5c\u7cfb\u7edf\u73a9\u5177\u201d \u7c7b\u4f3c</li> <li>\u8fdb\u7a0b/\u7ebf\u7a0b\u90fd\u662f Generator Object</li> <li>\u5171\u4eab\u5185\u5b58\u7528 heap \u53d8\u91cf\u8bbf\u95ee<ul> <li>\u7ebf\u7a0b\u4f1a\u5f97\u5230\u5171\u4eab heap \u7684\u6307\u9488</li> <li>\u8fdb\u7a0b\u4f1a\u5f97\u5230\u4e00\u4e2a\u72ec\u7acb\u7684 heap clone</li> </ul> </li> <li>\u8f93\u51fa\u7a0b\u5e8f\u8fd0\u884c\u7684 \u201c\u72b6\u6001\u56fe\u201d</li> <li>JSON Object \u53ef\u8bfb</li> <li>Vertices: \u7ebf\u7a0b/\u8fdb\u7a0b\u3001\u5185\u5b58\u5feb\u7167\u3001\u8bbe\u5907\u5386\u53f2\u8f93\u51fa</li> <li>Edges: \u7cfb\u7edf\u8c03\u7528<ul> <li>\u64cd\u4f5c\u7cfb\u7edf\u5c31\u662f \u201c\u72b6\u6001\u673a\u7684\u7ba1\u7406\u8005\u201d</li> </ul> </li> </ul>"},{"location":"courses/os_lab/04-os_python_modeling.html#_12","title":"\u5efa\u6a21\u7684\u610f\u4e49","text":"<p>\u53ef\u4ee5\u628a\u72b6\u6001\u673a\u7684\u6267\u884c\u753b\u51fa\u6765\u4e86\uff01</p> <ul> <li>\u53ef\u4ee5\u76f4\u89c2\u5730\u7406\u89e3\u7a0b\u5e8f\u6267\u884c\u7684\u5168\u6d41\u7a0b</li> <li>\u53ef\u4ee5\u5bf9\u7167\u7a0b\u5e8f\u5728\u771f\u5b9e\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u8fd0\u884c\u7ed3\u679c</li> </ul> <p>\u8fd9\u5bf9\u4e8e\u66f4\u590d\u6742\u7684\u7a0b\u5e8f\uff08\u591a\u7ebf\u7a0b\u5e76\u53d1\u95ee\u9898\uff09\u6765\u8bf4\u662f\u5341\u5206\u5173\u952e\u7684</p> <pre><code>void Tsum() {\n  for (int i = 0; i &lt; n; i++) {\n    // \u8fd9\u91cc\u662f\u56e0\u4e3a\u5efa\u6a21\u7684\u4ee3\u7801\u6bcf\u884c\u90fd\u662f\u539f\u5b50\u6267\u884c\u7684\uff08\u4e0d\u4f1a\u53d1\u751f\u7ebf\u7a0b\u5207\u6362)\uff0c\u56e0\u6b64\u91c7\u7528\u4e34\u65f6\u53d8\u91cf\u7684\u65b9\u6cd5\n    // \u5b9e\u9645\u4e0a\u5373\u4f7f sum++ \u4f1a\u88ab\u6c47\u7f16\u6210\u591a\u6761\u6307\u4ee4\uff0c\u5e76\u4e0d\u662f\u539f\u5b50\u6267\u884c\u7684\uff0c\u4f46\u8fd9\u4e2a\u5efa\u6a21\u7684\u64cd\u4f5c\u7cfb\u7edf\u505a\u4e0d\u5230\n    int tmp = sum;\n    tmp++;\n    // \u5047\u8bbe\u6b64\u65f6\u53ef\u80fd\u53d1\u751f\u8fdb\u7a0b/\u7ebf\u7a0b\u5207\u6362\n    // sum \u6700\u7ec8\u7684\u503c\u5e76\u4e0d\u548c\u671f\u671b\u503c\u4e00\u81f4\uff0c\u591a\u7ebf\u7a0b\u7684\u5e76\u53d1\u95ee\u9898\u3002\n    sum = tmp;\n  }\n}\n</code></pre>"},{"location":"courses/os_lab/04-os_python_modeling.html#_13","title":"\u8bfe\u540e\u5b9e\u8df5","text":"<p>\u9605\u8bfb\u3001\u8c03\u8bd5 os-model.py \u7684\u4ee3\u7801\uff0c\u89c2\u5bdf\u5982\u4f55\u4f7f\u7528 generator \u5b9e\u73b0\u5728\u72b6\u6001\u673a\u4e4b\u95f4\u7684\u5207\u6362\u3002</p> <p>\u5728\u73b0\u4ee3\u5206\u65f6\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u72b6\u6001\u673a\u7684\u9694\u79bb (\u901a\u8fc7\u865a\u62df\u5b58\u50a8\u7cfb\u7edf) \u548c\u5207\u6362\u662f\u4e00\u9879\u57fa\u7840\u6027\u7684\u57fa\u7840\uff0c\u4e5f\u662f\u64cd\u4f5c\u7cfb\u7edf\u6700\u6709\u8da3\u7684\u4e00\u5c0f\u90e8\u5206\u4ee3\u7801\uff1a</p> <ul> <li>\u5728\u4e2d\u65ad\u6216\u662f trap \u6307\u4ee4\u540e\uff0c\u901a\u5e38\u7531\u4e00\u6bb5\u6c47\u7f16\u4ee3\u7801\u5c06\u5f53\u524d\u72b6\u6001\u673a (\u6267\u884c\u6d41) \u7684\u5bc4\u5b58\u5668\u4fdd\u5b58\u5230\u5185\u5b58\u4e2d\uff0c\u5b8c\u6210\u72b6\u6001\u7684 \u201c\u5c01\u5b58\u201d</li> </ul>"},{"location":"courses/os_lab/05_multi_cpu_programming.html","title":"\u591a\u5904\u7406\u5668\u7f16\u7a0b\uff1a\u4ece\u5165\u95e8\u5230\u653e\u5f03","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a\u591a\u5904\u7406\u5668\u7f16\u7a0b\uff1a\u4ece\u5165\u95e8\u5230\u653e\u5f03\uff1a</p> <ul> <li>\u5165\u95e8\uff1a\u591a\u7ebf\u7a0b\u7f16\u7a0b\u5e93</li> <li>\u653e\u5f03\uff1a\u539f\u5b50\u6027\u3001\u987a\u5e8f\u6027\u3001\u53ef\u89c1\u6027</li> </ul>"},{"location":"courses/os_lab/05_multi_cpu_programming.html#_2","title":"\u591a\u5904\u7406\u5668\u7f16\u7a0b\u5165\u95e8","text":"<p>\u5bf9\u5e94Operating Systems: Three Easy Pieces \u4e2d\u7684\u5e76\u53d1\u3002</p>"},{"location":"courses/os_lab/05_multi_cpu_programming.html#_3","title":"\u591a\u7ebf\u7a0b\u5171\u4eab\u5185\u5b58\u5e76\u53d1","text":"<p>\u7ebf\u7a0b\uff1a\u5171\u4eab\u5185\u5b58\u7684\u6267\u884c\u6d41</p> <ul> <li>\u6267\u884c\u6d41\u62e5\u6709\u72ec\u7acb\u7684\u5806\u6808/\u5bc4\u5b58\u5668</li> </ul> <p>\u7b80\u5316\u7684\u7ebf\u7a0b API (thread.h)</p> <ul> <li><code>spawn(fn)</code></li> <li>\u521b\u5efa\u4e00\u4e2a\u5165\u53e3\u51fd\u6570\u662f fn \u7684\u7ebf\u7a0b\uff0c\u5e76\u7acb\u5373\u5f00\u59cb\u6267\u884c<ul> <li><code>void fn(int tid) { ... }</code></li> <li>\u53c2\u6570 <code>tid</code> \u4ece 1 \u5f00\u59cb\u7f16\u53f7</li> </ul> </li> <li>\u884c\u4e3a\uff1a<code>sys_spawn(fn, tid)</code></li> <li><code>join()</code></li> <li>\u7b49\u5f85\u6240\u6709\u8fd0\u884c\u7ebf\u7a0b\u7684\u8fd4\u56de (\u4e5f\u53ef\u4ee5\u4e0d\u8c03\u7528)</li> <li>\u884c\u4e3a\uff1a<code>while (done != T) sys_sched()</code></li> </ul>"},{"location":"courses/os_lab/05_multi_cpu_programming.html#_4","title":"\u5165\u95e8\u548c\u95ee\u9898","text":"<p>\u591a\u5904\u7406\u5668\u7f16\u7a0b\uff1a\u4e00\u4e2a API \u641e\u5b9a</p> <ul> <li><code>thread.h</code>\u5728\u968f\u5802\u4ee3\u7801\u4e2d\uff0c\u63d0\u4f9b<code>create</code>\u51fd\u6570\u521b\u5efa <code>thread</code>\uff1b</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u628a\u7ebf\u7a0b\u653e\u7f6e\u5728\u4e0d\u540c\u7684\u5904\u7406\u5668\u4e0a</li> <li>\u901a\u8fc7<code>top</code>\u547d\u4ee4\u67e5\u770b\uff0cCPU \u4f7f\u7528\u7387\u8d85\u8fc7\u4e86 100%</li> </ul> <pre><code>#include \"thread.h\"\n\nvoid Ta() { while (1) { printf(\"a\"); } }\nvoid Tb() { while (1) { printf(\"b\"); } }\n\nint main() {\n  create(Ta);\n  create(Tb);\n}\n</code></pre> <p>\u95ee\u98981\uff1aTa \u548c Tb \u771f\u7684\u5171\u4eab\u5185\u5b58\u4e48\uff1f</p> <ul> <li>\u8bc1\u660e\uff1a\u5b9a\u4e49\u5168\u5c40\u53d8\u91cf\uff0c\u4e24\u4e2a\u7ebf\u7a0b\u90fd\u53ef\u4ee5\u5bf9\u5176\u64cd\u4f5c\uff1b</li> </ul> <p>\u95ee\u98982\uff1a\u5982\u4f55\u8bc1\u660e\u7ebf\u7a0b\u5177\u6709\u72ec\u7acb\u7684\u5806\u6808\uff08\u4ee5\u53ca\u786e\u5b9a\u7684\u5806\u6808\u7684\u5927\u5c0f\u8303\u56f4\uff1f\uff09</p> <ul> <li>\u51fd\u6570\u91cc\u58f0\u660e\u7684\u53d8\u91cf\uff08\u6808\u4e0a\u7684\u53d8\u91cf\uff09\uff0c\u5176\u5b83\u7ebf\u7a0b\u65e0\u6cd5\u8fdb\u884c\u4fee\u6539\uff1b</li> <li>\u6808\u7684\u8303\u56f4\uff1a\u65e0\u7a77\u9012\u5f52\uff0c\u901a\u8fc7\u5c40\u90e8\u53d8\u91cf\u7684\u5730\u5740\u6765\u4f30\u7b97\u5206\u914d\u7ed9\u7ebf\u7a0b\u7684\u6808\u7a7a\u95f4\uff1b</li> </ul> <p>\u66f4\u591a\u7684\u95ee\u9898\uff1a</p> <ul> <li>\u521b\u5efa\u7ebf\u7a0b\u4f7f\u7528\u7684\u662f\u54ea\u4e2a\u7cfb\u7edf\u8c03\u7528\uff1a<code>clone</code></li> <li>\u80fd\u4e0d\u80fd\u7528 gdb \u8c03\u8bd5\uff1f\u80fd\uff0cRTFM</li> </ul>"},{"location":"courses/os_lab/05_multi_cpu_programming.html#1","title":"\u653e\u5f03 (1)\uff1a\u539f\u5b50\u6027","text":""},{"location":"courses/os_lab/05_multi_cpu_programming.html#_5","title":"\u72b6\u6001\u673a\u7684\u9690\u542b\u5047\u8bbe","text":"<p>\u201c\u4e16\u754c\u4e0a\u53ea\u6709\u4e00\u4e2a\u72b6\u6001\u673a\u201d</p> <ul> <li>\u6ca1\u6709\u5176\u4ed6\u4efb\u4f55\u4eba\u80fd \u201c\u5e72\u6d89\u201d \u7a0b\u5e8f\u7684\u72b6\u6001</li> <li>\u63a8\u8bba\uff1a\u5bf9\u53d8\u91cf\u7684 load \u4e00\u5b9a\u8fd4\u56de\u672c\u7ebf\u7a0b\u6700\u540e\u4e00\u6b21 store \u7684\u503c</li> <li>\u8fd9\u4e5f\u662f\u7f16\u8bd1\u4f18\u5316\u7684\u57fa\u672c\u5047\u8bbe</li> </ul> <p>\u4f46\u5171\u4eab\u5185\u5b58\u63a8\u7ffb\u4e86\u8fd9\u4e2a\u5047\u8bbe</p> <pre><code>int Tworker() {\n  printf(\"%d\\n\", x);  // Global x\n  printf(\"%d\\n\", x);\n}\n</code></pre> <ul> <li>\u5176\u4ed6\u7ebf\u7a0b\u968f\u65f6\u53ef\u4ee5\u4fee\u6539<code>x</code></li> <li>\u5bfc\u81f4\u4e24\u6b21\u53ef\u80fd\u8bfb\u5230\u4e0d\u540c\u7684 <code>x</code></li> </ul>"},{"location":"courses/os_lab/05_multi_cpu_programming.html#bug","title":"\u5e76\u53d1 Bug \u793a\u4f8b","text":"<p>\u76f8\u5173\u4ee3\u7801\u5728\u968f\u5802\u4ee3\u7801\u4e2d</p> <p><code>Talipay_withdraw</code>\uff1a\u4e24\u4e2a\u7ebf\u7a0b\u5e76\u53d1\u652f\u4ed8 \u00a5100 \u4f1a\u53d1\u751f\u4ec0\u4e48\uff08\u65e0\u7b26\u53f7 int \u6ca1\u6709\u8d1f\u6570\uff0c\u7528\u4e0d\u5b8c\u7684\u94b1\uff09\uff1b</p> <p><code>Tsum</code>\uff1a\u591a\u7ebf\u7a0b\u6c42\u548c\uff1b</p> <ul> <li>\u5373\u4f7f\u7528\u6c47\u7f16\u6307\u4ee4\uff08sum++\uff09\u4e5f\u4e0d\u884c\uff0c\u65e0\u6cd5\u4fdd\u8bc1\u5355\u6761\u6307\u4ee4\u5728\u591a\u5904\u7406\u5668\u4e0a\u6267\u884c\u7684\u539f\u5b50\u6027</li> </ul>"},{"location":"courses/os_lab/05_multi_cpu_programming.html#1_1","title":"\u653e\u5f03 (1)\uff1a\u6307\u4ee4/\u4ee3\u7801\u6267\u884c\u539f\u5b50\u6027\u5047\u8bbe","text":"<p>\u201c\u5904\u7406\u5668\u4e00\u6b21\u6267\u884c\u4e00\u6761\u6307\u4ee4\u201d \u7684\u57fa\u672c\u5047\u8bbe\u5728\u4eca\u5929\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e0a\u4e0d\u518d\u6210\u7acb (\u6211\u4eec\u7684\u6a21\u578b\u4f5c\u51fa\u4e86\u7b80\u5316\u7684\u5047\u8bbe)\u3002</p> <ul> <li>\u591a\u5904\u7406\u5668\u5bfc\u81f4\u5355\u6761\u6307\u4ee4\u6267\u884c\u7684\u4e0d\u539f\u5b50\u6027\uff08\u5355\u5904\u7406\u5668\u7684\u4e2d\u65ad\u53ea\u53d1\u751f\u5728\u6307\u4ee4\u8fb9\u7f18\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u5355\u6311\u6307\u4ee4\u539f\u5b50\u6027\uff09\uff1b</li> </ul> <p>\u5355\u5904\u7406\u5668\u591a\u7ebf\u7a0b</p> <ul> <li>\u7ebf\u7a0b\u5728\u8fd0\u884c\u65f6\u53ef\u80fd\u88ab\u4e2d\u65ad\uff0c\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u6267\u884c</li> </ul> <p>\u591a\u5904\u7406\u5668\u591a\u7ebf\u7a0b</p> <ul> <li>\u7ebf\u7a0b\u6839\u672c\u5c31\u662f\u5e76\u884c\u6267\u884c\u7684</li> </ul> <p>(\u5386\u53f2) 1960s\uff0c\u5927\u5bb6\u4e89\u5148\u5728\u5171\u4eab\u5185\u5b58\u4e0a\u5b9e\u73b0\u539f\u5b50\u6027 (\u4e92\u65a5)</p> <ul> <li>\u4f46\u51e0\u4e4e\u6240\u6709\u7684\u5b9e\u73b0\u90fd\u662f\u9519\u7684\uff0c\u76f4\u5230 Dekker's Algorithm\uff0c\u8fd8\u53ea\u80fd\u4fdd\u8bc1\u4e24\u4e2a\u7ebf\u7a0b\u7684\u4e92\u65a5</li> </ul> <p>\u653e\u5f03\u539f\u5b50\u6027\u5047\u8bbe\u7684\u540e\u679c</p> <ul> <li><code>printf</code> \u8fd8\u80fd\u5728\u591a\u7ebf\u7a0b\u7a0b\u5e8f\u91cc\u8c03\u7528\u5417\uff1f</li> <li>\u901a\u8fc7 <code>man printf</code>\u67e5\u770b\uff0c\u5176\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0cRTFM\uff1b</li> </ul>"},{"location":"courses/os_lab/05_multi_cpu_programming.html#2","title":"\u653e\u5f03 (2)\uff1a\u6267\u884c\u987a\u5e8f","text":""},{"location":"courses/os_lab/05_multi_cpu_programming.html#_6","title":"\u6c42\u548c\u793a\u4f8b\u7684\u4e0d\u540c\u7f16\u8bd1\u4f18\u5316","text":"<p>\u4e0b\u9762\u7684\u6c42\u548c\u4ee3\u7801\uff0c\u5982\u679c\u6dfb\u52a0\u7f16\u8bd1\u4f18\u5316\uff1f</p> <ul> <li><code>-O1</code>: \u7ed3\u679c\u662f\uff1a100000000 </li> <li><code>-O2</code>: \u7ed3\u679c\u662f\uff1a200000000</li> </ul> <pre><code>#define N 100000000\nlong sum = 0;\n\nvoid Tsum() { for (int i = 0; i &lt; N; i++) sum++; }\n\nint main() {\n  create(Tsum);\n  create(Tsum);\n  join();\n  printf(\"sum = %ld\\n\", sum);\n}\n</code></pre>"},{"location":"courses/os_lab/05_multi_cpu_programming.html#2_1","title":"\u653e\u5f03 (2)\uff1a\u7a0b\u5e8f\u7684\u987a\u5e8f\u6267\u884c\u5047\u8bbe","text":"<p>\u7f16\u8bd1\u5668\u5bf9\u5185\u5b58\u8bbf\u95ee \u201ceventually consistent\u201d \u7684\u5904\u7406\u5bfc\u81f4\u5171\u4eab\u5185\u5b58\u4f5c\u4e3a\u7ebf\u7a0b\u540c\u6b65\u5de5\u5177\u7684\u5931\u6548\u3002</p> <p>\u901a\u8fc7\u67e5\u770bO1\u548cO2\u4f18\u5316\u540e\u7684 Tsum \u7684\u6c47\u7f16\u6307\u4ee4\uff1a\u4f60\u7684\u7f16\u8bd1\u5668\u4e5f\u8bb8\u662f\u4e0d\u540c\u7684\u7ed3\u679c</p> <ul> <li>O1\uff1a\u5148\u5c06 sum \u7684\u503c\u653e\u5230\u5bc4\u5b58\u5668\uff0c\u7136\u540e\u5bc4\u5b58\u5668\u5faa\u73af\u52a0\uff0c\u6700\u540e\u8d4b\u503c\u5230 sum\uff1b</li> <li><code>R[eax] = sum; R[eax] += N; sum = R[eax]</code></li> <li>O2\uff1a\u76f4\u63a5\u53d8\u6210\u4e00\u6761\u6307\u4ee4\uff08\u5982\u679c\u7ebf\u7a0b\u591a\uff0c\u662f\u4e0d\u662f\u4ecd\u4f1a\u7ed3\u679c\u9519\u8bef\uff1f\uff09</li> <li><code>sum += N</code>;</li> </ul> <p>\u53e6\u4e00\u4e2a\u4f8b\u5b50</p> <pre><code>while (!done);\n// would be optimized to\nif (!done) while (1);\n</code></pre>"},{"location":"courses/os_lab/05_multi_cpu_programming.html#_7","title":"\u4fdd\u8bc1\u6267\u884c\u987a\u5e8f","text":"<p>\u56de\u5fc6 \u201c\u7f16\u8bd1\u6b63\u786e\u6027\u201d</p> <ul> <li> <p>C \u72b6\u6001\u548c\u6c47\u7f16\u72b6\u6001\u673a\u7684 \u201c\u53ef\u89c2\u6d4b\u884c\u4e3a\u7b49\u4ef7\u201d</p> </li> <li> <p>\u65b9\u6cd5 1\uff1a\u63d2\u5165 \u201c\u4e0d\u53ef\u4f18\u5316\u201d \u4ee3\u7801</p> </li> <li> <p>\u201cClobbers memory\u201d\uff1a\u8868\u660e\u5185\u8054\u6c47\u7f16\u4ee3\u7801\u6539\u53d8\u4e86\u5185\u5b58\u4e2d\u7684\u503c\uff0c\u5f3a\u8feb\u7f16\u8bd1\u5668\u5728\u6267\u884c\u8be5\u6c47\u7f16\u4ee3\u7801\u524d\u5b58\u50a8\u6240\u6709\u7f13\u5b58\u7684\u503c\uff0c\u5728\u6267\u884c\u5b8c\u6c47\u7f16\u4ee3\u7801\u4e4b\u540e\u91cd\u65b0\u52a0\u8f7d\u8be5\u503c\uff0c\u76ee\u7684\u662f\u9632\u6b62\u7f16\u8bd1\u4e71\u5e8f</p> </li> <li> <p><code>c     asm volatile (\"\" ::: \"memory\");</code></p> </li> <li> <p>\u65b9\u6cd5 2\uff1a\u6807\u8bb0\u53d8\u91cf load/store \u4e3a\u4e0d\u53ef\u4f18\u5316</p> </li> <li> <p>\u4f7f\u7528 <code>volatile</code> \u53d8\u91cf</p> </li> </ul> <pre><code>extern int volatile done;\nwhile (!done) ; // \u4e0d\u4f1a\u88ab\u4f18\u5316\u6210 if (!done) while (1);\n</code></pre>"},{"location":"courses/os_lab/05_multi_cpu_programming.html#3","title":"\u653e\u5f03 (3)\uff1a\u5904\u7406\u5668\u95f4\u7684\u53ef\u89c1\u6027","text":""},{"location":"courses/os_lab/05_multi_cpu_programming.html#_8","title":"\u793a\u4f8b","text":"<pre><code>int x = 0, y = 0;\n\nvoid T1() {\n  x = 1; int t = y; // Store(x); Load(y)\n  __sync_synchronize();\n  printf(\"%d\", t);\n}\n\nvoid T2() {\n  y = 1; int t = x; // Store(y); Load(x)\n  __sync_synchronize();\n  printf(\"%d\", t);\n}\n</code></pre> <p>\u904d\u5386\u6a21\u578b\uff08\u4e0d\u540c\u7684\u6267\u884c\u987a\u5e8f\uff09\u544a\u8bc9\u6211\u4eec\uff1a<code>01, 10, 11</code></p> <ul> <li>\u4f46\u6267\u884c\u7a0b\u5e8f\u53ef\u4ee5\u8f93\u51fa <code>00</code>\uff0c\u673a\u5668\u6c38\u8fdc\u662f\u5bf9\u7684</li> <li>Model checker \u7684\u7ed3\u679c\u548c\u5b9e\u9645\u7684\u7ed3\u679c\u4e0d\u540c \u2192 \uff08Model checker\uff09\u5047\u8bbe\u9519\u4e86</li> </ul>"},{"location":"courses/os_lab/05_multi_cpu_programming.html#_9","title":"\u73b0\u4ee3\u5904\u7406\u5668\u4e5f\u662f (\u52a8\u6001) \u7f16\u8bd1\u5668","text":"<p>\u9519\u8bef (\u7b80\u5316) \u7684\u5047\u8bbe\uff08Model checker\uff09</p> <ul> <li>\u4e00\u4e2a CPU \u6267\u884c\u4e00\u6761\u6307\u4ee4\u5230\u8fbe\u4e0b\u4e00\u72b6\u6001</li> </ul> <p>\u591a\u5904\u7406\u5668\u95f4\u5373\u65f6\u53ef\u89c1\u6027\u7684\u4e27\u5931\uff1aCPU\u7684\u6307\u4ee4\u91cd\u6392\u5e8f\u4f18\u5316\uff0c\u5185\u5b58\u540c\u6b65\u969c\u89e3\u51b3\u95ee\u9898</p> <ul> <li>\u5355\u4e2a\u5904\u7406\u5668\u628a\u6c47\u7f16\u4ee3\u7801\u201c\u7f16\u8bd1\u201d\u6210\u66f4\u5c0f\u7684\\(\\mu ops\\)\uff0c\u6bcf\u4e2a\\(\\mu ops\\) \u90fd\u6709 Fetch, Issue, Execute, Commit \u56db\u4e2a\u9636\u6bb5</li> <li>\u201c\u591a\u53d1\u5c04\u201d\uff1a\u6bcf\u4e00\u5468\u671f\u5411\u6c60\u5b50\u8865\u5145\u5c3d\u53ef\u80fd\u591a\u7684 \\(\\mu op\\)</li> <li>\u201c\u4e71\u5e8f\u6267\u884c\u201d\u3001\u201c\u6309\u5e8f\u63d0\u4ea4\u201d\uff1a\u6bcf\u4e00\u5468\u671f (\u5728\u4e0d\u8fdd\u53cd\u7f16\u8bd1\u6b63\u786e\u6027\u7684\u524d\u63d0\u4e0b) \u6267\u884c\u5c3d\u53ef\u80fd\u591a\u7684 \\(\\mu op\\) </li> </ul> \u7535\u8def\u5c06\u8fde\u7eed\u7684\u6307\u4ee4 \u201c\u7f16\u8bd1\u201d \u6210\u66f4\u5c0f\u7684 \u03bcops- RF[9] = load(RF[7] + 400) - store(RF[12], RF[13]) - RF[3] = RF[4] + RF[5]"},{"location":"courses/os_lab/05_multi_cpu_programming.html#_10","title":"\u591a\u5904\u7406\u5668\u95f4\u5185\u5b58\u8bbf\u95ee\u7684\u5373\u65f6\u53ef\u89c1\u6027","text":"<p>\u6ee1\u8db3\u5355\u5904\u7406\u5668 eventual memory consistency \u7684\u6267\u884c\uff0c\u5728\u591a\u5904\u7406\u5668\u7cfb\u7edf\u4e0a\u53ef\u80fd\u65e0\u6cd5\u5e8f\u5217\u5316\uff01</p> <p>\u5f53 \\(x \\ne y\\) \u65f6\uff0c\u5bf9 \\(x,y\\) \u7684\u5185\u5b58\u8bfb\u5199\u53ef\u4ee5\u4ea4\u6362\u987a\u5e8f</p> <ul> <li>\u5b83\u4eec\u751a\u81f3\u53ef\u4ee5\u5728\u540c\u4e00\u4e2a\u5468\u671f\u91cc\u5b8c\u6210 (\u53ea\u8981 load/store unit \u652f\u6301)</li> <li>\u5982\u679c\u5199\\(x\\)\u53d1\u751f cache miss\uff0c\u53ef\u4ee5\u8ba9\u8bfb \\(y\\) \u5148\u6267\u884c</li> <li>\u6ee1\u8db3 \u201c\u5c3d\u53ef\u80fd\u6267\u884c\u03bcop\u201d \u7684\u539f\u5219\uff0c\u6700\u5927\u5316\u5904\u7406\u5668\u6027\u80fd</li> </ul> <pre><code>     # &lt;-----------+\nmovl $1, (x)   #   |\nmovl (y), %eax # --+\n</code></pre> <ul> <li>\u5728\u591a\u5904\u7406\u5668\u4e0a\u7684\u8868\u73b0</li> <li>\u4e24\u4e2a\u5904\u7406\u5668\u5206\u522b\u770b\u5230 \\(y=0\\) \u548c \\(x=0\\)</li> </ul>"},{"location":"courses/os_lab/05_multi_cpu_programming.html#relaxedweak-memory-model","title":"\u5bbd\u677e\u5185\u5b58\u6a21\u578b (Relaxed/Weak Memory Model)","text":"<p>\u5bbd\u677e\u5185\u5b58\u6a21\u578b\u7684\u76ee\u7684\u662f\u4f7f\u5355\u5904\u7406\u5668\u7684\u6267\u884c\u66f4\u9ad8\u6548\u3002</p> <p>x86 \u5df2\u7ecf\u662f\u5e02\u9762\u4e0a\u80fd\u4e70\u5230\u7684 \u201c\u6700\u5f3a\u201d \u7684\u5185\u5b58\u6a21\u578b\u4e86 </p> <ul> <li> <p>\u8fd9\u4e5f\u662f Intel \u81ea\u5df1\u7ed9\u81ea\u5df1\u52a0\u7684\u5305\u88b1</p> </li> <li> <p>\u6bcf\u4e2a\u5904\u7406\u5668\uff0c\u5148\u5199\u5230\u5355\u72ec\u7684\u961f\u5217\uff0c\u7136\u540e\u518d\u5199\u5230\u5171\u4eab\u5185\u5b58\uff1b</p> </li> </ul> <p></p> <ul> <li> <p>\u770b\u770b ARM/RISC-V \u5427\uff0c\u6839\u672c\u5c31\u662f\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf</p> </li> <li> <p>\u6700\u7ec8\u4e00\u81f4\u6027</p> </li> </ul> <p></p>"},{"location":"courses/os_lab/05_multi_cpu_programming.html#_11","title":"\u8bfe\u540e\u9605\u8bfb","text":"<p>\u6559\u79d1\u4e66 Operating Systems: Three Easy Pieces:</p> <ul> <li> <p>\u7b2c 25 \u7ae0 - Dialogue on Concurrency</p> </li> <li> <p>\u7b2c 26 \u7ae0 - Concurrency and Threads</p> </li> <li> <p>\u7b2c 27 \u7ae0 - Thread API</p> </li> </ul>"},{"location":"courses/os_lab/05_multi_cpu_programming.html#_12","title":"\u7f16\u7a0b\u4f5c\u4e1a","text":"<ul> <li>\u5728\u4f60\u7684 Linux \u4e2d\u8fd0\u884c\u8bfe\u5802\u4e0a\u7684\u4ee3\u7801\u793a\u4f8b\uff1b</li> <li>thread.h \u53ef\u4ee5\u5b66\u4e60\u7684\u7f16\u7a0b\u6280\u5de7\uff0c\u4f8b\u5982 constructor \u548c destructor \u7b49\uff1b</li> </ul>"},{"location":"courses/os_lab/06_concurrent_control_basic.html","title":"\u5e76\u53d1\u63a7\u5236\u57fa\u7840","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a\u5e76\u53d1\u7f16\u7a0b\u56f0\u96be\u4e0d\u4ee3\u8868\u6211\u4eec\u53ea\u80fd\u6446\u70c2\u2014\u2014\u6211\u4eec\u8fd8\u53ef\u4ee5\u521b\u9020\u51fa\u65b0\u7684\u624b\u6bb5\uff0c\u5e2e\u52a9\u6211\u4eec\u7f16\u5199\u6b63\u786e\u7684\u5e76\u53d1\u7a0b\u5e8f\uff1a</p> <ul> <li>\u4e92\u65a5\u95ee\u9898\u548c Peterson \u7b97\u6cd5</li> <li>Peterson \u7b97\u6cd5\u7684\u6b63\u786e\u6027\u548c\u6a21\u578b\u68c0\u9a8c</li> <li>Peterson \u7b97\u6cd5\u5728\u73b0\u4ee3\u591a\u5904\u7406\u5668\u7cfb\u7edf\u4e0a\u7684\u5b9e\u73b0</li> <li>\u5b9e\u73b0\u5e76\u53d1\u63a7\u5236\u7684\u786c\u4ef6\u548c\u7f16\u8bd1\u5668\u673a\u5236</li> </ul>"},{"location":"courses/os_lab/06_concurrent_control_basic.html#_2","title":"\u4e92\u65a5\u95ee\u9898","text":""},{"location":"courses/os_lab/06_concurrent_control_basic.html#_3","title":"\u5e76\u53d1\u7f16\u7a0b\uff1a\u4ece\u5165\u95e8\u5230\u653e\u5f03","text":"<p>\u4eba\u7c7b\u662f sequential creature</p> <ul> <li> <p>\u7f16\u8bd1\u4f18\u5316 + weak memory model \u5bfc\u81f4\u96be\u4ee5\u7406\u89e3\u7684\u5e76\u53d1\u6267\u884c</p> </li> <li> <p>Verifying sequential consistency \u662f NP-\u5b8c\u5168\u95ee\u9898</p> </li> </ul> <p>\u4eba\u7c7b\u662f (\u4e0d\u8f7b\u8a00\u653e\u5f03\u7684) sequential creature</p> <ul> <li>\u624b\u6bb5\uff1a'\u201c\u56de\u9000\u5230\u201d \u987a\u5e8f\u6267\u884c</li> <li>\u6807\u8bb0\u82e5\u5e72\u5757\u4ee3\u7801\uff0c\u4f7f\u5f97\u8fd9\u4e9b\u4ee3\u7801\u4e00\u5b9a\u80fd\u6309\u67d0\u4e2a\u987a\u5e8f\u6267\u884c</li> </ul>"},{"location":"courses/os_lab/06_concurrent_control_basic.html#_4","title":"\u56de\u9000\u5230\u987a\u5e8f\u6267\u884c\uff1a\u4e92\u65a5","text":"<p>\u63d2\u5165 \u201c\u795e\u79d8\u4ee3\u7801\u201d\uff0c\u4f7f\u5f97\u6240\u6709\u5176\u4ed6 \u201c\u795e\u79d8\u4ee3\u7801\u201d \u90fd\u4e0d\u80fd\u5e76\u53d1</p> <ul> <li>\u7531 \u201c\u795e\u79d8\u4ee3\u7801\u201d \u9886\u5bfc\u4e0d\u4f1a\u5e76\u53d1\u7684\u4ee3\u7801 (\u4f8b\u5982 pure functions) \u6267\u884c</li> </ul> <pre><code>void Tsum() {\n  stop_the_world();\n  // \u4e34\u754c\u533a critical section\n  sum++;\n  resume_the_world();\n}\n</code></pre> <p>Stop the world \u771f\u7684\u662f\u53ef\u80fd\u7684</p> <ul> <li>Java \u6709 \u201cstop the world GC\u201d</li> <li>\u5355\u4e2a\u5904\u7406\u5668\u53ef\u4ee5\u5173\u95ed\u4e2d\u65ad</li> <li>\u591a\u4e2a\u5904\u7406\u5668\u4e5f\u53ef\u4ee5\u53d1\u9001\u6838\u95f4\u4e2d\u65ad</li> </ul>"},{"location":"courses/os_lab/06_concurrent_control_basic.html#_5","title":"\u786e\u5b9a\u5047\u8bbe\u3001\u8bbe\u8ba1\u7b97\u6cd5","text":"<p>\u5931\u8d25\u7684\u5c1d\u8bd5\uff1a\u5e76\u53d1\u7a0b\u5e8f\u4e0d\u80fd\u4fdd\u8bc1 load + store \u7684\u539f\u5b50\u6027</p> <pre><code>int locked = UNLOCK;\nvoid critical_section() {\nretry:\n  if (locked != UNLOCK) {\n    goto retry;\n  }\n  locked = LOCK;\n\n  // critical section\n\n  locked = UNLOCK;\n}\n</code></pre> <p>\u5047\u8bbe\uff1a\u5185\u5b58\u7684\u8bfb/\u5199\u53ef\u4ee5\u4fdd\u8bc1\u987a\u5e8f\u3001\u539f\u5b50\u5b8c\u6210</p> <ul> <li><code>val = atomic_load(ptr)</code></li> <li>\u770b\u4e00\u773c\u67d0\u4e2a\u5730\u65b9\u7684\u5b57\u6761 (\u53ea\u80fd\u770b\u5230\u77ac\u95f4\u7684\u5b57)</li> <li>\u521a\u770b\u5b8c\u5c31\u53ef\u80fd\u88ab\u6539\u6389</li> <li><code>atomic_store(ptr, val)</code></li> <li>\u5bf9\u5e94\u5f80\u67d0\u4e2a\u5730\u65b9 \u201c\u8d34\u4e00\u5f20\u7eb8\u6761\u201d (\u5fc5\u987b\u95ed\u773c\u76f2\u8d34)</li> <li>\u8d34\u5b8c\u4e00\u77ac\u95f4\u5c31\u53ef\u80fd\u88ab\u522b\u4eba\u8986\u76d6</li> </ul> <p>\u5bf9\u5e94\u4e8e<code>model checker</code></p> <ul> <li>\u6bcf\u4e00\u884c\u53ef\u4ee5\u6267\u884c\u4e00\u6b21\u5168\u5c40\u53d8\u91cf\u8bfb\u6216\u5199\uff08\u539f\u5b50\u6027\uff09\uff1b</li> <li>\u6bcf\u4e2a\u64cd\u4f5c\u6267\u884c\u4e4b\u540e\u90fd\u53d1\u751f <code>sys_sched()</code>\uff1b</li> </ul>"},{"location":"courses/os_lab/06_concurrent_control_basic.html#peterson","title":"Peterson \u7b97\u6cd5\uff08\u5982\u4f55\u8bc1\u660e\u6b63\u786e\uff09","text":"<p>\u8bc1\u660e Peterson \u7b97\u6cd5\u6b63\u786e\uff0c\u6216\u7ed9\u51fa\u53cd\u4f8b\u3002</p> <p>\u5f62\u8c61\u5316\u793a\u4f8b\uff1aA \u548c B \u4e89\u7528\u5395\u6240\u7684\u5305\u53a2</p> <ul> <li>\u60f3\u8fdb\u5165\u5305\u53a2\u4e4b\u524d\uff0cA/B \u90fd\u9996\u5148\u4e3e\u8d77\u81ea\u5df1\u7684\u65d7\u5b50</li> <li>A \u5f80\u5395\u6240\u95e8\u4e0a\u8d34\u4e0a \u201cB \u6b63\u5728\u4f7f\u7528\u201d \u7684\u6807\u7b7e</li> <li>B \u5f80\u5395\u6240\u95e8\u4e0a\u8d34\u4e0a \u201cA \u6b63\u5728\u4f7f\u7528\u201d \u7684\u6807\u7b7e</li> <li>\u7136\u540e\uff0c\u5982\u679c\u5bf9\u65b9\u4e3e\u7740\u65d7\uff0c\u4e14\u95e8\u4e0a\u7684\u540d\u5b57\u662f\u5bf9\u65b9\uff0c\u7b49\u5f85</li> <li>\u5426\u5219\u53ef\u4ee5\u8fdb\u5165\u5305\u53a2</li> <li>\u51fa\u5305\u53a2\u540e\uff0c\u653e\u4e0b\u81ea\u5df1\u7684\u65d7\u5b50 (\u5b8c\u5168\u4e0d\u7ba1\u95e8\u4e0a\u7684\u6807\u7b7e)</li> </ul>"},{"location":"courses/os_lab/06_concurrent_control_basic.html#_6","title":"\u7ed5\u6765\u7ed5\u53bb\u5f88\u5bb9\u6613\u6709\u9519\u6f0f","text":"<p>Prove by brute-force</p> <ul> <li>\u679a\u4e3e\u72b6\u6001\u673a\u7684\u5168\u90e8\u72b6\u6001 (\\(PC_1\uff0cPC_2,x,y,turn\\))</li> <li>\u4f46\u624b\u5199\u8fd8\u662f\u5f88\u5bb9\u6613\u9519\u554a\u2014\u2014\u53ef\u6267\u884c\u7684\u72b6\u6001\u673a\u6a21\u578b\u6709\u7528\u4e86\uff01</li> </ul> <pre><code>void TA() { while (1) {\n/* \u2776 */  x = 1;\n/* \u2777 */  turn = B;\n/* \u2778 */  while (y &amp;&amp; turn == B) ;\n/* \u2779 */  x = 0; } }\n\nvoid TB() { while (1) {\n/* \u2460 */  y = 1;\n/* \u2461 */  turn = A;\n/* \u2462 */  while (x &amp;&amp; turn == A) ;\n/* \u2463 */  y = 0; } }\n</code></pre>"},{"location":"courses/os_lab/06_concurrent_control_basic.html#_7","title":"\u6a21\u578b\u3001\u6a21\u578b\u68c0\u9a8c\u4e0e\u73b0\u5b9e","text":""},{"location":"courses/os_lab/06_concurrent_control_basic.html#model-checker","title":"Model Checker \u548c\u81ea\u52a8\u5316","text":"<p>\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5feb\u901f\u56de\u7b54\u66f4\u591a\u95ee\u9898</p> <ul> <li>\u5982\u679c\u7ed3\u675f\u540e\u628a\u95e8\u4e0a\u7684\u5b57\u6761\u6495\u6389\uff0c\u7b97\u6cd5\u8fd8\u6b63\u786e\u5417\uff1f</li> <li>\u5728\u653e\u4e0b\u65d7\u5b50\u4e4b\u524d\u6495</li> <li>\u5728\u653e\u4e0b\u65d7\u5b50\u4e4b\u540e\u6495</li> <li>\u5982\u679c\u5148\u8d34\u6807\u7b7e\u518d\u4e3e\u65d7\uff0c\u7b97\u6cd5\u8fd8\u6b63\u786e\u5417\uff1f</li> <li>\u6211\u4eec\u6709\u4e24\u4e2a \u201c\u67e5\u770b\u201d \u7684\u64cd\u4f5c</li> <li>\u770b\u5bf9\u65b9\u7684\u65d7\u6709\u6ca1\u6709\u4e3e\u8d77\u6765</li> <li>\u770b\u95e8\u4e0a\u7684\u8d34\u7eb8\u662f\u4e0d\u662f\u81ea\u5df1</li> <li>\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u7684\u987a\u5e8f\u5f71\u54cd\u7b97\u6cd5\u7684\u6b63\u786e\u6027\u5417\uff1f</li> <li>\u662f\u5426\u5b58\u5728 \u201c\u4e24\u4e2a\u4eba\u8c01\u90fd\u65e0\u6cd5\u8fdb\u5165\u4e34\u754c\u533a\u201d (liveness)\u3001\u201c\u5bf9\u67d0\u4e00\u65b9\u4e0d\u516c\u5e73\u201d (fairness) \u7b49\u884c\u4e3a\uff1f</li> <li>\u90fd\u8f6c\u6362\u6210\u56fe (\u72b6\u6001\u7a7a\u95f4) \u4e0a\u7684\u904d\u5386\u95ee\u9898\u4e86\uff01</li> </ul>"},{"location":"courses/os_lab/06_concurrent_control_basic.html#_8","title":"\u4ece\u6a21\u578b\u56de\u5230\u73b0\u5b9e\u2026\u2026","text":"<p>\u56de\u5230\u5047\u8bbe (\u4f53\u73b0\u5728\u6a21\u578b)</p> <ul> <li>Atomic load &amp; store\uff1a\u5047\u8bbe\u5728\u73b0\u4ee3\u591a\u5904\u7406\u5668\u4e0a\u5e76\u4e0d\u6210\u7acb</li> <li>\u6240\u4ee5\u5b9e\u9645\u4e0a\u6309\u7167\u6a21\u578b\u76f4\u63a5\u5199 Peterson \u7b97\u6cd5\u5e94\u8be5\u662f\u9519\u7684\uff1f</li> </ul> <p>\u201c\u5b9e\u73b0\u6b63\u786e\u7684 Peterson \u7b97\u6cd5\u201d \u662f\u5408\u7406\u9700\u6c42\uff0c\u5b83\u4e00\u5b9a\u80fd\u5b9e\u73b0</p> <ul> <li><code>Compiler barrier/volatile</code> \u4fdd\u8bc1\u4e0d\u88ab\u4f18\u5316\u7684\u524d\u63d0\u4e0b</li> <li>\u5904\u7406\u5668\u63d0\u4f9b\u7279\u6b8a\u6307\u4ee4\u4fdd\u8bc1\u53ef\u89c1\u6027</li> <li>\u7f16\u8bd1\u5668\u63d0\u4f9b <code>__sync_synchronize()</code> \u51fd\u6570<ul> <li>x86: <code>mfence</code>; ARM: <code>dmb ish</code>; RISC-V: <code>fence rw, rw</code></li> <li>\u540c\u65f6\u542b\u6709\u4e00\u4e2a compiler barrier</li> </ul> </li> </ul>"},{"location":"courses/os_lab/06_concurrent_control_basic.html#_9","title":"\u539f\u5b50\u6307\u4ee4","text":""},{"location":"courses/os_lab/06_concurrent_control_basic.html#_10","title":"\u5e76\u53d1\u7f16\u7a0b\u56f0\u96be\u7684\u89e3\u51b3","text":"<p>\u666e\u901a\u7684\u53d8\u91cf\u8bfb\u5199\u5728\u7f16\u8bd1\u5668 + \u5904\u7406\u5668\u7684\u53cc\u91cd\u4f18\u5316\u4e0b\u884c\u4e3a\u53d8\u5f97\u590d\u6742</p> <pre><code>retry:\n  if (locked != UNLOCK) {\n    goto retry;\n  }\n  locked = LOCK;\n</code></pre> <p>\u89e3\u51b3\u65b9\u6cd5\uff1a\u7f16\u8bd1\u5668\u548c\u786c\u4ef6\u5171\u540c\u63d0\u4f9b\u4e0d\u53ef\u4f18\u5316\u3001\u4e0d\u53ef\u6253\u65ad\u7684\u6307\u4ee4</p> <ul> <li>\u201c\u539f\u5b50\u6307\u4ee4\u201d + compiler barrier</li> </ul>"},{"location":"courses/os_lab/06_concurrent_control_basic.html#_11","title":"\u5b9e\u73b0\u6b63\u786e\u7684\u6c42\u548c","text":"<pre><code>for (int i = 0; i &lt; N; i++)\n  asm volatile(\"lock incq %0\" : \"+m\"(sum));\n</code></pre> <p>\u201cBus lock\u201d\u2014\u2014\u4ece 80386 \u5f00\u59cb\u5f15\u5165 (bus control signal)</p> <p></p>"},{"location":"courses/os_lab/06_concurrent_control_basic.html#_12","title":"\u7f16\u8bd1\u5668\u548c\u786c\u4ef6\u7684\u534f\u4f5c","text":"<p>Acquire/release semantics</p> <ul> <li>\u5bf9\u4e8e\u4e00\u5bf9\u914d\u5bf9\u7684 release-acquire</li> <li>(\u903b\u8f91\u4e0a) release \u4e4b\u524d\u7684 store \u90fd\u5bf9 acquire \u4e4b\u540e\u7684 load \u53ef\u89c1</li> <li> <p>Making Sense of Acquire-Release Semantics</p> </li> <li> <p><code>std::atomic</code></p> </li> <li><code>std::memory_order_acquire</code>: guarantees that subsequent loads are not moved before the current load or any preceding loads.</li> <li><code>std::memory_order_release</code>: preceding stores are not moved past the current store or any subsequent stores.</li> <li><code>x.load()</code>/<code>x.store()</code> \u4f1a\u6839\u636e memory order \u63d2\u5165 fence</li> <li><code>x.fetch_add()</code>\u5c06\u4f1a\u4fdd\u8bc1 cst (sequentially consistent)<ul> <li>\u53bb godbolt \u4e0a\u8bd5\u4e00\u4e0b\u5427\uff08\u7ffb\u8bd1\u6210\u5bf9\u5e94\u7684\u6307\u4ee4\uff09</li> </ul> </li> </ul>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html","title":"\u5e76\u53d1\u63a7\u5236\uff1a\u4e92\u65a5","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a\u73b0\u4ee3\u591a\u5904\u7406\u5668\u7cfb\u7edf\u4e0a\u7684\u4e92\u65a5\u5b9e\u73b0\uff1a</p> <ul> <li>\u4e92\u65a5\u95ee\u9898\u7684\u5b9a\u4e49\u548c\u5047\u8bbe</li> <li>\u81ea\u65cb\u9501</li> <li>\u4e92\u65a5\u9501\u548c Futex</li> </ul>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#_2","title":"\u4e92\u65a5\u95ee\u9898\uff1a\u5b9a\u4e49\u4e0e\u5047\u8bbe","text":""},{"location":"courses/os_lab/07_concurrent_control_mutex.html#_3","title":"\u4e92\u65a5\u95ee\u9898\uff1a\u5b9a\u4e49","text":"<p>\u4e92\u65a5 (mutual exclusion)\uff0c\u201c\u4e92\u76f8\u6392\u65a5\u201d</p> <ul> <li>\u5b9e\u73b0 <code>lock_t</code> \u6570\u636e\u7ed3\u6784\u548c <code>lock/unlock</code> API:</li> </ul> <pre><code>typedef struct {\n  ...\n} lock_t;\nvoid lock(lock_t *lk);\nvoid unlock(lock_t *lk);\n</code></pre> <p>\u4e00\u628a \u201c\u6392\u4ed6\u6027\u201d \u7684\u9501\u2014\u2014\u5bf9\u4e8e\u9501\u5bf9\u8c61 <code>lk</code></p> <ul> <li>\u5982\u679c\u67d0\u4e2a\u7ebf\u7a0b\u6301\u6709\u9501\uff0c\u5219\u5176\u4ed6\u7ebf\u7a0b\u7684 <code>lock</code> \u4e0d\u80fd\u8fd4\u56de (Safety)</li> <li>\u5728\u591a\u4e2a\u7ebf\u7a0b\u6267\u884c <code>lock</code> \u65f6\uff0c\u81f3\u5c11\u6709\u4e00\u4e2a\u53ef\u4ee5\u8fd4\u56de (Liveness)</li> <li>\u80fd\u6b63\u786e\u5904\u7406\u5904\u7406\u5668\u4e71\u5e8f\u3001\u5bbd\u677e\u5185\u5b58\u6a21\u578b\u548c\u7f16\u8bd1\u4f18\u5316</li> </ul>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#_4","title":"\u5b9e\u73b0\u4e92\u65a5\u7684\u57fa\u672c\u5047\u8bbe","text":"<p>\u5141\u8bb8\u4f7f\u7528\u4f7f\u6211\u4eec\u53ef\u4ee5\u4e0d\u7ba1\u4e00\u5207\u9ebb\u70e6\u4e8b\u7684\u539f\u5b50\u6307\u4ee4</p> <pre><code>void atomic_inc(long *ptr);\nint atomic_xchg(int val, int *ptr);\n</code></pre> <p>\u770b\u8d77\u6765\u662f\u4e00\u4e2a\u666e\u901a\u7684\u51fd\u6570\uff0c\u4f46\u5047\u8bbe\uff1a</p> <ul> <li>\u539f\u5b50\u6027\uff1a\u5305\u542b\u4e00\u4e2a\u539f\u5b50\u6307\u4ee4</li> <li>\u6307\u4ee4\u7684\u6267\u884c\u4e0d\u80fd\u88ab\u6253\u65ad</li> <li>\u6267\u884c\u987a\u5e8f\uff1a\u5305\u542b\u4e00\u4e2a compiler barrier</li> <li>\u65e0\u8bba\u4f55\u79cd\u4f18\u5316\u90fd\u4e0d\u53ef\u8d8a\u8fc7\u6b64\u51fd\u6570</li> <li>\u53ef\u89c1\u6027\uff1a\u5305\u542b\u4e00\u4e2a memory fence</li> <li>\u4fdd\u8bc1\u5904\u7406\u5668\u5728 stop-the-world \u524d\u6240\u6709\u5bf9\u5185\u5b58\u7684 store \u90fd \u201c\u751f\u6548\u201d</li> <li>\u5373\u5bf9 resume-the-world \u4e4b\u540e\u7684 load \u53ef\u89c1</li> </ul>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#atomic-exchange","title":"Atomic Exchange \u5b9e\u73b0","text":"<pre><code>int xchg(int volatile *ptr, int newval) {\n  int result;\n  asm volatile(\n    // \u6307\u4ee4\u81ea\u5e26 memory barrier\n    \"lock xchgl %0, %1\"\n    : \"+m\"(*ptr), \"=a\"(result)\n    : \"1\"(newval)\n    // Compiler barrier\n    : \"memory\"\n  );\n  return result;\n}\n</code></pre>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#spin-lock","title":"\u81ea\u65cb\u9501\uff08Spin Lock\uff09","text":"<p>\u79d1\u5b66\u5bb6\uff1a\u8003\u8651\u66f4\u591a\u66f4\u6839\u672c\u7684\u95ee\u9898</p> <ul> <li>\u6211\u4eec\u53ef\u4ee5\u8bbe\u8ba1\u51fa\u600e\u6837\u7684\u539f\u5b50\u6307\u4ee4\uff1f</li> <li>\u5b83\u4eec\u7684\u8868\u8fbe\u80fd\u529b\u5982\u4f55\uff1f</li> <li>\u8ba1\u7b97\u673a\u786c\u4ef6\u53ef\u4ee5\u63d0\u4f9b\u6bd4 \u201c\u4e00\u6b21 load/store\u201d \u66f4\u5f3a\u7684\u539f\u5b50\u6027\u5417\uff1f</li> <li>\u5982\u679c\u786c\u4ef6\u5f88\u56f0\u96be\uff0c\u8f6f\u4ef6/\u7f16\u8bd1\u5668\u53ef\u4ee5\u4e48\uff1f</li> </ul>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#xchg","title":"\u81ea\u65cb\u9501\uff1a\u7528 <code>xchg</code> \u5b9e\u73b0\u4e92\u65a5","text":"<p>Lock \u4fdd\u62a4\u4e34\u754c\u533a\uff0c\u4e34\u754c\u533a\u7684\u53d8\u91cf\u4e0d\u9700\u8981\u4efb\u4f55\u4fee\u9970\u3002\u4e0d\u540c\u7684 Lock \u662f\u5e76\u53d1\u7684\uff0c\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff1f</p> <ul> <li>\u6bcf\u6b21\u90fd\u662f\u8981\u5c06\u6570\u636e\u5199\u5185\u5b58/\u8bfb\u5185\u5b58\uff0c\u4e0d\u540c\u7684\u9501\u4e4b\u95f4\u4e5f\u4f1a\u6709\u5f71\u54cd\uff1f</li> <li>\u770b memory fence \u7684\u5b9a\u4e49</li> <li>lock  \u548c unlock \u95f4\u7684\u4ee3\u7801\u662f\u53ef\u4ee5\u8fdb\u884c\u4f18\u5316\u7684\uff1b</li> </ul> <p>\u5728 xchg \u7684\u5047\u8bbe\u4e0b\u7b80\u5316\u5b9e\u73b0</p> <ul> <li>\u5305\u542b\u4e00\u4e2a\u539f\u5b50\u6307\u4ee4</li> <li>\u5305\u542b\u4e00\u4e2a compiler barrier</li> <li>\u5305\u542b\u4e00\u4e2a memory fence</li> </ul> <pre><code>// \u7528 model checker \u4e2d\u68c0\u67e5\nint locked = 0;\n\nvoid lock() {\n  while (xchg(&amp;locked, 1));\n}\n\nvoid unlock() {\n  // X86 \u67b6\u6784\u4e0b\uff0c\u53ef\u4ee5\u7528\u76f4\u63a5locked == 0\uff0c\u53ea\u9700\u8981\u9632\u6b62\u7f16\u8bd1\u4f18\u5316\u5373\u53ef\u3002  \n  xchg(&amp;locked, 0);\n}\n</code></pre>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#_5","title":"\u4f60\u4eec (\u4e0d) \u60f3\u8981\u7684\u65e0\u9501\u7b97\u6cd5","text":""},{"location":"courses/os_lab/07_concurrent_control_mutex.html#_6","title":"\u66f4\u5f3a\u5927\u7684\u539f\u5b50\u6307\u4ee4","text":"<p>Compare and exchange (\u201ctest and set\u201d)</p> <ul> <li>(lock) <code>cmpxchg SRC, DEST</code></li> </ul> <pre><code># https://www.felixcloutier.com/x86/cmpxchg\nTEMP = DEST\nif accumulator == TEMP:\n    ZF = 1\n    DEST = SRC\nelse:\n    ZF = 0\n    accumulator = TEMP\n</code></pre>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#xchg_1","title":"\u5728\u81ea\u65cb\u9501\u4e2d\u4ee3\u66ff xchg","text":"<p>\u5728\u81ea\u65cb\u9501\u7684\u5b9e\u73b0\u4e2d\uff0cxchg \u5b8c\u5168\u53ef\u4ee5\u7528 cmpxchg \u4ee3\u66ff</p> <ul> <li>\u5728\u81ea\u65cb\u5931\u8d25\u7684\u65f6\u5019\u51cf\u5c11\u4e86\u4e00\u6b21 store\uff0c\u73b0\u4ee3\u5904\u7406\u5668\u4e5f\u53ef\u4ee5\u4f18\u5316 xchg\uff1b</li> </ul>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#compare","title":"\u591a\u51fa\u7684 Compare: \u7528\u5904","text":"<p>\u540c\u65f6\u68c0\u67e5\u4e0a\u4e00\u6b21\u83b7\u5f97\u7684\u503c\u662f\u5426\u4ecd\u7136\u6709\u6548 + \u4fee\u6539\u751f\u6548</p> <ul> <li>\u573a\u666f\uff1a\u5e76\u53d1\u7684\u5355\u5217\u8868\uff0c\u5934\u8282\u70b9\u7684\u5904\u7406</li> </ul> <pre><code>// Create a new node\n  node = newnode();\nretry:\n  expected = head;\n  node-&gt;next = expected;\n  seen = cmpxchg(expected, node, &amp;head);\n  if (seen != expected)\n    goto retry;\n</code></pre>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#_7","title":"\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u5b9e\u73b0\u4e92\u65a5","text":""},{"location":"courses/os_lab/07_concurrent_control_mutex.html#_8","title":"\u81ea\u65cb\u9501\u7684\u7f3a\u9677","text":"<p>\u81ea\u65cb (\u5171\u4eab\u53d8\u91cf) \u4f1a\u89e6\u53d1\u5904\u7406\u5668\u95f4\u7684\u7f13\u5b58\u540c\u6b65\uff0c\u5ef6\u8fdf\u589e\u52a0</p> <ul> <li>\u5176\u5b83\u9501\u673a\u5236\u4e5f\u4f1a\u6709\u6b64\u7c7b\u5171\u6027\u95ee\u9898\uff0c\u56e0\u4e3a\u4e0d\u7b97\u505a\u7f3a\u9677\u3002</li> </ul> <p>\u6027\u80fd\u95ee\u9898 (1)</p> <ul> <li>\u9664\u4e86\u8fdb\u5165\u4e34\u754c\u533a\u7684\u7ebf\u7a0b\uff0c\u5176\u4ed6\u5904\u7406\u5668\u4e0a\u7684\u7ebf\u7a0b\u90fd\u5728\u7a7a\u8f6c</li> <li>\u4e89\u62a2\u9501\u7684\u5904\u7406\u5668\u8d8a\u591a\uff0c\u5229\u7528\u7387\u8d8a\u4f4e</li> <li>4 \u4e2a CPU \u8fd0\u884c 4 \u4e2a sum-spinlock \u548c 1 \u4e2a OBS<ul> <li>\u4efb\u610f\u65f6\u523b\u90fd\u53ea\u6709\u4e00\u4e2a sum-atomic \u5728\u6709\u6548\u8ba1\u7b97</li> </ul> </li> <li>\u5747\u5206 CPU, OBS \u5c31\u5206\u4e0d\u5230 100% \u7684 CPU \u4e86</li> </ul> <p>\u6027\u80fd\u95ee\u9898 (2)</p> <ul> <li>\u6301\u6709\u81ea\u65cb\u9501\u7684\u7ebf\u7a0b\u53ef\u80fd\u88ab\u64cd\u4f5c\u7cfb\u7edf\u5207\u6362\u51fa\u53bb</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u4e0d \u201c\u611f\u77e5\u201d \u7ebf\u7a0b\u5728\u505a\u4ec0\u4e48(\u4f46\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u5462\uff1f)</li> <li>\u5b9e\u73b0 100% \u7684\u8d44\u6e90\u6d6a\u8d39</li> </ul>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#scalability","title":"Scalability: \u6027\u80fd\u7684\u65b0\u7ef4\u5ea6","text":"<p>\u901a\u8fc7 <code>sum++</code> \u4ee3\u7801\u9a8c\u8bc1 spinlock \u7684 scalability\u3002</p> <ul> <li>\u4f46\u4e25\u8c28\u7684\u7edf\u8ba1\u5f88\u96be</li> <li>CPU \u52a8\u6001\u529f\u8017</li> <li>\u7cfb\u7edf\u4e2d\u7684\u5176\u4ed6\u8fdb\u7a0b</li> <li>\u8d85\u7ebf\u7a0b</li> <li>NUMA</li> <li>\u2026\u2026</li> <li>Benchmarking crimes</li> </ul> <p></p>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#_9","title":"\u81ea\u65cb\u9501\u7684\u4f7f\u7528\u573a\u666f","text":"<ol> <li>\u4e34\u754c\u533a\u51e0\u4e4e\u4e0d \u201c\u62e5\u5835\u201d</li> <li>\u6301\u6709\u81ea\u65cb\u9501\u65f6\u7981\u6b62\u6267\u884c\u6d41\u5207\u6362</li> </ol> <p>\u4f7f\u7528\u573a\u666f\uff1a\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7684\u5e76\u53d1\u6570\u636e\u7ed3\u6784 (\u77ed\u4e34\u754c\u533a)</p> <ul> <li>\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u5173\u95ed\u4e2d\u65ad\u548c\u62a2\u5360\uff08\u53ea\u80fd\u5173\u95ed\u5f53\u524dcpu\u7684\u4e2d\u65ad\uff0c\u65e0\u6cd5\u5173\u95ed\u5176\u5b83cpu\uff09</li> <li>\u4fdd\u8bc1\u9501\u7684\u6301\u6709\u8005\u5728\u5f88\u77ed\u7684\u65f6\u95f4\u5185\u53ef\u4ee5\u91ca\u653e\u9501</li> <li>(\u5982\u679c\u662f\u865a\u62df\u673a\u5462...\ud83d\ude02)</li> <li>PAUSE \u6307\u4ee4\u4f1a\u89e6\u53d1 VM Exit</li> <li>\u4f46\u4f9d\u65e7\u5f88\u96be\u505a\u597d</li> <li>An analysis of Linux scalability to many cores (OSDI'10)</li> </ul>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#_10","title":"\u5b9e\u73b0\u7ebf\u7a0b + \u957f\u4e34\u754c\u533a\u7684\u4e92\u65a5","text":"<p>\u4f5c\u4e1a\u90a3\u4e48\u591a\uff0c\u4e0e\u5176\u5e72\u7b49 Online Judge \u53d1\u5e03\uff0c\u4e0d\u5982\u628a\u81ea\u5df1 (CPU) \u8ba9\u7ed9\u5176\u4ed6\u4f5c\u4e1a (\u7ebf\u7a0b) \u6267\u884c\uff1f</p> <p>\u201c\u8ba9\u201d \u4e0d\u662f C \u8bed\u8a00\u4ee3\u7801\u53ef\u4ee5\u505a\u5230\u7684 (C \u4ee3\u7801\u53ea\u80fd\u6267\u884c\u6307\u4ee4)</p> <ul> <li>\u4f46\u6709\u4e00\u79cd\u7279\u6b8a\u7684\u6307\u4ee4\uff1asyscall</li> <li>\u628a\u9501\u7684\u5b9e\u73b0\u653e\u5230\u64cd\u4f5c\u7cfb\u7edf\u91cc\u5c31\u597d\u5566\uff08\u5c31\u662f\u540e\u9762\u7684 sys_futex \u7cfb\u7edf\u8c03\u7528\uff09</li> <li><code>syscall(SYSCALL_lock, &amp;lk);</code><ul> <li>\u8bd5\u56fe\u83b7\u5f97 <code>lk</code>\uff0c\u4f46\u5982\u679c\u5931\u8d25\uff0c\u5c31\u5207\u6362\u5230\u5176\u4ed6\u7ebf\u7a0b</li> </ul> </li> <li><code>syscall(SYSCALL_unlock, &amp;lk);</code><ul> <li>\u91ca\u653e <code>lk</code>\uff0c\u5982\u679c\u6709\u7b49\u5f85\u9501\u7684\u7ebf\u7a0b\u5c31\u5524\u9192</li> </ul> </li> </ul>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#_11","title":"\u5173\u4e8e\u4e92\u65a5\u7684\u4e00\u4e9b\u5206\u6790","text":"<p>\u81ea\u65cb\u9501 (\u7ebf\u7a0b\u76f4\u63a5\u5171\u4eab locked)</p> <ul> <li>\u66f4\u5feb\u7684 fast path</li> <li>xchg \u6210\u529f \u2192 \u7acb\u5373\u8fdb\u5165\u4e34\u754c\u533a\uff0c\u5f00\u9500\u5f88\u5c0f</li> <li>\u66f4\u6162\u7684 slow path</li> <li>xchg \u5931\u8d25 \u2192 \u6d6a\u8d39 CPU \u81ea\u65cb\u7b49\u5f85</li> </ul> <p>\u4e92\u65a5\u9501 (\u901a\u8fc7\u7cfb\u7edf\u8c03\u7528\u8bbf\u95ee locked)</p> <ul> <li>\u66f4\u7ecf\u6d4e\u7684 slow path</li> <li>\u4e0a\u9501\u5931\u8d25\u7ebf\u7a0b\u4e0d\u518d\u5360\u7528 CPU</li> <li>\u66f4\u6162\u7684 fast path</li> <li>\u5373\u4fbf\u4e0a\u9501\u6210\u529f\u4e5f\u9700\u8981\u8fdb\u51fa\u5185\u6838 (syscall)</li> </ul>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#futex-fast-userspace-mutexes","title":"Futex: Fast Userspace muTexes","text":"<p>pthread_mutex \u5e95\u5c42\u5b9e\u73b0\uff0c\u91c7\u7528\u7684\u662f futex \u5b9e\u73b0\u3002</p> <ul> <li>Fast path: \u4e00\u6761\u539f\u5b50\u6307\u4ee4\uff0c\u4e0a\u9501\u6210\u529f\u7acb\u5373\u8fd4\u56de</li> <li>Slow path: \u4e0a\u9501\u5931\u8d25\uff0c\u6267\u884c\u7cfb\u7edf\u8c03\u7528\u7761\u7720</li> <li>\u6027\u80fd\u4f18\u5316\u7684\u6700\u5e38\u89c1\u6280\u5de7<ul> <li>\u770b average (frequent) case \u800c\u4e0d\u662f worst case</li> </ul> </li> </ul> <p>POSIX \u7ebf\u7a0b\u5e93\u4e2d\u7684\u4e92\u65a5\u9501 (<code>pthread_mutex</code>)</p> <ul> <li> <p>\u901a\u8fc7 <code>strace -f</code> \u67e5\u770b\u7cfb\u7edf\u8c03\u7528\uff0c\u53d1\u73b0 <code>pthread_mutex</code>\u5177\u5907\u5f88\u591a\u7684 <code>futex</code>\u7cfb\u7edf\u8c03\u7528\uff1b</p> </li> <li> <p>gdb \u8c03\u8bd5</p> </li> <li><code>set scheduler-locking on</code>, <code>info threads</code>, <code>thread X</code></li> </ul>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#lock","title":"\u9644\uff1aLock \u6307\u4ee4\u7684\u73b0\u4ee3\u5b9e\u73b0","text":"<p>\u5728 L1 cache \u5c42\u4fdd\u6301\u4e00\u81f4\u6027 (ring/mesh bus)</p> <ul> <li>\u76f8\u5f53\u4e8e\u6bcf\u4e2a cache line \u6709\u5206\u522b\u7684\u9501</li> <li><code>store(x)</code> \u8fdb\u5165 L1 \u7f13\u5b58\u5373\u4fdd\u8bc1\u5bf9\u5176\u4ed6\u5904\u7406\u5668\u53ef\u89c1</li> <li>\u4f46\u8981\u5c0f\u5fc3 store buffer \u548c\u4e71\u5e8f\u6267\u884c</li> </ul> <p>L1 cache line \u6839\u636e\u72b6\u6001\u8fdb\u884c\u534f\u8c03</p> <ul> <li>M (Modified)\uff0c \u810f\u503c</li> <li>E (Exclusive)\uff0c\u72ec\u5360\u8bbf\u95ee</li> <li>S (Shared)\uff0c\u53ea\u8bfb\u5171\u4eab</li> <li>I (Invalid)\uff0c\u4e0d\u62e5\u6709 cache line</li> </ul> <p>Load-Reserved/Store-Conditional (LR/SC)\uff1aRISC-V\uff0c \u53e6\u4e00\u79cd\u539f\u5b50\u64cd\u4f5c\u7684\u8bbe\u8ba1</p> <ul> <li>LR: \u5728\u5185\u5b58\u4e0a\u6807\u8bb0 reserved (\u76ef\u4e0a\u4f60\u4e86)\uff0c\u4e2d\u65ad\u3001\u5176\u4ed6\u5904\u7406\u5668\u5199\u5165\u90fd\u4f1a\u5bfc\u81f4\u6807\u8bb0\u6d88\u9664\uff1b</li> <li>SC: \u5982\u679c \u201c\u76ef\u4e0a\u201d \u672a\u88ab\u89e3\u9664\uff0c\u5219\u5199\u5165\u3002</li> <li>\u786c\u4ef6\u5b9e\u73b0\uff1aBOOM (Berkeley Out-of-Order Processor)</li> </ul>"},{"location":"courses/os_lab/07_concurrent_control_mutex.html#_12","title":"\u8bfe\u540e\u4e60\u9898","text":""},{"location":"courses/os_lab/07_concurrent_control_mutex.html#1","title":"1. \u9605\u8bfb\u6750\u6599","text":"<p>\u6559\u79d1\u4e66 Operating Systems: Three Easy Pieces</p> <ul> <li>\u7b2c 28 \u7ae0 - Locks</li> </ul> <p>Futexes are tricky</p>"},{"location":"courses/os_lab/08_debug_and_action.html","title":"\u8c03\u8bd5\u7406\u8bba\u4e0e\u5b9e\u8df5","text":"<p>\u80cc\u666f\u56de\u987e\uff1a\u5728\u5feb\u8282\u594f\u7684\u300a\u64cd\u4f5c\u7cfb\u7edf\u300b\u8bfe\u4e2d\uff0c\u63d2\u5165\u4e00\u4e9b (\u91cd\u8981\u5f97\u8981\u547d\u4f46\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u4e0d\u5b8c\u5168\u76f8\u5173\u7684) \u4f11\u95f2\u5185\u5bb9\u3002</p> <p>\u672c\u8bb2\u5185\u5bb9\uff1a\u8c03\u8bd5\u7406\u8bba\uff1aFault, Error \u548c Failure\uff1bGDB \u4f7f\u7528\u6280\u5de7\u3002</p>"},{"location":"courses/os_lab/08_debug_and_action.html#_2","title":"\u8c03\u8bd5\u7406\u8bba","text":"<p>\u673a\u5668\u6c38\u8fdc\u662f\u5bf9\u7684</p> <p>\u4e0d\u7ba1\u662f crash \u4e86\uff0cWrong Answer \u4e86\uff0c\u8fd8\u662f\u865a\u62df\u673a\u795e\u79d8\u91cd\u542f\uff0c\u90fd\u662f\u81ea\u5df1\u80cc\u9505</p> <p>\u672a\u6d4b\u4ee3\u7801\u6c38\u8fdc\u662f\u9519\u7684</p> <p>\u4f60\u4ee5\u4e3a\u6700\u4e0d\u53ef\u80fd\u51fa bug \u7684\u5730\u65b9\uff0c\u5f80\u5f80 bug \u5c31\u5728\u90a3\u8eba\u7740</p>"},{"location":"courses/os_lab/08_debug_and_action.html#_3","title":"\u8c03\u8bd5\u56f0\u96be\u7684\u6839\u672c\u539f\u56e0","text":"<p>bug \u7684\u89e6\u53d1\u7ecf\u5386\u4e86\u6f2b\u957f\u7684\u8fc7\u7a0b</p> <ul> <li>\u9700\u6c42 \u2192 \u8bbe\u8ba1 \u2192 \u4ee3\u7801 (\u72b6\u6001\u673a) \u2192 Fault (bug) \u2192 Error (\u7a0b\u5e8f\u72b6\u6001\u9519) \u2192 Failure</li> <li>\u6211\u4eec\u53ea\u80fd\u89c2\u6d4b\u5230 failure (\u53ef\u89c2\u6d4b\u7684\u7ed3\u679c\u9519)</li> <li>\u6211\u4eec\u53ef\u4ee5\u68c0\u67e5\u72b6\u6001\u7684\u6b63\u786e\u6027 (\u4f46\u975e\u5e38\u8d39\u65f6)</li> <li>\u65e0\u6cd5\u9884\u77e5 bug \u5728\u54ea\u91cc (\u6bcf\u4e00\u884c \u201c\u770b\u8d77\u6765\u201d \u90fd\u633a\u5bf9\u7684)</li> </ul> <p></p>"},{"location":"courses/os_lab/08_debug_and_action.html#_4","title":"\u8c03\u8bd5\u7406\u8bba\u548c\u5b9e\u9645\u8c03\u8bd5","text":"<p>\u8c03\u8bd5\u7406\u8bba\uff1a\u5982\u679c\u6211\u4eec\u80fd\u5224\u5b9a\u4efb\u610f\u7a0b\u5e8f\u72b6\u6001\u7684\u6b63\u786e\u6027\uff0c\u90a3\u4e48\u7ed9\u5b9a\u4e00\u4e2a failure\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e8c\u5206\u67e5\u627e\u5b9a\u4f4d\u5230\u7b2c\u4e00\u4e2a error \u7684\u72b6\u6001\uff0c\u6b64\u65f6\u7684\u4ee3\u7801\u5c31\u662f fault (bug)\u3002</p> <p>\u4e3a\u4ec0\u4e48\u6211\u4eec\u559c\u6b22 \u201c\u5355\u6b65\u8c03\u8bd5\u201d\uff1f</p> <ul> <li>\u4ece\u4e00\u4e2a\u5047\u5b9a\u6b63\u786e\u7684\u72b6\u6001\u51fa\u53d1</li> <li>\u6bcf\u4e2a\u8bed\u53e5\u7684\u884c\u4e3a\u6709\u9650\uff0c\u5bb9\u6613\u5224\u5b9a\u662f\u5426\u662f error</li> </ul> <p>\u4e3a\u4ec0\u4e48\u8c03\u8bd5\u7406\u8bba\u770b\u8d77\u6765\u5f88\u6ca1\u7528\uff1f</p> <ul> <li>\u56e0\u4e3a\u5224\u5b9a\u7a0b\u5e8f\u72b6\u6001\u7684\u6b63\u786e\u6027\u975e\u5e38\u56f0\u96be</li> </ul> <p>\u5b9e\u9645\u4e2d\u7684\u8c03\u8bd5\uff1a\u89c2\u5bdf\u72b6\u6001\u673a\u6267\u884c (trace) \u7684\u67d0\u4e2a\u4fa7\u9762</p> <ul> <li>\u7f29\u5c0f\u9519\u8bef\u72b6\u6001 (error) \u53ef\u80fd\u4ea7\u751f\u7684\u4f4d\u7f6e</li> <li>\u4f5c\u51fa\u9002\u5f53\u7684\u5047\u8bbe</li> <li>\u518d\u8fdb\u884c\u7ec6\u7c92\u5ea6\u7684\u5b9a\u4f4d\u548c\u8bca\u65ad</li> </ul> <p>\u6700\u91cd\u8981\u7684\u4e24\u4e2a\u5de5\u5177</p> <ul> <li>printf \u2192 \u81ea\u5b9a\u4e49 log \u7684 trace\uff0c\u7528\u4e8e\u68c0\u6d4b\u72b6\u6001\u662f\u5426\u6b63\u786e</li> <li>\u7075\u6d3b\u53ef\u63a7\u3001\u80fd\u5feb\u901f\u5b9a\u4f4d\u95ee\u9898\u5927\u6982\u4f4d\u7f6e\u3001\u9002\u7528\u4e8e\u5927\u578b\u8f6f\u4ef6</li> <li>\u65e0\u6cd5\u7cbe\u786e\u5b9a\u4f4d\u3001\u5927\u91cf\u7684 logs \u7ba1\u7406\u8d77\u6765\u6bd4\u8f83\u9ebb\u70e6</li> <li>gdb \u2192 \u6307\u4ee4/\u8bed\u53e5\u7ea7 trace</li> <li>\u7cbe\u786e\u3001\u6307\u4ee4\u7ea7\u5b9a\u4f4d\u3001\u4efb\u610f\u67e5\u770b\u7a0b\u5e8f\u5185\u90e8\u72b6\u6001</li> <li>\u8017\u8d39\u5927\u91cf\u65f6\u95f4</li> </ul>"},{"location":"courses/os_lab/08_debug_and_action.html#_5","title":"\u8c03\u8bd5 \u201c\u4efb\u4f55\u95ee\u9898\u201d","text":""},{"location":"courses/os_lab/08_debug_and_action.html#_6","title":"\u8ba1\u7b97\u673a\u4e16\u754c\uff1a\u4e00\u5207\u7686\u53ef\u8c03\u8bd5","text":"<p>\u7a0b\u5e8f = \u8ba1\u7b97\u673a\u7cfb\u7edf = \u72b6\u6001\u673a</p> <ul> <li>\u673a\u5668\u6c38\u8fdc\u662f\u5bf9\u7684</li> <li>UNIX \u4e16\u754c\u91cc\u4f60\u505a\u4efb\u4f55\u4e8b\u60c5\u90fd\u662f\u5728\u7f16\u7a0b</li> <li>\u56e0\u6b64\u914d\u7f6e\u9519\u3001make \u9519\u7b49\uff0c\u90fd\u662f\u7a0b\u5e8f\u6216\u8f93\u5165/\u914d\u7f6e\u6709 bug</li> <li>(\u8f93\u5165/\u914d\u7f6e\u53ef\u4ee5\u770b\u6210\u662f\u7a0b\u5e8f\u7684\u4e00\u90e8\u5206)</li> </ul> <p>\u6240\u6709\u95ee\u9898\u90fd\u53ef\u4ee5\u7528\u8c03\u8bd5\u7406\u8bba\u89e3\u51b3</p> <ul> <li>\u4f60\u5199\u4e86\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u73b0\u5728\u8fd9\u4e2a\u7a0b\u5e8f\u51fa bug \u4e86 (\u4f8b\u5982 Segmentation Fault)\uff0c\u4f60\u662f\u600e\u6837\u6392\u67e5\u8fd9\u4e2a\u95ee\u9898\u7684\uff1f</li> <li>curl: command not found</li> <li><code>'sys/cdefs.h'</code>: No such file or directory</li> <li>make: run: No such file or directory</li> </ul>"},{"location":"courses/os_lab/08_debug_and_action.html#_7","title":"\u4f7f\u7528\u8c03\u8bd5\u7406\u8bba","text":"<p>Debug (fault localization) \u7684\u57fa\u672c\u7406\u8bba\u56de\u987e\uff1a</p> <ul> <li>Fault (\u7a0b\u5e8f/\u8f93\u5165/\u914d\u7f6e\u9519) \u2192 Error \u2192 Failure (\u53ef\u89c2\u6d4b)</li> <li>\u7edd\u5927\u90e8\u5206\u5de5\u5177\u7684 Failure \u90fd\u6709 \u201c\u539f\u56e0\u62a5\u544a\u201d<ul> <li>\u56e0\u6b64\u80fd\u5e2e\u52a9\u4f60\u5feb\u901f\u5b9a\u4f4d fault</li> </ul> </li> <li><code>man perror</code>\uff1a\u6807\u51c6\u5e93\u6709\u6253\u5370 error message \u7684\u51fd\u6570</li> </ul> <p>\u5982\u679c\u95ee\u9898\u4e0d\u80fd\u5e2e\u4f60\u5b9a\u4f4d\u5230 fault/error\uff1f</p> <ul> <li>\u51fa\u9519\u539f\u56e0\u62a5\u544a\u4e0d\u51c6\u786e\u6216\u4e0d\u591f\u8be6\u7ec6</li> <li>\u7a0b\u5e8f\u6267\u884c\u7684\u8fc7\u7a0b\u4e0d\u591f\u8be6\u7ec6</li> <li>\u65e2\u7136\u6211\u4eec\u6709\u9700\u6c42\uff0c\u90a3\u522b\u4eba\u80af\u5b9a\u4e5f\u4f1a\u6709\u8fd9\u4e2a\u9700\u6c42<ul> <li>\u4e00\u5b9a\u6709\u4fe1\u606f\u80fd\u5e2e\u52a9\u6211\u4eec\uff01</li> </ul> </li> </ul> <p>\u6b63\u786e\u7684\u65b9\u6cd5\uff1a\u7406\u89e3\u7a0b\u5e8f (\u72b6\u6001\u673a) \u7684\u6267\u884c\u8fc7\u7a0b</p> <ul> <li><code>ssh</code>\uff1a\u4f7f\u7528 <code>-v</code> \u9009\u9879\u68c0\u67e5\u65e5\u5fd7</li> <li><code>gcc</code>\uff1a\u4f7f\u7528 <code>-v</code> \u9009\u9879\u6253\u5370\u5404\u79cd\u8fc7\u7a0b</li> <li><code>make</code>\uff1a\u4f7f\u7528 <code>-n</code>\u9009\u9879\u67e5\u770b\u5b8c\u6574\u547d\u4ee4</li> <li><code>make -nB | grep -ve '^\\(echo\\|mkdir\\)'</code> \u53ef\u4ee5\u67e5\u770b\u5b8c\u6574\u7f16\u8bd1 nemu \u7684\u7f16\u8bd1\u8fc7\u7a0b</li> </ul> <p>\u5404\u4e2a\u5de5\u5177\u666e\u904d\u63d0\u4f9b\u8c03\u8bd5\u529f\u80fd\uff0c\u5e2e\u52a9\u7528\u6237/\u5f00\u53d1\u8005\u4e86\u89e3\u7a0b\u5e8f\u7684\u884c\u4e3a</p>"},{"location":"courses/os_lab/08_debug_and_action.html#syscdefsh","title":"\u4f8b\u5b50\uff1a\u627e\u4e0d\u5230 <code>sys/cdefs.h</code>","text":"<p><code>'sys/cdefs.h': No such file or directory</code>\uff0c\u627e\u4e0d\u5230\u6587\u4ef6</p> <ul> <li><code>#include</code> = \u590d\u5236\u7c98\u8d34\uff0c\u81ea\u7136\u4f1a\u7ecf\u8fc7\u8def\u5f84\u89e3\u6790</li> <li>(\u6298\u817e20\u5206\u949f) \u660e\u660e <code>/usr/include/x86_64-linux-gnu/sys/cdefs.h</code> \u662f\u5b58\u5728\u7684 (<code>man 1 locate</code>) \u2192 \u6781\u5ea6\u632b\u8d25\uff0c\u4f53\u9a8c\u6781\u5dee</li> </ul> <p>\u63a8\u7406\uff1a<code>#include &lt;&gt;</code> \u4e00\u5b9a\u6709\u4e00\u4e9b\u641c\u7d22\u8def\u5f84</p> <ul> <li>\u4e3a\u4ec0\u4e48\u4e24\u4e2a\u7f16\u8bd1\u9009\u9879\uff0c\u4e00\u4e2a\u901a\u8fc7\uff0c\u4e00\u4e2a\u4e0d\u901a\u8fc7\uff1f</li> <li><code>gcc -m32 -v</code> v.s. <code>gcc -v</code></li> </ul> <p>\u8fd9\u662f\u6807\u51c6\u7684\u89e3\u51b3\u95ee\u9898\u529e\u6cd5\uff1a\u81ea\u5df1\u52a8\u624b\u6392\u67e5</p> <ul> <li>\u5728\u9762\u5bf9\u590d\u6742/\u5c0f\u4f17\u95ee\u9898\u65f6\u6bd4 STFW/ChatGPT \u6709\u6548</li> </ul>"},{"location":"courses/os_lab/08_debug_and_action.html#gdb","title":"\u4f7f\u7528 GDB \u8c03\u8bd5\u7a0b\u5e8f","text":""},{"location":"courses/os_lab/08_debug_and_action.html#gdb_1","title":"GDB: \u5165\u95e8","text":"<p>GDB: \u6700\u5e38\u7528\u7684\u547d\u4ee4\u5728 gdb cheat sheet</p> <ul> <li>\u6253\u5370\u8d34\u5728\u7535\u8111\u524d\uff0c\u8c03\u8bd5\u65f6\u5019\u770b\u4e00\u904d\uff0c\u5f88\u5feb\u5c31\u5927\u81f4\u8bb0\u4f4f\u4e86</li> </ul> <p>\u60f3\u8981\u66f4\u597d\u7684\u4f53\u9a8c\uff1f</p> <ul> <li>GDB \u672c\u8eab\u4e5f\u662f\u4e00\u4e2a\u7f16\u7a0b\u8bed\u8a00</li> <li>\u5b83\u751a\u81f3\u652f\u6301 Python</li> <li>\u53ef\u4ee5\u6267\u884c\u4e00\u4e9b\u521d\u59cb\u5316\u4ee3\u7801 (-x)</li> <li>\u53ef\u4ee5\u53cd\u5411\u6267\u884c\uff08\u975e\u786e\u5b9a\u6027\u5c40\u9650\u5728\u5c40\u90e8\uff09</li> <li>\u5e93\u51fd\u6570\u4e5f\u662f\u4ee3\u7801</li> <li>directory \u547d\u4ee4\u589e\u52a0\u6e90\u7801\u8def\u5f84</li> <li>GDB \u6709\u8bb8\u591a\u524d\u7aef</li> <li>cgdb, pwndbg, vscode, ...</li> <li>RTFM - M \u6bd4 ChatGPT \u597d\u7528\u5728\u4e8e\u5b83\u4e0d\u9700\u8981 prompt \u4e14\u5168\u9762</li> </ul>"},{"location":"courses/os_lab/08_debug_and_action.html#futex-fast-userspace-mutexes","title":"\ud83c\udf36\ufe0f Futex: Fast Userspace muTexes","text":"<p>\u8c03\u8bd5 POSIX \u7ebf\u7a0b\u5e93\u4e2d\u7684\u4e92\u65a5\u9501 (<code>pthread_mutex</code>)</p> <ul> <li>\u89c2\u5bdf\u7ebf\u7a0b\u5e93\u4e2d\u7684 lock/unlock \u884c\u4e3a\uff08GDB \u8c03\u8bd5\uff0c\u8bbe\u7f6e\u53ea\u6709\u5f53\u524d\u7ebf\u7a0b\u6267\u884c\uff09</li> <li>Mutex \u6ca1\u6709\u4e89\u62a2\u7684\u60c5\u51b5\uff08\u5f53\u524d\u7ebf\u7a0b\u6267\u884c\uff09<ul> <li>\u6ca1\u6709 syscall</li> </ul> </li> <li>Mutex \u6709\u4e89\u62a2\u7684\u60c5\u51b5\uff08\u5f53\u524d\u7ebf\u7a0b\u672a\u91ca\u653e\u9501\u65f6\uff0c\u5207\u6362\u5230\u53e6\u5916\u4e00\u4e2a\u7ade\u4e89\u7ebf\u7a0b\u6267\u884c\uff09<ul> <li>syscall 0xca\uff08futex \u7cfb\u7edf\u8c03\u7528\uff09</li> </ul> </li> </ul>"},{"location":"courses/os_lab/08_debug_and_action.html#_8","title":"\u8c03\u8bd5\u7406\u8bba\uff1a\u5e94\u7528","text":"<p>\u9700\u6c42 \u2192 \u8bbe\u8ba1 \u2192 \u4ee3\u7801 \u2192 Fault \u2192 Error \u2192 Failure</p> <p>\u201cTechnical Debt\u201d</p> <p>\u6bcf\u5f53\u4f60\u5199\u51fa\u4e0d\u597d\u7ef4\u62a4\u7684\u4ee3\u7801\uff0c\u4f60\u90fd\u5728\u7ed9\u4f60\u672a\u6765\u7684\u8c03\u8bd5/\u9700\u6c42\u53d8\u66f4\u6316\u5751\u3002</p>"},{"location":"courses/os_lab/08_debug_and_action.html#_9","title":"\u7f16\u7a0b\u57fa\u672c\u51c6\u5219\uff1a\u56de\u987e","text":"<p>Programs are meant to be read by humans (AIs) and only incidentally for computers to execute. \u2014 D. E. Knuth</p> <p>(\u7a0b\u5e8f\u9996\u5148\u662f\u62ff\u7ed9\u4eba\u8bfb\u7684\uff0c\u5176\u6b21\u624d\u662f\u88ab\u673a\u5668\u6267\u884c\u3002)</p> <p>\u597d\u7684\u7a0b\u5e8f</p> <p></p> <ul> <li>\u4e0d\u8a00\u81ea\u660e\uff1a\u80fd\u77e5\u9053\u662f\u505a\u4ec0\u4e48\u7684 (specification)</li> <li> <p>\u56e0\u6b64\u4ee3\u7801\u98ce\u683c\u5f88\u91cd\u8981</p> </li> <li> <p>\u4e0d\u8a00\u81ea\u8bc1\uff1a\u80fd\u786e\u8ba4\u4ee3\u7801\u548c specification \u4e00\u81f4</p> </li> <li> <p>\u56e0\u6b64\u4ee3\u7801\u4e2d\u7684\u903b\u8f91\u6d41\u5f88\u91cd\u8981</p> </li> <li> <p>\u4eba\u7c7b\u65b0\u7eaa\u5143\u7684\u8bc4\u5224\u6807\u51c6</p> </li> <li>AI \u662f\u5426\u80fd\u6b63\u786e\u7406\u89e3/\u7ef4\u62a4\u4f60\u7684\u4ee3\u7801</li> </ul>"},{"location":"courses/os_lab/08_debug_and_action.html#_10","title":"\u8c03\u8bd5\u7406\u8bba\u7684\u6700\u91cd\u8981\u5e94\u7528","text":"<p>\u5199\u597d\u8bfb\u3001\u6613\u9a8c\u8bc1\u7684\u4ee3\u7801</p> <p>\u5728\u4ee3\u7801\u4e2d\u6dfb\u52a0\u66f4\u591a\u7684\u65ad\u8a00 (assertions)</p> <p>\u65ad\u8a00\u7684\u610f\u4e49\uff1a\u628a\u4ee3\u7801\u4e2d\u9690\u85cf\u7684 specification \u5199\u51fa\u6765</p> <ul> <li>Fault \u2192 Error (\u9760\u6d4b\u8bd5)</li> <li>Error \u2192 Failure (\u9760\u65ad\u8a00)</li> <li>Error \u66b4\u9732\u7684\u8d8a\u665a\uff0c\u8d8a\u96be\u8c03\u8bd5</li> <li>\u8ffd\u6eaf\u5bfc\u81f4 assert failure \u7684\u53d8\u91cf\u503c (slice) \u901a\u5e38\u53ef\u4ee5\u5feb\u901f\u5b9a\u4f4d\u5230 bug</li> </ul> <p>\u793a\u4f8b\uff1a\u7ef4\u62a4\u7236\u4eb2\u8282\u70b9\u7684\u5e73\u8861\u6811</p> <p></p> <pre><code>// \u7ed3\u6784\u7ea6\u675f\nassert(u-&gt;parent == u ||\n       u-&gt;parent-&gt;left  == u ||\n       u-&gt;parent-&gt;right == u);\nassert(!u-&gt;left  || u-&gt;left-&gt;parent  == u);\nassert(!u-&gt;right || u-&gt;right-&gt;parent == u);\n\n// \u6570\u503c\u7ea6\u675f\nassert(!u-&gt;left  || u-&gt;left-&gt;val  &lt; u-&gt;val);\nassert(!u-&gt;right || u-&gt;right-&gt;val &gt; u-&gt;val);\n</code></pre>"},{"location":"courses/os_lab/08_debug_and_action.html#_11","title":"\u66f4\u591a\u7684\u65ad\u8a00","text":"<p>\u6bcf\u4e00\u6b21\u6307\u9488\u8bbf\u95ee\u65f6\uff0c\u90fd\u589e\u52a0\u4e00\u4e2a\u65ad\u8a00</p> <ul> <li><code>assert(obj-&gt;low &lt;= ptr &amp;&amp; ptr &lt; obj-&gt;high);</code></li> </ul> <p>\u795e\u5947\u7684\u7f16\u8bd1\u9009\u9879\uff1a<code>-fsanitize=address</code></p> <ul> <li>Address Sanitizer(asan)\uff1a \u201c\u52a8\u6001\u7a0b\u5e8f\u5206\u6790\u201d\uff0c\u63d0\u4f9b\u4e86\u5185\u5b58\u8bbf\u95ee (\u4f8b\u5982\u6570\u7ec4\u8d8a\u754c) \u7684\u989d\u5916\u68c0\u67e5\u3002</li> </ul>"},{"location":"courses/os_lab/09_sync_condition.html","title":"\u5e76\u53d1\u63a7\u5236\uff1a\u540c\u6b65\uff081\uff09","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a\u5e76\u53d1\u63a7\u5236\uff1a\u540c\u6b65</p> <ul> <li>\u540c\u6b65\u95ee\u9898\u7684\u5b9a\u4e49</li> <li>\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u95ee\u9898</li> <li>\u6761\u4ef6\u53d8\u91cf</li> </ul>"},{"location":"courses/os_lab/09_sync_condition.html#_1","title":"\u540c\u6b65\u95ee\u9898","text":""},{"location":"courses/os_lab/09_sync_condition.html#synchronization","title":"\u540c\u6b65 (Synchronization)","text":"<p>\u4e24\u4e2a\u6216\u4e24\u4e2a\u4ee5\u4e0a\u968f\u65f6\u95f4\u53d8\u5316\u7684\u91cf\u5728\u53d8\u5316\u8fc7\u7a0b\u4e2d\u4fdd\u6301\u4e00\u5b9a\u7684\u76f8\u5bf9\u5173\u7cfb</p> <ul> <li>\u540c\u6b65\u7535\u8def (\u4e00\u4e2a\u65f6\u949f\u63a7\u5236\u6240\u6709\u89e6\u53d1\u5668) </li> <li>iPhone/iCloud \u540c\u6b65 (\u624b\u673a vs \u7535\u8111 vs \u4e91\u7aef)</li> <li>\u53d8\u901f\u7bb1\u540c\u6b65\u5668 (\u5408\u5e76\u5feb\u6162\u901f\u9f7f\u8f6e) </li> <li>\u540c\u6b65\u7535\u673a (\u8f6c\u5b50\u4e0e\u78c1\u573a\u8f6c\u901f\u4e00\u81f4) </li> <li>\u540c\u6b65\u7535\u8def (\u6240\u6709\u89e6\u53d1\u5668\u5728\u8fb9\u6cbf\u540c\u65f6\u89e6\u53d1)</li> </ul> <p>\u5f02\u6b65 (Asynchronous) = \u4e0d\u9700\u8981\u540c\u6b65</p> <ul> <li>\u4e0a\u8ff0\u5f88\u591a\u4f8b\u5b50\u90fd\u6709\u5f02\u6b65\u7248\u672c (\u5f02\u6b65\u7535\u673a\u3001\u5f02\u6b65\u7535\u8def\u3001\u5f02\u6b65\u7ebf\u7a0b)</li> </ul>"},{"location":"courses/os_lab/09_sync_condition.html#_2","title":"\u5e76\u53d1\u7a0b\u5e8f\u4e2d\u7684\u540c\u6b65","text":"<p>\u5e76\u53d1\u7a0b\u5e8f\u7684\u6b65\u8c03\u5f88\u96be\u4fdd\u6301 \u201c\u5b8c\u5168\u4e00\u81f4\u201d</p> <ul> <li>\u7ebf\u7a0b\u540c\u6b65\uff1a\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u5171\u540c\u8fbe\u5230\u4e92\u76f8\u5df2\u77e5\u7684\u72b6\u6001</li> </ul>"},{"location":"courses/os_lab/09_sync_condition.html#-","title":"\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u95ee\u9898","text":"<p>99% \u7684\u5b9e\u9645\u5e76\u53d1\u95ee\u9898\u90fd\u53ef\u4ee5\u7528\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u89e3\u51b3\u3002</p> <p>\u5e76\u884c\u8ba1\u7b97\u57fa\u7840\uff1a\u8ba1\u7b97\u56fe</p> <ul> <li>\u8ba1\u7b97\u4efb\u52a1\u6784\u6210\u6709\u5411\u65e0\u73af\u56fe</li> <li>(u,v)\u2208E \u8868\u793a v \u8981\u7528\u5230\u524d u \u7684\u503c</li> <li>\u53ea\u8981\u8c03\u5ea6\u5668 (\u751f\u4ea7\u8005) \u5206\u914d\u4efb\u52a1\u6548\u7387\u591f\u9ad8\uff0c\u7b97\u6cd5\u5c31\u80fd\u5e76\u884c</li> <li>\u751f\u4ea7\u8005\u628a\u4efb\u52a1\u653e\u5165\u961f\u5217\u4e2d</li> <li>\u6d88\u8d39\u8005 (workers) \u4ece\u961f\u5217\u4e2d\u53d6\u51fa\u4efb\u52a1</li> </ul> <p>\u793a\u4f8b\uff1a\u62ec\u53f7\u6253\u5370</p> <pre><code>void Tproduce() { while (1) printf(\"(\"); }\nvoid Tconsume() { while (1) printf(\")\"); }\n</code></pre> <p>\u5728 <code>printf</code> \u524d\u540e\u589e\u52a0\u4ee3\u7801\uff0c\u4f7f\u5f97\u6253\u5370\u7684\u62ec\u53f7\u5e8f\u5217\u6ee1\u8db3</p> <ul> <li>\u4e00\u5b9a\u662f\u67d0\u4e2a\u5408\u6cd5\u62ec\u53f7\u5e8f\u5217\u7684\u524d\u7f00</li> <li>\u62ec\u53f7\u5d4c\u5957\u7684\u6df1\u5ea6\u4e0d\u8d85\u8fc7</li> <li>n=3, <code>((())())(((</code> \u5408\u6cd5</li> <li>n=3, <code>(((())))(()))</code> \u4e0d\u5408\u6cd5</li> </ul>"},{"location":"courses/os_lab/09_sync_condition.html#-_1","title":"\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u95ee\u9898\uff1a\u5b9e\u73b0","text":"<p>\u7528\u4e92\u65a5\u9501\u5b9e\u73b0\u62ec\u53f7\u95ee\u9898\uff1a</p> <ul> <li>\u5de6\u62ec\u53f7\uff1a\u5d4c\u5957\u6df1\u5ea6 (\u961f\u5217) \u4e0d\u8db3 n* \u65f6\u624d\u80fd\u6253\u5370</li> <li>\u53f3\u62ec\u53f7\uff1a\u5d4c\u5957\u6df1\u5ea6 (\u961f\u5217) &gt;1 \u65f6\u624d\u80fd\u6253\u5370</li> <li>\u5f53\u7136\u662f\u7b49\u5230\u6ee1\u8db3\u6761\u4ef6\u65f6\u518d\u6253\u5370\u4e86(\u4ee3\u7801\u6f14\u793a)</li> <li>\u7528\u4e92\u65a5\u9501\u4fdd\u6301\u6761\u4ef6\u6210\u7acb\uff1a\u4f1a\u51fa\u73b0\u65e0\u7528\u7684\u7533\u8bf7\u9501-&gt;\u91ca\u653e\uff0cCPU\u8d44\u6e90\u6d6a\u8d39</li> </ul> <p>\u6d4b\u8bd5\u7528\u4f8b\u548c\u68c0\u67e5\u5de5\u5177\uff0c\u8bc4\u4f30\u5e76\u53d1\u7a0b\u5e8f\u7684\u6b63\u786e\u6027\u3002</p>"},{"location":"courses/os_lab/09_sync_condition.html#_3","title":"\u6761\u4ef6\u53d8\u91cf","text":""},{"location":"courses/os_lab/09_sync_condition.html#_4","title":"\u540c\u6b65\u95ee\u9898\uff1a\u5206\u6790","text":"<p>\u7ebf\u7a0b\u540c\u6b65\u7531\u6761\u4ef6\u4e0d\u6210\u7acb\u7b49\u5f85\u548c\u540c\u6b65\u6761\u4ef6\u8fbe\u6210\u7ee7\u7eed\u6784\u6210\u3002</p> <p>\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u95ee\u9898</p> <ul> <li>Tproduce \u540c\u6b65\u6761\u4ef6\uff1a<code>CAN_PRODUCE (count &lt; n)</code></li> <li>Tproduce \u8fbe\u6210\u540c\u6b65\uff1aTconsume <code>count--</code></li> <li>Tconsume \u540c\u6b65\u6761\u4ef6\uff1a<code>CAN_CONSUME (count &gt; 0)</code></li> <li>Tconsume \u8fbe\u6210\u540c\u6b65\uff1aTproduce <code>count++</code></li> </ul>"},{"location":"courses/os_lab/09_sync_condition.html#api","title":"\u7406\u60f3\u4e2d\u7684\u540c\u6b65 API","text":"<pre><code>wait_until(CAN_PRODUCE) {\n  count++;\n  printf(\"(\");\n}\n\nwait_until(CAN_CONSUME) {\n  count--;\n  printf(\")\");\n}\n</code></pre> <p>\u82e5\u5e72\u5b9e\u73b0\u4e0a\u7684\u96be\u9898</p> <ul> <li>\u6b63\u786e\u6027\uff1a\u5927\u62ec\u53f7\u5185\u4ee3\u7801\u6267\u884c\u65f6\uff0c\u5176\u4ed6\u7ebf\u7a0b\u4e0d\u5f97\u7834\u574f\u7b49\u5f85\u7684\u6761\u4ef6</li> <li>\u6027\u80fd</li> <li>\u4e0d\u80fd spin check \u6761\u4ef6\u8fbe\u6210</li> <li>\u5df2\u7ecf\u5728\u7b49\u5f85\u7684\u7ebf\u7a0b\u600e\u4e48\u77e5\u9053\u6761\u4ef6\u88ab\u6ee1\u8db3\uff1f</li> </ul>"},{"location":"courses/os_lab/09_sync_condition.html#_5","title":"\u6761\u4ef6\u53d8\u91cf\uff1a\u7406\u60f3\u4e0e\u5b9e\u73b0\u4e4b\u95f4\u7684\u6298\u8877","text":"<p>\u4e00\u628a\u4e92\u65a5\u9501 + \u4e00\u4e2a \u201c\u6761\u4ef6\u53d8\u91cf\u201d + \u624b\u5de5\u5524\u9192</p> <ul> <li><code>wait(cv, mutex)</code></li> <li>\u8c03\u7528\u65f6\u5fc5\u987b\u4fdd\u8bc1\u5df2\u7ecf\u83b7\u5f97 mutex</li> <li>wait \u91ca\u653e mutex\u3001\u8fdb\u5165\u7761\u7720\u72b6\u6001</li> <li>\u88ab\u5524\u9192\u540e\u9700\u8981\u91cd\u65b0\u6267\u884c lock(mutex)</li> <li><code>signal/notify(cv)</code>\uff1a\u968f\u673a\u79c1\u4fe1\u4e00\u4e2a\u7b49\u5f85\u8005\uff1a\u9192\u9192</li> <li>\u5982\u679c\u6709\u7ebf\u7a0b\u6b63\u5728\u7b49\u5f85 cv\uff0c\u5219\u5524\u9192\u5176\u4e2d\u4e00\u4e2a\u7ebf\u7a0b</li> <li><code>broadcast/notifyAll(cv)</code>\uff1a  \u53eb\u9192\u6240\u6709\u4eba</li> <li>\u5524\u9192\u5168\u90e8\u6b63\u5728\u7b49\u5f85 cv \u7684\u7ebf\u7a0b</li> </ul>"},{"location":"courses/os_lab/09_sync_condition.html#-_2","title":"\u6761\u4ef6\u53d8\u91cf\uff1a\u5b9e\u73b0\u751f\u4ea7\u8005-\u6d88\u8d39\u8005","text":"<p>\u4ee3\u7801\u6f14\u793a &amp; \u538b\u529b\u6d4b\u8bd5 &amp; \u6a21\u578b\u68c0\u9a8c</p> <ul> <li>\u9519\u8bef\u7684\u793a\u4f8b\uff08\u4e0b\u9762\u7684\u4ee3\u7801\uff09\uff1a</li> <li>\u6761\u4ef6\u5224\u7b49\u7684\u65f6\u5019\uff0c\u9700\u8981\u7528 while\uff08\u9632\u6b62\u4ee3\u7801\u7684\u9519\u8bef\u5524\u9192\u6216\u8005os\u7684\u5047\u5524\u9192\uff09\uff1b</li> <li>\u9700\u8981\u4e24\u4e2a\u6761\u4ef6\u53d8\u91cf\uff0cTproduce \u53ea\u5e0c\u671b\u5524\u9192\u6d88\u8d39\u8005\uff1bTconsume \u53ea\u5e0c\u671b\u5524\u9192\u751f\u4ea7\u8005\uff0c\u9632\u6b62\u65e0\u6548\u5524\u9192\uff1b</li> </ul> <pre><code>void Tproduce() {\n  mutex_lock(&amp;lk);\n  // \u9700\u8981\u7528 while \u5224\u65ad\uff0c\u5e76\u4e14\u7528\u4e24\u4e2a\u6761\u4ef6\u53d8\u91cf\u907f\u514d\u65e0\u6548\u7684\u5524\u9192\n  if (!CAN_PRODUCE) cond_wait(&amp;cv, &amp;lk);\n  printf(\"(\"); count++; cond_signal(&amp;cv);\n  mutex_unlock(&amp;lk);\n}\n\nvoid Tconsume() {\n  mutex_lock(&amp;lk);\n  // \u9700\u8981\u7528 while \u5224\u65ad\uff0c\u5e76\u4e14\u7528\u4e24\u4e2a\u6761\u4ef6\u53d8\u91cf\u907f\u514d\u65e0\u6548\u7684\u5524\u9192\n  if (!CAN_CONSUME) cond_wait(&amp;cv, &amp;lk);\n  printf(\")\"); count--; cond_signal(&amp;cv);\n  mutex_unlock(&amp;lk);\n}\n</code></pre>"},{"location":"courses/os_lab/09_sync_condition.html#_6","title":"\u6761\u4ef6\u53d8\u91cf\uff1a\u6b63\u786e\u7684\u6253\u5f00\u65b9\u5f0f","text":"<p>\u540c\u6b65\u7684\u672c\u8d28\uff1a<code>wait_until(COND) { ... }</code>\uff0c\u56e0\u6b64\uff1a</p> <ul> <li>\u9700\u8981\u7b49\u5f85\u6761\u4ef6\u6ee1\u8db3\u65f6</li> </ul> <pre><code>mutex_lock(&amp;mutex);\n// while \u5faa\u73af\uff0c\u88ab\u5524\u9192\u65f6\u9700\u8981\u5224\u65ad\u6761\u4ef6\u662f\u5426\u6210\u7acb\nwhile (!COND) {\n  wait(&amp;cv, &amp;mutex);\n}\nassert(cond);  // \u4e92\u65a5\u9501\u4fdd\u8bc1\u6761\u4ef6\u6210\u7acb\nmutex_unlock(&amp;mutex);\n</code></pre> <ul> <li>\u4efb\u4f55\u6539\u52a8\u4f7f\u5176\u4ed6\u7ebf\u53ef\u80fd\u88ab\u6ee1\u8db3\u65f6</li> </ul> <pre><code>mutex_lock(&amp;mutex);\n// \u4efb\u4f55\u53ef\u80fd\u4f7f\u6761\u4ef6\u6ee1\u8db3\u7684\u4ee3\u7801\uff08\u9632\u6b62\u5524\u9192\u4e0d\u80fd\u6267\u884c\u7684\u7ebf\u7a0b\uff0c\u5bfc\u81f4\u6b7b\u9501\uff09\nbroadcast(&amp;cv);\nmutex_unlock(&amp;mutex);\n</code></pre>"},{"location":"courses/os_lab/09_sync_condition.html#_7","title":"\u6761\u4ef6\u53d8\u91cf\uff1a\u5e94\u7528","text":""},{"location":"courses/os_lab/09_sync_condition.html#m2","title":"\u4e07\u80fd\u5e76\u884c\u8ba1\u7b97\u6846\u67b6 (M2)","text":"<pre><code>struct work {\n  void (*run)(void *arg);\n  void *arg;\n}\n\nvoid Tworker() {\n  while (1) {\n    struct work *work;\n    wait_until(has_new_work() || all_done) {\n      work = get_work();\n    }\n    if (!work) break;\n    else {\n      work-&gt;run(work-&gt;arg); // \u5141\u8bb8\u751f\u6210\u65b0\u7684 work (\u6ce8\u610f\u4e92\u65a5)\n      release(work);  // \u6ce8\u610f\u56de\u6536 work \u5206\u914d\u7684\u8d44\u6e90\n    }\n  }\n}\n</code></pre>"},{"location":"courses/os_lab/09_sync_condition.html#_8","title":"\u6761\u4ef6\u53d8\u91cf\uff1a\u66f4\u53e4\u602a\u7684\u4e60\u9898/\u9762\u8bd5\u9898","text":"<p>\u6709\u4e09\u79cd\u7ebf\u7a0b</p> <ul> <li>Ta \u82e5\u5e72: \u6b7b\u5faa\u73af\u6253\u5370 <code>&lt;</code></li> <li>Tb \u82e5\u5e72: \u6b7b\u5faa\u73af\u6253\u5370 <code>&gt;</code></li> <li>Tc \u82e5\u5e72: \u6b7b\u5faa\u73af\u6253\u5370 <code>_</code></li> </ul> <p>\u4efb\u52a1\uff1a</p> <ul> <li>\u5bf9\u8fd9\u4e9b\u7ebf\u7a0b\u8fdb\u884c\u540c\u6b65\uff0c\u4f7f\u5f97\u5c4f\u5e55\u6253\u5370\u51fa <code>&lt;&gt;&lt;_</code> \u548c <code>&gt;&lt;&gt;_</code> \u7684\u7ec4\u5408</li> </ul> <p>\u4f7f\u7528\u6761\u4ef6\u53d8\u91cf\uff0c\u53ea\u8981\u56de\u7b54\u4e09\u4e2a\u95ee\u9898\uff1a</p> <ul> <li>\u6253\u5370 \u201c<code>&lt;</code>\u201d \u7684\u6761\u4ef6\uff1f<code>A,C,E</code></li> <li>\u6253\u5370 \u201c<code>&gt;</code>\u201d \u7684\u6761\u4ef6\uff1f<code>A,B,F</code></li> <li>\u6253\u5370 \u201c<code>_</code>\u201d \u7684\u6761\u4ef6\uff1f<code>D</code></li> </ul> <p>\u72b6\u6001\u673a</p> <pre><code>graph LR\n   A --\"&lt;\"--&gt; B\n   B --\"&gt;\"--&gt; C\n   C --\"&lt;\"--&gt; D\n   A --\"&gt;\"--&gt; E\n   E --\"&lt;\"--&gt; F\n   F --\"&gt;\"--&gt; D\n   D --\"_\"--&gt; A\n</code></pre>"},{"location":"courses/os_lab/09_sync_condition.html#_9","title":"\u8bfe\u540e\u4e60\u9898/\u7f16\u7a0b\u4f5c\u4e1a","text":""},{"location":"courses/os_lab/09_sync_condition.html#1_1","title":"1. \u9605\u8bfb\u6750\u6599","text":"<p>\u6559\u79d1\u4e66 Operating Systems: Three Easy Pieces:</p> <ul> <li>\u7b2c 29 \u7ae0 - Locked Data Structures</li> <li>\u7b2c30 \u7ae0 - Condition Variables</li> </ul>"},{"location":"courses/os_lab/09_sync_condition.html#2","title":"2. \u7f16\u7a0b\u5b9e\u8df5","text":"<p>\u8fd0\u884c\u793a\u4f8b\u4ee3\u7801\u5e76\u89c2\u5bdf\u6267\u884c\u7ed3\u679c\u3002\u5efa\u8bae\u5927\u5bb6\u5148\u4e0d\u53c2\u7167\u53c2\u8003\u4e66\uff0c\u901a\u8fc7\u4e24\u4e2a\u4fe1\u53f7\u91cf\u5206\u522b\u4ee3\u8868 Tproduce \u548c Tconsume \u7684\u5524\u9192\u6761\u4ef6\u5b9e\u73b0\u540c\u6b65\u3002</p>"},{"location":"courses/os_lab/09_sync_condition.html#3","title":"3. \u5b9e\u9a8c\u4f5c\u4e1a","text":"<p>\u5f00\u59cb M2 \u548c L1 \u5b9e\u9a8c\u4f5c\u4e1a\u3002</p>"},{"location":"courses/os_lab/10_sync_semphore.html","title":"\u5e76\u53d1\u63a7\u5236\uff1a\u540c\u6b65 (2)","text":"<p>\u4fe1\u53f7\u91cf\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u6761\u4ef6\u53d8\u91cf\uff0c\u800c\u4e14\u53ef\u4ee5\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u88ab\u9ad8\u6548\u5730\u5b9e\u73b0\uff0c\u907f\u514d broadcast \u5524\u9192\u7684\u6d6a\u8d39\u3002</p> <p>\u4f46\u51e1\u80fd\u5c06\u4efb\u52a1\u5f88\u597d\u5730\u5206\u89e3\u6210\u5c11\u91cf\u4e32\u884c\u7684\u90e8\u5206\u548c\u7edd\u5927\u90e8\u5206 \u201c\u7ebf\u7a0b\u5c40\u90e8\u201d \u7684\u8ba1\u7b97\uff0c\u90a3\u4e48\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u548c\u8ba1\u7b97\u56fe\u6a21\u578b\u5c31\u80fd\u5b9e\u73b0\u6709\u6548\u7684\u5e76\u884c\u3002</p> <p>\u672c\u8bb2\u5185\u5bb9\uff1a\u53e6\u4e00\u79cd\u5171\u4eab\u5185\u5b58\u7cfb\u7edf\u4e2d\u5e38\u7528\u7684\u540c\u6b65\u65b9\u6cd5\uff1a\u4fe1\u53f7\u91cf (E. W. Dijkstra)</p> <ul> <li>\u4ec0\u4e48\u662f\u4fe1\u53f7\u91cf</li> <li>\u4fe1\u53f7\u91cf\u9002\u5408\u89e3\u51b3\u4ec0\u4e48\u95ee\u9898</li> <li>\u54f2\u5b66\u5bb6\u5403\u996d\u95ee\u9898</li> </ul>"},{"location":"courses/os_lab/10_sync_semphore.html#_1","title":"\u4fe1\u53f7\u91cf","text":""},{"location":"courses/os_lab/10_sync_semphore.html#_2","title":"\u4fe1\u53f7\u91cf\uff1a\u4e00\u79cd\u6761\u4ef6\u53d8\u91cf\u7684\u7279\u4f8b","text":"<pre><code>void P(sem_t *sem) { // wait\n  wait_until(sem-&gt;count &gt; 0) {\n    sem-&gt;count--;\n  }\n}\n\nvoid V(sem_t *sem) { // post (signal)\n  atomic {\n    sem-&gt;count++;\n  }\n}\n</code></pre> <p>\u6b63\u662f\u56e0\u4e3a\u6761\u4ef6\u7684\u7279\u6b8a\u6027\uff0c\u4fe1\u53f7\u91cf\u4e0d\u9700\u8981 broadcast</p> <ul> <li>P \u5931\u8d25\u65f6\u7acb\u5373\u7761\u7720\u7b49\u5f85</li> <li>\u6267\u884c V \u65f6\uff0c\u5524\u9192\u4efb\u610f\u7b49\u5f85\u7684\u7ebf\u7a0b</li> </ul>"},{"location":"courses/os_lab/10_sync_semphore.html#_3","title":"\u7406\u89e3\u4fe1\u53f7\u91cf","text":"<p>\u4fe1\u53f7\u91cf\u5bf9\u5e94\u4e86 \u201c\u8d44\u6e90\u6570\u91cf\u201d</p> <ul> <li>\u4e92\u65a5\u9501\u662f\u4fe1\u53f7\u91cf\u7684\u7279\u4f8b</li> <li>\u6269\u5c55\u7684\u4e92\u65a5\u9501\uff1a\u4e00\u4e2a\u624b\u73af \u2192 n \u4e2a\u624b\u73af\uff08\u6e38\u6cf3\u6c60\u7684\u793a\u4f8b\uff09</li> </ul>"},{"location":"courses/os_lab/10_sync_semphore.html#-","title":"\u4fe1\u53f7\u91cf\uff1a\u5b9e\u73b0\u4f18\u96c5\u7684\u751f\u4ea7\u8005-\u6d88\u8d39\u8005","text":"<p>\u4fe1\u53f7\u91cf\u8bbe\u8ba1\u7684\u91cd\u70b9</p> <ul> <li>\u8003\u8651 \u201c\u7403\u201d/\u201c\u624b\u73af\u201d (\u6bcf\u4e00\u5355\u4f4d\u7684 \u201c\u8d44\u6e90\u201d) \u662f\u4ec0\u4e48</li> <li>\u751f\u4ea7\u8005/\u6d88\u8d39\u8005 = \u628a\u7403\u4ece\u4e00\u4e2a\u888b\u5b50\u91cc\u653e\u5230\u53e6\u4e00\u4e2a\u888b\u5b50\u91cc\uff1a\u4e24\u79cd\u8d44\u6e90</li> </ul> <pre><code>// emtpy = full, fill = 0\uff1b\u8868\u793a\u5f00\u59cb\u961f\u5217\u4e2d\u5f00\u59cb\u6ca1\u6709\u8d44\u6e90\nvoid Tproduce() {\n  P(&amp;empty);\n  printf(\"(\"); // \u6ce8\u610f\u5171\u4eab\u6570\u636e\u7ed3\u6784\u8bbf\u95ee\u9700\u4e92\u65a5\n  V(&amp;fill);\n}\nvoid Tconsume() {\n  P(&amp;fill);\n  printf(\")\");\n  V(&amp;empty);\n}\n</code></pre>"},{"location":"courses/os_lab/10_sync_semphore.html#_4","title":"\u4fe1\u53f7\u91cf\uff1a\u5e94\u7528","text":""},{"location":"courses/os_lab/10_sync_semphore.html#_5","title":"\u4fe1\u53f7\u91cf\u7684\u4e24\u79cd\u5178\u578b\u5e94\u7528","text":"<ol> <li>\u5b9e\u73b0\u4e00\u6b21\u4e34\u65f6\u7684 happens-before\uff1a\u5047\u8bbe s \u53ea\u88ab\u4f7f\u7528\u4e00\u6b21\uff0c\u4fdd\u8bc1 A happens-before B</li> <li>\u521d\u59cb\uff1as = 0</li> <li>A; V(s)</li> <li> <p>P(s); B</p> </li> <li> <p>\u5b9e\u73b0\u8ba1\u6570\u578b\u7684\u540c\u6b65\uff1a\u5982\u7ebf\u7a0b\u5e93\u7684 join</p> </li> <li> <p>\u521d\u59cb\uff1adone = 0</p> </li> <li> <p>Tworker: V(done)</p> </li> <li> <p>Tmain: P(done) \u00d7T</p> </li> </ol>"},{"location":"courses/os_lab/10_sync_semphore.html#_6","title":"\u4f8b\u5b50\uff1a\u5b9e\u73b0\u8ba1\u7b97\u56fe","text":"<p>\u5bf9\u4e8e\u4efb\u4f55\u8ba1\u7b97\u56fe\uff1a\u4e3a\u6bcf\u4e2a\u8282\u70b9\u5206\u914d\u4e00\u4e2a\u7ebf\u7a0b</p> <ul> <li>\u5bf9\u6bcf\u6761\u5165\u8fb9\u6267\u884c P (wait) \u64cd\u4f5c</li> <li>\u5b8c\u6210\u8ba1\u7b97\u4efb\u52a1</li> <li>\u5bf9\u6bcf\u6761\u51fa\u8fb9\u6267\u884c V (post/signal) \u64cd\u4f5c</li> <li>\u6bcf\u6761\u8fb9\u6070\u597d P \u4e00\u6b21\u3001V \u4e00\u6b21</li> <li>M2 Lab PLCS \u76f4\u63a5\u5c31\u89e3\u51b3\u4e86\u554a\uff1f</li> </ul> <pre><code>void Tworker_d() {\n  P(bd); P(ad); P(cd);\n  // \u5b8c\u6210\u8282\u70b9 d \u4e0a\u7684\u8ba1\u7b97\u4efb\u52a1\n  V(de);\n}\n</code></pre> <p></p> <p>\u5b58\u5728\u7684\u95ee\u9898\uff1a</p> <ul> <li>\u521b\u5efa\u90a3\u4e48\u591a\u7ebf\u7a0b\u548c\u90a3\u4e48\u591a\u4fe1\u53f7\u91cf = Time Limit Exceeded</li> <li>\u89e3\u51b3\u7ebf\u7a0b\u592a\u591a\u7684\u95ee\u9898\uff1a\u4e00\u4e2a\u7ebf\u7a0b\u8d1f\u8d23\u591a\u4e2a\u8282\u70b9\u7684\u8ba1\u7b97</li> <li>\u9759\u6001\u5212\u5206 \u2192 \u8986\u76d6\u95ee\u9898</li> <li>\u52a8\u6001\u8c03\u5ea6 \u2192 \u53c8\u53d8\u56de\u4e86\u751f\u4ea7\u8005-\u6d88\u8d39\u8005</li> <li>\u89e3\u51b3\u4fe1\u53f7\u91cf\u592a\u591a\u7684\u95ee\u9898\uff1a\u8ba1\u7b97\u8282\u70b9\u5171\u4eab\u4fe1\u53f7\u91cf</li> <li>\u53ef\u80fd\u51fa\u73b0 \u201c\u5047\u5524\u9192\u201d \u2192 \u53c8\u53d8\u56de\u4e86\u6761\u4ef6\u53d8\u91cf</li> </ul>"},{"location":"courses/os_lab/10_sync_semphore.html#_7","title":"\u7ec3\u4e60\u9898\u7684\u4fe1\u53f7\u91cf\u5b9e\u73b0","text":"<p>\u6709\u4e09\u79cd\u7ebf\u7a0b</p> <ul> <li>Ta \u82e5\u5e72: \u6b7b\u5faa\u73af\u6253\u5370 <code>&lt;</code></li> <li>Tb \u82e5\u5e72: \u6b7b\u5faa\u73af\u6253\u5370 <code>&gt;</code></li> <li>Tc \u82e5\u5e72: \u6b7b\u5faa\u73af\u6253\u5370 <code>_</code></li> <li>\u5982\u4f55\u540c\u6b65\u8fd9\u4e9b\u7ebf\u7a0b\uff0c\u4fdd\u8bc1\u6253\u5370\u51fa <code>&lt;&gt;&lt;_</code> \u548c <code>&gt;&lt;&gt;_</code> \u7684\u5e8f\u5217\uff1f</li> </ul> <p>\u4fe1\u53f7\u91cf\u7684\u56f0\u96be</p> <ul> <li>\u4e0a\u4e00\u6761\u9c7c\u6253\u5370\u540e\uff0c<code>&lt;</code> \u548c <code>&gt;</code> \u90fd\u662f\u53ef\u884c\u7684</li> <li>\u6211\u5e94\u8be5 P \u54ea\u4e2a\u4fe1\u53f7\u91cf\uff1f</li> <li>\u53ef\u4ee5 P \u6211\u81ea\u5df1\u7684</li> <li>\u7531\u6253\u5370 <code>_</code> \u7684\u7ebf\u7a0b\u968f\u673a\u9009\u4e00\u4e2a</li> </ul>"},{"location":"courses/os_lab/10_sync_semphore.html#_8","title":"\u4f7f\u7528\u4fe1\u53f7\u91cf\u5b9e\u73b0\u6761\u4ef6\u53d8\u91cf\uff1a\u672c\u8d28\u56f0\u96be","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u7528\u81ea\u65cb\u9501\u4fdd\u8bc1 wait \u7684\u539f\u5b50\u6027</p> <pre><code>wait(cv, mutex) {\n  release(mutex);\n  sleep();\n}\n</code></pre> <p>\u4fe1\u53f7\u91cf\u5b9e\u73b0\u7684\u77db\u76fe</p> <ul> <li>\u4e0d\u80fd\u5e26\u7740\u9501\u7761\u7720\uff1a\u6b7b\u9501</li> <li>\u4e5f\u4e0d\u80fd\u5148\u91ca\u653e\u9501</li> <li><code>P(mutex); nwait++; V(mutex);</code></li> <li>\u6b64\u65f6 signal/broadcast \u53d1\u751f\uff0c\u5524\u9192\u4e86\u540e wait \u7684\u7ebf\u7a0b</li> <li><code>P(sleep);</code></li> </ul>"},{"location":"courses/os_lab/10_sync_semphore.html#_9","title":"\u4fe1\u53f7\u91cf\uff1a\u5c0f\u7ed3","text":"<p>\u4fe1\u53f7\u91cf\u662f\u5bf9 \u201c\u888b\u5b50\u548c\u7403/\u624b\u73af\u201d \u7684\u62bd\u8c61</p> <ul> <li>\u5b9e\u73b0\u4e00\u6b21 happens-before\uff0c\u6216\u662f\u8ba1\u6570\u578b\u7684\u540c\u6b65</li> <li>\u80fd\u591f\u5199\u51fa\u4f18\u96c5\u7684\u4ee3\u7801</li> <li><code>P(empty); printf(\"(\"); V(fill)</code></li> <li>\u4f46\u5e76\u4e0d\u662f\u6240\u6709\u7684\u540c\u6b65\u6761\u4ef6\u90fd\u5bb9\u6613\u7528\u8fd9\u4e2a\u62bd\u8c61\u6765\u8868\u8fbe</li> </ul>"},{"location":"courses/os_lab/10_sync_semphore.html#_10","title":"\u54f2\u5b66\u5bb6\u5403\u996d\u95ee\u9898","text":"<p>\u7ecf\u5178\u540c\u6b65\u95ee\u9898\uff1a\u54f2\u5b66\u5bb6 (\u7ebf\u7a0b) \u6709\u65f6\u601d\u8003\uff0c\u6709\u65f6\u5403\u996d (E. W. Dijkstra, 1960)</p> <ul> <li>\u5403\u996d\u9700\u8981\u540c\u65f6\u5f97\u5230\u5de6\u624b\u548c\u53f3\u624b\u7684\u53c9\u5b50</li> <li>\u5f53\u53c9\u5b50\u88ab\u5176\u4ed6\u4eba\u5360\u6709\u65f6\uff0c\u5fc5\u987b\u7b49\u5f85\uff0c\u5982\u4f55\u5b8c\u6210\u540c\u6b65\uff1f</li> </ul>"},{"location":"courses/os_lab/10_sync_semphore.html#_11","title":"\u6210\u529f\u7684\u5c1d\u8bd5 (\u4e07\u80fd\u7684\u65b9\u6cd5)","text":"<pre><code>#define CAN_EAT (avail[lhs] &amp;&amp; avail[rhs])\n\nmutex_lock(&amp;mutex);\nwhile (!CAN_EAT)\n  cond_wait(&amp;cv, &amp;mutex);\n// \u62ff\u53c9\u5b50\navail[lhs] = avail[rhs] = false;\nmutex_unlock(&amp;mutex);\n\n// \u5403\u996d\nprint(\"eat\");\n\nmutex_lock(&amp;mutex);\n// \u91ca\u653e\u53c9\u5b50\uff0c\u5524\u9192\u7b49\u5f85\u53c9\u5b50\u7684\u7ebf\u7a0b\navail[lhs] = avail[rhs] = true;\ncond_broadcast(&amp;cv);\nmutex_unlock(&amp;mutex);\n</code></pre>"},{"location":"courses/os_lab/10_sync_semphore.html#_12","title":"\u4fe1\u53f7\u91cf\u7684\u5b9e\u73b0","text":"<p>\u5931\u8d25\u7684\u5c1d\u8bd5\uff1a\u6b7b\u9501</p> <ul> <li>\u628a\u4fe1\u53f7\u91cf\u5f53\u4e92\u65a5\u9501\uff1a\u5148\u62ff\u4e00\u628a\u53c9\u5b50\uff0c\u518d\u62ff\u53e6\u4e00\u628a\u53c9\u5b50</li> </ul> <p>Trick: \u6b7b\u9501\u4f1a\u5728 5 \u4e2a\u54f2\u5b66\u5bb6 \u201c\u540c\u65f6\u5403\u996d\u201d \u65f6\u53d1\u751f ---- \u7834\u574f\u6b7b\u9501\u6761\u4ef6</p> <ul> <li>\u4fdd\u8bc1\u4efb\u4f55\u65f6\u5019\u81f3\u591a\u53ea\u6709 4 \u4e2a\u4eba\u53ef\u4ee5\u5403\u996d\uff1a4\u4e2a\u8d44\u6e90\u7684\u4fe1\u53f7\u91cf</li> <li>\u76f4\u89c2\u7406\u89e3\uff1a\u5927\u5bb6\u5148\u4ece\u684c\u4e0a\u9000\u51fa\uff0c\u888b\u5b50\u91cc\u6709 4 \u5f20\u5361\uff0c\u62ff\u5230\u5361\u7684\u53ef\u4ee5\u4e0a\u684c\u5403\u996d (\u62ff\u53c9\u5b50)\u5403\u5b8c\u4ee5\u540e\u628a\u5361\u5f52\u8fd8\u5230\u888b\u5b50</li> </ul>"},{"location":"courses/os_lab/10_sync_semphore.html#_13","title":"\u53cd\u601d\uff1a\u5206\u5e03\u4e0e\u96c6\u4e2d","text":"<p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u975e\u5e38\u5e38\u89c1\u7684\u89e3\u51b3\u601d\u8def (HDFS, Yarn, K8s)</p> <p>\u201cLeader/follower\u201d - \u6709\u4e00\u4e2a\u96c6\u4e2d\u7684 \u201c\u603b\u63a7\u201d\uff0c\u800c\u975e \u201c\u5404\u81ea\u534f\u8c03\u201d</p> <ul> <li>\u5728\u53ef\u9760\u7684\u6d88\u606f\u673a\u5236\u4e0a\u5b9e\u73b0\u4efb\u52a1\u5206\u6d3e</li> <li>Leader \u4e32\u884c\u5904\u7406\u6240\u6709\u8bf7\u6c42 (\u4f8b\u5982\uff1a\u6761\u4ef6\u53d8\u91cf\u670d\u52a1)</li> </ul> <pre><code>void Tphilosopher(int id) {\n  send(Twaiter, id, EAT);\n  receive(Twatier); // \u7b49\u5f85 waiter \u628a\u4e24\u628a\u53c9\u5b50\u9012\u7ed9\u54f2\u5b66\u5bb6\n  eat();\n  send(Twaiter, id, DONE); // \u5f52\u8fd8\u53c9\u5b50\n}\n\nvoid Twaiter() {\n  while (1) {\n    (id, status) = receive(Any);\n    switch (status) { ... }\n  }\n}\n</code></pre> <p>\u4f60\u53ef\u80fd\u4f1a\u89c9\u5f97\uff0c\u7ba1\u53c9\u5b50\u7684\u4eba\u662f\u6027\u80fd\u74f6\u9888</p> <ul> <li>Premature optimization is the root of all evil (D. E. Knuth)</li> </ul> <p>\u629b\u5f00 workload \u8c08\u4f18\u5316\u5c31\u662f\u800d\u6d41\u6c13</p> <ul> <li>\u5403\u996d\u7684\u65f6\u95f4\u901a\u5e38\u8fdc\u8fdc\u5927\u4e8e\u8bf7\u6c42\u670d\u52a1\u5458\u7684\u65f6\u95f4</li> <li>\u5982\u679c\u4e00\u4e2a manager \u641e\u4e0d\u5b9a\uff0c\u53ef\u4ee5\u5206\u591a\u4e2a (fast/slow path)\uff1a\u628a\u7cfb\u7edf\u8bbe\u8ba1\u597d\uff0c\u96c6\u4e2d\u7ba1\u7406\u53ef\u4ee5\u4e0d\u662f\u74f6\u9888</li> <li>Millions of tiny databases (NSDI'20)</li> <li>The Google File System (SOSP'03) \u5f00\u542f\u5927\u6570\u636e\u65f6\u4ee3</li> </ul> <p></p>"},{"location":"courses/os_lab/10_sync_semphore.html#_14","title":"\u8bfe\u540e\u4e60\u9898/\u7f16\u7a0b\u4f5c\u4e1a","text":""},{"location":"courses/os_lab/10_sync_semphore.html#1","title":"1. \u9605\u8bfb\u6750\u6599","text":"<p>\u6559\u79d1\u4e66 Operating Systems: Three Easy Pieces:</p> <ul> <li>\u7b2c 31 \u7ae0 - Semaphores</li> </ul>"},{"location":"courses/os_lab/10_sync_semphore.html#2_1","title":"2. \u7f16\u7a0b\u5b9e\u8df5","text":"<p>\u8fd0\u884c\u793a\u4f8b\u4ee3\u7801\u5e76\u89c2\u5bdf\u6267\u884c\u7ed3\u679c\u3002\u5efa\u8bae\u5927\u5bb6\u5148\u4e0d\u53c2\u7167\u53c2\u8003\u4e66\uff0c\u901a\u8fc7\u4e24\u4e2a\u4fe1\u53f7\u91cf\u5206\u522b\u4ee3\u8868 Tproduce \u548c Tconsume \u7684\u5524\u9192\u6761\u4ef6\u5b9e\u73b0\u540c\u6b65\u3002</p>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html","title":"\u771f\u5b9e\u4e16\u754c\u7684\u5e76\u53d1\u7f16\u7a0b","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a(\u672c\u6b21\u8bfe\u4e3a\u79d1\u666e\uff0c\u4e0d\u9700\u8981\u638c\u63e1\u76f8\u5173\u7f16\u7a0b\u6280\u672f) \u5e76\u53d1\u7f16\u7a0b\u6a21\u578b\u4e0e\u5e95\u5c42\u540c\u6b65\u673a\u5236\u7684\u5c01\u88c5</p> <ul> <li>\u9ad8\u6027\u80fd\u8ba1\u7b97\u4e2d\u7684\u5e76\u884c\u7f16\u7a0b (embarrassingly parallel \u7684\u6570\u503c\u8ba1\u7b97)</li> <li>\u6570\u636e\u4e2d\u5fc3\u4e2d\u7684\u5e76\u53d1\u7f16\u7a0b (\u534f\u7a0b\u3001Goroutine \u548c channel)</li> <li>\u4eba\u5de5\u667a\u80fd\u65f6\u4ee3\u7684\u5206\u5e03\u5f0f\u673a\u5668\u5b66\u4e60 (GPU \u548c Parameter Server)</li> <li>\u7528\u6237\u8eab\u8fb9\u7684\u5e76\u53d1\u7f16\u7a0b (Web \u548c\u5f02\u6b65\u7f16\u7a0b)</li> </ul>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_2","title":"\u9ad8\u6027\u80fd\u8ba1\u7b97\u4e2d\u7684\u5e76\u884c\u7f16\u7a0b","text":""},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_3","title":"(\u7ecf\u5178) \u9ad8\u6027\u80fd\u8ba1\u7b97","text":"<p>\u201cA technology that harnesses the power of supercomputers or computer clusters to solve complex problems requiring massive computation.\u201d (IBM)</p> <p>\u6e90\u81ea\u6570\u503c\u5bc6\u96c6\u578b\u79d1\u5b66\u8ba1\u7b97\u4efb\u52a1</p> <ul> <li>\u7269\u7406\u7cfb\u7edf\u6a21\u62df</li> <li>\u5929\u6c14\u9884\u62a5\u3001\u822a\u5929\u3001\u5236\u9020\u3001\u80fd\u6e90\u3001\u5236\u836f\u3001\u2026\u2026</li> <li>\u5927\u5230\u5b87\u5b99\u5c0f\u5230\u91cf\u5b50\uff0c\u6709\u6a21\u578b\u5c31\u80fd\u6a21\u62df</li> <li>\u77ff\u5382 (\u73b0\u5728\u4e0d\u90a3\u4e48\u70ed\u4e86)</li> <li>\u7eaf\u7cb9\u7684 hash \u8ba1\u7b97</li> <li>HPC-China Top 100 </li> </ul>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_4","title":"\u9ad8\u6027\u80fd\u8ba1\u7b97\u7a0b\u5e8f\uff1a\u7279\u70b9","text":"<p>\u7269\u7406\u4e16\u754c\u5177\u6709 \u201c\u7a7a\u95f4\u5c40\u90e8\u6027\u201d\uff1a\u6309\u7a7a\u95f4\u5212\u5206\u4efb\u52a1</p> <ul> <li>\u4e00\u5207 \u201c\u6a21\u62df\u7269\u7406\u4e16\u754c\u201d \u7684\u7cfb\u7edf\u90fd\u5177\u6709 embarrassingly parallel \uff08\u6613\u5e76\u884c\u8ba1\u7b97\uff09\u7684\u7279\u6027</li> </ul> <p></p>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_5","title":"\u9ad8\u6027\u80fd\u8ba1\u7b97\uff1a\u5173\u952e\u95ee\u9898","text":"<p>\u95ee\u9898 1\uff1a\u8ba1\u7b97\u4efb\u52a1\u5982\u4f55\u5206\u89e3</p> <ul> <li>\u901a\u5e38\u8ba1\u7b97\u56fe\u5bb9\u6613\u9759\u6001\u5207\u5206 (\u673a\u5668-\u7ebf\u7a0b\u4e24\u7ea7\u4efb\u52a1\u5206\u89e3)</li> <li>\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u89e3\u51b3\u4e00\u5207</li> <li>MPI - \u201ca specification for the developers and users of message passing libraries\u201d</li> <li>OpenMP - \u201cmulti-platform shared-memory parallel programming in C/C++ and Fortran\u201d</li> <li>Parallel and Distributed Computation: Numerical Methods</li> </ul> <pre><code>#pragma omp parallel num_threads(128)\nfor (int i = 0; i &lt; 1024; i++) {\n}\n</code></pre> <p>\u95ee\u9898 2\uff1a\u6d77\u91cf\u7ebf\u7a0b\u4e4b\u95f4\u7684\u5982\u4f55\u540c\u6b65\u548c\u901a\u4fe1</p> <ul> <li>\u6301\u4e45\u5b58\u50a8 (~PB) \u2192 CPU/\u5185\u5b58 (~TB) \u2192 GPU/\u663e\u5b58 (~10GB) \u2192 \u7f13\u5b58 (~MB)</li> </ul>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_6","title":"\u6570\u636e\u4e2d\u5fc3\u91cc\u7684\u5e76\u53d1\u7f16\u7a0b","text":""},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_7","title":"\u6570\u636e\u4e2d\u5fc3\u7a0b\u5e8f\uff1a\u7279\u70b9","text":"<p>\u201cA network of computing and storage resources that enable the delivery of shared applications and data.\u201d (CISCO)</p> <p>\u4ee5\u6570\u636e (\u5b58\u50a8) \u4e3a\u4e2d\u5fc3</p> <ul> <li>\u4e92\u8054\u7f51\u7d22\u5f15\u4e0e\u641c\u7d22</li> <li>Google / Bing</li> <li>\u793e\u4ea4\u7f51\u7edc</li> <li>Facebook/Twitter</li> <li>\u652f\u6491\u5404\u7c7b\u4e92\u8054\u7f51\u5e94\u7528</li> <li>\u901a\u4fe1 (\u5fae\u4fe1/QQ)\u3001\u652f\u4ed8 (\u652f\u4ed8\u5b9d)\u3001\u6e38\u620f/\u7f51\u76d8/\u2026\u2026</li> </ul>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_8","title":"\u6570\u636e\u4e2d\u5fc3\uff1a\u5173\u952e\u95ee\u9898","text":"<p>\u5982\u4f55\u5b9e\u73b0\u9ad8\u53ef\u9760\u3001\u4f4e\u5ef6\u8fdf\u7684\u591a\u526f\u672c\u5206\u5e03\u5f0f\u5b58\u50a8\u548c\u8ba1\u7b97\u7cfb\u7edf\uff1f</p> <ul> <li>\u5728\u670d\u52a1\u6d77\u91cf\u5730\u7406\u5206\u5e03\u8bf7\u6c42\u7684\u524d\u63d0\u4e0b\uff0c\u4e09\u8005\u4e0d\u53ef\u517c\u5f97\uff1a</li> <li>\u6570\u636e\u8981\u4fdd\u6301\u4e00\u81f4 (Consistency)</li> <li>\u670d\u52a1\u65f6\u523b\u4fdd\u6301\u53ef\u7528 (Availability)</li> <li>\u5bb9\u5fcd\u673a\u5668\u79bb\u7ebf (Partition tolerance)</li> </ul> <p></p>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_9","title":"\u6570\u636e\u4e2d\u5fc3\u7a0b\u5e8f\u4e0a\u7684\u5355\u673a\u7a0b\u5e8f","text":"<p>\u4e8b\u4ef6\u9a71\u52a8 + \u9ad8\u5e76\u53d1\uff1a\u7cfb\u7edf\u8c03\u7528\u5bc6\u96c6\u4e14\u5ef6\u8fdf\u4e0d\u786e\u5b9a</p> <ul> <li>\u7f51\u7edc\u6570\u636e\u8bfb\u5199</li> <li>\u6301\u4e45\u5b58\u50a8\u8bfb\u5199</li> <li>\u5355\u673a\u7a0b\u5e8f\u76ee\u6807\uff1a\u5c3d\u53ef\u80fd\u591a\u5730\u670d\u52a1\u5e76\u884c\u7684\u8bf7\u6c42</li> <li>QPS\uff1a\u541e\u5410\u91cf</li> <li>Tail latency\uff1a\u4e00\u4e2a\u8bf7\u6c42\u6162\u4e86\uff0c\u5176\u4ed6\u8bf7\u6c42\u4e0d\u80fd\u6162</li> </ul> <p>\u5047\u8bbe\u6709\u6570\u5343/\u6570\u4e07\u4e2a\u8bf7\u6c42\u540c\u65f6\u5230\u8fbe\u670d\u52a1\u5668\u2026\u2026</p> <ul> <li>\u7ebf\u7a0b\u80fd\u591f\u5b9e\u73b0\u5e76\u884c\u5904\u7406</li> <li>\u4f46\u8fdc\u591a\u4e8e\u5904\u7406\u5668\u6570\u91cf\u7684\u7ebf\u7a0b\u5bfc\u81f4\u6027\u80fd\u95ee\u9898</li> <li>\u5207\u6362\u5f00\u9500 / \u7ef4\u62a4\u5f00\u9500</li> </ul>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_10","title":"\u534f\u7a0b\uff1a\u64cd\u4f5c\u7cfb\u7edf \u201c\u4e0d\u611f\u77e5\u201d \u7684\u4e0a\u4e0b\u6587\u5207\u6362","text":"<p>\u548c\u7ebf\u7a0b\u6982\u5ff5\u76f8\u540c (\u72ec\u7acb\u5806\u6808\u3001\u5171\u4eab\u5185\u5b58)</p> <ul> <li>\u4f46 \u201c\u4e00\u76f4\u6267\u884c\u201d\uff0c\u76f4\u5230<code>yield()</code>\u4e3b\u52a8\u653e\u5f03\u5904\u7406\u5668</li> <li>\u6709\u7f16\u8bd1\u5668\u8f85\u52a9\uff0c\u5207\u6362\u5f00\u9500\u4f4e<ul> <li>yield() \u662f\u51fd\u6570\u8c03\u7528\uff0c\u53ea\u9700\u4fdd\u5b58/\u6062\u590d \u201ccallee saved\u201d \u5bc4\u5b58\u5668\uff08\u66f4\u5c11\u7684\u5bc4\u5b58\u5668\uff09</li> <li>\u7ebf\u7a0b\u5207\u6362\u9700\u8981\u4fdd\u5b58/\u6062\u590d\u5168\u90e8\u5bc4\u5b58\u5668</li> </ul> </li> <li>\u4f46\u7b49\u5f85 I/O \u65f6\uff0c\u5176\u4ed6\u534f\u7a0b\u5c31\u4e0d\u80fd\u8fd0\u884c\u4e86\u2026\u2026<ul> <li>\u5931\u53bb\u4e86\u5e76\u884c</li> </ul> </li> </ul> <pre><code>// \u53ea\u53ef\u80fd\u662f 1122 \u6216 2211\nvoid T1() { send(\"1\"); send(\"1\"); yield(); }\nvoid T2() { send(\"2\"); send(\"2\"); yield(); }\n</code></pre>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#go-goroutine","title":"Go \u548c Goroutine","text":"<p>Go: \u5c0f\u5b69\u5b50\u624d\u505a\u9009\u62e9\uff0c\u591a\u5904\u7406\u5668\u5e76\u884c\u548c\u8f7b\u91cf\u7ea7\u5e76\u53d1\u6211\u5168\u90fd\u8981\uff01</p> <p>Goroutine: \u6982\u5ff5\u4e0a\u662f\u7ebf\u7a0b\uff0c\u5b9e\u9645\u662f\u7ebf\u7a0b\u548c\u534f\u7a0b\u7684\u6df7\u5408\u4f53</p> <ul> <li>\u6bcf\u4e2a CPU \u4e0a\u6709\u4e00\u4e2a Go Worker\uff0c\u81ea\u7531\u8c03\u5ea6 goroutines</li> <li>\u6267\u884c\u5230 blocking API \u65f6 (\u4f8b\u5982 sleep, read)\uff0cGo Worker \u5077\u5077\u6539\u6210 non-blocking \u7684\u7248\u672c</li> <li>\u6210\u529f \u2192 \u7acb\u5373\u7ee7\u7eed\u6267\u884c</li> <li>\u5931\u8d25 \u2192 \u7acb\u5373 yield \u5230\u53e6\u4e00\u4e2a\u9700\u8981 CPU \u7684 goroutine<ul> <li>\u592a\u5de7\u5999\u4e86\uff01CPU \u548c\u64cd\u4f5c\u7cfb\u7edf\u5168\u90e8\u7528\u5230 100%</li> </ul> </li> </ul> <p>\u4f8b\u5b50\uff1aFibonacci number from The Go Programming Language (ch 9.8)</p>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#go","title":"Go \u8bed\u8a00\u4e2d\u7684\u540c\u6b65","text":"<p>Do not communicate by sharing memory; instead, share memory by communicating. \u2014\u2014Effective Go</p> <p>\u5171\u4eab\u5185\u5b58 = \u4e07\u6076\u4e4b\u6e90</p> <ul> <li>\u4fe1\u53f7\u91cf/\u6761\u4ef6\u53d8\u91cf\uff1a\u5b9e\u73b0\u4e86\u540c\u6b65\uff0c\u4f46\u6ca1\u6709\u5b9e\u73b0 \u201c\u901a\u4fe1\u201d</li> <li>\u6570\u636e\u4f20\u9012\u5b8c\u5168\u9760\u624b\u5de5 (\u6ca1\u4e0a\u9501\u5c31\u9519\u4e86)</li> </ul> <p>\u4f46 UNIX \u65f6\u4ee3\u5c31\u6709\u4e00\u4e2a\u5b9e\u73b0\u5e76\u884c\u7684\u673a\u5236\u4e86</p> <ul> <li><code>cat *.txt | wc -l</code></li> <li>\u7ba1\u9053\u662f\u4e00\u4e2a\u5929\u7136\u7684\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\uff01</li> <li>\u4e3a\u4ec0\u4e48\u4e0d\u7528 \u201c\u7ba1\u9053\u201d \u5b9e\u73b0\u534f\u7a0b/\u7ebf\u7a0b\u95f4\u7684\u540c\u6b65 + \u901a\u4fe1\u5462\uff1f<ul> <li>Channels in Go</li> </ul> </li> </ul>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_11","title":"\u4eba\u5de5\u667a\u80fd\u65f6\u4ee3\u7684\u5206\u5e03\u5f0f\u673a\u5668\u5b66\u4e60","text":"<p>NVIDIA DGX H100: 3,958 TFLOPS FP16 Tensor @ 700W  ref.  CRAY-1: 138 MFLOPS @ 115kW</p>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_12","title":"\u673a\u5668\u5b66\u4e60\uff1a\u65e2\u8ba1\u7b97\u5bc6\u96c6\uff0c\u53c8\u6570\u636e\u5bc6\u96c6","text":"<p>GPT-3: Language models are few-shot learners</p> <ul> <li> <p>Transformer \u67b6\u6784</p> </li> <li> <p>Attention Is All You Need</p> </li> </ul> <p></p> <ul> <li> <p>175B \u53c2\u6570 (~300GB VRAM, FP-16)</p> </li> <li> <p>GPT-3 single training run cost: ~$5,000,000</p> </li> <li> <p>\u7f8e\u56fd\u4eba\u65ad\u4f9b\u82af\u7247 = \u4e09\u4f53\u4eba\u884c\u4e3a</p> </li> <li> <p>320TB \u8bed\u6599</p> </li> <li>\u76f8\u6bd4\u56fe\u7247\u548c\u89c6\u9891\uff0c\u8fd8\u662f\u5c0f\u5f1f\u5f1f</li> </ul>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#dependency-graph-is-all-you-need","title":"\u5e76\u884c\u5316\uff1aDependency Graph is All You Need","text":""},{"location":"courses/os_lab/11_concurrent_in_real_world.html#1simt","title":"\u8ba1\u7b97\u5bc6\u96c6\u90e8\u5206 (1)\uff1aSIMT","text":"<p>Single Instruction, Multiple Threads</p> <ul> <li>\u4e00\u4e2a PC\uff0c\u63a7\u5236 32 \u4e2a\u6267\u884c\u6d41\u540c\u65f6\u6267\u884c</li> <li>\u903b\u8f91\u7ebf\u7a0b\u53ef\u4ee5\u66f4\u591a</li> <li>\u6267\u884c\u6d41\u6709\u72ec\u7acb\u7684\u5bc4\u5b58\u5668</li> <li>x,y,z \u4e09\u4e2a\u5bc4\u5b58\u5668\u7528\u4e8e\u6807\u8bb0 \u201c\u7ebf\u7a0b\u53f7\u201d\uff0c\u51b3\u5b9a\u7ebf\u7a0b\u6267\u884c\u7684\u52a8\u4f5c</li> </ul> <p></p>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#2simd","title":"\u8ba1\u7b97\u5bc6\u96c6\u90e8\u5206 (2)\uff1aSIMD","text":"<p>Single Instruction, Multiple Data</p> <ul> <li>Tensor \u6307\u4ee4 (Tensor Core)\uff1a\u6df7\u5408\u7cbe\u5ea6 A\u00d7B+C</li> <li>\u5355\u6761\u6307\u4ee4\u5b8c\u6210 4\u00d74\u00d74 \u4e2a\u4e58\u6cd5\u8fd0\u7b97</li> </ul>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#3","title":"\u8ba1\u7b97\u5bc6\u96c6\u90e8\u5206 (3)\uff1a\u5806\u66f4\u591a\u7684\u5904\u7406\u5355\u5143\uff01","text":"<p>GH100 Spec</p> <ul> <li>144 SMs</li> <li>18432 CUDA Cores (\u5e76\u884c\u7684 Threads)</li> <li>AVX512: 512bits = 16 x Float32</li> <li>576 Tensor Cores (4 per SM)</li> <li>6 HBM3 or HBM2e stacks</li> <li>12 512-bit memory controllers</li> <li>60 MB L2 cache</li> </ul> <p>\u8fd9\u53ea\u662f\u4e00\u4e2a GPU</p> <ul> <li>\u663e\u5b58/\u7f13\u5b58\u51b3\u5b9a\u4e86 GPU \u5185\u5806\u5904\u7406\u5668\u7684\u4e0a\u9650</li> <li>\u4f46\u6211\u4eec\u53ef\u4ee5\u6709\u591a\u53f0\u673a\u5668\u3001\u6bcf\u4e2a\u673a\u5668\u6709\u591a\u53f0 GPU\uff01</li> </ul>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_13","title":"\u5206\u5e03\u5f0f\u673a\u5668\u5b66\u4e60","text":"<p>\u9ad8\u6027\u80fd\u8ba1\u7b97 (GPU) + \u6570\u636e\u4e2d\u5fc3\u8ba1\u7b97</p> <ul> <li>Scaling distributed machine learning with the parameter server (OSDI'14)</li> </ul> <p></p>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_14","title":"\u7528\u6237\u8eab\u8fb9\u7684\u5e76\u53d1\u7f16\u7a0b","text":""},{"location":"courses/os_lab/11_concurrent_in_real_world.html#web-20-1999","title":"Web 2.0 \u65f6\u4ee3 (1999)","text":"<p>\u4eba\u4e0e\u4eba\u4e4b\u95f4\u8054\u7cfb\u66f4\u52a0\u7d27\u5bc6\u7684\u4e92\u8054\u7f51</p> <ul> <li>\u201cUsers were encouraged to provide content, rather than just viewing it.\u201d</li> <li>\u4f60\u751a\u81f3\u53ef\u4ee5\u627e\u5230\u4e00\u4e9b \u201cWeb 3.0\u201d/Metaverse \u7684\u7ebf\u7d22</li> </ul> <p>\u662f\u4ec0\u4e48\u6210\u5c31\u4e86\u4eca\u5929\u7684 Web 2.0?</p> <ul> <li>HTML (DOM Tree) + CSS = \u7ec8\u7aef\u4e16\u754c</li> <li>\u901a\u8fc7 JavaScript \u53ef\u4ee5\u6539\u53d8\u5b83</li> <li>\u901a\u8fc7 JavaScript \u53ef\u4ee5\u8fde\u63a5\u6570\u636e\u4e2d\u5fc3</li> <li>Ajax (Asynchronous JavaScript + XML) \u548c <code>$</code></li> <li>\u4f8b\u5b50\uff1aJupyter Notebook</li> </ul>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_15","title":"\u4eba\u673a\u4ea4\u4e92\u7a0b\u5e8f\uff1a\u7279\u70b9\u548c\u4e3b\u8981\u6311\u6218","text":"<p>\u7279\u70b9\uff1a\u4e0d\u592a\u590d\u6742</p> <ul> <li>\u65e2\u6ca1\u6709\u592a\u591a\u8ba1\u7b97</li> <li>DOM Tree \u4e5f\u4e0d\u81f3\u4e8e\u592a\u5927 (\u5927\u4e86\u4eba\u4e5f\u770b\u4e0d\u8fc7\u6765)</li> <li>DOM Tree \u600e\u4e48\u753b\u6d4f\u89c8\u5668\u5168\u5e2e\u6211\u4eec\u641e\u5b9a\u4e86</li> <li>\u4e5f\u6ca1\u6709\u592a\u591a I/O</li> <li>\u5c31\u662f\u4e00\u4e9b\u7f51\u7edc\u8bf7\u6c42</li> </ul> <p>\u6311\u6218\uff1a\u7a0b\u5e8f\u5458\u591a</p> <ul> <li>\u96f6\u57fa\u7840\u7684\u4eba\u4f60\u8ba9\u4ed6\u6574\u5171\u4eab\u5185\u5b58\u4e0a\u7684\u591a\u7ebf\u7a0b</li> <li>\u6050\u6015\u6211\u4eec\u73b0\u5728\u7528\u7684\u5230\u5904\u90fd\u662f bug \u5427\uff1f\uff1f\uff1f</li> <li>\u6846\u67b6\uff1a\u4e0d\u7528\u6015\uff0c\u6709\u6211\u5728</li> <li>AI: \u4e0d\u7528\u6015\uff0c\u6709\u6211\u5728</li> </ul>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_16","title":"\u5355\u7ebf\u7a0b + \u4e8b\u4ef6\u6a21\u578b","text":"<p>\u5c3d\u53ef\u80fd\u5c11\u4f46\u53c8\u8db3\u591f\u7684\u5e76\u53d1</p> <ul> <li>\u4e00\u4e2a\u7ebf\u7a0b\u3001\u5168\u5c40\u7684\u4e8b\u4ef6\u961f\u5217\u3001\u6309\u5e8f\u6267\u884c (run-to-complete)</li> <li>\u8017\u65f6\u7684 API (Timer, Ajax, ...) \u8c03\u7528\u4f1a\u7acb\u5373\u8fd4\u56de</li> <li>\u6761\u4ef6\u6ee1\u8db3\u65f6\u5411\u961f\u5217\u91cc\u589e\u52a0\u4e00\u4e2a\u4e8b\u4ef6</li> </ul> <pre><code>$.ajax(\n  {\n    url: 'https://jyywiki.cn/hello/jyy',\n    success: function(resp) {\n      console.log(resp);\n    },\n    error: function(req, status, err) {\n      console.log(\"Error\");\n    }\n  }\n);\n</code></pre>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_17","title":"\u5f02\u6b65\u4e8b\u4ef6\u6a21\u578b","text":"<p>\u597d\u5904</p> <ul> <li>\u5e76\u53d1\u6a21\u578b\u7b80\u5355\u4e86\u5f88\u591a</li> <li>\u51fd\u6570\u7684\u6267\u884c\u662f\u539f\u5b50\u7684 (\u4e0d\u80fd\u5e76\u884c\uff0c\u51cf\u5c11\u4e86\u5e76\u53d1 bug \u7684\u53ef\u80fd\u6027)</li> <li>API \u4f9d\u7136\u53ef\u4ee5\u5e76\u884c</li> <li>\u9002\u5408\u7f51\u9875\u8fd9\u79cd \u201c\u5927\u90e8\u5206\u65f6\u95f4\u82b1\u5728\u6e32\u67d3\u548c\u7f51\u7edc\u8bf7\u6c42\u201d \u7684\u573a\u666f<ul> <li>JavaScript \u4ee3\u7801\u53ea\u8d1f\u8d23 \u201c\u63cf\u8ff0\u201d DOM Tree</li> </ul> </li> </ul> <p>\u574f\u5904</p> <ul> <li>Callback hell (\u7956\u4f20\u5c4e\u5c71)</li> <li><code>$.ajax</code> \u5d4c\u5957 5 \u5c42\uff0c\u53ef\u7ef4\u62a4\u6027\u5df2\u7ecf\u63a5\u8fd1\u4e8e\u96f6\u4e86</li> </ul>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#promise","title":"\u5f02\u6b65\u7f16\u7a0b\uff1aPromise","text":"<p>\u5bfc\u81f4 callback hell \u7684\u672c\u8d28\uff1a\u4eba\u7c7b\u8111\u888b\u91cc\u60f3\u7684\u662f \u201c\u6d41\u7a0b\u56fe\u201d\uff0c\u770b\u5230\u7684\u662f \u201c\u56de\u8c03\u201d\u3002</p> <p>Promise: \u6d41\u7a0b\u56fe\u7684\u6784\u9020\u65b9\u6cd5 (Mozilla-MDN Docs)</p> <ul> <li>The Promise object represents the eventual completion (or failure) of an asynchronous operation and its resulting value.</li> </ul> <p></p>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#promise-workflow","title":"Promise: \u63cf\u8ff0 Workflow \u7684 \u201c\u5d4c\u5165\u5f0f\u8bed\u8a00\u201d","text":"<p>Chaining</p> <pre><code>loadScript(\"/article/promise-chaining/one.js\")\n  .then( script =&gt; loadScript(\"/article/promise-chaining/two.js\") )\n  .then( script =&gt; loadScript(\"/article/promise-chaining/three.js\") )\n  .then( script =&gt; {\n    // scripts are loaded, we can use functions declared there\n  })\n  .catch(err =&gt; { ... } );\n</code></pre> <p>Fork-join</p> <pre><code>a = new Promise( (resolve, reject) =&gt; { resolve('A') } )\nb = new Promise( (resolve, reject) =&gt; { resolve('B') } )\nc = new Promise( (resolve, reject) =&gt; { resolve('C') } )\nPromise.all([a, b, c]).then( res =&gt; { console.log(res) } )\n</code></pre>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#async-await","title":"Async-Await: \u4e00\u79cd\u8ba1\u7b97\u56fe\u7684\u63cf\u8ff0\u8bed\u8a00","text":"<p>async function</p> <ul> <li>\u603b\u662f\u8fd4\u56de\u4e00\u4e2a <code>Promise</code> object</li> <li><code>async_func()</code> - fork</li> </ul> <p>await promise</p> <ul> <li><code>await promise</code> - join</li> </ul> <pre><code>A = async () =&gt; await $.ajax('/hello/a')\nB = async () =&gt; await $.ajax('/hello/b')\nC = async () =&gt; await $.ajax('/hello/c')\nhello = async () =&gt; await Promise.all([A(), B(), C()])\nhello()\n  .then(window.alert)\n  .catch(res =&gt; { console.log('fetch failed!') } )\n</code></pre>"},{"location":"courses/os_lab/11_concurrent_in_real_world.html#_18","title":"\u8bfe\u540e\u4e60\u9898/\u7f16\u7a0b\u4f5c\u4e1a","text":""},{"location":"courses/os_lab/11_concurrent_in_real_world.html#1","title":"1. \u9605\u8bfb\u6750\u6599","text":"<p>\u6559\u79d1\u4e66 Operating Systems: Three Easy Pieces</p> <ul> <li>\u7b2c 33 \u7ae0 - Event-based Concurrency</li> </ul>"},{"location":"courses/os_lab/12_concurrent_bug_category.html","title":"\u5e76\u53d1BUG\u5206\u7c7b","text":"<p>\u4ece\u6570\u636e\u5e93\u4e8b\u52a1 (transactions, tx) \u5230\u8f6f\u4ef6\u548c\u786c\u4ef6\u652f\u6301\u7684 Transactional Memory  \u5230 Operating System Transactions\uff0c\u76f4\u5230\u4eca\u5929\u6211\u4eec\u4f9d\u7136\u6ca1\u6709\u6bcf\u4e2a\u7a0b\u5e8f\u5458\u90fd\u5782\u624b\u53ef\u5f97\u7684\u53ef\u9760\u539f\u5b50\u6027\u4fdd\u969c\u3002</p> <p>\u672c\u8bb2\u5185\u5bb9\uff1a\u5e38\u89c1\u7684\u5e76\u53d1 bugs</p> <ul> <li>\u6b7b\u9501</li> <li>\u6570\u636e\u7ade\u4e89</li> <li>\u539f\u5b50\u6027\u548c\u987a\u5e8f\u8fdd\u53cd</li> </ul>"},{"location":"courses/os_lab/12_concurrent_bug_category.html#bug_1","title":"\u4f24\u4eba\u6027\u547d\u7684\u5e76\u53d1 Bug","text":"<p>\u5728\u5b89\u5168\u6538\u5173\u7684\u7cfb\u7edf\u4e2d\uff0c\u72ec\u7acb\u7684\u9632\u62a4\u6a21\u5757\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684\u3002</p> <p>\u4f9d\u636e\u8c03\u8bd5\u7406\u8bba\uff0c\u5373\u4fbf\u4e0d\u662f\u5b89\u5168\u6538\u5173\u7684\u7cfb\u7edf\uff0c\u72ec\u7acb\u4e8e\u7a0b\u5e8f\u5b9e\u73b0\u7684\u903b\u8f91\u68c0\u67e5 (assertions) \u53ef\u4ee5\u5728\u8f6f\u4ef6\u9020\u6210\u95ee\u9898\u4e4b\u524d fail fast\u3002</p>"},{"location":"courses/os_lab/12_concurrent_bug_category.html#killed-by-a-machine","title":"\u201cKilled by a Machine\u201d","text":"<p>Therac-25 Incident (1985-1987)</p> <ul> <li>\u81f3\u5c11\u5bfc\u81f4 6 \u4eba\u6b7b\u4ea1</li> <li>\u4e8b\u4ef6\u9a71\u52a8\u5bfc\u81f4\u7684\u5e76\u53d1 bug (\u6ca1\u6709\u591a\u7ebf\u7a0b)</li> </ul> <p>\u524d\u4e24\u8005\u6a21\u5f0f\u662f\u5408\u6cd5\u7684\uff1a\u7b2c\u4e09\u79cd\u6a21\u5f0f\u662f\u975e\u6cd5\u7684</p> <p></p> <p>\u5728\u66f4\u65e9\u7684\u4ea7\u54c1\u4e2d\uff0c\u4f7f\u7528\u7535\u8def\u4e92\u9501 (interlock) \u5728 assert fail \u65f6\u505c\u673a</p> <pre><code>assert mode in [XRay, Electron]\nassert mirror in [On, Off]\nassert not (mode == XRay and mirror == Off)\n</code></pre> <p>BUG\u53d1\u751f\u7684\u539f\u56e0\uff1a\u539f\u5b50\u6027 + \u5f02\u6b65\u6267\u884c\u5047\u8bbe\u5bfc\u81f4\u7684\u707e\u96be</p> <ul> <li>\u9009\u62e9 X-ray Mode</li> <li> <p>\u673a\u5668\u5f00\u59cb\u79fb\u52a8 mirror\uff0c\u9700\u8981 ~8s \u5b8c\u6210</p> </li> <li> <p>\u6b64\u65f6\uff08\u5728mirror\u672a\u79fb\u52a8\u5b8c\u6210\u65f6\uff09\uff0c\u5207\u6362\u5230 Electron Mode</p> </li> <li>\u5c04\u7ebf\u6e90\u4ee5 X-ray Mode \u8fd0\u884c\uff0cMirror \u5c1a\u672a\u5230\u4f4d</li> <li>\u6b64\u65f6\u4f1a\u89e6\u53d1\u4fdd\u62a4\u673a\u5236\uff0c\u629b\u51fa Malfunction 54 \uff08\u8be5\u9519\u8bef\u7684\u89e3\u91ca\u4e0d\u6e05\u6670\uff09<ul> <li>Malfunction 54 \u64cd\u4f5c\u8bf4\u660e\u4e66\u91cc\u9762\u7684\u89e3\u91ca\u662f\u201c\u80fd\u91cf\u5df2\u7ecf\u53d1\u5c04\uff0c\u53ef\u80fd\u8fc7\u9ad8\u6216\u8fc7\u4f4e\u201d</li> <li>\u6bcf\u5929\u5904\u7406\u5404\u79cd Malfunction \u7684\u64cd\u4f5c\u5458\u4e0b\u610f\u8bc6\u5730 Continue\uff08\u5bfc\u81f4BUG\u6a21\u5f0f\u51fa\u73b0\uff09</li> </ul> </li> </ul> <p>\u6700\u7ec8\u89e3\u51b3\u65b9\u6cd5</p> <ul> <li>\u72ec\u7acb\u7684\u786c\u4ef6\u5b89\u5168\u65b9\u6848\uff1a\u5728\u5927\u8ba1\u91cf\u7167\u5c04\u53d1\u751f\u65f6\u76f4\u63a5\u505c\u673a</li> </ul>"},{"location":"courses/os_lab/12_concurrent_bug_category.html#_1","title":"\u6b7b\u9501","text":"<p>A deadlock is a state in which each member of a group is waiting for another member, including itself, to take action.</p>"},{"location":"courses/os_lab/12_concurrent_bug_category.html#aa-deadlock","title":"AA-Deadlock","text":"<p>\u4e0d\u53ef\u91cd\u5165\u9501\uff1a\u5355\u4e2a\u7ebf\u7a0b\u4e0a\u9501 &gt; 1 \u6b21\uff1b</p> <pre><code>lock(&amp;lk);\n// lk = LOCKED;\nlock(&amp;lk);\n// while (xchg(&amp;lk, LOCKED) == LOCKED) ;\n</code></pre> <p>\u771f\u5b9e\u7cfb\u7edf\u7684\u590d\u6742\u6027\u7b49\u7740\u4f60</p> <ul> <li>\u591a\u5c42\u51fd\u6570\u8c03\u7528</li> <li>\u9690\u85cf\u7684\u63a7\u5236\u6d41</li> </ul>"},{"location":"courses/os_lab/12_concurrent_bug_category.html#abba-deadlock","title":"ABBA-Deadlock","text":"<p>\u54f2\u5b66\u5bb6\u5403\u996d\u95ee\u9898</p> <pre><code>void Tphilosopher() {\n  P(&amp;avail[lhs]);\n  P(&amp;avail[rhs]);\n  // ...\n  V(&amp;avail[lhs]);\n  V(&amp;avail[rhs]);\n}\n</code></pre> <ul> <li>T1: P(1) - \u6210\u529f, P(2) - \u7b49\u5f85</li> <li>T2: P(2) - \u6210\u529f, P(3) - \u7b49\u5f85</li> <li>T3: P(3) - \u6210\u529f, P(4) - \u7b49\u5f85</li> <li>T4: P(4) - \u6210\u529f, P(5) - \u7b49\u5f85</li> <li>T5: P(5) - \u6210\u529f, P(1) - \u7b49\u5f85</li> </ul>"},{"location":"courses/os_lab/12_concurrent_bug_category.html#_2","title":"\u6b7b\u9501\u4ea7\u751f\u7684\u5fc5\u8981\u6761\u4ef6","text":"<p>System deadlocks (1971)\uff1a\u6b7b\u9501\u4ea7\u751f\u7684\u56db\u4e2a\u5fc5\u8981\u6761\u4ef6</p> <ul> <li>Mutual-exclusion\uff08\u4e92\u65a5\uff09\uff1a\u4e00\u4e2a\u8d44\u6e90\uff08\u5982\u4e00\u5f20\u6821\u56ed\u5361\uff09\u53ea\u80fd\u88ab\u4e00\u4e2a\u7ebf\u7a0b\uff08\u4eba\uff09\u62e5\u6709</li> <li>Wait-for\uff08\u7b49\u5f85\uff09\uff1a \u4e00\u4e2a\u7ebf\u7a0b\uff08\u4eba\uff09\u7b49\u5176\u4ed6\u8d44\u6e90\uff08\u6821\u56ed\u5361\uff09\u65f6\uff0c\u4e0d\u4f1a\u91ca\u653e\u5df2\u6709\u7684\u8d44\u6e90\uff08\u6821\u56ed\u5361\uff09</li> <li>No-preemption\uff08\u65e0\u62a2\u5360\uff09\uff1a\u4e0d\u80fd\u62a2\u593a\u4ed6\u4eba\u7684\u8d44\u6e90\uff08\u6821\u56ed\u5361\uff09</li> <li>Circular-chain\uff08\u5faa\u73af\u94fe\uff09\uff1a\u5f62\u6210\u8d44\u6e90\uff08\u6821\u56ed\u5361\uff09\u7684\u5faa\u73af\u7b49\u5f85\u5173\u7cfb</li> </ul> <p>\u56db\u4e2a\u6761\u4ef6 \u201c\u7f3a\u4e00\u4e0d\u53ef\u201d</p> <ul> <li>\u6253\u7834\u4efb\u4f55\u4e00\u4e2a\u5373\u53ef\u907f\u514d\u6b7b\u9501</li> <li>\u5728\u7a0b\u5e8f\u903b\u8f91\u6b63\u786e\u7684\u524d\u63d0\u4e0b \u201c\u6253\u7834\u201d \u6839\u672c\u6ca1\u90a3\u4e48\u5bb9\u6613\u2026\u2026</li> </ul>"},{"location":"courses/os_lab/12_concurrent_bug_category.html#_3","title":"\u6570\u636e\u7ade\u4e89","text":""},{"location":"courses/os_lab/12_concurrent_bug_category.html#_4","title":"\u672c\u8d28","text":"<p>\u4e0d\u540c\u7684\u7ebf\u7a0b\u540c\u65f6\u8bbf\u95ee\u540c\u4e00\u5185\u5b58\uff0c\u4e14\u81f3\u5c11\u6709\u4e00\u4e2a\u662f\u5199\u3002</p> <ul> <li> <p>\u4e24\u4e2a\u5185\u5b58\u8bbf\u95ee\u5728 \u201c\u8d5b\u8dd1\u201d\uff0c\u201c\u8dd1\u8d62\u201d \u7684\u64cd\u4f5c\u5148\u6267\u884c</p> </li> <li> <p>\u4f8b\u5b50\uff1a\u5171\u4eab\u5185\u5b58\u4e0a\u5b9e\u73b0\u7684 Peterson \u7b97\u6cd5</p> </li> </ul> <p>\u8dd1\u8d62\u201d \u5e76\u6ca1\u6709\u60f3\u8c61\u4e2d\u90a3\u4e48\u7b80\u5355</p> <ul> <li>Weak memory model \u5141\u8bb8\u4e0d\u540c\u89c2\u6d4b\u8005\u770b\u5230\u4e0d\u540c\u7ed3\u679c</li> <li>Since C11: data race is undefined behavior</li> </ul> <p></p>"},{"location":"courses/os_lab/12_concurrent_bug_category.html#_5","title":"\u9632\u62a4","text":"<p>\u7528\u9501\u4fdd\u62a4\u597d\u5171\u4eab\u6570\u636e\uff0c\u6d88\u706d\u4e00\u5207\u6570\u636e\u7ade\u4e89</p>"},{"location":"courses/os_lab/12_concurrent_bug_category.html#_6","title":"\u793a\u4f8b","text":"<p>\u9047\u5230\u6570\u636e\u7ade\u4e89\u7684\u5927\u90e8\u5206\u60c5\u51b5</p> <pre><code>// Case #1: \u4e0a\u9519\u4e86\u9501\nvoid thread1() { spin_lock(&amp;lk1); sum++; spin_unlock(&amp;lk1); }\nvoid thread2() { spin_lock(&amp;lk2); sum++; spin_unlock(&amp;lk2); }\n</code></pre> <pre><code>// Case #2: \u5fd8\u8bb0\u4e0a\u9501\nvoid thread1() { spin_lock(&amp;lk1); sum++; spin_unlock(&amp;lk1); }\nvoid thread2() { sum++; }\n</code></pre> <p>\u4e0d\u540c\u7684\u7ebf\u7a0b\u540c\u65f6\u8bbf\u95ee\u540c\u4e00\u5185\u5b58\uff0c\u4e14\u81f3\u5c11\u6709\u4e00\u4e2a\u662f\u5199\u3002</p> <ul> <li>\u201c\u5185\u5b58\u201d \u53ef\u4ee5\u662f\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u4efb\u4f55\u5185\u5b58</li> <li>\u53ef\u4ee5\u662f\u5168\u90e8\u53d8\u91cf</li> <li>\u53ef\u4ee5\u662f\u5806\u533a\u5206\u914d\u7684\u53d8\u91cf</li> <li>\u53ef\u4ee5\u662f\u6808</li> <li>\u201c\u8bbf\u95ee\u201d \u53ef\u4ee5\u662f\u4efb\u4f55\u4ee3\u7801</li> <li>\u53ef\u80fd\u53d1\u751f\u5728\u4f60\u7684\u4ee3\u7801\u91cc</li> <li>\u53ef\u4ee5\u53d1\u751f\u5728\u6846\u67b6\u4ee3\u7801\u91cc</li> <li>\u53ef\u80fd\u662f\u4e00\u884c\u4f60\u6ca1\u6709\u8bfb\u5230\u8fc7\u7684\u6c47\u7f16\u4ee3\u7801</li> <li>\u53ef\u80fd\u65f6\u4e00\u6761 ret \u6307\u4ee4</li> </ul>"},{"location":"courses/os_lab/12_concurrent_bug_category.html#_7","title":"\u539f\u5b50\u6027\u548c\u987a\u5e8f\u8fdd\u53cd","text":""},{"location":"courses/os_lab/12_concurrent_bug_category.html#_8","title":"\u5e76\u53d1\u7f16\u7a0b\u7684\u672c\u8d28","text":"<p>\u4eba\u7c7b\u662f sequential creature\uff1a\u6211\u4eec\u53ea\u80fd\u7528 sequential \u7684\u65b9\u5f0f\u6765\u7406\u89e3\u5e76\u53d1</p> <ul> <li>\u7a0b\u5e8f\u5206\u6210\u82e5\u5e72 \u201c\u5757\u201d\uff0c\u6bcf\u4e00\u5757\u770b\u8d77\u6765\u90fd\u6ca1\u88ab\u6253\u65ad (\u539f\u5b50)</li> <li>\u5177\u6709\u903b\u8f91\u5148\u540e\u7684 \u201c\u5757\u201d \u88ab\u6b63\u786e\u540c\u6b65</li> <li>\u4f8b\u5b50\uff1aproduce \u2192 (happens-before) \u2192 consume</li> </ul> <p>\u5e76\u53d1\u63a7\u5236\u7684\u673a\u5236\u5b8c\u5168\u662f \u201c\u540e\u679c\u81ea\u8d1f\u201d \u7684</p> <ul> <li>\u4e92\u65a5\u9501 (lock/unlock) \u5b9e\u73b0\u539f\u5b50\u6027</li> <li>\u5fd8\u8bb0\u4e0a\u9501\u2014\u2014\u539f\u5b50\u6027\u8fdd\u53cd (Atomicity Violation, AV)</li> <li>\u6761\u4ef6\u53d8\u91cf/\u4fe1\u53f7\u91cf (wait/signal) \u5b9e\u73b0\u5148\u540e\u987a\u5e8f\u540c\u6b65</li> <li>\u5fd8\u8bb0\u540c\u6b65\u2014\u2014\u987a\u5e8f\u8fdd\u53cd (Order Violation, OV)</li> </ul>"},{"location":"courses/os_lab/12_concurrent_bug_category.html#_9","title":"\u90a3\u4e48\uff0c\u7a0b\u5e8f\u5458\u7528\u7684\u5bf9\u4e0d\u5bf9\u5462\uff1f","text":"<p>\u201cEmpirical study\u201d \u5b9e\u8bc1\u7814\u7a76\uff1a\u6536\u96c6\u4e86 105 \u4e2a\u771f\u5b9e\u7cfb\u7edf\u7684\u5e76\u53d1 bugs</p> <ul> <li>MySQL (14/9), Apache (13/4), Mozilla (41/16), OpenOffice (6/2)</li> <li>Learning from mistakes - A comprehensive study on real world concurrency bug characteristics (ASPLOS'08, Most Influential Paper Award)</li> </ul> <p>\u7ed3\u8bba\u4e4b\u4e00\uff1a97% \u7684\u975e\u6b7b\u9501\u5e76\u53d1 bug \u90fd\u662f\u539f\u5b50\u6027\u6216\u987a\u5e8f\u9519\u8bef</p> <ul> <li>\u201c\u4eba\u7c7b\u7684\u786e\u662f sequential creature\u201d</li> </ul>"},{"location":"courses/os_lab/12_concurrent_bug_category.html#av","title":"\u539f\u5b50\u6027\u8fdd\u53cd (AV)","text":"<p>\u201cABA\u201d\uff1aGet-Then-Set\uff0cCheck-Then-Use</p> <p></p> <p>\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u8fd8\u6709\u66f4\u591a\u7684\u5171\u4eab\u72b6\u6001</p> <ul> <li>\u201cTOCTTOU\u201d - time of check to time of use</li> </ul> <p></p> <ul> <li>TOCTTOU vulnerabilities in UNIX-style file systems: An anatomical study (FAST'05)</li> </ul>"},{"location":"courses/os_lab/12_concurrent_bug_category.html#ov","title":"\u987a\u5e8f\u8fdd\u53cd (OV)","text":"<p>\u201cBA\u201d\uff1a\u201c\u600e\u4e48\u5c31\u6ca1\u6309\u6211\u9884\u60f3\u7684\u987a\u5e8f\u6765\u5462\uff1f</p> <ul> <li>\u4f8b\u5b50\uff1aconcurrent use after free</li> </ul> <p></p>"},{"location":"courses/os_lab/12_concurrent_bug_category.html#_10","title":"\u8bfe\u540e\u4e60\u9898/\u7f16\u7a0b\u4f5c\u4e1a","text":""},{"location":"courses/os_lab/12_concurrent_bug_category.html#1","title":"1. \u9605\u8bfb\u6750\u6599","text":"<p>\u6559\u79d1\u4e66 Operating Systems: Three Easy Pieces</p> <ul> <li>\u7b2c 32 \u7ae0 - Event-based Concurrency</li> </ul>"},{"location":"courses/os_lab/13_concurrent_bug_defense.html","title":"\u5e76\u53d1 Bug \u7684\u5e94\u5bf9","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a\u4e00\u8282\u771f\u6b63\u7684 \u201c\u7f16\u7a0b \u201d\u8bfe\uff1a\u5982\u4f55\u6b63\u786e\u5730 (\u5e76\u53d1) \u7f16\u7a0b\uff1a</p> <ul> <li>Lock ordering</li> <li>\u9632\u5fa1\u6027\u7f16\u7a0b</li> <li>\u8fd0\u884c\u65f6\u68c0\u67e5</li> </ul>"},{"location":"courses/os_lab/13_concurrent_bug_defense.html#_1","title":"\u6b7b\u9501\u7684\u5e94\u5bf9","text":""},{"location":"courses/os_lab/13_concurrent_bug_defense.html#_2","title":"\u56de\u987e\uff1a\u6b7b\u9501\u4ea7\u751f\u7684\u5fc5\u8981\u6761\u4ef6","text":"<p>System deadlocks (1971)\uff1a\u6b7b\u9501\u4ea7\u751f\u7684\u56db\u4e2a\u5fc5\u8981\u6761\u4ef6</p> <ul> <li>\u7528 \u201c\u8d44\u6e90\u201d \u6765\u63cf\u8ff0</li> <li> <p>\u72b6\u6001\u673a\u89c6\u89d2\uff1a\u5c31\u662f \u201c\u5f53\u524d\u72b6\u6001\u4e0b\u6301\u6709\u7684\u9501 (\u6821\u56ed\u5361/\u7403)\u201d</p> </li> <li> <p>Mutual-exclusion - \u4e00\u5f20\u6821\u56ed\u5361\u53ea\u80fd\u88ab\u4e00\u4e2a\u4eba\u62e5\u6709</p> </li> <li>Wait-for - \u4e00\u4e2a\u4eba\u7b49\u5176\u4ed6\u6821\u56ed\u5361\u65f6\uff0c\u4e0d\u4f1a\u91ca\u653e\u5df2\u6709\u7684\u6821\u56ed\u5361</li> <li>No-preemption - \u4e0d\u80fd\u62a2\u593a\u4ed6\u4eba\u7684\u6821\u56ed\u5361</li> <li>Circular-chain - \u5f62\u6210\u6821\u56ed\u5361\u7684\u5faa\u73af\u7b49\u5f85\u5173\u7cfb</li> </ul>"},{"location":"courses/os_lab/13_concurrent_bug_defense.html#_3","title":"\u5982\u4f55\u5728\u5b9e\u9645\u7cfb\u7edf\u4e2d\u907f\u514d\u6b7b\u9501\uff1f","text":"<p>\u56db\u4e2a\u6761\u4ef6\u4e2d\u6700\u5bb9\u6613\u8fbe\u6210\u7684</p> <ul> <li>\u907f\u514d\u5faa\u73af\u7b49\u5f85</li> </ul> <p>Lock ordering</p> <ul> <li>\u4efb\u610f\u65f6\u523b\u7cfb\u7edf\u4e2d\u7684\u9501\u90fd\u662f\u6709\u9650\u7684</li> <li>\u4e25\u683c\u6309\u7167\u56fa\u5b9a\u7684\u987a\u5e8f\u83b7\u5f97\u6240\u6709\u9501 (Lock Ordering)\uff0c\u5c31\u53ef\u4ee5\u6d88\u706d\u5faa\u73af\u7b49\u5f85</li> <li>\u201c\u5728\u4efb\u610f\u65f6\u523b\u83b7\u5f97 \u201c\u6700\u9760\u540e\u201d \u9501\u7684\u7ebf\u7a0b\u603b\u662f\u53ef\u4ee5\u7ee7\u7eed\u6267\u884c\u201d</li> <li>\u4f8b\u5b50\uff1a\u4fee\u590d\u54f2\u5b66\u5bb6\u5403\u996d\u95ee\u9898</li> </ul>"},{"location":"courses/os_lab/13_concurrent_bug_defense.html#lock-ordering-linux-kernel-rmapc","title":"Lock Ordering: \u5e94\u7528 (Linux Kernel: rmap.c)","text":""},{"location":"courses/os_lab/13_concurrent_bug_defense.html#_4","title":"\u96be\u70b9","text":"<p>Textbooks will tell you that if you always lock in the same order, you will never get this kind of deadlock. Practice will tell you that this approach doesn't scale: when I create a new lock, I don't understand enough of the kernel to figure out where in the 5000 lock hierarchy it will fit.</p> <p>The best locks are encapsulated: they never get exposed in headers, and are never held around calls to non-trivial functions outside the same file. You can read through this code and see that it will never deadlock, because it never tries to grab another lock while it has that one. People using your code don't even need to know you are using a lock.</p> <p>\u2014\u2014 Unreliable Guide to Locking by Rusty Russell</p>"},{"location":"courses/os_lab/13_concurrent_bug_defense.html#bug_1","title":"Bug \u7684\u672c\u8d28\u548c\u9632\u5fa1\u6027\u7f16\u7a0b","text":""},{"location":"courses/os_lab/13_concurrent_bug_defense.html#bugs","title":"\u7f16\u7a0b\u8bed\u8a00\u4e0e Bugs","text":"<p>\u7f16\u8bd1\u5668/\u7f16\u7a0b\u8bed\u8a00</p> <ul> <li> <p>\u53ea\u7ba1 \u201c\u7ffb\u8bd1\u201d \u4ee3\u7801\uff0c\u4e0d\u7ba1\u548c\u5b9e\u9645\u9700\u6c42 (\u89c4\u7ea6) \u662f\u5426\u5339\u914d</p> </li> <li> <p>\u201c\u5c71\u5be8\u652f\u4ed8\u5b9d\u201d \u4e2d\u7684\u4f59\u989d <code>balance</code></p> </li> <li> <p>\u6b63\u5e38\u4eba\u770b\u5230 0 \u2192 18446744073709551516 \u90fd\u8ba4\u4e3a \u201c\u8fd9\u4ef6\u4e8b\u4e0d\u5bf9\u201d (\u201cbalance\u201d \u81ea\u5e26 no-underflow \u7684\u542b\u4e49)</p> </li> </ul> <p>\u600e\u4e48\u624d\u80fd\u7f16\u5199\u51fa \u201c\u6b63\u786e\u201d (\u7b26\u5408 specification) \u7684\u7a0b\u5e8f\uff1f</p> <ul> <li>\u8bc1\u660e\uff1aAnnotation verifier (Dafny), Refinement types</li> <li>\u63a8\u6d4b\uff1aSpecification mining (Daikon)</li> <li>\u6784\u9020\uff1aProgram sketching</li> <li>\u7f16\u7a0b\u8bed\u8a00\u7684\u5386\u53f2\u548c\u672a\u6765</li> <li>\u673a\u5668\u8bed\u8a00 \u2192 \u6c47\u7f16\u8bed\u8a00 \u2192 \u9ad8\u7ea7\u8bed\u8a00 \u2192 \u81ea\u7136\u7f16\u7a0b\u8bed\u8a00</li> </ul>"},{"location":"courses/os_lab/13_concurrent_bug_defense.html#_5","title":"\u9632\u5fa1\u6027\u7f16\u7a0b\uff1a\u5b9e\u8df5","text":"<p>\u628a\u7a0b\u5e8f\u9700\u8981\u6ee1\u8db3\u7684\u6761\u4ef6\u7528 assert \u8868\u8fbe\u51fa\u6765\u3002</p> <p>\u53ca\u65e9\u68c0\u67e5\u3001\u53ca\u65e9\u62a5\u544a\u3001\u53ca\u65e9\u4fee\u590d</p> <ul> <li>\u4e8c\u53c9\u6811\u7684\u65cb\u8f6c</li> <li><code>assert(p-&gt;parent-&gt;left == p || p-&gt;parent-&gt;right == p);</code></li> <li>AA-Deadlock \u7684\u68c0\u67e5</li> <li><code>if (holding(&amp;lk)) panic();</code></li> <li>xv6 spinlock \u5b9e\u73b0\u793a\u4f8b\uff1aAA \u578b\u6b7b\u9501\u3001double release\u3001\u91ca\u653e\u975e\u672c\u5904\u7406\u5668\u6301\u6709\u7684\u9501\u7b49\u3002</li> </ul> <pre><code>#define CHECK_INT(x, cond) \\\n  ({ panic_on(!((x) cond), \"int check fail: \" #x \" \" #cond); })\n#define CHECK_HEAP(ptr) \\\n  ({ panic_on(!IN_RANGE((ptr), heap)); })\n</code></pre> <p>\u53d8\u91cf\u6709 \u201ctyped annotation\u201d</p> <ul> <li><code>CHECK_INT(waitlist-&gt;count, &gt;= 0);</code></li> <li><code>CHECK_INT(pid, &lt; MAX_PROCS);</code></li> <li><code>CHECK_HEAP(ctx-&gt;rip); CHECK_HEAP(ctx-&gt;cr3);</code></li> <li>\u53d8\u91cf\u542b\u4e49\u6539\u53d8 \u2192 \u53d1\u751f\u5947\u602a\u95ee\u9898 (overflow, memory error, ...)</li> <li>\u4e0d\u8981\u5c0f\u770b\u8fd9\u4e9b\u68c0\u67e5\uff0c\u5b83\u4eec\u5728\u5e95\u5c42\u7f16\u7a0b (M2, L1, ...) \u65f6\u975e\u5e38\u5e38\u89c1</li> <li>\u5728\u865a\u62df\u673a\u795e\u79d8\u91cd\u542f/\u5361\u4f4f/...\u524d\u53d1\u51fa\u8b66\u62a5</li> </ul>"},{"location":"courses/os_lab/13_concurrent_bug_defense.html#_6","title":"\u81ea\u52a8\u8fd0\u884c\u65f6\u68c0\u67e5","text":""},{"location":"courses/os_lab/13_concurrent_bug_defense.html#_7","title":"\u52a8\u6001\u7a0b\u5e8f\u5206\u6790","text":"<p>\u901a\u7528 (\u56fa\u5b9a) bug \u6a21\u5f0f\u7684\u81ea\u52a8\u68c0\u67e5</p> <ul> <li>ABBA \u578b\u6b7b\u9501</li> <li>\u6570\u636e\u7ade\u4e89</li> <li>\u5e26\u7b26\u53f7\u6574\u6570\u6ea2\u51fa (undefined behavior)</li> <li>Use after free</li> <li>\u2026\u2026</li> </ul> <p>\u52a8\u6001\u7a0b\u5e8f\u5206\u6790\uff1a\u72b6\u6001\u673a\u6267\u884c\u5386\u53f2\u7684\u4e00\u4e2a\u51fd\u6570 f(\u03c4)</p> <ul> <li>\u4ed8\u51fa\u7a0b\u5e8f\u6267\u884c\u53d8\u6162\u7684\u4ee3\u4ef7</li> <li>\u627e\u5230\u66f4\u591a bugs</li> </ul>"},{"location":"courses/os_lab/13_concurrent_bug_defense.html#lockdep-lock-ordering","title":"Lockdep: \u8fd0\u884c\u65f6 Lock Ordering \u68c0\u67e5","text":"<p>Lockdep \u7684\u5b9e\u73b0</p> <ul> <li>Since Linux Kernel 2.6.17, also in OpenHarmony!</li> </ul> <p>Lockdep \u89c4\u7ea6 (Specification)</p> <ul> <li>\u4e3a\u6bcf\u4e00\u4e2a\u9501\u786e\u5b9a\u552f\u4e00\u7684 \u201callocation site\u201d</li> <li>assert: \u540c\u4e00\u4e2a allocation site \u7684\u9501\u5b58\u5728\u5168\u5c40\u552f\u4e00\u7684\u4e0a\u9501\u987a\u5e8f</li> </ul> <p>\u68c0\u67e5\u65b9\u6cd5\uff1aprintf</p> <ul> <li>\u8bb0\u5f55\u6240\u6709\u89c2\u5bdf\u5230\u7684\u4e0a\u9501\u987a\u5e8f\uff0c\u4f8b\u5982 \\([x,y,z]=&gt;x \\rightarrow y,x \\rightarrow z,y \\rightarrow z\\)</li> <li>\u68c0\u67e5\u662f\u5426\u5b58\u5728\\(x \\rightarrow y\u2227y \\rightarrow x\\)</li> <li>\u6211\u4eec\u6709\u4e00\u4e2a \u201c\u5c71\u5be8\u7248\u201d \u7684\u4f8b\u5b50</li> </ul>"},{"location":"courses/os_lab/13_concurrent_bug_defense.html#threadsanitizer","title":"ThreadSanitizer: \u8fd0\u884c\u65f6\u7684\u6570\u636e\u7ade\u4e89\u68c0\u67e5","text":"<p>\u4f9d\u8d56\u7f16\u8bd1\u5668\uff1a\u7f16\u8bd1\u5668\u77e5\u9053\u6bcf\u4e00\u6b21\u7684\u5185\u5b58\u8bbf\u95ee</p> <p>\u5e76\u53d1\u7a0b\u5e8f\u7684\u6267\u884c trace</p> <ul> <li>\u5185\u5b58\u8bfb\u5199\u6307\u4ee4 (load/store)</li> <li>\u540c\u6b65\u51fd\u6570\u8c03\u7528</li> <li>Happens-before: program order \u548c release acquire \u7684\u4f20\u9012\u95ed\u5305</li> </ul> <p>\u5bf9\u4e8e\u53d1\u751f\u5728\u4e0d\u540c\u7ebf\u7a0b\u4e14\u81f3\u5c11\u6709\u4e00\u4e2a\u662f\u5199\u7684 x,y \u68c0\u67e5\uff08\u56fe\u8bba\u7684\u53ef\u8fbe\u6027\u68c0\u67e5\uff09</p> <p>\u200b                                                               \\(x\u227ay\u2228y\u227ax\\)</p> <ul> <li>\u5b9e\u73b0\uff1aLamport's Vector Clock</li> <li>Time, clocks, and the ordering of events in a distributed system</li> </ul>"},{"location":"courses/os_lab/13_concurrent_bug_defense.html#sanitizers","title":"\u66f4\u591a\u7684 Sanitizers","text":"<p>\u73b0\u4ee3\u590d\u6742\u8f6f\u4ef6\u7cfb\u7edf\u5fc5\u5907\u7684\u652f\u6491\u5de5\u5177</p> <ul> <li>AddressSanitizer(asan); (paper): \u975e\u6cd5\u5185\u5b58\u8bbf\u95ee</li> <li>Buffer (heap/stack/global) overflow, use-after-free, use-after-return, double-free, ...</li> <li>Linux Kernel \u4e5f\u6709 kasan</li> <li>ThreadSanitizer (tsan): \u6570\u636e\u7ade\u4e89</li> <li>MemorySanitizer (msan): \u672a\u521d\u59cb\u5316\u7684\u8bfb\u53d6</li> <li>UBSanitizer (ubsan): undefined behavior</li> <li>Misaligned pointer, signed integer overflow, ...</li> <li>Kernel \u4f1a\u5e26\u7740 <code>-fwrapv</code> \u7f16\u8bd1</li> </ul>"},{"location":"courses/os_lab/13_concurrent_bug_defense.html#_8","title":"\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u9a8c\u4e2d\u7684\u9632\u5fa1\u6027\u7f16\u7a0b","text":""},{"location":"courses/os_lab/13_concurrent_bug_defense.html#_9","title":"\u9762\u5bf9\u7684\u56f0\u5883","text":"<p>\u7406\u8bba\u5f88\u7f8e\u597d\uff0c\u73b0\u5b9e\u5f88\u6b8b\u9177</p> <ul> <li>\u6211\u4eec\u7684\u6846\u67b6\u76f4\u63a5\u8fd0\u884c\u5728\u865a\u62df\u673a\u4e0a</li> <li> <p>\u6839\u672c\u6ca1\u6cd5\u5e26\u8fd9\u4e9b sanitizers</p> </li> <li> <p>\u6211\u4eec\u6839\u672c\u4e0d\u53ef\u80fd \u201c\u89c2\u6d4b\u6bcf\u4e00\u6b21\u5171\u4eab\u5185\u5b58\u8bbf\u95ee\u201d</p> </li> <li>\u76f4\u63a5\u6446\u70c2</li> <li>(\u56f0\u96be\u662f\u6446\u70c2\u7684\u7b2c\u4e00\u539f\u56e0)</li> </ul> <p>\u53e6\u4e00\u79cd\u601d\u8def (rule of thumb)</p> <ul> <li>\u4e0d\u5b9e\u73b0 \u201c\u5b8c\u6574\u201d \u7684\u68c0\u67e5</li> <li>\u5141\u8bb8\u5b58\u5728\u8bef\u62a5/\u6f0f\u62a5</li> <li>\u4f46\u5b9e\u73b0\u7b80\u5355\u3001\u975e\u5e38\u6709\u7528</li> </ul>"},{"location":"courses/os_lab/13_concurrent_bug_defense.html#buffer-overrun","title":"\u4f8b\u5b50\uff1aBuffer Overrun \u68c0\u67e5","text":"<p>\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e2d\u7684 canary (\u91d1\u4e1d\u96c0) \uff1a\u7a0b\u5e8f\u8fd0\u884c\u65f6\u6ca1\u6709\u52a8\u7269\u53d7\u5230\u5b9e\u8d28\u7684\u4f24\u5bb3</p> <ul> <li>\u201c\u727a\u7272\u201d \u4e00\u4e9b\u5185\u5b58\u5355\u5143\uff0c\u6765\u9884\u8b66 memory error \u7684\u53d1\u751f</li> </ul> <p>\u4fdd\u62a4\u6808\u7a7a\u95f4 (Stack Guard)</p> <pre><code>#define MAGIC 0x55555555\n#define BOTTOM (STK_SZ / sizeof(u32) - 1)\nstruct stack { char data[STK_SZ]; };\n\nvoid canary_init(struct stack *s) {\n  u32 *ptr = (u32 *)s;\n  for (int i = 0; i &lt; CANARY_SZ; i++)\n    ptr[BOTTOM - i] = ptr[i] = MAGIC;\n}\n\nvoid canary_check(struct stack *s) {\n  u32 *ptr = (u32 *)s;\n  for (int i = 0; i &lt; CANARY_SZ; i++) {\n    panic_on(ptr[BOTTOM - i] != MAGIC, \"underflow\");\n    panic_on(ptr[i] != MAGIC, \"overflow\");\n  }\n}\n</code></pre>"},{"location":"courses/os_lab/13_concurrent_bug_defense.html#_10","title":"\u70eb\u70eb\u70eb\u3001\u5c6f\u5c6f\u5c6f\u548c\u847a\u847a\u847a","text":"<p>msvc \u4e2d debug mode \u7684 guard/fence/canary (\u5b83\u4eec\u4e00\u76f4\u5728\u65e0\u5f62\u4e2d\u4fdd\u62a4\u4f60)</p> <ul> <li>\u672a\u521d\u59cb\u5316\u6808: <code>0xcccccccc</code></li> <li>\u672a\u521d\u59cb\u5316\u5806: <code>0xcdcdcdcd</code></li> <li>\u5bf9\u8c61\u5934\u5c3e: <code>0xfdfdfdfd</code></li> <li>\u5df2\u56de\u6536\u5185\u5b58: <code>0xdddddddd</code></li> <li>\u624b\u6301\u4e24\u628a\u951f\u65a4\u62f7\uff0c\u53e3\u4e2d\u75be\u547c\u70eb\u70eb\u70eb</li> <li>\u811a\u8e0f\u5343\u6735\u5c6f\u5c6f\u5c6f\uff0c\u7b11\u770b\u4e07\u7269\u9518\u9518\u9518</li> </ul> <pre><code>(b'\\xcc' * 80).decode('gb2312')\n</code></pre>"},{"location":"courses/os_lab/13_concurrent_bug_defense.html#lockdep","title":"\u9632\u5fa1\u6027\u7f16\u7a0b\uff1a\u4f4e\u914d\u7248 Lockdep","text":"<p>\u4e0d\u5fc5\u5927\u8d39\u5468\u7ae0\u8bb0\u5f55\u4ec0\u4e48\u4e0a\u9501\u987a\u5e8f</p> <ul> <li>\u7edf\u8ba1\u5f53\u524d\u7684 spin count</li> <li>\u5982\u679c\u8d85\u8fc7\u67d0\u4e2a\u660e\u663e\u4e0d\u6b63\u5e38\u7684\u6570\u503c (1,000,000,000) \u5c31\u62a5\u544a</li> </ul> <pre><code>int count = 0;\nwhile (xchg(&amp;lk, LOCKED) == LOCKED) {\n  if (count++ &gt; SPIN_LIMIT) {\n    panic(\"Spin limit exceeded @ %s:%d\\n\", __FILE__, __LINE__);\n  }\n}\n</code></pre> <ul> <li>\u914d\u5408\u8c03\u8bd5\u5668\uff08\u65ad\u70b9\uff09\u548c\u7ebf\u7a0b backtrace \u4e00\u79d2\u8bca\u65ad\u6b7b\u9501</li> </ul>"},{"location":"courses/os_lab/13_concurrent_bug_defense.html#addresssanitizer-l1","title":"\u9632\u5fa1\u6027\u7f16\u7a0b\uff1a\u4f4e\u914d\u7248 AddressSanitizer (L1)","text":"<p>\u5185\u5b58\u5206\u914d\u8981\u6c42\uff1a\u5df2\u5206\u914d\u5185\u5b58 S=[\u21130,r0)\u222a[\u21131,r1)\u222a\u2026</p> <ul> <li>kalloc(s) \u8fd4\u56de\u7684 [\u2113,r) \u5fc5\u987b\u6ee1\u8db3 [\u2113,r)\u2229S=\u2205</li> <li>thread-local allocation + \u5e76\u53d1\u7684 free \u8fd8\u86ee\u5bb9\u6613\u5f04\u9519\u7684</li> </ul> <pre><code>// double allocation check\nfor (int i = 0; (i + 1) * sizeof(u32) &lt;= size; i++) {\n  panic_on(((u32 *)ptr)[i] == MAGIC, \"double-allocation\");\n  arr[i] = MAGIC;\n}\n\n// double free check\nfor (int i = 0; (i + 1) * sizeof(u32) &lt;= alloc_size(ptr); i++) {\n  panic_on(((u32 *)ptr)[i] == 0, \"double-free\");\n  arr[i] = 0;\n}\n</code></pre>"},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html","title":"\u591a\u5904\u7406\u5668\u7cfb\u7edf\u4e0e\u4e2d\u65ad\u673a\u5236","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u5b9e\u73b0</p> <ul> <li>\u591a\u5904\u7406\u5668\u548c\u4e2d\u65ad</li> <li>AbstractMachine API</li> <li>50 \u884c\u5b9e\u73b0\u5d4c\u5165\u5f0f\u64cd\u4f5c\u7cfb\u7edf</li> </ul> <p>\u4e3a\u4ec0\u4e48 <code>while (1)</code> \u4e0d\u4f1a\u628a\u64cd\u4f5c\u7cfb\u7edf \u201c\u5361\u6b7b\u201d\uff1a</p> <ul> <li>\u5728\u64cd\u4f5c\u7cfb\u7edf\u4ee3\u7801\u5207\u6362\u5230\u5e94\u7528\u7a0b\u5e8f\u6267\u884c\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4f1a\u6253\u5f00\u4e2d\u65ad</li> <li>\u201c\u4e0d\u53ef\u4fe1\u4efb\u201d \u7684\u5e94\u7528\u7a0b\u5e8f\u5b9a\u671f\u4f1a\u6536\u5230\u65f6\u949f\u4e2d\u65ad\u88ab\u6253\u65ad\uff0c\u4e14\u5e94\u7528\u7a0b\u5e8f\u65e0\u6743\u914d\u7f6e\u4e2d\u65ad</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u63a5\u7ba1\u4e2d\u65ad\u540e\uff0c\u53ef\u4ee5\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u6267\u884c</li> </ul>"},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html#_2","title":"\u591a\u5904\u7406\u5668\u4e0a\u7684\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838","text":""},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html#abstractmachine-trm","title":"AbstractMachine: TRM","text":"<p>Turing Machine: \u4e00\u4e2a\u5904\u7406\u5668\uff0c\u4e00\u4e2a\u5730\u5740\u7a7a\u95f4</p> <ul> <li>\u201c\u65e0\u60c5\u7684\u6267\u884c\u6307\u4ee4\u7684\u673a\u5668\u201d (rvemu) \u7684\u62bd\u8c61</li> <li>\u53ef\u7528\u7684\u5185\u5b58\u662f\u9759\u6001\u53d8\u91cf\u548c <code>heap</code></li> <li>\u53ea\u80fd\u6267\u884c\u8ba1\u7b97\u6307\u4ee4\u548c putch, halt</li> </ul> <p></p>"},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html#abstractmachine-mpe","title":"AbstractMachine: MPE","text":"<p>Multiprocessing Extension: \u591a\u4e2a\u5904\u7406\u5668\uff0c\u4e00\u4e2a\u5730\u5740\u7a7a\u95f4</p> <ul> <li>\u53ef\u7528\u7684\u5730\u5740\u7a7a\u95f4\u4f9d\u7136\u662f\u9759\u6001\u53d8\u91cf\u548c <code>heap</code> (\u5904\u7406\u5668\u95f4\u5171\u4eab)</li> <li>\u201c\u591a\u4e2a Turing Machine\uff0c\u5171\u4eab\u4e00\u4e2a\u7eb8\u5e26\u201d</li> </ul> <p>\u72b6\u6001\u673a\u6a21\u578b\u53d1\u751f\u4e86\u6539\u53d8</p> <ul> <li>\u72b6\u6001\uff1a\u5171\u4eab\u5185\u5b58\u548c\u6bcf\u4e2a\u5904\u7406\u5668\u7684\u5185\u90e8\u72b6\u6001</li> </ul> <p>\u200b                                                     \\((M,R_1,R_2,\u2026,R_n)\\)</p> <ul> <li> <p>\u72b6\u6001\u8fc1\u79fb\uff1a\u5904\u7406\u5668 t \u5206\u9694\u51fa\u4e00\u4e2a \u201c\u5355\u5904\u7406\u5668\u8ba1\u7b97\u673a\u201d</p> </li> <li> <p>\u6267\u884c\\((M,R_t)\u2192(M^\u2032,R_t^\u2032)\\)</p> <p>\u200b                                               v\\((M,R_1,R_2,\u2026,R_n)\u2192(M^\u2032,R_1,R_2,\u2026,R_t^\u2032,\u2026,R_n)\\)</p> </li> </ul>"},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html#l1","title":"\u7b80\u6613\u591a\u5904\u7406\u5668\u5185\u6838 (L1 \u7684\u6a21\u578b)","text":"<p>\u4e0e\u591a\u7ebf\u7a0b\u7a0b\u5e8f\u5b8c\u5168\u4e00\u81f4</p> <ul> <li>\u540c\u6b65\u4ec5\u80fd\u901a\u8fc7\u539f\u5b50\u6307\u4ee4\u5982 <code>xchg</code> \u5b9e\u73b0</li> </ul> <pre><code>uint8_t shm[MEM_SIZE]; // Shared memory\n\nvoid Tprocessor() {\n  struct cpu_state s;\n  while (1) {\n    fetch_decode_exec(&amp;s, shm);\n  }\n}\n\nint main() {\n  for (int i = 0; i &lt; NPROC; i++) {\n    create(Tprocessor);\n  }\n}\n</code></pre>"},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html#_3","title":"\u4e2d\u65ad\u673a\u5236","text":""},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html#_4","title":"\u7406\u89e3\u4e2d\u65ad","text":"<p>\u786c\u4ef6\u4e0a\u7684\u4e2d\u65ad\uff1a\u4e00\u6839\u7ebf</p> <ul> <li>\\(\\overline{IRQ}, \\overline{NMI}\\)\uff08\u8fb9\u6cbf\u89e6\u53d1\uff0c\u4f4e\u7535\u5e73\u6709\u6548\uff09\uff1aIRQ\uff08\u4e2d\u65ad\u8981\u6c42\uff09\uff0cNMI\uff08\u4e0d\u53ef\u5c4f\u853d\u4e2d\u65ad\uff09</li> <li>\u201c\u544a\u8bc9\u5904\u7406\u5668\uff1a\u505c\u505c\uff0c\u6709\u4e8b\u6765\u4e86\u201d</li> <li>\u5269\u4e0b\u7684\u884c\u4e3a\u4ea4\u7ed9\u5904\u7406\u5668\u5904\u7406</li> </ul> <p>\u5b9e\u9645\u7684\u5904\u7406\u5668\u5e76\u4e0d\u662f \u201c\u65e0\u60c5\u5730\u6267\u884c\u6307\u4ee4\u201d</p> <ul> <li>\u65e0\u60c5\u7684\u6267\u884c\u6307\u4ee4</li> <li>\u540c\u65f6\u6709\u60c5\u5730\u54cd\u5e94\u5916\u90e8\u7684\u6253\u65ad</li> </ul> <p></p>"},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html#_5","title":"\u5904\u7406\u5668\u7684\u4e2d\u65ad\u884c\u4e3a","text":"<p>\u201c\u54cd\u5e94\u201d</p> <ul> <li>\u9996\u5148\u68c0\u67e5\u5904\u7406\u5668\u914d\u7f6e\u662f\u5426\u5141\u8bb8\u4e2d\u65ad</li> <li>\u5982\u679c\u5904\u7406\u5668\u5173\u95ed\u4e2d\u65ad\uff0c\u5219\u5ffd\u7565</li> <li>x86 Family</li> <li>\u8be2\u95ee\u4e2d\u65ad\u63a7\u5236\u5668\u83b7\u5f97\u4e2d\u65ad\u53f7 n</li> <li>\u4fdd\u5b58 CS, RIP, RFLAGS, SS, RSP \u5230\u5806\u6808</li> <li>\u8df3\u8f6c\u5230 <code>IDT[n]</code> \u6307\u5b9a\u7684\u5730\u5740\uff0c\u5e76\u8bbe\u7f6e\u5904\u7406\u5668\u72b6\u6001 (\u4f8b\u5982\u5173\u95ed\u4e2d\u65ad)</li> <li>RISC-V (M-Mode)</li> <li>\u68c0\u67e5 mie \u662f\u5426\u5c4f\u853d\u6b64\u6b21\u4e2d\u65ad</li> <li>\u8df3\u8f6c <code>PC = (mtvec &amp; ~0xf)</code></li> <li>\u66f4\u65b0 <code>mcause.Interrupt = 1</code></li> </ul>"},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html#risc-v-m-mode-rtfsc","title":"RISC-V M-Mode \u4e2d\u65ad\u884c\u4e3a RTFSC","text":"<p>\u201c\u66f4\u591a\u7684\u5904\u7406\u5668\u5185\u90e8\u72b6\u6001\u201d</p> <ul> <li>TFM Volume II: Privileged Architecture</li> </ul> <pre><code>struct MiniRV32IMAState {\n  uint32_t regs[32], pc;\n  uint32_t mstatus;\n  uint32_t cyclel, cycleh;\n  uint32_t timerl, timerh, timermatchl, timermatchh;\n  uint32_t mscratch, mtvec, mie, mip;\n  uint32_t mepc, mtval, mcause;\n  // Note: only a few bits are used.  (Machine = 3, User = 0)\n  // Bits 0..1 = privilege.\n  // Bit 2 = WFI (Wait for interrupt)\n  // Bit 3+ = Load/Store reservation LSBs.\n  uint32_t extraflags;\n};\n</code></pre>"},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html#_6","title":"\u4e2d\u65ad\uff1a\u5960\u5b9a\u64cd\u4f5c\u7cfb\u7edf \u201c\u9738\u4e3b\u5730\u4f4d\u201d \u7684\u673a\u5236","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838 (\u4ee3\u7801)\uff1a\u60f3\u5f00\u5c31\u5f00\uff0c\u60f3\u5173\u5c31\u5173</p> <p>\u5e94\u7528\u7a0b\u5e8f\uff1a\u5bf9\u4e0d\u8d77\uff0c\u6ca1\u6709\u4e2d\u65ad\uff08\u6b7b\u5faa\u73af\u4e5f\u53ef\u4ee5\u88ab\u6253\u65ad\uff09</p> <ul> <li>\u5728 gdb \u91cc\u53ef\u4ee5\u770b\u5230 flags \u5bc4\u5b58\u5668 (<code>FL_IF</code>)</li> <li>CLI \u2014 Clear Interrupt Flag</li> <li><code>#GP(0)</code> If CPL is greater than IOPL and less than 3</li> <li>\u8bd5\u4e00\u8bd5 <code>asm volatile (\"cli\");</code>\uff1asegment fault\uff1b</li> </ul>"},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html#abstractmachine-api","title":"AbstractMachine \u4e2d\u65ad API","text":"<p>\u9694\u79bb\u51fa\u4e00\u5757 \u201c\u5904\u7406\u4e8b\u4ef6\u201d \u7684\u4ee3\u7801\u6267\u884c\u65f6\u7a7a</p> <ul> <li>\u6267\u884c\u5b8c\u540e\uff0c\u53ef\u4ee5\u8fd4\u56de\u5230\u88ab\u4e2d\u65ad\u7684\u4ee3\u7801\u7ee7\u7eed\u6267\u884c</li> </ul> <pre><code>bool cte_init(Context *(*handler)(Event ev, Context *ctx)); // interrupt handler\nbool ienabled(void);  // interrupt enabled or not\nvoid iset(bool enable);  // set interrupt\n</code></pre> <p>\u4e2d\u65ad\u5f15\u5165\u4e86\u5e76\u53d1</p> <ul> <li>\u6700\u65e9\u64cd\u4f5c\u7cfb\u7edf\u7684\u5e76\u53d1\u6027\u5c31\u662f\u6765\u81ea\u4e8e\u4e2d\u65ad (\u800c\u4e0d\u662f\u591a\u5904\u7406\u5668)</li> <li>\u5173\u95ed\u4e2d\u65ad\u5c31\u80fd\u5b9e\u73b0\u4e92\u65a5</li> <li>\u7cfb\u7edf\u4e2d\u53ea\u6709\u4e00\u4e2a\u5904\u7406\u5668\uff0c\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u6253\u65ad</li> <li>\u5173\u4e2d\u65ad\u5b9e\u73b0\u4e86 \u201cstop the world\u201d</li> </ul>"},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html#_7","title":"\u771f\u6b63\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u6a21\u578b","text":"<p>\u72b6\u6001\uff1a\u5171\u4eab\u5185\u5b58\u548c\u6bcf\u4e2a\u5904\u7406\u5668\u7684\u5185\u90e8\u72b6\u6001\\((M,R_1,R_2,\u2026,R_n)\\)</p> <p>\u72b6\u6001\u8fc1\u79fb</p> <ol> <li>\u5904\u7406\u5668 t \u6267\u884c\u4e00\u6b65$ (M,R_t)\u2192(M^\u2032,R_t^\u2032)$</li> <li>\u65b0\u72b6\u6001\u4e3a \\((M^\u2032,R_1,R_2,\u2026,R_t\u2032,\u2026,R_n)\\)</li> <li>\u5904\u7406\u5668 t \u54cd\u5e94\u4e2d\u65ad</li> </ol> <p>\u5047\u8bbe race-freedom</p> <ul> <li>\u4e0d\u4f1a\u53d1\u751f relaxed memory behavior</li> <li>\u6a21\u578b\u80fd\u89e6\u53d1\u7684\u884c\u4e3a\u5c31\u662f\u771f\u5b9e\u7cfb\u7edf\u80fd\u89e6\u53d1\u7684\u6240\u6709\u884c\u4e3a</li> </ul>"},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html#_8","title":"\u4f8b\u5b50\uff1a\u5b9e\u73b0\u4e2d\u65ad\u5b89\u5168\u7684\u81ea\u65cb\u9501","text":"<p>\u5185\u6838\u4e2d\u7684\u7ebf\u7a0b\u5e76\u53d1\u3002</p> <p>\u5b9e\u73b0\u539f\u5b50\u6027\uff1a</p> <pre><code>printf(\"Hello\\n\");\n</code></pre> <ul> <li>printf \u65f6\u53ef\u80fd\u53d1\u751f\u4e2d\u65ad</li> <li>\u591a\u4e2a\u5904\u7406\u5668\u53ef\u80fd\u540c\u65f6\u6267\u884c printf</li> </ul> <p>\u8fd9\u4ef6\u4e8b\u6ca1\u6709\u5927\u5bb6\u60f3\u7684\u7b80\u5355</p> <ul> <li>\u591a\u5904\u7406\u5668\u548c\u4e2d\u65ad\u662f\u4e24\u4e2a\u5e76\u53d1\u6765\u6e90</li> </ul>"},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html#50","title":"50 \u884c\u5b9e\u73b0\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838","text":""},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html#_9","title":"\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u7684\u79d8\u5bc6","text":"<p>\u53c2\u6570\u548c\u8fd4\u56de\u503c \u201cContext\u201d</p> <pre><code>Context *handler(Event ev, Context *ctx) {\n  ...\n}\n</code></pre> <ul> <li>\u4e2d\u65ad\u53d1\u751f\u540e\uff0c\u4e0d\u80fd\u6267\u884c \u201c\u4efb\u4f55\u4ee3\u7801\u201d</li> <li><code>movl $1, %rax</code> \u5148\u524d\u72b6\u6001\u673a\u5c31\u88ab\u6c38\u4e45 \u201c\u7834\u574f\u201d \u4e86</li> <li>\u9664\u975e\u628a\u4e2d\u65ad\u77ac\u95f4\u7684\u5904\u7406\u5668\u72b6\u6001\u4fdd\u5b58\u4e0b\u6765</li> <li>\u4e2d\u65ad\u8fd4\u56de\u65f6\u9700\u8981\u628a\u5bc4\u5b58\u5668\u6062\u590d\u5230\u5904\u7406\u5668\u4e0a</li> <li>\u770b\u770b Context \u91cc\u6709\u4ec0\u4e48\u5427</li> </ul>"},{"location":"courses/os_lab/14_multi_cpu_and_interrupt.html#_10","title":"\u5b9e\u73b0\u591a\u5904\u7406\u5668\u591a\u7ebf\u7a0b","text":"<p>AbstractMachine API</p> <ul> <li>\u4f60\u53ea\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u6808\uff0c\u5c31\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u53ef\u8fd0\u884c\u7684 context</li> </ul> <pre><code>Context *on_interrupt(Event ev, Context *ctx) {\n  if (!current) {\n    current = &amp;tasks[0];  // First trap for this CPU\n  } else {\n    current-&gt;context = ctx; // Keep the stack-saved context\n  }\n\n  // Schedule\n  do {\n    current = current-&gt;next;\n  } while (!on_this_cpu(current));\n\n  return current-&gt;context;\n}\n</code></pre>"},{"location":"courses/os_lab/15_kernel_thread_and_process.html","title":"\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u8fdb\u7a0b","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u8fdb\u7a0b</p> <ul> <li>\u7ebf\u7a0b\u3001\u8fdb\u7a0b\u548c\u64cd\u4f5c\u7cfb\u7edf</li> <li>UNIX/Linux \u8fdb\u7a0b\u7ba1\u7406 API</li> </ul>"},{"location":"courses/os_lab/15_kernel_thread_and_process.html#_2","title":"\u7ebf\u7a0b\u3001\u8fdb\u7a0b\u548c\u64cd\u4f5c\u7cfb\u7edf","text":"<p>\u5728 UNIX/Linux \u7cfb\u7edf\u5185\u6838\u5b8c\u6210\u521d\u59cb\u5316\u540e\uff0c\u53ea\u6709\u4e00\u4e2a init \u8fdb\u7a0b\u88ab\u542f\u52a8\u3002</p> <ul> <li>init \u8fdb\u7a0b\u8ddf <code>/usr/sbin/init</code>\u662f\u4e0d\u4e00\u6837\u7684</li> </ul> <p>\u6b64\u540e\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u5c31\u5316\u8eab\u4e3a\u4e86\u4e00\u4e2a\u4e8b\u4ef6\u9a71\u52a8\u7684\u7a0b\u5e8f\u3001\u72b6\u6001\u673a\u7684\u7ba1\u7406\u8005\uff0c\u4ec5\u5728\u4e2d\u65ad\u548c\u7cfb\u7edf\u8c03\u7528\u53d1\u751f\u65f6\u5f00\u59cb\u6267\u884c\u3002</p>"},{"location":"courses/os_lab/15_kernel_thread_and_process.html#threados","title":"ThreadOS \u4e2d\u7684\u7ebf\u7a0b\u5207\u6362","text":"<p>\u8bfe\u5802\u5b9e\u9a8c\uff1a\u4e2d\u65ad\u65f6\u7684\u5bc4\u5b58\u5668\u548c\u5806\u6808\u7684\u67e5\u770b\u3002</p> <p>\u8ba1\u7b97\u673a\u786c\u4ef6\u4e5f\u662f\u72b6\u6001\u673a</p> <ul> <li>\u201c\u5171\u4eab\u7684\u5185\u5b58\uff0c\u5bb9\u7eb3\u4e86\u591a\u4e2a\u72b6\u6001\u673a\u201d</li> <li>\u5171\u4eab\u7684\u4ee3\u7801</li> <li>\u5171\u4eab\u7684\u5168\u5c40\u53d8\u91cf</li> <li>\u542f\u52a8\u4ee3\u7801\u7684\u5806\u6808 (\u4ec5\u542f\u52a8\u4ee3\u7801\u53ef\u7528)</li> <li>\\(T_1\\) \u7684 Task (\u4ec5\\(T_1\\)\u548c\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u53ef\u7528)<ul> <li>\u5806\u6808 (\u4e2d\u65ad\u65f6\uff0c\u5bc4\u5b58\u5668\u4fdd\u5b58\u5728\u5806\u6808\u4e0a)</li> </ul> </li> <li>\\(T_2\\)\u7684Task (\u4ec5\\(T_2\\)\u548c\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u53ef\u7528)<ul> <li>\u5806\u6808 (\u4e2d\u65ad\u65f6\uff0c\u5bc4\u5b58\u5668\u4fdd\u5b58\u5728\u5806\u6808\u4e0a)</li> </ul> </li> <li>\u72b6\u6001\u8fc1\u79fb</li> <li>\u6267\u884c\u6307\u4ee4\u6216\u54cd\u5e94\u4e2d\u65ad</li> </ul>"},{"location":"courses/os_lab/15_kernel_thread_and_process.html#_3","title":"\u4ec0\u4e48\u662f\u64cd\u4f5c\u7cfb\u7edf\uff1f","text":"<p>\u865a\u62df\u5316\uff1a\u64cd\u4f5c\u7cfb\u7edf\u540c\u65f6\u4fdd\u5b58\u591a\u4e2a\u72b6\u6001\u673a</p> <ul> <li>C \u7a0b\u5e8f = \u72b6\u6001\u673a</li> <li>\u521d\u59cb\u72b6\u6001\uff1a<code>main(argc, argv)</code></li> <li>\u72b6\u6001\u8fc1\u79fb\uff1a\u6307\u4ee4\u6267\u884c<ul> <li>\u5305\u62ec\u7279\u6b8a\u7684\u7cfb\u7edf\u8c03\u7528\u6307\u4ee4 syscall</li> </ul> </li> <li>\u6709\u4e00\u7c7b\u7279\u6b8a\u7684\u7cfb\u7edf\u8c03\u7528\u53ef\u4ee5\u7ba1\u7406\u72b6\u6001\u673a</li> <li><code>CreateProcess(exec_file)</code></li> <li><code>TerminateProcess()</code></li> </ul> <p>\u4ece\u7ebf\u7a0b\u5230\u8fdb\u7a0b\uff1a\u865a\u62df\u5b58\u50a8\u7cfb\u7edf</p> <ul> <li>\u901a\u8fc7\u865a\u62df\u5185\u5b58\u5b9e\u73b0\u6bcf\u6b21 \u201c\u62ff\u51fa\u6765\u4e00\u4e2a\u6267\u884c\u201d</li> <li>\u4e2d\u65ad\u540e\u8fdb\u5165\u64cd\u4f5c\u7cfb\u7edf\u4ee3\u7801\uff0c\u201c\u6362\u4e00\u4e2a\u6267\u884c\u201d</li> </ul>"},{"location":"courses/os_lab/15_kernel_thread_and_process.html#fork","title":"\u590d\u5236\u72b6\u6001\u673a\uff1afork()","text":""},{"location":"courses/os_lab/15_kernel_thread_and_process.html#_4","title":"\u72b6\u6001\u673a\u7ba1\u7406\uff1a\u521b\u5efa\u72b6\u6001\u673a","text":"<p>\u5982\u679c\u8981\u521b\u5efa\u72b6\u6001\u673a\uff0c\u6211\u4eec\u5e94\u8be5\u63d0\u4f9b\u4ec0\u4e48\u6837\u7684 API\uff1f</p> <p>UNIX \u7684\u7b54\u6848: fork</p> <ul> <li>\u505a\u4e00\u4efd\u72b6\u6001\u673a\u5b8c\u6574\u7684\u590d\u5236 (\u5185\u5b58\u3001\u5bc4\u5b58\u5668\u73b0\u573a)</li> </ul> <pre><code>int fork();\n</code></pre> <ul> <li>\u7acb\u5373\u590d\u5236\u72b6\u6001\u673a (\u5b8c\u6574\u7684\u5185\u5b58)</li> <li>\u590d\u5236\u5931\u8d25\u8fd4\u56de -1 (errno)</li> <li>\u65b0\u521b\u5efa\u8fdb\u7a0b\u8fd4\u56de 0</li> <li>\u6267\u884c fork \u7684\u8fdb\u7a0b\u8fd4\u56de\u5b50\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7</li> </ul> <p>\u72b6\u6001\u673a\u662f\u590d\u5236\u7684\uff0c\u56e0\u6b64\u603b\u80fd\u627e\u5230 \u201c\u7236\u5b50\u5173\u7cfb\u201d</p> <ul> <li>\u56e0\u6b64\u6709\u4e86\u8fdb\u7a0b\u6811 (pstree)</li> </ul> <pre><code>systemd-+-ModemManager---2*[{ModemManager}]\n        |-NetworkManager---2*[{NetworkManager}]\n        |-accounts-daemon---2*[{accounts-daemon}]\n        |-at-spi-bus-laun-+-dbus-daemon\n        |                 `-3*[{at-spi-bus-laun}]\n        |-at-spi2-registr---2*[{at-spi2-registr}]\n        |-atd\n        |-avahi-daemon---avahi-daemon\n        |-colord---2*[{colord}]\n        ...\n</code></pre> <ul> <li>\u590d\u5236\u662f\u5168\u90e8\u590d\u5236\uff0c\u5305\u62ec\u201c\u7f13\u51b2\u533a\u201d\u7684\u590d\u5236\u3001\u5168\u5c40\u53d8\u91cf\u7b49\uff0c\u56e0\u6b64\u9700\u8981\u5c0f\u5fc3\u5904\u7406\u3002</li> </ul>"},{"location":"courses/os_lab/15_kernel_thread_and_process.html#fork-bomb","title":"Fork Bomb","text":"<p>\u4e0d\u505c\u5730\u521b\u5efa\u8fdb\u7a0b\uff0c\u7cfb\u7edf\u8fd8\u662f\u4f1a\u6302\u6389\u7684</p> <pre><code>:(){:|:&amp;};:   # \u521a\u624d\u7684\u4e00\u884c\u7248\u672c\n\n:() {         # \u683c\u5f0f\u5316\u4e00\u4e0b\n  : | : &amp;\n}; :\n\nfork() {      # bash: \u5141\u8bb8\u5192\u53f7\u4f5c\u4e3a\u6807\u8bc6\u7b26\u2026\u2026\n  fork | fork &amp;\n}; fork\n</code></pre>"},{"location":"courses/os_lab/15_kernel_thread_and_process.html#execve","title":"\u91cd\u7f6e\u72b6\u6001\u673a\uff1aexecve()","text":""},{"location":"courses/os_lab/15_kernel_thread_and_process.html#_5","title":"\u72b6\u6001\u673a\u7ba1\u7406\uff1a\u91cd\u7f6e\u72b6\u6001\u673a","text":"<p>execve\uff1a\u5c06\u5f53\u524d\u8fdb\u7a0b\u91cd\u7f6e\u6210\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u63cf\u8ff0\u72b6\u6001\u673a\u7684\u521d\u59cb\u72b6\u6001</p> <pre><code>int execve(const char *filename, char * const argv[], char * const envp[]);\n</code></pre> <ul> <li>\u6267\u884c\u540d\u4e3a <code>filename</code> \u7684\u7a0b\u5e8f</li> <li>\u5141\u8bb8\u5bf9\u65b0\u72b6\u6001\u673a\u8bbe\u7f6e\u53c2\u6570<code>argv(v)</code>\u548c\u73af\u5883\u53d8\u91cf<code>envp(e)</code></li> <li>\u521a\u597d\u5bf9\u5e94\u4e86 <code>main()</code> \u7684\u53c2\u6570\uff01</li> <li>execve \u662f\u552f\u4e00\u80fd\u591f \u201c\u6267\u884c\u7a0b\u5e8f\u201d \u7684\u7cfb\u7edf\u8c03\u7528</li> <li>\u56e0\u6b64\u4e5f\u662f\u4e00\u5207\u8fdb\u7a0b strace \u7684\u7b2c\u4e00\u4e2a\u7cfb\u7edf\u8c03\u7528</li> </ul>"},{"location":"courses/os_lab/15_kernel_thread_and_process.html#_6","title":"\u73af\u5883\u53d8\u91cf","text":"<p>\u201c\u5e94\u7528\u7a0b\u5e8f\u6267\u884c\u7684\u73af\u5883\u201d</p> <ul> <li>\u4f7f\u7528<code>env</code>\u547d\u4ee4\u67e5\u770b</li> <li><code>PATH</code>: \u53ef\u6267\u884c\u6587\u4ef6\u641c\u7d22\u8def\u5f84</li> <li><code>PWD</code>: \u5f53\u524d\u8def\u5f84</li> <li><code>HOME</code>: home \u76ee\u5f55</li> <li><code>DISPLAY</code>: \u56fe\u5f62\u8f93\u51fa</li> <li><code>PS1</code>: shell \u7684\u63d0\u793a\u7b26</li> </ul> <p><code>export</code>: \u544a\u8bc9 shell \u5728\u521b\u5efa\u5b50\u8fdb\u7a0b\u65f6\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf</p>"},{"location":"courses/os_lab/15_kernel_thread_and_process.html#exit","title":"\u7ec8\u6b62\u72b6\u6001\u673a\uff1aexit()","text":""},{"location":"courses/os_lab/15_kernel_thread_and_process.html#_7","title":"\u72b6\u6001\u673a\u7ba1\u7406\uff1a\u9500\u6bc1\u72b6\u6001\u673a","text":"<p>\u6709\u4e86 fork, execve \u6211\u4eec\u5c31\u80fd\u81ea\u7531\u6267\u884c\u4efb\u4f55\u7a0b\u5e8f\u4e86\uff0c\u6700\u540e\u53ea\u7f3a\u4e00\u4e2a\u9500\u6bc1\u72b6\u6001\u673a\u7684\u51fd\u6570\uff01</p> <p><code>exit</code>\u7acb\u5373\u6467\u6bc1\u72b6\u6001\u673a</p> <pre><code>void _exit(int status)\n</code></pre> <ul> <li>\u9500\u6bc1\u5f53\u524d\u72b6\u6001\u673a\uff0c\u5e76\u5141\u8bb8\u6709\u4e00\u4e2a\u8fd4\u56de\u503c</li> <li>\u5b50\u8fdb\u7a0b\u7ec8\u6b62\u4f1a\u901a\u77e5\u7236\u8fdb\u7a0b (\u540e\u7eed\u8bfe\u7a0b\u89e3\u91ca)</li> </ul>"},{"location":"courses/os_lab/15_kernel_thread_and_process.html#_8","title":"\u7ed3\u675f\u7a0b\u5e8f\u6267\u884c\u7684\u4e09\u79cd\u65b9\u6cd5","text":"<ul> <li><code>exit(0)</code> -<code>stdlib.h</code> \u4e2d\u58f0\u660e\u7684 libc \u51fd\u6570\uff1a\u53ef\u4ee5\u6267\u884c <code>atexit</code>\u6ce8\u518c\u7684 hook\uff1b</li> <li><code>_exit</code>\uff1aglibc \u7684 syscall wrapper</li> <li>\u4f1a\u8c03\u7528syscall exit_group\uff0c\u7ec8\u6b62\u8fdb\u7a0b\uff08\u5305\u62ec\u6240\u6709\u7684\u7ebf\u7a0b\uff09 \uff1b</li> <li> <p>\u4e0d\u4f1a\u8c03\u7528 <code>atexit</code></p> </li> <li> <p><code>syscall(SYS_exit, 0)</code></p> </li> <li>\u6267\u884c \u201c<code>exit</code>\u201d \u7cfb\u7edf\u8c03\u7528\u7ec8\u6b62\u5f53\u524d\u7ebf\u7a0b</li> <li>\u4e0d\u4f1a\u8c03\u7528 <code>atexit</code></li> </ul>"},{"location":"courses/os_lab/15_kernel_thread_and_process.html#_9","title":"\u8bfe\u540e\u4e60\u9898/\u7f16\u7a0b\u4f5c\u4e1a","text":""},{"location":"courses/os_lab/15_kernel_thread_and_process.html#1","title":"1. \u9605\u8bfb\u6750\u6599","text":"<p>\u6559\u79d1\u4e66 Operating Systems: Three Easy Pieces</p> <ul> <li>\u7b2c 3 \u7ae0 - Dialogue</li> <li>\u7b2c 4 \u7ae0 - Processes</li> <li>\u7b2c 5 \u7ae0 - Process API</li> </ul>"},{"location":"courses/os_lab/16_application_in_linux.html","title":"Linux \u64cd\u4f5c\u7cfb\u7edf","text":"<p>\u4ece CPU Reset \u540e\u7684 \u201c\u786c\u4ef6\u521d\u59cb\u72b6\u6001\u201d \u5230\u64cd\u4f5c\u7cfb\u7edf\u52a0\u8f7d\u5b8c init \u8fdb\u7a0b\u540e\u7684 \u201c\u8f6f\u4ef6\u521d\u59cb\u72b6\u6001\u201d\uff0c\u4ece\u6b64\u4ee5\u540e\uff0c\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e2d\u7684\u4e00\u5207\u90fd\u662f\u7531\u5e94\u7528\u7a0b\u5e8f\u4e3b\u5bfc\u7684\uff0c\u64cd\u4f5c\u7cfb\u7edf\u53ea\u662f\u63d0\u4f9b\u7cfb\u7edf\u8c03\u7528\u8fd9\u4e00\u670d\u52a1\u63a5\u53e3\u3002</p> <p>\u672c\u8bb2\u5185\u5bb9\uff1a\u5b8c\u6574\u7684\u5e94\u7528\u4e16\u754c\u5230\u5e95\u662f\u5982\u4f55\u6784\u5efa\u7684\uff1f\u5728\u8fd9\u8282\u8bfe\u4e2d\uff0c\u6211\u4eec\u7528\u4e00\u4e2a \u201c\u6700\u5c0f\u201d \u7684 Linux \u7cfb\u7edf\u89e3\u7b54\u8fd9\u4e2a\u95ee\u9898\uff1a</p> <ul> <li>Linux \u64cd\u4f5c\u7cfb\u7edf</li> <li>Linux \u7cfb\u7edf\u542f\u52a8\u548c initramfs</li> <li>Linux \u5e94\u7528\u4e16\u754c\u7684\u6784\u5efa</li> </ul>"},{"location":"courses/os_lab/16_application_in_linux.html#linux_1","title":"Linux \u5386\u53f2","text":""},{"location":"courses/os_lab/16_application_in_linux.html#25-aug-1991-the-birthday-of-linux","title":"25 Aug 1991, The Birthday of Linux","text":"<p>Hello, everybody out there using minix \u2013 I\u2019m doing a (free) operating system (just a hobby, won\u2019t be big and professional like gnu) for 386(486) AT clones. This has been brewing since April, and is starting to get ready.</p> <p>\u2014\u2014 Linus Torvalds (\u65f6\u5e74 21 \u5c81)</p> <p>Linux \u662f\u57fa\u4e8e\u5b8f\u5185\u6838\uff0c\u800c Minix \u662f\u57fa\u4e8e\u5fae\u5185\u6838\u3002</p> <ul> <li>Tanenbaum/Linus \"Linux is Obsolete\" Debate</li> </ul>"},{"location":"courses/os_lab/16_application_in_linux.html#minix","title":"Minix","text":"<p>Minix: \u5b8c\u5168\u7528\u4e8e\u6559\u5b66\u7684\u771f\u5b9e\u64cd\u4f5c\u7cfb\u7edf  by Andrew S. Tanenbaum</p> <p>\u5e74\u8f7b\u4eba\u7684\u7b2c\u4e00\u4e2a \u201c\u5168\u529f\u80fd\u201d \u64cd\u4f5c\u7cfb\u7edf</p> <ul> <li>Minix1(1987): UNIXv7 \u517c\u5bb9</li> <li>Linus \u5b9e\u73b0 Linux \u7684\u8d77\u70b9</li> <li>Minix2(1997): POSIX \u517c\u5bb9</li> <li> <p>\u66f4\u52a0\u5b8c\u5907\u7684\u7cfb\u7edf\uff0c\u4e66\u540e\u9644\u5168\u90e8\u5185\u6838\u4ee3\u7801</p> </li> <li> <p>Minix3(2006): POSIX/NetBSD \u517c\u5bb9</p> </li> <li>\u4e00\u5ea6\u662f\u4e16\u754c\u4e0a\u5e94\u7528\u6700\u5e7f\u7684\u64cd\u4f5c\u7cfb\u7edf\uff1aIntel ME \u4eba\u624b\u4e00\u4e2a</li> </ul>"},{"location":"courses/os_lab/16_application_in_linux.html#linux_2","title":"Linux \u4ee3\u7801\u884c\u6570","text":"<ul> <li>Linux 2.0 \u5f15\u5165\u591a\u5904\u7406\u5668 (Big Kernel Lock, \u5185\u6838\u4e0d\u80fd\u5e76\u884c)</li> <li>Linux 2.4 \u5185\u6838\u5e76\u884c</li> <li>2002 \u5e74\u624d\u5f15\u5165 Read-Copy-Update (RCU) \u65e0\u9501\u540c\u6b65</li> <li>2003 \u5e74 Linux 2.6 \u53d1\u5e03\uff0c\u968f\u4e91\u8ba1\u7b97\u5f00\u59cb\u8d77\u98de</li> </ul>"},{"location":"courses/os_lab/16_application_in_linux.html#linux_3","title":"\u6784\u5efa\u6700\u5c0f Linux \u7cfb\u7edf","text":""},{"location":"courses/os_lab/16_application_in_linux.html#linux_4","title":"\u542f\u52a8 Linux","text":"<p>\u63a7\u5236 Linux Kernel \u52a0\u8f7d\u7684 \u201c\u7b2c\u4e00\u4e2a\u72b6\u6001\u673a\u201d\uff1f\u2014\u2014 <code>rdinit</code></p> <p>\u6311\u6218 ChatGPT\uff1a</p> <ul> <li>\u6211\u5e0c\u671b\u7528 QEMU \u5728\u7ed9\u5b9a\u7684 Linux \u5185\u6838\u5b8c\u6210\u521d\u59cb\u5316\u540e\uff0c\u76f4\u63a5\u6267\u884c\u6211\u81ea\u5df1\u7f16\u5199\u7684\u3001\u9759\u6001\u94fe\u63a5\u7684 init \u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u6211\u5e94\u8be5\u600e\u4e48\u505a\uff1f </li> </ul> <p>\u719f\u6089\u7684 QEMU\uff0c\u7a0d\u7a0d\u6709\u4e9b\u4e0d\u719f\u6089\u7684\u547d\u4ee4\u884c\u9009\u9879</p> <ul> <li>\u518d\u6b21\u6311\u6218 ChatGPT\uff1a\u5982\u679c\u6211\u5e0c\u671b\u7528 QEMU \u542f\u52a8\u6211\u7ed9\u5b9a\u7684 Linux \u5185\u6838\u4e8c\u8fdb\u5236\u6587\u4ef6 vmlinuz \u548c\u521d\u59cb\u5185\u5b58\u6587\u4ef6\u7cfb\u7edf initramfs\uff0c\u5e94\u8be5\u4f7f\u7528\u600e\u6837\u7684 QEMU \u53c2\u6570\u4f7f\u5f97 initramfs \u4e2d\u7684 /bin/hello \u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u6267\u884c\u7684\u7a0b\u5e8f\uff1f</li> </ul> <pre><code>initramfs:\n# Copy kernel and busybox from the host system\n    @mkdir -p build/initramfs/bin\n    sudo bash -c \"cp /boot/vmlinuz build/ &amp;&amp; chmod 666 build/vmlinuz\"\n    cp $(INIT) build/initramfs/\n    cp $(shell which busybox) build/initramfs/bin/\nrun:\n# Run QEMU with the installed kernel and generated initramfs\n    qemu-system-x86_64 \\\n      -serial mon:stdio \\\n      -kernel build/vmlinuz \\\n      -initrd build/initramfs.cpio.gz \\\n      -machine accel=kvm:tcg \\\n      -append \"console=ttyS0 quiet rdinit=$(INIT)\"\n</code></pre>"},{"location":"courses/os_lab/16_application_in_linux.html#initrd","title":"initrd","text":"<p><code>initrd</code>(boot loader initialized RAM disk\uff09\u53ea\u662f\u4e00\u4e2a\u5185\u5b58\u91cc\u7684\u5c0f\u6587\u4ef6\u7cfb\u7edf</p> <p>\u5185\u6838\u542f\u52a8\u88ab\u5206\u6210\u4e86\u4e24\u4e2a\u9636\u6bb5\uff1a</p> <ul> <li>\u7b2c\u4e00\u9636\u6bb5\u5148\u6267\u884c initrd \u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\"\u67d0\u4e2a\u6587\u4ef6\"\uff08init \u7a0b\u5e8f\uff09\uff0c\u5b8c\u6210\u52a0\u8f7d\u9a71\u52a8\u6a21\u5757\u7b49\u4efb\u52a1</li> <li>\u7b2c\u4e8c\u9636\u6bb5\u624d\u4f1a\u6267\u884c\u771f\u6b63\u7684\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4efb\u52a1 /sbin/init \u8fdb\u7a0b\uff08\u5b9e\u9645\u662f <code>systemmd</code>\uff0c\u8f6f\u94fe\u63a5\uff09\u3002</li> <li>\u5305\u62ec\u52a0\u8f7d\u5269\u4f59\u5fc5\u8981\u7684\u9a71\u52a8\u7a0b\u5e8f\uff0c\u4f8b\u5982\u7f51\u5361/\u663e\u5361\u9a71\u52a8\uff1b</li> </ul>"},{"location":"courses/os_lab/16_application_in_linux.html#pivot_root","title":"pivot_root","text":"<p><code>pivot_root()</code> changes the root mount in the mount namespace of the calling process. More precisely, it moves the root mount to the directory <code>put_old</code> and makes <code>new_root</code> the new root mount. The calling process must have the <code>CAP_SYS_ADMIN</code> capability in the user namespace that owns the caller's mount namespace.</p> <pre><code>int pivot_root(const char *new_root, const char *put_old);\n</code></pre> <p>\u5728 init \u65f6\u591a\u505a\u4e00\u4e9b\u4e8b</p> <pre><code>export PATH=/bin\nbusybox mknod /dev/sda b 8 0\nbusybox mkdir -p /newroot\nbusybox mount -t ext2 /dev/sda /newroot\nexec busybox switch_root /newroot/ /etc/init\n</code></pre> <ul> <li>pivot_root \u4e4b\u540e\u624d\u52a0\u8f7d\u7f51\u5361\u9a71\u52a8\u3001\u914d\u7f6e IP</li> <li>\u8fd9\u4e9b\u90fd\u662f systemd \u7684\u5de5\u4f5c (\u4f60\u4f1a\u7559\u610f\u5230 tty \u5b57\u4f53\u53d8\u4e86)</li> <li>\u4e4b\u540e initramfs \u5c31\u529f\u6210\u8eab\u9000\uff0c\u8d44\u6e90\u91ca\u653e</li> </ul>"},{"location":"courses/os_lab/17_hack_linux_process_address.html","title":"Linux \u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a\u5728\u6211\u4eec\u7684\u72b6\u6001\u673a\u6a21\u578b\u4e2d\uff0c\u8fdb\u7a0b\u7684\u72b6\u6001\u7531 (M,R)\u4e24\u90e8\u5206\u7ec4\u6210\uff1b\u5176\u4e2d R (register) \u662f\u7531\u4f53\u7cfb\u7ed3\u6784\u51b3\u5b9a\u7684\uff0c\u800c M (memory) \u5219\u8fd8\u6709\u4e00\u4e9b\u672a\u89e3\u5f00\u7684\u8c1c\u9898\uff1a\u7a0b\u5e8f\u5728\u521d\u59cb\u65f6\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u5185\u5b58\u90fd\u53ef\u4ee5\u8bbf\u95ee\u7684\uff0c\u4f46\u6211\u4eec\u5374\u53c8\u7684\u786e\u53ef\u4ee5\u7533\u8bf7\u5f88\u5927\u7684\u5185\u5b58\u3002\u8fd9\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff1f</p> <ul> <li>\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4</li> <li>mmap \u7cfb\u7edf\u8c03\u7528</li> <li>\u4e09\u7c7b\u6e38\u620f\u5916\u6302\u7684\u5b9e\u73b0\u539f\u7406</li> <li>\u91d1\u5c71\u6e38\u4fa0\uff1a\u5185\u5b58\u4fee\u6539</li> <li>\u6309\u952e\u7cbe\u7075\uff1aGUI \u4e8b\u4ef6\u53d1\u9001</li> <li>\u53d8\u901f\u9f7f\u8f6e\uff1a\u4ee3\u7801\u6ce8\u5165</li> </ul>"},{"location":"courses/os_lab/17_hack_linux_process_address.html#linux_1","title":"Linux \u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4","text":"<p>\u4e24\u4e2a\u5f88\u57fa\u672c (\u4f46\u4e5f\u5f88\u56f0\u96be) \u7684\u95ee\u9898</p> <ul> <li>\u4ee5\u4e0b\u7a0b\u5e8f\u7684 (\u53ef\u80fd) \u8f93\u51fa\u662f\u4ec0\u4e48\uff1f</li> </ul> <pre><code>printf(\"%p\\n\", main);\n</code></pre> <ul> <li>\u4f55\u79cd\u6307\u9488\u8bbf\u95ee\u4e0d\u4f1a\u5f15\u53d1 segmentation fault?</li> </ul> <pre><code>char *p = random();\n*p; // \u4ec0\u4e48\u65f6\u5019\u8bbf\u95ee\u5408\u6cd5\uff1f \n</code></pre>"},{"location":"courses/os_lab/17_hack_linux_process_address.html#_1","title":"\u67e5\u770b\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4","text":"<p><code>pmap (1) - report memory of a process</code></p> <ul> <li>pmap \u662f\u901a\u8fc7\u8bbf\u95ee procfs (<code>/proc/</code>) \u5b9e\u73b0\u7684\uff0c\u901a\u8fc7<code>strace</code>\u53ef\u4ee5\u9a8c\u8bc1\uff1b</li> </ul> <p>\u67e5\u770b\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4</p> <ul> <li>\u7b49\u7a0b\u5e8f\u8fd0\u884c\u8d77\u6765\u540e (gdb)\uff0c\u4f7f\u7528 <code>pmap</code> \u547d\u4ee4\u67e5\u770b\u5730\u5740\u7a7a\u95f4</li> <li>\u5730\u5740\u7a7a\u95f4\u662f\u82e5\u5e72\u8fde\u7eed\u7684 \u201c\u5185\u5b58\u6bb5\u201d</li> <li>\u201c\u6bb5\u201d \u7684\u5185\u5b58\u53ef\u4ee5\u6839\u636e\u6743\u9650\u8bbf\u95ee</li> <li>\u4e0d\u5728\u6bb5\u5185/\u8fdd\u53cd\u6743\u9650\u7684\u5185\u5b58\u8bbf\u95ee \u89e6\u53d1 SIGSEGV</li> </ul>"},{"location":"courses/os_lab/17_hack_linux_process_address.html#_2","title":"\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u67e5\u770b\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u7684\u673a\u5236","text":"<p>RTFM: <code>/proc/[pid]/maps</code> (man 5 proc)</p> <p>\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u6bcf\u4e00\u6bb5</p> <ul> <li>\u5730\u5740 (\u8303\u56f4) \u548c\u6743\u9650 (rwxsp)</li> <li>\u5bf9\u5e94\u7684\u6587\u4ef6: offset, dev, inode, pathname</li> </ul> <p>\u901a\u8fc7\u5b9e\u9a8c\u89c2\u5bdf address space \u7684\u53d8\u5316</p> <ul> <li>\u5806 (bss) \u5185\u5b58\u7684\u5927\u5c0f\uff1a\u5168\u5c40\u6570\u7ec4/malloc\uff1b</li> <li>\u6808\u4e0a\u7684\u5927\u6570\u7ec4 v.s. memory error</li> </ul> <p>\u8fdb\u7a0b\u7684\u5185\u5b58\u793a\u4f8b\uff1a</p> <ul> <li><code>vdso (7): vdso\uff08virtual dynamic shared object\uff09</code></li> <li><code>Virtual system calls(vsyscall)</code>: \u53ea\u8bfb\u7684\u7cfb\u7edf\u8c03\u7528\u4e5f\u8bb8\u53ef\u4ee5\u4e0d\u9677\u5165\u5185\u6838\u6267\u884c\u3002</li> </ul> <p>\u65e0\u9700\u9677\u5165\u5185\u6838\u7684\u7cfb\u7edf\u8c03\u7528</p> <ul> <li>\u4f8b\u5b50: time (2)\uff1a\u65f6\u95f4\uff1a\u5185\u6838\u7ef4\u62a4\u79d2\u7ea7\u7684\u65f6\u95f4 (\u6240\u6709\u8fdb\u7a0b\u6620\u5c04\u540c\u4e00\u4e2a\u9875\u9762)</li> <li>\u4f8b\u5b50: gettimeofday (2)\uff1aRTFSC (\u975e\u5e38\u806a\u660e\u7684\u5b9e\u73b0)</li> <li>\u66f4\u591a\u793a\u4f8b\uff1a\u95ee GPT \u5427</li> </ul> <pre><code>0000555555554000 r--p     a.out\n0000555555555000 r-xp     a.out               # \u4ee3\u7801\u6bb5\n0000555555556000 r--p     a.out               \n0000555555557000 r--p     a.out\n0000555555558000 rw-p     a.out               # \u6570\u636e\u6bb5\n00007ffff7dc1000 r--p     libc-2.31.so\n00007ffff7de3000 r-xp     libc-2.31.so\n00007ffff7f5b000 r--p     libc-2.31.so\n00007ffff7fa9000 r--p     libc-2.31.so\n00007ffff7fad000 rw-p     libc-2.31.so\n00007ffff7faf000 rw-p     (\u8fd9\u662f\u4ec0\u4e48\uff1f)\n00007ffff7fcb000 r--p     [vvar] (\u8fd9\u53c8\u662f\u4ec0\u4e48\uff1f)\n00007ffff7fce000 r-xp     [vdso] (\u8fd9\u53d2\u662f\u4ec0\u4e48\uff1f)\n00007ffff7fcf000 r--p     (\u7701\u7565\u76f8\u4f3c\u7684 ld-2.31.so)\n00007ffffffde000 rw-p     [stack]\nffffffffff600000 --xp     [vsyscall] (\u8fd9\u53d5\u662f\u4ec0\u4e48\uff1f)\n</code></pre>"},{"location":"courses/os_lab/17_hack_linux_process_address.html#_3","title":"\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u7ba1\u7406","text":""},{"location":"courses/os_lab/17_hack_linux_process_address.html#_4","title":"\u5730\u5740\u7a7a\u95f4 = \u5e26\u8bbf\u95ee\u6743\u9650\u7684\u5185\u5b58\u6bb5","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u5e94\u8be5\u63d0\u4f9b\u4e00\u4e2a\u4fee\u6539\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u7684\u7cfb\u7edf\u8c03\u7528</p> <pre><code>// \u6620\u5c04\nvoid *mmap(void *addr, size_t length, int prot, int flags, int fd, off_t offset);\nint munmap(void *addr, size_t length);\n\n// \u4fee\u6539\u6620\u5c04\u6743\u9650\nint mprotect(void *addr, size_t length, int prot);\n</code></pre> <p>\u672c\u8d28\uff1a\u5728\u72b6\u6001\u673a\u72b6\u6001\u4e0a\u589e\u52a0/\u5220\u9664/\u4fee\u6539\u4e00\u6bb5\u53ef\u8bbf\u95ee\u7684\u5185\u5b58</p> <ul> <li>mmap: \u53ef\u4ee5\u7528\u6765\u7533\u8bf7\u5185\u5b58 (<code>MAP_ANONYMOUS</code>)\uff0c\u4e5f\u53ef\u4ee5\u628a\u6587\u4ef6 \u201c\u642c\u5230\u201d \u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u4e2d</li> </ul>"},{"location":"courses/os_lab/17_hack_linux_process_address.html#_5","title":"\u628a\u6587\u4ef6\u6620\u5c04\u5230\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\uff1f","text":"<p>\u5b83\u4eec\u7684\u786e\u597d\u50cf\u6ca1\u6709\u4ec0\u4e48\u533a\u522b</p> <ul> <li>\u6587\u4ef6 = \u5b57\u8282\u5e8f\u5217 (\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u5bf9\u8c61)</li> <li>\u5185\u5b58 = \u5b57\u8282\u5e8f\u5217</li> </ul> <p>ELF loader \u7528 mmap \u975e\u5e38\u5bb9\u6613\u5b9e\u73b0</p> <ul> <li>\u89e3\u6790\u51fa\u8981\u52a0\u8f7d\u54ea\u90e8\u5206\u5230\u5185\u5b58\uff0c\u76f4\u63a5 mmap \u5c31\u5b8c\u4e86</li> <li>\u6211\u4eec\u7684 loader \u7684\u786e\u662f\u8fd9\u4e48\u505a\u7684 (strace)</li> </ul>"},{"location":"courses/os_lab/17_hack_linux_process_address.html#mmap","title":"\u4f7f\u7528 mmap","text":"<p>Example 1: \u7533\u8bf7\u5927\u91cf\u5185\u5b58\u7a7a\u95f4</p> <ul> <li>\u77ac\u95f4\u5b8c\u6210\u5185\u5b58\u5206\u914d</li> <li>mmap/munmap \u4e3a malloc/free \u63d0\u4f9b\u4e86\u673a\u5236</li> <li>libc \u7684\u5927 malloc \u4f1a\u76f4\u63a5\u8c03\u7528\u4e00\u6b21 mmap \u5b9e\u73b0</li> <li>\u4e0d\u59a8 strace/gdb \u770b\u4e00\u4e0b</li> </ul> <p>Example 2: Everything is a file</p> <ul> <li>\u6620\u5c04\u5927\u6587\u4ef6\u3001\u53ea\u8bbf\u95ee\u5176\u4e2d\u7684\u4e00\u5c0f\u90e8\u5206</li> </ul> <pre><code>with open('/dev/sda', 'rb') as fp:\n    mm = mmap.mmap(fp.fileno(),\n                   prot=mmap.PROT_READ, length=128 &lt;&lt; 30)\n    hexdump.hexdump(mm[:512])\n</code></pre>"},{"location":"courses/os_lab/17_hack_linux_process_address.html#memory-mapped-file","title":"Memory-Mapped File: \u4e00\u81f4\u6027","text":"<p>\u5982\u679c\u628a\u9875\u9762\u6620\u5c04\u5230\u6587\u4ef6</p> <ul> <li> <p>\u4fee\u6539\u4ec0\u4e48\u65f6\u5019\u751f\u6548\uff1f</p> </li> <li> <p>\u7acb\u5373\u751f\u6548\uff1a\u90a3\u4f1a\u9020\u6210\u5de8\u5927\u91cf\u7684\u78c1\u76d8 I/O</p> </li> <li> <p>unmap (\u8fdb\u7a0b\u7ec8\u6b62) \u65f6\u751f\u6548\uff1a\u597d\u50cf\u53c8\u592a\u8fdf\u4e86\u2026\u2026</p> </li> <li> <p>\u82e5\u5e72\u4e2a\u6620\u5c04\u5230\u540c\u4e00\u4e2a\u6587\u4ef6\u7684\u8fdb\u7a0b\uff1f</p> </li> <li> <p>\u5171\u4eab\u4e00\u4efd\u5185\u5b58\uff1f\u5404\u81ea\u6709\u672c\u5730\u7684\u526f\u672c\uff1f</p> </li> </ul> <p>\u8bf7\u67e5\u9605\u624b\u518c\uff0c\u770b\u770b\u64cd\u4f5c\u7cfb\u7edf\u662f\u5982\u4f55\u89c4\u5b9a\u8fd9\u4e9b\u64cd\u4f5c\u7684\u884c\u4e3a\u7684</p> <ul> <li>\u4f8b\u5982\u9605\u8bfb <code>msync(2)</code>, <code>mmap()</code></li> <li>\u8fd9\u624d\u662f\u64cd\u4f5c\u7cfb\u7edf\u771f\u6b63\u7684\u590d\u6742\u6027</li> </ul> <p><code>mmap</code>\u7684 flags \u51b3\u5b9a\u662f MAP_SHARED  \u8fd8\u662f MAP_PRIVATE\uff08copy-on-write\uff09</p> <ul> <li>MAP_SHARED  \uff1a\u5171\u4eab\uff0c\u5bf9\u5176\u5b83\u8fdb\u7a0b\u53ef\u89c1\uff0c\u66f4\u65b0\u4f1a\u5199\u56de\u5e95\u5c42\u6587\u4ef6\uff1b</li> <li>MAP_PRIVATE\uff1a\u79c1\u6709\u7684copy-on-write mappings\uff0c\u66f4\u65b0\u5bf9\u5176\u5b83\u8fdb\u7a0b\u4e0d\u53ef\u89c1\u4e14\u4e0d\u4f1a\u5199\u56de\u5230\u6587\u4ef6</li> </ul>"},{"location":"courses/os_lab/17_hack_linux_process_address.html#_6","title":"\ud83c\udf36\ufe0f \u5165\u4fb5\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4","text":""},{"location":"courses/os_lab/17_hack_linux_process_address.html#hacking-address-spaces","title":"Hacking Address Spaces","text":"<p>\u8fdb\u7a0b (M,R \u72b6\u6001\u673a) \u5728 \u201c\u65e0\u60c5\u6267\u884c\u6307\u4ee4\u673a\u5668\u201d \u4e0a\u6267\u884c</p> <ul> <li>\u72b6\u6001\u673a\u662f\u4e00\u4e2a\u5c01\u95ed\u4e16\u754c</li> <li>\u4f46\u5982\u679c\u5141\u8bb8\u4e00\u4e2a\u8fdb\u7a0b\u5bf9\u5176\u4ed6\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u6709\u8bbf\u95ee\u6743\uff1f</li> </ul> <p>\u4e00\u4e9b\u5165\u4fb5\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u7684\u4f8b\u5b50</p> <ul> <li>\u8c03\u8bd5\u5668 (gdb)\uff1agdb \u53ef\u4ee5\u4efb\u610f\u89c2\u6d4b\u548c\u4fee\u6539\u7a0b\u5e8f\u7684\u72b6\u6001</li> <li>Profiler (perf)\uff1a\u5408\u7406\u7684\u9700\u6c42\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5c31\u5fc5\u987b\u652f\u6301 \u2192 Ask GPT!</li> </ul>"},{"location":"courses/os_lab/17_hack_linux_process_address.html#0","title":"\u5165\u4fb5\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4 (0): \u91d1\u624b\u6307","text":"<p>\u5982\u679c\u6211\u4eec\u80fd\u76f4\u63a5\u7269\u7406\u52ab\u6301\u5185\u5b58\uff0c\u4e0d\u5c31\u90fd\u89e3\u51b3\u4e86\u5417\uff1f</p> <ul> <li>\u542c\u8d77\u6765\u5f88\u79bb\u8c31\uff0c\u4f46 \u201c\u5361\u5e26\u673a\u201d \u65f6\u4ee3\u7684\u786e\u53ef\u4ee5\u505a\u5230\uff01</li> </ul> <p></p> <p>Game Genie: \u4e00\u4e2a Look-up Table (LUT)</p> <ul> <li>\u5f53 CPU \u8bfb\u5730\u5740a\u65f6\u8bfb\u5230x\uff0c\u5219\u66ff\u6362\u4e3ay</li> <li>NES Game Genie Technical Notes (\u4e13\u5229, How did it work?)</li> <li>\u4eca\u5929\u6211\u4eec\u6709 Intel Processor Trace</li> </ul>"},{"location":"courses/os_lab/17_hack_linux_process_address.html#1","title":"\u5165\u4fb5\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4 (1): \u91d1\u5c71\u6e38\u4fa0","text":"<p>\u5728\u8fdb\u7a0b\u7684\u5185\u5b58\u4e2d\u627e\u5230\u4ee3\u8868 \u201c\u91d1\u94b1\u201d\u3001\u201c\u751f\u547d\u201d \u7684\u91cd\u8981\u5c5e\u6027\u5e76\u4e14\u6539\u6389</p> <p></p> <p>\u5305\u542b\u975e\u5e38\u8d34\u5fc3\u7684 \u201c\u6e38\u620f\u5185\u547c\u53eb\u201d \u529f\u80fd</p> <ul> <li>\u5b83\u5c31\u662f\u6e38\u620f\u7684 (\u9609\u5272\u7248) \u201c\u8c03\u8bd5\u5668\u201d</li> <li>\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728 Linux \u4e2d\u5b9e\u73b0\u5b83 (man 5 proc)\uff1a\u901a\u8fc7\u76f4\u63a5\u8bfb\u5199 <code>/proc/$pid/mem</code>\u6587\u4ef6\u3002</li> </ul>"},{"location":"courses/os_lab/17_hack_linux_process_address.html#2","title":"\u5165\u4fb5\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4 (2): \u6309\u952e\u7cbe\u7075","text":"<p>\u5927\u91cf\u91cd\u590d\u56fa\u5b9a\u7684\u4efb\u52a1 (\u4f8b\u5982 2 \u79d2 17 \u67aa)</p> <p></p> <p>\u8fd9\u4e2a\u7b80\u5355\uff0c\u5c31\u662f\u7ed9\u8fdb\u7a0b\u53d1\u9001\u952e\u76d8/\u9f20\u6807\u4e8b\u4ef6</p> <ul> <li>\u505a\u4e2a\u9a71\u52a8 (\u53ef\u7f16\u7a0b\u952e\u76d8/\u9f20\u6807)</li> <li>\u5229\u7528\u64cd\u4f5c\u7cfb\u7edf/\u7a97\u53e3\u7ba1\u7406\u5668\u63d0\u4f9b\u7684 API</li> <li>xdotool (\u6211\u4eec\u7528\u8fd9\u73a9\u610f\u6d4b\u8bd5 vscode \u7684\u63d2\u4ef6)</li> <li>evdev (\u6309\u952e\u663e\u793a\u811a\u672c\uff1b\u4e3b\u64ad\u5e38\u7528)</li> </ul>"},{"location":"courses/os_lab/17_hack_linux_process_address.html#3","title":"\u5165\u4fb5\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4 (3): \u53d8\u901f\u9f7f\u8f6e","text":"<p>\u8c03\u6574\u6e38\u620f\u7684\u903b\u8f91\u66f4\u65b0\u901f\u5ea6</p> <ul> <li>\u6bd4\u5982\u67d0\u795e\u79d8\u516c\u53f8\u6162\u5230\u96be\u4ee5\u5fcd\u53d7\u7684\u8dd1\u56fe\u548c\u6218\u6597</li> </ul> <p></p> <p>\u672c\u8d28\uff1a\u7a0b\u5e8f\u662f\u72b6\u6001\u673a</p> <ul> <li>\u9664\u4e86 syscall\uff0c\u662f\u4e0d\u80fd\u611f\u77e5\u65f6\u95f4\u7684</li> <li>\u53ea\u8981 \u201c\u52ab\u6301\u201d \u548c\u65f6\u95f4\u76f8\u5173\u7684 syscall\uff0c\u5c31\u80fd\u6539\u53d8\u7a0b\u5e8f\u5bf9\u65f6\u95f4\u7684\u8ba4\u8bc6</li> <li>\u539f\u5219\u4e0a\u7a0b\u5e8f\u4ecd\u7136\u53ef\u4ee5\u7528\u95f4\u63a5\u4fe1\u606f \u201c\u611f\u77e5\u201d \u7684 (\u5c31\u60f3\u8868\u8c03\u6162\u4e86\u4e00\u6837)</li> </ul>"},{"location":"courses/os_lab/18_os_lab_live_guide.html","title":"\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u9a8c\u751f\u5b58\u6307\u5357","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a</p> <ul> <li>\u7f16\u7a0b\u4e2d\u7684\u4e00\u4e9b\u7ec6\u8282</li> <li>\u8c03\u8bd5\u5de5\u5177\u7684\u6b63\u786e\u4f7f\u7528\u65b9\u6cd5</li> </ul>"},{"location":"courses/os_lab/18_os_lab_live_guide.html#_2","title":"\u5199 \u201c\u597d\u201d \u7684\u7a0b\u5e8f","text":"<p>\u6211\u53cd\u5bf9\u7f16\u7a0b\u81ea\u5b66\uff0c\u5f53\u7136\u524d\u63d0\u662f\u4f60\u7684\u8001\u5e08\u4f1a \u201c\u7f16\u7a0b\u201d\u3002      \u2014\u2014jyy</p>"},{"location":"courses/os_lab/18_os_lab_live_guide.html#_3","title":"\u7cbe\u76ca\u6c42\u7cbe","text":"<p>\u4ee3\u7801\u89c4\u8303\uff1aGuidelines</p> <ul> <li>Google, GNU, CERT-C</li> <li>\u53d8\u91cf\u8d77\u54ea\u4e9b\u540d\u5b57\uff1a</li> <li>AskGPT: Is it a good idea to use variable name \"rc\" for a variable holding a 0/-1 return value of an API/system call in C?</li> </ul> <p>Programming for fun</p> <ul> <li>The International Obfuscated C Code Contest</li> <li>\u5199\u51fa\u7edd\u5bf9\u4e0d\u53ef\u8bfb\uff0c\u4f46\u53c8\u7edd\u5bf9\u53ef\u7528\u7684\u4ee3\u7801</li> <li>\u4e00\u4e2a\u7a0b\u5e8f\u7684\u8bde\u751f</li> </ul>"},{"location":"courses/os_lab/18_os_lab_live_guide.html#timothy-roscoes-keynote-on-osdiatc21","title":"Timothy Roscoe's Keynote on OSDI/ATC'21","text":"<p>\u5927\u591a\u6570 OS \u7814\u7a76\u793e\u533a\u6210\u5458\u90fd\u72af\u4e86 ignorance \u548c denial \u4e24\u4e2a\u95ee\u9898\uff1a</p> <ul> <li> <p>ignorance\uff1a\u5c3d\u7ba1\u8fd9\u4e9b\u73b0\u4ee3\u786c\u4ef6\u7684\u6587\u6863\u90fd\u975e\u5e38\u5b8c\u5584\uff0c\u4f46\u6211\u4eec\u4e2d\u5f88\u591a\u4eba\u8fd8\u662f\u6839\u672c\u4e0d\u77e5\u9053\u73b0\u4ee3\u786c\u4ef6\u662f\u600e\u4e48\u6837\u7684\uff0c\u8fd8\u89c9\u5f97\u5b83\u4eec\u4e0d\u8fc7\u662f\u82b1\u54e8\u4e9b\u7684 VAX \uff1b</p> </li> <li> <p>\u5f88\u591a\u4eba\u56ff\u4e8e\u81ea\u5df1\u7684\u8212\u9002\u533a\uff0c\u4e13\u6ce8\u4e8e Linux \u64c5\u957f\u7684\u786c\u4ef6\u5047\u8bbe\u4e0a\uff0c\u89c9\u5f97\u5176\u4ed6\u7684\u4e1c\u897f\u90fd\u662f\u4e9b\u8bbe\u5907\u9a71\u52a8\u4e4b\u7c7b\u7684\u4e1c\u897f\uff0c\u4e0d\u5f52\u4ed6\u4eec\u8fd9\u4e9b\u505a\u201cOS\u201d\u7684\u4eba\u7ba1\uff0c\u4ed6\u4eec\u53ea\u9700\u8981\u77e5\u9053 Linux \u662f\u600e\u6837\u7684\u5c31\u884c\uff1b</p> </li> </ul>"},{"location":"courses/os_lab/18_os_lab_live_guide.html#_4","title":"\u7528\u597d\u5de5\u5177","text":""},{"location":"courses/os_lab/18_os_lab_live_guide.html#info-inferiors-pmap","title":"\u56de\u5230\u7b28\u62d9\u7684 info inferiors \u548c pmap","text":"<p>\u4f60\u4eec\u4e00\u5b9a\u4e0d\u4f1a\u613f\u610f\u7528\u7684\uff1a\u5c31\u50cf\u4f60\u4e0d\u5e0c\u671b\u7528\u6c47\u7f16\u5199\u4ee3\u7801</p> <ul> <li>AskGPT: Can I print process memory maps inside gdb?</li> <li>AskGPT: Can I visualize a process-internal data structure in gdb?</li> <li>(GPT \u6ca1\u7ed9\u6211 \u201c\u60ca\u559c\u201d\uff0c\u4f46\u6211\u6ca1\u6709\u4ed6\u90a3\u4e48\u597d\u7684\u8bb0\u5fc6\u8bfb\u53d6\u80fd\u529b)</li> </ul>"},{"location":"courses/os_lab/18_os_lab_live_guide.html#_5","title":"\u8ba1\u7b97\u673a\u7cfb\u7edf\u516c\u7406","text":"<p>\u201c\u4e09\u7701\u543e\u8eab\uff1a\u6eda\u53bb\u7f16\u7a0b\u4e86\u5417\uff1f\u5199\u6d4b\u8bd5\u7528\u4f8b\u4e86\u5417\uff1f\u56de\u770b\u81ea\u5df1\u7684\u5de5\u4f5c\u6d41\u7a0b\u4e86\u5417\uff1f\u201d</p> <ol> <li>\u673a\u5668\u6c38\u8fdc\u662f\u5bf9\u7684</li> <li>(ICS PA/OS Labs: \u6015\u662f\u4e0d\u7528\u591a\u8bf4\u4e86)</li> <li>\u672a\u6d4b\u4ee3\u7801\u6c38\u8fdc\u662f\u9519\u7684</li> <li>(ICS PA/OS Labs: \u6015\u662f\u4e0d\u7528\u591a\u8bf4\u4e86)</li> <li>\u8ba9\u4f60\u611f\u5230\u4e0d\u9002\u7684 tedious \u5de5\u4f5c\uff0c\u4e00\u5b9a\u6709\u529e\u6cd5\u63d0\u9ad8\u6548\u7387</li> <li>\u63a8\u8bba\uff1a\u6211\u4eec\u5e94\u8be5\u5206\u8fa8\u51fa\u4ec0\u4e48\u5de5\u4f5c\u662f tedious \u7684</li> </ol>"},{"location":"courses/os_lab/18_os_lab_live_guide.html#_6","title":"\u66f4\u8fdb\u4e00\u6b65\uff1a\u8fde\u63a5\u4e24\u4e2a\u4e16\u754c","text":"<p>\u7a0b\u5e8f = \u8ba1\u7b97\u673a\u7cfb\u7edf = \u72b6\u6001\u673a</p> <ul> <li>\u8c03\u8bd5\u5668\u7684\u672c\u8d28\u662f \u201c\u68c0\u67e5\u72b6\u6001\u201d</li> <li>\u6211\u4eec\u80fd\u4e0d\u80fd\u7528\u81ea\u5df1\u60f3\u8981\u7684\u65b9\u5f0f\u53bb\u68c0\u67e5\u72b6\u6001\uff1f</li> <li>\u4f8b\u5982\uff0c\u50cf model checker \u90a3\u6837\u628a\u4e00\u4e2a\u94fe\u8868\u7ed8\u5236\u51fa\u6765\uff1f</li> <li>AskGPT: How to use Python to parse and check/visualize C/C++ program state in GDB?</li> <li>GPT-4 \u751a\u81f3\u7ed9\u51fa\u4e86\u6b63\u786e\u7684\u6587\u6863 URL</li> </ul> <p>\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u505a\u4efb\u4f55\u4e8b\u4e86</p> <ul> <li>TUI Window API</li> <li>\u751a\u81f3\uff0c\u6211\u4eec\u53ef\u4ee5\u505a\u53e6\u4e00\u4e2a debugging front-end\uff1agdbgui</li> </ul>"},{"location":"courses/os_lab/18_os_lab_live_guide.html#_7","title":"\u8c03\u8bd5\u56f0\u96be\u7684\u6839\u672c\u539f\u56e0","text":"<p>\u6211\u4eec\u53ea\u80fd\u68c0\u67e5\u4e00\u4e2a\u77ac\u95f4\u7684\u72b6\u6001</p> <ul> <li>Reverse debugging \u7684\u6210\u672c\u8fd8\u662f\u592a\u9ad8\u4e86</li> <li>\u800c\u4e14 time-travel \u4e5f\u5f88\u96be\u64cd\u4f5c</li> <li>\u5982\u679c\u6211\u4eec\u80fd\u7cbe\u7b80\u72b6\u6001\u5c31\u597d\u4e86\uff01</li> <li>\u7cbe\u7b80\u72b6\u6001\u4e0d\u5c31\u884c\u4e86\u5417\u2026\u2026</li> </ul> <p>\u81ea\u5df1\u52a8\u624b\u505a\u5de5\u5177</p> <ul> <li>\u8c03\u8bd5 thread-os\uff08\u968f\u5802\u5b9e\u9a8c\u7684\u4ee3\u7801\uff09</li> </ul>"},{"location":"courses/os_lab/18_os_lab_live_guide.html#_8","title":"\u6211\u4eec\u9700\u8981\u7684\uff1a\u60f3\u8c61\u529b","text":"<p>The UNIX Philosophy</p> <ul> <li>Keep it simple, stupid</li> <li>\u628a gdb \u72b6\u6001\u5bfc\u51fa serialize \u5230\u6587\u4ef6/\u7ba1\u9053\u4e2d</li> <li>\u7531\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u8d1f\u8d23\u5904\u7406</li> <li>\u5c31\u50cf\u6211\u4eec\u7684 interactive state space explorer</li> </ul> <p>assertions \u4e5f\u4e0d\u4e00\u5b9a\u8981\u5199\u5728 C \u4ee3\u7801\u91cc</p> <ul> <li>\u5bfc\u51fa\u7684\u72b6\u6001\u53ef\u4ee5\u505a\u4efb\u4f55 trace analysis</li> </ul>"},{"location":"courses/os_lab/19_system_call_and_shell.html","title":"\u7cfb\u7edf\u8c03\u7528\u548c UNIX Shell","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a</p> <ul> <li>Shell</li> <li>xv6 shell \u4ee3\u7801\u8bb2\u89e3</li> </ul>"},{"location":"courses/os_lab/19_system_call_and_shell.html#unix-shell_1","title":"(UNIX) Shell","text":""},{"location":"courses/os_lab/19_system_call_and_shell.html#api","title":"\u4e3a\u7528\u6237\u5c01\u88c5\u64cd\u4f5c\u7cfb\u7edf API","text":"<p>\u6211\u4eec\u9700\u8981\u4e00\u4e2a \u201c\u7528\u6237\u80fd\u76f4\u63a5\u64cd\u4f5c\u201d \u7684\u7a0b\u5e8f\u7ba1\u7406\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u8c61\u3002</p> <p>\u9700\u8981\u4e00\u4e2a\u7a0b\u5e8f\u80fd\u534f\u8c03\u591a\u4e2a\u5e94\u7528\u7a0b\u5e8f</p> <p>Shell: Kernel \u7684 \u201c\u5916\u58f3\u201d</p> <ul> <li>\u201c\u4e0e\u4eba\u7c7b\u76f4\u63a5\u4ea4\u4e92\u7684\u7b2c\u4e00\u4e2a\u7a0b\u5e8f\u201d</li> </ul>"},{"location":"courses/os_lab/19_system_call_and_shell.html#the-unix-shell","title":"The UNIX Shell","text":"<p>\u201c\u7ec8\u7aef\u201d \u65f6\u4ee3\u7684\u4f1f\u5927\u8bbe\u8ba1</p> <ul> <li>\u201cCommand-line interface\u201d (CLI) \u7684\u5dc5\u5cf0</li> </ul> <p>Shell \u662f\u4e00\u95e8 \u201c\u628a\u7528\u6237\u6307\u4ee4\u7ffb\u8bd1\u6210\u7cfb\u7edf\u8c03\u7528\u201d \u7684\u7f16\u7a0b\u8bed\u8a00</p> <p>\u201cUnix is user-friendly; it's just choosy about who its friends are.\u201d</p> <p>\u5982\u679c\u628a shell \u7406\u89e3\u6210\u7f16\u7a0b\u8bed\u8a00\uff0c\u201c\u4e0d\u597d\u7528\u201d \u597d\u50cf\u4e5f\u6ca1\u4ec0\u4e48\u6bdb\u75c5\u4e86</p> <p></p>"},{"location":"courses/os_lab/19_system_call_and_shell.html#the-shell-programming-language","title":"The Shell Programming Language","text":"<p>\u57fa\u4e8e\u6587\u672c\u66ff\u6362\u7684\u5feb\u901f\u5de5\u4f5c\u6d41\u642d\u5efa</p> <ul> <li>\u91cd\u5b9a\u5411: <code>cmd &gt; file &lt; file 2&gt; /dev/null</code></li> <li>\u987a\u5e8f\u7ed3\u6784: <code>cmd1; cmd2</code>, <code>cmd1 &amp;&amp; cmd2</code>, <code>cmd1 || cmd2</code></li> <li>\u7ba1\u9053: <code>cmd1 | cmd2</code></li> <li>\u9884\u5904\u7406: <code>$()</code>, <code>&lt;()</code></li> <li><code>$(ls | grep 'A')</code></li> <li> <p><code>vim &lt;(ls)</code>\uff1a\u5c06 ls \u7684\u5185\u5bb9\uff0c\u4f5c\u4e3a vim \u7684\u6587\u4ef6\u8f93\u5165</p> </li> <li> <p>\u53d8\u91cf/\u73af\u5883\u53d8\u91cf\u3001\u63a7\u5236\u6d41\u2026\u2026</p> </li> </ul> <p>Job control\uff1a\u7c7b\u6bd4\u7a97\u53e3\u7ba1\u7406\u5668\u91cc\u7684 \u201c\u53c9\u201d\u3001\u201c\u6700\u5c0f\u5316\u201d</p> <ul> <li>jobs, fg, bg, wait</li> <li>(\u4eca\u5929\u7684 GUI \u5e76\u6ca1\u6709\u6bd4 CLI \u591a\u505a\u592a\u591a\u4e8b)</li> </ul>"},{"location":"courses/os_lab/19_system_call_and_shell.html#_1","title":"\u4eba\u5de5\u667a\u80fd\u65f6\u4ee3\uff0c\u6211\u4eec\u4e3a\u4ec0\u4e48\u8fd8\u8981\u8bfb\u624b\u518c\uff1f","text":"<p>\u4eca\u5929\u7684\u4eba\u5de5\u667a\u80fd\u8fd8\u662f \u201c\u88ab\u52a8\u201d \u7684</p> <ul> <li>\u5b83\u8fd8\u4e0d\u80fd\u5f88\u597d\u5730\u544a\u8bc9\u4f60\uff0c\u4f60\u5e94\u8be5\u53bb\u627e\u4ec0\u4e48</li> <li>Manual \u662f\u4e00\u4e2a complete source</li> <li>\u5f53\u7136\uff0cAI \u53ef\u4ee5\u5e2e\u52a9\u4f60\u66f4\u5feb\u901f\u5730\u6d4f\u89c8\u624b\u518c\u3001\u7406\u89e3\u7a0b\u5e8f\u7684\u884c\u4e3a</li> </ul>"},{"location":"courses/os_lab/19_system_call_and_shell.html#_2","title":"\u590d\u523b\u7ecf\u5178","text":""},{"location":"courses/os_lab/19_system_call_and_shell.html#a-zero-dependency-unix-shell-from-xv6","title":"A Zero-dependency UNIX Shell (from xv6)","text":"<p>Shell \u662f Kernel \u4e4b\u5916\u7684 \u201c\u58f3\u201d</p> <ul> <li>\u5b83\u4e5f\u662f\u4e00\u4e2a\u72b6\u6001\u673a (\u540c minimal.S)</li> <li>\u5b8c\u5168\u57fa\u4e8e\u7cfb\u7edf\u8c03\u7528 API</li> </ul> <p>\u968f\u5802\u5b9e\u9a8c\u4ee3\u7801\uff1a\u79fb\u690d\u4e86 xv6 \u7684 shell</p> <ul> <li>\u96f6\u5e93\u51fd\u6570\u4f9d\u8d56 (<code>-ffreestanding</code> \u7f16\u8bd1\u3001ld \u94fe\u63a5)</li> <li>\u53ef\u4ee5\u4f5c\u4e3a\u6700\u5c0f Linux \u7684 init \u7a0b\u5e8f</li> </ul> <p>\u652f\u6301\u7684\u529f\u80fd\uff08\u547d\u4ee4\u9700\u8981\u7edd\u5bf9\u8def\u5f84\uff09</p> <ul> <li>\u91cd\u5b9a\u5411/\u7ba1\u9053 <code>ls &gt; a.txt</code>, <code>ls | wc -l</code></li> <li>\u540e\u53f0\u6267\u884c <code>ls &amp;</code></li> <li>\u547d\u4ee4\u7ec4\u5408 <code>(echo a ; echo b) | wc -l</code></li> </ul>"},{"location":"courses/os_lab/19_system_call_and_shell.html#_3","title":"\u5982\u4f55\u9605\u8bfb\u4ee3\u7801","text":"<p>strace</p> <ul> <li>\u9002\u5f53\u7684\u5206\u5c4f\u548c\u8fc7\u6ee4</li> <li>AI \u4f7f\u9605\u8bfb\u6587\u6863\u7684\u6210\u672c\u5927\u5e45\u964d\u4f4e</li> </ul> <p>gdb</p> <ul> <li>AskGPT: How to debug a process that forks children processes in gdb?</li> <li>AI \u4e5f\u53ef\u4ee5\u5e2e\u4f60\u89e3\u91ca (\u4e0d\u7528\u53bb\u6dd8\u6587\u6863\u4e86)</li> <li>\u4ee5\u53ca\uff0c\u5b9a\u5236\u7684 visualization</li> <li>\u5bf9\u4e8e Shell\uff0c\u6211\u4eec\u5e94\u8be5\u663e\u793a\u4ec0\u4e48\uff1f</li> </ul>"},{"location":"courses/os_lab/19_system_call_and_shell.html#_4","title":"\u7406\u89e3\u7ba1\u9053","text":""},{"location":"courses/os_lab/19_system_call_and_shell.html#_5","title":"\u5c55\u671b\u672a\u6765","text":""},{"location":"courses/os_lab/19_system_call_and_shell.html#unix-shell-traps-and-pitfalls","title":"UNIX Shell: Traps and Pitfalls","text":"<p>\u5728 \u201c\u81ea\u7136\u8bed\u8a00\u201d\u3001\u201c\u673a\u5668\u8bed\u8a00\u201d \u548c \u201c1970s \u7684\u7b97\u529b\u201d \u4e4b\u95f4\u8fbe\u5230\u4f18\u96c5\u7684\u5e73\u8861</p> <ul> <li> <p>\u5e73\u8861\u610f\u5473\u7740\u5e76\u4e0d\u603b\u662f\u5b8c\u7f8e</p> </li> <li> <p>\u64cd\u4f5c\u7684 \u201c\u4f18\u5148\u7ea7\u201d\uff1f</p> </li> <li> <p><code>ls &gt; a.txt | cat</code></p> <ul> <li>\u6211\u5df2\u7ecf\u91cd\u5b9a\u5411\u7ed9 a.txt \u4e86\uff0ccat \u662f\u4e0d\u662f\u5c31\u6536\u4e0d\u5230\u8f93\u5165\u4e86\uff1f</li> </ul> </li> <li> <p><code>bash/zsh</code> \u7684\u884c\u4e3a\u662f\u4e0d\u540c\u7684</p> <ul> <li>\u6240\u4ee5\u811a\u672c\u4e00\u822c\u90fd\u662f <code>#!/bin/bash</code> \u751a\u81f3 <code>#!/bin/sh</code> \u4fdd\u6301\u517c\u5bb9</li> </ul> </li> </ul>"},{"location":"courses/os_lab/19_system_call_and_shell.html#_6","title":"\u53e6\u4e00\u4e2a\u6709\u8da3\u7684\u4f8b\u5b50","text":"<pre><code>$ echo hello &gt; /etc/a.txt\nbash: /etc/a.txt: Permission denied\n\n# \u91cd\u5b9a\u5411\u64cd\u4f5c\u4ecd\u7136\u662f\u4ee5\u5f53\u524d\u7528\u6237\u7684\u6743\u9650\u8fdb\u884c\n# correct: sudo sh -c 'echo hello &gt; /etc/a.txt'\n$ sudo echo hello &gt; /etc/a.txt\nbash: /etc/a.txt: Permission denied\n</code></pre>"},{"location":"courses/os_lab/19_system_call_and_shell.html#_7","title":"\u5c55\u671b\u672a\u6765","text":"<p>Open question: \u6211\u4eec\u80fd\u5426\u4ece\u6839\u672c\u4e0a\u6539\u53d8\u7ba1\u7406\u64cd\u4f5c\u7cfb\u7edf\u7684\u65b9\u5f0f\uff1f</p> <p>\u9700\u6c42\u5206\u6790</p> <ul> <li>Fast Path: \u7b80\u5355\u4efb\u52a1</li> <li>\u5c3d\u53ef\u80fd\u5feb</li> <li>100% \u51c6\u786e</li> <li>Slow Path: \u590d\u6742\u4efb\u52a1</li> <li>\u4efb\u52a1\u63cf\u8ff0\u672c\u8eab\u5c31\u53ef\u80fd\u5f88\u957f</li> <li>\u9700\u8981 \u201c\u7f16\u7a0b\u201d</li> </ul>"},{"location":"courses/os_lab/19_system_call_and_shell.html#shell","title":"\u672a\u6765\u7684 Shell","text":"<p>\u81ea\u7136\u4ea4\u4e92/\u8111\u673a\u63a5\u53e3\uff1a\u5fc3\u60f3\u4e8b\u6210</p> <ul> <li>Shell \u5c31\u6210\u4e3a\u4e86\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u7684\u4ea4\u4e92\u5e93</li> <li>UNIX Shell \u662f \u201c\u81ea\u7136\u8bed\u8a00\u201d\u3001\u201c\u673a\u5668\u8bed\u8a00\u201d \u4e4b\u95f4\u7684\u8fb9\u7f18\u5730\u5e26</li> </ul> <p>\u7cfb\u7edf\u7ba1\u7406\u4e0e\u8bed\u8a00\u6a21\u578b</p> <ul> <li>fish, zsh, Warp, ...</li> <li>Stackoverflow, tldr, thef**k (\u81ea\u52a8\u4fee\u590d)</li> <li>Command palette of vscode (Ctrl-Shift-P)</li> <li>Predictable</li> <li>\u6d41\u7a0b\u5f88\u5feb (\u65e0\u9700\u68c0\u67e5)\uff0c\u4f46\u53ef\u80fd\u72af\u50bb</li> <li>Creative</li> <li>\u7ed9\u4f60\u60ca\u559c\uff0c\u4f46\u5076\u5c14\u72af\u9519</li> </ul>"},{"location":"courses/os_lab/20-c_standard_lib.html","title":"C\u6807\u51c6\u5e93\u548c\u5b9e\u73b0","text":"<p>\u5728\u7cfb\u7edf\u8c03\u7528\u548c\u8bed\u8a00\u673a\u5236\u7684\u57fa\u7840\u4e0a\uff0clibc \u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u5f00\u53d1\u8de8\u5e73\u53f0\u5e94\u7528\u7a0b\u5e8f\u7684 \u201c\u7b2c\u4e00\u7ea7\u62bd\u8c61\u201d\u3002\u5728\u6b64\u57fa\u7840\u4e0a\u6784\u5efa\u8d77\u4e86\u4e07\u5343\u4e16\u754c\uff1aC++ (\u6269\u5145\u4e86 C \u6807\u51c6\u5e93)\u3001Java\u3001\u6d4f\u89c8\u5668\u4e16\u754c\u2026\u2026\u4eca\u5929\uff0cC \u8bed\u8a00\u5728\u5e94\u7528\u5f00\u53d1\u65b9\u9762\u6709\u5f88\u591a\u7f3a\u9677\uff0c\u4f46\u4ecd\u7136\u4e3a \u201c\u7b2c\u4e00\u7ea7\u62bd\u8c61\u201d \u63d0\u4f9b\u4e86\u4e00\u4e2a\u6709\u8da3\u7684\u8303\u672c\uff1a</p> <ul> <li>C is not a low-level language</li> <li>C isn't a programming language any more</li> </ul>"},{"location":"courses/os_lab/20-c_standard_lib.html#libc","title":"libc\u7b80\u4ecb","text":"<p>\u4e16\u754c\u4e0a \u201c\u6700\u901a\u7528\u201d \u7684\u9ad8\u7ea7\u8bed\u8a00\u5e93\u51fd\u6570</p> <ul> <li>C \u662f\u4e00\u79cd \u201c\u9ad8\u7ea7\u6c47\u7f16\u8bed\u8a00\u201d</li> <li>\u4f5c\u4e3a\u5bf9\u6bd4\uff0cC++ \u66f4\u597d\u7528\uff0c\u4f46\u4e5f\u66f4\u96be\u79fb\u690d</li> <li>\u5c4f\u853d\u4e86\u5e95\u5c42\u4f53\u7cfb\u7ed3\u6784\u7ec6\u8282</li> <li>\u7ba1\u7406\u6570\u636e\u3001\u8bf7\u6c42\u64cd\u4f5c\u7cfb\u7edf\u2026\u2026</li> </ul>"},{"location":"courses/os_lab/20-c_standard_lib.html#the-c-standard-library","title":"The C Standard Library","text":"<p>The GNU C Library - GNU Project - Free Software Foundation</p> <p>\u88ab\u5f88\u597d\u5730\u6807\u51c6\u5316</p> <ul> <li>ISO IEC \u6807\u51c6\u7684\u4e00\u90e8\u5206</li> <li>POSIX C Library \u7684\u5b50\u96c6</li> </ul> <p>C \u662f \u201c\u9ad8\u7ea7\u6c47\u7f16\u201d\uff0c\u4e00\u5b9a\u6709\u4e3a\u5d4c\u5165\u5f0f\u8bbe\u5907\u5b9e\u73b0\u7684\u5d4c\u5165\u5f0f\u7684 libc\u3002</p>"},{"location":"courses/os_lab/20-c_standard_lib.html#musl-libc","title":"musl libc","text":"<p>musl is an implementation of the C standard library built on top of the Linux system call API, including interfaces defined in the base language standard, POSIX, and widely agreed-upon extensions. musl is lightweight, fast, simple, free, and strives to be correct in the sense of standards-conformance and safety.</p> <ul> <li>Alpine Linux\uff1a\u91c7\u7528 Musl + Busybox \u7684\u7ec4\u5408</li> </ul> <p>AskGPT: How to compile a C program using musl as libc instead of glibc ?</p> <ul> <li><code>musl-gcc</code></li> <li>\u8bd5\u4e00\u8bd5\uff1a\u4ece\u7b2c\u4e00\u6761\u6307\u4ee4\u5f00\u59cb\u8c03\u8bd5\u4e00\u4e2a C \u7a0b\u5e8f</li> </ul>"},{"location":"courses/os_lab/20-c_standard_lib.html#libc_1","title":"libc \u57fa\u672c\u529f\u80fd","text":""},{"location":"courses/os_lab/20-c_standard_lib.html#_1","title":"\u57fa\u7840\u6570\u636e\u7684\u4f53\u7cfb\u7ed3\u6784\u65e0\u5173\u62bd\u8c61","text":"<p>Freestanding \u73af\u5883\u4e0b\u4e5f\u53ef\u4ee5\u4f7f\u7528\u7684\u5b9a\u4e49</p> <ul> <li>stddef.h, stdint.h, stdbool.h, float.h, limits.h, stdarg.h\uff08\u53d8\u957f\u53c2\u6570\uff09, inttype.h, math.h, setjmp.h</li> <li>\u5177\u4f53\u7684API \u89c1 clibrary/</li> </ul>"},{"location":"courses/os_lab/20-c_standard_lib.html#_2","title":"\u5b57\u7b26\u4e32\u548c\u6570\u7ec4\u64cd\u4f5c","text":"<p>string.h\uff1a\u5b57\u7b26\u4e32/\u6570\u7ec4\u64cd\u4f5c</p> <ul> <li>\u6807\u51c6\u5e93\u53ea\u5bf9\u201c\u6807\u51c6\u5e93\u5185\u90e8\u6570\u636e\u7684\u201d\u7684\u7ebf\u7a0b\u5b89\u5168\u6027\u8d1f\u8d23\uff0c\u4f8b\u5982 <code>printf</code> \u7684 buffer\uff1b</li> <li>\u53ef\u4ee5\u901a\u8fc7\u9605\u8bfb\u6e90\u7801/\u91c7\u7528\u5b9e\u9a8c\u7684\u5f62\u5f0f\u9a8c\u8bc1</li> <li>\u4f8b\u5982\u5bf9 memset \u91c7\u7528\u591a\u7ebf\u7a0b\uff0c\u53ef\u4ee5\u9a8c\u8bc1\u5176\u7ebf\u7a0b\u4e0d\u5b89\u5168\uff1b</li> </ul> <p>libc \u4e0d\u5f97\u4e0d\u5728\u517c\u5bb9\u6027\u3001\u6027\u80fd\u7b49\u4e4b\u95f4\u8fbe\u5230\u6743\u8861</p> <ul> <li>\u591a\u7ebf\u7a0b\u5171\u4eab\u7684 API (\u4f8b\u5982\u6587\u4ef6\u64cd\u4f5c\u3001malloc/free \u7b49) \u9700\u8981\u4e0a\u9501</li> <li><code>memset/memcpy</code> \u8fd9\u7c7b\u6027\u80fd\u654f\u611f\u7684\u51fd\u6570\uff0c\u5219\u628a\u6d88\u9664\u6570\u636e\u7ade\u4e89\u7684\u4efb\u52a1\u4ea4\u7ed9\u4e86\u5f00\u53d1\u8005</li> </ul>"},{"location":"courses/os_lab/20-c_standard_lib.html#_3","title":"\u6392\u5e8f\u548c\u67e5\u627e","text":"<p>\u4f4e\u60c5\u5546 (\u4f4e\u914d\u7f6e) API\uff1aC</p> <pre><code>void qsort(void *base, size_t nmemb, size_t size,\n           int (*compar)(const void *, const void *));\n\nvoid *bsearch(const void *key, const void *base,\n              size_t nmemb, size_t size,\n              int (*compar)(const void *, const void *));\n</code></pre> <p>\u9ad8\u60c5\u5546 API\uff1aC++</p> <pre><code>sort(xs.begin(), xs.end(), [] (auto&amp; a, auto&amp; b) {...});\nxs.sort(lambda key=...)\n</code></pre>"},{"location":"courses/os_lab/20-c_standard_lib.html#_4","title":"\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u8c61\u4e0e\u73af\u5883","text":""},{"location":"courses/os_lab/20-c_standard_lib.html#stdioh","title":"stdio.h","text":"<p>FILE * \u80cc\u540e\u662f\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u7528 gdb \u67e5\u770b\u5177\u4f53\u7684 <code>FILE *</code></p> <ul> <li>\u5c01\u88c5\u4e86\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u7684\u7cfb\u7edf\u8c03\u7528 (fseek, fgetpos, ftell, feof, ...)</li> </ul> <p>vprintf \u7cfb\u5217</p> <ul> <li>\u4f7f\u7528\u4e86 <code>stdarg.h</code> \u7684\u53c2\u6570\u5217\u8868</li> </ul> <pre><code>int vfprintf(FILE *stream, const char *format, va_list ap);\nint vasprintf(char **ret, const char *format, va_list ap);\n</code></pre>"},{"location":"courses/os_lab/20-c_standard_lib.html#popen-pclose","title":"popen \u548c pclose","text":"<p>FILE popen(const char command, const char *mode);</p> <p>\u6211\u4eec\u5728\u6e38\u620f\u4fee\u6539\u5668\u4e2d\u4f7f\u7528\u4e86\u5b83\uff1a\u4f46\u5176\u662f\u4e00\u4e2a\u8bbe\u8ba1\u6709\u7f3a\u9677\u7684 API</p> <ul> <li>Since a pipe is by definition unidirectional, the type argument may specify only reading or writing, not both; the resulting stream is correspondingly read-only or write-only.</li> </ul> <p>\u9ad8\u60c5\u5546 API (\u73b0\u4ee3\u7f16\u7a0b\u8bed\u8a00)</p> <pre><code>subprocess.check_output(['cat'],\n  input=b'Hello World', stderr=subprocess.STDOUT)\n</code></pre> <pre><code>let dir_checksum = {\n  Exec::shell(\"find . -type f\")\n    | Exec::cmd(\"sort\") | Exec::cmd(\"sha1sum\")\n}.capture()?.stdout_str();\n</code></pre>"},{"location":"courses/os_lab/20-c_standard_lib.html#err-error-perror","title":"err, error, perror","text":"<p>\u6240\u6709 API \u90fd\u53ef\u80fd\u5931\u8d25\uff1a</p> <pre><code>$ gcc nonexist.c\ngcc: error: nonexist.c: No such file or directory\n</code></pre> <p><code>man perror</code>,</p> <pre><code>// perror\u9996\u5148\u4f1a\u6253\u5370\u51famessage\uff0c\u7d27\u63a5\u7740\u6253\u5370\u4e00\u4e2a\u5192\u53f7\u201c\uff1a\u201d\u548c\u4e00\u4e2a\u7a7a\u683c\u3002\u6700\u540e\u6253\u5370\u5f53\u524derrno\u4ee3\u8868\u7684\u51fa\u9519\u539f\u56e0\u4fe1\u606f\nvoid perror( char const *message );\n</code></pre> <p><code>man 3 errno</code>\uff1a\u7ebf\u7a0b\u79c1\u6709\u53d8\u91cf\uff0c\u7c7b\u4f3c<code>__thread</code>\u4fee\u9970</p> <ul> <li><code>errno</code>\uff1anumber of last error\uff0c\u5982 <code>EACESS</code>, <code>ENOENT</code></li> </ul>"},{"location":"courses/os_lab/20-c_standard_lib.html#environ","title":"environ","text":"<p><code>environ</code>\u662f\u8c01\u8fdb\u884c\u8d4b\u503c\uff1f</p> <ul> <li>RTFM: System V ABI</li> <li>p33\uff1aFigure 3.9 Initial Process Stack</li> <li>\u64cd\u4f5c\u7cfb\u7edf\uff1aargc + argv + environ\uff1b</li> </ul> <pre><code>int main() {\n  extern char **environ;\n  for (char **env = environ; *env; env++) {\n    printf(\"%s\\n\", *env);\n  }\n}\n</code></pre> <p>\u73af\u5883\u53d8\u91cf <code>extern char **environ</code>\u7684\u601d\u8003\uff1a\u901a\u8fc7\u5bf9 <code>musl</code> \u7684 debug</p> <ul> <li>\u7a0b\u5e8f\u7684\u7b2c\u4e00\u6761\u6307\u4ee4\u6267\u884c\u65f6\uff0c<code>environ</code>\u662f\u6ca1\u6709\u8fdb\u884c\u8d4b\u503c\uff1b</li> <li>main \u51fd\u6570\u6267\u884c\u65f6\uff0c<code>environ</code>\u5df2\u7ecf\u88ab\u8d4b\u503c\uff1b</li> <li><code>_start_c</code> --&gt; <code>__libc_start_main</code>--&gt;<code>__init_llibc</code>\uff1b</li> </ul> <p>\u64cd\u4f5c\u7cfb\u7edf\u7ed9\u8fdb\u7a0b\u7684\u521d\u59cb\u72b6\u6001\uff1ainitial process stack\uff08\u6839\u636e\u9700\u6c42/\u573a\u666f\u641c\u7d22\u76f8\u5173\u7684\u6743\u5a01\u624b\u518c\uff09</p> <p></p>"},{"location":"courses/os_lab/20-c_standard_lib.html#_5","title":"\u52a8\u6001\u5185\u5b58\u7ba1\u7406","text":""},{"location":"courses/os_lab/20-c_standard_lib.html#_6","title":"\u5982\u4f55\u5206\u914d\u4e00\u5927\u6bb5\u5185\u5b58","text":"<ul> <li>\u7528 <code>MAP_ANONYMOUS</code> \u7533\u8bf7\uff0c\u60f3\u591a\u5c11\u5c31\u6709\u591a\u5c11\uff0c\u8d85\u8fc7\u7269\u7406\u5185\u5b58\u4e0a\u9650\u90fd\u884c</li> </ul> <p>\u53cd\u800c\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4e0d\u652f\u6301\u5206\u914d\u4e00\u5c0f\u6bb5\u5185\u5b58</p> <ul> <li>\u8fd9\u662f\u5e94\u7528\u7a0b\u5e8f\u81ea\u5df1\u7684\u4e8b\u60c5</li> </ul>"},{"location":"courses/os_lab/20-c_standard_lib.html#malloc-free","title":"malloc \u548c free","text":"<p>\u591a\u7ebf\u7a0b\u5b89\u5168\u4e0b\u7684\u6027\u80fd</p> <p>\u5728\u5927\u533a\u95f4 [L,R) \u4e2d\u7ef4\u62a4\u4e92\u4e0d\u76f8\u4ea4\u7684\u533a\u95f4\u7684\u96c6\u5408 \\(M={[l_0,r_0), [l_1,r_1), ... [ln0,r_n)}\\)</p> <ul> <li>\\(malloc(s)\\)\uff1a\u8fd4\u56de\u5927\u5c0f\u4e3a s \u7684\u533a\u95f4</li> <li>\u5fc5\u8981\u65f6\u53ef\u4ee5\u5411\u64cd\u4f5c\u7cfb\u7edf\u7533\u8bf7\u989d\u5916\u7684[L,R) (\u89c2\u5bdf strace)</li> <li>\u5141\u8bb8\u5728\u5185\u5b58\u4e0d\u8db3\u65f6 \u201c\u62d2\u7edd\u201d \u8bf7\u6c42</li> <li>\\(free(l,r)\\)\uff1a\u7ed9\u5b9a \\(l\\)\uff0c\u5220\u9664 \\([l,r) \\in M\\)</li> </ul>"},{"location":"courses/os_lab/20-c_standard_lib.html#mallocfree","title":"\u9ad8\u6548\u7684 malloc/free","text":"<p>Permature optimazation is the root of all evil.             -- D.E.Knuth</p> <ul> <li>\u8131\u79bb workload \u505a\u4f18\u5316\u5c31\u662f\u800d\u6d41\u6c13\uff08\u771f\u5b9e\u573a\u666f\uff0cbenchmark\uff09</li> </ul> <p>paper\uff1a</p> <ul> <li>2019-Mimalloc: free list sharding in action</li> </ul>"},{"location":"courses/os_lab/20-c_standard_lib.html#workload","title":"Workload \u5206\u6790","text":"<p>\u5728\u5b9e\u9645\u7cfb\u7edf\u4e2d\uff0c\u6211\u4eec\u901a\u5e38\u4e0d\u8003\u8651 adversarial \u7684 worst case</p> <ul> <li>\u6307\u5bfc\u601d\u60f3\uff1aO(n) \u5927\u5c0f\u7684\u5bf9\u8c61\u5206\u914d\u540e\u81f3\u5c11\u6709 \u03a9(n) \u7684\u8bfb\u5199\u64cd\u4f5c\uff0c\u5426\u5219\u5c31\u662f performance bug (\u4e0d\u5e94\u8be5\u5206\u914d\u90a3\u4e48\u591a)</li> <li>\u8d8a\u5c0f\u7684\u5bf9\u8c61\u521b\u5efa/\u5206\u914d\u8d8a\u9891\u7e41\uff1a\u4f18\u5316\u7684\u65b9\u5411<ul> <li>\u5b57\u7b26\u4e32\u3001\u4e34\u65f6\u5bf9\u8c61\u7b49\uff1b\u751f\u5b58\u5468\u671f\u53ef\u957f\u53ef\u77ed</li> </ul> </li> <li>\u8f83\u4e3a\u9891\u7e41\u5730\u5206\u914d\u4e2d\u7b49\u5927\u5c0f\u7684\u5bf9\u8c61<ul> <li>\u8f83\u5927\u7684\u6570\u7ec4\u3001\u590d\u6742\u7684\u5bf9\u8c61\uff1b\u66f4\u957f\u7684\u751f\u5b58\u5468\u671f</li> </ul> </li> <li>\u4f4e\u9891\u7387\u7684\u5927\u5bf9\u8c61<ul> <li>\u5de8\u5927\u7684\u5bb9\u5668\u3001\u5206\u914d\u5668\uff1b\u5f88\u957f\u7684\u751f\u5b58\u5468\u671f</li> </ul> </li> <li>\u5e76\u884c\u3001\u5e76\u884c\u3001\u518d\u5e76\u884c</li> <li>\u6240\u6709\u5206\u914d\u90fd\u4f1a\u5728\u6240\u6709\u5904\u7406\u5668\u4e0a\u53d1\u751f</li> <li>\u4f7f\u7528\u94fe\u8868/\u533a\u95f4\u6811 (first fit) \u53ef\u4e0d\u662f\u4e2a\u597d\u60f3\u6cd5\uff1a\u65e0\u6cd5\u5e76\u884c</li> </ul>"},{"location":"courses/os_lab/20-c_standard_lib.html#fast-and-slow","title":"Fast and Slow","text":"<p>\u8bbe\u7f6e\u4e24\u5957\u7cfb\u7edf\uff1a</p> <ul> <li>Fast path</li> <li>\u6027\u80fd\u6781\u597d\u3001\u5e76\u884c\u5ea6\u6781\u9ad8\u3001\u8986\u76d6\u5927\u90e8\u5206\u60c5\u51b5</li> <li>\u4f46\u6709\u5c0f\u6982\u7387\u4f1a\u5931\u8d25 (fall back to slow path)</li> <li>Slow path</li> <li>\u4e0d\u5728\u4e4e\u90a3\u4e48\u5feb</li> <li>\u4f46\u628a\u56f0\u96be\u7684\u4e8b\u60c5\u505a\u597d\uff1a\u8ba1\u7b97\u673a\u7cfb\u7edf\u91cc\u6709\u5f88\u591a\u8fd9\u6837\u7684\u4f8b\u5b50 (\u6bd4\u5982 cache)</li> </ul> <p>\u4eba\u7c7b\u4e5f\u662f\u8fd9\u6837\u7684\u7cfb\u7edf</p> <ul> <li>Daniel Kahneman. Thinking, Fast and Slow. Farrar, Straus and Giroux, 2011.</li> </ul>"},{"location":"courses/os_lab/20-c_standard_lib.html#malloc-fast-path","title":"<code>malloc</code>: Fast Path \u8bbe\u8ba1","text":""},{"location":"courses/os_lab/20-c_standard_lib.html#cpu","title":"\u4f7f\u6240\u6709 CPU \u90fd\u80fd\u5e76\u884c\u5730\u7533\u8bf7\u5185\u5b58","text":"<ul> <li>\u7ebf\u7a0b\u90fd\u4e8b\u5148\u74dc\u5206\u4e00\u4e9b \u201c\u9886\u5730\u201d (thread-local allocation buffer)</li> <li>\u9ed8\u8ba4\u4ece\u81ea\u5df1\u7684\u9886\u5730\u91cc\u5206\u914d</li> <li>\u9664\u4e86\u5728\u53e6\u4e00\u4e2a CPU \u91ca\u653e\uff0c<code>acquire lock</code> \u51e0\u4e4e\u603b\u662f\u6210\u529f</li> <li>\u5982\u679c\u81ea\u5df1\u7684\u9886\u5730\u4e0d\u8db3\uff0c\u5c31\u4ece\u5168\u5c40\u7684\u6c60\u5b50\u91cc\u501f\u4e00\u70b9</li> </ul> <p>\u4e0d\u8981\u5728\u4e4e\u4e00\u70b9\u5c0f\u7684\u6d6a\u8d39</p> <ul> <li>\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u8981\u5bf9\u9f50\u5230 \\(2^k\\) \u5b57\u8282</li> </ul>"},{"location":"courses/os_lab/20-c_standard_lib.html#segregated-list","title":"\u5c0f\u5185\u5b58\uff1aSegregated List","text":"<p>\u5206\u914d: Segregated List (Slab)</p> <ul> <li>\u6bcf\u4e2a slab \u91cc\u7684\u6bcf\u4e2a\u5bf9\u8c61\u90fd\u4e00\u6837\u5927</li> <li>\u6bcf\u4e2a\u7ebf\u7a0b\u62e5\u6709\u6bcf\u4e2a\u5bf9\u8c61\u5927\u5c0f\u7684 slab</li> <li>fast path \u2192 \u7acb\u5373\u5728\u7ebf\u7a0b\u672c\u5730\u5206\u914d\u5b8c\u6210</li> <li>slow path \u2192 pgalloc()</li> <li>\u4e24\u79cd\u5b9e\u73b0</li> <li>\u5168\u5c40\u5927\u94fe\u8868 v.s. List sharding (per-page \u5c0f\u94fe\u8868)</li> </ul> <p>\u56de\u6536</p> <ul> <li>\u76f4\u63a5\u5f52\u8fd8\u5230 slab \u4e2d</li> <li>\u6ce8\u610f\u8fd9\u53ef\u80fd\u662f\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u6301\u6709\u7684 slab\uff0c\u9700\u8981 per-slab \u9501 (\u5c0f\u5fc3\u6570\u636e\u7ade\u4e89)</li> </ul>"},{"location":"courses/os_lab/20-c_standard_lib.html#_7","title":"\u5927\u5185\u5b58\uff1a\u4e00\u628a\u5927\u9501\u4fdd\u5e73\u5b89","text":"<p>Buddy system (1963)</p> <ul> <li>\u5982\u679c\u4f60\u60f3\u5206\u914d 1, 2, 3, 4, ...n\u4e2a\u8fde\u7eed\u7684\u9875\u9762\uff1f</li> <li>\u4f8b\u5982\uff1a64 KB/\u9875\u9762</li> <li>\u90a3\u5c31 first fit \u6216\u8005 best fit \u5427\u2026\u2026</li> </ul> <p>\u4f60\u53ea\u9700\u8981\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u89e3\u51b3\u95ee\u9898</p> <ul> <li>\u533a\u95f4\u6811\uff1b\u7ebf\u6bb5\u6811\u2026\u2026</li> </ul>"},{"location":"courses/os_lab/20-c_standard_lib.html#mallocfree_1","title":"\u73b0\u5b9e\u4e16\u754c\u4e2d\u7684 malloc/free","text":"<p>\u4ee5\u4e0a\u5c31\u662f\u6240\u6709\u73b0\u4ee3 malloc/free \u5b9e\u73b0\u7684\u57fa\u7840</p> <ul> <li>\u5f53\u7136\uff0c\u5b9e\u9645\u60c5\u51b5\u4f1a\u590d\u6742\u4e00\u4e9b\uff0c\u6027\u80fd\u4e5f\u662f\u9531\u94e2\u5fc5\u8f83</li> <li>glibc: arena \u2192 heap \u2192 tcache (thread-local)</li> <li>tcmalloc: thread-caching malloc, mimalloc</li> <li>OpenJDK: ZGC: region based + tlab (thread-local)<ul> <li>managed memory \u5141\u8bb8 object move\uff0c\u56e0\u6b64\u590d\u6742\u5f97\u591a\u2026\u2026</li> </ul> </li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html","title":"\u53ef\u6267\u884c\u6587\u4ef6\u4e0e\u52a0\u8f7d","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a</p> <ul> <li>\u53ef\u6267\u884c\u6587\u4ef6</li> <li>\u9759\u6001/\u52a8\u6001\u94fe\u63a5\u548c\u52a0\u8f7d</li> <li>\u52a8\u6001\u94fe\u63a5\u4e0e\u52a0\u8f7d</li> <li>ELF \u7684\u52a8\u6001\u94fe\u63a5</li> <li><code>LD_PRELOAD</code> Hooking</li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#_2","title":"\u53ef\u6267\u884c\u6587\u4ef6","text":""},{"location":"courses/os_lab/21-22-executable_files_loading.html#_3","title":"\u4ec0\u4e48\u662f\u53ef\u6267\u884c\u6587\u4ef6","text":"<p>ELF \u683c\u5f0f\uff08Linux\uff09</p> <ul> <li><code>readelf</code> </li> </ul> <p>\u53ef\u6267\u884c\u6587\u4ef6\uff1a</p> <ul> <li>\u4e00\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u5bf9\u8c61\uff08\u6587\u4ef6\uff09</li> <li>\u4e00\u4e2a\u5b57\u8282\u5e8f\u5217\uff08\u53ef\u4ee5\u5f53\u6587\u672c\u7f16\u8f91\uff09</li> <li>\u63cf\u8ff0\u72b6\u6001\u673a\u521d\u59cb\u72b6\u6001\u7684\u6570\u636e\u7ed3\u6784</li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#_4","title":"\u4f5c\u4e3a\u201d\u6570\u636e\u7ed3\u6784\u201c\u7684\u53ef\u6267\u884c\u6587\u4ef6","text":"<p>RTFM: System V ABI</p> <ul> <li>binutils \u4e2d\u7684\u5de5\u5177\u53ef\u4ee5\u8ba9\u6211\u4eec\u67e5\u770b\u5176\u4e2d\u7684\u91cd\u8981\u4fe1\u606f</li> </ul> <p>\u72b6\u6001\u673a\u521d\u59cb\u72b6\u6001\u7684\u63cf\u8ff0\uff1a</p> <ul> <li>\u5185\u5b58\u4e2d\u5404\u6bb5\u7684\u4f4d\u7f6e\u548c\u6743\u9650</li> <li>\u521d\u59cb\u7684 PC \u5728 ELF Header \u7684 entry</li> <li>\u5bc4\u5b58\u5668\u548c\u6808\u7531\u64cd\u4f5c\u7cfb\u7edf\u51b3\u5b9a\uff08\u89c1\u4e0a\u4e00\u8282\u7684 env.c\uff09</li> </ul> <p>\u72b6\u6001\u673a\u7684\u63cf\u8ff0\uff1a</p> <ul> <li>\u4ee3\u7801</li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#_5","title":"\u52a0\u8f7d\u6700\u5c0f\u53ef\u6267\u884c\u6587\u4ef6","text":"<p>\u5b9e\u9a8c\u4ee3\u7801\uff1a\u901a\u8fc7 ChatGPT4 \u8fdb\u884c\u4ee3\u7801\u751f\u6210</p> <p>\u6700\u5c0f\u53ef\u6267\u884c\u6587\u4ef6\uff08\u6c47\u7f16\u5b9e\u73b0\u7684<code>HelloWorld</code>\uff0c<code>.text</code>\u6bb5\u5f88\u7b80\u5355\uff09</p> <ul> <li>\u4ee3\u7801\u5728\u5185\u5b58\u4e2d</li> <li>PC \u6307\u5411\u7b2c\u4e00\u6761\u6307\u4ee4</li> <li>\u9664\u6b64\u4e4b\u5916\uff0c\u4efb\u4f55\u521d\u59cb\u72b6\u6001\u90fd\u884c</li> </ul> <p>\u76f4\u63a5\u628a\u4ee3\u7801 <code>mmap</code> \u5230\u5185\u5b58</p> <ul> <li>\u7136\u540e\u8df3\u8f6c\u8fc7\u53bb\u5373\u53ef (\u4f60\u53ef\u4ee5\u60f3\u8c61 execve \u91cc\u5c31\u505a\u4e86\u8fd9\u4ef6\u4e8b)</li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#_6","title":"\u9759\u6001\u94fe\u63a5\u548c\u52a0\u8f7d","text":""},{"location":"courses/os_lab/21-22-executable_files_loading.html#elf-loader","title":"\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u5b9e\u73b0 ELF Loader","text":"<p>\u52a0\u8f7d\u5668 (loader) \u7684\u804c\u8d23\uff08\u9759\u6001\u94fe\u63a5\uff0c\u6240\u6709\u7684\u5185\u5bb9\u90fd\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u91cc\uff09</p> <ul> <li>\u89e3\u6790\u6570\u636e\u7ed3\u6784</li> <li>\u521b\u5efa\u8fdb\u7a0b\u521d\u59cb\u72b6\u6001</li> <li>argv, envp, ...</li> <li>\u518d\u4e00\u6b21\uff0cSystem V ABI</li> <li>\u8df3\u8f6c\u6267\u884c</li> </ul> <p>\u4ee3\u7801\u793a\u4f8b\uff1a\u6253\u5370 environ \u7684\u4e8c\u8fdb\u5236\u4ee3\u7801</p> <ul> <li>\u80fd\u6b63\u786e\u5904\u7406\u53c2\u6570/\u73af\u5883\u53d8\u91cf env.c</li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#boot-block-loader","title":"Boot Block Loader","text":"<p>\u52a0\u8f7d\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\uff1f</p> <ul> <li>\u4e5f\u662f\u4e00\u4e2a ELF \u6587\u4ef6</li> <li>\u89e3\u6790\u6570\u636e\u7ed3\u6784 + \u590d\u5236\u5230\u5185\u5b58 + \u8df3\u8f6c</li> </ul> <p>\u4e4b\u524d\u7ed9\u5927\u5bb6\u770b\u8fc7\u4e00\u773c</p> <ul> <li>\u505a\u5f97\u4e8b\u60c5\u4e0e\u9759\u6001\u52a0\u8f7d\u5668\u5b8c\u5168\u4e00\u6837</li> <li>\u6ca1\u6709 mmap \u600e\u4e48\u529e\uff1f</li> <li>\u7528 I/O \u6307\u4ee4\u628a\u6570\u636e\u4ece\u78c1\u76d8\u642c\u5230\u5185\u5b58\uff0c\u8bfb\u6210\u81ea\u5df1\u5e8f\u5217\uff0c\u7136\u540e\u6307\u9488\u8d4b\u503c\uff08\u5982\u4f55\u53ef\u6267\u884c\uff1f<code>mprotect</code>\uff09\uff1b</li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#elf","title":"ELF \u6587\u4ef6\u662f\u5982\u4f55\u751f\u6210\u7684\uff1f","text":"<p>\u4e00\u4e2a\u5b57\u8282\u4e00\u4e2a\u5b57\u8282 \u201c\u5199\u51fa\u6765\u201d \u7684</p> <ul> <li><code>printf(\"\\x7f\");</code></li> </ul> <p>\u7edd\u5927\u90e8\u5206\u6307\u4ee4\u90fd\u662f\u7f16\u8bd1\u65f6\u5c31\u5b8c\u5168\u786e\u5b9a</p> <pre><code>int bar();\n\nint foo() {\n\n        return bar() + 1;\n}\n// gcc -c test.c\n// objdump -d test.o\nDisassembly of section .text:\n\n0000000000000000 &lt;foo&gt;:\n   0:   55                      push   %rbp\n   1:   48 89 e5                mov    %rsp,%rbp\n   4:   b8 00 00 00 00          mov    $0x0,%eax\n   9:   e8 00 00 00 00          callq  e &lt;foo+0xe&gt;\n   e:   83 c0 01                add    $0x1,%eax\n  11:   5d                      pop    %rbp\n  12:   c3                      retq   \n\n// readelf -a test.o\nRelocation section '.rela.text' at offset 0x1c0 contains 1 entry:\n  Offset          Info           Type           Sym. Value    Sym. Name + Addend\n00000000000a  000900000004 R_X86_64_PLT32    0000000000000000 bar - 4\n</code></pre> <ul> <li>\u4f46\u6709\u5c11\u90e8\u5206\u4e0d\u80fd\uff0c\u4f8b\u5982 printf \u7684\u5730\u5740 (\u5f15\u7528\u7b2c\u4e09\u65b9)</li> <li>call \u4f1a\u7f16\u8bd1\u6210 <code>e8 00 00 00</code><ul> <li>\u590d\u4e60\u9898\uff1a<code>offset 0</code> \u662f\u8df3\u8f6c\u5230\u54ea\u6761\u6307\u4ee4\uff0c\u4e3a\u4ec0\u4e48\uff1f</li> <li>\u4e0b\u4e00\u6761\u6307\u4ee4\u7684\u5f00\u59cb\uff08\u5373\u672c\u6761\u6307\u4ee4\u7684\u672b\u5c3e\uff09\uff0c\u800c\u4e0d\u662f\u672c\u6761\u6307\u4ee4\u7684\u5f00\u59cb\u3002\uff08\u6307\u4ee4\u53ef\u4ee5\u52a0\u524d\u7f00\uff09</li> </ul> </li> <li>\u8fde\u63a5\u65f6\u9700\u8981 relocate<ul> <li>\u8fd9\u4e5f\u662f ELF \u201c\u6570\u636e\u7ed3\u6784\u201d \u7684\u4e00\u90e8\u5206</li> <li>\u4f60\u53ef\u4ee5\u7406\u89e3\u6210 \u201c<code>ADDR_OF(puts) + 4</code>\u201d \u8fd9\u79cd\u8fd0\u7b97\u89c4\u5219</li> </ul> </li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#ics","title":"\u4e3a\u4ec0\u4e48 ICS \u8bfe\u7684 \u201c\u94fe\u63a5\u548c\u52a0\u8f7d\u201d \u5982\u6b64\u50f5\u786c\uff1f","text":"<p>ELF \u4e0d\u662f\u4e00\u4e2a\u597d\u7684 \u201c\u63cf\u8ff0\u72b6\u6001\u673a\u6570\u636e\u7ed3\u6784\u201d \u7684\u683c\u5f0f\uff0c\u5f7b\u5e95\u8fdd\u80cc\u4e86\u4fe1\u606f\u7684\u5c40\u90e8\u6027\u539f\u5219\uff1a</p> <ul> <li>\u542b\u4e49\u9690\u6666\u7684 <code>R_X86_64_32</code>, <code>R_X86_64_PLT32</code></li> <li>\u4e0d\u9760\u89e3\u6790\u6839\u672c\u4e0d\u53ef\u80fd\u770b\u61c2</li> <li>\u5927\u91cf\u7684 \u201c\u6307\u9488\u201d (\u4eba\u7c7b\u65e0\u6cd5\u9605\u8bfb\u7684\u504f\u79fb\u91cf)</li> <li>\u7b49\u4e8e\u76f4\u63a5\u8ba9\u4f60\u53bb\u8bfb\u4e00\u4e2a\u5185\u5b58\u6570\u636e\u7ed3\u6784\u7684 core dump</li> </ul> <p>\u4e00\u4e2a\u673a\u4f1a\u91cd\u65b0\u8bbe\u8ba1\uff1f</p> <ul> <li>\u53ef\u4ee5\u505a\u4e2a JSON-based\uff0c\u53ef\u8bfb\u7684\u683c\u5f0f</li> <li>FLE: A Fast, Legible, and Expedient Binary Format</li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#_7","title":"\u52a8\u6001\u94fe\u63a5\u548c\u52a0\u8f7d","text":""},{"location":"courses/os_lab/21-22-executable_files_loading.html#_8","title":"\u201d\u62c6\u89e3\u5e94\u7528\u7a0b\u5e8f\u201c\u7684\u9700\u6c42","text":"<p>\u5b9e\u73b0\u8fd0\u884c\u5e93\u548c\u5e94\u7528\u4ee3\u7801\u5206\u79bb</p> <ul> <li>Linux \u4e2d\u7edd\u5927\u90e8\u5206\u5e94\u7528\u90fd\u662f\u52a8\u6001\u94fe\u63a5\u7684\uff1a\u7cfb\u7edf\u4e2d\u53ea\u6709\u4e00\u4efd libc \uff08\u8282\u7701\u78c1\u76d8\uff09</li> <li>Library \u4fdd\u6301\u63a5\u53e3\u7684\u5411\u540e\u517c\u5bb9\uff1a\u8865\u4e01\u53d1\u5e03\u540e\u4e0d\u518d\u9700\u8981\u91cd\u7f16\u8bd1\u6240\u6709\u4f9d\u8d56\u7684\u5e94\u7528</li> <li>Semantic Versioning\uff1a\u7248\u672c\u53f7\u89c4\u8303\uff08Major.Minor.Fix\uff09\uff1a\u201cCompatible\u201d \u662f\u4e2a\u6709\u4e9b\u5fae\u5999\u7684\u5b9a\u4e49</li> </ul> <p>\u5927\u578b\u9879\u76ee\u5185\u90e8\u4e5f\u53ef\u4ee5\u5185\u90e8\u5206\u89e3\uff1a\u7f16\u8bd1\u4e00\u90e8\u5206\uff0c\u4e0d\u7528\u91cd\u65b0\u94fe\u63a5</p> <ul> <li><code>libjvm.so, libart.so, ...</code></li> <li>NEMU: \u201c\u628a CPU \u63d2\u4e0a\u4e3b\u677f\u201d</li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#elf_1","title":"\u52a8\u6001\u94fe\u63a5\uff1a\u4eca\u5929\u4e0d\u8bb2 ELF","text":"<p>\u6bcf\u53e5\u8bdd\u90fd\u6ca1\u8bf4\u9519\uff0c\u4f46\u6ca1\u4eba\u80fd\u8ddf\u4e0a</p> <ul> <li>\u6839\u672c\u539f\u56e0\uff1a\u6982\u5ff5\u4e0a\u7d27\u5bc6\u76f8\u5173\u7684\u4e1c\u897f\u5728\u5b9e\u73b0\u4e2d\u88ab \u201c\u62c6\u6563\u201d \u4e86</li> </ul> <p>\u6362\u4e00\u79cd\u65b9\u6cd5</p> <ul> <li>\u5982\u679c\u7f16\u8bd1\u5668\u3001\u94fe\u63a5\u5668\u3001\u52a0\u8f7d\u5668\u90fd\u53d7\u4f60\u63a7\u5236</li> <li>\u4f60\u600e\u4e48\u8bbe\u8ba1\u3001\u5b9e\u73b0\u4e00\u4e2a \u201c\u6700\u76f4\u89c2\u201d \u7684\u52a8\u6001\u94fe\u63a5\u683c\u5f0f\uff1f</li> <li>\u518d\u53bb\u8003\u8651\u600e\u4e48\u6539\u8fdb\u5b83\uff0c\u4f60\u5c31\u5f97\u5230\u4e86 ELF\uff01</li> <li>\u5047\u8bbe\u7f16\u8bd1\u5668\u53ef\u4ee5\u4e3a\u4f60\u751f\u6210\u4f4d\u7f6e\u65e0\u5173\u4ee3\u7801 (PIC)</li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#dl","title":"\u8bbe\u8ba1\u4e00\u4e2a\u65b0\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u683c\u5f0f\uff08dl\uff09","text":"<p>\u52a8\u6001\u94fe\u63a5\u7684\u7b26\u53f7\u67e5\u8868\u5c31\u884c\u4e86\u561b\u3002</p> <pre><code>DL_HEAD\n\nLOAD(\"libc.dl\") # \u52a0\u8f7d\u52a8\u6001\u5e93\nIMPORT(putchar) # \u52a0\u8f7d\u5916\u90e8\u7b26\u53f7\nEXPORT(hello)   # \u4e3a\u52a8\u6001\u5e93\u5bfc\u51fa\u7b26\u53f7\n\nDL_CODE\n\nhello:\n  ...\n  call DSYM(putchar) # \u52a8\u6001\u94fe\u63a5\u7b26\u53f7\n  ...\n\nDL_END\n</code></pre> <p>\u7f16\u8bd1\u5668\uff1a<code>GCC, GNU as</code></p> <p><code>binutils</code></p> <ul> <li> <p><code>ld = objcopy</code> (\u5077\u6765\u7684)</p> </li> <li> <p><code>as = GNU as</code> (\u5077\u6765\u7684)</p> </li> <li> <p>\u5269\u4e0b\u7684\u5c31\u9700\u8981\u81ea\u5df1\u52a8\u624b\u4e86</p> </li> <li> <p><code>readdl (readelf)</code></p> </li> <li><code>objdump</code></li> <li> <p>\u4f60\u540c\u6837\u53ef\u4ee5\u5c71\u5be8 <code>addr2line, nm, objcopy, ...</code></p> </li> <li> <p>\u548c\u6700\u91cd\u8981\u7684\u52a0\u8f7d\u5668</p> </li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#dl_1","title":"\u89e3\u51b3 dl \u6587\u4ef6\u7684\u7f3a\u9677","text":""},{"location":"courses/os_lab/21-22-executable_files_loading.html#_9","title":"\u529f\u80fd\u7f3a\u9677","text":"<p>\u5b58\u50a8\u4fdd\u62a4\u548c\u52a0\u8f7d\u4f4d\u7f6e</p> <ul> <li>\u5141\u8bb8\u5c06 <code>.dl</code> \u4e2d\u7684\u4e00\u90e8\u5206\u4ee5\u67d0\u4e2a\u6307\u5b9a\u7684\u6743\u9650\u6620\u5c04\u5230\u5185\u5b58\u7684\u67d0\u4e2a\u4f4d\u7f6e (program header table)</li> </ul> <p>\u5141\u8bb8\u81ea\u7531\u6307\u5b9a\u52a0\u8f7d\u5668 (\u800c\u4e0d\u662f dlbox)</p> <ul> <li>\u52a0\u5165 <code>INTERP</code></li> </ul> <p>\u7a7a\u95f4\u6d6a\u8d39</p> <ul> <li>\u5b57\u7b26\u4e32\u5b58\u50a8\u5728\u5e38\u91cf\u6c60\uff0c\u7edf\u4e00\u901a\u8fc7 \u201c\u6307\u9488\u201d \u8bbf\u95ee\uff1a\u8fd9\u662f\u5e26\u6765 ELF \u6587\u4ef6\u96be\u8bfb\u7684\u6700\u6839\u672c\u539f\u56e0</li> </ul> <p>\u5176\u4ed6\uff1a\u4e0d\u90a3\u4e48\u91cd\u8981</p> <ul> <li>\u6309\u9700 RTFM/RTFSC</li> </ul> <pre><code>#define DSYM(sym)   *sym(%rip)\n</code></pre>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#_10","title":"\u6027\u80fd\u7f3a\u9677","text":"<p>DSYM \u662f\u95f4\u63a5\u5185\u5b58\u8bbf\u95ee</p> <pre><code>extern void foo();\nfoo();\n</code></pre> <p>\u4e00\u79cd\u5199\u6cd5\uff0c\u4e24\u79cd\u60c5\u51b5</p> <ul> <li>\u6765\u81ea\u5176\u4ed6\u7f16\u8bd1\u5355\u5143 (\u9759\u6001\u94fe\u63a5)\uff1a\u76f4\u63a5 PC \u76f8\u5bf9\u8df3\u8f6c\u5373\u53ef</li> <li>\u52a8\u6001\u94fe\u63a5\u5e93\uff1a\u5fc5\u987b\u67e5\u8868 (\u7f16\u8bd1\u65f6\u4e0d\u80fd\u51b3\u5b9a)</li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#_11","title":"\u52a8\u6001\u94fe\u63a5\u548c\u52a0\u8f7d\u539f\u7406","text":""},{"location":"courses/os_lab/21-22-executable_files_loading.html#_12","title":"\u5b9e\u73b0\u5e93\u7684\u8fd0\u884c\u65f6\u52a0\u8f7d","text":"<p>\u82e5\u5e72\u8981\u7d20</p> <ul> <li>\u7f16\u8bd1\u6210\u4f4d\u7f6e\u65e0\u5173\u4ee3\u7801\uff1a\u8fd9\u662f\u7f16\u8bd1\u5668\u53ef\u4ee5\u5b9e\u73b0\u7684</li> <li><code>lea (0x400000), addr_of_x</code> (no)</li> <li><code>lea 12(%rip), addr_of_x</code> (yes)</li> <li>\u5bf9\u5916\u90e8\u5e93\u51fd\u6570\u7684\u8c03\u7528\u662f\u67e5\u8868\u7684</li> <li><code>call TABLE(x)</code></li> <li>\u5728\u8fd0\u884c (\u52a0\u8f7d) \u65f6\u586b\u8868</li> <li>\u52a0\u8f7d\u65f6\u628a\u5bfc\u51fa\u7684\u7b26\u53f7\u586b\u5165 TABLE</li> </ul> <p>\u6211\u4eec \u201c\u53d1\u660e\u201d \u4e86 GOT (Global Offset Table)\uff1a\u5c31\u662f TABLE</p>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#_13","title":"\u4e00\u4e2a\u6709\u8da3\u7684\u95ee\u9898","text":"<pre><code>extern void foo();\n</code></pre> <p>\u7f16\u8bd1\u5668\u9047\u5230\u51fd\u6570\u8c03\u7528\uff0c\u5e94\u8be5\u7ffb\u8bd1\u6210\u54ea\u79cd\u6307\u4ee4\uff1f</p> <ul> <li>\u5982\u679c foo \u6765\u81ea\u540c\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u4e0d\u7528\u67e5\u8868\uff1a<code>call foo</code></li> <li>\u5982\u679c foo \u6765\u81ea\u53e6\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93\uff1a<code>call TABLE(foo)</code></li> </ul> <p>\u6211\u4eec\u53d1\u660e\u4e86 PLT (Procedure Linkage Table)\uff1a\u751f\u6210\u540c\u6837\u7684 call \u6307\u4ee4</p> <ul> <li>\u7f16\u8bd1\u5668\u603b\u662f\u751f\u6210\u4e00\u4e2a\u76f4\u63a5\u7684 call</li> <li>\u6765\u81ea\u53e6\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93\uff1acall putchar@PLT</li> <li> <p>\u94fe\u63a5\u7684\u65f6\u5019\u589e\u52a0\u95f4\u63a5\u8df3\u8f6c\u7684\u53ea\u8bfb\u4ee3\u7801</p> </li> <li> <p>\u51fd\u6570\u5b9e\u5728\u592a\u591a\u4e86</p> </li> <li>\u6bcf\u4e2a\u90fd\u6807\u8bb0\u533a\u5206\uff0c\u592a\u96be\u770b\u4e86</li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#elf_2","title":"ELF \u52a8\u6001\u94fe\u63a5\u4e0e\u52a0\u8f7d","text":"<p>\u66f4\u597d\u7684\u201d\u77e5\u8bc6\u7f51\u7edc\u201c\uff0c<code>ldd</code>\u7b49\u76f8\u5173\u547d\u4ee4 -&gt; \u201d\u72b6\u6001\u673a\u521d\u59cb\u72b6\u6001\u201c \u53ef\u89c6\u5316 </p>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#executable-linkable-format","title":"Executable Linkable Format","text":"<p>ELF \u548c \u201cdl\u201d \u6ca1\u6709\u672c\u8d28\u533a\u522b</p> <ul> <li>\u5f53\u7136\uff0c\u6709\u6d77\u91cf\u5de5\u7a0b\u5b9e\u8df5\u4e0a\u7684\u7ec6\u8282</li> <li>\u4e0e 99.9% \u7684\u7a0b\u5e8f\u5458\u65e0\u5173</li> </ul> <p>\u201c\u72b6\u6001\u673a\u521d\u59cb\u72b6\u6001\u201d \u2192 \u80fd\u591f\u53ef\u89c6\u5316</p> <ul> <li> <p>ldd - Print shared object dependencies</p> </li> <li> <p>SEE ALSO \u4e00\u76f4\u662f\u624b\u518c\u91cc\u7684\u5b9d\u85cf</p> </li> <li> <p>\u6307\u5411\u4e86 ld.so (8)</p> </li> </ul> <p>\u5bf9\u4e8e\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0cexecve \u540e\u7684\u7b2c\u4e00\u6761\u6307\u4ee4\u5728\u54ea\u91cc\uff1f</p> <ul> <li><code>gdb</code>\u4e2d <code>starti</code>\uff0c<code>ld.so</code>\u4e2d\u7684<code>_start</code>\uff1b</li> </ul> <p>\u8fd9\u79cd\u95ee\u9898\uff0c\u518d\u4e5f\u4e0d\u9700\u8981\u8001\u5e08\u6559\uff08\u4ece\u6b64 \u201c\u77e5\u8bc6\u201d \u4e0d\u518d\u662f\u58c1\u5792\u548c\u7981\u533a\uff09</p> <ul> <li><code>What are the first a few steps executed after execve() of a ELF dynamic link binary?</code></li> <li><code>How can I compile an ELF binary that use an alternative dynamic loader than the default ld.so?</code></li> <li><code>-Wl,--dynamic-linker=</code></li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#plt","title":"\u91cd\u65b0\u601d\u8003 PLT \u7684\u8bbe\u8ba1","text":"<p>\u6781\u81f4\u6027\u80fd\uff1a\u4e91\u4e0alinux\u865a\u62df\u673a\uff0c\u5355\u4e2a\u5e94\u7528\u76f4\u63a5\u5728\u5185\u6838\u6001\u6267\u884c\u3002</p> <pre><code>puts@PLT:\n  endbr64\n  bnd jmpq *GOT[n]  // *offset(%rip)\n</code></pre> <p>\u4e00\u4e2a\u6709\u8da3 (\u4e14\u6839\u672c) \u7684\u95ee\u9898</p> <ul> <li>\u5e93\u51fd\u6570\u8c03\u7528\u770b\u8d77\u6765 \u201c\u5f88\u6d6a\u8d39\u201d\uff1a\u8fde\u7eed\u7684\u8df3\u8f6c</li> <li>\u4e3a\u4ec0\u4e48\u4e0d\u5728\u52a0\u8f7d\u65f6\u6267\u884c\u9759\u6001\u94fe\u63a5\uff1f</li> <li>\u628a\u6307\u4ee4\u4e2d\u7684\u7acb\u5373\u6570\u66ff\u6362\u6210\u8df3\u8f6c\u5730\u5740\uff0c\u8fd9\u6837\u5c31\u907f\u514d\u4e86\u67e5\u8868\uff1f</li> <li>\u521d\u59cb\u5316\u5f00\u9500 VS \u67e5\u8868\u7684\u5f00\u9500</li> <li>\u52a8\u6001\u94fe\u63a5\uff1a\u590d\u7528\u8282\u7701\u7a7a\u95f4\uff0c\u65e0\u8bba\u662f\u78c1\u76d8\u7a7a\u95f4\u548c\u5185\u5b58\u7a7a\u95f4\uff08\u5171\u4eab\u52a8\u6001\u5e93\u7684\u4ee3\u7801\u6bb5\uff09\uff0c\u51cf\u5c11\u7269\u7406\u9875\u6362\u5165\u6362\u51fa\u3001\u589e\u52a0\u7f13\u5b58\u547d\u4e2d\u7387<ul> <li>\u5185\u6838\u4e2d\u4f1a\u4e3a\u6bcf\u4e2a\u6587\u4ef6\u8282\u70b9\u7ef4\u6301\u4e00\u4e2aradix\u6811\uff08Page Cache\uff09\uff0c\u8bb0\u5f55\u4e86\u4e3a\u52a0\u8f7d\u8be5\u6587\u4ef6\u5df2\u7ecf\u5206\u914d\u7684\u7269\u7406\u5185\u5b58\u9875\u6846</li> </ul> </li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#_14","title":"\u4ee3\u7801\u89e3\u51b3\u4e86\uff0c\u6570\u636e\u5462\uff1f","text":"<p>\u5982\u679c\u6211\u81ea\u5df1\u7684\u5171\u4eab\u5e93\u8981\u4f7f\u7528\u6570\u636e\uff1f</p> <pre><code>extern FILE *stdout;\nextern char *__lib_private;\n</code></pre> <ul> <li>\u5bf9\u4e8e stdout\uff0c\u65e0\u8bba\u591a\u5c11\u5e93\uff0c\u90fd\u53ea\u6709\u4e00\u4e2a\u526f\u672c\uff0c\u5fc5\u987b\u67e5\u8868</li> <li> <p><code>stdout</code>\u8fd9\u4e2a\u53d8\u91cf\u662f\u653e\u5728 libc.so \u4e2d\uff0c\u8fd8\u662fa.out\uff1f</p> </li> <li> <p>\u5bf9\u4e8e buf\uff0c\u53ef\u4ee5\u76f4\u63a5\u7ffb\u8bd1\u6210 PC \u76f8\u5bf9\u5bfb\u5740</p> </li> </ul> <p>\u8fd9\u4e2a\u95ee\u9898 GPT-4 \u7b54\u9519\u4e86</p> <ul> <li><code>-fPIC</code> \u9ed8\u8ba4\u4f1a\u4e3a\u6240\u6709 extern \u6570\u636e\u589e\u52a0\u4e00\u5c42\u95f4\u63a5\u8bbf\u95ee</li> <li>\u6b64\u65f6\u5171\u4eab\u5e93\u4e2d\u53ea\u6709\u5b83\u7684\u5730\u5740\uff0c\u9700\u8981\u91cd\u5b9a\u4f4d</li> <li><code>__attribute__((visibility(\"hidden\")))</code>\u63a7\u5236\u7b26\u53f7\uff08\u5982\u51fd\u6570\u6216\u53d8\u91cf\uff09\u7684\u94fe\u63a5\u53ef\u89c1\u6027</li> <li>\u4e0d\u4f1a\u5728\u5171\u4eab\u5e93\u7684\u7b26\u53f7\u8868\u4e2d\u5bfc\u51fa\uff0c\u5176\u4ed6\u94fe\u63a5\u5230\u8be5\u5e93\u7684\u4ee3\u7801\u4e0d\u80fd\u76f4\u63a5\u8bbf\u95ee\u8be5\u7b26\u53f7</li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#ld_preload","title":"LD_PRELOAD","text":""},{"location":"courses/os_lab/21-22-executable_files_loading.html#libc","title":"\u94fe\u63a5 \u201c\u4fee\u6539\u201d \u8fc7\u7684 libc","text":"<ul> <li>\u4e0d\u7528\u50cf\u4fee\u6539\u5668\u90a3\u6837 \u201c\u5165\u4fb5\u201d \u5730\u5740\u7a7a\u95f4\u4e86</li> <li>\u7a0b\u5e8f\u4f1a\u4e3b\u52a8\u628a\u63a7\u5236\u6d41\u4ea4\u7ed9\u6211\u4eec</li> </ul> <p><code>LD_PRELOAD</code>: \u5728\u52a0\u8f7d\u4e4b\u524d preload</p> <ul> <li>\u62e6\u622a\u7a0b\u5e8f\u5bf9\u5e93\u51fd\u6570\u7684\u8c03\u7528\uff0c\u5982\u8c03\u8bd5\u548c\u5185\u5b58\u68c0\u6d4b\u3001\u6027\u80fd\u5206\u6790\u3001\u517c\u5bb9\u6027\u4fee\u590d\u7b49\uff1b</li> </ul> <p><code>How can I hook calls to malloc and free using LD_PRELOAD?</code></p> <ul> <li>\u5229\u7528\u52a8\u6001\u94fe\u63a5\u7279\u6027\uff1a\u7b26\u53f7\u5148\u5230\u5148\u5360\u5751</li> <li>\u5148\u52a0\u8f7d\u4e00\u4e2a\u81ea\u5df1\u7684\u5e93\uff0c\u5360\u636e\u7b26\u53f7</li> <li>\u901a\u8fc7<code>dlsym</code>\u51fd\u6570\u6765\u83b7\u53d6\u539f\u59cb<code>malloc</code>\u548c<code>free</code>\u7684\u5730\u5740</li> </ul>"},{"location":"courses/os_lab/21-22-executable_files_loading.html#hooking","title":"\u5176\u4ed6\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684 Hooking","text":"<p>Open Question: \u5982\u4f55\u53cd\u6e38\u620f\u5916\u6302\uff1f</p> <p><code>Windows DLL Injection</code>\uff1a</p> <ul> <li> <p><code>DLL: Dynamic Link Library</code></p> </li> <li> <p>\u7406\u8bba\u6548\u679c\u4e0e <code>LD_PRELOAD</code> \u7c7b\u4f3c</p> </li> </ul> <p>Android</p> <ul> <li>LSPosed (Xposed \u540e\u7ee7\u9879\u76ee)</li> <li>Android App \u662f\u4e00\u4e2a Java \u7a0b\u5e8f</li> <li>\u90fd\u662f Zygote \u7684\u540e\u4ee3 </li> </ul>"},{"location":"courses/os_lab/23_application_of_state_machine.html","title":"\u72b6\u6001\u673a\u6a21\u578b\u7684\u5e94\u7528","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a\u56de\u987e\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u8c61\u3001API \u4e0a\u662f\u5982\u4f55\u6784\u5efa\u5e94\u7528\u7a0b\u5e8f\u4e16\u754c\u7684\uff1a</p> <ul> <li>\u64cd\u4f5c\u7cfb\u7edf\u548c\u5e94\u7528\u7a0b\u5e8f\u7684\u72b6\u6001\u673a\u6a21\u578b</li> <li>\u72b6\u6001\u673a\u6a21\u578b\u7684\u5e94\u7528</li> </ul>"},{"location":"courses/os_lab/23_application_of_state_machine.html#everything-is-a-state-machine","title":"Everything is a State Machine","text":""},{"location":"courses/os_lab/23_application_of_state_machine.html#_2","title":"\u4e00\u5207\u7686\u4e3a\u72b6\u6001\u673a","text":"<p>\u5728\u8bfe\u7a0b\u4e2d\u72b6\u6001\u673a\u6a21\u578b\u7684\u53d8\u5316</p> <ul> <li>minimal.S</li> <li>\u6307\u4ee4\u548c\u7cfb\u7edf\u8c03\u7528\u4e24\u79cd\u72b6\u6001\u8fc1\u79fb</li> <li>hanoi.c</li> <li>C \u7a0b\u5e8f\u4e5f\u662f\u72b6\u6001\u673a</li> <li>stack-prob.c</li> <li>\u5171\u4eab\u5185\u5b58\u3001\u72ec\u7acb\u5806\u6808\u7684\u72b6\u6001\u673a</li> <li>loader-static.c</li> <li>\u901a\u8fc7 mmap \u5b9e\u73b0\u5730\u5740\u7a7a\u95f4\u7684\u7ba1\u7406</li> </ul>"},{"location":"courses/os_lab/23_application_of_state_machine.html#api","title":"\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u8c61\u548c API","text":"<p>\u8bbf\u95ee\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u8c61</p> <ul> <li>\u6587\u4ef6\u63cf\u8ff0\u7b26\uff1a\u6307\u5411\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u8c61\u7684 \u201c\u6307\u9488\u201d (handle)</li> <li>fork() \u65f6\u4f1a\u7ee7\u627f</li> </ul> <p>\u72b6\u6001\u673a\u7ba1\u7406 API</p> <ul> <li>\u72b6\u6001\u673a\u521b\u5efa\u4e0e\u66f4\u65b0\uff1afork, execve, exit</li> <li>\u5730\u5740\u7a7a\u95f4\u7ba1\u7406\uff1ammap, sbrk</li> </ul> <p>\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u8c61\u7ba1\u7406 API</p> <ul> <li>open, read, write, lseek, pipe, ...</li> </ul>"},{"location":"courses/os_lab/23_application_of_state_machine.html#_3","title":"\u72b6\u6001\u673a\uff1a\u5efa\u6a21\u7406\u89e3\u6211\u4eec\u7684\u4e16\u754c","text":""},{"location":"courses/os_lab/23_application_of_state_machine.html#conways-game-of-life","title":"Conway's Game of Life","text":"<p>Game of life (Cellular automata)</p> <ul> <li>\u628a\u4e16\u754c\u60f3\u8c61\u6210\u662f\u4e00\u4e2a\u72b6\u6001\u673a</li> <li>\u4e00\u4e2a\u7a0b\u5e8f\u5982\u4f55\u611f\u77e5\u81ea\u5df1\u662f\u5728\u771f\u673a\u8fd8\u662f\u865a\u62df\u673a\u6267\u884c\uff1f</li> <li>\u5982\u4f55\u7406\u89e3\u56db\u7ef4\u7a7a\u95f4 (\ud835\udc65,\ud835\udc66,\ud835\udc67,\ud835\udc62)</li> </ul>"},{"location":"courses/os_lab/23_application_of_state_machine.html#_4","title":"\u66f4\u4e25\u8083\uff08\u7406\u8bba\uff09\u7684\u63a2\u8ba8","text":"<p>\u5728\u72b6\u6001\u673a\u6a21\u578b\u4e0a\u4e25\u683c\u5b9a\u4e49\u5f88\u591a\u6982\u5ff5\uff1a\u9884\u6d4b\u672a\u6765\u3001\u65f6\u95f4\u65c5\u884c\u2026\u2026</p> <ul> <li>\u6210\u4e3a\u4f60\u7406\u89e3\u7269\u7406 (\u548c\u8ba1\u7b97\u673a) \u4e16\u754c\u7684\u53c2\u8003</li> </ul> <p>Cellular automata \u4e0d\u652f\u6301 \u201c\u65f6\u95f4\u65c5\u884c\u201d</p> <ul> <li>\u600e\u4e48\u6dfb\u52a0\u4e00\u4e2a\u516c\u7406\u4f7f\u5b83\u53ef\u4ee5\u652f\u6301\uff1f</li> <li>\u5e73\u884c\u5b87\u5b99</li> <li>\u5982\u679c\u4e16\u754c\u7ebf\u9700\u8981\u5408\u5e76\uff1f\u53ef\u4ee5\u6536\u655b\u4e8e\u67d0\u4e2a\u5206\u5e03</li> </ul> <p>Cellular automata \u4e0d\u652f\u6301 \u201c\u9884\u6d4b\u5916\u6765\u201d</p> <ul> <li>\u80fd\u5426\u6dfb\u52a0\u4e00\u4e2a syscall \u4f7f\u5b83\u652f\u6301\uff1f</li> <li>Why philosophers should care about computational complexity, Ch. 10</li> </ul>"},{"location":"courses/os_lab/23_application_of_state_machine.html#_5","title":"\ufe0f\ud83c\udf36\ufe0f \u72b6\u6001\u673a\uff1a\u5efa\u6a21\u7406\u89e3\u7a0b\u5e8f\u7684\u4e16\u754c","text":""},{"location":"courses/os_lab/23_application_of_state_machine.html#trace","title":"Trace \u548c\u8c03\u8bd5\u5668","text":"<p>\u7a0b\u5e8f\u6267\u884c = \u72b6\u6001\u673a\u6267\u884c\uff1a\u201chack\u201d \u8fdb\u8fd9\u4e2a\u72b6\u6001\u673a</p> <ul> <li>\u89c2\u5bdf\u72b6\u6001\u673a\u7684\u6267\u884c\uff1astrace/gdb</li> <li>\u751a\u81f3\u8bb0\u5f55\u548c\u6539\u53d8\u72b6\u6001\u673a\u7684\u6267\u884c</li> </ul> <p>Time-Travel Debugging &amp; Record-replay</p> <ul> <li>\u5982\u4f55\u9000\u56de\u5230 \\(s_0 \\rightarrow s_1 \\rightarrow s_2 \\rightarrow ...\\)\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\u72b6\u6001\uff1f</li> <li>AskGPT: How is time-travel debugging implemented in gdb?</li> <li>\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u5b8c\u6574\u8bb0\u5f55\u7a0b\u5e8f\u7684\u6267\u884c</li> <li>record_and_replay, QEMU, ...</li> </ul>"},{"location":"courses/os_lab/23_application_of_state_machine.html#profiler","title":"\u6027\u80fd\u4f18\u5316\u548c Profiler","text":"<p>Premature optimization is the root of all evil. (D. E. Knuth)</p> <p>\u90a3\u5230\u5e95\u600e\u4e48\u6837\u624d\u7b97 mature \u5462\uff1f</p> <ul> <li>\u72b6\u6001\u673a\u7684\u6267\u884c\u9700\u8981\u65f6\u95f4\uff1b\u5bf9\u8c61\u9700\u8981\u5360\u7528\u7a7a\u95f4</li> <li>\u9700\u8981\u7406\u89e3\u597d \u201c\u65f6\u95f4\u82b1\u5728\u54ea\u91cc\u201d\u3001\u201c\u4ec0\u4e48\u5bf9\u8c61\u5360\u7528\u4e86\u7a7a\u95f4\u201d</li> <li>\u672c\u8d28\u7684\u56de\u7b54\uff1a\u201c\u4e3a\u4e86\u505a\u67d0\u4ef6\u4e8b\u5230\u5e95\u82b1\u53bb\u4e86\u591a\u5c11\u8d44\u6e90\u201d</li> <li>\u7b80\u5316\u7684\u56de\u7b54\uff1a\u201c\u4e00\u6bb5\u65f6\u95f4\u5185\u8d44\u6e90\u7684\u6d88\u8017\u60c5\u51b5\u201d</li> </ul> <p></p> <p>\u771f\u5b9e\u6267\u884c\u7684\u6027\u80fd\u6458\u8981\uff01</p> <ul> <li> <p>\u601d\u8def\uff1a\u9694\u4e00\u6bb5\u65f6\u95f4 \u201c\u6682\u505c\u201d \u7a0b\u5e8f\u3001\u89c2\u5bdf\u72b6\u6001\u673a\u7684\u6267\u884c\uff1a\u4e2d\u65ad\u5c31\u53ef\u4ee5\u505a\u5230</p> </li> <li> <p>\u5c06\u72b6\u6001 s\u2192s\u2032 \u201c\u8bb0\u8d26\u201d</p> <ul> <li>\u6267\u884c\u7684\u8bed\u53e5\uff0c\u51fd\u6570\u8c03\u7528\u6808\uff0c\u670d\u52a1\u7684\u8bf7\u6c42</li> </ul> </li> <li> <p>\u5f97\u5230\u7edf\u8ba1\u610f\u4e49\u7684\u6027\u80fd\u6458\u8981</p> </li> </ul> <p>\u4f8b\u5b50\uff1aLinux Kernel perf (\u652f\u6301\u786c\u4ef6 PMU)</p> <ul> <li><code>perf list, perf stat (-e), perf record, perf report</code></li> </ul> <p>\u4e8c\u516b\u5b9a\u5f8b\uff1a80% \u7684\u65f6\u95f4\u6d88\u8017\u5728\u975e\u5e38\u96c6\u4e2d\u7684\u51e0\u5904\u4ee3\u7801</p> <ul> <li>L1 (pmm): \u5c0f\u5185\u5b58\u5206\u914d\u65f6\u7684 lock contention</li> <li>profiler \u76f4\u63a5\u5e2e\u4f60\u89e3\u51b3\u95ee\u9898</li> </ul> <p>\u5de5\u4e1a\u754c\u9047\u5230\u7684\u5927\u90e8\u5206\u60c5\u51b5</p> <ul> <li>\u6728\u6876\u6548\u5e94\uff1a\u6bcf\u4e2a\u90e8\u5206\u90fd\u5df2\u7ecf tune \u5230\u5c40\u90e8\u6700\u4f18\u4e86</li> <li>\u5269\u4e0b\u7684\u90e8\u5206\u8981\u4e48 profiler \u4fe1\u606f\u4e0d\u5b8c\u6574\uff0c\u8981\u4e48\u5c31\u4e0d\u597d\u89e3\u51b3</li> <li>\u706b\u7130\u56fe\uff1aThe flame graph (CACM'16)</li> </ul>"},{"location":"courses/os_lab/23_application_of_state_machine.html#model-checker-verifier","title":"Model Checker \u548c Verifier","text":"<p>\u4e00\u4e9b\u771f\u6b63\u7684 model checkers</p> <ul> <li>TLA+ by Leslie Lamport;</li> <li>Java PathFinder (JFP) \u548c SPIN</li> <li>\u5982\u679c\u4f60\u5e0c\u671b\u76f4\u63a5\u9a8c\u8bc1\u7a0b\u5e8f\uff1f</li> </ul> <p>\u4efb\u4f55 \u201cnon-deterministic\u201d \u7684\u72b6\u6001\u673a\u90fd\u53ef\u4ee5\u68c0\u67e5</p> <pre><code>u32 x = rdrand(), y = rdrand();\nif (x &gt; y)\n  if (x * x + y * y == 65)\n    bug();  // \u6309\u503c\u5206\u72b6\u6001\u56fe\u5219\u5206\u652f\u7206\u70b8\uff0c\u5982\u4f55\u6709\u6548\u5730\u68c0\u9a8c\uff1f\u6309\u6761\u4ef6\n</code></pre> <ul> <li>KLEE: Unassisted and automatic generation of high-coverage tests for complex systems programs (OSDI'08, Best Paper \ud83c\udfc5)</li> </ul>"},{"location":"courses/os_lab/23_application_of_state_machine.html#_6","title":"\u8bfe\u540e\u4e60\u9898/\u7f16\u7a0b\u4f5c\u4e1a","text":""},{"location":"courses/os_lab/23_application_of_state_machine.html#1","title":"1. \u9605\u8bfb\u6750\u6599","text":"<p>\u6559\u79d1\u4e66 Operating Systems: Three Easy Pieces</p> <ul> <li>\u7b2c 6 \u7ae0 - Direct Execution</li> <li>\u7b2c 7 \u7ae0 - CPU Scheduling</li> <li>\u7b2c 8 \u7ae0 - Multi-level Feedback</li> <li>\u7b2c 9 \u7ae0 - Lottery Scheduling</li> <li>\u7b2c 10 \u7ae0 - Multi-CPU Scheduling</li> </ul>"},{"location":"courses/os_lab/24_impletation_of_os_process.html","title":"\u64cd\u4f5c\u7cfb\u7edf\u8fdb\u7a0b\u7684\u5b9e\u73b0","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a</p> <ul> <li>\u8fdb\u7a0b\u7684\u5b9e\u73b0</li> <li>\u5904\u7406\u5668\u8c03\u5ea6</li> </ul>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#_2","title":"\u8fdb\u7a0b\u7684\u5b9e\u73b0","text":""},{"location":"courses/os_lab/24_impletation_of_os_process.html#thread-oslab2","title":"Thread-OS/Lab2","text":"<p>\u5b9e\u73b0\u4e86\u5728\u591a\u4e2a\u7ebf\u7a0b\u4e4b\u95f4\u5207\u6362</p> <pre><code>Context *on_interrupt(Event ev, Context *ctx) {\n  if (!current) {\n    current = &amp;tasks[0];  // First trap\n  } else {\n    current-&gt;context = ctx;\n    current = current-&gt;next;\n  }\n  return current-&gt;context;\n}\n</code></pre> <p>\u5185\u6838\u7ebf\u7a0b v.s. \u8fdb\u7a0b\uff0c\u8fd8\u5dee\u4e86\u4ec0\u4e48\uff1f-- \u4e00\u4e2aVR \u773c\u955c</p>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#_3","title":"\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4","text":"<p>pmap: \u8fdb\u7a0b\u62e5\u6709 \\([0,2^{64}]\\) \u7684\u5730\u5740\u7a7a\u95f4</p> <ul> <li>\u865a\u62df\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u7269\u7406\u5185\u5b58\u4e5f\u5c31\u662f\u4ece 0 \u5f00\u59cb\u7684\u51e0\u4e2a GB</li> </ul> <p>\u5730\u5740\u7ffb\u8bd1\uff1a</p> <ul> <li>\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e2d\u7684\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\ud835\udc53(\ud835\udc65)f(x)</li> <li>\u628a\u865a\u62df\u5185\u5b58\u5730\u5740\u7ffb\u8bd1\u6210\u7269\u7406\u5185\u5b58\u5730\u5740</li> <li> <p>\u7531\u5bc4\u5b58\u5668 (\u4f8b\u5982 x86 \u7684 CR3) \u548c\u5185\u5b58\u5171\u540c\u63cf\u8ff0</p> </li> <li> <p>\u5730\u5740\u7ffb\u8bd1 (VR \u773c\u955c) \u662f\u5f3a\u5236\u7684</p> </li> <li>\u7528\u6237\u7a0b\u5e8f mov CR3 \u5c06\u5bfc\u81f4 #GP \u5f02\u5e38</li> <li>\u8d8a\u6743\u8bbf\u95ee/\u975e\u6cd5\u8bbf\u95ee\u5c06\u5bfc\u81f4 #PF \u5f02\u5e38 (Page Fault)</li> </ul>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#abstractmachine","title":"AbstractMachine \u5bf9\u5730\u5740\u7a7a\u95f4\u7684\u62bd\u8c61","text":"<p><code>AddrSpace</code> \u5c31\u662f\u4e00\u4e2a\u6570\u636e\u7ed3\u6784 f</p> <ul> <li>\u652f\u6301\u5bf9\u6570\u636e\u7ed3\u6784\u7684\u52a8\u6001\u8c03\u6574 (map)</li> <li>\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a \u201c\u6234 VR \u773c\u955c\u201d \u7684 kcontext (\u7ebf\u7a0b) --&gt; \u5c31\u662f\u8fdb\u7a0b\uff01</li> </ul> <pre><code>bool     vme_init (void *(*alloc)(int), void (*free)(void *));\nvoid     protect  (AddrSpace *as);\nvoid     unprotect(AddrSpace *as);\nvoid     map      (AddrSpace *as, void *va, void *pa, int prot);\nContext *ucontext (AddrSpace *as, Area kstk, void *entry);\n</code></pre>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#_4","title":"\u865a\u5047\u7684\u5730\u5740\u7a7a\u95f4","text":"<p>\u5ef6\u8fdf\u6620\u5c04\uff1a\u7c7b\u4f3cVR \u773c\u955c\uff0c\u773c\u775b\u8fd8\u6ca1\u770b\u5230\u7684\u5730\u65b9\u53ef\u4ee5\u5148\u4e0d\u663e\u793a</p> <ul> <li>\u64cd\u4f5c\u7cfb\u7edf\u53ea\u8981\u7528\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u8bb0\u5f55\u54ea\u6bb5\u5185\u5b58\u662f\u4ec0\u4e48</li> <li>\u8fdb\u7a0b\u53ef\u4ee5\u4f7f\u7528\u8d85\u8fc7\u7269\u7406\u5185\u5b58\u7684\u865a\u62df\u5185\u5b58 (swap)</li> <li>Page Fault \u7684\u65f6\u5019\u518d\u5206\u914d</li> <li>\u6587\u4ef6 \u2192 \u6620\u5c04\u6587\u4ef6\u5185\u5bb9\u540e\u8fd4\u56de</li> <li>\u533f\u540d\u6570\u636e \u2192 \u5206\u914d\u7269\u7406\u9875\u9762\u540e\u8fd4\u56de</li> <li>\u975e\u6cd5\u8bbf\u95ee \u2192 SIGSEGV</li> <li>\u7528\u4ec0\u4e48\u6837\u7684\u6570\u636e\u7ed3\u6784\u5b9e\u73b0\uff1f--&gt; \u7ea2\u9ed1\u6811</li> </ul> <p>\u4ee3\u7801\u5171\u4eab\uff1a\u6bd4 VR \u773c\u955c\u9ad8\u7ea7\u7684\u529f\u80fd\uff1a\u591a\u4e2a\u4f4d\u7f6e\u5171\u4eab\u540c\u4e00\u5757\u5c4f\u5e55</p> <ul> <li>\u5389\u5bb3\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u540c\u4e00\u4efd\u4ee3\u7801\u4ec5\u6709\u4e00\u4e2a\u526f\u672c</li> <li>\u5982\u4f55\u95f4\u63a5\u8bc1\u5b9e\u8fd9\u4e00\u70b9\uff1f<ul> <li>\u901a\u8fc7<code>.fill</code>\u6c47\u7f16\u586b\u5145\u4ee3\u7801\uff0c\u751f\u6210128M\u7684 a.out\uff0c\u8fd0\u884c1000\u4e2a a.out\uff0c\u5185\u5b58\u6ca1\u6709\u5361\u6b7b\uff1b</li> </ul> </li> <li>\u5982\u4f55\u76f4\u63a5\u786e\u8ba4\u8fd9\u4e00\u70b9\uff1f<ul> <li>AskGPT: How to print the corresponding physical address of a given virtual address in Linux user space in C?</li> </ul> </li> </ul> <p>\u5199\u65f6\u590d\u5236\uff1a\u9664\u4e86\u4e07\u4e0d\u5f97\u5df2\uff0c\u80fd\u4e0d\u590d\u5236\u5c31\u4e0d\u590d\u5236</p> <ul> <li>\u5373\u4fbf\u4f7f\u7528\u4e86\u5f88\u591a\u5185\u5b58\uff0cfork() \u4f9d\u7136\u53ef\u4ee5\u5728\u77ac\u95f4\u5b8c\u6210</li> <li>fork-execve \u975e\u5e38\u5e38\u89c1\uff0c\u521a\u590d\u5236\u5b8c 1GB \u5185\u5b58\uff0c\u5c31\u9500\u6bc1\u4e86</li> </ul>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#_5","title":"\u5904\u7406\u5668\u8c03\u5ea6\u539f\u7406","text":""},{"location":"courses/os_lab/24_impletation_of_os_process.html#_6","title":"\u95ee\u9898","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u5177\u6709\u5728\u4e2d\u65ad\u540e\u9009\u62e9\u4efb\u4f55\u8fdb\u7a0b\u6267\u884c\u7684\u6743\u5229</p> <ul> <li>\u90a3\u5e94\u8be5\u9009\u54ea\u4e2a\u6bd4\u8f83\u597d\u2026\u2026\u5462\uff1f1950-1960s \u64cd\u4f5c\u7cfb\u7edf\u7814\u7a76\u7684\u91cd\u8981\u8bdd\u9898</li> </ul> <pre><code>Context *on_interrupt(Event ev, Context *ctx) {\n  if (!current) {\n    current = &amp;tasks[0];  // First trap\n  } else {\n    current-&gt;context = ctx;\n    current = current-&gt;next;  // Round-robin \u8f6e\u8f6c\u8c03\u5ea6\n  }\n  return current-&gt;context;\n}\n</code></pre> <p>\u8bbe\u8ba1\u7a7a\u95f4</p> <ul> <li>\u5efa\u6a21 (\u7406\u89e3\u548c\u603b\u7ed3 \u201c\u8fc7\u53bb\u53d1\u751f\u4e86\u4ec0\u4e48\u201d)</li> <li>\u9884\u6d4b (\u8bd5\u56fe\u9884\u77e5\u672a\u6765\u53ef\u80fd\u53d1\u751f\u4ec0\u4e48)</li> <li>\u51b3\u7b56 (\u5728\u9884\u6d4b\u4e0b\u4f5c\u51fa\u5bf9\u7cfb\u7edf\u6700\u6709\u5229\u7684\u9009\u62e9)</li> </ul>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#_7","title":"\u5141\u8bb8\u7528\u6237\u5b9a\u5236\u5904\u7406\u5668\u8c03\u5ea6","text":"<p>UNIX niceness</p> <ul> <li>-20 .. 19 \u7684\u6574\u6570\uff0c\u8d8a nice \u8d8a\u8ba9\u522b\u4eba\u5f97\u5230 CPU</li> <li>-20: \u6781\u574f; most favorable to the process</li> <li>19: \u6781\u597d; least favorable to the process</li> <li>\u57fa\u4e8e\u4f18\u5148\u7ea7\u7684\u8c03\u5ea6\u7b56\u7565</li> <li>RTOS: \u574f\u4eba\u8eba\u4e0b\u597d\u4eba\u624d\u80fd\u4e0a</li> </ul> <p>Linux: 10 nice\u7684\u5dee\u522b \u2248 CPU \u8d44\u6e90\u83b7\u5f97\u7387\u76f8\u5dee 10 \u500d</p> <ul> <li>\u4e0d\u59a8\u8bd5\u4e00\u8bd5: nice/renice\uff0c\u67e5\u770b CPU \u7684\u5229\u7528\u7387</li> </ul> <pre><code>taskset -c 0 nice -n 19 yes &gt; /dev/null &amp;\ntaskset -c 0 nice -n  9 yes &gt; /dev/null &amp;\n</code></pre>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#round-robin","title":"Round-Robin \u7684\u7f3a\u9677","text":"<p>\u7cfb\u7edf\u91cc\u6709\u4e24\u4e2a\u8fdb\u7a0b</p> <ul> <li>\u4ea4\u4e92\u5f0f\u7684 Vim\uff0c\u5355\u7ebf\u7a0b</li> <li>\u7eaf\u7cb9\u8ba1\u7b97\u7684 mandelbrot.c, 32 \u4e2a\u7ebf\u7a0b</li> </ul> <p>Round-Robin</p> <ul> <li>Vim \u82b1 0.1ms \u5904\u7406\u5b8c\u8f93\u5165\u5c31\u53c8\u7b49\u8f93\u5165\u4e86</li> <li>\u4e3b\u52a8\u8ba9\u51fa CPU</li> <li>Mandelbrot \u4f7f Vim \u5728\u6709\u8f93\u5165\u53ef\u4ee5\u5904\u7406\u7684\u65f6\u5019\u88ab\u5ef6\u8fdf</li> <li>\u5fc5\u987b\u7b49\u5f53\u524d\u7684 Mandelbrot \u8f6c\u5b8c\u4e00\u5708</li> <li>\u6570\u767e ms \u7684\u5ef6\u8fdf\u5c31\u4f1a\u4f7f\u4eba\u611f\u5230\u660e\u663e\u5361\u987f</li> </ul>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#mlfq","title":"\u7b56\u7565\uff1a\u52a8\u6001\u4f18\u5148\u7ea7 (MLFQ)","text":"<p>\u4e0d\u4f1a\u8bbe\u7f6e\u4f18\u5148\u7ea7\uff1f\u8ba9\u7cfb\u7edf\u81ea\u52a8\u8bbe\u5b9a\uff01</p> <ul> <li>\u8bbe\u7f6e\u82e5\u5e72\u4e2a Round-Robin \u961f\u5217</li> <li>\u6bcf\u4e2a\u961f\u5217\u5bf9\u5e94\u4e00\u4e2a\u4f18\u5148\u7ea7</li> <li>\u52a8\u6001\u4f18\u5148\u7ea7\u8c03\u6574\u7b56\u7565\uff1a\u4f18\u5148\u8c03\u5ea6\u9ad8\u4f18\u5148\u7ea7\u961f\u5217</li> <li>\u7528\u5b8c\u65f6\u95f4\u7247 \u2192 \u574f\u4eba</li> <li>\u8ba9\u51fa CPU I/O \u2192 \u597d\u4eba</li> </ul>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#complete-fair-scheduling-cfs","title":"\u7b56\u7565\uff1aComplete Fair Scheduling (CFS)","text":"<p>\u8bd5\u56fe\u53bb\u6a21\u62df\u4e00\u4e2a \u201cIdeal Multi-Tasking CPU\u201d:</p> <ul> <li>\u201cIdeal multi-tasking CPU\u201d is a (non-existent :-)) CPU that has 100% physical power and which can run each task at precise equal speed, in parallel, each at . For example: if there are 2 tasks running, then it runs each at 50% physical power \u2014 i.e., actually in parallel.</li> </ul> <p>\u201c\u8ba9\u7cfb\u7edf\u91cc\u7684\u6240\u6709\u8fdb\u7a0b\u5c3d\u53ef\u80fd\u516c\u5e73\u5730\u5171\u4eab\u5904\u7406\u5668\u201d</p> <ul> <li>\u4e3a\u6bcf\u4e2a\u8fdb\u7a0b\u8bb0\u5f55\u7cbe\u786e\u7684\u8fd0\u884c\u65f6\u95f4</li> <li>\u4e2d\u65ad/\u5f02\u5e38\u53d1\u751f\u540e\uff0c\u5207\u6362\u5230\u8fd0\u884c\u65f6\u95f4\u6700\u5c11\u7684\u8fdb\u7a0b\u6267\u884c</li> <li>\u4e0b\u6b21\u4e2d\u65ad/\u5f02\u5e38\u540e\uff0c\u5f53\u524d\u8fdb\u7a0b\u7684\u53ef\u80fd\u5c31\u4e0d\u662f\u6700\u5c0f\u7684\u4e86</li> </ul>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#cfs","title":"CFS: \u5b9e\u73b0\u4f18\u5148\u7ea7","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u5177\u6709\u5bf9\u7269\u7406\u65f6\u949f\u7684 \u201c\u7edd\u5bf9\u63a7\u5236\u201d</p> <ul> <li>\u6bcf\u4eba\u6267\u884c 1ms\uff0c\u4f46\u597d\u4eba\u7684\u949f\u5feb\u4e00\u4e9b\uff0c\u574f\u4eba\u7684\u949f\u6162\u4e00\u4e9b</li> <li><code>vruntime (virtual runtime)</code></li> <li><code>vrt[i] / vrt[j]</code> \u7684\u589e\u52a0\u6bd4\u4f8b = <code>wt[j] / wt[i]</code></li> </ul> <pre><code>const int sched_prio_to_weight[40] = {\n  /* -20 */ 88761, 71755, 56483, 46273, 36291,\n  /* -15 */ 29154, 23254, 18705, 14949, 11916,\n  /* -10 */  9548,  7620,  6100,  4904,  3906,\n  /*  -5 */  3121,  2501,  1991,  1586,  1277,\n  /*   0 */  1024,   820,   655,   526,   423,\n  /*   5 */   335,   272,   215,   172,   137,\n  /*  10 */   110,    87,    70,    56,    45,\n  /*  15 */    36,    29,    23,    18,    15,\n};\n</code></pre>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#_8","title":"\ud83c\udf36\ufe0f\u771f\u5b9e\u7684\u5904\u7406\u5668\u8c03\u5ea6","text":""},{"location":"courses/os_lab/24_impletation_of_os_process.html#_9","title":"\u4f18\u5148\u7ea7\u5e26\u6765\u7684\u95ee\u9898","text":"<p>\u4f4e\u4f18\u5148\u7ea7\u7684\u4ee3\u7801\u83b7\u53d6\u5230\u9501\uff0c\u4f46\u662f\u88ab\u8d76\u4e0b\u5904\u7406\u5668\uff1b\u9ad8\u4f18\u5148\u7ea7\u65e0\u6cd5\u83b7\u53d6\u9501\uff0c\u65e0\u6cd5\u6267\u884c\uff1b</p> <p>\u4e2d\u4f18\u5148\u7ea7\u7684\u4ee3\u7801\u4e00\u76f4\u8fd0\u884c\uff1b</p> <pre><code>void jyy() { // \u6700\u4f4e\u4f18\u5148\u7ea7\n  mutex_lock(&amp;wc_lock);\n  // \u5148\u5230\u5148\u5f97\n}\n\nvoid xi_zhu_ren() { // \u4e2d\u4f18\u5148\u7ea7\n  while (1) ;\n}\n\nvoid xiao_zhang() { // \u9ad8\u4f18\u5148\u7ea7\n  sleep(1);\n  mutex_lock(&amp;wc_lock);\n  ...\n}\n</code></pre>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#_10","title":"\u89e3\u51b3\u4f18\u5148\u7ea7\u53cd\u8f6c\u95ee\u9898","text":"<p>Linux: \u89e3\u51b3\u4e0d\u4e86\uff0cCFS \u51d1\u5408\u7528\u5427\u3002</p> <p>\u5b9e\u65f6\u7cfb\u7edf\uff1a</p> <ul> <li>\u4f18\u5148\u7ea7\u7ee7\u627f (Priority Inheritance)/\u4f18\u5148\u7ea7\u63d0\u5347 (Priority Ceiling)</li> <li>\u6301\u6709 mutex \u7684\u7ebf\u7a0b/\u8fdb\u7a0b\u4f1a\u7ee7\u627f block \u5728\u8be5 mutex \u4e0a\u8fdb\u7a0b\u7684\u6700\u9ad8\u4f18\u5148\u7ea7</li> <li>\u4f46\u4e5f\u4e0d\u662f\u4e07\u80fd\u7684 (\u4f8b\u5982\u6761\u4ef6\u53d8\u91cf\u5524\u9192)</li> <li>\u5728\u7cfb\u7edf\u4e2d\u52a8\u6001\u7ef4\u62a4\u8d44\u6e90\u4f9d\u8d56\u5173\u7cfb</li> <li>\u4f18\u5148\u7ea7\u7ee7\u627f\u662f\u5b83\u7684\u7279\u4f8b</li> <li>\u4f3c\u4e4e\u66f4\u56f0\u96be\u4e86\u2026\u2026</li> <li>\u907f\u514d\u9ad8/\u4f4e\u4f18\u5148\u7ea7\u7684\u4efb\u52a1\u4e89\u62a2\u8d44\u6e90</li> <li>\u5bf9\u6f5c\u5728\u7684\u4f18\u5148\u7ea7\u53cd\u8f6c\u8fdb\u884c\u9884\u8b66 (lockdep)</li> <li>TX-based: \u51b2\u7a81\u7684 TX \u53d1\u751f\u65f6\uff0c\u603b\u662f\u4f4e\u4f18\u5148\u7ea7\u7684 abort</li> </ul>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#_11","title":"\u591a\u5904\u7406\u5668\u8c03\u5ea6\uff1a\u88ab\u4f4e\u4f30\u7684\u590d\u6742\u6027","text":"<p>\u201cAnd you have to realize that there are not very many things that have aged as well as the scheduler. Which is just another proof that scheduling is easy.\u201d \u2014\u2014Linus Torvalds, 2001</p> <ul> <li>As a central part of resource management, the OS thread scheduler must maintain the following, simple, invariant:make sure that ready threads are scheduled on available cores ... this invariant is often broken in Linux. Cores may stay idle for seconds while ready threads are waiting in runqueues.</li> <li>The Linux scheduler: A decade of wasted cores. (EuroSys'16)\uff1a\u4f5c\u8005\u5728\u72c2\u9ed1 Linus \ud83d\ude02</li> </ul> <p>\u591a\u5904\u7406\u5668\u8c03\u5ea6\u7684\u56f0\u96be\u6240\u5728</p> <ul> <li>\u65e2\u4e0d\u80fd\u7b80\u5355\u5730 \u201c\u5206\u914d\u7ebf\u7a0b\u5230\u5904\u7406\u5668\u201d</li> <li> <p>\u7ebf\u7a0b\u9000\u51fa\uff0c\u77ac\u95f4\u5904\u7406\u5668\u5f00\u59cb\u56f4\u89c2</p> </li> <li> <p>\u4e5f\u4e0d\u80fd\u7b80\u5355\u5730 \u201c\u8c01\u7a7a\u4e22\u7ed9\u8c01\u201d</p> </li> <li> <p>\u5728\u5904\u7406\u5668\u4e4b\u95f4\u8fc1\u79fb\u4f1a\u5bfc\u81f4 cache/TLB \u5168\u90fd\u767d\u7ed9</p> </li> <li> <p>\u591a\u5904\u7406\u5668\u8c03\u5ea6\u7684\u4e24\u96be\u5883\u5730</p> </li> <li> <p>\u8fc1\u79fb\uff1f\u53ef\u80fd\u8fc7\u4e00\u4f1a\u513f\u8fd8\u5f97\u79fb\u56de\u6765</p> </li> <li> <p>\u4e0d\u8fc1\u79fb\uff1f\u9020\u6210\u5904\u7406\u5668\u7684\u6d6a\u8d39</p> </li> </ul>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#1","title":"\u5b9e\u9645\u60c5\u51b5 (1): \u591a\u7528\u6237\u3001\u591a\u4efb\u52a1","text":"<p>\u4e0d\u540c\u7684\u7528\u6237\u53ef\u4ee5\u521b\u5efa\u591a\u4e2a\u7ebf\u7a0b\uff0c\u5360\u7528\u5f88\u591a\u7684\u8d44\u6e90\u3002</p> <ul> <li>A \u8981\u8dd1\u4e00\u4e2a\u4efb\u52a1\uff0c\u8c03\u7528\u4e00\u4e2a\u5e93\uff0c\u53ea\u80fd\u5355\u7ebf\u7a0b\u8dd1</li> <li>B \u8dd1\u5e76\u884c\u7684\u4efb\u52a1\uff0c\u521b\u5efa 10,000 \u4e2a\u7ebf\u7a0b\u8dd1\uff08\u83b7\u5f97\u51e0\u4e4e100%\u7684CPU\uff09</li> </ul> <p>\u975e\u7279\u6743\u7528\u6237\u65e0\u6cd5\u63d0\u9ad8\u81ea\u5df1\u7684\u8fdb\u7a0b\u7684\u4f18\u5148\u7ea7\uff1a</p> <ul> <li>an unprivileged user can only increase the \"nice value\" (i.e., choose a lower priority) and such changes are irreversible</li> </ul> <p>Linux Namespaces Control Groups (cgroups) \u4f5c\u4e3a\u89e3\u51b3\u65b9\u6848\uff1aDocker \u7684\u57fa\u7840</p> <ul> <li>\u8f7b\u91cf\u7ea7\u865a\u62df\u5316\uff0c\u521b\u9020 \u201c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u64cd\u4f5c\u7cfb\u7edf\u201d</li> <li>Mount, pid, network, IPC, user, cgroup namespace, time</li> <li> <p>cgroup \u5141\u8bb8\u4ee5\u8fdb\u7a0b\u7ec4\u4e3a\u5355\u4f4d\u7ba1\u7406\u8d44\u6e90</p> </li> <li> <p>askGPT\uff1a\u5982\u4f55\u4f7f\u7528 crgoup \u9650\u5236\u7528\u6237\u7684CPU/Memory \u4f7f\u7528\uff1f</p> </li> </ul>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#2-biglittle","title":"\u5b9e\u9645\u60c5\u51b5 (2): Big.LITTLE/\u80fd\u8017","text":"<p>\u9a81\u9f99 888\uff1a\u5927\u5c0f\u6838</p> <ul> <li>1X Prime Cortex-X1 (2.84GHz)</li> <li>3X Performance Cortex-A78 (2.4GHz)</li> <li>4X Efficiency Cortex-A55 (1.8GHz)</li> </ul> <p>\u201cDark silicon\u201d \uff08\u6697\u7845\uff09\u65f6\u4ee3\u7684\u56f0\u5883</p> <ul> <li> <p>\u529f\u7387\u65e0\u6cd5\u652f\u6491\u6240\u6709\u7535\u8def\u540c\u65f6\u5de5\u4f5c\uff0c\u603b\u5f97\u6709\u4e00\u90e8\u5206\u662f\u505c\u4e0b\u7684</p> </li> <li> <p>Linux Kernel EAS (Energy Aware Scheduler)</p> </li> </ul> <p>\u8f6f\u4ef6\u53ef\u4ee5\u914d\u7f6e CPU \u7684\u5de5\u4f5c\u6a21\u5f0f</p> <ul> <li>\u5f00/\u5173/\u5de5\u4f5c\u9891\u7387 (\u9891\u7387\u8d8a\u4f4e\uff0c\u80fd\u6548\u8d8a\u597d)</li> <li>\u5982\u4f55\u5728\u7ed9\u5b9a\u529f\u7387\u4e0b\u5e73\u8861\u5ef6\u8fdf v.s. \u541e\u5410\u91cf\uff1f</li> </ul> <p></p>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#3-non-uniform-memory-access","title":"\u5b9e\u9645\u60c5\u51b5 (3): Non-Uniform Memory Access","text":"<p>\u901a\u8fc7 lscpu \u53ef\u4ee5\u67e5\u770b NUMA \u548c CPU \u7684\u5bf9\u5e94\u5173\u7cfb</p> <pre><code>NUMA:\n  NUMA node(s):          2\n  NUMA node0 CPU(s):     0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38\n  NUMA node1 CPU(s):     1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39\n</code></pre> <p>\u5171\u4eab\u5185\u5b58\u53ea\u662f\u5047\u8c61</p> <ul> <li>L1 Cache \u82b1\u4e86\u5de8\u5927\u7684\u4ee3\u4ef7\u624d\u8ba9\u4f60\u611f\u5230\u5185\u5b58\u662f\u5171\u4eab\u7684</li> <li>Producer/Consumer \u4f4d\u4e8e\u540c\u4e00\u4e2a/\u4e0d\u540c module \u6027\u80fd\u5dee\u8ddd\u53ef\u80fd\u5f88\u5927</li> </ul> <p></p> <p>\u57fa\u672c\u7684\u5047\u8bbe\u53ef\u80fd\u4e0d\u518d\u6210\u7acb\uff1acache \u5bfc\u81f4\u591a\u7ebf\u7a0b\u7684\u6027\u80fd\u4e0b\u964d</p> <ul> <li>\u4f8b\u5b50: more CPU time, more progress</li> </ul> <pre><code># \u8bfe\u5802\u5b9e\u9a8c\uff0c\u901a\u8fc7 lock \u6307\u4ee4\u5b9e\u73b0\u81ea\u589e\uff08\u4e24\u4e2a\u7ebf\u7a0b\uff09 \n$ time taskset -c 0   ./a.out\n$ time taskset -c 0,1 ./a.out\n</code></pre> <ul> <li>\u5206\u914d\u4e86 1/2 \u7684\u5904\u7406\u5668\u8d44\u6e90\uff0c\u53cd\u800c\u901f\u5ea6\u66f4\u5feb</li> </ul>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#4-cpu-hot-plug","title":"\u5b9e\u9645\u60c5\u51b5 (4): CPU Hot-plug","text":"<p>\u590d\u6742\u7684\u7cfb\u7edf\u65e0\u4eba\u53ef\u4ee5\u638c\u63a7</p> <ul> <li>The battle of the schedulers: FreeBSD ULE vs. Linux CFS. (ATC'18)</li> <li>\u7ed3\u8bba\uff1a\u5728\u73b0\u5b9e\u9762\u524d\uff0c\u6ca1\u6709\u7edd\u5bf9\u7684\u8d62\u5bb6\u548c\u8f93\u5bb6</li> <li>\u5982\u679c\u4f60\u8ffd\u6c42\u6781\u81f4\u7684\u6027\u80fd\uff0c\u5c31\u4e0d\u80fd\u5168\u6307\u671b\u4e00\u4e2a\u8c03\u5ea6\u7b97\u6cd5</li> </ul>"},{"location":"courses/os_lab/24_impletation_of_os_process.html#_12","title":"\u8bfe\u540e\u4e60\u9898/\u7f16\u7a0b\u4f5c\u4e1a","text":""},{"location":"courses/os_lab/24_impletation_of_os_process.html#1_1","title":"1. \u9605\u8bfb\u6750\u6599","text":"<p>\u6559\u79d1\u4e66 Operating Systems: Three Easy Pieces</p> <ul> <li>\u7b2c 15 \u7ae0 - Address Translation</li> <li>\u7b2c 16 \u7ae0 - Segmentation</li> <li>\u7b2c 17 \u7ae0 - Free Space Management</li> <li>\u7b2c 18 \u7ae0 - Introduction to Paging</li> <li>\u7b2c 19 \u7ae0 - Translation Lookaside Buffers</li> <li>\u7b2c 20 \u7ae0 - Advanced Page Tables</li> <li>\u7b2c 21 \u7ae0 - Swapping: Mechanisms</li> <li>\u7b2c 22 \u7ae0 - Swapping: Policies</li> <li>\u7b2c 23 \u7ae0 - Complete VM Systems</li> </ul>"},{"location":"courses/os_lab/25_store_device.html","title":"\u5b58\u50a8\u8bbe\u5907\u539f\u7406","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a</p> <ul> <li>\u5b58\u50a8\u7cfb\u7edf\u539f\u7406</li> <li>\u6301\u4e45\u6570\u636e\u7684\u5b58\u50a8\uff1a\u78c1\u3001\u5149\u3001\u7535</li> </ul>"},{"location":"courses/os_lab/25_store_device.html#_2","title":"\u5b58\u50a8\u7cfb\u7edf\u539f\u7406","text":""},{"location":"courses/os_lab/25_store_device.html#_3","title":"\u4e3a\u4ec0\u4e48\u4f1a\u6709\u5185\u5b58\u548c\u5916\u5b58\uff1f","text":"<p>\u72b6\u6001\u673a(M,R)</p> <ul> <li>Memory \u5185\u5b58</li> <li>Registers \u5bc4\u5b58\u5668 (\u539f\u5219\u4e0a\u53ef\u4ee5\u4e0d\u9700\u8981)</li> </ul> <p>\u5b58\u50a8 \u201c\u5f53\u524d\u72b6\u6001\u201d \u7684\u9700\u6c42</p> <ul> <li>\u53ef\u4ee5\u5bfb\u5740\uff1a\u6839\u636e\u7f16\u53f7\u8bfb\u5199\u6570\u636e</li> <li>\u8bbf\u95ee\u901f\u5ea6\u5c3d\u53ef\u80fd\u5feb</li> <li>\u8d8a\u5feb\u5c31\u610f\u5473\u7740\u8d8a\u96be persist</li> <li>\u5141\u8bb8\u72b6\u6001\u5728\u6389\u7535\u540e\u4e22\u5931</li> </ul>"},{"location":"courses/os_lab/25_store_device.html#_4","title":"\u201c\u5f53\u524d\u72b6\u6001\u201d \u7684\u5b58\u50a8\u65b9\u6848","text":"<p>Delay line: \u7ef3\u5b50</p> <ul> <li>\u56e0\u4e3a\u4fe1\u53f7\u8870\u51cf\uff0c\u9700\u8981\u6301\u7eed\u653e\u5927</li> </ul> <p>Magnetic core: \u78c1\u94c1</p> <ul> <li>\u201cSegmentation fault (core dumped)\u201d</li> <li>\u4ec0\u4e48\u662f core dump\uff1f</li> <li>\u4e00\u79cd non-volatile memory</li> </ul> <p>SRAM/DRAM: Flip-Flop \u548c\u7535\u5bb9</p> <ul> <li>\u4eca\u5929\u7684\u5b9e\u73b0\u65b9\u6848</li> </ul>"},{"location":"courses/os_lab/25_store_device.html#_5","title":"\u5f00\u59cb\u6301\u4e45\u5316\u4e4b\u65c5","text":"<p>\u9664\u4e86 \u201c\u5f53\u524d\u72b6\u6001\u201d\uff0c\u6211\u4eec\u5e0c\u671b\u66f4\u5927\u3001\u66f4\u591a\u7684\u6570\u636e\u80fd \u201c\u7559\u4e0b\u6765\u201d (\u5e76\u4e14\u88ab\u64cd\u4f5c\u7cfb\u7edf\u6709\u6548\u5730\u7ba1\u7406\u8d77\u6765)</p> <p>\u6301\u4e45\u5b58\u50a8\u4ecb\u8d28</p> <ul> <li>\u6784\u6210\u4e00\u5207\u6587\u4ef6\u7684\u57fa\u7840</li> <li>\u903b\u8f91\u4e0a\u662f\u4e00\u4e2a <code>bit/byte array</code></li> <li>\u6839\u636e\u5c40\u90e8\u6027\u539f\u7406\uff0c\u5141\u8bb8\u6211\u4eec\u6309 \u201c\u5927\u5757\u201d \u8bfb\u5199</li> <li>\u8bc4\u4ef7\u65b9\u6cd5\uff1a\u4ef7\u683c\u3001\u5bb9\u91cf\u3001\u901f\u5ea6\u3001\u53ef\u9760\u6027</li> <li>\u518d\u6b21\u89c1\u8bc1\u4eba\u7c7b\u6587\u660e\u7684\u9ad8\u5149\u65f6\u523b\uff01</li> </ul>"},{"location":"courses/os_lab/25_store_device.html#_6","title":"\u6301\u4e45\u5316\u5b58\u50a8\uff1a\u78c1","text":""},{"location":"courses/os_lab/25_store_device.html#magnetic-tape-1928","title":"\u78c1\u5e26 (Magnetic Tape, 1928)","text":"<p>1D \u5b58\u50a8\u8bbe\u5907</p> <ul> <li> <p>\u628a Bits \u201c\u5377\u8d77\u6765\u201d</p> </li> <li> <p>\u7eb8\u5e26\u4e0a\u5747\u5300\u7c98\u4e0a\u94c1\u78c1\u6027\u9897\u7c92</p> </li> <li> <p>\u53ea\u9700\u8981\u4e00\u4e2a\u673a\u68b0\u90e8\u4ef6 (\u8f6c\u52a8) \u5b9a\u4f4d</p> </li> <li> <p>\u8bfb\u53d6\uff1a\u653e\u5927\u611f\u5e94\u7535\u6d41</p> </li> <li>\u5199\u5165\uff1a\u7535\u78c1\u94c1\u78c1\u5316\u78c1\u9488</li> </ul>"},{"location":"courses/os_lab/25_store_device.html#_7","title":"\u78c1\u5e26\uff1a\u4f5c\u4e3a\u5b58\u50a8\u8bbe\u5907\u7684\u5206\u6790","text":"<p>\u5206\u6790\uff1a\u5e94\u7528\u573a\u666f\uff1a\u51b7\u6570\u636e\u7684\u5b58\u6863\u548c\u5907\u4efd</p> <ul> <li>\u4ef7\u683c\uff1a\u975e\u5e38\u4f4e - \u90fd\u662f\u5ec9\u4ef7\u7684\u6750\u6599</li> <li>\u5bb9\u91cf\uff1a\u975e\u5e38\u9ad8</li> <li>\u8bfb\u5199\u901f\u5ea6</li> <li>\u987a\u5e8f\u8bfb\u53d6\uff1a\u52c9\u5f3a - \u9700\u8981\u7b49\u5f85\u5b9a\u4f4d</li> <li>\u968f\u673a\u8bfb\u53d6\uff1a\u51e0\u4e4e\u5b8c\u5168\u4e0d\u884c</li> <li>\u53ef\u9760\u6027\uff1a\u5b58\u5728\u673a\u68b0\u90e8\u4ef6\u3001\u9700\u8981\u4fdd\u5b58\u7684\u73af\u5883\u82db\u523b</li> </ul>"},{"location":"courses/os_lab/25_store_device.html#magnetic-drum-1932","title":"\u78c1\u9f13 (Magnetic Drum, 1932)","text":"<p>1D \u2192 1.5D (1D x n)</p> <ul> <li>\u7528\u65cb\u8f6c\u7684\u4e8c\u7ef4\u5e73\u9762\u5b58\u50a8\u6570\u636e</li> <li>\u65e0\u6cd5\u5185\u5377\uff0c\u5bb9\u91cf\u53d8\u5c0f</li> <li>\u8bfb\u5199\u5ef6\u8fdf\u4e0d\u4f1a\u8d85\u8fc7\u65cb\u8f6c\u5468\u671f</li> <li>\u968f\u673a\u8bfb\u5199\u901f\u5ea6\u5927\u5e45\u63d0\u5347</li> </ul> <p></p>"},{"location":"courses/os_lab/25_store_device.html#hard-disk-1956","title":"\u78c1\u76d8 (Hard Disk, 1956)","text":"<p>1D \u2192 2.5D (2D x n)</p> <ul> <li>\u5728\u4e8c\u7ef4\u5e73\u9762\u4e0a\u653e\u7f6e\u8bb8\u591a\u78c1\u5e26 (\u5185\u5377)</li> </ul> <p></p> <p>\u514b\u670d\u8bb8\u591a\u5de5\u7a0b\u6311\u6218</p> <p></p>"},{"location":"courses/os_lab/25_store_device.html#_8","title":"\u78c1\u76d8\uff1a\u4f5c\u4e3a\u5b58\u50a8\u8bbe\u5907\u7684\u5206\u6790","text":"<p>\u5206\u6790\uff1a\u5e94\u7528\u573a\u666f\uff1a\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684\u4e3b\u529b\u6570\u636e\u5b58\u50a8 (~~\u6d77\u91cf\u6570\u636e\uff1a\u4fbf\u5b9c\u624d\u662f\u738b\u9053~~)</p> <ul> <li>\u4ef7\u683c\uff1a\u4f4e - \u5bc6\u5ea6\u8d8a\u9ad8\uff0c\u6210\u672c\u8d8a\u4f4e</li> <li>\u5bb9\u91cf\uff1a\u9ad8 (2.5D) - \u5e73\u9762\u4e0a\u53ef\u4ee5\u6709\u6570\u4e07\u4e2a\u78c1\u9053</li> <li>\u8bfb\u5199\u901f\u5ea6</li> <li>\u987a\u5e8f\u8bfb\u53d6\uff1a\u8f83\u9ad8</li> <li>\u968f\u673a\u8bfb\u53d6\uff1a\u52c9\u5f3a</li> <li>\u53ef\u9760\u6027\uff1a\u5b58\u5728\u673a\u68b0\u90e8\u4ef6\uff0c\u78c1\u5934\u5212\u4f24\u76d8\u7247\u5bfc\u81f4\u6570\u636e\u635f\u574f</li> </ul>"},{"location":"courses/os_lab/25_store_device.html#_9","title":"\u78c1\u76d8\uff1a\u6027\u80fd\u8c03\u4f18","text":"<p>\u4e3a\u4e86\u8bfb/\u5199\u4e00\u4e2a\u6247\u533a\uff1a\u5b58\u53d6\u65f6\u95f4 = \u5bfb\u9053\u65f6\u95f4 + \u5ef6\u8fdf\u65f6\u95f4 + \u4f20\u8f93\u65f6\u95f4</p> <ol> <li>\u8bfb\u5199\u5934\u9700\u8981\u5230\u5bf9\u5e94\u7684\u78c1\u9053</li> <li>\u8bfb\u5199\u5934\u79fb\u52a8\u65f6\u95f4\u901a\u5e38\u4e5f\u9700\u8981\u51e0\u4e2a ms</li> <li>\u8f6c\u8f74\u5c06\u76d8\u7247\u65cb\u8f6c\u5230\u8bfb\u5199\u5934\u7684\u4f4d\u7f6e</li> <li>7200rpm \u2192 120rps \u2192  1/120 / 2 = 4.17 ms</li> </ol> <p>\u901a\u8fc7\u7f13\u5b58/\u8c03\u5ea6\u7b49\u7f13\u89e3</p> <ul> <li>\u4f8b\u5982\u8457\u540d\u7684 \u201c\u7535\u68af\u201d \u8c03\u5ea6\u7b97\u6cd5</li> <li>\u73b0\u4ee3 HDD \u90fd\u6709\u5f88\u597d\u7684 firmware \u7ba1\u7406\u78c1\u76d8 I/O \u8c03\u5ea6</li> <li><code>/sys/block/[dev]/queue</code></li> <li><code>[mq-deadline] none</code> (\u8bfb\u4f18\u5148\uff1b\u4f46\u5199\u4e5f\u4e0d\u81f3\u4e8e\u997f\u6b7b)</li> </ul>"},{"location":"courses/os_lab/25_store_device.html#floppy-disk-1971","title":"\u8f6f\u76d8 (Floppy Disk, 1971)","text":"<p>\u628a\u8bfb\u5199\u5934\u548c\u76d8\u7247\u5206\u5f00\u2014\u2014\u5b9e\u73b0\u6570\u636e\u79fb\u52a8</p> <ul> <li>\u8ba1\u7b97\u673a\u4e0a\u7684\u8f6f\u76d8\u9a71\u52a8\u5668 (drive) + \u53ef\u79fb\u52a8\u7684\u76d8\u7247</li> <li>8\" (1971), 5.25\" (1975), 3.5\" (1981)<ul> <li>\u6700\u521d\u7684\u8f6f\u76d8\u6210\u672c\u5f88\u4f4e\uff0c\u5c31\u662f\u4e2a\u7eb8\u58f3\u5b50</li> <li>3.5 \u82f1\u5bf8\u8f6f\u76d8\u4e3a\u4e86\u63d0\u9ad8\u53ef\u9760\u6027\uff0c\u5df2\u7ecf\u662f \u201c\u786c\u201d \u7684\u4e86</li> </ul> </li> </ul> <p></p>"},{"location":"courses/os_lab/25_store_device.html#_10","title":"\u8f6f\u76d8\uff1a\u4f5c\u4e3a\u5b58\u50a8\u8bbe\u5907\u7684\u5206\u6790","text":"<p>\u5206\u6790\uff1a\u8eba\u5728\u535a\u7269\u9986\u4f9b\u4eba\u53c2\u89c2\uff0c\u5f7b\u5e95\u88ab USB Flash Disk \u6740\u6b7b</p> <ul> <li>\u4ef7\u683c\uff1a\u4f4e - \u5851\u6599\u3001\u76d8\u7247\u548c\u4e00\u4e9b\u5c0f\u6750\u6599</li> <li>\u5bb9\u91cf\uff1a\u4f4e (\u66b4\u9732\u7684\u5b58\u50a8\u4ecb\u8d28\uff0c\u5bc6\u5ea6\u53d7\u9650)</li> <li>\u8bfb\u5199\u901f\u5ea6}\uff1a\u987a\u5e8f/\u968f\u673a\u8bfb\u53d6\uff1a\u4f4e</li> <li>\u53ef\u9760\u6027\uff1a\u4f4e (\u66b4\u9732\u7684\u5b58\u50a8\u4ecb\u8d28)</li> </ul>"},{"location":"courses/os_lab/25_store_device.html#_11","title":"\u6301\u4e45\u5316\u5b58\u50a8\uff1a\u5751","text":"<p>\u5929\u7136\u5bb9\u6613 \u201c\u9605\u8bfb\u201d \u7684\u6570\u636e\u5b58\u50a8\uff1a\u5982\u540c\u6c99\u6ee9\u7684SOS\u3001\u7eb8\u5e26\u4e0a\u7684\u5b54\uff1b</p>"},{"location":"courses/os_lab/25_store_device.html#compact-disk-cd-1980","title":"Compact Disk (CD, 1980)","text":"<p>\u5728\u53cd\u5c04\u5e73\u9762 (1) \u4e0a\u6316\u4e0a\u7c97\u7cd9\u7684\u5751 (0)</p> <ul> <li>\u6fc0\u5149\u626b\u8fc7\u8868\u9762\uff0c\u5c31\u80fd\u8bfb\u51fa\u5751\u7684\u4fe1\u606f\u6765</li> <li>\u98de\u5229\u6d66 (\u789f\u7247) \u548c\u7d22\u5c3c (\u6570\u5b57\u97f3\u9891) \u53d1\u660e</li> <li>~700 MiB\uff0c\u5728\u5f53\u65f6\u662f\u975e\u5e38\u5de8\u5927\u7684\u5bb9\u91cf</li> </ul> <p></p>"},{"location":"courses/os_lab/25_store_device.html#cd-rw","title":"CD-RW","text":"<p>\u80fd\u5426\u514b\u670d\u53ea\u8bfb\u7684\u9650\u5236\uff1f</p> <ul> <li> <p>\u65b9\u6cd5 1</p> </li> <li> <p>\u7528\u6fc0\u5149\u5668\u70e7\u51fa\u4e00\u4e2a\u5751\u6765 (\u201c\u523b\u76d8\u201d)</p> </li> <li> <p>\u4f7f\u7528\u6301\u4e45\u5316\u6570\u636e\u7ed3\u6784 (append-only)</p> </li> <li>\u65b9\u6cd5 2\uff1a\u6539\u53d8\u6750\u6599\u7684\u53cd\u5149\u7279\u6027</li> <li>PCM (Phase-change Material)</li> <li>How do rewriteable CDs work?</li> </ul>"},{"location":"courses/os_lab/25_store_device.html#_12","title":"\u6316\u5751\u7684\u6280\u672f\u8fdb\u5c55","text":"<p>\u5728\u5b9e\u7528\u65b9\u9762\u9010\u6e10\u88ab\u7f51\u7edc\u6dd8\u6c70</p> <p>CD (740 MB)\uff1a780nm \u7ea2\u5916\u6fc0\u5149</p> <p>DVD (4.7 GB)\uff1a635nm \u7ea2\u8272\u6fc0\u5149</p> <p>Blue Ray (100 GB)\uff1a405nm \u84dd\u7d2b\u8272\u6fc0\u5149</p>"},{"location":"courses/os_lab/25_store_device.html#_13","title":"\u5149\u76d8\uff1a\u4f5c\u4e3a\u5b58\u50a8\u8bbe\u5907\u7684\u5206\u6790","text":"<p>\u5206\u6790\uff1a\u5e94\u7528\u573a\u666f\uff1a\u4f5c\u4e3a\u6570\u5b57\u6536\u85cf</p> <ul> <li>\u4ef7\u683c\uff1a\u5f88\u4f4e (\u800c\u4e14\u5f88\u5bb9\u6613\u901a\u8fc7 \u201c\u538b\u76d8\u201d \u590d\u5236)</li> <li>\u5bb9\u91cf\uff1a\u9ad8</li> <li>\u8bfb\u5199\u901f\u5ea6\uff1a</li> <li>\u987a\u5e8f\u8bfb\u53d6\u901f\u5ea6\u9ad8\uff1b\u968f\u673a\u8bfb\u53d6\u52c9\u5f3a</li> <li>\u5199\u5165\u901f\u5ea6\u4f4e (\u6316\u5751\u5bb9\u6613\u586b\u5751\u96be)</li> <li>\u53ef\u9760\u6027\uff1a\u9ad8</li> </ul>"},{"location":"courses/os_lab/25_store_device.html#_14","title":"\u201c\u6316\u5751\u201d\uff1a\u4e0d\u6b62\u662f\u6570\u636e\u5b58\u50a8","text":"<p>\uff1f\u6316\u5751\u7684\u65b9\u5f0f\u9020\u82af\u7247\uff1f</p> <p></p>"},{"location":"courses/os_lab/25_store_device.html#_15","title":"\u6301\u4e45\u5316\u5b58\u50a8\uff1a\u7535","text":""},{"location":"courses/os_lab/25_store_device.html#solid-state-drive-1991","title":"Solid State Drive (1991)","text":"<p>\u4e4b\u524d\u7684\u6301\u4e45\u5b58\u50a8\u4ecb\u8d28\u90fd\u6709\u81f4\u547d\u7684\u7f3a\u9677</p> <ul> <li>\u78c1\uff1a\u673a\u68b0\u90e8\u4ef6\u5bfc\u81f4 ms \u7ea7\u5ef6\u8fdf</li> <li>\u5751 (\u5149): \u4e00\u65e6\u6316\u5751\uff0c\u586b\u5751\u5f88\u56f0\u96be (CD \u662f\u53ea\u8bfb\u7684)</li> </ul> <p>\u5bc6\u5ea6\u548c\u901f\u5ea6\uff1a\u6700\u540e\u8fd8\u5f97\u9760\u7535 (\u7535\u8def) \u89e3\u51b3\u95ee\u9898</p> <ul> <li>Flash Memory \u201c\u95ea\u5b58\u201d</li> <li>Floating gate \u7684\u5145\u7535/\u653e\u7535\u5b9e\u73b0 1-bit \u4fe1\u606f\u7684\u5b58\u50a8</li> </ul> <p></p>"},{"location":"courses/os_lab/25_store_device.html#flash-memory","title":"Flash Memory: \u51e0\u4e4e\u5168\u662f\u4f18\u70b9","text":"<p>\u5206\u6790</p> <ul> <li>\u4ef7\u683c\uff1a\u4f4e (\u5927\u89c4\u6a21\u96c6\u6210\u7535\u8def\uff0c\u4fbf\u5b9c)</li> <li>\u5bb9\u91cf\uff1a\u9ad8 (3D \u7a7a\u95f4\u91cc\u6bcf\u4e2a (\ud835\udc65,\ud835\udc66,\ud835\udc67) \u90fd\u662f\u4e00\u4e2a bit)</li> <li>\u8bfb\u5199\u901f\u5ea6\uff1a\u9ad8(\u76f4\u63a5\u901a\u8fc7\u7535\u8def\u8bfb\u5199)</li> <li>\u4e0d\u8bb2\u9053\u7406\u7684\u7279\u6027\uff1a\u5bb9\u91cf\u8d8a\u5927\uff0c\u901f\u5ea6\u8d8a\u5feb (\u7535\u8def\u7ea7\u5e76\u884c)</li> <li>\u5feb\u5230\u6dd8\u6c70\u4e86\u65e7\u7684 SATA \u63a5\u53e3\u6807\u51c6 (NVMe)</li> <li>\u53ef\u9760\u6027\uff1a\u9ad8 (\u6ca1\u6709\u673a\u68b0\u90e8\u4ef6\uff0c\u968f\u4fbf\u6454)</li> </ul> <p>\u4f46\u6709\u4e00\u4e2a\u610f\u60f3\u4e0d\u5230\u7684\u7f3a\u70b9 (\u5927\u5bb6\u77e5\u9053\u662f\u4ec0\u4e48\u5417\uff1f\u4e0b\u7ae0)</p>"},{"location":"courses/os_lab/25_store_device.html#usb-flash-disk-1999","title":"USB Flash Disk (1999)","text":"<p>\u4f18\u76d8\u5bb9\u91cf\u5927\u3001\u901f\u5ea6\u5feb\u3001\u76f8\u5f53\u4fbf\u5b9c</p> <ul> <li>\u5f88\u5feb\u5c31\u53d6\u4ee3\u4e86\u8f6f\u76d8\uff0c\u6210\u4e3a\u4e86\u4eba\u624b n \u4e2a\u7684\u5b58\u50a8\u4ecb\u8d28</li> <li>Compact Flash (CF, 1994)</li> <li>USB Flash Disk (1999, \u201c\u6717\u79d1\u201d)</li> </ul> <p>\u653e\u7535 (erase) \u505a\u4e0d\u5230 100% \u653e\u5e72\u51c0</p> <ul> <li>\u653e\u7535\u6570\u5343/\u6570\u4e07\u6b21\u4ee5\u540e\uff0c\u5c31\u597d\u50cf\u662f \u201c\u5145\u7535\u201d \u72b6\u6001\u4e86</li> <li>Dead cell; \u201cwear out\u201d</li> <li>\u5fc5\u987b\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898 SSD \u624d\u80fd\u5b9e\u7528</li> </ul> <p></p>"},{"location":"courses/os_lab/25_store_device.html#ssd","title":"\u4f18\u76d8\u548c SSD \u7684\u533a\u522b","text":"<p>\u4f18\u76d8, SD \u5361, SSD \u90fd\u662f NAND(Not AND) Flash\u3002</p> <p>\u4f46\u8f6f\u4ef6/\u786c\u4ef6\u7cfb\u7edf\u7684\u590d\u6742\u7a0b\u5ea6\u4e0d\u540c\uff0c\u6548\u7387/\u5bff\u547d\u4e5f\u4e0d\u540c</p> <ul> <li>\u5178\u578b\u7684 SSD</li> <li>CPU, on-chip RAM, \u7f13\u5b58, store buffer, \u64cd\u4f5c\u7cfb\u7edf ...</li> <li> <p>\u5bff\u547d: ~1 PiB \u6570\u636e\u5199\u5165 (~1,000 \u5e74\u5bff\u547d)</p> </li> <li> <p>SD \u5361\uff1a\u4e00\u5b9a\u4e0d\u8981\u7528\u4fbf\u5b9c\u7684\u4f18\u76d8\u4fdd\u5b58\u91cd\u8981\u6570\u636e</p> </li> <li>SDHC \u6807\u51c6\u672a\u89c4\u5b9a<ul> <li>\u9ed1\u5fc3\u5546\u5bb6\u4e00\u5b9a\u4f1a\u5077\u5de5\u51cf\u6599</li> </ul> </li> <li>\u4f46\u826f\u5fc3\u5382\u5bb6\u4f9d\u7136\u6709 ARM \u82af\u7247</li> </ul>"},{"location":"courses/os_lab/25_store_device.html#ssd_1","title":"SSD \u7684\u7ec6\u8282","text":"<p>\u8f6f\u4ef6\u5b9a\u4e49\u78c1\u76d8\uff1a\u6bcf\u4e00\u4e2a SSD \u91cc\u90fd\u85cf\u4e86\u4e00\u4e2a\u5b8c\u6574\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf</p> <p></p> <ul> <li>FTL: Flash Translation Layer</li> <li>\u201cWear Leveling\u201d: \u8f6f\u4ef6\u7ba1\u7406\u90a3\u4e9b\u53ef\u80fd\u51fa\u95ee\u9898\u7684 blocks</li> <li>\u50cf\u662f managed runtime (with garbage collection)</li> </ul> <p>Wear Leveling\uff1aLogical block address (LBA) \u2192 Physical block address (PBA)</p> <ul> <li>SSD \u7684 Page/Block \u4e24\u5c42\u7ed3\u6784</li> <li>Page (\u8bfb\u53d6\u7684\u6700\u5c0f\u5355\u4f4d, e.g., 4KB)</li> <li>Block (\u5199\u5165\u7684\u6700\u5c0f\u5355\u4f4d, e.g., 4MB)</li> <li>Read/write amplification (\u8bfb/\u5199\u4e0d\u5fc5\u8981\u591a\u7684\u5185\u5bb9)</li> <li>Copy on write</li> <li>Coding for SSDs</li> </ul>"},{"location":"courses/os_lab/25_store_device.html#ftl","title":"FTL \u5e26\u6765\u7684\u6027\u80fd\u3001\u53ef\u9760\u6027\u3001\u5b89\u5168\u6027\u95ee\u9898","text":"<p>\u7406\u89e3\u4e86 FTL \u4e4b\u540e</p> <ul> <li>\u5373\u4fbf\u683c\u5f0f\u5316\u540e\u5199\u5165\u6570\u636e (\u4e0d\u5199\u6ee1)</li> <li>\u540c\u4e00\u4e2a logic block \u88ab\u8986\u76d6\uff0cphysical block \u4f9d\u7136\u5b58\u50a8\u4e86\u6570\u636e (copy-on-write)</li> <li>\u9700\u8981\u6587\u4ef6\u7cfb\u7edf\u52a0\u5bc6</li> </ul> <p>\u53e6\u4e00\u4e2a memory system \u76f8\u5173\u7684\u5b89\u5168\u95ee\u9898</p> <ul> <li>Row Hammer(TCAD'19)</li> <li>\u66f4\u91cd\u7684\u8d1f\u8f7d\u53ef\u80fd\u4f1a \u201c\u5e72\u6270\u201d \u4e34\u8fd1\u7684 DRAM Cells</li> </ul> <p>\u786c\u4ef6\u91cc\u7684\u8f6f\u4ef6\uff1a\u5176\u5b9e\u975e\u5e38\u590d\u6742\uff1a\u7b97\u6cd5, cache; store buffer; ...</p> <ul> <li>\u9020\u75af\u72c2\u7684 workloads\uff0c\u628a\u5b83\u5f04\u6302\u5427\uff01</li> <li>Understanding the robustness of SSDs under power fault (FAST'13)</li> </ul>"},{"location":"courses/os_lab/25_store_device.html#_16","title":"\u9605\u8bfb\u6750\u6599","text":"<p>\u5982\u679c\u66f4\u5feb\u7684 non-volatile memory \u5230\u6765\uff0c\u6211\u4eec\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u662f\u5426\u4f1a\u53d1\u751f\u7ffb\u5929\u8986\u5730\u7684\u53d8\u5316\uff1f</p> <ul> <li>Operating system implications of fast, cheap, non-volatile memory (HotOS'13)</li> </ul> <p>\u6b22\u8fce\u5230\u5927\u5bb6\u9605\u8bfb\u8bfe\u5802\u4e2d\u7684\u4e00\u4e9b blogs\uff0c\u4ee5\u53ca\u81ea\u5df1\u6536\u96c6\u4e00\u4e9b\u6709\u8da3\u7684\u8d44\u6599\uff0c\u4f8b\u5982 How do rewriteable CDs work? \u548c Coding for SSDs\u3002</p>"},{"location":"courses/os_lab/25_store_device.html#1","title":"1. \u9605\u8bfb\u6750\u6599","text":"<p>\u6559\u79d1\u4e66 Operating Systems: Three Easy Pieces:</p> <ul> <li>\u7b2c 37 \u7ae0 - Hard Disk Drives</li> <li>\u7b2c 44 \u7ae0 - Flash-based SSDs</li> </ul>"},{"location":"courses/os_lab/26_input_output_device.html","title":"\u8f93\u5165\u8f93\u51fa\u8bbe\u5907","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a\u8f93\u5165\u8f93\u51fa\u8bbe\u5907\u539f\u7406</p> <ul> <li>\u8ba1\u7b97\u673a\u4e0e\u5916\u8bbe\u7684\u63a5\u53e3</li> <li>\u603b\u7ebf\u3001\u4e2d\u65ad\u63a7\u5236\u5668\u548c DMA</li> <li>GPU \u548c\u52a0\u901f\u5668</li> </ul>"},{"location":"courses/os_lab/26_input_output_device.html#_2","title":"\u8f93\u5165\u8f93\u51fa\u8bbe\u5907\u539f\u7406","text":""},{"location":"courses/os_lab/26_input_output_device.html#cpu","title":"\u5b64\u72ec\u7684 CPU","text":"<p>CPU \u53ea\u662f \u201c\u65e0\u60c5\u7684\u6307\u4ee4\u6267\u884c\u673a\u5668\u201d</p> <ul> <li>\u53d6\u6307\u4ee4\u3001\u8bd1\u7801\u3001\u6267\u884c</li> </ul> <p>Altair-8800 (1975), with Intel 8080A; 256B \u677f\u5361 RAM (\u9700\u8981\u5728\u9762\u677f\u4e0a\u62e8\u52a8\u5f00\u5173\u8f93\u5165\u6267\u884c\u6307\u4ee4\u7684\u8d77\u59cb\u5730\u5740)</p>"},{"location":"courses/os_lab/26_input_output_device.html#cpu_1","title":"CPU \u5982\u4f55\u6307\u6325 \u201c\u5916\u90e8\u201d \u7684\u8bbe\u5907\uff1f","text":"<p>\u9700\u6c42\uff1a\u80fd\u5426\u5b9e\u73b0\u6838\u5f39\u53d1\u5c04\u7bb1\uff1f</p> <ul> <li>\u5982\u4f55\u4f7f\u8ba1\u7b97\u673a\u80fd\u611f\u77e5\u5916\u90e8\u72b6\u6001(\u773c\u775b\u3001\u8033\u6735)\u3001\u5bf9\u5916\u5b9e\u65bd\u52a8\u4f5c (\u624b)\uff1f</li> <li>\u8ba1\u7b97\u673a\u7cfb\u7edf\uff1a\u8ba1\u7b97\u9a71\u52a8\u7684\u8f93\u5165/\u8f93\u51fa</li> </ul> <p></p> <p>\u7b54\u6848\uff1a\u4e00\u6839\u7ebf</p> <p>\u6838\u5f39\u53d1\u5c04\u7bb1</p> <ul> <li>\u628a\u94a5\u5319\u7684\u72b6\u6001\u5199\u5165 flip/flop\uff08\u89e6\u53d1\u5668\uff09 (0/1)\uff0c\u5e76\u914d\u6307\u793a\u706f</li> <li>\u628a\u6309\u94ae\u7684\u72b6\u6001\u5199\u5165 flip/flop (0/1)</li> <li>CPU \u63d0\u4f9b\u4e00\u6761\u6307\u4ee4</li> <li>reg_read(x)</li> <li>\u68c0\u6d4b\u5230\u6309\u94ae\u548c\u94a5\u5319\u7684\u88c5\u586b\uff0creg_write(launch, 1)</li> <li>\u68c0\u6d4b\u5230 launch \u5bc4\u5b58\u5668\uff0c\u5373\u53d1\u5c04\u6838\u5f39</li> </ul>"},{"location":"courses/os_lab/26_input_output_device.html#io","title":"I/O \u8bbe\u5907\uff1a\u201c\u8ba1\u7b97\u201d \u548c \u201c\u7269\u7406\u4e16\u754c\u201d \u4e4b\u95f4\u7684\u6865\u6881","text":"<p>I/O \u8bbe\u5907 (CPU \u89c6\u89d2)\uff1a\u201c\u4e00\u4e2a\u80fd\u4e0e CPU \u4ea4\u6362\u6570\u636e\u7684\u63a5\u53e3/\u63a7\u5236\u5668\u201d</p> <p></p> <p>\u201c\u51e0\u7ec4\u7ea6\u5b9a\u597d\u529f\u80fd\u7684\u7ebf\u201d (RTFM)</p> <ul> <li>\u901a\u8fc7\u63e1\u624b\u4fe1\u53f7\u4ece\u7ebf\u4e0a\u8bfb\u51fa/\u5199\u5165\u6570\u636e</li> </ul> <p>\u6bcf\u4e00\u7ec4\u7ebf\u6709\u81ea\u5df1\u7684\u5730\u5740\uff1aCPU \u5b8c\u5168\u4e0d\u7ba1\u8bbe\u5907\u5177\u4f53\u662f\u5982\u4f55\u5b9e\u73b0\u7684</p> <ul> <li>CPU \u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u6307\u4ee4 (in/out/MMIO) \u548c\u8bbe\u5907\u4ea4\u6362\u6570\u636e</li> </ul>"},{"location":"courses/os_lab/26_input_output_device.html#1-uart","title":"\u4f8b\u5b50 (1): \u4e32\u53e3 (UART)","text":"<p>\u201cCOM1\u201d; <code>putch()</code> \u7684\u5b9e\u73b0</p> <pre><code>#define COM1 0x3f8\n\nstatic int uart_init() {\n  outb(COM1 + 2, 0);   // \u63a7\u5236\u5668\u76f8\u5173\u7ec6\u8282\n  outb(COM1 + 3, 0x80);\n  outb(COM1 + 0, 115200 / 9600);\n  ...\n}\n\nstatic void uart_tx(AM_UART_TX_T *send) {\n  outb(COM1, send-&gt;data);\n}\n\nstatic void uart_rx(AM_UART_RX_T *recv) {\n  recv-&gt;data = (inb(COM1 + 5) &amp; 0x1) ? inb(COM1) : -1;\n}\n</code></pre>"},{"location":"courses/os_lab/26_input_output_device.html#2","title":"\u4f8b\u5b50 (2): \u952e\u76d8\u63a7\u5236\u5668","text":"<p>IBM PC/AT 8042 PS/2 (Keyboard) Controller</p> <ul> <li>\u201c\u786c\u7f16\u7801\u201d \u5230\u4e24\u4e2a I/O port: <code>0x60</code> (data), <code>0x64</code> (status/command)</li> </ul> Command Byte Use \u8bf4\u660e 0xED LED \u706f\u63a7 ScrollLock/NumLock/CapsLock 0xF3 \u8bbe\u7f6e\u91cd\u590d\u901f\u5ea6 30Hz - 2Hz; Delay: 250 - 1000ms 0xF4/0xF5 \u6253\u5f00/\u5173\u95ed N/A 0xFE \u91cd\u65b0\u53d1\u9001 N/A 0xFF RESET N/A <p>\u53c2\u8003 AbstractMachine \u7684\u952e\u76d8\u90e8\u5206\u5b9e\u73b0</p>"},{"location":"courses/os_lab/26_input_output_device.html#3","title":"\u4f8b\u5b50 (3): \u78c1\u76d8\u63a7\u5236\u5668","text":"<p>ATA (Advanced Technology Attachment)</p> <ul> <li>IDE (Integrated Drive Electronics) \u63a5\u53e3\u78c1\u76d8</li> <li>primary: <code>0x1f0 - 0x1f7</code>; secondary: <code>0x170 - 0x177</code></li> </ul> <pre><code>void readsect(void *dst, int sect) {\n  waitdisk();\n  out_byte(0x1f2, 1);          // sector count (1)\n  out_byte(0x1f3, sect);       // sector\n  out_byte(0x1f4, sect &gt;&gt; 8);  // cylinder (low)\n  out_byte(0x1f5, sect &gt;&gt; 16); // cylinder (high)\n  out_byte(0x1f6, (sect &gt;&gt; 24) | 0xe0); // drive\n  out_byte(0x1f7, 0x20);       // command (write)\n  waitdisk();\n  for (int i = 0; i &lt; SECTSIZE / 4; i ++)\n    ((uint32_t *)dst)[i] = in_long(0x1f0); // data\n}\n</code></pre>"},{"location":"courses/os_lab/26_input_output_device.html#4","title":"\u4f8b\u5b50 (4): \u6253\u5370\u673a","text":"<p>\u6253\u5370\u673a\uff1a\u5c06\u5b57\u8282\u6d41\u63cf\u8ff0\u7684\u6587\u5b57/\u56fe\u5f62\u6253\u5370\u5230\u7eb8\u5f20\u4e0a</p> <ul> <li>\u53ef\u7b80\u5355 (\u6253\u5b57\u673a)</li> <li>\u53ef\u590d\u6742 (\u7f16\u7a0b\u8bed\u8a00\u63cf\u8ff0\u7684\u56fe\u5f62)</li> <li>\u9ad8\u6e05\u5168\u9875\u56fe\u7247\u7684\u4f20\u8f93\u662f\u5f88\u5927\u7684\u6311\u6218</li> </ul> <p>\u4f8b\u5b50\uff1aPostScript (1984)</p> <ul> <li>\u4e00\u79cd\u63cf\u8ff0\u9875\u9762\u5e03\u5c40\u7684 domain-specific language</li> <li>\u7c7b\u4f3c\u4e8e\u6c47\u7f16\u8bed\u8a00</li> <li>\u53ef\u4ee5\u7528 \u201c\u7f16\u8bd1\u5668\u201d (\u4f8b\u5982 latex) \u521b\u5efa\u9ad8\u8d28\u91cf\u7684\u6587\u7a3f</li> <li>PDF \u662f\u5b83\u7684 superset \uff0c\u793a\u4f8b\uff1a\u4e0b\u9762\u7684 page.ps</li> <li>\u6253\u5370\u673a\u662f\u53e6\u4e00\u4e2a\u5e26 CPU \u7684\u8bbe\u5907</li> </ul> <pre><code>%!\n% http://www.cs.cmu.edu/afs/andrew/scs/cs/15-463/98/pub/www/assts/ps.html\n\n72 72 scale % scale coordinate system so units are inches, not points\n2 2 translate   % put origin 2 inches from lower left of page\n\n/Courier findfont .6 scalefont setfont\n% current font is now Courier about .6 inches high\ngsave   % save graphics state (coordinate system &amp; stuff)\n.5 setgray\n60 rotate\n0 0 moveto (Read the friendly manual) show\ngrestore    % restore previous graphics state\n\n/Helvetica-Bold findfont .2 scalefont setfont\n% current font is now slanted Helvetica about .2 inches high\n0 4 moveto (Read the friendly source code) show\n\n/Times-Italic findfont .5 scalefont setfont\n% current font is now italic Times about .5 inches high\n1 0 0 setrgbcolor\n0 6 moveto (Search the friendly Web) show\n\nshowpage\n</code></pre>"},{"location":"courses/os_lab/26_input_output_device.html#_3","title":"\u8ba1\u7b97\u673a\u7cfb\u7edf\u91cc\u6709\u4ec0\u4e48\u8bbe\u5907\uff1f","text":"<p>\u5382\u5546\u5fc5\u987b\u544a\u8bc9\u64cd\u4f5c\u7cfb\u7edf\uff1a\u54ea\u4e2a\u8bbe\u5907\u5728\u4ec0\u4e48\u5730\u5740</p> <ul> <li>0x1f2 - ATA \u63a7\u5236\u5668</li> <li>0x3f8 - COM1</li> </ul> <p>Linux \u6709\u4e00\u4e2a Device Tree \u673a\u5236</p> <ul> <li>qemu-system-aarch64 -machine virt -cpu cortex-a57 -machine dumpdtb=dtb.dtb</li> <li>\u53ef\u4ee5\u901a\u8fc7 dtc \u67e5\u770b\u5382\u5546\u7ed9\u51fa\u7684\u914d\u7f6e</li> </ul>"},{"location":"courses/os_lab/26_input_output_device.html#dma","title":"\u603b\u7ebf\u3001\u4e2d\u65ad\u63a7\u5236\u5668\u548c DMA","text":""},{"location":"courses/os_lab/26_input_output_device.html#io_1","title":"\u8d8a\u6765\u8d8a\u591a\u7684 I/O \u8bbe\u5907","text":"<p>\u5982\u679c\u4f60\u53ea\u9020 \u201c\u4e00\u53f0\u8ba1\u7b97\u673a\u201d</p> <ul> <li>\u968f\u4fbf\u7ed9\u6bcf\u4e2a\u8bbe\u5907\u5b9a\u4e00\u4e2a\u7aef\u53e3/\u5730\u5740\uff0c\u7528 mux \u8fde\u63a5\u5230 CPU \u5c31\u884c</li> <li>\u4f60\u4eec\u7684\u5b9e\u9a8c (AbstractMachine) \u548c\u81ea\u5236 CPU \u5c31\u662f\u8fd9\u4e48\u505a</li> </ul> <p>\u5e0c\u671b\u63a5\u5165\u66f4\u591a I/O \u8bbe\u5907</p> <ul> <li>\u751a\u81f3\u662f\u672a\u77e5\u7684\u8bbe\u5907\uff0c\u4f46\u4e0d\u5e0c\u671b\u6539\u53d8 CPU\uff1f</li> </ul>"},{"location":"courses/os_lab/26_input_output_device.html#io_2","title":"\u603b\u7ebf\uff1a\u4e00\u4e2a\u7279\u6b8a\u7684 I/O \u8bbe\u5907","text":"<p>\u63d0\u4f9b\u8bbe\u5907\u7684\u6ce8\u518c\u548c\u5730\u5740\u5230\u8bbe\u5907\u7684\u8f6c\u53d1</p> <ul> <li>\u628a\u6536\u5230\u7684\u5730\u5740 (\u603b\u7ebf\u5730\u5740) \u548c\u6570\u636e\u8f6c\u53d1\u5230\u76f8\u5e94\u7684\u8bbe\u5907\u4e0a</li> <li>\u4f8b\u5b50: port I/O \u7684\u7aef\u53e3\u5c31\u662f\u603b\u7ebf\u4e0a\u7684\u5730\u5740</li> <li>IBM PC \u7684 CPU \u5176\u5b9e\u53ea\u770b\u5230\u8fd9\u4e00\u4e2a I/O \u8bbe\u5907</li> </ul> <p>CPU \u53ea\u9700\u8981\u76f4\u8fde\u4e00\u4e2a\u603b\u7ebf </p> <ul> <li>\u4eca\u5929 PCI \u603b\u7ebf\u80a9\u8d1f\u4e86\u8fd9\u4e2a\u4efb\u52a1</li> <li>\u603b\u7ebf\u53ef\u4ee5\u6865\u63a5\u5176\u4ed6\u603b\u7ebf (\u4f8b\u5982 PCI \u2192 USB)</li> <li><code>lspci -tv</code> \u548c <code>lsusb -tv</code>: \u67e5\u770b\u7cfb\u7edf\u4e2d\u603b\u7ebf\u4e0a\u7684\u8bbe\u5907</li> <li>\u6982\u5ff5\u7b80\u5355\uff0c\u5b9e\u9645\u975e\u5e38\u590d\u6742\u2026\u2026<ul> <li>\u7535\u6c14\u7279\u6027\u3001burst \u4f20\u8f93\u3001\u4e2d\u65ad\u3001Plug and Play\uff08Windows\u53ef\u63d2\u62d4\u7ffb\u8f66 BillGates\uff09\u2026\u2026</li> </ul> </li> </ul>"},{"location":"courses/os_lab/26_input_output_device.html#_4","title":"\u4e2d\u65ad\u63a7\u5236\u5668","text":"<p>CPU \u6709\u4e00\u4e2a\u4e2d\u65ad\u5f15\u811a</p> <ul> <li>\u6536\u5230\u67d0\u4e2a\u7279\u5b9a\u7684\u7535\u4fe1\u53f7\u4f1a\u89e6\u53d1\u4e2d\u65ad</li> <li>\u4fdd\u5b58 5 \u4e2a\u5bc4\u5b58\u5668 (cs, rip, rflags, ss, rsp)</li> <li>\u8df3\u8f6c\u5230\u4e2d\u65ad\u5411\u91cf\u8868\u5bf9\u5e94\u9879\u6267\u884c</li> </ul> <p>\u7cfb\u7edf\u4e2d\u7684\u5176\u4ed6\u8bbe\u5907\u53ef\u4ee5\u5411\u4e2d\u65ad\u63a7\u5236\u5668\u8fde\u7ebf</p> <ul> <li>Intel 8259 PIC</li> <li>programmable interrupt controller</li> <li>\u53ef\u4ee5\u8bbe\u7f6e\u4e2d\u65ad\u5c4f\u853d\u3001\u4e2d\u65ad\u89e6\u53d1\u7b49\u2026\u2026</li> <li>APIC (Advanced PIC)</li> <li>local APIC: \u4e2d\u65ad\u5411\u91cf\u8868, IPI, \u65f6\u949f, \u2026\u2026</li> <li>I/O APIC: \u5176\u4ed6 I/O \u8bbe\u5907</li> </ul> <p></p>"},{"location":"courses/os_lab/26_input_output_device.html#_5","title":"\u4e2d\u65ad\u6ca1\u80fd\u89e3\u7684\u95ee\u9898","text":"<p>\u5047\u8bbe\u7a0b\u5e8f\u5e0c\u671b\u5199\u5165 1 GB \u7684\u6570\u636e\u5230\u78c1\u76d8</p> <ul> <li>\u5373\u4fbf\u78c1\u76d8\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u4f9d\u7136\u9700\u8981\u975e\u5e38\u6d6a\u8d39\u7f13\u6162\u7684\u5faa\u73af</li> <li>out \u6307\u4ee4\u5199\u5165\u7684\u662f\u8bbe\u5907\u7f13\u51b2\u533a\uff0c\u9700\u8981\u53bb\u603b\u7ebf\u4e0a\u7ed5\u4e00\u5708</li> <li>cache disable; store \u5176\u5b9e\u5f88\u6162\u7684</li> </ul> <pre><code>for (int i = 0; i &lt; 1 GB / 4; i++) {\n  outl(PORT, ((u32 *)buf)[i]);\n}\n</code></pre> <p>\u80fd\u5426\u628a CPU \u4ece\u6267\u884c\u5faa\u73af\u4e2d\u89e3\u653e\u51fa\u6765\uff1f</p> <ul> <li>\u6bd4\u5982\uff0c\u5728\u7cfb\u7edf\u91cc\u5f81\u7528\u4e00\u4e2a\u5c0f CPU\uff0c\u4e13\u95e8\u590d\u5236\u6570\u636e?</li> <li>\u597d\u50cf <code>memcpy_to_port(ATA0, buf, length);</code></li> </ul>"},{"location":"courses/os_lab/26_input_output_device.html#direct-memory-access-dma","title":"Direct Memory Access (DMA)","text":"<p>DMA: \u4e00\u4e2a\u4e13\u95e8\u6267\u884c \u201c<code>memcpy</code>\u201d \u7a0b\u5e8f\u7684 CPU</p> <ul> <li>\u52a0\u4e00\u4e2a\u901a\u7528\u5904\u7406\u5668\u592a\u6d6a\u8d39\uff0c\u4e0d\u5982\u52a0\u4e00\u4e2a\u7b80\u5355\u7684</li> </ul> <p>\u652f\u6301\u7684\u51e0\u79cd <code>memcpy</code></p> <ul> <li>memory \u2192 memory</li> <li>memory \u2192 device (register)</li> <li>device (register) \u2192 memory</li> <li>\u5b9e\u9645\u5b9e\u73b0\uff1a\u76f4\u63a5\u628a DMA \u63a7\u5236\u5668\u8fde\u63a5\u5728\u603b\u7ebf\u548c\u5185\u5b58\u4e0a</li> <li>Intel 8237A</li> </ul> <p>PCI \u603b\u7ebf\u652f\u6301 DMA</p> <ul> <li><code>sudo cat /proc/iomem</code></li> </ul>"},{"location":"courses/os_lab/26_input_output_device.html#gpu","title":"GPU \u548c\u52a0\u901f\u5668","text":""},{"location":"courses/os_lab/26_input_output_device.html#io_3","title":"I/O \u8bbe\u5907\u548c\u8ba1\u7b97\u673a\u4e4b\u95f4\u7684\u8fb9\u754c\u9010\u6e10\u6a21\u7cca","text":"<p>DMA \u4e0d\u5c31\u662f\u4e00\u4e2a \u201c\u505a\u4e00\u4ef6\u7279\u522b\u4e8b\u60c5\u201d \u7684 CPU \u5417</p> <ul> <li>\u90a3\u4e48\u6211\u4eec\u8fd8\u53ef\u4ee5\u6709\u505a\u5404\u79cd\u4e8b\u60c5\u7684 \u201cCPU\u201d \u554a</li> </ul> <p>\u4f8b\u5982\uff0c\u663e\u793a\u56fe\u5f62</p> <pre><code>for (int i = 1; i &lt;= H; i++) {\n  for (int j = 1; j &lt;= W; j++)\n    putchar(j &lt;= i ? '*' : ' ');\n  putchar('\\n');\n}\n</code></pre> <p>\u96be\u529e\u7684\u662f\u6027\u80fd\uff1aNES: 6502 @ 1.79Mhz; IPC = 0.43</p> <ul> <li>\u5c4f\u5e55\u5171\u6709 256 x 240 = 61K \u50cf\u7d20 (256 \u8272)</li> <li>60FPS \u2192 \u6bcf\u4e00\u5e27\u5fc5\u987b\u5728 ~10K \u6761\u6307\u4ee4\u5185\u5b8c\u6210</li> <li>\u5982\u4f55\u5728\u6709\u9650\u7684 CPU \u8fd0\u7b97\u529b\u4e0b\u5b9e\u73b0 60Hz\uff1f</li> </ul>"},{"location":"courses/os_lab/26_input_output_device.html#nes-picture-processing-unit-ppu","title":"NES Picture Processing Unit (PPU)","text":"<p>\u5728\u53d7\u9650\u7684\u673a\u80fd\u4e0b\u63d0\u4f9b\u4e30\u5bcc\u7684\u56fe\u5f62</p> <p>CPU \u53ea\u63cf\u8ff0 8x8 \u201c\u8d34\u5757\u201d \u7684\u6446\u653e\u65b9\u6cd5</p> <ul> <li>\u80cc\u666f\u662f \u201c\u5927\u56fe\u201d \u7684\u4e00\u90e8\u5206</li> <li>\u6bcf\u884c\u7684\u524d\u666f\u5757\u4e0d\u8d85\u8fc7 8 \u4e2a</li> <li>PPU \u5b8c\u6210\u56fe\u5f62\u7684\u7ed8\u5236</li> <li>\u4e00\u4e2a\u5e76\u884c\u5ea6\u66f4\u9ad8\u7684 \u201cCPU\u201d</li> </ul> <pre><code>76543210\n||||||||\n||||||++- Palette\n|||+++--- Unimplemented        \n||+------ Priority\n|+------- Flip horizontally\n+-------- Flip vertically\n</code></pre> <p>\u80cc\u666f\uff1a\u201c\u5377\u8f74\u201d \u64cd\u4f5c</p> <p>\u7531\u4e8ePPU\u673a\u80fd\u9650\u5236\uff0cFC\u6bcf\u4e2a\u6c34\u5e73\u626b\u63cf\u884c\u53ea\u80fd\u663e\u793a8\u4e2a\u6d3b\u52a8\u5757\u3002</p> <ul> <li>\u524d\u666f\uff1a\u300a\u9b42\u6597\u7f57\u300b\uff08Contra\uff09\u4e2d\u89d2\u8272\u4e3a\u4ec0\u4e48\u8981\u300c\u841d\u8389\u5f0f\u5c48\u817f\u4fef\u5367\u300d\uff1f</li> </ul> <p></p>"},{"location":"courses/os_lab/26_input_output_device.html#2d","title":"\u66f4\u597d\u7684 2D \u6e38\u620f\u5f15\u64ce","text":"<p>\u5982\u679c\u6211\u4eec\u6709\u66f4\u591a\u7684\u6676\u4f53\u7ba1\uff1f</p> <ul> <li>NES PPU \u7684\u672c\u8d28\u662f\u548c\u5750\u6807\u8f74\u5e73\u884c\u7684 \u201c\u8d34\u5757\u5757\u201d</li> <li>\u5b9e\u73b0\u4e0a\u53ea\u9700\u8981\u52a0\u6cd5\u548c\u4f4d\u8fd0\u7b97</li> <li>\u66f4\u5f3a\u5927\u7684\u8ba1\u7b97\u80fd\u529b = \u66f4\u590d\u6742\u7684\u56fe\u5f62\u7ed8\u5236</li> </ul> <p>2D \u56fe\u5f62\u52a0\u901f\u786c\u4ef6\uff1a\u56fe\u7247\u7684 \u201c\u88c1\u526a\u201d + \u201c\u62fc\u8d34\u201d</p> <ul> <li>\u652f\u6301\u65cb\u8f6c\u3001\u6750\u8d28\u6620\u5c04 (\u7f29\u653e)\u3001\u540e\u5904\u7406\u3001\u2026\u2026</li> </ul> <p>\u5b9e\u73b0 3D\uff1a\u4e09\u7ef4\u7a7a\u95f4\u4e2d\u7684\u591a\u8fb9\u5f62\uff0c\u5728\u89c6\u5e73\u9762\u4e0a\u4e5f\u662f\u591a\u8fb9\u5f62</p> <ul> <li>Thm. \u4efb\u4f55 n \u8fb9\u5f62\u90fd\u53ef\u4ee5\u5206\u89e3\u6210 n\u22122 \u4e2a\u4e09\u89d2\u5f62</li> </ul>"},{"location":"courses/os_lab/26_input_output_device.html#3d","title":"\u4ee5\u5047\u4e71\u771f\u7684\u526a\u8d34 3D","text":"<p>GameBoy Advance</p> <ul> <li>4 \u5c42\u80cc\u666f; 128 \u4e2a\u526a\u8d34 objects; 32 \u4e2a affine objects</li> <li>CPU \u7ed9\u51fa\u63cf\u8ff0\uff1bGPU \u7ed8\u5236 (\u6267\u884c \u201c\u4e00\u4e2a\u7a0b\u5e8f\u201d \u7684 CPU)</li> </ul> <p></p>  (V-Rally; Game Boy Advance, 2002)"},{"location":"courses/os_lab/26_input_output_device.html#3d_1","title":"\u6211\u4eec\u8fd8\u662f\u9700\u8981\u771f\u6b63\u7684 3D","text":"<p>\u4e09\u7ef4\u7a7a\u95f4\u4e2d\u7684\u4e09\u89d2\u5f62\u9700\u8981\u6b63\u786e\u6e32\u67d3</p> <ul> <li>\u8fd9\u65f6\u5019\u5efa\u6a21\u7684\u4e1c\u897f\u5c31\u591a\u4e86</li> <li>\u51e0\u4f55\u3001\u6750\u8d28\u3001\u8d34\u56fe\u3001\u5149\u6e90\u3001\u2026\u2026</li> <li>Rendering pipeline \u91cc\u5927\u90e8\u5206\u64cd\u4f5c\u90fd\u662f massive parallel \u7684</li> </ul> <p></p> \u201cPerspective correct\u201d texture mapping (Wikipedia)"},{"location":"courses/os_lab/26_input_output_device.html#_6","title":"\u9898\u5916\u8bdd\uff1a\u5982\u6b64\u4e30\u5bcc\u7684\u56fe\u5f62\u662f\u600e\u4e48\u6765\u7684\uff1f","text":"<p>\u7b54\u6848\uff1a\u5168\u9760 PS (\u540e\u5904\u7406)</p> <p>\u4f8b\u5b50\uff1aGLSL (Shading Language)</p> <ul> <li>\u4f7f \u201cshader program\u201d \u53ef\u4ee5\u5728 GPU \u4e0a\u6267\u884c</li> <li>\u53ef\u4ee5\u4f5c\u7528\u5728\u5404\u4e2a\u6e32\u67d3\u7ea7\u522b\u4e0a\uff1avertex, fragment, pixel shader</li> <li>\u76f8\u5f53\u4e8e\u4e00\u4e2a \u201cPS\u201d \u7a0b\u5e8f\uff0c\u7b97\u51fa\u6bcf\u4e2a\u90e8\u5206\u7684\u5149\u7167\u53d8\u5316<ul> <li>\u5168\u5c40\u5149\u7167\u3001\u53cd\u5c04\u3001\u9634\u5f71\u3001\u73af\u5883\u5149\u906e\u7f69\u2026\u2026</li> </ul> </li> </ul> <p></p>"},{"location":"courses/os_lab/26_input_output_device.html#gpu_1","title":"\u73b0\u4ee3 GPU: \u4e00\u4e2a\u901a\u7528\u8ba1\u7b97\u8bbe\u5907","text":"<p>\u4e00\u4e2a\u5b8c\u6574\u7684\u4f17\u6838\u591a\u5904\u7406\u5668\u7cfb\u7edf</p> <ul> <li>\u6ce8\u91cd\u5927\u91cf\u5e76\u884c\u76f8\u4f3c\u7684\u4efb\u52a1</li> <li>\u7a0b\u5e8f\u4f7f\u7528\u4f8b\u5982 <code>OpenGL, CUDA, OpenCL, ...</code> \u4e66\u5199</li> <li>\u7a0b\u5e8f\u4fdd\u5b58\u5728\u5185\u5b58 (\u663e\u5b58) \u4e2d\uff1anvcc (LLVM) \u5206\u4e24\u4e2a\u90e8\u5206</li> <li>main \u7f16\u8bd1/\u94fe\u63a5\u6210\u672c\u5730\u53ef\u6267\u884c\u7684 ELF</li> <li>kernel \u7f16\u8bd1\u6210 GPU \u6307\u4ee4 (PTX; \u9001\u7ed9\u9a71\u52a8)</li> <li>\u652f\u6301\u77e9\u9635\u8fd0\u7b97 (Tensor Cores)</li> <li>\u6570\u636e\u4e5f\u4fdd\u5b58\u5728\u5185\u5b58 (\u663e\u5b58) \u4e2d</li> <li>\u53ef\u4ee5\u8f93\u51fa\u5230\u89c6\u9891\u63a5\u53e3 (DP, HDMI, ...)</li> <li>\u4e5f\u53ef\u4ee5\u901a\u8fc7 DMA \u4f20\u56de\u7cfb\u7edf\u5185\u5b58</li> </ul>"},{"location":"courses/os_lab/26_input_output_device.html#_7","title":"\u8bfe\u540e\u4e60\u9898/\u7f16\u7a0b\u4f5c\u4e1a","text":""},{"location":"courses/os_lab/26_input_output_device.html#1","title":"1. \u9605\u8bfb\u6750\u6599","text":"<p>\u6559\u79d1\u4e66 Operating Systems: Three Easy Pieces</p> <ul> <li>\u7b2c 36 \u7ae0 - I/O Devices</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html","title":"\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u4e0e\u6587\u4ef6\u7cfb\u7edf","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a\u5f88\u81ea\u7136\u7684\u95ee\u9898\u662f\uff0c\u5982\u679c\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u7a0b\u5e8f\u60f3\u8981\u8bbf\u95ee\u8bbe\u5907\uff0c\u5c31\u5fc5\u987b\u628a\u8bbe\u5907\u62bd\u8c61\u6210\u4e00\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u4f7f\u7528\u7cfb\u7edf\u8c03\u7528\u8bbf\u95ee\u7684\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u8c61\uff0c\u4e5f\u5c31\u662f\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u548c\u6587\u4ef6\u7cfb\u7edf\uff1a</p> <ul> <li>\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f</li> <li>\u6587\u4ef6\u7cfb\u7edf API</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_2","title":"\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f","text":""},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#io","title":"I/O \u8bbe\u5907\u7684\u62bd\u8c61","text":"<p>I/O \u8bbe\u5907\u6a21\u578b\uff1a\u4e00\u4e2a\u80fd\u4e0e CPU \u4ea4\u6362\u6570\u636e\u7684\u63a5\u53e3/\u63a7\u5236\u5668</p> <ul> <li>\u5bc4\u5b58\u5668\u88ab\u6620\u5c04\u5230\u5730\u5740\u7a7a\u95f4</li> </ul> <p></p> <p>\u64cd\u4f5c\u7cfb\u7edf\uff1a\u8bbe\u5907\u4e5f\u662f\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u5bf9\u8c61</p> <ul> <li>\u5982\u4f55 \u201c\u627e\u5230\u201d \u4e00\u4e2a\u5bf9\u8c61\uff1f</li> <li>\u5bf9\u8c61\u652f\u6301\u4ec0\u4e48\u64cd\u4f5c\uff1f</li> </ul> <p>I/O \u8bbe\u5907\u7684\u4e3b\u8981\u529f\u80fd\uff1a\u8f93\u5165\u548c\u8f93\u51fa</p> <ul> <li>\u201c\u80fd\u591f\u8bfb (read) \u5199 (write) \u7684\u5b57\u8282\u5e8f\u5217 (\u6d41\u6216\u6570\u7ec4)\u201d</li> <li>\u5e38\u89c1\u7684\u8bbe\u5907\u90fd\u6ee1\u8db3\u8fd9\u4e2a\u6a21\u578b</li> <li>\u7ec8\u7aef/\u4e32\u53e3 - \u5b57\u8282\u6d41</li> <li>\u6253\u5370\u673a - \u5b57\u8282\u6d41 (\u4f8b\u5982 PostScript \u6587\u4ef6)</li> <li>\u786c\u76d8 - \u5b57\u8282\u6570\u7ec4 (\u6309\u5757\u8bbf\u95ee)</li> <li>GPU - \u5b57\u8282\u6d41 (\u63a7\u5236) + \u5b57\u8282\u6570\u7ec4 (\u663e\u5b58)</li> </ul> <p>\u64cd\u4f5c\u7cfb\u7edf\uff1a\u8bbe\u5907 = \u652f\u6301\u5404\u7c7b\u64cd\u4f5c\u7684\u5bf9\u8c61 (\u6587\u4ef6)</p> <ul> <li>read - \u4ece\u8bbe\u5907\u67d0\u4e2a\u6307\u5b9a\u7684\u4f4d\u7f6e\u8bfb\u51fa\u6570\u636e</li> <li>write - \u5411\u8bbe\u5907\u67d0\u4e2a\u6307\u5b9a\u4f4d\u7f6e\u5199\u5165\u6570\u636e</li> <li>ioctl - \u8bfb\u53d6/\u8bbe\u7f6e\u8bbe\u5907\u7684\u72b6\u6001</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_3","title":"\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f","text":"<p>\u628a\u7cfb\u7edf\u8c03\u7528 (<code>read/write/ioctl/...</code>) \u201c\u7ffb\u8bd1\u201d \u6210\u4e0e\u8bbe\u5907\u5bc4\u5b58\u5668\u7684\u4ea4\u4e92</p> <ul> <li>\u5c31\u662f\u4e00\u6bb5\u666e\u901a\u7684\u5185\u6838\u4ee3\u7801</li> <li>\u4f46\u53ef\u80fd\u4f1a\u7761\u7720 (\u4f8b\u5982 P \u4fe1\u53f7\u91cf\uff0c\u7b49\u5f85\u4e2d\u65ad\u4e2d\u7684 V \u64cd\u4f5c\u5524\u9192)</li> </ul> <p>\u4f8b\u5b50\uff1a<code>/dev/</code> \u4e2d\u7684\u5bf9\u8c61</p> <ul> <li><code>/dev/pts/[x]</code> - pseudo terminal</li> <li><code>/dev/zero</code> - \u201c\u96f6\u201d \u8bbe\u5907\uff08\u8f93\u5165\u90fd\u662f0x00\uff09</li> <li><code>/dev/null</code> - \u201cnull\u201d \u8bbe\u5907\uff08\u8f93\u51fa\u9ed1\u6d1e\uff09</li> <li><code>/dev/random</code>\uff0c<code>/dev/urandom</code> - \u968f\u673a\u6570\u751f\u6210\u5668</li> <li>\u8bd5\u4e00\u8bd5\uff1a<code>head -c 512 [device] | xxd</code></li> <li>\u4ee5\u53ca\u89c2\u5bdf\u5b83\u4eec\u7684 strace\uff1a\u80fd\u770b\u5230\u8bbf\u95ee\u8bbe\u5907\u7684\u7cfb\u7edf\u8c03\u7528</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#lab-2","title":"\u4f8b\u5b50: Lab 2 \u8bbe\u5907\u9a71\u52a8","text":"<p>\u8bbe\u5907\u6a21\u578b</p> <ul> <li>\u7b80\u5316\u7684\u5047\u8bbe\uff1a\u8bbe\u5907\u4ece\u7cfb\u7edf\u542f\u52a8\u65f6\u5c31\u5b58\u5728\u4e14\u4e0d\u4f1a\u6d88\u5931</li> <li>\u652f\u6301\u8bfb/\u5199\u4e24\u79cd\u64cd\u4f5c\uff1a\u5728\u65e0\u6570\u636e\u6216\u6570\u636e\u672a\u5c31\u7eea\u65f6\u4f1a\u7b49\u5f85 (P \u64cd\u4f5c)</li> </ul> <pre><code>typedef struct devops {\n  int (*init)(device_t *dev);\n  int (*read) (device_t *dev, int offset, void *buf, int count);\n  int (*write)(device_t *dev, int offset, void *buf, int count);\n} devops_t;\n</code></pre> <p>I/O \u8bbe\u5907\u770b\u8d77\u6765\u662f\u4e2a \u201c\u9ed1\u76d2\u5b50\u201d</p> <ul> <li>\u5199\u9519\u4efb\u4f55\u4ee3\u7801\u5c31 simply \u201cnot work\u201d</li> <li>\u8bbe\u5907\u9a71\u52a8\uff1aLinux \u5185\u6838\u4e2d\u6700\u591a\u4e5f\u662f\u8d28\u91cf\u6700\u4f4e\u7684\u4ee3\u7801</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_4","title":"\u5b57\u8282\u6d41/\u5b57\u8282\u5e8f\u5217\u62bd\u8c61\u7684\u7f3a\u70b9","text":"<p>\u8bbe\u5907\u4e0d\u4ec5\u4ec5\u662f\u6570\u636e\uff0c\u8fd8\u6709\u63a7\u5236</p> <ul> <li>\u5c24\u5176\u662f\u8bbe\u5907\u7684\u9644\u52a0\u529f\u80fd\u548c\u914d\u7f6e</li> <li>\u6240\u6709\u989d\u5916\u529f\u80fd\u5168\u90e8\u4f9d\u8d56 ioctl</li> <li><code>Arguments, returns, and semantics of ioctl() vary according to the device driver in question</code></li> </ul> <p>\u4f8b\u5b50</p> <ul> <li>\u6253\u5370\u673a\u7684\u6253\u5370\u8d28\u91cf/\u8fdb\u7eb8/\u53cc\u9762\u63a7\u5236\u3001\u5361\u7eb8\u3001\u6e05\u6d01\u3001\u81ea\u52a8\u88c5\u8ba2\u2026\u2026</li> <li>\u4e00\u53f0\u51e0\u5341\u4e07\u7684\u6253\u5370\u673a\u53ef\u4e0d\u662f\u90a3\u4e48\u7b80\u5355 \ud83d\ude02</li> <li>\u952e\u76d8\u7684\u8dd1\u9a6c\u706f\u3001\u91cd\u590d\u901f\u5ea6\u3001\u5b8f\u7f16\u7a0b\u2026\u2026</li> <li>\u78c1\u76d8\u7684\u5065\u5eb7\u72b6\u51b5\u3001\u7f13\u5b58\u63a7\u5236\u2026\u2026</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_5","title":"\u4f8b\u5b50\uff1a\u7ec8\u7aef","text":"<p>\u201c\u5b57\u8282\u6d41\u201d \u4ee5\u5185\u7684\u529f\u80fd</p> <ul> <li>ANSI Escape Code</li> </ul> <p>\u201c\u5b57\u8282\u6d41\u201d \u4ee5\u5916\u7684\u529f\u80fd</p> <ul> <li><code>stty -a</code></li> <li>\u7ec8\u7aef\u5927\u5c0f\u600e\u4e48\u77e5\u9053\uff1f\u7ec8\u7aef\u5927\u5c0f\u53d8\u5316\u53c8\u600e\u4e48\u77e5\u9053\uff1f</li> <li><code>isatty (3), termios (3)</code></li> <li>\u5927\u90e8\u5206\u90fd\u662f ioctl \u5b9e\u73b0\u7684</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#linux","title":"Linux \u8bbe\u5907\u9a71\u52a8","text":""},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#nuclear-launcher","title":"Nuclear Launcher","text":"<p>\u5982\u4f55\u5728 Linux \u4e2d\u4e3a\u6211\u4eec\u7684 \u201c\u6838\u5f39\u53d1\u5c04\u5668\u201d \u7f16\u5199\u4e00\u4e2a\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\uff1f</p> <p></p> <p>\u5185\u6838\u6a21\u5757\uff1a\u4e00\u6bb5\u53ef\u4ee5\u88ab\u5185\u6838\u52a8\u6001\u52a0\u8f7d\u6267\u884c\u7684\u4ee3\u7801</p> <ul> <li>Everything is a file</li> <li>\u8bbe\u5907\u9a71\u52a8\u5c31\u662f\u5b9e\u73b0\u4e86<code>struct file_operations</code>\u7684\u5bf9\u8c61<ul> <li>\u628a\u6587\u4ef6\u64cd\u4f5c\u7ffb\u8bd1\u6210\u8bbe\u5907\u63a7\u5236\u534f\u8bae</li> <li>\u8c03\u7528\u5230\u8bbe\u5907\u5b9e\u73b0\u7684 <code>file_operations</code></li> </ul> </li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#file_operations","title":"file_operations","text":"<pre><code>struct file_operations {\n  struct module *owner;\n  loff_t (*llseek) (struct file *, loff_t, int);\n  ssize_t (*read) (struct file *, char __user *, size_t, loff_t *);\n  ssize_t (*write) (struct file *, const char __user *, size_t, loff_t *);\n  int (*mmap) (struct file *, struct vm_area_struct *);\n  unsigned long mmap_supported_flags;\n  int (*open) (struct inode *, struct file *);\n  int (*release) (struct inode *, struct file *);\n  int (*flush) (struct file *, fl_owner_t id);\n  int (*fsync) (struct file *, loff_t, loff_t, int datasync);\n  int (*lock) (struct file *, int, struct file_lock *);\n  ssize_t (*sendpage) (struct file *, struct page *, int, size_t, loff_t *, int);\n  long (*unlocked_ioctl) (struct file *, unsigned int, unsigned long);\n  long (*compat_ioctl) (struct file *, unsigned int, unsigned long);\n  int (*flock) (struct file *, int, struct file_lock *);\n  ...\n</code></pre> <p>\u4e3a\u4ec0\u4e48\u6709\u4e24\u4e2a ioctl?</p> <pre><code>long (*unlocked_ioctl) (struct file *, unsigned int, unsigned long);\nlong (*compat_ioctl) (struct file *, unsigned int, unsigned long);\n</code></pre> <ul> <li><code>unlocked_ioctl</code>: BKL (Big Kernel Lock) \u65f6\u4ee3\u7684\u9057\u4ea7</li> <li>\u5355\u5904\u7406\u5668\u65f6\u4ee3\u53ea\u6709 <code>ioctl</code></li> <li>\u4e4b\u540e\u5f15\u5165\u4e86 BKL, <code>ioctl</code> \u6267\u884c\u65f6\u9ed8\u8ba4\u6301\u6709 BKL</li> <li>(2.6.11) \u9ad8\u6027\u80fd\u7684\u9a71\u52a8\u53ef\u4ee5\u901a\u8fc7 <code>unlocked_ioctl</code> \u907f\u514d\u9501</li> <li>(2.6.36) <code>ioctl</code> \u4ece <code>struct file_operations</code> \u4e2d\u79fb\u9664</li> <li><code>compact_ioctl</code>: \u673a\u5668\u5b57\u957f\u7684\u517c\u5bb9\u6027</li> <li>32-bit \u7a0b\u5e8f\u5728 64-bit \u7cfb\u7edf\u4e0a\u53ef\u4ee5 ioctl</li> <li>\u6b64\u65f6\u5e94\u7528\u7a0b\u5e8f\u548c\u64cd\u4f5c\u7cfb\u7edf\u5bf9 ioctl \u6570\u636e\u7ed3\u6784\u7684\u89e3\u8bfb\u53ef\u80fd\u4e0d\u540c (tty)</li> <li>(\u8c03\u7528\u6b64\u517c\u5bb9\u6a21\u5f0f)</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_6","title":"\u5b58\u50a8\u8bbe\u5907\u7684\u62bd\u8c61","text":"<p>\u78c1\u76d8 (\u5b58\u50a8\u8bbe\u5907) \u7684\u8bbf\u95ee\u7279\u6027</p> <ol> <li>\u4ee5\u6570\u636e\u5757 (block) \u4e3a\u5355\u4f4d\u8bbf\u95ee</li> <li>\u4f20\u8f93\u6709 \u201c\u6700\u5c0f\u5355\u5143\u201d\uff0c\u4e0d\u652f\u6301\u4efb\u610f\u968f\u673a\u8bbf\u95ee</li> <li>\u6700\u4f73\u7684\u4f20\u8f93\u6a21\u5f0f\u4e0e\u8bbe\u5907\u76f8\u5173 (HDD v.s. SSD)</li> <li>\u5927\u541e\u5410\u91cf</li> <li>\u4f7f\u7528 DMA \u4f20\u9001\u6570\u636e</li> <li>\u5e94\u7528\u7a0b\u5e8f\u4e0d\u76f4\u63a5\u8bbf\u95ee</li> <li>\u8bbf\u95ee\u8005\u901a\u5e38\u662f\u6587\u4ef6\u7cfb\u7edf (\u7ef4\u62a4\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u7ed3\u6784)</li> <li>\u5927\u91cf\u5e76\u53d1\u7684\u8bbf\u95ee (\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u8fdb\u7a0b\u90fd\u8981\u8bbf\u95ee\u6587\u4ef6\u7cfb\u7edf)</li> </ol>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#linux-block-io-layer","title":"Linux Block I/O Layer","text":"<p>\u6587\u4ef6\u7cfb\u7edf\u548c\u78c1\u76d8\u8bbe\u5907\u4e4b\u95f4\u7684\u63a5\u53e3</p> <ul> <li><code>bread</code> (\u8bfb\u4e00\u5757), <code>bwrite</code>(\u5199\u4e00\u5757), <code>bflush</code> (\u7b49\u5f85\u8fc7\u5f80\u5199\u5165\u843d\u76d8)</li> </ul> <p></p>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_7","title":"\u5b58\u50a8\u8bbe\u5907\u7684\u865a\u62df\u5316","text":""},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_8","title":"\u6587\u4ef6\u7cfb\u7edf\uff1a\u5b9e\u73b0\u8bbe\u5907\u5728\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u7684\u5171\u4eab","text":"<p>\u78c1\u76d8\u4e2d\u5b58\u50a8\u7684\u6570\u636e</p> <ul> <li>\u7a0b\u5e8f\u6570\u636e</li> <li>\u53ef\u6267\u884c\u6587\u4ef6\u548c\u52a8\u6001\u94fe\u63a5\u5e93</li> <li>\u5e94\u7528\u6570\u636e (\u9ad8\u6e05\u56fe\u7247\u3001\u8fc7\u573a\u52a8\u753b\u30013D \u6a21\u578b\u2026\u2026)</li> <li>\u7528\u6237\u6570\u636e</li> <li>\u6587\u6863\u3001\u4e0b\u8f7d\u3001\u622a\u56fe</li> <li>\u7cfb\u7edf\u6570\u636e</li> <li>Manpages</li> <li>\u914d\u7f6e\u6587\u4ef6 (/etc)</li> </ul> <p>\u5b57\u8282\u5e8f\u5217\u5e76\u4e0d\u662f\u78c1\u76d8\u7684\u597d\u62bd\u8c61</p> <ul> <li>\u8ba9\u6240\u6709\u5e94\u7528\u5171\u4eab\u78c1\u76d8\uff1f\u4e00\u4e2a\u7a0b\u5e8f bug \u64cd\u4f5c\u7cfb\u7edf\u5c31\u6ca1\u4e86</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_9","title":"\u6587\u4ef6\u7cfb\u7edf\uff1a\u78c1\u76d8\u7684\u865a\u62df\u5316","text":"<p>\u6587\u4ef6\u7cfb\u7edf\uff1a\u8bbe\u8ba1\u76ee\u6807</p> <ol> <li>\u63d0\u4f9b\u5408\u7406\u7684 API \u4f7f\u591a\u4e2a\u5e94\u7528\u7a0b\u5e8f\u80fd\u5171\u4eab\u6570\u636e</li> <li>\u63d0\u4f9b\u4e00\u5b9a\u7684\u9694\u79bb\uff0c\u4f7f\u6076\u610f/\u51fa\u9519\u7a0b\u5e8f\u7684\u4f24\u5bb3\u4e0d\u80fd\u4efb\u610f\u6269\u5927</li> </ol> <p>\u201c\u5b58\u50a8\u8bbe\u5907 (\u5b57\u8282\u5e8f\u5217) \u7684\u865a\u62df\u5316\u201d</p> <ul> <li>\u78c1\u76d8 (I/O \u8bbe\u5907) = \u4e00\u4e2a\u53ef\u4ee5\u8bfb/\u5199\u7684\u5b57\u8282\u5e8f\u5217</li> <li>\u865a\u62df\u78c1\u76d8 (\u6587\u4ef6) = \u4e00\u4e2a\u53ef\u4ee5\u8bfb/\u5199\u7684\u52a8\u6001\u5b57\u8282\u5e8f\u5217</li> <li>\u547d\u540d\u7ba1\u7406\uff1a\u865a\u62df\u78c1\u76d8\u7684\u540d\u79f0\u3001\u68c0\u7d22\u548c\u904d\u5386</li> <li>\u6570\u636e\u7ba1\u7406\uff1a<code>std::vector&lt;char&gt;</code> (\u968f\u673a\u8bfb\u5199/resize)</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_10","title":"\u6587\u4ef6 = \u865a\u62df\u78c1\u76d8","text":"<p>\u6587\u4ef6\uff1a\u865a\u62df\u7684\u78c1\u76d8</p> <ul> <li>\u78c1\u76d8\u662f\u4e00\u4e2a \u201c\u5b57\u8282\u5e8f\u5217\u201d</li> <li>\u652f\u6301\u8bfb/\u5199\u64cd\u4f5c</li> </ul> <p>\u6587\u4ef6\u63cf\u8ff0\u7b26\uff1a\u8fdb\u7a0b\u8bbf\u95ee\u6587\u4ef6 (\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u8c61) \u7684 \u201c\u6307\u9488\u201d</p> <ul> <li>\u901a\u8fc7 <code>open/pipe</code> \u83b7\u5f97</li> <li>\u901a\u8fc7 <code>close</code> \u91ca\u653e</li> <li>\u901a\u8fc7 <code>dup/dup2</code> \u590d\u5236</li> <li><code>fork</code> \u65f6\u7ee7\u627f</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#mmap","title":"mmap \u548c\u6587\u4ef6","text":"<pre><code>void *mmap(\n  void *addr, size_t length, int prot, int flags,\n  int fd, off_t offset // \u6620\u5c04 fd \u6587\u4ef6\n); \n</code></pre> <p>\u6587\u4ef6\u662f \u201c\u865a\u62df\u78c1\u76d8\u201d</p> <ul> <li>\u628a\u78c1\u76d8\u7684\u4e00\u90e8\u5206\u6620\u5c04\u5230\u5730\u5740\u7a7a\u95f4\uff0c\u518d\u81ea\u7136\u4e0d\u8fc7\u4e86</li> </ul> <p>\u5c0f\u95ee\u9898\uff1a\u6620\u5c04\u7684\u957f\u5ea6\u8d85\u8fc7\u6587\u4ef6\u5927\u5c0f\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f</p> <ul> <li>(RTFM, \u201cErrors\u201d section):<code>SIGBUS</code>...</li> <li>bus error \u7684\u5e38\u89c1\u6765\u6e90 (M5)</li> <li>ftruncate \u53ef\u4ee5\u6539\u53d8\u6587\u4ef6\u5927\u5c0f</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_11","title":"\u6587\u4ef6\u8bbf\u95ee\u7684\u6e38\u6807 (\u504f\u79fb\u91cf)","text":"<p>\u6587\u4ef6\u7684\u8bfb\u5199\u81ea\u5e26 \u201c\u6e38\u6807\u201d\uff0c\u8fd9\u6837\u5c31\u4e0d\u7528\u6bcf\u6b21\u90fd\u6307\u5b9a\u6587\u4ef6\u8bfb/\u5199\u5230\u54ea\u91cc\u4e86</p> <ul> <li>\u65b9\u4fbf\u4e86\u7a0b\u5e8f\u5458\u987a\u5e8f\u8bbf\u95ee\u6587\u4ef6</li> </ul> <p>\u4f8b\u5b50</p> <ul> <li><code>read(fd, buf, 512);</code> - \u7b2c\u4e00\u4e2a 512 \u5b57\u8282</li> <li><code>read(fd, buf, 512);</code> - \u7b2c\u4e8c\u4e2a 512 \u5b57\u8282</li> <li><code>lseek(fd, -1, SEEK_END);</code> - \u6700\u540e\u4e00\u4e2a\u5b57\u8282</li> <li>so far, so good</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_12","title":"\u504f\u79fb\u91cf\u7ba1\u7406\uff1a\u6ca1\u90a3\u4e48\u7b80\u5355","text":"<p><code>mmap, lseek, ftruncate</code> \u4e92\u76f8\u4ea4\u4e92\u7684\u60c5\u51b5</p> <ul> <li>\u521d\u59cb\u65f6\u6587\u4ef6\u5927\u5c0f\u4e3a 0</li> <li>mmap (<code>length</code> = 2 MiB)</li> <li>lseek to 3 MiB (<code>SEEK_SET</code>)</li> <li>ftruncate to 1 MiB</li> </ul> <p>\u5728\u4efb\u4f55\u65f6\u523b\uff0c\u5199\u5165\u6570\u636e\u7684\u884c\u4e3a\u662f\u4ec0\u4e48\uff1f</p> <ul> <li>blog posts \u4e0d\u4f1a\u544a\u8bc9\u4f60\u5168\u90e8</li> <li>RTFM &amp; \u505a\u5b9e\u9a8c\uff01</li> </ul> <p>\u6587\u4ef6\u63cf\u8ff0\u7b26\u5728 fork \u65f6\u4f1a\u88ab\u5b50\u8fdb\u7a0b\u7ee7\u627f\u3002</p> <p>\u7236\u5b50\u8fdb\u7a0b\u5e94\u8be5\u5171\u7528\u504f\u79fb\u91cf\uff0c\u8fd8\u662f\u5e94\u8be5\u5404\u81ea\u6301\u6709\u504f\u79fb\u91cf\uff1f</p> <ul> <li>\u8fd9\u51b3\u5b9a\u4e86 <code>offset</code> \u5b58\u50a8\u5728\u54ea\u91cc</li> </ul> <p>\u8003\u8651\u5e94\u7528\u573a\u666f\uff1a\u7236\u5b50\u8fdb\u7a0b\u540c\u65f6\u5199\u5165\u6587\u4ef6</p> <ul> <li>\u5404\u81ea\u6301\u6709\u504f\u79fb\u91cf \u2192 \u7236\u5b50\u8fdb\u7a0b\u9700\u8981\u534f\u8c03\u504f\u79fb\u91cf\u7684\u7ade\u4e89</li> <li>(race condition)</li> <li>\u5171\u4eab\u504f\u79fb\u91cf \u2192 \u64cd\u4f5c\u7cfb\u7edf\u7ba1\u7406\u504f\u79fb\u91cf</li> <li>\u867d\u7136\u4ecd\u7136\u5171\u4eab\uff0c\u4f46\u64cd\u4f5c\u7cfb\u7edf\u4fdd\u8bc1 <code>write</code> \u7684\u539f\u5b50\u6027 \u2705</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_13","title":"\u504f\u79fb\u91cf\u7ba1\u7406\uff1a\u884c\u4e3a","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u7684\u6bcf\u4e00\u4e2a API \u90fd\u53ef\u80fd\u548c\u5176\u4ed6 API \u6709\u4ea4\u4e92 \ud83d\ude02</p> <ol> <li><code>open</code> \u65f6\uff0c\u83b7\u5f97\u4e00\u4e2a\u72ec\u7acb\u7684 offset</li> <li><code>dup</code> \u65f6\uff0c\u4e24\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u5171\u4eab offset</li> <li><code>fork</code> \u65f6\uff0c\u7236\u5b50\u8fdb\u7a0b\u5171\u4eab offset</li> <li><code>execve</code> \u65f6\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0d\u53d8</li> <li><code>O_APPEND</code>\u65b9\u5f0f\u6253\u5f00\u7684\u6587\u4ef6\uff0c\u504f\u79fb\u91cf\u6c38\u8fdc\u5728\u6700\u540e (\u65e0\u8bba\u662f\u5426 fork)</li> <li>modification of the file offset and the write operation are performed as a single atomic step</li> </ol> <p>\u8fd9\u4e5f\u662f fork \u88ab\u6279\u8bc4\u7684\u4e00\u4e2a\u539f\u56e0</p> <ul> <li>(\u5728\u5f53\u65f6) \u597d\u7684\u8bbe\u8ba1\u53ef\u80fd\u6210\u4e3a\u7cfb\u7edf\u6f14\u5316\u8fc7\u7a0b\u4e2d\u7684\u5305\u88b1</li> <li>\u4eca\u5929\u7684 fork \u53ef\u8c13\u662f \u201c\u8865\u4e01\u6ee1\u6ee1\u201d\uff1bA <code>fork()</code> in the road</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_14","title":"\u76ee\u5f55\u6811\u7ba1\u7406","text":""},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_15","title":"\u5229\u7528\u4fe1\u606f\u7684\u5c40\u90e8\u6027\u7ec4\u7ec7\u865a\u62df\u78c1\u76d8","text":"<p>\u4fe1\u606f\u7684\u5c40\u90e8\u6027\uff1a\u5c06\u865a\u62df\u78c1\u76d8 (\u6587\u4ef6) \u7ec4\u7ec7\u6210\u5c42\u6b21\u7ed3\u6784</p> <p>\u76ee\u5f55\u6811</p> <ul> <li>\u903b\u8f91\u76f8\u5173\u7684\u6570\u636e\u5b58\u653e\u5728\u76f8\u8fd1\u7684\u76ee\u5f55</li> </ul> <pre><code>.\n\u2514\u2500\u2500 \u5b66\u4e60\u8d44\u6599\n    \u251c\u2500\u2500 .\u5b66\u4e60\u8d44\u6599(\u9690\u85cf)\n    \u251c\u2500\u2500 \u95ee\u9898\u6c42\u89e31\n    \u251c\u2500\u2500 \u95ee\u9898\u6c42\u89e32\n    \u251c\u2500\u2500 \u95ee\u9898\u6c42\u89e33\n    \u251c\u2500\u2500 \u95ee\u9898\u6c42\u89e34\n    \u2514\u2500\u2500 \u64cd\u4f5c\u7cfb\u7edf\n</code></pre>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_16","title":"\u6587\u4ef6\u7cfb\u7edf\u7684 \u201c\u6839\u201d","text":"<p>\u6811\u603b\u5f97\u6709\u4e2a\u6839\u7ed3\u70b9</p> <ul> <li>Windows: \u6bcf\u4e2a\u8bbe\u5907(\u9a71\u52a8\u5668) \u662f\u4e00\u68f5\u6811</li> <li>C:\\ \u201cC \u76d8\u6839\u76ee\u5f55\u201d<ul> <li><code>C:\\Program Files\\</code>, <code>C:\\Windows</code>, <code>C:\\Users</code>, ...</li> </ul> </li> <li> <p>\u4f18\u76d8\u5206\u914d\u7ed9\u65b0\u7684\u76d8\u7b26</p> <ul> <li>\u4e3a\u4ec0\u4e48\u6ca1\u6709 <code>A:\\</code>, <code>B:\\</code>? =&gt; \u8f6f\u76d8</li> <li>\u7b80\u5355\u3001\u7c97\u66b4\u3001\u65b9\u4fbf\uff0c\u4f46 <code>game.iso</code> \u4e00\u5ea6\u975e\u5e38\u9ebb\u70e6\u2026\u2026</li> </ul> </li> <li> <p>UNIX/Linux</p> </li> <li>\u53ea\u6709\u4e00\u4e2a\u6839 / <ul> <li>\u7b2c\u4e8c\u4e2a\u8bbe\u5907\u5462\uff1f</li> <li>\u4f18\u76d8\u5462\uff1f\uff1f\uff1f</li> </ul> </li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_17","title":"\u76ee\u5f55\u6811\u7684\u62fc\u63a5","text":"<p>UNIX: \u5141\u8bb8\u4efb\u610f\u76ee\u5f55 \u201c\u6302\u8f7d (mount)\u201d \u4e00\u4e2a\u8bbe\u5907\u4ee3\u8868\u7684\u76ee\u5f55\u6811</p> <ul> <li>\u975e\u5e38\u7075\u6d3b\u7684\u8bbe\u8ba1</li> <li>\u53ef\u4ee5\u628a\u8bbe\u5907\u6302\u8f7d\u5230\u4efb\u4f55\u60f3\u8981\u7684\u4f4d\u7f6e</li> <li>Linux \u5b89\u88c5\u65f6\u7684 \u201cmount point\u201d<ul> <li><code>/</code>, <code>/home</code>, <code>/var</code> \u53ef\u4ee5\u662f\u72ec\u7acb\u7684\u78c1\u76d8\u8bbe\u5907</li> </ul> </li> </ul> <p>mount \u7cfb\u7edf\u8c03\u7528</p> <pre><code>int mount(const char *source, const char *target,\n          const char *filesystemtype, unsigned long mountflags,\n          const void *data);\n</code></pre> <ul> <li><code>mount /dev/sdb /mnt</code>(RTFM)</li> <li>Linux mount \u5de5\u5177\u80fd\u81ea\u52a8\u68c0\u6d4b\u6587\u4ef6\u7cfb\u7edf (busybox \u4e0d\u80fd)</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#linux_1","title":"\u771f\u6b63\u7684 Linux \u542f\u52a8\u6d41\u7a0b","text":"<p>Linux-minimal \u8fd0\u884c\u5728 \u201cinitramfs\u201d \u6a21\u5f0f</p> <ul> <li>Initial RAM file system</li> <li>\u5b8c\u6574\u7684\u6587\u4ef6\u7cfb\u7edf</li> <li>\u53ef\u4ee5\u5305\u542b\u8bbe\u5907\u9a71\u52a8\u7b49\u4efb\u4f55\u6587\u4ef6</li> <li>\u4f46\u4e0d\u5177\u6709 \u201c\u6301\u4e45\u5316\u201d \u7684\u80fd\u529b</li> </ul> <p>\u6700\u5c0f \u201c\u771f\u6b63\u201d Linux \u7684\u542f\u52a8\u6d41\u7a0b</p> <pre><code>export PATH=/bin\nbusybox mknod /dev/sda b 8 0\nbusybox mkdir -p /newroot\nbusybox mount -t ext2 /dev/sda /newroot\nexec busybox switch_root /newroot/ /etc/init\n</code></pre> <p>\u901a\u8fc7 <code>pivot_root</code> (2) \u5b9e\u73b0\u6839\u6587\u4ef6\u7cfb\u7edf\u7684\u5207\u6362</p>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_18","title":"\u6587\u4ef6\u7684\u6302\u8f7d","text":"<p>\u6587\u4ef6\u7684\u6302\u8f7d\u5f15\u5165\u4e86\u4e00\u4e2a\u5fae\u5999\u7684\u5faa\u73af</p> <ul> <li>\u6587\u4ef6 = \u78c1\u76d8\u4e0a\u7684\u865a\u62df\u78c1\u76d8</li> <li>\u6302\u8f7d\u6587\u4ef6 = \u5728\u865a\u62df\u78c1\u76d8\u4e0a\u865a\u62df\u51fa\u7684\u865a\u62df\u78c1\u76d8</li> </ul> <p>Linux \u7684\u5904\u7406\u65b9\u5f0f</p> <ul> <li>\u521b\u5efa\u4e00\u4e2a loopback (\u56de\u73af) \u8bbe\u5907</li> <li>\u8bbe\u5907\u9a71\u52a8\u628a\u8bbe\u5907\u7684 <code>read/write</code> \u7ffb\u8bd1\u6210\u6587\u4ef6\u7684 <code>read/write</code></li> <li>\u89c2\u5bdf disk-img.tar.gz \u7684\u6302\u8f7d</li> <li><code>lsblk</code> \u67e5\u770b\u7cfb\u7edf\u4e2d\u7684 block devices (strace)</li> <li><code>strace</code> \u89c2\u5bdf\u6302\u8f7d\u7684\u6d41\u7a0b<ul> <li><code>ioctl(3, LOOP_CTL_GET_FREE)</code></li> <li><code>ioctl(4, LOOP_SET_FD, 3)</code></li> </ul> </li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#filesystem-hierarchy-standard-fhs","title":"Filesystem Hierarchy Standard (FHS)","text":"<p>FHS enables software and user to predict the location of installed files and directories.</p> <p>\u4f8b\u5b50\uff1amacOS \u662f UNIX \u7684\u5185\u6838 (BSD), \u4f46\u4e0d\u9075\u5faa Linux FHS\u3002</p>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_19","title":"\u76ee\u5f55\u7ba1\u7406\uff1a\u521b\u5efa/\u5220\u9664/\u904d\u5386","text":"<ul> <li><code>mkdir</code>\uff1a\u521b\u5efa\u4e00\u4e2a\u76ee\u5f55</li> <li>\u53ef\u4ee5\u8bbe\u7f6e\u8bbf\u95ee\u6743\u9650</li> <li><code>rmdir</code>\uff1a\u5220\u9664\u4e00\u4e2a\u7a7a\u76ee\u5f55</li> <li>\u6ca1\u6709 \u201c\u9012\u5f52\u5220\u9664\u201d \u7684\u7cfb\u7edf\u8c03\u7528<ul> <li>(\u5e94\u7528\u5c42\u80fd\u5b9e\u73b0\u7684\uff0c\u5c31\u4e0d\u8981\u5728\u64cd\u4f5c\u7cfb\u7edf\u5c42\u5b9e\u73b0)</li> <li><code>rm -rf</code> \u4f1a\u904d\u5386\u76ee\u5f55\uff0c\u9010\u4e2a\u5220\u9664 (\u8bd5\u8bd5 strace)</li> </ul> </li> <li><code>getdents</code>\uff1a\u8fd4\u56de count \u4e2a\u76ee\u5f55\u9879 (ls, find, tree \u90fd\u4f7f\u7528\u8fd9\u4e2a)</li> <li>\u4ee5\u70b9\u5f00\u5934\u7684\u76ee\u5f55\u4f1a\u88ab\u7cfb\u7edf\u8c03\u7528\u8fd4\u56de\uff0c\u53ea\u662f ls \u6ca1\u6709\u663e\u793a</li> </ul> <p>\u5408\u9002\u7684 API + \u5408\u9002\u7684\u7f16\u7a0b\u8bed\u8a00</p> <ul> <li>Globbing</li> </ul> <pre><code>from pathlib import Path\n\nfor f in Path('/proc').glob('*/status'):\n    print(f.parts[-2], \\\n        (f.parent / 'cmdline').read_text() or '[kernel]')\n</code></pre>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#hard","title":"\u786c (hard) \u94fe\u63a5","text":"<p>\u9700\u6c42\uff1a\u7cfb\u7edf\u4e2d\u53ef\u80fd\u6709\u540c\u4e00\u4e2a\u8fd0\u884c\u5e93\u7684\u591a\u4e2a\u7248\u672c</p> <ul> <li><code>libc-2.27.so</code>, <code>libc-2.26.so</code>, ...</li> <li>\u8fd8\u9700\u8981\u4e00\u4e2a \u201c\u5f53\u524d\u7248\u672c\u7684 libc\u201d</li> <li>\u7a0b\u5e8f\u9700\u8981\u94fe\u63a5 \u201c<code>libc.so.6</code>\u201d\uff0c\u80fd\u5426\u907f\u514d\u6587\u4ef6\u7684\u4e00\u4efd\u62f7\u8d1d\uff1f</li> </ul> <p>\u786c\u8fde\u63a5\uff1a\u5141\u8bb8\u4e00\u4e2a\u6587\u4ef6\u88ab\u591a\u4e2a\u76ee\u5f55\u5f15\u7528</p> <ul> <li>\u76ee\u5f55\u4e2d\u4ec5\u5b58\u50a8\u6307\u5411\u6587\u4ef6\u6570\u636e\u7684\u6307\u9488</li> <li>\u94fe\u63a5\u76ee\u5f55 \u274c</li> <li>\u8de8\u6587\u4ef6\u7cfb\u7edf \u274c</li> </ul> <p>\u5927\u90e8\u5206 UNIX \u6587\u4ef6\u7cfb\u7edf\u6240\u6709\u6587\u4ef6\u90fd\u662f\u786c\u8fde\u63a5 (<code>ls -i</code> \u67e5\u770b)</p> <ul> <li>\u5220\u9664\u7684\u7cfb\u7edf\u8c03\u7528\u79f0\u4e3a \u201cunlink\u201d (\u5f15\u7528\u8ba1\u6570)</li> </ul>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#symbolic","title":"\u8f6f (symbolic) \u94fe\u63a5","text":"<p>\u8f6f\u94fe\u63a5\uff1a\u5728\u6587\u4ef6\u91cc\u5b58\u50a8\u4e00\u4e2a \u201c\u8df3\u8f6c\u63d0\u793a\u201d</p> <ul> <li>\u8f6f\u94fe\u63a5\u4e5f\u662f\u4e00\u4e2a\u6587\u4ef6</li> <li>\u5f53\u5f15\u7528\u8fd9\u4e2a\u6587\u4ef6\u65f6\uff0c\u53bb\u627e\u53e6\u4e00\u4e2a\u6587\u4ef6</li> <li>\u53e6\u4e00\u4e2a\u6587\u4ef6\u7684\u7edd\u5bf9/\u76f8\u5bf9\u8def\u5f84\u4ee5\u6587\u672c\u5f62\u5f0f\u5b58\u50a8\u5728\u6587\u4ef6\u91cc</li> <li>\u53ef\u4ee5\u8de8\u6587\u4ef6\u7cfb\u7edf\u3001\u53ef\u4ee5\u94fe\u63a5\u76ee\u5f55\u3001\u2026\u2026</li> <li>\u7c7b\u4f3c \u201c\u5feb\u6377\u65b9\u5f0f\u201d</li> <li>\u94fe\u63a5\u6307\u5411\u7684\u4f4d\u7f6e\u5f53\u524d\u4e0d\u5b58\u5728\u4e5f\u6ca1\u5173\u7cfb</li> <li><code>~/usb</code> \u2192 <code>/media/jyy-usb</code></li> <li><code>~/Desktop</code> \u2192 <code>/mnt/c/Users/jyy/Desktop</code> (WSL)</li> </ul> <p><code>ln -s</code> \u521b\u5efa\u8f6f\u94fe\u63a5\uff1a<code>symlink</code> \u7cfb\u7edf\u8c03\u7528</p>"},{"location":"courses/os_lab/27_device_driver_and_filesystem.html#_20","title":"\u8f6f\u94fe\u63a5\u5e26\u6765\u7684\u9ebb\u70e6","text":"<p>\u201c\u4efb\u610f\u94fe\u63a5\u201d \u5141\u8bb8\u521b\u5efa\u4efb\u610f\u6709\u5411\u56fe</p> <ul> <li>\u5141\u8bb8\u591a\u6b21\u95f4\u63a5\u94fe\u63a5</li> <li>a \u2192 b \u2192 c (\u9012\u5f52\u89e3\u6790)</li> <li>\u53ef\u4ee5\u521b\u5efa\u8f6f\u8fde\u63a5\u7684\u786c\u94fe\u63a5 (\u56e0\u4e3a\u8f6f\u94fe\u63a5\u4e5f\u662f\u6587\u4ef6)</li> <li><code>ls -i</code> \u53ef\u4ee5\u770b\u5230</li> <li>\u5141\u8bb8\u6210\u73af</li> <li><code>find -L A | tr -d '/'</code></li> <li>\u53ef\u4ee5\u505a\u6210\u4e00\u4e2a \u201c\u8ff7\u5bab\u6e38\u620f\u201d<ul> <li>ssh \u8fdb\u5165\u6e38\u620f\uff0c\u8fdb\u5165\u540d\u4e3a end \u7684\u76ee\u5f55\u80dc\u5229</li> <li>\u53ea\u5141\u8bb8 ls (-i), cd, pwd</li> </ul> </li> <li>\u6240\u6709\u5904\u7406\u7b26\u53f7\u94fe\u63a5\u7684\u7a0b\u5e8f (tree, find, ...) \u90fd\u8981\u8003\u8651\u9012\u5f52\u7684\u60c5\u51b5</li> </ul>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html","title":"FAT \u548c UNIX \u6587\u4ef6\u7cfb\u7edf","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a</p> <ul> <li>\u6587\u4ef6\u7cfb\u7edf\u5b9e\u73b0\u5206\u6790</li> <li>FAT \u6587\u4ef6\u7cfb\u7edf</li> <li>UNIX \u6587\u4ef6\u7cfb\u7edf</li> </ul>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#_1","title":"\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u7ed3\u6784","text":""},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#_2","title":"\u6587\u4ef6\u7cfb\u7edf\u5b9e\u73b0","text":"<p>\u6587\u4ef6\u7684\u5b9e\u73b0</p> <ul> <li>\u6587\u4ef6 = \u201c\u865a\u62df\u201d \u78c1\u76d8</li> <li><code>API: read, write, ftruncate, ...</code></li> </ul> <p>\u76ee\u5f55\u7684\u5b9e\u73b0</p> <ul> <li>\u76ee\u5f55 = \u6587\u4ef6/\u76ee\u5f55\u7684\u96c6\u5408</li> <li><code>API: mkdir, rmdir, readdir, link, unlink, ...</code></li> </ul> <p>\u601d\u8003\u9898\uff1a<code>mount</code> \u5982\u4f55\u5b9e\u73b0\uff1f</p> <ul> <li>\u6700\u597d\u7531\u64cd\u4f5c\u7cfb\u7edf\u7edf\u4e00\u7ba1\u7406 (\u800c\u4e0d\u662f\u7531\u5177\u4f53\u7684\u6587\u4ef6\u7cfb\u7edf\u5b9e\u73b0)</li> </ul>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#_3","title":"\u5982\u679c\u662f\u300a\u6570\u636e\u7ed3\u6784\u300b\u8bfe\uff1f","text":"<p>\u501f\u52a9 RAM (Random Access Memory) \u81ea\u7531\u5e03\u5c40\u76ee\u5f55\u548c\u6587\u4ef6</p> <ul> <li><code>FileSystem</code> \u5c31\u662f\u4e00\u4e2a <code>Abstract DataType (ADT)</code></li> <li><code>Memory Hierarchy</code> \u5728\u82e6\u82e6\u652f\u6491 \u201crandom access\u201d \u7684\u5047\u8c61</li> </ul> <pre><code>class FSObject {\n};\n\nclass File: FSObject {\n  std::vector&lt;char&gt; content;\n};\n\nclass Directory: FSObject {\n  std::map&lt;std::string,FSObject*&gt; children;\n};\n</code></pre> <ul> <li>\u5b9e\u73b0\u4e0a\u9762\u7684 API \u5b8c\u5168\u5c31\u662f\u4e2a\u8bfe\u540e\u4e60\u9898</li> </ul>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#_4","title":"\u56de\u5230\u300a\u64cd\u4f5c\u7cfb\u7edf\u300b\u8bfe","text":"<p>\u6ca1\u6709 Random Access Memory</p> <ul> <li>\u53ea\u6709 block device \u548c\u4e24\u4e2a API\uff08\u88ab\u8feb\u8bfb\u5199\u8fde\u7eed\u7684\u4e00\u5757\u6570\u636e\uff09</li> <li><code>bread(int bid, struct block *b);</code></li> <li><code>bwrite(int bid, struct block *b);</code></li> </ul> <p>\u5982\u679c\u7528 block device \u6a21\u62df RAM\uff0c\u5c31\u4f1a\u51fa\u73b0\u4e25\u91cd\u7684\u8bfb/\u5199\u653e\u5927</p> <ul> <li>\u6211\u4eec\u9700\u8981\u66f4\u9002\u5408\u78c1\u76d8\u7684\u6570\u636e\u7ed3\u6784\u5b9e\u73b0 <code>read</code>, <code>write</code>, <code>ftruncate</code>, ...</li> </ul>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#file-allocation-table-fat","title":"File Allocation Table (FAT)","text":""},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#1980","title":"\u8ba9\u65f6\u95f4\u56de\u5230 1980 \u5e74","text":"<p>5.25\" \u8f6f\u76d8\uff1a\u5355\u9762 180 KiB</p> <ul> <li>360 \u4e2a 512B \u6247\u533a (sectors)</li> <li>\u5728\u8fd9\u6837\u7684\u8bbe\u5907\u4e0a\u5b9e\u73b0\u6587\u4ef6\u7cfb\u7edf\uff0c\u5e94\u8be5\u9009\u7528\u600e\u6837\u7684\u6570\u636e\u7ed3\u6784\uff1f</li> </ul> <p></p>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#_5","title":"\u9700\u6c42\u5206\u6790","text":"<p>\u76f8\u5f53\u5c0f\u7684\u6587\u4ef6\u7cfb\u7edf</p> <ul> <li>\u76ee\u5f55\u4e2d\u4e00\u822c\u53ea\u6709\u51e0\u4e2a\u3001\u5341\u51e0\u4e2a\u6587\u4ef6</li> <li>\u6587\u4ef6\u4ee5\u5c0f\u6587\u4ef6\u4e3a\u4e3b (\u51e0\u4e2a block \u4ee5\u5185)</li> </ul> <p>\u6587\u4ef6\u7684\u5b9e\u73b0\u65b9\u5f0f</p> <ul> <li><code>struct block *</code>\u7684\u94fe\u8868</li> <li>\u4efb\u4f55\u590d\u6742\u7684\u9ad8\u7ea7\u6570\u636e\u7ed3\u6784\u90fd\u663e\u5f97\u6d6a\u8d39</li> </ul> <p>\u76ee\u5f55\u7684\u5b9e\u73b0\u65b9\u5f0f</p> <ul> <li>\u76ee\u5f55\u5c31\u662f\u4e00\u4e2a\u666e\u901a\u7684\u6587\u4ef6 (\u865a\u62df\u78c1\u76d8\uff1b\u201c\u76ee\u5f55\u6587\u4ef6\u201d)</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5bf9\u6587\u4ef6\u7684\u5185\u5bb9\u4f5c\u4e3a\u76ee\u5f55\u7684\u89e3\u8bfb</li> <li>\u6587\u4ef6\u5185\u5bb9\u5c31\u662f\u4e00\u4e2a <code>struct dentry[];</code></li> </ul>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#_6","title":"\u7528\u94fe\u8868\u5b58\u50a8\u6570\u636e\uff1a\u4e24\u79cd\u8bbe\u8ba1","text":"<p>\u5728\u6bcf\u4e2a\u6570\u636e\u5757\u540e\u653e\u7f6e\u6307\u9488</p> <ul> <li>\u4f18\u70b9\uff1a\u5b9e\u73b0\u7b80\u5355\u3001\u65e0\u987b\u5355\u72ec\u5f00\u8f9f\u5b58\u50a8\u7a7a\u95f4</li> <li>\u7f3a\u70b9\uff1a\u6570\u636e\u7684\u5927\u5c0f\u4e0d\u662f \\(2^k\\); \u5355\u7eaf\u7684 <code>lseek</code> \u9700\u8981\u8bfb\u6574\u5757\u6570\u636e</li> </ul> <p>\u5c06\u6307\u9488\u96c6\u4e2d\u5b58\u653e\u5728\u6587\u4ef6\u7cfb\u7edf\u7684\u67d0\u4e2a\u533a\u57df</p> <ul> <li>\u4f18\u70b9\uff1a\u5c40\u90e8\u6027\u597d\uff1blseek \u66f4\u5feb</li> <li>\u7f3a\u70b9\uff1a\u96c6\u4e2d\u5b58\u653e\u7684\u6570\u636e\u635f\u574f\u5c06\u5bfc\u81f4\u6570\u636e\u4e22\u5931</li> </ul>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#_7","title":"\u96c6\u4e2d\u4fdd\u5b58\u6240\u6709\u6307\u9488","text":"<p>\u96c6\u4e2d\u5b58\u50a8\u7684\u6307\u9488\u5bb9\u6613\u635f\u574f\uff1f\u5b58n \u4efd\u5c31\u884c\uff01</p> <ul> <li>FAT-12/16/32 (FAT entry\uff0c\u5373 \u201cnext \u6307\u9488\u201d \u7684\u5927\u5c0f)</li> </ul> <p></p>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#fat","title":"FAT\u6587\u4ef6\u7cfb\u7edf","text":"<p>RTFM \u5f97\u5230\u5fc5\u8981\u7684\u7ec6\u8282</p> <ul> <li>\u8bf8\u5982 tutorial\u3001\u535a\u5ba2\u90fd\u4e0d\u53ef\u9760\uff0c\u8fd8\u4f1a\u4e22\u5931\u5f88\u591a\u91cd\u8981\u7684\u7ec6\u8282</li> </ul> <pre><code>if (CountofClusters &lt; 4085) {\n  // Volume is FAT12 (2 MiB for 512B cluster)\n} else if (CountofCluster &lt; 65525) {\n  // Volume is FAT16 (32 MiB for 512B cluster)\n} else {\n  // Volume is FAT32\n}\n</code></pre>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#fat_1","title":"FAT: \u94fe\u63a5\u5b58\u50a8\u7684\u6587\u4ef6","text":"<p>\u201cFAT\u201d \u7684 \u201cnext\u201d \u6570\u7ec4</p> <ul> <li><code>0</code>: free; <code>2...MAX</code>: allocated;</li> <li><code>ffffff7</code>: bad cluster; <code>ffffff8-ffffffe</code>, <code>-1</code>: end-of-file</li> </ul> <p></p>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#_8","title":"\u76ee\u5f55\u6811\u5b9e\u73b0\uff1a\u76ee\u5f55\u6587\u4ef6","text":"<p>\u4ee5\u666e\u901a\u6587\u4ef6\u7684\u65b9\u5f0f\u5b58\u50a8 \u201c\u76ee\u5f55\u201d \u8fd9\u4e2a\u6570\u636e\u7ed3\u6784</p> <ul> <li>FAT: \u76ee\u5f55 = 32-byte \u5b9a\u957f\u76ee\u5f55\u9879\u7684\u96c6\u5408</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u5728\u89e3\u6790\u65f6\u628a\u6807\u8bb0\u4e3a\u76ee\u5f55\u7684\u76ee\u5f55\u9879 \u201c\u5f53\u505a\u201d \u76ee\u5f55\u5373\u53ef</li> <li>\u53ef\u4ee5\u7528\u8fde\u7eed\u7684\u82e5\u5e72\u4e2a\u76ee\u5f55\u9879\u5b58\u50a8 \u201c\u957f\u6587\u4ef6\u540d\u201d</li> <li>\u601d\u8003\u9898\uff1a\u4e3a\u4ec0\u4e48\u4e0d\u628a\u5143\u6570\u636e (\u5927\u5c0f\u3001\u6587\u4ef6\u540d\u3001\u2026\u2026) \u4fdd\u5b58\u5728 <code>vector&lt;struct block *&gt; file</code> \u7684\u5934\u90e8\uff1f</li> </ul>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#talk-is-cheap-show-me-the-code","title":"Talk is Cheap, Show Me the Code!","text":"<p>\u9996\u5148\uff0c\u89c2\u5bdf \u201c\u5feb\u901f\u683c\u5f0f\u5316\u201d (<code>/usr/sbin/mkfs.fat</code>) \u662f\u5982\u4f55\u5de5\u4f5c\u7684</p> <ul> <li>\u8001\u670b\u53cb\uff1astrace</li> </ul> <p>\u7136\u540e\uff0c\u628a\u6574\u4e2a\u78c1\u76d8\u955c\u50cf mmap \u8fdb\u5185\u5b58</p> <ul> <li>\u7167\u6284\u624b\u518c\uff0c\u904d\u5386\u76ee\u5f55\u6811 (fat-tree demo)\uff0c\u8bd5\u8bd5\u955c\u50cf</li> </ul> <p>\u53e6\u4e00\u4e2a\u6709\u8da3\u7684\u95ee\u9898\uff1a\u6587\u4ef6\u7cfb\u7edf\u6062\u590d</p> <ul> <li>\u5feb\u901f\u683c\u5f0f\u5316 = FAT \u8868\u4e22\u5931</li> <li>\u6240\u6709\u7684\u6587\u4ef6\u5185\u5bb9 (\u5305\u62ec\u76ee\u5f55\u6587\u4ef6) \u90fd\u8fd8\u5728</li> <li>\u53ea\u662f\u5728\u6570\u636e\u7ed3\u6784\u773c\u91cc\u770b\u8d77\u6765\u90fd\u662f \u201cfree block\u201d</li> <li>\u9996\u5148\u9700\u8981\u731c\u51fa\u6587\u4ef6\u7cfb\u7edf\u7684\u53c2\u6570 (<code>SecPerClus</code>, <code>BytsPerSec</code>, <code>FATSz32</code>, <code>BPB_RootClus</code>, ...)</li> <li>\u672c\u8d28\u4e0a\u662f cluster \u7684\u5206\u7c7b\u548c\u5efa\u7acb \u201c\u53ef\u80fd\u540e\u7ee7\u5173\u7cfb\u201d</li> </ul>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#fat_2","title":"FAT: \u6027\u80fd\u4e0e\u53ef\u9760\u6027","text":"<p>\u6027\u80fd</p> <ul> <li>\u4f18\u70b9\uff1a\u5c0f\u6587\u4ef6\u7b80\u76f4\u592a\u5408\u9002\u4e86</li> <li>\u7f3a\u70b9\uff1a\u4f46\u5927\u6587\u4ef6\u7684\u968f\u673a\u8bbf\u95ee\u5c31\u4e0d\u884c\u4e86</li> <li>4 GB \u7684\u6587\u4ef6\u8df3\u5230\u672b\u5c3e (4 KB cluster) \u6709 220220 \u6b21\u94fe\u8868 next \u64cd\u4f5c</li> <li>\u7f13\u5b58\u80fd\u90e8\u5206\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898</li> <li>\u5728 FAT \u65f6\u4ee3\uff0c\u78c1\u76d8\u8fde\u7eed\u8bbf\u95ee\u6027\u80fd\u66f4\u4f73</li> <li>\u4f7f\u7528\u65f6\u95f4\u4e45\u7684\u78c1\u76d8\u4f1a\u4ea7\u751f\u788e\u7247 (fragmentation)</li> <li>malloc \u4e5f\u4f1a\u4ea7\u751f\u788e\u7247\uff0c\u4e0d\u8fc7\u5bf9\u6027\u80fd\u5f71\u54cd\u4e0d\u592a\u5927</li> </ul> <p>\u53ef\u9760\u6027</p> <ul> <li>\u7ef4\u62a4\u82e5\u5e72\u4e2a FAT \u7684\u526f\u672c\u9632\u6b62\u5143\u6570\u636e\u635f\u574f (\u989d\u5916\u7684\u5f00\u9500)</li> <li>\u635f\u574f\u7684 cluster \u5728 FAT \u4e2d\u6807\u8bb0</li> </ul>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#ext2unix","title":"ext2/UNIX \u6587\u4ef6\u7cfb\u7edf","text":""},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#_9","title":"\u66f4\u597d\u7684\u6587\u4ef6\u7cfb\u7edf\uff1a\u9700\u8981\u505a\u5230\u4ec0\u4e48\uff1f","text":"<p>\u4e0d\u80fd \u201c\u5c3d\u5584\u5c3d\u7f8e\u201d\uff0c\u4f46\u53ef\u4ee5\u5728 \u201c\u5b9e\u9645 workload\u201d \u4e0b\u5c3d\u53ef\u80fd\u597d</p> Summary Findings Most files are small Roughly 2K is the most common size Average file size is growing Almost 200K is the average Most bytes are stored in large files A few big files use most of the space File systems contains lots of files Almost 100K on average File systems are roughly half full Even as disks grow, file systems remain ~50% full Directories are typically small Many have few entries; most have 20 or fewer"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#ext2unix_1","title":"ext2/UNIX \u6587\u4ef6\u7cfb\u7edf","text":"<p>\u6309\u5bf9\u8c61\u65b9\u5f0f\u96c6\u4e2d\u5b58\u50a8\u6587\u4ef6/\u76ee\u5f55\u5143\u6570\u636e</p> <ul> <li>\u589e\u5f3a\u5c40\u90e8\u6027 (\u66f4\u6613\u4e8e\u7f13\u5b58)</li> <li>\u652f\u6301\u94fe\u63a5</li> </ul> <p>\u4e3a\u5927\u5c0f\u6587\u4ef6\u533a\u5206 fast/slow path</p> <ul> <li>\u5c0f\u7684\u65f6\u5019\u5e94\u8be5\u7528\u6570\u7ec4\uff1a\u8fde\u94fe\u8868\u904d\u5386\u90fd\u7701\u4e86</li> <li>\u5927\u7684\u65f6\u5019\u5e94\u8be5\u7528\u6811 (B-Tree; Radix-Tree; ...)\uff1a\u5feb\u901f\u7684\u968f\u673a\u8bbf\u95ee</li> </ul>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#ext2","title":"ext2: \u78c1\u76d8\u955c\u50cf\u683c\u5f0f","text":"<p>\u5bf9\u78c1\u76d8\u8fdb\u884c\u5206\u7ec4</p> <p></p> <p>\u201csuperblock\u201d\uff1a\u6587\u4ef6\u7cfb\u7edf\u5143\u6570\u636e</p> <ul> <li>\u6587\u4ef6 (inode) \u6570\u91cf</li> <li>block group \u4fe1\u606f</li> <li>ext2.h \u91cc\u6709\u4f60\u9700\u8981\u77e5\u9053\u7684\u4e00\u5207</li> </ul>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#ext2-inode","title":"ext2 inode","text":"<ul> <li>DIrect Blocks\uff1a\u76f4\u63a5\u5757\uff0c\u6570\u7ec4\uff1b</li> <li>Indirect blocks\uff1a\u4e00\u7ea7\u5757\u7d22\u5f15\uff1b</li> <li>Double Indirect\uff1a\u4e8c\u7ea7\u5757\u7d22\u5f15\uff1b</li> </ul>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#ext2_1","title":"ext2 \u76ee\u5f55\u6587\u4ef6","text":"<p>\u4e0e FAT \u672c\u8d28\u76f8\u540c\uff1a\u5728\u6587\u4ef6\u4e0a\u5efa\u7acb\u76ee\u5f55\u7684\u6570\u636e\u7ed3\u6784</p> <ul> <li>\u6ce8\u610f\u5230 inode \u7edf\u4e00\u5b58\u50a8</li> <li>\u76ee\u5f55\u6587\u4ef6\u4e2d\u5b58\u50a8\u6587\u4ef6\u540d\u5230 inode \u7f16\u53f7\u7684 key-value mapping</li> </ul> <p></p>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#ext2_2","title":"ext2: \u6027\u80fd\u4e0e\u53ef\u9760\u6027","text":"<p>\u5c40\u90e8\u6027\u4e0e\u7f13\u5b58</p> <ul> <li>bitmap, inode \u90fd\u6709 \u201c\u96c6\u4e2d\u5b58\u50a8\u201d \u7684\u5c40\u90e8\u6027</li> <li>\u901a\u8fc7\u5185\u5b58\u7f13\u5b58\u51cf\u5c11\u8bfb/\u5199\u653e\u5927</li> </ul> <p>\u5927\u6587\u4ef6\u7684\u968f\u673a\u8bfb\u5199\u6027\u80fd\u63d0\u5347\u660e\u663e (O(1))</p> <ul> <li>\u652f\u6301\u94fe\u63a5 (\u4e00\u5b9a\u7a0b\u5ea6\u51cf\u5c11\u7a7a\u95f4\u6d6a\u8d39)</li> <li>inode \u5728\u78c1\u76d8\u4e0a\u8fde\u7eed\u5b58\u50a8\uff0c\u4fbf\u4e8e\u7f13\u5b58/\u9884\u53d6</li> <li>\u4f9d\u7136\u6709\u788e\u7247\u7684\u95ee\u9898</li> </ul> <p>\u4f46\u53ef\u9760\u6027\u4f9d\u7136\u662f\u4e2a\u5f88\u5927\u7684\u95ee\u9898</p> <ul> <li>\u5b58\u50a8 inode \u7684\u6570\u636e\u5757\u635f\u574f\u662f\u5f88\u4e25\u91cd\u7684</li> </ul>"},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#_10","title":"\u8bfe\u540e\u4e60\u9898/\u7f16\u7a0b\u4f5c\u4e1a","text":""},{"location":"courses/os_lab/28_FAT_UNIX_filesystem.html#1","title":"1. \u9605\u8bfb\u6750\u6599","text":"<p>\u6559\u79d1\u4e66 Operating Systems: Three Easy Pieces./book_os_three_pieces/03-dialogue-virtualization.pdf)</p> <ul> <li>\u7b2c 40 \u7ae0 - File System Implementation</li> <li>\u7b2c 41 \u7ae0 - Fast File System (FFS)</li> </ul>"},{"location":"courses/os_lab/29_available_durable_data.html","title":"\u6301\u4e45\u6570\u636e\u7684\u53ef\u9760\u6027","text":"<p>\u672c\u8bb2\u5185\u5bb9\uff1a</p> <ul> <li>\u6301\u4e45\u6570\u636e\u7684\u53ef\u9760\u6027</li> <li>\u6784\u5efa\u53ef\u9760\u7684\u78c1\u76d8</li> <li>fsck \u548c journaling</li> </ul>"},{"location":"courses/os_lab/29_available_durable_data.html#_2","title":"\u6301\u4e45\u6570\u636e\u7684\u53ef\u9760\u6027","text":"<p>\u4efb\u4f55\u7269\u7406\u5b58\u50a8\u4ecb\u8d28\u90fd\u6709\u5931\u6548\u7684\u53ef\u80fd</p> <ul> <li> <p>\u4e34\u65f6\u5931\u6548\uff1aKernel panic\uff1b\u65ad\u7535</p> </li> <li> <p>\u6c38\u4e45\u5931\u6548</p> </li> <li>\u6781\u5c0f\u6982\u7387\u4e8b\u4ef6\uff1a\u6218\u4e89\u7206\u53d1/\u4e09\u4f53\u4eba\u8fdb\u653b\u5730\u7403/\u4e16\u754c\u6bc1\u706d</li> <li>\u5c0f\u6982\u7387\u4e8b\u4ef6\uff1a\u786c\u76d8\u635f\u574f (\u5927\u91cf\u91cd\u590d = \u5fc5\u7136\u53d1\u751f)</li> </ul>"},{"location":"courses/os_lab/29_available_durable_data.html#failure-model-1-fail-stop","title":"Failure Model (1): Fail-stop","text":"<p>\u78c1\u76d8\u53ef\u80fd\u5728\u67d0\u4e2a\u65f6\u523b\u5ffd\u7136\u5f7b\u5e95\u65e0\u6cd5\u8bbf\u95ee</p> <ul> <li>\u673a\u68b0\u6545\u969c\u3001\u82af\u7247\u6545\u969c\u2026\u2026</li> <li>\u78c1\u76d8\u597d\u50cf\u5c31 \u201c\u5ffd\u7136\u6d88\u5931\u201d \u4e86 (\u6570\u636e\u5b8c\u5168\u4e22\u5931)</li> <li>\u5047\u8bbe\u78c1\u76d8\u80fd\u62a5\u544a\u8fd9\u4e2a\u95ee\u9898 (\u5982\u4f55\u62a5\u544a\uff1f)</li> </ul> <p>\u78c1\u76d8\u53d1\u751f fail-stop \u4f1a\u5bf9\u4f60\u5e26\u6765\u4ec0\u4e48\u5f71\u54cd\uff1f</p>"},{"location":"courses/os_lab/29_available_durable_data.html#failure-model-2-system-crash","title":"Failure Model (2): System Crash","text":"<p>\u771f\u5b9e\u7684\u78c1\u76d8</p> <ul> <li><code>bwrite</code> \u4f1a\u88ab\u78c1\u76d8\u7f13\u5b58\uff0c\u5e76\u4e14\u4ee5\u4e0d\u53ef\u63a7\u7684\u987a\u5e8f\u88ab <code>persist</code></li> <li>\u5728\u4efb\u4f55\u65f6\u5019\uff0c\u7cfb\u7edf\u90fd\u53ef\u80fd crash</li> <li><code>bsync</code> \u4f1a\u7b49\u5f85\u6240\u6709 <code>bwrite</code> \u843d\u76d8</li> </ul> <p></p> <p>System crash \u4f1a\u5bf9\u4f60\u5e26\u6765\u4ec0\u4e48\u5f71\u54cd\uff1f</p>"},{"location":"courses/os_lab/29_available_durable_data.html#failure-mode","title":"\u66f4\u591a\u7684 Failure Mode","text":"<p>Data corruption</p> <ul> <li>\u78c1\u76d8\u770b\u8d77\u6765\u6b63\u5e38\uff0c\u4f46\u4e00\u90e8\u5206\u6570\u636e\u574f\u4e86</li> <li>An analysis of data corruption in the storage stack (FAST'08)</li> </ul> <p>Fail-slow\uff1a\u786c\u4ef6\u6216\u7cfb\u7edf\u4ecd\u5728\u8fd0\u884c\uff0c\u4f46\u5176\u6027\u80fd\u663e\u8457\u4e0b\u964d\u7684\u72b6\u6001</p> <ul> <li>Firmware bug; device error; wear-out; configuration; environment; ...</li> <li>Fail-slow at scale: Evidence of hardware performance faults in large production systems (FAST'18)</li> </ul> <p></p>"},{"location":"courses/os_lab/29_available_durable_data.html#redundant-array-of-inexpensive-disks-raid","title":"Redundant Array of Inexpensive Disks (RAID)","text":""},{"location":"courses/os_lab/29_available_durable_data.html#raid","title":"RAID: \u5b58\u50a8\u8bbe\u5907\u7684\u865a\u62df\u5316","text":"<p>\u628a\u591a\u4e2a (\u4e0d\u53ef\u9760\u7684) \u78c1\u76d8\u865a\u62df\u6210\u4e00\u5757\u975e\u5e38\u53ef\u9760\u4e14\u6027\u80fd\u6781\u9ad8\u7684\u865a\u62df\u78c1\u76d8</p> <ul> <li> <p>A case for redundant arrays of inexpensive disks (RAID) (SIGMOD'88)</p> </li> <li> <p>\u4e00\u4e2a \u201c\u53cd\u5411\u201d \u7684\u865a\u62df\u5316</p> </li> <li>\u7c7b\u6bd4\uff1a\u8fdb\u7a0b/\u865a\u5b58/\u6587\u4ef6\u628a \u201c\u4e00\u4e2a\u8bbe\u5907\u201d \u865a\u62df\u6210\u591a\u4efd</li> </ul>"},{"location":"courses/os_lab/29_available_durable_data.html#raid-design-space","title":"RAID: Design Space","text":"<p>RAID (\u865a\u62df\u5316) = \u865a\u62df\u78c1\u76d8\u5757\u5230\u7269\u7406\u78c1\u76d8\u5757\u7684 \u201c\u6620\u5c04\u201d\u3002</p> <ul> <li>\u865a\u62df\u78c1\u76d8\u5757\u53ef\u4ee5\u5b58\u50a8\u5728\u4efb\u4f55\u865a\u62df\u78c1\u76d8\u4e0a</li> <li>\u865a\u62df\u78c1\u76d8\u53ef\u4ee5\u5e76\u884c</li> <li>\u5b58\u50a8 &gt;1 \u4efd\u5373\u53ef\u5b9e\u73b0\u5bb9\u9519</li> </ul> <p>RAID-0\uff1a\u66f4\u5927\u7684\u5bb9\u91cf\u3001\u66f4\u5feb\u7684\u901f\u5ea6\uff0c\u6ca1\u6709\u5bb9\u9519</p> <ul> <li>\u8bfb\u901f\u5ea6 x 2\uff1b\u5199\u901f\u5ea6 x 2</li> </ul> <p>RAID-1\uff1a\u955c\u50cf (\u5bb9\u9519)</p> <ul> <li>\u4fdd\u6301\u4e24\u5757\u76d8\u5b8c\u5168\u4e00\u6837</li> <li>\u8bfb\u901f\u5ea6 x 2\uff1b\u5199\u901f\u5ea6\u4fdd\u6301\u4e00\u81f4</li> </ul>"},{"location":"courses/os_lab/29_available_durable_data.html#raid-1","title":"RAID-1\u5bb9\u9519\u7684\u4ee3\u4ef7","text":"<p>\u6d6a\u8d39\u4e86\u4e00\u5757\u76d8\u7684\u5bb9\u91cf\u2026\u2026</p> <ul> <li>\u5982\u679c\u6211\u4eec\u6709 100 \u5757\u76d8\uff0c\u4f46\u5047\u8bbe\u4e0d\u4f1a\u6709\u4e24\u5757\u76d8\u540c\u65f6 fail-stop\uff1f</li> </ul> <p>\u80fd\u4e0d\u80fd\u53ea\u7528 1-bit \u7684\u5197\u4f59\uff0c\u6062\u590d\u51fa\u4e00\u4e2a\u4e22\u5931\u7684 bit\uff1f</p> <ul> <li>\ud835\udc65=\ud835\udc4e\u2295\ud835\udc4f\u2295\ud835\udc50\u2295\ud835\udc51</li> <li>\ud835\udc4e=\ud835\udc65\u2295\ud835\udc4f\u2295\ud835\udc50\u2295\ud835\udc51</li> <li>\ud835\udc4f=\ud835\udc4e\u2295\ud835\udc65\u2295\ud835\udc50\u2295\ud835\udc51</li> <li>\ud835\udc50=\ud835\udc4e\u2295\ud835\udc4f\u2295\ud835\udc65\u2295\ud835\udc51</li> <li>\ud835\udc51=\ud835\udc4e\u2295\ud835\udc4f\u2295\ud835\udc50\u2295\ud835\udc65</li> <li>100 \u5757\u76d8\u91cc\uff0c99 \u5757\u76d8\u90fd\u662f\u6570\u636e\uff01</li> <li>Caveat: random write \u6027\u80fd\uff1a\u6821\u9a8c\u76d8\uff08parity block\uff09\u9700\u8981\u5148\u8bfb\u51fa\u6765\uff0c\u518d\u5199\u8fdb\u5165\uff08\u74f6\u9888\uff09</li> </ul>"},{"location":"courses/os_lab/29_available_durable_data.html#raid-5-rotating-parity","title":"RAID-5: Rotating Parity","text":"<p>\u201c\u4ea4\u9519\u6392\u5217\u201d parity block!</p> <p></p>"},{"location":"courses/os_lab/29_available_durable_data.html#raid_1","title":"RAID: \u8ba8\u8bba","text":"<p>\u66f4\u5feb\u3001\u66f4\u53ef\u9760\u3001\u8fd1\u4e4e\u514d\u8d39\u7684\u5927\u5bb9\u91cf\u78c1\u76d8</p> <ul> <li>\u9769\u4e86 \u201c\u9ad8\u53ef\u9760\u6027\u78c1\u76d8\u201d \u7684\u547d</li> <li>\u6210\u4e3a\u4eca\u5929\u670d\u52a1\u5668\u7684\u6807\u51c6\u914d\u7f6e</li> <li>\u7c7b\u4f3c\u7684\u91cc\u7a0b\u7891\uff1a\u201c\u5927\u6570\u636e\u201d \u65f6\u4ee3</li> <li>The Google file system (SOSP'03) \u548c MapReduce: Simplified data processing on large clusters (OSDI'04) </li> </ul> <p>RAID \u7684\u53ef\u9760\u6027</p> <ul> <li>RAID \u7cfb\u7edf\u53d1\u751f\u65ad\u7535\uff1f</li> <li>\u4f8b\u5b50\uff1aRAID-1 \u955c\u50cf\u76d8\u51fa\u73b0\u4e0d\u4e00\u81f4\u7684\u6570\u636e</li> <li>\u68c0\u6d4b\u5230\u78c1\u76d8\u574f\uff1f</li> <li>\u81ea\u52a8\u91cd\u7ec4</li> </ul>"},{"location":"courses/os_lab/29_available_durable_data.html#_3","title":"\u5d29\u6e83\u4e00\u81f4\u6027\u4e0e\u5d29\u6e83\u6062\u590d","text":""},{"location":"courses/os_lab/29_available_durable_data.html#crash-consistency","title":"\u5d29\u6e83\u4e00\u81f4\u6027 (Crash Consistency)","text":"<p>Crash Consistency: Move the file system from one consistent state (e.g., before the file got appended to) to another atomically (e.g., after the inode, bitmap, and new data block have been written to disk).</p> <p>\u78c1\u76d8\u4e0d\u63d0\u4f9b\u591a\u5757\u8bfb\u5199 \u201call or nothing\u201d \u7684\u652f\u6301</p> <ul> <li>\u751a\u81f3\u4e3a\u4e86\u6027\u80fd\uff0c\u6ca1\u6709\u987a\u5e8f\u4fdd\u8bc1</li> <li>bwrite \u53ef\u80fd\u88ab\u4e71\u5e8f</li> <li>\u6240\u4ee5\u78c1\u76d8\u8fd8\u63d0\u4f9b\u4e86 bflush \u7b49\u5f85\u5df2\u5199\u5165\u7684\u6570\u636e\u843d\u76d8</li> </ul>"},{"location":"courses/os_lab/29_available_durable_data.html#file-system-checking-fsck","title":"File System Checking (FSCK)","text":"<p>\u6839\u636e\u78c1\u76d8\u4e0a\u5df2\u6709\u7684\u4fe1\u606f\uff0c\u6062\u590d\u51fa \u201c\u6700\u53ef\u80fd\u201d \u7684\u6570\u636e\u7ed3\u6784</p> <p></p> <ul> <li>SQCK: A declarative file system checker (OSDI'08)</li> <li>Towards robust file system checkers (FAST'18)</li> <li>\u201cwidely used file systems (EXT4, XFS, BtrFS, and F2FS) may leave the file system in an uncorrectable state if the repair procedure is interrupted unexpectedly\u201d \ud83d\ude02</li> </ul>"},{"location":"courses/os_lab/29_available_durable_data.html#_4","title":"\u91cd\u65b0\u601d\u8003\u6570\u636e\u7ed3\u6784\u7684\u5b58\u50a8","text":"<p>\u4e24\u4e2a \u201c\u89c6\u89d2\u201d</p> <ol> <li>\u5b58\u50a8\u5b9e\u9645\u6570\u636e\u7ed3\u6784</li> <li>\u6587\u4ef6\u7cfb\u7edf\u7684 \u201c\u76f4\u89c2\u201d \u8868\u793a</li> <li>crash unsafe</li> <li>Append-only \u8bb0\u5f55\u6240\u6709\u5386\u53f2\u64cd\u4f5c</li> <li>\u201c\u91cd\u505a\u201d \u6240\u6709\u64cd\u4f5c\u5f97\u5230\u6570\u636e\u7ed3\u6784\u7684\u5f53\u524d\u72b6\u6001</li> <li>\u5bb9\u6613\u5b9e\u73b0\u5d29\u6e83\u4e00\u81f4\u6027</li> </ol> <p>\u4e8c\u8005\u7684\u878d\u5408</p> <ul> <li>\u6570\u636e\u7ed3\u6784\u64cd\u4f5c\u53d1\u751f\u65f6\uff0c\u7528 (2) append-only \u8bb0\u5f55\u65e5\u5fd7</li> <li>\u65e5\u5fd7\u843d\u76d8\u540e\uff0c\u7528 (1) \u66f4\u65b0\u6570\u636e\u7ed3\u6784</li> <li>\u5d29\u6e83\u540e\uff0c\u91cd\u653e\u65e5\u5fd7\u5e76\u6e05\u9664 (\u79f0\u4e3a redo log\uff1b\u76f8\u5e94\u4e5f\u53ef\u4ee5 undo log)</li> </ul>"},{"location":"courses/os_lab/29_available_durable_data.html#atomic-append","title":"\u5b9e\u73b0 Atomic Append","text":"<p>\u7528 <code>bread</code>, <code>bwrite</code> \u548c <code>bflush</code> \u5b9e\u73b0 <code>append()</code></p> <p></p> <ol> <li>\u5b9a\u4f4d\u5230 journal \u7684\u672b\u5c3e (bread)</li> <li>bwrite TXBegin \u548c\u6240\u6709\u6570\u636e\u7ed3\u6784\u64cd\u4f5c</li> <li>bflush \u7b49\u5f85\u6570\u636e\u843d\u76d8\uff08\u9632\u6b62 TxEnd \u4e71\u5e8f\u5148\u5199\u5165\uff09</li> <li>bwrite TXEnd</li> <li>bflush \u7b49\u5f85\u6570\u636e\u843d\u76d8\uff08\u4e24\u4e2a flush \u5177\u5907 happens-before\uff09</li> <li>\u5c06\u6570\u636e\u7ed3\u6784\u64cd\u4f5c\u5199\u5165\u5b9e\u9645\u6570\u636e\u7ed3\u6784\u533a\u57df</li> <li>\u7b49\u5f85\u6570\u636e\u843d\u76d8\u540e\uff0c\u5220\u9664 (\u6807\u8bb0) \u65e5\u5fd7</li> </ol>"},{"location":"courses/os_lab/29_available_durable_data.html#journaling","title":"Journaling: \u4f18\u5316","text":"<p>\u73b0\u5728\u78c1\u76d8\u9700\u8981\u5199\u5165\u53cc\u4efd\u7684\u6570\u636e</p> <ul> <li>\u6279\u5904\u7406 (xv6; jbd)</li> <li>\u591a\u6b21\u7cfb\u7edf\u8c03\u7528\u7684 Tx \u5408\u5e76\u6210\u4e00\u4e2a\uff0c\u51cf\u5c11 log \u7684\u5927\u5c0f</li> <li>jbd: \u5b9a\u671f write back</li> <li>Checksum (ext4)</li> <li>\u4e0d\u518d\u6807\u8bb0 TxBegin/TxEnd</li> <li>\u76f4\u63a5\u6807\u8bb0 Tx \u7684\u957f\u5ea6\u548c checksum</li> <li>Metadata journaling (ext4 default)</li> <li>\u6570\u636e\u5360\u78c1\u76d8\u5199\u5165\u7684\u7edd\u5927\u90e8\u5206<ul> <li>\u53ea\u5bf9 inode \u548c bitmap \u505a journaling \u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd</li> </ul> </li> <li>\u4fdd\u8bc1\u6587\u4ef6\u7cfb\u7edf\u7684\u76ee\u5f55\u7ed3\u6784\u662f\u4e00\u81f4\u7684\uff1b\u4f46\u6570\u636e\u53ef\u80fd\u4e22\u5931</li> </ul>"},{"location":"courses/os_lab/29_available_durable_data.html#metadata-journaling","title":"Metadata Journaling","text":"<p>\u4ece\u5e94\u7528\u89c6\u89d2\u6765\u770b\uff0c\u6587\u4ef6\u7cfb\u7edf\u7684\u884c\u4e3a\u53ef\u80fd\u5f88\u602a\u5f02</p> <ul> <li>\u5404\u7c7b\u7cfb\u7edf\u8f6f\u4ef6 (git, sqlite, gdbm, ...) \u4e0d\u5e78\u4e2d\u62db</li> <li>All file systems are not created equal: On the complexity of crafting crash-consistent applications (OSDI'14)</li> <li>\u66f4\u591a\u7684\u5e94\u7528\u7a0b\u5e8f\u53ef\u80fd\u53d1\u751f data loss</li> <li>\u6211\u4eec\u7684\u5de5\u4f5c: GNU coreutils, gmake, gzip, ... \u4e5f\u6709\u95ee\u9898</li> <li>Crash consistency validation made easy (FSE'16)</li> </ul> <p>\u66f4\u4e3a\u4e00\u52b3\u6c38\u9038\u7684\u65b9\u6848\uff1aTxOS</p> <ul> <li>xbegin/xend/xabort \u7cfb\u7edf\u8c03\u7528\u5b9e\u73b0\u8de8 syscall \u7684 \u201call-or-nothing\u201d</li> <li>\u5e94\u7528\u573a\u666f\uff1a\u6570\u636e\u66f4\u65b0\u3001\u8f6f\u4ef6\u66f4\u65b0\u3001check-use\u2026\u2026</li> <li>Operating systems transactions (SOSP'09)</li> </ul>"},{"location":"courses/os_lab/29_available_durable_data.html#_5","title":"\u8bfe\u540e\u4e60\u9898/\u7f16\u7a0b\u4f5c\u4e1a","text":""},{"location":"courses/os_lab/29_available_durable_data.html#1","title":"1. \u9605\u8bfb\u6750\u6599","text":"<p>\u6559\u79d1\u4e66 Operating Systems: Three Easy Pieces</p> <ul> <li>\u7b2c 38 \u7ae0 - Redundant Disk Arrays (RAID)</li> <li>\u7b2c 42 \u7ae0 - FSCK and Journaling</li> <li>\u7b2c 43 \u7ae0 - Log-structured File System (LFS)</li> </ul>"},{"location":"courses/os_lab/30_summarize.html","title":"\u8bfe\u7a0b\u603b\u7ed3","text":"<p>\u795d\u613f\u6bcf\u4e2a\u540c\u5b66\u90fd\u80fd\u627e\u5230\u5e76\u8ffd\u6c42\u81ea\u5df1\u7684\u68a6\u60f3\uff0c\u6210\u4e3a\u4e00\u4e2a\u613f\u610f\u7ad9\u51fa\u6765\u98a0\u8986\u4e00\u4e2a\u884c\u4e1a\u7684\u4eba\u3001\u4e00\u4e2a\u80fd\u7ba1\u7406\u597d\u5de5\u7a0b\u9879\u76ee\u7684\u4eba\u3001\u4e00\u4e2a\u80fd\u80fd\u9a7e\u9a6d\u7684\u4e86\u5927\u89c4\u6a21\u4ee3\u7801\u7684\u4eba\u2026\u2026\u7528\u81ea\u5df1\u7684\u65b9\u5f0f\u53bb\u5b8c\u6210\u90a3\u4e9b \u201c\u60ca\u4e3a\u5929\u4eba\u201d \u7684\u4e1c\u897f\uff0c\u63a8\u52a8\u4e16\u754c\u7684\u8fdb\u6b65\u3002</p> <p>\u6211\u4eec\u7684\u5f81\u9014\u662f\u661f\u8fb0\u548c\u5927\u6d77\u3002\u56e0\u6b64\uff0c\u5bf9\u81ea\u5df1\u8981\u6c42\u9ad8\u4e00\u70b9\u3002</p>"},{"location":"courses/os_lab/30_summarize.html#_2","title":"\u4ece\u903b\u8f91\u95e8\u5230\u8ba1\u7b97\u673a\u7cfb\u7edf","text":""},{"location":"courses/os_lab/30_summarize.html#_3","title":"\u6570\u5b57\u7cfb\u7edf\uff1a\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684 \u201c\u516c\u7406\u7cfb\u7edf\u201d","text":"<p>\u6570\u5b57\u7cfb\u7edf = \u72b6\u6001\u673a</p> <ul> <li>\u72b6\u6001\uff1a\u89e6\u53d1\u5668</li> <li>\u8fc1\u79fb\uff1a\u7ec4\u5408\u903b\u8f91</li> <li>\u201c\u6570\u7801\u7ba1\u201d \u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u4f8b\u5b50\uff1aUNIX Philosophy \u548c \u201c\u7f16\u7a0b\u201d \u7684\u529b\u91cf</li> <li>NEMU Full System Emulator</li> </ul> <p>\u6570\u5b57\u7cfb\u7edf\u7684\u8bbe\u8ba1 = \u5b9a\u4e49\u72b6\u6001\u673a</p> <ul> <li>HDL(Verilog)</li> <li>HCL (Chisel)\uff1a\u7f16\u8bd1\u751f\u6210 Verilog</li> <li>HLS (High Level Synthesis)\uff1a\u201c\u4ece\u9700\u6c42\u5230\u4ee3\u7801\u201d</li> </ul>"},{"location":"courses/os_lab/30_summarize.html#_4","title":"\u7f16\u7a0b\u8bed\u8a00\u548c\u7b97\u6cd5","text":"<p>C/Java/Python \u7a0b\u5e8f = \u72b6\u6001\u673a</p> <ul> <li>\u72b6\u6001\uff1a\u6808\u3001\u5806\u3001\u5168\u5c40\u53d8\u91cf</li> <li>\u8fc1\u79fb\uff1a\u8bed\u53e5 (\u6216\u8bed\u53e5\u4e00\u90e8\u5206) \u7684\u6267\u884c</li> <li>\u201c\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00\u7684\u5f62\u5f0f\u8bed\u4e49\u201d\uff1ahanoi-nr.c \u7684\u9012\u5f52\u8f6c\u975e\u9012\u5f52</li> </ul> <p>\u7f16\u7a0b = \u63cf\u8ff0\u72b6\u6001\u673a</p> <ul> <li>\u5c06\u4eba\u7c7b\u4e16\u754c\u7684\u9700\u6c42\u6620\u5c04\u5230\u8ba1\u7b97\u673a\u4e16\u754c\u4e2d\u7684\u6570\u636e\u548c\u8ba1\u7b97</li> <li>\u8c03\u8bd5\u7406\u8bba\uff1aFault, Error \u548c Failure</li> <li>\u5141\u8bb8\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684 API</li> <li>\u4f8b\u5b50\uff1a<code>write(fd, buf, size)</code> \u6301\u4e45\u5316\u6570\u636e</li> </ul>"},{"location":"courses/os_lab/30_summarize.html#_5","title":"\u5982\u4f55\u4f7f\u7a0b\u5e8f\u5728\u6570\u5b57\u7cfb\u7edf\u4e0a\u8fd0\u884c\uff1f","text":"<p>\u6307\u4ee4\u96c6\u4f53\u7cfb\u7ed3\u6784</p> <ul> <li>\u5728\u903b\u8f91\u95e8\u4e4b\u4e0a\u5efa\u7acb\u7684 \u201c\u6307\u4ee4\u7cfb\u7edf\u201d (\u72b6\u6001\u673a)</li> <li>The RISC-V Instruction Set Manual</li> <li>\u65e2\u5bb9\u6613\u7528\u7535\u8def\u5b9e\u73b0\uff0c\u53c8\u8db3\u591f\u652f\u6491\u7a0b\u5e8f\u6267\u884c</li> </ul> <p>\u7f16\u8bd1\u5668 (\u4e5f\u662f\u4e2a\u7a0b\u5e8f)</p> <ul> <li>\u5c06 \u201c\u9ad8\u7ea7\u201d \u72b6\u6001\u673a (\u7a0b\u5e8f) \u7ffb\u8bd1\u6210\u7684 \u201c\u4f4e\u7ea7\u201d \u72b6\u6001\u673a (\u6307\u4ee4\u5e8f\u5217)</li> <li>\u7ffb\u8bd1\u51c6\u5219\uff1aexternal visible \u7684\u884c\u4e3a (\u64cd\u4f5c\u7cfb\u7edf API \u8c03\u7528) \u7b49\u4ef7</li> </ul> <p>\u64cd\u4f5c\u7cfb\u7edf (\u4e5f\u662f\u4e2a\u7a0b\u5e8f)</p> <ul> <li>\u72b6\u6001\u673a (\u8fd0\u884c\u4e2d\u7a0b\u5e8f) \u7684\u7ba1\u7406\u8005</li> <li>\u4f7f\u7a0b\u5e8f\u53ef\u4ee5\u5171\u4eab\u4e00\u4e2a\u786c\u4ef6\u7cfb\u7edf\u4e0a\u7684\u8d44\u6e90 (\u4f8b\u5982 I/O \u8bbe\u5907)</li> </ul>"},{"location":"courses/os_lab/30_summarize.html#_6","title":"\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u7a0b\u5e8f","text":"<p>\u72b6\u6001\u673a + \u4e00\u6761\u7279\u6b8a\u7684 \u201c\u64cd\u4f5c\u7cfb\u7edf\u8c03\u7528\u201d \u6307\u4ee4</p> <ul> <li>syscall (2)\uff1aminimal.S\uff08\u6700\u5c0f\u7684Hello World\uff09</li> </ul> <p>\u53ef\u6267\u884c\u6587\u4ef6</p> <ul> <li> <p>loader.c\uff1a\u89e3\u6790 ELF \u7a0b\u5e8f\u5e76\u52a0\u8f7d\u6267\u884c</p> </li> <li> <p>\u201c\u8fdb\u7a0b\u521d\u59cb\u72b6\u6001\u7684\u63cf\u8ff0\u201d</p> </li> <li> <p>\u52a8\u6001\u94fe\u63a5\u548c\u52a0\u8f7d</p> </li> </ul> <p>\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4</p> <ul> <li>pmap \u548c\u6e38\u620f\u4fee\u6539\u5668</li> </ul>"},{"location":"courses/os_lab/30_summarize.html#api","title":"\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u8c61\u548c API","text":"<p>OperatingSystem: Three Easy Pieces</p> <ul> <li>Concurrency - thread.h\uff1a\u6253\u5f00\u6f58\u591a\u62c9\u7684\u76d2\u5b50</li> <li>Virtualization - sh-xv6.c\uff1a\u91d1\u5c71\u6e38\u4fa0\u3001\u6309\u952e\u7cbe\u7075\u548c\u53d8\u901f\u9f7f\u8f6e</li> <li>Persistence - fat-tree.c</li> </ul>"},{"location":"courses/os_lab/30_summarize.html#_7","title":"\u83b7\u5f97 \u201c\u5b9e\u73b0\u4e00\u5207\u201d \u7684\u80fd\u529b\uff01","text":"<p>M1 - pstree\uff1a\u6253\u5370\u8fdb\u7a0b\u6811 (\u6587\u4ef6\u7cfb\u7edf API; procfs)</p> <p>M2 - plcs\uff1a\u5b9e\u73b0\u5e76\u884c\u8ba1\u7b97\u52a0\u901f (\u7ebf\u7a0b\u548c\u540c\u6b65)</p> <p>M3 - sperf\uff1astrace (pipe; fork; execve)</p> <p>M4 - crepl\uff1a\u52a8\u6001\u94fe\u63a5\u548c\u52a0\u8f7d (fork; execve; dlopen)</p> <p>M5 - freov\uff1a\u6587\u4ef6\u7cfb\u7edf\u89e3\u6790 (mmap)</p>"},{"location":"courses/os_lab/30_summarize.html#_8","title":"\u83b7\u5f97 \u201c\u7406\u89e3\u4e00\u5207\u201d \u7684\u80fd\u529b","text":"<p>\u201c\u64cd\u4f5c\u7cfb\u7edf\u201d \u8bfe\u7ed9\u4e86\u4f60\u7a0b\u5e8f\u7684 \u201c\u6700\u5e95\u5c42\u201d \u7684\u72b6\u6001\u673a\u89c6\u89d2</p> <ul> <li>\u4e5f\u7ed9\u4e86\u5f88\u591a\u4e4b\u524d\u5f88\u96be\u56de\u7b54\u95ee\u9898\u7684\u7b54\u6848</li> <li>\u5982\u4f55\u521b\u9020\u4e00\u4e2a \u201c\u6700\u5c0f\u201d \u7684\u53ef\u6267\u884c\u6587\u4ef6\uff1f</li> <li><code>a.out</code> \u662f\u4ec0\u4e48\uff1f</li> <li><code>a.out</code> \u6267\u884c\u7684\u7b2c\u4e00\u6761\u6307\u4ee4\u5728\u54ea\u91cc\uff1f</li> <li><code>printf</code> \u662f\u5982\u4f55\u88ab\u8c03\u7528\u7684\uff1f</li> <li><code>a.out</code> \u6267\u884c\u4e86\u54ea\u4e9b\u7cfb\u7edf\u8c03\u7528\uff1f</li> <li><code>a.out</code> \u6267\u884c\u4e86\u591a\u5c11\u6761\u6307\u4ee4\uff1f</li> </ul>"},{"location":"courses/os_lab/30_summarize.html#_9","title":"\u7406\u89e3\u64cd\u4f5c\u7cfb\u7edf\u5982\u4f55\u5b9e\u73b0","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u73b0\u9009\u8bb2</p> <ul> <li>\u4ece Firmware \u5230\u7b2c\u4e00\u4e2a\u7528\u6237\u7a0b\u5e8f</li> <li>\u8ff7\u4f60 \u201c\u64cd\u4f5c\u7cfb\u7edf\u201d\uff1athread-os.c</li> <li>\u6700\u5c0f\u7684 Linux\uff1a\u8fd8\u6709 \u201c\u6838\u5f39\u53d1\u5c04\u5668\u201d \u9a71\u52a8</li> <li>OSLabs</li> </ul>"},{"location":"courses/os_lab/30_summarize.html#_10","title":"\u56de\u987e\uff1a\u4ece\u903b\u8f91\u95e8\u5230\u8ba1\u7b97\u673a\u7cfb\u7edf","text":"<p>\u5237\u4e00\u4e0b\u624b\u673a\uff0c\u4f60\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u7ecf\u5386\u4e86\u975e\u5e38\u590d\u6742\u7684\u8fc7\u7a0b</p> <ul> <li>\u5e94\u7528\u7a0b\u5e8f (app) \u2192 \u5e93\u51fd\u6570 \u2192 \u7cfb\u7edf\u8c03\u7528 \u2192 \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u5bf9\u8c61 \u2192 \u64cd\u4f5c\u7cfb\u7edf\u5b9e\u73b0 (C \u7a0b\u5e8f) \u2192 \u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f \u2192 \u786c\u4ef6\u62bd\u8c61\u5c42 \u2192 \u6307\u4ee4\u96c6 \u2192 CPU, RAM, I/O\u8bbe\u5907 \u2192 \u95e8\u7535\u8def</li> </ul> <p>\u64cd\u4f5c\u7cfb\u7edf\u8bfe\u7ed9\u8fd9\u4e2a\u7a0d\u663e\u590d\u6742\u7684\u8fc7\u7a0b\u4e00\u4e2a\u6e05\u6670\u7684\u8f6e\u5ed3</p> <ul> <li>\u201c\u8fd9\u4e00\u5207\u662f\u53ef\u4ee5\u638c\u63a7\u7684\u201d\uff1aAsk GPT! RTFM! RTFSC!</li> </ul> <p></p>"},{"location":"courses/os_lab/30_summarize.html#hackers-delights","title":"Hacker's Delights: \u65b0\u7684\u201c\u7406\u89e3\u201d","text":"<p>\u201c\u4e00\u5207\u7686\u72b6\u6001\u673a\u201d</p> <ul> <li>\u72b6\u6001\u7684\u526f\u672c (fork) \u53ef\u4ee5\u7528\u6765\u505a\u4ec0\u4e48\uff1f</li> <li>Model checking, failure recovery, ...</li> </ul> <p>\u201c\u6b7b\u9501\u68c0\u6d4b: lockdep \u5728\u6bcf\u6b21 lock/unlock \u7684\u65f6\u5019\u63d2\u5165\u4e00\u6761 printf\u201d</p> <ul> <li>\u8fd9\u5c31\u662f dynamic analysis \u7684\u672c\u8d28</li> <li>\u5982\u4f55\u51cf\u5c11 printf \u7684\u6570\u91cf\u3001\u600e\u4e48\u5de7\u5999\u5730\u8bb0\u5f55\u3001\u600e\u6837\u5206\u6790\u65e5\u5fd7\u2026\u2026</li> <li>\u5982\u4f55\u8c03\u63a7\u7a0b\u5e8f\u7684\u6267\u884c\uff1f\u627e\u5230 bug \u8fd8\u662f\u7ed5\u5f00 bug\uff1f</li> </ul> <p>\u201c\u6587\u4ef6\u7cfb\u7edf\u662f\u78c1\u76d8\u4e0a\u7684\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u201d</p> <ul> <li>\u901a\u8fc7 append-only \u5b9e\u73b0 journaling</li> <li>LSM Tree \u548c\u5206\u5e03\u5f0f key-value store</li> <li>Block chain \u4e5f\u662f\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff01</li> </ul>"},{"location":"courses/os_lab/30_summarize.html#_11","title":"\u5e76\u53d1\uff1a\u8d70\u5411\u5206\u5e03\u5f0f\u7cfb\u7edf","text":"<p>\u5982\u4f55\u4e3a\u7f51\u7edc\u4e0a\u7684\u591a\u53f0\u8ba1\u7b97\u673a\u63d0\u4f9b\u7edf\u4e00\u7684\u5e94\u7528\u7a0b\u5e8f\u63a5\u53e3\uff1f</p> <ul> <li>\u628a\u591a\u4e2a\u5206\u5e03\u7684\u3001\u968f\u65f6\u53ef\u80fd\u79bb\u7ebf\u7684\u8ba1\u7b97\u673a\u7ec4\u6210\u4e00\u4e2a\u5b58\u50a8\u7cfb\u7edf</li> <li>\u5728\u5b58\u50a8\u7684\u57fa\u7840\u4e0a\u5b8c\u6210\u8ba1\u7b97</li> </ul> <p></p>"},{"location":"courses/os_lab/30_summarize.html#_12","title":"\u865a\u62df\u5316\uff1a\u91cd\u65b0\u7406\u89e3\u64cd\u4f5c\u7cfb\u7edf\u8bbe\u8ba1","text":"<p>Microkernel, Exokernel, Unikernel</p> <ul> <li>\u6ca1\u6709\u4eba\u89c4\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u91cc\u4e00\u5b9a\u8981\u6709 \u201c\u6587\u4ef6\u201d\u3001\u201c\u8fdb\u7a0b\u201d \u8fd9\u4e9b\u5bf9\u8c61</li> </ul> <p></p>"},{"location":"courses/os_lab/30_summarize.html#_13","title":"\u6301\u4e45\u5316\uff1a\u91cd\u65b0\u7406\u89e3\u6301\u4e45\u5b58\u50a8\u8bbe\u8ba1","text":"<p>\u6587\u4ef6\u7cfb\u7edf\u6ca1\u80fd\u89e3\u51b3\u7684\u9700\u6c42</p> <ul> <li>\u5927\u91cf\u7684\u6570\u636e (\u8ba2\u5355\u3001\u7528\u6237\u3001\u7f51\u7edc\u2026\u2026) + \u975e\u7b80\u5355\u76ee\u5f55\u904d\u5386\u6027\u8d28\u7684\u67e5\u8be2</li> </ul> <p>\u201c\u6570\u636e\u5e93\u201d\uff1a\u865a\u62df\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u7ed3\u6784</p> <ul> <li>\u5c31\u50cf\u6211\u4eec\u5728\u5185\u5b58 (random access memory) \u4e0a\u6784\u5efa\u5404\u79cd\u6570\u636e\u7ed3\u6784</li> <li>Binary heap, binary search tree, hash table, ...</li> <li>\u5178\u578b\u7684\u6570\u636e\u5e93</li> <li>\u5173\u7cfb\u6570\u636e\u5e93 (\u4e8c\u7ef4\u8868\u3001\u5173\u7cfb\u4ee3\u6570)</li> <li>key-value store (\u6301\u4e45\u5316\u7684 <code>std::map</code>)</li> <li>VCS (\u76ee\u5f55\u6811\u7684\u5feb\u7167\u96c6\u5408)</li> <li>SSD \u548c NVM \u5e26\u6765\u7684\u65b0\u6d6a\u6f6e</li> </ul>"},{"location":"courses/os_lab/30_summarize.html#topics","title":"\u548c\u64cd\u4f5c\u7cfb\u7edf\u76f8\u5173\u7684 Topics","text":"<ul> <li> <p>Computer Architecture\uff1a\u8ba1\u7b97\u673a\u786c\u4ef6\u7684\u8bbe\u8ba1\u3001\u5b9e\u73b0\u4e0e\u8bc4\u4f30</p> </li> <li> <p>Computer Systems\uff1a\u7cfb\u7edf\u8f6f\u4ef6 (\u8f6f\u4ef6) \u7684\u8bbe\u8ba1\u3001\u5b9e\u73b0\u4e0e\u8bc4\u4f30</p> </li> <li>Network Systems\uff1a\u7f51\u7edc\u4e0e\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u8bbe\u8ba1\u3001\u5b9e\u73b0\u4e0e\u8bc4\u4f30</li> <li>Programming Languages\uff1a\u72b6\u6001\u673a (\u8ba1\u7b97\u8fc7\u7a0b) \u7684\u63cf\u8ff0\u65b9\u6cd5\u3001\u5206\u6790\u548c\u8fd0\u884c\u65f6\u652f\u6301</li> <li>Software Engineering\uff1a\u7a0b\u5e8f/\u7cfb\u7edf\u7684\u6784\u9020\u3001\u7406\u89e3\u548c\u7ecf\u9a8c</li> <li>System/Software Security\uff1a\u7cfb\u7edf\u8f6f\u4ef6\u7684\u5b89 (safety) \u5168 (integrity)</li> </ul>"},{"location":"courses/os_lab/30_summarize.html#jyy","title":"jyy \u7684\u8bfe\u7a0b\u603b\u7ed3","text":""},{"location":"courses/os_lab/30_summarize.html#_14","title":"\u4e0a\u64cd\u4f5c\u7cfb\u7edf\u8bfe\u7684\u4e50\u8da3","text":"<p>\u5728\u8bfe\u5802\u4e0a\u65f6\uff0c\u4f60\u53ef\u4ee5\u601d\u8003\u4e00\u4e9b\u5df2\u7ecf\u5f88\u6e05\u695a\u7684\u57fa\u672c\u4e1c\u897f\u3002\u8fd9\u4e9b\u77e5\u8bc6\u662f\u5f88\u6709\u8da3\u3001\u4ee4\u4eba\u6109\u5feb\u7684\uff0c\u91cd\u6e29\u4e00\u904d\u53c8\u4f55\u59a8\uff1f\u53e6\u4e00\u65b9\u9762\uff0c\u6709\u6ca1\u6709\u66f4\u597d\u7684\u4ecb\u7ecd\u65b9\u5f0f\uff1f\u6709\u4ec0\u4e48\u76f8\u5173\u7684\u65b0\u95ee\u9898\uff1f\u4f60\u80fd\u4e0d\u80fd\u8d4b\u4e88\u8fd9\u4e9b\u65e7\u77e5\u8bc6\u65b0\u751f\u547d\uff1f\u2026\u2026\u4f46\u5982\u679c\u4f60\u771f\u7684\u6709\u4ec0\u4e48\u65b0\u60f3\u6cd5\uff0c\u80fd\u4ece\u65b0\u89d2\u5ea6\u770b\u4e8b\u7269\uff0c\u4f60\u4f1a\u89c9\u5f97\u5f88\u6109\u5feb\u3002</p> <p>\u5b66\u751f\u95ee\u7684\u95ee\u9898\uff0c\u6709\u65f6\u4e5f\u80fd\u63d0\u4f9b\u65b0\u7684\u7814\u7a76\u65b9\u5411\u3002\u4ed6\u4eec\u7ecf\u5e38\u63d0\u51fa\u4e00\u4e9b\u6211\u66fe\u7ecf\u601d\u8003\u8fc7\u3001\u4f46\u6682\u65f6\u653e\u5f03\u3001\u5374\u90fd\u662f\u4e9b\u610f\u4e49\u5f88\u6df1\u8fdc\u7684\u95ee\u9898\uff0c\u91cd\u65b0\u60f3\u60f3\u8fd9\u4e9b\u95ee\u9898\uff0c\u770b\u770b\u80fd\u5426\u6709\u6240\u7a81\u7834\uff0c\u4e5f\u5f88\u6709\u610f\u601d\u3002</p> <p>\u5b66\u751f\u672a\u5fc5\u7406\u89e3\u6211\u60f3\u56de\u7b54\u7684\u65b9\u5411\uff0c\u6216\u8005\u662f\u6211\u60f3\u601d\u8003\u7684\u5c42\u6b21\uff1b\u4f46\u4ed6\u4eec\u95ee\u6211\u8fd9\u4e2a\u95ee\u9898\uff0c\u5374\u5f80\u5f80\u63d0\u9192\u4e86\u6211\u76f8\u5173\u7684\u95ee\u9898\u3002\u5355\u5355\u9760\u81ea\u5df1\uff0c\u662f\u4e0d\u5bb9\u6613\u83b7\u5f97\u8fd9\u79cd\u542f\u793a\u7684\u3002 \u2014\u2014 Richard Feynman</p>"},{"location":"courses/os_lab/30_summarize.html#_15","title":"\u516d\u5468\u76ee\u7684\u4e3b\u8981\u6539\u8fdb","text":"<p>\u8bfe\u7a0b\u4e3b\u7ebf</p> <ul> <li>\u771f\u6b63\u5b9e\u73b0\u4e86 \u201ceverything is a state machine\u201d</li> <li>\u5b9e\u73b0\u4e86\u7b2c\u4e94\u5468\u76ee\u7acb\u7684 flag</li> <li>\u4e00\u4e2a\u8db3\u591f\u6210\u719f\u7684 model checker</li> <li>Jupyter notebook \u548c lecture notes \u7684\u6539\u8fdb</li> </ul> <p>\u4ee3\u7801</p> <ul> <li>\u66f4\u597d\u7684\u4ee3\u7801\u793a\u4f8b</li> <li>\u4f46\u4f3c\u4e4e\u56e0\u4e3a\u8bfe\u65f6\uff0c\u5c55\u793a\u5f97\u4ee3\u7801\u53d8\u5c11\u4e86</li> </ul> <p>AI</p> <ul> <li>Copilot \u9010\u6e10\u5e94\u8be5\u6210\u4e3a\u8bfe\u7a0b\u7684\u4e00\u90e8\u5206</li> </ul>"},{"location":"courses/os_lab/30_summarize.html#_16","title":"\u81ea\u6211\u6279\u8bc4\u4e0e\u4e03\u5468\u76ee","text":"<p>\u8bfe\u7a0b\u4e3b\u7ebf</p> <ul> <li>\u4ecd\u7136\u6b20\u7740\u7684\u4ee3\u7801</li> <li>RAID \u6a21\u62df\u5668</li> <li>...</li> <li>\u91cd\u5199\u8bfe\u7a0b\u7f51\u7ad9/Online Judge</li> <li>\u6574\u6539\u9879\u76ee\uff0c\u518d\u518d\u518d\u6b21\u672a\u80fd\u5982\u613f</li> <li>\u8fd8\u4e0d\u591f friendly</li> <li>\u662f\u7684\u2026\u2026</li> <li>\u4e5f\u8bb8\u9700\u8981\u4e00\u4e2a\u56e2\u961f\u4e86</li> </ul> <p>\u5176\u4ed6</p> <ul> <li>\u6b22\u8fce\u5927\u5bb6\u63d0\u5efa\u8bae/\u610f\u89c1</li> </ul>"},{"location":"courses/os_lab/30_summarize.html#_17","title":"\u6211\u4eec\u8eab\u5904\u7684\u65f6\u4ee3","text":""},{"location":"courses/os_lab/30_summarize.html#google","title":"Google \u4e0d\u662f\u5076\u7136\u7684","text":""},{"location":"courses/os_lab/30_summarize.html#apple-facebook","title":"Apple \u548c Facebook \u4e0d\u662f\u5076\u7136\u7684","text":""},{"location":"courses/os_lab/30_summarize.html#openai","title":"OpenAI \u4e5f\u4e0d\u662f\u5076\u7136\u7684","text":""},{"location":"courses/os_lab/30_summarize.html#_18","title":"\u4e00\u4e2a\u89c2\u70b9","text":"<p>\u6211\u4eec\u56fd\u5bb6\u9700\u8981\u7684</p> <ul> <li>\u9762\u5411 \u201c\u5361\u8116\u5b50\u201d \u95ee\u9898\u3001\u56fd\u5bb6\u91cd\u5927\u6218\u7565\u9700\u6c42\u3001\u56fd\u6c11\u7ecf\u6d4e\u4e3b\u6218\u573a\uff0c\u5728 *\u3001\u3001** \u7684\u65b0\u8d5b\u9053\u5b9e\u73b0\u5f2f\u9053\u8d85\u8f66</li> </ul> <p>\u80a9\u8d1f\u4f7f\u547d\u7684\u8bfe\u9898\u7ec4\u548c\u5b9e\u9a8c\u5ba4</p> <ul> <li>\u6bcf\u5e74\u751f\u4ea7 50,000 \u884c\u4f4e\u8d28\u91cf\u4ee3\u7801</li> <li>50,000 \u884c\u4ee3\u7801\u4e0d\u5c11</li> <li>\u505a\u4e00\u4e9b incremental/proof-of-concept \u7684\u521b\u65b0\u4e5f\u8db3\u591f\u4e86</li> <li>\u4f46\u4f4e\u8d28\u91cf\u4ee3\u7801\u6539\u53d8\u4e0d\u4e86\u8fd9\u4e2a\u4e16\u754c</li> <li>Linus Torvalds: Nobody actually creates perfect code the first time around, except me. But there\u2019s only one of me.</li> </ul>"},{"location":"courses/os_lab/30_summarize.html#_19","title":"\u4e3a\u4ec0\u4e48\uff1f","text":"<p>\u5386\u53f2\u91cd\u590d\u7684\u4eca\u5929\uff1a\u201c\u591a\u8003\u4e00\u5206\uff0c\u5e72\u6389\u5343\u4eba\u201d</p> <p>\u6f5c\u79fb\u9ed8\u5316\u7684\u4ef7\u503c\u89c2\u548c\u98ce\u9669\u89c2</p> <ul> <li>\u4e0d\u80fd\u5bb9\u5fcd\u4efb\u4f55\u5f62\u5f0f\u7684 \u201c\u5931\u8d25\u201d</li> <li>\u76ee\u6807\u5c31\u662f\u5e72\u6389\u4f60\u7684 peers</li> </ul> <p>\u5927\u5b66\u7684 \u201c\u53bb\u9ad8\u8003\u5316\u201d \u5931\u8d25</p> <ul> <li>\u5377\u5377\u5c31\u80fd\u4fdd\u7814\u4e86\uff0c\u8fd8\u8981\u4ec0\u4e48\u81ea\u884c\u8f66\uff1f</li> <li>\u4e00\u4e2a\u5fae\u5999\u7684 Nash equilibrium\uff1a\u83dc\u9e21\u4e92\u5544\u7684\u56da\u5f92\u56f0\u5883                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </li> </ul>"},{"location":"courses/os_lab/30_summarize.html#_20","title":"\u8fd9\u4e2a\u4e16\u754c\u9700\u8981\u82f1\u96c4","text":"<p>Bill Gates \u5728 1975 \u5e74\u5f00\u53d1 Altair BASIC \u65f6\u5728 Harvard \u7684\u5927\u578b\u673a\u4e0a\u5b9e\u73b0\u4e86\u5168\u7cfb\u7edf\u6a21\u62df\u5668 (Intel 8080A)</p> <ul> <li>\u5357\u4eac\u5927\u5b66\u300a\u8ba1\u7b97\u673a\u7cfb\u7edf\u57fa\u7840\u300b\u8bfe\u7a0b\u82b1\u4e86 40 \u5e74\u65f6\u95f4\u8ffd\u4e0a</li> </ul> <p></p> <p>Remember brick walls let us show our dedication. They are there to separate us from the people who don't really want to achieve their childhood dreams. \u2014\u2014Randy Pausch's last lecture</p> <p></p>"},{"location":"courses/os_lab/30_summarize.html#_21","title":"\u53bb\u505a\u90a3\u4e2a \u201c\u5168\u4e16\u754c\u53ea\u6709\u4f60\u76f8\u4fe1\u201d \u7684\u4e8b","text":"<p>\u98a0\u8986\u6027\u7684\u60f3\u6cd5 (\u201c\u90a3\u4e00\u4e2a\u201d \u82f1\u96c4)</p> <ul> <li>10,000 \u884c\u4ee3\u7801 \u2190 Linux 0.11</li> <li>100,000 \u884c\u4ee3\u7801</li> <li>\u521d\u6b65\u7684\u6280\u672f\u58c1\u5792 (\u4ea7\u4e1a\u5316\u7684\u6f5c\u529b)</li> <li>1,000,000 \u884c\u4ee3\u7801</li> <li>\u201c\u4e09\u4f53\u4eba\u7684\u5c01\u9501\u201d</li> <li>\u53cd\u5236\u4e09\u4f53\u4eba\u7684\u5fc5\u7ecf\u4e4b\u8def (\u201c\u90a3\u4e00\u4e9b\u201d \u65e0\u540d\u7684\u82f1\u96c4)</li> <li>10,000,000 \u884c\u4ee3\u7801</li> <li>\u5de5\u4e1a\u7ea7\u6280\u672f\u7684\u6210\u719f</li> </ul>"},{"location":"courses/os_lab/L0_programming_for_hardware.html","title":"L0: \u4e3a\u8ba1\u7b97\u673a\u786c\u4ef6\u7f16\u7a0b","text":"<p>L0: \u4e3a\u8ba1\u7b97\u673a\u786c\u4ef6\u7f16\u7a0b (jyywiki.cn)</p>"},{"location":"courses/os_lab/L0_programming_for_hardware.html#1","title":"1. \u80cc\u666f","text":"<p>\u5f88\u591a Tutorial \u628a\u786c\u4ef6\u7684\u7ec6\u8282 (\u4f8b\u5982 x86 \u7684 GDT, IDT, TSS, ...) \u548c\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u73b0\u6346\u7ed1\u5728\u4e00\u8d77\uff0c\u5c31\u663e\u5f97\u66f4\u96be\u4e0a\u624b\u3002</p> <p>\u64cd\u4f5c\u7cfb\u7edf\u548c\u786c\u4ef6\u4e4b\u95f4\u7684\u5173\u7cfb\u88ab\u5938\u5927\u4e86\uff1a</p> <ul> <li>\u786c\u4ef6\u7684\u786e\u63d0\u4f9b\u4e86\u5fc5\u8981\u7684\u673a\u5236\u4f7f\u6211\u4eec\u80fd\u5b9e\u73b0\u8bf8\u5982\u8fdb\u7a0b/\u7ebf\u7a0b\u5207\u6362\uff0c\u4f46\u5e76\u4e0d\u610f\u5473\u7740\u9664\u975e\u6211\u4eec\u77e5\u9053\u6709\u5173\u786c\u4ef6\u6307\u4ee4\u7684\u4e00\u5207\u624d\u80fd\u7f16\u5199\u64cd\u4f5c\u7cfb\u7edf\uff1b</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u5728 99.99% \u7684\u65f6\u5019\u90fd\u662f\u666e\u901a\u7684 C \u7a0b\u5e8f\uff0c\u53ea\u662f\u5076\u5c14\u4f1a\u5e72\u4e00\u4e9b \u201c\u51fa\u683c\u201d \u7684\u4e8b\u60c5\uff1b</li> <li>\u5f53\u7136\u4f1a\u5728\u9002\u5f53\u7684\u65f6\u5019\u5f15\u5165\u8fd9\u4e9b\u9a9a (\u9ed1) \u64cd (\u79d1) \u4f5c (\u6280)\uff0c\u4ee5\u53ca\u5b83\u4eec\u662f\u5982\u4f55\u501f\u52a9\u786c\u4ef6\u6307\u4ee4\u548c\u673a\u5236\u5b9e\u73b0\uff1b</li> </ul>"},{"location":"courses/os_lab/L0_programming_for_hardware.html#2","title":"2. \u5b9e\u9a8c\u63cf\u8ff0","text":""},{"location":"courses/os_lab/L0_programming_for_hardware.html#21-abstractmachine","title":"2.1. \u9605\u8bfb AbstractMachine \u6587\u6863","text":"<p>\u9605\u8bfb AbstractMachine \u7684\u6587\u6863</p> <p>\u5efa\u7acb\u4e86\u4e00\u4e9b\u57fa\u672c\u6982\u5ff5\u540e\uff0c\u5c31\u53ef\u4ee5\u8bd5\u7740\u4ece\u6837\u4f8b\u4ee3\u7801\u51fa\u53d1\u5f00\u59cb\u7f16\u7a0b</p> <ul> <li>\u5b9e\u9a8c\u6846\u67b6\u4e2d\u76f4\u63a5\u5305\u542b\u4e86 AbstractMachine \u7684\u4ee3\u7801\u5e76\u5728 Makefile \u4e2d\u5b8c\u6210\u4e86\u914d\u7f6e (RTFSC)\uff0c\u65e0\u9700\u989d\u5916\u914d\u7f6e/\u4e0b\u8f7d</li> </ul>"},{"location":"courses/os_lab/L0_programming_for_hardware.html#21-abstractmachine-klib","title":"2.1.\u5b9e\u73b0 AbstractMachine \u4e2d klib \u4e2d\u7f3a\u5931\u7684\u51fd\u6570","text":"<p>AbstractMachine \u6846\u67b6\u4ee3\u7801\u4e2d\u5305\u542b\u4e00\u4e2a\u57fa\u7840\u8fd0\u884c\u5e93\u7684\u6846\u67b6 klib\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u65b9\u4fbf\u4f60\u7f16\u5199 \u201cbare-metal\u201d \u7a0b\u5e8f\u7684\u7cfb\u5217\u5e93\u51fd\u6570\u3002</p> <ul> <li>\u6ce8\u610f\u591a\u5904\u7406\u5668\u7684\u60c5\u51b5\u4e0b\u5de5\u4f5c\uff1b</li> <li>\u7f16\u5199\u76f8\u5f53\u591a\u7684 assertions\u3002</li> </ul>"},{"location":"courses/os_lab/L0_programming_for_hardware.html#22-abstractmachine","title":"2.2. \u5728 AbstractMachine \u4e2d\u663e\u793a\u4e00\u5f20\u56fe\u7247","text":"<p>\u7f16\u5199\u4e00\u4e2a\u76f4\u63a5\u8fd0\u884c\u5728 AbstractMachine \u4e0a (\u4ec5\u4ec5\u542f\u7528 IOE \u6269\u5c55\uff0c\u4e0d\u4f7f\u7528\u5176\u4ed6\u786c\u4ef6\u673a\u5236\u5982\u4e2d\u65ad/\u5f02\u5e38/\u865a\u62df\u5b58\u50a8/\u591a\u5904\u7406\u5668) \u7684\u7a0b\u5e8f\uff0c\u663e\u793a\u4e00\u5f20\u56fe\u7247\uff1b\u6ee1\u8db3\uff1a</p> <ol> <li>\u663e\u793a\u4e00\u5f20\u4efb\u4f55\u56fe\u7247\uff0c\u4f46\u80fd\u9002\u914d\u4e0d\u540c\u7684\u5c4f\u5e55\u5927\u5c0f\u3002\u786e\u4fdd\u4f60\u7684\u56fe\u7247\u5728 320\u00d7200\u3001640\u00d7480\u3001800\u00d7600 \u7b49\u5206\u8fa8\u7387\u4e0b\u5747\u53ef\u4ee5\u6b63\u5e38\u663e\u793a\uff1b</li> <li>\u56fe\u7247\u4e2d\u5305\u542b\u4e0d\u5c11\u4e8e 10 \u79cd\u989c\u8272\u3002</li> <li>\u7a0b\u5e8f\u4f7f\u7528\u7684\u5185\u5b58 (\u4ee3\u7801\u3001\u9759\u6001\u6570\u636e\u603b\u548c\u4e0d\u8d85\u8fc7 4 MiB\u3001\u5806\u533a <code>heap</code> \u4f7f\u7528\u4e0d\u8d85\u8fc7 4 MiB)\uff1b</li> <li>\u6309 ESC \u952e\u540e\u8c03\u7528 <code>halt()</code> \u9000\u51fa\uff1b\u9664\u6b64\u4e4b\u5916\uff0c\u6309\u4efb\u4f55\u952e\u7a0b\u5e8f\u90fd\u4e0d\u5e94\u9000\u51fa\u3002</li> </ol> <p>\u4f60\u7684\u4ee3\u7801\u5e94\u5f53\u6709\u4e00\u5b9a\u7684\u53ef\u79fb\u690d\u6027\uff1a</p> <ul> <li>\u540c minilabs \u4e00\u6837\uff0c\u4f60\u7684\u7a0b\u5e8f\u53ef\u80fd\u8fd0\u884c\u5728 32/64-bit \u5e73\u53f0\uff0c\u56e0\u6b64\u4f60\u5e94\u5f53\u4f7f\u7528 <code>intptr_t</code> \u6216 <code>uintptr_t</code> \u6765\u4fdd\u5b58\u6307\u9488\u6570\u503c\uff1b</li> <li>\u517c\u5bb9\u5927/\u5c0f\u7aef\uff0c\u56e0\u6b64\u7981\u6b62\u628a\u4e0d\u540c\u5927\u5c0f\u7684\u6307\u9488\u7c7b\u578b\u5f3a\u5236\u8f6c\u6362\uff1b</li> </ul> <p>\u4f1a\u5728 x86_64-qemu (64-bit) \u548c x86-qemu (32-bit) \u4e24\u4e2a\u73af\u5883\u4e0b\u8fd0\u884c\uff0c\u4f60\u7684\u7a0b\u5e8f\u5fc5\u987b\u5728\u4e24\u4e2a\u73af\u5883\u4e0b\u90fd\u80fd\u6b63\u786e\u7f16\u8bd1\u5e76\u8fd0\u884c\u826f\u597d\u3002</p> <p>\u6b64\u5916\uff0cAbstractMachine \u5047\u8bbe bare-metal \u4e0d\u652f\u6301\u6d6e\u70b9\u6570\u6307\u4ee4\u3002\u5728 x86_64 \u7684\u7f16\u8bd1\u9009\u9879\u4e2d\uff0c\u6211\u4eec\u6dfb\u52a0\u4e86 <code>-mno-sse</code>\u3002\u5c3d\u7ba1\u6709\u6d6e\u70b9\u6570\u7684\u7a0b\u5e8f\u5728 <code>ARCH=native</code> \u4e0b\u53ef\u4ee5\u6b63\u786e\u7f16\u8bd1\u8fd0\u884c\uff0c\u4f46\u53ef\u80fd\u5728\u5176\u4ed6\u67b6\u6784\u4e0b\u5931\u6548\u3002\u8fd9\u4e48\u505a\u7684\u76ee\u7684\u662f\u4f7f AbstractMachine \u7a0b\u5e8f\u80fd\u8fd0\u884c\u5728\u5404\u79cd (\u7b80\u5316) \u7684\u5904\u7406\u5668\u4e0a\u3002</p>"},{"location":"courses/os_lab/L0_programming_for_hardware.html#3","title":"3. \u6b63\u786e\u6027\u6807\u51c6","text":"<p>Online Judge \u4f1a\u4e25\u683c\u6309\u7167\u4e0a\u9762\u7684\u8981\u6c42\u6765\u8bc4\u6d4b\uff1a</p> <ol> <li>\u901a\u8fc7 qemu \u7684 <code>-m</code> \u9009\u9879\u9650\u5236\u5185\u5b58\u7684\u5927\u5c0f\uff1b\u4f7f\u7528\u8d85\u8fc7\u89c4\u5b9a\u7684\u5185\u5b58\u53ef\u80fd\u5bfc\u81f4\u7a0b\u5e8f crash\uff1b</li> <li>\u5728\u4e0d\u540c\u7684\u73af\u5883\u4e0b (x86-qemu \u6216 x86_64-qemu, native) \u8fd0\u884c\u4f60\u7684\u7a0b\u5e8f\uff0c\u5e76\u4e14\u53ef\u80fd\u4fee\u6539\u5c4f\u5e55\u7684\u5206\u8fa8\u7387\uff1b</li> <li>\u968f\u673a\u53d1\u9001\u4e00\u5b9a\u7684\u952e\u76d8\u4e8b\u4ef6\u3002</li> </ol> <p>Online Judge \u4f1a\u4f5c\u51fa\u5982\u4e0b\u6b63\u786e\u6027\u68c0\u67e5\uff1a</p> <ol> <li>\u9664\u975e\u6309 ESC \u952e\uff0c\u6211\u4eec\u5047\u8bbe\u7a0b\u5e8f\u4e0d\u7ed3\u675f\uff1b\u5982\u679c\u68c0\u6d4b\u5230 <code>halt()</code> \u7684\u8c03\u7528 (\u5305\u62ec assert \u5931\u8d25\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u589e\u52a0\u4e00\u4e9b\u989d\u5916\u7684\u5408\u6cd5\u6027\u68c0\u67e5)\uff0c\u5c06\u5224\u5b9a\u4e3a\u9519 (Runtime Error \u6216 Wrong Answer)\uff1b</li> <li>\u5982\u679c\u6309 ESC \u952e\u540e\u7a0b\u5e8f\u4e0d\u7ed3\u675f\uff0c\u5c06\u5224\u5b9a\u4e3a\u9519\uff1b</li> <li>\u5982\u679c\u865a\u62df\u673a\u6216\u8fdb\u7a0b\u53d1\u751f\u5d29\u6e83\u3001\u975e\u9884\u671f\u7684\u91cd\u542f\u7b49 (\u7531 undefined behavior \u5bfc\u81f4\uff0c\u4f8b\u5982\u8bbf\u95ee\u67d0\u975e\u6cd5\u5185\u5b58\u53ef\u80fd\u5bfc\u81f4\u5f02\u5e38\u6216 CPU Reset)\uff0c\u5219\u88ab\u5224\u5b9a\u4e3a\u9519\uff1b</li> <li>\u5176\u4ed6\u8fdd\u53cd specifications \u7684\u95ee\u9898\uff0c\u5982\u5728 <code>ioe_init()</code> \u4e4b\u524d\u8c03\u7528 <code>io_read</code>/<code>io_write</code>\uff0c\u5c06\u88ab\u5224\u5b9a\u4e3a\u9519\u3002</li> </ol> <p>\u6b64\u5916\uff0c\u6211\u4eec\u4f1a\u94fe\u63a5\u6211\u4eec klib \u7684\u53c2\u8003\u5b9e\u73b0\uff0c\u56e0\u6b64\u4f60\u4e0d\u5fc5\u62c5\u5fc3\u4f60\u7684 klib \u6709\u4e9b\u8bb8\u95ee\u9898\uff1b\u4f46\u4f60\u8981\u4fdd\u6301 klib \u5e93\u51fd\u6570\u7684\u884c\u4e3a\u4e0e libc \u4e00\u81f4\u3002\u6ce8\u610f native \u4f1a\u94fe\u63a5\u7cfb\u7edf\u672c\u5730\u7684 glibc (\u800c\u975e klib)\u3002</p>"},{"location":"courses/os_lab/L0_programming_for_hardware.html#4","title":"4. \u5b9e\u9a8c\u6307\u5357","text":""},{"location":"courses/os_lab/L0_programming_for_hardware.html#41","title":"4.1. \u5b9e\u73b0\u5e93\u51fd\u6570","text":"<p>\u5728\u7f16\u5199\u53ef\u79fb\u690d\u4ee3\u7801\u65f6\uff0c\u5e94\u5f53\u5c3d\u91cf\u4f7f\u7528 C \u6807\u51c6\u63d0\u4f9b\u7684\u673a\u5236\u3002</p> <ul> <li>\u5bf9\u4e8eprintf \u7684\u53d8\u957f\u53c2\u6570\uff0c\u53ef\u79fb\u690d\u7684\u65b9\u5f0f\u662f\u4f7f\u7528 <code>stdarg.h</code> \u4e2d\u7684 <code>va_list</code>, <code>va_start</code>, <code>va_arg</code>\uff1b</li> </ul>"},{"location":"courses/os_lab/L0_programming_for_hardware.html#42-io","title":"4.2. \u8bbf\u95ee I/O \u8bbe\u5907","text":"<p>TRM\uff08\u56fe\u7075\u673a\uff09 \u4e2d\u552f\u4e00\u80fd\u591f\u548c\u5916\u754c\u4ea4\u4e92\u7684\u624b\u6bb5\u662f <code>putch()</code> \u5728\u8c03\u8bd5\u7ec8\u7aef\u4e0a\u6253\u5370\u5b57\u7b26\u548c <code>halt()</code> \u7ec8\u6b62\u7a0b\u5e8f\u3002\u3002\u6211\u4eec\u7684\u786c\u4ef6\u63d0\u4f9b\u4e86\u82e5\u5e72 I/O \u8bbe\u5907\uff0cAbstractMachine \u53ef\u4ee5\u901a\u8fc7 IOE \u8bbf\u95ee\u5b83\u4eec\u3002\u5728\u8c03\u7528 I/O \u8bbe\u5907\u4e4b\u524d\uff0c\u9700\u8981\u8c03\u7528 <code>ioe_init()</code> \u521d\u59cb\u5316\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u7528</p> <pre><code>void ioe_read (int reg, void *buf);\nvoid ioe_write(int reg, void *buf);\n</code></pre> <p>\u4e24\u4e2a\u51fd\u6570\u8bbf\u95ee AbstractMachine \u4e2d\u7684 I/O \u201c\u5bc4\u5b58\u5668\u201d \u4e86\u3002\u8be6\u60c5\u8bf7\u53c2\u8003 AbstractMachine \u6587\u6863\u548c\u6846\u67b6\u4ee3\u7801\u3002\u5728 <code>klib-macros.h</code> \u4e2d\u5305\u542b\u4e86\u66f4\u7b80\u5316\u7684 I/O \u5bc4\u5b58\u5668\u8bbf\u95ee\u65b9\u6cd5 <code>io_read</code> \u548c <code>io_write</code>\uff0c\u8bf7\u5927\u5bb6\u67e5\u770b\u3002\u7528\u8fd9\u7ec4 API \u4f60\u5c31\u53ef\u4ee5\u7701\u53bb\u624b\u5de5\u5b9a\u4e49\u53d8\u91cf\u7684\u9ebb\u70e6\uff0c\u4f8b\u5982\u76f4\u63a5</p> <pre><code>int width = io_read(AM_GPU_CONFIG).width;\n</code></pre> <p>\u5230\u8fd9\u91cc\uff0c\u5927\u5bb6\u53ef\u80fd\u4f1a\u4ea7\u751f\u7684\u4e00\u4e2a\u7591\u95ee\u662f\uff1a\u8fd0\u884c\u5728 \u201c\u88f8\u673a\u201d \u4e0a\u7684\u7a0b\u5e8f\u53ef\u4ee5\u7528\u54ea\u4e9b\u6807\u51c6\u5e93\uff1f</p> <ul> <li>\u6211\u4eec\u77e5\u9053\uff0clibc \u4e2d\u76f8\u5f53\u4e00\u90e8\u5206\u51fd\u6570\u90fd\u8c03\u7528\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4f8b\u5982 <code>printf</code>, <code>malloc</code> \u7b49\uff0c\u5373\u4fbf\u5f15\u7528\u4e86 <code>stdio.h</code> \u8fd9\u6837\u7684\u5934\u6587\u4ef6\uff0c\u5b83\u4eec\u7684\u5b9e\u73b0\u4f9d\u7136\u662f\u7f3a\u5931\u7684\uff1b</li> <li>\u53e6\u4e00\u65b9\u9762\uff0c\u6211\u4eec\u5f15\u7528\u4e86\u4e00\u4e9b\u5e93\u7684\u5934\u6587\u4ef6\uff0c\u4f8b\u5982 <code>stdint.h</code> (\u5305\u542b\u8bf8\u5982 <code>int32_t</code> \u8fd9\u4e9b\u7c7b\u578b\u7684\u5b9a\u4e49)\u3001<code>stdarg.h</code> \u7b49\uff0c\u5374\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u3002\u8fd9\u662f\u4e3a\u4ec0\u4e48\uff1f</li> </ul> <p>\u4e8b\u5b9e\u4e0a\uff0cAbstractMachine \u7684\u7a0b\u5e8f\u8fd0\u884c\u5728 freestanding \u7684\u73af\u5883\u4e0b (\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684 C \u7a0b\u5e8f\u8fd0\u884c\u5728 hosted \u73af\u5883\u4e0b)\u3002</p> <p>The <code>__STDC_HOSTED__</code> macro expands to <code>1</code> on hosted implementations, or 0 on freestanding ones. The freestanding headers are: <code>float.h</code>, <code>iso646.h</code>, <code>limits.h</code>, <code>stdalign.h</code>, <code>stdarg.h</code>, <code>stdbool.h</code>, <code>stddef.h</code>, <code>stdint.h</code>, and <code>stdnoreturn.h</code>. You should be familiar with these headers as they contain useful declarations you shouldn't do yourself. GCC also comes with additional freestanding headers for CPUID, SSE and such.</p> <p>\u8fd9\u4e9b\u5934\u6587\u4ef6\u4e2d\u5305\u542b\u4e86 freestanding \u7a0b\u5e8f\u4e5f\u53ef\u4f7f\u7528\u7684\u58f0\u660e\u3002\u6709\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u53d1\u73b0\uff0c\u53ef\u53d8\u53c2\u6570\u7ecf\u8fc7\u9884\u7f16\u8bd1\u540e\u751f\u6210\u4e86\u7c7b\u4f3c <code>__builtin_va_arg</code> \u7684 builtin \u8c03\u7528\uff0c\u7531\u7f16\u8bd1\u5668\u7ffb\u8bd1\u6210\u4e86\u7279</p>"},{"location":"courses/os_lab/L0_programming_for_hardware.html#43","title":"4.3. \u7ed8\u5236\u4e00\u4e2a\u56fe\u7247","text":"<p>\u53ea\u8981\u628a\u56fe\u7247\u7684 RGB \u6570\u503c\u5199\u5728\u4ee3\u7801\u91cc\uff0c\u4e0d\u5c31\u53ef\u4ee5\u663e\u793a\u56fe\u7247\u4e86\u5417\uff01\u6ca1\u9519\u3002\u751a\u81f3\u6211\u4eec\u7684 xxd \u5de5\u5177\u90fd\u5e2e\u52a9\u5927\u5bb6\u5b9e\u73b0\u4e86\u8fd9\u4e00\u70b9\uff1a</p> <pre><code>// Generated by: xxd -i /bin/ls\nunsigned char _bin_ls[] = {\n  0x7f, 0x45, 0x4c, 0x46, 0x02, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,\n  0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x3e, 0x00, 0x01, 0x00, 0x00, 0x00,\n  ...\n  0x00, 0x00, 0x00, 0x00\n};\nunsigned int _bin_ls_len = 142144;\n</code></pre> <p>xxd \u53ef\u4ee5\u5c06\u4efb\u4f55\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f6c\u6362\u6210 C/C++ \u53ef\u4ee5\u63a5\u53d7\u7684\u5e38\u91cf\u6570\u7ec4\uff0c\u800c\u4e14\u628a\u6570\u7ec4\u7684\u957f\u5ea6\u4e5f\u56fa\u5b9a\u597d\u3002</p> <p>\u56e0\u6b64\u4f60\u53ef\u4ee5\u5728 \u201ckernel\u201d \u7684\u5916\u90e8\u51c6\u5907\u597d\u4efb\u4f55\u7684\u56fe\u7247\u6570\u636e\u3002\u81f3\u4e8e\u540c\u4e00\u4e2a\u56fe\u7247\u5982\u4f55 \u201c\u62c9\u4f38/\u7f29\u653e\u201d \u5230\u4e0d\u540c\u5206\u8fa8\u7387\uff0c\u8fd9\u5c31\u662f\u4f60\u9700\u8981\u8003\u8651\u7684\u95ee\u9898\u4e86\u2014\u2014\u4e0d\u8fc7\u8fd9\u4e5f\u4e0d\u96be\uff0c\u8bf4\u767d\u4e86\u4f60\u662f\u5e0c\u671b\u5c06\u4e00\u4e2a n\u00d7m \u7684\u77e9\u5f62\u7f51\u683c \u201c\u6295\u5f71\u201d \u5230\u4e00\u4e2a n\u2032\u00d7m\u2032 \u7684\u77e9\u5f62\u7f51\u683c\u4e0a\u2014\u2014\u56e0\u6b64\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u5728\u65b0\u7f51\u683c\u4e0a\u627e\u5230\u65e7\u7f51\u683c \u201c\u6700\u9760\u8fd1\u201d \u7684\u90a3\u4e2a\u4f4d\u7f6e\u5bf9\u5e94\u7684\u50cf\u7d20\u5373\u53ef\u3002</p>"},{"location":"courses/os_lab/L1_pmm.html","title":"L1: \u7269\u7406\u5185\u5b58\u7ba1\u7406 (pmm)","text":""},{"location":"courses/os_lab/L1_pmm.html#1","title":"1. \u80cc\u666f","text":"<p>\u591a\u5904\u7406\u5668\u4e0a\u7684\u7269\u7406\u5185\u5b58\u7ba1\u7406\uff0c\u5177\u4f53\u5b8c\u6210\u7269\u7406\u5185\u5b58\u7684\u5206\u914d\u548c\u56de\u6536\u3002</p>"},{"location":"courses/os_lab/L1_pmm.html#_1","title":"\u8c28\u614e\u4f7f\u7528\u52a8\u6001\u5185\u5b58\u5206\u914d","text":"<p>\u5982\u679c\u4f60\u6ca1\u6709\u5199\u8fc7\u76f8\u5f53\u89c4\u6a21\u7684\u7a0b\u5e8f\uff0c\u5728\u5bf9\u8c61\u7684\u79cd\u7c7b\u589e\u52a0\u65f6\uff0c\u5185\u5b58\u7ba1\u7406\u4f1a\u5e26\u6765\u76f8\u5f53\u9ebb\u70e6\u3002 \u5bf9\u4e8e\u5bf9\u8ff7\u4f60\u81ea\u5236\u64cd\u4f5c\u7cfb\u7edf\u6765\u8bf4\uff0c\u7528\u56fa\u5b9a\u5927\u5c0f\u7684\u6570\u7ec4\u7ba1\u7406\u5bf9\u8c61\u662f\u4e00\u4e2a\u597d\u529e\u6cd5 (xv6 \u4e2d\u5c31\u7ecf\u5e38\u8fd9\u4e48\u505a)\uff0c\u5206\u7c7b\u7ba1\u7406\u7684\u5bf9\u8c61 (\u800c\u4e0d\u662f\u6df7\u5728\u4e00\u4e2a\u5168\u5c40\u7684 \u201c\u6c60\u5b50\u201d \u91cc) \u5bf9\u8c03\u8bd5\u66f4\u53cb\u597d\uff0c\u800c\u4e14\u5bf9\u8c61\u7684\u5927\u5c0f\u901a\u5e38\u6709\u9650\uff0c\u5982\u679c\u5b58\u5728\u6cc4\u6f0f\u4e5f\u5f88\u5bb9\u6613\u89e6\u53d1\u3002</p>"},{"location":"courses/os_lab/L1_pmm.html#2","title":"2. \u5b9e\u9a8c\u63cf\u8ff0","text":""},{"location":"courses/os_lab/L1_pmm.html#21","title":"2.1. \u5b9e\u73b0\u591a\u5904\u7406\u5668\u5b89\u5168\u7684\u5185\u5b58\u5206\u914d\u548c\u56de\u6536","text":"<p>\u5728 AbstractMachine \u542f\u52a8\u540e\uff0c<code>[heap.start, heap.end)</code> \u4f1a\u7ed9\u51fa\u4e00\u6bb5\u53ef\u7528\u7684\u7269\u7406\u5185\u5b58 (\u5806\u533a)\u3002\u4f60\u9700\u8981\u5728\u6b64\u57fa\u7840\u4e0a\u5b9e\u73b0\u5141\u8bb8\u591a\u4e2a\u5904\u7406\u5668\u5e76\u53d1\u5730\u7533\u8bf7\u6216\u91ca\u653e\u5185\u5b58\u7684\u5206\u914d\u5668\uff0c\u5305\u62ec\u4ee5\u4e0b\u4e24\u4e2a\u51fd\u6570\uff1a</p> <pre><code>static void *kalloc(size_t size) {\n  // \u5185\u5b58\u5206\u914d\n}\n\nstatic void kfree(void *ptr) {\n  // \u5185\u5b58\u91ca\u653e\n}\n</code></pre> <p>\u5177\u4f53\u6765\u8bf4\uff0c\u8fd9\u4e2a\u5b9e\u9a8c\u7ef4\u62a4\u4e00\u4e2a\u6570\u636e\u7ed3\u6784 (\u62bd\u8c61\u6570\u636e\u7c7b\u578b)\uff0c\u7ef4\u62a4\u4e00\u4e2a\u4e0d\u76f8\u4ea4\u533a\u95f4\u7684\u96c6\u5408 (\u5806\u533a)</p> <p>\\(H=\\{[l_0,r_0), [l_1,r_1), ..., [l_n,r_n)\\}\\)</p> <p>\u521d\u59cb\u65f6\uff0c\u5806\u533a\u4e3a\u7a7a\u3002\u5047\u8bbe\u5f53\u524d\u5806\u533a\u4e3a \ufffdH\uff0c<code>heap.start</code> =\ufffd =L, <code>heap.end</code> =\ufffd =R\uff0c\u4f60\u9700\u8981\u5b9e\u73b0\u7684\u64cd\u4f5c\u6709\uff1a</p> <ul> <li>\\(kalloc (s)\\) \u5206\u914d s \u5b57\u8282\u7684\u5185\u5b58 \\([l,r)\\)\u6ee1\u8db3\uff1a</li> <li>\u5206\u914d\u53d1\u751f\u5728\u5806\u533a\u4e2d $L \\le l \\le r \\le R $</li> <li>\u5206\u914d\u7684\u5185\u5b58\u4e0d\u4e0e\u5df2\u5206\u914d\u5185\u5b58\u91cd\u53e0 \\(\\forall [l_i,r_i] \\in H. [l,r) \\cap [l_i, r_i) = \\empty]\\)</li> <li>\u5206\u914d\u540e\u65b0\u7684\u5806\u533a \\(H^{'} = H \\cup \\{[l,r)\\}\\)</li> <li> <p>\u8fd4\u56de\u5206\u914d\u533a\u95f4\u7684\u5de6\u7aef\u70b9 \\(l\\)</p> </li> <li> <p>\\(kfree(l)\\)\u5220\u9664\u4e00\u4e2a\u5df2\u6709\u533a\u95f4\\([l,r]\\in H\\)\uff0c\u5f97\u5230\u65b0\u7684\u5806\u533a \\(H^{'} = H \\textbackslash {[l,r)}\\)</p> </li> <li>\u5f53 \\(l\\) \u4e0d\u662f \\(H\\) \u4e2d\u4efb\u4f55\u4e00\u4e2a\u533a\u95f4\u5de6\u8282\u70b9\u65f6\uff0c\u4ea7\u751f undefined behavior \u2014\u2014\u5373 kfree \u7684\u8c03\u7528\u8005\u6709\u4e49\u52a1\u4fdd\u8bc1\u4e00\u5b9a\u91ca\u653e\u4e00\u4e2a\u5df2\u5206\u914d\u7684\u7a7a\u95f4\u3002</li> </ul> <p>\u4f5c\u4e3a\u8ba1\u7b97\u673a\u7cfb\u7edf\u8f6f\u4ef6\u57fa\u7840\u8bbe\u65bd\u7684\u8981\u6c42\uff1a</p> <ul> <li>\u5bf9\u4e8e\u5927\u5c0f\u4e3a s \u7684\u5185\u5b58\u5206\u914d\u8bf7\u6c42\uff0c\u8fd4\u56de\u7684\u5185\u5b58\u5730\u5740\u5fc5\u987b\u5bf9\u9f50\u5230\\(2^i\\)\uff0c\u5176\u4e2d \\(i\\) \u662f\u6700\u5c0f\u7684\u6b63\u6574\u6570\u6ee1\u8db3\\(2^i \\ge s\\)\u3002\u4f8b\u5982\uff0c4 KiB \u7684\u5185\u5b58\u5206\u914d\u8bf7\u6c42\u8fd4\u56de\u7684\u5730\u5740\u5fc5\u987b\u662f 4,096 \u7684\u6574\u6570\u500d (\u9875\u9762\u8fb9\u754c)\u3002\u4f8b\u5982\uff0c\u5206\u914d 17 \u5b57\u8282\u5185\u5b58\u8fd4\u56de\u7684\u5730\u5740\u5fc5\u987b\u662f 32 \u7684\u6574\u6570\u500d\u3002\u8fd9\u4e48\u8981\u6c42\u5176\u5b9e\u7b80\u5316\u4e86\u5927\u5bb6\u7684\u5b9e\u73b0\u3002</li> <li>\u5728\u4f60\u7684\u5206\u914d\u7b97\u6cd5\u4e0d\u80fd\u627e\u5230\u8db3\u591f\u7684\u5185\u5b58\u53ef\u4ee5\u5206\u914d\u65f6\uff0c\u8fd4\u56de NULL(0)\u3002</li> <li>\u53d7\u5206\u914d\u7b97\u6cd5\u7684\u5c40\u9650\uff0c\u53ef\u80fd\u7cfb\u7edf\u4e2d\u4ecd\u7136\u6709\u7a7a\u95f2\u7684\u5185\u5b58\uff0c\u4f46\u5f62\u6210\u4e86\u788e\u7247\u7684\u5185\u5b58\uff0c\u6216\u662f\u4f60\u7684\u7b97\u6cd5\u4e0d\u80fd\u627e\u5230\u5b83\u4ece\u800c\u5206\u914d\u5931\u8d25\u3002\u8fd9\u662f\u5141\u8bb8\u7684\uff1b\u4f46\u5728\u7cfb\u7edf\u5185\u5b58\u538b\u529b\u5f88\u5c0f\u7684\u65f6\u5019\u4f9d\u7136\u9891\u7e41\u5206\u914d\u5931\u8d25\uff0c\u53ef\u80fd\u5bfc\u81f4 hard test failure\u3002</li> <li>\u7531\u4e8e\u6211\u4eec\u5728\u81ea\u5236\u7684\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4e2d\u4f7f\u7528\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u62d2\u7edd\u8d85\u8fc7 16 MiB \u7684\u5185\u5b58\u5206\u914d\u3002</li> <li>\u4e0d\u5fc5\u521d\u59cb\u5316\u8fd4\u56de\u7684\u5185\u5b58\uff0c\u5f53\u7136\uff0c\u5bf9\u8fd4\u56de\u7684\u5185\u5b58\u8d4b\u4e0a\u521d\u59cb\u503c (\u4f8b\u5982\u96f6) \u4e5f\u8bb8\u662f\u4e2a\u4e0d\u9519\u7684\u4e3b\u610f\u3002</li> <li>\u5141\u8bb8\u591a\u5904\u7406\u5668\u5e76\u884c\u5730\u8c03\u7528 kalloc/kfree\uff1a</li> <li>\u4e0d\u540c\u7684\u5904\u7406\u5668\u53ef\u80fd\u540c\u65f6\u6267\u884c kalloc \u5206\u914d\u5927\u5c0f\u4e0d\u540c\u7684\u5185\u5b58\uff1b</li> <li>\u4e0d\u540c\u7684\u5904\u7406\u5668\u53ef\u80fd\u540c\u65f6\u6267\u884c kfree \u91ca\u653e\u5185\u5b58\uff1b</li> <li>\u5728\u4e00\u4e2a\u5904\u7406\u5668\u5206\u914d\u7684\u5185\u5b58\uff0c\u53ef\u80fd\u5728\u53e6\u4e00\u4e2a\u5904\u7406\u5668\u4e0a\u91ca\u653e\uff1b\u4f46\u6211\u4eec\u4fdd\u8bc1\u6211\u4eec\u7684\u6d4b\u8bd5\u4ee3\u7801\u4e2d\u4e0d\u5b58\u5728\u6570\u636e\u7ade\u4e89\uff1b</li> <li>\u5728 kalloc/kfree \u5b9e\u73b0\u6b63\u786e\u7684\u524d\u63d0\u4e0b\uff0c\u5c3d\u53ef\u80fd\u4f7f\u4e0d\u540c\u5904\u7406\u5668\u4e0a\u7684\u5185\u5b58\u5206\u914d\u80fd\u591f\u5e76\u884c\u3002\u5982\u679c\u4f60\u4ee3\u7801\u7684\u6027\u80fd\u8fc7\u4f4e (\u4f8b\u5982\u7528\u5168\u5c40\u7684\u9501\u4fdd\u62a4\u7a7a\u95f2\u94fe\u8868\uff0c\u5e76\u7528\u904d\u5386\u94fe\u8868\u7684\u65b9\u5f0f\u5bfb\u627e\u53ef\u7528\u7684\u5185\u5b58)\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4 hard test failure\u3002</li> </ul>"},{"location":"courses/os_lab/L1_pmm.html#22-hard-tests","title":"2.2. \u6027\u80fd\u4f18\u5316 (Hard Tests)","text":"<p>\u591a\u5904\u7406\u5668\u4e0a\u7684\u5185\u5b58\u5206\u914d\u548c\u91ca\u653e\u5e26\u6765\u989d\u5916\u7684\u6311\u6218\uff1a</p> <ol> <li>\u6211\u4eec\u5e0c\u671b\u4fdd\u8bc1\u5206\u914d\u7684\u6b63\u786e\u6027\u3002\u8fd9\u610f\u5473\u7740\u7528\u4e00\u628a\u5927\u9501\u4fdd\u62a4\u4e00\u4e2a\u4e32\u884c\u6570\u636e\u7ed3\u6784 (\u4f8b\u5982\u7b97\u6cd5\u5bfc\u8bba\u4e0a\u7684 \u201c\u533a\u95f4\u6811\u201d \u5c31\u80fd\u5728 O(logn) \u7684\u65f6\u95f4\u5185\u5b8c\u6210\u5206\u914d\u548c\u91ca\u653e\u64cd\u4f5c) \u5c31\u80fd\u6b63\u786e\u5b9e\u73b0\u591a\u5904\u7406\u5668\u4e0a\u7684\u5185\u5b58\u5206\u914d\u3002</li> <li>\u6211\u4eec\u5e0c\u671b\u4fdd\u8bc1\u5206\u914d\u5728\u591a\u5904\u7406\u5668\u4e0a\u7684\u6027\u80fd\u548c\u4f38\u7f29\u6027 (scalability)\u3002\u8fd9\u610f\u5473\u7740\u4e0d\u540c\u7684\u5904\u7406\u5668\u80fd\u591f\u5e76\u884c\u5730\u7533\u8bf7\u5185\u5b58\uff0c\u5c3d\u53ef\u80fd\u51cf\u5c11\u56e0\u4e3a\u540c\u65f6\u7533\u8bf7\u800c\u53d1\u751f\u4e00\u4e2a\u5904\u7406\u5668\u7b49\u53e6\u4e00\u4e2a\u5904\u7406\u5668\u7684\u60c5\u51b5\u3002</li> </ol> <p>\u4e0a\u9762\u4e24\u70b9\u9700\u6c42\u662f\u77db\u76fe\u7684\uff0c\u8fd9\u4e5f\u662f\u672c\u6b21\u5b9e\u9a8c\u7684\u91cd\u70b9\u6311\u6218\u3002\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u91cc\uff0c\u6211\u4eec\u901a\u8fc7 \u201csystem\u201d \u7684\u65b9\u6cd5\u89e3\u51b3\u95ee\u9898\uff0c\u800c\u4e0d\u662f\u5de7\u5999\u7684\u7b97\u6cd5/\u6570\u636e\u7ed3\u6784\u2014\u2014\u8fd9\u4e0d\u610f\u5473\u7740\u7b97\u6cd5/\u6570\u636e\u7ed3\u6784\u5728\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e2d\u6ca1\u6709\u5e94\u7528\uff0c\u53ea\u662f\u5728\u8fd9\u4e2a\u95ee\u9898\u4e0a\u5e76\u4e0d\u975e\u5e38\u5fc5\u8981\u3002</p>"},{"location":"courses/os_lab/L1_pmm.html#23-abstractmachine-klib","title":"2.3. \u5b9e\u73b0 AbstractMachine \u4e2d klib \u4e2d\u7f3a\u5931\u7684\u51fd\u6570","text":"<p>\u5728 Lab0 \u4e2d\uff0c\u6211\u4eec\u5df2\u7ecf\u63d0\u51fa\u4e86\u8fd9\u4e2a\u5b9e\u9a8c\u8981\u6c42\u3002\u8fd9\u4e2a\u5b9e\u9a8c\u5efa\u8bae\u5927\u5bb6\u5b9e\u73b0 klib \u91cc\u7f3a\u5931\u7684\u51fd\u6570\u2014\u2014\u6ca1\u6709 printf, sprintf \u7b49\u51fd\u6570\uff0c\u4f60\u6839\u672c\u5c31\u662f\u5728\u7528\u6c47\u7f16\u8bed\u8a00\u5199\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4f60\u65e0\u6cd5\u6d3b\u5230\u6700\u540e\u3002\u6211\u4eec\u4e0d\u4f1a\u68c0\u67e5\u5927\u5bb6\u7684 klib \u5b9e\u73b0\uff0c\u4f46\u4e5f\u8bf7\u5927\u5bb6\u4e0d\u8981\u6284\u88ad\u2014\u2014\u867d\u7136\u4e92\u8054\u7f51\u4e0a\u6709\u5f88\u591a\u4ee3\u7801\uff0c\u4f46\u81ea\u5df1\u5199\u4e00\u904d\u4f9d\u7136\u662f\u638c\u63e1\u8fd9\u4e9b\u5e93\u51fd\u6570\u539f\u7406\u7684\u6700\u597d\u65b9\u5f0f\u3002</p>"},{"location":"courses/os_lab/L1_pmm.html#3","title":"3. \u6b63\u786e\u6027\u6807\u51c6","text":""},{"location":"courses/os_lab/L1_pmm.html#31","title":"3.1. \u6d4b\u8bd5\u7528\u4f8b\u8bf4\u660e","text":"<p>\u4e3a\u4e86\u5f3a\u8feb\u5927\u5bb6\u4f7f\u7528\u52a8\u6001\u7684\u65b9\u5f0f\u7ba1\u7406\u5927\u5c0f\u4e0d\u540c\u7684\u5806\u533a\uff0c\u6211\u4eec\u89c4\u5b9a\u4f60\u4f7f\u7528\u7684\u6240\u6709\u9759\u6001\u5185\u5b58 (64-bit \u6a21\u5f0f\u4e0b\u7684\u4ee3\u7801\u3001\u6570\u636e\u3001bss) \u4e0d\u80fd\u8d85\u8fc7 1 MiB\u3002\u6211\u4eec\u5c06\u4f1a\u5728\u8fd0\u884c\u4e4b\u524d\u5bf9\u5185\u6838\u4f7f\u7528 size \u547d\u4ee4\u8fdb\u884c\u68c0\u67e5\uff0c\u5e76\u62d2\u7edd\u8fc7\u5927\u7684 kernel\u3002\u7ba1\u7406\u5806\u533a\u7684\u6570\u636e\u7ed3\u6784\u5e94\u5f53\u5728\u5806\u533a\u4e2d\u800c\u4e0d\u662f\u9759\u6001\u533a\u4e2d\u8fdb\u884c\u5206\u914d\u3002</p> <p>\u6211\u4eec\u4f1a\u4f7f\u7528\u6765\u81ea\u7c7b\u4f3c\u4e8e\u771f\u5b9e\u64cd\u4f5c\u7cfb\u7edf\u7cfb\u7edf\u5185\u6838\u7684 workload (\u591a\u5904\u7406\u5668) \u6765\u6d4b\u8bd5\u5927\u5bb6\u7684\u7a0b\u5e8f\u3002\u7cfb\u7edf/workload \u7684\u4e00\u4e9b\u5047\u8bbe\uff1a</p> <ul> <li>\u4e0d\u8d85\u8fc7 8 \u4e2a\u5904\u7406\u5668\u3001\u4e0d\u5c11\u4e8e 64 MiB\u3001\u4e0d\u591a\u4e8e 4 GiB \u5185\u5b58\u7684\u5806\u533a\uff1b</li> <li>\u5927\u91cf\u3001\u9891\u7e41\u7684\u5c0f\u5185\u5b58\u5206\u914d/\u91ca\u653e\uff1b\u5176\u4e2d\u7edd\u5927\u90e8\u5206\u4e0d\u8d85\u8fc7 128 \u5b57\u8282\uff1b</li> <li>\u8f83\u4e3a\u9891\u7e41\u7684\uff0c\u4ee5\u7269\u7406\u9875\u9762\u5927\u5c0f\u4e3a\u5355\u4f4d\u7684\u5206\u914d/\u91ca\u653e (4 KiB)\uff1b</li> <li>\u975e\u5e38\u7f55\u89c1\u7684\u5927\u5185\u5b58\u5206\u914d\u3002</li> </ul> <p>\u6211\u4eec\u9884\u671f\u4f60\u7684 kalloc/kfree \u5177\u6709\u8db3\u591f\u7684 robustness\uff0c\u8db3\u4ee5\u627f\u8f7d\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7684\u5b9e\u73b0:</p> <ol> <li>Safety: \u6211\u4eec\u9884\u671f\u4f60\u7684 kalloc/kfree \u5b9e\u73b0\u662f\u6b63\u786e\u7684\u3002\u4e00\u65e6\u4ee5\u4e0b\u60c5\u51b5\u53d1\u751f\uff0c\u5c06\u88ab\u7acb\u5373\u88ab Online Judge \u5224\u5b9a\u4e3a\u9519\u8bef\uff1a</li> <li>\u865a\u62df\u673a\u91cd\u542f\u3001crash\u3001\u6d4b\u8bd5\u4ee3\u7801\u4e2d\u7684 assert fail \u7b49 (\u901a\u5e38\u7531 undefined behavior \u89e6\u53d1\uff0c\u4f8b\u5982\u6570\u636e\u7ade\u4e89)</li> <li>kalloc \u7684\u8fd4\u56de\u503c\u4e0d\u6ee1\u8db3 API \u89c4\u7ea6\uff0c\u4f8b\u5982\u5206\u914d\u7684\u5185\u5b58\u4e0d\u4f4d\u4e8e\u5806\u533a\u3001\u9519\u8bef\u7684\u5185\u5b58\u5bf9\u9f50\u7b49</li> <li>kalloc \u8fd4\u56de\u4e00\u6bb5\u5c1a\u672a\u88ab kfree \u7684\u5185\u5b58</li> <li>Liveness: \u6211\u4eec\u8fd8\u9700\u8981\u7cfb\u7edf\u6709\u4e00\u5b9a\u7684 liveness\uff0c\u5373\u7cfb\u7edf\u4e2d\u6709\u5145\u8db3\u5269\u4f59\u5185\u5b58\u65f6\uff0c\u5185\u5b58\u5206\u914d\u4e0d\u5e94\u8fc7\u4e8e\u9891\u7e41\u7684\u9891\u7e41\u5931\u8d25\u3002\u8fd9\u662f\u4e3a\u4e86\u9632\u6b62\u4f60\u4e3a\u4e86 safety \u8fdb\u884c\u4e00\u4e9b \u201c\u6295\u673a\u53d6\u5de7\u201d\uff1a\u5bf9\u6240\u6709 kalloc \u90fd\u8fd4\u56de <code>NULL</code>\uff0csafety trivially \u88ab\u6ee1\u8db3\u3002</li> <li>liveness \u5e76\u4e0d\u662f\u4e00\u4e2a \u201c\u786c\u6027\u201d \u7684\u8981\u6c42\u3002\u5728\u5408\u7406\u7684 workload \u4e0a\uff0c\u4f60\u7a0b\u5e8f\u7684\u8868\u73b0\u53ea\u8981\u4e0d\u6bd4\u4e00\u4e2a (\u5b9e\u73b0\u5f97\u975e\u5e38\u4e00\u822c) \u7684 baseline \u5dee\u592a\u591a (\u4f60\u4f9d\u7136\u5141\u8bb8\u5728\u67d0\u4e9b\u4f60\u8ba4\u4e3a\u65e0\u6cd5\u6ee1\u8db3\u7684 kalloc \u4e0a\u8fd4\u56de <code>NULL</code>)\uff0c\u5c31\u4f1a\u88ab\u5224\u5b9a\u4e3a\u6b63\u786e</li> </ol> <p>\u4e0e L0 \u7c7b\u4f3c\uff0c\u6211\u4eec\u4f1a\u94fe\u63a5\u6211\u4eec klib \u7684\u53c2\u8003\u5b9e\u73b0\uff0c\u56e0\u6b64\u4f60\u4e0d\u5fc5\u62c5\u5fc3\u4f60\u7684 klib \u6709\u4e9b\u8bb8\u95ee\u9898\uff1b\u4f46\u4f60\u8981\u4fdd\u6301 klib \u5e93\u51fd\u6570\u7684\u884c\u4e3a\u4e0e libc \u4e00\u81f4\u3002\u6ce8\u610f native \u4f1a\u94fe\u63a5\u7cfb\u7edf\u672c\u5730\u7684 glibc (\u800c\u975e klib)\u3002</p>"},{"location":"courses/os_lab/L1_pmm.html#32-online-judge","title":"3.2. Online Judge \u8fd0\u884c\u6d4b\u8bd5\u4ee3\u7801\u7684\u65b9\u5f0f","text":"<p>\u6211\u4eec\u4f1a\u66ff\u6362 <code>framework/main.c</code> \u7684\u4ee3\u7801\uff0c\u4f46\u4fdd\u6301\u7684 <code>src/</code> \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u4e0d\u53d8\u3002\u56e0\u6b64\uff0c\u4f60\u81ea\u5df1\u7684\u6d4b\u8bd5\u7528\u4f8b (\u5728 <code>os_run()</code> \u4e2d) \u53ef\u4ee5\u4e0d\u5fc5\u4fee\u6539\u3002\u6d4b\u8bd5\u65f6\uff0c\u6211\u4eec\u4f1a\u6539\u53d8 <code>mpe_init</code> \u7684\u5165\u53e3 (\u4e0d\u518d\u4ece <code>os-&gt;run</code> \u5f00\u59cb\u6267\u884c\uff0c\u800c\u662f\u76f4\u63a5\u8fd0\u884c\u6d4b\u8bd5\u7684 workload)\u3002\u56e0\u6b64\u4f60\u5fc5\u987b\u5728 <code>os-&gt;init()</code> \u4e2d\u5b8c\u6210\u6240\u6709\u5fc5\u8981\u7684\u521d\u59cb\u5316\uff0c\u4f8b\u5982\u8c03\u7528 <code>pmm-&gt;init()</code>\u3002</p> <p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u6211\u4eec\u6d4b\u8bd5\u4ee3\u7801\u7684\u4f8b\u5b50\uff0c\u5b83\u4f1a\u4e0d\u65ad\u751f\u6210\u968f\u673a\u7684 kalloc/kfree \u8bf7\u6c42 (\u4f60\u53ef\u4ee5\u5047\u8bbe\u6211\u4eec\u7684\u751f\u6210\u5668\u603b\u662f\u751f\u6210\u5408\u6cd5\u7684\u8bf7\u6c42\uff0c\u4f8b\u5982\u4e0d\u4f1a\u53d1\u751f double-free \u7b49)\uff0c\u5e76\u4e14\u68c0\u67e5 kalloc/kfree \u8fd4\u56de\u7ed3\u679c\u7684\u5408\u6cd5\u6027\uff1b\u5f53\u68c0\u6d4b\u5230\u95ee\u9898\u540e\u4f1a assert fail \u9000\u51fa\uff0c\u7136\u540e\u4f60\u53ef\u80fd\u4f1a\u5f97\u5230 \u201cRuntime Error\u201d\u3002</p> <pre><code>#include &lt;common.h&gt;\n#include &lt;klib.h&gt;\n\nenum ops { OP_ALLOC = 1, OP_FREE };\nstruct malloc_op {\n  enum ops type;\n  union { size_t sz; void *addr; };\n};\n\nvoid stress_test() {\n  while (1) {\n    struct malloc_op op = random_op();\n    switch (op.type) {\n      case OP_ALLOC: alloc_check(pmm-&gt;alloc(op.sz), op.sz); break;\n      case OP_FREE:  free(op.addr); break;\n    }\n  }\n}\n\nint main() {\n  os-&gt;init();\n  mpe_init(stress_test);\n}\n</code></pre>"},{"location":"courses/os_lab/L1_pmm.html#4","title":"4. \u5b9e\u9a8c\u6307\u5357","text":""},{"location":"courses/os_lab/L1_pmm.html#41","title":"4.1. \u4ee3\u7801\u7ec4\u7ec7\u4e0e\u8fd0\u884c","text":"<p>\u5b9e\u9a8c\u6846\u67b6\u4ee3\u7801\u7531\u4e09\u4e2a\u76ee\u5f55\u7ec4\u6210\uff1a</p> <pre><code>.\n\u251c\u2500\u2500 framework  -&gt; \u6846\u67b6\u4ee3\u7801\uff1b\u53ef\u4ee5\u5728\u672c\u5730\u4fee\u6539\uff0c\u4f46 Online Judge \u8bc4\u6d4b\u65f6\u4f1a\u88ab\u66ff\u6362\u6210\u6211\u4eec\u7684\u7248\u672c\n\u2502   \u251c\u2500\u2500 kernel.h\n\u2502   \u2514\u2500\u2500 main.c\n\u251c\u2500\u2500 include    -&gt; \u5934\u6587\u4ef6\uff1b\u53ef\u4ee5\u81ea\u7531\u4fee\u6539/\u521b\u5efa\u6587\u4ef6 (Online Judge \u4f1a\u590d\u5236)\n\u2502   \u2514\u2500\u2500 common.h\n\u251c\u2500\u2500 Makefile\n\u2514\u2500\u2500 src        -&gt; \u6e90\u6587\u4ef6\uff1b\u53ef\u4ee5\u81ea\u7531\u4fee\u6539/\u521b\u5efa\u6587\u4ef6 (Online Judge \u4f1a\u590d\u5236)\n    \u251c\u2500\u2500 os.c\n    \u2514\u2500\u2500 pmm.c\n</code></pre> <p>\u9605\u8bfb make \u547d\u4ee4\u67e5\u770b make\u7684\u8f93\u51fa\uff1a</p> <ul> <li>\u53ef\u4ee5 <code>:%s/^/\\r</code> \u5728\u547d\u4ee4\u4e4b\u95f4\u63d2\u5165\u7a7a\u884c\uff1b<code>:%s/ /\\r /g</code> \u5c06\u547d\u4ee4\u7684\u53c2\u6570\u7f29\u8fdb\u6392\u7248</li> </ul> <pre><code>$ make -nB # RTFM!\n... (\u5b8c\u5168\u4e0d\u53ef\u8bfb\u7684\u8f93\u51fa)\n</code></pre>"},{"location":"courses/os_lab/L1_pmm.html#42","title":"4.2. \u6846\u67b6\u4ee3\u7801\u5bfc\u8bfb","text":"<p>\u6846\u67b6\u4ee3\u7801\u5f88\u77ed\uff0c\u5b83\u7684 <code>main</code> \u51fd\u6570\u9996\u5148\u6267\u884c <code>os</code> \u7684\u521d\u59cb\u5316\uff0c\u7136\u540e\u542f\u52a8\u591a\u4e2a\u5904\u7406\u5668\uff0c\u6bcf\u4e2a\u5904\u7406\u5668\u90fd\u8df3\u8f6c\u5230 <code>os-&gt;run</code> \u6267\u884c\uff1a</p> <pre><code>int main() {\n  os-&gt;init();\n  mpe_init(os-&gt;run);\n  return 1;\n}\n</code></pre> <p><code>os</code> \u662f\u4e00\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u7684 \u201c\u6a21\u5757\u201d\uff0c\u53ef\u4ee5\u770b\u6210\u662f\u6211\u4eec\u7528 C \u5b9e\u73b0\u7684\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\uff0c\u80fd\u589e\u52a0\u4ee3\u7801\u7684\u53ef\u8bfb\u6027\u3002\u6574\u4e2a\u6846\u67b6\u4ee3\u7801\u4e2d\u552f\u4e00\u6709\u4e9b\u96be\u4ee5\u7406\u89e3\u7684\u90e8\u5206\u5c31\u662f\u6a21\u5757\u7684\u58f0\u660e\u548c\u5b9a\u4e49 (<code>framework/kernel.h</code>)\uff1a</p> <pre><code>#define MODULE(mod) \\\n  typedef struct mod_##mod##_t mod_##mod##_t; \\\n  extern mod_##mod##_t *mod; \\\n  struct mod_##mod##_t\n\n#define MODULE_DEF(mod) \\\n  extern mod_##mod##_t __##mod##_obj; \\\n  mod_##mod##_t *mod = &amp;__##mod##_obj; \\\n  mod_##mod##_t __##mod##_obj\n</code></pre> <p>\u6211\u4eec\u7528 <code>MODULE</code> \u58f0\u660e\u4e00\u4e2a\u6a21\u5757\uff0c\u7528 <code>MODULE_DEF</code> \u5b9e\u9645\u5b9a\u4e49\u5b83\u3002</p> <p>\u8fd9\u4e2a\u5b8f\u7684\u89c6\u89c9\u6548\u679c\u5f88\u5dee\uff0c\u4e3a\u4e86\u9605\u8bfb\u5b83\uff0c\u5927\u5bb6\u4e0d\u59a8\u53ef\u4ee5\u5728\u521a\u624d\u770b\u5230\u7684\u7f16\u8bd1\u547d\u4ee4\u4e2d\u628a <code>-c -o ...</code> \u66ff\u6362\u6210 <code>-E</code>\uff0c\u5c31\u5f97\u5230\u4e86\u9884\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\uff1a</p> <pre><code>typedef struct mod_os_t mod_os_t;\nextern mod_os_t *os;\nstruct mod_os_t {\n  void (*init)();\n  void (*run)();\n};\n\n...\n\nextern mod_os_t __os_obj;\nmod_os_t *os = &amp;__os_obj;\nmod_os_t __os_obj = {\n  .init = os_init,\n  .run = os_run,\n};\n</code></pre> <p>\u7136\u540e\u4f60\u5c31\u53ef\u4ee5\u5bf9\u7167\u7740\u9605\u8bfb\u9884\u7f16\u8bd1\u7684\u4ee3\u7801 (\u7528\u5bf9\u4e86\u65b9\u6cd5\uff0c\u4e5f\u5c31\u6ca1\u6709\u90a3\u4e48\u96be\u4e86)\uff0c\u53ea\u9700\u8981\u8bb0\u4f4f\u4ee5\u4e0b\u4e24\u70b9\uff1a</p> <ol> <li>\u5b8f\u662f\u5b57\u9762\u66ff\u6362\uff0c<code>MODULE(mod)</code> \u4e2d\u6240\u6709\u7684 \u201c<code>mod</code>\u201d \u90fd\u4f1a\u88ab\u66ff\u6362\u6389\uff1b</li> <li><code>##</code> \u662f C \u8bed\u8a00\u7528\u6765\u62fc\u63a5\u6807\u8bc6\u7b26\u7684\u673a\u5236\uff0c<code>sys##tem</code> \u5c06\u4f1a\u5f97\u5230 <code>system</code>;</li> </ol> <p>\u5982\u679c\u4f60\u9605\u8bfb\u4e0a\u8ff0\u4ee3\u7801\u611f\u5230\u969c\u788d\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u8865\u5145\uff1a(1) <code>typedef</code> \u7c7b\u578b\u522b\u540d\u5b9a\u4e49, (2) <code>extern</code> \u5173\u952e\u5b57, (3) C11 \u7ed3\u6784\u4f53\u521d\u59cb\u5316\u7684\u77e5\u8bc6\u3002\u53e6\u5916\uff0c\u4e0b\u5212\u7ebf <code>_</code> \u4e5f\u53ef\u4ee5\u662f\u6807\u8bc6\u7b26\u7684\u4e00\u90e8\u5206\u3002</p> <p>\u968f\u7740\u5b9e\u9a8c\u7684\u8fdb\u5c55\uff0c\u4f60\u4f1a\u53d1\u73b0\u6a21\u5757\u673a\u5236\u6e05\u6670\u5730\u52fe\u52d2\u51fa\u4e86\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5404\u4e2a\u90e8\u5206\u4ee5\u53ca\u5b83\u4eec\u4e4b\u95f4\u7684\u4ea4\u4e92\uff0c\u80fd\u591f\u5e2e\u52a9\u5927\u5bb6\u66f4\u597d\u5730\u7406\u89e3\u64cd\u4f5c\u7cfb\u7edf\u7684\u5b9e\u73b0\u539f\u7406\u3002</p>"},{"location":"courses/os_lab/L1_pmm.html#43","title":"4.3. \u6846\u67b6\u4ee3\u7801\u7684\u6267\u884c","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\uff0c\u76ee\u524d\u53ea\u6709\u4e24\u4e2a\u51fd\u6570\uff1a</p> <ul> <li><code>os-&gt;init()</code> \u5b8c\u6210\u64cd\u4f5c\u7cfb\u7edf\u6240\u6709\u90e8\u5206\u7684\u521d\u59cb\u5316\u3002<code>os-&gt;init()</code> \u8fd0\u884c\u5728\u7cfb\u7edf\u542f\u52a8\u540e\u7684\u7b2c\u4e00\u4e2a\u5904\u7406\u5668\u4e0a\uff0c\u4e2d\u65ad\u5904\u4e8e\u5173\u95ed\u72b6\u6001\uff1b\u6b64\u65f6\u7cfb\u7edf\u4e2d\u7684\u5176\u4ed6\u5904\u7406\u5668\u5c1a\u672a\u88ab\u542f\u52a8\u3002\u56e0\u6b64\u5728 <code>os-&gt;init</code> \u7684\u5b9e\u73b0\u4e2d\uff0c\u4f60\u5b8c\u5168\u4e0d\u5fc5\u8003\u8651\u6570\u636e\u7ade\u4e89\u7b49\u591a\u5904\u7406\u5668\u4e0a\u7684\u95ee\u9898\u3002</li> <li><code>os-&gt;run()</code> \u662f\u6240\u6709\u5904\u7406\u5668\u7684\u5165\u53e3\uff0c\u5728\u521d\u59cb\u5316\u5b8c\u6210\u540e\uff0c\u6846\u67b6\u4ee3\u7801\u8c03\u7528 <code>_mpe_init(os-&gt;run)</code> \u542f\u52a8\u6240\u6709\u5904\u7406\u5668\u6267\u884c\u3002\u6846\u67b6\u4ee3\u7801\u4e2d\uff0c<code>os-&gt;run</code> \u53ea\u662f\u6253\u5370 Hello World \u4e4b\u540e\u5c31\u5f00\u59cb\u6b7b\u5faa\u73af\uff1b\u4f60\u4e4b\u540e\u53ef\u4ee5\u5728 <code>os-&gt;run</code> \u4e2d\u6dfb\u52a0\u5404\u79cd\u6d4b\u8bd5\u4ee3\u7801\u3002</li> </ul> <p>\u6240\u4ee5\u5c31\u60f3\u8c61\u6210\u662f\u4f60\u7684 <code>os-&gt;run()</code> \u5c31\u662f <code>threads.h</code> \u91cc\u521b\u5efa\u7684\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u4ec5\u6b64\u800c\u5df2\uff01</p>"},{"location":"courses/os_lab/L1_pmm.html#_2","title":"\u597d\u6d88\u606f\uff1a\u5b9e\u9a8c\u505a\u51fa\u7684\u7b80\u5316","text":"<p>\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u6211\u4eec\u53ea\u542f\u52a8\u4e86 AbstractMachine \u4e2d\u7684 TRM \u548c MPE\uff0c\u56e0\u6b64\u4f60\u4e0d\u5fc5\u8003\u8651\u4e2d\u65ad\u548c\u591a\u5904\u7406\u5668\u540c\u65f6\u5e26\u6765\u7684\u8bf8\u591a\u9ebb\u70e6 (\u4e0b\u4e00\u4e2a\u5b9e\u9a8c\u624d\u5f00\u59cb\u8003\u8651)\u3002\u4f60\u4e0d\u59a8\u628a\u6bcf\u4e2a\u5904\u7406\u5668\u60f3\u8c61\u6210\u4e00\u4e2a\u7ebf\u7a0b\u3002</p>"},{"location":"courses/os_lab/L1_pmm.html#44-kallockfree","title":"4.4. \u5b9e\u73b0 kalloc/kfree","text":"<p>\u5b9e\u73b0\u4e3b\u8981\u5728 pmm (physical memory management) \u6a21\u5757\uff1a</p> <pre><code>MODULE(pmm) {\n  void  (*init)();\n  void *(*alloc)(size_t size);\n  void  (*free)(void *ptr);\n};\n</code></pre> <p>\u6a21\u5757\u5305\u542b\u4e09\u4e2a\u51fd\u6570\u6307\u9488\uff1a</p> <ul> <li><code>pmm-&gt;init()</code> \u521d\u59cb\u5316 pmm \u6a21\u5757\uff0c\u5b83\u5e94\u5f53\u5728\u591a\u5904\u7406\u5668\u542f\u52a8\u524d (<code>os-&gt;init()</code> \u4e2d) \u8c03\u7528\u3002\u4f60\u4f1a\u5728\u8fd9\u91cc\u5b8c\u6210\u6570\u636e\u7ed3\u6784\u3001\u9501\u7684\u521d\u59cb\u5316\u7b49\uff1b</li> <li><code>pmm-&gt;alloc()</code> \u5bf9\u5e94\u5b9e\u9a8c\u8981\u6c42\u4e2d\u7684 kalloc\uff1b</li> <li><code>pmm-&gt;free()</code> \u5bf9\u5e94\u5b9e\u9a8c\u8981\u6c42\u4e2d\u7684 kfree\u3002</li> </ul> <p>\u6846\u67b6\u4ee3\u7801\u4e2d\u5305\u542b\u4e86 \u201c\u7a7a\u7684\u201d pmm \u5b9e\u73b0\uff0c\u5b83\u5bf9\u4efb\u4f55\u5185\u5b58\u5206\u914d\u7684\u8bf7\u6c42\u90fd\u8fd4\u56de\u5931\u8d25\uff0c\u56e0\u6b64\u5b83\u6ee1\u8db3 safety\uff0c\u4f46\u5b8c\u5168\u6ca1\u6709 liveness\uff0c\u4eff\u4f5b\u5806\u533a\u7684\u5927\u5c0f\u4e3a\u96f6\uff1a</p> <pre><code>static void *kalloc(size_t size) { return NULL; }\nstatic void kfree(void *ptr) { } \nstatic void pmm_init() { } \nMODULE_DEF(pmm) = {\n  .init  = pmm_init,\n  .alloc = kalloc,\n  .free  = kfree,\n};\n</code></pre> <p>\u5728\u8bb2\u89e3 \u201c\u5e76\u53d1\u6570\u636e\u7ed3\u6784\u201d \u65f6\u8bb2\u89e3\u4e86 kalloc/free \u7684\u7b97\u6cd5\u548c\u5b9e\u73b0\u3002\u4f60\u5e94\u8be5\u9605\u8bfb\uff1a</p> <ul> <li>\u6559\u79d1\u4e66\u7b2c 29 \u7ae0 (\u5e76\u53d1\u6570\u636e\u7ed3\u6784)\uff0c\u5b66\u4e60\u5982\u4f55\u5bf9\u6570\u636e\u7ed3\u6784\u8fdb\u884c\u5e76\u53d1\u63a7\u5236\uff1b</li> <li>\u6559\u79d1\u4e66\u7b2c 17 \u7ae0 (\u7a7a\u95f2\u7a7a\u95f4\u7ba1\u7406)\uff0c\u5b66\u4e60\u5982\u4f55\u7ba1\u7406\u7269\u7406\u5185\u5b58\uff1b</li> <li>\u4e92\u8054\u7f51\u4e0a\u7684\u5176\u4ed6\u8d44\u6599\u3002\u5982\u679c\u4f60\u5e0c\u671b\u4e86\u89e3\u73b0\u4ee3 malloc \u5b9e\u73b0\uff0c\u4f60\u53ef\u4ee5\u53c2\u8003\u6765\u81ea\u4e24\u4e2a\u4ee3\u7801\u5de8\u5934\u7684\u8bbe\u8ba1\uff1aGoogle \u7684 tcmalloc \u548c Microsoft \u7684 mimalloc\u3002</li> </ul>"},{"location":"courses/os_lab/L1_pmm.html#static","title":"\u601d\u8003\u9898\uff1astatic \u51fd\u6570","text":"<p>\u4e3a\u4ec0\u4e48 kalloc/kfree/pmm_init \u58f0\u660e\u6210\u4e86 <code>static</code>\uff1f\u6211\u628a <code>static</code> \u53bb\u6389\u4f9d\u7136\u53ef\u4ee5\u7f16\u8bd1\u5440\uff1f</p> <p>\u8fd9\u662f\u4e00\u4e2a\u597d\u7684\u7f16\u7a0b\u4e60\u60ef\uff0c\u5728 C \u8fd9\u6837\u7f3a\u5c11 module/package/namespace \u673a\u5236\u7684\u7f16\u7a0b\u8bed\u8a00\u4e0a\u6709\u6548\u51cf\u5c11\u610f\u5916\u53d1\u751f\u3002</p>"},{"location":"courses/os_lab/L1_pmm.html#45","title":"4.5. \u6d4b\u8bd5/\u8c03\u8bd5\u4f60\u7684\u4ee3\u7801","text":""},{"location":"courses/os_lab/L1_pmm.html#451","title":"4.5.1. \u505a\u4e00\u4e2a\u6d4b\u8bd5\u6846\u67b6","text":"<p>AbstractMachine \u4ee3\u7801\u7684\u8c03\u8bd5\u5e76\u4e0d\u5bb9\u6613\u2014\u2014\u4e0d\u8bba\u662f native \u8fd8\u662f\u8fd0\u884c\u5728\u6a21\u62df\u5668\u91cc\uff0cAM APIs \u90fd\u548c\u7cfb\u7edf\u6709\u7d27\u5bc6\u7684\u8026\u5408\u3002\u5927\u5bb6\u6709\u6ca1\u6709\u60f3\u8fc7\uff0c\u4f60\u4eec\u7684\u4ee3\u7801\u662f\u5426\u53ef\u4ee5\u94fe\u63a5 <code>threads.h</code> \u76f4\u63a5\u8fd0\u884c\u6d4b\u8bd5\u5462\uff1f\u7b54\u6848\u5f53\u7136\u662f\u80af\u5b9a\u7684\uff01\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u91cc\uff0c\u505a\u4e00\u4e2a\u6d4b\u8bd5\u6846\u67b6\u5bf9\u4f60\u627e\u5230 bug \u5176\u5b9e\u662f\u975e\u5e38\u6709\u7528\u7684\u3002</p> <p>\u4f60\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a test \u76ee\u5f55\uff0c\u7528\u4e8e\u5b58\u653e\u548c\u6d4b\u8bd5\u76f8\u5173\u7684\u4ee3\u7801\uff0c\u4f8b\u5982\u6211\u4eec\u63d0\u4f9b\u7684 <code>threads.h</code>:</p> <pre><code>$ tree test \ntest\n\u251c\u2500\u2500 am.h # \u4e00\u4e2a\u7a7a\u7684 am.h\n\u251c\u2500\u2500 common.h\n\u251c\u2500\u2500 test.c\n\u2514\u2500\u2500 threads.h # \u4e0a\u8bfe\u65f6\u7ed9\u51fa\u7684\u4ee3\u7801\n</code></pre> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u6240\u6709\u7684\u64cd\u4f5c\u7cfb\u7edf/\u6846\u67b6\u4ee3\u7801\u7b49\u90fd\u548c\u4e4b\u524d\u4fdd\u6301\u4e00\u81f4\u2014\u2014\u6211\u4eec\u901a\u8fc7\u6700\u5c0f\u7684\u3001\u975e\u4fb5\u5165\u5f0f\u7684\u9879\u76ee\u4fee\u6539\u786e\u4fdd\u4f60\u5728\u4efb\u4f55\u65f6\u5019\u90fd\u53ef\u4ee5\u901a\u8fc7 <code>make submit</code> \u76f4\u63a5\u63d0\u4ea4\u4ee3\u7801\u800c\u4e0d\u9700\u8981\u505a\u51fa\u4efb\u4f55\u989d\u5916\u7684\u4fee\u6539\u3002\u8fd9\u4e9b\u81ea\u52a8\u5de5\u5177/\u4ee3\u7801\u6846\u67b6\u5bf9\u4e8e\u505a\u5b9e\u9a8c (\u5305\u62ec\u505a Online Judge) \u90fd\u662f\u975e\u5e38\u503c\u5f97\u7684\u3002</p> <p>\u4e3a\u4e86\u8ba9\u6211\u4eec\u7684\u4ee3\u7801\u80fd\u591f\u517c\u5bb9\uff0c\u4f60\u53ef\u4ee5\u9700\u8981\u589e\u52a0\u4e00\u4e9b\u6761\u4ef6\u7f16\u8bd1\uff0c\u4f8b\u5982\uff0c\u5728 <code>pmm.c</code> \u4e2d\uff0c\u867d\u7136\u4f60\u7684 <code>kalloc</code> \u548c <code>kfree</code> \u7684\u5b9e\u73b0\u53ef\u4ee5\u4fdd\u6301\u4e0d\u53d8\uff0c\u4f46\u521d\u59cb\u5316\u4ee3\u7801\u5219\u9700\u8981\u4e0d\u540c\uff1a</p> <pre><code>#ifndef TEST\n// \u6846\u67b6\u4ee3\u7801\u4e2d\u7684 pmm_init (\u5728 AbstractMachine \u4e2d\u8fd0\u884c)\nstatic void pmm_init() {\n  uintptr_t pmsize = ((uintptr_t)heap.end - (uintptr_t)heap.start);\n  printf(\"Got %d MiB heap: [%p, %p)\\n\", pmsize &gt;&gt; 20, heap.start, heap.end);\n}\n#else\n// \u6d4b\u8bd5\u4ee3\u7801\u7684 pmm_init ()\nstatic void pmm_init() {\n  char *ptr  = malloc(HEAP_SIZE);\n  heap.start = ptr;\n  heap.end   = ptr + HEAP_SIZE;\n  printf(\"Got %d MiB heap: [%p, %p)\\n\", HEAP_SIZE &gt;&gt; 20, heap.start, heap.end);\n}\n#endif\n</code></pre> <p>\u5728\u4f60\u76f8\u5e94\u5b8c\u6210\u4e24\u4e2a\u4e0d\u540c\u73af\u5883\u7684\u6761\u4ef6\u7f16\u8bd1\u540e\uff0c\u5728\u4f60\u7684 Makefile \u91cc\u589e\u52a0\u4e00\u4e2a\u7f16\u8bd1\u76ee\u6807 (\u6211\u4eec\u6dfb\u52a0\u4e86 git \u7684\u4f9d\u8d56\uff0c\u4f7f\u5f97\u4f60\u7684\u63d0\u4ea4\u88ab\u6b63\u786e\u8ffd\u8e2a)\uff1a</p> <pre><code>test: git\n        @gcc $(shell find src/ -name \"*.c\")  \\\n             $(shell find test/ -name \"*.c\") \\\n             -Iframework -Itest -DTEST -lpthread \\\n             -o build/test\n        @build/test\n</code></pre> <p>\u7136\u540e\u5c31\u53ef\u4ee5\u6109\u5feb\u5730\u5199\u6d4b\u8bd5\u4ee3\u7801\u5566 (<code>test.c</code>):</p> <pre><code>static void entry(int tid) { pmm-&gt;alloc(128); }\nstatic void goodbye()      { printf(\"End.\\n\"); }\nint main() {\n  pmm-&gt;init();\n  for (int i = 0; i &lt; 4; i++)\n    create(entry);\n  join(goodbye);\n}\n</code></pre>"},{"location":"courses/os_lab/L1_pmm.html#_3","title":"\u628a\u65f6\u95f4\u6295\u8d44\u5728\u6846\u67b6\u5efa\u8bbe\u4e0a","text":"<p>\u4f60\u53ef\u80fd\u9700\u8981\u82b1\u4e00\u70b9\u65f6\u95f4\u624d\u80fd\u5b8c\u6210 <code>make</code> \u548c <code>make test</code> \u5171\u7528\u540c\u4e00\u4efd kalloc/kfree \u4ee3\u7801\u7684\u6846\u67b6\u3002\u4f46\u8fd9\u7edd\u5bf9\u662f\u503c\u5f97\u7684\u3002\u4e00\u65e6\u5b8c\u6210\uff0c\u76f4\u63a5\u6d4b\u8bd5/\u8c03\u8bd5\u672c\u5730\u4ee3\u7801\u7684\u597d\u5904\u662f\u5de8\u5927\u7684\u2014\u2014\u5b83\u8282\u7701\u4e86\u7f16\u8bd1\u3001\u8fd0\u884c\u3001\u8c03\u8bd5\u2026\u2026\u6574\u4e2a\u5f00\u53d1\u6d41\u7a0b\u7684 overhead\u3002\u4efb\u4f55\u60f3\u7528 \u201c\u86ee\u529b\u201d \u628a\u5b9e\u9a8c\u7cca\u5f04\u8fc7\u53bb\u90fd\u5c06\u5bfc\u81f4\u5de8\u5927\u7684\u65f6\u95f4\u6d6a\u8d39\u3002</p>"},{"location":"courses/os_lab/L1_pmm.html#452","title":"4.5.2. \u8bbe\u8ba1\u6d4b\u8bd5\u7528\u4f8b","text":"<p>\u5982\u679c\u4e0d\u60f3\u88ab Online Judge \u6298\u78e8\u5f97\u6b7b\u53bb\u6d3b\u6765\uff0c\u4f60\u5e94\u5f53\u8bbe\u8ba1\u4e00\u4e2a\u81ea\u5df1\u7684\u6d4b\u8bd5\u6846\u67b6\uff0c\u5c1d\u8bd5\u4e0d\u540c\u7c7b\u578b\u7684\u6d4b\u8bd5\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>\u9488\u5bf9\u6570\u636e\u7ed3\u6784\u7684\u5355\u5143\u6d4b\u8bd5\uff1b</li> <li>\u6700\u57fa\u672c\u7684 smoke test\uff0c\u6d4b\u8bd5\u5355\u7ebf\u7a0b\u7248\u672c\u662f\u5426\u6b63\u786e\uff1b</li> <li>\u57fa\u672c\u7684\u5e76\u53d1\u6d4b\u8bd5\uff0c\u4f8b\u5982\u591a\u4e2a\u5904\u7406\u5668\u5e76\u53d1\u5730\u5206\u914d (\u4f46\u4e0d\u56de\u6536)\uff1b</li> <li>\u9488\u5bf9\u56de\u6536\u4e13\u95e8\u8bbe\u8ba1\u7684\u6d4b\u8bd5\uff1b</li> <li>\u6781\u7aef\u60c5\u51b5\u4e0b\u7684\u538b\u529b\u6d4b\u8bd5 (\u6211\u4eec\u4f1a\u8fd9\u4e48\u505a\uff01)</li> <li>\u5728\u591a\u4e2a\u5904\u7406\u5668\u4e0a\u6a21\u62df\u5404\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f<ul> <li>\u9891\u7e41\u7684\u5c0f\u5185\u5b58\u7533\u8bf7\uff1b</li> <li>\u9891\u7e41\u7684\u5927\u5185\u5b58\u7533\u8bf7\uff1b</li> <li>\u6df7\u5408\u7684\u5185\u5b58\u7533\u8bf7\uff1b</li> <li>\u591a\u5904\u7406\u5668\u7ade\u4e89\u7684\u7533\u8bf7/\u91ca\u653e\u2026\u2026</li> </ul> </li> <li>\u4f60\u8fd8\u9700\u8981\u6709\u4e2a\u529e\u6cd5\u9a8c\u8bc1\u4f60\u7684 kalloc/free \u662f\u5426\u6b63\u786e<ul> <li>\u4e00\u4e2a\u53ef\u884c\u7684\u65b9\u6848\u662f\uff0c\u6bcf\u6b21\u5206\u914d/\u91ca\u653e\u90fd\u7528 printf \u6253\u5370\u4e00\u6761\u8bb0\u5f55\uff0c\u7136\u540e\u518d\u5199\u4e00\u4e2a\u5c0f\u811a\u672c\u89e3\u6790\u8bb0\u5f55\uff0c\u786e\u4fdd\u4f8b\u5982\u540c\u4e00\u6bb5\u5185\u5b58\u6ca1\u6709\u88ab\u5206\u914d\u7ed9\u4e24\u4e2a kalloc\u3002</li> </ul> </li> </ul> <p>\u8fd9\u65f6\u5019\uff0c\u4ee3\u7801\u6846\u67b6\u7684\u5a01\u529b\u5c31\u663e\u793a\u51fa\u6765\u4e86\uff01\u4f60\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u6279\u91cf\u8fd0\u884c\u5f88\u591a\u6d4b\u8bd5\uff0c\u4f8b\u5982</p> <pre><code>int main(int argc, char *argv[]) {\n  if (argc &lt; 2) exit(1);\n  switch(atoi(argv[1])) {\n    case 0: do_test_0();\n    case 1: do_test_1();\n    ...\n  }\n}\n</code></pre> <p>\u7136\u540e\u5728\u4f60\u7684 Makefile \u91cc\u6279\u91cf\u8fd0\u884c\u5b83\u4eec\uff1a</p> <pre><code>testall: test\n        @build/test 0\n        @build/test 1\n        @build/test 2\n        ...\n</code></pre>"},{"location":"courses/os_lab/L1_pmm.html#_4","title":"\u8b66\u60d5\u5e76\u53d1","text":"<p>\u5f88\u53ef\u80fd\u4f60\u7684\u987a\u5e8f\u6d4b\u8bd5\u5b8c\u5168\u901a\u8fc7\uff0c\u4f46\u591a\u5904\u7406\u5668\u8dd1\u8d77\u6765\u5c31\u6302\u4e86\u3002\u4e0d\u8981\u614c\uff0c\u591a\u52a0\u70b9 printf logs\uff0c\u6162\u6162\u8bca\u65ad\u53ef\u80fd\u7684\u95ee\u9898\u3002\u7136\u540e\u4f60\u53ef\u80fd\u4f1a\u60ca\u5947\u5730\u53d1\u73b0\uff0c\u4e5f\u8bb8\u52a0\u4e86\u4e00\u4e2a printf\uff0c\u9519\u8bef\u5c31\u4e0d\u89c1\u4e86\u3002\u6b64\u65f6\u7684\u5efa\u8bae\u662f\u8c03\u6574 workloads\u3001\u589e\u52a0\u5ef6\u8fdf\u7b49\u4fdd\u8bc1 bug \u7684\u7a33\u5b9a\u518d\u73b0\uff0c\u7136\u540e\u518d\u8fdb\u884c\u8bca\u65ad\u3002\u5982\u679c\u4f60\u5e0c\u671b\u5b9e\u73b0\u5404\u79cd fancy \u7684\u7b97\u6cd5\uff0c\u4e0d\u59a8\u4ece\u4e00\u628a\u5927\u9501\u4fdd\u62a4 kalloc/free \u5f00\u59cb\u3002\u8fd9\u662f\u4e2a\u4e0d\u9519\u7684\u4e3b\u610f\u2014\u2014\u8fd9\u6837\u4f60\u4e00\u5f00\u59cb\u5c31\u53ea\u9700\u8981\u5173\u6ce8\u5355\u7ebf\u7a0b kalloc/free \u7684\u6b63\u786e\u6027\u3002\u5f53\u4f60\u9700\u8981\u6027\u80fd\u7684\u65f6\u5019\uff0c\u518d\u9010\u6b65\u628a\u9501\u62c6\u5f00\u3002</p>"},{"location":"courses/os_lab/L1_pmm.html#453","title":"4.5.3 \u6027\u80fd\u8c03\u4f18","text":"<p>\u4f60\u9700\u8981\u9009\u53d6\u9002\u5f53\u7684 workload \u8fdb\u884c\u8c03\u4f18\uff0c\u5e76\u4e14\u7406\u89e3\u4f60\u7a0b\u5e8f\u7684\u6027\u80fd\u74f6\u9888\u5728\u54ea\u91cc\u3002\u8fd9\u65f6\u5019\uff0c\u9760 \u201c\u731c\u201d \u548c\u968f\u673a\u4fee\u6539\u7a0b\u5e8f\u4ee5\u83b7\u5f97\u6027\u80fd\u63d0\u5347\u7684\u65b9\u5f0f\u662f\u4e0d\u4e13\u4e1a\u7684\u8868\u73b0\u3002\u7406\u89e3\u7a0b\u5e8f\u6027\u80fd\u7684\u6700\u597d\u65b9\u6cd5\u662f\u4f7f\u7528\u6b63\u786e\u7684\u5de5\u5177\uff1aprofiler\u3002\u4f5c\u4e3a\u672c\u5730\u8fdb\u7a0b\u8fd0\u884c\u7684\u6d4b\u8bd5\u7528\u4f8b\u4e5f\u80fd\u66f4\u5bb9\u6613\u5730 profile\u2014\u2014\u4f60\u53ef\u4ee5\u7528 Linux \u7cfb\u7edf\u81ea\u5e26\u7684\u5404\u79cd\u5de5\u5177\u627e\u5230\u4f60\u5b9e\u73b0\u7684\u6027\u80fd\u74f6\u9888\u3002\u5f53\u7136\uff0c\u8fd9\u4e2a\u5b9e\u9a8c\u5bf9\u6027\u80fd\u7684\u8981\u6c42\u5e76\u4e0d\u9ad8\uff0c\u5927\u5bb6\u4f53\u9a8c\u4e00\u4e0b\u5373\u53ef\u3002</p> <p>\u5f53\u7136\uff0c\u8fd9\u4e2a\u5b9e\u9a8c\u7ed9\u5927\u5bb6\u7684\u5267\u900f\u662f\uff1a\u5982\u679c\u6570\u636e\u7ed3\u6784\u9009\u62e9\u5f97\u4e0d\u592a\u5dee\uff0c\u6027\u80fd\u74f6\u9888\u5c31\u4e3b\u8981\u5728\u4e8e\u591a\u4e2a\u7ebf\u7a0b\u5e76\u53d1\u8bbf\u95ee\u65f6\u7684\u4e92\u65a5\uff0c\u7531\u4e8e\u591a\u4e2a\u7ebf\u7a0b\u90fd\u9700\u8981\u83b7\u5f97\u540c\u4e00\u628a\u9501\uff0c\u5c31\u4f1a\u51fa\u73b0 \u201c\u4e00\u6838\u51fa\u529b\u3001\u4ed6\u4eba\u56f4\u89c2\u201d \u7684\u60c5\u51b5\u3002\u6b63\u5982\u8bfe\u672c\u4e0a\u6240\u8bf4\uff0c\u73b0\u4ee3 malloc/free \u5b9e\u73b0\u7684\u4e3b\u8981\u601d\u60f3\u5c31\u662f\u533a\u5206 fast/slow path\uff0c\u4f7f\u5f97 fast path \u5206\u914d\u5728\u7ebf\u7a0b\u672c\u5730\u5b8c\u6210\uff0c\u4ece\u800c\u4e0d\u4f1a\u9020\u6210\u9501\u7684\u4e89\u62a2\u3002\u4f60\u4e5f\u53ef\u4ee5\u4e3a\u6bcf\u4e2a CPU \u5206\u914d\u9875\u9762\u7684\u7f13\u5b58\u2014\u2014\u53ef\u4ee5\u501f\u9274 slab\uff0c\u4e5f\u53ef\u4ee5\u9884\u5148\u628a\u9875\u9762\u5206\u914d\u7ed9 CPU\uff0c\u5728\u5185\u5b58\u4e0d\u8db3\u65f6\u518d\u4e0a\u9501\u4ece\u5176\u4ed6 CPU \u201c\u5077\u53d6\u201d \u9875\u9762\u3002</p>"},{"location":"courses/os_lab/L1_pmm.html#workload","title":"\u629b\u5f00 workload \u8c08\u4f18\u5316\uff0c\u5c31\u662f\u800d\u6d41\u6c13","text":"<p>Premature optimization is the root of all evil. \u2014\u2014 D. E. Knuth</p> <p>\u8981\u8003\u8651\u597d\u4f60\u4f18\u5316\u7684\u573a\u666f\uff0c\u5426\u5219\u4e00\u5207\u90fd\u662f\u7a7a\u8c08\u3002</p>"},{"location":"courses/os_lab/L1_pmm.html#5","title":"5. \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u5185\u5b58\u7ba1\u7406","text":"<p>\u5f88\u591a\u73b0\u4ee3\u7f16\u7a0b\u8bed\u8a00\u90fd\u8fd0\u884c\u5728\u81ea\u52a8\u7ba1\u7406\u5185\u5b58\u7684\u7684\u8fd0\u884c\u65f6\u73af\u5883\u4e0a\uff1aJava, Python, Javascript, ...\u5b83\u4eec\u7684\u7279\u70b9\u662f\uff1a\u6ca1\u6709 raw pointer\uff0c\u4e5f\u6ca1\u6709 API \u7528\u4e8e \u201c\u91ca\u653e\u201d \u5185\u5b58\u3002\u5f53\u4e00\u4e2a\u5bf9\u8c61\u4ece\u4e00\u7cfb\u5217\u7684 root objects (\u4f8b\u5982\u6808\u4e0a\u7684\u5c40\u90e8\u53d8\u91cf\u3001\u5168\u5c40\u53d8\u91cf\u7b49\u2026\u2026) \u901a\u8fc7\u5f15\u7528\u5173\u7cfb\u4e0d\u53ef\u8fbe\uff0c\u5b83\u4eec\u5c31\u4f1a\u81ea\u52a8\u88ab\u8fd0\u884c\u65f6\u73af\u5883\u56de\u6536\u3002\u8fd9\u771f\u662f\u7a0b\u5e8f\u5458\u7684\u798f\u97f3\u2014\u2014\u518d\u4e5f\u6ca1\u6709 use-after-free, double-free \u7b49\u95ee\u9898\u4e86\uff0cmemory leak \u7684\u53ef\u80fd\u6027\u4e5f\u5927\u5927\u964d\u4f4e (\u867d\u7136\u4f9d\u7136\u53ef\u80fd\u4f1a\u6709)\u3002</p> <p>\u5f53\u7136\uff0c\u81ea\u52a8\u5185\u5b58\u7ba1\u7406\u5e26\u6765\u7684\u95ee\u9898\u662f\u5185\u5b58\u56de\u6536\u662f\u4e2a highly non-trivial \u7684\u95ee\u9898\uff0c\u81f3\u4eca\u4ecd\u7136\u4e0d\u80fd\u7b97\u5f7b\u5e95\u5b8c\u7f8e\u5730\u89e3\u51b3\uff0c\u751f\u4ea7\u7cfb\u7edf\u4f9d\u7136\u7ecf\u5e38\u53d7\u5230\u5783\u573e\u56de\u6536 (\u56de\u6536\u4e0d\u53ef\u8fbe\u5bf9\u8c61) \u505c\u987f/\u964d\u4f4e\u6027\u80fd\u7684\u56f0\u6270\u3002\u7531\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684\u6027\u80fd\u81f3\u5173\u91cd\u8981\uff0c\u8ba9\u5783\u573e\u56de\u6536\u5360\u636e\u5904\u7406\u5668\u8fd0\u884c\u4f3c\u4e4e\u4e0d\u662f\u4e2a\u597d\u4e3b\u610f\u2026\u2026\u672a\u5fc5\uff01</p> <ul> <li>\u9605\u8bfb\u6750\u6599\uff1aCody Cutler, M. Frans Kaashoek, and Robert T. Morris. The benefits and costs of writing a POSIX kernel in a high-level language. In Proc. of OSDI, 2018. (\u786c\u6838/\u4e13\u4e1a\u4eba\u58eb\u8b66\u544a)</li> </ul> <p>\u5f53\u7136\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7684\u6709\u8da3\u6545\u4e8b\u4e5f\u6ca1\u6709\u505c\u8fc7\uff1a</p> <ul> <li>Kevin Boos, Namitha Liyanage, Ramla Ijaz, and Lin Zhong. Theseus: An experiment in operating system structure and state management. In Proc. of OSDI, 2020.</li> </ul>"},{"location":"courses/os_lab/L2_kmt.html","title":"L2: \u5185\u6838\u7ebf\u7a0b\u7ba1\u7406 (kmt)","text":"<p>\u672c\u5b9e\u9a8c\u5728 L1 \u4ee3\u7801\u7684\u57fa\u7840\u4e0a\u5b8c\u6210\u3002\u4f46\u5982\u679c\u4f60\u5b8c\u5168\u6ca1\u6709\u5b8c\u6210 L1\uff0c\u4f9d\u7136\u53ef\u4ee5\u5408\u5e76\u4ee3\u7801\u5e76\u5f00\u59cb L2 (\u4f8b\u5982\u4f7f\u7528\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684 kalloc/kfree \u5b9e\u73b0)\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#1","title":"1. \u80cc\u666f","text":"<p>\u5b9e\u73b0\u591a\u5904\u7406\u5668\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4e2d\u7684\u5185\u6838\u7ebf\u7a0b API (\u5c31\u50cf pthreads \u5e93\uff0c\u6216\u662f\u8bfe\u5802\u4e0a\u5c55\u793a\u7684 <code>thread.h</code>)\u3002\u5728\u5b8c\u6210\u8fd9\u4e2a\u5b9e\u9a8c\u540e\uff0c\u4f60\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a\u771f\u6b63\u53ef\u4ee5\u5e76\u884c\u8fd0\u884c\u591a\u4efb\u52a1\u7684\u5d4c\u5165\u5f0f\u64cd\u4f5c\u7cfb\u7edf\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#2","title":"2. \u5b9e\u9a8c\u63cf\u8ff0","text":""},{"location":"courses/os_lab/L2_kmt.html#21","title":"2.1 \u5b9e\u9a8c\u603b\u89c8","text":"<p>\u8fd9\u4e2a\u5b9e\u9a8c\u5728 pmm \u7684\u57fa\u7840\u4e0a\uff0c\u589e\u52a0\u4e2d\u65ad\u548c\u7ebf\u7a0b\u7ba1\u7406\u7684\u529f\u80fd\uff0c\u5141\u8bb8\u64cd\u4f5c\u7cfb\u7edf\u4ee3\u7801\u6ce8\u518c\u4e2d\u65ad\u53d1\u751f\u65f6\u7684\u56de\u8c03\u51fd\u6570\u548c\u521b\u5efa\u7ebf\u7a0b\uff1a</p> <ul> <li>\u76f8\u6bd4 Lab1, os \u6a21\u5757\u4e2d\u65b0\u589e\u4e86 <code>trap</code> \u548c <code>on_irq</code> \u4e24\u4e2a\u51fd\u6570\uff0c\u5206\u522b\u662f\u7cfb\u7edf\u4e2d\u552f\u4e00\u4e2d\u65ad/\u7cfb\u7edf\u8c03\u7528\u7684\u5165\u53e3\u548c\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u7684\u56de\u8c03\u6ce8\u518c\uff1b</li> <li>pmm \u6a21\u5757\u4fdd\u6301\u4e0d\u53d8\uff0c\u4f60\u53ef\u4ee5\u6cbf\u7528 Lab1 \u7684\u5b9e\u73b0\uff0c\u4f46\u56e0\u4e3a\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\u591a\u4e86\u4e2d\u65ad\uff0c\u4f60\u9700\u8981\u5bf9\u4f60\u5df2\u6709\u7684\u4ee3\u7801\u505a\u4e00\u4e9b\u5c0f\u7684\u589e\u5f3a\uff0c\u4e3b\u8981\u662f\u81ea\u65cb\u9501\u9700\u8981\u4fdd\u8bc1\u4e0d\u88ab\u4e2d\u65ad\u6253\u65ad\uff1b</li> <li>\u65b0\u589e\u4e86 kmt \u6a21\u5757\uff0c\u4f60\u9700\u8981\u5b8c\u6210 <code>struct task</code>, <code>struct spinlock</code>, <code>struct semaphore</code> \u7684\u5b9a\u4e49\u5e76\u5b9e\u73b0\u5176\u4e2d\u5168\u90e8\u7684 API\u3002</li> </ul> <pre><code>typedef Context *(*handler_t)(Event, Context *);\nMODULE(os) {\n  void (*init)();\n  void (*run)();\n  Context *(*trap)(Event ev, Context *context);\n  void (*on_irq)(int seq, int event, handler_t handler);\n};\n\nMODULE(pmm) {\n  void  (*init)();\n  void *(*alloc)(size_t size);\n  void  (*free)(void *ptr);\n};\n\ntypedef struct task task_t;\ntypedef struct spinlock spinlock_t;\ntypedef struct semaphore sem_t;\nMODULE(kmt) {\n  void (*init)();\n  int  (*create)(task_t *task, const char *name, void (*entry)(void *arg), void *arg);\n  void (*teardown)(task_t *task);\n  void (*spin_init)(spinlock_t *lk, const char *name);\n  void (*spin_lock)(spinlock_t *lk);\n  void (*spin_unlock)(spinlock_t *lk);\n  void (*sem_init)(sem_t *sem, const char *name, int value);\n  void (*sem_wait)(sem_t *sem);\n  void (*sem_signal)(sem_t *sem);\n};\n</code></pre>"},{"location":"courses/os_lab/L2_kmt.html#_1","title":"\u4e0d\u7528\u5b9a\u4e49\u7ed3\u6784\u4f53\u4e5f\u80fd\u7f16\u8bd1\u901a\u8fc7\uff1f","text":"<p>\u6ca1\u9519\u3002\u53ea\u8981\u6211\u4eec\u4e0d\u5f15\u7528 <code>struct task</code> \u7684\u4efb\u4f55\u6210\u5458\uff0c\u6211\u4eec\u5728\u4ee3\u7801\u4e2d\u4f7f\u7528 <code>struct task</code> (\u6216\u5b83\u7684\u522b\u540d <code>task_t</code>) \u5c31\u4e0d\u4f1a\u5f15\u8d77\u95ee\u9898\u3002\u4f8b\u5982\uff0c\u4e3a\u51fd\u6570\u4f20\u9012 <code>struct task *</code> \u7684\u6307\u9488\u662f\u6ca1\u95ee\u9898\u7684\u3002\u4f46\u56e0\u4e3a\u4f60\u9700\u8981\u5b9e\u73b0\u5177\u4f53\u64cd\u4f5c\u8fd9\u4e9b\u7ed3\u6784\u4f53\u7684\u51fd\u6570\uff0c\u56e0\u6b64\u4f60\u9700\u8981\u5b9a\u4e49\u5b83\u4eec\u3002</p> <p>\u4f60\u53ef\u4ee5\u628a\u4f60\u4eec\u7684\u5b9a\u4e49\u653e\u5728 <code>include/</code> \u76ee\u5f55\u4e0b\u7684\u67d0\u4e2a\u5934\u6587\u4ef6\u91cc\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#22-os-operating-systems","title":"2.2 OS (Operating Systems) \u6a21\u5757","text":""},{"location":"courses/os_lab/L2_kmt.html#221","title":"2.2.1 \u64cd\u4f5c\u7cfb\u7edf\u7684\u4e3b\u5faa\u73af","text":"<p>os \u6a21\u5757\u662f\u64cd\u4f5c\u7cfb\u7edf\u4e3b\u5faa\u73af\u7684\u4ee3\u7801\uff0c\u4e3b\u8981\u8d1f\u8d23\u7cfb\u7edf\u7684\u521d\u59cb\u5316\u548c\u4e2d\u65ad\u54cd\u5e94\u3002\u6211\u4eec\u5728\u4e0a\u4e00\u4e2a\u5b9e\u9a8c\u7684\u6846\u67b6\u4ee3\u7801\u4e2d\uff0c\u5df2\u7ecf\u5305\u542b\u4e86\u4ee5\u4e0b\u51fd\u6570\uff1a</p> <ul> <li><code>os-&gt;init()</code> \u4f1a\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u88ab\u542f\u52a8\u7684\u7b2c\u4e00\u4e2a\u5904\u7406\u5668\u8c03\u7528 (\u4ec5\u521d\u59cb\u5316\u4e00\u6b21)\uff0c\u5b83\u5728\u5355\u5904\u7406\u5668\u72b6\u6001\u4e0b\u5b8c\u6210\u5fc5\u8981\u7684\u521d\u59cb\u5316\u2014\u2014\u56e0\u6b64\u4f60\u4e0d\u7528\u62c5\u5fc3\u6570\u636e\u7ade\u4e89\u7b49\u9ebb\u70e6\uff1b</li> <li><code>os-&gt;run()</code> \u662f\u64cd\u4f5c\u7cfb\u7edf\u542f\u52a8\u540e\u6bcf\u4e2a\u5904\u7406\u5668\u5fc5\u987b\u6267\u884c\u7684\u4e00\u4e9b\u4ee3\u7801\u3002\u6211\u4eec\u5047\u8bbe <code>os-&gt;run()</code> \u65f6\u5df2\u7ecf\u5b8c\u6210\u4e86\u6240\u6709\u521d\u59cb\u5316\u5de5\u4f5c\uff0c\u6bcf\u4e2a\u5904\u7406\u5668\u90fd\u4f1a\u8c03\u7528\u540c\u4e00\u4efd <code>os-&gt;run</code>\u3002</li> </ul> <p>\u4f60\u53ef\u80fd\u4f1a\u4fee\u6539\u4f60\u5df2\u6709\u7684\u5b9e\u73b0\uff0c\u4f8b\u5982\u4f60\u73b0\u5728\u7684 <code>os-&gt;init()</code> \u770b\u8d77\u6765\u53ef\u80fd\u957f\u8fd9\u6837\uff1a</p> <pre><code>static void os_init() {\n  pmm-&gt;init();\n}\n</code></pre> <p>\u4f46\u4f60\u53ef\u80fd\u4f1a\u5728\u5176\u4e2d\u589e\u52a0 kmt \u6a21\u5757\u7684\u521d\u59cb\u5316\uff1a</p> <pre><code>static void os_init() {\n  pmm-&gt;init();\n  kmt-&gt;init();\n}\n</code></pre> <p>\u7406\u89e3 os \u6a21\u5757\uff0c\u8981\u4ece\u7a0b\u5e8f\u6267\u884c\u7684\u5165\u53e3\u5f00\u59cb\uff0c\u4ee5\u4e0b\u662f\u6846\u67b6\u4ee3\u7801\u6267\u884c\u7684\u6d41\u7a0b\uff1a</p> <pre><code>int main() {\n  ioe_init();\n  cte_init(os-&gt;trap);\n  os-&gt;init();\n  mpe_init(os-&gt;run);\n  return 1;\n}\n</code></pre> <p>\u5728\u6bcf\u4e2a\u5904\u7406\u5668\u8c03\u7528 <code>os-&gt;run</code> \u6267\u884c (\u5e76\u6700\u7ec8\u88ab\u4e2d\u65ad) \u540e\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5c31\u5316\u8eab\u6210\u4e3a\u4e86\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u3002\u8c03\u7528 <code>mpe_init()</code> \u4e4b\u540e\uff0c\u6240\u6709\u7684\u5904\u7406\u5668\u90fd\u5f00\u59cb\u6267\u884c <code>os-&gt;run()</code>\uff0c\u64cd\u4f5c\u7cfb\u7edf\u6b63\u5f0f\u542f\u52a8\uff0c\u800c\u542f\u52a8\u4ee3\u7801\u5c31\u6210\u4e3a\u4e86\u5f53\u524d\u5904\u7406\u5668\u4e0a\u7684\u7b2c\u4e00\u4e2a\u7ebf\u7a0b\u2014\u2014\u8fd9\u4e2a\u7ebf\u7a0b\u662f\u8fd9\u4e2a\u5904\u7406\u5668\u4e0a\u7684 \u201cidle\u201d \u7ebf\u7a0b\uff1a\u5f53\u7cfb\u7edf\u4e2d\u6ca1\u6709\u7ebf\u7a0b\u53ef\u4ee5\u88ab\u8c03\u5ea6\u7684\u65f6\u5019\uff0c\u6211\u4eec\u7684\u5904\u7406\u5668\u4e5f\u5fc5\u987b\u6267\u884c\u70b9\u4ec0\u4e48\uff0c\u76f4\u5230\u4e0b\u4e00\u6b21\u4e2d\u65ad\u5230\u6765\uff0c\u56e0\u6b64\u5b83\u53ef\u4ee5\u662f\u4e00\u4e2a\u6b7b\u5faa\u73af\uff1a</p> <pre><code>static void os_run() {\n  iset(true);\n  while (1);\n}\n</code></pre> <p>\u4e3b\u5faa\u73af\u7684\u53e6\u4e00\u90e8\u5206\u662f\u672c\u6b21\u5b9e\u9a8c\u65b0\u589e\u7684\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u7684\u5165\u53e3</p> <ul> <li><code>os-&gt;trap(ev, context)</code>: \u4e2d\u65ad/\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\u7684\u552f\u4e00\u5165\u53e3\u3002\u4e2d\u65ad\u540e\uff0cAbstractMachine \u4f1a\u5c06\u6240\u6709\u5bc4\u5b58\u5668\u4fdd\u5b58\u5230\u5806\u6808\u4e0a (\u5c31\u50cf xv6 \u90a3\u6837)\uff0c\u7136\u540e\u8c03\u7528 <code>os-&gt;trap()</code>\uff0c\u5e76\u4e14\u5728\u51fd\u6570\u8fd4\u56de\u540e\uff0c\u5c06 <code>os-&gt;trap()</code> \u8fd4\u56de\u7684\u5bc4\u5b58\u5668\u73b0\u573a\u6062\u590d\u5230 CPU \u4e0a\u3002</li> </ul> <p>\u76f4\u5230 <code>mpe_init()</code> \u4e4b\u524d\uff0c\u90fd\u53ea\u6709\u4e00\u4e2a\u5904\u7406\u5668\u5728\u6267\u884c (\u7f16\u53f7\u4e3a 0 \u7684 CPU\uff0c\u6b64\u65f6\u8c03\u7528 <code>cpu_current()</code> \u4f1a\u8fd4\u56de <code>0</code>)\u3002\u5728\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\uff0c<code>cte_init(os-&gt;trap)</code> \u6307\u5b9a\u4e86<code>os-&gt;trap</code> \u662f\u552f\u4e00\u7684\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\uff0c\u6240\u6709\u7684\u5904\u7406\u5668\u53d1\u751f\u4e2d\u65ad\u90fd\u4f1a\u7edf\u4e00\u8c03\u7528 <code>os-&gt;trap()</code>\u3002\u5728\u4e2d\u65ad\u7684\u65f6\u5019\u505a\u4ec0\u4e48\u5b8c\u5168\u662f\u7531\u4f60\u51b3\u5b9a\u7684\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#os-run","title":"<code>os-&gt;run()</code> \u7684\u884c\u4e3a\u6539\u53d8","text":"<p>\u4e0e\u4e0a\u4e2a\u5b9e\u9a8c\u4e0d\u540c\uff0c\u6211\u4eec\u4f1a\u8c03\u7528\u4f60\u7684 <code>os-&gt;run()</code>\u3002\u56e0\u6b64\u5982\u679c\u4f60\u6709\u4efb\u4f55\u6d4b\u8bd5\u4ee3\u7801 (\u5982\u521b\u5efa\u4e00\u4e9b\u7528\u6237\u7ebf\u7a0b\u7684 <code>kmt-&gt;create</code>)\uff0c\u53ef\u4ee5\u8003\u8651\u4ee5\u4e0b\u4e24\u79cd\u65b9\u6cd5\uff1a</p> <ol> <li>(\u4e0d\u63a8\u8350) \u5199\u5728 <code>main</code> \u51fd\u6570\u4e2d\uff0cOnline Judge \u4f1a\u4f7f\u7528\u53e6\u4e00\u4efd framework\uff0c\u6240\u4ee5\u4f60\u63d2\u5165\u7684\u6240\u6709\u6d4b\u8bd5\u4ee3\u7801\u90fd\u4e0d\u4f1a\u88ab\u6267\u884c\u3002</li> <li>(\u63a8\u8350) \u5199\u5728 <code>os-&gt;init</code> \u4e2d\uff0c\u4f46\u4f7f\u7528\u4e00\u4e9b\u9884\u7f16\u8bd1\u6307\u4ee4\u786e\u4fdd\u5728 Online Judge \u65f6\u6d4b\u8bd5\u4ee3\u7801\u4e0d\u4f1a\u88ab\u6267\u884c (\u542f\u52a8\u4e00\u4e2a \u201c\u7a7a\u7684\u201d \u64cd\u4f5c\u7cfb\u7edf)\u3002</li> </ol>"},{"location":"courses/os_lab/L2_kmt.html#_2","title":"\u5c0f\u5fc3\u591a\u5904\u7406\u5668\u4e2d\u65ad","text":"<p>\u56e0\u4e3a\u6bcf\u4e2a\u5904\u7406\u5668\u90fd\u4f1a\u88ab\u4e2d\u65ad\uff0c\u8fd9\u8ba9 <code>os-&gt;trap()</code> \u53d8\u6210\u4e86\u88ab\u5e76\u884c\u6267\u884c\u7684\u4ee3\u7801\u3002\u56e0\u6b64\uff0c\u5982\u679c\u91cc\u9762\u6709\u4efb\u4f55\u5171\u4eab\u53d8\u91cf\uff0c\u4f60\u9700\u8981\u7528\u81ea\u65cb\u9501\u4fdd\u62a4\u597d (\u5e76\u4e14\u8981\u5c0f\u5fc3\u6b7b\u9501\uff0c\u5e76\u5c0f\u5fc3\u5730\u7ba1\u7406\u4e2d\u65ad\u6807\u5fd7\u4f4d)\uff0c\u6d88\u706d\u6570\u636e\u7ade\u4e89\u2014\u2014\u8fd8\u8bb0\u5f97 \u201c\u53ef\u89c1\u6027\u201d \u7684\u4f8b\u5b50\u5417\uff1f</p>"},{"location":"courses/os_lab/L2_kmt.html#222","title":"2.2.2 \u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f","text":"<p>os \u6a21\u5757\u7684\u53e6\u4e00\u4e2a\u91cd\u8981\u529f\u80fd\u662f\u7ba1\u7406\u7cfb\u7edf\u4e2d\u7684\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u2014\u2014\u6211\u4eec\u5e76\u4e0d\u5e0c\u671b\u5927\u5bb6\u5728\u6bcf\u5f53\u6709\u4e00\u4e2a\u65b0\u7684\u529f\u80fd\u4ee5\u540e\uff0c\u90fd\u76f4\u63a5\u53bb\u6539 <code>os-&gt;trap</code> \u7684\u4ee3\u7801\uff0c\u56e0\u6b64\u6211\u4eec\u63d0\u4f9b\u4e86\u53e6\u4e00\u4e2a API:</p> <ul> <li><code>os-&gt;on_irq(seq, event, handler)</code>: \u6ce8\u518c\u4e00\u4e2a\u5728\u4e2d\u65ad\u65f6\u8c03\u7528\u7684 callback\u3002</li> </ul> <p><code>on_irq</code> \u7684\u542b\u4e49\u662f\u5728 <code>os-&gt;trap(ev, ctx)</code> \u6267\u884c\u65f6\uff0c\u5f53 <code>ev.event</code> (\u4e8b\u4ef6\u7f16\u53f7) \u548c <code>event</code> \u5339\u914d\u65f6\uff0c\u8c03\u7528 <code>handler(event, ctx);</code>\u3002\u5176\u4e2d\uff1a</p> <ul> <li><code>seq</code> \u51b3\u5b9a\u4e86 handler \u88ab\u8c03\u7528\u7684\u987a\u5e8f\uff0c<code>seq</code> \u5c0f\u7684 handler \u5148\u88ab\u8c03\u7528\u3002<code>seq</code> \u76f8\u540c\u7684\u6309\u4efb\u610f\u987a\u5e8f\u8c03\u7528\uff1b</li> <li>\u5f53 <code>event == EVENT_NULL</code> \u65f6\uff0c\u5728\u4efb\u4f55\u4e2d\u65ad/\u5f02\u5e38\u65f6\u90fd\u8c03\u7528 <code>handler</code>\uff1b</li> <li>\u6211\u4eec\u5141\u8bb8\u4e00\u4e2a\u4e14\u4ec5\u4e00\u4e2a handler \u8fd4\u56de\u4e00\u4e2a <code>Context</code>\uff0c\u5728\u4e2d\u65ad\u8fd4\u56de\u65f6\u6062\u590d\u5230\u8fd9\u4e2a conetxt\u3002\u5f53\u591a\u4e2a handler \u90fd\u8fd4\u56de context \u65f6\uff0c\u662f undefined behavior\u3002</li> </ul> <p>\u5982\u679c\u6211\u4eec\u770b xv6 \u7684\u4ee3\u7801 (<code>trap.c</code>)\uff0c\u6211\u4eec\u4f1a\u770b\u5230\u4e2d\u65ad\u5230\u6765\u65f6\u7684 if-else \u7ed3\u6784\uff1a</p> <pre><code>int irq = plic_claim();\n\nif(irq == UART0_IRQ){\n  uartintr();\n} else if(irq == VIRTIO0_IRQ){\n  virtio_disk_intr();\n} else if(irq){\n  printf(\"unexpected interrupt irq=%d\\n\", irq);\n}\n</code></pre> <p>\u6211\u4eec\u7528 <code>on_irq</code> \u673a\u5236\u5b9e\u73b0\u4e86\u4e0a\u8ff0\u4ee3\u7801\u7684\u7075\u6d3b\u63a7\u5236: os \u6a21\u5757\u73b0\u5728\u53d8\u5f97\u975e\u5e38\u7b80\u5355\uff0c\u5b83\u751a\u81f3\u5b8c\u5168\u4e0d\u9700\u8981\u77e5\u9053\u5176\u4ed6\u4efb\u4f55\u6a21\u5757\u7684\u5b58\u5728\u3002\u5728\u53c2\u8003\u4ee3\u7801\u4e2d\uff0c<code>os-&gt;trap()</code> \u7684\u5b9e\u73b0\u7c7b\u4f3c\u4e8e\uff1a</p> <pre><code>static Context *os_trap(Event ev, Context *ctx) {\n  Context *next = NULL;\n  for (auto &amp;h: handlers_sorted_by_seq) {\n    if (h.event == EVENT_NULL || h.event == ev.event) {\n      Context *r = h.handler(ev, ctx);\n      panic_on(r &amp;&amp; next, \"returning multiple contexts\");\n      if (r) next = r;\n    }\n  }\n  panic_on(!next, \"returning NULL context\");\n  panic_on(sane_context(next), \"returning to invalid context\");\n  return next;\n}\n</code></pre> <p>\u501f\u52a9 <code>os-&gt;on_irq</code>\uff0c\u6211\u4eec\u53ef\u4ee5 \u201c\u6ce8\u518c\u201d \u82e5\u5e72\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\uff0c\u5728\u9002\u5f53\u7684\u65f6\u673a\u505a\u9002\u5f53\u7684\u4e8b\u60c5\u2014\u2014\u8fd9\u7c7b\u4f3c\u4e8e \u201c\u9762\u5411\u5207\u9762\u7f16\u7a0b\u201d (Aspected-Oriented Programming, AOP) \u7684\u8bbe\u8ba1\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u7684 os \u6a21\u5757\u5e76\u4e0d\u9700\u8981\u77e5\u9053\u7cfb\u7edf\u4e2d\u6709\u591a\u5c11\u4e2d\u65ad\u3001\u591a\u5c11\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u5904\u7406\u4e2d\u65ad\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u5e0c\u671b\u5728 I/O \u8bbe\u5907\u53d1\u751f\u4e2d\u65ad\u65f6\uff0c\u5411\u952e\u76d8\u9a71\u52a8\u7684\u4fe1\u53f7\u91cf\u6267\u884c\u4e00\u4e2a V \u64cd\u4f5c\uff0c\u6211\u4eec\u53ea\u9700\u8981\uff1a</p> <pre><code>static Context *input_notify(Event ev, Context *context) {\n  kmt-&gt;sem_signal(&amp;sem_kbdirq); // \u5728IO\u8bbe\u5907\u4e2d\u65ad\u5230\u6765\u65f6\uff0c\u6267\u884cV\u64cd\u4f5c\u5524\u9192\u4e00\u4e2a\u7ebf\u7a0b\n  return NULL;\n}\n\nvoid input_init() {\n  // seq == 100 \u662f\u968f\u610f\u8bbe\u7f6e\u5730\uff0c\u6211\u4eec\u5e76\u4e0d\u5728\u610f\u4f55\u65f6\u8c03\u7528\n  os-&gt;on_irq(100, EVENT_IRQ_IODEV, input_notify); \n  ...\n}\n</code></pre> <p>\u751a\u81f3\u5728 jyy \u7684\u53c2\u8003\u5b9e\u73b0\u4e2d\uff0c\u5bc4\u5b58\u5668\u73b0\u573a\u4fdd\u5b58\u3001\u6267\u884c\u8c03\u5ea6\u7a0b\u5e8f\u7684\u4ee3\u7801\uff0c\u4e5f\u90fd\u662f\u7528 <code>on_irq</code> \u6ce8\u518c\u7684 (\u5c3d\u7ba1\u4f60\u5e76\u4e0d\u5fc5\u8981\u8fd9\u4e48\u505a\uff0c\u53ef\u4ee5\u628a\u8fd9\u90e8\u5206\u4ee3\u7801\u76f4\u63a5\u5199\u5728 <code>os-&gt;trap</code> \u4e2d)\uff1a</p> <pre><code>// thread.c\uff0c\u7ebf\u7a0b\u7ba1\u7406\nstatic void kmt_init() {\n  ...\n  os-&gt;on_irq(INT_MIN, EVENT_NULL, kmt_context_save);   // \u603b\u662f\u6700\u5148\u8c03\u7528\n  os-&gt;on_irq(INT_MAX, EVENT_NULL, kmt_schedule);       // \u603b\u662f\u6700\u540e\u8c03\u7528\n  ...\n}\n</code></pre> <p>\u5982\u679c\u4e0a\u8ff0\u4ee3\u7801\u88ab\u6267\u884c\uff0c\u90a3\u4e48\u6309\u7167\u6ce8\u518c\u65f6\u7684 sequence number \u8fdb\u884c\u8c03\u7528\uff1a</p> <ul> <li>\u5728\u65f6\u949f\u4e2d\u65ad\u53d1\u751f\u65f6\u4f9d\u6b21\u8c03\u7528 <code>kmt_context_save</code> (<code>INT_MIN</code>) \u548c <code>kmt_schedule</code> (<code>INT_MAX</code>)\uff1b</li> <li>\u5728\u952e\u76d8\u4e2d\u65ad\u53d1\u751f\u65f6\u4f9d\u6b21\u8c03\u7528 <code>kmt_context_save</code> (<code>INT_MIN</code>), <code>input_notify</code> (<code>100</code>), \u548c <code>kmt_schedule</code> (<code>INT_MAX</code>)</li> </ul> <p>\u7ebf\u7a0b/\u4e2d\u65ad\u5b89\u5168\u6027\uff1a\u6bcf\u4e2a\u5904\u7406\u5668\u90fd\u4f1a\u5206\u522b\u54cd\u5e94\u4e2d\u65ad\u2014\u2014<code>iset</code> \u4ec5\u5bf9\u5f53\u524d\u6267\u884c\u7684\u5904\u7406\u5668\u6709\u6548\u3002\u56e0\u6b64\uff0c\u4f60\u53ef\u4ee5\u5047\u8bbe <code>os-&gt;on_irq</code> \u5728\u5355\u5904\u7406\u5668\u3001\u4e2d\u65ad\u5173\u95ed\u4e0b <code>os-&gt;run</code> \u88ab\u8c03\u7528\u4e4b\u524d\u5168\u90e8\u6267\u884c\u5b8c\u6bd5\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#assertions","title":"\u9632\u5fa1\u6027\u7684 Assertions","text":"<p>\u6ce8\u610f\u5230\u4e0a\u8ff0\u4ee3\u7801\u4e2d\u4e00\u4e9b\u9632\u5fa1\u6027\u7684 assertions\uff0c\u5b83\u4eec\u68c0\u67e5 specifications \u662f\u5426\u88ab\u8fdd\u53cd\u3002\u5728\u7a0b\u5e8f\u7684\u5404\u4e2a\u5730\u65b9\u6dfb\u52a0\u9632\u5fa1\u6027\u7684 assertions \u80fd\u6700\u5927\u7a0b\u5ea6\u4fdd\u62a4\u4f60\u4eec\u4e0d\u53d7\u4f24\u5bb3\u2014\u2014\u4f8b\u5982\u5728\u67d0\u4e2a\u7f55\u89c1\u7684\u6267\u884c\u8def\u5f84\u4e0a\uff0c\u4f60\u5fd8\u8bb0\u8fd4\u56de context\uff0c\u6216\u662f context \u5df2\u7ecf\u88ab\u635f\u574f\uff0c\u4f60\u4f1a\u5f97\u5230 assertion failure \u800c\u4e0d\u662f\u865a\u62df\u673a\u7684\u795e\u79d8\u91cd\u542f\u3002</p> <ul> <li><code>sane_context</code> \u5982\u4f55\u5b9e\u73b0\uff1f\u4e0d\u59a8\u53ef\u4ee5\u8003\u8651\u4f8b\u5982 <code>cs</code>, <code>rip</code>, <code>rflags</code> \u7b49\u5bc4\u5b58\u5668\u5408\u6cd5\u7684\u503c\u3002</li> </ul> <p>\u6b64\u5916\uff0c\u5f53\u524d\u7684 assert failure \u53ea\u80fd\u6253\u5370\u51fa\u5931\u8d25\u7684\u4f4d\u7f6e\u3002\u5982\u679c\u4f60\u5199\u4e00\u5c0f\u6bb5\u4ee3\u7801\uff0c\u80fd\u591f\u6253\u5370\u51fa call stack frame\uff0c\u90a3\u4f1a\u6781\u5927\u7a0b\u5ea6\u7b80\u5316\u4f60\u4eec\u8c03\u8bd5\u7684\u8fc7\u7a0b\u2014\u2014\u867d\u7136\u8fd9\u4e0d\u662f\u5fc5\u987b\u7684\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#23-pmm-physical-memory-management","title":"2.3 PMM (Physical Memory Management) \u6a21\u5757","text":"<p>pmm \u4e0e\u4e4b\u524d\u884c\u4e3a\u4e00\u81f4\uff0c\u4f46\u56e0\u4e3a\u5b83\u88ab\u8c03\u7528\u7684\u573a\u666f\u589e\u52a0\u4e86 (\u5e76\u4e0d\u662f\u6bcf\u4e2a CPU \u53ea\u662f\u8fde\u7eed\u4e0d\u65ad\u5730\u6267\u884c\u4ee3\u7801\uff0c\u800c\u662f CPU \u53ef\u80fd\u88ab\u4e2d\u65ad)\uff0c\u6211\u4eec\u9700\u8981\u7a0d\u7a0d\u5bf9\u5b83\u8fdb\u884c\u6539\u8fdb\uff1a</p> <p>\u7ebf\u7a0b/\u4e2d\u65ad\u5b89\u5168\u6027\uff1a\u5141\u8bb8\u4efb\u610f\u7ebf\u7a0b/\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u8c03\u7528 <code>pmm-&gt;alloc</code> \u548c <code>pmm-&gt;free</code>\u3002</p> <p>\u5177\u4f53\u6765\u8bf4\uff0c\u6211\u4eec\u8981\u6c42:</p> <ol> <li>\u53ef\u4ee5\u5728\u4e2d\u65ad\u91cc\u8c03\u7528 <code>pmm-&gt;alloc()</code> \u548c <code>pmm-&gt;free()</code>\uff1b</li> <li>\u5185\u5b58\u5206\u914d/\u56de\u6536\u65f6\uff0c\u7b80\u5355\u8d77\u89c1\uff0c\u4e0d\u5141\u8bb8\u88ab\u4e2d\u65ad\u3002</li> </ol> <p>\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u6cd5\u7b80\u5355\u505a\u5230\uff1a</p> <pre><code>static void *kalloc_safe(size_t size) {\n  bool i = ienabled();\n  iset(false);\n  void *ret = kalloc(size);\n  if (i) iset(true);\n  return ret;\n}\n\nstatic void kfree_safe(void *ptr) {\n  int i = ienabled();\n  iset(false);\n  kfree(ptr);\n  if (i) iset(true);\n}\n</code></pre> <p>\u6211\u4eec\u4e0d\u63a8\u8350\u4f60\u5728 pmm \u4e2d\u4f7f\u7528 <code>kmt-&gt;spinlock</code>\uff0c\u800c\u662f\u4fdd\u6301\u73b0\u6709\u7684\u5b9e\u73b0\u4e0d\u53d8\uff0c\u56e0\u4e3a\u4f60\u53ef\u80fd\u5728 <code>kmt-&gt;init()</code> \u7684\u65f6\u5019\u8c03\u7528 <code>pmm-&gt;alloc()</code>\uff0c\u6b64\u65f6\u81ea\u65cb\u9501\u53ef\u80fd\u8fd8\u6ca1\u6709\u5b8c\u6210\u5fc5\u8981\u7684\u521d\u59cb\u5316\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#24-kmt-kernel-multi-threading","title":"2.4 KMT (Kernel Multi-Threading) \u6a21\u5757","text":""},{"location":"courses/os_lab/L2_kmt.html#241","title":"2.4.1 \u6a21\u5757\u521d\u59cb\u5316","text":"<p><code>kmt-&gt;init()</code> \u8d1f\u8d23\u521d\u59cb\u5316\u5fc5\u8981\u7684\u6570\u636e\uff0c\u4f8b\u5982\u5206\u914d\u4e00\u4e9b\u91cd\u8981\u7684\u6570\u636e\u7ed3\u6784\u3002\u6211\u4eec\u9884\u671f\u4f60\u4f1a\u5728 <code>os-&gt;init()</code> \u65f6\u8c03\u7528 <code>kmt-&gt;init()</code>\u3002\u6574\u4e2a\u7cfb\u7edf\u542f\u52a8\u53ea\u8c03\u7528\u4e00\u6b21 <code>kmt-&gt;init()</code>\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#242","title":"2.4.2 \u7ebf\u7a0b\u7ba1\u7406","text":"<pre><code>int  (*create)(task_t *task, const char *name, void (*entry)(void *arg), void *arg);\nvoid (*teardown)(task_t *task);\n</code></pre> <p>\u5176\u4e2d <code>create</code> \u5728\u7cfb\u7edf\u4e2d\u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b (<code>task_t</code> \u5e94\u5f53\u4e8b\u5148\u88ab\u5206\u914d\u597d)\uff0c\u8fd9\u4e2a\u7ebf\u7a0b\u7acb\u5373\u5c31\u53ef\u4ee5\u88ab\u8c03\u5ea6\u6267\u884c (\u4f46\u8c03\u7528 create \u65f6\u4e2d\u65ad\u53ef\u80fd\u5904\u4e8e\u5173\u95ed\u72b6\u6001\uff0c\u5728\u6253\u5f00\u4e2d\u65ad\u540e\u5b83\u624d\u83b7\u5f97\u88ab\u8c03\u5ea6\u6267\u884c\u7684\u6743\u5229)\u3002\u6211\u4eec\u5047\u8bbe <code>create</code> \u521b\u5efa\u7684\u7ebf\u7a0b\u6c38\u4e0d\u8fd4\u56de\u2014\u2014\u4f46\u5b83\u6709\u53ef\u80fd\u5728\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u8c03\u5ea6\u6267\u884c\u7684\u60c5\u51b5\u4e0b\u88ab\u8c03\u7528 <code>kmt-&gt;teardown</code> \u56de\u6536\u3002</p> <p><code>teardown</code> \u76f8\u5e94\u56de\u6536\u4e3a\u7ebf\u7a0b\u5206\u914d\u7684\u8d44\u6e90\u2014\u2014\u4f8b\u5982\u4f60\u53ef\u80fd\u4f1a\u4e3a <code>task_t</code> \u52a8\u6001\u5206\u914d\u5185\u5b58\uff1a</p> <pre><code>int kmt_create(task_t *task, const char *name, void (*entry)(void *arg), void *arg) {\n  ...\n  task-&gt;stack = pmm-&gt;alloc(STACK_SIZE); // \u52a8\u6001\u5206\u914d\u5185\u6838\u6808\n  ...\n}\n</code></pre> <p>\u8fd9\u90e8\u5206\u7684\u5185\u5b58\u9700\u8981\u5728 <code>teardown()</code> \u65f6\u88ab\u56de\u6536\u3002\u7ebf\u7a0b\u53ea\u6709\u5728\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u8c03\u5ea6\u5230\u5904\u7406\u5668\u4e0a\u6267\u884c\u7684\u524d\u63d0\u4e0b\u624d\u80fd\u88ab\u56de\u6536\u3002\u4f60\u53ef\u4ee5\u5047\u8bbe\u56de\u6536\u7684\u65f6\u5019\u7ebf\u7a0b\u4e0d\u518d\u6301\u6709\u4efb\u4f55\u81ea\u65cb\u9501\u6216\u5728\u4fe1\u53f7\u91cf\u4e0a\u7b49\u5f85\u3002</p> <p>\u7ebf\u7a0b/\u4e2d\u65ad\u5b89\u5168\u6027\uff1a\u5141\u8bb8\u4efb\u610f\u7ebf\u7a0b\u8c03\u7528 <code>create</code>/<code>teardown</code>\u3002\u4e0d\u4f1a\u5728\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u4e2d\u8c03\u7528 <code>create</code>/<code>teardown</code>\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#243","title":"2.4.3 \u81ea\u65cb\u9501","text":"<pre><code>void (*spin_init)(spinlock_t *lk, const char *name);\nvoid (*spin_lock)(spinlock_t *lk);\nvoid (*spin_unlock)(spinlock_t *lk);\n</code></pre> <p>lock-unlock \u5b9e\u73b0\u4fdd\u62a4\u4e00\u6bb5\u5f3a\u539f\u5b50\u6027 (\u4efb\u4f55\u5176\u4ed6\u7ebf\u7a0b\u3001\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u3001\u5176\u4ed6\u5904\u7406\u5668\u90fd\u4e0d\u80fd\u540c\u65f6\u5f97\u5230\u540c\u4e00\u628a\u9501)\uff1a</p> <ul> <li>\u5141\u8bb8\u5728\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u4e2d\u8c03\u7528\u81ea\u65cb\u9501\uff1b</li> <li>\u5141\u8bb8\u4efb\u610f\u5728\u4efb\u610f\u5904\u7406\u5668\u7684\u4efb\u610f\u7ebf\u7a0b\u4e2d\u8c03\u7528\u81ea\u65cb\u9501\uff1b</li> <li><code>spin_lock</code> \u5c06\u4f1a\u5173\u95ed\u5904\u7406\u5668\u7684\u4e2d\u65ad\uff0c\u56e0\u6b64\u5bf9\u4e00\u4e2a\u5904\u7406\u5668\u800c\u8a00\uff0c\u6301\u6709\u4efb\u4f55\u4e00\u4e2a\u81ea\u65cb\u9501\u4e4b\u540e\u5c31\u4e0d\u4f1a\u518d\u53d1\u751f\u7ebf\u7a0b\u5207\u6362\uff1b</li> <li><code>spin_unlock</code> \u5728\u89e3\u9664\u6700\u540e\u4e00\u4e2a\u5f53\u524d\u5904\u7406\u5668\u6301\u6709\u7684\u81ea\u65cb\u9501\u4e4b\u540e\uff0c\u9700\u8981\u5c06\u5904\u7406\u5668\u7684\u4e2d\u65ad\u72b6\u6001\u6062\u590d\u3002\u4f8b\u5982\u5728\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u4e2d\uff0c\u4e2d\u65ad\u662f\u5173\u95ed\u7684\uff0c\u56e0\u6b64 <code>spin_unlock</code> \u4e0d\u5e94\u8be5\u6253\u5f00\u4e2d\u65ad\uff1b\u4f46\u5728\u4e00\u822c\u7684\u7ebf\u7a0b\u4e2d\uff0c<code>spin_unlock</code> \u540e\u5e94\u5f53\u6062\u590d\u5904\u7406\u5668\u7684\u4e2d\u65ad\u3002</li> </ul> <p>\u7ebf\u7a0b/\u4e2d\u65ad\u5b89\u5168\u6027\uff1a\u5141\u8bb8\u4efb\u610f\u7ebf\u7a0b\u8c03\u7528 <code>spin_init</code>, <code>spin_lock</code> \u548c <code>spin_unlock</code>\u3002\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u5141\u8bb8\u8c03\u7528 <code>spin_lock</code> \u548c <code>spin_unlock</code>\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#244","title":"2.4.4 \u4fe1\u53f7\u91cf","text":"<pre><code>void (*sem_init)(sem_t *sem, const char *name, int value);\nvoid (*sem_wait)(sem_t *sem);\nvoid (*sem_signal)(sem_t *sem);\n</code></pre> <p>\u5728\u4fe1\u53f7\u91cf\u521d\u59cb\u5316\u65f6\uff0c<code>value</code> \u6307\u5b9a\u4e86\u5b83\u521d\u59cb\u7684\u6570\u503c\u3002\u521d\u59cb\u65f6 <code>value == 1</code> \u53ef\u4ee5\u628a\u4fe1\u53f7\u91cf\u5f53\u4e92\u65a5\u9501\uff1b\u521d\u59cb\u65f6 <code>value == 0</code> \u53ef\u4ee5\u628a\u4fe1\u53f7\u91cf\u4f5c\u4e3a\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u7f13\u51b2\u533a\u7ba1\u7406\u5b9e\u73b0\u3002<code>sem_wait</code> \u548c <code>sem_signal</code> \u5206\u522b\u5bf9\u5e94\u4e86 P/V \u64cd\u4f5c\u3002</p> <ul> <li>\u5141\u8bb8\u5728\u7ebf\u7a0b\u4e2d\u6267\u884c\u4fe1\u53f7\u91cf\u7684 <code>sem_wait</code> \u64cd\u4f5c\u3002\u5728 P \u64cd\u4f5c\u6267\u884c\u6ca1\u6709\u76f8\u5e94\u8d44\u6e90\u65f6\uff0c\u7ebf\u7a0b\u5c06\u88ab\u963b\u585e (\u4e0d\u518d\u88ab\u8c03\u5ea6\u6267\u884c)\u3002\u4e2d\u65ad\u6ca1\u6709\u5bf9\u5e94\u7684\u7ebf\u7a0b\u3001\u4e0d\u80fd\u963b\u585e\uff0c\u56e0\u6b64\u4e0d\u80fd\u5728\u4e2d\u65ad\u65f6\u8c03\u7528 <code>sem_wait</code>\uff1b</li> <li>\u5141\u8bb8\u5728\u4efb\u610f\u72b6\u6001\u4e0b\u4efb\u610f\u6267\u884c <code>sem_signal</code>\uff0c\u5305\u62ec\u4efb\u4f55\u5904\u7406\u5668\u4e2d\u7684\u4efb\u4f55\u7ebf\u7a0b\u548c\u4efb\u4f55\u5904\u7406\u5668\u7684\u4efb\u4f55\u4e2d\u65ad\u3002</li> </ul> <p>\u5728\u4fe1\u53f7\u91cf\u5b9e\u73b0\u65f6\uff0c\u5927\u7ea6\u9700\u8981\u505a\u4ee5\u4e0b\u51e0\u4ef6\u4e8b (\u4efb\u4f55\u4e00\u672c\u64cd\u4f5c\u7cfb\u7edf\u6559\u6750\u4e0a\u90fd\u4f1a\u63d0\u5230\u7c7b\u4f3c\u7684\u5b9e\u73b0)\uff1a</p> <pre><code>void sem_wait(sem_t *sem) {\n  spin_lock(&amp;sem-&gt;lock); // \u83b7\u5f97\u81ea\u65cb\u9501\n  sem-&gt;count--; // \u81ea\u65cb\u9501\u4fdd\u8bc1\u539f\u5b50\u6027\n  if (...) {\n    // \u6ca1\u6709\u8d44\u6e90\uff0c\u9700\u8981\u7b49\u5f85\n    ...\n    mark_as_not_runnable(current); // \u5f53\u524d\u7ebf\u7a0b\u4e0d\u80fd\u518d\u6267\u884c\n  }\n  spin_unlock(&amp;sem-&gt;unlock);\n  if (...) {  // \u5982\u679c P \u5931\u8d25\uff0c\u4e0d\u80fd\u7ee7\u7eed\u6267\u884c\n              // (\u6ce8\u610f\u6b64\u65f6\u53ef\u80fd\u6709\u7ebf\u7a0b\u6267\u884c V \u64cd\u4f5c)\n    yield(); // \u5f15\u53d1\u4e00\u6b21\u4e0a\u4e0b\u6587\u5207\u6362\n  }\n}\n</code></pre> <p>\u7ebf\u7a0b/\u4e2d\u65ad\u5b89\u5168\u6027\uff1a\u9700\u8981\u5b9e\u73b0\u591a\u5904\u7406\u5668\u5b89\u5168\u6027\u3002\u5141\u8bb8\u4efb\u610f\u7ebf\u7a0b\u8c03\u7528 <code>sem_init</code>, <code>sem_wait</code> \u548c <code>sem_signal</code>\u3002\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u4e0d\u53ef\u7761\u7720\uff0c\u4f46\u53ef\u4ee5\u8c03\u7528 <code>sem_signal</code>\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#3","title":"3. \u6b63\u786e\u6027\u6807\u51c6","text":"<p>native \u5904\u4e8e\u957f\u4e45\u6ca1\u6709\u7ef4\u62a4\u7684\u9636\u6bb5\uff0c\u56e0\u6b64\u4e3a\u4e86\u5b9e\u9a8c\u7684\u7a33\u5b9a\u6027\uff0c\u6211\u4eec\u603b\u662f\u4ee5 qemu (x86-64 \u548c i386) \u4e3a\u51c6\u3002Online Judge \u8bc4\u6d4b\u65f6\u53ea\u6709 <code>x86-qemu</code> \u548c <code>x86_64-qemu</code>\u3002</p> <p>\u6211\u4eec\u6d4b\u8bd5\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u4f1a\u66ff\u6362\u6211\u4eec\u7684 <code>framework</code> \u76ee\u5f55\uff0c\u56e0\u6b64\u4f60\u5bf9\u5176\u4e2d\u6587\u4ef6 (\u4f8b\u5982 <code>kernel.h</code>) \u7684\u4efb\u4f55\u4fee\u6539\u90fd\u4f1a\u88ab\u6d88\u9664\u3002\u6ce8\u610f\u5230\u6211\u4eec\u7684\u6d4b\u8bd5\u4ee3\u7801\u9700\u8981\u6570\u636e\u7ed3\u6784 (<code>sem_t</code> \u7b49) \u7684\u5b9a\u4e49\uff0c\u800c\u8fd9\u4e9b\u5b9a\u4e49\u5e76\u4e0d\u5728 <code>kernel.h</code> \u4e2d\uff0c\u56e0\u6b64\u4f60\u9700\u8981\u5728 <code>os.h</code> \u4e2d\u5305\u542b\u5b83\u4eec\uff0c\u5426\u5219\u6d4b\u8bd5\u4ee3\u7801\u5c06\u65e0\u6cd5\u7f16\u8bd1\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#_3","title":"\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f \u91cd\u8981\u7684\u6ce8\u610f\u4e8b\u9879","text":"<p>\u6211\u4eec\u7684\u4ee3\u7801 (<code>main</code>) \u770b\u8d77\u6765\u662f\u8fd9\u6837\u7684\uff1a</p> <pre><code>#include &amp;lt;klib.h&amp;gt;\n#include &amp;lt;klib-macros.h&amp;gt;\n#include &amp;lt;am.h&amp;gt;\n#include &amp;lt;common.h&amp;gt;\n#include &amp;lt;os.h&amp;gt;\n\n... // \u6b64\u5904\u7701\u7565\u6d4b\u8bd5\u4ee3\u7801\n\nint main(const char *args) {\n  ioe_init();\n  cte_init(os-&gt;trap);\n  os-&gt;init();\n\n  init_workload(args);\n  mpe_init(os-&gt;run);\n}\n</code></pre> <p>\u6ce8\u610f\u5230\u6211\u4eec\u7684\u6d4b\u8bd5\u4ee3\u7801\u9700\u8981\u6570\u636e\u7ed3\u6784 (<code>sem_t</code> \u7b49) \u7684\u5b9a\u4e49\uff0c\u800c\u8fd9\u4e9b\u5b9a\u4e49\u5e76\u4e0d\u5728 <code>kernel.h</code> \u4e2d\uff0c\u56e0\u6b64\u4f60\u9700\u8981\u5728 <code>common.h</code> \u4e2d\u5305\u542b\u5b83\u4eec\uff0c\u5426\u5219\u6d4b\u8bd5\u4ee3\u7801\u5c06\u65e0\u6cd5\u7f16\u8bd1\u3002</p> <p>\u6b64\u5916\uff0c\u4e0d\u8981\u6253\u5370\u591a\u4f59\u7684\u8f93\u51fa\u3002\u5728\u4efb\u4f55\u65f6\u5019 (\u9501\u3001\u4e2d\u65ad\u3001\u2026\u2026) \u65f6\u6253\u5370\u591a\u4f59\u7684\u8f93\u51fa\u90fd\u53ef\u80fd\u5bfc\u81f4 Wrong Answer\u3002\u56e0\u6b64\u6211\u4eec\u5efa\u8bae\u4f60\u4f7f\u7528\u81ea\u5df1\u7684 log \u6216 printk \u51fd\u6570 (\u800c\u4e0d\u662f printf; \u6211\u4eec\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u4f1a\u4f7f\u7528 printf)\uff0c\u4e14\u5b83\u4eec\u7684\u884c\u4e3a\u7531\u9884\u7f16\u8bd1\u6307\u4ee4\u63a7\u5236\uff0c\u4ec5\u5728\u4f60\u672c\u5730\u7f16\u8bd1\u65f6\u624d\u6253\u5370\u6570\u636e\u3002</p> <p>\u5f53\u7136\u4e86\uff0c\u7cfb\u7edf\u542f\u52a8\u65f6 (<code>mpe_init</code> \u4e4b\u524d) \u6253\u5370\u5c11\u91cf\u65e5\u5fd7\u662f\u6ca1\u95ee\u9898\u7684\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#31-safety-liveness","title":"3.1 Safety \u548c Liveness","text":"<p>\u5728\u4efb\u610f\u65f6\u523b\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90fd\u53ef\u80fd\u6709\u591a\u4e2a\u7ebf\u7a0b\uff0c\u4f60\u9700\u8981\u8bbe\u8ba1\u8c03\u5ea6\u7684\u7b56\u7565\u5728\u591a\u4e2a\u5904\u7406\u5668\u4e2d\u8c03\u5ea6\u8fd9\u4e9b\u7ebf\u7a0b\uff0c\u4f7f\u7cfb\u7edf\u4e2d\u80fd\u591f\u88ab\u6267\u884c\u7684\u7ebf\u7a0b\u5c3d\u53ef\u80fd\u4e0d\u53d1\u751f\u9965\u997f\u3002</p> <p>\u7ecf\u8fc7 Lab1 \u7684\u6d17\u793c\uff0c\u4f60\u4eec\u5e94\u8be5\u610f\u8bc6\u5230\uff0c\u5199\u51fa\u6b63\u786e\u7684\u7a0b\u5e8f\u8981\u4ece\u7b80\u5355\u3001\u6709\u6548\u7684\u7b56\u7565\u5f00\u59cb\uff0c\u76f2\u76ee\u4f7f\u7528\u590d\u6742\u7684\u7b56\u7565\u53ea\u4f1a\u8ba9\u4f60\u9677\u5165 Wrong Answer \u7684\u6ce5\u6f6d\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#hard-tests","title":"\u4e00\u4e2a\u7279\u522b\u7684\u6b63\u786e\u6027\u8981\u6c42 (\u4ec5\u9488\u5bf9 Hard Tests)","text":"<p>\u5728\u7ebf\u7a0b\u6570\u4e0d\u8fc7\u591a\u7684\u524d\u63d0 (\u5341\u51e0) \u4e0b\uff0c\u6211\u4eec\u8981\u6c42\u6bcf\u4e2a\u53ef\u8fd0\u884c\u7684\u7ebf\u7a0b\uff0c\u7ed9\u5b9a\u8db3\u591f\u957f (\u4f8b\u5982\u6570\u79d2) \u7684\u65f6\u95f4\uff0c\u80fd\u591f\u88ab\u8c03\u5ea6\u5230\u6bcf\u4e2a\u5904\u7406\u5668\u4e0a\u6267\u884c\u3002\u8fd9\u4e2a\u9700\u6c42\u770b\u8d77\u6765\u5f88\u7b80\u5355\uff1a\u7a0d\u5fae\u6539\u4e00\u6539 <code>thread-os.c</code> \u7684\u8c03\u5ea6\u5668\u5c31\u884c\u4e86\u3002\u4f46\u4f60\u8981\u8b66\u60d5\u4e86\uff01\u8fd9\u53ef\u80fd\u6bd4\u4f60\u60f3\u8c61\u7684\u56f0\u96be\u5f97\u591a\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#32","title":"3.2 \u5b98\u65b9\u6d4b\u8bd5\u7528\u4f8b","text":"<p>\u5b98\u65b9\u6d4b\u8bd5\u7528\u4f8b\u4f7f\u4f60\u7684 \u201c\u64cd\u4f5c\u7cfb\u7edf\u201d \u770b\u8d77\u6765\u66f4\u50cf\u662f\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u3002\u4f46\u5b83\u5e76\u4e0d\u80fd\u4f5c\u4e3a \u201c\u538b\u529b\u6d4b\u8bd5\u201d \u6765\u5e2e\u52a9\u4f60\u68c0\u67e5 kmt \u5b9e\u73b0\u7684\u6b63\u786e\u6027\u3002\u6211\u4eec\u4e3a\u5927\u5bb6\u63d0\u4f9b\u4e86 dev \u6a21\u5757\u53ca\u5176\u5b9e\u73b0 (\u5df2\u7ecf\u5305\u542b\u5728\u6846\u67b6\u4ee3\u7801\u4e2d)\uff1a</p> <pre><code>typedef struct device device_t;\nMODULE(dev) {\n  void (*init)();\n  device_t *(*lookup)(const char *name);\n};\n</code></pre> <p>\u6211\u4eec\u7684\u5b98\u65b9\u6d4b\u8bd5\u7528\u4f8b\u8fd8\u5305\u542b\u4e86\u4ee5\u4e0b\u8bbe\u5907\u7684\u9a71\u52a8 (\u6211\u4eec\u5c06\u4f1a\u5728\u8bfe\u7a0b\u8fdb\u5c55\u5230\u4e00\u534a\u5de6\u53f3\u7684\u65f6\u5019\u8bb2\u89e3\u8bbe\u5907\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u62bd\u8c61\uff0c\u6b64\u65f6\u4f1a\u8bb2\u89e3\u4ec0\u4e48\u662f\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f)\uff1a</p> <ul> <li><code>input</code>\uff0c\u652f\u6301\u8bfb\u53d6\u952e\u76d8\u7684\u8f93\u5165\uff1b</li> <li><code>fb</code>\uff0c\u652f\u6301\u4e00\u4e2a\u8f6f\u4ef6\u6a21\u62df\u7684 2D \u663e\u793a\u52a0\u901f\u5668\u7684\u5199\u5165 (\u6211\u4eec\u6253\u7b97\u672a\u6765\u628a\u8fd9\u4e2a\u663e\u793a\u52a0\u901f\u5668\u7528\u771f\u6b63\u7684\u786c\u4ef6\u5b9e\u73b0)\uff1b</li> <li><code>tty1</code>, <code>tty2</code>, \u4e24\u4e2a\u652f\u6301\u8bfb\u5199\u7684\u865a\u62df\u7ec8\u7aef\uff0c\u4f7f\u7528 Alt-1, Alt-2 \u5728\u865a\u62df\u4e2d\u65ad\u4e4b\u95f4\u5207\u6362\uff1b</li> <li><code>sda</code>, \u652f\u6301\u8bfb\u5199\u7684\u7269\u7406\u78c1\u76d8\u3002\u4f60\u53ef\u4ee5\u4ece\u4e2d\u8bfb\u51fa\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7684 ELF \u6587\u4ef6\u3002</li> </ul> <p>\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u4f60\u5e76\u4e0d\u9700\u8981\u8c03\u8bd5\u6b63\u786e\u6240\u6709\u7684\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f (\u4f46\u8c03\u8bd5\u4e0d\u901a\u8fc7\u4e00\u822c\u610f\u5473\u7740 Online Judge \u4f1a\u6d4b\u8bd5\u5931\u8d25)\u3002\u4f46\u5728\u4e0b\u4e00\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u6211\u4eec\u4f1a\u7528\u5230\u8fd9\u4e9b\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u3002</p> <p>\u4ee3\u7801\u5408\u5e76\u540e\uff0c\u4f60\u9700\u8981\u5728 <code>os-&gt;init()</code> \u4e2d\u624b\u5de5\u6dfb\u52a0\u8bbe\u5907\u6a21\u5757\u7684\u521d\u59cb\u5316 <code>dev-&gt;init()</code>\u3002\u5982\u679c\u5b9e\u73b0\u6b63\u786e\uff0c\u5c31\u80fd\u5b8c\u6210\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f (\u548c\u82e5\u5e72\u8bbe\u5907\u76f8\u5173\u7ebf\u7a0b) \u7684\u521d\u59cb\u5316\u3002\u4f60\u4e0d\u9700\u8981\u6dfb\u52a0\u989d\u5916\u7684\u4ee3\u7801\uff0c\u5c31\u80fd\u770b\u5230\u95ea\u70c1\u7684\u5149\u6807\uff0c\u5e76\u4e14\u80fd\u770b\u5230\u8f93\u5165\u5b57\u7b26\u7684\u56de\u663e\u3002</p> <p>\u6b64\u540e\uff0c\u4f60\u5c31\u53ef\u4ee5\u521b\u5efa\u82e5\u5e72\u8bbf\u95ee\u8bbe\u5907\u7684\u7ebf\u7a0b\uff0c\u4f8b\u5982\u4f60\u53ef\u4ee5\u4e3a\u6bcf\u4e2a tty \u8bbe\u5907\u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b\uff1a</p> <pre><code>static void tty_reader(void *arg) {\n  device_t *tty = dev-&gt;lookup(arg);\n  char cmd[128], resp[128], ps[16];\n  snprintf(ps, 16, \"(%s) $ \", arg);\n  while (1) {\n    tty-&gt;ops-&gt;write(tty, 0, ps, strlen(ps));\n    int nread = tty-&gt;ops-&gt;read(tty, 0, cmd, sizeof(cmd) - 1);\n    cmd[nread] = '\\0';\n    sprintf(resp, \"tty reader task: got %d character(s).\\n\", strlen(cmd));\n    tty-&gt;ops-&gt;write(tty, 0, resp, strlen(resp));\n  }\n}\n\nstatic void os_init() {\n  ...\n  kmt-&gt;create(task_alloc(), \"tty_reader\", tty_reader, \"tty1\");\n  kmt-&gt;create(task_alloc(), \"tty_reader\", tty_reader, \"tty2\");\n}\n</code></pre> <p></p>"},{"location":"courses/os_lab/L2_kmt.html#_4","title":"\u5ffd\u7136\u5c31\u6709 \u201c\u64cd\u4f5c\u7cfb\u7edf\u201d \u7684\u6837\u5b50\u4e86\uff01","text":"<p>\u54c7\uff01\u505a\u5b8c\u5b9e\u9a8c\u6211\u597d\u50cf\u6709 \u201c\u64cd\u4f5c\u7cfb\u7edf\u201d \u7684\u611f\u89c9\u4e86\uff01\u7136\u540e\u518d\u770b\u770b trivial-os.c \u7684\u4ee3\u7801\uff0c\u4eff\u4f5b\u6211\u770b\u5230\u4e86\u5199\u51fa\u4e00\u4e2a\u771f\u6b63\u64cd\u4f5c\u7cfb\u7edf\u7684\u5e0c\u671b\u3002\u6ca1\u9519\u2014\u2014\u4f60\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\u6d3b\u4e0b\u6765\uff0c\u5c31\u610f\u5473\u7740\u4f60\u5df2\u7ecf\u638c\u63e1\u64cd\u4f5c\u7cfb\u7edf\u539f\u7406\u4e2d\u6700\u91cd\u8981\u7684\u90e8\u5206\uff1a\u5982\u4f55\u5b9e\u73b0\u5904\u7406\u5668\u7684\u5206\u65f6\u865a\u62df\u5316\u3002\u63a5\u4e0b\u6765\uff0c\u4f60\u53ea\u9700\u8981\u7406\u89e3\uff1a</p> <ol> <li>\u6587\u4ef6\u7cfb\u7edf\u662f\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u7ed3\u6784\uff1b</li> <li>\u8fdb\u7a0b\u662f\u62e5\u6709\u72ec\u7acb\u5730\u5740\u7a7a\u95f4\u7684\u7ebf\u7a0b\uff0c</li> </ol> <p>\u4f60\u5176\u5b9e\u5c31\u5728 high-level \u4e0a\u5bf9\u73b0\u4ee3\u64cd\u4f5c\u7cfb\u7edf\u6709\u4e86\u4e00\u4e2a\u51c6\u786e\u7684\u8ba4\u8bc6 (\u5f53\u7136\u8fd8\u6709\u65e0\u6570\u7ec6\u8282)\uff0c\u8fd9\u95e8\u8bfe\u7684\u76ee\u6807\u4e5f\u5c31\u8fbe\u5230\u4e86\u3002\u56e0\u4e3a\u6211\u4eec\u5bf9\u4f60\u7684 <code>include/</code> \u76ee\u5f55\u4e2d\u7684\u4ee3\u7801\u4e0d\u505a\u4efb\u4f55\u9650\u5236\uff0c\u4f60\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e00\u4e9b\u8bf8\u5982\u7ed3\u6784\u4f53\u672a\u5b9a\u4e49\u7b49\u95ee\u9898\uff0c\u7167\u5e38\u89e3\u51b3\u5373\u53ef\u3002\u5982\u679c\u53d1\u73b0\u6d4b\u8bd5\u7528\u4f8b\u4e2d\u7684 bugs\uff0c\u8bf7\u5411\u6211\u4eec\u62a5\u544a\u3002</p> <p>\u53e6\u5916\uff0c\u63d0\u4ea4\u65f6\u8bf7\u4e0d\u8981\u6fc0\u6d3b\u5b98\u65b9\u6d4b\u8bd5\u7528\u4f8b (\u4f8b\u5982\u542f\u52a8 <code>dev</code> \u6a21\u5757)\uff0c\u5b83\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6d4b\u8bd5\u5931\u8d25\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#33-online-judge","title":"3.3 Online Judge \u4e0a\u7684\u6d4b\u8bd5\u7528\u4f8b","text":"<p>\u4e0e L1 \u7c7b\u4f3c\uff0c\u6211\u4eec\u7684\u6d4b\u8bd5\u4ee3\u7801\u4f1a\u4f7f\u7528 Online Judge \u7684 <code>framework</code> \u4ee3\u7801 (\u5305\u542b\u4e00\u4e9b\u6d4b\u8bd5\u7528\u4f8b\u3001\u989d\u5916\u7684\u8fd0\u884c\u65f6\u68c0\u67e5\u7b49)\u3002\u6846\u67b6\u4ee3\u7801\u4f1a\u8c03\u7528\u4f60\u7684 <code>os-&gt;init()</code> \u548c <code>os-&gt;run()</code>\uff0c\u5c31\u50cf\u4e0b\u9762\u7684\u4ee3\u7801\u90a3\u6837\uff1a</p> <pre><code>static void producer(void *arg) { ... }\nstatic void consumer(void *arg) { ... }\nstatic void create_threads() {\n  ...\n  kmt-&gt;create(pmm-&gt;alloc(sizeof(task_t)),\n              \"test-thread-1\", producer, xxx);\n  kmt-&gt;create(pmm-&gt;alloc(sizeof(task_t)),\n              \"test-thread-2\", consumer, yyy);\n  ...\n}\nint main() {\n  ioe_init();\n  cte_init(os-&gt;trap);\n  os-&gt;init();\n  create_threads();\n  mpe_init(os-&gt;run); // all cores call os-&gt;run()\n  return 1;\n}\n</code></pre> <p>\u6211\u4eec\u7684 producer/consumer \u53ef\u80fd\u5c31\u50cf\u4e0a\u8bfe\u7684\u4f8b\u5b50\u90a3\u6837\uff0c\u7ba1\u7406 empty \u548c fill \u4e24\u4e2a\u4fe1\u53f7\u91cf\uff0c\u5206\u522b\u6253\u5370\u5de6\u62ec\u53f7\u548c\u53f3\u62ec\u53f7\uff0c\u7136\u540e\u6211\u4eec\u4f1a\u68c0\u67e5\u8f93\u51fa\u662f\u5426\u6ee1\u8db3 (1) \u662f\u5408\u6cd5\u62ec\u53f7\u5e8f\u5217\u7684\u4e00\u4e2a\u524d\u7f00; (2) \u62ec\u53f7\u5d4c\u5957\u7684\u6df1\u5ea6\u662f\u5426\u8d85\u8fc7\u8981\u6c42\u3002\u4e0e Lab1 \u4e00\u6837\uff0c\u6211\u4eec\u5728\u6d4b\u8bd5\u65f6\u4f1a\u94fe\u63a5\u4e00\u4e2a\u6211\u4eec\u5b9e\u73b0\u6b63\u786e\u7684 klib\uff0c\u6240\u4ee5\u5927\u5bb6\u5373\u4fbf klib \u6709 bug\uff0c\u4e5f\u4e0d\u5fc5\u592a\u8fc7\u62c5\u5fc3\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#4","title":"4. \u5b9e\u9a8c\u6307\u5357","text":""},{"location":"courses/os_lab/L2_kmt.html#41","title":"4.1 \u5750\u4e0b\u6765\uff0c\u8bfb\u4e00\u8bfb\u4ee3\u7801","text":"<p>\u6211\u4eec\u63a8\u8350\u5927\u5bb6\u9605\u8bfb\u7684\u4e24\u4efd\u4ee3\u7801\uff1a</p> <ul> <li>thread-os.c: \u4e00\u4e2a\u5355\u5904\u7406\u5668\u3001\u5206\u65f6\u8c03\u5ea6\u56fa\u5b9a\u6570\u91cf\u7ebf\u7a0b\u3001round-robin \u8c03\u5ea6\u7684\u5d4c\u5165\u5f0f\u64cd\u4f5c\u7cfb\u7edf\u3002\u8bfe\u5802\u4e0a\u6211\u4eec\u8bb2\u89e3\u4e86\u5982\u4f55\u8c03\u8bd5\u5b83</li> <li>xv6 \u7684\u4ee3\u7801\u3002\u968f\u7740\u8bfe\u7a0b\u7684\u6df1\u5165\uff0c\u6211\u4eec\u4e5f\u4f1a\u5728\u8bfe\u5802\u4e0a\u8bb2\u89e3\u8fd9\u90e8\u5206\u4ee3\u7801</li> </ul> <p>\u4e0a\u8bfe\u65f6\u7684\u4ee3\u7801\u8c03\u8bd5\u6f14\u793a\u5bf9\u5b9e\u9a8c\u7684\u751f\u5b58\u662f\u81f3\u5173\u91cd\u8981\u7684\u3002\u4f8b\u5982\uff0c\u4f60\u5e94\u8be5 <code>thread-os</code> \u5728\u4e00\u6b21\u65f6\u949f\u4e2d\u65ad\u540e\u7684\u4ee3\u7801\uff0c\u7ed3\u5408 AbstractMachine \u7684\u6587\u6863\uff0c\u4f60\u5c31\u80fd\u5bf9\u4e2d\u65ad\u5230\u5e95\u53d1\u751f\u4e86\u4ec0\u4e48\u3001AbstractMachine \u5230\u5e95\u505a\u4e86\u4ec0\u4e48\u6709\u66f4\u52a0\u6df1\u5165\u7684\u8ba4\u8bc6\u2014\u2014\u66f4\u91cd\u8981\u7684\u662f\uff0c<code>thread-os.c</code> \u662f\u5927\u5bb6\u5b9e\u73b0 Lab2 \u7684\u4e00\u4e2a \u201c\u57fa\u7840\u6027\u201d \u7684\u6846\u67b6\u3002\u4e0d\u8981\u5fd8\u8bb0\u4e86\uff0c\u6211\u4eec\u7684 Lab2 \u5c31\u662f\u8981\u5b9e\u73b0\u4e30\u5bcc\u7248\u7684 <code>thread-os.c</code>!</p> <p>\u800c <code>thread-os.c</code> \u4e2d\u6bd4\u8f83\u91cd\u8981\u7684\u662f\uff0c\u9996\u5148\u5b83\u6ce8\u518c\u4e86\u7cfb\u7edf\u5168\u5c40\u7684\u4e2d\u65ad\u5904\u7406\u51fd\u6570\uff1a</p> <pre><code>cte_init(on_interrupt);\n</code></pre> <p>\u800c\u8fd9\u4e2a\u51fd\u6570\u5728\u6211\u4eec\u7684\u5b9e\u9a8c\u4e2d\u7684\u5bf9\u5e94\u5c31\u662f <code>os-&gt;trap()</code>\u3002\u4e8e\u662f\u4f60\u4f1a\u77e5\u9053 <code>os-&gt;trap</code> \u7684\u4ee3\u7801\u4f1a\u548c <code>on_interrupt</code> \u6bd4\u8f83\u50cf\uff1a</p> <pre><code>Context *on_interrupt(Event ev, Context *ctx) {\n  if (!current) {\n    current = &amp;tasks[0];  // First trap\n  } else {\n    current-&gt;context = ctx;\n    current = current-&gt;next;\n  }\n  return current-&gt;context;\n}\n</code></pre> <p>\u800c\u4f60\u518d\u53bb\u770b <code>os-&gt;trap</code> \u548c <code>os-&gt;on_irq</code> \u7684\u5b9e\u9a8c\u8981\u6c42\uff0c\u4f60\u5c31\u80fd\u53d1\u73b0\u6211\u4eec\u5b9e\u9a8c\u7684\u9700\u6c42\u5408\u60c5\u5408\u7406\u3002\u5982\u679c\u4f60\u6ca1\u6709\u5f88\u597d\u5730\u7406\u89e3\u8fd9\u4e9b\u4ee3\u7801\u7684\u5de5\u4f5c\u539f\u7406\u800c\u76f2\u76ee\u5730 \u201c\u76f4\u63a5\u52a8\u624b\u4e0a\u5b9e\u9a8c\u201d\uff0c\u5f88\u53ef\u80fd\u4f1a\u9047\u5230\u5f88\u5927\u7684\u632b\u6298\u2014\u2014\u4f60\u7684\u7a0b\u5e8f\u5f88\u53ef\u80fd\u4f1a\u51fa\u73b0\u5404\u79cd\u5947\u602a\u7684\u95ee\u9898\uff0c\u800c\u4f60\u5374\u4e0d\u77e5\u9053\u4ece\u4f55\u4e0b\u624b\u3002\u4f46\u5982\u679c\u4f60\u8c03\u8bd5\u8fc7 thread-os \u6216\u8005 xv6 \u7684\u4ee3\u7801\uff0c\u5219\u4f1a\u66f4\u6709\u5e95\u6c14\u4e00\u4e9b\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#_5","title":"\u4e0d\u77e5\u9053\u5b9e\u9a8c\u8981\u6c42\u5728\u8bf4\u4ec0\u4e48\uff1f","text":"<p>\u62ff\u5230\u8fd9\u4e2a\u5b9e\u9a8c\u7684\u7b2c\u4e00\u611f\u89c9\u5c31\u662f\uff1a\u5b9e\u9a8c\u8981\u6c42\u4e5f\u592a tmd \u957f\u4e86\u3002\u8fd9\u73a9\u610f\u8fd8\u8981 Online Judge\uff0c\u8fd8\u4e0d\u5f97\u6b7b\u4eba\u4e86\uff1f\u8fd9\u662f\u5f88\u6b63\u5e38\u7684\u3002\u4e0d\u8981\u614c\uff0c\u56e0\u4e3a\u4f60\u4eec\u5df2\u7ecf\u6709\u8fc7 Lab1 \u7684\u7ecf\u9a8c\uff0c\u73b0\u5728\u4f60\u4eec\u53ef\u4ee5\u591a\u82b1\u4e00\u70b9\u65f6\u95f4\u6765\u8bfb\u4ee3\u7801\u4e86\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#42","title":"4.2 \u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u7a0b\u5e8f","text":"<p>\u73b0\u5728\uff0c\u6211\u4eec\u7684\u64cd\u4f5c\u7cfb\u7edf\u8fd8\u4e0d\u652f\u6301\u8fdb\u7a0b\u3001\u6587\u4ef6\u7cfb\u7edf\u7b49\uff0c\u4f46\u7684\u786e\u6709\u4e86\u5b8c\u5584\u7684\u7269\u7406\u5185\u5b58\u7ba1\u7406\u548c\u7ebf\u7a0b\u7ba1\u7406 API\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u6211\u4eec\u5b9e\u73b0\u7684\u662f\u4e00\u4e2a\u652f\u6301\u7ebf\u7a0b\u7684 \u201c\u5d4c\u5165\u5f0f\u64cd\u4f5c\u7cfb\u7edf\u201d\uff0c\u5b83\u80fd\u8fd0\u884c\u5728\u6ca1\u6709 MMU \u7684\u786c\u4ef6\u4e0a\u3002</p> <p>\u4e3a\u8fd9\u6837\u7684\u4e00\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u7f16\u5199 \u201c\u5e94\u7528\u7a0b\u5e8f\u201d\uff0c\u5c31\u662f\u76f4\u63a5\u5728\u64cd\u4f5c\u7cfb\u7edf\u4ee3\u7801\u4e2d\u9759\u6001\u94fe\u63a5\u4e00\u4e9b\u51fd\u6570\uff0c\u8fd9\u4e9b\u51fd\u6570\u53ef\u4ee5\u4f5c\u4e3a\u7ebf\u7a0b\u7684\u5165\u53e3\uff0c\u5e76\u4e14\u51fd\u6570\u53ef\u4ee5\u4efb\u610f\u8bbf\u95ee\u5185\u6838\u6570\u636e\u3001\u76f4\u63a5\u4ee5\u51fd\u6570\u8c03\u7528\u7684\u5f62\u5f0f\u8c03\u7528\u64cd\u4f5c\u7cfb\u7edf\u5185\u7684 API\u3002\u4e3a\u4e86\u66f4\u597d\u5730\u7406\u89e3\u5b9e\u9a8c\u8981\u6c42\uff0c\u6211\u4eec\u4e0d\u59a8\u7ed9\u51fa\u4e00\u4e2a\u8bfe\u5802\u4e0a \u201c\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u201d \u5728\u6211\u4eec\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u8fd0\u884c\u7684\u4f8b\u5b50\u3002</p> <p>\u9996\u5148\uff0c\u6211\u4eec\u5b9a\u4e49\u4fe1\u53f7\u91cf (kmt \u5b9e\u9a8c\u9700\u6c42\u90e8\u5206)\uff0c\u5e76\u4e14\u7528\u5b8f\u5305\u88c5\u4e00\u4e0b P/V \u64cd\u4f5c (\u8fd9\u4e00\u6b65\u5b8c\u5168\u4e0d\u5fc5\u8981\uff0c\u53ea\u662f\u4e3a\u4e86\u8ba9\u6211\u4eec\u7684\u4ee3\u7801\u770b\u8d77\u6765\u548c\u8bfe\u5802\u4e0a\u8bb2\u89e3\u5f97\u4e00\u6837)\uff1a</p> <pre><code>sem_t empty, fill;\n#define P kmt-&gt;sem_wait\n#define V kmt-&gt;sem_signal\n</code></pre> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5199\u51fa\u4e2a\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u7ebf\u7a0b\u7684\u4ee3\u7801\uff0c\u5c31\u8ddf\u6211\u4eec\u8bfe\u5802\u4e0a\u5c55\u793a\u7684 <code>threads.h</code> \u5b8c\u5168\u4e00\u6837\uff1a</p> <pre><code>void Tproduce(void *arg) { while (1) { P(&amp;empty); putch('('); V(&amp;fill);  } }\nvoid Tconsume(void *arg) { while (1) { P(&amp;fill);  putch(')'); V(&amp;empty); } }\n</code></pre> <p>\u7136\u540e\uff0c\u6211\u4eec\u5728\u64cd\u4f5c\u7cfb\u7edf\u521d\u59cb\u5316 (<code>os-&gt;init</code>) \u4e2d\u521b\u5efa\u82e5\u5e72\u4e2a\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u7ebf\u7a0b\uff0c\u5176\u4e2d\u5229\u7528\u4e86\u7269\u7406\u5185\u5b58\u7684\u5206\u914d\uff1a</p> <pre><code>static inline task_t *task_alloc() {\n  return pmm-&gt;alloc(sizeof(task_t));\n}\n\nstatic void os_init() {\n  pmm-&gt;init();\n  kmt-&gt;init(); // \u6a21\u5757\u5148\u521d\u59cb\u5316\n\n#ifdef DEBUG_LOCAL\n  kmt-&gt;sem_init(&amp;empty, \"empty\", N);\n  kmt-&gt;sem_init(&amp;fill,  \"fill\",  0);\n  for (int i = 0; i &lt; NPROD; i++) {\n    kmt-&gt;create(task_alloc(), \"producer\", Tproduce, NULL);\n  }\n  for (int i = 0; i &lt; NCONS; i++) {\n    kmt-&gt;create(task_alloc(), \"consumer\", Tconsume, NULL);\n  }\n#endif\n}\n</code></pre> <p>\u6ce8\u610f\u5230\u4e0a\u9762\u7684 <code>DEBUG_LOCAL</code> \u5b8f\u3002\u4f60\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e2a\u5b8f\u7684\u5b9a\u4e49\u52a0\u8f7d\u4f60\u4eec\u7684 <code>CFLAGS</code> \u91cc\uff0c\u8fd9\u6837\u4f60\u4eec\u5728\u672c\u5730\u8c03\u8bd5\u7684\u65f6\u5019\u5c31\u4f1a\u521b\u5efa\u7528\u4e8e\u6d4b\u8bd5\u7684\u7ebf\u7a0b\uff0c\u4f46\u5728 Online Judge \u4e0a\u5219\u4e0d\u4f1a\u3002\u8fd9\u4e2a\u884c\u4e3a\u5bf9\u5927\u5bb6\u6765\u8bf4\u5f88\u91cd\u8981\uff1a\u4f60\u4eec\u6253\u5370\u4efb\u4f55\u591a\u4f59\u7684\u8f93\u51fa\uff0c\u90fd\u53ef\u80fd\u5bfc\u81f4 Wrong Answer\u3002\u8fd9\u4e2a\u6280\u5de7\u540c\u6837\u53ef\u4ee5\u7528\u4e8e\u5728 Online Judge \u4e0a\u5173\u95ed\u989d\u5916\u7684\u8fd0\u884c\u65f6\u68c0\u67e5\uff0c\u63d0\u9ad8\u7a0b\u5e8f\u7684\u6267\u884c\u901f\u5ea6\u3002</p> <p>\u5982\u679c\u4f60\u7684\u4ee3\u7801\u5b9e\u73b0\u6b63\u786e\uff0c\u5728\u6a21\u62df\u5668\u4e0a\u8fd0\u884c (\u53ef\u4ee5\u4f7f\u7528 <code>smp=2</code>, <code>smp=4</code> \u7b49\u8fd0\u884c\u542f\u52a8\u591a\u4e2a\u5904\u7406\u5668) \u80fd\u591f\u770b\u5230\u6253\u5370\u51fa\u6b63\u786e\u7684\u62ec\u53f7\u5e8f\u5217\uff1a\u603b\u662f\u5408\u6cd5\u62ec\u53f7\u5e8f\u5217\u7684\u524d\u7f00\uff0c\u4e14\u62ec\u53f7\u5d4c\u5957\u7684\u6df1\u5ea6\u4e0d\u8d85\u8fc7 5\u3002\u5e26\u7740\u8fd9\u6837\u7684\u4e00\u4e2a\u5177\u4f53\u7684\u64cd\u4f5c\u7cfb\u7edf\u7684\u5c0f \u201c\u6d4b\u8bd5\u201d\uff0c\u4f60\u80fd\u66f4\u597d\u5730\u7406\u89e3\u6846\u67b6\u4ee3\u7801\u2014\u2014\u5b83\u5176\u5b9e\u5e76\u4e0d\u590d\u6742\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#_6","title":"\u5982\u679c\u4ee3\u7801\u5b9e\u73b0\u7684\u6b63\u786e\uff1f","text":"<p>\u4f60\u4eec\u5728\u7f16\u7a0b\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u4f1a\u9047\u5230\u65e0\u6570\u8be1\u5f02\u7684 bug\uff0c\u8dd1\u7740\u8dd1\u7740\u865a\u62df\u673a\u5c31\u6302\u4e86\uff0c\u800c\u4e14\u9519\u5f97\u975e\u5e38\u79bb\u8c31\uff0c\u5b8c\u5168\u4e0d\u77e5\u9053\u53d1\u751f\u4e86\u4ec0\u4e48\u3002\u5bf9\u4e8e\u5e76\u53d1\u7a0b\u5e8f\uff0c\u66f4\u96be\u53d7\u7684\u662f\u53ef\u80fd\u8981\u8fd0\u884c\u5f88\u591a\u6b21\uff0c\u6216\u8005\u5728\u67d0\u4e2a\u7279\u5b9a\u7684\u6761\u4ef6\u4e0b bug \u624d\u4f1a\u89e6\u53d1\u3002\u4f46\u4f60\u90fd\u76f8\u4fe1 (1) \u673a\u5668\u6c38\u8fdc\u662f\u5bf9\u7684; (2) \u672a\u6d4b\u4ee3\u7801\u6c38\u8fdc\u662f\u9519\u7684\u3002</p> <p>\u5f53\u7136\uff0c\u6211\u4eec\u4e0d\u6392\u9664 AbstractMachine \u6709 bug\u3001gcc \u6709 bug\u3001qemu \u6709 bug\uff0c\u751a\u81f3\u662f\u4f60\u7684\u5904\u7406\u5668\u6709 bug\u3002\u4f46\u6700\u7ec8\u65e0\u8bba\u662f\u54ea\u91cc\u7684\u95ee\u9898\uff0c\u53ea\u8981\u4f7f\u7528\u6b63\u786e\u7684\u7f16\u7a0b\u65b9\u5f0f\uff0c\u4f60\u6700\u7ec8\u90fd\u80fd\u627e\u5230\u8fd9\u4e2a bug\uff0c\u673a\u5668\u6c38\u8fdc\u662f\u5bf9\u7684\u3002\u5904\u7406\u5668\u7684 bug \u662f\u5b83\u7684\u4e00\u4e2a \u201cfeature\u201d\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#43-bug","title":"4.3 \u5728 Bug \u4e2d\u6d3b\u4e0b\u6765","text":"<p>\u56e0\u6b64\u4f60\u5b9e\u9645\u56de\u8fc7\u5934\u770b\uff0c\u8fd9\u4e2a\u5b9e\u9a8c\u5e76\u4e0d\u9700\u8981\u5b9e\u73b0\u591a\u5c11\u4ee3\u7801\u2014\u2014\u6bd4\u8f83\u7d27\u51d1\u7684\u53c2\u8003\u5b9e\u73b0\u4ec5\u4ec5\u5c0f\u51e0\u767e\u884c\u4ee3\u7801\u2014\u2014\u4e0d\u5c31\u662f\u7ebf\u7a0b\u3001\u81ea\u65cb\u9501\u548c\u4fe1\u53f7\u91cf\uff0c\u52a0\u4e0a\u4e00\u4e9b\u96f6\u788e\u7684\u4ee3\u7801 (\u4e2d\u65ad\u5904\u7406\u7684\u5165\u53e3\u7b49) \u561b\uff01\u90a3\u4e3a\u4ec0\u4e48\u5b9e\u9a8c\u8981\u6c42\u8981\u5199\u90a3\u4e48\u957f\u5462\uff1f\u8fd8\u7279\u522b\u7528\u7ea2\u8272\u5b57\u548c\u7070\u8272\u7684\u5e95\u8272\u6807\u51fa \u201c\u7ebf\u7a0b/\u4e2d\u65ad\u201d \u5b89\u5168\uff1f\u662f\u56e0\u4e3a\u6211\u4eec\u5e0c\u671b\u4f60\u7684\u4ee3\u7801\u5728\u591a\u5904\u7406\u5668\u3001\u4e2d\u65ad\u90fd\u5b58\u5728\u7684\u60c5\u51b5\u4e0b\u4fdd\u6301\u6b63\u786e\u3002\u8fd9\u4e0d\u662f\u4e00\u53e5\u7a7a\u8bdd\uff0c\u4f60\u4e0b\u9762\u4f1a\u770b\u5230\u5b83\u5b9e\u9645\u7684\u5177\u4f53\u542b\u4e49\u3002\u6216\u8005\u8bf4\uff0c\u4f60\u53ea\u6709\u5728\u505a\u5b8c\u5b9e\u9a8c\u4ee5\u540e\uff0c\u624d\u4f1a\u5bf9\u4e0b\u9762\u8fd9\u4e9b\u8bdd\u4ea7\u751f\u771f\u6b63\u7684\u7406\u89e3\uff1a</p> <ol> <li>\u4ee3\u7801\u53ef\u4ee5\u5728\u591a\u4e2a\u5904\u7406\u5668\u4e0a\u88ab\u540c\u65f6\u8c03\u7528\u3002\u56e0\u6b64\u4f60\u9700\u8981\u5c0f\u5fc3\u5730\u4fdd\u8bc1\u539f\u5b50\u6027\u3001\u987a\u5e8f\u3001\u53ef\u89c1\u6027\u3002\u5343\u4e07\u5c0f\u5fc3\uff1a<code>kmt-&gt;create()</code>, <code>kmt-&gt;sem_signal()</code> \u7b49\u6240\u6709\u51fd\u6570\u90fd\u53ef\u80fd\u540c\u65f6\u5728\u591a\u4e2a\u5904\u7406\u5668\u4e0a\u88ab\u8c03\u7528\u3002\u4f60\u73b0\u5728\u89c9\u5f97\u8fd9\u53e5\u8bdd\u5f88\u53ef\u7b11\uff0c\u4f60\u65e9\u5c31\u77e5\u9053\uff0c\u4f46\u4f60\u8c03\u8fc7 bug \u5c31\u77e5\u9053\u5389\u5bb3\u4e86\u3002</li> <li>\u5728\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u4e2d\u53ef\u4ee5\u8c03\u7528\u81ea\u65cb\u9501\u3002\u5b9e\u9645\u4e0a\uff0c\u4e00\u4e2a CPU \u7684\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u53ef\u4ee5\u548c\u53e6\u4e00\u4e2a CPU \u8bbf\u95ee\u540c\u4e00\u4e2a\u5171\u4eab\u6570\u636e\u7ed3\u6784 (\u4f8b\u5982\u5728\u4e2d\u65ad\u4e2d\u5411\u94fe\u8868\u91cc\u63d2\u5165\u4e00\u4e2a\u5143\u7d20\uff0c\u8fd9\u4e2a\u94fe\u8868\u88ab\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u8bfb\u53d6)\uff0c\u56e0\u6b64\u81ea\u65cb\u9501\u662f\u4fdd\u8bc1\u6b63\u786e\u6027\u7684\u91cd\u8981\u624b\u6bb5\u3002</li> <li>\u5c0f\u5fc3\u6570\u636e\u7ade\u4e89\u3002\u4e00\u5207\u5171\u4eab\u7684\u6570\u636e\u90fd\u53ef\u80fd\u4f1a\u4ea7\u751f\u6570\u636e\u7ade\u4e89\u2014\u2014\u5982\u679c\u4f60\u6ca1\u6709\u4fdd\u62a4\u597d\u7684\u8bdd\u3002\u6709\u4e9b\u5185\u5b58\u8bbf\u95ee\u6084\u6084\u5728\u4f60\u610f\u60f3\u4e0d\u5230\u7684\u65f6\u5019\u53d1\u751f\uff0c\u4f8b\u5982\u5bf9\u5806\u6808\u7684\u8bbf\u95ee\u2014\u2014\u6211\u4eec\u5df2\u7ecf\u505a\u51fa\u4e86\u63d0\u793a\uff0c\u5c0f\u5fc3\uff01\u5c0f\u5fc3\uff01</li> </ol> <p>\u5f88\u5feb\u5199\u7740\u5199\u7740\u4f60\u5c31\u4f1a\u53d1\u73b0\u81ea\u5df1\u7684\u4ee3\u7801\u51fa bug \u4e86\uff0c\u6709\u53ef\u80fd\u662f\u5e76\u53d1\u7684\uff0c\u6709\u53ef\u80fd\u53ea\u662f\u987a\u5e8f\u7684\u903b\u8f91\u5b9e\u73b0\u9519\u4e86\u3002\u5982\u679c\u51fa\u73b0\u4e86\u83ab\u540d\u5176\u5999\u7684\u5f02\u5e38\u3001\u865a\u62df\u673a\u795e\u79d8\u91cd\u542f\u7b49\u60c5\u51b5\u4e0d\u8981\u60ca\u614c\uff0c\u673a\u5668\u6c38\u8fdc\u662f\u5bf9\u7684\uff0c\u5750\u4e0b\u6765\u8c03\u4ee3\u7801\u5427\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#431","title":"4.3.1 \u8c03\u8bd5\u7406\u8bba\uff1a\u518d\u6b21\u590d\u4e60","text":"<p>\u5728\u8fd9\u4e24\u4e2a\u5b66\u671f\u7684\u8bfe\u7a0b\u91cc\uff0c\u6211\u4eec\u53cd\u590d\u63d0\u5230\u4e86\u8c03\u8bd5\u7406\u8bba\u2014\u2014\u6211\u4eec\u72af\u4e0b\u7684 bug \u662f fault\uff0c\u5b83\u5728\u8fd0\u884c\u65f6\u5bfc\u81f4\u7cfb\u7edf\u67d0\u4e2a\u6570\u503c\u4e0d\u7b26\u5408\u9884\u671f (specification), \u8fd9\u662f\u4e00\u4e2a error\uff0c\u800c\u53ea\u6709\u6700\u7ec8\u865a\u62df\u673a\u795e\u79d8\u5361\u6b7b/\u91cd\u542f/\u8f93\u51fa\u5947\u602a\u5185\u5bb9\uff0c\u6211\u624d\u771f\u6b63\u8bc1\u660e\u4e86\u7a0b\u5e8f\u91cc bug \u7684\u5b58\u5728 (failure)\u3002\u6211\u5efa\u8bae\u5927\u5bb6\u518d\u590d\u4e60\u4e00\u4e0b\u6211\u4eec\u8bfe\u7a0b\u7684\u89c6\u9891 (\u5e76\u53d1 bug)\uff0c\u6211\u4eec\u8bd5\u56fe\u7528\u8fd9\u6b21\u8bfe\u7a0b\u6765\u542f\u53d1\u4f60\uff0c\u5b9e\u73b0\u53ef\u9760\u8f6f\u4ef6\u7cfb\u7edf\u662f\u6709\u8ff9\u53ef\u5faa\u7684\u3002</p> <p>\u4e3a\u4e86\u8ba9 bug (fault) \u66f4\u5bb9\u6613\u88ab\u627e\u5230\uff0c\u6211\u4eec\u6709\u4e24\u4e2a\u60f3\u6cd5\uff1a</p> <ol> <li>fault \u2192 error, \u8ba9\u66f4\u591a\u7684 bug \u80fd\u5728\u8fd0\u884c\u65f6\u88ab\u89e6\u53d1\u51fa\u6765\u3002\u8fd9\u662f\u901a\u8fc7\u8be6\u5c3d\u7684\u6d4b\u8bd5\u5b9e\u73b0\u7684\u2014\u2014\u4f60\u4eec\u5df2\u7ecf\u5728 Lab1 \u91cc\u9971\u53d7\u6d4b\u8bd5\u4e0d\u5145\u5206\u7684\u6298\u78e8\u4e86\uff1b\u800c\u4f60\u4eec\u8981\u77e5\u9053\uff0cLab1 Online Judge \u7684\u6d4b\u8bd5\u8fdc\u8c08\u4e0d\u4e0a\u5145\u5206\u3002</li> <li>error \u2192 failure, \u8ba9\u8fd0\u884c\u65f6\u9519\u8bef\u7684\u72b6\u6001\u80fd\u5c3d\u5feb\u5730\u88ab\u6355\u83b7\u3002\u6211\u4eec\u7684 klib \u91cc\u5df2\u7ecf\u63d0\u4f9b\u4e86\u4ee5\u4e0b\u6709\u7528\u7684\u673a\u5236\u5e2e\u52a9\u4f60\u68c0\u67e5\uff1a</li> <li><code>assert</code>, \u4f60\u53ef\u4ee5\u901a\u8fc7 assert \u5c06\u7a0b\u5e8f\u5e94\u8be5\u6ee1\u8db3\u7684 specification (\u4f46\u4ee3\u7801\u672a\u5fc5\u4f53\u73b0) \u5199\u51fa\u6765</li> <li><code>panic</code>, \u7acb\u5373\u9000\u51fa\uff0c\u901a\u5e38\u662f\u56e0\u4e3a\u8fdb\u5165\u4e86\u67d0\u79cd\u4e0d\u6b63\u5e38\u7684\u72b6\u6001</li> <li><code>panic_on</code>, \u6761\u4ef6\u6210\u7acb\u65f6\u9000\u51fa\uff0c\u68c0\u67e5\u4e0d\u6b63\u5e38\u72b6\u6001\u5e76\u9000\u51fa</li> </ol> <p>\u5728\u9002\u5f53\u7684\u5730\u65b9\u52a0\u4e0a printf \u548c assert \u80fd\u5e2e\u52a9\u4f60\u5feb\u901f\u5b9a\u4f4d\u5230\u7a0b\u5e8f\u4e2d\u51fa\u9519\u7684\u72b6\u6001 (\u6bd4\u5982\u5728\u4e2d\u65ad\u5230\u6765\u65f6\u6253\u5370\u5bc4\u5b58\u5668\u7684\u73b0\u573a\uff0c\u80fd\u5feb\u901f\u5e2e\u4f60\u5b9a\u4f4d\u51fa\u73b0\u5f02\u5e38\u7684\u4f4d\u7f6e)\uff0c\u7f29\u5c0fbug \u7684\u68c0\u67e5\u8303\u56f4\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#_7","title":"\u60f3\u653e\u5f03\uff1f","text":"<p>\u76f8\u4fe1\u5927\u5bb6\u6709\u65e0\u6570\u6b21\u60f3\u653e\u5f03\u3002\u7b97\u4e86\uff0c\u6210\u7ee9\u4e0d\u8981\u4e86\u3002\u7b97\u4e86\uff0c\u6284\u4f5c\u4e1a\u5427\u3002\u5982\u679c\u4f60\u575a\u6301\u628a \u201c\u72ec\u7acb\u5b8c\u6210\u201d \u60f3\u8c61\u6210\u662f\u5bf9\u81ea\u5df1\u7684\u8bad\u7ec3\uff0c\u8fd9\u662f\u975e\u5e38\u6709\u76ca\u7684\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#432-log","title":"4.3.2 \u66f4\u597d\u7684 log \u65b9\u5f0f","text":"<p>\u76f8\u4fe1\u5927\u5bb6\u90fd\u6709\u8fc7\u4e0d\u505c\u5730\u52a0 <code>printf</code>, \u5220\u6389 <code>printf</code> \u7684\u8c03\u8bd5\u4f53\u9a8c\u5427\u3002\u8fd9\u611f\u89c9\u53ef\u4e0d\u592a\u597d\uff0c\u627e\u4e86\u4e00\u5927\u5708\uff0c\u6700\u540e\u53d1\u73b0\u4e00\u5f00\u59cb\u5220\u6389\u7684 <code>printf</code> \u6253\u5370\u7684\u4fe1\u606f\u624d\u662f\u6700\u6709\u7528\u7684\uff0c\u4e0d\u8fc7\u4e00\u6574\u5929\u5c31\u5df2\u7ecf\u8fc7\u53bb\u4e86\u3002</p> <p>\u4f60\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u4e00\u4e9b\u9884\u7f16\u8bd1\u9009\u9879\u63a7\u5236 log \u7684\u5f00\u5173\uff1a</p> <pre><code>#ifdef TRACE_F\n  #define TRACE_ENTRY printf(\"[trace] %s:entry\\n\", __func__)\n  #define TRACE_EXIT printf(\"[trace] %s:exit\\n\", __func__)\n#else\n  #define TRACE_ENTRY ((void)0)\n  #define TRACE_EXIT ((void)0)\n#endif\n\nvoid f() {\n  TRACE_ENTRY;\n  printf(\"This is f.\\n\");\n  TRACE_EXIT;\n}\n</code></pre> <p>\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u53d8\u91cf\u63a7\u5236 log \u7684\u5f00\u5173\uff0c\u4f8b\u5982\u8bbe\u7f6e <code>print_registers_on_irq</code>\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#433","title":"4.3.3 \u4f7f\u7528\u8c03\u8bd5\u5668","text":"<p>\u8ba9\u7136\uff0c\u5982\u679c\u5404\u79cd <code>printf</code> \u548c log \u90fd\u6ca1\u529e\u6cd5\u5e2e\u4f60\u627e\u5230\u95ee\u9898\uff0c\u4e5f\u8bb8\u4e0a gdb \u662f\u4e2a\u4e0d\u9519\u7684\u4e3b\u610f\u3002\u6846\u67b6\u4ee3\u7801\u91cc\u6545\u610f\u6ca1\u6709\u63d0\u4f9b <code>make debug</code> \u7684\u9009\u9879\uff0c\u4f46\u6211\u4eec\u5df2\u7ecf\u9891\u7e41\u5730\u5728\u8bfe\u4e0a\u5c55\u793a\u4e86\u5982\u4f55\u8c03\u8bd5\uff0cqemu \u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u547d\u4ee4\u884c\u9009\u9879\uff1a</p> <ul> <li><code>-gdb</code> \u80fd\u542f\u52a8\u8c03\u8bd5\u6a21\u5f0f\uff1b</li> <li><code>-S</code> \u80fd\u8ba9\u865a\u62df\u673a\u5728\u6536\u5230\u8c03\u8bd5\u547d\u4ee4\u524d\u4e0d\u6267\u884c\u6267\u884c\uff1b</li> <li>\u5728 gdb \u4e2d\u53ef\u4ee5\u7528 <code>target</code> \u547d\u4ee4\u8fde\u63a5\u8fdc\u7a0b\u8c03\u8bd5\uff1b</li> <li>\u7528 <code>.gdbinit</code> (\u6216 <code>-x</code>, <code>-ex</code> \u9009\u9879) \u80fd\u5b9e\u73b0\u811a\u672c\u7684\u9884\u5148\u6267\u884c\u3002</li> </ul> <p>\u6b64\u5916\uff0cprintf \u5e76\u4e0d\u662f\u552f\u4e00\u8c03\u8bd5\u4fe1\u606f\u7684\u6765\u6e90\u3002\u4e0a\u8bfe\u7684\u540c\u5b66\u5e94\u8be5\u8fd8\u6709\u5370\u8c61\uff0c\u6211\u4eec\u8bb2\u89e3\u8fc7\u5982\u4f55\u4f7f\u7528 qemu monitor \u4e2d\u7684 log \u6765\u8c03\u8bd5\u795e\u79d8\u7684 CPU \u91cd\u542f\u3002\u5f53\u4f60\u771f\u6b63\u8d70\u6295\u65e0\u8def\u7684\u65f6\u5019\uff0c\u4f60\u4f1a\u53d1\u73b0\u8fd9\u4e9b\u5de5\u5177\u624d\u662f\u8c03\u8bd5\u7cfb\u7edf\u8f6f\u4ef6\u91cc\u6700\u91cd\u8981\u7684\u8bbe\u65bd\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#_8","title":"\u4e0d\u4fe1\u90aa\uff1f","text":"<p>\u5982\u679c\u53ea\u662f\u5199\u51e0\u5341\u4e0a\u767e\u884c\u7684 OJ \u7a0b\u5e8f\uff0c\u65e0\u8bba\u4f60\u4e60\u60ef\u591a\u4e48\u7684\u574f\uff0c\u591a\u591a\u5c11\u5c11\u603b\u662f\u80fd\u8c03\u8bd5\u51fa\u6765\u7684\u3002\u4f46\u5982\u679c\u8981\u7ef4\u62a4\u66f4\u5927\u7684\u7a0b\u5e8f\uff0c\u7528\u4e0a\u6b63\u786e\u7684\u5de5\u5177\u5c31\u80fd\u5e2e\u4e0a\u5927\u5fd9\u4e86\u3002</p> <p>\u56e0\u6b64\uff0c\u4f60\u5728\u8bfb\u5b8c\u4e0a\u9762\u90a3\u4e9b\u6587\u5b57\u7684\u65f6\u5019\uff0c\u4f60\u5fc3\u91cc\u80af\u5b9a\u60f3\uff1a\u8fd9\u4e48\u9ebb\u70e6\uff0c\u5173\u6211 \u00d7\u00d7 \u4e8b\u3002\u5bf9\u4e2d\u67aa\u7684\u540c\u5b66\uff1a\u5f53\u4f60\u5b9e\u5728\u627e\u4e0d\u5230 bug \u7684\u65f6\u5019\uff0c\u56de\u6765\u6c42 gdb \u4e5f\u8bb8\u80fd\u5e2e\u4f60\u633d\u56de\u51e0\u5929\u7684\u8c03\u8bd5\u65f6\u95f4\u3002\u8fd9\u65f6\u5019\u4f60\u5c31\u771f\u6b63\u4f53\u4f1a\u5230\u57fa\u7840\u8bbe\u65bd\u7684\u91cd\u8981\u6027\u4e86\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#434","title":"4.3.4 \u4fdd\u62a4\u81ea\u5df1\u4e0d\u53d7\u4f24\u5bb3","text":"<p>\u6709\u4e9b bug \u53ef\u80fd\u4f1a\u975e\u5e38\u96be\u8c03\u8bd5\uff0c\u8fd9\u91cc\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff1a\u6808\u6ea2\u51fa\u3002\u4e5f\u8bb8\u5df2\u7ecf\u6709\u540c\u5b66\u5403\u8fc7\u82e6\u5934\u4e86\uff1a\u6808\u7a7a\u95f4\u4e0d\u662f\u65e0\u9650\u5927\u7684\uff0c\u800c\u5982\u679c\u6211\u4eec\u5e26\u7740\u5f88\u5927\u7684\u5c40\u90e8\u53d8\u91cf\u6216\u8005\u9012\u5f52\u5f88\u591a\u5c42\uff0c\u6808\u5c31\u6084\u6084\u6ea2\u51fa\u4e86\u2026\u2026\u5728\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4e2d\uff0c\u5185\u6838\u7ebf\u7a0b\u6808\u7684\u6ea2\u51fa\u5c31\u663e\u5f97\u66f4\u5371\u9669\u4e86\uff0c\u56e0\u4e3a\u4f60\u53ef\u80fd\u4f1a\u5b9a\u4e49\uff1a</p> <pre><code>struct task_t {\n  int32_t id;\n  ...\n  uint8_t stack[STK_SZ];\n};\n</code></pre> <p>\u800c\u6808\u6ea2\u51fa (x86 \u7684\u6808\u4ece\u9ad8\u5730\u5740\u5411\u4f4e\u5730\u5740\u751f\u957f) \u7684\u540e\u679c\u5c31\u662f\u7ebf\u7a0b\u7684\u4fe1\u606f\u53ef\u80fd\u88ab\u8986\u76d6\uff0c\u51fa\u73b0\u5404\u79cd\u8be1\u5f02 (\u96be\u4ee5\u7406\u89e3) \u7684\u60c5\u51b5\uff0c\u800c\u4e14\u6709\u53ef\u80fd bug \u82e5\u9690\u82e5\u73b0\uff0c\u52a0\u4e00\u6761 <code>printf</code> \u4e5f\u8bb8\u5c31\u4e0d\u89e6\u53d1\u4e86\u3002\u5982\u679c\u60f3\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\u7684\u53d1\u751f\uff0c\u53ef\u4ee5\u7ed9\u6808\u7684\u524d\u540e\u52a0\u4e00\u4e9b\u6805\u680f\u7f13\u51b2 (fences)\uff0c\u6216\u8005\u91d1\u4e1d\u96c0 (canaries)\uff0c\u6211\u4eec\u4e0a\u8bfe\u65f6\u4e5f\u8bb2\u89e3\u8fc7\u3002</p> <p>\u540c\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 kalloc/free \u7684\u65f6\u5019\u505a\u4e00\u4e9b hacking\uff0c\u8fd9\u6837\u53ef\u4ee5\u5e2e\u52a9\u4f60\u68c0\u67e5\u51fa\u5f88\u591a\u7c7b\u578b\u7684 bugs\uff0c\u4f8b\u5982\u4f60\u53ef\u4ee5\u5728 free \u4ee5\u540e\u5c06\u5185\u5b58\u5168\u90e8\u586b\u4e3a\u67d0\u4e00\u4e2a magic number\uff0c\u7136\u540e\u5728\u5173\u952e\u7684 pointer deference \u7684\u5730\u65b9\u63d2\u5165</p> <pre><code>#define uaf_check(ptr) \\\n  panic_on(MAGIC == *(uint32_t *)(ptr), \"use-after-free\");\n\n*ptr ... // important pointer, e.g., current\nuaf_check(ptr)\n</code></pre> <p>\u8fd9\u4e9b defensive \u7684\u7f16\u7a0b\u65b9\u5f0f\uff0c\u5e2e\u52a9\u4f60\u628a\u4ee3\u7801\u4e2d\u5e94\u8be5\u6ee1\u8db3\u7684 specification \u660e\u786e\u5730\u5728\u4ee3\u7801\u4e2d\u5199\u51fa\u6765\u2014\u2014\u6211\u4eec\u4f18\u5148\u5047\u8bbe\u6211\u4eec\u7684\u4ee3\u7801\u662f\u6709 bug \u7684\uff0c\u800c\u4e0d\u662f\u6ca1\u6709 bug \u7684\u3002\u5728\u6b64\u5047\u8bbe\u4e0b\uff0c\u505a\u7684\u68c0\u67e5\u8d8a\u591a\uff0c\u8d8a\u80fd\u51cf\u5c11 bug \u5bf9\u6211\u4eec\u8c03\u8bd5\u5e26\u6765\u7684\u75db\u82e6\u3002</p> <p>\u6700\u540e\uff0c\u8fd9\u51e0\u8282\u4e2d\u4ecb\u7ecd\u7684\u77e5\u8bc6\u90fd\u662f\u5b8c\u5168\u6ca1\u6709\u7528\u7684\u2014\u2014\u5982\u679c\u4f60\u4e0d\u5199\u591f\u5927\u7684\u4ee3\u7801\uff0c\u505a\u591f\u7cfb\u7edf\u7684\u9879\u76ee\uff0c\u4f60\u6c38\u8fdc\u90fd\u4e0d\u4f1a\u7528\u5230\u8fd9\u91cc\u7684\u77e5\u8bc6\uff0c\u6c38\u8fdc\u90fd\u4e0d\u4f1a\u60f3\u628a C \u8bed\u8a00\u7684\u80fd\u529b\u53d1\u6325\u5230\u6781\u81f4\u3002\u8fd9\u91cc\u7684\u77e5\u8bc6\u5bf9\u7406\u8bba\u8003\u8bd5\u51e0\u4e4e\u5b8c\u5168\u6ca1\u6709\u4efb\u4f55\u5e2e\u52a9\u3002\u4f46\u6b63\u662f\u5728\u79cd\u79cd\u7ec6\u8282\u4e0a\u8ffd\u6c42\u5b8c\u7f8e\u624d\u6210\u5c31\u4e86\u5927\u578b\u8f6f\u4ef6\u7cfb\u7edf\u7684\u6210\u529f\u3002\u4f18\u96c5\u7684\u4ee3\u7801\u8d4f\u5fc3\u60a6\u76ee\u3002\u5173\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\uff0cxv6 \u7edd\u5bf9\u662f\u4e00\u4efd\u4e86\u4e0d\u8d77\u7684\u4f73\u4f5c\uff0c\u770b\u4f3c\u5e73\u6de1\u65e0\u5947\u7684\u4ee3\u7801\u91cc\u53c2\u900f\u7740\u7cfb\u7edf\u8bbe\u8ba1\u7684\u667a\u6167\uff0c\u503c\u5f97\u5927\u5bb6\u54c1\u5473\u3002</p>"},{"location":"courses/os_lab/L2_kmt.html#44","title":"4.4 \u5b9e\u73b0\u80fd\u7761\u7720\u7684\u4e92\u65a5\u9501\u548c\u4fe1\u53f7\u91cf","text":"<p>\u81ea\u65cb\u9501\u5927\u5bb6\u53c2\u8003\u8bfe\u5802\u8bb2\u89e3\u7684\u4ee3\u7801\u548c xv6 \u5b9e\u73b0\u5373\u53ef\u3002\u4f46\u81ea\u65cb\u9501\u867d\u7136\u4fdd\u8bc1\u4e86\u591a\u5904\u7406\u5668\u8d44\u6e90\u4e0d\u4f1a\u88ab\u5b8c\u5168\u6d6a\u8d39 (\u5728\u6ca1\u6709\u6b7b\u9501\u7684\u524d\u63d0\u4e0b\uff0c\u81f3\u5c11\u6709\u4e00\u4e2a\u5904\u7406\u5668\u80fd\u4e00\u76f4\u6267\u884c)\uff0c\u4f46\u5173\u4e2d\u65ad\u5bf9\u4e8e\u957f\u4e34\u754c\u533a\u6765\u8bf4\u662f\u975e\u5e38\u7cdf\u7cd5\u7684\u4e00\u4ef6\u4e8b\uff1a</p> <ul> <li>\u957f\u65f6\u95f4\u5173\u4e2d\u65ad\u4f1a\u5bfc\u81f4\u4e2d\u65ad\u4e22\u5931\uff1b</li> <li>\u5176\u4ed6\u5904\u7406\u5668\u4e0a\u8bd5\u56fe\u83b7\u5f97\u9501\u7684\u7ebf\u7a0b\u4f1a\u5927\u91cf\u6d6a\u8d39\u5904\u7406\u5668\u8d44\u6e90\u81ea\u65cb\uff1b</li> <li>\u4e92\u65a5\u4e2d\u7684\u4ee3\u7801\u53ef\u80fd\u9700\u8981\u7b49\u5f85\u4e2d\u65ad (\u4f8b\u5982\u5e0c\u671b\u4e92\u65a5\u8bbf\u95ee I/O \u8bbe\u5907\u7684\u4ee3\u7801)\u3002</li> </ul> <p>\u56e0\u6b64\uff0c\u8fd9\u4e2a\u5b9e\u9a8c\u5f88\u91cd\u8981\u7684\u8981\u6c42\u5c31\u662f\u5728\u8fdb\u5165\u4e34\u754c\u533a\u540e\u5141\u8bb8\u4e2d\u65ad\u548c\u7ebf\u7a0b\u5207\u6362\uff0c\u4ece\u800c\u907f\u514d\u5904\u7406\u5668\u5728\u6ca1\u6709\u83b7\u5f97\u9501\u7684\u524d\u63d0\u4e0b\u6d88\u9664 \u201c\u7a7a\u8f6c\u201d\u3002\u8fdb\u4e00\u6b65\u60f3\uff0c\u5047\u5982\u67d0\u4e2a\u7ebf\u7a0b\u6267\u884c <code>lock(&amp;lk)</code> \u5df2\u7ecf\u83b7\u5f97\u4e86\u9501\u6b63\u5728\u6267\u884c\uff0c\u6b64\u65f6\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u6267\u884c\u4e86 <code>lock(&amp;lk)</code> \u4f46\u9700\u8981\u7b49\u5f85\u2014\u2014\u8fd9\u4e2a\u7b49\u5f85\u9884\u671f\u7684\u65f6\u95f4\u4f1a\u6bd4\u8f83\u957f\uff0c\u56e0\u6b64\u4e0e\u5176\u4e0d\u505c\u5730\u81ea\u65cb\uff0c\u6211\u4eec\u4e0d\u5982\u5728\u81ea\u65cb\u5931\u8d25\u7684\u65f6\u5019\uff0c\u4e3b\u52a8\u5207\u6362\u5230\u5176\u4ed6\u7ebf\u7a0b\u6267\u884c\uff1a</p> <pre><code>void lock(lock_t *lk) {\n  while (atomic_xchg(&amp;lk-&gt;locked, 1)) {\n    yield(); // \u5207\u6362    \n  }\n}\nvoid unlock(lock_t *lk) {\n  atomic_xchg(&amp;lk-&gt;locked, 0);\n}\n</code></pre> <p>\u5927\u5bb6\u53ef\u4ee5\u8003\u8651\u4e00\u4e0b\uff0c\u5982\u679c\u5728\u5173\u95ed\u4e2d\u65ad\u7684\u65f6\u5019 <code>yield()</code> \u4f1a\u53d1\u751f\u4ec0\u4e48\u3002\u8003\u8651\u6e05\u695a\u8fd9\u4e2a\u95ee\u9898\uff0c\u8bf7\u628a\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684\u6267\u884c\u60f3\u8c61\u6210\u72b6\u6001\u673a\uff1b\u8ba1\u7b97\u673a\u7684\u72b6\u6001\u5b8c\u5168\u662f\u7531\u5bc4\u5b58\u5668\u548c\u5185\u5b58\u7684\u6570\u503c\u51b3\u5b9a\u7684\uff0c\u800c\u63a7\u5236\u4e2d\u65ad\u5f00\u5173\u7684\u662f <code>EFLAGS</code> \u5bc4\u5b58\u5668\u4e2d\u7684 <code>IF</code>\u3002</p> <p>\u867d\u7136 <code>yield()</code> \u80fd\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u89e3\u51b3\u95ee\u9898\uff0c\u4f46\u4f9d\u7136\u4e0d\u591f\u5b8c\u7f8e\u2014\u2014\u5982\u679c\u7b49\u5f85\u9501\u7684\u7ebf\u7a0b\u5f88\u591a\uff0c\u8f6e\u7740\u8c03\u5ea6\u4e00\u904d\u4e5f\u8981\u82b1\u8d39\u5f88\u591a\u7684\u5f00\u9500\uff0c\u6211\u4eec\u4e0d\u5982\u505a\u5f97\u5f7b\u5e95\u4e00\u70b9\uff0c\u7ed9\u6bcf\u4e2a\u7ebf\u7a0b\u8bbe\u7f6e\u72b6\u6001\uff1a<code>BLOCKED</code> (\u5728\u7b49\u5f85\u67d0\u4e2a\u9501\uff0c\u6b64\u65f6\u4e0d\u80fd\u88ab\u8c03\u5ea6\u6267\u884c)\uff1b<code>RUNNABLE</code> (\u53ef\u88ab\u8c03\u5ea6\u6267\u884c)\u3002\u7531\u4e8e\u51b3\u5b9a\u4e0b\u4e00\u4e2a\u8fd0\u884c\u7684\u7ebf\u7a0b\u5b8c\u5168\u662f\u5728\u4e2d\u65ad\u5904\u7406\u51fd\u6570\u4e2d\u5b8c\u6210\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u4e0d\u59a8\u4e3a\u6bcf\u4e00\u4e2a\u7ebf\u7a0b\u589e\u52a0\u4e00\u4e2a <code>status</code> \u53d8\u91cf (\u5728 <code>Task</code> \u4e2d)\uff0c\u7136\u540e\u4fee\u6539\u6211\u4eec\u7684\u8c03\u5ea6\u7a0b\u5e8f\uff0c\u5c31\u53ef\u4ee5\u8ba9 <code>BLOCKED</code> \u7684\u7ebf\u7a0b\u4e0d\u518d\u5360\u7528\u5904\u7406\u5668\u6267\u884c\uff1a</p> <pre><code>typedef union task {\n  struct {\n    int status;\n    const char *name;\n    union task *next;\n    Context   *context;\n  };\n  uint8_t stack[4096];\n} Task;\n\n...\n\nContext *on_interrupt(Event ev, Context *ctx) {\n  if (!current) current = &amp;tasks[0];\n  else          current-&gt;context = ctx;\n  do {\n    current = current-&gt;next;\n  } while (\n    (current - tasks) % cpu_count() != cpu_current() ||\n    current-&gt;status != RUNNING // \u53ea\u8c03\u5ea6 RUNNING \u72b6\u6001\u7684\u7ebf\u7a0b\n  );\n  return current-&gt;context;\n}\n</code></pre> <p>\u6ca1\u9519\uff0c\u53ea\u8981\u901a\u8fc7\u5bf9 \u201c\u8fdb\u7a0b\u72b6\u6001\u201d \u7684\u4e00\u4e2a\u5c0f\u5c0f\u7684 hacking\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5b9e\u73b0\u53ef\u4ee5\u7761\u7720\u7684\u4e92\u65a5\u9501\uff1a</p> <ul> <li>\u4e92\u65a5\u9501\u7531\u4e00\u628a\u81ea\u65cb\u9501\u4fdd\u62a4\uff0c\u8fd9\u5927\u5e45\u7b80\u5316\u4e86\u6211\u4eec\u7406\u89e3\u7684\u96be\u5ea6\u2014\u2014\u540c\u4e00\u628a\u81ea\u65cb\u9501\u4fdd\u62a4\u7684\u533a\u57df\u6ee1\u8db3\u539f\u5b50\u6027\u3001\u987a\u5e8f\u548c\u53ef\u89c1\u6027\uff1b</li> <li>\u5982\u679c\u5728\u4e92\u65a5\u9501\u4e0a\u9501\u65f6\uff0c\u9501\u672a\u88ab\u5360\u7528\uff0c\u5219\u66f4\u65b0\u9501\u7684\u72b6\u6001\u5e76\u76f4\u63a5\u8fd4\u56de\uff1b</li> <li>\u5982\u679c\u5728\u4e92\u65a5\u9501\u4e0a\u9501\u65f6\uff0c\u9501\u5df2\u7ecf\u88ab\u522b\u7684\u7ebf\u7a0b\u6301\u6709\uff0c\u5219\u628a\u5f53\u524d\u7ebf\u7a0b\u653e\u5230\u9501\u7684\u961f\u5217\u4e2d\uff0c\u7136\u540e\u628a\u5f53\u524d\u7ebf\u7a0b\u6807\u8bb0\u4e3a\u4e0d <code>RUNNABLE</code>\u3002\u6ce8\u610f\u6b64\u65f6\u4e0d\u80fd\u8fdb\u5165\u4e34\u754c\u533a\u6267\u884c\uff0c\u56e0\u6b64\u4e92\u65a5\u9501\u51fd\u6570\u4e0d\u80fd\u7acb\u5373\u8fd4\u56de\u3002\u6b64\u65f6\u6267\u884c <code>yield()</code> \u201c\u81ea\u9677\u201d (trap) \u8fdb\u5165\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\uff0c\u89e6\u53d1\u8c03\u5ea6\u5668\u6267\u884c\uff1b</li> <li>\u5728\u4e92\u65a5\u9501\u91ca\u653e\u65f6\uff0c\u5982\u679c\u6709\u7ebf\u7a0b\u5728\u961f\u5217\u4e2d\u7b49\u5f85\uff0c\u76f4\u63a5\u5524\u9192\u5b83\u5373\u53ef\u3002\u5982\u679c\u6ca1\u6709\u7ebf\u7a0b\u5728\u7b49\u5f85\uff0c\u628a\u9501\u6062\u590d\u5230\u53ef\u7528\u7684\u72b6\u6001\u3002</li> </ul> <pre><code>void mutex_lock(mutexlock_t *lk) {\n  int acquired = 0;\n  spin_lock(&amp;lk-&gt;spinlock);\n  if (lk-&gt;locked != 0) {\n    enqueue(lk-&gt;wait_list, current);\n    current-&gt;status = BLOCKED;\n  } else {\n    lk-&gt;locked = 1;\n    acquired = 1;\n  }\n  spin_unlock(&amp;lk-&gt;spinlock);\n  if (!acquired) yield(); // \u4e3b\u52a8\u5207\u6362\u5230\u5176\u4ed6\u7ebf\u7a0b\u6267\u884c\n}\n\nvoid mutex_unlock(mutexlock_t *lk) {\n  spin_lock(&amp;lk-&gt;spinlock);\n  if (!empty(lk-&gt;wait_list)) {\n    struct task_t *task = dequeue(lk-&gt;wait_list);\n    task-&gt;status = RUNNABLE; // \u5524\u9192\u4e4b\u524d\u7761\u7720\u7684\u7ebf\u7a0b\n  } else {\n    lk-&gt;locked = 0;\n  }\n  spin_unlock(&amp;lk-&gt;spinlock);\n}\n</code></pre> <p>\u7406\u89e3\u8fd9\u4e9b\u7b97\u6cd5\u65f6\uff0c\u6211\u4eec\u4e0d\u59a8\u518d\u6b21\u4f7f\u7528\u6211\u4eec\u53cd\u590d\u63d0\u5230\u7684\u5de5\u5177\uff1a</p> <p>\u628a\u7ebf\u7a0b\u60f3\u8c61\u6210\u4eba\u3001\u628a\u5171\u4eab\u5185\u5b58\u60f3\u8c61\u6210\u7269\u7406\u4e16\u754c\u3002</p> <p>\u5728\u4e0a\u8ff0\u4e92\u65a5\u9501\u7684\u5b9e\u73b0\u4e2d\u4e2a\uff0c\u5982\u679c lock \u8c03\u7528\u5931\u8d25\uff0c\u6211\u4eec\u5e72\u8106\u4e0d\u8981\u81ea\u65cb\u4e86\uff0c\u800c\u662f\u628a\u81ea\u5df1\u52a0\u5230\u4e00\u4e2a\u7b49\u5f85\u7684\u961f\u5217\u91cc\uff0c\u7b49\u5230\u6709\u4eba\u91ca\u653e\u9501\u7684\u65f6\u5019\u518d\u5524\u9192\uff0c\u8fd9\u5c31\u597d\u50cf\u662f\u6211\u4eec\u7684lock/unlock \u4e0d\u518d\u76f4\u63a5\u7c97\u66b4\u5730\u53bb \u201c\u786c\u62a2\u201d (spin) \u8fd9\u628a\u9501\u7684\u4f7f\u7528\u6743\uff0c\u800c\u662f\u7c7b\u4f3c\u4e8e\u6e38\u6cf3\u9986\u90a3\u6837\u7684\u7ba1\u7406\u65b9\u6cd5\uff0c\u73b0\u5728\u5148\u5047\u8bbe\u6e38\u6cf3\u6c60\u540c\u4e00\u65f6\u95f4\u53ea\u80fd\u5bb9\u7eb3\u4e00\u4e2a\u4eba\u3002\u6bcf\u5f53\u540c\u5b66 (\u7ebf\u7a0b) \u8bd5\u56fe\u83b7\u5f97\u9501 (\u8bd5\u56fe\u8fdb\u5165\u6e38\u6cf3\u6c60) \u65f6\uff0c\u90fd\u95ee\u7ba1\u7406\u5458 (\u64cd\u4f5c\u7cfb\u7edf) \u8981\u624b\u73af\u3002\u6b64\u65f6\u548c\u7ba1\u7406\u5458\u4ea4\u8c08\u7684\u8fc7\u7a0b\u7531\u4e00\u628a\u81ea\u65cb\u9501\u4fdd\u62a4\uff0c\u9632\u6b62\u5176\u4ed6\u540c\u5b66\u5f3a\u52bf\u63d2\u5165\u6253\u65ad\u3002\u5982\u679c\u7ba1\u7406\u5458 (\u64cd\u4f5c\u7cfb\u7edf) \u6b64\u65f6\u6709\u4e00\u4e2a\u624b\u73af\uff0c\u5c31\u76f4\u63a5\u628a\u624b\u73af\u7ed9\u540c\u5b66 (\u8bbe\u7f6e <code>locked = 1</code>)\uff0c\u5e76\u4e14\u5141\u8bb8\u4ed6\u8fdb\u5165\u6e38\u6cf3\u6c60 (<code>mutex_lock</code> \u8fd4\u56de)\u3002\u5426\u5219\uff0c\u7ebf\u7a0b\u5c31\u9700\u8981\u5728\u7ba1\u7406\u5458\u5904\u6392\u961f (\u7136\u540e\u7ebf\u7a0b\u7761\u7720\uff0c\u4f60\u53ef\u4ee5\u7406\u89e3\u6210\u5728\u961f\u4f0d\u91cc\u4e13\u5fc3\u81f4\u5fd7\u5730\u73a9\u624b\u673a)\uff0c\u76f4\u5230\u4e0a\u4e00\u4e2a\u540c\u5b66\u51fa\u6e38\u6cf3\u9986 (<code>mutex_unlock</code>) \u7684\u65f6\u5019\u628a\u624b\u73af\u4ea4\u6362\u7ed9\u7ba1\u7406\u5458\uff0c\u6233\u4e00\u6233\u5728\u961f\u9996\u7684\u7ebf\u7a0b (\u5524\u9192\u5b83)\uff0c\u961f\u9996\u7684\u540c\u5b66 (\u7ebf\u7a0b) \u83b7\u5f97\u9501\u3002\u6b64\u65f6\u5982\u679c\u6ca1\u6709\u6392\u961f\u7684\u540c\u5b66\uff0c\u7ba1\u7406\u5458\u4f1a\u628a\u624b\u73af\u653e\u5230\u67dc\u5b50\u91cc\u3002</p> <p></p> <p>\u83b7\u5f97\u624b\u73af\uff0c\u5728\u6e38\u6cf3\u9986\u66f4\u8863\u5ba4\u7684\u540c\u5b66\u3002\u4e92\u65a5\u9501\u4fdd\u8bc1\u4e86\u5176\u4ed6\u540c\u5b66\u4e0d\u80fd\u8fdb\u5165\u66f4\u8863\u5ba4 (\u8bef</p> <p>\u4fe1\u53f7\u91cf\u548c\u53ef\u4ee5\u7761\u7720\u7684\u4e92\u65a5\u9501\u5b9e\u73b0\u53ef\u4ee5\u8bf4\u662f\u5b8c\u5168\u76f8\u540c\u2014\u2014\u53ea\u4e0d\u8fc7\u662f\u6211\u4eec\u7684 <code>locked</code> \u4e0d\u518d\u662f\u4e00\u4e2a 0 \u6216 1 \u7684\u6570\u503c\uff0c\u800c\u662f\u5141\u8bb8\u662f\u66f4\u591a\u7684\u6570\u503c\uff0c\u5b83\u4ee3\u8868\u4e86\u624b\u73af\u7684\u6570\u91cf\u3002</p>"},{"location":"courses/os_lab/L3_uproc.html","title":"L3: \u7528\u6237\u6001\u8fdb\u7a0b (uproc)","text":"<p>\u672c\u5b9e\u9a8c\u5728 L2 \u4ee3\u7801\u7684\u57fa\u7840\u4e0a\u5b8c\u6210\u3002\u4f46\u5982\u679c\u4f60\u51e0\u4e4e\u6ca1\u6709\u5b8c\u6210 L2 (\u4f8b\u5982\u6ca1\u6709\u6b63\u786e\u5b9e\u73b0\u540c\u6b65\u64cd\u4f5c\uff0c\u6216\u662f\u53ea\u652f\u6301\u5355\u5904\u7406\u5668)\uff0c\u4f9d\u7136\u53ef\u4ee5\u5f00\u59cb L3 \u5e76\u901a\u8fc7\u90e8\u5206\u6d4b\u8bd5\u7528\u4f8b\u3002</p>"},{"location":"courses/os_lab/L3_uproc.html#1","title":"1. \u80cc\u666f","text":"<p>\u5728\u4e0a\u4e00\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u6211\u4eec\u5df2\u7ecf\u5b9e\u73b0\u4e86\u73b0\u4ee3\u591a\u5904\u7406\u5668\u786c\u4ef6\u4e0a\u7684\u4e00\u4e2a \u201c\u5d4c\u5165\u5f0f\u201d \u64cd\u4f5c\u7cfb\u7edf\u2014\u2014\u5b83\u80fd\u591f\u4ee5\u62a2\u5360\u7684\u65b9\u5f0f\u8c03\u5ea6\u591a\u4e2a\u76f4\u63a5\u8fd0\u884c\u5728\u5185\u6838\u6001\u7684\u7ebf\u7a0b\uff0c\u4ece\u800c\u5b9e\u73b0\u5904\u7406\u5668\u7684\u65f6\u5206\u590d\u7528\u3002\u5982\u679c\u4f60\u7684\u8ba1\u7b97\u673a\u786c\u4ef6\u6ca1\u6709 MMU\uff0c\u4f60\u7684 Lab2 \u5df2\u7ecf\u662f\u76f8\u5f53\u8c6a\u534e\u7684\u4e86\uff0c\u5b83\u6709\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\uff0c\u80fd\u5b9e\u73b0\u5206\u65f6\uff0c\u5b8c\u5168\u53ef\u4ee5\u5728\u4e00\u4e9b\u5d4c\u5165\u5f0f GUI \u6846\u67b6\u4e0b\u652f\u6491\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\uff1a</p> <p></p> <p>\u662f\u7684\uff0c\u4f60\u770b\u5230\u7684\u8bb8\u591a\u5d4c\u5165\u5f0f\u8bbe\u5907\uff0c\u4f8b\u5982\u667a\u80fd\u624b\u73af\u7684 \u201c\u64cd\u4f5c\u7cfb\u7edf\u201d\uff0c\u90fd\u662f\u8fd0\u884c\u5728\u8fd9\u7c7b\u6ca1\u6709 MMU\u3001 \u8d85\u4f4e\u529f\u8017\u5904\u7406\u5668\u4e0a\u7684\u3002\u751a\u81f3 Linux Kernel \u4e5f\u53ef\u4ee5\u5728\u6ca1\u6709 MMU \u7684\u673a\u5668\u4e0a\u6709\u9650\u5ea6\u7684\u8fd0\u884c\u3002</p> <p>\u5f53\u7136\uff0c\u5982\u679c\u4f60\u60f3\u901a\u8fc7\u66f4\u590d\u6742\u7684\u64cd\u4f5c\u7cfb\u7edf (\u4f8b\u5982 Linux) \u652f\u6301\u66f4\u590d\u6742\u7684\u8f6f\u4ef6\uff0c\u786c\u4ef6 MMU \u5219\u662f\u5f88\u91cd\u8981\u7684\u9009\u9879\uff1a\u5b83\u63d0\u4f9b\u4e86\u8fdb\u7a0b\u9694\u79bb\u548c\u5b58\u50a8\u4fdd\u62a4\u673a\u5236\u3002\u56e0\u6b64\uff0c\u662f\u65f6\u5019\u5728\u5b9e\u9a8c\u4e2d\u7ed9\u7ebf\u7a0b\u6234\u4e0a MMU \u63d0\u4f9b\u7684 VR \u773c\u955c\uff0c\u4f7f\u5f97\u7ebf\u7a0b\uff1a</p> <ul> <li>\u8fd0\u884c\u5728\u8f83\u4f4e\u7684\u6743\u9650\u7ea7\u522b\uff0c\u4ece\u800c\u5728\u6267\u884c\u4efb\u4f55\u654f\u611f\u64cd\u4f5c\u65f6\u90fd\u4f1a\u5c06\u63a7\u5236\u6743\u901a\u8fc7\u5f02\u5e38\u673a\u5236\u4ea4\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u3002</li> <li>\u65e0\u6cd5\u76f4\u63a5\u770b\u5230\u7269\u7406\u5730\u5740\uff0c\u8bbf\u95ee\u4efb\u4f55\u5730\u5740\uff0c\u5305\u62ec\u53d6 PC \u5904\u7684\u6307\u4ee4\u3001load/store \u5185\u5b58\u7b49\uff0c\u5168\u90e8\u8981\u7ecf\u8fc7 VR \u773c\u955c\u7684\u8f6c\u8bd1\u3002VR \u773c\u955c\u88ab\u64cd\u4f5c\u7cfb\u7edf\u914d\u7f6e\u4e3a\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff0c\u4e14\u53ea\u6709\u64cd\u4f5c\u7cfb\u7edf\u624d\u6709\u6743\u4fee\u6539\u3002</li> </ul> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u8fdb\u7a0b\u3002\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u91cc\uff0c\u4f60\u4f1a\u5c06\u4f60\u7684 \u201c\u5d4c\u5165\u5f0f\u64cd\u4f5c\u7cfb\u7edf\u201d \u53d8\u6210\u4e00\u4e2a\u548c UNIX \u51e0\u4e4e \u201c\u65e0\u9650\u63a5\u8fd1\u201d \u7684\u771f\u6b63\u64cd\u4f5c\u7cfb\u7edf\uff0c\u8fdb\u7a0b\u53ef\u4ee5\u5728\u7528\u6237\u6001\u8fd0\u884c\uff0c\u5e76\u4e14\u56e0\u4e3a\u4e2d\u65ad/\u5f02\u5e38/\u7cfb\u7edf\u8c03\u7528\u540e\uff0c\u64cd\u4f5c\u7cfb\u7edf\u80fd\u591f\u6b63\u786e\u5730\u5904\u7406\u5b83\u4eec\u3002</p>"},{"location":"courses/os_lab/L3_uproc.html#2","title":"2. \u5b9e\u9a8c\u63cf\u8ff0","text":""},{"location":"courses/os_lab/L3_uproc.html#21","title":"2.1 \u5b9e\u9a8c\u603b\u89c8","text":"<p>\u8fd9\u4e2a\u5b9e\u9a8c\u5728 pmm \u548c kmt \u7684\u57fa\u7840\u4e0a\uff0c\u589e\u52a0\u7528\u6237\u6001\u7684\u8fdb\u7a0b (\u53ef\u4ee5\u7406\u89e3\u4e3a\u62e5\u6709\u5730\u5740\u7a7a\u95f4\u7684\u8fdb\u7a0b)\u3002\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u4f60\u7684\u64cd\u4f5c\u7cfb\u7edf\u5c06\u4f1a\u52a0\u8f7d\u7b2c\u4e00\u4e2a\u7528\u6237\u6001\u8fdb\u7a0b (\u8fdb\u7a0b\u7684\u4ee3\u7801 \u201c\u786c\u7f16\u7801\u201d \u5728\u64cd\u4f5c\u7cfb\u7edf\u542f\u52a8\u65f6\u7684\u5185\u5b58\u4e2d)\uff0c\u5e76\u4e14\u5141\u8bb8\u7528\u6237\u6001\u8fdb\u7a0b\u6267\u884c\u7cfb\u7edf\u8c03\u7528\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u9664 uproc \u6a21\u5757\u7684\u521d\u59cb\u5316 (init) \u4e4b\u5916\uff0c\u4f60\u9700\u8981\u5b9e\u73b0\u4ee5\u4e0b\u7cfb\u7edf\u8c03\u7528\uff1a</p> <pre><code>MODULE(uproc) {\n  void (*init)();\n  int (*kputc)(task_t *task, char ch);\n  int (*fork)(task_t *task);\n  int (*wait)(task_t *task, int *status);\n  int (*exit)(task_t *task, int status);\n  int (*kill)(task_t *task, int pid);\n  void *(*mmap)(task_t *task, void *addr, int length, int prot, int flags);\n  int (*getpid)(task_t *task);\n  int (*sleep)(task_t *task, int seconds);\n  int64_t (*uptime)(task_t *task);\n};\n</code></pre> <p>\u7cfb\u7edf\u8c03\u7528\u7684\u884c\u4e3a\u57fa\u672c\u9075\u5faa\u7b80\u5316\u7684 Linux \u7cfb\u7edf\u8c03\u7528\u884c\u4e3a\uff0c\u6211\u4eec\u4f1a\u5728\u4e4b\u540e\u8fdb\u884c\u8865\u5145\u8bf4\u660e\u3002</p>"},{"location":"courses/os_lab/L3_uproc.html#22-uproc","title":"2.2 \u7528\u6237\u8fdb\u7a0b (uproc) \u6a21\u5757","text":""},{"location":"courses/os_lab/L3_uproc.html#221-init-","title":"2.2.1 init - \u6a21\u5757\u521d\u59cb\u5316","text":"<p>\u5b8c\u6210\u5fc5\u8981\u7684\u521d\u59cb\u5316\u3002\u4f60\u9700\u8981\u624b\u52a8\u5728\u4f60\u7684 <code>os-&gt;init</code> \u4e2d\u8c03\u7528\u5b83\u3002</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u672c\u5b9e\u9a8c\u9700\u8981 AbstractMachine \u7684 VME (VM Extension)\uff0cVME \u521d\u59cb\u5316 (<code>vme_init</code>) \u65f6\u9700\u8981\u9875\u9762\u5206\u914d\u548c\u56de\u6536\u7684\u51fd\u6570\uff0c\u5e76\u4e14\u4f1a\u7acb\u5373\u5c31\u5730\u8c03\u7528\u3002\u8bf7\u4f60\u786e\u5728\u9002\u5f53\u7684\u5730\u65b9\u5b8c\u6210 VME \u7684\u521d\u59cb\u5316\uff0c\u4f8b\u5982</p> <pre><code>vme_init(pmm-&gt;alloc, pmm-&gt;free);\n</code></pre> <p>\u8fd9\u4e2a\u521d\u59cb\u5316\u53ef\u4ee5\u5728 <code>uproc-&gt;init</code> \u4e2d\u5b8c\u6210\u3002</p>"},{"location":"courses/os_lab/L3_uproc.html#222-kputc-","title":"2.2.2 kputc - \u6253\u5370\u8c03\u8bd5\u5b57\u7b26","text":"<p>\u8fd9\u662f\u6700\u7b80\u5355\u7684\u7cfb\u7edf\u8c03\u7528\uff0c\u53ef\u4ee5\u5728\u5185\u6838\u6253\u5370\u51fa\u4e00\u4e2a\u7528\u6237\u6001\u6570\u636e\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u4f60\u53ef\u4ee5\u5b9e\u73b0 printf \u66f4\u597d\u5730\u89c2\u5bdf\u7528\u6237\u7a0b\u5e8f\u548c\u5185\u6838\u4e4b\u95f4\u7684\u4ea4\u4e92\u3002\u5728\u5b9e\u73b0\u6587\u4ef6\u7cfb\u7edf (printf \u5b9e\u9645\u8c03\u7528\u7684\u662f\u50cf stdout \u6587\u4ef6\u63cf\u8ff0\u7b26\u7684 write \u7cfb\u7edf\u8c03\u7528) \u4e4b\u540e\uff0ckputc \u5c31\u663e\u5f97\u591a\u4f59\u4e86\uff0c\u4f46\u4e00\u4e2a \u201c\u6700\u7b80\u5355\u201d \u7684\u7cfb\u7edf\u8c03\u7528\u5728\u7cfb\u7edf\u521a\u5f00\u59cb\u5b9e\u73b0\u65f6\u662f\u975e\u5e38\u6709\u7528\u7684\u2014\u2014\u5b83\u53ef\u4ee5\u5e2e\u52a9\u4f60\u5feb\u901f\u89c2\u5bdf\u7cfb\u7edf/\u7528\u6237\u8fdb\u7a0b\u662f\u5426\u5728\u6b63\u5e38\u8fd0\u884c\u3002\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u76f4\u63a5\u7ed9\u51fa\u5b83\u7684\u53c2\u8003\u5b9e\u73b0\uff1a</p> <pre><code>int kputc(task_t *task, char ch) {\n  putch(ch); // safe for qemu even if not lock-protected\n  return 0;\n}\n</code></pre>"},{"location":"courses/os_lab/L3_uproc.html#223-getpid-","title":"2.2.3 getpid - \u83b7\u5f97\u8fdb\u7a0b\u53f7","text":"<pre><code>int getpid(task_t *task);\n</code></pre> <p>\u8fd4\u56de\u5f53\u524d\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7\u3002\u8fdb\u7a0b\u53f7\u4ece 1 \u5f00\u59cb\u7f16\u53f7\uff0c\u4e0d\u8d85\u8fc7 32767\u3002\u4f60\u9700\u8981\u4fdd\u8bc1\u82e5\u5e72\u8fdb\u7a0b\u53f7\u76f8\u5173\u7684\u57fa\u672c\u6027\u8d28\uff1a</p> <ul> <li>\u4efb\u4f55\u8fdb\u7a0b\u4ece\u521b\u5efa\u5f00\u59cb\uff0c\u8fdb\u7a0b\u53f7\u4e0d\u4f1a\u53d8\u5316\uff0c\u5373\u540c\u4e00\u8fdb\u7a0b\u591a\u6b21\u8c03\u7528 getpid \u4f1a\u8fd4\u56de\u540c\u4e00\u4e2a\u6570\u503c\u3002</li> <li>\u7cfb\u7edf\u4e2d\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u4e0d\u540c\u7684\u8fdb\u7a0b\u53f7\u3002</li> <li>\u8fdb\u7a0b\u53f7\u5728\u5206\u914d\u65f6\uff0c\u5c3d\u91cf\u505a\u5230\u5c3d\u53ef\u80fd\u4e0d\u7acb\u5373\u590d\u7528\u4e4b\u524d\u88ab\u6740\u6b7b\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7\u2014\u2014\u8bd5\u60f3\u4e00\u4e0b\uff0c\u4f60\u5728 Shell \u4e2d\u4f7f\u7528 ps \u547d\u4ee4\u67e5\u770b\u67d0\u4e2a\u8fdb\u7a0b\u7f16\u53f7\u4e3a 1234 \u5e76\u4e14\u5e0c\u671b\u5c06\u5b83\u6740\u6b7b\u2014\u2014\u4f46\u5c31\u5728\u4f60\u6267\u884c kill 1234 \u7684\u95f4\u9699\u4e4b\u95f4\uff0c1234 \u8fdb\u7a0b\u9000\u51fa\uff0c\u5e76\u4e14\u53e6\u4e00\u4e2a (\u4f8b\u5982\u7cfb\u7edf\u670d\u52a1\u521b\u5efa\u7684\u8fdb\u7a0b) \u8fdb\u7a0b\u88ab\u5206\u914d\u4e86 1234 \u7684\u8fdb\u7a0b\u53f7\uff0c\u4f60\u5c31\u4f1a \u201c\u9519\u6740\u201d\u3002</li> </ul>"},{"location":"courses/os_lab/L3_uproc.html#224-sleep-","title":"2.2.4 sleep - \u8fdb\u7a0b\u7761\u7720","text":"<pre><code>int sleep(task_t *task, int seconds);\n</code></pre> <p>\u5c06\u8fdb\u7a0b\u7761\u7720 seconds \u79d2\u540e\u518d\u6b21\u5524\u9192\u2014\u2014\u5b8c\u5168\u4e25\u683c\u65f6\u95f4\u7684\u7761\u7720\u662f\u505a\u4e0d\u5230\u7684\uff0c\u4f60\u53ea\u9700\u8981\u4fdd\u8bc1\u5524\u9192\u524d\u540e\u4e0d\u5c0f\u4e8e seconds \u79d2 (\u5141\u8bb8\u7565\u591a\u4e00\u4e9b)\u3002\u8fdb\u7a0b\u7761\u7720\u65f6\u4e0d\u5e94\u5360\u7528 CPU\u2014\u2014\u5426\u5219 sleep sort \u5c31\u65e0\u6cd5\u5b9e\u73b0\u4e86\u3002</p>"},{"location":"courses/os_lab/L3_uproc.html#225-uptime-","title":"2.2.5 uptime - \u83b7\u5f97\u5f00\u673a\u65f6\u95f4","text":"<pre><code>int64_t uptime(task_t *task);\n</code></pre> <p>\u8fd4\u56de\u5f00\u673a\u65f6\u95f4\u7684\u6beb\u79d2\u6570\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u7528\u6b64\u6570\u503c\u4f5c\u4e3a\u53c2\u8003\uff0c\u540c\u6837\u4e0d\u5fc5\u5b8c\u5168\u7cbe\u786e\u3002</p>"},{"location":"courses/os_lab/L3_uproc.html#226-fork-","title":"2.2.6 fork - \u521b\u5efa\u8fdb\u7a0b\u526f\u672c","text":"<pre><code>int fork(task_t *task);\n</code></pre> <p>\u521b\u5efa\u5f53\u524d\u8fdb\u7a0b (\u72b6\u6001\u673a) \u7684\u4e00\u4e2a\u526f\u672c\uff1a</p> <ul> <li>\u521b\u5efa\u7684\u8fdb\u7a0b\u4ece\u7528\u6237\u6001\u6267\u884c\u770b\u6765\u6ca1\u6709\u4efb\u4f55\u533a\u522b\uff0c\u9664\u4e86 GPRx (rax) \u7684\u8fd4\u56de\u503c\uff1a\u7236\u8fdb\u7a0b\u8fd4\u56de\u5b50\u8fdb\u7a0b\u8fdb\u7a0b\u53f7\uff0c\u5b50\u8fdb\u7a0b\u8fd4\u56de 0\u3002</li> <li>\u4f60\u9700\u8981\u5b9e\u73b0 Copy-on-Write \u624d\u80fd\u901a\u8fc7\u6240\u6709\u6d4b\u8bd5\u7528\u4f8b\u3002</li> <li>\u5177\u4f53\u6765\u8bf4\uff0c\u6211\u4eec\u7684\u6d4b\u8bd5\u7528\u4f8b\u53ef\u80fd\u4f1a fork \u591a\u4efd\u8fdb\u7a0b\u3002\u5982\u679c\u4f60\u5728 fork \u65f6\u76f4\u63a5\u590d\u5236\u5168\u90e8\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u53ef\u80fd\u4f1a\u9762\u4e34\u5185\u5b58\u4e0d\u8db3\u3002</li> <li>\u6b63\u786e\u5730\u505a\u6cd5\u662f\u5c06\u88ab\u590d\u5236\u7684\u5730\u5740\u7a7a\u95f4\u6807\u8bb0\u4e3a\u53ea\u8bfb\uff0c\u5e76\u5728\u53d1\u751f page fault \u65f6\u518d\u590d\u5236\u3002\u4f60\u9700\u8981\u9875\u9762\u7684\u5f15\u7528\u8ba1\u6570\u4ee5\u6b63\u786e\u5904\u7406\u8fde\u7eed\u591a\u4e2a fork \u7684\u60c5\u51b5\u3002</li> </ul>"},{"location":"courses/os_lab/L3_uproc.html#227-wait-","title":"2.2.7 wait - \u7b49\u5f85\u5b50\u8fdb\u7a0b\u7ed3\u675f","text":"<pre><code>int wait(task_t *task, int *status);\n</code></pre> <p>\u7b49\u5f85\u5f53\u524d\u8fdb\u7a0b\u521b\u5efa\u7684\u67d0\u4e2a\u76f4\u63a5\u5b50\u8fdb\u7a0b (\u5b50\u8fdb\u7a0b fork \u4ea7\u751f\u7684\u5b50\u8fdb\u7a0b\u4e0d\u5728\u7b49\u5f85\u5217\u8868) \u7ed3\u675f\u3002\u5982\u679c\u5f53\u524d\u6ca1\u6709\u8fd0\u884c\u7684\u5b50\u8fdb\u7a0b\uff0c\u8fd4\u56de -1\uff0c\u5426\u5219\u8fd4\u56de 0\uff0c\u5e76\u5c06\u5b50\u8fdb\u7a0b exit \u7684\u9000\u51fa\u4ee3\u7801\u4fdd\u5b58\u5230 status \u6307\u5411\u7684\u4f4d\u7f6e\u3002</p> <p>\u5728\u5b9e\u9645\u7684\u7cfb\u7edf\u4e2d\uff0cfork \u548c wait \u5e94\u5f53\u662f\u914d\u5bf9\u7684\u2014\u2014\u5373\u4fbf\u5b50\u8fdb\u7a0b\u7ed3\u675f\u4e86\uff0c\u7236\u8fdb\u7a0b\u4f9d\u7136\u53ef\u4ee5\u786e\u4fdd\u83b7\u5f97\u5b50\u8fdb\u7a0b\u7684\u8fd4\u56de\u503c\u3002\u4f46\u8fd9\u5c31\u5e26\u6765\u4e86\u4e00\u4e2a\u9ebb\u70e6\uff1a\u64cd\u4f5c\u7cfb\u7edf\u65e0\u6cd5\u533a\u5206\u662f\u7236\u8fdb\u7a0b\u56e0\u4e3a bug \u5bfc\u81f4\u6c38\u8fdc\u4e0d\u518d\u4f1a wait\uff0c\u8fd8\u662f\u7236\u8fdb\u7a0b\u6682\u65f6\u8fd8\u5728\u6267\u884c\u5176\u4ed6\u903b\u8f91\uff0c\u6ca1\u6709\u8c03\u7528 wait\u3002\u8fd9\u5c31\u6709\u4e86\u6709\u8da3\u7684 \u201c\u50f5\u5c38 (Zombie)\u201d \u8fdb\u7a0b\u3002\u4f46\u6211\u4eec\u7684\u5b9e\u9a8c\u4f5c\u51fa\u4e86\u7b80\u5316\uff1a\u5982\u679c\u5f53\u524d\u6ca1\u6709\u8fd0\u884c\u7684\u5b50\u8fdb\u7a0b\uff0c\u7236\u8fdb\u7a0b\u7684 wait \u5c06\u8fd4\u56de -1\uff0c\u4e5f\u4e0d\u518d\u80fd\u591f\u83b7\u5f97\u9000\u51fa\u8fdb\u7a0b\u7684\u8fd4\u56de\u503c\u3002</p>"},{"location":"courses/os_lab/L3_uproc.html#228-exit-","title":"2.2.8 exit - \u7ed3\u675f\u5f53\u524d\u8fdb\u7a0b","text":"<pre><code>int (*exit)(task_t *task, int status);\n</code></pre> <p>\u7ed3\u675f\u5f53\u524d\u72b6\u6001\u673a\u7684\u6267\u884c\uff0c\u5e76\u8bb0\u5f55\u8fd4\u56de\u503c\u4e3a status\u3002\u53c2\u8003 wait\u3002</p>"},{"location":"courses/os_lab/L3_uproc.html#229-kill-","title":"2.2.9 kill - \u7ed3\u675f\u8fdb\u7a0b","text":"<pre><code>int kill(task_t *task, int pid);\n</code></pre> <p>\u7ed3\u675f\u4e00\u4e2a\u8fdb\u7a0b\u53f7\u4e3a pid \u7684\u8fdb\u7a0b\u3002\u4f60\u53ef\u4ee5\u4e3a\u5b83\u6307\u5b9a\u4efb\u4f55\u8fd4\u56de\u503c\u3002</p>"},{"location":"courses/os_lab/L3_uproc.html#2210-mmap-","title":"2.2.10 mmap - \u4fee\u6539\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4","text":"<pre><code>void *mmap(task_t *task, void *addr, int length, int prot, int flags);\n</code></pre> <p>\u4fee\u6539\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u4e3a\u5176\u5206\u914d\u4e00\u4e2a\u5730\u5740\u4e0d\u5c0f\u4e8e addr\u3001\u5bf9\u5176\u5230\u9875\u8fb9\u754c (protect \u8fd4\u56de AddrSpace \u4e2d\u7684 pgsize)\u3001\u5927\u5c0f\u4e0d\u5c0f\u4e8e length \u7684\u4e00\u6bb5\u5185\u5b58\u3002flags (\u5df2\u5b9a\u4e49\u5728\u6846\u67b6\u4ee3\u7801\u4e2d)\uff1a</p> <ul> <li><code>MAP_SHARED</code> - \u5728 fork \u65f6\uff0c\u8be5\u5185\u5b58\u5728\u7236\u5b50\u8fdb\u7a0b\u4e4b\u95f4\u5171\u4eab\u3002</li> <li><code>MAP_PRIVATE</code> - \u5728 fork \u65f6\uff0c\u8be5\u5185\u5b58\u4f1a\u88ab\u590d\u5236\u4e00\u4efd (\u5c3d\u53ef\u80fd\u5730\u5b9e\u73b0\u6210 copy-on-write)\u3002</li> <li><code>MAP_UNMAP</code> - \u5220\u9664\u4ece addr \u5f00\u59cb\u3001\u957f\u5ea6\u4e3a length \u7684\u6620\u5c04 (\u800c\u4e0d\u662f\u5206\u914d)\u3002\u6ce8\u610f\u53ef\u80fd unmap \u4e00\u6bb5\u8fde\u7eed\u5185\u5b58\u4e2d\u7684\u4e00\u5c0f\u90e8\u5206\u3002\u4f60\u9700\u8981\u68c0\u67e5\u8fdb\u7a0b\u5e76\u6ca1\u6709\u62e5\u6709 addr \u5f00\u59cb\u957f\u5ea6\u4e3a length \u7684\u5185\u5b58\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u5219 mmap \u5931\u8d25\u3002</li> </ul> <p>prot \u6620\u5c04\u6743\u9650\uff1a</p> <ul> <li><code>PROT_READ</code> - \u53ef\u8bfb\u3002</li> <li><code>PROT_WRITE</code> - \u53ef\u5199\u3002</li> </ul> <p>\u6ce8\u610f\u6211\u4eec\u5141\u8bb8 <code>PROT_READ | PROT_WRITE</code> \u8fd9\u6837\u7684\u6743\u9650\u3002\u6846\u67b6\u4ee3\u7801\u5df2\u7ecf\u63d0\u4f9b\u4e86\u8fd9\u4e9b\u6570\u503c\u7684\u5b9a\u4e49\u2014\u2014\u8bf7\u4e0d\u8981\u81ea\u5df1\u5b9a\u4e49\u5b83\u4eec\uff01\u5728 Linux \u7cfb\u7edf\u4e2d\uff0c\u5b83\u4eec\u662f\u5728 linux/mman.h \u7b49\u7cfb\u7edf\u5e93\u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\uff0c\u8fd9\u4e2a\u6587\u4ef6\u5728\u5185\u6838\u4e2d\u6709\u4e00\u4e2a\u526f\u672c\u3002</p>"},{"location":"courses/os_lab/L3_uproc.html#23","title":"2.3 \u7528\u6237\u8fdb\u7a0b\u4ee3\u7801","text":"<p>\u6846\u67b6\u4ee3\u7801\u4e2d\u65b0\u589e\u4e86\u4e00\u4e2a user \u76ee\u5f55\u3002\u76ee\u524d\uff0c\u5b83\u53ef\u4ee5\u751f\u6210\u552f\u4e00\u7684\u3001\u88ab\u52a0\u8f7d\u5230\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u7528\u6237\u6001\u5e94\u7528\u7a0b\u5e8f\u3002</p> <pre><code>user/\n\u251c\u2500\u2500 init.c\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 trampoline.S\n\u2514\u2500\u2500 ulib.h\n</code></pre> <p>\u6211\u4eec\u4e3a\u5927\u5bb6\u5b9e\u73b0\u4e86\u4e00\u4e2a\u6700\u5c0f\u7684 ulib\uff0c\u5305\u62ec\u672c\u6b21\u5b9e\u9a8c\u4e2d\u6240\u7528\u7684\u7cfb\u7edf\u8c03\u7528\u5c01\u88c5\u2014\u2014\u6ce8\u610f user \u548c kernel \u5171\u4eab\u4e86 <code>syscall.h</code> \u548c <code>user.h</code> \u5934\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u91cd\u8981\u7684\u5b8f\u5b9a\u4e49\uff0c\u4f8b\u5982\u7cfb\u7edf\u8c03\u7528\u7684\u7f16\u53f7\u548c\u7cfb\u7edf\u8c03\u7528\u4e2d\u4f7f\u7528\u7684 flags \u503c\u3002</p> <p>\u7528\u6237\u8fdb\u7a0b\u7684\u7f16\u8bd1\u7531\u4e09\u90e8\u5206\u7ec4\u6210</p> <ul> <li> <p>\u7f16\u8bd1 .c \u548c .S \u6587\u4ef6\u3002\u6ce8\u610f\u5230\u6211\u4eec\u4f7f\u7528\u4e86\u548c kernel \u7c7b\u4f3c\u7684\u7f16\u8bd1\u9009\u9879\uff0c\u4f8b\u5982 <code>-mno-sse</code> \u4e0d\u4f7f\u7528\u6d6e\u70b9\u5bc4\u5b58\u5668\u3001<code>-ffreestanding</code> \u521b\u5efa\u4e00\u4e2a\u96f6\u4f9d\u8d56\u7684\u8fd0\u884c\u73af\u5883\u7b49\u3002\u5176\u4e2d\uff0c\u6700\u91cd\u8981\u7684\u7f16\u8bd1\u9009\u9879\u662f <code>-fPIC</code>\uff0c\u4f7f\u5f97\u6211\u4eec\u7f16\u8bd1\u51fa\u4f4d\u7f6e\u65e0\u5173\u4ee3\u7801\uff0c\u5b83\u80fd\u591f\u88ab\u52a0\u8f7d\u5230\u5730\u5740\u7a7a\u95f4\u7684\u4efb\u4f55\u4f4d\u7f6e\u3002</p> </li> <li> <p>\u5c06\u6240\u6709\u76ee\u6807\u6587\u4ef6\u9759\u6001\u94fe\u63a5\uff0c\u5176\u4e2d\u7528\u5230\u7684\u7f16\u8bd1\u9009\u9879 (RTFM):</p> </li> <li> <p><code>--omagic</code> \u5c06\u4ee3\u7801\u548c\u6570\u636e \u201c\u7ed1\u5728\u4e00\u8d77\u201d \u51cf\u5c11\u6587\u4ef6\u7684\u4f53\u79ef</p> </li> <li><code>--pic-executable</code> \u94fe\u63a5\u6210\u4f4d\u7f6e\u65e0\u5173\u7684\u53ef\u6267\u884c\u6587\u4ef6</li> <li> <p><code>--no-dynamic-linker</code> \u9759\u6001\u94fe\u63a5\u6240\u6709\u7b26\u53f7</p> </li> <li> <p>\u901a\u8fc7 objcopy \u5c06\u4ee3\u7801\u3001\u6570\u636e\u548c bss \u7edf\u4e00\u63d0\u53d6\u51fa\u6765\uff0c\u5f97\u5230\u4e8c\u8fdb\u5236\u6587\u4ef6</p> </li> </ul> <pre><code>_init\n</code></pre> <ul> <li> <p><code>_init</code> \u662f\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u7684\u6307\u4ee4\u5e8f\u5217\uff0c\u4f60\u53ef\u4ee5\u8bd5\u7740\u7528 <code>ndisasm -b 64</code> \u67e5\u770b\u53cd\u6c47\u7f16\uff0c\u5934\u90e8\u7684\u4ee3\u7801\u5373\u662f trampoline.S \u4e2d\u7684\u4ee3\u7801</p> </li> <li> <p>\u901a\u8fc7 xxd \u751f\u6210\u4e00\u4e2a C \u4ee3\u7801\uff0c\u6070\u597d\u662f <code>_init</code> \u7684\u6570\u636e\uff0c\u4f8b\u5982</p> </li> </ul> <pre><code>unsigned char _init[] = {\n  0xe8, 0x0c, 0x00, 0x00, 0x00, 0x48, 0x89, 0xc7, 0x48, 0xc7, 0xc0, 0x03,\n  0x00, 0x00, 0x00, 0xcd, 0x80, 0xf3, 0x0f, 0x1e, 0xfa, 0xb8, 0x00, 0x00,\n  0x00, 0x00, 0xc3\n};\nunsigned int _init_len = 27;\n</code></pre> <p>\u8fd9\u4e2a\u6587\u4ef6\u5c06\u4f1a\u88ab\u91cd\u5b9a\u5411\u5230 <code>kernel/src/initcode.inc</code>\u3002\u6846\u67b6\u4ee3\u7801\u4e2d\u5305\u542b\u4e86\u5bf9\u8fd9\u4e2a\u6587\u4ef6\u7684 \u201c\u7c98\u8d34\u5f15\u7528\u201d (initcode.inc):</p> <pre><code>#include &lt;os.h&gt;\n#include &lt;syscall.h&gt;\n\n#include \"initcode.inc\"\n\nMODULE_DEF(uproc) = {\n};\n</code></pre> <p>\u8fd9\u6837\uff0c\u4f60\u7684\u64cd\u4f5c\u7cfb\u7edf\u4ee3\u7801\u53ef\u4ee5\u901a\u8fc7 <code>_init</code> \u53d8\u91cf\u6765\u83b7\u5f97\u7528\u6237\u6001\u8fdb\u7a0b\u7684\u4ee3\u7801\u3002\u8fd9\u4e2a\u6d41\u7a0b\u548c xv6 \u5341\u5206\u7c7b\u4f3c\uff0c\u5982\u679c\u6709\u4e0d\u6e05\u695a\u7684\u5730\u65b9\uff0c\u53ef\u4ee5\u9605\u8bfb xv6 initcode \u7684\u5904\u7406\u3002</p>"},{"location":"courses/os_lab/L3_uproc.html#_1","title":"\u26a0\ufe0f \u4f53\u7cfb\u7ed3\u6784","text":"<p>\u7531\u4e8e\u6d89\u53ca Application Binary Interface\uff0c\u4ece\u4eca\u5f80\u540e\u7684\u5b9e\u9a8c\u4ec5\u9700\u8981\u652f\u6301 x86-64\u3002\u5f53\u7136\uff0c\u4f60\u4f9d\u7136\u5728\u5b9e\u73b0\u4ee3\u7801\u65f6\u5e94\u8be5\u5c3d\u53ef\u80fd\u4fdd\u6301\u8de8\u4f53\u7cfb\u673a\u6784\u7684\u517c\u5bb9\u6027\u3002</p>"},{"location":"courses/os_lab/L3_uproc.html#_2","title":"\u26a0\ufe0f \u6ce8\u610f","text":"<p>\u6211\u4eec\u4f1a\u5728 Online Judge \u6d4b\u8bd5\u65f6\u4f7f\u7528\u6211\u4eec\u7684\u4ee3\u7801\u3002\u56e0\u6b64\u8bf7\u4e0d\u8981\u4fee\u6539\u8fd9\u90e8\u5206\u6587\u4ef6\u540d (\u4f8b\u5982 initcode.inc)\u3002</p>"},{"location":"courses/os_lab/L3_uproc.html#24-application-binary-interface","title":"2.4 Application Binary Interface","text":"<p>\u6211\u4eec\u4e3a\u5927\u5bb6\u51c6\u5907\u4e86\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684 ABI\uff0c\u5e2e\u52a9\u5927\u5bb6\u5feb\u901f\u4e0a\u624b\u5e94\u7528\u7a0b\u5e8f\uff1a</p> <ul> <li>\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u52a0\u8f7d</li> <li>\u6211\u4eec\u53ea\u9700\u8981\u652f\u6301 init \u8fd9\u4e00\u4e2a\u4e8c\u8fdb\u5236\u7a0b\u5e8f</li> <li>\u5b83\u53ef\u4ee5\u88ab\u52a0\u8f7d\u5230\u4efb\u4f55\u5730\u5740\u7a7a\u95f4\u5408\u6cd5\u7684\u4f4d\u7f6e (\u6211\u4eec\u5df2\u7ecf\u7f16\u8bd1\u6210\u4e86\u4f4d\u7f6e\u65e0\u5173\u4ee3\u7801)</li> <li>rsp \u9700\u8981\u88ab\u521d\u59cb\u5316\u4e3a\u53ef\u7528\u7684\u5806\u6808\uff0c\u81f3\u5c11\u4e00\u4e2a\u9875\u9762\u5927\u5c0f (\u9875\u9762\u7684\u5927\u5c0f\u7531 <code>as-&gt;pgsize</code> \u6307\u5b9a)</li> <li>\u7cfb\u7edf\u8c03\u7528 ABI</li> <li>\u7cfb\u7edf\u8c03\u7528\u7f16\u53f7\u4fdd\u5b58\u5728 GRPx (rax) \u4e2d</li> <li>\u53c2\u6570\u4fdd\u5b58\u5728 GPR1 (rdi), GPR2 (rsi), GPR3 (rdx), GPR4 (rcx) \u4e2d</li> <li>\u901a\u8fc7 int $0x80 \u6307\u4ee4\u5b9e\u73b0\u7cfb\u7edf\u8c03\u7528</li> <li>\u7cfb\u7edf\u8c03\u7528\u8fd4\u56de\u503c\u5728 GPRx (rax) \u4e2d</li> </ul>"},{"location":"courses/os_lab/L3_uproc.html#3","title":"3. \u6b63\u786e\u6027\u6807\u51c6","text":"<p>Online Judge \u5728\u6d4b\u8bd5\u65f6\u5c06\u4f1a\u4f7f\u7528\u4e00\u4e2a\u7a0d\u5fae\u6709\u4e9b\u5927 (\u4f46\u4e0d\u4f1a\u8d85\u8fc7 16KB) \u7684 init \u7a0b\u5e8f\uff0c\u5e76\u4e14\u66ff\u6362\u540c\u5b66\u4eec\u7684 initcode.inc \u7f16\u8bd1\uff0c\u5e76\u68c0\u67e5\u7cfb\u7edf\u8c03\u7528\u7684\u57fa\u672c\u529f\u80fd\u3002\u7531\u4e8e\u4ece\u672c\u5b9e\u9a8c\u5f00\u59cb\u4ee3\u7801\u91cf\u5c31\u8fdb\u5165\u4e00\u4e2a \u201c\u81a8\u80c0\u671f\u201d\uff0c\u56e0\u6b64\u6d4b\u8bd5\u7684\u4e25\u82db\u6027\u4f1a\u6709\u6240\u4e0b\u964d\uff0c\u7cfb\u7edf\u8c03\u7528\u80fd\u57fa\u672c\u6b63\u5e38\u8fd0\u8f6c\u5373\u53ef\u901a\u8fc7\u3002\u4f46\u4ecd\u7136\u8bf7\u540c\u5b66\u4eec\u505a\u597d\u538b\u529b\u6d4b\u8bd5\uff0c\u5177\u4f53\u6b63\u786e\u6027\u8981\u6c42\u9664\u5b9e\u73b0\u4e0a\u8ff0 API \u5bf9\u5e94\u7684\u529f\u80fd\u5916\uff0c\u8fd8\u9700\u8981\u6ee1\u8db3\uff1a</p> <ul> <li>uproc \u6a21\u5757\u4e2d\u7684\u51fd\u6570\u9700\u8981\u81ea\u884c\u5728\u7cfb\u7edf\u8c03\u7528\u5904\u7406\u65f6\u8c03\u7528\u30022.1 \u8282 uproc \u4e2d\u7684\u51fd\u6570\u4e3a\u5927\u5bb6\u63d0\u4f9b\u4e86\u6b63\u786e\u7684\u7cfb\u7edf\u8c03\u7528\u51fd\u6570\u58f0\u660e\u3002</li> <li>\u7cfb\u7edf\u8c03\u7528\u6267\u884c\u65f6\uff0c\u4e0d\u80fd\u5168\u7a0b\u5173\u95ed\u4e2d\u65ad\u3002\u5728\u5b9e\u9645\u7684\u7cfb\u7edf\u4e2d\uff0c\u7cfb\u7edf\u8c03\u7528\u7684\u65f6\u95f4\u53ef\u80fd\u5f88\u957f\uff0c\u800c\u7cfb\u7edf\u8c03\u7528\u7684\u6267\u884c\u5b9e\u9645\u662f \u201c\u5c5e\u4e8e\u201d \u8fdb\u7a0b\u672c\u8eab\u7684\u2014\u2014\u4f8b\u5982 time \u547d\u4ee4\u7684\u8f93\u51fa\u4e2d\uff0cuser (\u7528\u6237\u6001) \u548c sys (\u5185\u6838\u6001) \u7684\u8fd0\u884c\u65f6\u95f4\u90fd\u88ab\u8ba1\u5165\u3002\u7cfb\u7edf\u8c03\u7528\u5728\u4e0d\u6301\u6709\u81ea\u65cb\u9501\u7b49\u4e34\u754c\u8d44\u6e90\u65f6\u5e94\u5f53\u5141\u8bb8\u88ab\u4e2d\u65ad\u3002</li> </ul> <p>(TBD)</p>"},{"location":"courses/os_lab/L3_uproc.html#4","title":"4. \u5b9e\u9a8c\u6307\u5357","text":"<p>(TBD)</p>"},{"location":"courses/os_lab/L4_vfs.html","title":"L4:\u865a\u62df\u6587\u4ef6\u7cfb\u7edf (vfs)","text":""},{"location":"courses/os_lab/L4_vfs.html#1","title":"1. \u80cc\u666f","text":"<p>\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u6211\u4eec\u5728\u591a\u5904\u7406\u5668\u5206\u65f6\u591a\u7ebf\u7a0b\u7684\u57fa\u7840\u4e0a\u5b9e\u73b0\u7ebf\u7a0b\u5b89\u5168\u7684\u865a\u62df\u6587\u4ef6\u7cfb\u7edf (virtual file system, VFS) API\uff0c\u5e76\u4e14\u5728 VFS \u8fd9\u4e00\u62bd\u8c61\u5c42\u4e0a\u5b9e\u73b0\u82e5\u5e72\u4e0d\u540c\u7684\u6587\u4ef6\u7cfb\u7edf\uff1a</p> <ul> <li>\u5728\u5b58\u50a8\u8bbe\u5907 (<code>sda</code>) \u4e0a\u652f\u6301\u5b8c\u6574\u6587\u4ef6\u548c\u76ee\u5f55\u64cd\u4f5c\u7684\u6587\u4ef6\u7cfb\u7edf \u201cultra-simple file system\u201d (ufs);</li> <li>\u865a\u62df\u7684 procfs\uff0c\u63d0\u4f9b\u4e00\u7cfb\u5217\u53ea\u8bfb\u7684\u3001\u53cd\u6620\u64cd\u4f5c\u7cfb\u7edf\u5185\u90e8\u72b6\u6001\u7684\u6587\u4ef6\uff1b</li> <li>\u865a\u62df\u7684 devfs\uff0c\u5c06\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u8bbe\u5907\u62bd\u8c61\u4e3a\u53ef\u4ee5\u8bbf\u95ee\u7684\u6587\u4ef6\uff0c\u5e76\u4e3a\u8fd9\u4e9b\u6587\u4ef6\u63d0\u4f9b\u8bfb\u5199\u64cd\u4f5c\u3002</li> </ul> <p>\u5b9e\u73b0\u5b8c\u6210\u540e\uff0c\u7cfb\u7edf\u4e2d\u7684\u591a\u4e2a\u7ebf\u7a0b\u5c31\u80fd\u901a\u8fc7\u6587\u4ef6\u7cfb\u7edf API \u8bfb\u5199\u6587\u4ef6\u2014\u2014\u81f3\u6b64\u6211\u4eec\u79bb\u73b0\u4ee3\u64cd\u4f5c\u7cfb\u7edf\u5c31\u53ea\u6709\u4e00\u6b65\u4e4b\u9065\uff1a\u53ea\u9700\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u9644\u5c5e\u4e00\u4e2a\u72ec\u7acb\u7684\u5730\u5740\u7a7a\u95f4 (\u901a\u8fc7\u865a\u62df\u5b58\u50a8\u5b9e\u73b0\uff0c\u53c2\u8003 xv6 \u4ee3\u7801)\uff0c\u7ebf\u7a0b\u5c31\u53d8\u6210\u4e86\u6211\u4eec\u719f\u77e5\u7684\u8fdb\u7a0b\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5c31\u5b8c\u6574\u4e86\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#2","title":"2. \u5b9e\u9a8c\u63cf\u8ff0","text":""},{"location":"courses/os_lab/L4_vfs.html#21","title":"2.1 \u5b9e\u9a8c\u603b\u89c8","text":"<p>\u8fd9\u4e2a\u5b9e\u9a8c\u5728 pmm \u548c kmt (\u5305\u62ec dev) \u7684\u57fa\u7840\u4e0a\uff0c\u5728\u78c1\u76d8\u8bbe\u5907 (\u9a71\u52a8\u7a0b\u5e8f) \u7684\u57fa\u7840\u4e0a\u5b9e\u73b0\u6301\u4e45\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u5e76\u4e14\u5728\u7ebf\u7a0b\u7ea7\u522b\u652f\u6301\u6587\u4ef6\u63cf\u8ff0\u7b26\u548c\u6587\u4ef6/\u76ee\u5f55\u64cd\u4f5c API\u2014\u2014vfs \u7684 API \u548c\u5927\u5bb6\u5728 MiniLabs \u4e2d\u4f7f\u7528\u7684\u7cfb\u7edf\u8c03\u7528\u51e0\u4e4e\u5b8c\u5168\u4e00\u6837\u2014\u2014\u5728 Linux \u4e2d\uff0c\u6211\u4eec\u7684\u8fdb\u7a0b\u901a\u8fc7 syscall \u6307\u4ee4\u8fdb\u5165\u8fdb\u5165\u64cd\u4f5c\u7cfb\u7edf\u540e\u5c31\u4f1a\u76f4\u63a5\u8c03\u7528\u8fd9\u4e9b\u51fd\u6570\u3002</p> <p>\u6211\u4eec\u7684\u6587\u4ef6\u7cfb\u7edf API \u505a\u4e86\u76f8\u5f53\u7684\u7b80\u5316\uff0c\u4f8b\u5982\u5e76\u4e0d\u652f\u6301\u52a8\u6001\u7684 mount (\u6587\u4ef6\u7cfb\u7edf\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u88ab mount)\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u4f60\u9700\u8981\u5b9e\u73b0\u4ee5\u4e0b API:</p> <pre><code>struct ufs_stat;\nMODULE(vfs) {\n  void (*init)();\n  int (*write)(int fd, void *buf, int count);\n  int (*read)(int fd, void *buf, int count);\n  int (*close)(int fd);\n  int (*open)(const char *pathname, int flags);\n  int (*lseek)(int fd, int offset, int whence);\n  int (*link)(const char *oldpath, const char *newpath);\n  int (*unlink)(const char *pathname);\n  int (*fstat)(int fd, struct ufs_stat *buf);\n  int (*mkdir)(const char *pathname);\n  int (*chdir)(const char *path);\n  int (*dup)(int fd);\n};\n</code></pre> <p>\u6ce8\u610f\u5230\u6211\u4eec\u7684\u6846\u67b6\u4e2d\u8fd8\u63d0\u4f9b\u4e86 <code>framework/user.h</code>, \u8fd9\u4e2a\u6587\u4ef6\u662f\u7528\u6237\u8fdb\u7a0b (\u5047\u60f3\u6709\u7684\u8bdd)/\u5185\u6838\u4e4b\u95f4\u5171\u4eab\u7684\uff0c\u5b83\u5b9a\u4e49\u4e86\u8bf8\u5982 <code>struct ufs_stat</code>, \u4ee5\u53ca\u82e5\u5e72\u51fd\u6570\u53c2\u6570\u7684\u542b\u4e49\uff0c\u548c\u76ee\u5f55\u6587\u4ef6\u7684\u683c\u5f0f\u3002\u4f8b\u5982 <code>whence</code> \u4e2d\u7684 <code>SEEK_SET</code>, <code>SEEK_CUR</code> \u548c <code>SEEK_END</code>\uff1a</p> <pre><code>#define T_DIR     1\n#define T_FILE    2\n\n#define SEEK_CUR  0\n#define SEEK_SET  1\n#define SEEK_END  2\n\n#define O_RDONLY  00000000\n#define O_WRONLY  00000001\n#define O_RDWR    00000002\n#define O_CREAT   00000100\n\nstruct ufs_stat {\n  uint32_t id, type, size;\n};\n\nstruct ufs_dirent {\n  uint32_t inode;\n  char name[28];\n} __attribute__((packed));\n</code></pre> <p>\u8bf7\u4e0d\u8981\u4fee\u6539\u4e0a\u8ff0\u6846\u67b6\u4e2d\u7684\u5b9a\u4e49\uff0c\u4f46\u6587\u4ef6\u7cfb\u7edf\u7684\u6570\u636e\u7ed3\u6784\u8bbe\u8ba1\u3001\u7ebf\u7a0b\u540c\u6b65\u7b49\u4f60\u90fd\u53ef\u4ee5\u81ea\u7531\u53d1\u6325\uff01\u867d\u7136\u6587\u4ef6\u7cfb\u7edf\u7684\u5b9e\u73b0\u539f\u7406\u7b80\u5355\uff0c\u4f46\u5b9e\u73b0\u6587\u4ef6\u7cfb\u7edf\u7684\u5de5\u4f5c\u91cf\u591f\u5927 (\u800c\u4e14\u8981\u5c0f\u5fc3\u5904\u7406\u5f88\u591a\u5bf9\u8c61\u7684\u751f\u547d\u5468\u671f\u548c error handling)\uff0c\u8bf7\u4f60\u505a\u597d\u8c03\u8bd5\u4ee3\u7801\u7684\u5fc3\u7406\u51c6\u5907 \ud83d\ude01\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#_1","title":"\u6ce8\u610f\uff1a\u672c\u5b9e\u9a8c\u9700\u8981\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u90e8\u5206\u6b63\u5e38\u5de5\u4f5c","text":"<p>\u5728 Lab 3 \u4e2d\uff0c\u4f60\u9700\u8981\u5408\u5e76 Lab 2 \u7684\u5b98\u65b9\u6d4b\u8bd5\u7528\u4f8b (dev \u4ee5\u53ca\u82e5\u5e72\u8bbe\u5907\u9a71\u52a8\u7684\u5b9e\u73b0)\u3002\u4f46\u5373\u4fbf\u4f60\u7684 kmt \u5b9e\u73b0\u6709\u95ee\u9898 (\u4f8b\u5982\u7ec8\u7aef\u8bbe\u5907\u5728\u65f6\u949f\u4f5c\u7528\u4e0b\u6709\u4e00\u5b9a\u7684\u5f02\u5e38)\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5c1d\u8bd5\u6ce8\u91ca\u6389\u7ebf\u7a0b\u521b\u5efa\u7684\u4ee3\u7801\u548c\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u7684\u6ce8\u518c\uff0cLab 3 \u7684 Online Judge \u53ea\u8c03\u7528\u78c1\u76d8\u8bbe\u5907 (sda)\uff0c\u5176\u4ee3\u7801\u76f8\u5bf9\u7b80\u5355\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#22-vfs-virtual-file-system","title":"2.2 VFS (Virtual File System) \u6a21\u5757","text":""},{"location":"courses/os_lab/L4_vfs.html#_2","title":"\u26a0\ufe0f \u7ebf\u7a0b\u5b89\u5168\u6027","text":"<p>\u6ce8\u610f\uff0c\u9664\u4e86\u6a21\u5757\u7684\u521d\u59cb\u5316 (<code>init</code>) \u4e4b\u5916\uff0c\u7cfb\u7edf\u4e2d\u521b\u5efa\u7684\u7ebf\u7a0b\u90fd\u53ef\u4ee5\u5e76\u53d1\u5730\u8bbf\u95ee\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u5bf9\u8c61\u2014\u2014\u4f46\u6ce8\u610f\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u6709\u4e00\u4efd\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u526f\u672c\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#221","title":"2.2.1 \u6a21\u5757\u521d\u59cb\u5316","text":"<p><code>vfs-&gt;init()</code> \u8d1f\u8d23\u521d\u59cb\u5316\u5fc5\u8981\u7684\u6570\u636e\uff0c\u4f8b\u5982\u6839\u6587\u4ef6\u7cfb\u7edf\u7684\u521b\u5efa\u7b49\u3002\u6211\u4eec\u9884\u671f\u4f60\u4f1a\u5728 <code>os-&gt;init()</code> \u65f6\u8c03\u7528 <code>vfs-&gt;init()</code>\u3002\u6574\u4e2a\u7cfb\u7edf\u542f\u52a8\u53ea\u8c03\u7528\u4e00\u6b21 <code>vfs-&gt;init()</code>\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#222","title":"2.2.2 \u76ee\u5f55\u7ed3\u6784","text":"<p>\u5728 Lab 3 \u4e2d\uff0c\u6211\u4eec\u5b9e\u73b0\u6811\u72b6\u7684\u76ee\u5f55\u7ed3\u6784\uff0c\u4e09\u4e2a\u6587\u4ef6\u7cfb\u7edf\u5b9e\u73b0\uff1a</p> <ul> <li>\u901a\u8fc7 <code>/</code> \u8bbf\u95ee ufs\uff0cufs \u7ba1\u7406\u78c1\u76d8\u8bbe\u5907 <code>sda</code>\u3002ufs \u652f\u6301\u6587\u4ef6\u7cfb\u7edf\u5185\u7684\u94fe\u63a5 (linking)\uff1b</li> <li>\u901a\u8fc7 <code>/proc</code> \u53ef\u4ee5\u8bbf\u95ee procfs\u3002procfs \u4e3a\u6bcf\u4e00\u4e2a\u7ebf\u7a0b (\u4e4b\u540e\u7684\u8fdb\u7a0b) \u521b\u5efa\u4e00\u4e2a\u76ee\u5f55\uff0c\u76ee\u5f55\u4e2d\u53ef\u4ee5\u63d0\u4f9b\u8be5\u7ebf\u7a0b (\u8fdb\u7a0b) \u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u4f60\u53ef\u4ee5\u901a\u8fc7 <code>/proc/1/name</code> \u6765\u5f97\u5230\u7ebf\u7a0b\u7684\u540d\u5b57\uff1b</li> <li>\u6211\u4eec\u9884\u671f\u901a\u8fc7 <code>/dev</code> \u8bbf\u95ee devfs\uff0c\u4f8b\u5982\u901a\u8fc7 <code>/dev/sda</code> \u7528\u6587\u4ef6\u7cfb\u7edf API \u76f4\u63a5\u8bfb\u5199\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u3002</li> </ul> <p>\u4f60\u53ef\u4ee5\u7406\u89e3\u4e3a\u4f60\u7684 <code>vfs-&gt;init()</code> \u9700\u8981\u5b8c\u6210 <code>/proc</code> \u548c <code>/dev</code> \u7684\u6302\u8f7d\u2014\u2014\u4f46\u4f60\u4e0d\u9700\u8981\u5b9e\u73b0 mount/unmount API\uff0c\u56e0\u6b64\u4f60\u53ef\u4ee5\u5728\u9002\u5f53\u7684\u65f6\u5019 \u201c\u786c\u7f16\u7801\u201d \u4ee5\u51cf\u5c11\u4ee3\u7801\u7684\u590d\u6742\u5ea6\u3002\u6587\u4ef6\u7cfb\u7edf\u7684\u76ee\u5f55\u6811\u770b\u8d77\u6765\u548c Linux \u6709\u4e00\u5b9a\u7684\u76f8\u4f3c\u6027 (\u7ea2\u8272\u7684\u8282\u70b9\u8868\u793a\u76ee\u5f55\uff0c\u9ed1\u8272\u7684\u8282\u70b9\u8868\u793a\u6587\u4ef6\uff0c\u4e09\u89d2\u5f62\u8868\u793a\u6587\u4ef6\u7cfb\u7edf)\uff1a</p> <p></p> <p><code>vfs</code> \u6a21\u5757\u4e2d\u7684 API \u7528\u4e8e\u6539\u53d8\u6587\u4ef6\u7cfb\u7edf\u7684\u7ed3\u6784\u548c\u7ba1\u7406\u7ebf\u7a0b\u6253\u5f00\u7684\u6587\u4ef6\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#223","title":"2.2.3 \u8def\u5f84\u4e0e\u6587\u4ef6\u63cf\u8ff0\u7b26","text":"<pre><code>int (*chdir)(const char *path);\nint (*open)(const char *pathname, int flags);\nint (*close)(int fd);\n</code></pre> <p>\u5728\u6211\u4eec\u5b9e\u73b0\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u6709\u4e00\u4e2a \u201c\u5f53\u524d\u8def\u5f84\u201d\uff0c\u6307\u5411\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4e00\u4e2a\u5b58\u5728\u7684\u76ee\u5f55 (\u6211\u4eec\u5047\u8bbe\u4e0d\u4f1a\u5220\u9664\u4efb\u4f55\u8fdb\u7a0b\u7684\u5f53\u524d\u76ee\u5f55\uff0c\u867d\u7136\u5b9e\u9645\u7684\u7cfb\u7edf\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u6709 defined behavior\uff1b\u4f60\u53ef\u4ee5\u8003\u8651\u5982\u4f55\u5b9e\u73b0\u8fd9\u4e00\u70b9)\u3002\u4e4b\u540e\u7ebf\u7a0b\u6267\u884c\u6240\u6709\u7684 API (chdir, open, read, link, unlink, mkdir) \u65f6\uff0c\u5982\u8def\u5f84\u4e0d\u662f\u4ee5 <code>/</code> \u5f00\u5934\uff0c\u5219\u76f8\u5bf9\u4e8e\u5f53\u524d\u8def\u5f84\u8fdb\u884c\u8def\u5f84\u89e3\u6790\u3002\u4f8b\u5982\uff0c\u5982\u679c\u5f53\u524d\u76ee\u5f55\u662f <code>/proc</code> (procfs)\uff0c\u90a3\u4e48 <code>1/name</code> \u5c31\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u8def\u5f84 (\u6307\u5411 <code>/proc/1/name</code>)\u3002</p> <ul> <li> <p>chdir \u6539\u53d8\u5f53\u524d\u7ebf\u7a0b\u7684\u5f53\u524d\u8def\u5f84\u4e3a <code>path</code>; \u6210\u529f\u8fd4\u56de 0\u3002</p> </li> <li> <p>open \u6253\u5f00 <code>path</code>, \u5141\u8bb8\u7684\u6253\u5f00\u65b9\u5f0f flags \u5b9a\u4e49\u5728 <code>user.h</code>:</p> </li> <li> <p><code>O_RDONLY</code>: \u53ea\u8bfb\uff1b</p> </li> <li><code>O_WRONLY</code>: \u53ea\u5199\uff1b</li> <li><code>O_RDWR</code>: \u53ef\u8bfb\u53ef\u5199\uff1b</li> <li><code>O_CREAT</code>: \u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\u5219\u521b\u5efa\u3002</li> </ul> <p>\u5982\u6253\u5f00\u6210\u529f\uff0c\u8fd4\u56de\u4e00\u4e2a\u975e\u8d1f\u6574\u6570\u7f16\u53f7\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26 (\u6700\u5c0f\u7684\u672a\u4f7f\u7528\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u5c31\u50cf\u6211\u4eec\u5728 Linux \u4e2d\u89c1\u5230\u7684\u90a3\u6837\uff0c\u6253\u5f00\u5931\u8d25\u8fd4\u56de\u8d1f\u6570)\u3002\u6587\u4ef6\u63cf\u8ff0\u7b26\u662f\u6307\u5411\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u8c61 (\u5177\u4f53\u6765\u8bf4\uff0c\u5728\u6211\u4eec\u7684\u5b9e\u73b0\u91cc\u5c31\u662f\u6587\u4ef6) \u7684\u6307\u9488\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u6587\u4ef6\u63cf\u8ff0\u7b26\u64cd\u4f5c\u8bbf\u95ee\u8fd9\u4e2a\u5bf9\u8c61\u3002</p> <ul> <li>close \u5173\u95ed\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</li> </ul>"},{"location":"courses/os_lab/L4_vfs.html#unix","title":"\u4e0e UNIX \u6587\u4ef6\u7cfb\u7edf\u7684\u533a\u522b","text":"<p>\u6ce8\u610f\u5141\u8bb8 open \u4ee5\u53ea\u8bfb\u7684\u65b9\u5f0f\u6253\u5f00\u76ee\u5f55\u6587\u4ef6\u3002\u5728\u6211\u4eec\u7684 ufs \u4e2d\uff0c\u76ee\u5f55\u6587\u4ef6\u4ee5\u4e8c\u8fdb\u5236\u5f62\u5f0f\u5b58\u50a8 <code>struct ufs_dirent</code> \u7684\u6570\u7ec4\uff0c\u4ece\u800c\u53ef\u4ee5\u83b7\u5f97\u76ee\u5f55\u4e2d\u6587\u4ef6\u7684\u5217\u8868\uff0c\u4ece\u800c\u65e0\u9700 <code>readdir</code> (<code>getdents</code>) \u7cfb\u7edf\u8c03\u7528\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#224","title":"2.2.4 \u76ee\u5f55\u548c\u6587\u4ef6\u64cd\u4f5c","text":"<pre><code>int (*mkdir)(const char *pathname);\nint (*link)(const char *oldpath, const char *newpath);\nint (*unlink)(const char *pathname);\nint (*fstat)(int fd, struct ufs_stat *buf);\n</code></pre> <ul> <li>\u76ee\u5f55\u7ba1\u7406\u7684 API \u662f mkdir (\u521b\u5efa\u76ee\u5f55)\u3001link (\u521b\u5efa\u6587\u4ef6\u7684\u94fe\u63a5)\u3001unlink (\u5220\u9664\u94fe\u63a5)\uff0c\u884c\u4e3a\u548c Linux/\u6559\u79d1\u4e66\u4fdd\u6301\u4e00\u81f4\uff0c\u6ce8\u610f\u8def\u5f84\u540d\u5982\u679c\u4e0d\u662f\u4ee5 <code>/</code> \u5f00\u5934\u9700\u8981\u4ee5\u5f53\u524d\u7ebf\u7a0b\u7684\u5de5\u4f5c\u76ee\u5f55\u8fdb\u884c\u76f8\u5bf9\u89e3\u6790\u3002\u6ce8\u610f\u53ea\u6709\u78c1\u76d8\u4e0a\u6301\u4e45\u7684\u6587\u4ef6\u7cfb\u7edf\u652f\u6301\u94fe\u63a5\u2014\u2014\u4f60\u4e0d\u9700\u8981\u4e3a procfs \u548c devfs \u652f\u6301\u94fe\u63a5\u3002</li> <li>\u5bf9\u4e00\u4e2a\u6253\u5f00\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528 fstat \u67e5\u770b\u6587\u4ef6\u7684\u5c5e\u6027\uff0c<code>struct ufs_stat</code> \u5b9a\u4e49\u5728<code>user.h</code>\uff1a</li> <li>id \u662f\u7f16\u53f7 (<code>&gt;= 1</code>)\uff1b</li> <li>type \u662f <code>T_DIR</code> (\u76ee\u5f55) \u6216 <code>T_FILE</code> (\u6587\u4ef6)\uff0c\u5176\u4ed6\u6570\u503c\u4e3a\u975e\u6cd5\uff1b</li> <li>size \u662f\u6587\u4ef6\u5927\u5c0f\u7684\u5b57\u8282\u6570\u3002\u5bf9\u4e8e\u76ee\u5f55\u6587\u4ef6 (\u76ee\u5f55\u9879\u7684\u6570\u7ec4)\uff0c\u5927\u5c0f\u603b\u662f <code>struct ufs_dirent</code> \u5927\u5c0f\u7684\u6574\u6570\u500d\u3002</li> </ul>"},{"location":"courses/os_lab/L4_vfs.html#225","title":"2.2.5 \u6587\u4ef6\u63cf\u8ff0\u7b26\u64cd\u4f5c","text":"<pre><code>int (*write)(int fd, void *buf, int count);\nint (*read)(int fd, void *buf, int count);\nint (*lseek)(int fd, int offset, int whence);\nint (*dup)(int fd);\n</code></pre> <p>\u628a\u6587\u4ef6\u63cf\u8ff0\u7b26\u770b\u6210\u662f\u8bbf\u95ee\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u8c61\u7684 \u201c\u6307\u9488\u201d\uff0c\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u7684\u64cd\u4f5c\u5c31\u975e\u5e38\u5bb9\u6613\u7406\u89e3\uff1aread, write \u4f1a\u4ece\u6587\u4ef6\u63cf\u8ff0\u7b26\u5185\u7f6e\u7684\u6e38\u6807 (offset) \u4e2d\u8bfb\u53d6\u6570\u636e\u5e76\u76f8\u5e94\u66f4\u65b0 offset, lseek \u4f1a\u6539\u53d8\u6e38\u6807\u7684\u4f4d\u7f6e\uff0c\u5176\u4e2d whence (<code>user.h</code>):</p> <ul> <li><code>SEEK_CUR</code>: \u4ece\u5f53\u524d\u4f4d\u7f6e\u5f00\u59cb\uff1b</li> <li><code>SEEK_SET</code>: \u4ece\u5934\u90e8\u5f00\u59cb\uff1b</li> <li><code>SEEK_END</code>: \u4ece\u5c3e\u90e8\u5f00\u59cb\u3002\u6b64\u65f6 <code>offset</code> \u4e3a 0 \u5c06\u4f1a\u8bfb\u5230 EOF (end-of-file)\u3002</li> </ul> <p>dup \u590d\u5236\u4e00\u4efd\u5171\u4eab offset \u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u8fd4\u56de\u6700\u5c0f\u53ef\u7528\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u8fd9\u4e9b API \u7684\u884c\u4e3a\u90fd\u548c Linux \u4e00\u81f4\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#226","title":"2.2.6 \u6302\u8f7d\u7684\u6587\u4ef6\u7cfb\u7edf","text":""},{"location":"courses/os_lab/L4_vfs.html#1-ufs","title":"(1) ufs","text":"<p>ufs \u662f\u5efa\u7acb\u5728\u8bbe\u5907 <code>sda</code> (\u78c1\u76d8) \u4e0a\u7684\u6301\u4e45\u6570\u636e\u7ed3\u6784\u3002\u8bbe\u5907\u9a71\u52a8\u63d0\u4f9b\u4e86\u5bf9 sda \u7684\u8bfb\u5199\u64cd\u4f5c\u3002\u4f60\u9700\u8981\u652f\u6301\u5728 ufs \u4e2d\u521b\u5efa\u76ee\u5f55\u3001\u6587\u4ef6\u548c\u94fe\u63a5\u3002</p> <p>ufs \u9ed8\u8ba4\u6302\u8f7d\u5728 <code>/</code>\uff0c\u5373\u9664\u4e86 <code>/proc</code> \u548c <code>/dev</code> \u4e2d\u7684\u6587\u4ef6\u548c\u76ee\u5f55\u4e4b\u5916\uff0c\u5176\u4ed6\u7684\u6587\u4ef6\u548c\u76ee\u5f55\u90fd\u5c5e\u4e8e ufs\uff1b\u6ce8\u610f\u5982\u679c\u4f7f\u7528 open \u6253\u5f00 <code>/</code> (ufs)\uff0c\u5e76\u4e14\u8bfb\u53d6\u5176\u4e2d\u7684\u76ee\u5f55\u9879\uff0c\u4f60\u80fd\u591f\u8bfb\u5230 <code>dev</code> \u548c <code>proc</code> (\u4e24\u4e2a\u76ee\u5f55)\uff0c\u4f46\u5b83\u4eec\u7684 inode \u7f16\u53f7\u5e76\u4e0d\u91cd\u8981\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u4f60\u7684\u5b9e\u73b0\u81ea\u884c\u786e\u5b9a\u3002</p> <p>\u4f7f\u7528\u76ee\u5f55\u7ba1\u7406/\u6587\u4ef6\u7ba1\u7406\u7684 API \u53ef\u4ee5\u4fee\u6539 ufs \u6587\u4ef6\u7cfb\u7edf\u7684\u7ed3\u6784\uff0c\u5e76\u4e14\u8fd9\u4e9b\u4fee\u6539\u4f1a\u6700\u7ec8\u88ab\u6301\u4e45\u5316\u5230\u78c1\u76d8\u4e0a\u2014\u2014ufs \u662f\u78c1\u76d8\u4e0a (<code>sda</code>) \u8bbe\u5907\u4e0a\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u4f60\u9700\u8981\u5c06\u6587\u4ef6\u7cfb\u7edf\u8fd9\u4e00\u6570\u636e\u7ed3\u6784\uff0c\u7ffb\u8bd1\u6210\u5bf9 I/O \u8bbe\u5907\u7684\u8bfb/\u5199\u64cd\u4f5c\u3002\u6ce8\u610f\u6211\u4eec\u7684 dev \u6a21\u5757\u5df2\u7ecf\u5bf9\u78c1\u76d8\u8fdb\u884c\u4e86\u5c01\u88c5\uff0c\u5c06\u78c1\u76d8\u5c01\u88c5\u6210\u4e86\u4e00\u4e2a\u5b57\u8282\u5e8f\u5217\uff0c\u53ef\u4ee5\u652f\u6301\u4efb\u610f\u4f4d\u7f6e\u7684\u8bfb\u5199\u2014\u2014\u8fd9\u53ef\u80fd\u4f1a\u7b80\u5316\u4f60\u7684\u7f16\u7a0b\uff0c\u4f46\u8981\u6ce8\u610f\u975e\u5bf9\u9f50\u7684\u8bfb/\u5199\u4f1a\u5f15\u8d77\u989d\u5916\u7684 I/O \u64cd\u4f5c\u2014\u2014\u4f8b\u5982\u4f60\u5e0c\u671b\u5199\u5165\u78c1\u76d8\u7684\u67d0\u4e2a\u5b57\u8282\uff0c\u5c31\u4f1a\u5bfc\u81f4\u5305\u542b\u8fd9\u4e2a\u5b57\u8282\u7684\u6570\u636e\u5757\u88ab\u8bfb\u53d6\uff0c\u7136\u540e\u518d\u6b21\u88ab\u5199\u5165\u3002\u9f13\u52b1\u4f60\u5728\u4f60\u7684\u7cfb\u7edf\u4e2d\u5b9e\u73b0\u4e00\u5c42\u57fa\u4e8e\u6570\u636e\u5757 (\u5757\u5927\u5c0f\u53ef\u4ee5\u7531\u4f60\u81ea\u884c\u5b9a\u4e49\uff0c\u4f8b\u5982 4 KiB) \u7684\u7f13\u5b58\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#2-procfs","title":"(2) procfs","text":"<p>procfs \u662f\u865a\u62df\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e0d\u6d89\u53ca\u4efb\u4f55\u8bbe\u5907\u3002\u4e0d\u652f\u6301\u5728 procfs \u4e2d\u4f7f\u7528 vfs API \u521b\u5efa\u6587\u4ef6/\u76ee\u5f55/\u94fe\u63a5\u3002procfs \u4e2d\u7684\u76ee\u5f55 (<code>/proc</code> \u672c\u8eab\uff0c\u4ee5\u53ca\u5f62\u5982 <code>/proc/[id]</code> \u7684\u76ee\u5f55) \u9700\u8981\u652f\u6301 fstat \u548cread \u64cd\u4f5c\uff0c\u80fd\u8bfb\u51fa\u6b63\u786e\u7684\u5927\u5c0f (<code>struct ufs_stat</code> \u4e2d\u7684 <code>size</code> \u5b57\u8282\u6570)\uff0c\u548c <code>struct ufs_dirent</code> \u7ed3\u6784\u4f53\u3002</p> <p>procfs \u597d\u50cf\u662f \u201c\u6302\u8f7d\u201d \u5728 <code>/proc</code> \u4e0b\uff0cprocfs \u4e2d\u7684\u76ee\u5f55\u662f\u6240\u6709\u7684\u7ebf\u7a0b\u7684\u7f16\u53f7\u3002\u6bcf\u4e2a\u7ebf\u7a0b\u5bf9\u5e94\u7684\u76ee\u5f55\u91cc\u81f3\u5c11\u6709\u4e00\u4e2a \u201cname\u201d \u6587\u4ef6\uff0c\u8bfb\u53d6\u8be5\u6587\u4ef6\u53ef\u4ee5\u5f97\u5230\u7ebf\u7a0b\u7684\u540d\u5b57 (<code>kmt-&gt;create</code> \u65f6\u7684\u53c2\u6570)\u3002\u56e0\u6b64\u4f60\u7684 procfs \u5b9e\u73b0\u770b\u8d77\u6765\u5c31\u662f\uff1a</p> <pre><code>/\n\u2514\u2500\u2500 proc\n    \u251c\u2500\u2500 1\n    \u2502   \u2514\u2500\u2500 name\n    \u251c\u2500\u2500 2\n    \u2502   \u2514\u2500\u2500 name\n    \u251c\u2500\u2500 4\n    \u2502   \u2514\u2500\u2500 name\n    \u251c\u2500\u2500 cpuinfo\n    \u2514\u2500\u2500 meminfo\n</code></pre> <p>procfs \u4e2d\u7684\u76ee\u5f55\u548c\u6587\u4ef6\u4f1a\u6839\u636e\u7ebf\u7a0b\u7684\u521b\u5efa/\u5220\u9664\u52a8\u6001\u53d8\u5316\u3002\u56e0\u6b64\u4f60\u8981\u5c0f\u5fc3\u4ee5\u4e0b\u60c5\u51b5\uff1a</p> <ul> <li>\u4f7f\u7528 open \u6253\u5f00 <code>/proc</code> \u540e\u8bfb\u53d6\u5230\u4e86\u7f16\u53f7\u4e3a 10 \u7684\u7ebf\u7a0b\uff1b</li> <li>\u6253\u5f00 <code>/proc/10/name</code> \u6210\u529f\uff1b</li> <li>\u6b64\u65f6\u7ebf\u7a0b\u7ed3\u675f\u9000\u51fa\u3002</li> </ul> <p>\u65e0\u8bba\u4f60\u7684 read \u662f\u8fd4\u56de EOF \u8fd8\u662f\u4f9d\u7136\u6210\u529f\u90fd\u662f\u5408\u7406\u7684\uff1b\u4f46\u4f60\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0d\u80fd\u56e0\u6b64 crash\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#3-devfs","title":"(3) devfs","text":"<p>devfs \u662f\u865a\u62df\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e0d\u6d89\u53ca\u4efb\u4f55\u8bbe\u5907\u3002\u4e0d\u652f\u6301\u5728 devfs \u4e2d\u4f7f\u7528 vfs API \u521b\u5efa\u6587\u4ef6/\u76ee\u5f55/\u94fe\u63a5\u3002</p> <p>devfs \u597d\u50cf\u662f \u201c\u6302\u8f7d\u201d \u5728 <code>/dev</code> \u4e0b\uff0cdevfs \u4e2d\u81f3\u5c11\u9700\u8981\u5305\u542b\u4ee5\u4e0b\u6587\u4ef6\uff1a</p> <ul> <li>zero (<code>/dev/zero</code>): \u53ea\u8bfb\uff0c\u6c38\u8fdc\u8fd4\u56de 0 \u7684\u5e8f\u5217\uff1b</li> <li>null (<code>/dev/zero</code>): \u8bfb\u5199\uff0c\u8bfb\u6c38\u8fdc\u8fd4\u56de EOF\uff0c\u5199\u6570\u636e\u76f4\u63a5\u6210\u529f (\u4e22\u5f03)\uff1b</li> <li>random (<code>/dev/random</code>): \u53ea\u8bfb\uff0c\u8fd4\u56de\u968f\u673a\u7684\u5b57\u8282\u5e8f\u5217\u3002</li> </ul> <p>\u540c procfs, \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 vfs \u7684 API \u6253\u5f00\u3001\u8bfb\u53d6\u3001\u5199\u5165\u8fd9\u4e9b\u6587\u4ef6\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#227-mkfs","title":"2.2.7 mkfs \u5de5\u5177","text":"<p>\u4f60\u4e00\u5b9a\u7559\u610f\u5230 <code>tools/mkfs.c</code> \u8fd9\u4e2a\u6587\u4ef6\u4e86\u3002\u4f60\u9700\u8981\u5b9e\u73b0\u8fd9\u4e2a mkfs \u5de5\u5177\uff0c\u5b83\u63a5\u53d7\u4e09\u4e2a\u53c2\u6570 size, img \u548c dir\uff0c\u5c06\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u76ee\u5f55 dir \u4e2d\u7684\u6240\u6709\u76ee\u5f55\u548c\u6587\u4ef6 \u201c\u6253\u5305\u201d \u5230 img \u955c\u50cf\u6587\u4ef6\u4e2d\uff0c\u5e76\u5c06\u955c\u50cf\u6587\u4ef6\u7684\u5927\u5c0f\u8bbe\u7f6e\u4e3a size MiB\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u5f53\u524d\u76ee\u5f55\u4e2d\u6709 fs-img:</p> <pre><code>fs-img\n\u251c\u2500\u2500 a.txt\n\u251c\u2500\u2500 b.txt\n\u2514\u2500\u2500 t\n    \u2514\u2500\u2500 tmp.txt\n</code></pre> <p>\u5219\u6267\u884c</p> <pre><code>mkfs 64 build/kernel-x86_64-qemu fs-img/\n</code></pre> <p>\u5c06\u4f1a\u628a \u201cfs-img\u201d \u4f5c\u4e3a\u4f60\u78c1\u76d8\u4e0a\u6587\u4ef6\u7cfb\u7edf (\u6570\u636e\u7ed3\u6784) \u7684\u6839 (<code>/</code>)\uff0c\u5199\u5165\u5230 <code>build/kernel-x86_64-qemu</code> \u4e2d\uff0c\u5e76\u5c06\u8be5\u6587\u4ef6\u7684\u5927\u5c0f\u8bbe\u7f6e\u4e3a 64 MiB\u3002\u7b80\u5355\u8d77\u89c1\uff0c\u4f60\u53ef\u4ee5\u5047\u8bbe dir \u4e2d\u4e0d\u5b58\u5728\u4efb\u4f55\u5f62\u5f0f\u7684\u94fe\u63a5 (\u7b26\u53f7\u94fe\u63a5\u6216\u786c\u94fe\u63a5)\u3002Online Judge \u4f1a\u5728 make \u7f16\u8bd1\u5b8c\u6210\u540e\u3001\u6267\u884c\u5f00\u59cb\u524d\u8c03\u7528\u4f60\u7684 mkfs \u5de5\u5177\uff0c\u521b\u5efa\u521d\u59cb\u7684\u955c\u50cf\uff0c\u7136\u540e\u5f00\u59cb\u6267\u884c\u6587\u4ef6\u7cfb\u7edf\u7684 workloads\u3002\u6211\u4eec\u5728\u6d4b\u8bd5\u65f6\uff0cmkfs \u521b\u5efa\u7684\u955c\u50cf\u4e0d\u4f1a\u8d85\u8fc7 AbstractMachine \u4e2d\u78c1\u76d8\u7684\u5927\u5c0f (\u5728\u5f53\u524d\u7684\u5b9e\u73b0\u4e2d\u662f 256 MiB)\u3002</p> <p>\u6ce8\u610f AbstractMachine \u78c1\u76d8\u955c\u50cf\u6709\u5b83\u56fa\u5b9a\u7684\u683c\u5f0f\uff1a</p> <p></p> <p>\u53ea\u6709\u5728 kernel \u7684 ELF \u6587\u4ef6\u4e4b\u540e\u7684\u7a7a\u95f4\u624d\u662f\u53ef\u7528\u7684\u3002\u4e3a\u4e86\u5728\u78c1\u76d8\u4e0a\u5efa\u7acb\u6587\u4ef6\u7cfb\u7edf\uff0c\u4f60\u6709\u4e24\u79cd\u53ef\u884c\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u4efb\u610f\u9009\u62e9\uff1a</p> <ul> <li>\u6587\u4ef6\u7cfb\u7edf\u7684\u7b2c\u4e00\u4e2a block \u4ece\u56fa\u5b9a\u7684\u4f4d\u7f6e\u5f00\u59cb\uff0c\u4f8b\u5982 1 MiB \u7684\u4f4d\u7f6e\u3002\u8fd9\u6837\u4f60\u53ef\u80fd\u9700\u8981\u68c0\u67e5\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u5927\u5c0f\uff0c\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u8fc7\u5927\u65f6\u663e\u793a\u9519\u8bef\u4fe1\u606f\u3002</li> <li>\u6587\u4ef6\u7cfb\u7edf\u7684\u7b2c\u4e00\u4e2a block \u7531 ELF \u6587\u4ef6\u51b3\u5b9a\uff0c\u4f8b\u5982\u76f4\u63a5\u5728 ELF \u6587\u4ef6\u4e4b\u540e\u3002\u4f60\u9700\u8981\u628a\u8fd9\u4e2a block \u7684\u7f16\u53f7 (\u4f8b\u5982\u6247\u533a\u53f7) \u5199\u5165\u5230\u78c1\u76d8\u7684\u5f15\u5bfc\u6247\u533a (\u7b2c\u4e00\u4e2a 512 \u5b57\u8282) \u4e2d\u3002</li> </ul>"},{"location":"courses/os_lab/L4_vfs.html#2210","title":"2.2.10 \u5751","text":"<p>\u4f60\u4f1a\u5728\u5b9e\u73b0\u6587\u4ef6\u7cfb\u7edf\u7684\u8fc7\u7a0b\u4e2d\u9047\u5230\u5404\u79cd\u5404\u6837\u7684\u5c0f\u9ebb\u70e6\uff0c\u4f8b\u5982\u4f60\u9996\u5148\u9047\u5230\u7684\u5751\u662f mkfs \u9700\u8981\u5c06\u6587\u4ef6 \u201cpad\u201d \u5230\u6307\u5b9a\u7684\u5927\u5c0f\uff0c\u78c1\u76d8\u624d\u80fd\u6b63\u786e\u5199\u5165\u3002\u5982\u679c\u955c\u50cf\u6587\u4ef6\u53ea\u6709 1 MiB\uff0c\u90a3\u4e48\u8bfb\u53d6\u4e4b\u540e\u7684\u5b57\u8282\u90fd\u5c06\u5f97\u5230 0\u3002\u4f60\u8bfb\u5230\u8fd9\u53e5\u8bdd\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u9047\u5230\u8fc7\u8fd9\u4e2a\u95ee\u9898\u5e76\u4e14 debug \u5f88\u4e45\u4e86\u2014\u2014jyy \u89c9\u5f97\u8c03\u8bd5\u548c\u8d70\u8fc7\u7684\u5f2f\u8def\u90fd\u662f\u975e\u5e38\u5b9d\u8d35\u7684\u7ecf\u9a8c\u3002</p> <p>\u6bcf\u4e2a\u8fdb\u7a0b\u6709 \u201c\u5f53\u524d\u8def\u5f84\u201d\uff0c\u901a\u5e38\u662f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4e00\u4e2a\u5408\u6cd5\u76ee\u5f55 (\u81f3\u5c11\u5728 chdir \u8fd4\u56de\u7684\u77ac\u95f4\uff0c\u5426\u5219 chdir \u5e94\u8be5\u8fd4\u56de\u5931\u8d25)\u3002\u4f46\u662f\uff0c\u7cfb\u7edf\u4e2d\u7684\u5176\u4ed6\u7ebf\u7a0b (\u751a\u81f3\u5f53\u524d\u7ebf\u7a0b) \u53ef\u80fd\u5c06\u8fd9\u4e2a\u76ee\u5f55\u5220\u9664\u3002\u6b64\u65f6\uff0c\u4f60\u7684\u7cfb\u7edf\u7684\u884c\u4e3a\u662f\u4ec0\u4e48\uff1f\u5982\u679c\u518d\u8003\u8651\u5230 inode \u7684\u56de\u6536\uff0c\u4f60\u4f1a\u53d1\u73b0\u8fd9\u4ef6\u4e8b\u8fdc\u6bd4\u4f60\u60f3\u8c61\u5f97\u56f0\u96be\u2014\u2014\u4f60\u9700\u8981\u975e\u5e38\u4ed4\u7ec6\u5730\u8bbe\u8ba1\u5176\u4e2d\u7684\u5bf9\u8c61\u7ed3\u6784\u3001\u5f15\u7528\u8ba1\u6570\u7b49\uff0c\u6587\u4ef6\u7cfb\u7edf\u7684\u5b9e\u73b0\u5e76\u4e0d\u53ea\u662f \u201c\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u7ed3\u201d\uff0c\u6211\u4eec\u8fd8\u5fc5\u987b\u6b63\u786e\u5b9e\u73b0\u5b83\u5728\u5185\u5b58\u4e2d\u7684\u89c6\u56fe\u3002</p> <p>\u4f60\u4e0d\u59a8\u5728 Linux \u7cfb\u7edf\u91cc\u8bd5\u4e00\u8bd5\uff0c\u5982\u679c\u5904\u4e8e\u4e00\u4e2a\u88ab\u5220\u9664\u7684\u76ee\u5f55\u4f1a\u53d1\u751f\u4ec0\u4e48\u2014\u2014\u65e0\u8bba\u5982\u4f55\u53ef\u4ee5\u80af\u5b9a\u7684\u662f\uff0cLinux \u7cfb\u7edf\u4e0d\u4f1a crash\uff0c\u4f46\u4f60\u7684\u64cd\u4f5c\u7cfb\u7edf\u53ef\u80fd\u5c31\u4f1a\u4e86\u3002\u5f53\u7136\uff0c\u6211\u4eec\u7684\u6d4b\u8bd5\u7528\u4f8b\u4e2d\u6ca1\u6709\u8fd9\u79cd\u60c5\u51b5\u2014\u2014\u6211\u4eec\u7684\u6d4b\u8bd5\u7528\u4f8b\u4e2d\u6240\u6709\u7684\u8bbf\u95ee\u90fd\u662f\u5408\u6cd5\u7684\u3002\u505a\u5bf9\u6240\u6709\u7684 error handling \u662f\u4e2a\u6781\u5177\u6311\u6218\u7684\u95ee\u9898\uff0c\u751a\u81f3 Linux Kernel \u90fd\u505a\u5f97\u4e0d\u591f\u597d\u3002</p> <p>\u6587\u4ef6\u7cfb\u7edf\u7684 API \u770b\u4f3c\u7b80\u5355\uff0c\u4f46\u5176\u5b9e\u968f\u5904\u90fd\u5145\u6ee1\u4e86\u5404\u79cd\u5404\u6837\u7684\u5751 (\u4f8b\u5982\u5982\u4f55\u8fdb\u884c\u8def\u5f84\u89e3\u6790\u3001\u5982\u4f55\u5c06\u64cd\u4f5c\u8f6c\u53d1\u5230\u5bf9\u5e94\u7684\u6587\u4ef6\u7cfb\u7edf\u5b9e\u73b0\u7b49\u7b49)\u3002\u5728\u8fd9\u91cc jyy \u8981\u8b66\u544a\u5927\u5bb6\uff1a\u8bf7\u7559\u610f\u4f60\u9879\u76ee\u4ee3\u7801\u7684\u7ec4\u7ec7\u548c\u8bbe\u8ba1\u3002\u5982\u679c\u4f60\u76f4\u63a5 \u201c\u4e0d\u7ba1\u4e00\u5207\u201d \u5730\u7f16\u7a0b\uff0c\u5f88\u5feb\u5c31\u4f1a\u5f97\u5230\u81a8\u80c0\u4e14\u96be\u4ee5\u7ef4\u62a4\u7684\u4ee3\u7801\u3002\u51b7\u9759\u4e0b\u6765\u8bfb\u4e00\u8bfb xv6 \u7684\u4ee3\u7801\u662f\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#3","title":"3. \u6b63\u786e\u6027\u6807\u51c6","text":""},{"location":"courses/os_lab/L4_vfs.html#31","title":"3.1 \u6587\u4ef6\u7cfb\u7edf\u5b9e\u73b0","text":"<p>\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u6211\u4eec\u4f1a\u9996\u5148\u4f7f\u7528\u4f60\u7684 mkfs \u5de5\u5177\u521d\u59cb\u5316\u6587\u4ef6\u7cfb\u7edf\uff0c\u7136\u540e\u542f\u52a8\u865a\u62df\u673a\u3001\u521b\u5efa\u82e5\u5e72\u7ebf\u7a0b\uff0c\u8fde\u7eed\u8c03\u7528\u6587\u4ef6\u7cfb\u7edf API\uff0c\u6839\u636e\u6587\u4ef6\u7cfb\u7edf API \u7684\u8f93\u51fa\u51b3\u5b9a\u4f60\u5b9e\u73b0\u7684\u6b63\u786e\u6027\u3002\u5728 easy tests \u4e2d\uff0c\u6211\u4eec\u53ea\u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u987a\u5e8f\u5730\u6267\u884c\u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c\uff0c\u5e76\u68c0\u67e5\u6587\u4ef6\u7cfb\u7edf\u7684\u529f\u80fd\u5b9e\u73b0\u3002\u5728 hard tests \u4e2d\uff0c\u6211\u4eec\u4f1a\u521b\u5efa\u82e5\u5e72\u7ebf\u7a0b\u6267\u884c\u4e00\u7cfb\u5217\u7684\u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c\u3002\u6267\u884c\u7684\u64cd\u4f5c\u53ef\u80fd\u6709\u4e00\u5b9a\u7684\u968f\u673a\u6027\uff0c\u5e76\u4e14\u56e0\u4e3a\u5e76\u53d1\u7a0b\u5e8f\u7684\u4e0d\u786e\u5b9a\u6027\uff0c\u4f60\u5c06\u4f1a\u9884\u671f\u6bcf\u6b21\u6267\u884c\u7684\u7ed3\u679c\u90fd\u6709\u4e00\u4e9b\u4e0d\u540c\uff0c\u4f46\u4f60\u9700\u8981\u5b9e\u73b0\u53ef\u4e32\u884c\u5316 (serializable) \u7684\u6587\u4ef6\u7cfb\u7edf\uff1a\u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c\u7684\u7ed3\u679c\u770b\u8d77\u6765\u50cf\u662f\u6240\u6709\u6267\u884c\u8fc7\u7684\u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c\u6392\u6210\u67d0\u4e2a\u987a\u5e8f\u6267\u884c\u7684\u3002\u6700\u7b80\u5355\u7684\u5b9e\u73b0\u53ef\u4e32\u884c\u5316\u7684\u65b9\u5f0f\u5c31\u662f\u4e3a\u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c\u52a0\u4e0a\u4e92\u65a5\u9501\uff0c\u53ef\u4ee5\u4f7f\u7528\u4fe1\u53f7\u91cf\u7684 P/V \u64cd\u4f5c\u5b9e\u73b0\u3002</p> <p>\u6240\u6709\u6d4b\u8bd5\u7528\u4f8b\u7684\u6587\u4ef6\u7cfb\u7edf\u8c03\u7528\u5747\u5728\u4f7f\u7528 <code>kmt-&gt;create</code> \u521b\u5efa\u7684\u7ebf\u7a0b\u4e2d\u8c03\u7528\u2014\u2014\u56e0\u4e3a\u6587\u4ef6\u63cf\u8ff0\u7b26\u662f\u7ebf\u7a0b\u7684\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u4e0d\u4f1a\u5728\u64cd\u4f5c\u7cfb\u7edf\u542f\u52a8/\u521d\u59cb\u5316/\u4e2d\u65ad\u65f6\u6267\u884c\u5bf9\u6587\u4ef6\u7cfb\u7edf\u7684\u64cd\u4f5c\u3002</p> <p>\u4e3a\u4e86\u5c3d\u53ef\u80fd\u5730\u8ba9\u6240\u6709\u540c\u5b66\u80fd\u5b8c\u6210 Lab3\uff0c\u6211\u4eec\u7684\u6d4b\u8bd5\u7528\u4f8b\u867d\u7136\u4f1a\u521b\u5efa\u7ebf\u7a0b\uff0c\u4f46\u7ebf\u7a0b\u4e0d\u4f1a\u7ec8\u6b62 (\u6267\u884c\u5b8c\u6240\u6709\u64cd\u4f5c\u7684\u7ebf\u7a0b\u4f1a\u6267\u884c\u6b7b\u5faa\u73af\u6216 yield)\uff0c\u4e5f\u4e0d\u8c03\u7528\u4fe1\u53f7\u91cf (\u4f1a\u8c03\u7528\u81ea\u65cb\u9501)\uff0c\u8fd9\u6837\u5373\u4fbf\u4f60\u7684 Lab2 \u5b9e\u73b0\u6709\u4e00\u5b9a\u95ee\u9898\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4e00\u5b9a\u7684\u6d4b\u8bd5\u7528\u4f8b\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#_3","title":"\u6ce8\u610f\uff1a\u8c03\u8bd5\u8f93\u51fa","text":"<p>\u540c\u4e0a\u4e00\u4e2a\u5b9e\u9a8c\uff0c\u8bf7\u5c3d\u91cf\u4e0d\u8981\u6253\u5370\u591a\u4f59\u7684\u8f93\u51fa\u3002\u867d\u7136\u6211\u4eec\u7684\u68c0\u67e5\u4ee3\u7801\u4f1a\u8fdb\u884c\u4e00\u5b9a\u7684\u8fc7\u6ee4\uff0c\u4f46\u56e0\u4e3a\u591a\u5904\u7406\u5668\u7684\u5e76\u53d1\uff0c\u4f60\u5728\u5176\u4ed6\u5904\u7406\u5668\u4e0a\u7684\u8f93\u51fa\u53ef\u80fd\u4f1a\u5f71\u54cd\u6211\u4eec\u7684\u68c0\u67e5\u8f93\u51fa\uff0c\u4ece\u800c\u5bfc\u81f4 Wrong Answer\u3002\u56e0\u6b64\u6211\u4eec\u5efa\u8bae\u4f60\u4f7f\u7528\u81ea\u5df1\u7684 log \u6216 printk \u51fd\u6570 (\u800c\u4e0d\u662f printf; \u6211\u4eec\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u4f1a\u4f7f\u7528 printf)\uff0c\u4e14\u5b83\u4eec\u7684\u884c\u4e3a\u7531\u9884\u7f16\u8bd1\u6307\u4ee4\u63a7\u5236\uff0c\u4ec5\u5728\u4f60\u672c\u5730\u7f16\u8bd1\u65f6\u624d\u6253\u5370\u6570\u636e\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#_4","title":"\u6ce8\u610f\uff1a\u4e0a\u9501\u7684\u7c92\u5ea6","text":"<p>\u78c1\u76d8\u662f\u6162\u901f\u8bbe\u5907\uff1b\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u7684\u64cd\u4f5c\u53ef\u80fd\u8f83\u957f\uff0c\u4f7f\u7528\u81ea\u65cb\u9501\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e2d\u65ad\u4e22\u5931\u3001\u9965\u997f\u7b49\u540e\u679c (\u9965\u997f\u610f\u5473\u7740\u4f60\u65e0\u6cd5\u8fbe\u5230\u6700\u5c0f\u7684\u6027\u80fd\u8981\u6c42\u4ece\u800c Wrong Answer)\u3002\u5982\u679c\u4f60\u5e0c\u671b\u501f\u7528 Lab2 \u4e2d\u7684\u540c\u6b65\u539f\u8bed\uff0c\u8bf7\u4f7f\u7528\u4fe1\u53f7\u91cf\u5b9e\u73b0\u7684\u4e92\u65a5\u9501\uff0c\u5728\u7ebf\u7a0b\u65e0\u6cd5\u83b7\u5f97\u9501\u65f6\u7761\u7720\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#32","title":"3.2 \u6570\u636e\u7684\u6301\u4e45\u6027","text":"<p>\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u6211\u4eec\u4e0d\u8981\u6c42\u4f60\u5b9e\u73b0\u6ee1\u8db3\u5d29\u6e83\u4e00\u81f4\u6027\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e5f\u6ca1\u6709\u63d0\u4f9b fsync \u7684\u63a5\u53e3\uff1a\u6211\u4eec\u5047\u8bbe\u4f60\u7684\u6570\u636e\u6ee1\u8db3 \u201ceventual consistency\u201d\uff0c\u5373\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u7ed3\u6784\u5728\u6ca1\u6709\u66f4\u591a\u64cd\u4f5c\u5230\u6765\u65f6\uff0c\u4f1a\u8fbe\u5230\u4e00\u81f4\u7684\u72b6\u6001\u3002\u6211\u4eec\u7684\u6d4b\u8bd5\u6570\u636e\u4f1a\u5728\u6240\u6709\u7684\u78c1\u76d8\u64cd\u4f5c\u4e4b\u540e\u7b49\u5f85\u4e00\u79d2\u949f (1000ms)\uff0c\u7136\u540e\u5173\u95ed\u865a\u62df\u673a\u3002\u518d\u6b21\u91cd\u542f\u540e\uff0cufs \u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\u5e94\u5f53\u88ab\u6b63\u786e\u6301\u4e45\u5316\uff0c\u4f8b\u5982\u4e4b\u524d\u521b\u5efa\u7684\u76ee\u5f55\u548c\u6587\u4ef6\u6b64\u65f6\u5e94\u8be5\u80fd\u591f\u6b63\u786e\u8bbf\u95ee\uff0c\u80fd\u8bfb\u53d6\u51fa\u6b63\u786e\u7684\u6570\u636e\u3002\u5982\u679c\u4f60\u4f7f\u7528\u4e86\u7c7b\u4f3c buffer cache \u7684\u7ed3\u6784\u5bf9\u78c1\u76d8\u7684\u8bfb\u5199\u8fdb\u884c\u4e86\u7f13\u5b58\uff0c\u8bf7\u4f60\u786e\u4fdd\u5728\u5728\u8fdb\u884c\u6587\u4ef6\u7cfb\u7edf\u8c03\u7528\u4e4b\u540e\u7684 1s \u5185\u5c06\u6570\u636e\u6301\u4e45\u5316\u5230\u78c1\u76d8\u3002\u4f8b\u5982\uff1a</p> <ol> <li>\u4f60\u53ef\u4ee5\u9009\u62e9\u6700\u7b80\u5355\u7684\u5b9e\u73b0\uff0c\u5373\u6bcf\u4e2a\u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c\u90fd\u7acb\u5373\u5199\u5165\u78c1\u76d8\uff0c\u5728\u6700\u540e\u4e00\u4e2a\u7cfb\u7edf\u64cd\u4f5c\u8fd4\u56de\u65f6\uff0c\u78c1\u76d8\u5373\u5904\u4e8e consistent \u7684\u72b6\u6001\u3002</li> <li>\u4f60\u53ef\u4ee5\u6784\u5efa\u81ea\u5df1\u7684\u7f13\u5b58\uff0c\u6709\u4e00\u4e2a\u540e\u53f0\u7684 daemon (\u7c7b\u4f3c jbd) \u5b8c\u6210\u78c1\u76d8\u7684\u5199\u56de\u3002\u6211\u4eec\u5efa\u8bae\u5199\u56de\u7684\u9891\u7387\u5728 500ms\uff0c\u8fd9\u6837\u6709\u8db3\u591f\u7684\u65f6\u95f4\u5c06\u6301\u4e45\u6570\u636e\u5199\u5165\u78c1\u76d8 (\u867d\u7136\u5bf9\u4e8e\u5b9e\u9645\u7684\u7cfb\u7edf\uff0c\u5199\u56de\u7684\u9891\u7387\u4f1a\u66f4\u4f4e\u4e00\u4e9b\uff0c\u4ee5\u51cf\u5c11\u78c1\u76d8\u7684\u5e26\u5bbd)\u3002</li> </ol>"},{"location":"courses/os_lab/L4_vfs.html#4","title":"4. \u5b9e\u9a8c\u6307\u5357","text":"<p>\u5728\u5f00\u59cb\u5b9e\u73b0\u4e4b\u524d\u2014\u2014\u518d\u56de\u987e\u4e00\u4e0b\u8fd9\u53e5\u8bdd\uff1a\u6587\u4ef6\u7cfb\u7edf\u662f\u4e00\u4e2a\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u7ed3\u6784\u3002\u6240\u4ee5\uff0c\u5c31\u628a\u5b83\u5f53\u6210\u662f\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u95ee\u9898\uff0c\u7528 \u201c\u62bd\u8c61\u6570\u636e\u7c7b\u578b\u201d \u53bb\u8003\u8651\u5b83\u7684\u5b9e\u73b0\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#41","title":"4.1 \u6587\u4ef6\u7cfb\u7edf\u5b9e\u73b0\uff1a\u57fa\u7840","text":"<p>\u5b9e\u73b0\u6587\u4ef6\u7cfb\u7edf\u4e2d\u6700 \u201c\u57fa\u7840\u201d \u7684\u64cd\u4f5c\u662f\u7ed9\u5b9a\u4e00\u4e2a\u8def\u5f84 (\u7edd\u5bf9\u6216\u76f8\u5bf9\u5f53\u524d\u7ebf\u7a0b\u7684\u5f53\u524d\u8def\u5f84)\uff0c\u5bf9\u8def\u5f84\u8fdb\u884c\u89e3\u6790\uff0c\u7136\u540e\u8fd4\u56de\u76f8\u5e94\u7684 inode\u3002\u9053\u7406\u770b\u8d77\u6765\u7b80\u5355\uff0c\u4f46\u5374\u6d89\u53ca\u6587\u4ef6\u7cfb\u7edf\u7684\u5404\u4e2a\u90e8\u5206\uff0c\u4e5f\u8bb8\u6709\u4e9b\u7ec6\u8282\u5c31\u662f\u4f60\u6ca1\u6709\u8003\u8651\u5230\u7684\u3002</p> <p>\u9996\u5148\uff0cinode \u4e0d\u4ec5\u662f\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u7ed3\u6784 (\u9488\u5bf9 ufs \u800c\u8a00)\uff0c\u8fd8\u9700\u8981\u5728\u5185\u5b58\u4e2d\u5206\u914d\uff1b\u865a\u62df\u7684\u6587\u4ef6\u7cfb\u7edf (\u4f8b\u5982 procfs) \u8fd8\u9700\u8981\u7ef4\u62a4\u4e00\u4e9b inode \u79c1\u6709\u7684\u5185\u5b58\u6570\u636e (\u4f8b\u5982 procfs)\u3002\u5982\u4f55\u7ba1\u7406\u8fd9\u4e9b\u6570\u636e\uff1f\u5982\u4f55\u7ba1\u7406\u5185\u5b58\u4e2d inode \u7684\u751f\u5b58\u5468\u671f\uff1f\u4f60\u7acb\u5373\u4f1a\u60f3\u5230\u4e00\u4e9b\u95ee\u9898\uff1a</p> <ol> <li>\u5728\u89e3\u6790\u8def\u5f84\u65f6\uff0c\u4f8b\u5982 <code>/this/is/a/very/long/path</code> \u65f6\uff0c\u6211\u4eec\u4f1a\u5386\u7ecf\u591a\u4e2a inode \u7684\u8bbf\u95ee\uff0c\u4f8b\u5982 <code>/</code>, <code>/this</code>, <code>/this/is</code>, ... \u6211\u4eec\u4f1a\u5728\u8fd9\u4e9b inode \u4e0a\u5206\u522b\u6267\u884c open \u64cd\u4f5c\uff0c\u76f4\u5230\u786e\u5b9a\u8981\u6253\u5f00\u7684 inode \u4e3a\u6b62\uff1b</li> <li>\u7ebf\u7a0b (\u8fdb\u7a0b) \u6709\u81ea\u5df1\u7684 \u201c\u5f53\u524d\u76ee\u5f55\u201d\uff0c\u6240\u6709\u6d89\u53ca\u8def\u5f84\u7684\u7cfb\u7edf\u8c03\u7528\uff0c\u5f53\u7ed9\u5b9a\u7684\u8def\u5f84\u4e0d\u662f\u4ee5 <code>/</code> \u5f00\u5934\u65f6\uff0c\u90fd\u662f\u76f8\u5bf9\u5f53\u524d\u8fdb\u7a0b\u7684 \u201c\u5f53\u524d\u76ee\u5f55\u201d \u8fdb\u884c\u89e3\u6790\u7684\uff1b</li> <li>\u6253\u5f00\u7684 inode \u4f1a\u5386\u7ecf\u5404\u79cd\u64cd\u4f5c\uff0c\u4f8b\u5982\u4ece\u6587\u4ef6\u7cfb\u7edf\u4e2d unlink\u3002\u6b64\u65f6\u53ef\u80fd\u6709\u4e00\u4e2a\u8fdb\u7a0b\u6301\u6709\u8be5 inode \u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u5e76\u4e14\u6b63\u5728\u5411\u6587\u4ef6\u8bfb\u5199\u6570\u636e\u3002\u6b64\u65f6\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f\u662f\u5426\u4f1a\u6709\u4e00\u65b9\u8fd4\u56de\u5931\u8d25\uff1f\u8bf7\u4f60\u5728 Linux \u4e2d\u8bd5\u4e00\u8bd5\u3002</li> </ol> <p>\u53ea\u8981\u4f60\u5728\u5185\u5b58\u4e2d\u5b9e\u73b0 <code>struct inode</code>, \u4f60\u5c31\u5fc5\u987b\u5c0f\u5fc3\u5730\u7ba1\u7406\u5b83\u7684\u751f\u5b58\u5468\u671f\u2014\u2014\u5f53\u7ebf\u7a0b\u521b\u5efa\u3001\u9500\u6bc1\u3001\u6587\u4ef6\u5173\u95ed\u2026\u2026\u5404\u79cd\u65f6\u523b\uff0c\u4f60\u90fd\u8981\u5c0f\u5fc3\u5730\u7ef4\u62a4\u5185\u5b58\u4e2d\u7684 inodes\uff0c\u4f7f\u5f97\u5b83\u4eec\u5728\u4e0d\u518d\u4f7f\u7528\u65f6 (\u6216\u8005\u662f\u5728\u53ef\u4ee5\u91ca\u653e\u540e\u4e00\u6bb5\u65f6\u95f4\u540e) \u80fd\u88ab\u5b89\u5168\u5730\u91ca\u653e\uff0c\u5e76\u4e14\u4e0d\u5f15\u8d77 double-free, use-after-free \u7b49\u95ee\u9898\u3002\u5f15\u7528\u8ba1\u6570\u662f\u4e2a\u5f88\u597d\u7684\u673a\u5236\uff0c\u4f46\u4f60\u5fc5\u987b\u8981\u5c0f\u5fc3\u5730\u7ba1\u7406\u5f15\u7528\u2014\u2014\u4e00\u65e6\u67d0\u4e2a\u5f15\u7528\u53d1\u751f\u590d\u5236\u65f6\u4f60\u5fd8\u8bb0\u589e\u52a0\u5f15\u7528\u8ba1\u6570\uff0c\u5c31\u610f\u5473\u7740\u7a0b\u5e8f\u91cc\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e25\u91cd\u7684\u95ee\u9898\u3002</p> <p>\u8def\u5f84\u89e3\u6790\u7684\u6838\u5fc3\u662f\u7ed9\u5b9a\u4e00\u4e2a inode (\u5047\u8bbe\u4f60\u5df2\u7ecf\u8f7d\u5165\u5185\u5b58\uff0c\u5e76\u4e14\u786e\u4fdd\u662f\u4e00\u4e2a\u76ee\u5f55\u6587\u4ef6)\uff0c\u7136\u540e\u8bfb\u53d6\u8fd9\u4e2a\u76ee\u5f55\u6587\u4ef6\u4e2d\u7684\u76ee\u5f55\u9879 (\u901a\u8fc7\u6587\u4ef6\u7cfb\u7edf\u7684 read \u64cd\u4f5c)\uff0c\u627e\u5230\u540d\u5b57\u5339\u914d\u7684 inode \u7f16\u53f7\uff0c\u9012\u5f52\u8fd9\u4e2a\u8fc7\u7a0b\u5c31\u80fd\u5b8c\u6210\u8def\u5f84\u89e3\u6790\u2014\u2014\u6211\u4eec\u4e5f\u9f13\u52b1\u4f60\u5b9e\u73b0\u6210\u9012\u5f52\u7684\uff0c\u8fd9\u4f1a\u5927\u5927\u7b80\u5316\u4f60\u7684\u5b9e\u73b0\u3002</p> <p>\u8def\u5f84\u89e3\u6790\u7684\u53e6\u4e00\u4e2a\u6709\u8da3\u7684\u95ee\u9898\u662f\u5904\u7406 <code>/proc</code>, <code>/dev</code> \u8fd9\u6837\u7684\u6302\u8f7d\u70b9 (mount point)\u3002\u4f60\u5e94\u8be5\u80fd\u60f3\u5230\u4e00\u4e2a\u901a\u7528\u7684\u5b9e\u73b0\u6302\u8f7d\u7684\u65b9\u6848\uff0c\u8fd9\u6837\u4f60\u7684\u6587\u4ef6\u7cfb\u7edf\u80fd\u6302\u8f7d\u5230\u76ee\u5f55\u6811\u7684\u4efb\u4f55\u5730\u65b9\u2014\u2014Linux/UNIX \u7684\u786e\u5c31\u662f\u8fd9\u6837\u5b9e\u73b0\u7684\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#42","title":"4.2 \u591a\u4e2a\u6587\u4ef6\u7cfb\u7edf\u7684\u5171\u5b58","text":"<p>\u5728\u8def\u5f84\u89e3\u6790\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4f60\u4f1a\u610f\u8bc6\u5230\u6211\u4eec\u6bcf\u4e2a\u6587\u4ef6\u7cfb\u7edf\u7684 \u201c\u6570\u636e\u7ed3\u6784\u201d \u90fd\u4e0d\u592a\u4e00\u6837\uff1a</p> <ol> <li>ufs \u7684\u6587\u4ef6\u548c\u76ee\u5f55\u90fd\u4ee5\u4e00\u4e2a\u7c7b\u4f3c UNIX \u6587\u4ef6\u7cfb\u7edf\u7684\u8bbe\u8ba1\u65b9\u5f0f\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\uff0c\u56e0\u6b64\u5bf9 ufs \u6587\u4ef6\u548c\u76ee\u5f55\u7684\u4fee\u6539\u9700\u8981\u7ffb\u8bd1\u6210 <code>sda</code> \u8bbe\u5907\u4e0a\u7684\u8bfb\u5199\u64cd\u4f5c\uff1b</li> <li>procfs \u7684\u76ee\u5f55\u662f\u52a8\u6001\u521b\u5efa\u7684 (\u5e76\u4e14\u4e0d\u5728\u6301\u4e45\u5b58\u50a8\u4e0a\uff0c\u800c\u662f\u6839\u636e\u5f53\u524d\u7684\u7ebf\u7a0b)\uff0c\u56e0\u6b64\u4f60\u9700\u8981\u904d\u5386\u7cfb\u7edf\u4e2d\u7684 <code>struct task</code>\uff0c\u5e76\u4e14\u5c06\u7ebf\u7a0b\u4fe1\u606f\u5199\u5165\u7f13\u51b2\u533a\u4e2d\uff0c\u7136\u540e\u8fd4\u56de\u7ed9\u5bf9 procfs \u7684 read\uff1b</li> <li>devfs \u7684\u6bcf\u4e2a\u6587\u4ef6\u90fd\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684\u8bbe\u5907 (\u53ef\u80fd\u662f\u865a\u62df\u7684\u3001\u53ef\u80fd\u662f\u5b9e\u9645\u5b58\u5728\u7684)\uff0c\u5bf9\u4e8e\u5b9e\u9645\u5b58\u5728\u7684\u8bbe\u5907\uff0c\u4f60\u9700\u8981\u8c03\u7528\u8bbe\u5907\u7684 read/write; \u800c\u5bf9\u4e8e\u865a\u62df\u7684\u8bbe\u5907\uff0c\u4f60\u9700\u8981\u5411\u8bfb\u8005\u63d0\u4f9b\u6b63\u786e\u7684\u6570\u636e\uff0c\u6216\u662f\u6a21\u62df\u5411\u8bbe\u5907\u7684\u5199\u5165\u3002</li> </ol> <p>\u4f60\u9700\u8981\u4e3a\u6bcf\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u7684\u90fd\u5b9e\u73b0\u4e00\u5957\u6587\u4ef6/\u76ee\u5f55\u7684 API\u2014\u2014\u8fd9\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48\u8fd9\u4e2a\u5b9e\u9a8c\u663e\u5f97\u590d\u6742\u7684\u539f\u56e0\u3002\u5982\u679c\u4f60\u4f7f\u7528\u7d27\u8026\u5408\u7684\u65b9\u5f0f\u5b9e\u73b0\uff0c\u4f60\u7684\u4ee3\u7801\u5f88\u5bb9\u6613\u4f1a\u9677\u5165\u4e0d\u53ef\u7ef4\u62a4\u7684\u6ce5\u6f6d\uff1b\u4f8b\u5982\u4ec5\u4ec5\u662f\u5199\u4e00\u4e2a \u201c\u4ee3\u7801\u6846\u67b6\u201d \u5c31\u5df2\u7ecf\u5728\u89c6\u89c9\u4e0a\u770b\u8d77\u6765\u4e0d\u592a\u53cb\u597d\u4e86\uff1a</p> <pre><code>int vfs_write(int fd, void *buf, int count) {\n  struct file *f = current-&gt;oflies[fd]; // \u53d6\u51fa\u6570\u636e\u7ed3\u6784\n  struct dev *d;\n  if (!f) goto abort;\n  ...\n  switch (f-&gt;inode-&gt;type) {\n    case FS_PROCFS:\n      ...\n      break;\n    case FS_DEVFS:\n      d = getdev(f);\n      switch (d) {\n        case DEV_NULL:\n          ...\n        case DEV_RANDOM:\n          ...\n        default:\n          // \u5176\u4ed6\u8bbe\u5907\uff0c\u8f6c\u53d1\u7ed9\u8bbe\u5907\u9a71\u52a8\n          ...\n      }\n      break;\n    case FS_UFS:\n      ...\n      break;\n  }\n  ...\nabort:\n  ...\n}\n</code></pre> <p>\u56e0\u6b64\uff0c\u5728\u8fd9\u91cc\u6709\u5fc5\u8981\u505a\u4e00\u70b9 \u201c\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u201d\u3002\u6211\u4eec\u4e0d\u59a8\u628a \u201c\u6587\u4ef6\u7cfb\u7edf\u201d \u548c \u201c\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u6587\u4ef6 (\u5305\u62ec\u76ee\u5f55\u6587\u4ef6)\u201d \u90fd\u4ee5\u5bf9\u8c61\u7684\u5f62\u5f0f\u5305\u88c5\u8d77\u6765\u3002\u4f60\u7acb\u5373\u5c31\u60f3\u5230\u4e86\uff0c\u6211\u4eec\u7684\u6846\u67b6\u4ee3\u7801\u5176\u5b9e\u5df2\u7ecf\u505a\u4e86\u5f88\u591a\u9762\u5411\u5bf9\u8c61\u7684\u5c01\u88c5\u4e86\uff01\u4f8b\u5982\u6211\u4eec\u7684\u6574\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u7684 \u201c\u6a21\u5757\u201d \u5c31\u662f\u9762\u5411\u5bf9\u8c61\u7684\uff0c\u4e00\u4e2a\u6a21\u5757\u5c31\u662f\u4e00\u4e2a\u5bf9\u8c61\u3002\u53e6\u5916\u4e00\u4e2a\u503c\u5f97\u5927\u5bb6\u53c2\u8003\u7684\u662f\u6211\u4eec\u5bf9 I/O \u8bbe\u5907\u8fdb\u884c\u7684\u5c01\u88c5\uff1a</p> <pre><code>typedef struct devops {\n  int (*init)(device_t *dev);\n  ssize_t (*read) (device_t *dev, off_t offset, void *buf, size_t count);\n  ssize_t (*write)(device_t *dev, off_t offset, const void *buf, size_t count);\n} devops_t;\n</code></pre> <p>\u7136\u540e\u6211\u4eec\u5c31\u80fd\u8fdb\u884c \u201c\u9762\u5411\u5bf9\u8c61\u201d \u7684\u8c03\u7528\u4e86\uff1a</p> <pre><code>d-&gt;ops-&gt;read(d, offset, buf, count) // d: pointer to struct dev\n</code></pre> <p>\u8fd9\u6837\u7684\u5199\u6cd5\u5728 C++ \u4e2d\u53ef\u4ee5\u66f4\u7cbe\u7b80\uff0c\u4f8b\u5982 C++ \u7684\u5bf9\u8c61\u81ea\u5e26\u51fd\u6570\uff0c\u53ef\u4ee5\u7701\u7565 \u201cthis\u201d \u7684\u8c03\u7528\u3002\u4ee5\u53ca C++ \u652f\u6301\u7c7b\u7684\u7ee7\u627f\u548c\u865a\u51fd\u6570\u2014\u2014\u865a\u51fd\u6570\u5c31\u662f\u7528\u7c7b\u4f3c <code>devops_t</code> \u5b9e\u73b0\u7684\uff01\u6bcf\u4e2a\u5bf9\u8c61\u7684\u5934\u90e8\u90fd\u6709\u4e00\u4e2a\u79f0\u4e3a \u201cvtable\u201d \u7684\u6570\u636e\u7ed3\u6784\uff0c\u6307\u5411\u4e86\u5b83\u865a\u51fd\u6570\u5b9e\u73b0\u7684\u5730\u5740\u3002</p> <pre><code>d.read(offset, buf, count); // d: reference of a Device object\n</code></pre> <p>\u4f60\u4e5f\u53ef\u4ee5\u5bf9\u6587\u4ef6\u7cfb\u7edf/\u6587\u4ef6\u7684\u64cd\u4f5c\u505a\u51fa\u7c7b\u4f3c\u7684\u5c01\u88c5\uff0c\u53ef\u4ee5\u5927\u5e45\u589e\u52a0\u4f60\u4ee3\u7801\u7684\u53ef\u7ef4\u62a4\u6027\uff0c\u4f60\u5728\u9605\u8bfb\u65f6\u4e5f\u66f4\u5bb9\u6613\u68b3\u7406\u4f60\u5b9e\u73b0\u7684\u6b63\u786e\u6027\u3002</p>"},{"location":"courses/os_lab/L4_vfs.html#43","title":"4.3 \u6587\u4ef6\u7cfb\u7edf\u5b9e\u73b0","text":"<p>\u8fd9\u91cc\u6709\u5f88\u591a\u5fae\u5999\u7684\u5751 (\u751a\u81f3\u6d4b\u8bd5\u7528\u4f8b\u65e0\u6cd5\u5b8c\u6574\u5730\u8986\u76d6\u5230\u5b83\u4eec)\u3002\u4f8b\u5982\uff0c\u5f53\u4f60\u904d\u5386 procfs \u65f6\uff0c\u4f60\u9700\u8981\u904d\u5386\u7cfb\u7edf\u4e2d\u6240\u6709\u7684\u7ebf\u7a0b\uff1b\u800c\u4e0e\u6b64\u540c\u65f6\uff0c\u7ebf\u7a0b\u53ef\u80fd\u88ab\u521b\u5efa/\u56de\u6536\u3002\u4e00\u4e2a\u590d\u6742\u7cfb\u7edf\u7684\u5b9e\u73b0\u5f88\u5bb9\u6613\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4ea7\u751f\u6570\u636e\u7ade\u4e89 (\u51e0\u4e4e\u603b\u662f bug\uff0c\u4f8b\u5982\u4f60\u53ef\u80fd\u4f1a\u8bfb\u53d6\u4e00\u4e2a\u5c1a\u672a\u521d\u59cb\u5316\u597d\u7684\u7ebf\u7a0b) \u6216\u662f\u6b7b\u9501\u3002\u8fd9\u6837\u7684\u95ee\u9898\u5728\u6d4b\u8bd5\u4e2d\u6070\u6070\u662f\u5f88\u96be\u66b4\u9732\u7684\uff1a\u4f60\u5f88\u96be\u4f1a\u60f3\u5230\u6784\u9020\u8fd9\u6837\u7684\u6d4b\u8bd5\u7528\u4f8b\uff0c\u4ee5\u53ca\u5b9e\u9645\u7684\u7cfb\u7edf\u53ef\u80fd\u4f1a\u5728\u66f4 subtle \u7684\u60c5\u51b5\u4e0b\u51fa\u9519\u3002</p> <p>\u6211\u4eec\u65e0\u6cd5\u5b8c\u6574\u5217\u4e3e\u4f60\u6240\u6709\u53ef\u80fd\u9047\u5230\u7684\u5751\u2014\u2014\u4f46\u4f60\u5728\u5b8c\u6210\u5b9e\u9a8c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4f60\u4e00\u5b9a\u4f1a\u611f\u53f9\u505a\u597d\u4e00\u5b9a\u7684\u8bbe\u8ba1\u662f\u591a\u4e48\u91cd\u8981\u3002\u4ee5\u53ca\uff0c\u65e0\u8bba\u4f60\u505a\u4e86\u591a\u5c11\u8bbe\u8ba1\uff0c\u5728\u5b9e\u9645\u4e2d\u90fd\u53ef\u80fd\u9047\u5230\u5947\u5947\u602a\u602a\u7684\u95ee\u9898\uff0c\u4f60\u4e5f\u771f\u6b63\u7406\u89e3\u4e86 lockdep, AddressSanitizer/ThreadSanitizer \u8fd9\u6837\u7684\u5de5\u5177\u5b58\u5728\u7684\u5fc5\u8981\u6027\u3002\u603b\u4e4b\u8fd9\u4e2a \u201c\u7f16\u7a0b\u5927\u5b9e\u9a8c\u201d \u4f1a\u8ba9\u4f60\u771f\u6b63\u4f53\u4f1a\u4e00\u4e9b\u8ba1\u7b97\u673a\u7cfb\u7edf\u8bbe\u8ba1/\u5b9e\u73b0\u7684\u56f0\u96be\u3002Happy hacking!</p>"},{"location":"courses/os_lab/L4_vfs.html#44","title":"4.4 \u798f\u5229","text":"<p>\u6211\u4eec\u4e3a\u5927\u5bb6\u63d0\u4f9b\u4e86 Hard Test \u7c7b\u4f3c\u7684 workload\uff0c\u7528\u4e8e\u521b\u5efa\u4e00\u4e2a\u76ee\u5f55\u6811 (\u5047\u8bbe\u521d\u59cb\u65f6\uff0c\u7ebf\u7a0b\u7684\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e3a <code>/</code>)\u3002\u6587\u4ef6\u5728 vfs-workload.inc\u3002\u5927\u5bb6\u53ef\u4ee5\u76f4\u63a5\u7f16\u5199\u4e00\u4e2a C \u6587\u4ef6\uff0c\u7136\u540e\uff1a</p> <pre><code>void run_fs_test() {\n#include \"vfs-workload.inc\"\n}\n</code></pre> <p>\u6765\u5c06 workload \u76f4\u63a5\u7c98\u8d34\u5230 C \u4ee3\u7801\u4e2d\u3002\u8fd9\u4e5f\u662f\u4f60\u4eec\u751f\u6210\u6d4b\u8bd5\u7528\u4f8b\u7684\u65b9\u6cd5\u2014\u2014\u5982\u679c\u4f60\u4eec\u5b8c\u6210\u4e86\u4e00\u4e2a\u81ea\u52a8\u7684\u968f\u673a\u6d4b\u8bd5\u7528\u4f8b\u751f\u6210\u5de5\u5177\uff0c\u4f60\u53ef\u4ee5\u5c06\u7cfb\u7edf\u8c03\u7528\u7684\u5e8f\u5217\u5199\u5165\u4e00\u4e2a <code>.inc</code> \u6587\u4ef6\u4e2d\uff0c\u7136\u540e\u5b83\u88ab include \u5230\u4ee3\u7801\u4e2d\u6267\u884c\u3002\u5728\u5b9e\u9645\u7684\u6d4b\u8bd5\u4e2d\uff0c\u6211\u4eec\u7684\u76ee\u5f55\u6811\u4f1a\u6bd4\u7ed9\u51fa\u7684 workload.inc \u7a0d\u5927\u4e00\u4e9b\uff0c\u4f46\u4e0d\u4f1a\u5927\u592a\u591a\u3002</p> <p>\u5728\u6267\u884c\u5b8c workload \u4e4b\u540e\uff0c\u6211\u4eec\u4f1a\u9012\u5f52\u5730\u904d\u5386\u76ee\u5f55\uff0c\u5927\u81f4\u7684\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>static void traverse(const char *root) {\n  char *buf = pmm-&gt;alloc(sz); // asserts success\n  struct ufs_stat s;\n\n  int fd = vfs-&gt;open(strcmp(root, \"\") == 0 ? \"/\" : root, O_RDONLY), nread;\n  if (fd &lt; 0) goto release;\n\n  vfs-&gt;fstat(fd, &amp;s);\n  if (s.type == T_DIR) {\n    while ( (nread = vfs-&gt;read(fd, buf, sz)) &gt; 0) {\n      for (int offset = 0;\n           offset +  sizeof(struct ufs_dirent) &lt;= nread;\n           offset += sizeof(struct ufs_dirent)) {\n        struct ufs_dirent *d = (struct ufs_dirent *)(buf + offset);\n        if (d-&gt;name[0] != '.') { // \u5c0f\u5f69\u86cb\uff1a\u4f60\u8fd9\u4e0b\u77e5\u9053\u4e3a\u4ec0\u4e48\n                                 // Linux \u4ee5 \u201c.\u201d \u5f00\u5934\u7684\u6587\u4ef6\u662f\u9690\u85cf\u6587\u4ef6\u4e86\u5427\n          char *fname = pmm-&gt;alloc(MAX_PATH_LEN); // assert success\n          sprintf(fname, \"%s/%s\", root, d-&gt;name);\n          traverse(fname);\n          pmm-&gt;free(fname);\n        }\n      }\n    }\n  }\n\nrelease:\n  if (fd &gt;= 0) vfs-&gt;close(fd);\n  pmm-&gt;free(buf);\n}\n</code></pre> <p>\u6211\u4eec\u4f1a\u8c03\u7528 <code>traverse(\"\");</code> \u5b8c\u6210\u76ee\u5f55\u6811\u7684\u904d\u5386\u3002</p>"},{"location":"courses/os_lab/M1_pstree.html","title":"M1: \u6253\u5370\u8fdb\u7a0b\u6811 (pstree)","text":""},{"location":"courses/os_lab/M1_pstree.html#1","title":"1. \u80cc\u666f","text":"<p>\u56e0\u4e3a\u7a0b\u5e8f\u53ef\u4ee5\u770b\u6210\u72b6\u6001\u673a\uff0c\u64cd\u4f5c\u7cfb\u7edf\u80fd \u201c\u540c\u65f6\u8fd0\u884c\u591a\u4e2a\u7a0b\u5e8f\u201d \u7684\u80fd\u529b\u5c31\u662f\u72b6\u6001\u673a\u7ba1\u7406\u7684\u80fd\u529b\u3002\u81ea\u7136\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4e5f\u5e94\u8be5\u63d0\u4f9b \u201c\u76d1\u6d4b\u72b6\u6001\u673a\u72b6\u6001\u201d \u7684\u529f\u80fd\uff0c\u4f8b\u5982\u663e\u793a\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u5404\u4e2a\u7a0b\u5e8f (\u8fdb\u7a0b\u3001\u72b6\u6001\u673a) \u7684\u6d3b\u8dc3\u7a0b\u5ea6\u3002</p> <p>UNIX \u91c7\u7528\u4e86 Everything is a File \u7684\u8bbe\u8ba1\uff0c\u628a\u64cd\u4f5c\u7cfb\u7edf\u7684\u72b6\u6001\u53d8\u6210\u6587\u4ef6\u7cfb\u7edf\u7684\u4e00\u90e8\u5206\uff1a</p> <ul> <li>\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u4e0d\u65ad\u66f4\u65b0\u4e00\u4e2a\u5bf9\u8c61 (\u6587\u672c\u6587\u4ef6) \u7684\u5185\u5bb9\uff0c\u8fd9\u6837\u5e94\u7528\u7a0b\u5e8f\u5c31\u80fd\u7528\u6587\u4ef6 API (open, read, close) \u6765\u83b7\u53d6\u8fdb\u7a0b\u5217\u8868\uff1b</li> </ul>"},{"location":"courses/os_lab/M1_pstree.html#2","title":"2. \u5b9e\u9a8c\u63cf\u8ff0","text":"<p>\u5b9e\u9a8c\u8981\u6c42\uff1a\u5b9e\u73b0 <code>pstree</code> \u6253\u5370\u8fdb\u7a0b\u4e4b\u95f4\u7684\u6811\u72b6\u7684\u7236\u5b50\u5173\u7cfb</p> <p>Linux \u7cfb\u7edf\u4e2d\u53ef\u4ee5\u540c\u65f6\u8fd0\u884c\u591a\u4e2a\u7a0b\u5e8f\u3002\u8fd0\u884c\u7684\u7a0b\u5e8f\u79f0\u4e3a\u8fdb\u7a0b\u3002\u9664\u4e86\u6240\u6709\u8fdb\u7a0b\u7684\u6839\u4e4b\u5916\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u5b83\u552f\u4e00\u7684\u7236\u8fdb\u7a0b\uff0c\u4f60\u7684\u4efb\u52a1\u5c31\u662f\u628a\u8fd9\u68f5\u6811\u5728\u547d\u4ee4\u884c\u4e2d\u8f93\u51fa\u3002\u4f60\u53ef\u4ee5\u81ea\u7531\u9009\u62e9\u5c55\u793a\u6811\u7684\u65b9\u5f0f (\u4f8b\u5982\u4f7f\u7528\u7f29\u8fdb\u8868\u793a\u7236\u5b50\u5173\u7cfb\uff0c\u8fd9\u662f\u6700\u5bb9\u6613\u7684)\u3002</p> <p>Linux \u7cfb\u7edf\u81ea\u5e26\u4e86 <code>pstree</code> \u547d\u4ee4\uff0c\u8fdb\u7a0b\u6811\u4f1a\u4ee5\u975e\u5e38\u6f02\u4eae\u7684\u683c\u5f0f\u6392\u7248 (\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u7b2c\u4e00\u4e2a\u5b69\u5b50\u90fd\u4e0e\u5b83\u5904\u5728\u540c\u4e00\u884c\uff0c\u4e4b\u540e\u7684\u5b69\u5b50\u4fdd\u6301\u76f8\u540c\u7684\u7f29\u8fdb)\uff1a</p> <pre><code>systemd\u2500\u252c\u2500accounts-daemon\u2500\u252c\u2500{gdbus}\n        \u2502                 \u2514\u2500{gmain}\n        \u251c\u2500acpid\n        \u251c\u2500agetty\n        \u251c\u2500atd\n        \u251c\u2500cron\n        \u251c\u2500dbus-daemon\n        \u251c\u2500dhclient\n        \u251c\u25002*[iscsid]\n        \u251c\u2500lvmetad\n        \u251c\u2500lxcfs\u2500\u2500\u250010*[{lxcfs}]\n        \u251c\u2500mdadm\n        \u251c\u2500polkitd\u2500\u252c\u2500{gdbus}\n        \u2502         \u2514\u2500{gmain}\n        \u251c\u2500rsyslogd\u2500\u252c\u2500{in:imklog}\n        \u2502          \u251c\u2500{in:imuxsock}\n        \u2502          \u2514\u2500{rs:main Q:Reg}\n        ...\n</code></pre>"},{"location":"courses/os_lab/M1_pstree.html#21","title":"2.1 \u603b\u89c8","text":"<p>\u63d0\u4f9b\u7684\u547d\u4ee4\u5f62\u5f0f\u5982\u4e0b\uff1a<code>pstree [OPTION]\u2026</code></p> <p>\u628a\u7cfb\u7edf\u4e2d\u7684\u8fdb\u7a0b\u6309\u7167\u7236\u4eb2-\u5b69\u5b50\u7684\u6811\u72b6\u7ed3\u6784\u6253\u5370\u5230\u7ec8\u7aef\u3002</p> <ul> <li><code>-p</code> \u6216 <code>--show-pids</code>: \u6253\u5370\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7\u3002</li> <li><code>-n</code> \u6216 <code>--numeric-sort</code>: \u6309\u7167pid\u7684\u6570\u503c\u4ece\u5c0f\u5230\u5927\u987a\u5e8f\u8f93\u51fa\u4e00\u4e2a\u8fdb\u7a0b\u7684\u76f4\u63a5\u5b69\u5b50\u3002</li> <li><code>-V</code> \u6216 <code>--version</code>: \u6253\u5370\u7248\u672c\u4fe1\u606f\u3002</li> </ul> <p>\u4f60\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u4e2d\u89c2\u5bdf\u7cfb\u7edf\u7684 <code>pstree</code> \u7684\u6267\u884c\u884c\u4e3a (\u5982\u6267\u884c <code>pstree -V</code>\u3001<code>pstree --show-pids</code> \u7b49)\u3002\u8fd9\u4e9b\u53c2\u6570\u53ef\u80fd\u4efb\u610f\u7ec4\u5408\uff0c\u4f46\u4f60\u4e0d\u9700\u8981\u5904\u7406\u5355\u5b57\u6bcd\u53c2\u6570\u5408\u5e76\u7684\u60c5\u51b5\uff0c\u4f8b\u5982 <code>-np</code>\u3002</p>"},{"location":"courses/os_lab/M1_pstree.html#3","title":"3. \u6b63\u786e\u6027\u6807\u51c6","text":"<p>\u53ef\u4ee5\u4efb\u610f\u9009\u62e9\u6811\u7684\u5f62\u6001\uff0c\u4ee5\u4e0b\u8f93\u51fa\u90fd\u662f\u5408\u6cd5\u7684\uff1a</p> <pre><code>$ ./pstree-64\nsystemd\u2500\u252c\u2500accounts-daemon\u2500\u252c\u2500\n        \u2502\n        ...\n\n$ ./pstree-64\nsystemd\n |\n +--accounts-daemon-\n |\n ...\n\n$ ./pstree-64\nsystemd\n  accounts-daemon\n    ...\n</code></pre> <p>\u53ea\u8981\u8f93\u51fa\u7cfb\u7edf\u4e2d\u7684\u8fdb\u7a0b\u5373\u53ef\uff1b\u6b64\u5916\uff0c\u5141\u8bb8\u8fdb\u7a0b\u5217\u8868\u6709\u8f7b\u5fae\u51fa\u5165\u3002</p>"},{"location":"courses/os_lab/M1_pstree.html#31","title":"3.1 \u6ce8\u610f\u4e8b\u9879","text":"<p>\u8bd5\u4e00\u8bd5 <code>pstree -V &gt; /dev/null</code>\uff0c\u4f60\u4f1a\u53d1\u73b0\u8f93\u51fa\u5e76\u6ca1\u6709\u5230 <code>/dev/null</code>\u3002\u6211\u4eec\u5e0c\u671b\u4f60\u7684\u884c\u4e3a\u548c\u7cfb\u7edf\u4e2d\u7684 <code>pstree -V</code> \u57fa\u672c\u4e00\u81f4\uff1a\u8f93\u51fa\u5230\u6b63\u786e\u7684\u8f93\u51fa\u6d41\u3001\u5305\u542b <code>pstree</code> \u7684\u57fa\u672c\u4fe1\u606f\uff0c\u4f46\u7248\u672c\u63cf\u8ff0\u53ef\u4ee5\u4e0d\u540c\u3002</p> <ul> <li><code>pstree -V</code>\u662f\u5c06\u4fe1\u606f\u8f93\u51fa\u5230\u9519\u8bef\u6d41\uff08\u6587\u4ef6\u63cf\u8ff0\u7b262\uff09\uff0c\u800c\u4e0d\u662f\u8f93\u51fa\u6d41\uff08\u6587\u4ef6\u63cf\u8ff0\u7b261\uff09\uff1b</li> </ul>"},{"location":"courses/os_lab/M1_pstree.html#4","title":"4. \u5b9e\u9a8c\u6307\u5357","text":"<p>\u6253\u5370\u8fdb\u7a0b\u6811\u7684\u95ee\u9898\u5206\u89e3\uff1a</p> <ul> <li>\u5f97\u5230\u547d\u4ee4\u884c\u7684\u53c2\u6570\uff0c\u6839\u636e\u8981\u6c42\u8bbe\u7f6e\u6807\u5fd7\u53d8\u91cf\u7684\u6570\u503c\uff1b</li> <li>\u5f97\u5230\u7cfb\u7edf\u4e2d\u6240\u6709\u8fdb\u7a0b\u7684\u7f16\u53f7 (\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u4f1a\u6709\u552f\u4e00\u7684\u7f16\u53f7) \u4fdd\u5b58\u5230\u5217\u8868\u91cc\uff1b</li> <li>\u5bf9\u5217\u8868\u91cc\u7684\u6bcf\u4e2a\u7f16\u53f7\uff0c\u5f97\u5230\u5b83\u7684\u7684\u7236\u4eb2\u662f\u8c01\uff1b</li> <li>\u5728\u5185\u5b58\u4e2d\u628a\u6811\u5efa\u597d\uff0c\u6309\u547d\u4ee4\u884c\u53c2\u6570\u8981\u6c42\u6392\u5e8f\uff1b</li> <li>\u628a\u6811\u6253\u5370\u5230\u7ec8\u7aef\u4e0a\u3002</li> </ul>"},{"location":"courses/os_lab/M1_pstree.html#41","title":"4.1 \u547d\u4ee4\u884c\u53c2\u6570","text":"<p><code>main</code>\u51fd\u6570\u7684\u7b7e\u540d\u5305\u542b\u4e86\u547d\u4ee4\u884c\u7684\u53c2\u6570\uff1a <code>./a.out hello world</code></p> <ul> <li><code>argv[0]</code> \u662f\u53ef\u6267\u884c\u6587\u4ef6\u540d \"./a.out\"\uff0c\u540e\u9762\u8ddf\u7684\u662f\u53c2\u6570\uff08\u7a7a\u767d\u7b26\u4f5c\u4e3a\u5206\u9694\u7b26\uff09\uff1b</li> </ul> <pre><code>int main(int argc, char *argv[])\n</code></pre> <ul> <li><code>getopt(man 3 getopt)</code>\u5e93\u53ef\u4ee5\u5904\u7406\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u81ea\u5df1\u89e3\u6790\uff1b</li> </ul>"},{"location":"courses/os_lab/M1_pstree.html#42","title":"4.2 \u83b7\u53d6\u6240\u6709\u7684\u8fdb\u7a0b","text":"<p>ps \u547d\u4ee4\u4e5f\u662f\u901a\u8fc7 procfs \u5b9e\u73b0\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>strace ps</code>\u67e5\u770b\u7cfb\u7edf\u8c03\u7528\u8bc1\u660e\u3002</p> <ul> <li><code>openat(AT_FDCWD, \"/proc/1/stat\", O_RDONLY)</code></li> </ul> <p>Linux \u63d0\u4f9b\u4e86 procfs\uff0c\u76ee\u5f55\u662f <code>/proc</code>\u3002</p> <ul> <li>\u4ee5\u6570\u5b57\u547d\u540d\u7684\u76ee\u5f55\uff0c\u6bcf\u4e2a\u76ee\u5f55\u7684\u540d\u5b57\u5c31\u662f\u8fdb\u7a0b\u53f7\uff0c\u76ee\u5f55\u91cc\u5b58\u50a8\u4e86\u8fdb\u7a0b\u76f8\u5173\u7684\u8fd0\u884c\u65f6\u6570\u636e\u3002</li> <li><code>/proc/[pid]/stat</code> \u6587\u4ef6\u4e2d\u5305\u542b\u4e86\u5176\u7236\u8fdb\u7a0b\u7684 pid\uff1b</li> </ul>"},{"location":"courses/os_lab/M1_pstree.html#43","title":"4.3 \u5efa\u6811\u548c\u6253\u5370","text":"<p>\u8bd5\u7740\u5b9a\u4e49\u4e00\u4e2a\u9012\u5f52\u51fd\u6570\\(f(T)=[s_1,s_2,\u2026,s_n]\\)\u628a \\(T\\)\u6253\u5370\u6210\u591a\u884c\u6587\u672c (\u7b2c \\(i\\)\u884c\u662f\u5b57\u7b26\u4e32 \\(s_i\\))\u3002</p> <ol> <li>\u5bf9\u4e8e\u53f6\u5b50\u8282\u70b9\uff0c\u76f4\u63a5\u8f93\u51fa\u4e00\u4e2a\u683c\u5f0f\u5316\u5b57\u7b26\u4e32 (\u4f8b\u5982\u4f7f\u7528 <code>asprintf</code>)\uff1b</li> <li>\u5982\u679c\u4e0d\u662f\u53f6\u5b50\u8282\u70b9\uff0c\u5bf9\u5b83\u6240\u6709\u5b50\u6811\\(T_1,T_2,...,T_k\\) \u5206\u522b\u6c42\\(f_i(T_i)\\)\uff0c\u5f97\u5230 \\(k\\) \u4e2a\u591a\u884c\u7684\u6587\u672c\uff1b</li> <li>\u628a\u8fd9\u4e9b\u5b57\u7b26\u4e32\u62fc\u5230\u9002\u5f53\u7684\u4f4d\u7f6e\uff0c\u52a0\u4e0a\u4e00\u4e9b\u8fde\u63a5\u7ebf\uff1a</li> </ol> <pre><code>(root)\u2500+\u2500T1(line 1)\n       | T1(line 2)\n       | T1(line 3)\n       +\u2500T2(1)\n       |\n...\n</code></pre> <p>\u7136\u540e\u4f60\u4f1a\u53d1\u73b0\u4f60\u5e76\u4e0d\u9700\u8981\u771f\u7684\u5b9e\u73b0 \\(f(T)\\)\uff0c\u800c\u662f\u4e00\u904d\u9012\u5f52\u4e00\u8fb9\u6253\u5370\u5c31\u884c\u3002</p>"},{"location":"courses/os_lab/M1_pstree.html#44","title":"4.4 \u7f16\u8bd1","text":"<p>\u6bd4\u8f83\u5e38\u89c1\u7684\u9879\u76ee\u7ec4\u7ec7\u662f\u7f16\u5199 Makefile\uff0c\u5728\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528 <code>make</code> \u5b9e\u73b0\u7f16\u8bd1\uff0c<code>make test</code> \u5b8c\u6210\u6d4b\u8bd5\u3002</p>"},{"location":"courses/os_lab/M1_pstree.html#45","title":"4.5 \u6d4b\u8bd5","text":"<ol> <li>\u7a0b\u5e8f\u591f roubust \u5417\uff1f\u5b83\u4f1a\u4e0d\u4f1a\u5728\u4e00\u4e9b\u975e\u6cd5\u7684\u8f93\u5165\u4e0a crash\uff1f\u5982\u679c\u7cfb\u7edf\u91cc\u7684\u8fdb\u7a0b\u5f88\u591a\u5462\uff1f\u5982\u679c\u5185\u5b58\u4e0d\u591f\u4e86\u5462\uff1f\u5982\u679c <code>open</code> \u6216\u8005 <code>malloc</code> \u5931\u8d25\u4e86\u5462\uff1f\u8981\u77e5\u9053\uff0ccrash \u4e00\u822c\u662f\u56e0\u4e3a undefined behavior (UB) \u5bfc\u81f4\u7684\u2014\u2014UB \u6ca1\u628a\u6240\u6709\u7684\u6587\u4ef6\u90fd\u5220\u6389\u771f\u662f\u8c22\u5929\u8c22\u5730\u4e86\u3002</li> <li>\u4e07\u4e00\u6211\u5f97\u5230\u8fdb\u7a0b\u53f7\u4ee5\u540e\uff0c\u8fdb\u53bb\u53d1\u73b0\u6587\u4ef6\u6ca1\u4e86 (\u8fdb\u7a0b\u7ec8\u6b62\u4e86)\uff0c\u600e\u4e48\u529e\uff1f\u4f1a\u4e0d\u4f1a\u6709\u8fd9\u79cd\u60c5\u51b5\uff1f\u4e07\u4e00\u6709\u6211\u7684\u7a0b\u5e8f\u4f1a\u4e0d\u4f1a crash\u2026\u2026\uff1f</li> <li>\u8fdb\u7a0b\u7684\u4fe1\u606f\u4e00\u76f4\u5728\u53d8\uff0c\u6587\u4ef6\u7684\u5185\u5bb9\u4e5f\u4e00\u76f4\u5728\u53d8 (\u4e24\u6b21 <code>cat</code> \u7684\u7ed3\u679c\u4e0d\u540c)\u3002\u90a3\u6211\u4f1a\u4e0d\u4f1a\u8bfb\u5230\u4e0d\u4e00\u81f4\u7684\u4fe1\u606f(\u524d\u4e00\u534a\u662f\u65e7\u4fe1\u606f\u3001\u65b0\u4e00\u534a\u662f\u65b0\u4fe1\u606f)\uff1f</li> <li>\u5982\u679c\u6211\u4e0d\u786e\u4fe1\u8fd9\u4e9b\u4e8b\u4f1a\u4e0d\u4f1a\u53d1\u751f\uff0c\u6211\u6709\u6ca1\u6709\u5199\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u81f3\u5c11\u5728\u538b\u529b\u73af\u5883\u4e0b\u6d4b\u8bd5\u4e00\u4e0b\u5b83\u4eec\u6709\u6ca1\u6709\u53ef\u80fd\u53d1\u751f\uff1f\u55ef\uff0c\u5982\u679c\u6211\u540c\u65f6\u8fd0\u884c\u5f88\u591a\u7a0b\u5e8f\uff0c\u6bcf\u4e2a\u7a0b\u5e8f\u90fd\u4e0d\u65ad\u626b\u63cf\u76ee\u5f55\u3001\u8bfb\u53d6\u6587\u4ef6\uff0c\u4e5f\u89c2\u5bdf\u4e0d\u5230\u8fd9\u4e2a\u95ee\u9898\uff0c\u81f3\u5c11\u5e94\u8be5\u53ef\u4ee5\u653e\u70b9\u5fc3\u3002</li> </ol>"},{"location":"courses/os_lab/M2_libco.html","title":"M2: \u534f\u7a0b\u5e93 (libco)","text":""},{"location":"courses/os_lab/M2_libco.html#1","title":"1. \u80cc\u666f","text":"<p>\u8bbe\u60f3\u6211\u4eec\u5b9e\u73b0\u4e86\u4e00\u4e2a SimpleC \u7684\u89e3\u91ca\u5668 (\u53c2\u8003\u4e0a\u8bfe\u65f6\u7684\u975e\u9012\u5f52\u6c49\u8bfa\u5854)\uff0c\u53ef\u4ee5\u770b\u6210 \u201c\u5355\u6b65\u6267\u884c\u8bed\u53e5\u201d \u7684\u72b6\u6001\u673a\uff1a</p> <pre><code>struct State {\n    stack&lt;Frame&gt; frames;\n    char *shared_memory;\n\n    void next() {\n        exec(frames.top().pc, shared_memory);\n    }\n};\n</code></pre> <p>\u800c\u5176\u4e2d\u6bcf\u4e00\u4e2a next \u90fd\u662f \u201c\u4e00\u5c0f\u6b65\u201d\uff0c\u9664\u4e86\u7cfb\u7edf\u8c03\u7528\u4e4b\u5916\uff0c\u90fd\u53ef\u4ee5\u5f88\u5feb\u8fd4\u56de\uff0c\u90a3\u4e48\u6211\u4eec\u628a SimpleC \u7684\u89e3\u91ca\u5668\u6539\u9020\u4e00\u4e0b\uff0c\u4e0d\u5c31\u53ef\u4ee5\u5b9e\u73b0\uff0c\u7528\u4e00\u4e2a\u7ebf\u7a0b\u6a21\u62df \u201c\u4e24\u4e2a\u7ebf\u7a0b\u201d \u6267\u884c\u4e86\u5417\uff1a</p> <pre><code>struct State {\n    stack&lt;Frame&gt; t1, t2;\n    char *shared_memory;\n\n    void next() {\n        auto frames_chosen = random_choice({t1, t2});\n        exec(frames_chosen.top().pc, shared_memory);\n    }\n};\n</code></pre> <p>\u90a3\u4e48\uff0c\u6211\u4eec\u80fd\u4e0d\u80fd\u66f4\u8fdb\u4e00\u6b65\uff0c\u5728\u4e00\u4e2a\u7ebf\u7a0b\u91cc\u901a\u8fc7 malloc \u521b\u5efa\u82e5\u5e72\u4efd\u5806\u6808\uff0c\u7136\u540e\u5728\u591a\u4e2a\u7ebf\u7a0b\u4e4b\u95f4\u4e3b\u52a8\u5730\u5207\u6362\u5462\uff1f\u6709\u4e9b\u8bed\u8a00\u7684\u786e\u5141\u8bb8\u6211\u4eec\u8fd9\u4e48\u505a\uff0c\u4f8b\u5982\u6211\u4eec\u7684 \u201c\u64cd\u4f5c\u7cfb\u7edf\u201d \u6a21\u578b\uff1a</p> <p>\u64cd\u4f5c\u7cfb\u7edf\u6a21\u578b\uff1a\u6211\u4eec\u5b9e\u73b0\u4e00\u4e2a \u201c\u6a21\u62df\u201d \u7684\u3001\u80fd\u591f\u652f\u6301\u5355\u4e2a\u5e94\u7528\u7a0b\u5e8f\u6267\u884c (\u63d0\u4f9b read, write, spawn \u4e09\u4e2a \u201c\u6781\u7b80\u201c \u7cfb\u7edf\u8c03\u7528) \u7684\u64cd\u4f5c\u7cfb\u7edf\u6a21\u578b\uff0c\u5e2e\u52a9\u7406\u89e3\u64cd\u64cd\u4f5c\u7cfb\u7edf\u7684\u5de5\u4f5c\u539f\u7406\u3002\u628a\u5f85\u8fd0\u884c\u7684\u7a0b\u5e8f (hello.py, proc.py \u7b49) \u60f3\u8c61\u6210\u72b6\u6001\u673a\u3001\u64cd\u4f5c\u7cfb\u7edf\u60f3\u8c61\u6210\u72b6\u6001\u673a\u7684\u7ba1\u7406\u8005\uff0c\u5c31\u4e0d\u96be\u7406\u89e3\u64cd\u4f5c\u7cfb\u7edf\u662f\u4ec0\u4e48\u4e86\u3002</p> <p>\u4f8b\u5982\u6211\u4eec\u7684\u64cd\u4f5c\u7cfb\u7edf\u6a21\u578b\u5b9e\u73b0\u501f\u52a9\u4e86 generator object\uff1a</p> <pre><code>def positive_integers():\n    i = 0\n    while i := i + 1:  # \u6b7b\u5faa\u73af\n        yield i  # \"return\" i\uff0c\u4f46\u4e4b\u540e\u7a0b\u5e8f\u53ef\u4ee5\u4ece\u8fd9\u91cc\u5f00\u59cb\u7ee7\u7eed\u6267\u884c\n\ndef is_prime(i):\n    return i &gt;= 2 and \\\n        not any(i % j == 0 for j in range(2, i))\n\n# \u6240\u6709\u7d20\u6570\u7684\u987a\u5e8f\u96c6\u5408\uff1b\u6ce8\u610f\u5176\u4e2d\u7684 positive_integers \u662f \u201c\u6b7b\u5faa\u73af\u201d\nprimes = (i for i in positive_integers() if is_prime(i))\n</code></pre> <p>\u8c03\u7528 generator function \u4f1a\u521b\u5efa\u4e00\u4e2a\u95ed\u5305 (closure)\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u9677\u5165\u6b7b\u5faa\u73af\uff1a</p> <pre><code>&gt;&gt;&gt; positive_integers()\n&lt;generator object positive_integers at 0x10e4d01c0&gt;\n&gt;&gt;&gt; primes\n&lt;generator object &lt;genexpr&gt; at 0x10e4bcc80&gt;\n</code></pre> <p>\u95ed\u5305\u7684\u5185\u90e8\u4f1a\u5b58\u50a8\u6240\u6709\u5c40\u90e8\u53d8\u91cf\u548c PC\uff0c\u9047\u5230 yield \u65f6\u6267\u884c\u6d41\u8fd4\u56de\uff0c\u4f46\u95ed\u5305\u4ecd\u7136\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528\uff0c\u5c31\u597d\u50cf <code>stack&lt;Frame&gt;</code> \u8fd8\u88ab\u4fdd\u7559\u4e0b\u6765\uff0c\u968f\u65f6\u53ef\u4ee5\u7ee7\u7eed\u6267\u884c\u3002</p>"},{"location":"courses/os_lab/M2_libco.html#2","title":"2. \u5b9e\u9a8c\u63cf\u8ff0","text":"<p>\ud83d\uddd2\ufe0f\u5b9e\u9a8c\u8981\u6c42\uff1a\u4f7f\u7528\u4e00\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u7ebf\u7a0b\u5b9e\u73b0\u4e3b\u52a8\u5207\u6362\u7684\u591a\u4e2a\u6267\u884c\u6d41</p> <p>\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u6211\u4eec\u5b9e\u73b0\u8f7b\u91cf\u7ea7\u7684\u7528\u6237\u6001\u534f\u7a0b](https://en.wikipedia.org/wiki/Coroutine) (coroutine\uff0c\u201c\u534f\u540c\u7a0b\u5e8f\u201d)\uff0c\u4e5f\u79f0\u4e3a green threads\u3001user-level threads\uff0c\u53ef\u4ee5\u5728\u4e00\u4e2a\u4e0d\u652f\u6301\u7ebf\u7a0b\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u5b9e\u73b0\u5171\u4eab\u5185\u5b58\u591a\u4efb\u52a1\u5e76\u53d1\u3002\u5373\u6211\u4eec\u5e0c\u671b\u5b9e\u73b0 C \u8bed\u8a00\u7684 \u201c\u51fd\u6570\u201d\uff0c\u5b83\u80fd\u591f\uff1a</p> <ul> <li>\u88ab <code>co_start()</code> \u8c03\u7528\uff0c\u4ece\u5934\u5f00\u59cb\u8fd0\u884c\uff1b</li> <li>\u5728\u8fd0\u884c\u5230\u4e2d\u9014\u65f6\uff0c\u8c03\u7528 <code>co_yield()</code> \u88ab \u201c\u5207\u6362\u201d \u51fa\u53bb\uff1b</li> <li>\u7a0d\u540e\u6709\u5176\u4ed6\u534f\u7a0b\u8c03\u7528 <code>co_yield()</code> \u540e\uff0c\u9009\u62e9\u4e00\u4e2a\u5148\u524d\u88ab\u5207\u6362\u7684\u534f\u7a0b\u7ee7\u7eed\u6267\u884c\u3002</li> </ul> <p>\u534f\u7a0b\u8fd9\u4e00\u6982\u5ff5\u6700\u65e9\u51fa\u73b0\u5728 Melvin Conway 1963 \u5e74\u7684\u8bba\u6587 \"Design of a separable transition-diagram compiler\"\uff0c\u5b83\u5b9e\u73b0\u4e86 \u201c\u53ef\u4ee5\u6682\u505c\u548c\u6062\u590d\u6267\u884c\u201d \u7684\u51fd\u6570\u3002</p>"},{"location":"courses/os_lab/M2_libco.html#21-coroutine-apis","title":"2.1 Coroutine APIs","text":"<p>\u5b9e\u73b0\u534f\u7a0b\u5e93 <code>co.h</code> \u4e2d\u5b9a\u4e49\u7684 API\uff1a</p> <pre><code>struct co *co_start(const char *name, void (*func)(void *), void *arg);\nvoid       co_yield();\nvoid       co_wait(struct co *co);\n</code></pre> <p>\u534f\u7a0b\u5e93\u7684\u4f7f\u7528\u548c\u7ebf\u7a0b\u5e93\u975e\u5e38\u7c7b\u4f3c\uff1a</p> <ol> <li><code>co_start(name, func, arg)</code>\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u534f\u7a0b\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u6307\u5411<code>struct co</code></li> </ol> <p>\u7684\u6307\u9488 (\u7c7b\u4f3c\u4e8e<code>pthread_create</code>)\u3002</p> <ul> <li>\u65b0\u521b\u5efa\u7684\u534f\u7a0b\u4ece\u51fd\u6570 <code>func</code> \u5f00\u59cb\u6267\u884c\uff0c\u5e76\u4f20\u5165\u53c2\u6570 <code>arg</code>\u3002\u65b0\u521b\u5efa\u7684\u534f\u7a0b\u4e0d\u4f1a\u7acb\u5373\u6267\u884c\uff0c\u800c\u662f\u8c03\u7528 <code>co_start</code> \u7684\u534f\u7a0b\u7ee7\u7eed\u6267\u884c\u3002</li> <li>\u4f7f\u7528\u534f\u7a0b\u7684\u5e94\u7528\u7a0b\u5e8f\u4e0d\u9700\u8981\u77e5\u9053 <code>struct co</code> \u7684\u5177\u4f53\u5b9a\u4e49\uff0c\u56e0\u6b64\u8bf7\u628a\u8fd9\u4e2a\u5b9a\u4e49\u7559\u5728 <code>co.c</code> \u4e2d\uff1b\u6846\u67b6\u4ee3\u7801\u4e2d\u5e76\u6ca1\u6709\u9650\u5b9a <code>struct co</code> \u7ed3\u6784\u4f53\u7684\u8bbe\u8ba1\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u81ea\u7531\u53d1\u6325\u3002</li> <li> <p><code>co_start</code> \u8fd4\u56de\u7684 <code>struct co</code> \u6307\u9488\u9700\u8981\u5206\u914d\u5185\u5b58\u3002\u6211\u4eec\u63a8\u8350\u4f7f\u7528 <code>malloc()</code> \u5206\u914d\u3002</p> </li> <li> <p><code>co_wait(co)</code>\u8868\u793a\u5f53\u524d\u534f\u7a0b\u9700\u8981\u7b49\u5f85\uff0c\u76f4\u5230<code>co</code>\u534f\u7a0b\u7684\u6267\u884c\u5b8c\u6210\u624d\u80fd\u7ee7\u7eed\u6267\u884c (\u7c7b\u4f3c\u4e8e<code>pthread_join</code>)\u3002</p> </li> <li> <p>\u5728\u88ab\u7b49\u5f85\u7684\u534f\u7a0b\u7ed3\u675f\u540e\u3001 <code>co_wait()</code> \u8fd4\u56de\u524d\uff0c<code>co_start</code> \u5206\u914d\u7684 <code>struct co</code> \u9700\u8981\u88ab\u91ca\u653e\u3002\u5982\u679c\u4f60\u4f7f\u7528 <code>malloc()</code>\uff0c\u4f7f\u7528 <code>free()</code> \u91ca\u653e\u5373\u53ef\u3002</p> </li> <li> <p>\u56e0\u6b64\uff0c\u6bcf\u4e2a\u534f\u7a0b\u53ea\u80fd\u88ab <code>co_wait</code> \u4e00\u6b21 (\u4f7f\u7528\u534f\u7a0b\u5e93\u7684\u7a0b\u5e8f\u5e94\u5f53\u4fdd\u8bc1\u9664\u4e86\u521d\u59cb\u534f\u7a0b\u5916\uff0c\u5176\u4ed6\u534f\u7a0b\u90fd\u5fc5\u987b\u88ab <code>co_wait</code> \u6070\u597d\u4e00\u6b21\uff0c\u5426\u5219\u4f1a\u9020\u6210\u5185\u5b58\u6cc4\u6f0f)\u3002</p> </li> <li> <p><code>co_yield()</code> \u5b9e\u73b0\u534f\u7a0b\u7684\u5207\u6362\u3002\u534f\u7a0b\u8fd0\u884c\u540e\u4e00\u76f4\u5728 CPU \u4e0a\u6267\u884c\uff0c\u76f4\u5230 <code>func</code> \u51fd\u6570\u8fd4\u56de\u6216\u8c03\u7528 <code>co_yield</code> \u4f7f\u5f53\u524d\u8fd0\u884c\u7684\u534f\u7a0b\u6682\u65f6\u653e\u5f03\u6267\u884c\u3002<code>co_yield</code> \u65f6\u82e5\u7cfb\u7edf\u4e2d\u6709\u591a\u4e2a\u53ef\u8fd0\u884c\u7684\u534f\u7a0b\u65f6 (\u5305\u62ec\u5f53\u524d\u534f\u7a0b)\uff0c\u4f60\u5e94\u5f53\u968f\u673a\u9009\u62e9\u4e0b\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u53ef\u8fd0\u884c\u7684\u534f\u7a0b\u3002</p> </li> <li> <p><code>main</code> \u51fd\u6570\u7684\u6267\u884c\u4e5f\u662f\u4e00\u4e2a\u534f\u7a0b\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728 <code>main</code> \u4e2d\u8c03\u7528 <code>co_yield</code> \u6216 <code>co_wait</code>\u3002<code>main</code> \u51fd\u6570\u8fd4\u56de\u540e\uff0c\u65e0\u8bba\u6709\u591a\u5c11\u534f\u7a0b\uff0c\u8fdb\u7a0b\u90fd\u5c06\u76f4\u63a5\u7ec8\u6b62\u3002</p> </li> </ul>"},{"location":"courses/os_lab/M2_libco.html#22","title":"2.2 \u4f7f\u7528\u534f\u7a0b\u5e93","text":"<p>\u4e0b\u9762\u662f\u534f\u7a0b\u5e93\u4f7f\u7528\u7684\u4e00\u4e2a\u4f8b\u5b50\uff0c\u521b\u5efa\u4e24\u4e2a (\u6c38\u4e0d\u7ed3\u675f\u7684) \u534f\u7a0b\uff0c\u5206\u522b\u6253\u5370 <code>a</code> \u548c <code>b</code>\u3002\u7531\u4e8e <code>co_yield()</code> \u4e4b\u540e\u5207\u6362\u5230\u7684\u534f\u7a0b\u662f\u968f\u673a\u7684 (\u53ef\u80fd\u5207\u6362\u5230\u5b83\u81ea\u5df1)\uff0c\u56e0\u6b64\u4f60\u5c06\u4f1a\u770b\u5230\u968f\u673a\u7684 <code>ab</code> \u4ea4\u66ff\u51fa\u73b0\u7684\u5e8f\u5217\uff0c\u4f8b\u5982 <code>ababbabaaaabbaa...</code></p> <pre><code>#include &lt;stdio.h&gt;\n#include \"co.h\"\n\nvoid entry(void *arg) {\n    while (1) {\n        printf(\"%s\", (const char *)arg);\n        co_yield();\n    }\n}\n\nint main() {\n    struct co *co1 = co_start(\"co1\", entry, \"a\");\n    struct co *co2 = co_start(\"co2\", entry, \"b\");\n    co_wait(co1); // never returns\n    co_wait(co2);\n}\n</code></pre> <p>\u5f53\u7136\uff0c\u534f\u7a0b\u6709\u53ef\u80fd\u4f1a\u8fd4\u56de\uff0c\u4f8b\u5982\u5728\u4e0b\u9762\u7684\u4f8b\u5b50 (\u6d4b\u8bd5\u7a0b\u5e8f) \u4e2d\uff0c\u4e24\u4e2a\u534f\u7a0b\u4f1a\u4ea4\u66ff\u6267\u884c\uff0c\u5171\u4eab <code>counter</code> \u53d8\u91cf\uff1a</p> <pre><code>#include &lt;stdio.h&gt;\n#include \"co.h\"\n\nint count = 1; // \u534f\u7a0b\u4e4b\u95f4\u5171\u4eab\n\nvoid entry(void *arg) {\n    for (int i = 0; i &lt; 5; i++) {\n        printf(\"%s[%d] \", (const char *)arg, count++);\n        co_yield();\n    }\n}\n\nint main() {\n    struct co *co1 = co_start(\"co1\", entry, \"a\");\n    struct co *co2 = co_start(\"co2\", entry, \"b\");\n    co_wait(co1);\n    co_wait(co2);\n    printf(\"Done\\n\");\n}\n</code></pre> <p>\u6b63\u786e\u7684\u534f\u7a0b\u5b9e\u73b0\u5e94\u8be5\u8f93\u51fa\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u7684\u7ed3\u679c\uff1a\u5b57\u6bcd\u662f\u968f\u673a\u7684 (<code>a</code> \u6216 <code>b</code>)\uff0c\u6570\u5b57\u5219\u4ece <code>1</code> \u5230 <code>10</code> \u9012\u589e\u3002</p> <pre><code>b[1] a[2] b[3] b[4] a[5] b[6] b[7] a[8] a[9] a[10] Done\n</code></pre> <p>\u4ece \u201c\u7a0b\u5e8f\u662f\u72b6\u6001\u673a\u201d \u7684\u89d2\u5ea6\uff0c\u534f\u7a0b\u7684\u884c\u4e3a\u7406\u89e3\u8d77\u6765\u4f1a\u7a0d\u7a0d\u5bb9\u6613\u4e00\u4e9b\u3002\u9996\u5148\uff0c\u6240\u6709\u7684\u534f\u7a0b\u662f\u5171\u4eab\u5185\u5b58\u7684\u2014\u2014\u5c31\u662f\u534f\u7a0b\u6240\u5728\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u3002\u6b64\u5916\uff0c\u6bcf\u4e2a\u534f\u7a0b\u60f3\u8981\u6267\u884c\uff0c\u5c31\u9700\u8981\u62e5\u6709\u72ec\u7acb\u7684\u5806\u6808\u548c\u5bc4\u5b58\u5668 (\u8fd9\u4e00\u70b9\u4e0e\u7ebf\u7a0b\u76f8\u540c)\u3002\u4e00\u4e2a\u534f\u7a0b\u7684\u5bc4\u5b58\u5668\u3001\u5806\u6808\u3001\u5171\u4eab\u5185\u5b58\u5c31\u6784\u6210\u4e86\u5f53\u4e14\u534f\u7a0b\u7684\u72b6\u6001\u673a\u6267\u884c\uff0c\u7136\u540e\uff1a</p> <ul> <li><code>co_start</code> \u4f1a\u5728\u5171\u4eab\u5185\u5b58\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u72b6\u6001\u673a (\u5806\u6808\u548c\u5bc4\u5b58\u5668\u4e5f\u4fdd\u5b58\u5728\u5171\u4eab\u5185\u5b58\u4e2d)\uff0c\u4ec5\u6b64\u800c\u5df2\u3002\u65b0\u72b6\u6001\u673a\u7684 <code>%rsp</code> \u5bc4\u5b58\u5668\u5e94\u8be5\u6307\u5411\u5b83\u72ec\u7acb\u7684\u5806\u6808\uff0c<code>%rip</code> \u5bc4\u5b58\u5668\u5e94\u8be5\u6307\u5411 <code>co_start</code> \u4f20\u9012\u7684 <code>func</code> \u53c2\u6570\u3002\u6839\u636e 32/64-bit\uff0c\u53c2\u6570\u4e5f\u5e94\u8be5\u88ab\u4fdd\u5b58\u5728\u6b63\u786e\u7684\u4f4d\u7f6e (x86-64 \u53c2\u6570\u5728 <code>%rdi</code> \u5bc4\u5b58\u5668\uff0c\u800c x86 \u53c2\u6570\u5728\u5806\u6808\u4e2d)\u3002<code>main</code> \u5929\u7136\u662f\u4e2a\u72b6\u6001\u673a\uff0c\u5c31\u5bf9\u5e94\u4e86\u4e00\u4e2a\u534f\u7a0b\uff1b</li> <li><code>co_yield</code> \u4f1a\u5c06\u5f53\u524d\u8fd0\u884c\u534f\u7a0b\u7684\u5bc4\u5b58\u5668\u4fdd\u5b58\u5230\u5171\u4eab\u5185\u5b58\u4e2d\uff0c\u7136\u540e\u9009\u62e9\u4e00\u4e2a\u53e6\u4e00\u4e2a\u534f\u7a0b\uff0c\u5c06\u5bc4\u5b58\u5668\u52a0\u8f7d\u5230 CPU \u4e0a\uff0c\u5c31\u5b8c\u6210\u4e86 \u201c\u72b6\u6001\u673a\u7684\u5207\u6362\u201d\uff1b</li> <li><code>co_wait</code> \u4f1a\u7b49\u5f85\u72b6\u6001\u673a\u8fdb\u5165\u7ed3\u675f\u72b6\u6001\uff0c\u5373 <code>func()</code> \u7684\u8fd4\u56de\u3002</li> </ul>"},{"location":"courses/os_lab/M2_libco.html#23","title":"2.3 \u534f\u7a0b\u548c\u7ebf\u7a0b","text":"<p>\u534f\u7a0b\u548c\u7ebf\u7a0b\u7684 API \u975e\u5e38\u76f8\u4f3c\u3002\u4f8b\u5982\u8bfe\u5802\u7ebf\u7a0b\u5e93\u4e2d\u63d0\u4f9b\u7684</p> <pre><code>void create(void (*func)(void *));\nvoid join();\n</code></pre> <p>\u521a\u597d\u5bf9\u5e94\u4e86 <code>co_start</code> \u548c <code>co_wait</code> (<code>join</code> \u4f1a\u5728 <code>main</code> \u8fd4\u56de\u540e\uff0c\u5bf9\u6bcf\u4e2a\u521b\u5efa\u7684\u7ebf\u7a0b\u8c03\u7528 <code>pthread_join</code>\uff0c\u4f9d\u6b21\u7b49\u5f85\u5b83\u4eec\u7ed3\u675f\uff0c\u4f46\u6211\u4eec\u7684\u534f\u7a0b\u5e93\u4e2d <code>main</code> \u8fd4\u56de\u540e\u5c06\u7acb\u5373\u7ec8\u6b62)\u3002\u552f\u4e00\u4e0d\u540c\u7684\u662f\uff0c\u7ebf\u7a0b\u7684\u8c03\u5ea6\u4e0d\u662f\u7531\u7ebf\u7a0b\u51b3\u5b9a\u7684 (\u7531\u64cd\u4f5c\u7cfb\u7edf\u548c\u786c\u4ef6\u51b3\u5b9a)\uff0c\u4f46\u534f\u7a0b\u9664\u975e\u6267\u884c <code>co_yield()</code> \u4e3b\u52a8\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u534f\u7a0b\u8fd0\u884c\uff0c\u5f53\u524d\u7684\u4ee3\u7801\u5c31\u4f1a\u4e00\u76f4\u6267\u884c\u4e0b\u53bb\u3002</p> <p>\u534f\u7a0b\u4f1a\u5728\u6267\u884c <code>co_yield()</code> \u65f6\u4e3b\u52a8\u8ba9\u51fa\u5904\u7406\u5668\uff0c\u8c03\u5ea6\u5230\u53e6\u4e00\u4e2a\u534f\u7a0b\u6267\u884c\u3002\u56e0\u6b64\uff0c\u5982\u679c\u80fd\u4fdd\u8bc1 <code>co_yield()</code> \u7684\u5b9a\u65f6\u6267\u884c\uff0c\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u5728\u8fdb\u7a0b\u91cc\u5b9e\u73b0\u7ebf\u7a0b\u3002\u8fd9\u5c31\u6709\u4e86\u64cd\u4f5c\u7cfb\u7edf\u6559\u79d1\u4e66\u4e0a\u6240\u8bb2\u7684 \u201c\u7528\u6237\u6001\u7ebf\u7a0b\u201d\u2014\u2014\u7ebf\u7a0b\u53ef\u4ee5\u770b\u6210\u662f\u6bcf\u4e00\u6761\u8bed\u53e5\u540e\u90fd \u201c\u63d2\u5165\u201d \u4e86 <code>co_yield()</code> \u7684\u534f\u7a0b\u3002\u8fd9\u4e2a \u201c\u63d2\u5165\u201d \u64cd\u4f5c\u662f\u7531\u4e24\u65b9\u5b9e\u73b0\u7684\uff1a\u64cd\u4f5c\u7cfb\u7edf\u5728\u4e2d\u65ad\u540e\u53ef\u80fd\u5f15\u53d1\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u8c03\u5ea6\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u6267\u884c\uff1b\u5728\u591a\u5904\u7406\u5668\u4e0a\uff0c\u4e24\u4e2a\u7ebf\u7a0b\u5219\u662f\u771f\u6b63\u5e76\u884c\u6267\u884c\u7684\u3002</p> <p>\u534f\u7a0b\u4e0e\u7ebf\u7a0b\u7684\u533a\u522b\u5728\u4e8e\u534f\u7a0b\u662f\u5b8c\u5168\u5728\u5e94\u7528\u7a0b\u5e8f\u5185 (\u4f4e\u7279\u6743\u8fd0\u884c\u7ea7) \u5b9e\u73b0\u7684\uff0c\u4e0d\u9700\u8981\u64cd\u4f5c\u7cfb\u7edf\u7684\u652f\u6301\uff0c\u5360\u7528\u7684\u8d44\u6e90\u901a\u5e38\u4e5f\u6bd4\u64cd\u4f5c\u7cfb\u7edf\u7ebf\u7a0b\u66f4\u5c0f\u4e00\u4e9b\u3002\u534f\u7a0b\u53ef\u4ee5\u968f\u65f6\u5207\u6362\u6267\u884c\u6d41\u7684\u7279\u6027\uff0c\u7528\u4e8e\u5b9e\u73b0\u72b6\u6001\u673a\u3001actor model, goroutine \u7b49\u3002\u5728\u5b9e\u9a8c\u6750\u6599\u6700\u524d\u9762\u63d0\u5230\u7684 Python/Javascript \u7b49\u8bed\u8a00\u91cc\u7684 generator \u4e5f\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u534f\u7a0b\uff0c\u5b83\u6bcf\u6b21 <code>co_yield</code> \u90fd\u5c06\u63a7\u5236\u6d41\u8fd4\u56de\u5230\u5b83\u7684\u8c03\u7528\u8005\uff0c\u800c\u4e0d\u662f\u50cf\u672c\u5b9e\u9a8c\u4e00\u6837\u968f\u673a\u9009\u62e9\u4e00\u4e2a\u53ef\u8fd0\u884c\u7684\u534f\u7a0b\u3002</p>"},{"location":"courses/os_lab/M2_libco.html#3","title":"3. \u6b63\u786e\u6027\u6807\u51c6","text":"<p>\ud83d\uddd2\ufe0f\u5b9e\u9a8c\u8981\u6c42\uff1a\u5c06\u6240\u6709\u4ee3\u7801\u5b9e\u73b0\u5728 co.c \u4e2d</p> <p>\u4e0d\u8981\u4fee\u6539 <code>co.h</code>\u3002Online Judge \u5728\u8bc4\u6d4b\u65f6\u4ec5\u62f7\u8d1d\u4f60\u7684 <code>co.c</code> \u6587\u4ef6\u3002<code>struct co</code> \u53ef\u4ee5\u76f4\u63a5\u5728 .c \u4e2d\u5b9a\u4e49 (\u5934\u6587\u4ef6\u4e0d\u9700\u8981\u7ed9\u51fa\u5177\u4f53\u7684\u7ed3\u6784\u4f53\u5b9a\u4e49)\u3002</p> <p>\u597d\u6d88\u606f\u662f\uff0c\u6211\u4eec\u5df2\u7ecf\u4e3a\u5927\u5bb6\u63d0\u4f9b\u4e86\u57fa\u7840\u6d4b\u8bd5\u7528\u4f8b\uff0c\u6d4b\u8bd5\u7528\u4f8b\u6709\u4e24\u7ec4\uff1a</p> <ol> <li>(Easy) \u521b\u5efa\u4e24\u4e2a\u534f\u7a0b\uff0c\u6bcf\u4e2a\u534f\u7a0b\u4f1a\u5faa\u73af 100 \u6b21\uff0c\u7136\u540e\u6253\u5370\u5f53\u524d\u534f\u7a0b\u7684\u540d\u5b57\u548c\u5168\u5c40\u8ba1\u6570\u5668 <code>g_count</code> \u7684\u6570\u503c\uff0c\u7136\u540e\u6267\u884c <code>g_count++</code>\u3002</li> <li>(Hard) \u521b\u5efa\u4e24\u4e2a\u751f\u4ea7\u8005\u3001\u4e24\u4e2a\u6d88\u8d39\u8005\u3002\u6bcf\u4e2a\u751f\u4ea7\u8005\u6bcf\u6b21\u4f1a\u5411\u961f\u5217\u4e2d\u63d2\u5165\u4e00\u4e2a\u6570\u636e\uff0c\u7136\u540e\u6267\u884c <code>co_yield()</code> \u8ba9\u5176\u4ed6 (\u968f\u673a\u7684) \u534f\u7a0b\u6267\u884c\uff1b\u6bcf\u4e2a\u6d88\u8d39\u8005\u4f1a\u68c0\u67e5\u961f\u5217\u662f\u5426\u4e3a\u7a7a\uff0c\u5982\u679c\u975e\u7a7a\u4f1a\u4ece\u961f\u5217\u4e2d\u53d6\u51fa\u5934\u90e8\u7684\u5143\u7d20\u3002\u65e0\u8bba\u961f\u5217\u662f\u5426\u4e3a\u7a7a\uff0c\u4e4b\u540e\u90fd\u4f1a\u8c03\u7528 <code>co_yield()</code> \u8ba9\u5176\u4ed6 (\u968f\u673a\u7684) \u534f\u7a0b\u6267\u884c\u3002</li> </ol> <p>\u6267\u884c <code>make test</code> \u4f1a\u5728 x86-64 \u548c x86-32 \u4e24\u4e2a\u73af\u5883\u4e0b\u8fd0\u884c\u4f60\u7684\u4ee3\u7801\u2014\u2014\u5982\u679c\u4f60\u770b\u5230\u7b2c\u4e00\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u6253\u5370\u51fa\u6570\u5b57 <code>X/Y-0</code> \u5230 <code>X/Y-199</code>\u3001\u7b2c\u4e8c\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u6253\u5370\u51fa <code>libco-200</code> \u5230 <code>libco-399</code>\uff0c\u8bf4\u660e\u4f60\u7684\u5b9e\u73b0\u57fa\u672c\u6b63\u786e\uff1b\u5426\u5219\u8bf7\u8c03\u8bd5\u4f60\u7684\u4ee3\u7801\u3002</p> <p>Online Judge \u4e0a\u4f1a\u8fd0\u884c\u7c7b\u4f3c\u7684\u6d4b\u8bd5 (\u4e5f\u4f1a\u5728 x86-64 \u548c x86-32 \u4e24\u4e2a\u5e73\u53f0\u4e0a\u8fd0\u884c)\uff0c\u4f46\u89c4\u6a21\u53ef\u80fd\u7a0d\u5927\u4e00\u4e9b\u3002\u4f60\u53ef\u4ee5\u5047\u8bbe\uff1a</p> <ol> <li>\u6bcf\u4e2a\u534f\u7a0b\u7684\u5806\u6808\u4f7f\u7528\u4e0d\u8d85\u8fc7 64 KiB\uff1b</li> <li>\u4efb\u610f\u65f6\u523b\u7cfb\u7edf\u4e2d\u7684\u534f\u7a0b\u6570\u91cf\u4e0d\u4f1a\u8d85\u8fc7 128 \u4e2a (\u5305\u62ec <code>main</code> \u5bf9\u5e94\u7684\u534f\u7a0b)\u3002\u534f\u7a0b <code>wait</code> \u8fd4\u56de\u540e\u534f\u7a0b\u7684\u8d44\u6e90\u5e94\u5f53\u88ab\u56de\u6536\u2014\u2014\u6211\u4eec\u53ef\u80fd\u4f1a\u521b\u5efa\u5927\u91cf\u7684\u534f\u7a0b\u6267\u884c-\u7b49\u5f85-\u9500\u6bc1\u3001\u6267\u884c-\u7b49\u5f85-\u9500\u6bc1\u3002\u56e0\u6b64\u5982\u679c\u4f60\u7684\u8d44\u6e90\u6ca1\u6709\u53ca\u65f6\u56de\u6536\uff0c\u53ef\u80fd\u4f1a\u53d1\u751f Memory Limit Exceeded \u95ee\u9898\u3002</li> </ol> <p>\u8fd8\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u63d0\u4ea4\u7684\u4ee3\u7801\u4e0d\u8981\u6709\u4efb\u4f55\u591a\u4f59\u7684\u8f93\u51fa\uff0c\u5426\u5219\u53ef\u80fd\u4f1a\u88ab Online Judge \u5224\u9519\u3002</p> <p>\u2615\ufe0f\u5e0c\u671b\u5728\u672c\u5730\u4fdd\u7559\u8c03\u8bd5\u4fe1\u606f\uff1f</p> <p>\u5982\u679c\u4f60\u5e0c\u671b\u5728\u672c\u5730\u8fd0\u884c\u65f6\u4fdd\u7559\u8c03\u8bd5\u4fe1\u606f\u5e76\u4e14\u4e0d\u60f3\u5728\u63d0\u4ea4\u5230 Online Judge \u65f6\u8d39\u529b\u5730\u5220\u9664\u6563\u843d\u5728\u7a0b\u5e8f\u4e2d\u7684\u8c03\u8bd5\u4fe1\u606f\uff0c\u4f60\u53ef\u4ee5\u5c1d\u8bd5\u7528\u4e00\u4e2a\u4f60\u672c\u5730\u7684\u5b8f\u6765\u63a7\u5236\u8f93\u51fa\u7684\u884c\u4e3a\uff0c\u4f8b\u5982</p> <pre><code>#ifdef LOCAL_MACHINE\n    #define debug(...) printf(__VA_ARGS__)\n#else\n    #define debug(...)\n#endif\n</code></pre> <p>\u7136\u540e\u901a\u8fc7\u589e\u52a0 <code>-DLOCAL_MACHINE</code> \u7684\u7f16\u8bd1\u9009\u9879\u6765\u5b9e\u73b0\u8f93\u51fa\u63a7\u5236\u2014\u2014\u5728 Online Judge \u4e0a\uff0c\u6240\u6709\u7684\u8c03\u8bd5\u8f93\u51fa\u90fd\u4f1a\u6d88\u5931\u3002</p>"},{"location":"courses/os_lab/M2_libco.html#4","title":"4. \u5b9e\u9a8c\u6307\u5357","text":"<p>\u2615\ufe0f\u611f\u89c9\u6709\u70b9\u65e0\u4ece\u4e0b\u624b\uff1f</p> <p>\u4e0d\u8981\u7740\u6025\u3002\u8fd9\u4e2a\u5b9e\u9a8c\u7684\u786e\u6709\u70b9\u4e0d\u4e00\u6837\uff1a\u4ee5\u524d\u7684\u5b9e\u9a8c\u90fd\u662f\u6709\u660e\u786e\u76ee\u6807\u7684\uff0c\u6bd4\u5982 OJ \u9898\u7ed9\u5b9a\u8f93\u5165\u548c\u8f93\u51fa\u3002\u4f46\u8fd9\u6b21\u4e0d\u4e00\u6837\uff0c\u6211\u4eec\u8981 hack C \u8bed\u8a00\u8fd0\u884c\u65f6\u7684\u884c\u4e3a\u2014\u2014\u5199\u4e00\u4e2a\u51fd\u6570 \u201c\u5207\u6362\u201d \u5230\u53e6\u4e00\u4e2a\u51fd\u6570\u6267\u884c\u3002\u542c\u8d77\u6765\u5c31\u6709\u4e9b\u65e0\u4ece\u4e0b\u624b\u3002\u8fd8\u8bb0\u5f97\u4e24\u4ef6\u4e8b\uff1a</p> <ol> <li>\u5206\u89e3\u95ee\u9898\uff0c\u59cb\u7ec8\u628a\u590d\u6742\u7684\u95ee\u9898\u5206\u6210\u66f4\u5c0f\u7684\u3001\u5bb9\u6613\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u8fd9\u6837\u4f60\u603b\u662f\u53ef\u4ee5\u5356\u51fa\u4e00\u6b65\u3002</li> <li>\u6211\u4eec\u8bb0\u5f97\u4e0a\u8bfe\u65f6\u63d0\u4f9b\u7684\u601d\u8def\uff1a\u201c\u4e00\u5207\u90fd\u662f\u72b6\u6001\u673a\u201d\u3002</li> </ol>"},{"location":"courses/os_lab/M2_libco.html#41","title":"4.1. \u7f16\u8bd1\u548c\u8fd0\u884c","text":"<p>\u65e0\u8bba\u5bf9\u6846\u67b6\u4ee3\u7801\u591a\u4e48\u6ca1\u6709\u5934\u7eea\uff0c\u628a\u5df2\u6709\u7684\u4ee3\u7801\u8fd0\u884c\u8d77\u6765\u90fd\u662f\u597d\u7684\u3002</p> <p>\u6211\u4eec\u7684\u6846\u67b6\u4ee3\u7801\u7684 <code>co.c</code> \u4e2d\u6ca1\u6709 <code>main</code> \u51fd\u6570\u2014\u2014\u5b83\u5e76\u4e0d\u4f1a\u88ab\u7f16\u8bd1\u6210\u4e00\u4e2a\u80fd\u76f4\u63a5\u5728 Linux \u4e0a\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u7f16\u8bd1\u811a\u672c\u4f1a\u751f\u6210\u5171\u4eab\u5e93 (shared object, \u52a8\u6001\u94fe\u63a5\u5e93) <code>libco-32.so</code> \u548c <code>libco-64.so</code>\uff1a</p> <pre><code>$ file libco-64.so \nlibco-64.so: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), ...\n</code></pre> <p>\u5171\u4eab\u5e93\u53ef\u4ee5\u6709\u81ea\u5df1\u7684\u4ee3\u7801\u3001\u6570\u636e\uff0c\u751a\u81f3\u53ef\u4ee5\u8c03\u7528\u5176\u4ed6\u5171\u4eab\u5e93 (\u4f8b\u5982 libc, libpthread \u7b49)\u3002\u5171\u4eab\u5e93\u4e2d\u5168\u5c40\u7684\u7b26\u53f7\u5c06\u80fd\u88ab\u52a0\u8f7d\u5b83\u7684\u5e94\u7528\u7a0b\u5e8f\u8c03\u7528\u3002\u5171\u4eab\u5e93\u4e2d\u4e0d\u9700\u8981\u5165\u53e3 (<code>main</code> \u51fd\u6570)\u3002\u6211\u4eec\u7684 Makefile \u91cc\u5df2\u7ecf\u5199\u660e\u4e86\u5982\u4f55\u7f16\u8bd1\u5171\u4eab\u5e93\uff1a</p> <pre><code>$(NAME)-64.so: $(DEPS) # 64bit shared library\n    gcc -fPIC -shared -m64 $(CFLAGS) $(SRCS) -o $@ $(LDFLAGS)\n</code></pre> <p>\u5176\u4e2d <code>-fPIC -fshared</code> \u5c31\u4ee3\u8868\u7f16\u8bd1\u6210\u4f4d\u7f6e\u65e0\u5173\u4ee3\u7801\u7684\u5171\u4eab\u5e93\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u5171\u4eab\u5e93\u548c\u666e\u901a\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u6ca1\u6709\u7279\u522b\u7684\u533a\u522b\u3002\u867d\u7136\u8fd9\u4e2a\u6587\u4ef6\u6709 <code>+x</code> \u5c5e\u6027\u5e76\u4e14\u53ef\u4ee5\u6267\u884c\uff0c\u4f46\u4f1a\u7acb\u5373\u5f97\u5230 Segmentation Fault (\u53ef\u4ee5\u8bd5\u7740\u7528 gdb \u8c03\u8bd5\u5b83)\u3002</p> <p>\u2615\ufe0f\u80fd\u4e0d\u80fd\u5f97\u5230\u65e2\u53ef\u4ee5\u8fd0\u884c\u53c8\u80fd\u88ab\u52a8\u6001\u52a0\u8f7d\u7684\u5171\u4eab\u5e93\u5bf9\u8c61\uff1f</p> <p>GPT-4 \u7adf\u7136\u7b54\u9519\u4e86\uff01\u4f46\u8fd9\u4ef6\u4e8b\u662f\u53ef\u4ee5\u505a\u5230\u7684\uff1b\u6709\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u5728\u4e92\u8054\u7f51\u4e0a\u89e3\u51b3\u65b9\u6848\u3002\u63d0\u793a\uff1aELF \u6587\u4ef6\u4e2d\u6709 \u201cINTERP\u201d \u5b57\u6bb5\u6307\u5b9a\u4e00\u4e2a\u6267\u884c\u6587\u4ef6\u7684\u89e3\u91ca\u5668</p>"},{"location":"courses/os_lab/M2_libco.html#42","title":"4.2. \u4f7f\u7528\u534f\u7a0b\u5e93","text":"<p>\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u7ec4\u534f\u7a0b\u5e93\u7684\u6d4b\u8bd5\u7528\u4f8b (<code>tests/</code> \u76ee\u5f55\u4e0b)\uff0c\u5305\u542b\u4e86\u7f16\u8bd1\u548c\u8fd0\u884c\u6240\u9700\u7684\u811a\u672c\uff0c\u5176\u4e2d\u7f16\u8bd1\u7684\u7f16\u8bd1\u9009\u9879\u662f</p> <pre><code>gcc -I.. -L.. -m64 main.c -o libco-test-64 -lco-64\ngcc -I.. -L.. -m32 main.c -o libco-test-32 -lco-32\n</code></pre> <p>\u6ce8\u610f\u5230 <code>-I</code> \u548c <code>-L</code> \u9009\u9879\u7684\u4f7f\u7528 (\u8fd9\u4e9b\u9009\u9879\u4f60\u5e94\u8be5\u4e4b\u524d\u770b\u5230\u8fc7\u5f88\u591a\u6b21)\uff1a</p> <ul> <li><code>-I</code> \u9009\u9879\u4ee3\u8868 include path\uff0c\u4f7f\u6211\u4eec\u53ef\u4ee5 <code>#include &lt;co.h&gt;</code>\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528 <code>gcc --verbose</code> \u7f16\u8bd1\u770b\u5230\u7f16\u8bd1\u5668\u4f7f\u7528\u7684 include paths\u3002</li> <li><code>-L</code> \u9009\u9879\u4ee3\u8868\u589e\u52a0 link search path\u3002</li> <li><code>-l</code> \u9009\u9879\u4ee3\u8868\u94fe\u63a5\u67d0\u4e2a\u5e93\uff0c\u94fe\u63a5\u65f6\u4f1a\u81ea\u52a8\u52a0\u4e0a <code>lib</code> \u7684\u524d\u7f00\uff0c\u5373 <code>-lco-64</code> \u4f1a\u4f9d\u6b21\u5728\u5e93\u51fd\u6570\u7684\u641c\u7d22\u8def\u5f84\u4e2d\u67e5\u627e <code>libco-64.so</code> \u548c <code>libco-64.a</code>\uff0c\u76f4\u5230\u627e\u5230\u4e3a\u6b62\u3002\u5982\u679c\u4f60\u5c06 <code>libco-64.so</code> \u5220\u9664\u540e\u7528 strace \u5de5\u5177\u67e5\u770b gcc \u8fd0\u884c\u65f6\u4f7f\u7528\u7684\u7cfb\u7edf\u8c03\u7528\uff0c\u5c31\u80fd\u6e05\u6670\u5730\u770b\u5230\u5e93\u51fd\u6570\u89e3\u6790\u7684\u6d41\u7a0b\uff1b</li> </ul> <p>\u5728\u8fd0\u884c\u65f6\uff0c\u4f7f\u7528 <code>make test</code> \u76f4\u63a5\u8fd0\u884c\uff0c\u5b83\u6267\u884c\u7684\u547d\u4ee4\u662f\uff1a</p> <pre><code>LD_LIBRARY_PATH=.. ./libco-test-64\n</code></pre> <p>\u5982\u679c\u4e0d\u8bbe\u7f6e <code>LD_LIBRARY_PATH</code> \u73af\u5883\u53d8\u91cf\uff0c\u4f60\u5c06\u4f1a\u9047\u5230 \u201cerror while loading shared libraries: <code>libco-xx.so</code>: cannot open shared object file: No such file or directory\u201d \u7684\u9519\u8bef\u3002\u8bf7 STFW \u7406\u89e3\u8fd9\u4e2a\u73af\u5883\u53d8\u91cf\u7684\u542b\u4e49\u3002</p> <p>\u81f3\u6b64\uff0c\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u4e86\u5171\u4eab\u5e93\u7684\u7f16\u8bd1\uff0c\u4ee5\u53ca\u8ba9\u4e00\u4e2a C \u7a0b\u5e8f\u52a8\u6001\u94fe\u63a5\u5171\u4eab\u5e93\u6267\u884c\u3002</p> <p>\u2615\ufe0f\u65e0\u6cd5\u8c03\u8bd5\uff1f</p> <p>\u76f4\u63a5\u8fd0\u884c <code>./libco-test-64</code> \u4f1a\u9047\u5230 No such file or directory \u7684\u95ee\u9898\uff1b\u5f53\u7136\uff0c\u53ea\u9700\u8981\u7528 <code>make test</code> \u5c31\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u4e86\u3002</p> <p>\u7c7b\u4f3c\u5730\uff0c\u4f60\u53ef\u80fd\u5e0c\u671b\u6267\u884c gdb libco-test-64\uff0c\u4f46 gdb \u4e5f\u4f1a\u65e0\u60c5\u5730\u4ee5 \u201c\u627e\u4e0d\u5230\u5e93\u201d \u7684\u7406\u7531\u62d2\u7edd\u4f60\u3002\u6b64\u65f6\u6211\u4eec\u9700\u8981\u7684\u662f\u4e3a gdb \u914d\u7f6e\u4e0e <code>make test</code> \u5b8c\u5168\u76f8\u540c\u7684\u73af\u5883\uff1a\u5728\u7ec8\u7aef\u4e2d\u4f7f\u7528 <code>export</code> \u5c06\u5f53\u524d shell \u8fdb\u7a0b\u7684 <code>LD_LIBRARY_PATH</code> \u8bbe\u7f6e\u597d\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u65e0\u969c\u788d\u5730\u8fd0\u884c\u548c\u8c03\u8bd5 <code>./libco-test-64</code> \u4e86\u3002</p>"},{"location":"courses/os_lab/M2_libco.html#43","title":"4.3. \u5b9e\u73b0\u534f\u7a0b\uff1a\u95ee\u9898\u5206\u6790","text":"<p>Everything is a state machine.</p> <p>\u6211\u4eec\u6765\u5206\u6790\u5b9e\u73b0\u4e2d\u6700\u56f0\u96be\u7684 <code>co_yield()</code>\uff0c\u5f53\u7136\uff0c\u7528\u4e00\u4e2a\u4f8b\u5b50\uff1a</p> <pre><code>void foo() {\n    int i;\n    for (int i = 0; i &lt; 1000; i++) {\n        printf(\"%d\\n\", i);\n        co_yield();\n    }\n}\n</code></pre> <p>\u8fd9\u4e2a\u7a0b\u5e8f\u5728 <code>co_yield()</code> \u4e4b\u540e\u53ef\u80fd\u4f1a\u5207\u6362\u5230\u5176\u4ed6\u534f\u7a0b\u6267\u884c\uff0c\u4f46\u6700\u7ec8\u5b83\u4f9d\u7136\u4f1a\u5b8c\u6210 1, 2, 3, ... 1000 \u7684\u6253\u5370\u3002\u5206\u6790 <code>co_yield</code> \u51fd\u6570\uff1a</p> <ul> <li>\u4e0d\u80fd\u8fd4\u56de\u5230 foo \u7ee7\u7eed\u6267\u884c\uff0c\u5426\u5219\u5207\u6362\u529f\u80fd\u5c31\u4eff\u4f5b\u6ca1\u6709\u5b9e\u73b0\u8fc7\u3002</li> <li>\u4e0d\u80fd\u628a\u6b63\u5728\u6267\u884c\u7684 foo \u201c\u8fd4\u56de\u201d\uff0c\u5426\u5219 <code>co_yield</code> \u51fd\u6570\u7684\u8c03\u7528\u6808\u5e27 (stack frame) \u4f1a\u88ab\u6467\u6bc1\uff0c\u53d8\u91cf \ufffdi \u4e5f\u5c31\u6d88\u5931\u4e86\u3002</li> </ul> <p>\u6211\u4eec\u4e0d\u59a8\u56de\u5230\u72b6\u6001\u673a\u7684\u89c6\u89d2\u3002 <code>co_yield</code> \u7684\u6267\u884c (call \u6307\u4ee4\uff0c\u5305\u62ec\u51fd\u6570\u7684\u6267\u884c)\uff0c\u5e94\u8be5\u770b\u4f5c\u4e00\u4e2a\u72b6\u6001\u8fc1\u79fb\uff0c\u628a\u5f53\u524d\u4ee3\u7801\u6267\u884c\u7684\u72b6\u6001\u673a\u5207\u6362\u5230\u53e6\u4e00\u6bb5\u4ee3\u7801\uff1a</p> <pre><code>push   %rbp\npush   %rbx\nlea    &lt;stdout&gt;, %rbp       \nxor    %ebx, %ebx\nsub    $0x8, %rsp\nmov    %ebx, %esi\nmov    %rbp, %rdi\nxor    %eax, %eax\ncallq  &lt;printf@plt&gt;\ninc    %ebx\nxor    %eax, %eax\ncallq  &lt;co_yield&gt;  // &lt;- \u6267\u884c call \u4e4b\u524d\uff0c\u6709\u4e00\u4e2a \u201c\u72b6\u6001\u201d\ncmp    $0x3e8, %ebx\njne    669 &lt;foo+0xf&gt;\npop    %rax\npop    %rbx\npop    %rbp\nretq    \n</code></pre> <p>\u90a3\u4e48\uff0c\u8c03\u7528 <code>co_yield</code> \u77ac\u95f4\u7684\u534f\u7a0b \u201c\u72b6\u6001\u201d \u662f\u4ec0\u4e48\u5462\uff1f\u662f\u5f53\u524d\u534f\u7a0b\u6808\u4e2d\u7684\u6240\u6709\u6570\u636e\uff0c\u5916\u52a0\u5904\u7406\u5668\u4e0a\u6240\u6709\u7684\u5bc4\u5b58\u5668\u2014\u2014\u6709\u5b83\u4eec\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u89e3\u91ca\u6267\u884c\u4efb\u610f\u51fd\u6570\u4e86\u3002\u6240\u4ee5\u6211\u4eec\u628a\u5bc4\u5b58\u5668 (\u5305\u62ec Stack Pointer) \u90fd\u4fdd\u5b58\u4e0b\u6765\uff0c\u7136\u540e\u6062\u590d\u53e6\u4e00\u4e2a\u534f\u7a0b\u4fdd\u5b58\u7684\u5bc4\u5b58\u5668 (\u548c Stack Pointer)\uff0c\u5c31\u5b8c\u6210\u4e86\u4efb\u52a1\uff01</p> <p>\u6ca1\u9519\uff01\u4f60 \u201c\u53d1\u660e\u201d \u4e86\u5206\u65f6\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4e2d\u5177\u6709\u5960\u57fa\u6027\u610f\u4e49\u7684\u673a\u5236\uff1a\u201c\u4e0a\u4e0b\u6587\u5207\u6362\u201d\u3002\u6211\u4eec\u53ef\u4ee5\u4e3a\u7ebf\u7a0b (\u6216\u534f\u7a0b) \u5728\u5185\u5b58\u4e2d\u5206\u914d\u5806\u6808\uff0c\u8ba9 Stack Pointer \u6307\u5411\u5404\u81ea\u5206\u914d\u7684\u5806\u6808\u4e2d\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u5c31\u53ea\u8981\u4fdd\u5b58\u5bc4\u5b58\u5668\u5c31\u53ef\u4ee5\u4e86\uff1a</p> <pre><code>struct context {\n    uint64_t rax;\n    ...\n}\n</code></pre> <p>\u901a\u8fc7\u5c0f\u5fc3\u5730\u7528\u6c47\u7f16\u4ee3\u7801\u4fdd\u5b58\u5bc4\u5b58\u5668\uff0c\u7136\u540e\u5728\u6700\u540e\u6267\u884c PC \u7684\u5207\u6362\uff1a</p> <pre><code>co_yield:\n    // \u4fdd\u5b58\u5bc4\u5b58\u5668\n    popq (saved_pc) // \u76f4\u63a5\u8fd4\u56de\u5230 co_yield \u7684\u8fd4\u56de\u4f4d\u7f6e\n    movq %rax, 0(saved_context)\n    movq %rbx, 8(saved_context)\n    ...\n\n    // \u6062\u590d\u5bc4\u5b58\u5668\n    movq 0(next_context), %rax\n    movq 8(next_context), %rbx\n    ...\n\n    jmp *(next_pc)\n</code></pre> <p>\u540c\u6837\u7684\u4ee3\u7801\u51fa\u73b0\u5728 AbstractMachine:</p> <pre><code>trap:\n  cli\n  subq  $48, %rsp\n  pushq %r15\n  pushq %r14\n  pushq %r13\n  pushq %r12\n  pushq %r11\n  pushq %r10\n  pushq %r9\n  pushq %r8\n  pushq %rdi\n  pushq %rsi\n  pushq %rbp\n  pushq %rdx\n  pushq %rcx\n  pushq %rbx\n  pushq %rax\n  pushq $0  // cr3, saved in __am_irq_handle\n\n  movq  %rsp, %rdi\n  call  __am_irq_handle\n\n.globl __am_iret\n__am_iret:\n  movq  %rdi, %rsp\n  movq  160(%rsp), %rax\n  movw  %ax, %ds\n  movw  %ax, %es\n  addq  $8, %rsp\n  popq  %rax\n  popq  %rbx\n  popq  %rcx\n  popq  %rdx\n  popq  %rbp\n  popq  %rsi\n  popq  %rdi\n  popq  %r8\n  popq  %r9\n  popq  %r10\n  popq  %r11\n  popq  %r12\n  popq  %r13\n  popq  %r14\n  popq  %r15\n  iretq\n</code></pre> <p>\u6ca1\u9519\uff0c\u8fd9\u5c31\u662f\u6211\u4eec\u89e3\u51b3\u95ee\u9898\u7684\u601d\u8def\u3002\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u7740\u624b\u5177\u4f53\u5b9e\u73b0\u4e86\u3002</p>"},{"location":"courses/os_lab/M2_libco.html#44","title":"4.4 \u5b9e\u73b0\u534f\u7a0b\uff1a\u6570\u636e\u7ed3\u6784","text":"<p>\u6211\u4eec\u7ed9\u51fa\u4e00\u4e2a\u53c2\u8003\u7684 <code>struct co</code> \u5b9a\u4e49\uff1a</p> <pre><code>enum co_status {\n    CO_NEW = 1, // \u65b0\u521b\u5efa\uff0c\u8fd8\u672a\u6267\u884c\u8fc7\n    CO_RUNNING, // \u5df2\u7ecf\u6267\u884c\u8fc7\n    CO_WAITING, // \u5728 co_wait \u4e0a\u7b49\u5f85\n    CO_DEAD,    // \u5df2\u7ecf\u7ed3\u675f\uff0c\u4f46\u8fd8\u672a\u91ca\u653e\u8d44\u6e90\n};\n\nstruct co {\n    char *name;\n    void (*func)(void *); // co_start \u6307\u5b9a\u7684\u5165\u53e3\u5730\u5740\u548c\u53c2\u6570\n    void *arg;\n\n    enum co_status status;  // \u534f\u7a0b\u7684\u72b6\u6001\n    struct co *    waiter;  // \u662f\u5426\u6709\u5176\u4ed6\u534f\u7a0b\u5728\u7b49\u5f85\u5f53\u524d\u534f\u7a0b\n    struct context context; // \u5bc4\u5b58\u5668\u73b0\u573a\n    uint8_t        stack[STACK_SIZE]; // \u534f\u7a0b\u7684\u5806\u6808\n};\n</code></pre> <p>\u5f53\u7136\uff0c\u6211\u4eec\u9700\u8981\u5168\u5c40\u7684\u6307\u9488\uff0c\u6307\u5411\u5f53\u524d\u8fd0\u884c\u7684\u534f\u7a0b (\u521d\u59cb\u65f6\uff0c\u6211\u4eec\u9700\u8981\u4e3a main \u5206\u914d\u534f\u7a0b\u5bf9\u8c61)\uff1a</p> <pre><code>struct co* current;\n</code></pre> <p>\u4e3a\u4e86\u5b9e\u73b0 <code>co_yield</code>\uff0c\u6211\u4eec\uff1a</p> <ol> <li>\u4e3a\u6bcf\u4e00\u4e2a\u534f\u7a0b\u5206\u914d\u72ec\u7acb\u7684\u5806\u6808 (stack)\uff1b\u6808\u9876\u7684\u6307\u9488\u7531 <code>current-&gt;context</code> \u4e2d\u7684 <code>%rsp</code> \u5bc4\u5b58\u5668\u786e\u5b9a\uff1b</li> <li>\u5728 <code>co_yield</code> \u53d1\u751f\u65f6\uff0c\u5c06\u5bc4\u5b58\u5668\u4fdd\u5b58\u5230\u5c5e\u4e8e\u8be5\u534f\u7a0b\u7684 <code>current-&gt;context</code> \u4e2d (\u5305\u62ec <code>%rsp</code>)\uff1b</li> <li>\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u534f\u7a0b\u6267\u884c\uff0c\u627e\u5230\u7cfb\u7edf\u4e2d\u7684\u53e6\u4e00\u4e2a\u534f\u7a0b\uff0c\u7136\u540e\u6062\u590d\u5b83 <code>struct co</code> \u4e2d\u7684\u5bc4\u5b58\u5668\u73b0\u573a (\u5305\u62ec <code>%rsp</code>)\u3002</li> </ol> <p>\u8fd9\u4e2a\u8fc7\u7a0b\u79f0\u4e3a \u201c\u4e0a\u4e0b\u6587\u5207\u6362\u201d\u3002POSIX \u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86 ucontext.h \u7528\u4e8e\u5904\u7406\u7ebf\u7a0b\u7684\u5bc4\u5b58\u5668\u5feb\u7167\uff0c\u5927\u5bb6\u53ef\u4ee5\u5728\u5b9e\u9a8c\u4e2d\u4f7f\u7528\uff0c\u6216\u662f\u7528\u4e4b\u540e\u4ecb\u7ecd\u66f4\u9ad8\u6548\u7684\u65b9\u6cd5\u3002</p> <p>\u26a0\ufe0f\u51c6\u5907\u597d gdb \u8c03\u8bd5\u7684\u5fc3\u7406\u51c6\u5907</p> <p>\u5b9e\u73b0\u4e0a\u4e0b\u6587\u5207\u6362\u5e76\u4e0d\u975e\u5e38\u5bb9\u6613\uff0c\u5728\u6c47\u7f16\u4ee3\u7801\u4e2d\u4f7f\u7528\u5bc4\u5b58\u5668\u9700\u8981\u683c\u5916\u5c0f\u5fc3\u2014\u2014\u5f88\u591a \u201c\u770b\u8d77\u6765\u5bf9\u201d \u7684\u4ee3\u7801\u5b9e\u9645\u5374\u662f\u6709\u7f3a\u9677\u7684\u3002\u5bf9\u4e8e\u5173\u952e\u7684\u4ee3\u7801\uff0c\u4f60\u9700\u8981\u505a\u597d\u7528 gdb \u5355\u6b65\u89c2\u5bdf\u72b6\u6001\u673a\u7684\u5fc3\u7406\u51c6\u5907\u2014\u2014\u800c\u50cf\u8bfe\u5802\u4e0a\u90a3\u6837\uff0c\u5b9e\u73b0\u4e00\u4e9b Python \u811a\u672c\u5219\u662f\u5f88\u6709\u5e2e\u52a9\u7684\u3002</p>"},{"location":"courses/os_lab/M2_libco.html#45","title":"4.5 \u5b9e\u73b0\u534f\u7a0b\u5207\u6362","text":"<p>\u6ce8\u610f\u5230 <code>co_yield</code> \u662f\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\u3002\u7f16\u8bd1\u5668\u5728\u4e3a\u8c03\u7528 <code>co_yield</code> \u751f\u6210\u4ee3\u7801\u65f6\uff0c\u4f1a\u9075\u5faa x86-64 \u7684 calling conventions (System V ABI)\uff1a</p> <ul> <li>\u524d 6 \u4e2a\u53c2\u6570\u5206\u522b\u4fdd\u5b58\u5728 rdi, rsi, rdx, rcx, r8, r9\u3002\u5f53\u7136\uff0c<code>co_yield</code> \u6ca1\u6709\u53c2\u6570\uff0c\u8fd9\u4e9b\u5bc4\u5b58\u5668\u91cc\u7684\u6570\u503c\u4e5f\u6ca1\u6709\u610f\u4e49\u3002</li> <li><code>co_yield</code> \u53ef\u4ee5\u4efb\u610f\u6539\u5199\u4e0a\u9762\u7684 6 \u4e2a\u5bc4\u5b58\u5668\u7684\u503c\u4ee5\u53ca rax (\u8fd4\u56de\u503c), r10, r11\uff0c\u8fd4\u56de\u540e <code>foo</code> \u4ecd\u7136\u80fd\u591f\u6b63\u786e\u6267\u884c\u3002</li> <li><code>co_yield</code> \u8fd4\u56de\u65f6\uff0c\u5fc5\u987b\u4fdd\u8bc1 rbx, rsp, rbp, r12, r13, r14, r15 \u7684\u503c\u548c\u8c03\u7528\u65f6\u4fdd\u6301\u4e00\u81f4 (\u8fd9\u4e9b\u5bc4\u5b58\u5668\u79f0\u4e3a callee saved/non-volatile registers/call preserved, \u548c caller saved/volatile/call-clobbered \u76f8\u53cd)\u3002</li> </ul> <p>\u6362\u53e5\u8bdd\u8bf4\uff0c<code>co_yield</code> \u8fd9\u4e2a \u201c\u51fd\u6570\u8c03\u7528\u201d \u4f7f\u7f16\u8bd1\u5668\u5728\u5e2e\u52a9\u6211\u4eec\u51cf\u5c11\u5b9e\u73b0\u4e0a\u4e0b\u6587\u5207\u6362\u7684\u5de5\u4f5c\u91cf\u2014\u2014\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u50cf ucontext.h \u90a3\u6837\uff0c\u4fdd\u5b58 <code>rdi</code> \u7b49 6 \u4e2a\u5bc4\u5b58\u5668\uff1b\u66f4\u4e0d\u9700\u8981\u4fdd\u5b58\u6d6e\u70b9\u6570\u76f8\u5173\u7684\u5bc4\u5b58\u5668\u3002\u800c\u66f4\u6709\u8da3\u7684\u662f\uff0csetjmp/longjmp \u6070\u597d\u5e2e\u6211\u4eec\u5b9e\u73b0\u4e86 caller save register \u7684\u4fdd\u5b58\u548c\u6062\u590d\u3002</p> <p>\u6211\u4eec\u5b9e\u9645\u5b9e\u73b0\u534f\u7a0b\u5207\u6362\u7684\u4ee3\u7801\u662f</p> <pre><code>void co_yield() {\n    int val = setjmp(current-&gt;context);\n    if (val == 0) {\n        // ?\n    } else {\n        // ?\n    }\n}\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\uff0c<code>setjmp</code> \u4f1a\u8fd4\u56de\u4e24\u6b21 (\u542c\u8d77\u6765\u5f88\u795e\u5947\u5427)\uff1a</p> <ul> <li>\u5728 <code>co_yield()</code> \u88ab\u8c03\u7528\u65f6\uff0c<code>setjmp</code> \u4fdd\u5b58\u5bc4\u5b58\u5668\u73b0\u573a\u540e\u4f1a\u7acb\u5373\u8fd4\u56de <code>0</code>\uff0c\u6b64\u65f6\u6211\u4eec\u9700\u8981\u9009\u62e9\u4e0b\u4e00\u4e2a\u5f85\u8fd0\u884c\u7684\u534f\u7a0b (\u76f8\u5f53\u4e8e\u4fee\u6539 <code>current</code>)\uff0c\u5e76\u5207\u6362\u5230\u8fd9\u4e2a\u534f\u7a0b\u8fd0\u884c\u3002</li> <li><code>setjmp</code> \u662f\u7531\u53e6\u4e00\u4e2a <code>longjmp</code> \u8fd4\u56de\u7684\uff0c\u6b64\u65f6\u4e00\u5b9a\u662f\u56e0\u4e3a\u67d0\u4e2a\u534f\u7a0b\u8c03\u7528 <code>co_yield()</code>\uff0c\u6b64\u65f6\u4ee3\u8868\u4e86\u5bc4\u5b58\u5668\u73b0\u573a\u7684\u6062\u590d\uff0c\u56e0\u6b64\u4e0d\u5fc5\u505a\u4efb\u4f55\u64cd\u4f5c\uff0c\u76f4\u63a5\u8fd4\u56de\u5373\u53ef\u3002</li> </ul> <p>\u4f60\u9700\u8981\u51c6\u5907\u4e00\u4e2a setjmp/longjmp \u7684\u4ee3\u7801\u793a\u4f8b\u2014\u2014\u5982\u679c\u4f60\u5bf9\u4e0b\u9762\u7684\u4f8b\u5b50\u4e0d\u6ee1\u610f\uff0c\u53ef\u4ee5\u5728\u4e92\u8054\u7f51\u4e0a\u5bfb\u627e\uff0c\u4e5f\u53ef\u4ee5\u8ba9 AI \u7ed9\u4f60\u751f\u6210\u4e00\u4e2a\u3002</p> <pre><code>int main() {\n    int n = 0;\n    jmp_buf buf;\n    setjmp(buf);\n    printf(\"Hello %d\\n\", n);\n    longjmp(buf, n++);\n}\n</code></pre> <p>\u7136\u540e\uff0cgdb \u51fa\u573a\uff0c\u82b1\u4e00\u4e9b\u786e\u4fdd\u4f60\u7406\u89e3\u4e86 \u201c\u4fdd\u5b58\u201d \u548c \u201c\u5207\u6362\u201d \u662f\u5982\u4f55\u5b9e\u73b0\u7684\u3002<code>setjmp/longjmp</code> \u7684 \u201c\u5bc4\u5b58\u5668\u5feb\u7167\u201d \u673a\u5236\u8fd8\u88ab\u7528\u6765\u505a\u5f88\u591a\u6709\u8da3\u7684 hacking\uff0c\u4f8b\u5982\u5b9e\u73b0\u4e8b\u52a1\u5185\u5b58\u3001\u5728\u5e76\u53d1 bug \u53d1\u751f\u4ee5\u540e\u7684\u7ebf\u7a0b\u672c\u5730\u8f7b\u91cf\u7ea7 recovery \u7b49\u7b49\u3002</p>"},{"location":"courses/os_lab/M2_libco.html#46","title":"4.6 \u521b\u5efa\u65b0\u534f\u7a0b","text":"<p>\u6bcf\u5f53 <code>co_yield()</code> \u53d1\u751f\u65f6\uff0c\u6211\u4eec\u90fd\u4f1a\u9009\u62e9\u4e00\u4e2a\u534f\u7a0b\u7ee7\u7eed\u6267\u884c\uff0c\u6b64\u65f6\u5fc5\u5b9a\u4e3a\u4ee5\u4e0b\u4e24\u79cd\u60c5\u51b5\u4e4b\u4e00 (\u601d\u8003\u4e3a\u4ec0\u4e48)\uff1a</p> <ol> <li>\u9009\u62e9\u7684\u534f\u7a0b\u662f\u65b0\u521b\u5efa\u7684\uff0c\u6b64\u65f6\u8be5\u534f\u7a0b\u8fd8\u6ca1\u6709\u6267\u884c\u8fc7\u4efb\u4f55\u4ee3\u7801\u2014\u2014\u5b83\u7684 context \u662f\u7a7a\u7684\u3002</li> <li>\u9009\u62e9\u7684\u534f\u7a0b\u662f\u8c03\u7528 <code>yield()</code> \u5207\u6362\u51fa\u6765\u7684\uff0c\u6b64\u65f6\u8be5\u534f\u7a0b\u5df2\u7ecf\u8c03\u7528\u8fc7 <code>setjmp</code> \u4fdd\u5b58\u5bc4\u5b58\u5668\u73b0\u573a\uff0c\u6211\u4eec\u76f4\u63a5 <code>longjmp</code> \u6062\u590d\u5bc4\u5b58\u5668\u73b0\u573a\u5373\u53ef\u3002</li> </ol> <p>\u771f\u6b63\u9ebb\u70e6\u7684\u662f\u7b2c\u4e00\u79cd\u60c5\u51b5\u3002AbstractMachine \u7684\u5b9e\u73b0\u4e2d\u6709\u4e00\u4e2a\u5c0f\u5de7\u7684 <code>stack_switch_call</code> (<code>x86.h</code>)\uff0c\u53ef\u4ee5\u7528\u4e8e\u5207\u6362\u5806\u6808\u540e\u5e76\u6267\u884c\u51fd\u6570\u8c03\u7528\uff0c\u4e14\u80fd\u4f20\u9012\u4e00\u4e2a\u53c2\u6570\uff1a</p> <pre><code>static inline void\nstack_switch_call(void *sp, void *entry, uintptr_t arg) {\n    asm volatile (\n#if __x86_64__\n        \"movq %0, %%rsp; movq %2, %%rdi; jmp *%1\"\n          :\n          : \"b\"((uintptr_t)sp),\n            \"d\"(entry),\n            \"a\"(arg)\n          : \"memory\"\n#else\n        \"movl %0, %%esp; movl %2, 4(%0); jmp *%1\"\n          :\n          : \"b\"((uintptr_t)sp - 8),\n            \"d\"(entry),\n            \"a\"(arg)\n          : \"memory\"\n#endif\n    );\n}\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u501f\u52a9\u8fd9\u4e2a\u51fd\u6570\uff0c\u5207\u6362\u5230\u5168\u65b0\u7684\u534f\u7a0b\u6808\u5e76\u6267\u884c\u51fd\u6570\u3002\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684\u5806\u6808\u5207\u6362\u662f\u4e0d\u53ef\u907f\u514d\u7684\u2014\u2014\u6211\u4eec\u4e5f\u65e0\u6cd5\u7528 C/C++ \u63d0\u4f9b\u7684\u673a\u5236\u5b89\u5168\u5730\u5b9e\u73b0\u5b83\u3002\u6846\u67b6\u4ee3\u7801\u91cc\u6709\u4e00\u884c\u5947\u602a\u7684 <code>CFLAGS += -U_FORTIFY_SOURCE</code>\uff0c\u662f\u7528\u6765\u9632\u6b62 <code>__longjmp_chk</code> \u4ee3\u7801\u68c0\u67e5\u5230\u5806\u6808\u5207\u6362\u4ee5\u540e\u62a5\u9519 (\u5f53\u6210\u662f stack smashing)\u3002Google \u7684 sanitizer \u4e5f\u9047\u5230\u4e86\u76f8\u540c\u7684\u95ee\u9898\u3002</p> <p>\ud83d\udca1\u7eb8\u4e0a\u5f97\u6765\u7ec8\u89c9\u6d45</p> <p>\u65e0\u8bba\u4f60\u89c9\u5f97\u4f60\u7406\u89e3\u5f97\u591a\u4e48 \u201c\u6e05\u695a\u201d\uff0c\u4eb2\u624b\u8c03\u8bd5\u8fc7\u4ee3\u7801\u540e\u7684\u611f\u89c9\u4ecd\u662f\u5f88\u4e0d\u4e00\u6837\u7684\u3002\u4f60\u53ef\u80fd\u4f1a\u82b1\u4e00\u70b9\u65f6\u95f4\uff0c\u82e5\u5e72\u6b21\u8bd5\u9519\uff0c\u624d\u80fd\u5b9e\u73b0\u7b2c\u4e00\u6b21\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u534f\u7a0b\u6267\u884c\u2014\u2014\u5f53\u7136\uff0c\u8fd9\u4f1a\u8ba9\u4f60\u611f\u5230\u975e\u5e38\u7684\u5174\u594b\u3002\u4e4b\u540e\uff0c\u4f60\u8fd8\u4f1a\u9762\u5bf9\u4e00\u4e9b\u6311\u6218\uff0c\u4f8b\u5982\u5806\u6808\u5207\u6362\u540e\u7684\u5bf9\u9f50\u95ee\u9898\u3002\u4f46\u628a\u8fd9\u4e9b\u96be\u5173\u4e00\u4e00\u6392\u9664\u4ee5\u540e\uff0c\u4f60\u4f1a\u53d1\u73b0\u4f60\u5bf9\u8ba1\u7b97\u673a\u7cfb\u7edf (\u4ee5\u53ca \u201c\u7a0b\u5e8f\u662f\u4e2a\u72b6\u6001\u673a\u201d) \u7684\u7406\u89e3\u66f4\u6df1\u523b\u4e86\u3002</p>"},{"location":"courses/os_lab/M2_libco.html#47","title":"4.7 \u8d44\u6e90\u521d\u59cb\u5316\u3001\u7ba1\u7406\u548c\u91ca\u653e","text":"<p>\u2615\ufe0f\u60f3\u5b9e\u73b0\u7a0b\u5e8f\u8fd0\u884c\u524d\u7684\u521d\u59cb\u5316\uff1f</p> <p>\u8bb8\u591a\u5e93\u51fd\u6570\u90fd\u4f1a\u63d0\u4f9b\u4e00\u4e2a init \u51fd\u6570\uff0c\u4f8b\u5982 <code>co_init()</code>\uff0c\u5728\u5e0c\u671b\u4f7f\u7528\u65f6\u8c03\u7528\u3002\u4f46\u534f\u7a0b\u5e93\u5b9e\u9a8c\u4e2d\u6ca1\u6709\u3002\u5982\u679c\u4f60\u5e0c\u671b\u5728\u7a0b\u5e8f\u8fd0\u884c\u524d\u5b8c\u6210\u4e00\u7cfb\u5217\u7684\u521d\u59cb\u5316\u5de5\u4f5c (\u4f8b\u5982\u5206\u914d\u4e00\u4e9b\u5185\u5b58)\uff0c\u53ef\u4ee5\u5b9a\u4e49 <code>__attribute__((constructor))</code> \u5c5e\u6027\u7684\u51fd\u6570\uff0c\u5b83\u4eec\u4f1a\u5728 <code>main</code> \u6267\u884c\u524d\u88ab\u8fd0\u884c\u3002</p> <p>\u5b9e\u9a8c\u4e2d\u6700\u540e\u4e00\u4e2a\u5c0f\u5c0f\u7684\u6311\u6218\u662f\u8d44\u6e90\u7684\u5408\u7406\u5206\u914d\u548c\u56de\u6536\u2014\u2014\u8d44\u6e90\u7ba1\u7406\u662f\u957f\u65f6\u95f4\u8fd0\u884c\u8f6f\u4ef6 (\u548c\u5e93) \u5341\u5206\u91cd\u8981\u7684\u4e3b\u9898\u3002\u5728\u9762\u5411 OJ \u7f16\u7a0b\u65f6\uff0c\u5927\u5bb6\u517b\u6210\u4e86\u5f88\u7cdf\u7cd5\u7684\u4e60\u60ef\uff1a\u53ea\u7ba1\u7533\u8bf7\u3001\u4e0d\u7ba1\u91ca\u653e\uff0c\u4f9d\u8d56\u64cd\u4f5c\u7cfb\u7edf\u5728\u8fdb\u7a0b\u7ed3\u675f\u540e\u81ea\u52a8\u91ca\u653e\u8d44\u6e90\u3002\u4f46\u5982\u679c\u662f\u957f\u671f\u8fd0\u884c\u7684\u7a0b\u5e8f\uff0c\u8fd9\u4e9b\u6ca1\u6709\u91ca\u653e\u4f46\u53c8\u4e0d\u4f1a\u88ab\u4f7f\u7528\u7684\u6cc4\u9732\u8d44\u6e90\u5c31\u6210\u4e86\u5f88\u5927\u4f46\u95ee\u9898\uff0c\u4f8b\u5982\u5728 Windows XP \u65f6\u4ee3\uff0c\u684c\u9762 Windows \u662f\u6ca1\u6709\u529e\u6cd5\u505a\u5230\u5f00\u673a\u4e00\u661f\u671f\u7684\uff0c\u4e00\u5468\u4e4b\u540e\u673a\u5668\u5c31\u4e00\u5b9a\u4f1a\u53d8\u5f97\u5de8\u5361\u65e0\u6bd4\u3002</p> <p>\u7ba1\u7406\u5185\u5b58\u8bf4\u8d77\u6765\u8f7b\u5de7\u2014\u2014\u4e00\u6b21\u5206\u914d\u5bf9\u5e94\u4e00\u6b21\u56de\u6536\u5373\u53ef\uff0c\u4f46\u534f\u7a0b\u5e93\u4e2d\u7684\u8d44\u6e90\u7ba1\u7406\u6709\u4e9b\u5fae\u5999 (\u4f46\u5e76\u4e0d\u590d\u6742)\uff0c\u56e0\u4e3a <code>co_wait</code> \u6267\u884c\u7684\u65f6\u5019\uff0c\u6709\u4e24\u79cd\u4e0d\u540c\u7684\u53ef\u80fd\u6027\uff1a</p> <ol> <li>\u6b64\u65f6\u534f\u7a0b\u5df2\u7ecf\u7ed3\u675f (<code>func</code> \u8fd4\u56de)\uff0c\u8fd9\u662f\u5b8c\u5168\u53ef\u80fd\u7684\u3002\u6b64\u65f6\uff0c<code>co_wait</code> \u5e94\u8be5\u76f4\u63a5\u56de\u6536\u8d44\u6e90\u3002</li> <li>\u6b64\u65f6\u534f\u7a0b\u5c1a\u672a\u7ed3\u675f\uff0c\u56e0\u6b64 <code>co_wait</code> \u4e0d\u80fd\u7ee7\u7eed\u6267\u884c\uff0c\u5fc5\u987b\u8c03\u7528 <code>co_yield</code> \u5207\u6362\u5230\u5176\u4ed6\u534f\u7a0b\u6267\u884c\uff0c\u76f4\u5230\u534f\u7a0b\u7ed3\u675f\u540e\u5524\u9192\u3002</li> </ol> <p>\u2615\ufe0fHook \u534f\u7a0b\u8fd4\u56de</p> <p>\u6211\u4eec\u5e0c\u671b\u5728\u534f\u7a0b\u8fd4\u56de\u65f6\u6267\u884c\u6211\u4eec\u7684\u8d44\u6e90\u91ca\u653e\u4ee3\u7801\u2014\u2014\u56e0\u6b64\u6211\u4eec\u5e0c\u671b \u201chook\u201d \u534f\u7a0b\u6267\u884c\u7684\u4ee3\u7801\uff0c\u5373\u5e0c\u671b <code>co_start(func)</code> \u7684 func \u8fd4\u56de\u65f6\uff0c\u80fd\u8fd4\u56de\u5230\u6211\u4eec\u7684\u4ee3\u7801\u3002\u5b9e\u73b0\u7684\u65b9\u5f0f\u662f\u4f7f\u7528\u7ebf\u7a0b\u5e93\u4e2d\u7684 wrapper (\u8bf7\u5927\u5bb6\u518d\u9605\u8bfb\u4e00\u4e0b thread.h \u4e2d\u521b\u5efa\u7ebf\u7a0b\u7684\u4ee3\u7801):</p> <pre><code>void coroutine_wrapper(void (*func)(void *), void *arg) {\n    func(arg);\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec <code>co_start</code> \u59cb\u7ec8\u521b\u5efa\u4e00\u4e2a\u8c03\u7528 coroutine_wrapper \u7684\u534f\u7a0b\uff0c\u5373\u53ef\u5b9e\u73b0\u8d44\u6e90\u7684\u56de\u6536\u3002</p> <p>\u5e0c\u671b\u5927\u5bb6\u4ed4\u7ec6\u8003\u8651\u597d\u6bcf\u4e00\u79cd\u53ef\u80fd\u7684\u60c5\u51b5\uff0c\u4fdd\u8bc1\u4f60\u7684\u7a0b\u5e8f\u4e0d\u4f1a\u5728\u4efb\u4f55\u4e00\u79cd\u60c5\u51b5\u4e0b crash \u6216\u9020\u6210\u8d44\u6e90\u6cc4\u6f0f\u3002\u7136\u540e\u4f60\u4f1a\u53d1\u73b0\uff0c\u5047\u8bbe\u6bcf\u4e2a\u534f\u7a0b\u90fd\u4f1a\u88ab <code>co_wait</code> \u4e00\u6b21\uff0c\u4e14\u5728 <code>co_wait</code> \u8fd4\u56de\u65f6\u91ca\u653e\u5185\u5b58\u662f\u4e00\u4e2a\u51e0\u4e4e\u4e0d\u53ef\u907f\u514d\u7684\u8bbe\u8ba1\uff1a\u5982\u679c\u5141\u8bb8\u5728\u4efb\u610f\u65f6\u523b\u3001\u4efb\u610f\u591a\u6b21\u7b49\u5f85\u4efb\u610f\u534f\u7a0b\uff0c\u90a3\u4e48\u534f\u7a0b\u521b\u5efa\u65f6\u5206\u914d\u7684\u8d44\u6e90\u5c31\u65e0\u6cd5\u505a\u5230\u81ea\u52a8\u56de\u6536\u4e86\u2014\u2014\u5373\u4fbf\u4e00\u4e2a\u534f\u7a0b\u7ed3\u675f\uff0c\u6211\u4eec\u4e5f\u65e0\u6cd5\u9884\u77e5\u672a\u6765\u662f\u5426\u8fd8\u4f1a\u6267\u884c\u5bf9\u5b83\u7684 <code>co_wait</code>\uff0c\u800c\u5bf9\u5df2\u7ecf\u56de\u6536\u7684 (\u975e\u6cd5) \u6307\u9488\u7684 <code>co_wait</code> \u5c06\u5bfc\u81f4 undefined behavior\u3002C \u8bed\u8a00\u4e2d\u53e6\u4e00\u79cd\u5e38\u89c1 style \u662f\u8ba9\u7528\u6237\u7ba1\u7406\u8d44\u6e90\u7684\u5206\u914d\u548c\u91ca\u653e\uff0c\u663e\u5f0f\u5730\u63d0\u4f9b <code>co_free</code> \u51fd\u6570\uff0c\u5728\u7528\u6237\u786e\u8ba4\u4eca\u540e\u4e0d\u4f1a\u4f7f\u7528\u65f6\u91ca\u653e\u8d44\u6e90\u3002</p> <p>\u8d44\u6e90\u7ba1\u7406\u4e00\u76f4\u662f\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e16\u754c\u7684\u96be\u9898\uff0c\u81f3\u4eca\u5f88\u591a\u7cfb\u7edf\u8fd8\u53d7\u5230\u8d44\u6e90\u6cc4\u6f0f\u3001use-after-free \u7684\u56f0\u6270\u3002\u4f8b\u5982\uff0c\u987a\u7740\u521a\u624d\u8d44\u6e90\u91ca\u653e\u7684\u4f8b\u5b50\uff0c\u4f60\u53ef\u80fd\u4f1a\u611f\u89c9 <code>pthread</code> \u7ebf\u7a0b\u5e93\u4f3c\u4e4e\u6709\u70b9\u9ebb\u70e6\uff1a<code>pthread_create()</code> \u4f1a\u4fee\u6539\u4e00\u4e2a <code>pthread_t</code> \u7684\u503c\uff0c\u7ebf\u7a0b\u8fd4\u56de\u4ee5\u540e\u8d44\u6e90\u4f3c\u4e4e\u5e94\u8be5\u4f1a\u88ab\u91ca\u653e\u3002\u90a3\u4e48\uff1a</p> <ul> <li>\u5982\u679c <code>pthread_join</code> \u53d1\u751f\u5728\u7ed3\u675f\u540e\u4e0d\u4e45\uff0c\u8d44\u6e90\u8fd8\u672a\u88ab\u56de\u6536\uff0c\u51fd\u6570\u4f1a\u7acb\u5373\u8fd4\u56de\u3002</li> <li>\u5982\u679c <code>pthread_join</code> \u53d1\u751f\u5728\u7ed3\u675f\u4ee5\u540e\u4e00\u6bb5\u65f6\u95f4\uff0c\u53ef\u80fd\u4f1a\u5f97\u5230 <code>ESRCH</code> (no such thread) \u9519\u8bef\u3002</li> <li>\u5982\u679c <code>pthread_join</code> \u53d1\u751f\u5728\u4e4b\u540e\u5f88\u4e45\u5f88\u4e45\u5f88\u4e45\u5f88\u4e45\uff0c\u8d44\u6e90\u88ab\u91ca\u653e\u53c8\u88ab\u518d\u6b21\u590d\u7528 (<code>pthread_t</code> \u662f\u4e00\u4e2a\u7684\u786e\u53ef\u80fd\u88ab\u590d\u7528\u7684\u6574\u6570)\uff0c\u6211\u4e0d\u5c31 join \u4e86\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u4e86\u5417\uff1f\u8fd9\u6050\u6015\u8981\u51fa\u5927\u95ee\u9898\u3002</li> </ul> <p>\u5b9e\u9645\u4e0a\uff0cpthread \u7ebf\u7a0b\u9ed8\u8ba4\u662f \u201cjoinable\u201d \u7684\u3002joinable \u7684\u7ebf\u7a0b\u53ea\u8981\u6ca1\u6709 join \u8fc7\uff0c\u8d44\u6e90\u5c31\u4e00\u76f4\u4e0d\u4f1a\u91ca\u653e\u3002\u7279\u522b\u5730\uff0c\u6587\u6863\u91cc\u5199\u660e\uff1a</p> <p>Failure to join with a thread that is joinable (i.e., one that is not detached), produces a \"zombie thread\". Avoid doing this, since each zombie thread consumes some system resources, and when enough zombie threads have accumulated, it will no longer be possible to create new threads (or processes).</p> <p>\u8fd9\u5c31\u662f\u5b9e\u9645\u7cfb\u7edf\u4e2d\u5404\u79cd\u5404\u6837\u7684 \u201c\u5751\u201d\u3002\u5728\u300a\u64cd\u4f5c\u7cfb\u7edf\u300b\u8fd9\u95e8\u8bfe\u7a0b\u4e2d\uff0c\u6211\u4eec\u5c3d\u91cf\u4e0d\u6d89\u53ca\u8fd9\u4e9b\u590d\u6742\u7684\u884c\u4e3a\uff0c\u800c\u662f\u529b\u56fe\u7528\u6700\u5c11\u7684\u4ee3\u7801\u628a\u5fc5\u8981\u7684\u539f\u7406\u89e3\u91ca\u6e05\u695a\u3002\u5f53\u5927\u5bb6\u5bf9\u57fa\u672c\u539f\u7406\u6709\u6df1\u5165\u7684\u7406\u89e3\u540e\uff0c\u968f\u7740\u7ecf\u9a8c\u7684\u589e\u957f\uff0c\u5c31\u4f1a\u6162\u6162\u8003\u8651\u5230\u66f4\u5468\u5168\u7684\u7cfb\u7edf\u8bbe\u8ba1\u3002</p>"},{"location":"courses/os_lab/M2_plcs.html","title":"M2: \u5e76\u884c Longest Common Subsequence (plcs)","text":"<p>M2: \u5e76\u884c Longest Common Subsequence (plcs) (jyywiki.cn)</p>"},{"location":"courses/os_lab/M2_plcs.html#1","title":"1. \u80cc\u666f","text":"<p>\u201c\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\u201d (Longest Common Subsequence, LCS) \u662f\u5927\u5bb6\u719f\u6089\u7684\u7b97\u6cd5\u95ee\u9898\uff0c\u95ee\u9898\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <p>\u7ed9\u5b9a\u4e24\u4e2a\u5b57\u7b26\u4e32 A \u548c B\uff0c\u73b0\u5728\u5141\u8bb8\u4ece A \u548c B \u4e2d\u5206\u522b\u5220\u9664\u4efb\u610f\u6570\u91cf\u7684\u5b57\u7b26\uff0c\u4f46\u5b57\u7b26\u7684\u51fa\u73b0\u7684\u987a\u5e8f\u4e0d\u80fd\u6539\u53d8\uff0c\u5f97\u5230\u5b57\u7b26\u4e32\u2032A\u2032 \u548c \u2032B\u2032\u3002\u95ee\u5982\u4f55\u5220\u9664\uff0c\u4f7f\u5f97\uff1a</p> <ul> <li>C=A\u2032=B\u2032\uff0c\u5373\u5220\u9664\u5269\u4e0b\u7684\u5b57\u7b26\u4e32\u76f8\u540c\uff0cC \u88ab\u79f0\u4e3aA \u548c B \u7684\u4e00\u4e2a \u201c\u516c\u5171\u5b50\u5e8f\u5217\u201d\uff1b</li> <li>\u2223C\u2223 \u5373\u516c\u5171\u5b50\u5e8f\u5217\u7684\u957f\u5ea6\u6700\u5927\u3002</li> </ul> <p>\u4ee5\u4e0b\u662f\u4e00\u4e9b\u4f8b\u5b50\uff1a</p> <ul> <li><code>LCS(\"abcde\", \"ace\") = 3</code>, LCS \u4e3a <code>ace</code></li> <li><code>LCS(\"bcdaacd\", \"acdbac\") = 4</code>, LCS \u4e3a <code>cdac</code></li> <li><code>LCS(\"abc\", \"def\") = 0</code></li> </ul> <p>LCS \u662f\u4e00\u4e2a\u5341\u5206\u7ecf\u5178\u7684\u7b97\u6cd5\u95ee\u9898\uff0c\u4e5f\u662f \u201c\u52a8\u6001\u89c4\u5212\u201d \u7b97\u6cd5\u7684\u5178\u578b\u4ee3\u8868\u3002\u5927\u5bb6\u53ef\u4ee5\u5728\u4e92\u8054\u7f51\u4e0a\u67e5\u627e LCS \u95ee\u9898\u7684\u6c42\u89e3\u65b9\u6cd5\uff1b\u6216\u662f\u5728\u4e92\u8054\u7f51\u4e0a\u5bfb\u627e\u8bb2\u89e3\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\u7684\u89c6\u9891\u6559\u7a0b\u3002</p>"},{"location":"courses/os_lab/M2_plcs.html#2","title":"2. \u5b9e\u9a8c\u63cf\u8ff0","text":"<p>\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u6211\u4eec\u5df2\u7ecf\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5355\u7ebf\u7a0b\u7684 LCS \u7b97\u6cd5\u5b9e\u73b0\u3002\u4f60\u9700\u8981\u5c06\u5b83\u5e76\u884c\u5316\uff0c\u4f7f\u5b83\u80fd\u5229\u7528\u591a\u5904\u7406\u5668\u5e76\u884c\u7684\u8ba1\u7b97\u529b\u52a0\u901f\u8ba1\u7b97\u3002</p> <p>\u6ce8\u610f\uff1a\u5b58\u5728\u4e00\u4e9b\u7b97\u6cd5 trick \u80fd\u52a0\u901f LCS \u7684\u8ba1\u7b97\uff0c\u4f46\u6211\u4eec\u7684\u8981\u6c42\u662f\u5c06\u6211\u4eec\u7ed9\u51fa\u7684 naive \u52a8\u6001\u89c4\u5212\u7b97\u6cd5\u5e76\u884c\u5316\u3002</p>"},{"location":"courses/os_lab/M2_plcs.html#21","title":"2.1 \u603b\u89c8","text":"<p>\u200b                                                                                                               \\(plcs [T]\\)</p>"},{"location":"courses/os_lab/M2_plcs.html#22","title":"2.2. \u63cf\u8ff0","text":"<p>\u521b\u5efa T (T\u226416) \u4e2a\u7ebf\u7a0b\u6c42\u89e3\u5b57\u7b26\u4e32\u7684\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\u3002plcs \u547d\u4ee4\u4ece\u6807\u51c6\u8f93\u5165\u4e2d\u8bfb\u53d6\u4e24\u4e2a\u5b57\u7b26\u4e32\uff0c\u5e76\u5c06 LCS \u7684\u957f\u5ea6\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\u3002\u6211\u4eec\u4fdd\u8bc1\u8f93\u5165\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u5747\u4e0d\u8d85\u8fc7 10,000\u3002</p> <p>\u5f53\u4e0d\u63d0\u4f9b\u53c2\u6570 T \u65f6\uff0cT=1\uff0c\u5373\u4e32\u884c\u6c42\u89e3\u3002</p>"},{"location":"courses/os_lab/M2_plcs.html#23","title":"2.3. \u89e3\u91ca","text":"<p>\u6846\u67b6\u4ee3\u7801\u4e2d\u5df2\u7ecf\u5305\u542b\u4e86\u4e32\u884c LCS \u7684\u5b9e\u73b0\uff0c\u5b83\u7684\u529f\u80fd\u662f\u6b63\u786e\u7684 (\u521b\u5efa\u4e86\u591a\u4e2a\u7ebf\u7a0b\uff0c\u4f46\u4e0d\u80fd\u5e76\u884c\u6c42\u89e3)\u3002\u4f60\u5728\u5e76\u884c\u5316\u7684\u8fc7\u7a0b\u4e2d\uff0c\u9700\u8981\u9075\u5b88\u4ee5\u4e0b\u7ea6\u5b9a\uff1a</p> <ul> <li>\u4f60\u4e0d\u80fd\u521b\u5efa\u8d85\u8fc7 T \u4e2a\u7ebf\u7a0b (<code>main</code> \u6240\u5728\u7684\u7ebf\u7a0b\u4e0d\u8ba1\u5165\uff0c\u56e0\u6b64\u4f60\u53ef\u4ee5\u5229\u7528 <code>main</code> \u7ebf\u7a0b)</li> <li>\u4f60\u53ea\u80fd\u4f7f\u7528\u7eaf\u7cb9\u7684\u8ba1\u7b97\u548c\u7ed9\u51fa\u7684\u6846\u67b6\u4ee3\u7801 <code>thread.h/thread-sync.h</code> \u4e2d\u63d0\u4f9b\u7684 API (\u5176\u4e2d\u5305\u62ec lock \u548c unlock)</li> </ul> <p>\u8bf7\u7279\u522b\u6ce8\u610f\uff1alock/unlock \u53ea\u80fd\u4fdd\u62a4\u548c\u5176\u4ed6 lock/unlock \u4ee3\u7801\u4e4b\u95f4\u7684\u4e92\u65a5\uff1b\u6301\u6709\u9501\u7684\u7ebf\u7a0b\u4ecd\u7136\u4f1a\u548c\u5176\u4ed6\u4e0d\u4f7f\u7528 lock/unlock \u7684\u4ee3\u7801\u5728\u591a\u4e2a\u5904\u7406\u5668\u4e0a\u5e76\u884c\u6267\u884c\u3002\u6b64\u65f6\uff0c\u8bbf\u95ee\u5171\u4eab\u5185\u5b58 (\u81f3\u5c11\u6709\u4e00\u4e2a\u662f\u5199) \u5c06\u5bfc\u81f4\u6570\u636e\u7ade\u4e89\uff0c\u8fd9\u662f\u4e00\u79cd\u5f88\u5e38\u89c1\u7684\u5e76\u53d1 bug\u3002</p>"},{"location":"courses/os_lab/M2_plcs.html#3","title":"3. \u6b63\u786e\u6027\u6807\u51c6","text":"<p>\u9996\u5148\uff0c\u4f60\u7684\u7a0b\u5e8f\u4ecd\u7136\u5e94\u8be5\u80fd\u591f\u6b63\u786e\u8f93\u51fa\u6700\u957f\u516c\u5171\u5b50\u4e32 LCS \u7684\u6570\u503c\u3002</p> <p>\u5176\u6b21\uff0c\u4f60\u4e0d\u5e94\u8be5\u5927\u5e45\u4fee\u6539\u6211\u4eec\u7ed9\u51fa\u7684\u7b97\u6cd5\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u9884\u671f\u5728 T=1 \u65f6\uff0c\u4f60\u7684\u4ee3\u7801\u7684\u8fd0\u884c\u65f6\u95f4\u4e0e\u6846\u67b6\u4ee3\u7801\u76f8\u5f53\u3002</p> <p>\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u6211\u4eec\u9700\u8981\u89c2\u6d4b\u5230\u5728\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u8db3\u591f\u5927 (\u5982 10,000) \u65f6\uff0c\u4f60\u7684\u4ee3\u7801\u5728\u4e00\u4e2a\u591a\u5904\u7406\u5668 (\u4e0d\u5c11\u4e8e 4 \u4e2a\u5904\u7406\u5668) \u7684 Online Judge \u8bc4\u6d4b\u673a\u4e0a\uff0cT=1,2,4 \u65f6\u63a5\u8fd1\u4e8e T \u500d\u7684\u7ebf\u6027\u52a0\u901f\u3002</p>"},{"location":"courses/os_lab/M2_plcs.html#4","title":"4. \u5b9e\u9a8c\u6307\u5357","text":""},{"location":"courses/os_lab/M2_plcs.html#41","title":"4.1. \u5bfb\u627e\u5e76\u884c\u7684\u673a\u4f1a","text":"<p>\u6211\u4eec\u53ef\u4ee5\u628a LCS \u7684\u52a8\u6001\u89c4\u5212\u7b97\u6cd5 (\u65e0\u8bba\u662f\u9012\u5f52\u6c42\u89e3\uff0c\u8fd8\u662f\u8fed\u4ee3\u6c42\u89e3) \u90fd\u770b\u6210\u662f\u4e00\u4e2a\u6709\u5411\u65e0\u73af\u56fe\u4e0a\u7684\u8ba1\u7b97\uff1a\u4e3a\u4e86\u5f97\u5230f(i,j) \u7684\u503c\uff0c\u6211\u4eec\u5c31\u9700\u8981f(i\u22121,j)\u3001f(i,j\u22121) \u548c f(i\u22121,j\u22121) \u7684\u503c\u3002\u53ea\u6709\u5728\u8fd9\u4e09\u4e2a\u503c\u90fd\u88ab\u6b63\u786e\u8ba1\u7b97\u7684\u524d\u63d0\u4e0b\uff0c\u6211\u4eec\u624d\u80fd\u6b63\u786e\u8ba1\u7b97 f(i,j)\uff1a</p> <p></p> <p>\u5f88\u81ea\u7136\u5730\uff0c\u6211\u4eec\u9009\u62e9\u7528\u4efb\u4f55 \u201c\u8ba1\u7b97\u56fe\u201d \u4e0a\u7684\u62d3\u6251\u5e8f\u8ba1\u7b97\uff0c\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u4e2a\u8282\u70b9\u8ba1\u7b97\u65f6\uff0c\u5b83\u9700\u8981\u7684\u6570\u636e\u90fd\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u4e8e\u662f\u6709\u4e86\u6846\u67b6\u4ee3\u7801\u4e2d\u7684\u4e8c\u91cd\u5faa\u73af\uff0c\u5b83\u4ee3\u8868\u4e86\u4e00\u79cd\u62d3\u6251\u987a\u5e8f\uff1a</p> <pre><code>for (int i = 0; i &lt; N; i++) {\n  for (int j = 0; j &lt; M; j++) {\n    // Always try to make DP code more readable\n    int skip_a = DP(i - 1, j);\n    int skip_b = DP(i, j - 1);\n    int take_both = DP(i - 1, j - 1) + (A[i] == B[j]);\n    dp[i][j] = MAX3(skip_a, skip_b, take_both);\n  }\n}\n</code></pre> <p>\u7136\u800c\uff0c\u91cc\u5c42\u5faa\u73af\u5374\u4e0d\u80fd\u88ab\u76f4\u63a5\u5e76\u884c\uff1a\u5f53 i \u56fa\u5b9a\u65f6\uff0c\u8ba1\u7b97 f(i,j) \u9700\u8981 f(i,j\u22121) \u7684\u503c\u3002\u90a3\u4e48\uff0c\u5e94\u8be5\u6309\u7167\u4ec0\u4e48\u6837\u7684\u987a\u5e8f\u8ba1\u7b97\u5462\uff1f\u4e0d\u59a8\u628a\u77e9\u5f62\u65cb\u8f6c 45 \u5ea6\u2014\u2014\u4f60\u4f1a\u53d1\u73b0\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 2n\u22121 \u201c\u6b65\u201d \u4e4b\u5185\u8ba1\u7b97\u5b8c\u6240\u6709\u8282\u70b9\u4e0a\u7684\u6570\u503c\uff0c\u800c\u6bcf\u4e00\u6b65\u91cc\u7684\u8282\u70b9\u90fd\u662f\u53ef\u4ee5\u5e76\u884c\u8ba1\u7b97\u7684\uff1a</p> <p></p> <p>\u5728\u8fd9\u5f20\u56fe\u4e2d\uff0c\u53ea\u8981\u7ea2\u7ebf \u201c\u4e0a\u9762\u201d \u7684 f(i,j) \u90fd\u88ab\u6b63\u786e\u8ba1\u7b97\u51fa\u6765\uff0c\u7ea2\u7ebf\u4e0a\u7684 f(i,j) \u5c31\u53ef\u4ee5\u5e76\u884c\u8ba1\u7b97\u3002\u5f53\u5b57\u7b26\u4e32\u957f\u5ea6\u8db3\u591f\u65f6\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u5c31\u53ef\u4ee5\u5206\u914d\u5230\u8db3\u591f\u7684\u5de5\u4f5c\u91cf\u4e86\u3002</p>"},{"location":"courses/os_lab/M2_plcs.html#42","title":"4.2. \u5e76\u884c\u7b97\u6cd5\u8bbe\u8ba1\u539f\u7406","text":"<p>\u5982\u679c\u6211\u4eec\u628a\u6bcf\u4e2a\u8282\u70b9\u770b\u4f5c\u662f\u6d88\u8017\u65f6\u957f\u5927\u81f4\u76f8\u7b49\u7684\u8ba1\u7b97\u3001\u628a\u8fb9\u770b\u6210\u662f\u8282\u70b9\u8ba1\u7b97\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u8ba1\u7b97\u7684\u4f9d\u8d56\u56fe (dependency graph)\u3002\u8ba1\u7b97\u56fe\u7684\u6df1\u5ea6\u51b3\u5b9a\u4e86\u5e76\u884c\u7b97\u6cd5\u7684\u65f6\u95f4\u4e0b\u9650\u2014\u2014\u4efb\u4f55\u4e00\u6761\u957f\u5ea6\u4e3a d \u7684\u8def\u5f84\u90fd\u610f\u5473\u7740\u6211\u4eec\u9700\u8981\u81f3\u5c11 d \u6b65\u7684\u4e32\u884c\u8ba1\u7b97\u3002\u800c\u5728\u6bcf\u4e2a\u8282\u70b9\u7684\u8ba1\u7b97\u65f6\u95f4\u8fdc\u8fdc\u5927\u4e8e\u7ebf\u7a0b\u8c03\u5ea6/\u540c\u6b65\u5f00\u9500\u65f6\uff0c\u5047\u8bbe\\(T_n\\) \u662f n\u4e2a\u5904\u7406\u5668\u6267\u884c\u7684\u6700\u4f18\u65f6\u95f4\uff0c\u90a3\u4e48\u6709 Brent's Theorem</p> <p>\u200b                                                                                                   \\(\\frac{T_1}{p} \\le T_p \\le \\frac{T_1}{p} + T_{\\infty}\\)</p> <p>\u7531\u4e8e \\(T_{\\infty}\\) \u5219\u53ef\u4ee5\u901a\u8fc7\u5728\u8ba1\u7b97\u4f9d\u8d56\u56fe\u4e0a\u7acb\u5373\u5e76\u884c\u6267\u884c\u4e00\u5207\u53ef\u6267\u884c\u7684\u8ba1\u7b97\u5b9e\u73b0\uff0c\u8fd9\u4e2a\u7ed3\u8bba\u610f\u5473\u7740\u6211\u4eec\u51e0\u4e4e\u603b\u662f\u53ef\u4ee5\u5e76\u884c \u201c\u53ef\u5e76\u884c\u201d \u7684\u90e8\u5206\u3002\u5728\u5b9e\u9645\u5e76\u884c\u5316\u7a0b\u5e8f\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u8ba1\u7b97\u56fe\u5206\u6210\u82e5\u5e72\u8f6e\u6b21\u7684\u8fed\u4ee3 (\u4f8b\u5982 LCS \u4e2d\uff0c\u6839\u636e\u5bf9\u89d2\u7ebf\u5212\u5206\u8fed\u4ee3\u7684\u8f6e\u6b21)\uff0c\u5728\u6bcf\u4e00\u4e2a\u8f6e\u6b21\u4e2d\uff0c\u5747\u5300\u5730\u628a\u4efb\u52a1\u5206\u914d\u7ed9\u5404\u4e2a\u7ebf\u7a0b\u6267\u884c\u3002</p>"},{"location":"courses/os_lab/M2_plcs.html#43","title":"4.3. \u5b9e\u73b0\u5e76\u884c\u6c42\u89e3","text":"<p>\u5728\u7406\u89e3\u4e86\u5e76\u884c\u7b97\u6cd5\u7684\u8bbe\u8ba1\u539f\u7406\u4ee5\u540e\uff0c\u5b9e\u73b0\u5e76\u884c LCS \u5c31\u4e0d\u56f0\u96be\u4e86\uff1a</p> <pre><code>for (int round = 0; round &lt; 2 * n - 1; round++) {\n  // 1. \u8ba1\u7b97\u51fa\u672c\u8f6e\u80fd\u591f\u8ba1\u7b97\u7684\u5355\u5143\u683c\n  // 2. \u5c06\u4efb\u52a1\u5206\u914d\u7ed9\u7ebf\u7a0b\u6267\u884c\n  // 3. \u7b49\u5f85\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\n}\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u6846\u67b6\u53ef\u4ee5\u4f7f\u7528\u540c\u6b65\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e92\u65a5\u5b9e\u73b0\u3002\u53e6\u5916\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u5f53\u672c\u8f6e\u8ba1\u7b97\u91cf\u8db3\u591f\u5c0f\u65f6\uff0c\u5e76\u884c\u5316\u5e26\u6765\u7684\u6536\u76ca\u672a\u5fc5\u5212\u7b97 (\u6267\u884c\u989d\u5916\u540c\u6b65\u64cd\u4f5c\u7684\u65f6\u95f4\u53ef\u80fd\u548c\u76f4\u63a5\u4e32\u884c\u6267\u884c\u76f8\u5dee\u65e0\u51e0)\u3002\u6b64\u5916\uff0c\u7f13\u5b58\u8bbf\u95ee\u7684\u5c40\u90e8\u6027\u4e5f\u662f\u5e76\u884c\u5316\u7b97\u6cd5\u7684\u4e00\u4e2a\u91cd\u8981\u8003\u8651\u3002\u8fd9\u90e8\u5206\u5185\u5bb9\u4ea4\u7ed9\u5927\u5bb6\u81ea\u7531\u63a2\u7d22\u3002</p>"},{"location":"courses/os_lab/M3_sperf.html","title":"M3: \u7cfb\u7edf\u8c03\u7528 Profiler (sperf)","text":"<p>M3: \u7cfb\u7edf\u8c03\u7528 Profiler (sperf) (jyywiki.cn)</p>"},{"location":"courses/os_lab/M3_sperf.html#1","title":"1. \u80cc\u666f","text":"<p>\u5f88\u591a\u80fd\u591f\u89c2\u5bdf\u72b6\u6001\u673a\u6267\u884c\u7684\u5de5\u5177\uff1agdb (step/stepi \u5355\u6b65\u6267\u884c)\u3001strace (\u67e5\u770b\u7cfb\u7edf\u8c03\u7528)\u3002</p> <p>\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u4f7f\u7528\u8bfe\u5802\u4e0a\u5b66\u8fc7\u7684\u8fdb\u7a0b\u7ba1\u7406 API\uff0c\u53bb\u542f\u52a8\u4e00\u4e2a\u8fd9\u6837\u7684\u5de5\u5177\uff0c\u5e76\u83b7\u5f97\u5b83\u4eec\u7684\u8f93\u51fa\u3002\u5177\u4f53\u800c\u8a00\uff0c\u4f60\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e2a\u5c5e\u4e8e\u81ea\u5df1\u7684\u7cfb\u7edf\u8c03\u7528 profiler\uff0c\u751a\u81f3\u53ef\u4ee5\u548c\u56fe\u5f62\u754c\u9762\u91cc\u7684\u4e00\u6837 cool\uff1a</p> <p></p>"},{"location":"courses/os_lab/M3_sperf.html#11-trace","title":"1.1. Trace \u5de5\u5177","text":"<p>Trace \u5de5\u5177\u662f\u7cfb\u7edf\u7f16\u7a0b\u65f6\u975e\u5e38\u5e38\u7528\u7684\u95ee\u9898\u8bca\u65ad\u5de5\u5177\u3002trace \u53cd\u5e94\u4e86\u7a0b\u5e8f\u6267\u884c\u7684\u6d41\u7a0b\uff0c\u56e0\u6b64\u53ef\u4ee5\u5e2e\u52a9\u4f60\u7f29\u5c0f bug \u6240\u5728\u7684\u8303\u56f4 (\u8c03\u8bd5\u7684\u76ee\u6807\u662f\u627e\u5230\u7b2c\u4e00\u4e2a\u53d1\u751f error \u7684\u7a0b\u5e8f\u72b6\u6001)\uff1b\u6b64\u5916\uff0ctrace \u4e2d\u989d\u5916\u7684\u4fe1\u606f\u8fd8\u80fd\u5e2e\u52a9\u8bca\u65ad\u6027\u80fd\u7b49\u95ee\u9898 (\u4f8b\u5982\u4f60\u7684\u7a0b\u5e8f\u662f\u5426\u5728\u67d0\u4e2a\u7cfb\u7edf\u8c03\u7528\u4e0a\u82b1\u53bb\u4e86\u5927\u91cf\u7684\u65f6\u95f4)\u3002\u9664\u4e86\u6211\u4eec\u719f\u77e5\u7684 strace, ltrace\uff0c\u5176\u5b9e trace \u5e7f\u6cdb\u5730\u5b58\u5728\u4e8e\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684\u5404\u4e2a\u5c42\u9762\u4e0a\uff1a</p> <ul> <li>\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838 (\u4f8b\u5982 Linux) \u63d0\u4f9b\u4e86\u591a\u79cd trace \u673a\u5236\uff0c\u6709\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u53c2\u8003 ftrace\uff1b</li> <li>\u6d4f\u89c8\u5668\u7684\u5f00\u53d1\u8005\u6a21\u5f0f (F12 \u63a7\u5236\u53f0\uff0c\u60f3\u5fc5\u5927\u5bb6\u5df2\u7ecf\u7528\u5b83\u67e5\u770b\u8fc7\u8bfe\u7a0b\u7f51\u7ad9\u7684 slides \u662f\u5982\u4f55\u5b9e\u73b0\u7684\u4e86) \u4e2d\uff0c\u80fd\u591f trace \u7f51\u7edc\u7b49\u8bf7\u6c42\u2014\u2014\u522b\u5c0f\u770b\u5b83\uff0c\u8fd9\u4e5f\u662f\u4e00\u79cd trace\uff01\u800c\u4e14\u5b83\u5bf9\u8c03\u8bd5\u7f51\u7ad9\u7684\u529f\u80fd\u6027\u95ee\u9898\u548c\u6027\u80fd\u95ee\u9898\u90fd\u662f\u81f3\u5173\u91cd\u8981\u7684\uff1b</li> <li>\u901a\u8fc7 Java Virtual Machine Tool Interface (JVMTI) \u5728 Java \u865a\u62df\u673a\u4e2d\u521b\u5efa agent\uff0c\u6536\u96c6\u7a0b\u5e8f\u6267\u884c\u7684\u4fe1\u606f\u3002</li> </ul> <p>\u5728 trace \u7684\u57fa\u7840\u4e0a\uff0c\u6211\u4eec\u5b9e\u73b0\u7a0b\u5e8f\u7684\u6027\u80fd\u8bca\u65ad\u5de5\u5177 (\u867d\u7136 strace \u7684\u8bbe\u8ba1\u610f\u56fe\u672c\u8eab\u5e76\u4e0d\u4e3b\u8981\u662f\u4e3a\u4e86\u8bca\u65ad\u6027\u80fd\u95ee\u9898)\uff0c\u5b83\u80fd\u591f\u5e2e\u52a9\u4f60\u627e\u5230\u7a0b\u5e8f\u8fd0\u884c\u65f6\u8017\u65f6\u6700\u591a\u7684\u90a3\u4e9b\u7cfb\u7edf\u8c03\u7528\uff0c\u4ece\u800c\u627e\u5230\u7a0b\u5e8f\u7684\u6027\u80fd\u74f6\u9888\u3002Profiler \u80fd\u591f\u63d0\u4f9b\u7cfb\u7edf\u6027\u80fd\u5206\u6790\u7684\u62a5\u544a\u2014\u2014\u800c\u4e14\u8fd9\u4ef6\u4e8b\u4e00\u70b9\u4e5f\u4e0d\u96be\uff0c\u6211\u4eec\u53ea\u8981\u5206\u6790 trace \u7684\u8f93\u51fa\u5c31\u53ef\u4ee5\u4e86\u3002\u4f7f\u7528\u9002\u5f53\u7684\u5de5\u5177\uff0c\u751a\u81f3\u53ef\u4ee5\u6839\u636e trace \u7684\u7ed3\u679c\u8f93\u51fa\u4e00\u4e2a\u53ef\u4ea4\u4e92\u7684 Flame Graph:</p> <p></p> <p>Flame graph \u662f\u8bca\u65ad\u6027\u80fd\u95ee\u9898\u7684\u5229\u5668\u3002</p>"},{"location":"courses/os_lab/M3_sperf.html#2","title":"2. \u5b9e\u9a8c\u63cf\u8ff0","text":"<p>\u5b9e\u73b0\u547d\u4ee4\u884c\u5de5\u5177 <code>sperf</code>\uff1a</p> <p>\u200b                                                                                                   <code>sperf COMMAND [ARG]...</code></p> <p>\u5b83\u4f1a\u5728\u7cfb\u7edf\u4e2d\u6267\u884c COMMAND \u547d\u4ee4 (\u5982\u679c COMMAND \u662f\u4ee5 <code>/</code> \u5f00\u5934\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u5219\u76f4\u63a5\u6267\u884c\uff1b\u5426\u5219\u5728 <code>PATH</code> \u73af\u5883\u53d8\u91cf\u4e2d\u641c\u7d22\u5230\u7b2c\u4e00\u4e2a\u5b58\u5728\u4e14\u53ef\u6267\u884c\u7684\u6587\u4ef6)\uff0c\u5e76\u4e3a COMMAND \u4f20\u5165 ARG \u53c2\u6570 (\u5217\u8868)\uff0c\u7136\u540e\u7edf\u8ba1\u547d\u4ee4\u6267\u884c\u7684\u7cfb\u7edf\u8c03\u7528\u6240\u5360\u7684\u65f6\u95f4\u3002\u4f8b\u5982\u6267\u884c <code>sperf find /</code> \u4f1a\u5728\u7cfb\u7edf\u4e2d\u6267\u884c <code>find /</code>\uff0c\u5e76\u4e14\u5728\u5c4f\u5e55\u4e0a\u663e\u793a\u51fa\u8017\u65f6\u6700\u591a\u7684\u82e5\u5e72\u7cfb\u7edf\u8c03\u7528\u7684\u65f6\u95f4\u3002</p> <p>\u4e00\u4e9b\u5047\u8bbe\u548c\u7ea6\u5b9a\uff1a</p> <ul> <li>\u8f93\u51fa\u7684\u5f62\u5f0f\u4e0d\u9650\u3002\u5bf9\u4e8e\u8f83\u77ed\u65f6\u95f4\u8fd0\u884c\u7684\u7a0b\u5e8f\uff0c\u4f60\u53ef\u4ee5\u4e00\u6b21\u6027\u6253\u5370\u51fa\u8017\u65f6\u6700\u591a\u7684\u51e0\u4e2a\u7cfb\u7edf\u8c03\u7528\uff1b\u5bf9\u4e8e\u8017\u65f6\u8f83\u957f\u7684\u7a0b\u5e8f\uff0c\u4f60\u9700\u8981\u5b9a\u671f (\u5982\u6bcf\u79d2) \u6253\u5370\u51fa\u7cfb\u7edf\u8c03\u7528\u7684\u8017\u65f6\u4fe1\u606f\uff1b</li> <li>\u5047\u8bbe <code>COMMAND</code> \u662f\u5355\u8fdb\u7a0b\u3001\u5355\u7ebf\u7a0b\u7684\uff0c\u65e0\u9700\u5904\u7406\u591a\u8fdb\u7a0b (<code>fork</code>) \u548c\u591a\u7ebf\u7a0b (<code>clone</code>/<code>pthread_create</code>) \u7684\u60c5\u51b5\uff1b\u867d\u7136 strace \u660e\u786e\u652f\u6301\u591a\u8fdb\u7a0b/\u591a\u7ebf\u7a0b\u7a0b\u5e8f\u3002</li> <li>\u4f5c\u4e3a\u5bf9\u5927\u5bb6\u7684\u8003\u9a8c\uff0c\u5fc5\u987b\u4f7f\u7528 execve \u7cfb\u7edf\u8c03\u7528\uff1b\u4f7f\u7528 glibc \u5bf9 execve \u7684\u5305\u88c5 (execl, execlp, execle, execv, execvp, execvpe) \u5c06\u5bfc\u81f4\u7f16\u8bd1\u9519\u8bef\uff0c\u4f46\u6211\u4eec\u9f13\u52b1\u4f60\u9605\u8bfb\u540e\u8005\u7684\u624b\u518c\u3002</li> </ul>"},{"location":"courses/os_lab/M3_sperf.html#execve","title":"\u53ea\u5141\u8bb8\u7528 execve\uff1f","text":"<p>\u5728\u7ec8\u7aef\u91cc\uff0c\u6211\u4eec\u8f93\u5165 \u201cstrace\u201d \u4ee5\u540e\uff0c\u4e3a\u4ec0\u4e48 <code>/usr/bin/strace</code> \u4f1a\u88ab\u627e\u5230\u6267\u884c\uff1f\u4e3a\u4ec0\u4e48\u8f93\u5165 <code>a.out</code> \u5f53\u524d\u76ee\u5f55\u4e0b\u7684 <code>a.out</code> \u4e0d\u4f1a\u88ab\u6267\u884c (\u5fc5\u987b\u8981 <code>./a.out</code>?) \u8def\u5f84\u7684\u89e3\u6790\u662f\u901a\u8fc7 <code>PATH</code> \u73af\u5883\u53d8\u91cf\u5b9e\u73b0\u7684\uff0c\u5982\u679c\u6267\u884c\u547d\u4ee4\uff0c\u4f1a\u9010\u4e2a\u5c1d\u8bd5 <code>PATH</code> \u73af\u5883\u53d8\u91cf\u4e2d\u7684\u8def\u5f84\uff0c\u76f4\u5230\u627e\u4e0d\u5230\u540e\u624d\u5931\u8d25\u3002</p> <p>\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u91cc\uff0c\u4e3a\u4e86\u5f3a\u8feb\u5927\u5bb6\u7406\u89e3\u73af\u5883\u53d8\u91cf\uff0c\u6211\u4eec\u8bbe\u7f6e\u4e86\u4e24\u4e2a\u5751\uff1a</p> <ol> <li>\u5fc5\u987b\u4f7f\u7528 execve\uff0c\u5e76\u4e14 strace \u7684\u53ef\u6267\u884c\u6587\u4ef6\u5e76\u4e0d\u4f4d\u4e8e <code>/usr/bin</code>\uff0c\u4f46\u5b83\u7684\u786e\u5728 <code>PATH</code> \u73af\u5883\u53d8\u91cf\u4e2d\u7684\u67d0\u4e2a\u76ee\u5f55\u4e2d\u3002\u56e0\u6b64\u5982\u679c\u4f60\u76f4\u63a5 <code>execve(\"/usr/bin/strace\", ...)</code> \u5c06\u4f1a\u5931\u8d25\uff1b</li> <li>\u5fc5\u987b\u6b63\u786e\u5904\u7406\u4f20\u9012\u7ed9\u5b50\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5426\u5219\u5c06\u5728 hard test \u53d1\u751f Wrong Answer\u3002</li> </ol>"},{"location":"courses/os_lab/M3_sperf.html#3","title":"3. \u6b63\u786e\u6027\u6807\u51c6","text":"<p>\u5224\u5b9a\u6b63\u786e\u6027\uff1a</p> <ul> <li>\u81f3\u5c11\u8f93\u51fa\u8017\u65f6 top 5 \u7684\u7cfb\u7edf\u8c03\u7528\u3001\u6bcf\u4e2a\u7cfb\u7edf\u8c03\u7528\u81f3\u591a\u8f93\u51fa\u4e00\u6b21 (\u5728\u5c4f\u5e55\u4e0a\u7edf\u4e00\u4f4d\u7f6e\u8986\u76d6\u7b97\u8f93\u51fa\u591a\u6b21)\uff1b</li> <li>\u8f93\u51fa\u7cfb\u7edf\u8c03\u7528\u5728 strace \u8f93\u51fa\u4e2d\u7684\u5c0f\u5199\u540d\u5b57\u3001\u5728\u7cfb\u7edf\u8c03\u7528\u8017\u65f6\u6bd4\u4f8b\u7684\u5de6\u53f3\u5199\u4e0a\u5c0f\u62ec\u53f7\uff0c\u6309\u7167 \u201c<code>(XX%)</code>\u201d\uff0c\u5373 <code>printf(\"(%d%%)\", ratio)</code> \u7684\u683c\u5f0f\u8f93\u51fa\u7cfb\u7edf\u8c03\u7528\u8017\u65f6\u6240\u5360\u7684\u767e\u5206\u6bd4\uff1b</li> <li>\u9664\u4e86\u7cfb\u7edf\u8c03\u7528\u7684\u540d\u5b57\u548c\u8017\u65f6\u4ee5\u5916\uff0c\u4e0d\u8981\u8f93\u51fa\u989d\u5916\u7684\u5b57\u6bcd\u548c\u6570\u5b57 (ANSI Escape Code \u662f\u5141\u8bb8\u7684)\uff1b</li> <li>\u5728\u7edf\u8ba1\u4fe1\u606f\u8f93\u51fa\u5b8c\u6bd5\u540e\uff0c\u6253\u5370 80 \u4e2a <code>\\0</code> (\u6ce8\u610f\u4e0d\u662f <code>'0'</code>\uff0c\u662f\u6570\u503c\u4e3a 0 \u7684\u5b57\u7b26\uff0c\u5b83\u4eec\u4e0d\u4f1a\u5728\u7ec8\u7aef\u4e0a\u663e\u793a)\u3002\u6211\u4eec\u5c06\u4ee5\u8fd9 80 \u4e2a <code>\\0</code> \u4f5c\u4e3a\u5212\u5206\uff1b</li> <li>\u8f93\u51fa\u8fc7\u4e8e\u9891\u7e41\u4f1a\u81f4 Output Limit Exceeded\u3002\u6bcf\u79d2\u8f93\u51fa\u4e00\u6b21\u662f\u8f83\u4e3a\u5408\u7406\u7684\u3002</li> </ul> <p>\u7279\u522b\u6ce8\u610f\uff1a</p> <ul> <li>\u8bf7\u4e0d\u8981\u6df7\u5408\u4f60\u7684\u8f93\u51fa\u548c\u88ab\u8ffd\u8e2a\u8fdb\u7a0b\u7684\u8f93\u51fa\uff0c\u5426\u5219\u5c06\u53ef\u80fd\u4f1a\u5bfc\u81f4 Wrong Answer\uff1b</li> <li>\u5982\u679c\u8fdb\u7a0b\u9000\u51fa\uff0c\u4f60\u7684 sperf \u4e5f\u5e94\u8be5\u76f8\u5e94\u9000\u51fa\u3002</li> </ul> <p>\u53ea\u8981\u5b8c\u6210\u7b80\u5355\u7684\u65f6\u95f4\u7edf\u8ba1\u5c31\u80fd\u83b7\u5f97\u8fd9\u4e2a\u5b9e\u9a8c\u7684\u6ee1\u5206\uff0c\u6253\u5370\u51fa \u201c\u4e0d\u9519\u201d \u7684\u56fe\u5f62\u5b8c\u5168\u662f\u4f60\u51fa\u4e8e\u4e2a\u4eba\u5174\u8da3\u7684\u884c\u4e3a\u3002</p> <p>\u5982\u679c\u4f60\u8981\u5728\u7ec8\u7aef\u4e0a\u8fdb\u884c\u7ed8\u56fe\uff0c\u6709\u4ee5\u63d0\u793a\u53ef\u4ee5\u5e2e\u52a9\u4f60\u9632\u6b62\u88ab Online Judge \u8bef\u4f24\uff1a</p> <ul> <li>\u4f7f\u7528 ANSI Escape Code \u8bbe\u7f6e\u989c\u8272\u3001\u5750\u6807\u7b49;</li> <li>\u4ece <code>stdin</code> \u5bf9\u5e94\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26 (0) \u83b7\u53d6\u7ec8\u7aef\u4fe1\u606f (\u4f8b\u5982\u5927\u5c0f)\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u91cd\u5b9a\u5411 <code>stdout</code>/<code>stderr</code> \u5230\u6587\u4ef6\u8fdb\u884c\u68c0\u67e5\uff1b</li> <li>\u4e0d\u8981\u4f9d\u8d56\u4e0d\u53ef\u9760\u7684\u7ec8\u7aef\u6570\u636e\u6765\u6e90 (\u5982 <code>LINES</code> \u73af\u5883\u53d8\u91cf\uff0c\u867d\u7136\u4f60\u7684 shell \u91cc\u53ef\u80fd\u5b58\u5728\uff0c\u4f46 Online Judge \u91cc\u672a\u5fc5)\uff1b</li> <li>\u53ef\u4ee5\u5047\u8bbe\u7a97\u53e3\u5927\u5c0f\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\u2014\u2014\u7a97\u53e3\u5927\u5c0f\u53d1\u751f\u53d8\u5316\u65f6\u4f1a\u6536\u5230 <code>SIGWINCH</code> \u4fe1\u53f7\uff0c\u9ed8\u8ba4\u5ffd\u7565\uff0c\u800c\u4f60\u4e5f\u4e0d\u9700\u8981\u5904\u7406\u5b83\u3002</li> </ul>"},{"location":"courses/os_lab/M3_sperf.html#flush","title":"\u7559\u610f flush \u4f60\u7684\u8f93\u51fa","text":"<p>\u6211\u4eec\u91cd\u5b9a\u5411 stdout \u540e\uff0c\u4f1a\u8fdb\u5165 fully buffered mode (\u5c31\u50cf\u6211\u4eec\u8bfe\u5802\u4e0a\u8bb2 fork \u5728 <code>./a.out</code> \u548c <code>./a.out | wc -l</code> \u770b\u5230\u4e0d\u540c\u884c\u6570\u7684\u4f8b\u5b50\u90a3\u6837)\u3002\u56e0\u6b64\u8bf7\u786e\u4fdd\u4f60\u5728\u6bcf\u4e00\u8f6e\u8f93\u51fa\u540e\u4f7f\u7528 fflush\u3002</p>"},{"location":"courses/os_lab/M3_sperf.html#4","title":"4. \u5b9e\u9a8c\u6307\u5357","text":"<p>\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u6211\u4eec\u8981\u505a\u7684\u4e8b\u60c5\u662f\uff1a</p> <ol> <li>\u521b\u5efa\u5b50\u8fdb\u7a0b\uff0c\u5728\u5b50\u8fdb\u7a0b\u4e2d\u542f\u52a8 strace (\u901a\u8fc7 fork/execve \u7cfb\u7edf\u8c03\u7528)</li> <li>\u5728\u7236\u8fdb\u7a0b\u4e2d\u6355\u83b7 strace \u7684\u8f93\u51fa (\u901a\u8fc7 pipe \u7cfb\u7edf\u8c03\u7528)</li> <li>\u89e3\u6790\u6355\u83b7\u7684 strace \u8f93\u51fa\uff0c\u5e76\u628a\u7cfb\u7edf\u8c03\u7528\u7684\u65f6\u95f4\u4fe1\u606f\u7edf\u8ba1\u663e\u793a\u3002</li> </ol>"},{"location":"courses/os_lab/M3_sperf.html#41-strace","title":"4.1 \u663e\u793a\u7cfb\u7edf\u8c03\u7528\u5e8f\u5217 (strace)","text":"<p>\u4ee5\u4e0b\u662f strace \u4f7f\u7528\u7684\u4f8b\u5b50\uff1a</p> <pre><code>$ strace ls\nexecve(\"/bin/ls\", [\"ls\"], 0x7ffd3a99eb80 /* 23 vars */)  = 0\nbrk(NULL)                                                = 0x55c642aa9000\naccess(\"/etc/ld.so.nohwcap\", F_OK)                       = -1 ENOENT\naccess(\"/etc/ld.so.preload\", R_OK)                       = -1 ENOENT\nopenat(AT_FDCWD, \"/etc/ld.so.cache\", O_RDONLY|O_CLOEXEC) = 3\nfstat(3, {st_mode=S_IFREG|0644, st_size=93852, ...})     = 0\n...\n</code></pre>"},{"location":"courses/os_lab/M3_sperf.html#42-strace","title":"4.2 \u663e\u793a\u7cfb\u7edf\u8c03\u7528\u7684\u65f6\u95f4 (strace)","text":"<p>strace \u4e5f\u63d0\u4f9b\u4e86\u8fd9\u4e2a\u529f\u80fd\u3002\u4e00\u65b9\u9762\u4f60\u53ef\u4ee5 STFW\uff0c\u4f46\u6211\u4eec\u5728\u8fd9\u91cc\u63a8\u8350\u4f60 RTFM\uff1a\u4f7f\u7528</p> <pre><code>man strace\n</code></pre> <p>\u67e5\u770b strace \u7684\u624b\u518c\u4e2d\u6240\u6709\u7684\u547d\u4ee4\u884c\u9009\u9879\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5927\u5bb6\u83b7\u5f97\u7684\u6536\u83b7\u8fdc\u6bd4\u76f4\u63a5\u53bb\u7f51\u4e0a \u201c\u5f97\u5230\u8fd9\u4e2a\u95ee\u9898\u7684\u7b54\u6848\u201d \u8981\u5927\u3002</p>"},{"location":"courses/os_lab/M3_sperf.html#43-sperf","title":"4.3 sperf: \u8bbe\u8ba1","text":"<p>\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u628a\u91cd\u8981\u7684\u6b65\u9aa4\u4e3a\u5927\u5bb6\u5206\u89e3\u597d\uff1a</p> <ol> <li>\u89e3\u6790\u51fa COMMAND \u548c ARG\uff0c\u8fd9\u53ef\u4ee5\u5f53\u505a\u662f\u666e\u901a\u7684\u7f16\u7a0b\u7ec3\u4e60\uff1b</li> <li>\u4f7f\u7528 <code>fork</code>\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8fdb\u7a0b\uff1a</li> <li>\u5b50\u8fdb\u7a0b\u4f7f\u7528 execve \u8c03\u7528<code>strace COMMAND ARG...</code>\uff0c\u542f\u52a8\u4e00\u4efd strace\uff1b<ul> <li>\u5728 execve \u6210\u529f\u8fd4\u56de\u4ee5\u540e\uff0c\u5b50\u8fdb\u7a0b\u5df2\u7ecf\u4e0d\u518d\u53d7\u63a7\u5236\u4e86\uff0cstrace \u4f1a\u4e0d\u65ad\u8f93\u51fa\u7cfb\u7edf\u8c03\u7528\u7684 trace\uff0c\u76f4\u5230\u7a0b\u5e8f\u7ed3\u675f\u3002\u7a0b\u5e8f\u4e0d\u7ed3\u675f strace \u4e5f\u4e0d\u4f1a\u7ed3\u675f</li> </ul> </li> <li>\u7236\u8fdb\u7a0b\u60f3\u529e\u6cd5\u4e0d\u65ad\u8bfb\u53d6 strace \u7684\u8f93\u51fa\uff0c\u76f4\u5230 strace \u7a0b\u5e8f\u7ed3\u675f\u3002<ul> <li>\u80fd\u8bfb\u53d6\u5230\u8f93\u51fa\uff0c\u5c31\u53ef\u4ee5\u89e3\u6790\u51fa\u6bcf\u4e2a\u7cfb\u7edf\u8c03\u7528\u7684\u65f6\u95f4\uff0c\u4ece\u800c\u628a\u7edf\u8ba1\u4fe1\u606f\u6253\u5370\u5230\u5c4f\u5e55\u4e0a</li> </ul> </li> </ol> <p>\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5730\u5206\u89e3\u95ee\u9898\u4e86\u3002</p>"},{"location":"courses/os_lab/M3_sperf.html#44-execve","title":"4.4 \u4f7f\u7528 execve \u521b\u5efa\u5b50\u8fdb\u7a0b","text":"<p>execve \u771f\u6b63\u7528\u8d77\u6765\u8fd8\u662f\u6709\u70b9\u5c0f\u9ebb\u70e6\u7684\uff1a</p> <pre><code>int execve(const char *filename, char *const argv[], char *const envp[]);\n</code></pre> <p>\u53ef\u80fd\u4f1a\u9047\u5230\u7684\u95ee\u9898\u6709\uff1a</p> <ul> <li> <p>\"No such file or directory\"\uff1afilename \u662f\u76f8\u5bf9\u4e8e\u8fdb\u7a0b\u7684\u5f53\u524d\u76ee\u5f55 (current working directory) \u800c\u8a00\u7684\uff0c\u6216\u8005\u662f\u4e00\u4e2a\u7edd\u5bf9\u8def\u5f84\u3002</p> </li> <li> <p>\u4f20\u5165\u6b63\u786e\u7684 <code>argv</code>\u3002\u600e\u4e48\u6784\u9020\u4e00\u4e2a\u53c2\u6570\u7684\u6570\u7ec4\uff1f</p> </li> <li> <p>\u4f20\u5165\u6b63\u786e\u7684 <code>envp</code>\u3002</p> </li> <li> <p>\u5982\u679c\u5728 execve strace \u7684\u65f6\u5019\u6ca1\u6709\u4f20\u5165\u6b63\u786e\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5b83\u4e5f\u6ca1\u6cd5\u6267\u884c\u547d\u4ee4\uff1a</p> </li> </ul> <pre><code>$ PATH=\"\" /usr/bin/strace ls\n/usr/bin/strace: Can't stat 'ls': No such file or directory\n</code></pre>"},{"location":"courses/os_lab/M3_sperf.html#45","title":"4.5 \u8fde\u63a5\u7236\u5b50\u8fdb\u7a0b\u7684\u8f93\u5165","text":"<p>\u4f7f\u7528 pipe \u7cfb\u7edf\u8c03\u7528\u53ef\u4ee5\u521b\u5efa\u7ba1\u9053\uff1a</p> <pre><code>int pipe(int pipefd[2]);\n</code></pre> <p>\u5b83\u4f1a\u8fd4\u56de\u4e24\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26 (\u4f60\u53ef\u4ee5\u7406\u89e3\u6210\u6307\u5411\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5bf9\u8c61\u7684\u6307\u9488)\uff0c\u4e00\u4e2a\u53ea\u80fd\u8bfb\u51fa\uff08pipefd[0]\uff09\uff0c\u53e6\u4e00\u4e2a\u53ea\u80fd\u5199\u5165\uff08pipefd[1]\uff09\uff0c\u5206\u522b\u5bf9\u5e94\u4e86\u8bfb\u7aef\u548c\u5199\u7aef\u2014\u2014\u987e\u540d\u601d\u4e49\uff0c\u5411\u5199\u7aef\u5199\u5165\u6570\u636e\uff0c\u8bfb\u5165\u7aef\u5c31\u80fd\u8bfb\u5230\u4e86\u3002\u6240\u6709\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u90fd\u4f1a\u5728 fork \u7684\u65f6\u5019\u88ab\u7ee7\u627f\uff0c\u6240\u4ee5\u7236\u8fdb\u7a0b\u521b\u5efa\u4e00\u4e2a\u7ba1\u9053\uff0c\u5b50\u8fdb\u7a0b\u4e5f\u5f97\u5230\u4e86\u8fd9\u4e24\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff1a</p> <pre><code>if (pipe(fildes) != 0) {\n  // \u51fa\u9519\u5904\u7406\n}\npid = fork();\nif (pid == 0) {\n  // \u5b50\u8fdb\u7a0b\uff0c\u6267\u884cstrace\u547d\u4ee4\n  execve(...);\n  // \u4e0d\u5e94\u8be5\u6267\u884c\u6b64\u5904\u4ee3\u7801\uff0c\u5426\u5219execve\u5931\u8d25\uff0c\u51fa\u9519\u5904\u7406\n} else {\n  // \u7236\u8fdb\u7a0b\uff0c\u8bfb\u53d6strace\u8f93\u51fa\u5e76\u7edf\u8ba1\n}\n</code></pre> <p>\u53ef\u80fd\u8fd8\u9700\u8981\u7528 <code>dup2</code> \u7cfb\u7edf\u8c03\u7528\u8fdb\u884c\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u817e\u632a (\u4f8b\u5982\u628a\u7ba1\u9053\u7684\u5199\u7aef \u201c\u8986\u76d6\u201d \u5230 strace \u7684 stderr \u4e0a)</p> <p>\u4e00\u4e9b\u6709\u7528\u7684\u8c03\u8bd5\u6280\u5de7\uff1a</p> <ol> <li>\u6253\u5370\u51fa <code>fildes</code> \u53d8\u91cf\u7684\u503c (\u6587\u4ef6\u63cf\u8ff0\u7b26)\uff1b</li> <li>\u753b\u51fa\u7a0b\u5e8f\u5bf9\u5e94\u7684\u72b6\u6001\u673a\uff1b</li> <li>\u4f7f\u7528 <code>lsof</code> \u547d\u4ee4\u67e5\u770b\u8fdb\u7a0b\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u2014\u2014\u8fd9\u4e2a\u5de5\u5177\u975e\u5e38\u6709\u7528\uff0c\u5b83\u4e5f\u662f\u57fa\u4e8e procfs \u5b9e\u73b0\u7684\u3002</li> </ol>"},{"location":"courses/os_lab/M3_sperf.html#dup2","title":"\u601d\u8003\u9898\uff1a\u4e3a\u4ec0\u4e48\u9700\u8981 <code>dup2</code>\uff1f","text":"<p>\u770b\u8d77\u6765 <code>close</code> \u548c <code>dup</code> \u5c31\u80fd\u5b9e\u73b0 <code>dup2</code> \u7684\u529f\u80fd\u4e86\u3002\u4e3a\u4ec0\u4e48\u8fd8\u9700\u8981\u5b83\u5462\uff1f\u624b\u518c\u91cc\u6709\u4e00\u4e9b\u89e3\u91ca\uff0c\u4e0d\u8fc7\u7a0d\u6709\u4e9b\u542b\u7cca\uff0c\u4f60\u80fd\u628a\u8fd9\u4e2a\u95ee\u9898\u60f3\u6e05\u695a\u5417\uff1f\u5728\u8fd9\u4e2a\u4f8b\u5b50\u91cc\uff0c <code>dup2</code> \u8bd5\u56fe\u907f\u514d\u7684 race conditions \u662f\u56e0\u4e3a\u8fdb\u7a0b\u91cc\u7684\u591a\u4e2a\u7ebf\u7a0b\u5bfc\u81f4\u7684\u3002\u4f46 race condition \u5e26\u6765\u7684\u9ebb\u70e6\u4e0d\u6b62\u5982\u6b64\uff0c\u6709\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u9605\u8bfb\u4e00\u7bc7\u6709\u8da3\u7684\u8bba\u6587\u3002</p>"},{"location":"courses/os_lab/M3_sperf.html#46-strace","title":"4.6 \u89e3\u6790 strace \u7684\u8f93\u51fa","text":"<p>strace \u7684\u8f93\u51fa\u5f88\u50cf\u662f\u4e00\u884c C \u51fd\u6570\u8c03\u7528\u3002\u5982\u679c\u4f7f\u7528\u4e86\u6b63\u786e\u7684\u53c2\u6570\u8c03\u7528 strace\uff0c\u6211\u4eec\u7684\u95ee\u9898\u5c31\u88ab\u89c4\u7ea6\u6210\u4e86\u4ece\u4e00\u884c\u5b57\u7b26\u4e32\u91cc\u63d0\u53d6 <code>0.000011</code>\u3002</p> <pre><code>mmap2(0xb76d1000, 10780, PROT_READ|PROT_WRITE, ...) = 0xb76d1000 &lt;0.000011&gt;\n</code></pre> <p>\u6700\u65b9\u4fbf\u7684\u5f53\u7136\u662f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u5566\uff01\u6709\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u8bd5\u8bd5 <code>regex.h</code>\u3002</p> <p>\u6b63\u786e\u89e3\u6790\u4e86\u8f93\u51fa\uff0c\u4f60\u5c31\u80fd\u5f97\u5230\u4e00\u5f20\u8868 (key-value map)\uff0c\u77e5\u9053\u6bcf\u4e2a\u7cfb\u7edf\u8c03\u7528\u6240\u82b1\u7684\u603b\u65f6\u95f4\u3002</p> <ul> <li>\u4f7f\u7528 ANSI Escape Code \u7ed8\u5236\u5230\u7ec8\u7aef\u4e0a</li> <li>\u9694\u4e00\u6bb5\u65f6\u95f4\u7528 ANSI Escape Code \u6e05\u4e00\u4e0b\u5c4f\u5e55</li> </ul> <p>Escape Code \u7ed9\u5927\u5bb6\u6253\u5f00\u4e86\u4e00\u6247\u5927\u95e8\u3002\u53ea\u9700\u8981\u4e24\u4e2a\u989d\u5916\u7684 API\uff0c\u5c31\u80fd\u5b9e\u73b0\u4efb\u4f55\u6709\u8da3\u7684\u4e1c\u897f\u4e86\uff1a</p> <ol> <li>\u51c6\u786e\u7684\u5b9a\u65f6\u5668\uff1b</li> <li>\u80fd\u591f\u5373\u523b\u6355\u83b7\u7ec8\u7aef\u6309\u952e\u7684API\u3002</li> </ol> <p>\u80fd \u201c\u7ed8\u56fe\u201d\u3001\u80fd\u8f93\u5165\u3001\u80fd\u5b9a\u65f6\uff0c\u5404\u79cd\u6e38\u620f\u548c\u5c0f\u5de5\u5177 (\u6bd4\u5982\u8f93\u5165\u51fd\u6570 y=f(x)\uff0c\u5728\u7ec8\u7aef\u4e0a\u7ed8\u5236\u5b83\u7684\u66f2\u7ebf)\uff0c\u5c31\u90fd\u80fd\u5b9e\u73b0\u5566\u3002\u5f53\u7136\uff0c\u8fd9\u4ef6\u4e8b\u80af\u5b9a\u65e9\u5c31\u6709\u4eba\u505a\u4e86\uff0c\u6bd4\u5982\u8457\u540d\u7684 NetHack\uff0c\u4ee5\u53ca\u5982\u679c\u60f3\u8bfb\u4e00\u70b9\u77ed\u7684\u4ee3\u7801\uff0c\u53ef\u4ee5\u770b\u770b\u7ec8\u7aef 2048 \u6e38\u620f\u3002</p>"},{"location":"courses/os_lab/M3_sperf.html#_1","title":"\u597d\u50cf\u6ca1\u90a3\u4e48\u7b80\u5355\u2026\u2026","text":"<p>\u5982\u679c\u4f60\u60f3\u5f97\u591a\u4e00\u4e9b\uff0c\u53ef\u80fd\u4f1a\u53d1\u73b0\u4e00\u4e9b\u989d\u5916\u7684\u9ebb\u70e6\uff0c\u4f8b\u5982\uff1a</p> <ol> <li> <p>strace \u9ed8\u8ba4\u4f1a\u628a trace \u8f93\u51fa\u5230 stderr\uff0c\u8fd9\u4e2a\u884c\u4e3a\u6ca1\u5565\u95ee\u9898\u3002\u4f46\u5982\u679c strace \u8ffd\u8e2a\u7684\u7a0b\u5e8f\u4e5f\u8f93\u51fa\u5230 stderr\uff0c\u4e0d\u5c31\u7834\u574f\u4e86 strace \u7684\u8f93\u51fa\u4e86\u5417\uff1f</p> </li> <li> <p>\u5373\u4fbf\u89e3\u51b3\u4e86\u4e0a\u9762\u7684\u95ee\u9898 (\u6bd4\u5982\u628a\u7a0b\u5e8f\u7684 stderr \u91cd\u5b9a\u5411\u5230 <code>/dev/null</code>\u4e22\u5f03)\uff0c\u7a0b\u5e8f\u8f93\u51fa\u7684\u5b57\u7b26\u4e32\u4e5f\u53ef\u80fd\u5bf9 parsing \u5e26\u6765\u4e0d\u597d\u7684\u5f71\u54cd\uff1a</p> </li> </ol> <pre><code>$ strace -T echo -n '\", 1) = 100 &lt;99999.9&gt;' &gt; /dev/null\nioctl(1, TCGETS, 0x7fff80723570)        = -1 ENOTTY &lt;0.000100&gt;\nwrite(1, \"\\\", 1) = 100 &lt;99999.9&gt;\", 21)  = 21 &lt;0.000149&gt;\nclose(1)                                = 0 &lt;0.000126&gt;\n</code></pre> <p>\u6211\u627f\u8ba4\u4e0a\u9762\u7684\u4f8b\u5b50\u6709\u70b9 \u201c\u6545\u610f\u800d\u8d56\u201d\u2014\u2014\u4f46\u5b83\u7684\u786e\u5f88\u53ef\u80fd\u4f7f\u4f60\u7684 parser \u51fa\u73b0\u4e00\u4e9b\u95ee\u9898\u3002\u7f16\u5199\u51fa \u201c\u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\u90fd\u6b63\u786e\u201d \u7684\u7a0b\u5e8f\u5c31\u4e0d\u90a3\u4e48\u5bb9\u6613\u4e86\u3002\u867d\u7136\u6211\u4eec\u5e76\u4e0d\u4f1a\u60f3\u5c3d\u4e00\u5207\u529e\u6cd5\u6784\u9020\u6781\u7aef\u7684\u6d4b\u8bd5\u7528\u4f8b\u6765\u5bf9\u4ed8\u5927\u5bb6\uff0c\u4f46\u5927\u5bb6\u4e0d\u59a8\u53ef\u4ee5\u6df1\u5165\u601d\u8003\u4e00\u4e0b \u201c\u600e\u4e48\u628a\u7a0b\u5e8f\u5199\u5bf9\u201d \u8fd9\u4e2a\u95ee\u9898\u3002</p>"},{"location":"courses/os_lab/M3_sperf.html#47","title":"4.7 (\u8865\u5145) \u8fd9\u4e2a\u5b9e\u9a8c\u5230\u5e95\u662f\u4ec0\u4e48\u76ee\u7684\uff1f","text":"<p>\u9700\u8981\u4e00\u4e2a\u5b9e\u9a8c\u6765\u4f53\u9a8c fork, execve, pipe\u2014\u2014\u5b83\u4eec\u662f UNIX \u4e16\u754c\u7684\u57fa\u7840\u3002</p> <ul> <li>\u4f7f\u7528 sperf \u5b9e\u9a8c\u5f3a\u8feb\u5927\u5bb6\u9605\u8bfb\u4e86\u7cfb\u7edf\u8c03\u7528\u7684\u5e8f\u5217\uff0c\u8fd8\u7406\u89e3\u4e86 trace \u548c profiler\u3002</li> </ul> <p>Linux kernel perf \u80fd\u5728\u5185\u6838\u4e2d\u63d2\u5165\u5404\u79cd\u5404\u6837\u7684\u89c2\u6d4b\u70b9 (probes)\uff0c\u57fa\u4e8e systemtap \u7684\u811a\u672c\u5219\u80fd\u5b9e\u73b0\u5404\u79cd\u5b9a\u5236\u7684 profiling (\u4f8b\u5982\u89c2\u5bdf\u7f51\u7edc\u7edf\u8ba1\u62a5\u6587\u7684\u60c5\u51b5\u3001\u78c1\u76d8 I/O \u7684\u60c5\u51b5\u2026\u2026)\u3002</p>"},{"location":"courses/os_lab/M4_crepl.html","title":"M4: C Real-Eval-Print-Loop (crepl)","text":""},{"location":"courses/os_lab/M4_crepl.html#1","title":"1. \u80cc\u666f","text":"<p>\u5927\u5bb6\u4e00\u5b9a\u5f88\u719f\u6089\u7f16\u7a0b\u8bed\u8a00\u63d0\u4f9b\u7684\u4ea4\u4e92\u5f0f read-eval-print-loop (REPL)\uff0c\u66f4\u4fd7\u4e00\u70b9\u7684\u540d\u5b57\u5c31\u662f \u201c\u4ea4\u4e92\u5f0f\u7684shell\u201d\u3002</p> <p>\u4f8b\u5982\u6211\u4eec\u5728\u8bfe\u5802\u4e0a\u5c55\u793a\u7684 Python Shell\uff0c\u53ef\u4ee5\u5feb\u901f\u5e2e\u52a9\u5927\u5bb6\u89e3\u51b3\u9ad8\u7b49\u6570\u5b66\u4f5c\u4e1a\u3001\u9ad8\u7cbe\u5ea6\u8ba1\u7b97\u7b49\u70e6\u607c\uff1a</p> <p></p> <p>\u73b0\u4ee3\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00\u901a\u5e38\u90fd\u4f1a\u63d0\u4f9b\u4ea4\u4e92\u5f0f\u7684\u6a21\u5f0f\uff0c\u65b9\u4fbf\u65e5\u5e38\u4f7f\u7528\uff0c\u5305\u975e\u89e3\u91ca\u578b\u7684\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00\u4e5f\u63d0\u4f9b\u7c7b\u4f3c\u7684\u8bbe\u65bd\uff0c\u4f8b\u5982 Scala REPL\u3001go-eval \u7b49\u2014\u2014\u5f53\u7136\u4e5f\u5305\u62ec\u6211\u4eec\u7684 UNIX Shell\uff01</p> <p>\u9884\u671f C \u540c\u6837\u4e5f\u53ef\u4ee5\u5b9e\u73b0 \u201c\u4ea4\u4e92\u5f0f\u201d \u7684 shell\uff0c\u652f\u6301\u5373\u65f6\u5b9a\u4e49\u51fd\u6570\uff0c\u800c\u4e14\u80fd\u8ba1\u7b97 C \u8868\u8fbe\u5f0f\u7684\u6570\u503c\u3002\u5982\u679c\u4f60\u8f93\u5165\u4e00\u884c\u4ee3\u7801\uff0c\u6bd4\u5982<code>strlen(\"Hello World\")</code>\uff0c\u8fd9\u6bb5\u4ee3\u7801\u4f1a\u7ecf\u5386 gcc \u7f16\u8bd1\u3001\u52a8\u6001\u52a0\u8f7d\u3001\u8c03\u7528\u6267\u884c\uff0c\u6700\u7ec8\u628a\u4ee3\u7801\u6267\u884c\u5f97\u5230\u7684\u6570\u503c <code>11</code> \u6253\u5370\u5230\u5c4f\u5e55\u4e0a\u3002</p>"},{"location":"courses/os_lab/M4_crepl.html#2","title":"2. \u5b9e\u9a8c\u63cf\u8ff0","text":"<p><code>crepl</code> - \u9010\u884c\u4ece stdin \u4e2d\u8f93\u5165\uff0c\u6839\u636e\u5185\u5bb9\u8fdb\u884c\u5904\u7406\uff1a</p> <ul> <li>\u5982\u679c\u8f93\u5165\u7684\u4e00\u884c\u5b9a\u4e49\u4e86\u4e00\u4e2a\u51fd\u6570\uff0c\u5219\u628a\u51fd\u6570\u7f16\u8bd1\u5e76\u52a0\u8f7d\u5230\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u4e2d\uff1b</li> <li>\u5982\u679c\u8f93\u5165\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5219\u628a\u5b83\u7684\u503c\u8f93\u51fa\u3002</li> </ul> <p>\u89e3\u91ca\u6267\u884c\u6bcf\u4e00\u884c\u6807\u51c6\u8f93\u5165\u4e2d\u7684 C \u201c\u5355\u884c\u201d \u4ee3\u7801 (\u5047\u8bbe\u6211\u4eec\u53ea\u4f7f\u7528 <code>int</code> \u7c7b\u578b\uff0c\u5373\u6240\u6709\u8f93\u5165\u7684\u8868\u8fbe\u5f0f\u90fd\u662f\u6574\u6570\uff1b\u5b9a\u4e49\u51fd\u6570\u7684\u8fd4\u56de\u503c\u4e5f\u6c38\u8fdc\u662f\u6574\u6570)\uff0c\u5206\u5982\u4e0b\u4e24\u79cd\u60c5\u51b5\uff1a</p> <ul> <li>\u51fd\u6570\u603b\u662f\u4ee5 <code>int</code>\u5f00\u5934\uff0c\u4f8b\u5982</li> </ul> <pre><code>int fib(int n) { if (n &lt;= 1) return 1; return fib(n - 1) + fib(n - 2); }\n</code></pre> <p>\u51fd\u6570\u63a5\u6536\u82e5\u5e72 <code>int</code> \u7c7b\u578b\u7684\u53c2\u6570\uff0c\u8fd4\u56de\u4e00\u4e2a <code>int</code> \u6570\u503c\u3002\u5982\u679c\u4e00\u884c\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u6211\u4eec\u5e0c\u671b\u5b83\u5c06\u4f1a\u7ecf\u8fc7 gcc \u7f16\u8bd1\uff0c\u5e76\u88ab\u52a0\u8f7d\u5230\u5f53\u524d\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u4e2d\u3002\u51fd\u6570\u53ef\u4ee5\u5f15\u7528\u4e4b\u524d\u5b9a\u4e49\u8fc7\u7684\u51fd\u6570\u3002</p> <ul> <li>\u5982\u679c\u4e00\u884c\u4e0d\u662f\u4ee5 int\u5f00\u5934\uff0c\u6211\u4eec\u8ba4\u4e3a\u8fd9\u4e00\u884c\u662f\u4e00\u4e2a C \u8bed\u8a00\u7684\u8868\u8fbe\u5f0f\uff0c\u5176\u7c7b\u578b\u4e3a int\uff0c\u4f8b\u5982</li> </ul> <pre><code>1 + 2 || (fib(3) * fib(4))\n</code></pre> <p>\u51fd\u6570\u548c\u8868\u8fbe\u5f0f\u5747\u53ef\u4ee5\u8c03\u7528\u4e4b\u524d\u5b9a\u4e49\u8fc7\u7684\u51fd\u6570\uff0c\u4f46\u4e0d\u5141\u8bb8\u8bbf\u95ee\u5168\u5c40\u7684\u72b6\u6001 (\u53d8\u91cf) \u6216\u8c03\u7528\u6807\u51c6 C \u4e2d\u7684\u51fd\u6570\u3002</p> <p>\u5982\u679c\u4e00\u884c\u65e2\u4e0d\u662f\u5408\u6cd5\u7684\u51fd\u6570 (\u4f8b\u5982\u8c03\u7528\u4e86\u4e0d\u5141\u8bb8\u8c03\u7528\u7684\u51fd\u6570)\uff0c\u4e5f\u4e0d\u662f\u5408\u6cd5\u7684\u8868\u8fbe\u5f0f\uff0c<code>crepl</code> \u53ef\u4ee5\u4e0d\u4fdd\u8bc1\u5b83\u4eec\u6267\u884c\u7684\u7ed3\u679c (\u4e0d\u4e00\u5b9a\u8981\u62a5\u544a\u9519\u8bef\uff0c\u4f8b\u5982\u4f60\u7684\u7a0b\u5e8f\u4f9d\u7136\u53ef\u4ee5\u7167\u5e38\u7f16\u8bd1\u6216\u6267\u884c\uff0c\u4f46\u4f60\u7684\u7a0b\u5e8f\u8981\u5c3d\u91cf\u4e0d\u4f1a crash)\u3002</p> <p>\u91cd\u590d\u5b9a\u4e49\u91cd\u540d\u51fd\u6570\u4f60\u4e5f\u53ef\u4ee5\u5f53\u505a undefined behavior \u4e0d\u5fc5\u505a\u51fa\u8fc7\u591a\u5904\u7406\u2014\u2014\u6211\u4eec\u7684\u6d4b\u8bd5\u7528\u4f8b\u4e2d\u6ca1\u6709\u8fd9\u6837\u7684\u60c5\u51b5\u3002</p> <p>\u4ee5\u4e0b\u662f\u6211\u4eec\u7684\u53c2\u8003\u5b9e\u73b0\uff0c\u5b83\u8c03\u7528\u4e86\u4e00\u4e9b\u5916\u6302\u7a0b\u5e8f\u5728\u7ec8\u7aef\u91cc\u5b9e\u73b0\u4e86\u8bed\u6cd5\u9ad8\u4eae\u3002</p> <ul> <li>\u6ca1\u6709\u505a\u8bed\u6cd5\u9ad8\u4eae\u7684\u5fc5\u8981\uff0c\u6211\u4eec\u7684\u73af\u5883\u91cc\u6ca1\u6709\u4f60\u9700\u8981\u7684\u8fd0\u884c\u5e93\uff0c\u56e0\u6b64\u4f1a\u5bfc\u81f4\u4f60\u65e0\u60c5\u7684 Compile Error \u6216 Wrong Answer\u3002</li> <li>\u5982\u679c\u4f60\u4f7f\u7528\u5916\u6302\uff0c\u4e00\u4e2a\u66f4\u597d\u7684\u4e60\u60ef (\u4e5f\u662f\u7f16\u5199\u8f6f\u4ef6\u5e38\u89c1\u7684\u505a\u6cd5) \u662f\u5728\u8fd0\u884c\u65f6\u68c0\u67e5\u5916\u6302\u662f\u5426\u5b58\u5728\u3002\u5982\u679c\u5b58\u5728\u5219\u8c03\u7528\uff1b\u5982\u679c\u4e0d\u5b58\u5728\u5219\u76f4\u63a5\u8f93\u51fa\u6ca1\u6709\u5916\u6302\u975e\u9ad8\u4eae\u7684\u7248\u672c\u3002</li> </ul> <p></p> <p>\u6700\u7b80\u7684\u5b9e\u9a8c\u8981\u6c42\uff1a\u4f60\u53ea\u8981\u4f60\u4e3a\u6bcf\u4e00\u4e2a\u51fd\u6570\u6216\u8868\u8fbe\u5f0f\u8f93\u51fa\u4e00\u884c\u5373\u53ef\uff0c\u4f8b\u5982\u4f60\u53ef\u4ee5\u628a\u4f60\u7684 crepl \u5b9e\u73b0\u6210\u8fd9\u6837\uff1a</p> <pre><code>$ ./crepl-64\nint gcd(int a, int b) { return b ? gcd(b, a % b) : a; }\nOK.\ngcd(256, 144) * gcd(56, 84)\n= 448.\n</code></pre> <p>\u8fd9\u4e2a\u5b9e\u9a8c\u8868\u660e\uff0c\u7f16\u8bd1\u548c\u89e3\u91ca\u5e76\u6ca1\u6709\u660e\u786e\u7684\u8fb9\u754c\u2014\u2014\u5728 OpenJDK \u7684\u5b9e\u73b0\u4e2d\uff0c\u5373\u4fbf\u662f \u201c\u89e3\u91ca\u5668\u201d \u4e5f\u662f\u7f16\u8bd1\u7684 (\u53ea\u662f\u6ca1\u6709\u7ecf\u8fc7\u4f18\u5316)\u3002</p> <p>\u52a8\u6001 (just-in-time) \u6280\u672f\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6 (\u800c\u975e\u7a0b\u5e8f\u6267\u884c\u524d) \u8fdb\u884c\u7f16\u8bd1\uff0c\u5e76\u5c06\u7f16\u8bd1\u5f97\u5230\u7684\u4e8c\u8fdb\u5236\u4ee3\u7801 (\u6307\u4ee4/\u6570\u636e) \u52a8\u6001\u52a0\u8f7d\u3002</p> <ul> <li>\u6700\u6210\u529f\u7684\u6848\u4f8b\u4e4b\u4e00\u662f Sun (\u73b0\u5728\u662f Oracle) \u7684 Java \u865a\u62df\u673a HotSpot (\u73b0\u5728\u662fOpenJDK\u7684\u4e00\u90e8\u5206)\uff0c\u53e6\u4e00\u4e2a\u6700\u6210\u529f\u7684\u6848\u4f8b\u662f JavaScript \u7684 V8 \u5f15\u64ce</li> </ul>"},{"location":"courses/os_lab/M4_crepl.html#3","title":"3. \u6b63\u786e\u6027\u6807\u51c6","text":"<ul> <li>\u53ea\u8981\u80fd\u6b63\u786e\u89e3\u6790\u5355\u884c\u7684\u51fd\u6570 (\u4ee5 <code>int</code> \u5f00\u5934)\uff0c\u5e76\u4e14\u9ed8\u8ba4\u5176\u4ed6\u8f93\u5165\u90fd\u662f\u8868\u8fbe\u5f0f\u5373\u53ef\u3002</li> <li>\u8f93\u5165\u4e0d\u5408\u6cd5\u7684 C \u4ee3\u7801 (\u4f8b\u5982\u4e0d\u5408\u6cd5\u7684\u8868\u8fbe\u5f0f)\uff1b\u4f60\u7684\u7a0b\u5e8f\u5e94\u8be5\u7ed9\u51fa\u9519\u8bef\u63d0\u793a\u800c\u4e0d\u5e94\u8be5 crash\u3002</li> <li>\u6ce8\u610f\u6211\u4eec\u5141\u8bb8\u51fd\u6570\u548c\u8868\u8fbe\u5f0f\u8c03\u7528\u4e4b\u524d (\u5728 crepl \u4e2d) \u5b9a\u4e49\u8fc7\u7684\u51fd\u6570\uff1b</li> <li>\u53ef\u4ee5\u5047\u8bbe\u6211\u4eec\u8f93\u5165\u7684\u547d\u4ee4/\u8868\u8fbe\u5f0f\u6570\u91cf\u4e0d\u8d85\u8fc7 100 \u4e2a\uff1b</li> <li>\u6ce8\u610f\u4f60\u5904\u5728\u7684\u8fd0\u884c\u76ee\u5f55\u53ef\u80fd\u6ca1\u6709\u5199\u5165\u7684\u6743\u9650\u3002\u5efa\u8bae\u4f60\u5c06\u521b\u5efa\u7684\u4e34\u65f6\u6587\u4ef6\u90fd\u653e\u5728 <code>/tmp/</code> \u76ee\u5f55\u4e0b\u3002\u5efa\u8bae\u4f7f\u7528 <code>mkstemp</code> family API \u521b\u5efa\u4e34\u65f6\u6587\u4ef6\uff1b</li> <li>\u4e3b\u8fdb\u7a0b\u786e\u5b9e\u6c42\u51fa\u4e86\u6240\u6709\u8868\u8fbe\u5f0f\u7684\u503c\u3002</li> <li>\u7981\u6b62\u4f7f\u7528 C \u6807\u51c6\u5e93 system \u548c popen\u3002</li> </ul>"},{"location":"courses/os_lab/M4_crepl.html#system-popen","title":"\u7981\u6b62\u4f7f\u7528 system() \u548c popen()","text":"<p>\u8c03\u7528\u5b83\u4eec\u5c06\u4f1a\u5bfc\u81f4\u7f16\u8bd1\u9519\u8bef\u3002\u597d\u6d88\u606f\u662f\u8fd9\u4e2a\u5b9e\u9a8c\u6211\u4eec\u4e0d\u7981\u6b62 <code>exec</code> family \u7684\u7cfb\u7edf\u8c03\u7528\uff1aexecl, execlp, execle, execv, execvp, execvpe \u90fd\u662f\u5141\u8bb8\u7684\u3002</p>"},{"location":"courses/os_lab/M4_crepl.html#4","title":"4. \u5b9e\u9a8c\u6307\u5357","text":""},{"location":"courses/os_lab/M4_crepl.html#41","title":"4.1 \u89e3\u6790\u8bfb\u5165\u7684\u547d\u4ee4","text":"<p>\u6846\u67b6\u4ee3\u7801\u91cc\u5df2\u7ecf\u5305\u542b\u4e86\u8bfb\u5165\u547d\u4ee4\u7684\u5faa\u73af (\u770b\u8d77\u6765\u50cf\u662f\u4e00\u4e2a\u5c0f shell)\uff0c\u5b83\u6253\u5370\u51fa\u4e00\u4e2a\u63d0\u793a\u7b26\uff0c\u7136\u540e\u63a5\u53d7\u8f93\u5165\u5e76\u89e3\u6790\uff1a</p> <pre><code>int main(int argc, char *argv[]) {\n  static char line[4096];\n  while (1) {\n    printf(\"crepl&gt; \");\n    fflush(stdout);\n    if (!fgets(line, sizeof(line), stdin)) {\n      break;\n    }\n    printf(\"Got %zu chars.\\n\", strlen(line)); // WTF?\n  }\n}\n</code></pre> <p>\u5f53\u4f60\u5728\u7ec8\u7aef\u91cc\u6309\u4e0b Ctrl-d\uff0c\u4f1a\u7ed3\u675f stdin \u8f93\u5165\u6d41\uff0cfgets \u4f1a\u5f97\u5230 <code>NULL</code>\u3002</p> <ul> <li>fgets \u4f1a flush stdout \u7684\u7f13\u51b2\u533a\u3002\u4f46 C \u6807\u51c6\u5e76\u6ca1\u6709\u89c4\u5b9a\u8fd9\u4e2a\u884c\u4e3a\u3002</li> </ul>"},{"location":"courses/os_lab/M4_crepl.html#42","title":"4.2 \u628a\u51fd\u6570\u7f16\u8bd1\u6210\u5171\u4eab\u5e93","text":"<p>\u5bf9\u4e8e\u4e00\u4e2a\u4e00\u884c\u7684\u51fd\u6570\uff0c\u6bd4\u5982</p> <pre><code>int gcd(int a, int b) { return b ? gcd(b, a % b) : a; }\n</code></pre> <p>\u5982\u4f55\u628a\u5b83\u7f16\u8bd1\u6210\u5171\u4eab\u5e93\uff1f\u628a\u8fd9\u4e2a\u6587\u4ef6\u4fdd\u5b58\u5230\u4e34\u65f6\u6587\u4ef6\u91cc\uff0c\u4f8b\u5982 <code>a.c</code> \u4e2d\uff0c\u7136\u540e\u4f7f\u7528\u6b63\u786e\u7684\u9009\u9879\u8c03\u7528 gcc \u5373\u53ef\u3002</p> <p>\u5982\u679c\u6211\u7684\u51fd\u6570\u8c03\u7528\u4e86\u5176\u4ed6\u51fd\u6570\u600e\u4e48\u529e\uff1f</p> <pre><code>int foo() { return bar() + baz(); }\n</code></pre> <p>\u4f60\u4e0d\u59a8\u8bd5\u7740\u7f16\u8bd1\u8fd9\u4e2a\u7a0b\u5e8f\u2026\u2026\u5b83\u7adf\u7136\u53ef\u4ee5\u88ab\u7f16\u8bd1\uff01\u6240\u4ee5\u5ffd\u7565\u6240\u6709\u7684 warnings \u5c31\u597d\u4e86\uff01</p>"},{"location":"courses/os_lab/M4_crepl.html#_1","title":"\u9009\u53d6\u5408\u9002\u7684\u8def\u5f84\u548c\u6587\u4ef6\u540d","text":"<p>\u53ef\u80fd\u5728\u4e00\u4e2a\u6ca1\u6709\u8bbf\u95ee\u6743\u9650\u7684\u5de5\u4f5c\u76ee\u5f55\u4e0a (\u4f8b\u5982\u6587\u4ef6\u7cfb\u7edf\u7684\u6839 <code>/</code>)\u3002\u5728 <code>/tmp</code> \u4e2d\u521b\u5efa\u4e34\u65f6\u6587\u4ef6\u662f\u66f4\u5b89\u5168\u7684\u505a\u6cd5\u3002\u6b64\u5916\uff0cglibc \u8fd8\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86 <code>mkstemp</code> family API \u8c03\u7528\uff0c\u80fd\u591f\u5e2e\u52a9\u6211\u4eec\u751f\u6210\u540d\u79f0\u552f\u4e00\u7684\u4e34\u65f6\u6587\u4ef6\u3002</p>"},{"location":"courses/os_lab/M4_crepl.html#43","title":"4.3 \u628a\u8868\u8fbe\u5f0f\u7f16\u8bd1\u6210\u5171\u4eab\u5e93","text":"<p>\u4e0d\u9700\u8981\u8fdb\u884c\u8bed\u6cd5\u89e3\u6790\u3002</p> <p>\u6bcf\u5f53\u6211\u4eec\u6536\u5230\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u4f8b\u5982 <code>gcd(256, 144)</code> \u7684\u65f6\u5019\uff0c\u6211\u4eec\u90fd\u53ef\u4ee5 \u201c\u4eba\u5de5\u751f\u6210\u201d \u4e00\u6bb5 C \u4ee3\u7801</p> <pre><code>int __expr_wrapper_4() {\n  return gcd(256, 144);\n}\n</code></pre> <p>\u8868\u8fbe\u5f0f\u53d8\u6210\u4e00\u4e2a\u51fd\u6570\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u5b83\u7f16\u8bd1\u6210\u5171\u4eab\u5e93\u4e86\u3002\u628a\u52a8\u6001\u5e93\u52a0\u8f7d\u5230\u5730\u5740\u7a7a\u95f4\u5e76\u5f97\u5230 <code>__expr_wrapper_4</code> \u7684\u5730\u5740\uff0c\u76f4\u63a5\u8fdb\u884c\u51fd\u6570\u8c03\u7528\u5c31\u80fd\u5f97\u5230\u8868\u8fbe\u5f0f\u7684\u503c\u4e86\u3002</p>"},{"location":"courses/os_lab/M4_crepl.html#44","title":"4.4 \u5171\u4eab\u5e93\u7684\u52a0\u8f7d","text":"<p>\u4f7f\u7528 <code>dlopen</code> \u52a0\u8f7d\u5171\u4eab\u5e93\u3002\u6211\u4eec\u5df2\u7ecf\u4e3a\u5927\u5bb6\u63d0\u4f9b\u4e86 <code>-ldl</code> \u7684\u94fe\u63a5\u9009\u9879\uff0c\u5927\u5bb6\u53ef\u4ee5\u9605\u8bfb\u76f8\u5173\u5e93\u51fd\u6570\u7684\u624b\u518c\u3002\u53e6\u4e00\u4e2a\u5f88\u4e0d\u9519\u7684\u624b\u518c\u662f elf (5)\u3002</p> <p>\u5982\u679c\u4f60\u5e0c\u671b\u7406\u89e3 dlopen \u7684\u539f\u7406\uff0c\u4e0d\u59a8\u53c2\u8003\u6211\u4eec\u8bfe\u5802\u4e0a\u63d0\u4f9b\u7684\u9759\u6001/\u52a8\u6001\u94fe\u63a5\u52a0\u8f7d\u5668\u2014\u2014\u53ea\u8981\u6b63\u786e\u89e3\u6790 ELF \u6587\u4ef6\uff0c\u4f60\u4e5f\u53ef\u4ee5\u81ea\u5df1\u5b9e\u73b0 dlopen\u3002</p> <ul> <li>\u4f7f\u7528 strace \u89c2\u5bdf dlopen \u6267\u884c\u7684\u7cfb\u7edf\u8c03\u7528\u5e8f\u5217 (\u53ea\u8981\u901a\u8fc7\u9002\u5f53\u7684\u65b9\u5f0f\uff0c\u4f8b\u5982\u4f60\u4eba\u4e3a\u8c03\u7528\u7684\u7cfb\u7edf\u8c03\u7528 \u201c\u6807\u8bb0\u201d dlopen \u7684\u5f00\u59cb\u548c\u7ed3\u675f\u5373\u53ef)\uff0c\u66f4\u597d\u5730\u7406\u89e3\u52a8\u6001\u94fe\u63a5\u548c\u52a0\u8f7d\u7684\u8fc7\u7a0b\uff1b</li> </ul>"},{"location":"courses/os_lab/M5_mymalloc.html","title":"M5: \u5e76\u884c\u5185\u5b58\u5206\u914d\u5668 (mymalloc)","text":""},{"location":"courses/os_lab/M5_mymalloc.html#1","title":"1. \u80cc\u666f","text":"<p>\u5185\u5b58\u5206\u914d\u5668 (malloc/free) \u662f libc \u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u8d1f\u8d23\u7ba1\u7406\u7a0b\u5e8f\u8fd0\u884c\u65f6\u52a8\u6001\u7533\u8bf7\u548c\u91ca\u653e\u5185\u5b58\u7684\u8fc7\u7a0b\u3002\u5728\u591a\u5904\u7406\u5668\u7cfb\u7edf\u4e2d\uff0c\u5185\u5b58\u5206\u914d\u5668\u9762\u4e34\u66f4\u5927\u7684\u6311\u6218\uff1a\u8fd0\u884c\u5728\u591a\u4e2a\u5904\u7406\u5668\u4e0a\u7684\u591a\u4e2a\u7ebf\u7a0b\u53ef\u80fd\u540c\u65f6\u8bf7\u6c42\u5206\u914d\u6216\u91ca\u653e\u5185\u5b58\uff0c\u6211\u4eec\u5f53\u7136\u5e0c\u671b\u591a\u4e2a\u5904\u7406\u5668\u4e0a\u7684 malloc \u548c free \u90fd\u53ef\u4ee5\u5e76\u884c\u6267\u884c\uff0c\u4ee5\u83b7\u5f97\u66f4\u597d\u7684\u6027\u80fd\u3002\u4e0e\u6b64\u540c\u65f6\uff0cmmap \u7ed9\u6211\u4eec\u7684 \u201c\u5927\u6bb5\u201d \u5185\u5b58\u5fc5\u987b\u7528\u5408\u9002\u7684\u6570\u636e\u7ed3\u6784\u7ba1\u7406\uff0c\u6570\u636e\u7ed3\u6784\u7684\u5e76\u53d1\u8bbf\u95ee\u53c8\u9700\u8981\u5c0f\u5fc3\u7684\u5e76\u53d1\u63a7\u5236\u3002</p>"},{"location":"courses/os_lab/M5_mymalloc.html#2","title":"2. \u5b9e\u9a8c\u63cf\u8ff0","text":""},{"location":"courses/os_lab/M5_mymalloc.html#21-freestanding","title":"2.1 \u5b9e\u73b0 Freestanding \u73af\u5883\u4e0b\u7684\u591a\u7ebf\u7a0b\u5185\u5b58\u5206\u914d\u548c\u56de\u6536","text":"<p>\ud83d\uddd2\ufe0f\u5b9e\u9a8c\u8981\u6c42\uff1amymalloc/myfree</p> <p>\u5b9e\u73b0\u591a\u5904\u7406\u5668\u5b89\u5168\u7684\u5185\u5b58\u5206\u914d\u5668\uff0c\u5305\u62ec\u4ee5\u4e0b\u4e24\u4e2a\u51fd\u6570\uff1a</p> <pre><code>void *mymalloc(size_t size); // \u5185\u5b58\u5206\u914d\nvoid myfree(void *ptr); // \u5185\u5b58\u91ca\u653e\n</code></pre> <p>\u4f60\u7684 malloc/free \u5b9e\u73b0\u5141\u8bb8\u4f7f\u7528\u4ee5\u4e0b\u4e24\u4e2a\u51fd\u6570 (\u6211\u4eec\u7684\u6846\u67b6\u4ee3\u7801\u4e2d\u63d0\u4f9b\u4e86\u5b9e\u73b0\uff0cOnline Judge \u8bc4\u6d4b\u65f6\u4f1a\u8986\u76d6\u4f60\u7684\u4fee\u6539\u8fc7\u7684 vmalloc/free)\uff1a</p> <pre><code>void *vmalloc(void *addr, size_t length); // length \u5fc5\u987b\u662f 4096 \u7684\u500d\u6570\nvoid vmfree(void *addr, size_t length);\n</code></pre> <p>\u5b83\u4eec\u662f mmap \u548c munmap \u7684\u5c01\u88c5\uff0c\u5141\u8bb8\u4f60\u7533\u8bf7\u548c\u91ca\u653e\u5927\u5757\u7684\u5185\u5b58\u3002\u4f60\u53ef\u4ee5\u5728\u64cd\u4f5c\u7cfb\u7edf\u5141\u8bb8\u7684\u8303\u56f4\u5185\u81ea\u7531\u4f7f\u7528\u5b83\u4eec\u2014\u2014vmalloc \u6210\u529f\u4f1a\u8fd4\u56de\u4e00\u6bb5\u957f\u5ea6\u4e3a length \u7684\u53ef\u8bfb\u3001\u53ef\u5199\u7684\u5185\u5b58\uff1bvmfree \u4f1a\u91ca\u653e\u8fd9\u6bb5\u5185\u5b58\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u4f60\u63d0\u4ea4\u7684\u4ee3\u7801\u4e0d\u80fd\u4f7f\u7528\u4efb\u4f55\u5176\u4ed6\u5e93\u51fd\u6570 (freestanding \u73af\u5883)\u3002\u8fd9\u6837\u51e0\u4e4e \u201c\u96f6\u4f9d\u8d56\u201d \u7684\u4ee3\u7801\u53ef\u4ee5\u4f5c\u4e3a libc \u5b9e\u73b0\u7684\u4e00\u90e8\u5206\uff0c\u6216\u662f\u7528\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838 (\u6211\u4eec\u4e0d\u518d\u7528 vmalloc/vmfree \u5206\u914d\u8fdb\u7a0b\u7684\u865a\u62df\u5185\u5b58\uff0c\u800c\u662f\u5206\u914d\u7269\u7406\u5185\u5b58)\u3002</p> <p>\u6211\u4eec\u8981\u6c42\u5206\u914d\u548c\u56de\u6536\u6ee1\u8db3\uff1a</p> <ul> <li>\u539f\u5b50\u6027\uff1a\u5f53\u591a\u4e2a\u5904\u7406\u5668\u540c\u65f6\u8bf7\u6c42\u5185\u5b58\u5206\u914d\u6216\u91ca\u653e\u65f6\uff0c\u5206\u914d\u5668\u5fc5\u987b\u786e\u4fdd\u540c\u65f6\u8fdb\u884c\u7684\u5206\u914d/\u56de\u6536\u64cd\u4f5c\u80fd\u591f\u6b63\u786e\u5b8c\u6210\u3002\u6ce8\u610f\uff0c\u5728\u4e00\u4e2a\u5904\u7406\u5668\u4e0a\u5206\u914d\u7684\u5185\u5b58\uff0c\u53ef\u80fd\u5728\u53e6\u4e00\u4e2a\u5904\u7406\u5668\u4e0a\u88ab\u91ca\u653e\u3002</li> <li>\u65e0\u91cd\u53e0\uff1a\u5206\u914d\u5668\u8fd4\u56de\u7684\u5185\u5b58\u5757\u4e4b\u95f4\u4e0d\u80fd\u6709\u91cd\u53e0\u3002\u6bcf\u6b21\u8c03\u7528 <code>myalloc</code> \u65f6\uff0c\u5b83\u5fc5\u987b\u8fd4\u56de\u4e00\u4e2a\u72ec\u7279\u7684\u5185\u5b58\u533a\u57df\uff0c\u8be5\u533a\u57df\u5728\u5176\u751f\u547d\u5468\u671f\u5185\u4e0d\u4e0e\u4efb\u4f55\u5176\u4ed6\u5206\u914d\u7684\u5185\u5b58\u5757\u5171\u4eab\u5730\u5740\u7a7a\u95f4\u3002</li> <li>\u5bf9\u9f50\uff1a\u5185\u5b58\u4e3a 8 \u5b57\u8282\u5bf9\u9f50\uff0c\u5373 mymalloc \u8fd4\u56de\u5730\u5740\u7684 \u4f4e 3 \u4f4d\u5fc5\u987b\u603b\u662f 0\u3002</li> <li>\u65e0\u5185\u5b58\u6cc4\u6f0f\uff1a\u4f7f\u7528 <code>myfree</code> \u91ca\u653e\u7684\u5185\u5b58\u5e94\u5f53\u652f\u6301\u91cd\u7528\uff0c\u800c\u4e0d\u662f\u6210\u4e3a\u65e0\u6cd5\u518d\u5206\u914d\u7684 \u201c\u6b7b\u5185\u5b58\u201d\u3002\u8fd9\u610f\u5473\u7740\u5206\u914d\u5668\u9700\u8981\u51c6\u786e\u8ddf\u8e2a\u54ea\u4e9b\u5185\u5b58\u662f\u7a7a\u95f2\u7684\uff0c\u54ea\u4e9b\u662f\u5df2\u5206\u914d\u7684\u3002</li> <li>\u9519\u8bef\u5904\u7406\uff1a\u5f53\u65e0\u6cd5\u6ee1\u8db3\u5185\u5b58\u5206\u914d\u8bf7\u6c42\u65f6 (\u4f8b\u5982\uff0c\u56e0\u4e3a\u6ca1\u6709\u8db3\u591f\u7684\u7a7a\u95f2\u5185\u5b58)\uff0c<code>myalloc</code> \u5e94\u8be5\u8fd4\u56de NULL (0)\u3002</li> <li>\u6700\u540e\uff0c\u4e0d\u5fc5\u521d\u59cb\u5316\u8fd4\u56de\u7684\u5185\u5b58 (libc \u7684 malloc \u4e3a\u4e86\u6027\u80fd\u5e76\u4e0d\u6e05\u9664\u5185\u5b58\u2014\u2014\u8fd9\u4e2a\u8bbe\u8ba1\u5176\u5b9e\u5bfc\u81f4\u4e86\u4e00\u4e9b\u5b89\u5168\u95ee\u9898)\uff0c\u5f53\u7136\uff0c\u5bf9\u8fd4\u56de\u7684\u5185\u5b58\u8d4b\u4e0a\u521d\u59cb\u503c (\u4f8b\u5982\u96f6) \u4e5f\u8bb8\u662f\u4e2a\u4e0d\u9519\u7684\u4e3b\u610f\u3002</li> </ul> <p>\u5bf9\u4e8e\u7b80\u5355\u7684\u9700\u6c42\uff0c\u4e3a\u4e86\u5b9e\u73b0\u7ebf\u7a0b\u5b89\u5168\u6027\uff0c\u53ea\u8981\u501f\u52a9\u6846\u67b6\u4ee3\u7801\u4e2d\u5b9e\u73b0\u7684\u81ea\u65cb\u9501\uff0c\u201c\u4e00\u628a\u5927\u9501\u4fdd\u5e73\u5b89\u201d \u5c31\u53ef\u4ee5\u4e86\u3002\u5728\u672c\u6b21\u5b9e\u9a8c\u4e2d\uff0c\u4f60\u53ea\u80fd\u4f7f\u7528\u81ea\u65cb\u7684\u65b9\u5f0f\u5b9e\u73b0\u4e92\u65a5\uff0c\u4e0d\u5f97\u8c03\u7528 pthreads \u7b49\u5e93\u3002</p> <p>\ud83d\udca1\u5185\u5b58\u5206\u914d\u548c\u56de\u6536</p> <p>\u6211\u4eec\u5e0c\u671b\u540c\u5b66\u4eec\u5728\u5e73\u65f6\u4f7f\u7528\u5927\u8bed\u8a00\u6a21\u578b\u7684\u8fc7\u7a0b\u4e2d\uff0c\u7ea0\u6b63\u9762\u5411 Online Judge \u7f16\u7a0b\u65f6\u4e00\u4e2a\u4e0d\u597d\u7684\u4e60\u60ef\uff1a\u53ea\u7ba1\u5206\u914d\uff0c\u4e0d\u7ba1\u56de\u6536\u3002\u5927\u5bb6\u5728\u505a \u201c\u7b97\u6cd5\u9898\u201d \u65f6\uff0c\u4e0d\u7ba1\u662f\u5927\u6570\u7ec4 int dp[N][N]\uff0c\u8fd8\u662f new Tree[N]\uff0c\u90fd\u6307\u671b\u64cd\u4f5c\u7cfb\u7edf\u5728\u8fdb\u7a0b\u7ed3\u675f\u540e\u81ea\u52a8\u56de\u6536\u8d44\u6e90\u3002\u4f46\u5bf9\u4e8e\u957f\u671f\u8fd0\u884c\u7684\u7a0b\u5e8f\u6765\u8bf4\uff0c\u7ba1\u7406\u5bf9\u8c61\u7684\u751f\u5b58\u5468\u671f\u5e76\u4e0d\u662f\u4e00\u4ef6\u7b80\u5355\u7684\u4e8b\u60c5\u3002</p>"},{"location":"courses/os_lab/M5_mymalloc.html#22-hard-tests","title":"2.2 \u6027\u80fd\u4f18\u5316 (Hard Tests)","text":"<p>\ud83d\uddd2\ufe0f\u5b9e\u9a8c\u8981\u6c42\uff1a\u9ad8\u6027\u80fd\u7684 mymalloc/myfree</p> <p>\u6211\u4eec\u5e0c\u671b\u4f60\u7684\u5206\u914d\u5668\u5e94\u8be5\u5c3d\u91cf\u9ad8\u6548\u5730\u4f7f\u7528\u5185\u5b58\uff0c\u51cf\u5c11\u788e\u7247\uff0c\u540c\u65f6\u4fdd\u6301\u5feb\u901f\u7684\u5206\u914d\u548c\u91ca\u653e\u64cd\u4f5c\uff1a</p> <ul> <li>\u5728 mymalloc/myfree \u5b9e\u73b0\u6b63\u786e\u7684\u524d\u63d0\u4e0b\uff0c\u5c3d\u53ef\u80fd\u4f7f\u4e0d\u540c\u5904\u7406\u5668\u4e0a\u7684\u5185\u5b58\u5206\u914d\u80fd\u591f\u5e76\u884c\u3002</li> <li>\u53d7\u5206\u914d\u7b97\u6cd5\u7684\u5c40\u9650\uff0c\u53ef\u80fd\u7cfb\u7edf\u4e2d\u4ecd\u7136\u6709\u7a7a\u95f2\u7684\u5185\u5b58\uff0c\u4f46\u5f62\u6210\u4e86\u788e\u7247\u7684\u5185\u5b58\uff0c\u6216\u662f\u4f60\u7684\u7b97\u6cd5\u4e0d\u80fd\u627e\u5230\u5b83\u4ece\u800c\u5206\u914d\u5931\u8d25\u3002\u8fd9\u662f\u5141\u8bb8\u7684\uff1b\u4f46\u5728\u7cfb\u7edf\u5185\u5b58\u538b\u529b\u5f88\u5c0f\u7684\u65f6\u5019\u4f9d\u7136\u9891\u7e41\u5206\u914d\u5931\u8d25\uff0c\u53ef\u80fd\u5bfc\u81f4 hard test failure\u3002</li> <li>\u5982\u679c\u4f60\u4ee3\u7801\u7684\u6027\u80fd\u8fc7\u4f4e (\u4f8b\u5982\u7528\u5168\u5c40\u7684\u9501\u4fdd\u62a4\u7a7a\u95f2\u94fe\u8868\uff0c\u5e76\u7528\u904d\u5386\u94fe\u8868\u7684\u65b9\u5f0f\u5bfb\u627e\u53ef\u7528\u7684\u5185\u5b58)\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4 hard test failure\u3002</li> </ul> <p>\u56de\u987e\u591a\u5904\u7406\u5668\u4e0a\u7684\u5185\u5b58\u5206\u914d\u548c\u91ca\u653e\u5e26\u6765\u989d\u5916\u7684\u6311\u6218\uff1a</p> <ol> <li>\u6211\u4eec\u5e0c\u671b\u4fdd\u8bc1\u5206\u914d\u7684\u6b63\u786e\u6027\u3002\u8fd9\u610f\u5473\u7740\u7528\u4e00\u628a\u5927\u9501\u4fdd\u62a4\u4e00\u4e2a\u4e32\u884c\u6570\u636e\u7ed3\u6784 (\u4f8b\u5982\u7b97\u6cd5\u5bfc\u8bba\u4e0a\u7684 \u201c\u533a\u95f4\u6811\u201d \u5c31\u80fd\u5728 O(log\u2061n)O(logn) \u7684\u65f6\u95f4\u5185\u5b8c\u6210\u5206\u914d\u548c\u91ca\u653e\u64cd\u4f5c) \u5c31\u80fd\u6b63\u786e\u5b9e\u73b0\u591a\u5904\u7406\u5668\u4e0a\u7684\u5185\u5b58\u5206\u914d\u3002</li> <li>\u6211\u4eec\u5e0c\u671b\u4fdd\u8bc1\u5206\u914d\u5728\u591a\u5904\u7406\u5668\u4e0a\u7684\u6027\u80fd\u548c\u6269\u5c55\u6027 (scalability)\u3002\u8fd9\u610f\u5473\u7740\u4e0d\u540c\u7684\u5904\u7406\u5668\u80fd\u591f\u5e76\u884c\u5730\u7533\u8bf7\u5185\u5b58\uff0c\u5c3d\u53ef\u80fd\u51cf\u5c11\u56e0\u4e3a\u540c\u65f6\u7533\u8bf7\u800c\u53d1\u751f\u4e00\u4e2a\u5904\u7406\u5668\u7b49\u53e6\u4e00\u4e2a\u5904\u7406\u5668\u7684\u60c5\u51b5\u3002</li> </ol> <p>\u4e0a\u9762\u4e24\u70b9\u9700\u6c42\u662f\u77db\u76fe\u7684\uff0c\u8fd9\u4e5f\u662f\u672c\u6b21\u5b9e\u9a8c\u7684\u91cd\u70b9\u6311\u6218\u3002\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u91cc\uff0c\u6211\u4eec\u901a\u8fc7 \u201csystem\u201d \u7684\u65b9\u6cd5\u89e3\u51b3\u95ee\u9898\uff0c\u800c\u4e0d\u662f\u5de7\u5999\u7684\u7b97\u6cd5/\u6570\u636e\u7ed3\u6784\u2014\u2014\u8fd9\u4e0d\u610f\u5473\u7740\u7b97\u6cd5/\u6570\u636e\u7ed3\u6784\u5728\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e2d\u6ca1\u6709\u5e94\u7528\uff0c\u53ea\u662f\u5728\u8fd9\u4e2a\u95ee\u9898\u4e0a\u5e76\u4e0d\u975e\u5e38\u5fc5\u8981\u3002</p> <p>\u2615\ufe0f\u4e0d\u8981\u4f7f\u7528\u533a\u95f4\u6811</p> <p>\u6811\u578b\u7684\u6570\u636e\u7ed3\u6784\u5f88\u5bb9\u6613\u5728\u5e76\u884c\u65f6\u9047\u5230\u74f6\u9888\u2014\u2014\u867d\u7136\u4e0d\u4ee3\u8868\u4f60\u4e0d\u80fd\u5b9e\u73b0\u9ad8\u6548\u7684\u6811\u578b\u6570\u636e\u7ed3\u6784\uff0c\u4f46\u73b0\u4ee3\u6d41\u884c\u7684\u5185\u5b58\u5206\u914d\u5668\u90fd\u4f7f\u7528\u4e86\u66f4\u7b80\u5355\u3001\u66f4 \u201csystem\u201d \u7684\u65b9\u5f0f\u89e3\u51b3\u95ee\u9898\uff1a\u6211\u4eec\u89c2\u5bdf\u5b9e\u9645\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u5185\u5b58\u5206\u914d\u7684\u6a21\u5f0f\uff0c\u63d0\u51fa\u6700\u4f73\u7684\u7b97\u6cd5\u3002</p>"},{"location":"courses/os_lab/M5_mymalloc.html#3","title":"3. \u6b63\u786e\u6027\u6807\u51c6","text":"<p>\u57fa\u4e8e vmalloc/vmfree \u5206\u914d \u201c\u5927\u533a\u95f4\u7684\u5185\u5b58\u201d\uff0c\u5728\u53ef\u7528\u7684\u5185\u5b58 (\u533a\u95f4) \u4e0a\u5b9e\u73b0\u6570\u636e\u7ed3\u6784 (\u62bd\u8c61\u6570\u636e\u7c7b\u578b)\uff0c\u7ef4\u62a4\u4e00\u4e2a\u4e0d\u76f8\u4ea4\u533a\u95f4\u7684\u96c6\u5408 (\u5806\u533a)\uff1a</p> <p>\u200b                               $$ H={[l_0,r_0),[l_1,r_1),...,[l_n,r_n)} $$</p> <p>\u521d\u59cb\u65f6\uff0c\\(H=\u2205\\)\u3002\u5bf9\u4e8e\u4efb\u610f\u65f6\u523b\u7684\u5f53\u524d\u5806\u533a H:</p> <ul> <li>mymalloc(s) \u5206\u914ds\u5b57\u8282\u7684\u5185\u5b58 [\u2113,r)[\u2113,r) \u6ee1\u8db3\uff1a</li> <li>\u5206\u914d\u53d1\u751f\u5728\u5806\u533a\u4e2d L\u2264\u2113&lt;r&lt;R</li> <li>\u5206\u914d\u7684\u5185\u5b58\u4e0d\u4e0e\u5df2\u5206\u914d\u5185\u5b58\u91cd\u53e0 \u2200[\u2113i,ri)\u2208H. [\u2113,r)\u2229[\u2113i,ri)=\u2205</li> <li>\u5206\u914d\u540e\u65b0\u7684\u5806\u533a H\u2032=H\u222a{[\u2113,r)}</li> <li> <p>\u8fd4\u56de\u5206\u914d\u533a\u95f4\u7684\u5de6\u7aef\u70b9 \u2113\u3002</p> </li> <li> <p><code>myfree</code>(\u2113) \u5220\u9664\u4e00\u4e2a\u5df2\u6709\u533a\u95f4 [\u2113,r)\u2208H\uff0c\u5f97\u5230\u65b0\u7684\u5806\u533a H\u2032=H\u2216{[\u2113,r)} \u5f53 \u2113\u4e0d\u662f H \u4e2d\u4efb\u4f55\u4e00\u4e2a\u533a\u95f4\u5de6\u7aef\u70b9\u65f6\uff0c\u4ea7\u751f undefined behavior\u2014\u2014\u5373 <code>myfree</code> \u7684\u8c03\u7528\u8005\u6709\u4e49\u52a1\u4fdd\u8bc1\u4e00\u5b9a\u91ca\u653e\u4e00\u4e2a\u5df2\u5206\u914d\u7684\u7a7a\u95f4\u3002</p> </li> </ul> <p>\u26a0\ufe0f\u91cd\u89c6\u6b63\u786e\u6027</p> <p>\u5982\u679c\u4f60\u7684 mymalloc/myfree \u201c\u51e0\u4e4e\u5b8c\u5168\u4e0d\u6b63\u786e\u201d\uff0c\u95ee\u9898\u53cd\u800c\u5bb9\u6613\u6392\u67e5\u3002\u4f46\u5982\u679c\u5728\u7284\u89d2\u65ee\u65ef\u7684\u60c5\u51b5\u91cc\u6709\u4e00\u4e2a\u5e76\u53d1 bug\uff0c\u53c8\u6070\u597d\u5230\u751f\u4ea7\u90e8\u7f72\u4ee5\u540e\u624d\u4ee5\u975e\u786e\u5b9a\u6027\u7684\u65b9\u5f0f\u66b4\u9732\u51fa\u6765\uff0c\u707e\u96be\u5c31\u6765\u4e86\uff1a\u8fd9\u4e48\u5927\u7684\u7cfb\u7edf\uff0c\u4f60\u53ef\u80fd\u4e0d\u4f1a\u60f3\u5230\u95ee\u9898\u51fa\u5728\u5148\u524d\u5b9e\u9a8c\u7684\u6a21\u5757\u3002\u5927\u5bb6\u6bd5\u4e1a\u4ee5\u540e\u7ec8\u6709\u4e00\u5929\u9700\u8981\u8131\u79bb Online Judge\uff0c\u53bb\u5b9e\u73b0 \u201c\u4ece\u6ca1\u4eba\u505a\u8fc7\u7684\u4e1c\u897f\u201d\uff0c\u6240\u4ee5\u4f60\u53ef\u80fd\u4f1a\u62b1\u6028 Online Judge \u7684\u65e0\u60c5\u62d2\u7edd\u548c\u51b7\u5374\u65f6\u95f4\uff0c\u4f46\u4e5f\u8bf7\u575a\u6301\u4f4f\uff01</p> <p>\ud83d\uddd2\ufe0f\u5b9e\u9a8c\u8981\u6c42\uff1a\u4f7f\u7528\u52a8\u6001\u65b9\u5f0f\u7ba1\u7406\u5185\u5b58</p> <p>\u4e3a\u4e86\u5f3a\u8feb\u5927\u5bb6\u4f7f\u7528\u52a8\u6001\u7684\u65b9\u5f0f\u7ba1\u7406\u5927\u5c0f\u4e0d\u540c\u7684\u5806\u533a\uff0c\u6211\u4eec\u89c4\u5b9a\u4f60\u4f7f\u7528\u7684\u6240\u6709\u9759\u6001\u5185\u5b58 (64-bit \u6a21\u5f0f\u4e0b\u7684\u4ee3\u7801\u3001\u6570\u636e\u3001bss) \u4e0d\u80fd\u8d85\u8fc7 1 MiB\u3002\u6211\u4eec\u5c06\u4f1a\u5728\u8fd0\u884c\u4e4b\u524d\u5bf9\u5185\u6838\u4f7f\u7528 size \u547d\u4ee4\u8fdb\u884c\u68c0\u67e5\uff0c\u5e76\u62d2\u7edd\u8fc7\u5927\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u7ba1\u7406\u5806\u533a\u7684\u6570\u636e\u7ed3\u6784\u5e94\u5f53\u5728\u5806\u533a\u4e2d\u800c\u4e0d\u662f\u9759\u6001\u533a\u4e2d\u8fdb\u884c\u5206\u914d\u3002</p> <p>\u6211\u4eec\u4f1a\u7528\u4e00\u4e9b\u63a5\u8fd1\u771f\u5b9e\u7684 workload \u6765\u6d4b\u8bd5 mymalloc/myfree \u7684\u6b63\u786e\u6027\u548c\u6027\u80fd\u3002</p> <p>Prompt: \u6709\u54ea\u4e9b\u5f00\u6e90\u7684\u8bc4\u4f30 malloc/free \u7684 workload\uff1f </p> <p>\u6211\u4eec\u5efa\u8bae\u5927\u5bb6\u5c1d\u8bd5\u4f7f\u7528\u771f\u5b9e\u7684 workload \u6765\u6d4b\u8bd5\u4f60\u7684 mymalloc/myfree \u7684\u6027\u80fd\u2014\u2014\u914d\u7f6e\u771f\u5b9e workload \u65f6\u53ef\u4ee5\u501f\u52a9 AIGC\u3002</p>"},{"location":"courses/os_lab/M5_mymalloc.html#32-online-judge","title":"3.2 Online Judge \u8fd0\u884c\u6d4b\u8bd5\u4ee3\u7801\u7684\u65b9\u5f0f","text":"<p>\u6211\u4eec\u4f1a\u5728 freestanding \u7684\u73af\u5883\u4e0b\u8fd0\u884c\u4f60\u7684\u4ee3\u7801\uff0c\u6a21\u62df\u4f60\u5728\u5b9e\u73b0\u4e00\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u3002\u6211\u4eec\u4f1a\u63d0\u4f9b\u4e0e mmap \u7c7b\u4f3c\u7684 vmalloc \u548c vmfree\uff0c\u8bf7\u4f60\u505a\u597d\u8c03\u8bd5\u4ee3\u7801 (printf\u3001\u7ebf\u7a0b\u521b\u5efa\u7b49) \u7684\u9694\u79bb\uff0c\u5b83\u4eec\u5728 freestanding \u73af\u5883\u4e0b\u5c06\u5bfc\u81f4\u7f16\u8bd1\u9519\u8bef\u3002\u6ce8\u610f\u4f60\u7684\u5206\u914d\u5668\uff1a</p> <ul> <li>\u4e0d\u80fd \u201c\u6d6a\u8d39\u201d \u8fc7\u591a\u7684\u5185\u5b58\uff0c\u5373\u5185\u5b58\u788e\u7247\u7684\u63a7\u5236\u5e94\u5f53\u5728\u4e00\u4e2a\u5408\u7406\u8303\u56f4\u5185\uff1a\u5f53\u5b9e\u9645\u4f7f\u7528\u7684\u5185\u5b58\u8d85\u8fc7\u7533\u8bf7\u5185\u5b58\u7684 4 \u500d\u65f6\uff0cOnline Judge \u5c06\u4f1a\u5224\u5b9a\u4e3a\u9519\u8bef\u3002\u521d\u59cb\u9636\u6bb5\u4f7f\u7528\u7684\u4e00\u4e9b\u5408\u7406\u5185\u5b58\u4e0d\u8ba1\u5165\u6b64\u9879\u3002</li> <li>\u786e\u4fdd\u591a\u5904\u7406\u5668\u5206\u914d\u7684\u6027\u80fd\uff0c\u5426\u5219\u53ef\u80fd\u4f1a\u5bfc\u81f4 hard test failure\u3002</li> </ul>"},{"location":"courses/os_lab/M5_mymalloc.html#4","title":"4. \u5b9e\u9a8c\u6307\u5357","text":""},{"location":"courses/os_lab/M5_mymalloc.html#41","title":"4.1 \u6846\u67b6\u4ee3\u7801","text":"<p>\u6211\u4eec\u7684\u6846\u67b6\u4ee3\u7801\u51e0\u4e4e \u201c\u4ec0\u4e48\u90fd\u6ca1\u6709\u201d\uff0c\u800c\u4e14\u8981\u6c42\u4f60\u652f\u6301 freestanding \u73af\u5883\u2014\u2014\u6ca1\u6709 libc\uff0c\u6ca1\u6709 pthreads\u3002\u6211\u4eec\u63d0\u4f9b\u7684\u4ec5\u6709\uff1a</p> <pre><code>typedef struct {\n    atomic_int status;\n} spinlock_t;\n\n#define LOCKED   1\n#define UNLOCKED 0\n\nstatic inline void spin_lock(spinlock_t *lock) {\n    // \u4e0d\u65ad\u5c1d\u8bd5\u5c06\u9501\u4ece UNLOCKED \u6539\u4e3a LOCKED\uff0c\u76f4\u5230\u6210\u529f\n    int expected;\n    do {\n        expected = UNLOCKED;\n    } while (!atomic_compare_exchange_strong(&amp;lock-&gt;status, &amp;expected, LOCKED));\n}\n\nstatic inline void spin_unlock(spinlock_t *lock) {\n    // \u76f4\u63a5\u5c06\u9501\u72b6\u6001\u8bbe\u4e3a UNLOCKED\n    atomic_store_explicit(&amp;lock-&gt;status, UNLOCKED, memory_order_release);\n}\n</code></pre> <p>\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u60f3\u8981\u83b7\u53d6\u5df2\u88ab\u5360\u7528\u7684\u9501\u65f6\uff0c\u5b83\u4f1a\u4e00\u76f4 \u201c\u81ea\u65cb\u201d (\u5fd9\u7b49) \u76f4\u5230\u9501\u88ab\u91ca\u653e\u3002\u5bf9\u4e8e\u7b49\u5f85\u65f6\u95f4\u8f83\u77ed\u7684\u4e34\u754c\u533a\uff0c\u81ea\u65cb\u5b9e\u73b0\u4e92\u65a5\u4e5f\u4e0d\u5931\u4e3a\u4e00\u79cd\u5408\u7406\u7684\u9009\u62e9\u3002</p> <p>start.c \u91cc\u63d0\u4f9b\u4e86\u4e24\u79cd\u73af\u5883\u7684\u4ee3\u7801\uff1a\u5bf9\u4e8e\u975e freestanding \u73af\u5883 (\u6709 libc)\uff0c\u6211\u4eec\u57fa\u4e8e mmap \u548c munmap \u5b9e\u73b0\u4e86 vmalloc/vmfree\uff0c\u5e76\u4e14\u5df2\u7ecf\u7ed9\u5927\u5bb6\u5b9e\u73b0\u4e86\u4e00\u4e9b\u6d4b\u8bd5\u7528\u7684\u4ee3\u7801\uff0c\u5305\u62ec mymalloc, vmalloc \u7684 smoke testing\uff0c\u4ee5\u53ca\u521b\u5efa\u7ebf\u7a0b (\u81ea\u65cb\u9501) \u7684\u6d4b\u8bd5\u3002</p> <p>\ud83d\uddd2\ufe0f\u4e3a freestanding \u73af\u5883\u5b9e\u73b0 vmalloc \u548c vmfree</p> <p>\u4f60\u53ef\u4ee5 \u201c\u5212\u5b9a\u201d \u4e00\u5757\u56fa\u5b9a\u5927\u5c0f\u7684\u9759\u6001\u5185\u5b58 (static char [])\uff0c\u7136\u540e\u5b9e\u73b0\u7b80\u5355\u7684 vmalloc/vmfree\u3002</p>"},{"location":"courses/os_lab/M5_mymalloc.html#42","title":"4.2 \u4e25\u8083\u5730\u7f16\u7a0b","text":"<p>\u8fd9\u4e2a\u4f5c\u4e1a\u7684\u96be\u5ea6\u8fd8\u662f\u6709\u4e00\u70b9\u7684\uff0c\u5927\u5bb6\u52a0\u6cb9\uff01\u5176\u5b9e\u672c\u8eab malloc/free \u7684\u5b9e\u73b0\u5e76\u4e0d\u590d\u6742\uff0c\u4ee3\u7801\u91cf\u5728 200-300 \u884c\u5de6\u53f3\uff0c\u5c24\u5176\u662f\u5982\u679c\u4f60\u9002\u5f53\u5730\u4f7f\u7528\u6570\u636e\u7ed3\u6784\uff0c\u5c31\u4f1a\u53d1\u73b0\u9501\u7684\u7ba1\u7406\u76f8\u5f53\u6e05\u695a\u660e\u786e\uff0c\u5728 \u201c\u6b63\u5e38\u201d \u7684 workload \u4e0b\u4e5f\u6ca1\u6709\u6027\u80fd\u74f6\u9888\u3002\u4f46\u8fd9\u4e2a\u5b9e\u9a8c\u5176\u5b9e\u6697\u85cf\u4e86 \u201c\u9677\u9631\u201d\uff1a</p> <p>\ud83d\udca1\u4f60\u662f\u4e0d\u662f\u9a6c\u4e0a\u5c31\u5f00\u59cb\u7f16\u7a0b\uff1f</p> <p>\u5f88\u5feb\u4f60\u5c31\u4f1a\u5199\u51fa\u4e00\u4e2a\u80fd\u901a\u8fc7\u5192\u70df\u6d4b\u8bd5\u7684\u4ee3\u7801\u3002\u4f60\u4f1a\u5199\u4e00\u4e2a\u968f\u673a\u751f\u6210\u5668\uff0c\u751f\u6210\u4e00\u4e9b\u987a\u5e8f\u7684 malloc/free \u8bf7\u6c42\uff0c\u5e76\u4e14\u770b\u5230\u6d4b\u8bd5\u5f88\u597d\u5730\u901a\u8fc7\u3002\u4f60\u5f88\u5f00\u5fc3\uff0c\u7136\u540e\u2026\u2026</p> <p>Online Judge \u7ed9\u4e86\u4f60\u65e0\u60c5\u7684 Wrong Answer\u3002\u8fd9\u4e2a\u65f6\u5019\uff0c\u8bca\u65ad\u95ee\u9898\u5c31\u53d8\u5f97\u975e\u5e38\u56f0\u96be\u3002\u4f60\u9700\u8981\u6784\u5efa\u6d4b\u8bd5\u6846\u67b6\u2014\u2014\u51e0\u4e2a\u7b80\u5355\u7684 unit test cases \u662f\u4e0d\u591f\u7684\u3002\u627e\u5230\u9519\u8bef\u3001\u8c03\u4f18\u6027\u80fd\uff0c\u624d\u662f\u8fd9\u4e2a\u5b9e\u9a8c\u7684\u771f\u6b63\u76ee\u7684\u3002\u4f60\u9700\u8981\u6784\u9020\u5e76\u53d1\u7684 workload\uff0c\u6d4b\u8bd5\u4f60\u7684\u5206\u914d/\u56de\u6536\u7b97\u6cd5\u662f\u5426\u5b58\u5728\u903b\u8f91\u9519\u8bef\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u4e3a\u6bcf\u4e2a malloc/free \u90fd\u6253\u5370\u51fa\u5206\u914d\u5230\u7684\u5730\u5740 (\u548c\u91ca\u653e\u7684\u5730\u5740)\uff0c\u5e76\u4e14\u7528\u53e6\u4e00\u4e2a\u811a\u672c\u6765\u68c0\u67e5\u662f\u5426\u5b58\u5728\u5e38\u89c1\u7684 memory errors: use-after-free, double-allocation, ... \u4f46\u4f60\u7684\u65e5\u5fd7\u4f1a\u4ea7\u751f \u201cprobe effect\u201d\uff0c\u53ef\u80fd\u4f1a\u63a9\u76d6\u4e00\u4e9b\u5728\u6ca1\u6709\u65e5\u5fd7\u65f6\u4f1a\u4ea7\u751f\u7684\u5e76\u53d1\u95ee\u9898\u2026\u2026</p> <p>\u8fd9\u65f6\u5019\u4f60\u5c31\u4f1a\u53d1\u73b0\u6d4b\u8bd5\u6846\u67b6\u975e\u5e38\u6709\u7528\u4e86\u2014\u2014\u4f60\u53ef\u4ee5\u5728\u5176\u4e2d\u5b9e\u73b0\u5404\u4e2a\u79cd\u7c7b\u7684\u6d4b\u8bd5\uff0c\u5e76\u4e14\u4e00\u4ef6\u8fd0\u884c\u3002\u5fc5\u8981\u7684\u65f6\u5019\uff0c\u4f60\u53ef\u4ee5\u4fee\u6539 testkit.h \u91cc\u7684 Time Limit\uff0c\u4f7f\u4f60\u7684 workload \u80fd\u8fd0\u884c\u66f4\u957f\u7684\u65f6\u95f4\uff0c\u6267\u884c\u8db3\u591f\u7684 \u201c\u538b\u529b\u6d4b\u8bd5\u201d\u3002</p>"},{"location":"courses/os_lab/M5_mymalloc.html#44","title":"4.4 \u6027\u80fd\u8c03\u4f18","text":"<p>\u26a0\ufe0f\u629b\u5f00 workload \u8c08\u4f18\u5316\uff0c\u5c31\u662f\u800d\u6d41\u6c13</p> <p>Premature optimization is the root of all evil.* (D. E. Knuth) \u8981\u8003\u8651\u597d\u4f60\u4f18\u5316\u7684\u573a\u666f\uff0c\u5426\u5219\u4e00\u5207\u90fd\u662f\u7a7a\u8c08\u3002</p> <p>Prompt: \u7ed9\u672c\u79d1\u751f\u7b2c\u4e00\u6b21\u63a5\u89e6\u64cd\u4f5c\u7cfb\u7edf\u8bfe\u7a0b\u7684\u540c\u5b66\uff0c\u4ecb\u7ecd\u4e00\u4e0b\u6027\u80fd\u8c03\u4f18\u7684\u6ce8\u610f\u4e8b\u9879\u3002 deepseek-r1: \u25b6\ufe0f</p> <p>\u5982\u679c\u4f60\u60f3\u8981\u505a\u6027\u80fd\u8c03\u4f18\uff0c\u9996\u5148\u8981\u786e\u4fdd\u4f60\u8c03\u5411\u4e86\u6b63\u786e\u7684\u65b9\u5411\u2014\u2014\u4f60\u5fc5\u987b\u8981\u5148\u6709\u4e00\u4e2a\u5408\u9002\u7684 workload \u7528\u4e8e\u8bc4\u4f30\u4f60\u7684\u6027\u80fd\uff1b\u7136\u540e\uff0c\u9760 \u201c\u731c\u201d \u548c\u968f\u673a\u4fee\u6539\u7a0b\u5e8f\u4ee5\u83b7\u5f97\u6027\u80fd\u63d0\u5347\u7684\u65b9\u5f0f\u4e5f\u662f\u4e0d\u4e13\u4e1a\u7684\u8868\u73b0\uff1b\u6211\u4eec\u6709\u6210\u719f\u7684\u5de5\u5177\u4f53\u7cfb (trace, profiler, ...) \u5e2e\u52a9\u6211\u4eec\u7406\u89e3\u7a0b\u5e8f\u6027\u80fd\u7684\u74f6\u9888\u3002\u7531\u4e8e\u6ca1\u6709\u7ed9\u51fa\u8fd9\u6b21\u5b9e\u9a8c\u7684\u80cc\u666f\uff0cAI \u8fd8\u7ed9\u4e86\u6211\u4eec\u4e00\u4e9b\u53d1\u6563\u7684\u601d\u8003\u3002</p> <p>\u8fd9\u4e2a\u5b9e\u9a8c\u7ed9\u5927\u5bb6\u7684\u5267\u900f\u662f\uff1a\u5982\u679c\u6570\u636e\u7ed3\u6784\u9009\u62e9\u5f97\u4e0d\u592a\u5dee\uff0c\u6027\u80fd\u74f6\u9888\u5c31\u4e3b\u8981\u5728\u4e8e\u591a\u4e2a\u7ebf\u7a0b\u5e76\u53d1\u8bbf\u95ee\u65f6\u7684\u4e92\u65a5\uff0c\u7531\u4e8e\u591a\u4e2a\u7ebf\u7a0b\u90fd\u9700\u8981\u83b7\u5f97\u540c\u4e00\u628a\u9501\uff0c\u81ea\u65cb\u6d6a\u8d39\u4e86\u591a\u5904\u7406\u5668\u7684\u7b97\u529b\u3002\u6b63\u5982\u8bfe\u672c\u4e0a\u6240\u8bf4\uff0c\u73b0\u4ee3 malloc/free \u5b9e\u73b0\u7684\u4e3b\u8981\u601d\u60f3\u5c31\u662f\u533a\u5206 fast/slow path\uff0c\u4f7f\u5f97 fast path \u5206\u914d\u5728\u7ebf\u7a0b\u672c\u5730\u5b8c\u6210\uff0c\u4ece\u800c\u4e0d\u4f1a\u9020\u6210\u9501\u7684\u4e89\u62a2\u3002</p> <p>\u806a\u660e\u7684\u4f60\u60f3\u5230\u4e86 thread-local \u5206\u914d\u6765\u4f18\u5316\u6027\u80fd\u2014\u2014\u6bd5\u7adf vmalloc \u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u3002\u5bf9\u4e8e\u8bc4\u6d4b\u5e73\u53f0\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u5f0f\u5b9e\u73b0 freestanding \u73af\u5883\u4e0b\u7684 gettid\uff1a</p> <pre><code>static inline pid_t gettid(void) {\n    pid_t tid;\n    __asm__ volatile (\n        \"syscall\"\n        : \"=a\" (tid)\n        : \"0\" (SYS_gettid)\n        : \"rcx\", \"r11\", \"memory\"\n    );\n    return tid;\n}\n</code></pre>"},{"location":"courses/os_lab/M5_mymalloc.html#5","title":"5. \u603b\u7ed3","text":"<p>malloc/free \u4e5f\u662f \u201c\u673a\u5236\u4e0e\u7b56\u7565\u5206\u79bb\u201d \u7684\u5178\u578b\u6848\u4f8b\u3002\u5185\u5b58\u7684\u5206\u914d\u63a5\u53e3\u7b80\u5355\uff0c\u4f46\u8986\u76d6\u4e86\u6781\u4e3a\u5e7f\u6cdb\u7684\u5e94\u7528\u573a\u666f\u3002\u5404\u79cd\u8bbf\u95ee\u6a21\u5f0f\u7684\u7a0b\u5e8f\u90fd\u7528\u540c\u4e00\u4e2a API \u5206\u914d\uff0c\u7f16\u7a0b\u786e\u5b9e\u7b80\u5355\u4e86\u2014\u2014\u5e26\u6765\u7684\u4ee3\u4ef7\u662f\u7b56\u7565\u7684\u8bbe\u8ba1\u53d8\u5f97\u975e\u5e38\u56f0\u96be\u3002\u201c\u81ea\u52a8\u201d \u4e00\u76f4\u662f\u8ba1\u7b97\u673a\u7cfb\u7edf\u5b9e\u73b0\u8005\u7684\u7ec8\u6781\u8ffd\u6c42\u2014\u2014\u4f8b\u5982\uff0cfree \u770b\u8d77\u6765\u5c31\u4e0d\u90a3\u4e48 \u201c\u81ea\u52a8\u201d\u3002\u5f88\u591a\u73b0\u4ee3\u7f16\u7a0b\u8bed\u8a00\u90fd\u8fd0\u884c\u5728\u81ea\u52a8\u7ba1\u7406\u5185\u5b58\u7684\u7684\u8fd0\u884c\u65f6\u73af\u5883\u4e0a\uff1aJava, Python, Javascript, ...\u5b83\u4eec\u7684\u7279\u70b9\u662f\uff1a\u6ca1\u6709 raw pointer\uff0c\u4e5f\u6ca1\u6709 API \u7528\u4e8e \u201c\u91ca\u653e\u201d \u5185\u5b58\u3002\u5f53\u4e00\u4e2a\u5bf9\u8c61\u4ece\u4e00\u7cfb\u5217\u7684 root objects (\u4f8b\u5982\u6808\u4e0a\u7684\u5c40\u90e8\u53d8\u91cf\u3001\u5168\u5c40\u53d8\u91cf\u7b49\u2026\u2026) \u901a\u8fc7\u5f15\u7528\u5173\u7cfb\u4e0d\u53ef\u8fbe\uff0c\u5b83\u4eec\u5c31\u4f1a\u81ea\u52a8\u88ab\u8fd0\u884c\u65f6\u73af\u5883\u56de\u6536\u3002\u8fd9\u771f\u662f\u7a0b\u5e8f\u5458\u7684\u798f\u97f3\u2014\u2014\u518d\u4e5f\u6ca1\u6709 use-after-free, double-free \u7b49\u95ee\u9898\u4e86\uff0cmemory leak \u7684\u53ef\u80fd\u6027\u4e5f\u5927\u5927\u964d\u4f4e (\u867d\u7136\u4f9d\u7136\u53ef\u80fd\u4f1a\u6709)\u3002</p> <p>\u4f46\u968f\u7740\u7cfb\u7edf\u7684\u53d1\u5c55\uff0c\u603b\u6709\u4e00\u5929\u6211\u4eec\u4f1a\u53d1\u73b0 \u201c\u81ea\u52a8\u201d \u7684\u6027\u80fd\u96be\u4ee5\u652f\u6491\u6240\u6709\u5e94\u7528\u7684\u9700\u6c42\uff0c\u673a\u5236\u7684\u5b9e\u73b0\u4e5f\u53d8\u5f97\u8d8a\u6765\u8d8a\u590d\u6742\uff0c\u5230\u4eca\u5929\u751a\u81f3\u673a\u5668\u5b66\u4e60\u4e5f\u4e0b\u573a\u4e86\uff0cRust \u5219\u5e0c\u671b\u56de\u5230\u4e00\u79cd\u4ecb\u4e8e\u624b\u52a8\u548c\u81ea\u52a8\u4e4b\u95f4\u7684\u7ba1\u7406\u65b9\u5f0f\u3002\u201c\u4ec0\u4e48\u662f\u5408\u9002\u7684\u62bd\u8c61\u201d \u4e5f\u8bb8\u662f\u4e00\u4e2a\u77ed\u65f6\u95f4\u5185\u65e0\u6cd5\u89e3\u51b3\u7684\u95ee\u9898\u3002</p>"},{"location":"courses/os_lab/M6_gpt.html","title":"M3: GPT-2 \u5e76\u884c\u63a8\u7406 (gpt.c)","text":""},{"location":"courses/os_lab/M6_gpt.html#1","title":"1. \u80cc\u666f","text":"<p>GPT \u8fd9\u6837\u7684 \u201c\u5927\u8bed\u8a00\u6a21\u578b\u201d \u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u51fd\u6570 \ud835\udc53f\uff0c\u80fd\u591f\u63a5\u6536\u4e00\u4e2a \u201c\u90e8\u5206\u6587\u672c\u201d\uff0c\u8f93\u51fa \u201c\u6587\u672c\u53ef\u80fd\u7684\u4e0b\u4e00\u4e2a\u5b57\u7b26\u201d\u3002\u8fd9\u4e2a \u201c\u667a\u80fd\u201d \u51fd\u6570 \ud835\udc53f \u5177\u6709\u60ca\u4eba\u7684\u5e94\u7528\u573a\u666f\uff0c\u5305\u62ec \u201c\u4e00\u5207\u201d \u7684 copilot (\u7f16\u7a0b\u3001\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u3001\u751a\u81f3\u662f\u8bfe\u5802\u5b66\u4e60)\uff0c\u548c\u53ef\u4ee5\u5404\u79cd\u66ff\u4ee3\u4eba\u7c7b\u7684\u667a\u80fd agent\u3002\u800c \ud835\udc53f \u8bad\u7ec3\u597d\u4e4b\u540e\uff0c\u5c31\u4f1a\u90e8\u7f72\u5728\u4e91\u7aef\u7684\u63a8\u7406\u670d\u52a1\uff0c\u4ee5 API \u7684\u5f62\u5f0f\u63d0\u4f9b\u670d\u52a1\u3002\u6211\u4eec\u9884\u89c1\uff0cAI \u63a8\u7406\u670d\u52a1\u5c06\u4f1a\u548c\u6c34\u3001\u7535\u3001\u4e91\u4e00\u6837\u6210\u4e3a\u4eba\u7c7b\u793e\u4f1a\u7684\u91cd\u8981\u57fa\u7840\u8bbe\u65bd\u3002</p>"},{"location":"courses/os_lab/M6_gpt.html#2","title":"2. \u5b9e\u9a8c\u63cf\u8ff0","text":""},{"location":"courses/os_lab/M6_gpt.html#21","title":"2.1 \u603b\u89c8","text":"gpt [token]\u2026"},{"location":"courses/os_lab/M6_gpt.html#22","title":"2.2 \u63cf\u8ff0","text":"<p>\u4f7f\u7528 <code>gpt2_124M</code> \u6a21\u578b\u5c06\u8f93\u5165\u7684\u4ee3\u8868\u4e86\u4e00\u6bb5\u6587\u672c\u7684 token (\u6574\u6570) \u5e8f\u5217\u8fdb\u884c\u8865\u5168\uff0c\u8f93\u51fa\u540e\u7eed\u53ef\u80fd\u7684 tokens (\u5305\u542b\u8f93\u5165\uff0c\u603b\u6709\u6709n=10 \u4e2a tokens)\uff0c\u4f5c\u4e3a\u6982\u7387\u610f\u4e49\u4e0a \u201c\u53ef\u80fd\u201d \u7684\u540e\u7eed\u6587\u672c\u3002</p>"},{"location":"courses/os_lab/M6_gpt.html#23","title":"2.3 \u89e3\u91ca","text":"<p>GPT-2 \u662f\u4e00\u4e2a\u57fa\u4e8e Transformer \u7684\u65e9\u671f\u6a21\u578b\uff0c\u4f46\u5960\u5b9a\u4e86 OpenAI \u7684\u6280\u672f\u57fa\u7840\u3002\u5e76\u884c\u5316\u662f\u63d0\u9ad8\u5927\u89c4\u6a21\u6a21\u578b\u8ba1\u7b97\u6548\u7387\u7684\u5173\u952e\u6280\u672f\u4e4b\u4e00\u3002</p> <p>gpt.c \u5b9e\u73b0\u4e86\u751f\u6210\u5f0f\u4eba\u5de5\u667a\u80fd\u7684 \u201c\u6587\u672c\u8865\u5168\u201d\uff0c\u6846\u67b6\u4ee3\u7801\u5df2\u7ecf\u63d0\u4f9b\u4e86\u4ece llm.c \u4e2d\u88c1\u526a\u51fa\u7684\u5b8c\u6574\u7684\u795e\u7ecf\u7f51\u7edc\u63a8\u7406 (inference) \u5b9e\u73b0\u3002\u4e0b\u8f7d <code>gpt2_124M.bin</code> \u5230\u5b9e\u9a8c\u76ee\u5f55\u5373\u53ef\u6b63\u5e38\u5de5\u4f5c\uff0c\u5b9e\u73b0\u6587\u672c\u7684\u8865\u5168\u3002</p> <p>\u4e0e\u5b83\u4ea4\u4e92\uff0c\u4f60\u53ef\u4ee5\u611f\u53d7\u5230\u81ea\u7136\u8bed\u8a00\u5904\u7406\u7684\u98de\u901f\u53d1\u5c55 (GPT-2 \u662f 2019 \u5e74\u7684\u6a21\u578b\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u662f 124M \u7684\u5c0f\u7248\u672c\u6a21\u578b\uff0c\u80fd\u529b\u4e0e\u4eca\u5929\u7684\u6a21\u578b\u65e0\u6cd5\u5339\u654c\uff0c\u4f46\u4f9d\u7136\u80fd\u770b\u5230\u5b83\u7684\u786e\u53ef\u4ee5\u751f\u6210 \u201c\u5408\u6cd5\u201d \u7684\u53e5\u5b50)\u3002</p> <p>\u6a21\u578b\u6587\u4ef6\u8f83\u5927 (~500MB)\uff0c\u56e0\u6b64\u4f60\u9700\u8981\u624b\u52a8\u4e0b\u8f7d\u5230\u5b9e\u9a8c\u76ee\u5f55\u3002\u5982\u679c\u65e0\u6cd5\u4e0b\u8f7d\uff0c\u4ece llm.c-github  \u4e0a\u8bad\u7ec3\u4e00\u4e2a\u51fa\u6765\u3002</p> <p>\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a Python \u7684\u811a\u672c chat.py\uff0c\u53ef\u4ee5\u76f4\u63a5\u8f93\u5165\u4e00\u6bb5\u6587\u672c\uff0c\u5b8c\u6210 tokenize\uff0c\u5e76\u4e14\u8c03\u7528 gpt \u547d\u4ee4\u884c\u5de5\u5177\u8fdb\u884c\u8865\u5168\uff0c\u6ca1\u9519\uff0c\u4f60\u771f\u7684\u5728\u5b9e\u9a8c\u4e2d\u4f7f\u7528\u4e86\u4e00\u4e2a\u80fd\u751f\u6210\u6587\u672c\u7684\u5927\u8bed\u8a00\u6a21\u578b\uff01\u4ee3\u7801\u5df2\u7ecf\u5168\u90e8\u7ed9\u5927\u5bb6\u51c6\u5907\u597d\uff0c\u5e76\u4e14\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u4e86\uff01\u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u91cc\uff0c\u6570\u5b57\u5e8f\u5217 \u201c31373 612\u201d \u5c31\u662f \u201cLadies and\u201d\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u8bed\u8a00\u6a21\u578b\u7684\u786e\u4e3a\u6211\u4eec\u751f\u6210\u4e86\u53ef\u9605\u8bfb\u7684\u6587\u672c\uff1a</p> <p></p> <p>\u6ca1\u9519\uff0c\u5373\u4fbf\u8fd9\u4e48\u5c0f\u7684\u6a21\u578b\uff0c\u5355\u7ebf\u7a0b\u7684\u5b9e\u73b0\u5728 CPU \u4e0a\u63a8\u7406\u90fd\u975e\u5e38\u5403\u529b\uff0c\u66f4\u4e0d\u5fc5\u8bf4\u4e4b\u540e \u201c\u8d85\u5927\u201d \u7684 GPT-3 (1750 \u4ebf\u53c2\u6570)\u3002\u795e\u7ecf\u7f51\u7edc\u63a8\u7406\u4f18\u5316\u662f\u4e00\u4e2a\u975e\u5e38\u590d\u6742\u7684\u4e3b\u9898\uff1b\u5728\u8fd9\u91cc\u6211\u4eec\u8bd5\u7740\u505a\u51fa\u5e76\u884c\u5316</p> <p>\u5b9e\u9a8c\u8981\u6c42\uff1a\u5c06 gpt.c \u5e76\u884c\u5316</p> <p>\u6211\u4eec\u7684 gpt.c \u662f\u4e32\u884c\u7684\u4ee3\u7801 (\u4f46\u529f\u80fd\u672a\u53d8)\uff0c\u53ea\u80fd\u5229\u7528\u5355\u4e2a\u5904\u7406\u5668\u3002\u4f60\u9700\u8981\u627e\u5230\u4ee3\u7801\u4e2d\u53ef\u5e76\u884c (\u5e76\u4e14\u6709\u6536\u76ca) \u7684\u90e8\u5206\uff0c\u6539\u9020\u6210\u5e76\u884c\uff0c\u4ece\u800c\u83b7\u5f97\u76f8\u5e94\u7684\u6027\u80fd\u63d0\u5347\u3002</p> <p>\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8bfe\u5802\u4e0a\u7684\u7ebf\u7a0b\u5e93 (thread.h \u548c thread-sync.h)\uff0c\u5176\u4e2d\u5305\u62ec\u7ebf\u7a0b\u7684\u521b\u5efa\u548c\u56de\u6536\u3001\u4e92\u65a5\u9501\u3001\u4fe1\u53f7\u91cf\u548c\u6761\u4ef6\u53d8\u91cf\u3002</p>"},{"location":"courses/os_lab/M6_gpt.html#3","title":"3. \u6b63\u786e\u6027\u6807\u51c6","text":"<p>\u6b63\u786e\u6027 &amp; Scalability</p> <p>\u4f60\u5e76\u884c\u5316\u540e\u7684\u7a0b\u5e8f\u884c\u4e3a\u5e94\u5f53\u4e0e\u6211\u4eec\u7ed9\u51fa\u7684\u4e32\u884c\u7a0b\u5e8f\u4fdd\u6301\u4e25\u683c\u4e00\u81f4 (\u5982\u679c\u4f60\u5e0c\u671b\u52a8\u624b \u201c\u73a9\u4e00\u73a9\u201d\uff0c\u53ef\u4ee5\u76f4\u63a5\u79fb\u6b65\u539f repo)\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u8f93\u5165 + \u8f93\u51fa\u603b\u5171 \ud835\udc5b=10n=10 \u4e2a tokens\u3002\u4f60\u5e94\u8be5\u4fdd\u6301\u8fd9\u4e2a\u884c\u4e3a\u4e0d\u53d8\u3002</p> <p>\u5e76\u884c\u5316\u5e26\u6765\u7684\u8ba1\u7b97\u987a\u5e8f\u8c03\u6574\u53ef\u80fd\u4f1a\u8f7b\u5fae\u5f71\u54cd\u6574\u4e2a\u795e\u7ecf\u7f51\u7edc\u7684\u6fc0\u6d3b\u51fd\u6570\u51fd\u6570\u503c\uff0c\u4f46\u53ea\u8981\u6700\u7ec8\u8f93\u51fa\u7684 token \u5e8f\u5217 (\u7406\u89e3\u4e3a\u6587\u672c) \u4e00\u81f4\uff0c\u6211\u4eec\u5c31\u8ba4\u4e3a\u6b63\u786e\u3002\u76f8\u6bd4\u4e8e\u4e32\u884c\u7a0b\u5e8f\uff0c\u5728\u4e00\u4e2a \ud835\udc58k \u4e2a\u5904\u7406\u5668\u7684\u8ba1\u7b97\u673a\u4e0a\uff0c\u9664\u53bb\u6a21\u578b\u52a0\u8f7d\u65f6\u95f4\uff0c\u4f60\u5e94\u5f53\u5728\u6709\u8f83\u591a\u8f6e\u63a8\u7406\u65f6\u5f97\u5230\u8fd1\u4f3c\u7ebf\u6027 (\ud835\udc58k \u500d) \u7684\u52a0\u901f\u6bd4\u3002</p> <p>Online Judge \u8bc4\u6d4b\u65f6\uff0c\ud835\udc58\u22644\u3002\u5bf9\u4e8e\u771f\u5b9e\u7684\u795e\u7ecf\u7f51\u7edc\u8bad\u7ec3/\u63a8\u5bfc\u7cfb\u7edf\uff0cGPU \u8fd9\u7c7b SIMT \u7684\u5927\u89c4\u6a21\u5e76\u884c\u5904\u7406\u5668\u5728\u80fd\u8017\u6bd4\u4e0a\u76f8\u6bd4 CPU \u6709\u5de8\u5927\u7684\u4f18\u52bf\u3002\u56de\u987e\u8bfe\u7a0b\u4e2d\u8bb2\u89e3 SIMT \u65f6\uff0c\u4e00\u4e2a\u7ebf\u7a0b\u675f\u5171\u4eab\u4e00\u4e2a Program Counter\uff0c\u63a7\u5236\u591a\u4e2a\u7ebf\u7a0b \u201c\u540c\u6b65\u201d \u6267\u884c\u6307\u4ee4\u3002\u6b64\u65f6\uff0c\u9488\u5bf9\u5927\u77e9\u9635\u3001\u5411\u91cf\u7684 load/store\uff0c\u4e00\u4e2a\u7ebf\u7a0b\u675f\u5c31\u4f1a\u751f\u6210\u4e00\u4e2a\u975e\u5e38\u957f\u7684\u5185\u5b58 load (coalesced memory access)\uff0c\u76f8\u6bd4 CPU \u201c\u78be\u788e\u4e86\u201d \u7684\u5185\u5b58-\u7f13\u5b58\u7cfb\u7edf\uff0c\u5177\u6709\u9ad8\u5f97\u591a\u7684\u7535\u8def\u6bd4\u548c\u80fd\u6548\u6bd4\u3002</p> <p>\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u4f60\u9700\u8981\u9759\u6001\u5206\u914d\u597d\u7ebf\u7a0b (\u4f8b\u5982 4 \u4e2a workers)\uff0c\u7136\u540e\u7531\u8fd9\u4e9b\u7ebf\u7a0b\u5b8c\u6210\u8ba1\u7b97\u4efb\u52a1\u3002</p>"},{"location":"courses/os_lab/M6_gpt.html#4","title":"4. \u5b9e\u9a8c\u6307\u5357","text":""},{"location":"courses/os_lab/M6_gpt.html#41-gpt-2","title":"4.1 GPT-2 \u5de5\u4f5c\u539f\u7406","text":"<p>\u9996\u5148\uff0c<code>gpt.c</code> \u7684\u6e90\u4ee3\u7801\u5c31\u662f\u6700\u597d\u7684\u8001\u5e08\uff01\u5b83\u5b9e\u73b0\u4e86\u5bf9\u795e\u7ecf\u7f51\u7edc\u7684 \u201c\u771f\u6b63\u6570\u5b66\u4e25\u683c\u201d \u7684\u63cf\u8ff0\u2014\u2014\u5982\u679c\u6211\u4eec\u770b PyTorch \u7684\u4ee3\u7801\uff0c\u5176\u4e2d\u4f1a\u6d89\u53ca\u8bb8\u591a\u5185\u7f6e\u7684\u7b97\u5b50\uff0c\u4f60\u5bf9\u5176\u4e2d\u7684\u5b9e\u73b0\u5176\u5b9e\u5e76\u4e0d 100% \u7406\u89e3\u2014\u2014\u4f46\u5bf9\u4e8e C \u4ee3\u7801\u8fd9\u79cd\u8bed\u4e49 \u201c\u6241\u5e73\u201d \u7684\u8bed\u8a00\u6765\u8bf4\uff0c\u4f60\u771f\u7684\u53ef\u4ee5\u5b8c\u5168\u7406\u89e3\u5b83\uff01\u6b64\u5916\uff0c\u6211\u4eec\u7ed9\u4e00\u4e2a\u5916\u94fe\uff0c\u4e5f\u8fd8\u63a8\u8350 Understanding Deep Learning\u3002</p>"},{"location":"courses/os_lab/M6_gpt.html#42","title":"4.2 \u5bfb\u627e\u5e76\u884c\u7684\u673a\u4f1a","text":"<p>\u5982\u4f55\u4f18\u5316\u4f60\u7684\u4ee3\u7801\uff1f\u5728\u5f00\u59cb\u4efb\u4f55\u4f18\u5316\u4e4b\u524d\uff0c\u9996\u5148\u770b D. E. Knuth \u7684\u540d\u8a00\uff1a</p> <p>Premature optimization is the root of all evil.</p> <p>\u201cPremature\u201d \u4e0d\u4ec5\u6307\u4f60\u4e0d\u5e94\u8be5\u5728\u5b9e\u73b0\u4ee3\u7801\u7684\u8fc7\u7a0b\u4e2d\u505a \u201c\u4efb\u610f\u201d \u7684\u4f18\u5316\uff0c\u5b83\u4eec\u53ef\u80fd\u6536\u6548\u751a\u5fae\uff0c\u4f46\u5927\u5e45\u7834\u574f\u4e86\u4f60\u4ee3\u7801\u7684\u53ef\u8bfb\u6027\u3001\u53ef\u7ef4\u62a4\u6027\u7b49\u3002\u201cPremature\u201d \u540c\u6837\u6307\u4f60\u4e0d\u5e94\u8be5\u968f\u610f\u5730\u53bb\u52a8\u4f60\u7684\u4ee3\u7801\uff0c\u7136\u540e\u53bb\u505a\u4e00\u4e9b\u60f3\u5f53\u7136\u7684\u4f18\u5316\u3002\u540c\u6837\uff0c\u8fd9\u4e9b\u4f18\u5316\u53ef\u80fd\u7834\u574f\u53ef\u8bfb\u6027\uff0c\u800c\u4e14\u5f88\u53ef\u80fd\u6ca1\u6709\u4ec0\u4e48\u6548\u679c\u3002</p> <p>\ud83d\udca1\u600e\u4e48\u505a\u51fa\u6b63\u786e\u7684\u4f18\u5316\uff1f</p> <p>\u7ed9\u5927\u5bb6\u4e00\u4e2a\u63d0\u793a\uff1aEverything is a state machine. \u5982\u679c\u987a\u7740\u8fd9\u4e2a\u601d\u8def\u51fa\u53d1\uff0c\u6211\u4eec\u5e94\u8be5\u600e\u4e48\u8003\u8651\u6027\u80fd\u4f18\u5316\u8fd9\u4e2a\u95ee\u9898\uff1f</p> <p>\u7b54\u6848\u662f\uff1a\u6211\u4eec\u5e94\u8be5\u89c2\u5bdf\u72b6\u6001\u673a\u7684\u6267\u884c\u3002\u6839\u636e\u4e8c\u516b\u5b9a\u5f8b\uff0c\u7edd\u5927\u90e8\u5206\u7684\u65f6\u95f4\u5e94\u8be5\u662f\u6d88\u8017\u5728\u5c11\u90e8\u5206\u64cd\u4f5c\u4e0a\u7684\u3002\u56e0\u6b64\uff0c\u4f60\u9996\u5148\u9700\u8981\u7406\u89e3\u7a0b\u5e8f\u7684\u54ea\u4e2a\u90e8\u5206\u6d88\u8017\u4e86\u6700\u591a\u7684\u65f6\u95f4\u2014\u2014\u9488\u5bf9\u6027\u5730\uff0c\u6211\u4eec\u4e5f\u5e94\u5f53\u8bd5\u56fe\u4f18\u5316 (\u5e76\u884c\u5316) \u8fd9\u4e9b\u4ee3\u7801\u2014\u2014\u4f60\u5bf9\u5360\u7528 1% \u65f6\u95f4\u7684\u4ee3\u7801\uff0c\u5373\u4fbf\u4f18\u5316\u5230\u6781\u81f4\u4f7f\u8fd0\u884c\u65f6\u95f4\u5b8c\u5168\u4e3a 0\uff0c\u4f60\u7684\u6536\u76ca\u4e5f\u8fd1\u4e4e\u4e3a\u96f6\u3002</p> <p>\u5f53\u7136\uff0c\u4f60\u9700\u8981\u5de5\u5177\uff1aprofiler\uff0c\u7528\u4e8e\u91c7\u6837\u72b6\u6001\u673a\u7684\u6267\u884c\uff0c\u201c\u5bc6\u96c6\u201d \u7684\u91c7\u6837\u5c31\u80fd\u5f97\u5230\u7a0b\u5e8f\u6d88\u8017\u65f6\u95f4\u7684\u5e8f\u5217\u3002</p> <p>In software engineering, profiling (\"program profiling\", \"software profiling\") is a form of dynamic program analysis that measures, for example, the space (memory) or time complexity of a program, the usage of particular instructions, or the frequency and duration of function calls. Most commonly, profiling information serves to aid program optimization.</p> <p>\u4f8b\u5982\uff0cLinux perf \u5de5\u5177\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u6027\u80fd\u5206\u6790\u5de5\u5177\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u7528\u4e8e\u5206\u6790\u7a0b\u5e8f\u6027\u80fd\u548c\u8ddf\u8e2a\u7cfb\u7edf\u4e8b\u4ef6\u7684\u529f\u80fd\u3002\u8fd9\u4e2a\u5de5\u5177\u662f\u5185\u6838\u4e2d\u7684\u4e00\u90e8\u5206\uff0c\u5229\u7528\u4e86 Linux \u5185\u6838\u4e2d\u7684\u6027\u80fd\u8ba1\u6570\u5668\u5b50\u7cfb\u7edf\u3002Perf \u53ef\u4ee5\u5e2e\u52a9\u5f00\u53d1\u8005\u548c\u7cfb\u7edf\u7ba1\u7406\u5458\u76d1\u63a7\u6574\u4e2a\u7cfb\u7edf\u7684\u6027\u80fd\uff0c\u5305\u62ec\u786c\u4ef6\u548c\u8f6f\u4ef6\u5c42\u9762\u3002Perf \u5de5\u5177\u80fd\u591f\u6d4b\u91cf\u8f6f\u4ef6\u4e8b\u4ef6\u5982\u51fd\u6570\u8c03\u7528\u548c\u7a0b\u5e8f\u6267\u884c\u65f6\u95f4\uff0c\u5e76\u4e14\u80fd\u591f\u76d1\u63a7\u786c\u4ef6\u4e8b\u4ef6\u6bd4\u5982 CPU \u5468\u671f\u6570\u3001\u6307\u4ee4\u6570\u4ee5\u53ca\u7f13\u5b58\u547d\u4e2d\u548c\u672a\u547d\u4e2d\u7684\u60c5\u51b5\u3002\u8fd9\u4f7f\u5f97\u5b83\u975e\u5e38\u9002\u5408\u4e8e\u6027\u80fd\u8c03\u4f18\u548c\u5bfb\u627e\u74f6\u9888\u3002\u6b64\u5916\uff0cperf \u652f\u6301\u4e8b\u4ef6\u7684\u5b9e\u65f6\u8ffd\u8e2a\uff0c\u80fd\u591f\u8bb0\u5f55\u548c\u62a5\u544a\u7cfb\u7edf\u8fd0\u884c\u4e2d\u7684\u5404\u79cd\u4e8b\u4ef6\uff0c\u5982\u4e0a\u4e0b\u6587\u5207\u6362\u3001\u7cfb\u7edf\u8c03\u7528\u3001\u9875\u9519\u8bef\u7b49\u3002\u8fd9\u4e9b\u529f\u80fd\u4f7f\u5f97 perf \u6210\u4e3a Linux \u7cfb\u7edf\u6027\u80fd\u5206\u6790\u548c\u95ee\u9898\u8bca\u65ad\u7684\u91cd\u8981\u5de5\u5177\u3002</p> <p></p>"},{"location":"courses/os_lab/M6_gpt.html#43","title":"4.3 \u4f7f\u7528\u7ebf\u7a0b\u5e93\u5b9e\u73b0\u5e76\u884c","text":"<p>\u5982\u679c\u4f60\u4e0d\u77e5\u9053\u600e\u4e48\u5b9e\u73b0\u5e76\u884c\uff0c\u53ef\u4ee5\u4ece\u6211\u4eec\u8bfe\u5802\u7684\u4ee3\u7801\u5165\u624b\uff0c\u4f8b\u5982\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u95ee\u9898\uff1a</p> <p>\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u95ee\u9898\uff1a\u5728\u89e3\u51b3\u540c\u6b65\u95ee\u9898\u65f6\uff0c\u5173\u952e\u5728\u4e8e\u7406\u89e3 \u201c\u540c\u6b65\u6210\u529f\u201d \u7684\u6761\u4ef6\u662f\u4ec0\u4e48\u3002\u7136\u540e\u5404\u4e2a\u7ebf\u7a0b\u5728\u6761\u4ef6\u4e0d\u6ee1\u8db3\u65f6\u7b49\u5f85\uff0c\u76f4\u5230\u6761\u4ef6\u6ee1\u8db3\u65b9\u53ef\u7ee7\u7eed\u3002\u8fd9\u4e2a\u601d\u8def\u81ea\u7136\u5730\u5f15\u51fa\u4e86 \u201c\u6761\u4ef6\u53d8\u91cf\u201d \u8fd9\u4e00\u540c\u6b65\u673a\u5236\u3002</p> <p>\u6211\u4eec\u5df2\u7ecf\u63d0\u5230\uff0c\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u53ef\u4ee5\u89e3\u51b3\u5927\u5bb6 99% \u7684\u5e76\u884c\u7f16\u7a0b\u95ee\u9898\u2014\u2014\u8fd9\u4e2a\u81ea\u7136\u4e0d\u4f8b\u5916\u3002</p>"},{"location":"courses/os_lab/M7_httpd.html","title":"M7: HTTP Daemon (httpd)","text":""},{"location":"courses/os_lab/M7_httpd.html#1","title":"1. \u80cc\u666f","text":"<p>HTTP (Hypertext Transfer Protocol) \u662f\u4e92\u8054\u7f51\u4e0a\u6700\u5e7f\u6cdb\u4f7f\u7528\u7684\u5e94\u7528\u5c42\u534f\u8bae\u4e4b\u4e00\u3002\u4ece\u7b80\u5355\u7684\u9759\u6001\u7f51\u9875 (\u4f8b\u5982\u300a\u64cd\u4f5c\u7cfb\u7edf\u300b\u7684\u8bfe\u7a0b\u7f51\u7ad9) \u5230\u590d\u6742\u7684 Web \u5e94\u7528 (\u4f8b\u5982\u6211\u4eec\u7684\u6559\u52a1\u7cfb\u7edf\u5230\u80fd\u5728\u7f51\u9875\u4e2d\u76f4\u63a5\u4f7f\u7528\u7684 Office 365)\uff0c\u5b83\u4eec\u90fd\u662f\u7531 HTTP \u670d\u52a1\u5668\u652f\u6491\u7684\uff01HTTP \u670d\u52a1\u5668\u7684\u57fa\u672c\u529f\u80fd\u63a5\u6536\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u5e76\u8fd4\u56de\u54cd\u5e94\uff0c\u4f8b\u5982\u4ee5\u4e0b\u662f\u4e00\u4e2a\u5178\u578b\u7684 HTTP \u8bf7\u6c42\uff1a</p> <pre><code>GET /index.html HTTP/1.1\nHost: www.example.com\nUser-Agent: Mozilla/5.0\n</code></pre> <p>\u5176\u4e2d \u201cGET \u662f\u8bf7\u6c42\u7684\u65b9\u6cd5\u201d \u8868\u793a\u83b7\u53d6\u8d44\u6e90\u3002\u9664\u4e86 GET \u5916\uff0c\u8fd8\u6709 POST\u3001PUT\u3001DELETE \u7b49\uff0c\u7528\u4e8e\u6267\u884c\u4e0d\u540c\u7c7b\u578b\u7684\u64cd\u4f5c\u3002GET \u540e\u7684 \u201c/index.html\u201d \u662f\u8bf7\u6c42\u7684\u8d44\u6e90\u8def\u5f84\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u5728\u6d4f\u89c8\u5668\u680f\u4e2d\u8f93\u5165\u7684\u57df\u540d\u540e\u7684\u8def\u5f84\uff0cHTTP/1.1 \u662f HTTP \u534f\u8bae\u7248\u672c\u3002Host \u662f\u6307\u5b9a\u670d\u52a1\u5668\u4e3b\u673a\u540d\uff0c\u4f8b\u5982\u7f51\u9875\u7684\u57df\u540d\u3002\u5f88\u591a\u7f51\u7ad9\u90fd\u4f1a\u76f4\u63a5\u62d2\u7edd\u4f7f\u7528 IP \u7684\u8bbf\u95ee\u3002User-Agent \u662f\u5ba2\u6237\u7aef\u8f6f\u4ef6\u4fe1\u606f\u2014\u2014\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u7f51\u9875\u80fd\u81ea\u52a8 \u201c\u8bc6\u522b\u201d \u624b\u673a\u548c\u7535\u8111\uff0c\u4ee5\u53ca\u6709\u4e9b\u7f51\u7ad9\u4f1a\u62d2\u7edd\u4f60\u7684 curl \u8bf7\u6c42\u3002</p> <p>HTTP \u670d\u52a1\u5668\u89e3\u6790\u8bf7\u6c42\u540e\uff0c\u4f1a\u6839\u636e\u8bf7\u6c42\u7684\u8d44\u6e90\u8def\u5f84\uff0c\u4ece\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u4e2d\u8bfb\u53d6\u8d44\u6e90\u6216\u8c03\u7528\u53e6\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u4fd7\u79f0\u7684 \u201c\u540e\u7aef\u201d\uff0c\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002HTTP \u534f\u8bae\u672c\u8eab\u662f\u65e0\u72b6\u6001\u7684\uff0c\u56e0\u6b64\u901a\u5e38\u9700\u8981 Cookie\u3001Session \u6216 Token \u7b49\u673a\u5236\u5b9e\u73b0\u7528\u6237\u767b\u5f55\u7b49\u9700\u8981\u72b6\u6001\u4fdd\u6301\u7684\u529f\u80fd\uff0c\u6d4f\u89c8\u5668\u4f1a\u81ea\u52a8\u5728 request header \u4e2d\u643a\u5e26\u76f8\u5e94\u7684 Cookie \u4fe1\u606f (Cookie \u5b57\u6bb5) \u53d1\u9001\u7ed9\u670d\u52a1\u5668\uff0c\u4ee5\u5b9e\u73b0\u7528\u6237\u767b\u5f55\u529f\u80fd\u3002</p>"},{"location":"courses/os_lab/M7_httpd.html#2","title":"2. \u5b9e\u9a8c\u63cf\u8ff0","text":""},{"location":"courses/os_lab/M7_httpd.html#21","title":"2.1 \u603b\u89c8","text":"httpd [port]"},{"location":"courses/os_lab/M7_httpd.html#22","title":"2.2 \u63cf\u8ff0","text":"<p>\u5b9e\u73b0\u4e00\u4e2a\u652f\u6301\u591a\u7ebf\u7a0b\u7684 HTTP \u670d\u52a1\u5668\uff0c\u76d1\u542c prot \u7aef\u53e3 (\u9ed8\u8ba4\u4e3a 8080)\uff0c\u80fd\u591f\u5904\u7406\u5e76\u53d1\u7684 HTTP \u8bf7\u6c42\u3002\u4e0d\u7528\u62c5\u5fc3\uff0c\u6211\u4eec\u5df2\u7ecf\u63d0\u4f9b\u4e86\u4e00\u4efd \u201c\u53ef\u4ee5\u8fd0\u884c\u201d \u7684 httpd \u4f9b\u5927\u5bb6\u53c2\u8003\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u8fd0\u884c\u5b83\uff0c\u5e76\u4e14\u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95ee\u4efb\u4f55 url\uff0c\u90fd\u53ef\u4ee5\u5f97\u5230 \u201cunder construction\u201d \u7684\u54cd\u5e94\u3002\u6ca1\u9519\uff0c\u4f60\u7684\u6d4f\u89c8\u5668\u80fd\u76f4\u63a5\u8bbf\u95ee\u4f60\u7684 Web \u670d\u52a1\uff01\u4f60\u8d70\u51fa\u4e86\u8fc8\u5411\u4e92\u8054\u7f51\u65f6\u4ee3\u7684\u7b2c\u4e00\u6b65\uff01</p> <p>\u670d\u52a1\u5668\u9700\u8981\u652f\u6301\u4ee5\u4e0b\u529f\u80fd\uff1a</p> <ol> <li>GET <code>/cgi-bin/</code> \u5f00\u5934\u7684 URL\uff0c\u8c03\u7528 CGI \u7a0b\u5e8f\u8fd4\u56de\u52a8\u6001\u5185\u5bb9\u3002\u5982\u679c\u8def\u5f84\u975e\u6cd5\u6216 CGI \u811a\u672c\u4e0d\u5b58\u5728\uff0c\u8fd4\u56de 404 \u9519\u8bef\u3002\u5982\u679c CGI \u811a\u672c\u6267\u884c\u5931\u8d25\uff0c\u8fd4\u56de 500 \u9519\u8bef\u3002</li> <li>\u5e76\u53d1\u5230\u8fbe\u7684\u8bf7\u6c42\u5e94\u5f53\u5c3d\u5feb\u63a5\u6536\u5e76\u5c3d\u53ef\u80fd\u5e76\u884c\u5904\u7406\u3002\u5e76\u884c\u6267\u884c\u7684\u8bf7\u6c42\u6570\u4e0d\u5f97\u8d85\u8fc7 4 \u4e2a\u3002\u6ce8\u610f\u8bc4\u6d4b\u65f6\uff0cCGI \u811a\u672c\u6267\u884c\u7684\u65f6\u95f4\u53ef\u80fd\u5f88\u957f\u3002</li> <li>\u6309\u7167\u8bf7\u6c42\u5230\u6765\u7684\u987a\u5e8f\u8f93\u51fa\u65e5\u5fd7\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u5728\u6bcf\u6b21\u65e5\u5fd7\u8f93\u51fa\u540e\u90fd\u8bf7\u786e\u4fdd\u6267\u884c fflush\u3002\u6211\u4eec\u5df2\u7ecf\u63d0\u4f9b\u4e86 log_request \u51fd\u6570\uff0c\u8bf7\u8c03\u7528\u5b83\u3002</li> </ol> <p>\u26a0\ufe0flog_request</p> <p>\u6839\u636e log_request \u7684\u8f93\u51fa\uff1a</p> <pre><code>printf(\"[%s] [%s] [%s] [%d]\\n\", timestamp, method, path, status_code);\n</code></pre> <p>\u4f60\u9700\u8981\u8f93\u51fa\u6b63\u786e\u7684\u8def\u5f84\uff0c\u4f8b\u5982 /cgi-bin/echo\uff0c\u4ee5\u53ca\u6b63\u786e\u7684\u72b6\u6001\u7801\uff0c\u4f8b\u5982 CGI \u7a0b\u5e8f\u8fd4\u56de\u7684 403\u3002</p>"},{"location":"courses/os_lab/M7_httpd.html#23","title":"2.3 \u89e3\u91ca","text":"<p>CGI (Common Gateway Interface) \u662f\u4e00\u79cd\u5141\u8bb8 Web \u670d\u52a1\u5668\u4e0e\u5916\u90e8\u7a0b\u5e8f\u901a\u4fe1\u7684\u6807\u51c6\u534f\u8bae\u3002\u5f53\u670d\u52a1\u5668\u6536\u5230\u4ee5 <code>/cgi-bin/</code> \u5f00\u5934\u7684\u8bf7\u6c42\u65f6\uff0c\u5b83\u4f1a\uff1a</p> <ol> <li>\u89e3\u6790\u8bf7\u6c42\u8def\u5f84\uff0c\u786e\u5b9a\u8981\u6267\u884c\u7684 CGI \u7a0b\u5e8f\u3002CGI \u7a0b\u5e8f\u53ef\u4ee5\u662f\u4efb\u4f55\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5305\u62ec\u7f16\u8bd1\u540e\u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u3001\u811a\u672c\u6587\u4ef6\uff08\u5982 Python\u3001Shell \u811a\u672c\u7b49\uff09\u3001\u5176\u4ed6\u53ef\u6267\u884c\u7a0b\u5e8f\u7b49\u3002CGI \u7a0b\u5e8f\u4fdd\u5b58\u5728 <code>cgi-bin/</code> \u76ee\u5f55\u4e0b\uff0c\u4f8b\u5982 <code>cgi-bin/echo</code>\u3002</li> <li>CGI \u8981\u6c42\u521b\u5efa\u5b50\u8fdb\u7a0b\u6765\u6267\u884c\u8be5\u7a0b\u5e8f\uff0c\u5e76\u5c06 HTTP \u8bf7\u6c42\u7684\u4fe1\u606f (\u5982\u8bf7\u6c42\u65b9\u6cd5\u3001\u8bf7\u6c42\u5934\u3001\u67e5\u8be2\u5b57\u7b26\u4e32\u7b49) \u901a\u8fc7\u73af\u5883\u53d8\u91cf\u4f20\u9012\u7ed9 CGI \u7a0b\u5e8f\u3002</li> <li>\u7a0b\u5e8f\u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u5c06 CGI \u7a0b\u5e8f\u7684\u8f93\u51fa (\u6807\u51c6\u8f93\u51fa) \u4f5c\u4e3a HTTP \u54cd\u5e94\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002</li> </ol> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cCGI \u7a0b\u5e8f\u5fc5\u987b\u8f93\u51fa\u5b8c\u6574\u7684 HTTP Response\uff0c\u7a0b\u5e8f\u5fc5\u987b\u5904\u7406\u5404\u79cd\u9519\u8bef\u60c5\u51b5 (\u5982\u6587\u4ef6\u4e0d\u5b58\u5728\u3001\u6743\u9650\u4e0d\u8db3\u7b49)\uff0c\u670d\u52a1\u5668\u9700\u8981\u6b63\u786e\u5904\u7406 CGI \u7a0b\u5e8f\u7684\u9000\u51fa\u72b6\u6001\u3002\u4f8b\u5982\uff0c\u5f53\u6536\u5230\u8bf7\u6c42 <code>GET /cgi-bin/hello?name=world</code> \u65f6\uff1a</p> <ol> <li> <p>\u670d\u52a1\u5668\u4f1a\u6267\u884c <code>cgi-bin/hello</code> \u7a0b\u5e8f\uff1b</p> </li> <li> <p>\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff1a</p> </li> <li> <p><code>REQUEST_METHOD=GET</code>, <code>QUERY_STRING=name=world</code></p> </li> <li> <p>(\u5176\u4ed6 HTTP \u5934\u4fe1\u606f\u6211\u4eec\u4e0d\u8981\u6c42\u5904\u7406)</p> </li> <li> <p>CGI \u7a0b\u5e8f\u6267\u884c\u5e76\u8f93\u51fa HTTP \u54cd\u5e94\uff0c\u4f8b\u5982</p> </li> </ol> <pre><code>Content-Type: text/plain\n\nHello, world!\n</code></pre> <ol> <li>\u670d\u52a1\u5668\u5c06\u8f93\u51fa\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u3002</li> </ol> <p>\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6b63\u786e\u7684 CGI \u811a\u672c \u201cecho\u201d (bash; \u5f53\u7136\uff0c\u4f60\u53ef\u4ee5\u7528\u4efb\u4f55\u65b9\u5f0f\u5b9e\u73b0\u4f60\u7684\u540e\u7aef\u7a0b\u5e8f)\uff0c\u5982\u679c\u5b9e\u73b0\u6b63\u786e\uff0c\u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95ee http://localhost:8080/cgi-bin/echo \u770b\u5230\u8bf7\u6c42\u7684\u65b9\u6cd5 (GET)\u3001\u53c2\u6570\u3001\u73af\u5883\u53d8\u91cf\u548c\u65e5\u671f\u3002</p> <p>\u26a0\ufe0fAIGC Policy\u8fd9\u4e2a\u5b9e\u9a8c\u5bf9\u5927\u8bed\u8a00\u6a21\u578b\u6765\u8bf4\u662f \u201c\u521a\u597d\u9002\u5408\u201d \u7684\u4efb\u52a1\uff0c\u751a\u81f3\u6211\u4eec\u7684\u53c2\u8003\u5b9e\u73b0\u90fd\u662f\u7531 LLM \u76f4\u63a5\u4e00\u6b21\u751f\u6210\u6b63\u786e\u7684\u3002\u4f46\u4e3a\u4e86\u83b7\u5f97\u6700\u4f73\u7684\u5b66\u4e60\u6548\u679c\uff0c\u4f60\u53ef\u4ee5\u501f\u52a9\u5927\u8bed\u8a00\u6a21\u578b\u67e5\u9605 CGI \u7684\u76f8\u5173\u6807\u51c6\uff0c\u8be2\u95ee\u4efb\u4f55\u4e0d\u7406\u89e3\u7684\u5730\u65b9\uff0c\u4f46\u8bf7\u4f60\u4e0d\u8981\u4f7f\u7528\u5927\u8bed\u8a00\u6a21\u578b\u76f4\u63a5\u5b9e\u73b0\u4ee3\u7801\u3002</p>"},{"location":"courses/os_lab/M7_httpd.html#24-http-request-response","title":"2.4 HTTP Request \u548c Response \u683c\u5f0f","text":"<p>\u5728 HTTP/1.1 \u534f\u8bae\u4e2d\uff0c\u6bcf\u4e2a\u8bf7\u6c42\u7531\u8bf7\u6c42\u884c\u3001\u8bf7\u6c42\u5934 (header)\u3001\u7a7a\u884c\u4ee5\u53ca\u53ef\u9009\u7684\u8bf7\u6c42\u6d88\u606f\u4f53\u4f9d\u6b21\u7ec4\u6210\u3002\u8bf7\u6c42\u884c\u9996\u5148\u6307\u51fa\u8bf7\u6c42\u65b9\u6cd5 (\u5982 GET\u3001POST \u7b49)\u3001\u8bf7\u6c42\u76ee\u6807 (\u5305\u542b\u8d44\u6e90\u8def\u5f84\u548c\u53ef\u9009\u67e5\u8be2\u5b57\u7b26\u4e32) \u4ee5\u53ca\u534f\u8bae\u7248\u672c (\u901a\u5e38\u4e3a HTTP/1.1)\uff0c\u4e09\u8005\u4e4b\u95f4\u4ee5\u7a7a\u683c\u5206\u9694\uff0c\u5e76\u4ee5 CRLF (\\r\\n) \u7ed3\u675f\u3002\u968f\u540e\u662f\u4e00\u7cfb\u5217\u8bf7\u6c42\u5934\uff0c\u6bcf\u4e00\u884c\u7531\u5934\u90e8\u5b57\u6bb5\u540d\u3001\u5192\u53f7\u3001\u7a7a\u683c\u548c\u5b57\u6bb5\u503c\u6784\u6210\uff0c\u540c\u6837\u4ee5 CRLF \u7ed3\u5c3e\u3002\u4e00\u4e2a\u7a7a\u884c (\u8fde\u7eed\u4e24\u4e2a CRLF) \u6807\u5fd7\u7740\u8bf7\u6c42\u5934\u7684\u7ed3\u675f\uff0c\u5982\u679c\u8bf7\u6c42\u65b9\u6cd5\u8981\u6c42\u5728\u6d88\u606f\u4f53\u4e2d\u643a\u5e26\u6570\u636e (\u4f8b\u5982 POST \u4e0a\u4f20\u8868\u5355)\uff0c\u5219\u5728\u7a7a\u884c\u4e4b\u540e\u7d27\u8ddf\u6d88\u606f\u4f53\u5185\u5bb9\uff0c\u5176\u5b57\u8282\u957f\u5ea6\u7531 Content-Length \u5934\u7cbe\u786e\u6307\u660e\u3002</p> <p>\u670d\u52a1\u5668\u5728\u6536\u5230\u5b8c\u6574\u8bf7\u6c42\u540e\uff0c\u4f1a\u8fd4\u56de\u4e00\u4e2a HTTP/1.1 \u54cd\u5e94\uff0c\u7ed3\u6784\u4e0e\u8bf7\u6c42\u7c7b\u4f3c\uff0c\u7531\u72b6\u6001\u884c\u3001\u54cd\u5e94\u5934\u3001\u7a7a\u884c\u548c\u53ef\u9009\u7684\u54cd\u5e94\u6d88\u606f\u4f53\u4f9d\u6b21\u6784\u6210\u3002\u72b6\u6001\u884c\u5305\u542b\u534f\u8bae\u7248\u672c\u3001\u4e09\u4f4d\u6570\u5b57\u72b6\u6001\u7801 (\u5982 200\u3001404\u3001500 \u7b49) \u4ee5\u53ca\u539f\u56e0\u77ed\u8bed\uff0c\u4e09\u8005\u4ee5\u7a7a\u683c\u5206\u9694\u5e76\u4ee5 CRLF \u7ed3\u675f\u3002\u968f\u540e\u662f\u4e00\u7cfb\u5217\u54cd\u5e94\u5934\uff0c\u4f8b\u5982 Content-Type \u7528\u4e8e\u8bf4\u660e\u6d88\u606f\u4f53\u7684\u5a92\u4f53\u7c7b\u578b\uff0cContent-Length \u6307\u793a\u6d88\u606f\u4f53\u7684\u5b57\u8282\u957f\u5ea6\uff0cConnection \u63a7\u5236\u662f\u5426\u4fdd\u6301\u8fde\u63a5\u7b49\u3002\u54cd\u5e94\u5934\u7ed3\u675f\u540e\u4ee5\u7a7a\u884c\u5206\u9694\uff0c\u7d27\u63a5\u7740\u662f\u54cd\u5e94\u6d88\u606f\u4f53\uff0c\u5176\u5185\u5bb9\u53ef\u4ee5\u662f HTML\u3001JSON\u3001\u7eaf\u6587\u672c\u6216\u4e8c\u8fdb\u5236\u6570\u636e\u3002\u6d88\u606f\u4f53\u53d1\u9001\u5b8c\u6bd5\u540e\uff0c\u5982\u679c Connection \u5934\u4e3a close\uff0c\u670d\u52a1\u5668\u5c06\u5173\u95ed\u8fde\u63a5\uff0c\u5426\u5219\u4fdd\u6301\u8fde\u63a5\u4ee5\u4fbf\u590d\u7528\u5904\u7406\u540e\u7eed\u8bf7\u6c42\u3002</p> <p>\u4f60\u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u4e2d\u67e5\u770b\u5b8c\u6574\u7684 HTTP Request \u548c Response\u3002</p> <p>\ud83d\udcacPrompt: \u5982\u4f55\u5728\u6d4f\u89c8\u5668\u4e2d\u67e5\u770b\u5b8c\u6574\u7684 HTTP Request \u548c Response\uff1f claude-3.7-sonnet: \u25b6\ufe0f</p>"},{"location":"courses/os_lab/M7_httpd.html#3","title":"3. \u6b63\u786e\u6027\u6807\u51c6","text":"<p>\u9996\u5148\uff0c\u4f60\u9700\u8981\u6b63\u786e\u5730\u5b9e\u73b0 CGI \u811a\u672c\u7684\u6267\u884c\u3002\u6211\u4eec\u4f1a\u5728 cgi-bin \u76ee\u5f55\u4e0b\u653e\u7f6e\u82e5\u5e72 CGI \u811a\u672c\uff0c\u5e76\u4f7f\u7528 curl \u547d\u4ee4\u6d4b\u8bd5\u4f60\u7684 httpd \u662f\u5426\u80fd\u591f\u6b63\u786e\u5730\u6267\u884c\u8fd9\u4e9b\u811a\u672c\u3002\u5982\u679c\u4f60\u7684 httpd \u80fd\u6b63\u786e\u89e3\u6790 URL\u3001\u4f20\u9012\u73af\u5883\u53d8\u91cf REQUEST_METHOD \u548c QUERY_STRING\uff0c\u5e76\u6b63\u786e\u8fd4\u56de CGI \u811a\u672c\u7684\u8f93\u51fa\uff0c\u53ef\u4ee5\u901a\u8fc7 Easy Test Cases\u3002</p> <p>\u5bf9\u4e8e Hard Test Cases\uff0c\u6211\u4eec\u4f1a\u5e76\u53d1\u5730\u8bf7\u6c42\u4f60\u7684 httpd\u3002\u6b64\u65f6\uff0c\u4e0d\u540c\u8bf7\u6c42\u7684 CGI \u811a\u672c\u7684\u5904\u7406\u65f6\u95f4\u53ef\u80fd\u6709\u663e\u8457\u533a\u522b\uff0c\u4f46\u4f60\u7684 httpd \u5e94\u5f53\u6309\u6536\u5230\u8bf7\u6c42\u7684\u987a\u5e8f\u8f93\u51fa\u65e5\u5fd7\uff0c\u65e5\u5fd7\u5305\u542b CGI \u811a\u672c\u8fd4\u56de\u7684 HTTP response status code (\u4f8b\u5982 200, 404, 500)\u3002</p>"},{"location":"courses/os_lab/M7_httpd.html#4","title":"4. \u5b9e\u9a8c\u6307\u5357","text":""},{"location":"courses/os_lab/M7_httpd.html#41-httpd","title":"4.1 \u6846\u67b6\u4ee3\u7801\u4e2d\u7684 httpd","text":"<p>\u5b9e\u9a8c\u6846\u67b6\u4ee3\u7801\u5b9e\u73b0\u4e86\u4e0d\u652f\u6301 CGI\u3001\u4e0d\u5e76\u53d1\u7684 httpd\u3002\u4ee3\u7801\u7684\u6838\u5fc3\u662f <code>handle_request</code> \u51fd\u6570\uff1a</p> <pre><code>void handle_request(int client_socket) {\n    char buffer[BUFFER_SIZE];\n    int bytes_received;\n\n    // Read request\n    bytes_received = recv(client_socket, buffer, BUFFER_SIZE - 1, 0);\n    if (bytes_received &lt;= 0) {\n        return;\n    }\n    buffer[bytes_received] = '\\0';\n\n    printf(\"Got a new request:\\n%s\\n\", buffer);\n\n    // Send \"Under construction\" response\n    const char *response_body = \"Under construction\";\n    int body_length = strlen(response_body);\n\n    char content_length_header[64];\n    sprintf(content_length_header, \"Content-Length: %d\\r\\n\", body_length);\n\n    send(client_socket, \"HTTP/1.1 200 OK\\r\\n\", 17, 0);\n    send(client_socket, \"Content-Type: text/plain\\r\\n\", 26, 0);\n    send(client_socket, content_length_header, strlen(content_length_header), 0);\n    send(client_socket, \"Connection: close\\r\\n\", 19, 0);\n    send(client_socket, \"\\r\\n\", 2, 0);\n    send(client_socket, response_body, body_length, 0);\n\n    // Close the connection\n    close(client_socket);\n}\n</code></pre> <p>\u51fd\u6570\u7684\u53c2\u6570\u662f\u4e00\u4e2a \u201cclient_socket\u201d\uff0c\u5b83\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26 (\u66f4\u7cbe\u786e\u5730\u8bf4\uff0c\u662f\u4e00\u4e2a socket \u63cf\u8ff0\u7b26)\uff0c\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528 read \u548c write \u8bfb\u5199\u2014\u2014\u53ea\u662f\u6211\u4eec\u7528\u4e86\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u7f51\u7edc API \u4e2d\u7684 send \u548c recv\uff0c\u4f60\u628a\u5b83\u4eec\u7406\u89e3\u6210\u8bfb\u53d6\u8fde\u63a5\u5230 \u201c\u8fdc\u7aef\u201d \u7ba1\u9053\u7684 read \u548c write \u5373\u53ef\u3002\u5b83\u9996\u5148\u8bfb\u51fa\u4e00\u4e2a\u4e0d\u592a\u957f\u7684 http request\uff0c\u7136\u540e\u6784\u9020\u4e00\u4e2a HTTP/1.1 200 OK \u7684 response\uff0c\u56de\u590d\u7684\u5b57\u7b26\u4e32\u662f \u201cUnder construction\u201d\u3002</p> <p>main \u51fd\u6570\u5219\u5728\u505a\u51fa\u5fc5\u8981\u7684\u521d\u59cb\u5316\uff0c\u5305\u62ec socket \u7684\u521b\u5efa\u3001\u7ed1\u5b9a\u3001\u76d1\u542c\uff0c\u7136\u540e\u63a5\u53d7\u8fde\u63a5\u5e76\u8c03\u7528 <code>handle_request</code> \u5904\u7406\u8bf7\u6c42\u3002\u6211\u76f4\u63a5\u5728 Cursor \u4e2d\u6253\u5f00\u4e86\u6846\u67b6\u4ee3\u7801\uff0c\u7136\u540e\u628a \u201c\u79d1\u666e\u89e3\u91ca\u201d \u7684\u4efb\u52a1\u4ea4\u7ed9\u4e86 AI\u3002AI \u63d0\u4f9b\u7684\u4fe1\u606f\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u8d77\u70b9\uff0c\u4f60\u53ef\u4ee5\u6301\u7eed\u548c AI \u5bf9\u8bdd\u5feb\u901f\u7406\u89e3 HTTP \u670d\u52a1\u5668\u7684\u5de5\u4f5c\u539f\u7406\u3002</p> <p>\ud83d\udcacPrompt: ...\u7ed9\u6211\u7528\u666e\u53ca\u7684\u53e3\u543b\u89e3\u91ca\u4e00\u4e0b\u5176\u4e2d\u51fa\u73b0\u7684\u548c\u7f51\u7edc\u76f8\u5173\u7684\u6982\u5ff5\u3002 claude-3.7-sonnet: \u25b6\ufe0f</p>"},{"location":"courses/os_lab/M7_httpd.html#42","title":"4.2 \u524d\u7aef\u548c\u540e\u7aef","text":"<p>\u4eca\u5929\uff0cWeb \u7684 \u201c\u524d\u7aef\u201d \u662f\u6307\u7528\u6237\u76f4\u63a5\u4ea4\u4e92\u7684\u90e8\u5206\uff0c\u4e3b\u8981\u8d1f\u8d23\u9875\u9762\u7684\u5c55\u793a\u4e0e\u7528\u6237\u4f53\u9a8c\uff0c\u5e38\u7528\u6280\u672f\u6709 HTML\u3001CSS\u3001JavaScript \u7b49\u3002\u201c\u540e\u7aef\u201d \u662f\u6307\u652f\u6491\u524d\u7aef\u7684\u670d\u52a1\u5668\u7aef\u90e8\u5206\uff0c\u8d1f\u8d23\u6570\u636e\u5b58\u50a8\u3001\u4e1a\u52a1\u903b\u8f91\u5904\u7406\u548c\u63a5\u53e3\u63d0\u4f9b\uff0c\u5e38\u7528\u6280\u672f\u6709 Java\u3001Python\u3001Node.js \u7b49\uff0c\u8fd8\u6d89\u53ca\u6570\u636e\u5e93\u3001\u8d1f\u8f7d\u5747\u8861\u5668\u7b49\u7cfb\u7edf\u7ec4\u4ef6\u3002\u524d\u7aef\u6ce8\u91cd\u754c\u9762\u4e0e\u4ea4\u4e92\uff0c\u540e\u7aef\u6ce8\u91cd\u6570\u636e\u5904\u7406\u4e0e\u5b89\u5168\uff0c\u4e24\u8005\u5171\u540c\u534f\u4f5c\u5b9e\u73b0\u5b8c\u6574\u7684\u7f51\u7ad9\u6216\u5e94\u7528\u3002</p> <p>\u5728\u8fd9\u91cc\u56de\u987e\u4e00\u4e0b\u5386\u53f2\u4f1a\u5f88\u6709\u8da3\u3002\u65e9\u671f\u7684 Web \u7edd\u5927\u591a\u6570\u5185\u5bb9\u90fd\u5c5e\u4e8e \u201c\u524d\u7aef\u201d\uff0c\u5b83\u4eec\u662f\u9759\u6001\u7684\uff0c\u7531 HTML \u6587\u4ef6\u7ec4\u6210\uff0c\u6d4f\u89c8\u5668\u8d1f\u8d23\u6e32\u67d3\u3002\u7f51\u7edc\u540e\u7aef\u53ea\u662f\u8d1f\u8d23\u89e3\u6790 url \u4e2d\u7684\u8def\u5f84\uff0c\u4f8b\u5982 <code>/wiki/index.html</code>\uff0c\u4ece\u672c\u5730\u7684\u6587\u4ef6\u7cfb\u7edf\u4e2d\u8bfb\u53d6\u6587\u4ef6\u5e76\u8fd4\u56de\u7ed9\u6d4f\u89c8\u5668\u3002\u5f53\u7136\uff0c\u65e2\u7136\u8d1f\u8d23\u8fd4\u56de\u9875\u9762\u7684\u540e\u7aef\u662f\u7a0b\u5e8f\uff0c\u6211\u4eec\u81ea\u7136\u53ef\u4ee5 \u201chack\u201d \u5b83\uff0c\u4f7f\u6211\u4eec\u5728\u8bf7\u6c42 url \u7684\u65f6\u5019\uff0c\u6839\u636e\u670d\u52a1\u5668\u4e0a\u5b58\u50a8\u7684\u6570\u636e\u5b9e\u73b0\u7684\u52a8\u6001\u7684\u5185\u5bb9\uff0c\u4f8b\u5982 CGI \u5b9e\u73b0\u7684 Web Forum: \u4f60\u53ef\u4ee5\u57fa\u4e8e UNIX \u6587\u4ef6\u7cfb\u7edf\u7528\u51e0\u767e\u884c\u811a\u672c\u5b9e\u73b0\u4e00\u4e2a \u201c\u5728\u7ebf\u8ba8\u8bba\u8bba\u575b\u201d\uff0c\u5141\u8bb8\u7528\u6237\u6d4f\u89c8\u5206\u533a\u5e16\u5b50\u3001\u53d1\u8868\u5e16\u5b50\u3001\u56de\u590d\u5e16\u5b50\u7b49\u3002\u4e0b\u9762\u662f 2001 \u5e74\u7684 Wikipedia \u9996\u9875\uff0c\u5728\u90a3\u65f6\u8fd9\u5df2\u7ecf\u662f\u975e\u5e38 \u201c\u4e86\u4e0d\u8d77\u201d \u7684\u9879\u76ee\u4e86\u2014\u2014\u5f53\u65f6\u7684\u5f00\u53d1\u4eba\u5458\u505a\u68a6\u4e5f\u60f3\u4e0d\u5230\u4eca\u5929 Vibe Coding \u534a\u5c0f\u65f6\u5c31\u80fd\u5b9e\u73b0\u4e00\u4e2a\u5b8c\u6210\u5ea6\u9ad8\u5f97\u591a\uff0c\u90e8\u7f72\u5728\u4e91\u5e73\u53f0\u5c31\u80fd\u4e0a\u7ebf\u5b9e\u88c5\u7684\u7cfb\u7edf\uff1a</p> <p></p> <p>\u968f\u7740\u4e92\u8054\u7f51\u7684\u53d1\u5c55\uff0c\u524d\u540e\u7aef\u7684\u5206\u5de5\u53d8\u5f97\u66f4\u52a0\u660e\u786e\u3002Web 2.0 \u65f6\u4ee3\u5f15\u5165\u4e86 AJAX \u6280\u672f\uff0c\u4f7f\u5f97\u524d\u7aef\u53ef\u4ee5\u5f02\u6b65\u5730\u5411\u540e\u7aef\u8bf7\u6c42\u6570\u636e\uff0c\u800c\u4e0d\u5fc5\u5237\u65b0\u6574\u4e2a\u9875\u9762\uff0c\u5927\u5927\u63d0\u5347\u4e86\u7528\u6237\u4f53\u9a8c\u3002\u8fd9\u4e5f\u4fc3\u4f7f\u4e86\u524d\u7aef\u6846\u67b6\u7684\u84ec\u52c3\u53d1\u5c55\uff0c\u5982 jQuery\u3001Angular\u3001React \u548c Vue \u7b49\uff0c\u4f7f\u5f97\u524d\u7aef\u5f00\u53d1\u66f4\u52a0\u6a21\u5757\u5316\u548c\u7ec4\u4ef6\u5316\u3002\u540c\u65f6\uff0c\u540e\u7aef\u6280\u672f\u4e5f\u5728\u4e0d\u65ad\u6f14\u8fdb\u3002\u4ece\u65e9\u671f\u7684 CGI \u811a\u672c\uff0c\u5230 PHP\u3001ASP \u7b49\u670d\u52a1\u5668\u7aef\u811a\u672c\u8bed\u8a00\uff0c\u518d\u5230\u73b0\u4ee3\u7684 MVC \u6846\u67b6\u5982 Ruby on Rails\u3001Django\u3001Spring Boot \u7b49\uff0c\u540e\u7aef\u5f00\u53d1\u53d8\u5f97\u66f4\u52a0\u7ed3\u6784\u5316\u548c\u9ad8\u6548\u3002\u5fae\u670d\u52a1\u67b6\u6784\u7684\u5174\u8d77\u8fdb\u4e00\u6b65\u6539\u53d8\u4e86\u540e\u7aef\u7684\u8bbe\u8ba1\u7406\u5ff5\uff0c\u5c06\u5927\u578b\u5e94\u7528\u62c6\u5206\u6210\u591a\u4e2a\u72ec\u7acb\u7684\u670d\u52a1\uff0c\u6bcf\u4e2a\u670d\u52a1\u8d1f\u8d23\u7279\u5b9a\u7684\u529f\u80fd\uff0c\u901a\u8fc7 API \u76f8\u4e92\u901a\u4fe1\u3002\u4e91\u8ba1\u7b97\u7684\u666e\u53ca\u4e5f\u6781\u5927\u5730\u6539\u53d8\u4e86\u540e\u7aef\u90e8\u7f72\u65b9\u5f0f\u3002\u4ece\u4f20\u7edf\u7684\u7269\u7406\u670d\u52a1\u5668\uff0c\u5230\u865a\u62df\u673a\uff0c\u518d\u5230\u73b0\u5728\u7684\u5bb9\u5668\u5316\u548c\u670d\u52a1\u5668\u65e0\u611f\u77e5\u8ba1\u7b97 (Serverless)\uff0c\u90e8\u7f72\u53d8\u5f97\u66f4\u52a0\u7075\u6d3b\u548c\u53ef\u6269\u5c55\uff0c\u901a\u8fc7\u5e95\u5c42\u6570\u636e\u5e93\u3001\u5927\u6570\u636e\u7cfb\u7edf\u7684\u652f\u6301\uff0c\u5e94\u7528\u53ef\u4ee5\u65e0\u7f1d\u6269\u5c55\u5230\u5343\u4e07\u7ea7\u7528\u6237\u3002</p> <p></p> <p>\u524d\u540e\u7aef\u5206\u79bb\u5df2\u6210\u4e3a\u73b0\u4ee3 Web \u5f00\u53d1\u7684\u4e3b\u6d41\u6a21\u5f0f\u3002\u524d\u7aef\u901a\u8fc7 RESTful API \u4e0e\u540e\u7aef\u901a\u4fe1\uff0c\u540e\u7aef\u4e13\u6ce8\u4e8e\u63d0\u4f9b\u6570\u636e\u548c\u4e1a\u52a1\u903b\u8f91\uff0c\u524d\u7aef\u8d1f\u8d23\u6570\u636e\u5c55\u793a\u548c\u7528\u6237\u4ea4\u4e92\u3002\u8bfe\u7a0b\u7f51\u7ad9\u4f7f\u7528\u4e86 Next.js \u7edf\u4e00\u7ba1\u7406\u524d\u540e\u7aef\u4ee3\u7801\uff0c\u4f8b\u5982\u4f60\u770b\u5230\u7684\u8fd9\u4e2a\u5b9e\u9a8c\u63cf\u8ff0\u9875\u9762\uff0cMarkdown \u7684\u5b9e\u9a8c\u8bb2\u4e49\u662f\u5728\u6d4f\u89c8\u5668\u4e2d\u6e32\u67d3\u6210 DOM Tree \u7684\uff0c\u800c\u6240\u6709\u9875\u9762\u7684\u524d\u7aef\u4ee3\u7801\u90fd\u662f\u5171\u4eab\u7684\uff0c\u6d4f\u89c8\u5668\u4f1a\u81ea\u52a8\u7f13\u5b58\u8fd9\u4e9b JavaScript \u811a\u672c\uff0c\u4f7f\u4f60\u5728\u6253\u5f00\u9875\u9762\u65f6\u53ea\u9700\u52a0\u8f7d\u5f88\u5c11\u7684\u6570\u636e\u3002\u524d\u7aef\u6280\u672f\u4e5f\u5f7b\u5e95\u6539\u53d8\u4e86\u7a0b\u5e8f\u7684\u5f00\u53d1\u6a21\u5f0f\uff0c\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u901a\u8fc7\u5c0f\u7a0b\u5e8f\uff0c\u5728\u5fae\u4fe1\u548c\u652f\u4ed8\u5b9d\u7684 WebView \u91cc\u5b8c\u6210\u4ece\u6821\u56ed\u5361\u5145\u503c\u5230\u533b\u4fdd\u6302\u53f7\u7684 \u201c\u4efb\u4f55\u4e8b\u201d \u4e86\u3002\u5728\u8fd9\u80cc\u540e\u662f\u7f16\u7a0b\u8bed\u8a00\u3001IDE\u3001\u7f16\u7a0b\u8f85\u52a9\u7b49\u6280\u672f\u5171\u540c\u8fdb\u6b65\u7684\u6770\u4f5c\u3002</p> <p></p>"},{"location":"courses/os_lab/M8_filerecovery.html","title":"M5: File Recovery (frecov)","text":"<p>M5: File Recovery (frecov) (jyywiki.cn)</p>"},{"location":"courses/os_lab/M8_filerecovery.html#1","title":"1. \u80cc\u666f","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u5de5\u5177 \u201c\u683c\u5f0f\u5316\u201d \u5b58\u50a8\u4ecb\u8d28\u2014\u2014\u901a\u5e38\u9ed8\u8ba4\u7684\u9009\u9879\u662f \u201c\u5feb\u901f\u683c\u5f0f\u5316\u201d\u3002\u8bfe\u5802\u4e0a\u4e5f\u5c55\u793a\u4e86 mkfs.fat (\u5c06\u6587\u4ef6\u7cfb\u7edf\u683c\u5f0f\u5316\u6210 FAT \u683c\u5f0f) \u5de5\u5177\u5728\u683c\u76d8\u65f6\u7684\u7cfb\u7edf\u8c03\u7528\u5e8f\u5217\u3002</p> <p>\u89e3\u91ca\u4e86 \u201c\u4e3a\u4ec0\u4e48 1TB \u7684\u78c1\u76d8\u53ea\u8981\u683c\u5f0f\u5316\u4e00\u79d2\u949f\u201d\uff1a</p> <ul> <li>\u628a\u5b58\u50a8\u8bbe\u5907\u4e0a\u7684\u6587\u4ef6\u7cfb\u7edf\u770b\u6210\u662f\u4e00\u4e2a\u6570\u636e\u7ed3\u6784 (\u4f8b\u5982\uff0c\u4e0d\u59a8\u5047\u8bbe\u6210\u662f\u5927\u5bb6\u719f\u6089\u7684\u4e8c\u53c9\u6811)\uff0c\u4f60\u4e0d\u96be\u7406\u89e3\u4f60\u53ea\u8981\u7834\u574f\u6570\u636e\u7ed3\u6784\u7684 \u201c\u6839\u8282\u70b9\u201d\uff0c\u4e5f\u5c31\u662f</li> </ul> <pre><code>root-&gt;left = root-&gt;right = NULL;\n</code></pre> <p>\u6570\u636e\u7ed3\u6784\u7684\u5176\u4ed6\u90e8\u5206\u4e5f\u5c31\u6c38\u4e45\u5730\u4e22\u5931\u4e86\u2014\u2014\u6570\u636e\u7ed3\u6784\u5c31\u5b8c\u6210\u4e86\u4e00\u6b21\u5b8c\u7f8e\u7684 \u201c\u5185\u5b58\u6cc4\u6f0f\u201d\u3002\u5f53\u7136\uff0c\u56e0\u4e3a\u6574\u4e2a\u6570\u636e\u7ed3\u6784\u90fd\u88ab\u6467\u6bc1\uff0c\u4f60\u4e5f\u53ef\u4ee5\u91cd\u7f6e\u5185\u5b58\u5206\u914d\u5668 (balloc/bfree) \u7684\u72b6\u6001\uff0c\u8fd9\u6837\u6240\u6709\u78c1\u76d8\u4e0a\u7684\u7a7a\u95f4\u5c31\u53d8\u5f97\u53ef\u4ee5\u88ab\u5206\u914d\uff0c\u78c1\u76d8\u4e5f\u5c31 \u201c\u7115\u7136\u4e00\u65b0\u201d (\u88ab\u683c\u5f0f\u5316) \u4e86\u3002</p>"},{"location":"courses/os_lab/M8_filerecovery.html#12","title":"1.2 \u683c\u5f0f\u5316\u78c1\u76d8\u7684\u6570\u636e\u6062\u590d","text":"<p>\u5feb\u901f\u683c\u5f0f\u5316\u7d27\u63a5\u7740\u5c31\u5e26\u6765\u4e86\u4e00\u4e2a\u95ee\u9898\uff1a\u5feb\u901f\u683c\u5f0f\u5316 (\u6307\u9488\u8d4b\u503c) \u4e5f\u610f\u5473\u7740\u4f60\u80fd\u901a\u8fc7\u904d\u5386\u5b58\u50a8\u8bbe\u5907 (\u5185\u5b58) \u7684\u65b9\u5f0f\u628a\u6570\u636e\u7ed3\u6784\u627e\u56de\u6765\uff1a</p> <pre><code>root-&gt;left = find_left();\nroot-&gt;right = find_left();\n</code></pre> <p>\u53ea\u8981\u6062\u590d\u51fa\u8fd9\u4e24\u4e2a\u6307\u9488\uff0c\u6574\u4e2a\u4e8c\u53c9\u6811\u5c31\u53c8\u56de\u6765\u4e86\uff01</p> <p>\u4e0d\u4ec5\u662f\u683c\u5f0f\u5316\uff0c\u6211\u4eec\u77e5\u9053\u6587\u4ef6\u7cfb\u7edf\u5728\u5b9e\u73b0\u6587\u4ef6/\u76ee\u5f55\u7684\u5220\u9664\u64cd\u4f5c\u65f6\uff0c\u4e5f\u53ea\u662f\u4ece\u6587\u4ef6\u7cfb\u7edf\u7684\u6570\u636e\u7ed3\u6784\u4e2d\u62b9\u53bb\u6587\u4ef6\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u5e76\u4e0d\u4f1a\u5b9e\u9645\u5c06\u6bcf\u4e00\u4e2a\u4fdd\u5b58\u6570\u636e\u7684\u5757\u5220\u9664\u3002</p> <ul> <li>\u589e\u52a0\u4e86\u6587\u4ef6\u7cfb\u7edf\u7684\u6027\u80fd\uff0c\u51cf\u5c11\u4e86\u78c1\u76d8\u7684\u8bfb\u5199\u6570\u91cf\uff0c\u5176\u5b9e\u727a\u7272\u4e86\u4e00\u5b9a\u7a0b\u5ea6\u7684\u5b89\u5168\u6027\u2014\u2014\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 \u201c\u626b\u63cf\u78c1\u76d8\u201d \u7684\u65b9\u5f0f\u4e00\u5b9a\u7a0b\u5ea6\u5730\u6062\u590d\u51fa\u6587\u4ef6\u7cfb\u7edf\u4e2d\u5df2\u7ecf\u88ab\u5220\u9664\u7684\u6587\u4ef6\u3002</li> </ul>"},{"location":"courses/os_lab/M8_filerecovery.html#_1","title":"\u6587\u4ef6\u7c89\u788e","text":"<p>\u6587\u4ef6\u7c89\u788e\u7684\u4e00\u4e2a\u5b9e\u73b0\u65b9\u6cd5\u662f\u7528\u8986\u76d6\u5199\u7684\u65b9\u5f0f\u628a\u6587\u4ef6\u7684\u6570\u636e\u6e05\u9664 (\u5373\u627e\u5230\u78c1\u76d8\u4e0a\u6240\u6709\u5b58\u50a8\u4e86\u8be5\u6587\u4ef6\u6570\u636e\u7684\u5757\uff0c\u5e76\u4e14\u5411\u5757\u5185\u5199\u5165\u968f\u673a\u6570\u636e)\uff0c\u7136\u540e\u518d\u5220\u9664\u3002</p> <ul> <li>\u5bf9\u4e8e HDD \u4e0a\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u901a\u5e38\u8fd9\u6837\u7684 \u201c\u6587\u4ef6\u7c89\u788e\u201d \u5c31\u662f\u76f8\u5f53\u5b89\u5168\u7684\u3002</li> <li>\u5e95\u5c42\u7684\u6587\u4ef6\u7cfb\u7edf (\u751a\u81f3\u662f Flash SSD \u7684 FTL) \u53ef\u80fd\u91c7\u7528 copy-on-write \u65b9\u5f0f\u4fdd\u5b58\u6570\u636e\uff0c\u4ece\u800c\u5728\u786c\u4ef6\u4e0a\u4fdd\u7559\u6587\u4ef6\u7684\u62f7\u8d1d\u3002</li> <li>\u867d\u7136\u6062\u590d\u5b83\u4eec\u9700\u8981\u5f88\u5927\u7684\u4ee3\u4ef7\uff0c\u4f46\u5b89\u5168\u7684 \u201c\u6587\u4ef6\u7c89\u788e\u201d \u53d8\u5f97\u66f4\u52a0\u56f0\u96be\u3002\u4f7f\u7528\u52a0\u5bc6\u7684\u6587\u4ef6\u7cfb\u7edf\u662f\u66f4\u597d\u7684\u529e\u6cd5\u3002</li> </ul>"},{"location":"courses/os_lab/M8_filerecovery.html#2","title":"2. \u5b9e\u9a8c\u63cf\u8ff0","text":"<p>\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u6211\u4eec\u8981\u6c42\u4f60\u7f16\u5199\u7a0b\u5e8f\uff0cbest-effort \u6062\u590d\u7ecf\u8fc7\u4e86\u5feb\u901f\u683c\u5f0f\u5316\u7684\u6587\u4ef6\u7cfb\u7edf\u4e2d bmp \u683c\u5f0f\u7684\u56fe\u7247\u5373\u53ef (\u5373\u5c3d\u53ef\u80fd\u5730\u62a2\u6551\u6587\u4ef6\u5373\u53ef)\u3002</p> <p>\u5b9e\u73b0\u547d\u4ee4\u884c\u5de5\u5177 <code>frecov</code>\uff0c\u7ed9\u5b9a\u4e00\u4e2a\u683c\u5f0f\u5316\u8fc7\u7684 FAT32 \u6587\u4ef6\u7cfb\u7edf\u955c\u50cf\uff0c\u5047\u8bbe\u5176\u4e2d\u7edd\u5927\u90e8\u5206\u6587\u4ef6\u90fd\u662f\u4ee5 BMP \u683c\u5f0f\u5b58\u50a8\u7684\u3002\u8bf7\u4f60\u5c3d\u53ef\u80fd\u5730\u4ece\u6587\u4ef6\u7cfb\u7edf\u4e2d\u6062\u590d\u51fa\u5b8c\u6574\u7684\u56fe\u7247\u6587\u4ef6\u3002\u547d\u4ee4\u884c\u5de5\u5177\u4f7f\u7528\u65b9\u6cd5\uff1a</p> <p>\u200b                                                                                                       <code>frecov FILE</code></p> <p>\u5176\u4e2d FILE \u662f\u4e00\u4e2a FAT-32 \u6587\u4ef6\u7cfb\u7edf\u7684\u955c\u50cf\u3002\u6bcf\u6062\u590d\u4e00\u5f20\u56fe\u7247\u6587\u4ef6 (\u5b8c\u6574\u7684\u6587\u4ef6\uff0c\u5305\u542b BMP \u5934\u548c\u6240\u6709\u6570\u636e)\uff0c\u8c03\u7528\u7cfb\u7edf\u4e2d\u7684 <code>sha1sum</code> \u547d\u4ee4\u83b7\u5f97\u5b83\u7684\u6821\u9a8c\u548c\uff0c\u5728\u6807\u51c6\u8f93\u51fa\u4e2d\u9010\u884c\u8f93\u51fa\u56fe\u7247\u6587\u4ef6\u7684\u6821\u9a8c\u548c\u4ee5\u53ca\u4f60\u6062\u590d\u51fa\u7684\u6587\u4ef6\u540d\u3002\u53ea\u6709\u6821\u9a8c\u548c\u4e0e\u6587\u4ef6\u540d\u90fd\u6062\u590d\u6b63\u786e\u4e14\u4e00\u81f4\uff0c\u624d\u88ab\u8ba4\u4e3a\u6b63\u786e\u6062\u590d\u4e86\u4e00\u4e2a\u6587\u4ef6\u3002</p>"},{"location":"courses/os_lab/M8_filerecovery.html#21","title":"2.1 \u56fe\u7247\u6062\u590d\u4efb\u52a1","text":"<p>\u8fd9\u4e2a\u5b9e\u9a8c\u5e76\u4e0d\u662f\u8ba9\u5927\u5bb6\u771f\u6b63\u7f16\u5199\u4e00\u4e2a\u4f18\u79c0\u7684 undelete \u5de5\u5177\u3002\u5982\u679c\u505a\u5230\u7684\u8bdd\uff0c\u4f60\u5c31\u53ef\u4ee5\u5f00\u516c\u53f8\u6323\u5927\u94b1\u4e86\uff01EasyRecovery \u66fe\u7ecf\u4e00\u5ea6\u6323\u5230\u5f88\u591a\u94b1</p> <p>\u5b9e\u9a8c\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u8ba9\u5927\u5bb6\u4f53\u9a8c\u4e00\u4e0b\uff1a</p> <ul> <li>\u4ed4\u7ec6\u9605\u8bfb FAT \u6587\u4ef6\u7cfb\u7edf\u7684 specification\u3002\u56e0\u4e3a\u624b\u518c\u4f53\u91cf\u4e0d\u5927\uff0c\u7cbe\u8bfb\u624b\u518c\u57fa\u672c\u5728\u4f60\u7684\u638c\u63a7\u8303\u56f4\u3002</li> <li>\u5199\u4ee3\u7801\u5206\u6790\u6587\u4ef6\u7cfb\u7edf\u955c\u50cf\uff0c\u5c24\u5176\u4f53\u4f1a mmap \u5e26\u6765\u7684\u4fbf\u5229\uff1b</li> <li>\u5199\u4ee3\u7801\u5206\u6790\u4e00\u4e2a\u5b9e\u9645\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff1a\u6211\u4eec\u9009\u53d6\u7684\u662f\u5206\u6790 BMP \u683c\u5f0f\u7684\u56fe\u7247\u6587\u4ef6\uff1b</li> <li>\u60f3\u4e00\u4e2a (\u4e5f\u8bb8\u662f\u975e\u5e38\u7b80\u5355) \u7684\u7b97\u6cd5\u6062\u590d\u51fa\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684 BMP \u6587\u4ef6\u3002\u4e5f\u8bb8\u80fd work \u7684\u7b97\u6cd5\u6bd4\u4f60\u60f3\u8c61\u66f4\u7b80\u5355\u3002</li> </ul> <p>\u6211\u4eec\u5bf9\u8fd9\u4e2a\u95ee\u9898\u505a\u4e86\u76f8\u5f53\u7684\u7b80\u5316\uff0c\u9996\u5148\uff0c\u6211\u4eec\u4fdd\u8bc1\u6211\u4eec\u7684\u6587\u4ef6\u7cfb\u7edf\u955c\u50cf\u4f7f\u7528\u5982\u4e0b\u65b9\u6cd5\u521b\u5efa\u7684 (\u4e3b\u8981\u4f7f\u7528 <code>mkfs.fat</code> \u5de5\u5177):</p> <ol> <li>\u521b\u5efa\u4e00\u4e2a\u7a7a\u6587\u4ef6 (\u4f8b\u5982\u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6587\u4ef6\u7cfb\u7edf\u955c\u50cf\u7684\u5927\u5c0f\u662f 64 MiB)\uff0c\u4f8b\u5982 <code>fs.img</code></li> </ol> <pre><code>$ cat /dev/zero | head -c $(( 1024 * 1024 * 64 )) &gt; fs.img\n</code></pre> <ol> <li>\u5728\u8fd9\u4e2a\u7a7a\u95f4\u6587\u4ef6\u4e0a\u521b\u5efa FAT-32 \u6587\u4ef6\u7cfb\u7edf</li> </ol> <pre><code>$ mkfs.fat -v -F 32 -S 512 -s 8 fs.img\nmkfs.fat 4.1 (2017-01-24)\nWARNING: Not enough clusters for a 32 bit FAT!\nfs.img has 64 heads and 32 sectors per track,\nhidden sectors 0x0000;\nlogical sector size is 512,\nusing 0xf8 media descriptor, with 131072 sectors;\ndrive number 0x80;\nfilesystem has 2 32-bit FATs and 8 sectors per cluster.\nFAT size is 128 sectors, and provides 16348 clusters.\nThere are 32 reserved sectors.\nVolume ID is 6f71a2db, no volume label.\n</code></pre> <p>\u6ce8\u610f\u6211\u4eec\u4f7f\u7528\u7684\u9009\u9879\uff1a<code>-S 512</code> \u8868\u793a sector \u5927\u5c0f\u662f 512, <code>-s 8</code> \u8868\u793a\u6bcf\u4e2a cluster \u6709 8 \u4e2a sectors\u3002\u8fd9\u4e2a\u4fe1\u606f\u5bf9\u5927\u5bb6\u6b63\u786e\u7f16\u7a0b\u975e\u5e38\u91cd\u8981\u2014\u2014\u5982\u679c\u4f60\u60f3\u5077\u61d2\uff0c\u53ef\u4ee5\u5047\u8bbe\u6211\u4eec\u603b\u662f\u7528\u8fd9\u79cd\u65b9\u5f0f\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf\u955c\u50cf (\u5373\u786c\u7f16\u7801\u8fd9\u4e2a\u4fe1\u606f)\uff0c\u4f46\u6211\u4eec\u66f4\u63a8\u8350\u4f60\u9605\u8bfb\u624b\u518c\uff0c\u5199\u51fa\u517c\u5bb9 FAT \u6807\u51c6\u7684 frecov\u3002</p> <p>\u5982\u679c\u4f60\u7528 <code>file</code> \u547d\u4ee4\uff0c\u53ef\u4ee5\u67e5\u770b\u5230\u955c\u50cf\u5df2\u7ecf\u88ab\u6b63\u786e\u683c\u5f0f\u5316\uff1a</p> <pre><code>$ file fs.img\nfs.img: DOS/MBR boot sector, code offset 0x58+2, OEM-ID \"mkfs.fat\", sectors/cluster 8, Media descriptor 0xf8, sectors/track 32, heads 64, sectors 131072 (volumes &gt; 32 MB), FAT (32 bit), sectors/FAT 128, serial number 0x166d2b7d, unlabeled\n</code></pre> <ol> <li>\u6302\u8f7d\u65b0\u521b\u5efa\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u5e76\u521b\u5efa\u6839\u76ee\u5f55\u4e0b\u7684 <code>DCIM</code> \u76ee\u5f55</li> </ol> <pre><code>$ mount fs.img /mnt/\n$ mkdir /mnt/DCIM\n</code></pre> <ol> <li> <p>\u6b64\u65f6\uff0c\u6587\u4ef6\u7cfb\u7edf\u5df2\u88ab\u6302\u8f7d (mount) \u5230 <code>/mnt</code> \u76ee\u5f55\u4e0b\uff0c\u5e76\u4e14\u6709\u4e00\u4e2a \u201cDCIM\u201d \u76ee\u5f55\u3002\u7136\u540e\u6211\u4eec\u4f1a\u5728 DCIM \u76ee\u5f55\u4e2d\u8fdb\u884c\u5f88\u591a\u6b21\u5982\u4e0b\u7684\u6587\u4ef6\u64cd\u4f5c\u3002\u5c3d\u7ba1\u56fe\u7247\u6587\u4ef6\u5206\u8fa8\u7387\u3001\u5927\u5c0f\u53ef\u80fd\u4e0d\u540c\uff0c\u4f46\u90fd\u4fdd\u8bc1\u662f\u771f\u5b9e\u4e16\u754c\u4e2d\u6709\u610f\u4e49\u7684\u56fe\u7247 (\u800c\u4e0d\u662f\u968f\u673a\u6570\u751f\u6210\u5668\u751f\u6210\u7684\u968f\u673a\u6570\u636e)\uff1a</p> </li> <li> <p>\u5411 DCIM \u4e2d\u590d\u5236\u56fe\u7247\u6587\u4ef6 (\u6587\u4ef6\u540d\u4e3a\u5927/\u5c0f\u5199\u5b57\u6bcd\u548c\u6570\u5b57\u3001\u51cf\u53f7\u3001\u4e0b\u5212\u7ebf\uff0c\u4ee5 \u201c.bmp\u201d \u6216 \u201c.BMP\u201d \u7ed3\u5c3e)</p> </li> <li>\u5220\u9664 DCIM \u4e2d\u7684\u56fe\u7247\u6587\u4ef6</li> <li>\u2026\u2026</li> <li> <p>(\u53cd\u590d\u64cd\u4f5c\u4e4b\u540e\uff0c\u6587\u4ef6\u7cfb\u7edf\u4e2d\u53ef\u80fd\u5b58\u5728\u4e00\u4e9b\u788e\u7247\u5316\u7684\u60c5\u51b5)</p> </li> <li> <p>\u5378\u8f7d (unmount) \u6587\u4ef6\u7cfb\u7edf\u955c\u50cf\u540e\uff0c\u6211\u4eec\u4f1a\u91cd\u65b0\u8fdb\u884c\u4e00\u6b21\u6587\u4ef6\u7cfb\u7edf\u7684\u5feb\u901f\u683c\u5f0f\u5316\uff0c\u901a\u8fc7\u4f7f\u7528\u540c\u6837\u7684\u9009\u9879\u518d\u6b21\u8c03\u7528 <code>mkfs.fat</code>\uff1a</p> </li> </ol> <pre><code>$ mkfs.fat -v -F 32 -S 512 -s 8 fs.img\n</code></pre> <p>\u6b64\u65f6\u7684 <code>fs.img</code> \u5c31\u662f\u4f60\u8981\u6062\u590d\u7684\u6587\u4ef6\u7cfb\u7edf\u955c\u50cf\u3002\u6b64\u5916\uff0c\u4f60\u53ef\u4ee5\u5047\u8bbe\u6240\u6709\u7684 BMP \u6587\u4ef6\uff0c\u90fd\u662f\u4f7f\u7528 Python PIL \u5e93\u521b\u5efa\u7684 24-bit \u4f4d\u56fe\uff1a</p> <pre><code>$ file 0M15CwG1yP32UPCp.bmp \n0M15CwG1yP32UPCp.bmp: PC bitmap, Windows 3.x format, 364 x 448 x 24\n</code></pre>"},{"location":"courses/os_lab/M8_filerecovery.html#22","title":"2.2 \u8f93\u51fa\u683c\u5f0f","text":"<p>\u8bd5\u56fe\u6062\u590d\u51fa DCIM \u76ee\u5f55\u4e0b\u5c3d\u53ef\u80fd\u591a\u7684\u56fe\u7247\u6587\u4ef6\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u6062\u590d\u51fa\u7684\u6587\u4ef6\uff0c\u8f93\u51fa\u4e00\u884c\uff0c\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32\u662f\u8be5\u6587\u4ef6\u7684 SHA1 fingerprint (\u901a\u8fc7\u8c03\u7528\u7cfb\u7edf\u7684 <code>sha1sum</code> \u547d\u4ee4\u5f97\u5230)\uff0c\u7136\u540e\u53ef\u4ee5\u8f93\u51fa\u4e00\u4e2a\u6216\u591a\u4e2a\u7a7a\u683c\uff0c\u63a5\u4e0b\u6765\u8f93\u51fa\u56fe\u7247\u7684\u6587\u4ef6\u540d\uff0c\u4f8b\u5982\uff1a</p> <pre><code>d60e7d3d2b47d19418af5b0ba52406b86ec6ef83  0M15CwG1yP32UPCp.bmp\n1ab8c4f2e61903ae2a00d0820ea0111fac04d9d3  1yh0sw8n6.bmp\n1681e23d7b8bb0b36c399c065514bc04badfde79  2Kbg82NaSqPga.bmp\n...\n</code></pre> <p>\u4f60\u7684\u8f93\u51fa\u4e2d\u53ef\u80fd\u5e26\u6709\u4e00\u4e9b\u8c03\u8bd5\u4fe1\u606f\uff0c\u6211\u4eec\u4f1a\u5ffd\u7565\u5b83 (\u4e0d\u8981\u8f93\u51fa\u592a\u591a\u8c03\u8bd5\u4fe1\u606f\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4 output limit exceeded)\uff0c\u4f46\u8bf7\u4fdd\u8bc1\u4f60\u7684 SHA1 fingerprint \u548c\u8f93\u51fa\u7684\u6587\u4ef6\u540d\u72ec\u5360\u4e00\u884c\u3002</p>"},{"location":"courses/os_lab/M8_filerecovery.html#3","title":"3. \u6b63\u786e\u6027\u6807\u51c6","text":"<p>\u8bf7\u4e25\u683c\u6309\u7167 2.2 \u4e2d\u89c4\u5b9a\u7684\u8f93\u51fa\u683c\u5f0f\u8f93\u51fa (40 \u5b57\u8282\u7684 sha1sum, \u4e4b\u540e\u662f\u6587\u4ef6\u540d)\u3002</p>"},{"location":"courses/os_lab/M8_filerecovery.html#31","title":"3.1 \u8bc4\u6d4b\u8bf4\u660e","text":"<p>\u6211\u4eec\u4f1a\u4f7f\u7528\u4e0d\u8d85\u8fc7 128 MiB \u7684\u955c\u50cf\u6587\u4ef6\u6765\u6d4b\u8bd5\u4f60\u7684\u6587\u4ef6\uff0c\u7136\u540e\uff1a</p> <ul> <li>\u6211\u4eec\u6709 10s \u7684 Time Limit (128 MiB \u7684\u955c\u50cf\u6709 30s \u7684 Time Limit)\u3002\u5982\u679c\u4f60\u7684\u7a0b\u5e8f\u901f\u5ea6\u8f83\u6162\uff0c\u4f60\u53ef\u4ee5\u8003\u8651\u5728\u6bcf\u6062\u590d\u51fa\u4e00\u4e2a\u56fe\u7247\u540e\u6253\u5370\uff0c\u5e76 flush stdout (\u8d85\u65f6\u7684\u7a0b\u5e8f\u4f1a\u88ab\u7ec8\u6b62\uff0c\u4f46\u53ea\u8981\u6062\u590d\u7684\u6587\u4ef6\u540d/\u56fe\u7247\u6b63\u786e\u5373\u5224\u5b9a\u4e3a\u6b63\u786e)\uff0c\u5efa\u8bae\u4f7f\u7528\u5185\u5b58\u4e0d\u8981\u8d85\u8fc7 1 GB\uff1b</li> <li>\u8d85\u8fc7 10% \u7684\u6587\u4ef6\u540d\u88ab\u6062\u590d\u6b63\u786e\uff0c\u53ef\u4ee5\u901a\u8fc7\u6240\u6709 easy test cases\uff1b</li> <li>\u8d85\u8fc7 50% \u7684\u6587\u4ef6\u540d\u88ab\u6062\u590d\u6b63\u786e\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a hard test case\uff1b</li> <li>\u8d85\u8fc7 75% \u7684\u6587\u4ef6\u540d\u548c 50% \u7684\u56fe\u7247\u88ab\u6062\u590d\u6b63\u786e\uff0c\u53ef\u4ee5\u901a\u8fc7\u6240\u6709 hard test cases\u3002</li> </ul> <p>\u4e0d\u5fc5\u628a\u56fe\u7247\u6062\u590d\u4efb\u52a1\u60f3\u8c61\u5f97\u592a\u56f0\u96be\u2014\u2014\u5927\u6587\u4ef6\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u662f\u503e\u5411\u4e8e\u8fde\u7eed\u5b58\u50a8\u7684\uff0c\u5c31\u50cf\u5728\u4e0b\u9762\u53c2\u8003\u955c\u50cf\u7684 FAT \u8868\u4e2d\u770b\u5230\u7684\u90a3\u6837\u3002</p> <p>\u6b64\u5916\uff0cOnline Judge \u4f1a\u628a\u4f60\u7684\u8f93\u51fa\u4f5c\u4e3a\u4e00\u4e2a utf-8 \u5b57\u7b26\u4e32\u8fdb\u884c\u8bfb\u53d6\u3002\u56e0\u6b64\uff0c\u5982\u679c\u4f60\u8f93\u51fa\u4e86\u975e\u6cd5\u7684\u5b57\u7b26 (\u4f8b\u5982\u4e0d\u7ecf\u68c0\u67e5\u5730\u8f93\u51fa\u6062\u590d\u7684\u6587\u4ef6\u540d\uff0c\u4f46\u5176\u5b9e\u5e76\u4e0d\u662f\u5408\u6cd5\u7684\u6587\u4ef6\u540d)\uff0c\u5c06\u6709\u53ef\u80fd\u5bfc\u81f4\u89e3\u7801\u5931\u8d25\uff0c\u5f97\u5230 Invalid Output\u3002</p> <p>\u6211\u4eec\u4e3a\u5927\u5bb6\u63d0\u4f9b\u4e86\u4e00\u4e2a\u53c2\u8003\u6587\u4ef6\u7cfb\u7edf\u955c\u50cf\u3002\u5b9e\u9645\u6d4b\u8bd5\u7684\u56fe\u50cf\u6765\u81ea\u540c\u4e00\u4e2a\u6570\u636e\u96c6 (WikiArt)\uff0c\u4f46\u6211\u4eec\u53ef\u80fd\u4f1a\u6311\u9009\u4e0d\u540c\u7684\u56fe\u7247\u3001\u8d4b\u4e88\u6587\u4ef6\u5176\u4ed6\u7684\u968f\u673a\u540d\u79f0\u6216\u6539\u53d8\u56fe\u50cf\u7684\u5927\u5c0f\uff0c\u4f46\u6240\u6709\u968f\u673a\u7684\u53c2\u6570\u90fd\u4e0e\u6211\u4eec\u7ed9\u51fa\u7684\u955c\u50cf\u76f8\u540c (\u4f8b\u5982\u968f\u673a\u7684\u6587\u4ef6\u540d\u957f\u5ea6\u7684\u5206\u5e03\u7b49)\u3002\u955c\u50cf\u8bf7\u70b9\u8fd9\u91cc\u4e0b\u8f7d\u3002</p> <p>\u955c\u50cf\u4e0b\u8f7d\u5b8c\u6bd5\u540e\u53ef\u4ee5\u76f4\u63a5\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u6302\u8f7d (\u4f60\u53ef\u80fd\u9700\u8981 root \u6743\u9650)\uff0c\u8fd9\u4e2a\u955c\u50cf\u6587\u4ef6\u5c31\u6210\u4e3a\u4e86\u6587\u4ef6\u7cfb\u7edf\u7684\u4e00\u90e8\u5206\uff1a</p> <pre><code>$ mount /tmp/M5-frecov.img /mnt/\n$ tree /mnt/\n/mnt\n\u2514\u2500\u2500 DCIM\n    \u251c\u2500\u2500 0M15CwG1yP32UPCp.bmp\n    \u251c\u2500\u2500 1yh0sw8n6.bmp\n    \u251c\u2500\u2500 2Kbg82NaSqPga.bmp\n    ...\n</code></pre> <p>\u4f60\u53ef\u4ee5\u67e5\u770b\u5176\u4e2d\u7684\u56fe\u7247\u6587\u4ef6\uff0c\u4f8b\u5982 <code>3DhTVVP9avTrH.bmp</code> \u662f\u4e0b\u9762\u7684\u56fe\u7247\uff1a</p> <p></p> <p>\u5982\u679c\u4f60\u7528\u4e8c\u8fdb\u5236\u5de5\u5177 (\u4f8b\u5982\u6211\u4eec\u4f7f\u7528\u7684\u662f xxd) \u67e5\u770b\u955c\u50cf\u6587\u4ef6\uff0c\u4f60\u80fd\u53d1\u73b0\u6b63\u786e\u7684 FAT \u8868\uff0c\u4ee5\u94fe\u8868\u7684\u5f62\u5f0f\u4fdd\u5b58\u4e86\u6bcf\u4e2a\u56fe\u50cf\u6587\u4ef6\u7684\u4e0b\u4e00\u4e2a\u6570\u636e\u5757 (\u5728 FAT \u7cfb\u7edf\u4e2d\uff0c\u662f cluster \u7684\u7f16\u53f7)\uff1a</p> <pre><code>00004000: f8ff ff0f ffff ff0f f8ff ff0f 1720 0000  ............. ..\n00004010: 0500 0000 0600 0000 0700 0000 0800 0000  ................\n00004020: 0900 0000 0a00 0000 0b00 0000 0c00 0000  ................\n00004030: 0d00 0000 0e00 0000 0f00 0000 1000 0000  ................\n00004040: 1100 0000 1200 0000 1300 0000 1400 0000  ................\n</code></pre> <p>\u63a5\u4e0b\u6765\uff0c\u4f60\u53ef\u4ee5\u6a21\u62df Online Judge \u5728\u6d4b\u8bd5\u4f60\u7684\u4ee3\u7801\u524d\u6240\u505a\u7684\u64cd\u4f5c\uff1a\u4f7f\u7528 <code>mkfs.fat</code> \u5feb\u901f\u683c\u5f0f\u5316\u8fd9\u4e2a\u78c1\u76d8\u955c\u50cf\uff1a</p> <pre><code>$ mkfs.fat -v -F 32 -S 512 -s 8 M5-frecov.img\nmkfs.fat 4.1 (2017-01-24)\nWARNING: Not enough clusters for a 32 bit FAT!\n/tmp/M5-frecov.img has 64 heads and 32 sectors per track,\nhidden sectors 0x0000;\nlogical sector size is 512,\nusing 0xf8 media descriptor, with 131072 sectors;\ndrive number 0x80;\nfilesystem has 2 32-bit FATs and 8 sectors per cluster.\nFAT size is 128 sectors, and provides 16348 clusters.\nThere are 32 reserved sectors.\nVolume ID is a332d0ad, no volume label.\n</code></pre> <p>\u5982\u679c\u4f60\u63a5\u4e0b\u6765\u518d\u6b21\u6302\u8f7d\u8fd9\u4e2a\u955c\u50cf\uff0c\u5c06\u4f1a\u770b\u5230\u5b8c\u5168\u7a7a\u767d\u7684\u76ee\u5f55\uff0c\u4eff\u4f5b\u78c1\u76d8\u955c\u50cf\u4e0a\u7684\u6240\u6709\u6587\u4ef6\u90fd\u88ab\u5220\u9664\u4e86\uff1a</p> <pre><code>$ tree /mnt/\n/mnt/\n\n0 directories, 0 files\n</code></pre> <p>\u5982\u679c\u518d\u6b21\u67e5\u770b <code>M5-frecov.img</code> \u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4f60\u4f1a\u53d1\u73b0\u5206\u533a\u8868\u5df2\u7ecf\u88ab \u201c\u62b9\u9664\u201d \u4e86\uff1a</p> <pre><code>00004000: f8ff ff0f ffff ff0f f8ff ff0f 0000 0000  ................\n00004010: 0000 0000 0000 0000 0000 0000 0000 0000  ................\n00004020: 0000 0000 0000 0000 0000 0000 0000 0000  ................\n00004030: 0000 0000 0000 0000 0000 0000 0000 0000  ................\n00004040: 0000 0000 0000 0000 0000 0000 0000 0000  ................\n</code></pre> <p>\u867d\u7136\u64cd\u4f5c\u7cfb\u7edf\u5df2\u7ecf\u770b\u4e0d\u5230\u78c1\u76d8\u4e0a\u7684\u6587\u4ef6\u4e86\uff0c\u4f46\u5982\u679c\u4f60\u4ed4\u7ec6\u5730\u641c\u7d22 (\u4f7f\u7528 \u201c\u67e5\u627e\u201d \u5de5\u5177) \u4e00\u4e0b\uff0c\u8fd8\u662f\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e9b\u86db\u4e1d\u9a6c\u8ff9\uff1a</p> <pre><code>00025ae0: 4250 0043 0070 002e 0062 000f 0089 6d00  BP.C.p...b....m.\n00025af0: 7000 0000 ffff ffff ffff 0000 ffff ffff  p...............\n00025b00: 0130 004d 0031 0035 0043 000f 0089 7700  .0.M.1.5.C....w.\n00025b10: 4700 3100 7900 5000 3300 0000 3200 5500  G.1.y.P.3...2.U.\n00025b20: 304d 3135 4357 7e31 424d 5020 0064 2b5a  0M15CW~1BMP .d+Z\n00025b30: ac50 ac50 0000 2b5a ac50 6915 3677 0700  .P.P..+Z.Pi.6w..\n</code></pre> <p>\u8fd9\u597d\u50cf\u4ee5\u67d0\u79cd\u683c\u5f0f (FAT32 \u7684 directory entry) \u5b58\u50a8\u4e86 \u201c<code>0M15CwG1yP32UPCp.bmp</code>\u201d \u76f8\u5173\u7684\u4fe1\u606f\u3002\u6b64\u5916\uff0cbitmap \u56fe\u7247\u6587\u4ef6\u7684\u6587\u4ef6\u5934\u4e5f\u88ab\u5b8c\u6574\u5730\u5728\u6570\u636e\u533a\u91cc\u4fdd\u7559\u4e0b\u6765\uff1a</p> <pre><code>000fb000: 424d 2ecf 0f00 0000 0000 3600 0000 2800  BM........6...(.\n000fb010: 0000 0202 0000 9f02 0000 0100 1800 0000  ................\n000fb020: 0000 f8ce 0f00 c40e 0000 c40e 0000 0000  ................\n000fb030: 0000 0000 0000 7d74 9986 7ba3 6c61 8888  ......}t..{.la..\n000fb040: 7ea4 8076 9d84 7ca2 766d 9469 6187 6a64  ~..v..|.vm.ia.jd\n</code></pre> <p>\u4f60\u7684 <code>frecov</code> \u4f1a\u88ab\u8c03\u7528\uff0c\u8fd0\u884c\u5728\u8fd9\u4e2a\u683c\u5f0f\u5316\u540e\u7684\u955c\u50cf\u4e0a\uff0c\u7136\u540e\u9884\u671f\u4f1a\u5f97\u5230\u4e00\u5b9a\u7684\u8f93\u51fa\uff1a</p> <pre><code>d60e7d3d2b47d19418af5b0ba52406b86ec6ef83  0M15CwG1yP32UPCp.bmp\n...\n</code></pre> <p>\u5982\u679c\u4f60\u6302\u8f7d\u6ca1\u6709\u88ab\u683c\u5f0f\u5316\u8fc7\u7684 <code>M5-frecov.img</code>\uff0c\u4f60\u53ef\u4ee5\u67e5\u770b\u6240\u6709\u56fe\u7247\u7684 sha1sum\uff0c\u4ece\u800c\u68c0\u67e5\u4f60\u6b63\u786e\u6062\u590d\u4e86\u54ea\u4e9b\u56fe\u7247\u3002</p> <pre><code>$ cd /mnt/DCIM &amp;&amp; sha1sum *.bmp\nd60e7d3d2b47d19418af5b0ba52406b86ec6ef83  0M15CwG1yP32UPCp.bmp\n1ab8c4f2e61903ae2a00d0820ea0111fac04d9d3  1yh0sw8n6.bmp\n1681e23d7b8bb0b36c399c065514bc04badfde79  2Kbg82NaSqPga.bmp\naabd1ef8a2371dd64fb64fc7f10a0a31047d1023  2pxHTrpI.bmp\n...\n</code></pre>"},{"location":"courses/os_lab/M8_filerecovery.html#4","title":"4. \u5b9e\u9a8c\u6307\u5357","text":""},{"location":"courses/os_lab/M8_filerecovery.html#41-fat32","title":"4.1 FAT32 \u6587\u4ef6\u7cfb\u7edf","text":"<p>\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4efd Microsoft FAT Specification \u7684 local copy\u3002\u4f60\u53ef\u4ee5\u8bd5\u4e00\u8bd5\uff1a\u4e0d\u501f\u52a9\u4efb\u4f55\u5176\u4ed6\u6709\u5173 FAT \u7684 blog post, tutorial \u548c\u4ee3\u7801\uff0c\u4f60\u4f1a\u6e10\u6e10\u89c9\u5f97 RTFM \u4e0d\u90a3\u4e48\u56f0\u96be\u4e86\u3002\u5982\u679c\u4f60\u4f9d\u7136\u611f\u5230\u56f0\u96be\uff0c\u53ef\u4ee5\u56de\u770b\u89c6\u9891\u5e76\u53c2\u8003\u8bfe\u5802\u4e0a\u7684\u5b9e\u4f8b\u4ee3\u7801 fatree.c\uff0c\u4f46\u6211\u4eec\u5f3a\u70c8\u5efa\u8bae\u5927\u5bb6\u4e0d\u8981\u590d\u5236\u5176\u4e2d\u7684\u4ee3\u7801\u800c\u662f\u81ea\u5df1\u7f16\u5199\uff0c\u4ee5\u5f97\u5230\u6700\u597d\u7684\u8bad\u7ec3\u3002</p> <p>FAT \u6587\u4ef6\u7cfb\u7edf\u662f\u7531\u4e00\u4e9b\u5934\u90e8\u4fe1\u606f (\u5143\u6570\u636e)\u3001FAT (\u6587\u4ef6\u5206\u914d\u8868) \u548c\u6570\u636e (cluster, \u5fae\u8f6f\u7684\u5b98\u65b9\u7ffb\u8bd1\u662f \u201c\u7c07\u201d) \u7ec4\u6210\u7684\u3002\u5982\u679c\u4f60\u505a\u4e00\u4e9b\u5206\u6790\uff0c\u4f60\u4f1a\u77e5\u9053\uff1a</p> <ol> <li>FAT \u6587\u4ef6\u7684\u5934\u90e8\u662f\u53ef\u7528\u7684\u2014\u2014\u6211\u4eec\u7528\u540c\u6837\u7684\u65b9\u5f0f\u8fdb\u884c\u4e24\u6b21\u683c\u5f0f\u5316\uff1b</li> <li>FAT \u8868\u5c06\u88ab\u6e05\u7a7a\uff0c\u6b64\u90e8\u5206\u7684\u6570\u636e\u76f8\u5f53\u4e8e\u5168\u90e8\u4e22\u5931\uff1b</li> <li>\u6570\u636e\u533a\u51e0\u4e4e\u6ca1\u6709\u53d8\u5316\u2014\u2014\u6211\u4eec\u6267\u884c\u7684\u662f \u201c\u5feb\u901f\u201d \u683c\u5f0f\u5316\u3002</li> </ol> <p>\u63a5\u4e0b\u6765\uff0c\u4f60\u5c31\u53ef\u4ee5\u5f00\u59cb\u7167\u6284\u624b\u518c\uff0c\u8fdb\u884c FAT \u6587\u4ef6\u7cfb\u7edf\u7684\u89e3\u6790\u4e86\uff0c\u4f8b\u5982\u624b\u518c\u5df2\u7ecf\u8be6\u7ec6\u5730\u89c4\u5b9a\u597d\u4e86 FAT32 \u6587\u4ef6\u7cfb\u7edf\u524d 512 \u4e2a\u5b57\u8282\u7684\u683c\u5f0f\uff0c\u4f60\u4e0d\u59a8\u628a\u5b83\u89e3\u91ca\u6210\u4e00\u4e2a\u7ed3\u6784\u4f53\uff1a</p> <pre><code>struct fat32hdr {\n  u8  BS_jmpBoot[3];\n  u8  BS_OEMName[8];\n  u16 BPB_BytsPerSec;\n  u8  BPB_SecPerClus;\n  ...\n  u8  __padding_1[420];\n  u16 Signature_word;\n} __attribute__((packed));\n</code></pre> <p>\u201c\u6284\u624b\u518c\u201d \u5f88\u5bb9\u6613\u6284\u9519\uff1f\u4e0d\u8981\u5fd8\u8bb0 <code>_static_assert(sizeof(struct fat32hdr) == 512)</code>\u3002\u7136\u540e\u4f60\u4f1a\u795e\u5947\u5730\u53d1\u73b0\uff0c\u5982\u679c\u4f60\u4f7f\u7528 mmap \u7cfb\u7edf\u8c03\u7528\u5c06\u78c1\u76d8\u6620\u5c04\u5230\u5730\u5740\u7a7a\u95f4\u4e2d\uff0c\u4f8b\u5982\u8fd4\u56de <code>disk</code>\uff0c\u90a3\u4e48\u4f60\u5c31\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u78c1\u76d8\u955c\u50cf\u5934\u90e8\u7684\u5143\u6570\u636e\u4e86\uff1a</p> <pre><code>panic_on(sizeof(struct fat_header) != 512, \"bad header\");\npanic_on(disk-&gt;signature != 0xaa55, \"not a valid fat\");\ncluster_sz = disk-&gt;BPB_BytsPerSec * disk-&gt;BPB_SecPerClus;\n</code></pre> <p>\u8fd9\u4e2a\u65f6\u5019\uff0c\u4f60\u5c31\u53ef\u4ee5\u771f\u6b63\u5728\u5185\u5b58\u91cc\u4efb\u610f \u201c\u628a\u73a9\u201d \u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u4e86\u3002\u505a\u4e00\u4e9b\u5b9e\u9a8c\uff0c\u770b\u770b\u80fd\u4e0d\u80fd\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u627e\u5230\u4e00\u4e9b\u6709\u7528\u7684\u6570\u636e\u3002\u8bb0\u5f97\u6211\u4eec\u5728\u8bfe\u5802\u4e0a\u89e3\u91ca\u8fc7\uff0c\u6587\u4ef6\u7cfb\u7edf\u662f\u57fa\u4e8e block I/O \u5c01\u88c5\u7684\u6570\u636e\u7ed3\u6784\u3002\u5f53\u6211\u4eec\u5b8c\u6210 mmap \u4ee5\u540e\uff0c\u5b83\u5c31\u771f\u7684\u662f\u4e00\u4e2a\u5185\u5b58\u91cc\u7684\u6570\u636e\u7ed3\u6784\u4e86\uff0c\u9664\u4e86\u6709\u4e9b \u201c\u6307\u9488\u201d \u9700\u8981\u7ecf\u8fc7\u989d\u5916\u7684\u8ba1\u7b97\u624d\u80fd\u5f97\u5230\u5b83\u6307\u5411\u7684\u5730\u5740\u3002</p>"},{"location":"courses/os_lab/M8_filerecovery.html#42-bmp","title":"4.2 BMP \u6587\u4ef6\u683c\u5f0f","text":"<p>\u4e3a\u4e86\u5b8c\u6210\u5b9e\u9a8c\uff0c\u4f60\u8fd8\u9700\u8981\u4e86\u89e3 BMP \u6587\u4ef6\u7684\u683c\u5f0f\u3002\u4e3a\u4e86\u953b\u70bc\u5927\u5bb6\u72ec\u7acb\u601d\u8003\u3001\u67e5\u627e\u8d44\u6599\u7684\u80fd\u529b\uff0c\u5173\u4e8e BMP \u6587\u4ef6\u7684\u7ec6\u8282\u8bf7 STFW\u3002\u597d\u6d88\u606f\u662f\u8fd9\u90e8\u5206\u4f60\u4eec\u9700\u8981\u67e5\u9605\u7684\u8d44\u6599\u5f88\u7b80\u5355\uff0c\u7531\u4e8e\u6211\u4eec\u7684 BMP \u90fd\u662f\u4ee5\u540c\u6837\u7684\u65b9\u5f0f\u521b\u5efa\u7684\uff0c\u4f60\u53ef\u4ee5\u5ffd\u7565\u5176\u4e2d\u5927\u90e8\u5206\u7684 fields\uff0c\u53ea\u9700\u5173\u6ce8\uff1a</p> <ol> <li>bitmap \u5b58\u50a8\u533a\u57df\u5f00\u59cb\u7684 offset\uff1b</li> <li>\u56fe\u7247\u7684\u5bbd\u5ea6\u548c\u9ad8\u5ea6\u3002</li> </ol>"},{"location":"courses/os_lab/M8_filerecovery.html#43-clusters","title":"4.3 \u626b\u63cf Clusters","text":"<p>\u5728\u4f60\u5bf9 FAT32 \u6587\u4ef6\u7cfb\u7edf\u6709\u4e86\u8db3\u591f\u7684\u8ba4\u8bc6\u4ee5\u540e\uff0c\u4f60\u4f1a\u53d1\u73b0\u5728\u6211\u4eec\u7684\u95ee\u9898\u4e2d\uff0c\u6570\u636e\u533a\u7684 clusters \u5206\u6210\u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\uff1a</p> <ol> <li>\u76ee\u5f55\u6587\u4ef6\uff0c\u5b58\u50a8\u82e5\u5e72\u76ee\u5f55\u9879 (directory entry)\uff0c\u5bf9\u5e94\u624b\u518c Sections 6 \u548c 7 \u63cf\u8ff0\u7684\u5185\u5bb9\u3002\u6ce8\u610f Section 7 \u662f\u975e\u5e38\u91cd\u8981\u7684\uff0c\u56e0\u4e3a\u4f60\u5fc5\u987b\u6062\u590d\u51fa\u5b8c\u6574\u7684\u6587\u4ef6\u540d\uff1b</li> <li>BMP \u6587\u4ef6\u7684\u5934\u90e8\uff0c\u4ee5 \u201c<code>424d</code> (<code>BM</code>)\u201d \u5f00\u5934\uff1b</li> <li>BMP \u6587\u4ef6\u7684\u5b9e\u9645\u6570\u636e\uff0c\u6309\u7167 3 \u5b57\u8282\u4e00\u7ec4\u6309\u987a\u5e8f\u5b58\u50a8\u4e86\u56fe\u7247\u4e2d\u7684\u6240\u6709\u50cf\u7d20\uff1b</li> <li>\u672a\u4f7f\u7528\u7684 cluster\u3002</li> </ol> <p>\u5728 FAT \u8868\u88ab\u6e05\u9664\u540e\uff0c\u6211\u4eec\u5df2\u7ecf\u65e0\u6cd5\u6839\u636e FAT \u6062\u590d\u51fa\u76ee\u5f55\u7684\u6811\u72b6\u7ed3\u6784\u4e86\u3002\u56e0\u6b64\u63a5\u4e0b\u6765\u6211\u4eec\u8981\u505a\u7684\u662f\u4e00\u4e2a\u5206\u7c7b\u95ee\u9898\uff1a\u6211\u4eec\u9700\u8981\u4f9d\u6b21\u626b\u63cf\u78c1\u76d8\u4e2d\u7684\u6240\u6709 clusters\uff0c\u5e76\u5c06\u5b83\u4eec\u6807\u8bb0\u4e3a\u4ee5\u4e0a 4 \u7c7b\u3002\u4f60\u4e0d\u9700\u8981\u4f7f\u7528\u4efb\u4f55\u673a\u5668\u5b66\u4e60\u2014\u2014\u4f60\u53ef\u4ee5\u624b\u5de5\u786c\u7f16\u7801\u4e00\u4e9b\u7279\u5f81\uff0c\u5c31\u8db3\u591f\u5b8c\u6210\u8bc6\u522b\u4e86\uff0c\u4f8b\u5982\u76ee\u5f55\u6587\u4ef6\u91cc\u603b\u662f\u5305\u542b\u5927\u91cf\u7684 \u201cBMP\u201d \u5b57\u7b26\uff0c\u8fd9\u662f\u6570\u636e\u548c bitmap \u6587\u4ef6\u5934\u6240\u6ca1\u6709\u7684\u3002\u4f60\u4e0d\u9700\u8981\u505a\u5f97 100% \u51c6\u786e\uff0c\u56e0\u4e3a\u4f60\u53ea\u8981\u6062\u590d\u76f8\u5f53\u4e00\u90e8\u5206\u6587\u4ef6\u5373\u53ef\uff1b\u4f46\u4f60\u8981\u5c0f\u5fc3\u5730\u7f16\u5199\u5065\u58ee\u7684\u4ee3\u7801\uff0c\u4f7f\u5f97\u5206\u7c7b\u9519\u8bef\u53d1\u751f\u65f6\u7a0b\u5e8f\u4e0d\u4f1a\u53d1\u751f\u592a\u5927\u7684\u95ee\u9898\u2014\u2014\u4f60\u7684\u7a0b\u5e8f\u53ef\u80fd\u5728\u5206\u7c7b\u9519\u8bef\u65f6 (\u4f8b\u5982\u5c06\u4f4d\u56fe\u6570\u636e\u89e3\u6790\u4e3a\u76ee\u5f55\u65f6) \u56e0\u4e3a\u975e\u6cd5\u7684\u8f93\u5165\u800c crash\u3002</p>"},{"location":"courses/os_lab/M8_filerecovery.html#44","title":"4.4 \u56fe\u7247\u6570\u636e\u6062\u590d","text":"<p>\u63a5\u4e0b\u6765\uff0c\u4f60\u9700\u8981\u7684\u662f\u6062\u590d\u76ee\u5f55\u6587\u4ef6\u4e2d\u7684\u76ee\u5f55\u9879\uff0c\u4ece\u800c\u5f97\u5230\u6587\u4ef6\u540d\u3002\u624b\u518c\u4e0a\u5bf9\u76ee\u5f55\u6587\u4ef6\u4e2d\u7684\u76ee\u5f55\u9879\u7ed9\u51fa\u4e86\u7cbe\u786e\u7684\u5b9a\u4e49\u3002\u5f53\u4f60\u9700\u8981\u5199\u4ee3\u7801\u89e3\u6790\u6587\u4ef6\u65f6\uff0c\u624b\u518c\u5c31\u6bd4 blog posts \u9760\u8c31\u5f97\u591a\u4e86\u3002\u5728\u8fd9\u91cc\uff0c\u4f60\u8981\u5c0f\u5fc3\u76ee\u5f55\u9879\u53ef\u80fd\u8de8\u8fc7 cluster \u7684\u60c5\u51b5\u2014\u2014\u5f53\u7136\u7b80\u5355\u8d77\u89c1\uff0c\u4f60\u53ef\u4ee5\u653e\u5f03\u8fd9\u4e2a\u6587\u4ef6\u7684\u6062\u590d\uff0c\u53ea\u8981\u4f60\u7684\u7a0b\u5e8f\u4e0d\u4f1a\u56e0\u6b64 crash \u5c31\u884c\u3002</p> <p></p> <p>\u5f53\u4f60\u6062\u590d\u51fa\u4e00\u4e2a\u76ee\u5f55\u9879\u4ee5\u540e\uff0c\u4f60\u4e0d\u4ec5\u5f97\u5230\u4e86\u6b63\u786e\u7684\u6587\u4ef6\u540d\uff0c\u800c\u4e14\u5f97\u5230\u4e86\u4e00\u4e2a\u975e\u5e38\u6709\u7528\u7684\u4fe1\u606f\uff1a\u8fd9\u4e2a\u6587\u4ef6\u540d\u5bf9\u5e94\u7684 cluster ID\uff0c\u4f60\u6839\u636e\u8fd9\u4e2a\u5757\u7684\u7f16\u53f7\u5c31\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u4fdd\u8bc1\u662f BMP header \u7684 cluster\u2014\u2014\u4f60\u53ef\u4ee5\u548c\u4f60\u5728\u626b\u63cf clusters \u65f6\u7684\u5206\u7c7b\u7ed3\u679c\u8fdb\u884c\u5339\u914d\uff0c\u5982\u679c\u8fd9\u4e2a cluster \u4e0d\u662f\u4e00\u4e2a bitmap header\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u653e\u5f03\u8fd9\u4e2a\u6587\u4ef6\u7684\u6062\u590d\u3002</p> <p>\u63a5\u4e0b\u6765\u5269\u4e0b\u7684\u5de5\u4f5c\u5c31\u662f\u6062\u590d\u56fe\u7247\u7684\u5269\u4e0b\u90e8\u5206\u4e86\uff01\u6700\u7b80\u5355\u5730\uff0c\u4f60\u53ef\u4ee5\u5047\u8bbe\u56fe\u7247\u5269\u4e0b\u7684\u90e8\u5206 (clusters) \u90fd\u8fde\u7eed\u5730\u5b58\u50a8\u5728\u6587\u4ef6\u4e2d\u3002\u56e0\u6b64\u4f60\u53ea\u8981\u6b63\u786e\u77e5\u9053\u6587\u4ef6\u7684\u5927\u5c0f (\u8fd9\u4e2a\u4fe1\u606f\u5728\u76ee\u5f55\u9879\u4e2d\u4e5f\u6709)\uff0c\u4f60\u5c31\u53ef\u4ee5\u76f4\u63a5\u6062\u590d\u51fa\u4e00\u5f20\u56fe\u7247\u4e86\u3002</p> <p>\u5982\u679c\u60f3\u8981\u66f4\u8fdb\u4e00\u6b65\uff0c\u5c31\u9700\u8981\u505a\u51fa\u4e00\u4e9b\u6570\u5b66\u4e0a\u7684\u5206\u6790\u3002\u6211\u4eec\u4e22\u5931\u7684\u662f FAT \u8868\uff0c\u4e5f\u5c31\u662f\u6240\u6709\u7684 \u201c\u94fe\u63a5\u201d \u5173\u7cfb\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u6587\u4ef6\u6062\u590d\u5efa\u6a21\u6210\u4e00\u4e2a\u56fe\u95ee\u9898\uff1a</p> <ul> <li>\u5efa\u7acb\u6709\u5411\u56fe G*\uff0c\u5176\u4e2d\u6bcf\u4e00\u4e2a cluster \u662f\u4e00\u4e2a\u9876\u70b9\u3002</li> <li>\u5bf9\u4e8e\u4e24\u4e2a\u9876\u70b9 u, v\uff0c\u5efa\u7acb\u4e00\u6761\u8fb9 u\u2192v\uff0c\u6743\u503c\u662f u\u3001v \u4f5c\u4e3a\u540c\u4e00\u4e2a\u6587\u4ef6\u8fde\u7eed\u4e24\u5757\u7684\u6982\u7387\u3002</li> <li>\u56fe\u4e2d\u6bcf\u4e00\u6761 \u201c\u6982\u7387\u8db3\u591f\u5927\u201d \u7684\u8def\u5f84\u5c31\u5bf9\u5e94\u4e86\u4e00\u4e2a\u6587\u4ef6\u3002</li> </ul> <p>\u5728\u8fd9\u4e2a\u6a21\u578b\u4e0b\uff0c\u4f60\u53ef\u4ee5\u63d0\u51fa\u5f88\u591a\u6709\u8da3\u7684\u7b97\u6cd5\u6765\u5c1d\u8bd5\u6062\u590d\u6587\u4ef6\u2014\u2014\u6ce8\u610f\u4f60\u53ef\u4ee5\u5bf9\u540c\u4e00\u4e2a\u6587\u4ef6\u6062\u590d\u51fa\u591a\u79cd\u53ef\u80fd\u6027\u3002\u540c\u65f6\uff0c\u4f60\u4e5f\u53ef\u4ee5\u91c7\u53d6\u4e00\u4e9b\u542f\u53d1\u5f0f\u7684\u4f18\u5316\uff0c\u4f8b\u5982\u5047\u8bbe\u6587\u4ef6\u7684\u5927\u90e8\u5206\u90fd\u662f\u8fde\u7eed\u5b58\u50a8\u7684\u3002\u5728\u6784\u5efa\u56fe\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u9488\u5bf9 bitmap \u8fde\u7eed\u5b58\u50a8\u50cf\u7d20\u7684\u7279\u6027\u53bb\u5224\u65ad\u4e24\u4e2a cluster \u662f\u5426\u5904\u4e8e\u540c\u4e00\u5f20\u56fe\u7247\uff1a\u73b0\u5b9e\u4e16\u754c\u4e2d\u7684\u56fe\u7247\u5927\u591a\u662f \u201c\u8fde\u7eed\u201d \u53d8\u5316\u7684\uff0c\u5373\u7edd\u5927\u90e8\u5206\u76f8\u90bb\u7684\u50cf\u7d20\uff0c\u50cf\u7d20\u503c\u90fd\u4e0d\u4f1a\u53d1\u751f\u5267\u70c8\u7684\u53d8\u5316\u3002\u8fd9\u6837\u7684\u60f3\u6cd5\u5176\u5b9e\u5bf9\u5e94\u4e86\u5bf9\u56fe\u50cf\u5728\u4e8c\u7ef4\u7a7a\u95f4\u4e0a\u8fdb\u884c\u6c42\u5bfc (\u201cgradient\u201d)\uff0c\u800c\u5927\u90e8\u5206\u50cf\u7d20\u7684\u5bfc\u6570\u90fd\u662f\u5f88\u5c0f\u7684\uff1a</p> <p></p> <p>\u8fd9\u6784\u6210\u4e86 SIFT \u7b97\u6cd5\u7684\u6838\u5fc3\uff0c\u5e76\u4e14\u5728\u8ba1\u7b97\u673a\u89c6\u89c9\u9886\u57df\u7edf\u9886\u4e86\u6570\u5341\u5e74\uff0c\u76f4\u5230\u6df1\u5ea6\u5b66\u4e60\u6280\u672f\u7684\u51fa\u73b0\u2014\u2014\u5377\u79ef\u80fd\u591f\u81ea\u52a8\u5730\u5b66\u4e60\u51fa\u56fe\u7247\u68af\u5ea6\u7684\u4fe1\u606f\uff0c\u5e76\u5728\u6b64\u57fa\u7840\u4e0a\u63d0\u53d6\u51fa\u66f4\u4e3a\u6709\u7528\u7684\u9ad8\u5c42\u7279\u5f81\u3002</p>"},{"location":"courses/os_lab/M8_filerecovery.html#45","title":"4.5 \u8ba1\u7b97\u6821\u9a8c\u548c","text":"<p>\u7ec8\u4e8e\uff0c\u4f60\u5f97\u5230\u4e86\u6587\u4ef6\u540d\u3001\u6587\u4ef6\u7684\u5927\u5c0f\u548c\u6587\u4ef6\u7684\u6240\u6709\u6570\u636e\u2014\u2014\u662f\u65f6\u5019\u628a\u5b83\u7684\u6821\u9a8c\u548c\u8f93\u51fa\u4e86\u3002\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\uff0c\u4f60\u9700\u8981\u8c03\u7528\u5916\u90e8\u5de5\u5177 sha1sum \u8ba1\u7b97\u6821\u9a8c\u548c\u3002sha1sum \u7684\u547d\u4ee4\u884c\u5de5\u5177\u53ef\u4ee5\u4ece stdin (\u6216\u8005\u6587\u4ef6) \u8bfb\u53d6\u6570\u636e\uff0c\u7136\u540e\u628a hash digest \u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\uff1a</p> <pre><code>$ echo \"Hello, World\" | sha1sum\n4ab299c8ad6ed14f31923dd94f8b5f5cb89dfb54  -\n</code></pre> <p>sha1sum \u662f\u4e00\u79cd\u8ba1\u7b97\u5b57\u8282\u5e8f\u5217 \u201c\u6307\u7eb9\u201d \u7684\u7b97\u6cd5\u3002\u6307\u7eb9 (fingerprint) \u4e5f\u79f0\u4e3a\u6821\u9a8c\u548c (checksum)\uff0c\u5b83\u662f\u4e00\u4e2a\u5355\u5411\u7684 hash function H\uff0c\u80fd\u628a\u4e00\u4e2a\u5f88\u5927\u7a7a\u95f4\u91cc\u7684\u5b57\u7b26\u4e32\u6620\u5c04\u5230\u5f88\u5c0f\u7684\u7a7a\u95f4\u4e2d (\u8ba1\u7b97 H(x))\uff0c\u5e76\u4e14\u76ee\u524d\u800c\u8a00\uff0c\u7ed9\u5b9a\u4e00\u4e2a fingerprint \u540e\u7684\u5b57\u7b26\u4e32 t\uff0c\u4eba\u7c7b\u5f88\u96be\u8ba1\u7b97\u51fa\u4e00\u4e2a\u5b57\u7b26\u4e32 x \u6ee1\u8db3 H(x)=t\u3002\u6307\u7eb9\u80fd\u5728\u4e0d\u4f20\u8f93\u6574\u4e2a\u6587\u4ef6\u7684\u524d\u63d0\u4e0b\uff0c\u5feb\u901f\u6bd4\u8f83\u4e24\u4e2a\u6587\u4ef6\u662f\u5426\u76f8\u7b49\u3002\u9664\u4e86\u6821\u9a8c\u6587\u4ef6\u7684\u5b8c\u6574\u6027\u4e4b\u5916\uff0c\u6307\u7eb9\u8fd8\u53ef\u4ee5\u7528\u6765\u505a\u6570\u636e\u7684\u53bb\u91cd\u2014\u2014\u4f8b\u5982\u5927\u5bb6\u5728\u5373\u65f6\u901a\u4fe1\u8f6f\u4ef6\u4e2d\u4f20\u9001\u6587\u4ef6 (\u4f8b\u5982 QQ) \u65f6\uff0c\u670d\u52a1\u5668\u4f1a\u7528\u6821\u9a8c\u548c\u68c0\u67e5\u662f\u5426\u5df2\u7ecf\u5b58\u5728\u6587\u4ef6\u7684\u526f\u672c\uff0c\u5982\u679c\u662f\u5c31\u53ef\u4ee5\u7acb\u5373\u7ed3\u675f\u4f20\u8f93 (\u6240\u4ee5\u4f60\u4eec\u5728\u4e0a\u4f20\u4e00\u4e9b\u522b\u4eba\u53ef\u80fd\u5df2\u7ecf\u4e0a\u4f20\u8fc7\u6587\u4ef6\u65f6\u4f1a\u51fa\u73b0\u5927\u6587\u4ef6 \u201c\u79d2\u4f20\u201d \u7684\u60c5\u51b5)\u3002</p> <p>\u5982\u679c\u4f60\u4e0d\u5e0c\u671b\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u91cc\u91cd\u590d pipe-fork-execve \u7684\u6d41\u7a0b\uff0cpopen \u53ef\u4ee5\u5f88\u597d\u5730\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a\u6211\u4eec\u53ef\u4ee5\u628a\u6062\u590d\u51fa\u7684\u56fe\u50cf\u5199\u5165\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4efb\u4f55\u4f4d\u7f6e (\u5f53\u7136\u662f\u67d0\u4e2a\u4e34\u65f6\u76ee\u5f55)\uff0c\u7136\u540e\u7528 popen \u8bfb\u53d6 sha1sum \u7684\u8f93\u51fa\u5230\u7f13\u51b2\u533a\u4e2d\uff0c\u7136\u540e\u518d\u5c06\u5b83\u8f93\u51fa\uff1a</p> <pre><code>fp = popen(\"sha1sum /tmp/your-tmp-filename\", \"r\");\npanic_on(fp &lt; 0, \"popen\");\nfscanf(fp, \"%s\", buf); // Get it!\npclose(fp);\n</code></pre>"},{"location":"courses/os_lab/M8_filerecovery.html#46","title":"4.6 \u8c03\u8bd5\u4f60\u7684\u7a0b\u5e8f","text":"<p>\u8fd9\u6b21\u7684\u7a0b\u5e8f\u7a0d\u5fae\u6709\u4e9b\u957f\u3002\u4f60\u53ef\u80fd\u9700\u8981\u4e00\u4e9b logging \u624d\u80fd\u6bd4\u8f83\u597d\u5730\u5e2e\u52a9\u4f60\u5b8c\u6210\u4efb\u52a1\u3002\u8bb0\u5f55\u65e5\u5fd7\u65f6\u8981\u5c0f\u5fc3\u5e72\u6270 Online Judge\u3002\u6ce8\u610f\u4f60\u4f9d\u7136\u53ea\u80fd\u7f16\u5199\u4e00\u4e2a <code>.c</code> \u6587\u4ef6\uff0c\u56e0\u6b64\u6ce8\u610f\u4f60\u7684\u4ee3\u7801\u98ce\u683c\uff0c\u9002\u5f53\u5730\u4f7f\u7528 IDE \u548c\u4ee3\u7801\u6298\u53e0\u80fd\u6700\u5927\u7a0b\u5ea6\u5730\u63d0\u9ad8\u4f60\u7684\u7f16\u7801\u6548\u7387\u3002</p> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\u4e00\u4e2a\u5e38\u89c1\u7684\u95ee\u9898\u662f\u4f60\u5f88\u591a\u65f6\u5019\u4e0d\u77e5\u9053\u4f60\u7684\u7a0b\u5e8f \u201c\u4e3a\u4ec0\u4e48\u201d \u6ca1\u6709\u6062\u590d\u51fa\u6b63\u786e\u7684\u56fe\u7247\u2014\u2014\u867d\u7136\u4f60\u77e5\u9053\u6bcf\u4e00\u4e2a\u56fe\u7247\u7684 sha1sum\uff0c\u4f46\u8fd9\u4e9b\u6570\u503c\u770b\u8d77\u6765\u5c31\u50cf\u662f\u968f\u673a\u7684\u6570\u5b57\uff0c\u53ea\u8981\u4f60\u6709\u4e00\u4e2a\u5b57\u8282\u7684\u5dee\u5f02\uff0c\u5b83\u4eec\u5c31\u4f1a\u770b\u8d77\u6765\u5b8c\u5168\u4e0d\u540c\u3002</p> <p>\u4e00\u4e2a\u8c03\u8bd5\u7684\u597d\u529e\u6cd5\u662f \u201cvisualization\u201d: \u5728\u8c03\u8bd5\u65f6\u5c06\u6062\u590d\u51fa\u7684\u56fe\u7247\u8f93\u51fa\u5230\u67d0\u4e2a\u76ee\u5f55\u4e2d (\u5c0f\u5fc3\u4e0d\u8981\u628a\u56fe\u7247\u6587\u4ef6\u653e\u5230 Git repo \u4e2d)\uff0c\u7136\u540e\u76f4\u63a5 \u201c\u8089\u773c\u201d \u89c2\u5bdf\u6062\u590d\u7684\u7ed3\u679c\uff0c\u4f60\u4f1a\u53d1\u73b0\u6709\u4e9b\u56fe\u7247\u5f97\u5230\u4e86\u6b63\u786e\u7684\u6062\u590d\uff0c\u6709\u4e9b\u5219\u6ca1\u6709\u3002\u4f60\u80fd\u89e3\u91ca\u4e3a\u4ec0\u4e48\u4f1a\u770b\u5230\u4e0b\u9762\u90a3\u6837\u9519\u8bef\u7684\u56fe\u5f62\u5417\uff1f</p> <p></p>"},{"location":"cs/cs_basic.html","title":"\u8ba1\u7b97\u673a\u57fa\u7840","text":"<p>\u4e8c\u8fdb\u5236\u7f16\u7801\uff0c\u4ee5 8 \u4f4d\u6570\u4e3a\u4f8b</p> <ul> <li>\u539f\u7801\uff1a\u7b26\u53f7\u4f4d\u52a0\u4e0a\u771f\u503c\u7684\u7edd\u5bf9\u503c</li> <li>+1 ( 0000 0001)\uff0c -1 ( 1000 0001)</li> <li>\u53cd\u7801\uff1a \u6b63\u6570\u7684\u53cd\u7801\u662f\u5176\u672c\u8eab\uff0c\u8d1f\u6570\u7684\u53cd\u7801\u662f\u5728\u5176\u539f\u7801\u7684\u57fa\u7840\u4e0a\u7b26\u53f7\u4f4d\u4e0d\u53d8\uff0c\u5176\u4f59\u5404\u4e2a\u4f4d\u53d6\u53cd\u3002</li> <li>+1 ( 0000 0001)\uff0c -1 ( 1111 1110)</li> <li>\u5b58\u5728 +0 \u548c -0</li> <li>\u8865\u7801\uff1a\u6b63\u6570\u7684\u8865\u7801\u7b49\u4e8e\u6e90\u7801/\u53cd\u7801\uff0c\u8d1f\u6570\u7684\u8865\u7801\u662f\u53cd\u7801\u52a0\u4e00\uff1b</li> <li>+1 ( 0000 0001)\uff0c -1 ( 1111 1111)</li> </ul> <p>\u5de6\u79fb/\u53f3\u79fb\uff1a\u79fb\u52a8\u4f4d\u6570\u9650\u5236\u6839\u636e\u7c7b\u578b\u7684\u4f4d\u6570\u51b3\u5b9a\uff08mod n\uff09\uff0c\u6bd4\u5982 32\u4f4d int\uff0c\u5de6\u79fb 1 \u7b49\u4ef7\u4e8e \u5de6\u79fb 33</p> <ul> <li>\u7b97\u672f\u5de6\u79fb\u3001\u7b97\u672f\u53f3\u79fb\u3001\u903b\u8f91\u5de6\u79fb\u3001\u903b\u8f91\u53f3\u79fb</li> </ul> <p>\u6d6e\u70b9\u6570\u7684\u5b9a\u4e49\uff1aIEEE 754\uff0c\u79d1\u5b66\u8ba1\u6570\u6cd5\uff0c\\(1.xyz * (2 ^ n)\\) \uff0c\u9690\u542b\u6700\u9ad8\u6570\u4f4d1</p> <ul> <li>\u5355\u7cbe\u5ea6\u6d6e\u70b9\u6570\uff1a\u7b26\u53f7\u4f4d\uff081\u4f4d\uff09\uff0c\u9636\u7801\uff088\u4f4d\uff09\uff0c\u5c3e\u6570\uff0823\u4f4d\uff09</li> <li>\u9636\u7801\uff1a\u91c7\u7528\u79fb\u7801\u8868\u793a\uff0c\u53ef\u76f4\u63a5\u6bd4\u8f83\uff0c\u4e0d\u9700\u8003\u8651\u8d1f\u53f7\u95ee\u9898\uff0c\u504f\u79fb\u91cf\u4e3a 127\uff082^7 - 1\uff09 \uff1b<ul> <li>\u79fb\u7801\u7684\u6307\u6570\u8303\u56f4\u4e3a[-126, 127]\uff08254\u4e2a\u53d6\u503c\uff09\uff1a\u9636\u7801\u51680\u88ab\u8ba4\u4e3a\u673a\u56680\uff0c\u9636\u7801\u5168\u4e00\u88ab\u8ba4\u4e3a\u65e0\u7a77\u5927\uff1b</li> </ul> </li> <li>\u5c3e\u6570\uff1a\u4ee5\u539f\u7801\u8868\u793a    </li> </ul> \u5c3e\u6570\\\u9636\u7801 \u51680 \u4e0d\u51680 \u51680 +0, -0 \\(+\\infty\\), \\(-\\infty\\) \u4e0d\u51680 NAN \\([-(2\u22122^{-23})\u00d72^{127}, (2\u22122^{-23})\u00d72^{127}]\\)"},{"location":"cs/cs_os.html","title":"\u64cd\u4f5c\u7cfb\u7edf","text":""},{"location":"cs/cs_os.html#cpu","title":"CPU \u7f13\u5b58/\u5185\u5b58\u6570\u636e\u4e00\u81f4\u6027","text":"<p>\u6570\u636e\u4ee5\"cache lines\"\u7684\u5f62\u5f0f\u5728cpus\u7684cache\u548c\u5185\u5b58\u4e4b\u95f4\u4f20\u8f93\uff0ccache line\u662f\u5b9a\u957f\u7684block\uff0c\u5927\u5c0f\u901a\u5e38\u5728<code>16\uff5e256</code> bytes\u3002</p> <ul> <li>cache miss \u65f6\u4f1a\u52a0\u8f7d\u6570\u636e\uff0c\u4e00\u822c\u91c7\u7528\u7ec4\u76f8\u8054\u6a21\u5f0f\uff1b</li> </ul> <p></p> <p>CPU \u7684\u7f13\u5b58\u4e00\u81f4\u6027\u95ee\u9898\u5e94\u8be5\u4ece 2 \u4e2a\u7ef4\u5ea6\u7406\u89e3\uff1a</p> <ul> <li>\u7eb5\u5411\uff1aCache \u4e0e\u5185\u5b58\u7684\u4e00\u81f4\u6027\u95ee\u9898\uff1a \u5728\u4fee\u6539 Cache \u6570\u636e\u540e\uff0c\u5982\u4f55\u540c\u6b65\u56de\u5185\u5b58\uff1f</li> <li>\u6a2a\u5411\uff1a\u591a\u6838\u5fc3 Cache \u7684\u4e00\u81f4\u6027\u95ee\u9898\uff1a \u5728\u4e00\u4e2a\u6838\u5fc3\u4fee\u6539 Cache \u6570\u636e\u540e\uff0c\u5982\u4f55\u540c\u6b65\u7ed9\u5176\u4ed6\u6838\u5fc3 Cache\uff1f</li> </ul>"},{"location":"cs/cs_os.html#cache","title":"Cache \u4e0e\u5185\u5b58\u7684\u4e00\u81f4\u6027","text":"<p>\u5199\u76f4\u8fbe\u7b56\u7565\uff08Write-Through\uff09\uff1a\u6bcf\u6b21\u66f4\u65b0 Cache \u65f6\uff0c\u540c\u6b65\u66f4\u65b0\u5185\u5b58\uff1b</p> <p>\u5199\u56de\u7b56\u7565\uff08Write-Back\uff09\uff1a\u6bcf\u4e2a Cache \u5757\u4e0a\u589e\u52a0\u4e00\u4e2a \u201c\u810f\uff08Dirty\uff09\u201d \u6807\u8bb0\u4f4d\uff0c\u5728 Cache \u5757\u88ab\u66ff\u6362\u51fa\u53bb\u7684\u65f6\u5019\u5c06\u6570\u636e\u5199\u56de\u7f13\u5b58\uff1a</p> <ul> <li>\u5199\u5165\u65f6\uff0c\u6570\u636e\u4e0d\u5728Cache\uff0c\u9700\u8981\u5148\u52a0\u8f7d\u5230 Cache\uff0c\u5982\u679c\u66ff\u6362\u7b56\u7565\u6362\u51fa\u7684\u65e7 Cache \u5757\u662f\u810f\u7684\uff0c\u5c31\u4f1a\u89e6\u53d1\u4e00\u6b21\u5199\u56de\u5185\u5b58\u64cd\u4f5c\uff1b</li> <li>Cache Miss \u65f6\uff1a\u66ff\u6362\u7b56\u7565\u6362\u51fa\u7684\u65e7 Cache \u5757\u662f\u810f\u7684\uff0c\u5c31\u4f1a\u89e6\u53d1\u4e00\u6b21\u5199\u56de\u5185\u5b58\u64cd\u4f5c\uff1b</li> </ul>"},{"location":"cs/cs_os.html#mesi","title":"MESI\uff08\u7f13\u5b58\u4e00\u81f4\u6027\uff09","text":"<p>MESI\u5728\u7ebf\u4f53\u9a8c\u7f51\u7ad9</p> <p>\u793a\u4f8b\uff1a\u5047\u8bbe A \u548c B \u4e24\u4e2aCPU\uff0c\u7ebf\u7a0b T \u5148\u5728 CPU A \u4e0a\u5199\u6570\u636e\uff0c\u5199\u5230 CPU A \u7684\u7f13\u5b58\uff0c\u518d\u5207\u6362\u5230 CPU B \u4e0a\u6267\u884c\uff0c\u6b64\u65f6 CPU B \u7684\u7f13\u5b58\u6ca1\u6709\u6570\u636e\u3002</p> <ul> <li>CPU B \u8bfb\u53d6\u65f6\uff0c\u4f1a\u89e6\u53d1CPU A\u7684\u7f13\u5b58\u5c06\u6570\u636e\u5199\u56de\u4e3b\u5b58\uff0c\u7136\u540eCPU B\u4ece\u4e3b\u5b58\u52a0\u8f7d\u5230\u7f13\u5b58\uff0c\u6b64\u65f6CPU A \u548c CPU B\u7684Cache line\u7684\u72b6\u6001\u662f Shared\u3002</li> </ul> <p>\u7f13\u5b58\u4e00\u81f4\u6027\u673a\u5236\u9700\u8981\u89e3\u51b3\u7684\u95ee\u9898\u5c31\u662f 2 \u70b9\uff1a</p> <ul> <li>\u7279\u6027 1 - \u5199\u4f20\u64ad\uff08Write Propagation\uff09\uff1a \u6bcf\u4e2a CPU \u6838\u5fc3\u7684\u5199\u5165\u64cd\u4f5c\uff0c\u9700\u8981\u4f20\u64ad\u5230\u5176\u4ed6 CPU \u6838\u5fc3\uff1b</li> <li>\u7279\u6027 2 - \u4e8b\u52a1\u4e32\u884c\u5316\uff08Transaction Serialization\uff09\uff1a \u5404\u4e2a CPU \u6838\u5fc3\u6240\u6709\u5199\u5165\u64cd\u4f5c\u7684\u987a\u5e8f\uff0c\u5728\u6240\u6709 CPU \u6838\u5fc3\u770b\u8d77\u6765\u662f\u4e00\u81f4\u3002</li> </ul> <p>MESI \u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\uff0c\u6bcf\u4e2acache line\u4e0a\u75282\u4f4d\u6765\u7ef4\u62a4\u72b6\u6001\u503c\"tag\"\uff0c\u56db\u79cd\u72b6\u6001\u5206\u522b\u4e3a\uff1a</p> <ul> <li>Modified\uff1a\u8868\u660e Cache \u5757\u88ab\u4fee\u6539\u8fc7\uff0c\u4f46\u672a\u540c\u6b65\u56de\u5185\u5b58\uff1b</li> <li>Exclusive\uff1a\u8868\u660e Cache \u5757\u88ab\u5f53\u524d\u6838\u5fc3\u72ec\u5360\uff0c\u800c\u5176\u5b83\u6838\u5fc3\u7684\u540c\u4e00\u4e2a Cache \u5757\u4f1a\u5931\u6548\uff0c\u5185\u5b58\u8ddf\u7f13\u5b58\u4e00\u81f4\u3002</li> <li>Shared\uff1a\u8868\u660e Cache \u5757\u88ab\u591a\u4e2a\u6838\u5fc3\u6301\u6709\u4e14\u90fd\u662f\u6709\u6548\u7684\uff0c\u4e0d\u7528\u8d1f\u8d23\u5c06\u6570\u636e\u5199\u56de\u6216\u8005\u79fb\u4ea4\u7ed9\u5176\u5b83cache\uff0c\u5185\u5b58\u8ddf\u7f13\u5b58\u4e00\u81f4\u3002</li> <li>Invalid\uff1a\u5904\u4e8einvalid\u72b6\u6001\u7684line\u662f\u7a7a\u7684\uff0c\u6ca1\u6709\u6570\u636e\uff0c\u5f53\u65b0\u7684\u6570\u636e\u8fdb\u5165cache\u65f6\uff0c\u5c06\u4f1a\u4f18\u5148\u88ab\u653e\u5165invalid\u72b6\u6001\u7684cache line\u4e2d\u3002</li> </ul> <p>\u72b6\u6001\u8f6c\u6362\u56fe\u5982\u4e0b\u6240\u793a\uff1a</p> <p></p> <p>\u73b0\u4ee3\u7684 CPU \u4f1a\u5728\u589e\u52a0\u5199\u7f13\u51b2\u533a\u548c\u5931\u6548\u961f\u5217\u5c06 MESI \u534f\u8bae\u7684\u8bf7\u6c42\u5f02\u6b65\u5316\uff0c\u4ee5\u63d0\u9ad8\u5e76\u884c\u5ea6\uff1a</p> <ul> <li>\u5199\u7f13\u51b2\u533a\uff08Store Buffer\uff09\uff1a</li> <li>\u5728\u5199\u5165\u64cd\u4f5c\u4e4b\u524d\uff0cCPU \u6838\u5fc3 1 \u9700\u8981\u5148\u5e7f\u64ad RFO \u8bf7\u6c42\u83b7\u5f97\u72ec\u5360\u6743\uff0c\u5728\u5176\u5b83\u6838\u5fc3\u56de\u5e94 ACK \u4e4b\u524d\uff0c\u5f53\u524d\u6838\u5fc3\u53ea\u80fd\u7a7a\u7b49\u5f85\uff0c\u8fd9\u5bf9 CPU \u8d44\u6e90\u662f\u4e00\u79cd\u6d6a\u8d39</li> <li>\u5199\u5165\u6307\u4ee4\u653e\u5230\u5199\u7f13\u51b2\u533a\u540e\u5e76\u53d1\u9001 RFO \u8bf7\u6c42\u540e\uff0cCPU \u5c31\u53ef\u4ee5\u53bb\u6267\u884c\u5176\u5b83\u4efb\u52a1\uff0c\u7b49\u6536\u5230 ACK \u540e\u518d\u5c06\u5199\u5165\u64cd\u4f5c\u5199\u5230 Cache \u4e0a\u3002</li> <li>\u5931\u6548\u961f\u5217\uff08Invalidation Queue\uff09</li> <li>\u5176\u4ed6\u6838\u5fc3\u5728\u6536\u5230 RFO \u8bf7\u6c42\u65f6\uff0c\u9700\u8981\u53ca\u65f6\u56de\u5e94 ACK\u3002\u4f46\u5982\u679c\u6838\u5fc3\u5f88\u5fd9\u4e0d\u80fd\u53ca\u65f6\u56de\u590d\uff0c\u5c31\u4f1a\u9020\u6210\u53d1\u9001 RFO \u8bf7\u6c42\u7684\u6838\u5fc3\u5728\u7b49\u5f85 ACK\u3002</li> <li>\u5148\u628a\u5176\u5b83\u6838\u5fc3\u53d1\u8fc7\u6765\u7684 RFO \u8bf7\u6c42\u653e\u5230\u5931\u6548\u961f\u5217\uff0c\u7136\u540e\u76f4\u63a5\u8fd4\u56de ACK\uff0c\u7b49\u5f53\u524d\u6838\u5fc3\u5904\u7406\u5b8c\u4efb\u52a1\u540e\u518d\u53bb\u5904\u7406\u5931\u6548\u961f\u5217\u4e2d\u7684\u5931\u6548\u8bf7\u6c42\u3002</li> </ul> <p></p> <p>\u4e8b\u5b9e\u4e0a\uff0c\u5199\u7f13\u51b2\u533a\u548c\u5931\u6548\u961f\u5217\u7834\u574f\u4e86 Cache \u7684\u4e00\u81f4\u6027\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff1a\u521d\u59cb\u72b6\u6001\u53d8\u91cf a \u548c\u53d8\u91cf b \u90fd\u662f 0\uff0c\u73b0\u5728 Core1 \u548c Core2 \u5206\u522b\u6267\u884c\u8fd9\u4e24\u6bb5\u6307\u4ee4\uff0c\u6700\u7ec8 x \u548c y \u7684\u7ed3\u679c\u662f\u4ec0\u4e48\uff1f</p> <p>Core1 \u6307\u4ee4</p> <pre><code>a = 1; // A1\nx = b; // A2\n</code></pre> <p>Core2 \u6307\u4ee4</p> <pre><code>b = 2; // B1\ny = a; // B2\n</code></pre> <p>\u5199\u7f13\u51b2\u533a\u9020\u6210\u6307\u4ee4\u91cd\u6392\uff0c\u51fa\u73b0\u610f\u6599\u4e4b\u5916\u7684\u7ed3\u679c</p> <p></p>"},{"location":"cs/cs_os.html#_2","title":"\u987a\u5e8f\u4e00\u81f4\u6027","text":""},{"location":"cs/cs_os.html#_3","title":"\u5185\u5b58\u8bfb\u5199\u6307\u4ee4\u7684\u91cd\u6392","text":"<p><code>\u5185\u5b58\u91cd\u6392</code>\uff08\u7531Store Buffer\u3001CPU\u4e71\u5e8f\u3001\u7f16\u8bd1\u5668\u91cd\u6392\u7b49\u9020\u6210\uff09\u5e26\u6765\u7684\u5185\u5b58\u4e00\u81f4\u6027memory consistency\u95ee\u9898\uff0cMESI\u534f\u8bae\u4e5f\u662f\u5904\u7406\u4e0d\u4e86\u7684\u3002</p> <ul> <li>X86 \u4e0a\u7684LOCK\u524d\u7f00\u6307\u4ee4\uff1a\u539f\u5b50\u6027 + \u7981\u6b62\u524d\u540e\u6307\u4ee4\u7684\u91cd\u6392\u5e8f</li> </ul> <p>\u5185\u5b58\u8bfb\u5199\u6307\u4ee4\u7684\u91cd\u6392\u5206\u4e3a\u8f6f\u4ef6\u5c42\u9762\u7684<code>\u7f16\u8bd1\u5668\u91cd\u6392</code> \u548c\u786c\u4ef6\u5c42\u9762\u7684<code>CPU\u91cd\u6392</code> \u3002</p> <p>CPU\u91cd\u6392\uff1a</p> <ul> <li>CPU\u6307\u4ee4\u91cd\u6392\uff1a\u5e76\u884c\u6267\u884c\u3001\u5ef6\u8fdf\u6267\u884c\u3001\u5206\u652f\u9884\u6d4b\u6280\u672f\u7b49\uff1b</li> <li>\u7f13\u5b58\u8bfb\u5199\u91cd\u6392\uff1a\u5148\u8fdb\u884c\u7f13\u5b58\u8bfb\u5199\u64cd\u4f5c\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u5bf9\u5185\u5b58\u8fdb\u884c\u8bfb\u5199\uff0c\u5305\u62ec MESI \u7684\u5199\u7f13\u51b2\u533a\u548c\u5931\u6548\u961f\u5217\u673a\u5236\uff1b</li> </ul>"},{"location":"cs/cs_os.html#_4","title":"\u5185\u5b58\u5c4f\u969c\u7c7b\u578b","text":"<p>barrier \u6709\u56db\u79cd:</p> <ul> <li>LoadLoad \u963b\u6b62\u4e0d\u76f8\u5173\u7684 Load \u64cd\u4f5c\u53d1\u751f\u91cd\u6392</li> <li>LoadStore \u963b\u6b62 Store \u88ab\u91cd\u6392\u5230 Load \u4e4b\u524d</li> <li>StoreLoad \u963b\u6b62 Load \u88ab\u91cd\u6392\u5230 Store \u4e4b\u524d</li> <li>StoreStore \u963b\u6b62 Store \u88ab\u91cd\u6392\u5230 Store \u4e4b\u524d</li> </ul>"},{"location":"cs/cs_os.html#cpu_1","title":"CPU \u5185\u5b58\u4e00\u81f4\u6027\u6a21\u578b","text":"<p>\u76ee\u524d\u6709\u591a\u79cd\u5185\u5b58\u4e00\u81f4\u6027\u6a21\u578b\uff1a</p> <ul> <li>\u987a\u5e8f\u5b58\u50a8\u6a21\u578b\uff08sequential consistency model\uff09\uff1a\u7406\u60f3\u6a21\u578b\uff0c\u6ca1\u6709\u4e71\u5e8f\u7684\u5b58\u5728\u3002</li> <li>\u5b8c\u5168\u5b58\u50a8\u5b9a\u5e8f\uff08total store order\uff09\uff1a\u5f3a\u4e00\u81f4\u6027\u6a21\u578b</li> <li>\u90e8\u5206\u5b58\u50a8\u5b9a\u5e8f\uff08part store order\uff09</li> <li>\u5bbd\u677e\u5b58\u50a8\u6a21\u578b\uff08relax memory order\uff09</li> </ul>"},{"location":"cs/cs_os.html#_5","title":"\u8fdb\u7a0b","text":"<p>\u4e09\u6001\u6a21\u578b\uff1a\u8fd0\u884c\u6001\u3001\u5c31\u7eea\u6001\u3001\u963b\u585e\u6001</p> <p>\u8fdb\u7a0b\u7684\u7ec4\u6210\u90e8\u5206\uff1a\u7a0b\u5e8f\u3001\u6570\u636e\u96c6\u5408\u3001PCB\uff08\u8fdb\u7a0b\u63a7\u5236\u5757\uff09</p> <ul> <li>PCB\u662f\u79cd\u6570\u636e\u7ed3\u6784\uff0c\u662f\u8fdb\u7a0b\u5b58\u5728\u7684\u552f\u4e00\u6807\u8bc6\uff1b</li> </ul> <p>PCB\u7684\u7ec4\u7ec7\u65b9\u5f0f\uff1a</p> <ul> <li>\u7ebf\u6027\u65b9\u5f0f\uff1a\u6240\u6709PCB\u65e0\u8bba\u72b6\u6001\uff0c\u8fde\u7eed\u5b58\u653e\u5728\u5185\u5b58\u533a\u57df\uff08\u7ebf\u6027\u8868\u7ec4\u7ec7\uff09\uff0c\u6bcf\u6b21\u67e5\u627e\u626b\u63cf\u5168\u8868\uff1b</li> <li>\u94fe\u63a5\u65b9\u5f0f\uff1a\u6309\u7167\u8fdb\u7a0b\u7684\u72b6\u6001\uff0c\u5c06\u8fdb\u7a0b\u7684PCB\u7ec4\u7ec7\u6210\u961f\u5217\uff0c\u5f62\u6210\u5c31\u7eea\u3001\u963b\u585e\u3001\u8fd0\u884c\u961f\u5217\uff08\u961f\u5217\u5934\u6307\u9488\uff09\u7b49\uff1b</li> <li>\u7d22\u5f15\u65b9\u5f0f\uff1a\u6309\u7167\u8fdb\u7a0b\u72b6\u6001\uff0c\u5efa\u7acb\u5c31\u7eea\u3001\u963b\u585e\u3001\u8fd0\u884c\u7d22\u5f15\u8868\u7b49\uff1b</li> </ul> <p></p>"},{"location":"cs/cs_os.html#_6","title":"\u8fdb\u7a0b\u7a7a\u95f4","text":"<p>\u865a\u62df\u5185\u5b58\u673a\u5236\uff1a\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u903b\u8f91\u4e0a\u72ec\u5360\u62e5\u6709\u5168\u90e8\u7684\u5185\u5b58\u3002</p> <ul> <li>\u5185\u5b58\u5206\u914d\u662f\u5206\u914d\u865a\u62df\u5185\u5b58\u7ed9\u8fdb\u7a0b\uff0c\u5f53\u8fdb\u7a0b\u771f\u6b63\u8bbf\u95ee\u67d0\u4e00\u865a\u62df\u5185\u5b58\u5730\u5740\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u901a\u8fc7\u89e6\u53d1\u7f3a\u9875\u4e2d\u65ad\uff0c\u5728\u7269\u7406\u5185\u5b58\u4e0a\u5206\u914d\u4e00\u6bb5\u76f8\u5e94\u7684\u7a7a\u95f4\u518d\u4e0e\u4e4b\u5efa\u7acb\u6620\u5c04\u5173\u7cfb\uff0c\u865a\u62df\u5185\u5b58\u5730\u5740\u4f1a\u88ab\u81ea\u52a8\u8f6c\u6362\u53d8\u6210\u6709\u6548\u7269\u7406\u5185\u5b58\u5730\u5740\uff0c\u4fbf\u53ef\u4ee5\u8fdb\u884c\u6570\u636e\u7684\u5b58\u50a8\u4e0e\u8bbf\u95ee\uff1b</li> </ul> <p></p> <ul> <li> <p>64\u4f4d\u5730\u5740\u7684\u865a\u62df\u5185\u5b58\u7a7a\u95f4\u4e3a256TB ( 2^48 )\uff1a\u76ee\u524d\u7684x86-64\u67b6\u6784CPU\u90fd\u9075\u5faaAMD\u7684Canonical form\uff0c \u5373\u53ea\u6709\u865a\u62df\u5730\u5740\u7684\u6700\u4f4e48\u4f4d\u624d\u4f1a\u5728\u5730\u5740\u8f6c\u6362\u65f6\u88ab\u4f7f\u7528\uff0c\u4e14\u4efb\u4f55\u865a\u62df\u5730\u5740\u768448\u4f4d\u81f363\u4f4d\u5fc5\u987b\u4e0e47\u4f4d\u4e00\u81f4(sign extension)\u3002</p> </li> <li> <p>\u5185\u6838\u7a7a\u95f4\u5360\u4e00\u534a\uff08\u540c\u6837\u662f\u9ad8\u5730\u5740\u533a\u57df\uff09\uff0c\u666e\u901a\u8fdb\u7a0b\u4f7f\u7528\u53e6\u5916\u4e00\u534a\u3002</p> </li> <li>\u4f7f\u752840\u4f4d\u6765\u8868\u793a\u7269\u7406\u5730\u5740\u7a7a\u95f4\uff0c\u53ef\u4ee5\u901a\u8fc7<code>cat /proc/cpuinfo</code>\u6765\u67e5\u770b\uff1b</li> </ul> <p>Kernel space\uff1a\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u5730\u5740\u7a7a\u95f4\uff1b</p> <ul> <li>\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u5185\u6838\u865a\u62df\u5730\u5740\u7a7a\u95f4\u90fd\u662f\u6620\u5c04\u5230\u76f8\u540c\u7684\u771f\u5b9e\u7269\u7406\u5730\u5740\uff1b</li> <li>\u5185\u6838\u865a\u62df\u5730\u5740\u7a7a\u95f4\u603b\u662f\u5b58\u653e\u5728\u865a\u62df\u5185\u5b58\u7684\u5730\u5740\u6700\u9ad8\u5904\u3002</li> </ul> <p>Stack\uff1a\u6808\u7a7a\u95f4\u3002</p> <ul> <li>Random stack offset\uff08\u6808\u968f\u673a\u504f\u79fb\uff09\uff1a\u56e0\u4e3a\u5185\u5b58\u5e03\u5c40\u6309\u7167\u4e25\u683c\u7684\u89c4\u5219\u6446\u653e\uff0c\u56e0\u6b64\u5f88\u5bb9\u6613\u88ab\u6076\u610f\u8bbf\u95ee\uff0c\u901a\u8fc7\u52a0\u5165\u968f\u673a\u504f\u79fb\uff0c\u4f7f\u7684\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u6808\u7a7a\u95f4\u8d77\u59cb\u4f4d\u7f6e\u90fd\u7a0d\u6709\u4e0d\u540c\uff0c\u4f7f\u7684\u88ab\u786e\u5b9a\u6808\u7a7a\u95f4\u8d77\u59cb\u4f4d\u7f6e\u5177\u6709\u4e00\u5b9a\u96be\u5ea6\uff0c\u9632\u6b62\u88ab\u6076\u610f\u8bbf\u95ee\u3002</li> </ul> <p>Heap\u4e0eMemory Mapping Segment\uff1a\u5806\u4e0e\u5185\u5b58\u6620\u5c04\u6bb5\u90fd\u5c5e\u4e8e\u5806\u7a7a\u95f4</p> <ul> <li>\u5806\u8d1f\u8d23\u5c0f\u989d\u5185\u5b58\u7684\u7ba1\u7406\uff0c\u5185\u5b58\u6620\u5c04\u6bb5\u8d1f\u8d23\u5927\u989d\u5185\u5b58\u7684\u7ba1\u7406\uff0c\u65b9\u4fbf\u7684\u5b58\u50a8\u6570\u636e\u5e76\u4e14\u51cf\u5c11\u52a8\u6001\u5206\u914d\u5185\u5b58\u65f6\u7cfb\u7edf\u7684\u5f00\u9500\uff1b</li> </ul> <p>Text segment\uff1a\u4ee3\u7801\u6bb5\u3002\u8fd9\u4e00\u5757\u533a\u57df\u662f\u7528\u6765\u5b58\u653e\u8fdb\u7a0b\u4ee3\u7801\uff1b</p> <p>Data segment\uff1a\u6570\u636e\u6bb5\u3002\u5b58\u653e\u5168\u5c40\u6570\u636e\u4e0e\u9759\u6001\u6570\u636e\uff1b</p> <p>BBS segment\uff1a\u4fdd\u5b58\u7684\u662f\u5168\u5c40/\u9759\u6001\u672a\u521d\u59cb\u5316\u6570\u636e</p>"},{"location":"cs/cs_os.html#_7","title":"\u6b7b\u9501","text":"<p>\u4e24\u4e2a\u6216\u591a\u4e2a\u4efb\u52a1\uff08\u7ebf\u7a0b\uff09\u5f62\u6210\u5faa\u73af\u7b49\u5f85\u5404\u81ea\u7684\u5171\u4eab\u8d44\u6e90\u91ca\u653e\uff0c\u5f62\u6210\u4e86\u6b7b\u9501\u3002</p> <p>Coffman\u6761\u4ef6\uff1a\u6b7b\u9501\u7684\u5145\u8981\u6761\u4ef6</p> <ul> <li>\u4e92\u65a5\uff1a\u8d44\u6e90\u4e0d\u53ef\u5171\u4eab\uff1b</li> <li>\u5360\u6709\u5e76\u7b49\u5f85\u6761\u4ef6\uff1a\u4e00\u4e2a\u4efb\u52a1\u5360\u6709\u67d0\u4e2a\u4e92\u65a5\u8d44\u6e90\u540c\u65f6\u4e14\u8bf7\u6c42\u53e6\u4e00\u4e2a\u4e92\u65a5\u8d44\u6e90\uff0c\u4e14\u7b49\u5f85\u65f6\u4e0d\u4f1a\u91ca\u653e\u4efb\u4f55\u8d44\u6e90\uff1b</li> <li>\u4e0d\u53ef\u5265\u593a\uff1a\u8d44\u6e90\u53ea\u80fd\u88ab\u90a3\u4e9b\u6301\u6709\u5b83\u4eec\u7684\u4efb\u52a1\u91ca\u653e\uff1b</li> <li>\u5faa\u73af\u7b49\u5f85\uff1a\u62e5\u6709\u8d44\u6e90\u548c\u7533\u8bf7\u8d44\u6e90\u5f62\u6210\u4e86\u73af\u72b6\u7684\u5faa\u73af\u3002</li> </ul> <p>\u89e3\u51b3\u6b7b\u9501\u7684\u7b56\u7565\uff1a</p> <ul> <li>\u6b7b\u9501\u9884\u9632\uff1a\u7834\u574f\u6b7b\u9501\u6761\u4ef6\u4e2d\u7684\u4efb\u4e00\u4e2a\uff1b </li> <li>\u6b7b\u9501\u907f\u514d\uff1a\u7533\u8bf7\u8d44\u6e90\u65f6\u5224\u65ad\u662f\u5426\u4f1a\u53d1\u751f\u6b7b\u9501\uff0c\u5982\u94f6\u884c\u5bb6\u7b97\u6cd5\uff1b</li> <li>\u6b7b\u9501\u68c0\u6d4b\uff1a\u5224\u65ad\u5f53\u524d\u662f\u5426\u5904\u4e8e\u6b7b\u9501\uff0c\u5982\u679c\u662f\u5219\u8fdb\u6b7b\u9501\u89e3\u9664\uff1b</li> <li>\u6b7b\u9501\u89e3\u9664\uff1a\u4e0e\u6b7b\u9501\u68c0\u6d4b\u914d\u5408\u4f7f\u7528\uff0c\u5265\u593a\u8fdb\u7a0b\u7684\u8d44\u6e90\uff1b</li> </ul> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u901a\u8fc7\u9884\u9632\u5c31\u53ef\u4ee5\u907f\u514d\u6b7b\u9501\uff0c\u6bd4\u5982\u591a\u8d44\u6e90\u7533\u8bf7\u7684\u987a\u5e8f\u8981\u4e00\u81f4\uff0c\u4e14\u6700\u5148\u7533\u8bf7\u7684\u8d44\u6e90\u6700\u540e\u91ca\u653e\u3002</p>"},{"location":"cs/cs_os.html#_8","title":"\u6d3b\u9501","text":"<p>\u7cfb\u7edf\u6709\u4e24\u4e2a\u4efb\u52a1\uff0c\u56e0\u5bf9\u65b9\u7684\u884c\u4e3a\u800c\u6539\u53d8\u81ea\u5df1\u7684\u72b6\u6001\uff0c\u5219\u51fa\u73b0\u4e86\u6d3b\u9501\u3002\u6700\u7ec8\u662f\u5b83\u4eec\u9677\u5165\u72b6\u6001\u53d8\u66f4\u7684\u5faa\u73af\u800c\u65e0\u6cd5\u7ee7\u7eed\u5411\u4e0b\u6267\u884c\u3002</p> <p>\u901a\u8fc7\u5bf9\u591a\u4e2a\u8d44\u6e90\u7684\u540c\u987a\u5e8f\u7533\u8bf7\uff0c\u53ef\u4ee5\u9884\u9632\u6d3b\u9501\u3002</p>"},{"location":"cs/cs_os.html#_9","title":"\u5bfb\u5740","text":""},{"location":"cs/cs_os.html#_10","title":"\u865a\u62df\u5730\u5740(\u903b\u8f91\u5730\u5740)","text":"<p>\u6240\u6709\u73b0\u4ee3\u64cd\u4f5c\u7cfb\u7edf\u90fd\u4f7f\u7528\u865a\u62df\u5185\u5b58\uff0c\u4f7f\u7528\u865a\u62df\u7684\u5730\u5740\u53d6\u4ee3\u7269\u7406\u5730\u5740\uff0c\u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\uff1a</p> <ol> <li> <p>\u4e00\u4e2a\u4ee5\u4e0a\u7684\u865a\u62df\u5730\u5740\u53ef\u4ee5\u6307\u5411\u540c\u4e00\u4e2a\u7269\u7406\u5185\u5b58\u5730\u5740\uff1b</p> </li> <li> <p>\u865a\u62df\u5185\u5b58\u7a7a\u95f4\u53ef\u5927\u4e8e\u5b9e\u9645\u53ef\u7528\u7684\u7269\u7406\u5730\u5740\uff1b</p> </li> </ol> <p>\u5229\u7528\u7b2c\u4e00\u6761\u7279\u6027\u53ef\u4ee5\u628a\u5185\u6838\u7a7a\u95f4\u5730\u5740\u548c\u7528\u6237\u7a7a\u95f4\u7684\u865a\u62df\u5730\u5740\u6620\u5c04\u5230\u540c\u4e00\u4e2a\u7269\u7406\u5730\u5740\uff0c\u8fd9\u6837DMA\u5c31\u53ef\u4ee5\u586b\u5145\u5bf9\u5185\u6838\u548c\u7528\u6237\u7a7a\u95f4\u8fdb\u7a0b\u540c\u65f6\u53ef\u89c1\u7684\u7f13\u51b2\u533a\u3002</p>"},{"location":"cs/cs_os.html#_11","title":"\u5730\u5740\u91cd\u5b9a\u4f4d","text":"<p>\u5c06\u7a0b\u5e8f\u7684\u865a\u62df\u5730\u5740\uff08\u903b\u8f91\u5730\u5740\uff09\u8f6c\u4e3a\u5185\u5b58\u7684\u771f\u5b9e\u5730\u5740\uff08\u7269\u7406\u5730\u5740\uff09\u7684\u8fc7\u7a0b\uff0c\u7531\u5355\u72ec\u7684\u786c\u4ef6\u5904\u7406\u3002</p> <ul> <li>\u9759\u6001\u91cd\u5b9a\u4f4d\uff1a</li> <li>\u7edd\u5bf9\u5730\u5740\uff08\u7269\u7406\u5730\u5740\uff09 = \u76f8\u5bf9\u5730\u5740\uff08\u903b\u8f91\u5730\u5740\uff09 + \u7a0b\u5e8f\u5b58\u653e\u7684\u5185\u5b58\u8d77\u59cb\u5730\u5740</li> <li>\u7a0b\u5e8f\u8fd0\u884c\u524d\u786e\u5b9a\u6620\u5c04\u5173\u7cfb\uff0c\u7a0b\u5e8f\u88c5\u5165\u540e\u4e0d\u80fd\u79fb\u52a8\uff0c\u5360\u7528\u8fde\u7eed\u7684\u5185\u5b58\u7a7a\u95f4\uff1b</li> <li>\u52a8\u6001\u91cd\u5b9a\u4f4d\uff1a</li> <li>\u7edd\u5bf9\u5730\u5740\uff08\u7269\u7406\u5730\u5740\uff09= \u903b\u8f91\u5730\u5740\u5bc4\u5b58\u5668\u7684\u503c\uff08VR\uff09+ \u91cd\u5b9a\u4f4d\u5bc4\u5b58\u5668\u7684\u503c\uff08BR\uff09</li> <li>\u7a0b\u5e8f\u5360\u7528\u7684\u5185\u5b58\u7a7a\u95f4\u53ef\u52a8\u6001\u53d8\u5316\uff0c\u4e0d\u8981\u6c42\u8fde\u7eed\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u4fbf\u4e8e\u591a\u4e2a\u8fdb\u7a0b\u5171\u4eab\u4ee3\u7801\uff1b</li> </ul>"},{"location":"cs/cs_os.html#_12","title":"\u5b58\u50a8\u7ba1\u7406","text":""},{"location":"cs/cs_os.html#_13","title":"\u5206\u533a\u7ba1\u7406","text":"<p>\u628a\u4e3b\u5b58\u7684\u7528\u6237\u533a\u5212\u5206\u4e3a\u82e5\u5e72\u4e2a\u533a\u57df\uff08\u8fde\u7eed\uff09\uff0c\u6bcf\u4e2a\u533a\u57df\u5206\u914d\u7ed9\u7528\u6237\u4f5c\u4e1a\u4f7f\u7528\uff0c\u5e76\u9650\u5b9a\u4ed6\u4eec\u53ea\u80fd\u5728\u81ea\u5df1\u7684\u533a\u57df\u4e2d\u8fd0\u884c\u3002</p> <ul> <li>\u56fa\u5b9a\u5206\u533a\uff1a\u6bcf\u4e2a\u5206\u533a\u7528\u6765\u88c5\u5165\u4e00\u4e2a\u4f5c\u4e1a\uff1b</li> <li>\u53ef\u53d8\u5206\u533a\uff1a\u8fdb\u7a0b\u88c5\u5165\u5185\u5b58\u65f6\uff0c\u6839\u636e\u8fdb\u7a0b\u7684\u5927\u5c0f\u52a8\u6001\u5730\u5efa\u7acb\u5206\u533a\uff0c\u7cfb\u7edf\u5206\u533a\u7684\u5927\u5c0f\u548c\u6570\u76ee\u662f\u53ef\u53d8\u7684\uff08\u7a7a\u95f2\u5206\u533a\u4f1a\u5408\u5e76\uff09\uff1b</li> <li>\u9996\u6b21\u9002\u5e94\u7b97\u6cd5\uff1a\u7b2c\u4e00\u4e2a\u533a\u57df\u80fd\u591f\u6ee1\u8db3\u7a0b\u5e8f\u7684\u7a7a\u95f4\u9700\u6c42\uff1b</li> <li>\u6700\u4f73\u9002\u5e94\u7b97\u6cd5\uff1a\u6700\u5c0f\u5269\u4f59\u7684\u533a\u57df\u80fd\u591f\u6ee1\u8db3\u7a0b\u5e8f\u7684\u7a7a\u95f4\u9700\u6c42\uff1b</li> <li>\u6700\u5dee\u9002\u5e94\u7b97\u6cd5\uff1a\u6700\u5927\u5269\u4f59\u7684\u533a\u57df\u80fd\u591f\u6ee1\u8db3\u7a0b\u5e8f\u7684\u7a7a\u95f4\u9700\u6c42\uff1b</li> <li>\u53ef\u91cd\u5b9a\u4f4d\u5206\u533a\uff1a</li> <li>\u7a0b\u5e8f\u4f7f\u7528\u7684\u7a7a\u95f4\uff08\u8fde\u7eed\uff09\u53ef\u4ee5\u6574\u4f53\u79fb\u52a8\uff0c\u8ba9\u4f7f\u7528\u7684\u5206\u533a\u96c6\u4e2d\uff0c\u8fdb\u4e00\u6b65\u51cf\u5c11\u5185\u5b58\u788e\u7247\uff1b</li> </ul> <p>\u6848\u4f8b\uff1a\u4f19\u4f34\u7cfb\u7edf\uff08buddy system\uff09\uff1a\u5185\u5b58\u662f\u4ee52\u7684\u5e42\u6b21\u4e2a\u5b57\u8282\u5927\u5c0f\u7684\u7a7a\u95f2\u5757\u4e3a\u5206\u914d\u5355\u4f4d</p>"},{"location":"cs/cs_os.html#_14","title":"\u5206\u9875\u7ba1\u7406","text":"<p>\u9875\uff1a\u5c06\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u5212\u5206\u4e3a\u82e5\u5e72\u4e2a\u5927\u5c0f\u76f8\u7b49\u7684\u533a\u57df\u3002</p> <p>\u9875\u6846\uff1a\u5c06\u4e3b\u5b58\u7a7a\u95f4\u4e5f\u5212\u5206\u8ddf\u9875\u5927\u5c0f\u76f8\u7b49\u7684\u82e5\u5e72\u4e2a\u7269\u7406\u5757\uff0c\u4e5f\u79f0\u4e3a\u5757\u3002</p> <p>\u903b\u8f91\u5730\u5740\uff1a\u9875\u53f7+\u9875\u5185\u5730\u5740\uff1b</p> <p>\u7269\u7406\u5730\u5740\uff1a\u9875\u6846\u53f7\uff08\u7269\u7406\u5757\u53f7\uff09+\u5757\u5185\u5730\u5740\uff1b</p> <p>\u901a\u8fc7\u9875\u8868\u8bb0\u5f55 \u9875\u53f7 -&gt; \u9875\u6846\u53f7\uff0c\u9875\u5185\u5730\u5740\u7b49\u4e8e\u5757\u5185\u5730\u5740\u3002</p> <p></p>"},{"location":"cs/cs_os.html#_15","title":"\u5206\u6bb5\u7ba1\u7406","text":"<p>\u4e3a\u6bcf\u4e2a\u6bb5\u5206\u914d\u4e00\u4e2a\u8fde\u7eed\u7684\u533a\u57df\uff08\u5404\u4e2a\u6bb5\u7684\u957f\u5ea6\u53ef\u4ee5\u4e0d\u4e00\u6837\uff09\uff0c\u8fdb\u7a0b\u4e2d\u7684\u5404\u4e2a\u6bb5\u53ef\u4ee5\u79bb\u6563\u5730\u5206\u914d\u5230\u4e3b\u5b58\u7684\u4e0d\u540c\u5206\u6bb5\u4e2d\u3002</p> <p>\u903b\u8f91\u5730\u5740\uff1a\u6bb5\u53f7+\u6bb5\u5185\u5730\u5740\uff1b</p> <p>\u7269\u7406\u5730\u5740\uff1a\u6bb5\u57fa\u5740+\u6bb5\u5185\u5730\u5740\uff1b</p> <p>\u901a\u8fc7\u6bb5\u8868\u8bb0\u5f55 \u6bb5\u53f7 -&gt; \u6bb5\u57fa\u5740\uff0c\u6bb5\u5185\u5730\u5740\u4e00\u6837\u3002</p> <p></p>"},{"location":"cs/cs_os.html#_16","title":"\u6bb5\u9875\u5f0f\u7ba1\u7406","text":"<p>\u5c06\u4e3b\u5b58\u5212\u5206\u6210\u5927\u5c0f\u76f8\u7b49\u7684\u5b58\u50a8\u5757\uff08\u9875\u6846\uff09\uff0c\u5c06\u7528\u6237\u7a0b\u5e8f\u6309\u7a0b\u5e8f\u903b\u8f91\u5173\u7cfb\u5206\u4e3a\u82e5\u5e72\u6bb5\uff0c\u5c06\u6bcf\u4e2a\u6bb5\u5212\u5206\u4e3a\u82e5\u5e72\u9875\uff0c\u4ee5\u9875\u6846\u4e3a\u5355\u4f4d\u79bb\u6563\u5206\u914d\u3002</p> <p>\u903b\u8f91\u5730\u5740\uff1a\u6bb5\u53f7 + \u6bb5\u5185\u9875\u53f7 + \u9875\u5185\u5730\u5740</p> <p>\u7269\u7406\u5730\u5740\uff1a\u6bb5\u57fa\u5740 + \u9875\u6846\u53f7 + \u9875\u5185\u5730\u5740</p> <p></p>"},{"location":"cs/cs_os.html#_17","title":"\u865a\u62df\u5b58\u50a8","text":"<p>\u5f53\u4e3b\u5b58\u7a7a\u95f4\u4e0d\u80fd\u6ee1\u8db3\u4f5c\u4e1a\u8981\u6c42\u65f6\uff0c\u4f5c\u4e1a\u65e0\u6cd5\u88c5\u5165\u4e3b\u5b58\u6267\u884c\u3002</p> <p>\u5982\u679c\u4e00\u4e2a\u4f5c\u4e1a\u53ea\u90e8\u5206\u88c5\u5165\u4e3b\u5b58\u4fbf\u53ef\u5f00\u59cb\u542f\u52a8\u8fd0\u884c\uff0c\u5176\u4f59\u90e8\u5206\u6682\u65f6\u7559\u5728\u78c1\u76d8\u4e0a\uff0c\u5728\u9700\u8981\u65f6\u518d\u88c5\u5165\u4e3b\u5b58\uff0c\u8fd9\u6837\u53ef\u4ee5\u6709\u6548\u5730\u5229\u7528\u4e3b\u5b58\u7a7a\u95f4\u3002</p> <p>\u4ece\u7528\u6237\u89d2\u5ea6\u770b\uff0c\u8be5\u7cfb\u7edf\u6240\u5177\u6709\u7684\u4e3b\u5b58\u5bb9\u91cf\u5c06\u6bd4\u5b9e\u9645\u4e3b\u5b58\u5bb9\u91cf\u5927\u5f97\u591a\uff0c\u4eba\u4eec\u628a\u8fd9\u6837\u7684\u5b58\u50a8\u5668\u79f0\u4e3a\u865a\u62df\u5b58\u50a8\u5668\u3002</p> <ul> <li>\u6839\u636e\u4e0d\u540c\u7684\u7ba1\u7406\u65b9\u5f0f\u5206\u4e3a\uff1a\u8bf7\u6c42\u5206\u9875\u3001\u8bf7\u6c42\u5206\u6bb5\u3001\u8bf7\u6c42\u6bb5\u9875\u5f0f</li> </ul>"},{"location":"cs/cs_os.html#_18","title":"\u9875\u9762\u6dd8\u6c70","text":"<p>\u8bf7\u6c42\u5206\u9875\u7ba1\u7406\u4e2d\uff0c\u6dd8\u6c70\u9875\u9762\u7684\u7b97\u6cd5\uff1a</p> <ul> <li>\u72b6\u6001\u4f4d\u5728\u5185\u5b58\u7684\u9875\u9762\u624d\u53ef\u4ee5\u88ab\u6dd8\u6c70\uff1b</li> <li>\u6839\u636e\u8bbf\u95ee\u4f4d\uff080\u672a\u8bbf\u95ee\uff0c1\u8bbf\u95ee\uff09\uff0c\u4fee\u6539\u4f4d\uff080\u672a\u4fee\u6539\uff0c1\u4fee\u6539\uff09\u8fdb\u884c\u6dd8\u6c70\uff1a</li> <li>\u6309\u7167 00  -&gt; 01 -&gt; 10 -&gt; 11 \u7684\u987a\u5e8f\u8fdb\u884c\u6dd8\u6c70\uff1b</li> </ul>"},{"location":"cs/cs_os.html#_19","title":"\u8bbe\u5907\u7ba1\u7406","text":"<p>\u7a0b\u5e8f\u63a7\u5236\uff1aCPU\u4e0e\u8bbe\u5907\u4e32\u884c\u5de5\u4f5c</p> <ul> <li>\u65e0\u6761\u4ef6\u4f20\u9001\uff1aIO\u7aef\u603b\u662f\u51c6\u5907\u597d\uff0cCPU\u9700\u8981\u65f6\uff0c\u968f\u65f6\u4f7f\u7528IO\u7aef\u53e3\uff1b</li> <li>\u7a0b\u5e8f\u67e5\u8be2\uff1aCPU\u8f6e\u8be2IO\u7aef\u662f\u5426\u51c6\u5907\u597d\uff0c\u518d\u8fdb\u884c\u53d1\u9001\u6570\u636e\uff1b</li> </ul> <p>\u4e2d\u65ad\uff1a</p> <ul> <li>\u67d0\u4e2a\u8fdb\u7a0b\u8981\u542f\u52a8\u67d0\u4e2a\u8bbe\u5907\u65f6\uff0cCPU\u5c31\u5411\u76f8\u5e94\u7684\u8bbe\u5907\u63a7\u5236\u5668\u53d1\u51fa\u4e00\u6761\u8bbe\u5907I/O\u542f\u52a8\u6307\u4ee4\uff0c\u7136\u540eCPU\u53c8\u8fd4\u56de\u505a\u539f\u6765\u7684\u5de5\u4f5c\uff1b</li> <li>\u8bbe\u5907\u51c6\u5907\u597d\u65f6\uff0c\u53ef\u4ee5\u53d1\u9001\u4e2d\u65ad\u8bf7\u6c42\uff0cCPU\u54cd\u5e94\u4e2d\u65ad\u8bf7\u6c42\u53d1\u9001\u6570\u636e\uff1b</li> <li>CPU\u4e0eI/O\u8bbe\u5907\u53ef\u4ee5\u5e76\u884c\u5de5\u4f5c\uff08\u5373\u8bbe\u5907\u51c6\u5907\u65f6\uff0cCPU\u53ef\u4ee5\u7ee7\u7eed\u6267\u884c\u5176\u5b83\u7a0b\u5e8f\uff09\u3002</li> </ul> <p></p> <p>DMA\uff1a</p> <ul> <li>\u901a\u8fc7DMA\u63a7\u5236\u5668\u76f4\u63a5\u8fdb\u884c\u6279\u91cf\u6570\u636e\u4ea4\u6362\uff0c\u9664\u4e86\u5728\u6570\u636e\u4f20\u8f93\u5f00\u59cb\u548c\u7ed3\u675f\u65f6\uff0c\u6574\u4e2a\u8fc7\u7a0b\u65e0\u987bCPU\u7684\u5e72\u9884\uff1b</li> </ul> <p></p>"},{"location":"cs/cs_os.html#_20","title":"\u6587\u4ef6\u5b58\u50a8\u7ba1\u7406","text":""},{"location":"cs/cs_os.html#_21","title":"\u7d22\u5f15\u89c6\u56fe","text":""},{"location":"cs/cs_os.html#_22","title":"\u4f4d\u89c6\u56fe","text":"<p>\u8be5\u65b9\u6cd5\u662f\u5728\u5916\u5b58\u4e0a\u5efa\u7acb\u4e00\u5f20\u4f4d\u793a\u56fe\uff08Bitmap\uff09\uff0c\u8bb0\u5f55\u6587\u4ef6\u5b58\u50a8\u5668\u7684\u4f7f\u7528\u60c5\u51b5\u3002\u6bcf\u4e00\u4f4d\u4ec5\u5bf9\u5e94\u6587\u4ef6\u5b58\u50a8\u5668\u4e0a\u7684\u4e00\u4e2a\u7269\u7406\u5757\uff0c\u53d6\u503c0 \u548c1 \u5206\u522b\u8868\u793a\u7a7a\u95f2\u548c\u5360\u7528\u3002</p> <p></p>"},{"location":"cs/cs_os.html#_23","title":"\u5185\u6838\u6001\u548c\u7528\u6237\u6001","text":"<p>\u5185\u6838\u6001\uff1a\u63a7\u5236\u8ba1\u7b97\u673a\u7684\u786c\u4ef6\u8d44\u6e90\uff0c\u5e76\u63d0\u4f9b\u4e0a\u5c42\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u7684\u73af\u5883\u3002\u6bd4\u5982socket I/O\u64cd\u4f5c\u6216\u8005\u6587\u4ef6\u7684\u8bfb\u5199\u64cd\u4f5c\u7b49</p> <p>\u7528\u6237\u6001\uff1a\u4e0a\u5c42\u5e94\u7528\u7a0b\u5e8f\u7684\u6d3b\u52a8\u7a7a\u95f4\uff0c\u5e94\u7528\u7a0b\u5e8f\u7684\u6267\u884c\u5fc5\u987b\u4f9d\u6258\u4e8e\u5185\u6838\u63d0\u4f9b\u7684\u8d44\u6e90\u3002</p> <p>\u7cfb\u7edf\u8c03\u7528\uff1a\u4e3a\u4e86\u4f7f\u4e0a\u5c42\u5e94\u7528\u80fd\u591f\u8bbf\u95ee\u5230\u8fd9\u4e9b\u8d44\u6e90\uff0c\u5185\u6838\u4e3a\u4e0a\u5c42\u5e94\u7528\u63d0\u4f9b\u8bbf\u95ee\u7684\u63a5\u53e3\u3002</p> <p>Intel X86 CPU \u6709\u56db\u79cd\u4e0d\u540c\u6267\u884c\u7ea7\u522b0\u52303\uff0cLinux\u75280\u548c3\u5206\u522b\u8868\u793a\u5185\u6838\u6001\u548c\u7528\u6237\u6001\u3002</p>"},{"location":"cs/cs_os.html#_24","title":"\u7f13\u51b2\u533a","text":"<ul> <li>\u7528\u6237\u7f13\u51b2\u533a\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u51cf\u5c11\u7cfb\u7edf\u8c03\u7528\u6b21\u6570\uff0c\u4ece\u800c\u964d\u4f4e\u64cd\u4f5c\u7cfb\u7edf\u5728\u7528\u6237\u6001\u4e0e\u6838\u5fc3\u6001\u5207\u6362\u6240\u8017\u8d39\u7684\u65f6\u95f4\uff1b</li> <li>\u6bd4\u5982 Java \u4e2d\u7684 BufferedReader\uff0c\u7528\u6237\u7a7a\u95f4\u7684\u7f13\u5b58\uff1b</li> <li>\u5185\u6838\u7f13\u51b2\u533a\uff0c\u662f\u4e3a\u4e86\u5728OS\u7ea7\u522b\uff0c\u63d0\u9ad8\u78c1\u76d8IO\u6548\u7387\uff0c\u4f18\u5316\u78c1\u76d8\u5199\u64cd\u4f5c\uff1b</li> <li>\u8bfb\u5199\u6587\u4ef6\u65f6\u7684\u5185\u5b58\u7f13\u51b2\u533a\uff0c\u7b49\u5230\u4e00\u5b9a\u65f6\u95f4\u6216\u6570\u636e\u89c4\u6a21\u540e\uff0c\u518d\u5199\u5165\u78c1\u76d8\u3002</li> </ul>"},{"location":"cs/cs_os.html#io","title":"I/O","text":""},{"location":"cs/cs_os.html#_25","title":"\u540c\u6b65\u3001\u5f02\u6b65\u3001\u963b\u585e\u3001\u975e\u963b\u585e","text":"<ul> <li> <p>\u540c\u6b65\uff1a\u4e0d\u7ba1\u662fBIO/NIO/IO\u591a\u8def\u590d\u7528\uff0c\u4ece\u5185\u6838\u7f13\u5b58\u5199\u5165\u7528\u6237\u7f13\u5b58\u4e00\u5b9a\u662f\u7531\u7528\u6237\u7ebf\u7a0b\u81ea\u884c\u8bfb\u53d6\u6570\u636e\uff0c\u5904\u7406\u6570\u636e</p> </li> <li> <p>\u5f02\u6b65\uff1a\u6570\u636e\u662f\u5185\u6838\u5199\u5165\u7684\uff0c\u5e76\u653e\u5728\u4e86\u7528\u6237\u7ebf\u7a0b\u6307\u5b9a\u7684\u7f13\u5b58\u533a\uff0c\u5199\u5165\u5b8c\u6bd5\u540e\u901a\u77e5\u7528\u6237\u7ebf\u7a0b</p> </li> <li>\u963b\u585e\uff1a\u6570\u636e\u4ece\u7f51\u53e3\u5199\u5230\u5185\u6838,\u5982\u679c\u6ca1\u5199\u597d,\u7ebf\u7a0b\u5c31\u4e00\u76f4\u5728\u7b49\u5f85</li> <li>\u975e\u963b\u585e\uff1a\u6570\u636e\u4ece\u7f51\u53e3\u5199\u5230\u5185\u6838,\u7528\u4e00\u4e2a\u7ebf\u7a0b\u8f6e\u8be2\u7684\u53bb\u67e5\u770b\u6240\u6709\u7684\u6570\u636e\u662f\u5426\u51c6\u5907\u597d(I/O\u591a\u8def\u590d\u7528,\u76d1\u542c\u591a\u4e2asocket)</li> </ul> <p>IO\u5206\u7c7b</p> <ul> <li>BIO:\u540c\u6b65\u963b\u585eIO,\u4e00\u4e2a\u5ba2\u6237\u7aef\u8fde\u63a5\uff0c\u5bf9\u5e94\u4e00\u4e2a\u670d\u52a1\u7aef\u7ebf\u7a0b</li> <li>BIO\u8fd8\u6709\u4e00\u79cd\u53d8\u79cd,\u4f2a\u5f02\u6b65IO,\u5f53\u6709\u65b0\u7684\u5ba2\u6237\u7aef\u63a5\u5165\u65f6\uff0c\u5c06\u5ba2\u6237\u7aef\u7684socket\u5c01\u88c5\u6210\u4e00\u4e2atask\uff0c\u4e22\u5230\u7ebf\u7a0b\u6c60\u4e2d\u5904\u7406\u3002\u4f18\u5316\u4e86\u540e\u7eed\u5904\u7406\u7ebf\u7a0b\u7684\u65b9\u5f0f</li> <li>NIO\uff1a \u540c\u6b65\u975e\u963b\u585eIO</li> <li>AIO:\uff1a\u5f02\u6b65\u975e\u963b\u585eIO(\u5f02\u6b65\u4e00\u5b9a\u662f\u975e\u963b\u585e)</li> </ul>"},{"location":"cs/cs_os.html#io_1","title":"I/O\u591a\u8def\u590d\u7528","text":"<p>select\uff1a\u77e5\u9053\u4e86\u6709I/O\u4e8b\u4ef6\u53d1\u751f\u4e86\uff0c\u5374\u5e76\u4e0d\u77e5\u9053\u662f\u54ea\u90a3\u51e0\u4e2a\u6d41\uff08\u53ef\u80fd\u6709\u4e00\u4e2a\uff0c\u591a\u4e2a\uff0c\u751a\u81f3\u5168\u90e8\uff09\uff0c\u53ea\u80fd\u65e0\u5dee\u522b\u8f6e\u8be2\u6240\u6709\u6d41(O(n))\uff0c\u627e\u51fa\u80fd\u8bfb\u51fa\u6570\u636e\u6216\u8005\u5199\u5165\u6570\u636e\u7684\u6d41\uff0c\u518d\u8fdb\u884c\u64cd\u4f5c\uff1b</p> <p>poll\uff1a\u672c\u8d28\u4e0a\u548cselect\u6ca1\u6709\u533a\u522b\uff0c\u5b83\u5c06\u7528\u6237\u4f20\u5165\u7684\u6570\u7ec4\u62f7\u8d1d\u5230\u5185\u6838\u7a7a\u95f4\uff0c\u7136\u540e\u67e5\u8be2\u6bcf\u4e2afd\u5bf9\u5e94\u7684\u8bbe\u5907\u72b6\u6001\uff0c \u4f46\u662f\u5b83\u6ca1\u6709\u6700\u5927\u8fde\u63a5\u6570\u7684\u9650\u5236\uff0c\u539f\u56e0\u662f\u5b83\u662f\u57fa\u4e8e\u94fe\u8868\u6765\u5b58\u50a8\u7684</p> <p>epoll(Linux\u5185\u6838\u6240\u7279\u6709)\uff1a\u53ef\u4ee5\u7406\u89e3\u4e3aevent poll\uff0c\u4e0d\u540c\u4e8e\u5fd9\u8f6e\u8be2\u548c\u65e0\u5dee\u522b\u8f6e\u8be2\uff0cepoll\u4f1a\u628a\u54ea\u4e2a\u6d41\u53d1\u751f\u4e86\u600e\u6837\u7684I/O\u4e8b\u4ef6\u901a\u77e5\u6211\u4eec\uff08O(1)\uff09\u3002epoll\u5b9e\u9645\u4e0a\u662f\u4e8b\u4ef6\u9a71\u52a8\uff08\u6bcf\u4e2a\u4e8b\u4ef6\u5173\u8054\u4e0afd\uff09\uff1b</p> <p>\u6ce8\u610f\uff1a\u8868\u9762\u4e0a\u770bepoll\u7684\u6027\u80fd\u6700\u597d\uff0c\u4f46\u662f\u5728\u8fde\u63a5\u6570\u5c11\u5e76\u4e14\u8fde\u63a5\u90fd\u5341\u5206\u6d3b\u8dc3\u7684\u60c5\u51b5\u4e0b\uff0cselect\u548cpoll\u7684\u6027\u80fd\u53ef\u80fd\u6bd4epoll\u597d\uff0c\u6bd5\u7adfepoll\u7684\u901a\u77e5\u673a\u5236\u9700\u8981\u5f88\u591a\u51fd\u6570\u56de\u8c03\uff1b</p>"},{"location":"cs/cs_os.html#_26","title":"\u9501\u9875\u5185\u5b58","text":"<p>\u8bbe\u5907\u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u5185\u5b58\u8bbf\u95ee\uff08direct memory access\uff0cDMA\uff09\u65b9\u5f0f\u6765\u8bbf\u95ee\u4e3b\u673a\u7684\u9501\u9875\u5185\u5b58\u3002 </p> <p>\u9501\u9875\u5c31\u662f\u5c06\u5185\u5b58\u9875\u9762\u6807\u8bb0\u4e3a\u4e0d\u53ef\u88ab\u64cd\u4f5c\u7cfb\u7edf\u6362\u51fa\u7684\u5185\u5b58\u3002\u6240\u4ee5\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u7ed9\u8fd9\u4e9b\u5916\u8bbe\u7f16\u7a0b\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u9875\u9762\u7684\u7269\u7406\u5730\u5740\u76f4\u63a5\u8bbf\u95ee\u5185\u5b58\uff08DMA\uff09\uff0c\u4ece\u800c\u907f\u514d\u4ece\u5916\u5b58\u5230\u5185\u5b58\u7684\u590d\u5236\u64cd\u4f5c\u3002</p> <ul> <li>\u9501\u9875\u5185\u5b58\u548cGPU\u5185\u5b58\u4e4b\u95f4\u7684\u62f7\u8d1d\u53ef\u4ee5\u548c\u5185\u6838\u7a0b\u5e8f\u540c\u65f6\u6267\u884c\uff0c\u4e5f\u5c31\u662f\u5f02\u6b65\u5e76\u53d1\u6267\u884c\uff1b</li> </ul>"},{"location":"cs/network/index.html","title":"\u57fa\u7840","text":"<p>127.0.0.1\u7684\u672c\u673a\u7f51\u8def\u4e0d\u8d70\u7f51\u5361\uff0c\u4f46\u5176\u5b83\u6d41\u7a0b\u5982\u5185\u6838\u534f\u8bae\u6808\u8fd8\u5f97\u8d70\u3002</p> <ul> <li>\u534f\u8bae\u6808 -&gt; \u7f51\u7edc\u8bbe\u5907\u5b50\u7cfb\u7edf-&gt; \u9a71\u52a8\u7a0b\u5e8f -&gt; \u8f6f\u4e2d\u65ad -&gt; \u9a71\u52a8\u7a0b\u5e8f\uff1b</li> </ul> <p>\u7528\u672c\u673aIP\u8ddf 127.0.0.1 \u6027\u80fd\u4e0a\u6ca1\u6709\u5dee\u5f02\uff0c\u8d70\u865a\u62df\u7684\u73af\u56de\u8bbe\u5907lo\u3002</p> <p>BPF\uff1aBerkeley Packet Filter\uff0c\u662f\u7c7bUnix\u7cfb\u7edf\u4e0a\u6570\u636e\u94fe\u8def\u7684\u539f\u59cb\u63a5\u53e3\uff0c\u63d0\u4f9b\u539f\u59cb\u94fe\u8def\u5c42\u5c01\u5305\u7684\u8f6c\u53d1\u3002</p> <p>eBPF\uff1aExtended BPF\uff0clinux 3.18\u7248\u672c\u540e\u5f15\u8fdb\uff0c\u901a\u7528\u6267\u884c\u5f15\u64ce\uff0c\u63d0\u4f9b\u53ef\u57fa\u4e8e\u7cfb\u7edf\u6216\u7a0b\u5e8f\u4e8b\u4ef6\u9ad8\u6548\u5b89\u5168\u6267\u884c\u7279\u5b9a\u4ee3\u7801\u7684\u901a\u7528\u80fd\u529b\u3002</p> <ul> <li>\u89c2\u6d4b\uff08\u8ddf\u8e2a\uff0c\u6027\u80fd\u8c03\u4f18\uff09\u3001\u5b89\u5168\u548c\u7f51\u7edc\u7b49\u65b9\u9762\uff1b</li> </ul> <p>\u4e1a\u754c\u57fa\u4e8eebpf\u7684sockmap\u548csk redirect\u529f\u80fd\u7814\u53d1sockops\u7ec4\u4ef6\uff0c\u52a0\u901f istio \u67b6\u6784\u4e2d sidecar \u4ee3\u7406\u548c\u672c\u5730\u8fdb\u7a0b\u4e4b\u95f4\u7684\u901a\u4fe1\u3002</p> <ul> <li>\u907f\u514d\u5185\u6838\u534f\u8bae\u6808\u7684\u5f00\u9500</li> </ul>"},{"location":"cs/network/index.html#_2","title":"\u901a\u4fe1\u53c2\u8003\u6a21\u578b","text":"<p>OSI\u4e03\u5c42\u6a21\u578b\uff1a\u4e94\u5c42\u6a21\u578b\u662f\u5c06\uff08\u4f1a\u8bdd/\u8868\u793a/\u5e94\u7528\u5f53\u4f5c\u4e00\u4e2a\u5e94\u7528\u5c42\uff09\uff0cTCP/IP\u4f53\u7cfb</p> <ul> <li>\u7269\u7406\u5c42\uff1a\u6bd4\u7279\uff0c\u6570\u6a21\u8f6c\u6362\u4e0e\u6a21\u6570\u8f6c\u6362\uff0c\u4f20\u8f93\u6bd4\u7279\u6d41\uff080/1\u8f6c\u5316\u4e3a\u7535\u6d41\u5f3a\u5f31\u4f20\u8f93\uff0c\u76ee\u7684\u5730\u518d\u8f6c\u5316\u4e3a0/1\uff09</li> <li>\u6570\u636e\u94fe\u8def\u5c42\uff1a\u5e27\uff0c\u6839\u636eMAC\u5730\u5740\u8fdb\u884c\u8f6c\u53d1\uff1b</li> <li>MAC \u5730\u5740\u867d\u7136\u552f\u4e00\uff0c\u4f46\u5728\u4e16\u754c\u8303\u56f4\u5185\u4e0d\u80fd\u901a\u8fc7\u5e7f\u64ad\u7684\u5f62\u5f0f\uff0c\u627e\u5230\u76ee\u6807MAC\u5730\u5740\u8ba1\u7b97\u673a\u800c\u4e0d\u8d85\u65f6\uff1b</li> <li>\u7f51\u7edc\u5c42\uff1aIP\uff0c\u5e38\u89c1\u7684\u534f\u8bae\u6709 IP, ICMP, IGMP, ARP, RARP\u7b49\uff1b</li> <li>\u4f20\u8f93\u5c42\uff1a\u7aef\u53e3\uff0cTCP/UDP\u534f\u8bae\uff1b</li> <li>\u4f1a\u8bdd\u5c42/\u8868\u793a\u5c42/\u5e94\u7528\u5c42\uff1a\u5982 HTTP, SMTP, FTP, DNS \u7b49\uff1b</li> </ul>"},{"location":"cs/network/index.html#_3","title":"\u5176\u5b83","text":""},{"location":"cs/network/index.html#ieee-8021xmac","title":"IEEE 802.1x\uff08MAC\u5730\u5740\u8ba4\u8bc1\u534f\u8bae\uff09","text":"<p>\u7f51\u7edc\u8bbf\u95ee\u63a7\u5236\u534f\u8bae\uff0c\u5b9a\u4e49\u4e86\u5728\u5c40\u57df\u7f51\uff08LAN\uff09\u548c\u5e7f\u57df\u7f51\uff08WAN\uff09\u4e0a\u8fdb\u884c\u7f51\u7edc\u8ba4\u8bc1\u548c\u6388\u6743\u7684\u6807\u51c6\u65b9\u5f0f\u3002</p> <p>\u5de5\u4f5c\u5728\u6570\u636e\u94fe\u8def\u5c42\uff08\u7b2c2\u5c42\uff09\u534f\u8bae\u4e0a\uff0c\u7f51\u7edc\u7ba1\u7406\u5458\u53ef\u4ee5\u63a7\u5236\u8c01\u53ef\u4ee5\u8bbf\u95ee\u7f51\u7edc\u3001\u4f55\u65f6\u53ef\u4ee5\u8bbf\u95ee\u7f51\u7edc\u4ee5\u53ca\u8bbf\u95ee\u7f51\u7edc\u7684\u6743\u9650\u7b49</p>"},{"location":"cs/network/LVS.html","title":"Linux Virtual Server","text":"<p>LVS\u7684\u6a21\u578b\u4e2d\u6709\u4e24\u4e2a\u89d2\u8272\uff1a</p> <ul> <li>\u8c03\u5ea6\u5668\uff1aDirector\uff0c\u53c8\u79f0\u4e3aDispatcher\uff0cBalancer</li> <li> <p>\u8c03\u5ea6\u5668\u4e3b\u8981\u7528\u4e8e\u63a5\u53d7\u7528\u6237\u8bf7\u6c42\u3002</p> </li> <li> <p>\u771f\u5b9e\u4e3b\u673a:Real Server\uff0c\u7b80\u79f0\u4e3aRS\u3002</p> </li> <li>\u7528\u4e8e\u771f\u6b63\u5904\u7406\u7528\u6237\u7684\u8bf7\u6c42\u3002</li> </ul> <p>Director Virtual IP\uff1a</p> <ul> <li>\u8c03\u5ea6\u5668\u7528\u4e8e\u4e0e\u5ba2\u6237\u7aef\u901a\u4fe1\u7684IP\u5730\u5740\uff0c\u7b80\u79f0\u4e3a VIP</li> </ul> <p>Director IP\uff1a</p> <ul> <li>\u8c03\u5ea6\u5668\u7528\u4e8e\u4e0eRealServer\u901a\u4fe1\u7684IP\u5730\u5740\uff0c\u7b80\u79f0\u4e3aDIP\u3002</li> </ul> <p>Real Server \uff1a</p> <ul> <li>\u540e\u7aef\u4e3b\u673a\u7684\u7528\u4e8e\u4e0e\u8c03\u5ea6\u5668\u901a\u4fe1\u7684IP\u5730\u5740\uff0c\u7b80\u79f0\u4e3aRIP\u3002</li> </ul>"},{"location":"cs/network/LVS.html#vsnat","title":"VS/NAT\u6280\u672f","text":"<p>Virtual Server via Network Address Translation</p> <p>\u901a\u8fc7\u7f51\u7edc\u5730\u5740\u8f6c\u6362\uff08Network Address Translation\uff09\u5c06\u4e00\u7ec4\u670d\u52a1\u5668\u6784\u6210\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684\u3001\u9ad8\u53ef\u7528\u7684\u865a\u62df\u670d\u52a1\u5668\uff1b</p> <p></p> <p>\u4f18\u70b9\uff1a  </p> <ul> <li>\u652f\u6301\u7aef\u53e3\u6620\u5c04\uff0cRS\u53ef\u4ee5\u4f7f\u7528\u4efb\u610f\u64cd\u4f5c\u7cfb\u7edf\uff0c\u8282\u7701\u516c\u6709IP\u5730\u5740\uff1b</li> <li>RIP\u548cDIP\u90fd\u5e94\u8be5\u4f7f\u7528\u540c\u4e00\u7f51\u6bb5\u79c1\u6709\u5730\u5740\uff0c\u800c\u4e14RS\u7684\u7f51\u5173\u8981\u6307\u5411DIP\uff1b</li> <li>\u4f7f\u7528nat\u53e6\u5916\u4e00\u4e2a\u597d\u5904\u5c31\u662f\u540e\u7aef\u7684\u4e3b\u673a\u76f8\u5bf9\u6bd4\u8f83\u5b89\u5168\u3002   </li> </ul> <p>\u7f3a\u70b9\uff1a  </p> <ul> <li>\u8bf7\u6c42\u548c\u54cd\u5e94\u62a5\u6587\u90fd\u8981\u7ecf\u8fc7Director\u8f6c\u53d1\uff0c\u6781\u9ad8\u8d1f\u8f7d\u65f6\uff0cDirector\u53ef\u80fd\u6210\u4e3a\u7cfb\u7edf\u74f6\u9888\u3002  </li> </ul>"},{"location":"cs/network/LVS.html#vstun","title":"VS/TUN","text":"<p>Virtual Server via IP Tunneling\uff1aIP\u96a7\u9053\u5b9e\u73b0\u865a\u62df\u670d\u52a1\u5668\u7684\u65b9\u6cd5\uff1b</p> <p>IP\u96a7\u9053\uff08IP tunneling\uff09\u662f\u5c06\u4e00\u4e2aIP\u62a5\u6587\u5c01\u88c5\u5728\u53e6\u4e00\u4e2aIP\u62a5\u6587\u7684\u6280\u672f\uff1b</p> <ul> <li>RealServer\u5219\u4f1a\u4f7f\u7528lo\u63a5\u53e3\u4e0a\u7684VIP\u76f4\u63a5\u54cd\u5e94CIP\uff1b</li> <li>VS/TUN\u6280\u672f\u5bf9\u670d\u52a1\u5668\u6709\u8981\u6c42\uff0c\u5373\u6240\u6709\u7684\u670d\u52a1\u5668\u5fc5\u987b\u652f\u6301\u201cIP Tunneling\u201d\u6216\u8005\u201cIP Encapsulation\u201d\u534f\u8bae\uff1b</li> </ul> <p></p> <p>\u4f18\u70b9\uff1a  </p> <ul> <li>RIP\uff0cVIP\uff0cDIP\u90fd\u5e94\u8be5\u4f7f\u7528\u516c\u7f51\u5730\u5740\uff0c\u4e14RS\u7f51\u5173\u4e0d\u6307\u5411DIP;</li> <li>\u53ea\u63a5\u53d7\u8fdb\u7ad9\u8bf7\u6c42\uff0c\u89e3\u51b3\u4e86LVS-NAT\u65f6\u7684\u95ee\u9898\uff0c\u51cf\u5c11\u8d1f\u8f7d\u3002  </li> <li>\u8bf7\u6c42\u62a5\u6587\u7ecf\u7531Director\u8c03\u5ea6\uff0c\u4f46\u662f\u54cd\u5e94\u62a5\u6587\u4e0d\u9700\u7ecf\u7531Director\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a  </p> <ul> <li>\u4e0d\u6307\u5411Director\u6240\u4ee5\u4e0d\u652f\u6301\u7aef\u53e3\u6620\u5c04\u3002 </li> <li>RS\u7684OS\u5fc5\u987b\u652f\u6301\u96a7\u9053\u529f\u80fd\u3002 </li> <li>\u96a7\u9053\u6280\u672f\u4f1a\u989d\u5916\u82b1\u8d39\u6027\u80fd\uff0c\u589e\u5927\u5f00\u9500\u3002</li> </ul>"},{"location":"cs/network/LVS.html#vsdr","title":"VS/DR","text":"<p>Virtual Server via Direct Routing\uff1a\u901a\u8fc7\u76f4\u63a5\u8def\u7531\u5b9e\u73b0\u865a\u62df\u670d\u52a1\u5668\u7684\u65b9\u6cd5\uff1b</p> <ul> <li>\u76ee\u6807\u5730\u5740\u7684MAC\u5730\u5740\u6539\u4e3aRealServer\u7684MAC\u5730\u5740\u3002</li> <li>RealServer\u63a5\u53d7\u5230\u8f6c\u53d1\u800c\u6765\u7684\u8bf7\u6c42\uff0c\u53d1\u73b0\u76ee\u6807\u5730\u5740\u662fVIP\u3002RealServer\u914d\u7f6e\u5728lo\u63a5\u53e3\u4e0a\u3002</li> <li>\u5904\u7406\u8bf7\u6c42\u4e4b\u540e\u5219\u4f7f\u7528lo\u63a5\u53e3\u4e0a\u7684VIP\u54cd\u5e94CIP\u3002</li> </ul> <p></p> <p>\u4f18\u70b9\uff1a </p> <ul> <li>RIP\u53ef\u4ee5\u4f7f\u7528\u79c1\u6709\u5730\u5740\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u516c\u7f51\u5730\u5740\uff1b</li> <li>\u53ea\u8981\u6c42DIP\u548cRIP\u7684\u5730\u5740\u5728\u540c\u4e00\u4e2a\u7f51\u6bb5\u5185\uff1b</li> <li>\u8bf7\u6c42\u62a5\u6587\u7ecf\u7531Director\u8c03\u5ea6\uff0c\u4f46\u662f\u54cd\u5e94\u62a5\u6587\u4e0d\u7ecf\u7531Director\uff1b</li> <li>RS\u53ef\u4ee5\u4f7f\u7528\u5927\u591a\u6570OS\u3002</li> </ul> <p>\u7f3a\u70b9\uff1a  </p> <ul> <li>\u4e0d\u652f\u6301\u7aef\u53e3\u6620\u5c04\uff0cDirector\u4e0d\u80fd\u66f4\u6539\u8bf7\u6c42\u62a5\u6587\u7684\u7aef\u53e3\uff1b</li> <li>\u4e0d\u80fd\u8de8\u5c40\u57df\u7f51\u3002</li> </ul>"},{"location":"cs/network/LVS.html#_1","title":"\u4e3b\u5907","text":"<p>LVS\u7684\u5bb9\u707e\u53ef\u4ee5\u901a\u8fc7\u4e3b\u5907+\u5fc3\u8df3\u7684\u65b9\u5f0f\u5b9e\u73b0\u3002\u4e3bLVS\u5931\u53bb\u5fc3\u8df3\u540e\uff0c\u5907LVS\u53ef\u4ee5\u4f5c\u4e3a\u70ed\u5907\u7acb\u5373\u66ff\u6362\u3002</p> <p>\u5bb9\u707e\u4e3b\u8981\u662f\u9760KeepAlived\u6765\u505a\u7684\u3002</p>"},{"location":"cs/network/LVS.html#ipvsadm","title":"ipvsadm","text":"<p>ipvsadm -A -t     192.168.2.211:80 -s rr </p> <p>ipvsadm -a -t 192.168.2.211:80 -r 192.168.2.203 -g</p> <p>ipvsadm -a -t 192.168.2.211:80 -r 192.168.2.204 -g</p>"},{"location":"cs/network/LVS.html#realserver","title":"RealServer","text":"<p>\u6539RealServer\u5185\u6838\u53c2\u6570</p> <p>echo \"1\" &gt; /proc/sys/net/ipv4/ip_forward</p> <p>echo \"2\" &gt; /proc/sys/net/ipv4/conf/all/arp_announce</p> <p>echo \"1\" &gt; /proc/sys/net/ipv4/conf/all/arp_ignore</p> <p>echo \"1\" &gt; /proc/sys/net/ipv4/conf/lo/arp_ignore</p> <p>echo \"2\" &gt; /proc/sys/net/ipv4/conf/lo/arp_announce</p> <p>ifconfig lo:0 192.168.2.211/32 broadcast 192.168.2.211 up</p> <p>route add -host 192.168.2.211 dev lo:0</p> <p>\u4fee\u6539\u5185\u6838\u53c2\u6570\uff0c\u5e76\u4e14\u914d\u7f6eVIP\u5730\u5740\u5230RealServer\u7684loopback\u63a5\u53e3\u4e0a\u3002</p> <p>\u90a3\u6837\u7684\u8bdd\uff0c\u5f53RealServer\u63a5\u5230\u4eceDirector\u8f6c\u53d1\u800c\u6765\u7684\u6570\u636e\u62a5\u6587\u65f6\uff0cRealServer\u4e5f\u4e0d\u4f1a\u4e22\u5f03\u62a5\u6587\u3002</p> <p>\u540c\u65f6\uff0c\u4fee\u6539\u4e86RealServer\u7684\u53c2\u6570\uff0c\u5c40\u57df\u7f51\u5185\u7684arp\u8868\u5c31\u53ea\u6709Director\u6709VIP\u3002</p> <p>RealServer\u7684\u7684\u673a\u5668\u4e0a\u6709VIP\u8fd9\u4ef6\u4e8b\uff0c\u53ea\u6709RealServer\u81ea\u5df1\u77e5\u9053\u3002</p> <p>\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\uff0c\u5f53\u8bf7\u6c42\u5230\u6765\u7684\u65f6\u5019\uff0c\u7b2c\u4e00\u4e2a\u4f1a\u9001\u5230Director\u90a3\u91cc\u53bb\u3002</p>"},{"location":"cs/network/http.html","title":"HTTP","text":"<p>HTTP\uff1aHyper Text Transfer Protocol </p> <p>Header</p> <ul> <li>\u7a7a\u683c\u7f16\u7801\u662f<code>%20</code>\uff0c\u4f46\u662fapplication/x-www-form-urlencoded\u5a92\u4f53\u7c7b\u578b\u4f1a\u5c06\u7a7a\u683c\u7f16\u7801\u4e3a<code>+</code>\u53f7\uff1b</li> </ul>"},{"location":"cs/network/http.html#https","title":"HTTPS","text":"<p>HTTPS\uff1aHTTP over Secure Socket Layer</p> <ul> <li>HTTP\u4e0b\u52a0\u5165SSL\u5c42\uff0c\u4e00\u4e2a\u52a0\u5bc6/\u8eab\u4efd\u9a8c\u8bc1\u5c42\uff08\u5728HTTP\u4e0eTCP\u4e4b\u95f4\uff09\uff0c\u7aef\u53e3443\uff1b</li> <li>SSL(Secure Sockets Layer \u5b89\u5168\u5957\u63a5\u5c42)\u53ca\u5176\u7ee7\u4efb\u8005\u4f20\u8f93\u5c42\u5b89\u5168(Transport Layer Security\uff0cTLS)\u662f\u4e3a\u7f51\u7edc\u901a\u4fe1\u63d0\u4f9b\u5b89\u5168\u53ca\u6570\u636e\u5b8c\u6574\u6027\u7684\u4e00\u79cd\u5b89\u5168\u534f\u8bae\uff1b</li> <li>\u91c7\u7528https\u7684\u670d\u52a1\u5668\u5fc5\u987b\u4eceCA\uff08Certificate Authority\uff09\u7533\u8bf7\u4e00\u4e2a\u7528\u4e8e\u8bc1\u660e\u670d\u52a1\u5668\u7528\u9014\u7c7b\u578b\u7684\u8bc1\u4e66\u3002\u8be5\u8bc1\u4e66\u53ea\u6709\u7528\u4e8e\u5bf9\u5e94\u7684\u670d\u52a1\u5668\u7684\u65f6\u5019\uff0c\u5ba2\u6237\u7aef\u624d\u4fe1\u4efb\u6b64\u4e3b\u673a\u3002</li> <li>HTTPS\u7684\u6027\u80fd\u4f18\u5316\uff1ahttp://mp.weixin.qq.com/s/V62VYS8KFNKxJxfzMYefrw</li> </ul>"},{"location":"cs/network/http.html#http1x","title":"HTTP/1.x","text":"<p>\u6587\u672c\u534f\u8bae\u3002</p> <p>\u89e3\u6790\uff1aHTTP header \u5404\u4e2a fields \u4f7f\u7528 <code>\\r\\n</code> \u5206\u9694\uff0c\u7136\u540e\u8ddf body \u4e4b\u95f4\u4f7f\u7528 <code>\\r\\n\\r\\n</code> \u5206\u9694\u3002\u89e3\u6790\u5b8c header \u4e4b\u540e\uff0c\u6211\u4eec\u624d\u80fd\u4ece header \u91cc\u9762\u7684 <code>content-length</code> \u62ff\u5230 body \u7684 size\uff0c\u4ece\u800c\u8bfb\u53d6 body\u3002\u6574\u4e2a\u6d41\u7a0b\u5e76\u4e0d\u9ad8\u6548\u3002</p> <p>\u4ea4\u4e92\uff1a\u4e00\u4e2a\u8fde\u63a5\u6bcf\u6b21\u53ea\u80fd\u4e00\u95ee\u4e00\u7b54\u3002client\u9700\u8981\u8ddfserver\u5efa\u7acb\u591a\u6761\u8fde\u63a5\u3002</p> <p>\u63a8\u9001\uff1aHTTP/1.x\u6ca1\u6709\u63a8\u9001\u673a\u5236\uff0c\u4e00\u822c\u91c7\u7528 \u8f6e\u8be2 \u6216\u8005 Web-socket\u65b9\u5f0f\u3002</p>"},{"location":"cs/network/http.html#http2","title":"HTTP/2","text":"<p>\u4e8c\u8fdb\u5236\u534f\u8bae\u3002</p> <ul> <li>Stream : \u4e00\u4e2a\u53cc\u5411\u6d41\uff0c\u4e00\u6761\u8fde\u63a5\u53ef\u4ee5\u6709\u591a\u4e2astreams\uff1b</li> <li>Message : \u7b49\u4ef7\u4e8erequest\u548cresponse\uff1b</li> <li>Frame : \u6570\u636e\u4f20\u8f93\u7684\u6700\u5c0f\u5355\u4f4d\u3002\u6bcf\u4e2aFrame\u90fd\u5c5e\u4e8e\u4e00\u4e2a\u7279\u5b9a\u7684stream\u6216\u8005\u6574\u4e2a\u8fde\u63a5\u3002\u4e00\u4e2amessage\u53ef\u80fd\u7531\u591a\u4e2aframe\u7ec4\u6210\u3002</li> </ul>"},{"location":"cs/network/http.html#frame","title":"Frame\u683c\u5f0f","text":"<p>\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>+-----------------------------------------------+\n|                 Length (24)                   |\n+---------------+---------------+---------------+\n|   Type (8)    |   Flags (8)   |\n+-+-------------+---------------+-------------------------------+\n|R|                 Stream Identifier (31)                      |\n+=+=============================================================+\n|                   Frame Payload (0...)                      ...\n+---------------------------------------------------------------+\n</code></pre> <p>Length : Frame\u7684\u957f\u5ea6\uff0c\u9ed8\u8ba4\u6700\u5927\u957f\u5ea6\u662f16KB\uff0c\u53ef\u4ee5\u663e\u793a\u8bbe\u7f6emax frame size\uff1b</p> <p>Type : Frame\u7c7b\u578b\uff0c\u5982DATA, HEADERS, PRIORITY\u7b49\uff1b</p> <p>Flag, R : \u4fdd\u7559\u4f4d\uff1b</p> <p>Stream Identifier : \u6807\u5fd7\u6240\u5c5e\u7684stream\uff0c\u5982\u679c\u4e3a0\uff0c\u5219\u8868\u793a\u8fd9\u4e2aframe\u5c5e\u4e8e\u6574\u6761\u8fde\u63a5\uff1b </p> <p>Frame Payload : \u4e0d\u540cType\u6709\u4e0d\u540c\u683c\u5f0f\u3002</p>"},{"location":"cs/network/http.html#_1","title":"\u591a\u8def\u590d\u7528","text":"<p>HTTP/2\u7684\u901a\u8fc7stream\u652f\u6301\u8fde\u63a5\u7684\u591a\u8def\u590d\u7528\uff0c\u63d0\u9ad8\u8fde\u63a5\u5229\u7528\u7387\u3002Stream\u7684\u91cd\u8981\u7279\u6027\uff1a</p> <ul> <li>\u4e00\u6761\u8fde\u63a5\u53ef\u4ee5\u5305\u542b\u591a\u4e2astreams\uff0c\u591a\u4e2astreams\u53d1\u9001\u7684\u6570\u636e\u4e92\u76f8\u4e0d\u5f71\u54cd\uff1b</li> <li>Stream\u53ef\u4ee5\u88abclient\u548cserver\u5355\u65b9\u9762\u6216\u8005\u5171\u4eab\u4f7f\u7528\uff1b</li> <li>Stream\u53ef\u4ee5\u88ab\u4efb\u610f\u4e00\u7aef\u5173\u95ed\uff1b</li> <li>Stream\u4f1a\u786e\u5b9a\u597d\u53d1\u9001frame\u7684\u987a\u5e8f\uff0c\u53e6\u4e00\u7aef\u4f1a\u6309\u7167\u63a5\u53d7\u5230\u7684\u987a\u5e8f\u6765\u5904\u7406\uff1b</li> <li>Stream\u7528\u4e00\u4e2a\u552f\u4e00ID\u6765\u6807\u8bc6\uff0cclient\u521b\u5efa\u7684\u662f\u5947\u6570\uff0cserver\u521b\u5efa\u7684\u662f\u5076\u6570\u3002</li> </ul> <p>\u63d0\u9ad8\u4e00\u4e2astream\u7684\u5e76\u53d1\uff0c\u53ef\u4ee5\u8c03\u5927MAX_CONCURRENT_STREAMS\u3002</p> <p>\u4e00\u6761\u8fde\u63a5\u901a\u5e38\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u6765\u5904\u7406\uff0c\u6240\u4ee5\u5e76\u4e0d\u80fd\u5145\u5206\u5229\u7528\u670d\u52a1\u5668\u591a\u6838\u7684\u4f18\u52bf\u3002\u540c\u65f6\uff0c\u6bcf\u4e2a\u8bf7\u6c42\u7f16\u89e3\u7801\u8fd8\u662f\u6709\u5f00\u9500\u7684\uff0c\u6240\u4ee5\u7528\u4e00\u6761\u8fde\u63a5\u8fd8\u662f\u4f1a\u51fa\u73b0\u74f6\u9888\u3002</p>"},{"location":"cs/network/http.html#_2","title":"\u6d41\u63a7","text":"<ul> <li>Flow control \u662f\u5355\u5411\u7684\u3002Receiver \u53ef\u4ee5\u9009\u62e9\u7ed9 stream \u6216\u8005\u6574\u4e2a\u8fde\u63a5\u8bbe\u7f6e window size\u3002</li> <li>Flow control \u662f\u57fa\u4e8e\u4fe1\u4efb\u7684\u3002Receiver \u53ea\u662f\u4f1a\u7ed9 sender \u5efa\u8bae\u5b83\u7684\u521d\u59cb\u8fde\u63a5\u548c stream \u7684 flow control window size\u3002</li> <li>Flow control \u4e0d\u53ef\u80fd\u88ab\u7981\u6b62\u6389\u3002\u5f53 HTTP/2 \u8fde\u63a5\u5efa\u7acb\u8d77\u6765\u4e4b\u540e\uff0cclient \u548c server \u4f1a\u4ea4\u6362 SETTINGS frames\uff0c\u7528\u6765\u8bbe\u7f6e flow control window size\u3002</li> <li>Flow control \u662f hop-by-hop\uff0c\u5e76\u4e0d\u662f end-to-end \u7684\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u4e2d\u95f4\u4eba\u6765\u8fdb\u884c flow control\u3002</li> </ul> <p>HTTP/2 \u9ed8\u8ba4\u7684 window size \u662f 64 KB\u3002</p>"},{"location":"cs/network/http.html#hpack","title":"HPACK","text":"<p>\u65e0\u9700\u53d1\u9001\u91cd\u590d\u7684Header\uff0c\u63d0\u4f9b\u9759\u6001\u548c\u52a8\u6001\u7684table\u3002</p>"},{"location":"cs/network/http.html#content-type","title":"Content-Type","text":"<p>content-type \u662f  Http Header \u4e2d\u7684\u4e00\u4e2a\u5b57\u6bb5\uff0c\u5728\u6b64\u5355\u72ec\u5217\u51fa\u3002</p>"},{"location":"cs/network/http.html#applicationoctet-stream","title":"application/octet-stream","text":"<p>\u4e8c\u8fdb\u5236\u6587\u4ef6\u6ca1\u6709\u7279\u5b9a\u6216\u5df2\u77e5\u7684 subtype\uff0c\u5373\u4f7f\u7528 <code>application/octet-stream</code></p> <ul> <li>\u6d4f\u89c8\u5668\u9488\u5bf9\u6b64\u7c7b\u578b\u7684\u54cd\u5e94\uff0c\u4f1a\u5c06\u5176\u4fdd\u5b58\u4e0b\u8f7d\u4e0b\u6765\uff08\u914d\u5408 Content-Disposition\uff09\uff1b</li> <li>\u5982\u679c\u662f\u5176\u5b83\u7684\u5ba2\u6237\u7aef\uff08\u6bd4\u5982 curl\uff0cJava\uff09\uff0c\u53ef\u4ee5\u81ea\u884c\u5904\u7406\uff1b</li> </ul>"},{"location":"cs/network/http.html#textevent-stream","title":"text/event-stream","text":"<p>\u4e0d\u5e94\u8be5\u8bbe\u7f6e WriteTimeOut</p> <p>webpack\u70ed\u66f4\u65b0\u9700\u8981\u5411\u6d4f\u89c8\u5668\u63a8\u9001\u4fe1\u606f\uff0c\u4e00\u822c\u90fd\u4f1a\u60f3\u5230websocket\uff0c\u4f46\u662f\u8fd8\u6709\u4e00\u79cd\u65b9\u5f0f\uff0c\u53eb\u505aServer-Sent Events\uff08\u7b80\u79f0SSE\uff09\u3002</p> <ul> <li>SSE\u662f websocket \u7684\u4e00\u79cd\u8f7b\u578b\u66ff\u4ee3\u65b9\u6848\uff0c\u5176\u54cd\u5e94 Type \u7c7b\u578b\u4e3a <code>text/event-stream</code>\u3002</li> </ul> sse websocket http \u534f\u8bae \u72ec\u7acb\u7684 websocket \u534f\u8bae \u8f7b\u91cf\uff0c\u4f7f\u7528\u7b80\u5355 \u76f8\u5bf9\u590d\u6742 \u9ed8\u8ba4\u652f\u6301\u65ad\u7ebf\u91cd\u8fde\uff08JS \u81ea\u5e26 EventSource\uff09 \u9700\u8981\u81ea\u5df1\u5b9e\u73b0\u65ad\u7ebf\u91cd\u8fde \u6587\u672c\u4f20\u8f93 \u4e8c\u8fdb\u5236\u4f20\u8f93 \u652f\u6301\u81ea\u5b9a\u4e49\u53d1\u9001\u7684\u6d88\u606f\u7c7b\u578b -"},{"location":"cs/network/http.html#other-headers","title":"Other Headers","text":""},{"location":"cs/network/http.html#transfer-encoding","title":"Transfer-Encoding","text":"<p>\u5f53\u5305\u4f53\u957f\u5ea6\u672a\u77e5\u6216\u8005\u6211\u4eec\u60f3\u628a\u5305\u4f53\u62c6\u6210\u51e0\u4e2a\u5c0f\u5757\u4f20\u8f93\u65f6\uff08\u6bd4\u5982\u63a8\u9001\u573a\u666f\uff09\uff0c\u5373 Content-Length \u957f\u5ea6\u672a\u77e5\u65f6\u3002</p> <p>\u5f53\u670d\u52a1\u5668\u8fd4\u56de <code>Transfer-Encoding: chunked</code> \u65f6\uff0c\u8868\u660e\u6b64\u65f6\u670d\u52a1\u5668\u4f1a\u5bf9\u8fd4\u56de\u7684\u5305\u4f53\u8fdb\u884c <code>chunked</code> \u7f16\u7801\uff0c\u6bcf\u4e2a chunk \u7684\u683c\u5f0f\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>${chunk-length}\\r\\n${chunk-data}\\r\\n\n</code></pre> <p>\u5176\u4e2d\uff0c<code>${chunk-length}</code> \u8868\u793a chunk \u7684\u5b57\u8282\u957f\u5ea6\uff0c\u4f7f\u7528 16 \u8fdb\u5236\u8868\u793a\uff0c<code>${chunk-data}</code> \u4e3a chunk \u7684\u5185\u5bb9\u3002</p> <p>\u5f53 chunk \u90fd\u4f20\u8f93\u5b8c\uff0c\u9700\u8981\u989d\u5916\u4f20\u8f93 <code>0\\r\\n\\r\\n</code> \u8868\u793a\u7ed3\u675f\u3002</p> <ul> <li>HTTP \u7684\u5305\u5df2\u7ecf\u5bf9\u8be5\u683c\u5f0f\u8fdb\u884c\u89e3\u6790\u548c\u5904\u7406\uff0c\u5e94\u7528\u7aef\u76f4\u63a5\u8bfb\u53d6 Body\uff0c\u5982\u4e0b\uff08\u5047\u8bbe\u6bcf\u4e2achunk-data\u6309 <code>\\n</code>\u5212\u5206\uff09</li> </ul> <pre><code>rep, _ := client.Get(url)\nreader := bufio.NewReader(rep.Body)\ndefer rep.Body.Close()\nfor {\n    // handle chunked data\n    data, _ := reader.ReadString('\\n')\n    log.Printf(\"receive: [%s]\", data)\n}\n</code></pre>"},{"location":"cs/network/http.html#range","title":"Range","text":"<p>\u5982\u679c\u8bf7\u6c42\u4e00\u4e2a\u8d44\u6e90\u65f6\uff0c HTTP\u54cd\u5e94\u4e2d\u51fa\u73b0\u5982\u4e0b\u6240\u793a\u7684 'Accept-Ranges'\uff0c \u4e14\u5176\u503c\u4e0d\u662fnone\uff0c \u90a3\u4e48\u670d\u52a1\u5668\u652f\u6301\u8303\u56f4\u8bf7\u6c42\u3002</p> <pre><code># Response \u7684\u54cd\u5e94\ncurl -I http://i.imgur.com/z4d4kWk.jpg\n\nHTTP/1.1 200 OK\n...\nAccept-Ranges: bytes\nContent-Length: 577454964\nContent-Range: bytes 0-577454963/577454964\n</code></pre> <p>\u5728\u5982\u4e0a\u54cd\u5e94\u4e2d\uff0cAccept-Ranges: bytes \u4ee3\u8868\u53ef\u4ee5\u4f7f\u7528\u5b57\u8282\u4f5c\u4e3a\u5355\u4f4d\u6765\u5b9a\u4e49\u8bf7\u6c42\u8303\u56f4\u3002\u8fd9\u91cc\u7684 Response Headers\u4e2d\u7684 Content-Length: 577454964\u5219\u4ee3\u8868\u8be5\u8d44\u6e90\u7684\u5927\u5c0f\u3002</p> <p>\u5728\u5904\u7406HTTP Range \u8bf7\u6c42\u65f6\uff0c\u6709\u4e09\u4e2a\u76f8\u5173\u7684\u72b6\u6001\uff1a</p> <ul> <li>206 Partial Content\u2014\u2014&gt; HTTP Range \u8bf7\u6c42\u6210\u529f</li> <li>416 Requested Range Not Satisfiable status.\u2014\u2014&gt; HTTP Range \u8bf7\u6c42\u8d85\u51fa\u754c\u9650</li> <li>200 OK\u2014\u2014&gt; \u4e0d\u652f\u6301\u8303\u56f4\u8bf7\u6c42</li> </ul>"},{"location":"cs/network/http.html#_3","title":"\u5355\u4e2a\u8303\u56f4\u8bf7\u6c42","text":"<pre><code>curl http://i.imgur.com/z4d4kWk.jpg -i -H \"Range: bytes=0-1023\"\n\n# HTTP/1.1 206 Partial Content Content-Range: bytes 0-1023/577454964 Content-Length: 1024 ... (binary content)\n</code></pre> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b server \u8fd4\u56de 206 \u90e8\u5206\u5185\u5bb9\u54cd\u5e94\uff0cContent-Length\u8868\u793a\u7684\u662f\u73b0\u5728\u8bf7\u6c42\u7684\u8303\u56f4\u5927\u5c0f\uff0c\u800cContent-Range\u5219\u8868\u793a\u7684\u662f\u8fd9\u90e8\u5206\u6d88\u606f\u5728\u5b8c\u6574\u8d44\u6e90\u4e2d\u7684\u4f4d\u7f6e\u3002</p>"},{"location":"cs/network/http.html#_4","title":"\u591a\u8303\u56f4\u8bf7\u6c42","text":"<pre><code>curl http://www.example.com -i -H \"Range: bytes=0-50, 100-150\"\n# HTTP/1.1 206 Partial Content \n# Content-Type: multipart/byteranges; boundary=3d6b6a416f9b5 \n# Content-Length: 282 \n# --3d6b6a416f9b5 \n# Content-Type: video/mp4\n# Content-Range: bytes 0-50/577454964\n# ... binary data...\n# --3d6b6a416f9b5 \n# Content-Type: video/mp4\n# Content-Range: bytes 100-150/577454964\n\n# \u591a\u90e8\u5206 byterange\uff0c\u6bcf\u4e2a\u90e8\u5206\u5305\u542b\u81ea\u5df1\u7684Content-Type \u548c Content-Range\n</code></pre>"},{"location":"cs/network/http.html#_5","title":"\u6761\u4ef6\u8303\u56f4\u8bf7\u6c42","text":"<p>\u5f53\u7ee7\u7eed\u8bf7\u6c42\u66f4\u591a\u8d44\u6e90\u65f6\uff0c\u4f60\u9700\u8981\u786e\u4fdd\u88ab\u5b58\u50a8\u7684\u8d44\u6e90\u5728\u4e0a\u4e00\u5e27\u6536\u5230\u540e\u6ca1\u6709\u88ab\u6539\u53d8\u3002</p> <ul> <li>\u5982\u679c\u6761\u4ef6\u5f97\u5230\u6ee1\u8db3\uff0crange\u8bf7\u6c42\u5c06\u4f1a\u88ab\u53d1\u51fa\uff0cserver \u53d1\u56de\u5e26\u6709\u9002\u5f53\u6b63\u6587\u7684206 partial content \u5e94\u7b54\uff1b</li> <li>\u5982\u679c\u6761\u4ef6\u4e0d\u6ee1\u8db3\u5219\u8fd4\u56de\u5b8c\u6574\u8d44\u6e90\uff0c\u5e76\u663e\u793a200 OK\u72b6\u6001\u3002</li> </ul> <p>If-Range \u5934\u53ef\u4ee5\u4e0eLast-Modified \u9a8c\u8bc1\u7a0b\u5e8f\uff0c\u6216\u8005\u4e0e ETag \u4e00\u8d77\u4f7f\u7528\u3002</p> <p>If-Range: Wed, 21 Oct 2015 07:28:00 GMT</p>"},{"location":"cs/network/http.html#_6","title":"\u9519\u8bef\u7801","text":"\u9519\u8bef\u7801 \u4fe1\u606f 206(Partial Content) \u90e8\u5206\u8d44\u6e90 400(Bad  Request) \u8bed\u6cd5\u9519\u8bef\u65e0\u6cd5\u89e3\u8bfb\u8bf7\u6c42 401(Unauthorized) \u65e0\u6743\u9650\u8bbf\u95ee\u8d44\u6e90\uff0c\u4f46\u8eab\u4efd\u8ba4\u8bc1\u540e\u53ef\u4ee5\u8bbf\u95ee\u6743\u9650\u65f6 403(Forbidden) \u4e0d\u5141\u8bb8\u5ba2\u6237\u7aef\u83b7\u5f97\u8d44\u6e90\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u5373\u4f7f\u901a\u8fc7\u8eab\u4efd\u8ba4\u8bc1 404(Not  found) \u672a\u627e\u5230\u8d44\u6e90 405(Not  Allowed) \u8d44\u6e90\u4e0d\u5141\u8bb8\u4f7f\u7528\u67d0\u4e2aHTTP\u65b9\u6cd5\u65f6 406(Not  Acceptable) \u8bf7\u6c42\u4e0d\u53ef\u63a5\u53d7 409(Conflict) \u8bf7\u6c42\u4e0e\u8d44\u6e90\u7684\u5f53\u524d\u72b6\u6001\u6709\u51b2\u7a81\u65f6 410(Gone) \u8d44\u6e90\u4ee5\u524d\u5b58\u5728\uff0c\u4f46\u4eca\u540e\u4e0d\u4f1a\u5b58\u5728"},{"location":"cs/network/http.html#websocket","title":"WebSocket","text":"<p>\u670d\u52a1\u7aef\u53ef\u4ee5\u901a\u8fc7\u68c0\u67e5\u8bf7\u6c42\u7684\u534f\u8bae\u6765\u533a\u5206\u662fHTTP\u8fd8\u662fWebSocket\u7684\u8bf7\u6c42</p> <ul> <li>Upgrade\u5934\u90e8\u5b57\u6bb5\u503c\u4e3awebsocket\uff0c\u5219\u8868\u793a\u5ba2\u6237\u7aef\u5e0c\u671b\u5347\u7ea7\u5230WebSocket\u534f\u8bae\uff1b</li> </ul> <p>\u5355\u4e2aTCP\u8fde\u63a5\u4e0a\u8fdb\u884c\u5168\u53cc\u5de5\u901a\u4fe1\u7684\u534f\u8bae\u3002</p> <p>Websocket \u901a\u8fc7HTTP 1.1 \u534f\u8bae\u7684101\u72b6\u6001\u7801\u8fdb\u884c\u63e1\u624b\u3002</p> <p>\u5728 WebSocket API \u4e2d\uff0c\u6d4f\u89c8\u5668\u548c\u670d\u52a1\u5668\u53ea\u9700\u8981\u5b8c\u6210\u4e00\u6b21\u63e1\u624b\uff0c\u4e24\u8005\u4e4b\u95f4\u5c31\u76f4\u63a5\u53ef\u4ee5\u521b\u5efa\u6301\u4e45\u6027\u7684\u8fde\u63a5\uff0c\u5e76\u8fdb\u884c\u53cc\u5411\u6570\u636e\u4f20\u8f93\u3002</p>"},{"location":"cs/network/intranet_penetration.html","title":"\u5185\u7f51\u7a7f\u900f","text":"<p>\u5728\u4efb\u4f55\u5730\u65b9\uff0c\u901a\u8fc7\u7f51\u7edc\u53ef\u4ee5\u8bbf\u95ee\u5bb6\u91cc\u7b14\u8bb0\u672c\u4e0a\u7684\u5e94\u7528\u670d\u52a1\uff1f</p> <p>\u5185\u7f51\u7a7f\u900f\uff0c\u4e5f\u5373NAT\u7a7f\u900f\uff0c\u4e3a\u4e86\u4f7f\u67d0\u4e00\u7279\u5b9a\u6e90IP\u5730\u5740\u548c\u6e90\u7aef\u53e3\u53f7\u7684\u6570\u636e\u4e0d\u88abNAT\u8bbe\u5907\u5c4f\u853d\u800c\u6b63\u786e\u8def\u7531\u5230\u5185\u7f51\u4e3b\u673a\u3002</p> <p>\u53c2\u8003\u94fe\u63a5\uff1a[\u8bd1] NAT \u7a7f\u900f\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff1a\u6280\u672f\u539f\u7406\u53ca\u4f01\u4e1a\u7ea7\u5b9e\u8df5\uff08Tailscale, 2020\uff09 (arthurchiao.art)</p> <p>\u5728\u4e24\u53f0\u7ecf\u8fc7 NAT \u7684\u673a\u5668\u4e4b\u95f4\u5efa\u7acb \u70b9\u5bf9\u70b9\u8fde\u63a5</p> <ul> <li>IP\u6709\u4e24\u79cd\uff0cIPV4\u3001IPV6\uff1b\u53ea\u6709IPV4\u4f1a\u6709\u5185\u7f51\u7a7f\u900f\u7684\u60c5\u51b5\uff1b</li> <li>NAT\uff1a\u4e00\u4e2a\u533a\u57df\u5185\u7684\u6240\u6709\u8bbe\u5907\u8fde\u5728\u4e00\u8d77\u5e76\u7edf\u4e00\u548c\u4e3b\u5e72\u9053\u4e0a\u5176\u4ed6\u533a\u57df\u8bbe\u5907\u8054\u7cfb\uff0c\u5bf9\u5916\u53ea\u5171\u7528\u4e00\u4e2a\u516c\u7f51IP\u6765\u6807\u8bc6\u81ea\u5df1\uff0c\u5bf9\u5185\u5219\u5206\u914d\u4e00\u4e9b\u591f\u7528\u7684\u79c1\u6709\u5730\u5740\uff1b</li> <li>NAT\u505a\u7684\u4e8b\u60c5\uff1a\u79c1\u6709IP+\u7aef\u53e3\u300a--\u300b\u516c\u7f51IP+\u7aef\u53e3</li> <li>\u8bc6\u522b\u4e00\u4e2a\u8fde\u63a5\u53ea\u97005\u5143\u7ec4\u5373\u53ef\uff1a<code>\u534f\u8bae\u3001\u6e90\u5730\u5740\u3001\u6e90\u7aef\u53e3\u3001\u76ee\u7684\u5730\u5740\u3001\u76ee\u7684\u7aef\u53e3</code></li> <li>\u5185\u7f51\u7a7f\u900f\uff0c\u672c\u8d28\u5c31\u662f\u5bf9\u516c\u7f51IP\u6216\u8005\u7aef\u53e3\u505a\u6587\u7ae0\uff0c\u4ece\u800c\u5b9e\u73b0\u81ea\u5b9a\u4e49\u8bbf\u95ee</li> </ul> <p>\u8d2d\u4e70\u516c\u7f51ip</p> <ul> <li>\u4e00\u53f0\u81ea\u5df1\u62e5\u6709\u7684\u80fd\u591f\u64cd\u4f5c\u7684\u3001\u5177\u6709\u516c\u7f51IP\u7684\u673a\u5b50A\uff08\u7269\u7406\u673a\u3001\u865a\u62df\u673a\u90fd\u53ef\u4ee5\uff09\uff1b</li> <li>\u9700\u8981\u8fdb\u884c\u7aef\u53e3\u6620\u5c04/\u8f6c\u53d1\uff0c\u8ba9\u672c\u5730\u5c40\u57df\u7f51\u7684\u673a\u5b50\u548c\u673a\u5b50A\u5efa\u7acb\u8054\u7cfb\uff0c\u4ece\u800c\u5b9e\u73b0\u5185\u7f51\u7a7f\u900f\uff1b</li> <li>nat123\u3001\u82b1\u751f\u58f3\u3001frp\u3001\u53ea\u8981\u662f\u7c7b\u4f3c\u7684\uff0c\u90fd\u662f\u8fd9\u79cd\u6a21\u5f0f\uff1a\u4f7f\u7528\u5176\u4ed6\u80fd\u64cd\u4f5c\u7684\u516c\u7f51ip\u8fdb\u884c\u8f6c\u53d1\uff1b</li> </ul> <p>\u76f4\u8fde\u516c\u7f51\u4e3b\u673a\u7aef\u53e3</p> <ul> <li>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0cNAT\u8f6c\u6362\u51fa\u53bb\u7684\u7aef\u53e3\u662f\u968f\u673a\u7684\uff0c\u4f46\u4f60\u6211\u4eec\u624b\u673a\u6216\u7535\u8111\u4e0a\u73a9\u7684\u5404\u79cd\u8f6f\u4ef6\u662f\u53ef\u4ee5\u548c\u4ed6\u4eec\u81ea\u5df1\u7684\u670d\u52a1\u5668\u8fdb\u884c\u53cc\u5411\u901a\u4fe1\u7684\uff1b</li> <li>\u5728\u4ed6\u4eec\u901a\u4fe1\u7684\u65f6\u5019\uff0c\u76f8\u4e92\u83b7\u53d6\u4e86\u5bf9\u65b9\u7684\u516c\u7f51IP+\u7aef\u53e3\uff08\u6709\u4e9bapp\u662f\u56fa\u5b9a\u7684\u57df\u540d\uff09\uff1b</li> <li>p2p\u8fde\u63a5\uff0c\u8fd8\u662fVPN\uff0c\u53ea\u8981\u662f\u7c7b\u4f3c\u7684\uff0c\u5c31\u662f\u8fd9\u79cd\u6a21\u5f0f\uff1b</li> <li>\u5728\u4e24\u7aef\u90fd\u5b89\u88c5\u4f7f\u7528\u8f85\u52a9\u7684\u5ba2\u6237\u7aef\u624d\u884c\uff08\u53ef\u4ee5\u7406\u89e3\u4e3a\u83b7\u53d6\u5bf9\u65b9\u5730\u5740\u76f8\u4e92\u8fde\u63a5\uff0c\u751a\u81f3\u8fd8\u53ef\u4ee5\u52a0\u5bc6\u63d0\u9ad8\u5b89\u5168\u6027\uff09\uff1b</li> </ul>"},{"location":"cs/network/intranet_penetration.html#p2p","title":"P2P\uff08\u76f4\u8fde\uff09","text":"<ul> <li>\u534f\u8bae\u5e94\u8be5\u57fa\u4e8e UDP\uff1aTCP \u7684\u5b9e\u73b0\u8fc7\u4e8e\u590d\u6742\uff0c\u53ef\u4f7f\u7528 QUIC \u83b7\u53d6\u9762\u5411\u6d41\u7684\u8fde\u63a5\uff1b</li> <li>\u5bf9\u6536\u53d1\u5305\u7684 socket \u6709\u76f4\u63a5\u63a7\u5236\u6743\uff1a\u5fc5\u987b\u5728\u4f7f\u7528\u7684\u201c\u4e3b\u8981\u201d\u534f\u8bae\u4e4b\u5916\uff0c\u53d1\u9001\u548c\u63a5\u6536\u989d\u5916\u7684\u6570\u636e\u5305\u3002</li> </ul>"},{"location":"cs/network/intranet_penetration.html#udpudp-hole-punching","title":"UDP\u6253\u6d1e\uff08UDP hole punching\uff09","text":"<p>\u53ea\u6709\u5f53\u4e24\u4e2aNAT\u90fd\u662fCone NAT\uff08\u6216\u8005\u975eNAT\u7684\u9632\u706b\u5899\uff09\u65f6\u624d\u80fd\u5de5\u4f5c\u3002</p> <ul> <li>\u56e0\u4e3a\u5185\u7f51\u7684\u540c\u4e00\u4e2a IP:Port \u4f1a\u88ab\u6620\u5c04\u5230NAT\u4e0a\u7684\u540c\u4e00\u4e2a IP:Port</li> </ul> <p>P2P\u901a\u4fe1\u6280\u672f\uff0c\u88ab\u5e7f\u6cdb\u91c7\u7528\u7684\uff0c\u540d\u4e3a\u201cP2P\u6253\u6d1e\u201c\u3002</p> <p>P2P\u6253\u6d1e\u6280\u672f\u4f9d\u8d56\u4e8e\u901a\u5e38\u9632\u706b\u5899\u548c<code>cone NAT</code>\u5141\u8bb8\u6b63\u5f53\u7684P2P\u5e94\u7528\u7a0b\u5e8f\u5728\u4e2d\u95f4\u4ef6\u4e2d\u6253\u6d1e\u4e14\u4e0e\u5bf9\u65b9\u5efa\u7acb\u76f4\u63a5\u94fe\u63a5\u7684\u7279\u6027\u3002</p> <p></p> <ul> <li>\u5ba2\u6237\u7aefA\u65e0\u6cd5\u548c\u5ba2\u6237\u7aefB\u76f4\u63a5\u5efa\u7acb\u4e00\u4e2aUDP\u901a\u4fe1\u4f1a\u8bdd\u3002\u5982\u679cA\u76f4\u63a5\u7ed9B\u7684\u516c\u7f51\u5730\u5740<code>138.76.29.7:31000</code>\u53d1\u9001UDP\u6570\u636e\uff0cNAT B\u5c06\u5f88\u53ef\u80fd\u4f1a\u65e0\u89c6\u8fdb\u5165\u7684\u6570\u636e\uff08\u9664\u975e\u662fFull Cone NAT\uff09\uff0c\u56e0\u4e3a\u6e90\u5730\u5740\u548c\u7aef\u53e3\u4e0eS\u4e0d\u5339\u914d\uff0c\u800c\u6700\u521d\u53ea\u4e0eS\u5efa\u7acb\u8fc7\u4f1a\u8bdd\u3002B\u5f80A\u76f4\u63a5\u53d1\u4fe1\u606f\u4e5f\u7c7b\u4f3c\uff1b</li> <li>\u5047\u8bbeA\u5f00\u59cb\u7ed9B\u7684\u516c\u7f51\u5730\u5740\u53d1\u9001UDP\u6570\u636e\u7684\u540c\u65f6\uff0c\u7ed9\u670d\u52a1\u5668S\u53d1\u9001\u4e00\u4e2a\u4e2d\u7ee7\u8bf7\u6c42\uff0c\u8981\u6c42B\u5f00\u59cb\u7ed9A\u7684\u516c\u7f51\u5730\u5740\u53d1\u9001UDP\u4fe1\u606f\u3002A\u5f80B\u7684\u8f93\u51fa\u4fe1\u606f\u4f1a\u5bfc\u81f4NAT A\u6253\u5f00\u4e00\u4e2aA\u7684\u5185\u7f51\u5730\u5740\u4e0e\u4e0eB\u7684\u5916\u7f51\u5730\u5740\u4e4b\u95f4\u7684\u65b0\u901a\u8baf\u4f1a\u8bdd\uff0cB\u5f80A\u4ea6\u7136\u3002\u4e00\u65e6\u65b0\u7684UDP\u4f1a\u8bdd\u5728\u4e24\u4e2a\u65b9\u5411\u90fd\u6253\u5f00\u4e4b\u540e\uff0c\u5ba2\u6237\u7aefA\u548c\u5ba2\u6237\u7aefB\u5c31\u80fd\u76f4\u63a5\u901a\u8baf\uff0c\u800c\u65e0\u987b\u518d\u901a\u8fc7\u5f15\u5bfc\u670d\u52a1\u5668S\u4e86\u3002</li> </ul>"},{"location":"cs/network/intranet_penetration.html#nat","title":"\u5982\u4f55\u83b7\u53d6NAT\u7684\u5916\u7f51\u5730\u5740\u548c\u7aef\u53e3\u53f7\uff1f","text":"<p>Server\u901a\u8fc7\u767b\u9646\u6d88\u606f\u7684IP\u5934\u548cUDP\u5934\u5f97\u5230\u8be5\u5ba2\u6237\u7aef\u7684\u5916\u7f51\u76f8\u5173\u4fe1\u606f\u3002</p> <p>STUN \u57fa\u4e8e\u4e00\u4e2a\u7b80\u5355\u7684\u89c2\u5bdf\uff1a\u4ece\u4e00\u4e2a\u4f1a\u88ab NAT \u7684\u5ba2\u6237\u7aef\u8bbf\u95ee\u516c\u7f51\u670d\u52a1\u5668\u65f6\uff0c \u670d\u52a1\u5668\u770b\u5230\u7684\u662f NAT \u8bbe\u5907\u7684\u516c\u7f51 ip:port \u5730\u5740\uff0c\u800c\u975e\u8be5 \u5ba2\u6237\u7aef\u7684\u5c40\u57df\u7f51 ip:port \u5730\u5740\u3002</p> <p></p>"},{"location":"cs/network/intranet_penetration.html#frp","title":"Frp \u4ee3\u7406\uff08\u4e2d\u7ee7\uff09","text":"<p>\u5728\u67d0\u4e9b\u573a\u666f\u4e2d\uff0c\u76f4\u63a5\u8bbf\u95ee socket \u8fd9\u4e00\u6761\u4ef6\u53ef\u80fd\u5f88\u96be\u6ee1\u8db3\u3002</p> <p>\u9000\u800c\u6c42\u5176\u6b21\u7684\u4e00\u4e2a\u65b9\u5f0f\u662f\u8bbe\u7f6e\u4e00\u4e2a local proxy\uff08\u672c\u5730\u4ee3\u7406\uff09\uff0c\u4e3b\u534f\u8bae\u4e0e\u8fd9\u4e2a proxy \u901a\u4fe1 \uff0c\u540e\u8005\u6765\u5b8c\u6210 NAT \u7a7f\u900f\uff0c\u5c06\u5305\u4e2d\u7ee7\uff08relay\uff09\u7ed9\u5bf9\u7aef\u3002\u8fd9\u79cd\u65b9\u5f0f\u589e\u52a0\u4e86\u4e00\u4e2a\u989d\u5916\u7684\u95f4\u63a5\u5c42 \uff0c\u4f46\u597d\u5904\u662f\uff1a</p> <ol> <li>\u4ecd\u7136\u80fd\u83b7\u5f97 NAT \u7a7f\u900f\uff0c</li> <li>\u4e0d\u9700\u8981\u5bf9\u5df2\u6709\u7684\u5e94\u7528\u7a0b\u5e8f\u505a\u4efb\u4f55\u6539\u52a8\u3002</li> </ol>"},{"location":"cs/network/intranet_penetration.html#_2","title":"\u539f\u7406","text":"<ol> <li>frps \u76d1\u542c\u7aef\u53e317000\u7aef\u53e3\uff08\u5bf9\u5185\u7aef\u53e3\uff09\uff0c\u7b49\u5f85fprc\u7684\u8fde\u63a5</li> <li>frpc\u4f1a\u8bf7\u6c42frps:17000\u7aef\u53e3\uff0c\u5e76\u5efa\u7acbTCP\u8fde\u63a5\uff0c\u6b64\u540e\u4f1a\u4e00\u76f4\u7ef4\u6301\u8fd9\u4e2a\u94fe\u63a5\uff0c \u56e0\u4e3a\u540e\u9762\u6240\u6709\u5ba2\u6237\u7aef\u8bf7\u6c42frpc\u540e\u9762\u7684\u670d\u52a1\u65f6\uff0c\u6570\u636e\u90fd\u4f1a\u901a\u8fc7\u8fd9\u4e2aTCP\u8fde\u63a5\u8fdb\u884c\uff0c\u800c\u4e0d\u518d\u5efa\u7acb\u65b0\u7684\u8fde\u63a5\u3002</li> <li>frpc\u8fde\u63a5\u5230\u670d\u52a1\u7aef\u7684\u5bf9\u5185\u7aef\u53e317000\uff0c\u540c\u65f6\u544a\u8bc9frps\u8981\u76d1\u542c\u7684\u5bf9\u5916\u7aef\u53e317001\u548c\u8f6c\u53d1\u7c7b\u578bhttp\uff1b</li> <li>frps\u670d\u52a1\u7aeffork\u65b0\u7684\u8fdb\u7a0b\u76d1\u542c\u5ba2\u6237\u7aef\u5bf9\u5916\u7aef\u53e317001\uff1b</li> <li>\u5916\u7f51\u5ba2\u62371\u8bf7\u6c42frps:17001\u65f6\uff0cfrps\u4f1a\u628a\u6570\u636e\u8f6c\u53d117000\uff08\u5bf9\u5185\u7aef\u53e3\uff09\u7ed9frpc\uff0cfrpc\u4f1a\u628a\u6570\u636e\u53d1\u7ed922\u7aef\u53e3\u670d\u52a1ssh</li> </ol>"},{"location":"cs/network/network.html","title":"\u7f51\u7edc\u5c42\u534f\u8bae","text":""},{"location":"cs/network/network.html#nat","title":"NAT","text":"<p>NAT\u7f51\u7edc\u5730\u5740\u8f6c\u6362\uff08NAT\uff0cNetwork Address Translation\uff09\u5c5e\u63a5\u5165\u5e7f\u57df\u7f51(WAN)\u6280\u672f\uff0c\u662f\u4e00\u79cd\u5c06\u79c1\u6709(\u4fdd\u7559)\u5730\u5740\u8f6c\u5316\u4e3a\u5916\u7f51IP\u5730\u5740\u7684\u8f6c\u6362\u6280\u672f\uff0c\u5b83\u88ab\u5e7f\u6cdb\u5e94\u7528\u4e8e\u5404\u79cd\u7c7b\u578bInternet\u63a5\u5165\u65b9\u5f0f\u548c\u5404\u79cd\u7c7b\u578b\u7684\u7f51\u7edc\u4e2d\u3002</p> <p>NAT\u4e0d\u4ec5\u5b8c\u7f8e\u5730\u89e3\u51b3\u4e86lP\u5730\u5740\u4e0d\u8db3\u7684\u95ee\u9898\uff0c\u800c\u4e14\u8fd8\u80fd\u591f\u6709\u6548\u5730\u907f\u514d\u6765\u81ea\u7f51\u7edc\u5916\u90e8\u7684\u653b\u51fb\uff0c\u9690\u85cf\u5e76\u4fdd\u62a4\u7f51\u7edc\u5185\u90e8\u7684\u8ba1\u7b97\u673a\u3002</p> <ul> <li>\u9759\u6001\u8f6c\u6362\uff1a\u4e00\u4e2a\u5185\u7f51IP\u53ea\u8f6c\u6362\u4e3a\u67d0\u4e2a\u516c\u6709IP\uff1b</li> <li>\u52a8\u6001\u8f6c\u6362\uff1a\u5185\u90e8\u5730\u5740\u53ef\u4ee5\u8f6c\u6362\u6210\u5916\u90e8IP\u96c6\u5408\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\uff1b</li> <li>\u7aef\u53e3\u591a\u8def\u590d\u7528(PAT)\uff1a\u591a\u4e2a\u4e3b\u673a\u5171\u4eab\u4e00\u4e2a\u5408\u6cd5\u7684\u516c\u7f51 IP \u5b9e\u73b0\u5bf9Internet\u7684\u8bbf\u95ee\uff0c\u6bcf\u4e2a\u5185\u90e8IP\u6620\u5c04\u5230\u516c\u7f51\u4e0a\u7684\u4e00\u4e2a\u7aef\u53e3\uff1b</li> <li>\u5e94\u7528\u7a0b\u5e8f\u7ea7\u7f51\u5173\u6280\u672fALG\uff08Appliaction Level Gateway)\uff1a\u4f20\u7edf\u7684NAT\u6280\u672f\u53ea\u5bf9\u4f20\u8f93\u5c42\u5934\u90e8\u8fdb\u884c\u5904\u7406\uff0c\u652f\u6301\u5bf9\u5e94\u7528\u5c42\u534f\u8bae\u4e2d\u7684\u5730\u5740\u4fe1\u606f\u8fdb\u884c\u8f6c\u6362\uff1b</li> </ul> <p>SNAT\uff08Source Network Address Translation\uff09\u6307\u7684\u662f\u6e90\u5730\u5740\u8f6c\u6362\uff0c\u5b83\u5c06\u6e90IP\u5730\u5740\u548c\u7aef\u53e3\u53f7\u8fdb\u884c\u8f6c\u6362\u3002</p> <ul> <li>\u5f53\u4e00\u4e2a\u5185\u90e8\u8bbe\u5907\u5411\u5916\u90e8\u7f51\u7edc\u53d1\u9001\u6570\u636e\u5305\u65f6\uff0cSNAT\u4f1a\u5c06\u6e90IP\u5730\u5740\u548c\u7aef\u53e3\u53f7\u66ff\u6362\u4e3a\u4e00\u4e2a\u516c\u5171IP\u5730\u5740\u548c\u7aef\u53e3\u53f7\uff0c\u4ee5\u9690\u85cf\u5185\u90e8\u7f51\u7edc\u7684\u771f\u5b9eIP\u5730\u5740\u548c\u7aef\u53e3\u53f7\u3002\u8fd9\u6837\u53ef\u4ee5\u907f\u514d\u5185\u90e8\u7f51\u7edc\u53d7\u5230\u653b\u51fb\u548c\u4fb5\u5165\uff0c\u5e76\u4e14\u53ef\u4ee5\u5b9e\u73b0\u591a\u4e2a\u5185\u90e8\u8bbe\u5907\u5171\u4eab\u4e00\u4e2a\u516c\u5171IP\u5730\u5740\u7684\u529f\u80fd\u3002</li> </ul> <p>DNAT\uff08Destination Network Address Translation\uff09\u6307\u7684\u662f\u76ee\u6807\u5730\u5740\u8f6c\u6362\uff0c\u5b83\u5c06\u76ee\u6807IP\u5730\u5740\u548c\u7aef\u53e3\u53f7\u8fdb\u884c\u8f6c\u6362\u3002</p> <ul> <li>\u5f53\u5916\u90e8\u7f51\u7edc\u5411\u5185\u90e8\u7f51\u7edc\u53d1\u9001\u6570\u636e\u5305\u65f6\uff0cDNAT\u4f1a\u5c06\u76ee\u6807IP\u5730\u5740\u548c\u7aef\u53e3\u53f7\u66ff\u6362\u4e3a\u5185\u90e8\u7f51\u7edc\u4e2d\u7684\u4e00\u4e2a\u8bbe\u5907\u7684IP\u5730\u5740\u548c\u7aef\u53e3\u53f7\uff0c\u4ee5\u5b9e\u73b0\u5185\u7f51\u7a7f\u900f\u548c\u8bbf\u95ee\u5185\u90e8\u7f51\u7edc\u4e2d\u7684\u8bbe\u5907\u3002</li> </ul>"},{"location":"cs/network/network.html#napt","title":"\u7aef\u53e3\u591a\u8def\u590d\u7528 NAPT","text":"<p>\u7f51\u7edc\u5730\u5740\u7aef\u53e3\u8f6c\u6362NAPT\uff08Network Address Port Translation\uff09\uff1a</p> <ul> <li>\u6539\u53d8\u5916\u51fa\u6570\u636e\u5305\u7684\u6e90IP\u5730\u5740\u548c\u6e90\u7aef\u53e3\u5e76\u8fdb\u884c\u7aef\u53e3\u8f6c\u6362\uff0c\u5373\u7aef\u53e3\u5730\u5740\u8f6c\u6362\u91c7\u7528\u7aef\u53e3\u591a\u8def\u590d\u7528\u7684\u65b9\u5f0f\uff1b</li> <li>\u5185\u90e8\u7f51\u7edc\u7684\u6240\u6709\u4e3b\u673a\u5747\u53ef\u5171\u4eab\u4e00\u4e2a\u5408\u6cd5\u5916\u90e8IP\u5730\u5740\u5b9e\u73b0\u4e92\u8054\u7f51\u7684\u8bbf\u95ee\u3002</li> </ul>"},{"location":"cs/network/network.html#natsymmetric-nat","title":"\u5bf9\u79f0NAT\uff08Symmetric NAT\uff09","text":"<p>\u4ece\u540c\u4e00\u4e2a\u5185\u7f51\uff08IP\uff0c\u7aef\u53e3\uff09\u53d1\u9001\u5230\u540c\u4e00\u4e2a\u76ee\u7684IP\u548c\u7aef\u53e3\u7684\u8bf7\u6c42\u90fd\u4f1a\u88ab\u6620\u5c04\u5230\u540c\u4e00\u4e2aIP\u548c\u7aef\u53e3\uff1a</p> <ul> <li>\uff08SourceIP, SourcePort,DestIP, DestPort\uff09\u53ea\u8981\u6709\u4e00\u4e2a\u53d1\u751f\u53d8\u5316\u90fd\u4f1a\u4f7f\u7528\u4e0d\u540c\u7684\u6620\u5c04\u6761\u76ee</li> </ul>"},{"location":"cs/network/network.html#natcone-nat","title":"\u9525\u5f62NAT\uff08Cone NAT\uff09","text":"<p>\u5185\u7f51\u4e2d\u7684\uff08IP\uff0c\u7aef\u53e3\uff09\u76f8\u540c\u7684\u8bf7\u6c42\u5c31\u4f1a\u88abNAT\u6620\u5c04\u5230\u540c\u4e00\u4e2a\u5916\u7f51\uff08IP\uff0cport\uff09</p> <ul> <li>\u4ece\u76f8\u540c\u7684\u5185\u90e8\u7aef\u70b9\uff08\u79c1\u6709\u5730\u5740\uff09\u5230\u4e24\u4e2a\u4e0d\u540c\u7684\u5916\u90e8\u670d\u52a1\u7aefS1\u548cS2\uff0cCone NAT\u53ea\u4e3a\u4e24\u4e2a\u4f1a\u8bdd\u6620\u5c04\u4e86\u4e00\u4e2a\u516c\u7f51\u7aef\u70b9\u3002</li> </ul>"},{"location":"cs/network/network.html#natfull-cone-nat","title":"\u5168\u9525\u5f62NAT\uff08Full Cone NAT\uff09","text":"<p>\u5728\u4e00\u4e2a\u65b0\u4f1a\u8bdd\u5efa\u7acb\u4e86\u516c\u7f51/\u5185\u7f51\u7aef\u53e3\u7ed1\u5b9a\u4e4b\u540e\uff0c\u5168\u9525\u5f62NAT\u63a5\u4e0b\u6765\u4f1a\u63a5\u53d7\u5bf9\u5e94\u516c\u7f51\u7aef\u53e3\u7684\u6240\u6709\u6570\u636e\uff0c\u65e0\u8bba\u662f\u6765\u81ea\u54ea\u4e2a\uff08\u516c\u7f51\uff09\u7ec8\u7aef\u3002</p> <p></p>"},{"location":"cs/network/network.html#natrestricted-cone-nat","title":"\u5730\u5740\u53d7\u9650\u9525\u5f62NAT\uff08Restricted Cone NAT\uff09","text":"<p>\u53ea\u8f6c\u53d1\u7b26\u5408\u67d0\u4e2a\u6761\u4ef6\u7684\u8f93\u5165\u6570\u636e\u5305\u3002\u6761\u4ef6\u4e3a\uff1a\u5916\u90e8\uff08\u6e90\uff09IP\u5730\u5740\u5339\u914d\u5185\u7f51\u4e3b\u673a\u4e4b\u524d\u53d1\u9001\u4e00\u4e2a\u6216\u591a\u4e2a\u6570\u636e\u5305\u7684\u7ed3\u70b9\u7684IP\u5730\u5740\u3002</p> <ul> <li>\u53ea\u6709\u5185\u7f51\u4e3b\u673a\u4e3b\u52a8\u8fde\u63a5\u7684\u516c\u7f51IP\u624d\u53ef\u4ee5\u4e0e\u5185\u7f51\u4e2d\u7684\u4e3b\u673a\u901a\u8baf\u3002</li> </ul> <p></p>"},{"location":"cs/network/network.html#natport-restricted-cone-nat","title":"\u7aef\u53e3\u53d7\u9650\u9525\u5f62NAT\uff08Port-Restricted Cone NAT\uff09","text":"<p>\u53ea\u5f53\u5916\u90e8\u6570\u636e\u5305\u7684IP\u5730\u5740\u548c\u7aef\u53e3\u53f7\u90fd\u5339\u914d\u5185\u7f51\u4e3b\u673a\u53d1\u9001\u8fc7\u7684\u5730\u5740\u548c\u7aef\u53e3\u53f7\u65f6\u624d\u8fdb\u884c\u8f6c\u53d1\u3002\u7aef\u53e3\u53d7\u9650\u9525\u5f62NAT\u4e3a\u5185\u90e8\u7ed3\u70b9\u63d0\u4f9b\u4e86\u548c\u5bf9\u79f0NAT\u76f8\u540c\u7b49\u7ea7\u7684\u4fdd\u62a4\uff0c\u4ee5\u9694\u79bb\u672a\u5173\u8054\u7684\u6570\u636e\u3002</p> <p></p>"},{"location":"cs/network/network.html#_2","title":"\u95ee\u9898","text":"<ul> <li>\u4e0d\u80fd\u5904\u7406\u5d4c\u5165\u5f0fIP\u5730\u5740\u6216\u7aef\u53e3\uff0c\u5e94\u7528\u534f\u8bae\u91cc\u7684\u6570\u636e\u5305\u542b\u672c\u5730\u5730\u5740\uff0c\u65e0\u6cd5\u88abNAT\u8f6c\u6362\uff1b</li> <li>\u4e0d\u80fd\u4ece\u516c\u7f51\u8bbf\u95ee\u5185\u90e8\u7f51\u7edc\u670d\u52a1\uff0c\u9700\u8981\u5efa\u7acbNAT\u5230\u79c1\u6709\u5730\u5740\u7aef\u53e3\u7684\u6620\u5c04\uff1b</li> <li>\u6709\u4e00\u4e9b\u5e94\u7528\u7a0b\u5e8f\u867d\u7136\u662f\u7528A\u7aef\u53e3\u53d1\u9001\u6570\u636e\u7684\uff0c\u4f46\u5374\u8981\u7528B\u7aef\u53e3\u8fdb\u884c\u63a5\u6536\uff0c\u7ed3\u679cNAT\u6ca1\u6709B\u7aef\u53e3\u7684\u6620\u5c04\uff1b</li> <li>\u5982\u679cNAT\u672c\u8eab\u53c8\u4f4d\u4e8e\u53e6\u4e00\u4e2aNAT\u4e4b\u540e\uff0c\u5219\u4e5f\u4f1a\u51fa\u73b0\u4e00\u4e9b\u95ee\u9898\uff1b</li> <li>\u4e00\u4e9bP2P\u5e94\u7528\u5728NAT\u540e\u65e0\u6cd5\u8fdb\u884c\uff0cNAT\u8bbe\u5907\u540e\u7684P2P\u7a0b\u5e8f\u5728NAT\u8bbe\u5907\u4e0a\u662f\u4e0d\u4f1a\u6709\u6620\u5c04\u6761\u76ee\u3002</li> </ul>"},{"location":"cs/network/network.html#natnat-traversal","title":"NAT\u7a7f\u8d8a\u6280\u672f(NAT Traversal)","text":"<p>\u89e3\u51b3NAT\u6280\u672f\u7684\u95ee\u9898\uff1a</p> <ul> <li>\u8ba9\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f(\u5982QQ)\u4e3b\u52a8\u53d1\u73b0\u81ea\u5df1\u4f4d\u4e8eNAT\u8bbe\u5907\u4e4b\u540e\uff0c\u4e3b\u52a8\u83b7\u5f97NAT\u8bbe\u5907\u7684\u516c\u7f51IP\uff0c\u5e76\u4e3a\u81ea\u5df1\u5efa\u7acb\u7aef\u53e3\u6620\u5c04\u6761\u76ee\uff1b</li> <li>NAT\u7a7f\u8d8a\u6280\u672f\u4f9d\u8d56\u4e8eUPnP\u534f\u8bae\u7684\u652f\u6301\uff0c\u4e5f\u5c31\u662f\u8bf4NAT\u8bbe\u5907\u5fc5\u987b\u652f\u6301UPnP\uff0c\u652f\u6301NAT\u7a7f\u8d8a\u6280\u672f\uff1b</li> <li>\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f\u4e00\u6837\u4e5f\u9700\u8981\u652f\u6301UPnP\uff0c\u652f\u6301NAT\u7a7f\u8d8a\u6280\u672f\uff1b</li> </ul> <p>\u5bf9\u4e8e\u90a3\u79cdNAT\u8bbe\u5907\u4f4d\u4e8e\u53e6\u4e00\u4e2aNAT\u8bbe\u5907\u4e4b\u540e\u7684\u60c5\u51b5\uff0cNAT\u7a7f\u8d8a\u6280\u672f\u4e5f\u65e0\u80fd\u4e3a\u529b\u3002</p>"},{"location":"cs/network/network.html#ipv4","title":"IPV4","text":""},{"location":"cs/network/network.html#_3","title":"\u5730\u5740\u4e0e\u5b50\u7f51\u63a9\u7801","text":"<p>32\u4f4d\u7684\u4e8c\u8fdb\u5236\u6570\uff0c\u70b9\u5206\u5341\u8fdb\u5236\uff0c\u5982 192.168.3.1\u3002</p> <p>IP\u5730\u5740\u6784\u6210\uff1a\u7f51\u7edc\u53f7 + \u4e3b\u673a\u53f7</p> <ul> <li>A\u7c7b\u5730\u5740\uff1a<code>1.0.0.0--126.255.255.255</code>\uff0c1\u5b57\u8282\u7684\u7f51\u7edc\u5730\u5740\u548c3\u5b57\u8282\u4e3b\u673a\u5730\u5740\uff0c\u4e8c\u8fdb\u5236\u4ee5<code>0</code>\u5f00\u5934</li> <li>\u79c1\u6709\u533a\u57df\uff1a<code>10.0.0.0\uff5e10.255.255.255</code></li> <li>B\u7c7b\u5730\u5740\uff1a<code>128.0.0.0--191.255.255.255</code>\uff0c2\u4e2a\u5b57\u8282\u7684\u7f51\u7edc\u5730\u5740\u548c2\u4e2a\u5b57\u8282\uff0c\u4e8c\u8fdb\u5236\u4ee5<code>10</code>\u5f00\u5934</li> <li>\u79c1\u6709\u533a\u57df\uff1a<code>172.16.0.0\uff5e173.31.255.255</code></li> <li>C\u7c7b\u5730\u5740\uff1a<code>192.0.0.0--223.255.255.255</code>\uff0c3\u4e2a\u5b57\u8282\u7684\u7f51\u7edc\u5730\u5740\u548c1\u5b57\u8282\u7684\u4e3b\u673a\u5730\u5740\uff0c\u4e8c\u8fdb\u5236\u4ee5<code>110</code>\u5f00\u5934</li> <li>\u79c1\u6709\u533a\u57df\uff1a<code>192.168.0.0\uff5e192.168.255.255</code></li> <li>D\u7c7b\u5730\u5740\uff1a<code>224.0.0.0---239.255.255.255</code>\uff0c\u4e8c\u8fdb\u5236\u4ee5<code>1110</code>\u5f00\u5934\uff0c\u7ec4\u64ad\u5730\u5740\uff1b</li> <li>E\u7c7b\u5730\u5740\uff1a<code>240.0.0.1---255.255.255.25</code>\uff0c\u4e8c\u8fdb\u5236\u4ee5<code>1110</code>\u5f00\u5934\uff0c\u7528\u4f5c\u4fdd\u7559\u5730\u5740\uff1b</li> </ul> <p>\u7279\u6b8a\u7684\u5730\u5740\uff1a</p> <ul> <li><code>127.X.X.X</code>\uff1a\u672c\u5730\u56de\u73af\u5730\u5740</li> <li><code>0.0.0.0</code>\uff1a\u5f53\u524d\u4e3b\u673a\u3002</li> <li><code>255.255.255.255</code>\uff1a\u5f53\u524d\u5b50\u7f51\u7684\u5e7f\u64ad\u5730\u5740\u3002</li> </ul> <p>\u5b50\u7f51\u63a9\u7801\uff1a\u7f51\u7edc\u53f7 + \u5b50\u7f51\u53f7 +  \u4e3b\u673a\u53f7</p> <ul> <li>\u6807\u51c6\u5b50\u7f51\u63a9\u7801\uff1aA\u7c7b\uff0c<code>255.0.0.0</code>\uff1bB\u7c7b\uff0c<code>255.255.0.0</code>\uff1bC\u7c7b\uff0c<code>255.255.255.0</code>\uff1b</li> <li>\u7279\u6b8a\u5b50\u7f51\u63a9\u7801\uff1a\u7528\u4e8e\u7f51\u7edc\u5212\u5206\uff0c\u54ea\u4e9b\u4e3b\u673a\u662f\u540c\u4e00\u4e2a\u5b50\u7f51\uff1b</li> <li><code>131.1.123.23/27</code>\uff1a\u524d27\u4f4d\u662f\u7f51\u7edc\u4f4d\uff0c\u540e5\u4f4d\u662f\u4e3b\u673a\u4f4d\uff1b</li> </ul>"},{"location":"cs/network/network.html#_4","title":"\u6570\u636e\u62a5\u6587","text":"<ul> <li>\u7248\u672c\uff1aIP\u534f\u8bae\u7684\u7248\u672c\u3002\u8fd9\u91cc\u7248\u672c\u53f7\u4e3a4\u3002</li> <li>\u9996\u90e8\u957f\u5ea6\uff1a\u53ef\u8868\u793a\u7684\u6700\u5927\u6570\u503c\u662f15\u4e2a\u5355\u4f4d\uff084 \u5b57\u8282\u4e3a\u4e00\u4e2a\u5355\u4f4d\uff09\uff0c\u5373\u9996\u90e8\u957f\u5ea6\u6700\u591a60\u5b57\u8282\u3002</li> <li>\u533a\u5206\u670d\u52a1\uff1a\u4e0d\u540c\u4f18\u5148\u7ea7\u670d\u52a1\u8d28\u91cf\u4e0d\u540c\uff0c\u53ea\u6709\u5728\u4f7f\u7528\u533a\u5206\u670d\u52a1\uff08DiffServ\uff09\u65f6\u6709\u6548\u3002</li> <li>\u603b\u957f\u5ea6\uff1a\u9996\u90e8\u4e0e\u6570\u636e\u4e4b\u548c\u7684\u957f\u5ea6\uff0c\u6700\u5927\u957f\u5ea6\u4e3a2^16-1=65535\u5b57\u8282\u3002</li> <li>\u6807\u8bc6\uff1a\u552f\u4e00\u6807\u8bc6\u6570\u636e\u62a5\u7684\u6807\u8bc6\u7b26\u3002</li> <li>\u6807\u5fd7\uff1a\u4e2d\u95f4\u7684\u4e00\u4f4d\uff08DF\uff090\u8868\u793a\u5206\u7247\uff0c1\u8868\u793a \u4e0d\u5206\u7247\uff1b\u6700\u4f4e\u4f4d\uff08MF\uff09\uff0c0\u8868\u793a\u6700\u540e\u4e00\u4e2a\u5206\u7247\uff0c1\u8868\u793a\u8fd8\u6709\u5206\u7247\uff1b\u6700\u9ad8\u4f4d\u4fdd\u7559\u65e0\u7528\uff1b</li> <li>\u7247\u504f\u79fb\uff1a\u6307\u660e\u8be5\u6bb5\u5904\u4e8e\u539f\u6765\u6570\u636e\u62a5\u4e2d\u7684\u4f4d\u7f6e\uff0c\u4ee5 8 \u4e2a\u5b57\u8282\u4e3a\u504f\u79fb\u5355\u4f4d\u3002</li> <li>\u751f\u5b58\u65f6\u95f4\uff1a\u8bb0\u4e3aTTL\uff08Time To Live\uff09\uff0c\u6307\u793a\u6570\u636e\u62a5\u5728\u7f51\u7edc\u4e2d\u53ef\u901a\u8fc7\u7684\u8def\u7531\u5668\u7684\u6700\u5927\u503c\u3002\u9632\u6b62\u6570\u636e\u62a5\u65e0\u9650\u5faa\u73af\u4f20\u8f93</li> <li>\u534f\u8bae\uff1a\u6570\u636e\u62a5\u643a\u5e26\u7684\u534f\u8bae\uff08TCP\u3001UDP\u3001IGMP\u7b49\uff09</li> <li>\u9996\u90e8\u68c0\u9a8c\u548c\uff1a\u53ea\u68c0\u9a8c\u9996\u90e8\uff0c\u4e0d\u68c0\u9a8c\u6570\u636e\u3002\u91c7\u752816\u4f4d\u4e8c\u8fdb\u5236\u53cd\u7801\u6c42\u548c\u7b97\u6cd5\u3002</li> <li>\u53ef\u9009\u5b57\u6bb5\uff1a\u53ef\u8bb0\u5f55\u65f6\u95f4\u6233 \uff0c\u901a\u8fc7\u8def\u5f84\uff0c\u5b89\u5168\u4fe1\u606f\u7b49\u3002</li> <li>\u586b\u5145\uff1a\u586b\u5145\u4e3a4\u7684\u500d\u6570 \u3002</li> </ul>"},{"location":"cs/network/network.html#ipv6","title":"IPV6","text":""},{"location":"cs/network/network.html#_5","title":"\u5730\u5740","text":"<p>128\u4f4d\uff0c16\u4f4d\u4e3a\u4e00\u6bb5\uff0c\u5171 8 \u6bb5\uff0c\u5982<code>2001:0da8:d001:0001:0000:0000:0000:0001</code></p> <ul> <li><code>::</code>\u8868\u793a\u8fde\u7eed\u7684\u4e09\u4e2a<code>0000:0000:0000</code>\uff1b</li> </ul> <p>IPv4/IPv6\u7684\u8fc7\u6e21\u6280\u672f\uff1a</p> <ul> <li>\u53cc\u534f\u8bae\u6808\u6280\u672f\uff1a\u8282\u70b9\u540c\u65f6\u652f\u6301IPv4/IPv6\uff1b</li> <li>\u96a7\u9053\u6280\u672f\uff1a\u5728IPv4\u7f51\u7edc\u4e2d\u90e8\u7f72\u96a7\u9053\uff0c\u5b9e\u73b0IPv4\u7f51\u7edc\u5bf9IPv6\u7684\u4e1a\u52a1\u627f\u8f7d\uff0c\u5982 6to4 \u96a7\u9053\u30016over4 \u96a7\u9053\u3001ISATAP\u96a7\u9053\uff1b</li> <li>NAT-PT\u6280\u672f\uff1a\u4f7f\u7528\u7f51\u5173\u8bbe\u5907\u8fde\u63a5 IPv6 \u548c IPv4 \u7f51\u7edc\uff0c\u5f53 IPv4 \u548c IPv6 \u8282\u70b9\u4e92\u76f8\u8bbf\u95ee\u65f6\uff0cNAT-PT \u7f51\u5173\u5b9e\u73b0\u534f\u8bae\u8f6c\u6362\u548c\u5730\u5740\u6620\u5c04\uff1b</li> </ul>"},{"location":"cs/network/network.html#_6","title":"\u62a5\u6587","text":"<ul> <li>\u7248\u672c\uff1aIP\u534f\u8bae\u7684\u7248\u672c\u3002\u8fd9\u91cc\u7248\u672c\u53f7\u4e3a6\u3002</li> <li>\u6d41\u91cf\u5206\u7c7b\uff1a\u901a\u4fe1\u7c7b\u578b\uff0c\u76f8\u5f53\u4e8eIPV4\u670d\u52a1\u7c7b\u578b\u5b57\u6bb5\u3002</li> <li>\u6d41\u6807\u7b7e\uff1a\u4ece\u6e90\u70b9\u5230\u7ec8\u70b9\u7684\u4e00\u7cfb\u5217\u6570\u636e\u62a5\uff0c\u540c\u4e00\u4e2a\u6d41\u4e0a\u7684\u6570\u636e\u62a5\u6807\u7b7e\u76f8\u540c\uff0c\u4fdd\u8bc1\u670d\u52a1\u8d28\u91cf\u3002</li> <li>\u6709\u6548\u8d1f\u8f7d\u957f\u5ea6\uff1a\u9664\u57fa\u672c\u9996\u90e8\u4ee5\u5916\u7684\u5b57\u8282\u6570\uff08\u6240\u6709\u6269\u5c55\u9996\u90e8\u90fd\u7b97\u5728\u6709\u6548\u8d1f\u8f7d\u5185\uff09\uff0c\u6700\u5927\u503c64KB</li> <li>\u4e0b\u4e00\u5934\u90e8\uff1a\u76f8\u5f53\u4e8eIPV4\u7684\u534f\u8bae\u5b57\u6bb5\u6216\u53ef\u9009\u5b57\u6bb5\u3002</li> <li>\u8df3\u6570\u9650\u5236\uff1a\u7528\u4e8e\u68c0\u6d4b\u8def\u7531\u5faa\u73af\uff0c\u8def\u7531\u5668\u5728\u8f6c\u53d1\u6570\u636e\u62a5\u65f6\u5bf9\u8fd9\u4e2a\u5b57\u6bb5\u51cf1\uff0c\u53d8\u62100\u4e22\u5f03\u8be5\u6570\u636e\u62a5\u3002</li> </ul> <p>IPv6\u6570\u636e\u62a5\u7684\u76ee\u7684\u5730\u5740\u53ef\u4ee5\u662f\u4ee5\u4e0b\u4e09\u79cd\u57fa\u672c\u7c7b\u578b\u5730\u5740\u4e4b\u4e00\u2236</p> <ul> <li>\u5355\u64ad\uff08\uff08unicast\uff09\u2236\u4f20\u7edf\u7684\u70b9\u5bf9\u70b9\u901a\u4fe1\uff1b</li> <li>\u591a\u64ad/\u7ec4\u64ad\uff08multicast\uff09\u2236\u4e00\u70b9\u5bf9\u591a\u70b9\u7684\u901a\u4fe1\u3002</li> <li>\u4efb\u64ad\uff08anycast\uff09\u2236\u8fd9\u662f IPv6\u589e\u52a0\u7684\u4e00\u79cd\u7c7b\u578b\u3002\u4efb\u64ad\u7684\u76ee\u7684\u7ad9\u662f\u4e00\u7ec4\u8ba1\u7b97\u673a\uff0c\u4f46\u6570\u636e\u62a5\u5728\u4ea4\u4ed8\u65f6\u53ea\u4ea4\u4ed8\u5176\u4e2d\u7684\u4e00\u4e2a\uff0c\u901a\u5e38\u662f\u8ddd\u79bb\u6700\u8fd1\u7684\u4e00\u4e2a\u3002</li> </ul>"},{"location":"cs/network/network.html#ipsec","title":"IPSec","text":"<p>Internet Protocol Security\uff1a\u662f\u4e00\u4e2a\u534f\u8bae\u5305\uff0c\u901a\u8fc7\u5bf9 IP\u534f\u8bae\u7684\u5206\u7ec4\u8fdb\u884c\u52a0\u5bc6\u548c\u8ba4\u8bc1\u6765\u4fdd\u62a4 IP \u534f\u8bae\u7684\u7f51\u7edc\u4f20\u8f93\u534f\u8bae\u7c07\uff08\u4e00\u4e9b\u76f8\u4e92\u5173\u8054\u7684\u534f\u8bae\u7684\u96c6\u5408\uff09\u3002</p> <ul> <li>\u8ba4\u8bc1\u5934\uff1a\u7528\u4e8e\u6570\u636e\u5b8c\u6574\u6027\u8ba4\u8bc1\u548c\u6570\u636e\u6e90\u8ba4\u8bc1\uff1b</li> <li>\u5c01\u88c5\u5b89\u5168\u8d1f\u8377\uff1a\u63d0\u4f9b\u6570\u636e\u4fdd\u5bc6\u6027\u548c\u5b8c\u6574\u6027\u8ba4\u8bc1\uff0c\u5305\u62ec\u9632\u6b62\u91cd\u653e\u653b\u51fb\u7684\u987a\u5e8f\u53f7\uff1b</li> <li>Internet\u5bc6\u94a5\u4ea4\u6362\u534f\u8bae\uff1a\u751f\u6210\u548c\u5206\u53d1\u5728ESP\u548cAH\u4e2d\u4f7f\u7528\u7684\u5bc6\u94a5\uff0c\u5bf9\u8fdc\u7a0b\u7cfb\u7edf\u8fdb\u884c\u521d\u59cb\u8ba4\u8bc1\uff1b</li> </ul> <p>IPSec \u6a21\u5f0f\uff1a</p> <ul> <li>\u4f20\u8f93\u6a21\u5f0f\uff1aIP\u5934\u6ca1\u6709\u52a0\u5bc6\uff0c\u53ea\u662f\u5bf9IP\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\uff1b</li> <li>\u96a7\u9053\u6a21\u5f0f\uff1a\u5bf9\u539f\u6765\u7684IP\u6570\u636e\u5305\u8fdb\u884c\u5c01\u88c5\u548c\u52a0\u5bc6\uff0c\u52a0\u4e0a\u65b0\u7684IP\u5934\uff1b</li> </ul>"},{"location":"cs/network/network.html#arp","title":"ARP","text":"<p>Address Resolution Protocol\uff1a\u5730\u5740\u89e3\u6790\u534f\u8bae\uff0cIP\u5730\u5740\u5230MAC\u5730\u5740</p> <p>\u5de5\u4f5c\u6d41\u7a0b\uff1a</p> <ul> <li>\u4e3b\u673a\u6709ARP\u7f13\u51b2\u4fdd\u5b58ARP\u5217\u8868\uff0c\u4fdd\u5b58IP\u5730\u5740\u5230MAC\u5730\u5740\u5bf9\u5e94\u5173\u7cfb\uff1b</li> <li>\u6e90\u4e3b\u673a\u53d1\u9001\u6570\u636e\uff0c\u67e5\u770bARP\u5217\u8868\u662f\u5426\u6709\u76ee\u7684\u4e3b\u673aIP\u7684MAC\u5730\u5740\uff0c\u6709\u5219\u76f4\u63a5\u53d1\u9001\uff1b\u5426\u5219\uff0c\u5411\u672c\u7f51\u6bb5\u6240\u6709\u4e3b\u673a\u53d1\u9001ARP\u6570\u636e\u5305\uff0c\u5305\u542b\u5185\u5bb9\uff1a<code>\u6e90\u4e3b\u673aIP\uff0c\u6e90\u4e3b\u673aMAC\uff0c\u76ee\u7684\u4e3b\u673aIP</code>\uff1b</li> <li>\u672c\u7f51\u7edc\u5176\u4ed6\u4e3b\u673a\u63a5\u53d7ARP\u6570\u636e\u5305\uff0cIP\u5730\u5740\u4e0d\u5339\u914d\u76ee\u7684\u4e3b\u673aIP\u5730\u5740\uff0c\u5ffd\u7565\uff1b\u5339\u914d\uff0c\u5219\u5c06\u6e90\u4e3b\u673aIP\u548cMAC\u5730\u5740\u52a0\u5165ARP\u7f13\u5b58\uff08\u5b58\u5728\u5219\u8986\u76d6\uff09\uff0c\u7136\u540e\u5c06\u81ea\u5df1MAC\u5730\u5740\u5199\u5165ARP\u54cd\u5e94\u5305\u4e2d\uff0c\u5373\u544a\u8bc9\u6e90\u4e3b\u673a\u76ee\u7684\u4e3b\u673aMAC\u5730\u5740\uff1b</li> <li>\u6e90\u4e3b\u673a\u63a5\u53d7ARP\u54cd\u5e94\u5305\u540e\uff0c\u5c06\u76ee\u7684\u4e3b\u673aIP\u548cMAC\u5199\u5165ARP\u7f13\u5b58\uff0c\u5e76\u53d1\u9001\u6570\u636e\uff1b\u82e5\u6e90\u4e3b\u673a\u4e00\u76f4\u672a\u6536\u5230ARP\u54cd\u5e94\uff0c\u5219ARP\u67e5\u8be2\u5931\u8d25\uff1b</li> <li>\u5e7f\u64ad\u53d1\u9001ARP\u8bf7\u6c42\uff0c\u5355\u64ad\u53d1\u9001ARP\u54cd\u5e94\uff1b</li> </ul>"},{"location":"cs/network/network.html#rarp","title":"RARP","text":"<p>Reverse Address Resolution Protocol\uff1a\u9006\u5730\u5740\u89e3\u6790\u534f\u8bae\uff0cMAC\u5730\u5740\u5230IP\u5730\u5740</p> <pre><code># -b \u4fdd\u6301\u5e7f\u64ad  -I \u6307\u5b9a\u7f51\u5361  -s \u6307\u5b9a\u6e90IP\u5730\u5740  -c \u53d1\u9001\u7684\u6570\u636e\u5305\u7684\u6570\u76ee\n$ ifconfig eth0:1 10.90.143.176 netmask 255.255.255.0 up\n$ /sbin/arping -b -I eth0 -s \"10.90.143.176\" \"10.90.143.1\" -c 4\n</code></pre>"},{"location":"cs/network/network.html#_7","title":"\u96a7\u9053\u534f\u8bae","text":"<ul> <li>\u96a7\u9053\u534f\u8bae\uff1a\u4f7f\u7528\u4e00\u79cd\u7f51\u7edc\u534f\u8bae\uff08\u53d1\u9001\u534f\u8bae\uff09\uff0c\u5c06\u53e6\u4e00\u4e2a\u4e0d\u540c\u7684\u7f51\u7edc\u534f\u8bae\u5c01\u88c5\u5728\u8d1f\u8f7d\u90e8\u5206\uff0c\u70b9\u5bf9\u70b9\u7684\u8fde\u63a5\uff0c\u4e24\u7aef\u90fd\u9700\u8981\u914d\u7f6e\u96a7\u9053\u534f\u8bae\uff1b</li> <li> <p>\u5982 6to4 \u96a7\u9053\u30016over4 \u96a7\u9053\u3001ISATAP\u96a7\u9053\uff1b</p> </li> <li> <p>VPN\u96a7\u9053\u534f\u8bae\uff1aVPN Server\u5c06private ip\u53d1\u9001\u7684\u5305\u4f5c\u4e3a\u8d1f\u8f7d\uff0c\u53d1\u9001\u7ed9\u53e6\u4e00\u4e2aVPN server\u89e3\u6790\uff1b</p> </li> </ul>"},{"location":"cs/network/trans_protocols.html","title":"\u4f20\u8f93\u5c42\u534f\u8bae","text":""},{"location":"cs/network/trans_protocols.html#tcp","title":"TCP","text":"<p>\u4f20\u8f93\u63a7\u5236\u534f\u8bae\uff08Transmission Control Protocol\uff0cTCP\uff09\u662f\u4e00\u79cd\u53ef\u9760\u7684\u3001\u9762\u5411\u8fde\u63a5\u7684\u5b57\u8282\u6d41\u670d\u52a1\u3002</p> <p></p>"},{"location":"cs/network/trans_protocols.html#_2","title":"\u62a5\u6587","text":""},{"location":"cs/network/trans_protocols.html#_3","title":"\u4e09\u6b21\u63e1\u624b\u534f\u8bae","text":"<p>\u4e0d\u8bba\u63e1\u624b\u591a\u5c11\u6b21\u90fd\u4e0d\u80fd\u786e\u8ba4\u4e00\u6761\u4fe1\u9053\u4e00\u5b9a\u662f\u201c\u53ef\u9760\u201d\u7684\uff0c\u4f46\u901a\u8fc73\u6b21\u63e1\u624b\u53ef\u4ee5\u81f3\u5c11\u786e\u8ba4\u5b83\u662f\u201c\u53ef\u7528\u201d\u7684\u3002</p> <p>\u63e1\u624b\u6210\u529f\u53ea\u80fd\u8bf4\u660e\u63e1\u624b\u65f6\u7684\u901a\u4fe1\u662f\u6b63\u5e38\u7684\uff0c\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u63e1\u624b\u540e\u7684\u901a\u4fe1\u662f\u6b63\u5e38\u7684\u3002</p> <p>\u4e24\u6b21\u63e1\u624b\u7684\u95ee\u9898\uff1a</p> <ul> <li>\u9632\u6b62\u5df2\u5931\u6548\u7684\u8fde\u63a5\u8bf7\u6c42\u62a5\u6587\u6bb5\u7a81\u7136\u53c8\u4f20\u9001\u5230\u4e86\u670d\u52a1\u7aef\uff0c\u9020\u6210\u670d\u52a1\u7aef\u8d44\u6e90\u7684\u6d6a\u8d39\u3002</li> </ul> <p></p> <p>\u4e09\u6b21\u63e1\u624b\uff1a</p> <ul> <li>\u7b2c\u4e00\u6b21\uff1a\u5ba2\u6237\u7aef\u53d1\u9001syn\u5305(syn=x)\u5230\u670d\u52a1\u5668\uff0c\u5e76\u8fdb\u5165SYN_SEND\u72b6\u6001\uff0c\u7b49\u5f85\u670d\u52a1\u5668\u786e\u8ba4\uff1b</li> <li>\u7b2c\u4e8c\u6b21\uff1a\u670d\u52a1\u5668\u6536\u5230syn\u5305\uff0c\u5fc5\u987b\u786e\u8ba4\u5ba2\u6237\u7684SYN\uff08ack=x+1\uff09\uff0c\u540c\u65f6\u81ea\u5df1\u4e5f\u53d1\u9001\u4e00\u4e2aSYN\u5305\uff08syn=y\uff09\uff0c\u5373SYN+ACK\u5305\uff0c\u6b64\u65f6\u670d\u52a1\u5668\u8fdb\u5165SYN_RECV\u72b6\u6001\uff1b</li> <li>\u7b2c\u4e09\u6b21\uff1a\u5ba2\u6237\u7aef\u6536\u5230\u670d\u52a1\u5668\u7684SYN\uff0bACK\u5305\uff0c\u5411\u670d\u52a1\u5668\u53d1\u9001\u786e\u8ba4\u5305ACK(ack=y+1)\uff0c\u6b64\u5305\u53d1\u9001\u5b8c\u6bd5\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u8fdb\u5165ESTABLISHED\u72b6\u6001\uff0c\u5b8c\u6210\u4e09\u6b21\u63e1\u624b\u3002</li> </ul>"},{"location":"cs/network/trans_protocols.html#_4","title":"\u56db\u6b21\u6325\u624b","text":"<p>TIME_WAIT\uff1a\u4e3b\u52a8\u8981\u6c42\u5173\u95ed\u7684\u673a\u5668\u8868\u793a\u6536\u5230\u5bf9\u65b9\u7684FIN\u62a5\u6587\uff0c\u5e76\u53d1\u9001\u51faACK\u62a5\u6587\uff1b</p> <ul> <li>\u7b49\u5f85\u7684 2MSL \u662f\u62a5\u6587\u5728\u7f51\u7edc\u4e0a\u751f\u5b58\u7684\u6700\u957f\u65f6\u95f4\uff0c\u8d85\u8fc7\u9601\u503c\u4fbf\u5c06\u62a5\u6587\u4e22\u5f03\uff1b</li> <li>\u786e\u4fdd\u88ab\u52a8\u65b9\u4f1a\u63a5\u6536\u5230 ACK\uff0c\u53d8\u6210 CLOSED \u72b6\u6001\uff1b</li> <li>TIME_WAIT \u72b6\u6001\u65e0\u6cd5\u91ca\u653e\u53e5\u67c4\u8d44\u6e90\uff0c\u5bf9\u4e8e\u670d\u52a1\u5668\u6765\u8bf4\uff0c\u9650\u5236\u6709\u6548\u8fde\u63a5\u7684\u521b\u5efa\u6570\u91cf\uff0c\u6210\u4e3a\u6027\u80fd\u74f6\u9888\uff1b</li> </ul> <p>CLOSE_WAIT\uff1a\u88ab\u52a8\u8981\u6c42\u5173\u95ed\u7684\u673a\u5668\u6536\u5230\u5bf9\u65b9\u8bf7\u6c42\u5173\u95ed\u8fde\u63a5\u7684FIN\u62a5\u6587\uff0c\u5728\u7b2c\u4e00\u6b21ACK\u5e94\u7b54\u540e\uff1b</p>"},{"location":"cs/network/trans_protocols.html#tcp_1","title":"TCP\u4fdd\u6d3b","text":"<p>\u4fdd\u6d3b\u529f\u80fd\u4e3b\u8981\u662f\u4e3a\u670d\u52a1\u5668\u63d0\u4f9b\u7684\uff0c\u670d\u52a1\u5668\u53ef\u80fd\u4f1a\u4ee3\u8868\u5ba2\u6237\u7ed1\u5b9a\u4e00\u4e9b\u8d44\u6e90\uff0c\u5e0c\u671b\u77e5\u9053\u5ba2\u6237\u4e3b\u673a\u662f\u5426\u5d29\u6e83\u3002</p> <p>\u5ba2\u6237\u7aef\u4e5f\u53ef\u4ee5\u8bbe\u7f6eSocket\u4fdd\u6d3b\uff0c\u8bbe\u7f6e\u7684\u4e00\u65b9\u4f1a\u5411\u5bf9\u7aef\u53d1\u9001Keepalive\u62a5\u6587\uff1b</p> <p>\u5982\u679c\u4e00\u4e2a\u7ed9\u5b9a\u7684\u8fde\u63a5\u57282\u4e2a\u5c0f\u65f6\u4e4b\u5185\u6ca1\u6709\u4efb\u4f55\u52a8\u4f5c\uff0c\u5219\u670d\u52a1\u5668\u5c31\u5411\u5ba2\u6237\u53d1\u9001\u4e00\u4e2a\u63a2\u67e5\u62a5\u6587\u6bb5\uff1a</p> <ul> <li>\u5bf9\u7aef\u4ecd\u7136\u8fd0\u884c\u6b63\u5e38</li> </ul> <p>\u5ba2\u6237\u4e3b\u673a\u4f9d\u7136\u6b63\u5e38\u8fd0\u884c\uff0c\u5e76\u4e14\u670d\u52a1\u5668\u53ef\u8fbe\u3002\u5219\u5ba2\u6237\u7684TCP\u54cd\u5e94\u6b63\u5e38\uff0c\u800c\u670d\u52a1\u5668\u4e5f\u77e5\u9053\u5bf9\u65b9\u662f\u6b63\u5e38\u5de5\u4f5c\u7684\uff0c\u5219\u670d\u52a1\u5668\u57282\u5c0f\u65f6\u5185\u4ee5\u540e\u5c06\u4fdd\u6d3b\u5b9a\u65f6\u5668\u590d\u4f4d\u3002\u5728\u8fd92\u5c0f\u65f6\u4ee5\u5185\uff0c\u5982\u679c\u6709\u6570\u636e\u6d41\u4ea4\u6362\uff0c\u5219\u5728\u4ea4\u6362\u6570\u636e\u540e\u7684\u672a\u67652\u5c0f\u65f6\u518d\u590d\u4f4d\u3002</p> <ul> <li>\u5bf9\u7aef\u5df2\u7ecf\u5d29\u6e83</li> </ul> <p>\u5ba2\u6237\u4e3b\u673a\u5df2\u7ecf\u5d29\u6e83\uff0c\u5e76\u4e14\u5173\u95ed\u6216\u8005\u6b63\u5728\u91cd\u65b0\u542f\u52a8\u3002\u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\uff0c\u5ba2\u6237\u7684TCP\u90fd\u6ca1\u6709\u54cd\u5e94\u3002\u670d\u52a1\u5668\u4e0d\u80fd\u591f\u6536\u5230\u5bf9\u63a2\u67e5\u7684\u54cd\u5e94\uff0c\u5e76\u572875\u79d2\u540e\u8d85\u65f6(\u670d\u52a1\u5668\u603b\u5171\u53d1\u900110\u4e2a\u8fd9\u6837\u7684\u63a2\u67e5\uff0c\u6bcf\u4e2a\u95f4\u969475\u79d2)\u3002\u5982\u679c\u670d\u52a1\u5668\u6ca1\u6709\u6536\u5230\u4e00\u4e2a\u54cd\u5e94\uff0c\u5219\u8ba4\u4e3a\u5ba2\u6237\u4e3b\u673a\u5df2\u7ecf\u5173\u95ed\u5e76\u4f1a\u7ec8\u6b62\u8fd9\u4e2a\u8fde\u63a5\u3002</p> <ul> <li>\u5bf9\u7aef\u5df2\u7ecf\u5d29\u6e83\u5e76\u91cd\u65b0\u542f\u52a8</li> </ul> <p>\u5ba2\u6237\u4e3b\u673a\u5d29\u6e83\u5e76\u5df2\u7ecf\u91cd\u65b0\u542f\u52a8\u3002\u8fd9\u65f6\u670d\u52a1\u5668\u5c06\u6536\u5230\u4e00\u4e2a\u5bf9\u5176\u4fdd\u6d3b\u63a2\u67e5\u7684\u54cd\u5e94\uff0c\u7136\u800c\u8fd9\u4e2a\u54cd\u5e94\u662f\u4e00\u4e2a\u590d\u4f4d\uff0c\u4f7f\u5f97\u670d\u52a1\u5668\u7ec8\u6b62\u8fd9\u4e2a\u8fde\u63a5\u3002</p> <ul> <li>\u5bf9\u7aef\u5f53\u524d\u65e0\u6cd5\u5230\u8fbe</li> </ul> <p>\u5ba2\u6237\u4e3b\u673a\u6b63\u5e38\u8fd0\u884c\uff0c\u4f46\u662f\u670d\u52a1\u5668\u4e0d\u53ef\u8fbe\u3002</p>"},{"location":"cs/network/trans_protocols.html#_5","title":"\u53c2\u6570\u89e3\u91ca","text":"<p>SO_KEEPALIVE \u7528\u4e8e\u5f00\u542f\u6216\u8005\u5173\u95ed\u4fdd\u6d3b\u63a2\u6d4b\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f\u5173\u95ed\u7684\u3002</p> <ul> <li> <p><code>net.ipv4.tcp_keepalive_intvl = 75</code> \uff08\u53d1\u9001\u63a2\u6d4b\u5305\u7684\u5468\u671f\uff0c\u524d\u63d0\u662f\u5f53\u524d\u8fde\u63a5\u4e00\u76f4\u6ca1\u6709\u6570\u636e\u4ea4\u4e92\uff0c\u624d\u4f1a\u4ee5\u8be5\u9891\u7387\u8fdb\u884c\u53d1\u9001\u63a2\u6d4b\u5305\uff0c\u5982\u679c\u4e2d\u9014\u6709\u6570\u636e\u4ea4\u4e92\uff0c\u5219\u4f1a\u91cd\u65b0\u8ba1\u65f6tcp_keepalive_time\uff0c\u5230\u8fbe\u89c4\u5b9a\u65f6\u95f4\u6ca1\u6709\u6570\u636e\u4ea4\u4e92\uff0c\u624d\u4f1a\u91cd\u65b0\u4ee5\u8be5\u9891\u7387\u53d1\u9001\u63a2\u6d4b\u5305\uff09</p> </li> <li> <p><code>net.ipv4.tcp_keepalive_probes = 9</code> \uff08\u63a2\u6d4b\u5931\u8d25\u7684\u91cd\u8bd5\u6b21\u6570\uff0c\u53d1\u9001\u63a2\u6d4b\u5305\u8fbe\u6b21\u6570\u9650\u5236\u5bf9\u65b9\u4f9d\u65e7\u6ca1\u6709\u56de\u5e94\uff0c\u5219\u5173\u95ed\u81ea\u5df1\u8fd9\u7aef\u7684\u8fde\u63a5\uff09</p> </li> <li> <p><code>net.ipv4.tcp_keepalive_time</code> = 7200 \uff08\u7a7a\u95f2\u591a\u957f\u65f6\u95f4\uff0c\u5219\u53d1\u9001\u63a2\u6d4b\u5305\uff09</p> </li> </ul>"},{"location":"cs/network/trans_protocols.html#_6","title":"\u5168\u5c40\u4fee\u6539","text":"<p>\u5728Linux\u4e2d\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539<code>/etc/sysctl.conf</code> \u7684\u5168\u5c40\u914d\u7f6e\uff1a</p> <pre><code>net.ipv4.tcp_keepalive_time=7200\nnet.ipv4.tcp_keepalive_intvl=75\nnet.ipv4.tcp_keepalive_probes=9\n</code></pre> <p>\u6dfb\u52a0\u4e0a\u9762\u7684\u914d\u7f6e\u540e\u8f93\u5165 <code>sysctl -p</code> \u4f7f\u5176\u751f\u6548\uff0c\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u6765\u67e5\u770b\u5f53\u524d\u7684\u9ed8\u8ba4\u914d\u7f6e</p> <pre><code>sysctl -a | grep keepalive \n</code></pre> <p>\u5982\u679c\u5e94\u7528\u4e2d\u5df2\u7ecf\u8bbe\u7f6eSO_KEEPALIVE\uff0c\u7a0b\u5e8f\u4e0d\u7528\u91cd\u542f\uff0c\u5185\u6838\u76f4\u63a5\u751f\u6548\u3002</p>"},{"location":"cs/network/trans_protocols.html#socket","title":"\u5355socket\u4fee\u6539","text":"<p>TCP_KEEPCNT\u3001TCP_KEEPIDLE\u3001TCP_KEEPINTVL</p> <p>C \u53ef\u4ee5\u5bf9\u5355\u4e2asocket\u8bbe\u7f6e\u4e0d\u540c\u7684keepalive\u53c2\u6570\uff0c\u4f46\u662f Java Socket \u53ea\u80fd\u8bbe\u7f6ekeepalive\u662f\u5426\u5f00\u542f\u3002</p>"},{"location":"cs/network/trans_protocols.html#_7","title":"\u4e2d\u95f4\u8bbe\u5907","text":"<p>\u4e2d\u95f4\u8bbe\u5907\u5982\u9632\u706b\u5899\u7b49\uff0c\u4f1a\u4e3a\u7ecf\u8fc7\u5b83\u7684\u6570\u636e\u62a5\u6587\u5efa\u7acb\u76f8\u5173\u7684\u8fde\u63a5\u4fe1\u606f\u8868\uff0c\u5e76\u4e3a\u5176\u8bbe\u7f6e\u4e00\u4e2a\u8d85\u65f6\u65f6\u95f4\u7684\u5b9a\u65f6\u5668\uff0c\u5982\u679c\u8d85\u51fa\u9884\u5b9a\u65f6\u95f4\uff0c\u67d0\u8fde\u63a5\u65e0\u4efb\u4f55\u62a5\u6587\u4ea4\u4e92\u7684\u8bdd\uff0c\u4e2d\u95f4\u8bbe\u5907\u4f1a\u5c06\u8be5\u8fde\u63a5\u4fe1\u606f\u4ece\u8868\u4e2d\u5220\u9664\uff0c\u5728\u5220\u9664\u540e\uff0c\u518d\u6709\u5e94\u7528\u62a5\u6587\u8fc7\u6765\u65f6\uff0c\u4e2d\u95f4\u8bbe\u5907\u5c06\u4e22\u5f03\u8be5\u62a5\u6587\uff0c\u4ece\u800c\u5bfc\u81f4\u5e94\u7528\u51fa\u73b0\u5f02\u5e38\uff0c\u8fd9\u4e2a\u4ea4\u4e92\u7684\u8fc7\u7a0b\u5927\u81f4\u5982\u4e0b\u56fe\u6240\u793a\uff1a  </p> <p></p>"},{"location":"cs/network/trans_protocols.html#_8","title":"\u5b9e\u8df5\uff08\u5fc3\u8df3\uff09","text":"<p>\u4f46\u662f\u65e5\u5e38\u66f4\u591a\u7684\u662f\u5728\u5e94\u7528\u5c42\u52a0\u5165\u5fc3\u8df3\u5305\u673a\u5236\uff0c\u56e0\u4e3aTCP\u7684\u8fd9\u4e2a\u4fdd\u6d3b\u673a\u5236\u7531\u51e0\u4e2a\u7f3a\u9677\uff1a</p> <ul> <li>keepalive\u53ea\u80fd\u68c0\u6d4b\u8fde\u63a5\u662f\u5426\u5b58\u6d3b\uff0c\u4e0d\u80fd\u68c0\u6d4b\u8fde\u63a5\u662f\u5426\u53ef\u7528\u3002\u6bd4\u5982\u670d\u52a1\u5668\u56e0\u4e3a\u8d1f\u8f7d\u8fc7\u9ad8\u5bfc\u81f4\u65e0\u6cd5\u54cd\u5e94\u8bf7\u6c42\u4f46\u662f\u8fde\u63a5\u4ecd\u7136\u5b58\u5728\uff0c\u6b64\u65f6keepalive\u65e0\u6cd5\u5224\u65ad\u8fde\u63a5\u662f\u5426\u53ef\u7528\u3002</li> <li>\u5982\u679cTCP\u8fde\u63a5\u4e2d\u7684\u53e6\u4e00\u65b9\u56e0\u4e3a\u505c\u7535\u7a81\u7136\u65ad\u7f51\uff0c\u6211\u4eec\u5e76\u4e0d\u77e5\u9053\u8fde\u63a5\u65ad\u5f00\uff0c\u6b64\u65f6\u53d1\u9001\u6570\u636e\u5931\u8d25\u4f1a\u8fdb\u884c\u91cd\u4f20\uff0c\u7531\u4e8e\u91cd\u4f20\u5305\u7684\u4f18\u5148\u7ea7\u8981\u9ad8\u4e8ekeepalive\u7684\u6570\u636e\u5305\uff0c\u56e0\u6b64keepalive\u7684\u6570\u636e\u5305\u65e0\u6cd5\u53d1\u9001\u51fa\u53bb\u3002\u53ea\u6709\u5728\u957f\u65f6\u95f4\u7684\u91cd\u4f20\u5931\u8d25\u4e4b\u540e\u6211\u4eec\u624d\u80fd\u5224\u65ad\u6b64\u8fde\u63a5\u65ad\u5f00\u4e86\u3002</li> </ul>"},{"location":"cs/network/trans_protocols.html#_9","title":"\u4f20\u8f93","text":""},{"location":"cs/network/trans_protocols.html#_10","title":"\u6162\u5f00\u59cb\u548c\u62e5\u585e\u63a7\u5236","text":"<p>\u62e5\u585e\u7a97\u53e3\uff08\u53d1\u9001\u65b9\u7ef4\u6301\uff09\u7684\u5927\u5c0f\u53d6\u51b3\u4e8e\u7f51\u7edc\u7684\u62e5\u585e\u7a0b\u5ea6\uff0c\u5e76\u4e14\u52a8\u6001\u5730\u5728\u53d8\u5316\u3002</p> <ul> <li>\u7f51\u7edc\u6ca1\u6709\u51fa\u73b0\u62e5\u585e\uff0c\u62e5\u585e\u7a97\u53e3\u5c31\u589e\u5927\u4e00\u4e9b\uff0c\u4ee5\u4fbf\u628a\u66f4\u591a\u7684\u5206\u7ec4\u53d1\u9001\u51fa\u53bb\u3002\u4f46\u53ea\u8981\u7f51\u7edc\u51fa\u73b0\u62e5\u585e\uff0c\u62e5\u585e\u7a97\u53e3\u5c31\u51cf\u5c0f\u4e00\u4e9b\uff0c\u4ee5\u51cf\u5c11\u6ce8\u5165\u5230\u7f51\u7edc\u4e2d\u7684\u5206\u7ec4\u6570</li> </ul> <p>cwnd\u53d1\u9001\u65b9\u7ef4\u6301\u7684\u62e5\u585e\u7a97\u53e3\uff0c\u6162\u5f00\u59cb\u9650\u5236\u9608\u503c ssthresh</p> <p>\u5f53cwnd&lt;ssthresh\u65f6\uff0c\u4f7f\u7528\u6162\u5f00\u59cb\u7b97\u6cd5\u3002</p> <p>\u5f53cwnd&gt;ssthresh\u65f6\uff0c\u6539\u7528\u62e5\u585e\u907f\u514d\u7b97\u6cd5\u3002</p> <p>\u5f53cwnd=ssthresh\u65f6\uff0c\u6162\u5f00\u59cb\u4e0e\u62e5\u585e\u907f\u514d\u7b97\u6cd5\u4efb\u610f\u3002</p> <p>\u6162\u5f00\u59cb\uff1a\u4ece1\u5f00\u59cb\uff0c\u6307\u6570\u589e\u957f\u76f4\u81f3\u5927\u4e8e\u9608\u503c</p> <p>\u62e5\u585e\u63a7\u5236\uff1a\u6bcf\u6b21\u53ea\u589e\u957f1</p> <p>\u62e5\u585e\u65f6\uff08\u6ca1\u6709\u6309\u65f6\u6536\u5230\u786e\u8ba4\uff09\uff1a\u9608\u503c\u51cf\u534a\uff0c\u91cd\u65b0\u6162\u5f00\u59cb</p> <p></p>"},{"location":"cs/network/trans_protocols.html#_11","title":"\u5feb\u91cd\u4f20\u548c\u5feb\u6062\u590d","text":"<p>\u5feb\u91cd\u4f20\u914d\u5408\u4f7f\u7528\u7684\u8fd8\u6709\u5feb\u6062\u590d\u7b97\u6cd5:</p> <ul> <li>\u5f53\u53d1\u9001\u65b9\u8fde\u7eed\u6536\u5230\u4e09\u4e2a\u91cd\u590d\u786e\u8ba4\u65f6\uff0c\u5c31\u6267\u884c\u201c\u4e58\u6cd5\u51cf\u5c0f\u201d\u7b97\u6cd5\uff0c\u628assthresh\u95e8\u9650\u51cf\u534a\u3002\u4f46\u662f\u63a5\u4e0b\u53bb\u5e76\u4e0d\u6267\u884c\u6162\u5f00\u59cb\u7b97\u6cd5\u3002</li> <li>\u8003\u8651\u5230\u5982\u679c\u7f51\u7edc\u51fa\u73b0\u62e5\u585e\u7684\u8bdd\u5c31\u4e0d\u4f1a\u6536\u5230\u597d\u51e0\u4e2a\u91cd\u590d\u7684\u786e\u8ba4\uff0c\u6240\u4ee5\u53d1\u9001\u65b9\u73b0\u5728\u8ba4\u4e3a\u7f51\u7edc\u53ef\u80fd\u6ca1\u6709\u51fa\u73b0\u62e5\u585e\u3002\u6240\u4ee5\u6b64\u65f6\u4e0d\u6267\u884c\u6162\u5f00\u59cb\u7b97\u6cd5\uff0c\u800c\u662f\u5c06cwnd\u8bbe\u7f6e\u4e3assthresh\u7684\u5927\u5c0f\uff0c\u7136\u540e\u6267\u884c\u62e5\u585e\u907f\u514d\u7b97\u6cd5</li> </ul> <p></p>"},{"location":"cs/network/trans_protocols.html#udp","title":"UDP","text":"<p>\u7528\u6237\u6570\u636e\u62a5\u534f\u8bae\uff08User Datagram Protocol\uff0cUDP\uff09\u662f\u4e00\u79cd\u4e0d\u53ef\u9760\u7684\u3001\u65e0\u8fde\u63a5\u7684\u6570\u636e\u62a5\u670d\u52a1\u3002\u6e90\u4e3b\u673a\u5728\u4f20\u9001\u6570\u636e\u524d\u4e0d\u9700\u8981\u548c\u76ee\u6807\u4e3b\u673a\u5efa\u7acb\u8fde\u63a5\u3002</p>"},{"location":"cs/network/trans_protocols.html#_12","title":"\u62a5\u6587","text":""},{"location":"cs/network/trans_protocols.html#_13","title":"\u5bf9\u6bd4","text":"<ul> <li>UDP\u662f\u65e0\u8fde\u63a5\u7684\uff0c\u53d1\u9001\u6570\u636e\u4e4b\u524d\u4e0d\u9700\u8981\u5efa\u7acb\u8fde\u63a5\uff0c\u56e0\u6b64\u51cf\u5c11\u4e86\u5f00\u9500\u548c\u53d1\u9001\u6570\u636e\u4e4b\u524d\u7684\u65f6\u5ef6\uff1b</li> <li>UDP\u4f7f\u7528\u5c3d\u6700\u5927\u52aa\u529b\u4ea4\u4ed8\uff0c\u5373\u4e0d\u4fdd\u8bc1\u53ef\u9760\u4ea4\u4ed8\uff0c\u56e0\u6b64\u4e3b\u673a\u4e0d\u9700\u8981\u7ef4\u6301\u590d\u6742\u7684\u8fde\u63a5\u72b6\u6001\u8868\uff1b</li> <li>UDP\u662f\u9762\u5411\u62a5\u6587\u7684\u3002UDP\u5bf9\u5e94\u7528\u5c42\u4ea4\u4e0b\u6765\u7684\u62a5\u6587\uff0c\u65e2\u4e0d\u5408\u5e76\uff0c\u4e5f\u4e0d\u62c6\u5206\uff0c\u800c\u662f\u4fdd\u7559\u8fd9\u4e9b\u62a5\u6587\u7684\u8fb9\u754c\u3002UDP\u4e00\u6b21\u4ea4\u4ed8\u4e00\u4e2a\u5b8c\u6574\u7684\u62a5\u6587\uff1b</li> <li>UDP\u6ca1\u6709\u62e5\u585e\u63a7\u5236\uff0c\u56e0\u6b64\u7f51\u7edc\u51fa\u73b0\u7684\u62e5\u585e\u4e0d\u4f1a\u4f7f\u6e90\u4e3b\u673a\u7684\u53d1\u9001\u901f\u7387\u964d\u4f4e\u3002\u8fd9\u5bf9\u67d0\u4e9b\u5b9e\u65f6\u5e94\u7528\u662f\u5f88\u91cd\u8981\u7684\u3002\u5f88\u9002\u5408\u591a\u5a92\u4f53\u901a\u4fe1\u7684\u8981\u6c42;</li> <li>UDP\u652f\u6301\u4e00\u5bf9\u4e00\u3001\u4e00\u5bf9\u591a\u3001\u591a\u5bf9\u4e00\u548c\u591a\u5bf9\u591a\u7684\u4ea4\u4e92\u901a\u4fe1;</li> <li>UDP\u7684\u9996\u90e8\u5f00\u9500\u5c0f\uff0c\u53ea\u67098\u4e2a\u5b57\u8282\uff0c\u6bd4TCP\u7684 20\u4e2a\u5b57\u8282\u7684\u9996\u90e8\u8981\u77ed\u3002</li> </ul>"},{"location":"languages/libffi.html","title":"FFI","text":"<p>FFI\uff08Foreign Function Interface\uff09\u5141\u8bb8\u4ee5\u4e00\u79cd\u8bed\u8a00\u7f16\u5199\u7684\u4ee3\u7801\u8c03\u7528\u53e6\u4e00\u79cd\u8bed\u8a00\u7684\u4ee3\u7801</p>"},{"location":"languages/libffi.html#libffi","title":"LibFFI","text":"<p><code>Libffi</code>\u662f\u4e00\u4e2a\u5916\u90e8\u51fd\u6570\u63a5\u53e3\u5e93\uff0c\u63d0\u4f9b\u4e86\u6700\u5e95\u5c42\u7684\u3001\u4e0e\u67b6\u6784\u76f8\u5173\u7684\u3001\u5b8c\u6574\u7684FFI</p> <ul> <li>\u63d0\u4f9b\u4e86\u4e00\u4e2aC\u7f16\u7a0b\u8bed\u8a00\u63a5\u53e3\uff0c\u7528\u4e8e\u5728\u8fd0\u884c\u65f6\uff08\u800c\u4e0d\u662f\u7f16\u8bd1\u65f6\uff09\u7ed9\u5b9a\u6709\u5173\u76ee\u6807\u51fd\u6570\u7684\u4fe1\u606f\u6765\u8c03\u7528\u672c\u5730\u7f16\u8bd1\u51fd\u6570\u3002</li> <li>\u53ef\u4ee5\u751f\u6210\u4e00\u4e2a\u6307\u5411\u53ef\u4ee5\u63a5\u53d7\u548c\u89e3\u7801\u5728\u8fd0\u884c\u65f6\u5b9a\u4e49\u7684\u53c2\u6570\u7ec4\u5408\u7684\u51fd\u6570\u7684\u6307\u9488\u3002</li> </ul> <p><code>libffi</code>\u7684\u4f5c\u7528\u5c31\u76f8\u5f53\u4e8e\u7f16\u8bd1\u5668\uff0c\u5b83\u4e3a\u591a\u79cd\u8c03\u7528\u89c4\u5219\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u9ad8\u7ea7\u8bed\u8a00\u7f16\u7a0b\u63a5\u53e3\uff0c\u7136\u540e\u901a\u8fc7\u76f8\u5e94\u63a5\u53e3\u5b8c\u6210\u51fd\u6570\u8c03\u7528\uff0c\u5e95\u5c42\u4f1a\u6839\u636e\u5bf9\u5e94\u7684\u89c4\u5219\uff0c\u5b8c\u6210\u6570\u636e\u51c6\u5907\uff0c\u751f\u6210\u76f8\u5e94\u7684\u6c47\u7f16\u6307\u4ee4\u4ee3\u7801\u3002</p>"},{"location":"languages/libffi.html#java-ffi","title":"Java FFI","text":"<p>jffi  \u57fa\u4e8e libffi-3.4.4 </p> <p>jna \u57fa\u4e8e libffi-3.4.4 </p>"},{"location":"languages/libffi.html#golang-fficgo","title":"Golang FFI(Cgo)","text":"<p>cgo doc</p>"},{"location":"languages/libffi.html#python-ffi","title":"Python FFI","text":""},{"location":"languages/libffi.html#cffi","title":"CFFI","text":"<p>A Foreign Function Interface package for calling C libraries from Python. \u57fa\u4e8e libffi \u5b9e\u73b0</p>"},{"location":"languages/libffi.html#ctypes","title":"Ctypes","text":"<p>Python\u5185\u7f6e\uff0c\u57fa\u4e8e \u57fa\u4e8e libffi \u5b9e\u73b0\u3002</p>"},{"location":"languages/libffi.html#pybind11","title":"Pybind11","text":"<p>Seamless operability between C++11 and Python.</p>"},{"location":"languages/unicode.html","title":"Unicode","text":"<p>\u5b57\u7b26\u96c6\uff1a\u4e3a\u6bcf\u4e00\u4e2a\u5b57\u7b26\u5206\u914d\u552f\u4e00\u7684 ID\uff08\u5b66\u540d\u4e3a\u7801\u4f4d/\u7801\u70b9/CodePoint\uff09</p> <p>\u7f16\u7801\u89c4\u5219\uff1a\u5c06\u7801\u4f4d\u8f6c\u6362\u4e3a\u5b57\u8282\u5e8f\u5217\u7684\u89c4\u5219\uff0c\u7f16\u7801/\u89e3\u7801</p> <p>Unicode\u662f\u5b57\u7b26\u96c6\uff0cUTF-8\u3001UTF-16\u3001UTF-32\u7b49\u662f\u5177\u4f53\u7684\u7f16\u7801\u89c4\u5219\u3002</p> <p>ASCII \u78017\u4f4d\uff0c\u5171128\u5b57\u7b26\uff0c\u7f16\u7801\u65f6\u7528\u4e00\u4e2abyte\u8868\u793a\uff0c\u7b2c0\u4f4d\u4e3a\u5947\u5076\u6821\u9a8c\u4f4d\u3002</p> <p>Unicode\u5b57\u7b26\u96c6\u4e3a\u6bcf\u4e00\u4e2a\u5b57\u7b26\u5206\u914d\u4e00\u4e2a\u7801\u4f4d\uff0c\u5982<code>\u77e5</code>\u7684\u7801\u4f4d\u4e3a30693\uff0c\u8bb0\u4f5cU+77E5\uff0830693\u768416\u8fdb\u5236\u4e3a0x77E5\uff09\u3002</p> <p>\u76ee\u524d\u7684Unicode\u5b57\u7b26\u5206\u4e3a17\u7ec4\u7f16\u6392\uff0c0x0000 \u81f3 0x10FFFF\uff0c\u6bcf\u7ec4\u79f0\u4e3a\u5e73\u9762\uff08Plane\uff09\uff0c\u800c\u6bcf\u5e73\u9762\u62e5\u670965536\u4e2a\u7801\u4f4d\uff0c\u51711114112\u4e2a\u3002</p> <ul> <li> <p>code point: \u7801\u4f4d</p> </li> <li> <p>code unit:  \u6307\u67d0\u79cd Unicode \u7f16\u7801\u65b9\u5f0f\u91cc\u7f16\u7801\u4e00\u4e2a code point \u9700\u8981\u7684\u6700\u5c11\u5b57\u8282\u6570\uff0c\u6bd4\u5982 UTF-8 \u9700\u8981\u6700\u5c11\u4e00\u4e2a\u5b57\u8282\uff0cUTF-16 \u6700\u5c11\u4e24\u4e2a\u5b57\u8282\uff0cUCS-2 \u4e24\u4e2a\u5b57\u8282\uff0cUCS-4 \u548c UTF-32 \u56db\u4e2a\u5b57\u8282\uff0c\u540e\u9762\u4e09\u4e2a\u662f\u5b9a\u957f\u7f16\u7801\u3002</p> </li> </ul> <p>Unicode\u4e2d\u7684U+D800~U+DFFF\u7801\u70b9\uff0c\u79f0\u4e4b\u4e3a\u4ee3\u7406\u7801\u70b9\uff0c\u4e0d\u8868\u793a\u4efb\u4f55\u5b57\u7b26\uff0c\u7ed9UTF-16\u4f7f\u7528</p>"},{"location":"languages/unicode.html#_1","title":"\u7f16\u7801\u89c4\u5219","text":""},{"location":"languages/unicode.html#utf-16","title":"UTF-16","text":"<p>\u4ee5 16 \u4f4d\u4e3a\u4e00\u4e2a\u7f16\u7801\u5355\u4f4d\uff0c\u6700\u5f00\u59cb\u75282 byte\u8868\u793aunicode\uff08\u57fa\u672c\u5e73\u9762\u7801\u70b9\uff09\uff0c\u76f4\u63a5\u5c06\u7801\u4f4d\u6620\u5c04\u4f4d\u7f16\u7801\u3002</p> <p>UTF-16\u4e2d\uff0c\u5927\u90e8\u5206\u6c49\u5b57\u91c7\u7528\u4e24\u4e2a\u5b57\u8282\u7f16\u7801\uff0c\u5c11\u91cf\u4e0d\u5e38\u7528\u6c49\u5b57\u91c7\u7528\u56db\u4e2a\u5b57\u8282\u7f16\u7801\u3002</p> <p>\u968f\u7740unicode\u7684\u589e\u8865\u5e73\u9762\u7801\u70b9\u7684\u51fa\u73b0\uff0c\u91c7\u7528\u4ee3\u7406\u673a\u5236\u8fdb\u884c\u6269\u5c55\u3002</p> <ul> <li> <p>Unicode\u5b57\u7b26\u96c6\u57fa\u672c\u5e73\u9762BMP\u4e2d\u7684\u5b57\u7b26\uff08\u9664U+D800~U+DFFF\u7801\u70b9\uff0c\u79f0\u4e4b\u4e3a\u4ee3\u7406\u7801\u70b9\uff09\uff0c\u5176\u7f16\u7801\u548c\u7801\u70b9\u503c\u662f\u4e00\u6837\u7684\uff0c2 byte\u8868\u793a\uff1b</p> </li> <li> <p>Unicode\u5b57\u7b26\u96c6\u589e\u8865\u5e73\u9762\u4e2d\u7684\u5b57\u7b26\uff0c\u901a\u8fc7\u4ee3\u7406\u7801\u70b9\u6269\u5c55\uff0c4 byte\u8868\u793a\u3002</p> </li> </ul> <p>\u4ee3\u7406Surrogate</p> <p>\u589e\u8865\u5e73\u9762\u4e00\u5171\u670916\u4e2a\u5e73\u9762\uff0c\u7801\u70b9\u7f16\u53f7\u8303\u56f4\u4e3a0x10000~0x10FFFF\uff1a</p> <ul> <li>\u7528\u4e24\u4e2a\u4ee3\u7406\u7801\u5143\u8868\u793a\uff0c\u7b2c\u4e00\u4e2a\u7801\u5143\u7684\u53d6\u503c\u8303\u56f4\u4e3a0xD800~0xDBFF\uff0c\u7b2c\u4e8c\u4e2a\u7801\u5143\u7684\u53d6\u503c\u8303\u56f4\u4e3a0xDC00~0xDFFF</li> </ul> <pre><code>======\u4ee3\u7406\u7801\u70b91======       ======\u4ee3\u7406\u7801\u70b92====== \n1101 10pp ppxx xxxx        1101 11xx xxxx xxxx\n</code></pre> <ul> <li> <p>\u603b\u4f4d\u6570p + x = 20\uff0c\u6b63\u597d\u4e3a\u589e\u8865\u5e73\u9762\u7684\u6240\u6709\u7801\u70b9\u3002</p> </li> <li> <p>\u8ba1\u7b97\u65f6\uff0c\u5c06unicode\u7684\u7801\u4f4d\u503c\u5148\u51cf\u53bb 0x10000\uff0c\u518d\u7528\u6a21\u677f\u586b\u5145\uff1b</p> </li> </ul>"},{"location":"languages/unicode.html#utf-8","title":"UTF-8**","text":"<p>\u4ee5 8 \u4f4d\u4e3a\u4e00\u4e2a\u7f16\u7801\u5355\u4f4d\u7684\u53ef\u53d8\u957f\u7f16\u7801\uff0c\u5c06\u4e00\u4e2a\u7801\u4f4d\u7f16\u7801\u4e3a1\u52304\u4e2a\u5b57\u8282\u3002\u5e38\u7528\u5b57\u7b26\u66f4\u5c11\u5b57\u7b26\u6570\u3002</p> <pre><code>\u7801\u4f4d\u5bf9\u5e94\u7684\u6a21\u677f\nU+  000 ~ U+  007F : 0XXXXXX                                       \u51712^7\u4f4d\nU+ 0080 ~ U+  07FF : 110XXXXX 10XXXXXX                             \u51712^11 - 2^7\nU+ 0800 ~ U+  FFFF : 1110XXXX 10XXXXXX 10XXXXXX                    \u51712^16 - 2^11\nU+10000 ~ U+10FFFF : 11110XXX 10XXXXXX 10XXXXXX 10XXXXXX           \u51712^20\n</code></pre> <p><code>\u77e5</code>\u7684\u7801\u4f4dU+77E5\u4f4d\u4e8e\u7b2c\u4e09\u884c</p> <pre><code>      7    7     E    5\n    0111 0111 1110 0101   \u4e8c\u8fdb\u5236\u768477E5\n --------------------------    \n    0111   011111   100101 \u4e8c\u8fdb\u5236\u768477E5\uff08\u6309\u7167\u6a21\u677fX\u5bf9\u9f50\uff09\n1110XXXX 10XXXXXX 10XXXXXX \u6a21\u677f\n11100111 10011111 10100101 \u5e26\u5165\u6a21\u677f\n   E   7    9   F    A   5    \n</code></pre>"},{"location":"languages/unicode.html#utf-32","title":"UTF-32","text":"<p>UTF-32\u7f16\u7801\u4ee532\u4f4d\u4e3a\u7f16\u7801\u5355\u4f4d\u3002Unicode\u7684UTF-32\u7f16\u7801\u5c31\u662f\u5176\u5bf9\u5e94\u768432\u4f4d\u65e0\u7b26\u53f7\u6574\u6570\u3002</p>"},{"location":"languages/unicode.html#_2","title":"\u5b57\u8282\u5e8f","text":"<p>\u5b57\u8282\u5e8f\u6709\u4e24\u79cd\uff0c\u5206\u522b\u662f\u201c\u5927\u7aef\u201d\uff08Big Endian, BE, \u9ad8\u5b57\u8282\u5b58\u4e8e\u5185\u5b58\u4f4e\u5730\u5740\uff09\u548c\u201c\u5c0f\u7aef\u201d\uff08Little Endian, LE, \u9ad8\u5b57\u8282\u5b58\u4e8e\u5185\u5b58\u9ad8\u5730\u5740\uff09\u3002</p> <p>\u5728\u5c06\u903b\u8f91\u5f62\u5f0f\u7684\u7801\u5143\u5e8f\u5217(\u6216\u53ef\u79f0\u4e4b\u4e3a\u903b\u8f91\u7f16\u7801)\u6620\u5c04\u4e3a\u7269\u7406\u5f62\u5f0f\u7684\u5b57\u8282\u5e8f\u5217(\u6216\u53ef\u79f0\u4e4b\u4e3a\u7269\u7406\u7f16\u7801)\u65f6\uff0c\u56e0\u7cfb\u7edf\u5e73\u53f0\u7684\u5dee\u5f02\uff0c\u5b58\u5728\u4e00\u4e2a\u5b57\u8282\u5e8f(Byte-Order\u5b57\u8282\u987a\u5e8f)\u7684\u95ee\u9898\u3002</p> <p>Unicode\u6807\u51c6\u5efa\u8bae\u7528BOM\uff08Byte Order Mark\uff09\u6765\u533a\u5206\u5b57\u8282\u5e8f\uff0c\u5176\u503c\u4e3a U+FEFF\uff08\u7279\u5b9a\u7684\u7528\u9014\u7684unicode\uff09\u3002</p> <ul> <li>\u5b57\u8282FE(\u4e8c\u8fdb\u5236\u4e3a1111 1110)\u548cFF(\u4e8c\u8fdb\u5236\u4e3a1111 1111)\u5728 UTF-8 \u7f16\u7801\u4e2d\u6c38\u8fdc\u4e0d\u4f1a\u51fa\u73b0\uff0c\u79f0\u4e4b\u4e3a\u96f6\u5bbd\u5ea6\u4e0d\u4e2d\u65ad\u7a7a\u683c(ZERO WIDTH NO-BREAK SPACE)\uff1b</li> </ul> <p>\u63a5\u6536\u5230 FEFF \u8868\u793a\u5927\u7aef\uff0c\u63a5\u6536\u5230 FFEF \u8868\u793a\u5c0f\u7aef\u3002</p> <p>UTF-8 \u4e0d\u9700\u8981BOM\u6765\u8868\u660e\u5b57\u8282\u987a\u5e8f\uff0c\u4f46\u53ef\u4ee5\u7528BOM\u6765\u8868\u660e\u7f16\u7801\u65b9\u5f0f\u3002\u5b57\u7b26\u201d<code>ZERO WIDTH NO-BREAK SPACE</code>\u201c\u7684<code>UTF-8\u7f16\u7801</code>\u662f<code>EF BB BF</code>\u3002\u4f46\uff0c\u6700\u597d\u4e0d\u8981\u4f7f\u7528\uff0c\u9632\u6b62\u65e0\u6cd5\u8bc6\u522b\u3002</p> Unicode\u7f16\u7801 0x 00 6C 49 0x 02 0C 30 UTF-16LE FF FE 49 6C FF FE 30 DC 43 D8 UTF-16BE FE FF 49 6C FE FF D8 43 DC 30 UTF-32LE FF FE 00 00 49 6C 00 00 FF FE 00 00 30 0C 02 00 UTF-32LE 00 00 FE FF 00 00 6C 49 00 00 FE FF 00 02 0C 30 <p>\u7f51\u7edc\u5b57\u8282\u5e8f\u662f\u5927\u7aef\u5b57\u8282\u5e8f\u3002</p>"},{"location":"languages/ziju.html","title":"\u8bed\u8a00\u81ea\u4e3e","text":"<p>\u81ea\u4e3e\u7684\u5b9a\u4e49\uff1a\u4e00\u79cd\u7f16\u7a0b\u8bed\u8a00\u7684\u7a0b\u5e8f\u53ef\u4ee5\u7528\u8fd9\u79cd\u8bed\u8a00\u672c\u8eab\u7f16\u5199\u7684\u7f16\u8bd1\u5668\u6765\u7f16\u8bd1\uff0c\u8bed\u8a00\u9700\u8981\u5e26\u6709\u8fd0\u884c\u65f6\u7cfb\u7edf\uff08runtime system\uff09\u6216\u8005\u53eb\u8fd0\u884c\u65f6\u5e93\uff08runtime library\uff09\u7684\u8bdd\uff0c\u8fd9\u90e8\u5206\u4e5f\u8981\u7528\u81ea\u5df1\u6765\u5b9e\u73b0\u624d\u53ef\u4ee5\u7b97\u662f\u771f\u7684\u81ea\u4e3e\u3002</p> <p>\u4f8b\u5982\uff0c\u521b\u9020\u4e00\u95e8 V\u8bed\u8a00\u800c\u4e14\u7528V\u8bed\u8a00\u6765\u5199V\u7f16\u8bd1\u5668\u7684\u8bdd\uff0c\u4f60\u5f97\u6309\u7167\u4e0b\u9762\u7684\u65b9\u6cd5\u505a\uff1a</p> <ul> <li>\u7528C++\u628a\u90a3\u4e2a\u7f16\u8bd1\u5668\uff08A\uff09\u5199\u51fa\u6765\uff0c\u987a\u4fbf\u7559\u4e0b\u5f88\u591a\u6d4b\u8bd5\u7528\u4f8b\u3002</li> <li>\u7528V\u8bed\u8a00\u628a\u90a3\u4e2a\u7f16\u8bd1\u5668\u5199\uff08B\uff09\u51fa\u6765\uff0c\u7528A.exe\u6765\u7f16\u8bd1B\uff0c\u4fee\u6539\u76f4\u5230\u6240\u6709\u6d4b\u8bd5\u7528\u4f8b\u90fd\u901a\u8fc7\u4e3a\u6b62\u3002</li> <li>B.exe\u6765\u7f16\u8bd1B\u81ea\u5df1\u5f97\u5230B2.exe\uff0c\u4fee\u6539\u76f4\u5230B2.exe\u6240\u6709\u6d4b\u8bd5\u7528\u4f8b\u90fd\u901a\u8fc7\u4e3a\u6b62\u3002\u8fd9\u662f\u4e3a\u4e86\u4fdd\u8bc1\uff0c\u5c31\u7b97B\u672c\u8eab\u6709\u5f88\u591abug\uff0c\u81f3\u5c11\u7f16\u8bd1\u81ea\u5df1\u662f\u6ca1\u6709bug\u7684\uff0c\u4ece\u800c\u4f60\u5c31\u53ef\u4ee5\u8d70\u5230\u7b2c\u56db\u6b65\u3002</li> <li>\u5f53\u4f60\u89c9\u5f97\u6709\u4fe1\u5fc3\u4e86\uff0c\u7528A.exe\u628aB\u7f16\u8bd1\u4e00\u904d\uff0c\u5c31\u5f97\u5230\u4e86B.exe\u3002\u7136\u540eA\u7684\u4ee3\u7801\u548cA.exe\u90fd\u5728\u4e5f\u4e0d\u9700\u8981\u5b58\u5728\u4e86\uff0c\u5220\u6389\u4ed6\u4eec\u3002\u4ee5\u540e\u4f60\u5c31\u4e0d\u65ad\u7684\u7528B.exe\u6765\u7f16\u8bd1\u4e0b\u4e00\u4e2a\u7248\u672c\u7684B\u5c31\u597d\u4e86\uff0c\u5c31\u81ea\u4e3e\u4e86\u3002</li> </ul>"},{"location":"languages/ziju.html#java","title":"Java\u7684\u81ea\u4e3e","text":""},{"location":"languages/ccpp/abi.html","title":"Application Binary Interface","text":"<p>Linux Foundation Referenced Specifications</p> <p>ABI \u662f\u7f16\u8bd1\u5668\u548c\u94fe\u63a5\u5668\u9075\u5b88\u7684\u4e00\u7ec4\u89c4\u5219\uff0c\u4ee5\u8ba9\u7f16\u8bd1\u540e\u7684\u7a0b\u5e8f\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c</p> <p>\u4e8c\u8fdb\u5236\u517c\u5bb9\u6027\uff1a\u5047\u8bbe\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u5f15\u7528\u7684\u4e00\u4e2a\u5e93\u67d0\u5929\u66f4\u65b0\u4e86\uff0c\u867d\u7136 API \u548c\u8c03\u7528\u65b9\u5f0f\u57fa\u672c\u6ca1\u53d8\uff0c</p> <ul> <li>\u9700\u8981\u91cd\u65b0\u7f16\u8bd1\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u624d\u80fd\u4f7f\u7528\u8fd9\u4e2a\u5e93\uff0c\u90a3\u4e48\u4e00\u822c\u8bf4\u8fd9\u4e2a\u5e93\u662f Source compatible\uff1b</li> <li>\u4e0d\u9700\u8981\u91cd\u65b0\u7f16\u8bd1\u5e94\u7528\u7a0b\u5e8f\u5c31\u80fd\u4f7f\u7528\u65b0\u7248\u672c\u7684\u5e93\uff0c\u90a3\u4e48\u8bf4\u8fd9\u4e2a\u5e93\u8ddf\u5b83\u4e4b\u524d\u7684\u7248\u672c\u662f\u4e8c\u8fdb\u5236\u517c\u5bb9\u3002</li> </ul> <p>ABI\u91cc\u5305\u542b\u5f88\u591a\u65b9\u9762\u7684\u5185\u5bb9\uff1a</p> <ul> <li>\u6700\u5927\u548c\u6700\u91cd\u8981\u7684\u90e8\u5206\u662f\u89c4\u5b9a\u51fd\u6570\u7684\u8c03\u7528\u987a\u5e8f\uff0c\u4e5f\u79f0\u4e3a\u201c\u8c03\u7528\u7ea6\u5b9a\u201d\uff0c\u6807\u51c6\u5316\u5982\u4f55\u5c06\u201c\u51fd\u6570\u201d\u8f6c\u6362\u4e3a\u6c47\u7f16\u4ee3\u7801\u3002</li> <li>\u89c4\u5b9a\u4e86\u5e93\u4e2d\u516c\u5f00\u51fd\u6570\u7684name\uff08\u5982printf\uff09\u5982\u4f55\u8868\u793a\uff0c\u4ee5\u4fbf\u5728\u94fe\u63a5\u540e\u53ef\u4ee5\u6b63\u786e\u7684\u8c03\u7528\u8fd9\u4e9b\u5e93\u51fd\u6570\u5e76\u63a5\u6536\u53c2\u6570\u3002</li> <li>\u89c4\u5b9a\u53ef\u4ee5\u4f7f\u7528\u4ec0\u4e48\u7c7b\u578b\u7684\u6570\u636e\u7c7b\u578b\u3001\u5b83\u4eec\u5fc5\u987b\u5982\u4f55\u5bf9\u9f50\u4ee5\u53ca\u5176\u4ed6\u4f4e\u7ea7\u7ec6\u8282\u3002</li> <li>\u6d89\u53ca\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u5bb9\uff0c\u5982\u53ef\u6267\u884c\u6587\u4ef6\u7684\u683c\u5f0f\uff0c\u865a\u62df\u5730\u5740\u7a7a\u95f4\u5e03\u5c40\uff0c\u8fd8\u6709Program Loading and Dynamic Linking\u7b49\u7ec6\u8282</li> </ul>"},{"location":"languages/ccpp/abi.html#name-mangling","title":"Name mangling","text":"<p>C++ \u5f15\u5165\uff08\u91cd\u8f7d\uff09\u7684\u6982\u5ff5\uff0c\u5176\u6838\u5fc3\u601d\u60f3\u662f\u628a\u51fd\u6570\u7684\u540d\u5b57\u3001\u53c2\u6570\u7b49\u4fe1\u606f\uff08\u6216\u8005\u53eb\u51fd\u6570\u7b7e\u540d\uff09\u7f16\u7801\u6210\u4e00\u4e2a\u5177\u6709\u552f\u4e00\u6027\u7684\u5b57\u7b26\u4e32\uff0c\u7528\u4f5c\u94fe\u63a5\u7b26\u53f7\uff1b\u8fd9\u6837\u5c31\u80fd\u5728\u7f16\u8bd1\u671f\u5b8c\u6210\u68c0\u67e5\uff0c\u4ece\u800c\u907f\u514d\u8fd0\u884c\u65f6\u51fa\u95ee\u9898\uff08\u5982<code>_ZN9wikipedia7article6formatEv</code>\uff09\u3002</p>"},{"location":"languages/ccpp/abi.html#calling-convention","title":"Calling Convention","text":"<p>\u51fd\u6570\u8c03\u7528\uff1a\u540c\u4e00\u4e2a\u5e73\u53f0\u4e0b\u540c\u4e00\u4e2a\u7f16\u8bd1\u5668\u7684\u8c03\u7528\u7ea6\u5b9a\u662f\u4e00\u6837\u7684\uff0c\u4e0d\u540c\u5e73\u53f0\u53ef\u80fd\u4e0d\u4e00\u6837\u3002</p> <ul> <li>\u8c03\u7528\u8005\u8981\u628a\u53c2\u6570\u548c\u8fd4\u56de\u70b9\u5730\u5740\u4f20\u9012\u7ed9\u51fd\u6570\uff0c\u51fd\u6570\u8981\u628a\u8fd4\u56de\u503c\u4f20\u9012\u7ed9\u8c03\u7528\u8005\uff1b</li> <li>\u653e\u6808\u548c\u5bc4\u5b58\u5668\u91cc\u4e86\u3002\u54ea\u4e9b\u53c2\u6570\u653e\u6808\u9876\uff0c\u54ea\u4e2a\u53c2\u6570\u5148\u5165\u6808\uff0c\u54ea\u4e9b\u53c2\u6570\u653e\u5bc4\u5b58\u5668\u91cc\uff0c\u653e\u54ea\u4e2a\u5bc4\u5b58\u5668\uff0c\u8fd4\u56de\u5730\u5740\u653e\u54ea\uff0c\u8fd4\u56de\u503c\u653e\u54ea\uff0c\u8fd9\u90fd\u662f\u8c03\u7528\u7ea6\u5b9a\u7684\u4e00\u90e8\u5206</li> <li>\u8c03\u7528\u8005\u5728\u8c03\u7528\u524d\u540e\uff0c\u67d0\u4e9b\u5bc4\u5b58\u5668\u91cc\u7684\u503c\u662f\u8fd8\u6709\u7528\u7684\uff0c\u800c\u51fd\u6570\u5185\u90e8\u4e5f\u53ef\u80fd\u8981\u7528\u8fd9\u4e2a\u5bc4\u5b58\u5668\u3002</li> <li>caller-saved \u6216\u8005 callee-saved\uff0c\u4e5f\u662f\u8c03\u7528\u7ea6\u5b9a\u7684\u4e00\u90e8\u5206</li> </ul>"},{"location":"languages/ccpp/abi.html#_1","title":"\u6ce8\u610f\u4e8b\u9879","text":"<ul> <li>\u5f00\u53d1\u4e8c\u8fdb\u5236\u517c\u5bb9\u7684\u5e93\u7684\u65f6\u5019\uff0c\u4e00\u822c\u4f7f\u7528 extern \"C\" \u6765\u6291\u5236 Name mangling\uff1b</li> <li>\u5f00\u53d1\u4e8c\u8fdb\u5236\u517c\u5bb9\u7684\u5e93\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u8981\u907f\u514d\u4f7f\u7528 STL\uff0c\u56e0\u4e3a\u4e0d\u540c\u7684 C++ \u7f16\u8bd1\u5668\u3001\u4e0d\u540c\u7248\u672c\u7684 C++ \u7f16\u8bd1\u5668\u643a\u5e26\u7684 STL \u4e0d\u5177\u5907\u4e8c\u8fdb\u5236\u517c\u5bb9\u6027\uff0c\u751a\u81f3\u540c\u4e00\u4e2a\u7248\u672c\u7684 C++ \u7f16\u8bd1\u5668\u7528\u6237\u4e5f\u53ef\u80fd\u4f7f\u7528\u4e0d\u540c\u7684 STL \u66ff\u4ee3\u81ea\u5e26\u7684 STL</li> <li>\u4e8c\u8fdb\u5236\u517c\u5bb9\u7684\u63a5\u53e3\u5e94\u8be5\u53ea\u4f7f\u7528 int32\u3001double \u7b49\u57fa\u7840\u6570\u636e\u7c7b\u578b\uff0c\u4f7f\u7528\u786e\u5b9a\u7684 struct \u751a\u81f3\u5b8c\u5168\u4e0d\u4f7f\u7528 struct\u3001\u53ea\u63d0\u4f9b\u62bd\u8c61\u7684 handle\uff0c\u6216\u8005\u7eaf\u62bd\u8c61\u63a5\u53e3</li> <li>\u5185\u5b58\u5206\u914d\u548c\u91ca\u653e\u4e0d\u5e94\u8be5\u8de8\u8d8a DLL Boundary\uff0c\u65e0\u6cd5\u786e\u5b9a\u4e0d\u540c\u7684\u6a21\u5757\u5185\u90e8\u4f7f\u7528\u7684\u5185\u5b58\u5206\u914d\u5668\u662f\u5426\u76f8\u540c\uff1b</li> </ul>"},{"location":"languages/ccpp/abi.html#_2","title":"\u5b9e\u8df5","text":"<p>\u9488\u5bf9 library \uff08\u4e3b\u8981\u662f shared library\uff0c\u5373\u52a8\u6001\u94fe\u63a5\u5e93\uff09\u7684 ABI (application binary interface)\uff0c\u5f53 library \u5347\u7ea7\u65f6\uff0c\u4f9d\u8d56\u8be5\u5e93\u7684\u4e8c\u8fdb\u5236\u4e0d\u9700\u8981\u6539\u52a8\u3002</p> <ul> <li>non-virtual \u51fd\u6570\u6bd4 virtual \u51fd\u6570\u66f4\u5065\u58ee\uff1a\u56e0\u4e3a virtual function \u662f bind-by-vtable-offset\uff0c\u800c non-virtual function \u662f bind-by-name\u3002</li> </ul>"},{"location":"languages/ccpp/abi.html#_3","title":"\u4e8c\u8fdb\u5236\u4ee3\u7801\u4e0d\u517c\u5bb9\u4f8b\u5b50","text":"<ul> <li>\u7ed9\u51fd\u6570\u589e\u52a0\u9ed8\u8ba4\u53c2\u6570\uff0c\u73b0\u6709\u7684\u53ef\u6267\u884c\u6587\u4ef6\u65e0\u6cd5\u4f20\u8fd9\u4e2a\u989d\u5916\u7684\u53c2\u6570\uff1b</li> <li>\u589e\u52a0\u865a\u51fd\u6570\uff0c\u4f1a\u9020\u6210 vtbl \u91cc\u7684\u6392\u5217\u53d8\u5316\uff08\u4e0d\u8981\u8003\u8651\u201c\u53ea\u5728\u672b\u5c3e\u589e\u52a0\u201d\u8fd9\u79cd\u53d6\u5de7\u884c\u4e3a\uff0c\u56e0\u4e3a\u4f60\u7684 class \u53ef\u80fd\u5df2\u88ab\u7ee7\u627f\u3002\uff09\uff1b</li> <li>\u589e\u52a0\u9ed8\u8ba4\u6a21\u677f\u7c7b\u578b\u53c2\u6570\uff0c\u6bd4\u65b9\u8bf4 <code>Foo&lt;T&gt;</code> \u6539\u4e3a <code>Foo&lt;T, Alloc=alloc&lt;T&gt;&gt;</code>\uff0c\u8fd9\u4f1a\u6539\u53d8 name mangling\uff1b</li> </ul> <p>\u7ed9 class Bar \u589e\u52a0\u6570\u636e\u6210\u5458\uff0c\u9020\u6210 sizeof(Bar) \u53d8\u5927\uff0c\u4ee5\u53ca\u5185\u90e8\u6570\u636e\u6210\u5458\u7684 offset \u53d8\u5316\uff1a</p> <ul> <li> <p>\u4e0d\u5b89\u5168\uff08\u4e0d\u517c\u5bb9\uff09\u7684\u5ba2\u6237\u7aef\u4f7f\u7528\uff1a</p> </li> <li> <p>\u5ba2\u6237\u4ee3\u7801\u91cc\u6709 <code>new Bar</code>\uff0c\u90a3\u4e48\u80af\u5b9a\u4e0d\u5b89\u5168\uff1b</p> </li> <li> <p>\u5ba2\u6237\u4ee3\u7801\u91cc\u6709 <code>Bar* pBar; pBar-&gt;memberA = xx</code>\uff0c\u90a3\u4e48\u80af\u5b9a\u4e0d\u5b89\u5168\uff0cmemberA \u7684\u65b0 Bar \u7684\u504f\u79fb\u53ef\u80fd\u4f1a\u53d8\uff1b</p> </li> <li> <p>\u5982\u679c\u5ba2\u6237\u8c03\u7528 <code>pBar-&gt;setMemberA(xx);</code> \u800c <code>Bar::setMemberA()</code> \u662f\u4e2a inline function\uff0c\u90a3\u4e48\u80af\u5b9a\u4e0d\u5b89\u5168\uff0c\u56e0\u4e3a\u504f\u79fb\u91cf\u5df2\u7ecf\u88ab inline \u5230\u5ba2\u6237\u7684\u4e8c\u8fdb\u5236\u91cc\u3002</p> </li> <li> <p>\u517c\u5bb9\u7684\u5ba2\u6237\u7aef\u4f7f\u7528\uff1a</p> </li> <li>\u901a\u8fc7\u6210\u5458\u51fd\u6570\u8bbf\u95ee\u5bf9\u8c61\u7684\u6570\u636e\u6210\u5458\uff0c\u4e14\u8be5\u6210\u5458\u51fd\u6570\u5b9a\u4e49\u5728 cpp \u4e2d\uff0c\u4e0d\u662f\u5185\u8054\u51fd\u6570\uff1b</li> </ul>"},{"location":"languages/ccpp/abi.html#_4","title":"\u89e3\u51b3\u529e\u6cd5","text":"<p>\u7b2c\u4e00\u79cd\u7c7b\u4f3c\u6865\u63a5\u8bbe\u8ba1\u6a21\u5f0f\uff1a\u95f4\u63a5\u8c03\u7528\u5b9e\u73b0\u7c7b\u5b9e\u73b0\uff0c\u53ef\u80fd\u6709\u4e00\u5b9a\u7684\u6027\u80fd\u635f\u5931\uff1b</p> <ul> <li>\u63a5\u53e3\u7c7b\uff1a\u53ea\u5b9a\u4e49 non-virtual \u63a5\u53e3\uff0c\u53ea\u5305\u542b <code>Impl *</code> \u7684\u79c1\u6709\u6210\u5458\uff1b</li> <li>\u63a5\u53e3\u7c7b\u65b0\u589e\u51fd\u6570\uff0c\u53ea\u8981\u65b0\u589e non-virtual \u63a5\u53e3\uff1b</li> </ul> <p>\u7b2c\u4e8c\u79cd\uff1a</p> <ul> <li> <p>\u5bf9\u4e8e\u63a5\u53e3\u7c7b Bar\uff1a</p> </li> <li> <p>\u6240\u6709\u7684\u6210\u5458\u90fd\u662f\u79c1\u6709\u6210\u5458\uff0c\u5e76\u901a\u8fc7\u975e\u5185\u8054\u7684\u6210\u5458\u51fd\u6570\u8c03\u7528\uff1b</p> </li> <li> <p>\u4fee\u6539\u65f6\uff0c\u53ea\u65b0\u589e non-virtual \u63a5\u53e3\uff1b</p> </li> <li> <p>\u4e0d\u63d0\u4f9b\u516c\u5171\u7684\u6784\u9020\u51fd\u6570\u548c\u6790\u6784\u51fd\u6570\uff0c\u800c\u662f\u63d0\u4f9b\u5de5\u5382\u65b9\u6cd5\u8fd4\u56de<code>Bar *</code>\uff1b</p> </li> <li> <p>\u5bf9\u4e8e\u5ba2\u6237\u7aef\u8981\u6c42\uff1a</p> </li> <li>\u5ba2\u6237\u7aef\u4e0d\u9700\u8981\u7528\u5230 <code>sizeof(Bar)</code>\u6216\u8005\u63a5\u53e3\u7c7b\u4e0d\u8981\u6dfb\u52a0\u65b0\u6210\u5458\uff1b</li> </ul>"},{"location":"languages/ccpp/basic.html","title":"C++","text":""},{"location":"languages/ccpp/basic.html#_1","title":"\u6570\u7ec4","text":"<p>C99 \u6807\u51c6\u4e2d\u65b0\u589e\u4e86\u53d8\u957f\u6570\u7ec4\uff08variable-length array\uff0c\u7b80\u79f0VLA\uff09</p> <ul> <li>\u5141\u8bb8\u4f7f\u7528\u53d8\u91cf\u6307\u5b9a\u6570\u7ec4\u7684\u5927\u5c0f\uff1a\u6808\u4e0a\u5206\u914d</li> </ul> <pre><code>int n = a + b;\nint arr[n];\n</code></pre>"},{"location":"languages/ccpp/basic.html#_2","title":"\u6307\u9488","text":"<p><code>shared_ptr</code></p> <p><code>unique_ptr</code></p>"},{"location":"languages/ccpp/basic.html#_3","title":"# \u548c #","text":"<p>#  -- \u8f6c\u6362\uff0c \u5b8c\u6210\u4ee3\u7801\u5230\u5b57\u7b26\u4e32\u7684\u8f6c\u6362</p> <pre><code>#define CONVERT(name) #name\n\nint main(int argc, char* argv[])\n{\n    printf(\"You and %s are friends.\\n\", CONVERT(James));\n    return 0;\n}\n</code></pre> <p>## -- \u8fde\u63a5\uff0c \u5b8c\u6210\u4ee3\u7801\u7684\u8fde\u63a5</p> <p>```c++</p>"},{"location":"languages/ccpp/basic.html#define-catbatman-robin-batman-robin","title":"define CAT(batman, robin) batman ## robin","text":""},{"location":"languages/ccpp/basic.html#define-make_friendindex-printfyou-and-s-are-friendsn-catjames-index","title":"define make_friend(index)  printf(\"You and %s are friends.\\n\", CAT(james, index));","text":"<p>int main(int argc, char argv[]) {     char james001=\"fake James 001\";     char james007=\"James Bond\";     char james110=\"fake James 110\";</p> <pre><code>make_friend(001); // print the james001 variable\nmake_friend(007);\nmake_friend(110);\nreturn 0;\n</code></pre> <p>}  ```</p>"},{"location":"languages/ccpp/basic.html#__attribute__","title":"__attribute__","text":"<p><code>__attribute__((constructor))</code> \u4e0e <code>__attribute__((destructor))</code>\u662f GCC \u4e2d\u7528\u6765\u4fee\u9970\u51fd\u6570\u7684</p> <ul> <li>constructor \u53ef\u4ee5\u4f7f\u88ab\u4fee\u9970\u7684\u51fd\u6570\u5728 main() \u6267\u884c\u524d\u88ab\u8c03\u7528\uff1b</li> <li>destructor \u53ef\u4ee5\u4f7f\u88ab\u4fee\u9970\u7684\u51fd\u6570\u5728 main() \u6267\u884c\u7ed3\u675f\u6216 exit() \u8c03\u7528\u7ed3\u675f\u540e\u88ab\u6267\u884c\u3002</li> </ul>"},{"location":"languages/ccpp/basic.html#const","title":"const \u4fee\u9970","text":"<p>\u6307\u9488\u53c2\u6570\u4e3a <code>const</code></p> <ul> <li>\u4e0d\u4f1a\u4fee\u6539\u901a\u8fc7\u8be5\u6307\u9488\u4f20\u9012\u7684\u6570\u636e</li> </ul> <pre><code>void foo(const int* ptr) {  \n    // *ptr = 42; // \u7f16\u8bd1\u9519\u8bef\uff0c\u4e0d\u80fd\u4fee\u6539\u901a\u8fc7const\u6307\u9488\u4f20\u9012\u7684\u6570\u636e  \n}\nvoid foo(const int&amp; ref) {  \n    // ref = 42; // \u7f16\u8bd1\u9519\u8bef\uff0c\u4e0d\u80fd\u4fee\u6539\u901a\u8fc7const\u5f15\u7528\u4f20\u9012\u7684\u6570\u636e  \n}\n</code></pre> <p>\u8fd4\u56de\u503c\u7c7b\u578b\u4e3a <code>const</code></p> <ul> <li>\u7528\u4e8e\u8fd4\u56de\u6307\u5411\u5e38\u91cf\u6570\u636e\u7684\u6307\u9488\u6216\u5f15\u7528\uff0c\u4ee5\u786e\u4fdd\u8c03\u7528\u8005\u4e0d\u4f1a\u610f\u5916\u5730\u4fee\u6539\u8fd9\u4e9b\u6570\u636e</li> </ul> <pre><code>const int* get_const_pointer() {  \n    static int x = 42;  \n    return &amp;x;  \n}  \n\nconst int&amp; get_const_reference() {  \n    static int y = 42;  \n    return y;  \n}\n</code></pre> <p>\u6210\u5458\u51fd\u6570\u540e\u7684 <code>const</code></p> <ul> <li>\u51fd\u6570\u4e0d\u4f1a\u4fee\u6539\u8c03\u7528\u5b83\u7684\u5bf9\u8c61\u7684\u72b6\u6001\uff08\u5373\uff0c\u8be5\u51fd\u6570\u662f\u4e00\u4e2a\u5e38\u91cf\u6210\u5458\u51fd\u6570\uff09</li> </ul> <pre><code>class MyClass {  \npublic:  \n    int value;  \n\n    int getValue() const { // \u8fd9\u662f\u4e00\u4e2a\u5e38\u91cf\u6210\u5458\u51fd\u6570  \n        return value;  \n    }  \n\n    // \u4ee5\u4e0b\u51fd\u6570\u4e0d\u80fd\u662f\u5e38\u91cf\u6210\u5458\u51fd\u6570\uff0c\u56e0\u4e3a\u5b83\u8bd5\u56fe\u4fee\u6539\u6210\u5458\u53d8\u91cf  \n    // void setValue(int v) const { // \u7f16\u8bd1\u9519\u8bef  \n    //     value = v;  \n    // }  \n\n    void setValue(int v) { // \u975e\u5e38\u91cf\u6210\u5458\u51fd\u6570  \n        value = v;  \n    }  \n};  \n\nconst MyClass obj;  \nint val = obj.getValue(); // \u6b63\u786e\uff0c\u56e0\u4e3agetValue\u662f\u5e38\u91cf\u6210\u5458\u51fd\u6570  \n// obj.setValue(42); // \u7f16\u8bd1\u9519\u8bef\uff0c\u56e0\u4e3aobj\u662f\u5e38\u91cf\u5bf9\u8c61\uff0c\u4e0d\u80fd\u8c03\u7528\u975e\u5e38\u91cf\u6210\u5458\u51fd\u6570\n</code></pre>"},{"location":"languages/ccpp/basic.html#std-buffer","title":"Std Buffer","text":"<p>libc will line-buffer when stdout to screen and block-buffer when stdout to a file, but no-buffer for stderr.</p>"},{"location":"languages/ccpp/basic.html#extern-c","title":"extern C","text":"<p>C++ \u7684\u5173\u952e\u5b57\uff0c\u7528\u4e8e\u5f15\u5165 C \u7684\u5934\u6587\u4ef6</p> <ul> <li>\u88ab extern \"C\" \u9650\u5b9a\u7684\u51fd\u6570\u6216\u53d8\u91cf\u662f<code>extern</code> \u7c7b\u578b\u7684</li> <li>\u8868\u660e\u51fd\u6570\u548c\u5168\u5c40\u53d8\u91cf\u4f5c\u7528\u8303\u56f4\uff08\u53ef\u89c1\u6027\uff09\u7684\u5173\u952e\u5b57\uff0c\u53ef\u4ee5\u88ab\u5916\u90e8\u6a21\u5757\u4f7f\u7528</li> <li>\u88ab extern \"C\" \u4fee\u9970\u7684\u53d8\u91cf\u548c\u51fd\u6570\u662f\u6309\u7167 <code>C</code> \u8bed\u8a00\u65b9\u5f0f\u7f16\u8bd1\u548c\u8fde\u63a5\u7684\u3002</li> <li>C\u4e2d\u7684\u51fd\u6570<code>C++</code> \u7f16\u8bd1\u540e\u5728\u7b26\u53f7\u5e93\u4e2d\u7684\u540d\u5b57\u4e0e <code>C</code> \u8bed\u8a00\u7684\u6709\u6240\u4e0d\u540c\uff08\u56e0\u4e3aC++\u652f\u6301\u51fd\u6570\u91cd\u8f7d\uff09</li> </ul> <p>\u793a\u4f8b\uff1aC \u4e2d\u7684\u5e93\uff0c\u5982\uff0c\u90fd\u5728\u5176\u5b9a\u4e49\u7684\u65f6\u5019\uff0c\u4f7f\u7528\u4e86<code>extern C</code> <ul> <li>\u5982\u679c C++ \u4e2d\u4f7f\u7528 C \u7684\u5e93\uff0c\u5982 stdlib\uff0c\u5e94\u8be5\u5f15\u5165 \\ \uff0c\u56e0\u4e3a\u4f1a\u5c06\u51fd\u6570\u9650\u5b9a\u5728 <code>std</code> \u7684\u540d\u7a7a\u95f4\uff1b <pre><code>#ifndef __BEGIN_DECLS\n# ifdef  __cplusplus\n#  define __BEGIN_DECLS  extern \"C\" {\n#  define __END_DECLS    }\n# else\n#  define __BEGIN_DECLS\n#  define __END_DECLS\n# endif\n#endif\n</code></pre> <ul> <li> <ul> <li></li> </ul> </li> </ul>"},{"location":"languages/ccpp/call_python.html","title":"Call Python","text":""},{"location":"languages/ccpp/call_python.html#gil","title":"GIL","text":"<p>\u5728\u4f7f\u7528CPython\u89e3\u91ca\u5668\u65f6\uff0c\u8981\u6ce8\u610fGIL\uff08\u5168\u5c40\u89e3\u91ca\u9501\uff09\u7684\u5de5\u4f5c\u539f\u7406\u4ee5\u53ca\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\u3002GIL\u4fdd\u8bc1\u5728\u4efb\u610f\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u89e3\u91ca\u5668\u4e2d\u8fd0\u884c\u3002\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e2d\uff0cpython\u89e3\u91ca\u5668\u5de5\u4f5c\u539f\u7406\u5982\u4e0b\uff1a Plain Text</p> <pre><code>1. \u8bbe\u7f6eGIL\n2. \u5207\u6362\u5230\u4e00\u4e2a\u7ebf\u7a0b\u53bb\u8fd0\u884c\n3. \u8fd0\u884c\uff1a\n    a. \u6307\u5b9a\u6570\u91cf\u7684\u5b57\u8282\u7801\u6307\u4ee4\uff0c\u6216\u8005\n    b. \u7ebf\u7a0b\u4e3b\u52a8\u8ba9\u51fa\u63a7\u5236\uff08\u53ef\u4ee5\u8c03\u7528time.sleep(0)\uff09\n4. \u628a\u7ebf\u7a0b\u8bbe\u7f6e\u4e3a\u7761\u7720\u72b6\u6001\n5. \u89e3\u9501GIL\n6. \u518d\u6b21\u91cd\u590d\u4ee5\u4e0a\u6240\u6709\u6b65\u9aa4\n</code></pre> <p>GIL\u662f\u4e00\u4e2a\u5386\u53f2\u9057\u7559\u95ee\u9898\uff0c\u5bfc\u81f4CPython\u591a\u7ebf\u7a0b\u4e0d\u80fd\u5229\u7528\u591a\u4e2aCPU\u5185\u6838\u7684\u8ba1\u7b97\u80fd\u529b\u3002\u4e3a\u4e86\u5229\u7528\u591a\u6838\uff0c\u901a\u5e38\u4f7f\u7528\u591a\u8fdb\u7a0b\u7684\u65b9\u6cd5\uff0c\u6216\u662f\u901a\u8fc7Python\u8c03\u7528C\u4ee3\u7801\uff0c\u7531C\u6765\u5b9e\u73b0\u591a\u7ebf\u7a0b\u3002</p> <p>\u6ce8\u610f\uff0c\u5f53\u5728C/C++\u521b\u5efa\u7684\u7ebf\u7a0b\u4e2d\u8c03\u7528Python\u65f6\uff0cGIL\u9700\u8981\u901a\u8fc7\u51fd\u6570PyGILState_Ensure()\u548cPyGILState_Release(\uff09\u624b\u52a8\u83b7\u53d6\u3001\u91ca\u653e\u3002 </p> <pre><code>PyGILState_STATE gstate;\ngstate = PyGILState_Ensure();\n\n/* Perform Python actions here. */\nresult = CallSomeFunction();\n/* evaluate result or handle exception */\n\n/* Release the thread. No Python API allowed beyond this point. */\nPyGILState_Release(gstate);\n</code></pre>"},{"location":"languages/ccpp/call_python.html#_1","title":"\u51fd\u6570","text":""},{"location":"languages/ccpp/call_python.html#python","title":"\u52a0\u8f7dpython\u6a21\u5757","text":"<pre><code>PyRun_SimpleString(\"import sys\"); //\u5bfc\u5165\u7cfb\u7edf\u6a21\u5757\nPyRun_SimpleString(\"sys.path.append('./')\"); //\u6307\u5b9apytest.py\u6240\u5728\u7684\u76ee\u5f55\nPyObject* fname = PyUnicode_FromString(\"hello\");\nPyObject* pModule = PyImport_Import(fname);\nif (pModule == NULL)\n{\n    PyErr_Print();\n    std::exit(1);\n}\n</code></pre>"},{"location":"languages/ccpp/call_python.html#_2","title":"\u8c03\u7528\u6a21\u5757\u7684\u51fd\u6570","text":""},{"location":"languages/ccpp/call_python.html#_3","title":"\u52a0\u8f7d\u6a21\u5757\u5185\u7684\u51fd\u6570","text":"<pre><code>PyObject *pfunc, *args, *results;\n// pModule \u662f\u4e0a\u4e00\u6b65load\u597d\u7684Python\u6a21\u5757\nPfunc= PyObject_GetAttrString(pModule, \"func\");\n// \u8bbe\u7f6e\u8c03\u7528func\u65f6\u7684\u8f93\u5165\u53d8\u91cf\uff0c\u8fd9\u91cc\u5047\u8bbe\u4e3a12345\nargs = Py_BuildValue(\"(i)\",12345); \n// \u6267\u884cfunc(12345)\uff0c\u5e76\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9results\nresults= PyObject_CallObject(Pfunc, args); \n</code></pre>"},{"location":"languages/ccpp/call_python.html#_4","title":"\u52a0\u8f7d\u6a21\u5757\u5185\u7684\u7c7b","text":"<pre><code>PyObject *pClass, *pDict,*pInstance, *class_args, *results;\n// \u62ff\u5230pModule\u91cc\u7684\u6240\u6709\u7c7b\u548c\u51fd\u6570\u5b9a\u4e49\npDict = PyModule_GetDict(pModule); \n// \u627e\u5230\u540d\u4e3aExecutor\u7684\u7c7b\npClass=PyDict_GetItemString(pDict,\"Executor\"); \n// \u8bbe\u7f6e\u7c7b\u521d\u59cb\u5316\u9700\u8981\u7684\u53c2\u6570\nclass_args = Py_BuildValue(\"(s)\",\"./config.txt\"); \n// \u521d\u59cb\u5316Executor\uff0c\u5efa\u7acb\u5b9e\u4f8bpInstance\npInstance=PyInstance_New(pClass, class_args, NULL ); \n// \u6267\u884cpInstance.func(12345)\nresults=PyObject_CallMethod(pInstance,\"func\",\"(i)\",12345); \n</code></pre>"},{"location":"languages/ccpp/call_python.html#_5","title":"\u53c2\u6570\u4f20\u9012","text":"<p>\u53c2\u6570\u683c\u5f0f\u89c1\uff1aParsing arguments and building values</p> <pre><code>PyObject* args = Py_BuildValue(\"(ifs)\", 100, 3.14, \"hello\");\n// \u5982\u679c\u8f93\u5165\u53c2\u6570\u662f\u53e6\u4e00\u4e2aPython\u51fd\u6570\u7684\u8f93\u51fa\u7ed3\u679cPyObject* results (o)\nPyObject* args = Py_BuildValue(\"(o)\", results);\n</code></pre>"},{"location":"languages/ccpp/call_python.html#_6","title":"\u89e3\u6790\u8fd4\u56de\u503c","text":"<p>\u540cC++\u4f20\u9012\u53c2\u6570\u5230Python\u7c7b\u4f3c\uff0c\u8c03\u7528\u89e3\u6790\u51fd\u6570</p> <p>\u5355\u4e2a\u8fd4\u56de\u503c\uff1aPyArg_Parse()</p> <p>\u591a\u8fd4\u56de\u503c\uff1aPyArg_ParseTuple()</p> <p>\u5177\u4f53\u4f8b\u5b50\uff1a1.7 Format Strings for PyArg_ParseTuple()</p>"},{"location":"languages/ccpp/call_python.html#_7","title":"\u91ca\u653e\u5f15\u7528","text":"<p>\u5728\u4f7f\u7528 <code>Py_DECREF</code> \u51fd\u6570\u65f6\uff0c\u9700\u8981\u786e\u4fdd\u5bf9\u8c61\u7684\u5f15\u7528\u8ba1\u6570\u5927\u4e8e 0\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u5185\u5b58\u9519\u8bef\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5728\u83b7\u53d6 Python \u5bf9\u8c61\u540e\uff0c\u4f1a\u81ea\u52a8\u589e\u52a0\u5176\u5f15\u7528\u8ba1\u6570\uff0c\u56e0\u6b64\u9700\u8981\u5728\u4f7f\u7528\u5b8c\u540e\u53ca\u65f6\u51cf\u5c11\u5f15\u7528\u8ba1\u6570\u3002</p> <pre><code>Py_DECREF(args);\n</code></pre>"},{"location":"languages/ccpp/call_python.html#demo","title":"Demo","text":"<pre><code>#include &lt;Python.h&gt;\nint main(int argc, char *argv[]) {\n    Py_Initialize();\n    PyRun_SimpleString(\"print('hello world')\\n\");\n    Py_Finalize();\n    return 0;\n}\n// g++ -o main main.cpp -I/home/conda/envs/HXAI/include/python3.6m -L/home/conda/envs/HXAI/lib/ -lpython3.6m\n// \u8f93\u51fa hello world\n</code></pre>"},{"location":"languages/ccpp/call_python.html#_8","title":"\u95ee\u9898","text":""},{"location":"languages/ccpp/call_python.html#importerror-python36lib-dynload_structcpython-36m-x86_64-linux-gnuso-undefined-symbol-pydict_size","title":"ImportError: **/python3.6/lib-dynload/_struct.cpython-36m-x86_64-linux-gnu.so: undefined symbol: PyDict_Size","text":"<p>conda\u88c5\u7684python\u4e2d\u5176lib-dynload\u6ca1\u6709link python\u7684\u52a8\u6001\u5e93\uff0c\u901a\u8fc7<code>ldd -r _struct.cpython-36m-x86_64-linux-gnu.so</code>\uff0c\u4f1a\u53d1\u73b0\u5f88\u591a\u7684unfined symbol\u3002</p> <p>\u56e0\u6b64\u9700\u8981\u63d0\u524d\u52a0\u8f7dpython\u7684\u52a8\u6001\u5e93\uff0c\u4f7f\u7528\u73af\u5883\u53d8\u91cf<code>LD_PRELOAD=/home/conda/envs/HXAI/lib/libpython3.6m.so</code>\u5b9e\u73b0\u3002</p>"},{"location":"languages/ccpp/class.html","title":"\u7c7b","text":""},{"location":"languages/ccpp/class.html#_2","title":"\u57fa\u672c\u5b9a\u4e49","text":"<ul> <li>\u5bf9\u8c61\u6210\u5458\u7684\u8c03\u7528\u987a\u5e8f\u6309\u7167\u58f0\u660e\u7684\u987a\u5e8f\uff0c\u5bf9\u8c61\u6210\u5458\u7684\u6790\u6784\u987a\u5e8f\u4e0e\u4e4b\u76f8\u53cd\uff1b</li> <li>A\u6784\u9020\u51fd\u6570\u8c03\u7528 --&gt;A\u7684\u7236\u7c7b\u6784\u9020\u51fd\u6570\u8c03\u7528 --&gt; A\u4e2d\u5bf9\u8c61\u6210\u5458\u7684\u6784\u9020\u51fd\u6570\u8c03\u7528\uff1b</li> <li>\u7c7b\u7684\u9759\u6001\u6210\u5458\uff08\u9664\u5e38\u91cf\uff09\u90fd\u9700\u8981\u5728\u7c7b\u5b9a\u4e49\u4e4b\u5916\u8fdb\u884c\u521d\u59cb\u5316\uff1b</li> </ul> <pre><code>// \u5bf9\u5e38\u91cf\u6570\u636e\u6210\u5458b\u548c\u5f15\u7528\u53d8\u91cfc\u8d4b\u503c\uff08\u8be5\u4e24\u7c7b\u6210\u5458\u4e00\u5b9a\u8981\u8d4b\u503c\uff09\uff1b\n// \u6570\u636e\u6210\u5458\u521d\u59cb\u5316\u987a\u5e8f\u6309\u5728\u7c7b\u4e2d\u7684\u58f0\u660e\u6b21\u5e8f\uff1b\nA(): b(1), c(x)\n</code></pre>"},{"location":"languages/ccpp/class.html#_3","title":"\u590d\u5236\uff08\u62f7\u8d1d\uff09\u6784\u9020\u51fd\u6570","text":"<p>\u9ed8\u8ba4\u7684\u590d\u5236\u6784\u9020\u51fd\u6570\u548c\u8d4b\u503c\u8fd0\u7b97\u7b26\u8fdb\u884c\u7684\u90fd\u662f\"shallow copy\"</p> <pre><code>// 1. const\u53ea\u662f\u4e3a\u4e86\u4e0d\u80fd\u4fee\u6539a\u7684\u5185\u5bb9\n// 2. \u7c7b\u6210\u5458\u53d8\u91cf\uff0c\u9700\u8981\u5728\u62f7\u8d1d\u51fd\u6570\u7684\u6210\u5458\u521d\u59cb\u5316\u8868\u4e2d\u6307\u5b9a\u62f7\u8d1d\u6784\u9020\u51fd\u6570\uff0c\u5426\u5219\u662f\u9ed8\u8ba4\u7684\u62f7\u8d1d\u51fd\u6570\uff1b\nA::A(const A &amp;a): b(a.b) {\n\n}\n</code></pre> <p>\u590d\u5236\u6784\u9020\u51fd\u6570\u5728\u4ec0\u4e48\u65f6\u5019\u88ab\u8c03\u7528</p> <ul> <li>\u5bf9\u8c61\u5728\u521b\u5efa\u65f6\u4f7f\u7528\u5176\u4ed6\u7684\u5bf9\u8c61\u521d\u59cb\u5316</li> </ul> <pre><code>Person p(q);  //\u6b64\u65f6\u590d\u5236\u6784\u9020\u51fd\u6570\u88ab\u7528\u6765\u521b\u5efa\u5b9e\u4f8bp\nPerson p = q; //\u6b64\u65f6\u590d\u5236\u6784\u9020\u51fd\u6570\u88ab\u7528\u6765\u5728\u5b9a\u4e49\u5b9e\u4f8bp\u65f6\u521d\u59cb\u5316p\n\n// \u5982\u679c\u5bf9\u8c61\u5df2\u7ecf\u5b58\u5728\uff0c\u7136\u540e\u5c06\u53e6\u4e00\u4e2a\u5df2\u5b58\u5728\u7684\u5bf9\u8c61\u8d4b\u7ed9\u5b83\uff0c\u8c03\u7528\u7684\u5c31\u662f\u8d4b\u503c\u8fd0\u7b97\u7b26(\u91cd\u8f7d)\np = q\n</code></pre> <ul> <li> <p>\u5bf9\u8c61\u4ee5\u503c\u4f20\u9012\u7684\u65b9\u5f0f\u4ece\u51fd\u6570\u8fd4\u56de</p> </li> <li> <p>\u5bf9\u8c61\u4f5c\u4e3a\u51fd\u6570\u7684\u53c2\u6570\u8fdb\u884c\u503c\u4f20\u9012\u65f6</p> </li> </ul>"},{"location":"languages/ccpp/class.html#_4","title":"\u8d4b\u503c\u91cd\u8f7d\u51fd\u6570","text":""},{"location":"languages/ccpp/class.html#_5","title":"\u53cb\u5143\u51fd\u6570","text":"<p>\u5c06\u8fd9\u4e9b\u53cb\u5143\u58f0\u660e\u5728\u7c7b\u91cc\uff1b</p> <ul> <li> <p>\u4f7f\u67d0\u5168\u5c40\u51fd\u6570\u3001\u5176\u4ed6\u7c7b\u6216\u5176\u4ed6\u7c7b\u7684\u67d0\u6210\u5458\u51fd\u6570\u53ef\u4ee5\u8bbf\u95ee\u8be5\u7c7b\u7684\u79c1\u6709\u548c\u4fdd\u62a4\u6210\u5458\uff0c\u79f0\u4e3a\u53cb\u5143\u51fd\u6570\u3001\u53cb\u5143\u7c7b\u3001\u53cb\u5143\u6210\u5458\u51fd\u6570\uff1b</p> </li> <li> <p>\u53cb\u5143\u4e0d\u5177\u6709\u4f20\u9012\u6027</p> </li> </ul>"},{"location":"languages/ccpp/class.html#_6","title":"\u7ee7\u627f","text":"<p>\u5c3d\u91cf\u4e0d\u4f7f\u7528\u83f1\u5f62\u7ee7\u627f\u3002</p> <ul> <li>\u6d3e\u751f\u7c7b\u4e0d\u7ee7\u627f\u57fa\u7c7b\u7684\u8d4b\u503c\u64cd\u4f5c\uff1b</li> <li>\u865a\u51fd\u6570\uff1avirtual\u9650\u5b9a\u7b26\uff1b\u7eaf\u865a\u51fd\u6570\uff0cvirtual void f() = 0; \u5305\u542b\u7eaf\u865a\u51fd\u6570\u4e3a\u62bd\u8c61\u7c7b\uff1b</li> <li>\u7eaf\u865a\u51fd\u6570\u6ca1\u6709\u5b9e\u4e60\uff0c\u865a\u51fd\u6570\u7236\u7c7b\u53ef\u4ee5\u6709\u5b9e\u73b0\uff1b</li> </ul>"},{"location":"languages/ccpp/concurrency.html","title":"\u5e76\u53d1","text":""},{"location":"languages/ccpp/concurrency.html#cc-memory-order","title":"C/C++ \u4e2dMemory Order","text":"<p>C/C++ \u4e2d\u7684  memory order \u3002</p> <p>Making Sense of Acquire-Release Semantics | Dave Kilian's Blog</p>"},{"location":"languages/ccpp/concurrency.html#volatile","title":"volatile","text":"<p>Java \u4e2d\u7684 volatile \u65e2\u4fdd\u8bc1\u53ef\u89c1\u6027\uff0c\u8fd8\u5177\u5907\u5185\u5b58\u5c4f\u969c\uff08\u9632\u91cd\u6392\u5e8f\uff09\u7684\u4f5c\u7528\u3002</p> <p>\u7f16\u8bd1\u5668\u505a\u7684\u662f\u9759\u6001\u4e71\u5e8f\u4f18\u5316\uff0cCPU\u505a\u7684\u662f\u52a8\u6001\u4e71\u5e8f\u4f18\u5316\u3002</p> <ul> <li>volatile\u5173\u952e\u5b57\u80fd\u591f\u7528\u6765\u89e3\u51b3\u5185\u5b58\u4e0eI/O\u7edf\u4e00\u7f16\u5740\u65f6\uff0c\u5bf9\u786c\u4ef6\u7684\u5373\u65f6\u8bbf\u95ee\u3002</li> </ul> <pre><code>// volatile \u4ec5\u4fdd\u8bc1\u53ef\u89c1\u6027\uff0c\u5173\u952e\u5b57\u8868\u793a\u6bcf\u6b21\u5185\u5b58\u6570\u636e\u8bfb\u53d6\u90fd\u8d70\u4e3b\u5b58\uff08\u4e0d\u8d70\u5bc4\u5b58\u5668\uff09\uff0c\u907f\u514d\u9759\u6001\u4e71\u5e8f\u4f18\u5316\nvolatile \n// volatile \u7b49\u4e8e\u7f16\u8bd1\u5668\u7ea7\u522b\u5c4f\u969c\uff0c\u4f46\u4e0d\u80fd\u963b\u6b62CPU\u786c\u4ef6\u7ea7\u522b\u5bfc\u81f4\u7684\u91cd\u6392\n#define barrier() __asm__ __volatile__(\"\": : :\"memory\") \n\n// CPU\u5c4f\u969c CPU Barrior\uff1a\u51fd\u6570\u8868\u793a\u5185\u5b58\u5c4f\u969c/\u7981\u6b62\u6307\u4ee4\u91cd\u6392\u5e8f\uff0c\u907f\u514d\u52a8\u6001\u4e71\u5e8f\u4f18\u5316\n__sync_synchronize()\n// C++11\u4e3a\u5185\u5b58\u5c4f\u969c\u63d0\u4f9b\u4e86\u4e13\u95e8\u7684\u51fd\u6570std::atomic_thread_fence\n</code></pre>"},{"location":"languages/ccpp/concurrency.html#_2","title":"\u7ebf\u7a0b\u672c\u5730\u53d8\u91cf","text":"<p>Static memory local to a thread (\u7ebf\u7a0b\u5c40\u90e8\u9759\u6001\u53d8\u91cf)\uff0c\u540c\u65f6\u4e5f\u53ef\u79f0\u4e4b\u4e3a\u7ebf\u7a0b\u7279\u6709\u6570\u636e\uff08TSD: Thread-Specific Data\uff09\u6216\u8005\u7ebf\u7a0b\u5c40\u90e8\u5b58\u50a8\uff08TLS: Thread-Local Storage\uff09\u3002</p> <pre><code>#include &lt;pthread.h&gt;\n\n// \u786e\u4fdd\u65e0\u8bba\u6709\u591a\u5c11\u4e2a\u7ebf\u7a0b\u8c03\u7528\u591a\u5c11\u6b21\u8be5\u51fd\u6570\uff0c\u4e5f\u53ea\u4f1a\u6267\u884c\u4e00\u6b21\u7531init\u6240\u6307\u5411\u7684\u7531\u8c03\u7528\u8005\u5b9a\u4e49\u7684\u51fd\u6570\u3002\nint pthread_once (pthread_once_t *once_control, void (*init) (void));\n\n// Returns 0 on success, or a positive error number on error\nint pthread_key_create (pthread_key_t *key, void (*destructor)(void *));\n\n// Returns 0 on success, or a positive error number on error\nint pthread_key_delete (pthread_key_t key);\n\n// Returns 0 on success, or a positive error number on error\nint pthread_setspecific (pthread_key_t key, const void *value);\n\n// Returns pointer, or NULL if no thread-specific data is associated with key\nvoid *pthread_getspecific (pthread_key_t key);\n</code></pre> <p>\u53ea\u8981\u7ebf\u7a0b\u7ec8\u6b62\u65f6\u4e0ekey\u5173\u8054\u7684\u503c\u4e0d\u4e3aNULL\uff0c\u5219destructor\u6240\u6307\u7684\u51fd\u6570\u5c06\u4f1a\u81ea\u52a8\u88ab\u8c03\u7528\u3002</p> <p>\u667a\u80fd\u7684<code>__thread</code>\u7684\u53d8\u91cf\u58f0\u660e\u3002</p>"},{"location":"languages/ccpp/debug.html","title":"C/C++ DEBUG","text":""},{"location":"languages/ccpp/debug.html#gdb","title":"gdb","text":"<ul> <li>\u7f16\u8bd1\u65f6 -ggdb \u6dfb\u52a0\u8c03\u8bd5\u4fe1\u606f\u3002</li> <li>gdbgui \u57fa\u4e8e\u6d4f\u89c8\u5668\u7684 gdb \u8c03\u8bd5\u3002</li> </ul> <ul> <li><code>starti</code> \u53ef\u4ee5\u8fdb\u884c\u6307\u4ee4\u6267\u884c\uff1b</li> <li><code>bt</code>\uff08backtrace\uff09\u67e5\u770b\u5806\u6808\uff1b</li> <li><code>layout asm/src</code> \u53ef\u4ee5\u67e5\u770b\u76f8\u5e94\u7684\u6c47\u7f16/\u6e90\u4ee3\u7801\uff1b\uff08\u5982\u4e0b\uff0c\u67e5\u770b $rsp \u5bc4\u5b58\u5668\u7684\u5730\u5740\u6240\u6307\u5b9a\u7684\u503c\uff08main\u51fd\u6570\u7684\u8fd4\u56de\u5730\u5740\uff09\uff09</li> </ul>"},{"location":"languages/ccpp/debug.html#_1","title":"\u5f02\u5e38","text":""},{"location":"languages/ccpp/debug.html#_2","title":"\u5904\u7406\u89c4\u5219","text":"<p>C++\u4e2d\uff0c\u5f02\u5e38\u4e0d\u53ef\u4ee5\u5ffd\u7565\uff0c\u5f53\u5f02\u5e38\u627e\u4e0d\u5230\u5339\u914d\u7684catch\u5b57\u53e5\u65f6\uff0c\u4f1a\u8c03\u7528\u7cfb\u7edf\u7684\u5e93\u51fd\u6570<code>terminate()</code>\uff08\u5728\u5934\u6587\u4ef6\u4e2d\uff09\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cterminate\uff08\uff09\u51fd\u6570\u8c03\u7528\u6807\u51c6C\u5e93\u51fd\u6570abort\uff08\uff09\u4f7f\u7a0b\u5e8f\u7ec8\u6b62\u800c\u9000\u51fa\u3002</p> <p>\u5f53\u8c03\u7528abort\u51fd\u6570\u65f6\uff0c\u7a0b\u5e8f\u4e0d\u4f1a\u8c03\u7528\u6b63\u5e38\u7684\u7ec8\u6b62\u51fd\u6570\uff0c\u5168\u5c40\u5bf9\u8c61\u548c\u9759\u6001\u5bf9\u8c61\u7684\u6790\u6784\u51fd\u6570\u4e0d\u4f1a\u6267\u884c\u3002</p>"},{"location":"languages/ccpp/debug.html#_3","title":"\u8bbe\u7f6e\u5f02\u5e38\u5806\u6808\u5904\u7406\u51fd\u6570","text":""},{"location":"languages/ccpp/debug.html#stdset_terminate","title":"std::set_terminate","text":"<p>\u5904\u7406\u672a\u8bbe\u7f6e\u5f02\u5e38\u5904\u7406\u51fd\u6570\u7684\u5f02\u5e38\uff08\u5373\u901a\u8fc7throw\u629b\u51fa\u7684\u5f02\u5e38\uff09\uff1a</p> <ul> <li>\u5bf9\u4e8e\u6570\u7ec4\u8d8a\u754c\u5f02\u5e38\uff08\u672a\u5b9a\u4e49\u884c\u4e3a\uff0cUndefined Behavior, UB\uff09\uff0c\u65e0\u6cd5\u6355\u83b7\uff1b</li> </ul>"},{"location":"languages/ccpp/debug.html#_4","title":"\u5f02\u5e38\u4fe1\u53f7","text":"<p>\u5f53\u7a0b\u5e8f\u51fa\u73b0\u5f02\u5e38\u65f6\u901a\u5e38\u4f34\u968f\u7740\u4f1a\u6536\u5230\u4e00\u4e2a\u7531\u5185\u6838\u53d1\u8fc7\u6765\u7684\u5f02\u5e38\u4fe1\u53f7\uff0c\u5982\u5f53\u5bf9\u5185\u5b58\u51fa\u73b0\u975e\u6cd5\u8bbf\u95ee\u65f6\u5c06\u6536\u5230\u6bb5\u9519\u8bef\u4fe1\u53f7SIGSEGV\uff0c\u7136\u540e\u624d\u9000\u51fa\u3002</p> <p>\u5229\u7528\u8fd9\u4e00\u70b9\uff0c\u5f53\u6211\u4eec\u5728\u6536\u5230\u5f02\u5e38\u4fe1\u53f7\u540e\u5c06\u7a0b\u5e8f\u7684\u8c03\u7528\u6808\u8fdb\u884c\u8f93\u51fa\uff0c\u5b83\u901a\u5e38\u662f\u5229\u7528<code>signal()</code>\u51fd\u6570\u3002</p>"},{"location":"languages/ccpp/debug.html#_5","title":"\u5f02\u5e38\u4ee3\u7801\u884c\u5b9a\u4f4d","text":""},{"location":"languages/ccpp/debug.html#backtrace","title":"backtrace","text":"<p>\u51fa\u73b0\u5d29\u6e83\u9000\u51fa\u65f6\u628a\u5f53\u524d\u8c03\u7528\u6808\u901a\u8fc7\u7ec8\u7aef\u6253\u5370\u51fa\u6765\u5e76\u5b9a\u4f4d\u95ee\u9898\u7684\u65b9\u6cd5\u3002</p> <p>\u5728Linux\u4e0a\u7684C/C++\u7f16\u7a0b\u73af\u5883\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u4e09\u4e2a\u51fd\u6570\u6765\u83b7\u53d6\u7a0b\u5e8f\u7684\u8c03\u7528\u6808\u4fe1\u606f\u3002</p> <pre><code>#include &lt;execinfo.h&gt;\n\n/* Store up to SIZE return address of the current program state in\n   ARRAY and return the exact number of values stored.  */\nint backtrace(void **array, int size);\n\n/* Return names of functions from the backtrace list in ARRAY in a newly\n   malloc()ed memory block.  */\nchar **backtrace_symbols(void *const *array, int size);\n\n/* This function is similar to backtrace_symbols() but it writes the result\n   immediately to a file.  */\nvoid backtrace_symbols_fd(void *const *array, int size, int fd);\n</code></pre> <p>\u5b83\u4eec\u7531GNU C Library\u63d0\u4f9b\uff0c\u5173\u4e8e\u5b83\u4eec\u66f4\u8be6\u7ec6\u7684\u4ecb\u7ecd\u53ef\u53c2\u8003Linux Programmer\u2019s Manual\u4e2d\u5173\u4e8ebacktrack\u76f8\u5173\u51fd\u6570\u7684\u4ecb\u7ecd\u3002</p> <p><code>backtrace</code>\u9700\u8981\u6ce8\u610f\u7684\u5730\u65b9\uff1a</p> <ul> <li><code>backtrace</code>\u7684\u5b9e\u73b0\u4f9d\u8d56\u4e8e\u6808\u6307\u9488\uff08fp\u5bc4\u5b58\u5668\uff09\uff0c\u5728gcc\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u4efb\u4f55\u975e\u96f6\u7684\u4f18\u5316\u7b49\u7ea7\uff08-On\u53c2\u6570\uff09\u6216\u52a0\u5165\u4e86\u6808\u6307\u9488\u4f18\u5316\u53c2\u6570-fomit-frame-pointer\u540e\u591a\u5c06\u4e0d\u80fd\u6b63\u786e\u5f97\u5230\u7a0b\u5e8f\u6808\u4fe1\u606f\uff1b</li> <li>\u5185\u8054\u51fd\u6570\u6ca1\u6709\u6808\u5e27\uff0c\u5b83\u5728\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u88ab\u5c55\u5f00\u5728\u8c03\u7528\u7684\u4f4d\u7f6e\uff1b</li> <li>\u5c3e\u8c03\u7528\u4f18\u5316\uff08Tail-call Optimization\uff09\u5c06\u590d\u7528\u5f53\u524d\u51fd\u6570\u6808\uff0c\u800c\u4e0d\u518d\u751f\u6210\u65b0\u7684\u51fd\u6570\u6808\uff0c\u8fd9\u5c06\u5bfc\u81f4\u6808\u4fe1\u606f\u4e0d\u80fd\u6b63\u786e\u88ab\u83b7\u53d6\u3002</li> </ul> <p>\u5bf9\u4e8e\u9759\u6001\u94fe\u63a5\u6587\u4ef6\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u83b7\u53d6\u5230\u7684\u9519\u8bef\u4fe1\u606f\u5982\u4e0b:</p> <pre><code>Dump stack start...\nbacktrace() returned 9 addresses\n  [00] [0x401806]\n  [01] [0x401925]\n  [02] [0x40a2a0]\n  [03] [0x401793]\n  [04] [0x4017cc]\n  [05] [0x401988]\n  [06] [0x401dda]\n  [07] [0x403677]\n  [08] [0x401675]\nDump stack end...\n</code></pre> <p>\u5bf9\u4e8e\u52a8\u6001\u94fe\u63a5\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u83b7\u53d6\u5230\u7684\u5806\u6808\u4fe1\u606f\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>Dump stack start...\nbacktrace() returned 9 addresses\n  [00] ./dynamic.out(+0x12bb) [0x55be3cc4a2bb]\n  [01] ./dynamic.out(+0x13da) [0x55be3cc4a3da]\n  [02] /lib/x86_64-linux-gnu/libc.so.6(+0x42520) [0x7f1e1c42c520]\n  [03] ./libadd.so(add1+0x1e) [0x7f1e1c61e137]\n  [04] ./libadd.so(add+0x20) [0x7f1e1c61e170]\n  [05] ./dynamic.out(+0x143d) [0x55be3cc4a43d]\n  [06] /lib/x86_64-linux-gnu/libc.so.6(+0x29d90) [0x7f1e1c413d90]\n  [07] /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0x80) [0x7f1e1c413e40]\n  [08] ./dynamic.out(+0x11c5) [0x55be3cc4a1c5]\nDump stack end...\n\nSegmentation fault\n</code></pre>"},{"location":"languages/ccpp/debug.html#addr2line","title":"addr2line","text":"<p>\u901a\u8fc7 <code>-g</code>\u7684debug\u4fe1\u606f\uff0c\u83b7\u53d6\u9519\u8bef\u7684\u884c\u53f7\u4fe1\u606f\u3002</p>"},{"location":"languages/ccpp/debug.html#_6","title":"\u9759\u6001\u94fe\u63a5\u60c5\u51b5\u4e0b\u7684\u9519\u8bef\u4fe1\u606f\u5206\u6790\u5b9a\u4f4d","text":"<p>\u7f16\u8bd1\u6210\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u5e76\u6267\u884c\u7684\u9519\u8bef\uff0c\u901a\u8fc7<code>addr2line</code>\u547d\u4ee4\u53ef\u4ee5\u5f97\u5230\uff1a</p> <pre><code># addr2line -e ${exe_name} ${error_address}\n$ addr2line -e static.out 0x401793\n# \u8f93\u51fa\u7ed3\u679c\u7c7b\u4f3c\u5982\u4e0b\u4fe1\u606f\uff0c\u53ef\u4ee5\u770b\u51fa\u884c\u53f7\u4fe1\u606f\n/home/share/work/backtrace/add.c:10\n</code></pre>"},{"location":"languages/ccpp/debug.html#_7","title":"\u52a8\u6001\u94fe\u63a5\u60c5\u51b5\u4e0b\u7684\u9519\u8bef\u4fe1\u606f\u5206\u6790\u5b9a\u4f4d","text":"<p>\u6309\u7167\u4e0a\u9762\u65b9\u6cd5\uff0c\u5f97\u4e0d\u5230\u6b63\u786e\u7684\u4fe1\u606f</p> <pre><code>$ addr2line -e dynamic.out 0x7fa4aa022137\n??:0\n$ addr2line -e libadd.so 0x1e\n??:0\n</code></pre> <p>\u56e0\u4e3a\uff0c\u52a8\u6001\u94fe\u63a5\u5e93\u662f\u7a0b\u5e8f\u8fd0\u884c\u65f6\u52a8\u6001\u52a0\u8f7d\u7684\uff0c\u5176\u52a0\u8f7d\u5730\u5740\u4e5f\u662f\u6bcf\u6b21\u53ef\u80fd\u90fd\u662f\u4e0d\u4e00\u6837\uff08ASLR\uff1aAddress Space Layout Randomization\uff09\u3002</p> <p>\u6ce8\u610f\u5230<code>add+0x1c</code>\u63cf\u8ff0\u51fa\u9519\u7684\u5730\u65b9\u53d1\u751f\u5728\u7b26\u53f7add1\u504f\u79fb0x1a\u5904\u7684\u5730\u65b9\uff0c\u83b7\u53d6 add1 \u5728\u7a0b\u5e8f\u4e2d\u7684\u5165\u53e3\u5730\u5740\u518d\u52a0\u4e0a\u504f\u79fb\u91cf0x1a\u4e5f\u80fd\u5f97\u5230\u6b63\u5e38\u7684\u51fa\u9519\u5730\u5740\u3002</p> <p>\u5f97\u5230\u51fd\u6570add\u7684\u5165\u53e3\u5730\u5740\u518d\u4e0a\u504f\u79fb\u91cf\u6765\u5f97\u5230\u6b63\u786e\u7684\u5730\u5740\uff08\u63a8\u8350\uff09</p> <p>\u901a\u8fc7 <code>nm</code> \u83b7\u53d6\u7b26\u53f7 <code>add1</code> \u7684\u5730\u5740</p> <pre><code>$ nm -n libadd.so | grep add1\n0000000000001119 T add1\n# add1\u7684\u5730\u5740\u4e3a 0x1119\uff0c\u7136\u540e\u52a0\u4e0a\u504f\u79fb\u5730\u57400x1a\u5373`0x1119 + 0x1e = 0x1137`\uff0c\u901a\u8fc7 addr2line \u53ef\u4ee5\u5b9a\u4f4d\u5230\u884c\u3002\n$ addr2line -e libadd.so 0x1137\n~/backtrace/add.c:10\n</code></pre>"},{"location":"languages/ccpp/debug.html#_8","title":"\u793a\u4f8b","text":"<p>add.c</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint add1(int num)\n{\n    int ret = 0x00;\n    int *pTemp = NULL;\n\n    *pTemp = 0x01;  /* \u8fd9\u5c06\u5bfc\u81f4\u4e00\u4e2a\u6bb5\u9519\u8bef\uff0c\u81f4\u4f7f\u7a0b\u5e8f\u5d29\u6e83\u9000\u51fa */\n\n    ret = num + *pTemp;\n\n    return ret;\n}\n\nint add(int num)\n{\n    int ret = 0x00;\n\n    ret = add1(num);\n\n    return ret;\n}\n</code></pre> <p>dump.c</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;     /* for signal */\n#include &lt;execinfo.h&gt;   /* for backtrace() */\n\n#define BACKTRACE_SIZE   16\n\nvoid dump(void)\n{\n    int j, nptrs;\n    void *buffer[BACKTRACE_SIZE];\n    char **strings;\n\n    nptrs = backtrace(buffer, BACKTRACE_SIZE);\n    printf(\"backtrace() returned %d addresses\\n\", nptrs);\n    strings = backtrace_symbols(buffer, nptrs);\n    if (strings == NULL) {\n        perror(\"backtrace_symbols\");\n        exit(EXIT_FAILURE);\n    }\n\n    for (j = 0; j &lt; nptrs; j++)\n        printf(\"  [%02d] %s\\n\", j, strings[j]);\n\n    free(strings);\n}\n\nvoid signal_handler(int signo)\n{\n\n#if 0   \n    char buff[64] = {0x00};\n    sprintf(buff,\"cat /proc/%d/maps\", getpid());\n    system((const char*) buff);\n#endif  \n\n    printf(\"\\n=========&gt;&gt;&gt;catch signal %d &lt;&lt;&lt;=========\\n\", signo);\n    printf(\"Dump stack start...\\n\");\n    dump();\n    printf(\"Dump stack end...\\n\");\n\n    signal(signo, SIG_DFL); /* \u6062\u590d\u4fe1\u53f7\u9ed8\u8ba4\u5904\u7406 */\n    raise(signo);           /* \u91cd\u65b0\u53d1\u9001\u4fe1\u53f7 */\n}\n</code></pre> <p>backtrace.c</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;     /* for signal */\n#include &lt;execinfo.h&gt;   /* for backtrace() */\n\nextern void dump(void);\nextern void signal_handler(int signo);\nextern int add(int num);\n\nint main(int argc, char *argv[])\n{\n    int sum = 0x00;\n    signal(SIGSEGV, signal_handler);  /* \u4e3aSIGSEGV\u4fe1\u53f7\u5b89\u88c5\u65b0\u7684\u5904\u7406\u51fd\u6570 */\n    sum = add(sum);\n    printf(\" sum = %d \\n\", sum);\n    return 0x00;\n}\n</code></pre> <p>Makefile</p> <pre><code>all: add dynamic static\n\nadd: add.c\n    gcc -g -shared -fPIC add.c -o libadd.so\n\n# \u53ea\u8981\u6c42\u51fa\u9519\u7684 so \u6709\u7b26\u53f7\u4fe1\u606f\u5373\u53ef\ndynamic: add dump.c backtrace.c \n    gcc dump.c backtrace.c -L./ -ladd -Wl,-rpath,./ -o dynamic.out\n\nstatic: add dump.c backtrace.c\n    gcc -g -static add.c dump.c backtrace.c -o static.out\n\nclean:\n    rm *.out *.so\n</code></pre>"},{"location":"languages/ccpp/gcc.html","title":"\u7f16\u8bd1\u3001\u52a0\u8f7d\u548c\u94fe\u63a5","text":"<p>\u6e90\u6587\u4ef6\u5230\u53ef\u6267\u884c\u76ee\u6807\u6587\u4ef6\uff1a</p> <ul> <li> <p>\u9884\u5904\u7406\uff08.i\u6587\u4ef6\uff09\uff1a<code>gcc -E hello.c -o hello.i</code></p> </li> <li> <p>\u5c06<code>#include</code>\u5305\u542b\u7684\u6587\u4ef6\u76f4\u63a5\u63d2\u5165\u5230\u7a0b\u5e8f\u6587\u672c\u4e2d\uff0c\u5b8f\u5b9a\u4e49\u66ff\u6362\u7b49</p> </li> <li> <p>\u7f16\u8bd1\uff08.s\u6587\u4ef6\uff09\uff1a  gcc -S hello.c -o hello.s</p> </li> <li> <p>0\u751f\u6210\u6c47\u7f16\u6587\u4ef6\uff1b</p> </li> <li> <p>\u6c47\u7f16\uff08.o\u6587\u4ef6\uff09\uff1agcc -c hello.c -o hello.o</p> </li> <li> <p>\u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u7a0b\u5e8f\uff0c\u7ffb\u8bd1\u6210\u673a\u5668\u8bed\u8a00\u6307\u4ee4\uff1b</p> </li> <li> <p>\u94fe\u63a5\u9636\u6bb5\uff1agcc hello.c -o hello</p> </li> <li>\u53ef\u6267\u884c\u76ee\u6807\u7a0b\u5e8f\uff0c\u94fe\u63a5\u5176\u5b83\u7684.o\u6587\u4ef6</li> </ul> <p></p>"},{"location":"languages/ccpp/gcc.html#_2","title":"\u9759\u6001\u94fe\u63a5\u548c\u52a8\u6001\u94fe\u63a5","text":"<ul> <li>\u9759\u6001\u94fe\u63a5\uff1a(.a )</li> <li><code>ar</code>\u547d\u4ee4\u7684<code>-t</code>\u53c2\u6570\u67e5\u770b\u9759\u6001\u5e93\u7684\u7ec4\u6210\uff0c<code>ar -t libg.a</code>\uff1b</li> <li> <p>\u6d6a\u8d39\u7a7a\u95f4\uff1b\u5e93\u51fd\u6570\u7684\u4ee3\u7801\u4fee\u6539\uff0c\u9700\u8981\u91cd\u65b0\u8fdb\u884c\u7f16\u8bd1\u94fe\u63a5\uff08bug\u4fee\u590d\uff09\uff1b\u6267\u884c\u901f\u5ea6\u5feb\uff08\u6ca1\u6709\u641c\u7d22\u52a0\u8f7d\u7684\u8fc7\u7a0b\uff09\uff1b</p> </li> <li> <p>\u52a8\u6001\u94fe\u63a5\uff1a(.so)</p> </li> <li>\u628a\u7a0b\u5e8f\u6309\u7167\u6a21\u5757\u62c6\u5206\u6210\u5404\u4e2a\u76f8\u5bf9\u72ec\u7acb\u90e8\u5206\uff0c\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u624d\u5c06\u5b83\u4eec\u94fe\u63a5\u5728\u4e00\u8d77\u5f62\u6210\u4e00\u4e2a\u5b8c\u6574\u7684\u7a0b\u5e8f</li> </ul>"},{"location":"languages/ccpp/gcc.html#_3","title":"\u52a8\u6001\u5e93","text":"<p>\u5f53 A.so \u4f9d\u8d56 B.so \u65f6\uff0c\u7f16\u8bd1 A.so \u65f6\uff0c\u53ea\u9700\u8981 include B \u7684\u5934\u6587\u4ef6\uff0c\u4e0d\u9700\u8981 <code>-L</code>,<code>-l</code>\u94fe\u63a5 B.so\u3002</p>"},{"location":"languages/ccpp/gcc.html#_4","title":"\u7f16\u8bd1","text":""},{"location":"languages/ccpp/gcc.html#gcc-g","title":"gcc \u548c g++","text":"<p><code>gcc</code>\uff1a\u9ed8\u8ba4\u5904\u7406 C \u8bed\u8a00\u6e90\u4ee3\u7801</p> <ul> <li>\u5f53\u4f7f\u7528 <code>gcc</code> \u7f16\u8bd1 C++ \u6e90\u4ee3\u7801\u65f6\uff0c\u53ef\u80fd\u9700\u8981\u624b\u52a8\u6307\u5b9a\u4e00\u4e9b\u53c2\u6570\uff08\u5982 <code>-lstdc++</code>\uff09\u6765\u786e\u4fdd\u6b63\u786e\u7684\u94fe\u63a5\u3002</li> </ul> <p><code>g++</code>\uff1a\u9ed8\u8ba4\u5904\u7406 C++ \u8bed\u8a00\u6e90\u4ee3\u7801\u3002</p> <ul> <li>\u94fe\u63a5 C++ \u6807\u51c6\u5e93\uff0c\u9ed8\u8ba4\u542f\u7528\u4e86\u4e0e C++ \u76f8\u5173\u7684\u9009\u9879\uff0c\u5982 RTTI\uff08\u8fd0\u884c\u65f6\u7c7b\u578b\u8bc6\u522b\uff09\u3001\u5f02\u5e38\u5904\u7406\u7b49</li> </ul>"},{"location":"languages/ccpp/gcc.html#_5","title":"\u53c2\u6570","text":""},{"location":"languages/ccpp/gcc.html#-g","title":"-g","text":"<p>gcc \u7684 -g \uff0c\u5e76\u4e14\u6839\u636e\u8c03\u8bd5\u5de5\u5177\u7684\u4e0d\u540c\uff0c\u8fd8\u80fd\u76f4\u63a5\u9009\u62e9\u66f4\u6709\u9488\u5bf9\u6027\u7684\u8bf4\u660e\uff0c\u6bd4\u5982 -ggdb \u3002-g\u662f\u4e00\u4e2a\u7f16\u8bd1\u9009\u9879\uff0c\u5373\u5728\u6e90\u4ee3\u7801\u7f16\u8bd1\u7684\u8fc7\u7a0b\u4e2d\u8d77\u4f5c\u7528\uff0c\u8ba9gcc\u628a\u66f4\u591a\u8c03\u8bd5\u4fe1\u606f\uff08\u4e5f\u5c31\u5305\u62ec\u7b26\u53f7\u4fe1\u606f\uff09\u6536\u96c6\u8d77\u6765\u5e76\u5c06\u5b58\u653e\u5230\u6700\u7ec8\u7684\u53ef\u6267\u884c\u6587\u4ef6\u5185\u3002 </p>"},{"location":"languages/ccpp/gcc.html#-rdynamic","title":"-rdynamic","text":"<p>\u8fde\u63a5\u9009\u9879 \uff0c\u6307\u793a\u8fde\u63a5\u5668\u628a\u6240\u6709\u7b26\u53f7\uff08\u800c\u4e0d\u4ec5\u4ec5\u53ea\u662f\u7a0b\u5e8f\u5df2\u4f7f\u7528\u5230\u7684\u5916\u90e8\u7b26\u53f7\uff09\u90fd\u6dfb\u52a0\u5230\u52a8\u6001\u7b26\u53f7\u8868\uff08\u5373.dynsym\u8868\uff09\u91cc\uff0c\u4ee5\u4fbf\u90a3\u4e9b\u901a\u8fc7 dlopen() \u6216 backtrace() \uff08\u8fd9\u4e00\u7cfb\u5217\u51fd\u6570\u4f7f\u7528.dynsym\u8868\u5185\u7b26\u53f7\uff09\u8fd9\u6837\u7684\u51fd\u6570\u4f7f\u7528\u3002</p>"},{"location":"languages/ccpp/gcc.html#-fpic-shared","title":"-fPIC/-shared","text":"<p>-fPIC \u4f5c\u7528\u4e8e\u7f16\u8bd1\u9636\u6bb5\uff0c\u544a\u8bc9\u7f16\u8bd1\u5668\u4ea7\u751f\u4e0e\u4f4d\u7f6e\u65e0\u5173\u4ee3\u7801(Position-Independent Code)\uff0c\u5219\u4ea7\u751f\u7684\u4ee3\u7801\u4e2d\uff0c\u6ca1\u6709\u7edd\u5bf9\u5730\u5740\uff0c\u5168\u90e8\u4f7f\u7528\u76f8\u5bf9\u5730\u5740\uff0c\u6545\u800c\u4ee3\u7801\u53ef\u4ee5\u88ab\u52a0\u8f7d\u5668\u52a0\u8f7d\u5230\u5185\u5b58\u7684\u4efb\u610f\u4f4d\u7f6e\uff0c\u90fd\u53ef\u4ee5\u6b63\u786e\u7684\u6267\u884c\u3002\u8fd9\u6b63\u662f\u5171\u4eab\u5e93\u6240\u8981\u6c42\u7684\uff0c\u5171\u4eab\u5e93\u88ab\u52a0\u8f7d\u65f6\uff0c\u5728\u5185\u5b58\u7684\u4f4d\u7f6e\u4e0d\u662f\u56fa\u5b9a\u7684\u3002</p> <p>GCC\u6765\u770b\uff0c<code>-shared</code>\u5e94\u8be5\u662f\u5305\u542b fPIC \u9009\u9879\u7684\uff0c\u4f46\u4f3c\u4e4e\u4e0d\u662f\u6240\u4ee5\u7cfb\u7edf\u90fd\u652f\u6301\uff0c\u6240\u4ee5\u6700\u597d\u663e\u5f0f\u52a0\u4e0afPIC\u9009\u9879</p>"},{"location":"languages/ccpp/gcc.html#-fvisibilityhidden","title":"-fvisibility=hidden","text":"<p>\u4e0d\u540c\u7684 so \u5e93\u4e2d\u542b\u6709\u540c\u6837\u7684\u51fd\u6570\uff08\u540c\u540d\u7684\u5168\u5c40\u7b26\u53f7\uff09\uff0c\u5982 libA \u4e2d\u548c libB \u4e2d\u90fd\u6709 subfunc \u51fd\u6570\uff1a</p> <ul> <li>main\u5148\u52a0\u8f7d\u4e86libA\uff0c\u5f97\u5230\u4e86libA\u4e2d\u7684subfunc\u7b26\u53f7\uff0c\u518d\u52a0\u8f7dlibB\u65f6\uff0c\u5c31\u628alibB\u4e2d\u7684subfunc\u5ffd\u7565\u4e86\u3002</li> </ul> <p>\u5b9e\u9645\u60c5\u51b5 libA \u91cc\u9762\u6709\u5f88\u591a\u7684\u5185\u90e8\u51fd\u6570\uff0c\u800c\u66b4\u9732\u7ed9\u5916\u90e8\u7684\u53ea\u6709\u5c11\u6570\uff0c\u80fd\u4e0d\u80fd\u6307\u5b9a\u5c11\u6570\u7b26\u53f7\u4e3aGLOBAL\uff0c\u5176\u5b83\u7684\u90fd\u662fLOCAL\u5462\uff1f\u7b54\u6848\u662f\u80af\u5b9a\u7684\uff0c\u4fee\u6539libA.cpp\u5982\u4e0b\uff1a</p> <pre><code>int subfunc(int a, int b) {\n    return a + b;\n}\n\n__attribute__ ((visibility (\"default\"))) int funcA(int a, int b) {\n    return subfunc(a, b);\n}\u8fd9\u65f6\uff0clibA\u7684\u7f16\u8bd1\u53c2\u6570\u9700\u8981\u52a0\u4e0a`-fvisibility=hidden`\uff1a\n</code></pre> <pre><code>g++ -fPIC libA.cpp -shared -fvisibility=hidden -o libA.so\n</code></pre>"},{"location":"languages/ccpp/gcc.html#-d_reentrant","title":"-D_REENTRANT","text":"<p><code>_REENTRANT</code> \u5b8f\u53ef\u80fd\u5df2\u7ecf\u88ab\u5e9f\u5f03\u6216\u66ff\u6362\u4e3a\u5176\u4ed6\u673a\u5236\uff08\u5982 <code>-pthread</code> \u7f16\u8bd1\u9009\u9879\uff09</p> <p>\u5728\u4e00\u4e2a\u591a\u7ebf\u7a0b\u7a0b\u5e8f\u91cc\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53ea\u6709\u4e00\u4e2a<code>errno</code>\u53d8\u91cf\u4f9b\u6240\u6709\u7684\u7ebf\u7a0b\u5171\u4eab\u3002\u5728\u4e00\u4e2a\u7ebf\u7a0b\u51c6\u5907\u83b7\u53d6\u521a\u624d\u7684\u9519\u8bef\u4ee3\u7801\u65f6\uff0c\u8be5\u53d8\u91cf\u5f88\u5bb9\u6613\u88ab\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u4e2d\u7684\u51fd\u6570\u8c03\u7528\u6240\u6539\u53d8\u3002\u7c7b\u4f3c\u7684\u95ee\u9898\u8fd8\u5b58\u5728\u4e8e<code>fputs</code>\u4e4b\u7c7b\u7684\u51fd\u6570\u4e2d\uff0c\u8fd9\u4e9b\u51fd\u6570\u901a\u5e38\u7528\u4e00\u4e2a\u5355\u72ec\u7684\u5168\u5c40\u6027\u533a\u57df\u6765\u7f13\u5b58\u8f93\u51fa\u6570\u636e\u3002</p> <p>\u53ef\u91cd\u5165\u4ee3\u7801\u53ef\u4ee5\u88ab\u591a\u6b21\u8c03\u7528\u800c\u4ecd\u7136\u5de5\u4f5c\u6b63\u5e38\u3002\u7f16\u5199\u7684\u591a\u7ebf\u7a0b\u7a0b\u5e8f\uff0c\u901a\u8fc7\u5b9a\u4e49\u5b8f_REENTRANT\u6765\u544a\u8bc9\u7f16\u8bd1\u5668\u6211\u4eec\u9700\u8981\u53ef\u91cd\u5165\u529f\u80fd\u3002</p> <ul> <li>\u8fd9\u4e2a\u5b8f\u7684\u5b9a\u4e49\u5fc5\u987b\u51fa\u73b0\u4e8e\u7a0b\u5e8f\u4e2d\u7684\u4efb\u4f55<code>#include</code>\u8bed\u53e5\u4e4b\u524d\u3002</li> </ul> <p><code>_REENTRANT</code>\u4e3a\u6211\u4eec\u505a\u4e09\u4ef6\u4e8b\u60c5\uff0c\u5e76\u4e14\u505a\u7684\u975e\u5e38\u4f18\u96c5\uff1a</p> <ul> <li> <p>\u5b9a\u4e49\u53ef\u91cd\u5165\u7684\u51fd\u6570\u7248\u672c\uff1a\u51fd\u6570\u540d\u540e\u9762\u6dfb\u52a0<code>_r</code>\u5b57\u7b26\u4e32\uff0c\u5982\u51fd\u6570\u540d <code>gethostbyname</code> \u53d8\u6210 <code>gethostbyname_r</code>\u3002</p> </li> <li> <p>\u8f6c\u6362\u5b8f\u5b9e\u73b0\u7684\u51fd\u6570\uff1a<code>stdio.h</code>\u4e2d\u539f\u6765\u4ee5\u5b8f\u7684\u5f62\u5f0f\u5b9e\u73b0\u7684\u4e00\u4e9b\u51fd\u6570\u5c06\u53d8\u6210\u53ef\u5b89\u5168\u91cd\u5165\u51fd\u6570</p> </li> <li>\u6539\u53d8\u9519\u8bef\u5904\u7406\uff1a\u5728<code>error.h</code>\u4e2d\u5b9a\u4e49\u7684\u53d8\u91cferror\u73b0\u5728\u5c06\u6210\u4e3a\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\uff0c\u5b89\u5168\u7684\u591a\u7ebf\u7a0b\u65b9\u5f0f\u6765\u83b7\u53d6\u771f\u6b63\u7684errno\u7684\u503c</li> </ul>"},{"location":"languages/ccpp/gcc.html#-i-i","title":"-I (\u5927\u5199\u7684i)","text":"<p>include\u5934\u6587\u4ef6\u7684\u8def\u5f84</p>"},{"location":"languages/ccpp/gcc.html#-ll","title":"-l\uff08\u5c0f\u5199\u7684l\uff09","text":"<p>\u94fe\u63a5\u7684lib\u5e93\u7684\u540d\u5b57</p>"},{"location":"languages/ccpp/gcc.html#-l","title":"-L","text":"<p>lib\u5e93\u7684\u641c\u7d22\u8def\u5f84</p>"},{"location":"languages/ccpp/make.html","title":"Make\u5de5\u5177\u94fe","text":""},{"location":"languages/ccpp/make.html#makefile","title":"Makefile","text":""},{"location":"languages/ccpp/make.html#automake","title":"AutoMake","text":""},{"location":"languages/java/agent.html","title":"Java Agent","text":"<p>\u8fd0\u884c\u65f6\u52a8\u6001\u4fee\u6539\u7c7b\uff0c\u4ee3\u7801\u65e0\u4fb5\u5165\uff1b</p>"},{"location":"languages/java/agent.html#premain","title":"\u542f\u52a8\u65f6\u52a0\u8f7d(Premain)","text":"<p>\u901a\u8fc7 -javaagent \u53c2\u6570\u6307\u5b9a\u4e00\u4e2a\u7279\u5b9a\u7684 jar \u6587\u4ef6\uff08\u5305\u542bInstrumentation \u4ee3\u7406\uff09\u6765\u542f\u52a8\u4ee3\u7406\u7a0b\u5e8f\uff1b</p> <pre><code>java -javaagent:jar Instrumentation_jar -jar xxx.jar\n</code></pre> <p><code>Instrumentation_jar</code>\u4e2d\u7684 META-INF/MAINFEST.INF\u6587\u4ef6\u7684\u5b9a\u4e49\uff1a</p> <ul> <li>Premain-Class\uff1a\u5fc5\u987b\u5305\u542b\uff0cJVM\u542f\u52a8\u65f6\u6307\u5b9a\u4ee3\u7406\uff0c\u5305\u542bpremain\u65b9\u6cd5\u7684\u7c7b\uff1b</li> </ul> <pre><code>// \u5148\u627e\u8be5\u65b9\u6cd5\u7b7e\u540d\npublic static void premain(final String args, final Instrumentation instrumentation) {}\n// \u627e\u4e0d\u5230\uff0c\u518d\u627e\u8be5\u65b9\u6cd5\u51fd\u6570\npublic static void premain(String agentArgs);\n</code></pre>"},{"location":"languages/java/agent.html#agentmain","title":"\u8fd0\u884c\u65f6\u52a0\u8f7d(Agentmain)","text":"<p>\u5728\u4e3b\u7a0b\u5e8f\u8fd0\u884c\u524d\u5c31\u6307\u5b9ajavaagent\u53c2\u6570\uff0cpremain\u65b9\u6cd5\u4e2d\u4ee3\u7801\u51fa\u73b0\u5f02\u5e38\u4f1a\u5bfc\u81f4\u4e3b\u7a0b\u5e8f\u542f\u52a8\u5931\u8d25\u7b49\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff0cJDK1.6\u4ee5\u540e\u63d0\u4f9b\u4e86\u5728\u7a0b\u5e8f\u8fd0\u884c\u4e4b\u540e\u6539\u53d8\u7a0b\u5e8f\u7684\u80fd\u529b\u3002</p> <p>\u901a\u8fc7attach\u673a\u5236\uff0c\u5c06JVM A\u8fde\u63a5\u81f3JVM B\uff0c\u5e76\u53d1\u9001\u6307\u4ee4\u7ed9JVM B\u6267\u884c\u3002</p> <p><code>agent.jar</code>\u4e2d\u7684META-INF/MAINFEST.INF\u6587\u4ef6</p> <ul> <li>Agentmain-Class\uff1a\u5fc5\u987b\u5305\u542b\uff0cJVM\u542f\u52a8\u65f6\u6307\u5b9a\u4ee3\u7406\uff0c\u5305\u542bagentmain\u65b9\u6cd5\u7684\u7c7b\uff1b</li> </ul> <pre><code>public static void agentmain(final String args, final Instrumentation instrumentation) {}\npublic static void agentmain(String agentArgs);\n</code></pre> <p>JVM A \u7684\u793a\u4f8b\u4ee3\u7801\uff1a</p> <pre><code>public static void main(String[] args) {\n    try {\n        String jvmPid = \"23281\"; // \u76ee\u6807\u8fdb\u884c\u7684pid;\n        VirtualMachine vm = VirtualMachine.attach(jvmPid);  \n        vm.loadAgent(\"agent.jar\");\n        vm.detach();\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n}\n</code></pre>"},{"location":"languages/java/agent.html#instrument","title":"Instrument","text":"<p>instrument\u662fJVM\u63d0\u4f9b\u7684\u4e00\u4e2a\u53ef\u4ee5\u4fee\u6539\u5df2\u52a0\u8f7d\u7c7b\u7684\u7c7b\u5e93\uff0c\u4e13\u95e8\u4e3aJava\u8bed\u8a00\u7f16\u5199\u7684\u63d2\u6869\u670d\u52a1\u63d0\u4f9b\u652f\u6301\u3002\u5b83\u9700\u8981\u4f9d\u8d56JVMTI \u7684Attach API\u673a\u5236\u5b9e\u73b0\u3002</p> <ul> <li>\u5b9e\u73b0\u5b83\u63d0\u4f9b\u7684 ClassFileTransformer \u63a5\u53e3\uff0c\u5b9a\u4e49\u4e00\u4e2a\u7c7b\u6587\u4ef6\u8f6c\u6362\u5668\u3002\u63a5\u53e3\u4e2d\u7684transform()\u65b9\u6cd5\u4f1a\u5728\u7c7b\u6587\u4ef6\u88ab\u52a0\u8f7d\u65f6\u8c03\u7528\uff1b</li> <li>\u5728transform\u65b9\u6cd5\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u4e0a\u6587\u4e2d\u7684 ASM \u6216 Javassist \u5bf9\u4f20\u5165\u7684\u5b57\u8282\u7801\u8fdb\u884c\u6539\u5199\u6216\u66ff\u6362\uff0c\u751f\u6210\u65b0\u7684\u5b57\u8282\u7801\u6570\u7ec4\u540e\u8fd4\u56de\u3002</li> </ul>"},{"location":"languages/java/agent.html#_1","title":"\u914d\u7f6e","text":"<ul> <li>\u5728\u4e00\u4e2a\u666e\u901a Java \u7a0b\u5e8f\uff08\u5e26\u6709 main \u51fd\u6570\u7684 Java \u7c7b\uff09\u8fd0\u884c\u65f6\uff0c\u901a\u8fc7 <code>-javaagent</code> \u53c2\u6570\u6307\u5b9a\u4e00\u4e2a\u7279\u5b9a\u7684 jar \u6587\u4ef6\uff08\u5305\u542b Instrumentation \u4ee3\u7406\uff09\u6765\u542f\u52a8 Instrumentation \u7684\u4ee3\u7406\u7a0b\u5e8f\u3002\u5728\u7c7b\u7684\u5b57\u8282\u7801\u8f7d\u5165jvm\u524d\u4f1a\u8c03\u7528ClassFileTransformer\u7684transform\u65b9\u6cd5\uff0c\u4ece\u800c\u5b9e\u73b0\u4fee\u6539\u539f\u7c7b\u65b9\u6cd5\u7684\u529f\u80fd\uff0c\u5b9e\u73b0aop\uff1b</li> <li>\u4e0d\u4f1a\u50cf\u52a8\u6001\u4ee3\u7406\u6216\u8005cglib\u6280\u672f\u5b9e\u73b0aop\u90a3\u6837\u4f1a\u4ea7\u751f\u4e00\u4e2a\u65b0\u7c7b\uff0c\u4e5f\u4e0d\u9700\u8981\u539f\u7c7b\u8981\u6709\u63a5\u53e3\uff1b</li> </ul> <pre><code>&lt;!-- maven \u6253\u5305\u751f\u6210--&gt;\n&lt;plugin&gt;\n    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.6&lt;/version&gt;\n    &lt;configuration&gt;\n        &lt;archive&gt;\n            &lt;manifestEntries&gt;\n                &lt;Agent-Class&gt;com.uber.profiling.Agent&lt;/Agent-Class&gt;\n                &lt;Premain-Class&gt;com.uber.profiling.Agent&lt;/Premain-Class&gt;\n            &lt;/manifestEntries&gt;\n        &lt;/archive&gt;\n    &lt;/configuration&gt;\n&lt;/plugin&gt;\n</code></pre> <ul> <li><code>META-INF/MAINFEST.INF</code>\u6587\u4ef6</li> <li><code>Premain-Class</code>\uff1a\u5fc5\u987b\u5305\u542b\uff0cJVM\u542f\u52a8\u65f6\u6307\u5b9a\u4ee3\u7406\uff0c\u5305\u542bpremain\u65b9\u6cd5\u7684\u7c7b\uff1b</li> <li><code>Agent-Class</code>\uff1a\u652f\u6301VM\u542f\u52a8\u4e4b\u540e\uff0c\u5728\u67d0\u65f6\u523b\u542f\u52a8\u4ee3\u7406\u7684\u673a\u5236\uff0c\u6307\u5b9a\u4ee3\u7406\u7c7b\uff08\u5305\u542bagentmain\u65b9\u6cd5\uff09\uff1b</li> <li><code>Boot-Class-Path</code>\uff1a\u5f15\u5bfc\u7c7b\u52a0\u8f7d\u5668\u641c\u7d22\u7684\u8def\u5f84\u5217\u8868\uff1b</li> <li><code>Can-Redefine-Classes</code>\uff1a\u5e03\u5c14\u503c\uff08\u9ed8\u8ba4\uff09\uff0c\u80fd\u591f\u91cd\u5b9a\u4e49\u6b64\u4ee3\u7406\u9700\u8981\u7684\u7c7b\uff1b</li> <li><code>Can-Retransform-Classes</code>\uff1atrue\u6216false\uff08\u9ed8\u8ba4\uff09\uff0c\u80fd\u5426\u91cd\u8f6c\u6362\u6b64\u4ee3\u7406\u9700\u8981\u7684\u7c7b\uff1b</li> <li><code>Can-Set-Native-Method-Prefix</code>\uff1atrue \u6216 false\uff08\u9ed8\u8ba4\uff09\uff0c\u662f\u5426\u80fd\u8bbe\u7f6e\u6b64\u4ee3\u7406\u6240\u9700\u7684\u672c\u673a\u65b9\u6cd5\u524d\u7f00\uff1b</li> </ul>"},{"location":"languages/java/annotation.html","title":"\u6ce8\u89e3","text":"<p>\u6ce8\u89e3\u5b9a\u4e49\u65f6\uff0c\u4e0d\u53ef\u4ee5\u7ee7\u627f\u5176\u5b83\u7684\u6ce8\u89e3\u6216\u63a5\u53e3\uff1b</p>"},{"location":"languages/java/annotation.html#_2","title":"\u5143\u6ce8\u89e3","text":"<p>\u56db\u79cd\u5143\u6ce8\u89e3\uff0cjava.lang.annotation\uff0c\u4e13\u95e8\u6ce8\u91ca\u5176\u4ed6\u7684\u6ce8\u89e3\uff1a</p> <ul> <li> <p>@Documented\uff1a\u6ce8\u89e3\u662f\u5426\u5c06\u5305\u542b\u5728JavaDoc\u4e2d</p> </li> <li> <p>@Retention\uff1a\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528\u8be5\u6ce8\u89e3\uff0c\u6ce8\u89e3\u7684\u751f\u547d\u5468\u671f\uff0cRetentionPolicy</p> </li> <li> <p>SOURCE\uff1a\u7f16\u8bd1\u9636\u6bb5\u4e22\u5f03\uff0c\u6ce8\u89e3\u5728\u7f16\u8bd1\u7ed3\u675f\u65e0\u610f\u4e49\uff0c\u5982@Override,       @suppressWarnings\uff1b</p> </li> <li>CLASS\uff1a\u7c7b\u52a0\u8f7d\u65f6\u5019\u4e22\u5f03\uff0c\u5728\u5b57\u8282\u7801\u6587\u4ef6\u7684\u5904\u7406\u4e2d\u6709\u7528\uff0c\u9ed8\u8ba4\u65b9\u5f0f\uff1b</li> <li> <p>RUNTIME\uff1a\u4e0d\u4e22\u5f03\uff0c\u8fd0\u884c\u671f\u4e5f\u4fdd\u7559\u6ce8\u89e3\uff0c\u53ef\u4ee5\u4f7f\u7528\u53cd\u5c04\u673a\u5236\u8bfb\u53d6\u6ce8\u89e3\u4fe1\u606f\uff1b\u81ea\u5b9a\u4e49\u6ce8\u89e3\u4f7f\u7528\uff1b</p> </li> <li> <p>@Target\uff1a\u6ce8\u89e3\u7528\u4e8e\u4ec0\u4e48\u5730\u65b9\uff0cElementType.{TYPE, METHOD,\u2026}</p> </li> <li>@Inherited\uff1a\u662f\u5426\u5141\u8bb8\u5b50\u7c7b\u7ee7\u627f\u8be5\u6ce8\u89e3\uff0c\u53ea\u5bf9<code>\u7c7b</code>\u751f\u6548\uff1b</li> <li>\u5982\u679c\u5143\u6ce8\u89e3Inherited\u4fee\u9970\u7684\u5176\u4ed6\u6ce8\u89e3\uff0c\u4fee\u9970\u4e86\u9664\u7c7b\u4e4b\u5916\u7684\u5176\u4ed6\u7a0b\u5e8f\u5143\u7d20\uff0c\u90a3\u4e48\u7ee7\u627f\u6027\u5c06\u4f1a\u5931\u6548\u3002</li> <li>\u65b9\u6cd5\u548c\u5c5e\u6027\u4e0a\u6ce8\u89e3\u7684\u7ee7\u627f\uff0c\u5fe0\u5b9e\u4e8e\u65b9\u6cd5/\u5c5e\u6027\u7ee7\u627f\u672c\u8eab\uff0c\u5ba2\u89c2\u53cd\u6620\u65b9\u6cd5/\u5c5e\u6027\u4e0a\u7684\u6ce8\u89e3\u3002</li> </ul> <p>@interface\u7528\u6765\u58f0\u660e\u4e00\u4e2a\u6ce8\u89e3\uff0c\u5176\u4e2d\u7684\u6bcf\u4e00\u4e2a\u65b9\u6cd5\u5b9e\u9645\u4e0a\u662f\u58f0\u660e\u4e86\u4e00\u4e2a\u914d\u7f6e\u53c2\u6570\u3002\u65b9\u6cd5\u7684\u540d\u79f0\u5c31\u662f\u53c2\u6570\u7684\u540d\u79f0\uff0c\u8fd4\u56de\u503c\u7c7b\u578b\u5c31\u662f\u53c2\u6570\u7684\u7c7b\u578b\uff08\u8fd4\u56de\u503c\u7c7b\u578b\u53ea\u80fd\u662f\u57fa\u672c\u7c7b\u578b\u3001Class\u3001String\u3001enum\uff09\u3002\u53ef\u4ee5\u901a\u8fc7default\u6765\u58f0\u660e\u53c2\u6570\u7684\u9ed8\u8ba4\u503c\u3002</p> <pre><code>@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.METHOD)\npublic @interface Action {\n    String input() default \"\";\n    FaultAction[] fault() default { };\n}\n</code></pre>"},{"location":"languages/java/annotation.html#_3","title":"\u5e38\u7528\u7684\u6ce8\u89e3","text":""},{"location":"languages/java/annotation.html#guardedby","title":"@GuardedBy","text":"<p>@GuardedBy(\"mResourcesManager\")</p> <p>\u662f\u4e00\u4e2a\u540c\u6b65\u9501\uff0c\u53ea\u6709\u5728\u7ebf\u7a0b\u6301\u6709mResourcesManager\u5bf9\u8c61\u9501\u65f6\uff0c\u624d\u80fd\u4f7f\u7528\u8fd9\u5199\u53d8\u91cf\u3002</p>"},{"location":"languages/java/annotation.html#_4","title":"\u6ce8\u89e3\u7ec4\u5408","text":"<p>Spring \u7684\u80fd\u529b\uff0c\u5e76\u975e\u662f Java \u81ea\u8eab\u7684\u80fd\u529b\uff0c\u66f4\u8be6\u7ec6\u7684\u5185\u5bb9\u89c1 Spring \u7684\u6ce8\u89e3\u7ec4\u5408\u3002</p> <pre><code>// \u901a\u8fc7\u8be5\u51fd\u6570\u80fd\u591f\u83b7\u53d6\u5230\u88ab\u6ce8\u89e3\u7684\u6ce8\u89e3\nAnnotatedElementUtils.getMergedAnnotation(Element.class, Test2.class);\n\n@Target({ ANNOTATION_TYPE, FIELD, TYPE })\n@Retention(RUNTIME)\n@interface Test2 {\n    String test2() default \"test2\";\n}\n\n@Target({ ANNOTATION_TYPE, FIELD, TYPE })\n@Retention(RUNTIME)\n@Test2\n@interface Test3 {\n    String tset3() default \"test3\";\n}\n\n@Test3\nstatic class Element {}\n</code></pre>"},{"location":"languages/java/annotation.html#processor","title":"Processor","text":"<p><code>javax.annotation.processing.Processor</code></p> <p>\u6ce8\u89e3\u5904\u7406\u5668(Annotation Processor)\u662f javac \u5185\u7f6e\u7684\u4e00\u4e2a\u7528\u4e8e\u7f16\u8bd1\u65f6\u626b\u63cf\u548c\u5904\u7406\u6ce8\u89e3(Annotation)\u7684\u5de5\u5177\uff0c\u5e38\u7528\u7684\u7528\u6cd5\u5c31\u662f\u5728\u7f16\u8bd1\u671f\u95f4\u83b7\u53d6\u76f8\u5173\u6ce8\u89e3\u6570\u636e\uff0c\u7136\u540e\u52a8\u6001\u751f\u6210<code>.java</code>\u6e90\u6587\u4ef6\uff0c\u6bd4\u5982lombok\u3002</p> <p>\u5728\u7f16\u8bd1\u7684\u65f6\u5019\uff0cjavac\u4f1a\u53bb\u627e\u6240\u6709jar\u5305\u53ca\u9879\u76ee\uff08\u6a21\u5757\uff09\u91cc<code>resource/META-INF/services/javax.annotation.processing.Processor</code>\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u914d\u7f6e\u7684\u7c7b\u4fe1\u606f\uff0c\u8bb0\u4f4f\u662f\u7c7b\u4fe1\u606f\uff0c\u5b83\u4f1a\u901a\u8fc7classloader\u53bb\u52a0\u8f7d\u8fd9\u4e2a\u7c7b\uff0c\u6b64\u65f6\u9879\u76ee\uff08\u6a21\u5757\uff09\u4e2d\u7684\u6587\u4ef6\u56e0\u4e3a\u662f\u5728\u7f16\u8bd1\u671f\uff0c\u5c1a\u672a\u751f\u6210class\u6587\u4ef6\uff0c\u4e5f\u5c31\u627e\u4e0d\u5230\u5bf9\u5e94\u7684\u7c7b\uff0c\u89e3\u51b3\u65b9\u6cd5\uff1a</p> <ul> <li>\u901a\u8fc7<code>maven-resource</code>\u63d2\u4ef6\uff0c\u7f16\u8bd1\u5b8c\u4e4b\u540e\u518d\u8fdb\u884c copy-resource\uff1b</li> </ul> <p>\u7b80\u5355\u6848\u4f8b\u89c1\u4ee3\u7801\u5e93</p> <ul> <li>GetterSetterProcessor</li> <li>demo</li> </ul>"},{"location":"languages/java/annotation.html#_5","title":"\u7f16\u8bd1\u671f\u95f4\u4fee\u6539\u8bed\u6cd5\u6811","text":"<p>\u793a\u4f8b\uff1a\u5b9e\u73b0 GettetSetter \u6ce8\u89e3\uff08\u4f9d\u8d56 tools.jar\uff09\uff1b</p> <ul> <li>\u76f4\u63a5\u4fee\u6539\u8bed\u6cd5\u6811\uff0c\u4e5f\u53ef\u4ee5\u5148\u751f\u6210\u6e90\u6587\u4ef6\uff0c\u518d\u8fdb\u884c\u7f16\u8bd1\uff1b</li> </ul> <pre><code>// \u6839\u636e\u5b57\u7b26\u4e32\u83b7\u53d6Name\nprivate Name getNameFromString(String s) { return names.fromString(s); }\n\n// \u521b\u5efa \u57df/\u65b9\u6cd5 \u7684\u591a\u7ea7\u8bbf\u95ee, \u65b9\u6cd5\u7684\u6807\u8bc6\u53ea\u80fd\u662f\u6700\u540e\u4e00\u4e2a \u4f8b\u5982\uff1a java.lang.System.out.println\nprivate JCTree.JCExpression memberAccess(String components) {\n    String[] componentArray = components.split(\"\\\\.\");\n    JCTree.JCExpression expr = treeMaker.Ident(getNameFromString(componentArray[0]));\n    for (int i = 1; i &lt; componentArray.length; i++) {\n        expr = treeMaker.Select(expr, getNameFromString(componentArray[i]));\n    }\n    return expr;\n}\n\n// \u521b\u5efa\u53d8\u91cf\u8bed\u53e5\nprivate JCTree.JCVariableDecl makeVarDef(JCTree.JCModifiers modifiers, String name, JCTree.JCExpression vartype, JCTree.JCExpression init) {\n    return treeMaker.VarDef(\n        modifiers,\n        getNameFromString(name), //\u540d\u5b57\n        vartype, //\u7c7b\u578b\n        init //\u521d\u59cb\u5316\u8bed\u53e5\n    );\n}\n// \u7ed9\u53d8\u91cf\u8d4b\u503c\nprivate JCTree.JCExpressionStatement makeAssignment(JCTree.JCExpression lhs, JCTree.JCExpression rhs) {\nreturn treeMaker.Exec(\n    treeMaker.Assign(lhs, rhs)\n    );\n}\n\n// \u58f0\u660e\u53d8\u91cf\u5e76\u8d4b\u503c\uff08\u5229\u7528\u4ee5\u4e0a\u5305\u88c5\u7684\u65b9\u6cd5\uff09  \u751f\u6210\u8bed\u53e5\u4e3a\uff1aString xiao = \"methodName\";\nJCTree.JCVariableDecl var = makeVarDef(treeMaker.Modifiers(0), \"xiao\", memberAccess(\"java.lang.String\"), treeMaker.Literal(\"methodName\"));\n\n// \u751f\u6210\u8bed\u53e5\u4e3a\uff1axiao = \"-Binary operator one\" + \"-Binary operator two\";\ntreeMaker.Exec(\n    treeMaker.Assign(treeMaker.Ident(getNameFromString(\"xiao\")),\n        treeMaker.Binary(\n            JCTree.Tag.PLUS,\n            treeMaker.Literal(\"-Binary operator one\"),\n            treeMaker.Literal(\"-Binary operator two\")\n        ))\n);\n\n// \u58f0\u660e\u6574\u578b\u53d8\u91cf\u5e76\u8d4b\u503c \u751f\u6210\u8bed\u53e5\u4e3a\uff1aInteger zhen = 1;\nmakeVarDef(treeMaker.Modifiers(0), \"zhen\", memberAccess(\"java.lang.Integer\"), treeMaker.Literal(1));\n\n// \u751f\u6210\u8bed\u53e5\uff1aSystem.out.println(xiao)\nJCTree.JCExpressionStatement printVar = treeMaker.Exec(treeMaker.Apply(\n    List.of(memberAccess(\"java.lang.String\")),//\u53c2\u6570\u7c7b\u578b\n    memberAccess(\"java.lang.System.out.println\"),\n    List.of(treeMaker.Ident(getNameFromString(\"xiao\")))\n    )\n);\n</code></pre>"},{"location":"languages/java/basic.html","title":"\u57fa\u7840\u77e5\u8bc6","text":"<ul> <li> <p>\u5bf9\u8c61\u7684\u9ed8\u8ba4\u521d\u59cb\u503c\u90fd\u662fnull\uff0c\u5305\u62ecString\uff0cnew String[]\uff1b</p> </li> <li> <p>Iterator\u7684\u5220\u9664\u5143\u7d20\u65b9\u6cd5\u662fremove\uff0c\u4e0d\u4f1a\u4ea7\u751fconcurrentModify\u5f02\u5e38\uff1b</p> </li> <li> <p>HashMap\u7684key\uff0cvalue\u53ef\u4ee5\u4e3anull\uff0c\u4f46\u662fHashTable\u548cConcurrentHashMap\u90fd\u4e0d\u53ef\u4ee5\uff1b</p> </li> <li> <p>instanceof\uff0c\u591a\u7ef4\u6570\u7ec4\u662fObject[]\u7684\u7c7b\u578b\uff0c\u4f46\u4e0d\u662fint[]\u7684\u7c7b\u578b\uff0cint[]\u662fObject\u7c7b\u578b\uff0c\u4f46\u4e0d\u662fObject[]\u7c7b\u578b\uff0c\u57fa\u672c\u7c7b\u578b\u4e5f\u4e0d\u662fObject\u7c7b\u578b\uff1b</p> </li> <li> <p>System.getProperty(\"java.library.path\") \u53c2\u6570\u53ef\u4ee5\u901a\u8fc7-D\u914d\u7f6e\uff0cSystem.getEnv\u4e2d\u83b7\u53d6\u5f53\u524d\u73af\u5883\u7684\u73af\u5883\u53d8\u91cf\uff1b</p> </li> <li> <p>user.dir\uff1a\u5f53\u524d\u7528\u6237\u5de5\u4f5c\u76ee\u5f55\uff0c\u5373\u5f53\u524d\u6267\u884cjava\u547d\u4ee4\u7684\u8def\u5f84</p> </li> <li> <p>hashcode \u548c equals\u65b9\u6cd5\uff1a</p> </li> </ul> <p>1\uff09\u5982\u679co1.equals(o2)\uff0c\u90a3\u4e48o1.hashCode() == o2.hashCode()\u603b\u662f\u4e3atrue\u7684\u3002</p> <p>2\uff09\u5982\u679co1.hashCode() == o2.hashCode()\uff0c\u5e76\u4e0d\u610f\u5473\u7740o1.equals(o2)\u4f1a\u4e3atrue\u3002</p> <ul> <li> <p>Java \u5bf9 Interger\u7684-128~127\u7684\u5bf9\u8c61\u8fdb\u884c\u7f13\u5b58\uff0c\u8fd4\u56denew Integer(321)\u662f\u4e24\u4e2a\u4e0d\u540c\u7684\u5bf9\u8c61\uff1b</p> </li> <li> <p>Thread.currentThread.getStackTrace()\u53ef\u4ee5\u83b7\u5f97\u5f53\u524d\u8c03\u7528\u6808\u7684\u6570\u7ec4StackTraceElement[]\uff0c\u53ef\u4ee5\u83b7\u53d6\u65b9\u6cd5\u540d\uff0c\u6587\u4ef6\u540d\uff0c\u884c\u6570\u7b49\u4fe1\u606f\uff1b</p> </li> <li> <p>StringBuffer\u88ab\u9690\u5f0f\u4f7f\u7528\uff0c\u5f53String\u4f7f\u7528+\u64cd\u4f5c\u65f6\uff0c\u663e\u793a\u4f7f\u7528StringBuilder\u6216StringBuffer\u53ef\u4ee5\u63d0\u5347\u6027\u80fd\uff1bStringBuffer\u7ebf\u7a0b\u5b89\u5168\uff1b</p> </li> <li> <p>Java\u7684final\u5b57\u6bb5\u4e0d\u4f1a\u81ea\u52a8\u7c7b\u578b\u63d0\u5347\uff1bprivate\u548cstatic\u65b9\u6cd5\u65e0\u6cd5\u88ab\u91cd\u8f7d\uff1b</p> </li> <li> <p>Thread\u72b6\u6001getState, isAlive\uff0c\u6807\u8bb0\u4e3aDEAD\u72b6\u6001\u7684\u7ebf\u7a0b\u53ef\u80fd\u590d\u6d3b\uff0c\u4e0d\u4f1a\u88ab\u5783\u573e\u56de\u6536\uff1b</p> </li> <li> <p>\u53cc\u5927\u62ec\u53f7\u53ef\u4ee5\u7528\u6765\u5b9e\u73b0\u5b9e\u4f8b\u7684\u521b\u5efa\uff08\u751f\u6210\u533f\u540d\u7c7b\uff0c\u7136\u540e\u5c06\u7b2c\u4e8c\u4e2a\u62ec\u53f7\u91cc\u5185\u5bb9\u9644\u5728\u533f\u540d\u7c7b\u91cc\uff09\uff0c\u5355\u4e2a\u5927\u62ec\u53f7\u5b9e\u73b0\u533f\u540d\u7c7b\uff1b</p> </li> </ul> <pre><code>// \u614e\u7528\uff0c\u533f\u540d\u7c7b\u4f1a\u5305\u542b\u4e00\u4e2a\u5916\u56f4\u5b9e\u4f8b\uff0c\u9020\u6210\u5185\u5b58\u6cc4\u6f0f\u7684\u95ee\u9898\nSet&lt;Integer&gt; set = new HashSet&lt;Integer&gt;() {{\n    add(1);\n    add(2);\n}};\n</code></pre> <ul> <li> <p>final\u4fee\u9970\u7b26\u7684\u4f5c\u7528</p> </li> <li> <p>\u7c7b\uff1a\u65e0\u6cd5\u88ab\u7ee7\u627f</p> </li> <li>\u65b9\u6cd5\uff1a\u65e0\u6cd5\u88ab\u5b50\u7c7b\u8986\u76d6</li> <li> <p>\u53d8\u91cf\uff1a\u65e0\u6cd5\u88ab\u91cd\u65b0\u8d4b\u503c</p> </li> <li> <p>\u83b7\u53d6\u5230\u7c7b\u8def\u5f84\uff08classpath\uff09\u4e0b\u7684\u8d44\u6e90\u8def\u5f84\u4fe1\u606f</p> </li> <li> <p>ClassLoader.getResource(String classpathFilePath)\uff0c\u7c7b\u4f3c\u201c\u53cc\u4eb2\u59d4\u6d3e\u673a\u5236\u201d\uff0c\u4ee5 / \u5f00\u5934\u7684\u8d44\u6e90\u662f\u5728ClassLoader\u76ee\u5f55\u4e0b\u7684\u8d44\u6e90\uff0c\u5e76\u975e\u6307\u7684\u662f\u5f53\u524d\u5e94\u7528\u7684\u7c7b\u52a0\u8f7d\u8def\u5f84\u4e0b\u7684\u8d44\u6e90\u3002\u5982\u679c\u8d44\u6e90\u662f\u4f4d\u4e8eclasspath\u4e0b\u7684\u4e0d\u8981\u4ee5 / \u5f00\u5934\uff1b</p> </li> <li> <p>Class&lt;?&gt;.getResource(String  classpathFilePath)\uff0c\u5f53\u8def\u5f84\u4fe1\u606f\u4e0d\u4ee5 / \u5f00\u5934\u65f6\uff0c\u83b7\u53d6\u7684\u662f\u76f8\u5bf9\u4e8e\u5f53\u524d\u7c7b\u6240\u5728\u8def\u5f84\u7684\u76f8\u5bf9\u8d44\u6e90\uff1b\u5f53\u8def\u5f84\u4fe1\u606f\u4ee5 / \u5f00\u5934\u65f6\uff0c\u5219\u83b7\u53d6\u7684\u662f\u5f53\u524d\u5e94\u7528\u7c7b\u52a0\u8f7d\u8def\u5f84\u4e0b\u7684\u8d44\u6e90</p> </li> <li> <p>jar\u4e2d\u7684\u6587\u4ef6\u7684\u83b7\u53d6\u65b9\u5f0f\uff1a</p> </li> <li> <p>\u901a\u8fc7\u7c7b\u88c5\u8f7d\u5668\u6765\u6765\u83b7\u5b9a\u4f4d\u8d44\u6e90</p> <p><code>Icon myIcon = new ImageIcon(getClass().getResource(\"/com/directory.gif\"))</code></p> </li> <li> <p>Path\u7528\u6765\u83b7\u53d6\u8def\u5f84\uff1a</p> </li> <li> <p>Path.toAbsolutePath()\u83b7\u53d6\u7edd\u5bf9\u8def\u5f84\uff1b</p> </li> <li> <p>File.getCanonicalPath()\u83b7\u53d6\u89c4\u8303\u7edd\u5bf9\u8def\u5f84\uff0c\u5c06\u7edd\u5bf9\u8def\u5f84\u4e2d\u7684\"..\"\u548c\".\"\u8f6c\u6362\u6d88\u9664\u540e\u7684\u5f97\u5230\u7684\u8def\u5f84</p> </li> <li> <p>Path.toRealPath()\u83b7\u53d6\u5b9e\u9645\u8def\u5f84\uff0c\u76f8\u5bf9\u5730\u5740\u8f6c\u7edd\u5bf9\u5730\u5740\uff0c.. \u548c . \u8f6c\u4e3a\u89c4\u8303\u8def\u5f84\uff0c\u7b26\u53f7\u94fe\u63a5\u8f6c\u4e3a\u5b9e\u9645\u8def\u5f84\uff1b</p> </li> <li> <p>Runtime Exception \u65e0\u9700\u88ab try-catch \u6216\u65b9\u6cd5\u52a0\u58f0\u660e\uff1b</p> </li> </ul>"},{"location":"languages/java/basic.html#_2","title":"\u51fd\u6570","text":"<ul> <li>Java\u91cd\u8f7d\u7684\u65b9\u6cd5\uff08\u540c\u540d\u4f46\u7b7e\u540d\u4e0d\u4e00\u6837\u7684\u51fd\u6570\uff09\u7684\u5339\u914d\u662f\u6309\u7167\u58f0\u660e\u7c7b\u578b\u5339\u914d\u5f62\u53c2\u7c7b\u578b\uff0c\u800c\u4e0d\u662f\u9760\u5b9e\u9645\u7c7b\u578b\uff1b</li> </ul> <p>lombok.NonNull\u3001javax.annotation.Nonnull \u548c javax.validation.constraints.NotNull\u7684\u533a\u522b\u548c\u4f7f\u7528\u573a\u666f\uff1a</p> <ul> <li> <ul> <li>@NonNull\u7528\u5728\u5f3a\u5236\u5165\u53c2\u975e\u7a7a\u3001\u5c5e\u6027\u975e\u7a7a\u7684\u573a\u666f\u4e0b\uff0c\u7f16\u8bd1\u65f6\u4f1a\u751f\u6210\u7a7a\u6307\u9488\u68c0\u67e5\u7684\u4ee3\u7801\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\uff0c\u5219\u4f1a\u629b\u51faNullPointerException\u3002</li> </ul> </li> <li>@Nonnull\u7528\u5728\u8fd4\u56de\u7ed3\u679c\u4e0d\u4e3a\u7a7a\u7684\u573a\u666f\uff0c\u4e3b\u8981\u7531IDE\u8bc6\u522b\u5e76\u7ed9\u51fa\u544a\u8b66\u63d0\u793a\u3002</li> <li>@NotNull\u4e3b\u8981\u7528\u5728Validator\u6821\u9a8c\u573a\u666f\u4e0b\uff0c\u9650\u5236\u53c2\u6570\u975e\u7a7a\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\uff0c\u5219\u6821\u9a8c\u5931\u8d25\u3002</li> </ul>"},{"location":"languages/java/basic.html#_3","title":"\u5f02\u5e38\u4e0e\u65e5\u5fd7","text":"<p>Error \u662f\u4e0d\u53ef\u63a7\u7684\u9519\u8bef\uff0c\u7a0b\u5e8f\u65e0\u6cd5\u5904\u7406\uff0c\u5fc5\u987b\u4eba\u5de5\u4ecb\u5165\uff1b</p> <p>Exception \u5206\u4e3a\uff1a</p> <ul> <li>\u53d7\u68c0\u5f02\u5e38\uff1a\u9700\u8981\u663e\u5f0f\u5904\u7406\uff08try catch \u6216\u8005 throws\uff09\uff1b</li> <li>\u975e\u53d7\u68c0\u5f02\u5e38\uff08<code>RuntimeException</code>\u5b50\u7c7b\uff09</li> </ul> <p>finally \u53ea\u7528\u6765\u6e05\u7406\u8d44\u6e90\u3001\u91ca\u653e\u8fde\u63a5\u3001\u5173\u95ed\u6d41\u7b49\u64cd\u4f5c\uff1a</p> <ul> <li>\u4e0d\u8981\u5728 finally \u4ee3\u7801\u5757\u4e2d\u8d4b\u503c\uff0ccatch \u4e2d\u7684 return \u4f1a\u5148\u6682\u5b58\uff0c\u518d\u6267\u884c finally \u4e2d\u7684\u4ee3\u7801\uff1b</li> <li>\u4e0d\u8981\u5728 finally \u4e2d\u4f7f\u7528 return \u8bed\u53e5\uff0c\u4f1a\u4f7f\u8fd4\u56de\u503c\u7684\u5224\u65ad\u53d8\u5f97\u590d\u6742\uff1b</li> </ul>"},{"location":"languages/java/basic.html#try-lock","title":"try \u8ddf lock","text":"<ul> <li>try \u4ee3\u7801\u5757\u524d\u8c03\u7528 lock() \u65b9\u6cd5\uff0c\u907f\u514d\u7531\u4e8e\u52a0\u9501\u5931\u8d25\u5bfc\u81f4 finally \u8c03\u7528 unlock \u629b\u51fa\u5f02\u5e38\uff1b</li> <li>\u5bf9\u672a\u52a0\u9501\u7684\u5bf9\u8c61\u89e3\u9501\u4f1a\u629b\u51fa unchecked \u5f02\u5e38\uff0c\u5bfc\u81f4\u52a0\u9501\u5931\u8d25\u7684\u539f\u56e0\u88ab\u8986\u76d6\uff1b</li> </ul> <pre><code>Lock lock = new XXXLock();\nlock.lock();\ntry {\n    // do something\n} finally {\n    lock.unlock();\n}\n</code></pre>"},{"location":"languages/java/basic.html#_4","title":"\u5f02\u5e38\u548c\u9519\u8bef\u7801","text":"<p>\u63a8\u8350\u89c4\u8303</p> <ul> <li>\u5bf9\u5916\u63d0\u4f9b\u7684\u5f00\u653e\u63a5\u53e3\u4f7f\u7528\u9519\u8bef\u7801\uff1b</li> <li>\u5185\u90e8\u5f00\u653e\u7684\u63a5\u53e3\u8003\u8651\u4f7f\u7528 Result \u5bf9\u8c61\u5c01\u88c5\u9519\u8bef\u7801\u548c\u9519\u8bef\u63cf\u8ff0\u4fe1\u606f\uff1b</li> <li>\u82e5\u8c03\u7528\u65b9\u672a\u6355\u83b7\uff0c\u5219\u4f1a\u4ea7\u751f\u8fd0\u884c\u65f6\u9519\u8bef\uff0c\u5bfc\u81f4\u7a0b\u5e8f\u4e2d\u65ad\uff1b</li> <li>\u5e94\u7528\u5185\u90e8\u76f4\u63a5\u629b\u51fa\u5f02\u5e38\u5bf9\u8c61\uff1b</li> </ul>"},{"location":"languages/java/basic.html#null","title":"\u8fd4\u56de NULL","text":"<p>\u5951\u7ea6\u5f0f\u53d8\u6210\u7406\u5ff5\u5904\u4e8e\u9632\u5fa1\u5f0f\u7f16\u7a0b\u7406\u5ff5\u7684\u4e0b\u98ce\u3002</p> <p>\u9632\u6b62 NPE \u4e00\u5b9a\u662f\u8c03\u7528\u65b9\u7684\u8d23\u4efb\uff08\u63a5\u6536\u65b9\u670d\u52a1\u53ef\u80fd\u4f1a\u5f02\u5e38\uff09\u3002</p>"},{"location":"languages/java/basic.html#_5","title":"\u7c7b\u548c\u63a5\u53e3","text":""},{"location":"languages/java/basic.html#_6","title":"\u57fa\u672c\u77e5\u8bc6","text":"<ul> <li>\u5b50\u7c7b\u9ed8\u8ba4\u8c03\u7528\u7684\u662f\u7236\u7c7b\u7684\u65e0\u53c2\u6784\u9020\u51fd\u6570\uff0c\u53ea\u6709\u7c7b\u6ca1\u6709\u6784\u9020\u51fd\u6570\u65f6\u624d\u4f1a\u9ed8\u8ba4\u6784\u9020\uff1b</li> <li>\u8986\u76d6\u7236\u7c7b\u7684\u65b9\u6cd5\u65f6\uff0c\u8bbf\u95ee\u6743\u9650\u4e0d\u80fd\u53d8\u5c0f\uff08public &gt; package &gt; protected &gt; private)\uff1b</li> <li>\u63a5\u53e3\u9ed8\u8ba4\u5c31\u662fabstract public\uff0c\u5176\u6210\u5458\u51fd\u6570\u9ed8\u8ba4\u662fabstract public\uff0c\u5176\u6210\u5458\u53d8\u91cf\u9ed8\u8ba4\u662fstatic final\uff1b</li> <li>Java\u4e2d\u9759\u6001\u7ed1\u5b9a\u7684\u60c5\u51b5\uff1a\u8c03\u7528\u7c7b\u65b9\u6cd5\uff1b\u521d\u59cb\u5316\u65b9\u6cd5\uff1b\u79c1\u6709\u65b9\u6cd5\uff1b\u5176\u4ed6\u90fd\u662f\u52a8\u6001\u7ed1\u5b9a\uff1b</li> <li>this()\u548csuper()\u90fd\u5fc5\u987b\u5728\u6784\u9020\u51fd\u6570\u7684\u7b2c\u4e00\u884c\uff0c\u4e0d\u4f1a\u540c\u65f6\u51fa\u73b0\uff08\u5148\u521d\u59cb\u5316\u518d\u4f7f\u7528\u6210\u5458\uff09\uff1b</li> <li>\u5185\u90e8\u7c7b\u7684\u5b9e\u4f8b\u521b\u5efa\uff1a<code>Outer.Inner in = new Outer().new Inner()</code>\uff1b\u9759\u6001\u5185\u90e8\u7c7b\u7684\u521b\u5efa\uff1a<code>Outer.Inner in = new Outer.Inner()</code>\uff1b</li> <li>\u5185\u90e8\u7c7b\u6301\u6709\u5916\u90e8\u7c7b\uff0c\u4f46\u5916\u90e8\u7c7b\u5173\u95ed\u65f6\uff0c\u5185\u90e8\u7c7b\u4f9d\u7136\u88ab\u6301\u6709\u4f1a\u9020\u6210\u6cc4\u6f0f\uff1b</li> </ul>"},{"location":"languages/java/basic.html#jdk8","title":"\u51fd\u6570\u5f0f\u63a5\u53e3\uff08JDK8\uff09","text":"<ul> <li>\u4e00\u4e2a\u51fd\u6570\u5f0f\u63a5\u53e3\u53ea\u6709\u4e00\u4e2a\u62bd\u8c61\u65b9\u6cd5(SAM\uff0csingle abstract method)\uff1b</li> <li>Object \u7c7b\u4e2d\u7684 public abstract method \u4e0d\u4f1a\u88ab\u89c6\u4e3a\u5355\u4e00\u7684\u62bd\u8c61\u65b9\u6cd5\uff1b</li> <li>\u51fd\u6570\u5f0f\u63a5\u53e3\u53ef\u4ee5\u6709\u9ed8\u8ba4\u65b9\u6cd5\u548c\u9759\u6001\u65b9\u6cd5\uff1b</li> <li>\u51fd\u6570\u5f0f\u63a5\u53e3\u53ef\u4ee5\u7528@FunctionalInterface \u6ce8\u89e3\u8fdb\u884c\u4fee\u9970\u3002</li> </ul>"},{"location":"languages/java/basic.html#string","title":"String","text":"<ul> <li> <p>Java\u4e2d\u5b57\u7b26\u4e32\u91c7\u7528Unicode\u7f16\u7801\uff0c\u4e00\u4e2achar\u5360\u4e24\u4e2a\u5b57\u8282\uff1b</p> </li> <li> <p>JDK8\u540e\uff0cString \u5185\u90e8\u91c7\u7528 <code>byte[]</code> \u800c\u4e0d\u662f <code>char[]</code></p> </li> <li> <p><code>\\u</code>\u662funicode\u7f16\u7801\uff1b</p> </li> <li> <p>Java String \u91c7\u7528 UTF-16\u7f16\u7801\uff1b</p> </li> <li>String\u7684 length \u65b9\u6cd5\u8fd4\u56de\u7684\u662fUnicode\u7684 code units \u7684\u6570\u91cf\uff1b</li> </ul> <pre><code>// name.getBytes().length == 15 != (5 == name.length())\nString name = \"\u6211\u662f\u4e2d\u56fd\u4eba\";\nSystem.out.println(name.getBytes().length + \":\" + name.length());\n</code></pre> <ul> <li>String\u4e2d\u7684charAt\u548ccodePointAt\u65b9\u6cd5\uff1b</li> <li>\u975e\u57fa\u672c\u5e73\u9762\u7684String\u904d\u5386\u65b9\u5f0f</li> </ul> <pre><code>// JDK 8, CharSequence#codePoints\u4e86\u8fd4\u56deIntStream\n\"str\".codePoints().forEach(c -&gt; ...);\n</code></pre> <p>String \u7684 getBytes\u65b9\u6cd5\uff0c\u662f\u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u7279\u5b9a\u7f16\u7801\u89c4\u5219\u540e\u7684\u5b57\u8282\u6570\u7ec4</p> <ul> <li> <p>\u9ed8\u8ba4\u7684\u662fCharset.defaultCharset()\uff1b</p> </li> <li> <p>String\u7684\u5e26Charset\u7684\u6784\u9020\u65b9\u6cd5\uff0cCharset\u6307\u7684\u662fbyte[]\u7684\u7f16\u7801\u65b9\u5f0f\uff1b</p> </li> <li> <p>InputStreamReader\u8bfb\u53d6\u4e8c\u8fdb\u5236\u6587\u672c\u6570\u636e\u6d41\u65f6\uff0c\u53ef\u4ee5\u6307\u5b9aCharset\uff1b</p> </li> <li> <p>String \u201dmain\"\u7684\u5185\u5b58\u5360\u7528\u56fe\u793a\uff1a</p> </li> </ul> <p></p>"},{"location":"languages/java/basic.html#files","title":"Files","text":"<p>\u66f4\u591a\u573a\u666f\uff0c\u63a8\u8350\u4f7f\u7528 apache common io.</p> <p><code>java.nio.Files</code> \u7c7b\uff0c\u63d0\u4f9b\u7684\u6587\u4ef6\u7684\u5e38\u89c1\u64cd\u4f5c\uff0c\u5982 \u521b\u5efa\u3001\u904d\u5386\u3001\u5b58\u5728\u3001\u5220\u9664\u3001\u62f7\u8d1d\u7b49\u9759\u6001\u65b9\u6cd5\uff1b</p> <ul> <li>Files.list \u65b9\u6cd5\u53ea\u904d\u5386\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u548c\u76ee\u5f55\uff0c<code>Files.walk</code> \u65b9\u6cd5\u904d\u5386\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u548c\u76ee\u5f55\uff0c\u9664\u975e\u6307\u5b9a\u4e86\u6700\u5927\u6df1\u5ea6</li> </ul>"},{"location":"languages/java/basic.html#_7","title":"\u6cdb\u578b","text":"<p><code>&lt;?&gt;</code>\u79f0\u4e3a\u901a\u914d\u7b26\u96c6\u5408\uff0c\u53ef\u4ee5\u63a5\u53d7\u4efb\u4f55\u7c7b\u578b\u7684\u96c6\u5408\u5f15\u7528\u8d4b\u503c\uff0c\u4e0d\u80fd\u8c03\u7528\u53c2\u6570\u662f\u6cdb\u578b\u7684\u76f8\u5173\u51fd\u6570\uff1b</p> <pre><code>List&lt;?&gt; stus = new ArrayList&lt;&gt;();\n// \u7f16\u8bd1\u9519\uff0c\u56e0\u4e3a add \u65b9\u6cd5\u7684\u53c2\u6570\u662f\u6cdb\u578b\uff0c\u4f46\u662f ? \u4e0d\u4ee3\u8868\u4efb\u4f55\u7684\u6570\u636e\u7c7b\u578b\nstus.add(1);\n</code></pre> <p><code>&lt;? extend T&gt;</code>\uff1a\u8d4b\u503c\u7ed9\u4efb\u4f55 T \u53ca T\u5b50\u7c7b\u7684\u96c6\u5408\uff0cGet First\uff0c\u7528\u4e8e\u6d88\u8d39\u96c6\u5408\u5143\u7d20\uff0c</p> <ul> <li>\u4e0d\u80fd\u8c03\u7528\u53c2\u6570\u662f\u6cdb\u578b\u7684\u76f8\u5173\u51fd\u6570\uff0c\u9664 null \u4e4b\u5916\uff1b</li> <li>get \u8fd4\u56de\u7684\u7c7b\u578b\u662f T \u53ca T\u7684\u7236\u7c7b\uff1b</li> </ul> <p><code>&lt;? super T&gt;</code>\uff1a\u8d4b\u503c\u7ed9\u4efb\u4f55 T \u53ca T\u7684\u7236\u7c7b\u7684\u96c6\u5408\uff0cPut First\uff0c\u7528\u4e8e\u751f\u4ea7\u96c6\u5408\u5143\u7d20\uff1b</p> <ul> <li>\u6240\u6709\u7684\u5143\u7d20\u7c7b\u578b\u90fd\u662f T \u7684\u7236\u7c7b\uff0cput \u5143\u7d20\u7c7b\u578b\u4e3a T\u53ca\u5176\u5b50\u7c7b</li> <li>\u8c03\u7528\u8fd4\u56de\u7c7b\u578b\u662f\u6cdb\u578b\u7684\u51fd\u6570\uff0c\u5176\u8fd4\u56de\u7ed3\u679c\u662f Object\uff1b</li> </ul> <pre><code>List&lt;? extends Father &gt; extendFather = new ArrayList&lt;&gt;();\nList&lt;? super Father &gt; superFather = new ArrayList&lt;&gt;();\n\nFather cat = extendFather.get(1);\nObject object = superFather.get(0);\nsuperFather.add(new Son());\n</code></pre>"},{"location":"languages/java/basic.html#iterator","title":"Iterator","text":"<ul> <li> <p>Java\u4e2d\u975e\u7ebf\u7a0b\u5b89\u5168\u7684\u96c6\u5408\u5982ArrayList\u7b49\uff0c\u5176Iterator\u662ffail-fast\u673a\u5236\uff0citerator\u904d\u5386\u7684\u65f6\u5019\uff0c\u4e0d\u53ef\u4ee5\u8fdb\u884c\u6dfb\u52a0\u6216\u5220\u9664\u64cd\u4f5c\uff1b</p> </li> <li> <p>\u904d\u5386\u65f6\u5220\u9664\uff0c\u4f7f\u7528 iterator \u7684 remove\u65b9\u6cd5</p> </li> </ul> <pre><code>// \u5355\u7ebf\u7a0b\u904d\u5386\u65f6\u5220\u9664\uff0c\u9700\u8981\u901a\u8fc7 Iterator\u7684remove\u65b9\u6cd5\u64cd\u4f5c\nIterator&lt;String&gt; iter = list.iterator();\nwhile (iter.hasNext()) {\n    String item = iter.next();\n    if (shouldRemove(item)) {\n        iter.remove();\n    }\n}\n</code></pre> <ul> <li>\u5bf9\u4e8e\u7ebf\u7a0b\u5b89\u5168\u7684\u5982ConcurrentHashMap\u800c\u8a00\uff0cIterator\u5728\u904d\u5386\u5e95\u5c42\u6570\u7ec4\u3002\u5728\u904d\u5386\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u5df2\u7ecf\u904d\u5386\u7684\u6570\u7ec4\u4e0a\u7684\u5185\u5bb9\u53d8\u5316\u4e86\uff0c\u8fed\u4ee3\u5668\u4e0d\u4f1a\u629b\u51faConcurrentModificationException\u5f02\u5e38\u3002\u5982\u679c\u672a\u904d\u5386\u7684\u6570\u7ec4\u4e0a\u7684\u5185\u5bb9\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u5219\u6709\u53ef\u80fd\u53cd\u6620\u5230\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u3002\u8fd9\u5c31\u662fConcurrentHashMap\u8fed\u4ee3\u5668\u5f31\u4e00\u81f4\u7684\u8868\u73b0\u3002</li> </ul>"},{"location":"languages/java/basic.html#java-time","title":"Java Time","text":"<pre><code>long t1 = System.currentTimeMillis();\nlong t2 = new Date().getTime();\nlong t3 = Calendar.getInstance().getTimeInMillis();\n</code></pre> <p>\u5c06\u63d0\u4f9b\u81eaunix\u7eaa\u5143\u4ee5\u6765\u7684\u6beb\u79d2\u6570\uff0c\u8fd9\u662f\u4e00\u4e2a\u56fa\u5b9a\u7684\u65f6\u95f4\u70b9\uff0c\u4e0d\u53d7\u672c\u5730\u65f6\u533a\u5f71\u54cd\uff1b</p> <p>GMT\uff08Greenwich Mean Time\uff0c\u683c\u6797\u5a01\u6cbb\u65f6\u95f4)\u662f\u65f6\u533a\u65f6\u95f4\u3002</p> <p>UTC\uff08Coordinated Universal Time\u534f\u8c03\u4e16\u754c\u65f6\uff09\u662f\u4e2a\u6807\u51c6\u65f6\u95f4\uff1bUTC\u4f5c\u4e3a\u4e00\u4e2a\u6807\u51c6\u65f6\u95f4\u548c\u5404\u4e2a\u65f6\u533a\u65f6\u95f4\u6362\u7b97</p> <p>LocalDateTime \u662f\u6ca1\u6709\u65f6\u533a\u6982\u5ff5\u7684\u65f6\u95f4\uff0cZonedDateTime\u662f\u6709\u65f6\u533a\u6982\u5ff5\u7684\u65f6\u95f4\u3002</p> <p>LocalDateTime.now(ZoneId.of(\"UTC\")) \u662f\u6839\u636eUTC\u6784\u5efa\u65f6\u95f4\uff0c\u9ed8\u8ba4\u662f\u6839\u636e\u7cfb\u7edf\u7684\u65f6\u533a\u521b\u5efa\u65f6\u95f4\uff1b</p>"},{"location":"languages/java/basic.html#stream","title":"Stream","text":"<p>JDK 8 \u5f15\u5165\uff0c\u5bf9\u4e8e\u96c6\u5408\u6570\u636e\u53ef\u4ee5\u6d41\u5f0f\u5904\u7406\u3002</p>"},{"location":"languages/java/basic.html#_8","title":"\u521b\u5efa","text":"<p>Stream.of \u53ef\u4ee5\u521b\u5efaStream\uff0c\u96c6\u5408\u7c7b\u901a\u8fc7\u901a\u8fc7stream\u65b9\u6cd5\u6216\u8005parallelStream\u521b\u5efa\u6d41\u3002</p>"},{"location":"languages/java/basic.html#_9","title":"\u4e2d\u95f4\u64cd\u4f5c","text":"<p>peek, skip, sorted, map, flatMap, filter, distinct</p>"},{"location":"languages/java/basic.html#_10","title":"\u672b\u7aef\u64cd\u4f5c","text":"<p>collect, count, reduce</p> <p>max, min</p> <p>forEach, forEachOrdered</p> <p>findFirst, findAny</p> <p>anyMatch, allMatch, noneMatch</p> <p>toArray</p>"},{"location":"languages/java/basic.html#collectors","title":"Collectors","text":"<p>groupingBy\uff1a\u6309Key\u805a\u5408</p> <p>groupingByConcurrent</p> <p>joining</p> <p>partitioningBy</p> <p>maxBy, minBy</p> <p>toList, toMap, toSet, toConcurrentMap, toCollection</p>"},{"location":"languages/java/basic.html#flow","title":"Flow","text":"<p>JDK 9 \u4e2d\u7684\u53cd\u5e94\u6d41\u3002</p> <p>Flow.Publisher \u63a5\u53e3\uff1a\u5b9e\u73b0\u4fe1\u606f\u7684\u53d1\u5e03\u8005\uff1b</p> <p>Flow.Subscriber\u63a5\u53e3\uff1a\u5b9e\u73b0\u4fe1\u606f\u7684\u8ba2\u9605\u8005\uff1b</p> <p>Flow.Subsciption\u63a5\u53e3\uff1a\u53d1\u5e03\u548c\u8ba2\u9605\u7684\u8ba2\u9605\u5173\u7cfb\uff1b</p>"},{"location":"languages/java/basic.html#_11","title":"\u6a21\u5757\u5316","text":"<p>Java 9 \u4e4b\u540e\u5f15\u5165\u6a21\u5757\u5316\u7684\u6982\u5ff5\u3002</p> <ul> <li>\u4f7f\u7528 public \u4fee\u9970\u7684\u7c7b\u53ea\u80fd\u5728\u5f53\u524d\u6a21\u5757\u4f7f\u7528\uff1b</li> </ul>"},{"location":"languages/java/basic.html#_12","title":"\u52a0\u5bc6\u89e3\u5bc6","text":"<p>Java API</p> <ul> <li><code>Cipher.getInstance(transformation)</code>\uff0c\u201c\u7b97\u6cd5/\u6a21\u5f0f/\u586b\u5145\u201d\u6216\u201c\u7b97\u6cd5\u201d\uff0c\u5982 AES/CBC/PKCS5Padding\uff1b</li> <li>PKCS7Padding\uff1aPKCS #7 \u586b\u5145\u5b57\u7b26\u4e32\u7531\u4e00\u4e2a\u5b57\u8282\u5e8f\u5217\u7ec4\u6210\uff0c\u6bcf\u4e2a\u5b57\u8282\u586b\u5145\u8be5\u586b\u5145\u5b57\u8282\u5e8f\u5217\u7684\u957f\u5ea6\uff0c0x01-0x08\uff0c\u6839\u636e\u6700\u540e\u4e00\u4f4d\u77e5\u9053\u586b\u5145\u5b57\u8282\u6570\uff1b</li> <li>PKCS5Padding\u7684blocksize\u4e3a8\u5b57\u8282\uff0cPKCS7Padding\u7684blocksize\u53ef\u4ee5\u4e3a1\u5230255\u5b57\u8282\uff1b</li> </ul>"},{"location":"languages/java/basic.html#_13","title":"\u5bb9\u5668","text":""},{"location":"languages/java/basic.html#cpumemory","title":"CPU/Memory","text":"<p>\u4f7f\u7528 java 8u191+ \u6216\u8005 JDK 10\u4e4b\u540e\u7684\u7248\u672c\uff0c\u9ed8\u8ba4\u5f00\u542f<code>+XX:-UseContainerSupport</code>\uff1b</p> <ul> <li>JVM \u77e5\u9053\u5728Docker\u5bb9\u5668\u4e2d\u8fd0\u884c\uff0c\u4ece\u4e3b\u673a\u8bfb\u53d6cgroup\u9650\u5236\uff08\u5df2\u5206\u914d\u7ed9\u5bb9\u5668\u7684CPU\u6570\u91cf\u548c\u603b\u5185\u5b58\uff09\uff0c\u800c\u4e0d\u662f\u4ece\u5bbf\u4e3b\u673a\u63d0\u53d6\uff1b</li> <li><code>-XX:InitialRAMPercentage</code>\uff1a\u8bbe\u7f6eJVM\u4f7f\u7528\u5bb9\u5668\u5185\u5b58\u7684\u521d\u59cb\u767e\u5206\u6bd4\u3002\u5efa\u8bae\u4e0e -XX:MaxRAMPercentage \u4fdd\u6301\u4e00\u81f4\uff0c\u63a8\u8350\u8bbe\u7f6e\u4e3a70.0\u3002</li> <li><code>-XX:MaxRAMPercentage</code>\uff1a\u5176\u503c\u4ecb\u4e8e0.0\u5230100.0\u4e4b\u95f4\uff0c\u9ed8\u8ba4\u503c\u4e3a25.0\u3002\u8bbe\u7f6eJVM\u4f7f\u7528\u5bb9\u5668\u5185\u5b58\u7684\u6700\u5927\u767e\u5206\u6bd4\u3002\u7531\u4e8e\u5b58\u5728\u7cfb\u7edf\u7ec4\u4ef6\u5f00\u9500\uff0c\u5efa\u8bae\u6700\u5927\u4e0d\u8d85\u8fc775.0\uff0c\u63a8\u8350\u8bbe\u7f6e\u4e3a70.0\u3002</li> </ul>"},{"location":"languages/java/bytecode.html","title":"\u5b57\u8282\u7801","text":""},{"location":"languages/java/bytecode.html#_2","title":"\u6d41\u7a0b","text":""},{"location":"languages/java/bytecode.html#_3","title":"\u7f16\u8bd1\u8fc7\u7a0b","text":"<pre><code>graph LR\n    A(Java \u6e90\u6587\u4ef6)  --&gt; B(\u8bcd\u6cd5\u89e3\u6790) --token\u6d41--&gt; C(\u8bed\u6cd5\u89e3\u6790) --&gt; D(\u8bed\u4e49\u5206\u6790) --&gt; E(\u751f\u6210\u5b57\u8282\u7801) --&gt; F(\u5b57\u8282\u7801)\n</code></pre>"},{"location":"languages/java/bytecode.html#_4","title":"\u6267\u884c","text":"<p>\u70ed\u673a\u7684\u6d41\u91cf\u5207\u6362\u65f6\uff0c\u9632\u6b62\u51b7\u673a\u72b6\u6001\u7684\u670d\u52a1\u5668\u65e0\u6cd5\u627f\u8f7d\u6d41\u91cf\u800c\u5047\u6b7b\u3002</p> <p>\u5b57\u8282\u7801\u901a\u8fc7\u7c7b\u52a0\u8f7d\u8fc7\u7a0b\u52a0\u8f7d\u5230 JVM\u73af\u5883\u540e\uff0c\u624d\u53ef\u4ee5\u6267\u884c\uff1a</p> <ul> <li>\u89e3\u91ca\u6267\u884c</li> <li>JIT \u7f16\u8bd1\u6267\u884c</li> <li>JIT \u7f16\u8bd1\u4e0e\u89e3\u91ca\u6df7\u5408\u6267\u884c</li> </ul> <pre><code>graph\n    A{\u5df2\u7f16\u8bd1} --\u662f--&gt;B(\u6267\u884c\u7f16\u8bd1\u540e\u7684\u673a\u5668\u7801)\n    B --&gt; C(\u65b9\u6cd5\u8fd4\u56de)\n    A --\u5426--&gt; D(\u65b9\u6cd5\u8c03\u7528\u8ba1\u6570\u5668\u52a01)\n    D --&gt; E{\u8ba1\u6570\u662f\u5426\u8d85\u8fc7\u9608\u503c}\n    E --\u662f--&gt; F(\u63d0\u4ea4\u7f16\u8bd1\u8bf7\u6c42)\n    E --\u5426--&gt; G(\u89e3\u91ca\u65b9\u6cd5\u6267\u884c)\n    G --&gt; C\n    H(\u89e3\u91ca\u5668) --&gt; G\n    F --&gt; I(\u7f16\u8bd1\u5668)\n    F --&gt; G\n    I --&gt; J(\u540e\u53f0\u7f16\u8bd1\u6267\u884c)\n    J --&gt; K(Code Cache)\n</code></pre>"},{"location":"languages/java/bytecode.html#_5","title":"\u5b57\u8282\u7801\u589e\u5f3a","text":"<p>cglib \uff08\u57fa\u4e8e ASM\uff09\u5df2\u7ecf\u4e0d\u7ef4\u62a4\uff0c\u4e0d\u9002\u7528\u4e8e JDK \u9ad8\u7248\u672c\uff0c\u5b98\u65b9\u63a8\u8350\u4f7f\u7528 ByteBuddy\u66ff\u4ee3</p> <ul> <li>Spring \u81ea\u5df1\u7ef4\u62a4\u4e86\u4e00\u5957 cglib\uff0c\u53ef\u4ee5\u5e94\u7528\u4e8e\u9ad8\u7248\u672c\u7684 JDK\uff1b</li> </ul> <p>\u8fd0\u884c\u65f6\u7684\u5b57\u8282\u7801\u589e\u5f3a\uff0c\u662f\u8ddf java agent \u673a\u5236\u7ed3\u5408\u4f7f\u7528\uff0c\u4e24\u8005\u4e4b\u95f4\u6b63\u4ea4\u5173\u7cfb\uff1b</p>"},{"location":"languages/java/bytecode.html#asm","title":"ASM","text":"<p>\u793a\u4f8b\u4ee3\u7801</p> <p>asm \u5b9e\u73b0\u5bf9java\u5b57\u8282\u7801\u7684\u64cd\u4f5c\uff08\u64cd\u7eb5\u7684\u7ea7\u522b\u662f\u5e95\u5c42JVM\u7684\u6c47\u7f16\u6307\u4ee4\u7ea7\u522b\uff09\uff0c\u4e1a\u754c\u7684btrace \u548c arthas\u5747\u662f\u901a\u8fc7\u5b83\u5b9e\u73b0\u4e86\u8fd0\u884c\u65f6trace\u7684\u529f\u80fd\u3002</p> <ul> <li>\u63d0\u4f9b\u4e86ClassReader\uff0cClassVisitor\uff0cClassWriter\u5206\u522b\u5bf9java\u5b57\u8282\u7801\u8fdb\u884c\u8bfb\uff0c\u904d\u5386\uff0c\u5199\u7684\u64cd\u4f5c\uff1b</li> <li>\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0\u81ea\u5df1\u7684Visitor\u5bf9\u5e94\u7684VisitXXX\u65b9\u6cd5\u6765\u8fbe\u5230\u5bf9\u6307\u5b9a\u904d\u5386\u5bf9\u8c61\u7684\u81ea\u5b9a\u4e49\u64cd\u4f5c\uff1b</li> <li>\u52a8\u6001\u751f\u6210\u7c7b\u6216\u8005\u589e\u5f3a\u65e2\u6709\u7c7b\u7684\u529f\u80fd\uff1b</li> </ul>"},{"location":"languages/java/bytecode.html#apache-common-bcel","title":"Apache Common BCEL","text":"<p>BCEL is already being used successfully in several projects such as compilers, optimizers, obsfuscators, code generators and analysis tools. Unfortunately there hasn't been much development going on over the past few years. </p> <p>BCEL \u662f\u5b57\u8282\u7801\u589e\u5f3a\u5de5\u5177\uff0c\u4e0d\u57fa\u4e8e\u5176\u5b83\u5b57\u8282\u7801\u5de5\u5177\u3002</p> <ul> <li>\u5206\u6790\u3001\u521b\u5efa\u548c\u64cd\u4f5c\uff08\u4e8c\u8fdb\u5236\uff09Java \u7c7b\u6587\u4ef6\uff08\u4ee5 .class \u7ed3\u5c3e\u7684\u6587\u4ef6\uff09</li> </ul>"},{"location":"languages/java/bytecode.html#bytebuddy","title":"ByteBuddy","text":"<p>bytebuddy \uff08\u57fa\u4e8eASM\uff09\u4e0e Java Agent \u4f7f\u7528\u6765\u5b9e\u73b0\u52a8\u6001\u4fee\u6539\u548c\u589e\u5f3a\u7c7b\u7684\u5b57\u8282\u7801</p> <ul> <li>\u6613\u4e8e\u4f7f\u7528\u7684 API\uff0c\u5e76\u652f\u6301\u5728\u8fd0\u884c\u65f6\u751f\u6210\u4ee3\u7406\u5bf9\u8c61\u3001\u4fee\u6539\u65b9\u6cd5\u7684\u884c\u4e3a\u3001\u5b9e\u73b0 AOP \u548c\u52a8\u6001\u7c7b\u521b\u5efa\u7b49\u529f\u80fd\u3002</li> <li>\u57fa\u4e8eJVM\u7684 Java Class\u5143\u6570\u636e\u6765\u8fdb\u884c</li> </ul>"},{"location":"languages/java/bytecode.html#javassist","title":"Javassist","text":"<p>javaassit \u548c \u5176\u4ed6\u5b57\u8282\u7801\u589e\u5f3a\u6846\u67b6\u4f7f\u7528\u65f6\uff0c\u9700\u8981\u653e\u5728\u6700\u524d\u9762\uff1b</p> <ul> <li>\u4eceClassPool \u91cc\u9762\u53bb\u62ffClass\u5143\u4fe1\u606f\uff0c\u5728Javassist\u4e4b\u524d\u5df2\u7ecf\u52a0\u8f7d\u4e86\u5176\u4ed6\u5b57\u8282\u7801\u589e\u5f3a\u6846\u67b6\uff0c\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u65e0\u6cd5\u83b7\u53d6\u5230\u589e\u5f3a\u4e4b\u540e\u7684Class\u4fe1\u606f\uff1b</li> </ul> <p>javaassit \u63d0\u4f9b\u6613\u4e8e\u4f7f\u7528\u7684\u9ad8\u7ea7 API\uff0c\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7f16\u8bd1\u6e90\u7801\u751f\u6210\u5b57\u8282\u7801\uff1a</p> <ul> <li>\u589e\u5f3a\u903b\u8f91\u91c7\u7528\u7684\u662f\u786c\u7f16\u7801\u5f62\u5f0f\uff0c\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u65e0\u6cd5\u8fdb\u884cdebug\uff1b</li> <li>\u5e95\u5c42\u4e5f\u662f\u91c7\u7528\u7c7b\u4f3c asm \u7684 ClassFileWriter\uff0c\u8fdb\u884c\u5b57\u8282\u7801\u7684\u64cd\u4f5c\uff1b</li> </ul>"},{"location":"languages/java/bytecode.html#_6","title":"\u53cd\u5c04","text":"<ul> <li>\u57fa\u672c\u7c7b\u578b\u7684Class\uff0c\u5982boolean.class\uff1b</li> </ul>"},{"location":"languages/java/bytecode.html#reflectasm","title":"reflectasm","text":"<p>\u57fa\u4e8e asm \u63d0\u4f9b a very small Java library that provides high performance reflection by using code generation.</p>"},{"location":"languages/java/bytecode.html#_7","title":"\u4ee3\u7406","text":""},{"location":"languages/java/bytecode.html#jdk","title":"JDK \u52a8\u6001\u4ee3\u7406","text":"<p>\u901a\u8fc7\u53cd\u5c04\u7c7bProxy\u4ee5\u53caInvocationHandler\u56de\u8c03\u63a5\u53e3\u5b9e\u73b0</p> <ul> <li>\u8fdb\u884c\u52a8\u6001\u4ee3\u7406\u7684\u7c7b\u5fc5\u987b\u8981\u5b9e\u73b0\u4e00\u4e2a\u63a5\u53e3</li> </ul> <ul> <li>\u5b9e\u73b0<code>InvocationHandle</code>\u63a5\u53e3\uff0c<code>Proxy.newProxyInstance(ClassLoader, Interface, InvocationHandle)</code></li> </ul>"},{"location":"languages/java/bytecode.html#cglib","title":"Cglib \u52a8\u6001\u4ee3\u7406(\u4e0d\u518d\u7ef4\u62a4)","text":"<p>cglib \uff08\u57fa\u4e8e ASM\uff09\u5df2\u7ecf\u4e0d\u7ef4\u62a4\uff0c\u4e0d\u9002\u7528\u4e8e JDK \u9ad8\u7248\u672c\uff0c\u5b98\u65b9\u63a8\u8350\u4f7f\u7528 ByteBuddy\u66ff\u4ee3</p> <ul> <li>Spring \u81ea\u5df1\u7ef4\u62a4\u4e86\u4e00\u5957 cglib\uff0c\u53ef\u4ee5\u5e94\u7528\u4e8e\u9ad8\u7248\u672c\u7684 JDK\uff1b</li> </ul> <p>\u4f7f\u7528 ASM \u8fdb\u884c\u5e95\u5c42\u7684\u5b57\u8282\u7801\u5904\u7406\uff0c\u52a8\u6001\u4ee3\u7406\u7684\u7c7b\u4e0d\u9700\u8981\u63a5\u53e3\u3002</p>"},{"location":"languages/java/classloader.html","title":"\u7c7b\u52a0\u8f7d","text":"<p>\u7c7b\u52a0\u8f7d\u5668\uff1a\u901a\u8fc7\u4e00\u4e2a\u7c7b\u7684\u5168\u9650\u5b9a\u540d\u6765\u83b7\u53d6\u63cf\u8ff0\u6b64\u7c7b\u7684\u4e8c\u8fdb\u5236\u5b57\u8282\u6d41\u3002</p> <p>\u7c7b\u7531\u7c7b\u52a0\u8f7d\u5668\u548c\u7c7b\u672c\u8eab\u786e\u5b9a\u5176\u5728\u865a\u62df\u673a\u4e2d\u7684\u552f\u4e00\u6027\uff1b</p> <ul> <li>\u7c7b\u201c\u76f8\u7b49\u201d\uff08Class\u5bf9\u8c61\u7684equals, isAssignableFrom, isInstance\u65b9\u6cd5\uff09\uff0c\u5fc5\u987b\u7531\u540c\u4e00\u4e2a\u52a0\u8f7d\u5668\u52a0\u8f7d\u524d\u63d0\u4e0b\u624d\u6709\u610f\u4e49\uff1b\u52a0\u8f7d\u5668\u4e0d\u540c\uff0c\u5219\u80af\u5b9a\u4e0d\u540c\uff1b</li> </ul>"},{"location":"languages/java/classloader.html#_2","title":"\u53cc\u4eb2\u59d4\u6d3e\u6a21\u578b","text":"<ul> <li>\u5f15\u5bfc\u7c7b\u52a0\u8f7d\u5668\uff1a\u5b9a\u4e49\u6838\u5fc3Java SE\u548cJDK\u6a21\u5757\u3002</li> <li>\u5e73\u53f0\u7c7b\u52a0\u8f7d\u5668\uff1a\u5b9a\u4e49\u90e8\u5206Java SE\u548cJDK\u6a21\u5757\u3002</li> <li>\u5e94\u7528\u6216\u7cfb\u7edf\u7c7b\u52a0\u8f7d\u5668\uff1a\u5b9a\u4e49CLASSPATH\u4e0a\u7684\u7c7b\u548c\u6a21\u5757\u8def\u5f84\u4e2d\u7684\u6a21\u5757</li> </ul> <p>\u5c06\u52a0\u8f7d\u4ea4\u7ed9\u7236\u52a0\u8f7d\u5668\u52a0\u8f7d\uff0c\u7236\u52a0\u8f7d\u5668\u65e0\u6cd5\u52a0\u8f7d\uff0c\u5219\u81ea\u5df1\u518d\u52a0\u8f7d\uff1b\uff08\u7c7b\u548c\u7c7b\u52a0\u8f7d\u5668\u6709\u4e86\u4f18\u5148\u5c42\u7ea7\uff09</p> <ul> <li>\u7ec4\u5408\u800c\u4e0d\u662f\u7ee7\u627f\u5b9e\u73b0\uff1b</li> </ul>"},{"location":"languages/java/classloader.html#_3","title":"\u5f15\u5bfc\u7c7b\u52a0\u8f7d\u5668","text":"<p>C++\u8bed\u8a00\u5b9e\u73b0\uff0c\u662f\u865a\u62df\u673a\u81ea\u8eab\u4e00\u90e8\u5206\uff1b</p> <ul> <li>\u5c06<code>&lt;JAVA_HOME&gt;\\lib</code>\u76ee\u5f55\u4e2d\u6216<code>-Xbootclasspath</code>\u6307\u5b9a\u8def\u5f84\uff0c\u4ec5\u88ab\u865a\u62df\u673a\u8bc6\u522b\u7684\u7c7b\u5e93\u52a0\u8f7d\u5230\u865a\u62df\u673a\u3002</li> <li>\u4e0d\u53ef\u4ee5\u88abJava\u7a0b\u5e8f\u76f4\u63a5\u5f15\u7528\uff0c\u5982<code>String.class.getClassLoader()</code> \u8fd4\u56de\u7684\u7ed3\u679c\u4e3a null\uff1b</li> </ul>"},{"location":"languages/java/classloader.html#_4","title":"\u5e73\u53f0(\u6269\u5c55)\u7c7b\u52a0\u8f7d\u5668","text":"<p>JDK 9\u4e4b\u540e\u79f0\u4e3a Platform ClassLoader\u3002</p> <p><code>&lt;JAVA_HOME&gt;\\lib\\ext</code>\u76ee\u5f55\u6216<code>java.ext.dirs</code>\u6307\u5b9a\u8def\u5f84\uff0c\u53ef\u4ee5\u88abJava\u7a0b\u5e8f\u4f7f\u7528\uff1b</p>"},{"location":"languages/java/classloader.html#_5","title":"\u7cfb\u7edf\u7c7b\u52a0\u8f7d\u5668","text":"<p>AppClassLoader</p> <p>\u5e94\u7528\u7a0b\u5e8f\u7c7b\u52a0\u8f7d\u5668\uff1a\u7528\u6237\u7c7b\u8def\u5f84\uff08ClassPath\uff09\u4e0a\u7c7b\u5e93\uff0c\u53ef\u4ee5\u76f4\u63a5\u88abJava\u4f7f\u7528\uff1b</p>"},{"location":"languages/java/classloader.html#_6","title":"\u7ebf\u7a0b\u52a0\u8f7d\u5668","text":"<p>\u53cc\u4eb2\u59d4\u6d3e\u6a21\u578b\u7684\u5178\u578b\u95ee\u9898\u662f\u52a0\u8f7d SPI \u5b9e\u73b0\u7c7b\u7684\u573a\u666f\u3002</p> <p>Java\u4e2d\u7684 SPI \u673a\u5236\uff0c\u5982 JDBC\uff1a</p> <ul> <li> <p>Driver\u7c7b\u7531\u542f\u52a8\u7c7b\u52a0\u8f7d\u5668\u52a0\u8f7d\uff08rt.jar\uff09\uff0c\u4f46\u662f\u5b9e\u73b0\u662f\u7531\u7b2c\u4e09\u65b9\u63d0\u4f9b\u7684\uff0c\u542f\u52a8\u7c7b\u52a0\u8f7d\u5668\u52a0\u8f7d\u4e0d\u5230\uff1b</p> </li> <li> <p>\u7b2c\u4e09\u65b9\u63d0\u4f9b\u7684\u5177\u4f53 jar \u5b9e\u73b0\uff0c<code>ServiceLoader</code>\u901a\u8fc7 \u7531Thread\u7684<code>contextClassLoader</code>\u52a0\u8f7d\uff1b</p> </li> <li> <p>\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u7c7b\u52a0\u8f7d\u5668\uff0c\u7ee7\u627f\u4e8e\u7236\u7ebf\u7a0b\uff0c\u82e5\u5f00\u59cb\u5c31\u6ca1\u6709\uff0c\u5219\u9ed8\u8ba4\u662f\u7cfb\u7edf\u7c7b\u52a0\u8f7d\u5668\uff08AppClassLoader\uff09\uff1b</p> </li> </ul>"},{"location":"languages/java/classloader.html#jdk-9","title":"JDK 9","text":"<p>\u6a21\u5757\u5316\u7684\u652f\u6301\uff0c\u5bf9\u53cc\u4eb2\u59d4\u6d3e\u6a21\u5f0f\u505a\u4e86\u4e00\u4e9b\u6539\u52a8</p> <ul> <li>\u6269\u5c55\u7c7b\u52a0\u8f7d\u5668\u88ab\u5e73\u53f0\u7c7b\u52a0\u8f7d\u5668\uff08Platform ClassLoader\uff09</li> <li> <p>\u6a21\u5757\u5316\uff0c\u53ef\u6269\u5c55\uff0c\u65e0\u9700<code>java.ext.dirs</code></p> </li> <li> <p>\u542f\u52a8\u7c7b\u52a0\u8f7d\u5668\u73b0\u5728\u662f\u5728 Java \u865a\u62df\u673a\u5185\u90e8\u548c Java \u7c7b\u5e93\u5171\u540c\u534f\u4f5c\u5b9e\u73b0\u7684\u7c7b\u52a0\u8f7d\u5668\uff08\u4ee5\u524d\u662f C++\u5b9e\u73b0\uff09</p> </li> <li> <p>\u5373\u5b58\u5728<code>BootClassLoader</code>\u7c7b\uff0c\u4f46\u6240\u6709\u5728\u83b7\u53d6\u542f\u52a8\u7c7b\u52a0\u8f7d\u5668\u7684\u573a\u666f\u4ecd\u7136\u4f1a\u8fd4\u56de null \u6765\u4ee3\u66ff\uff08\u517c\u5bb9\uff09\uff1b</p> </li> <li> <p>\u5e73\u53f0\u7c7b\u52a0\u8f7d\u5668\u548c\u7cfb\u7edf\u7c7b\u52a0\u8f7d\u5668\u4e0d\u518d\u662f<code>URLClassLoader</code>\u7c7b\u7684\u5bf9\u8c61\uff0c\u800c\u7ee7\u627f<code>BuiltinClassLoader</code>\uff1a</p> </li> <li> <p>Hack\u5931\u6548\uff1a\u628a\u7cfb\u7edf\u7c7b\u52a0\u8f7d\u5668\u8f6c\u578b\u6210<code>URLClassLoader</code>\u5e76\u8c03\u7528\u5176<code>addURL()</code>\u65b9\u6cd5</p> </li> <li> <p>\u5f53\u5e73\u53f0\u53ca\u5e94\u7528\u7a0b\u5e8f\u7c7b\u52a0\u8f7d\u5668\u6536\u5230\u7c7b\u52a0\u8f7d\u8bf7\u6c42\uff0c\u5728\u59d4\u6d3e\u7ed9\u7236\u52a0\u8f7d\u5668\u52a0\u8f7d\u524d\uff0c\u8981\u5148\u5224\u65ad\u8be5\u7c7b\u662f\u5426\u80fd\u591f\u5f52\u5c5e\u5230\u67d0\u4e00\u4e2a\u7cfb\u7edf\u6a21\u5757\u4e2d\uff0c\u5982\u679c\u53ef\u4ee5\u627e\u5230\u8fd9\u6837\u7684\u5f52\u5c5e\u5173\u7cfb\uff0c\u5c31\u8981\u4f18\u5148\u59d4\u6d3e\u7ed9\u8d1f\u8d23\u90a3\u4e2a\u6a21\u5757\u7684\u52a0\u8f7d\u5668\u5b8c\u6210\u52a0\u8f7d\u3002</p> </li> </ul> <p></p>"},{"location":"languages/java/classloader.html#_7","title":"\u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u5668","text":"<ul> <li>\u8986\u76d6findClass\u65b9\u6cd5\uff1b</li> </ul>"},{"location":"languages/java/classloader.html#_8","title":"\u52a8\u6001\u91cd\u65b0\u52a0\u8f7d","text":"<p>JVM \u4e0d\u5141\u8bb8\u52a8\u6001\u91cd\u65b0\u52a0\u8f7d\u7c7b\uff0c\u4e00\u65e6\u7c7b\u52a0\u8f7d\u5668\u52a0\u8f7d\u4e86\u4e00\u4e2a\u7c7b\uff0c\u5b83\u5c31\u4e0d\u80fd\u5728\u8fd0\u884c\u65f6\u91cd\u65b0\u52a0\u8f7d\u8be5\u7c7b\u7684\u4fee\u6539\u7248\u672c\u3002\u56e0\u6b64\uff0cJVM\u52a0\u8f7d\u7c7b\u540e\uff0c\u60a8\u65e0\u6cd5\u66f4\u6539\u7c7b\u7684\u5b9a\u4e49\uff08\u5bf9\u4e8e\u540c\u4e00\u4e2a ClassLoader\uff09\u3002</p>"},{"location":"languages/java/classloader.html#jpda","title":"JPDA","text":"<p>JP\u3002JVM\u662f\u5728\u542f\u7528JPDA\uff08Java\u5e73\u53f0\u8c03\u8bd5\u5668\u4f53\u7cfb\u7ed3\u6784\uff09\u7684\u60c5\u51b5\u4e0b\u542f\u52a8\u7684\uff0c\u90a3\u4e48\u7c7b\u662f\u52a8\u6001\u53ef\u91cd\u65b0\u52a0\u8f7d\u7684\u3002</p> <ul> <li>\u65b0\u7684\u7c7b\u5b9a\u4e49\u5fc5\u987b\u4e0e\u65e7\u7684\u7c7b\u5b9a\u4e49\u5728\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u517c\u5bb9\uff0c\u5373JVM\u4e0d\u5141\u8bb8\u5728\u4e24\u4e2a\u7248\u672c\u4e4b\u95f4\u66f4\u6539\u6a21\u5f0f\uff0c\u5b83\u4eec\u5177\u6709\u76f8\u540c\u7684\u4e00\u7ec4\u65b9\u6cd5\u548c\u5b57\u6bb5\uff1b</li> <li>\u5373 \u53ea\u80fd\u4fee\u6539\u51fd\u6570\u5b9a\u4e49\uff0c\u4e0d\u80fd\u65b0\u589e/\u5220\u9664\u7c7b\u7684\u5b57\u6bb5\u6216\u65b9\u6cd5\uff1b</li> </ul>"},{"location":"languages/java/cmd_tools.html","title":"Tools","text":"<p>\u5f53\u524d\u6ca1\u6709\u65b9\u6cd5\u53ef\u4ee5\u5bf9 JNI \u533a\u5206JVM\u4f7f\u7528\u7684\u5185\u5b58\u548cC++\u4f7f\u7528\u7684\u5185\u5b58\u3002</p> <ul> <li>\u8fdb\u7a0b\u5185\u5b58\u53ef\u4ee5\u901a\u8fc7 <code>/proc</code> \u83b7\u53d6\uff1b</li> <li>JVM\u5185\u5b58\u7531 Heap + Meta + Direct Memory \u7b49\u7ec4\u6210\uff1b</li> </ul>"},{"location":"languages/java/cmd_tools.html#_1","title":"\u547d\u4ee4\u884c","text":""},{"location":"languages/java/cmd_tools.html#java","title":"java","text":"<p><code>-server</code>\uff1a\u670d\u52a1\u5668\u6a21\u5f0f\u542f\u52a8JAVA\uff0c\u9ed8\u8ba4\u542f\u52a8JVM\u57fa\u672c\u90fd\u662f-server\u6a21\u5f0f</p> <p>\u542f\u7528\u8c03\u8bd5\uff1b -XDebug -Xrunjdwp:transport=dt_scoket, server=y,address=7899,suspend=n</p> <ul> <li>-Xrunjdwp \u52a0\u8f7dJDWP\u7684JPDA\u53c2\u8003\u6267\u884c\u5b9e\u4f8b\uff1b1.7\u4e4b\u540e\u53ef\u4ee5\u5c06 -Xrunjdwp: \u66ff\u6362\u4e3a -agentlib:jdwp=</li> <li>transport\uff1adebugee\u4e0edebuger\u8c03\u8bd5\u65f6\u4e4b\u95f4\u7684\u901a\u8baf\u6570\u636e\u4f20\u8f93\u65b9\u5f0f\u3002 </li> <li>server\uff1a\u662f\u5426\u76d1\u542cdebuger\u7684\u8c03\u8bd5\u8bf7\u6c42(\u4f5c\u4e3a\u8c03\u8bd5\u670d\u52a1\u5668\u6267\u884c)\u3002 </li> <li>suspend\uff1a\u662f\u5426\u7b49\u5f85\u542f\u52a8\uff0c\u4e5f\u5373\u8bbe\u7f6e\u662f\u5426\u5728debuger\u8c03\u8bd5\u94fe\u63a5\u5efa\u7acb\u540e\u624d\u542f\u52a8debugee JVM\u3002 </li> <li>address\uff1a \u8c03\u8bd5\u670d\u52a1\u5668\u76d1\u542c\u7684\u7aef\u53e3\u53f7</li> </ul> <p><code>-cp</code></p> <ul> <li>\u6307\u5b9a\u52a0\u8f7d\u67d0\u8def\u5f84\u4e0b\u7684\u6240\u6709\u7b2c\u4e09\u65b9\u5305\uff0c-Djava.ext.dirs \u6216\u8005 java -cp .;c:\\classes\\myClass.jar;d:\\classes*.jar</li> </ul> <p>linux\u4e0b\u4e3a java -cp .:/home/text/*\uff0c\u6ce8\u610f * \u4e0d\u5305\u62ec\u9012\u5f52\u7684\u5b50\u76ee\u5f55\u4e2d\u7684\u5185\u5bb9\u3002</p> <p>OOM\u65f6\u5806\u5feb\u7167</p> <p>-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=${\u76ee\u5f55}</p> <ul> <li>\u5f53JVM\u53d1\u751fOOM\u65f6\uff0c\u81ea\u52a8\u751f\u6210DUMP\u6587\u4ef6\u3002</li> <li>\u5982\u679c\u4e0d\u6307\u5b9a\u6587\u4ef6\u540d\uff0c\u9ed8\u8ba4\u4e3a\uff1ajava__heapDump.hprof <p><code>-jar</code></p> <pre><code>java -jar myClass.jar\n</code></pre> <p>\u6267\u884c\u8be5\u547d\u4ee4\u65f6\uff0c\u4f1a\u7528\u5230\u76ee\u5f55<code>META-INF\\MANIFEST.MF</code>\u6587\u4ef6\uff0c\u5728\u8be5\u6587\u4ef6\u4e2d<code>Main-Class</code>\u7684\u53c2\u6570\u8bf4\u660ejava -jar\u547d\u4ee4\u6267\u884c\u7684\u7c7b\u3002</p>"},{"location":"languages/java/cmd_tools.html#jar","title":"Jar","text":"<p>\u89e3\u538b</p> <pre><code>jar -xvf jar\u5305\u540d\u5b57.jar\n</code></pre> <p>\u6253\u5305</p> <pre><code>jar -cvfM \u5408\u5e76\u540e\u7684jar\u5305\u540d\u5b57.jar .\n</code></pre>"},{"location":"languages/java/cmd_tools.html#javapclass","title":"javap\uff08\u67e5\u770bclass\u6587\u4ef6)","text":"<p>javap -c -s -l -verbose $ClassName</p> <ul> <li>-c \uff1a\u8f93\u51fa\u7c7b\u4e2d\u5404\u65b9\u6cd5\u7684\u672a\u89e3\u6790\u7684\u4ee3\u7801\uff0c\u5373\u6784\u6210java\u5b57\u8282\u7801\u7684\u6307\u4ee4\uff1b</li> <li>-l \uff1a\u8f93\u51fa\u884c\u53ca\u5c40\u90e8\u53d8\u91cf\u8868\uff1b</li> <li>-s \uff1a\u8f93\u51fa\u5185\u90e8\u7c7b\u578b\u7b7e\u540d\uff1b</li> <li>-verbose \uff1a\u6253\u5370\u5806\u6808\u5927\u5c0f\u3001\u5404\u65b9\u6cd5\u7684locals\u53caargs\u53c2\u6570\uff0c\u4ee5\u53caclass\u6587\u4ef6\u7684\u7f16\u8bd1\u7248\u672c\uff1b</li> </ul>"},{"location":"languages/java/cmd_tools.html#jpsjvm","title":"jps\uff08JVM\u53c2\u6570\u4fe1\u606f\uff09","text":"<pre><code>jps -m #\u8f93\u51fa\u4f20\u9012\u7ed9main\u65b9\u6cd5\u7684\u53c2\u6570\njps -l  #\u8f93\u51fa\u5e94\u7528\u7a0b\u5e8fmain class\u7684\u5b8c\u6574package\u540d\u6216\u8005\u5e94\u7528\u7a0b\u5e8f\u7684jar\u6587\u4ef6\u5b8c\u6574\u8def\u5f84\u540d\njps -v #\u8f93\u51fajvm\u53c2\u6570\n</code></pre>"},{"location":"languages/java/cmd_tools.html#jcmd","title":"jcmd\uff08\u7c7b\uff0c\u7ebf\u7a0b\u4ee5\u53ca\u865a\u62df\u673a\u4fe1\u606f\uff09","text":"<p>\u6253\u5370\u4e00\u4e2a Java \u8fdb\u7a0b\u7684\u7c7b\uff0c\u7ebf\u7a0b\u4ee5\u53ca\u865a\u62df\u673a\u4fe1\u606f\u3002\u4f7f\u7528 jcmd - h \u6765\u67e5\u770b\u4f7f\u7528\u65b9\u6cd5\u3002</p> <pre><code>jcmd &lt;pid | main class&gt; &lt;command ...|PerfCounter.print|-f file&gt;\n\n# \u67e5\u770b\u652f\u6301\u7684\u547d\u4ee4\u5217\u8868\uff0c\u5982 GC.heap_dump, VM.native_memory\u7b49\njcmd pid help\n</code></pre> <p>PerfCounter.print\u548cjstat\u4e00\u6837\u4f7f\u7528PerfData,jstat\u4e2d\u7684\u6307\u6807\u90fd\u53ef\u4ee5\u6839\u636e\u8fd9\u4e9bcounter\u8ba1\u7b97\u51fa\u6765\uff0c\u5177\u4f53\u7684\u8ba1\u7b97\u89c4\u5219\u53ef\u4ee5\u53c2\u8003tool.jar\u4e2d\u7684sun/tools/jstat/resources/jstat_options\u6587\u4ef6\u3002</p>"},{"location":"languages/java/cmd_tools.html#jhathtml","title":"jhat\uff08html\u5f62\u5f0f\u67e5\u770b\u5806\u4fe1\u606f\uff09","text":"<p>\u5e2e\u52a9\u5206\u6790\u5185\u5b58\u5806\u5b58\u50a8\uff0c\u5206\u6790jmap\u8f93\u51fa\u7684dump\u6587\u4ef6\u3002</p> <pre><code>jhat dump.log\n</code></pre>"},{"location":"languages/java/cmd_tools.html#jmap","title":"jmap\uff08\u5185\u5b58\u4fe1\u606f\uff0c\u7c7b\u5b9e\u4f8b\u6570\u76ee\u548c\u5185\u5b58\u5360\u7528\uff09","text":"<p>\u63d0\u4f9b JVM \u5185\u5b58\u4f7f\u7528\u4fe1\u606f\uff0c\u9002\u7528\u4e8e\u811a\u672c\u4e2d\u3002</p> <pre><code>-dump:[live,]format=b,file=&lt;filename&gt; \u4f7f\u7528hprof\u4e8c\u8fdb\u5236\u5f62\u5f0f,\u8f93\u51fajvm\u7684heap\u5185\u5bb9\u5230\u6587\u4ef6. live\u5b50\u9009\u9879\u662f\u53ef\u9009\u7684\uff0c\u5047\u5982\u6307\u5b9alive\u9009\u9879,\u90a3\u4e48\u53ea\u8f93\u51fa\u6d3b\u7684\u5bf9\u8c61\u5230\u6587\u4ef6.\n\n-finalizerinfo \u6253\u5370\u6b63\u7b49\u5019\u56de\u6536\u7684\u5bf9\u8c61\u7684\u4fe1\u606f.\n\n-heap \u6253\u5370heap\u7684\u6982\u8981\u4fe1\u606f\uff0cGC\u4f7f\u7528\u7684\u7b97\u6cd5\uff0cheap\u7684\u914d\u7f6e\u53cawise heap\u7684\u4f7f\u7528\u60c5\u51b5.\n\n-histo[:live] \u6253\u5370\u6bcf\u4e2aclass\u7684\u5b9e\u4f8b\u6570\u76ee,\u5185\u5b58\u5360\u7528,\u7c7b\u5168\u540d\u4fe1\u606f. VM\u7684\u5185\u90e8\u7c7b\u540d\u5b57\u5f00\u5934\u4f1a\u52a0\u4e0a\u524d\u7f00\u201d*\u201d. \u5982\u679clive\u5b50\u53c2\u6570\u52a0\u4e0a\u540e,\u53ea\u7edf\u8ba1\u6d3b\u7684\u5bf9\u8c61\u6570\u91cf.\n\n-clstats \u6253\u5370classload\u548cjvm heap\u957f\u4e45\u5c42\u7684\u4fe1\u606f. \u5305\u542b\u6bcf\u4e2aclassloader\u7684\u540d\u5b57,\u6d3b\u6cfc\u6027,\u5730\u5740,\u7236classloader\u548c\u52a0\u8f7d\u7684class\u6570\u91cf. \u53e6\u5916,\u5185\u90e8String\u7684\u6570\u91cf\u548c\u5360\u7528\u5185\u5b58\u6570\u4e5f\u4f1a\u6253\u5370\u51fa\u6765.(-clstats\u662f-permstat\u7684\u66ff\u4ee3\u65b9\u6848\uff0c\u5728JDK8\u4e4b\u524d\uff0c-permstat\u7528\u6765\u6253\u5370\u7c7b\u52a0\u8f7d\u5668\u7684\u6570\u636e)\n-F \u5f3a\u8feb.\u5728pid\u6ca1\u6709\u76f8\u5e94\u7684\u65f6\u5019\u4f7f\u7528-dump\u6216\u8005-histo\u53c2\u6570. \u5728\u8fd9\u4e2a\u6a21\u5f0f\u4e0b,live\u5b50\u53c2\u6570\u65e0\u6548.\n</code></pre>"},{"location":"languages/java/cmd_tools.html#jinfo","title":"jinfo\uff08\u7cfb\u7edf\u5c5e\u6027\uff09","text":"<p>\u8bbf\u95ee JVM \u7cfb\u7edf\u5c5e\u6027\uff0c\u540c\u65f6\u53ef\u4ee5\u52a8\u6001\u4fee\u6539\u8fd9\u4e9b\u5c5e\u6027\u3002</p>"},{"location":"languages/java/cmd_tools.html#jstack","title":"jstack\uff08\u5806\u6808\u548c\u6b7b\u9501\u4fe1\u606f\uff09","text":"<p>\u63d0\u4f9b Java \u8fdb\u7a0b\u5185\u7684\u7ebf\u7a0b\u5806\u6808\u4fe1\u606f\u3002</p>"},{"location":"languages/java/cmd_tools.html#jstatgc","title":"jstat\uff08\u7c7b\u52a0\u8f7d\uff0cGC\uff0c\u7f16\u8bd1\u4fe1\u606f\uff09","text":"<p>\u63d0\u4f9b Java \u5783\u573e\u56de\u6536\u4ee5\u53ca\u7c7b\u52a0\u8f7d\u4fe1\u606f\u3002</p> <pre><code># S0\uff1a\u5e78\u5b581\u533a\u5f53\u524d\u4f7f\u7528\u6bd4\u4f8b S1\uff1a\u5e78\u5b582\u533a\u5f53\u524d\u4f7f\u7528\u6bd4\u4f8b E\uff1a\u4f0a\u7538\u56ed\u533a\u4f7f\u7528\u6bd4\u4f8b O\uff1a\u8001\u5e74\u4ee3\u4f7f\u7528\u6bd4\u4f8b M\uff1a\u5143\u6570\u636e\u533a\u4f7f\u7528\u6bd4\u4f8b\n# CCS\uff1a\u538b\u7f29\u4f7f\u7528\u6bd4\u4f8b YGC\uff1a\u5e74\u8f7b\u4ee3\u5783\u573e\u56de\u6536\u6b21\u6570 FGC\uff1a\u8001\u5e74\u4ee3\u5783\u573e\u56de\u6536\u6b21\u6570 FGCT\uff1a\u8001\u5e74\u4ee3\u5783\u573e\u56de\u6536\u6d88\u8017\u65f6\u95f4\n# GCT\uff1a\u5783\u573e\u56de\u6536\u6d88\u8017\u603b\u65f6\u95f4\njstat -gcutil pid\n\njstat -compiler pid\n\njstat -class pid\n</code></pre>"},{"location":"languages/java/cmd_tools.html#jstatdattach","title":"jstatd\uff08\u4f9b\u8fdc\u7a0battach\u76d1\u63a7\u672c\u5730\u8fdb\u7a0b\uff09","text":"<p>jstatd\u662f\u4e00\u4e2aRMI\u7684server\u5e94\u7528\uff0c\u7528\u4e8e\u76d1\u63a7jvm\u7684\u521b\u5efa\u548c\u7ed3\u675f\uff0c\u4e5f\u4e3a\u8fdc\u7a0b\u76d1\u89c6\u5de5\u5177\uff08\u5982 jvisualvm\uff09\u63d0\u4f9b\u4e86\u4e00\u4e2a\u53ef\u4ee5attach\u7684\u63a5\u53e3\u3002 </p> <ul> <li>\u914d\u7f6e jstatd.all.policy \u6587\u4ef6\uff0c\u5b89\u5168\u7b56\u7565</li> </ul> <pre><code>grant codebase \"file:${java.home}/../lib/tools.jar\" {\n    permission java.security.AllPermission;\n};\n</code></pre> <ul> <li>\u542f\u52a8</li> </ul> <pre><code>jstatd -J-Djava.security.policy=jstatd.all.policy -J-Djava.rmi.server.hostname=172.16.2.132  -J-Djava.rmi.server.logCalls=true\n</code></pre>"},{"location":"languages/java/cmd_tools.html#jmxjstatd","title":"jmx\u548cjstatd\u533a\u522b","text":"<p>JMX\uff1a\u4f7f\u7528JMX\u9700\u8981\u8fdc\u7a0bJVM\u5728\u542f\u52a8\u7684\u65f6\u5019\u5f00\u542f\u8fdc\u7a0b\u8bbf\u95ee\u652f\u6301\uff0c\u8bbe\u5b9aJMX\u7aef\u53e3\u7b49\uff0c\u6bcf\u4e00\u4e2aJMX\u8fde\u63a5\u4e00\u4e2a\u8fdc\u7a0bJVM\u3002 Jstatd\uff1a\u4f7f\u7528jstatd\u8fde\u63a5\u65b9\u5f0f\u65f6\uff0c\u9700\u8981\u5728\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u521b\u5efa\u5b89\u5168\u7b56\u7565\u6587\u4ef6\u7136\u540e\u542f\u52a8jstatd\u8fdb\u7a0b\uff0c\u5e76\u4e14\u6b64\u8fdb\u7a0b\u9700\u8981\u4e00\u76f4\u4fdd\u6301\u8fd0\u884c\u72b6\u6001\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u770b\u5230\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u5f53\u524d\u7528\u6237\u7684\u6240\u6709JVM\u7684\u4fe1\u606f\uff0c\u5373\u53ea\u8981\u521b\u5efa\u4e00\u4e2ajstatd\u8fde\u63a5\u3002</p>"},{"location":"languages/java/cmd_tools.html#_2","title":"\u56fe\u5f62\u5316","text":""},{"location":"languages/java/cmd_tools.html#jconsolejvisualvm","title":"jconsole(\u4f7f\u7528jvisualvm\u66ff\u4ee3)","text":"<p>\u63d0\u4f9b JVM \u6d3b\u52a8\u7684\u56fe\u5f62\u5316\u5c55\u793a\uff0c\u5305\u62ec\u7ebf\u7a0b\u4f7f\u7528\uff0c\u7c7b\u4f7f\u7528\u4ee5\u53ca\u5783\u573e\u56de\u6536\uff08GC\uff09\u4fe1\u606f\u3002</p>"},{"location":"languages/java/cmd_tools.html#jvisualvmjvmcpumemorygchot-spot","title":"jvisualvm\uff08JVM\u5206\u6790\uff0ccpu/memory/gc/hot spot\uff09","text":"<p>\u63d0\u4f9b\u672c\u5730\u548c\u8fdc\u7a0b JVM \u7684\u53ef\u89c6\u5316\u5de5\u5177\uff0c\u5256\u6790\u8fd0\u884c\u4e2d\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u5206\u6790 JVM \u5806\u5b58\u50a8\u3002</p> <p>\u5bf9\u4e8e\u8fdc\u7a0bJVM\uff0c\u9700\u8981\u914d\u7f6eJMX\u6216\u8005\u8fdc\u7a0b\u542f\u52a8jstatd\uff1a</p> <pre><code>-Dcom.sun.management.jmxremote\n-Dcom.sun.management.jmxremote.port=10207 -Dcom.sun.management.jmxremote.\nauthenticate=false -Dcom.sun.management.jmxremote.ssl=false\n</code></pre> <p>GC\u901a\u8fc7\u63d2\u4ef6Visual GC\u67e5\u770b\u3002</p>"},{"location":"languages/java/cmd_tools.html#jmc","title":"jmc\uff08\u5206\u6790\u6027\u80fd\uff09","text":"<p>\u98de\u884c\u8bb0\u5f55\u5668\uff1a\u4e00\u822c\u4fe1\u606f\u3001\u5185\u5b58\u3001\u4ee3\u7801\u3001\u7ebf\u7a0b\u3001I/O\u3001\u7cfb\u7edf\u3001\u4e8b\u4ef6\u3002</p>"},{"location":"languages/java/cmd_tools.html#_3","title":"\u6848\u4f8b","text":""},{"location":"languages/java/cmd_tools.html#ideadebug","title":"idea\u8fdc\u7a0bdebug","text":"<p>\u5728 DEBUG \u91cc\u9762\u65b0\u5efa Remote\uff0c</p> <ul> <li>Attach\u6a21\u5f0f\uff0c\u8fdc\u7a0b\u5f00\u542f\u7aef\u53e3\uff0c\u672c\u5730\u53bb\u8fde\u63a5\u3002\u8fdc\u7a0bjvm\u542f\u52a8\u53c2\u6570\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e\uff08jdk 8\uff09\uff1a</li> </ul> <pre><code>-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005\n</code></pre> <ul> <li>Socket\u6a21\u5f0f\uff0c\u672c\u5730\u5f00\u7aef\u53e3\uff0c\u8fdc\u7a0b\u542f\u52a8\u65f6\u8fde\u63a5\u3002\u8fdc\u7a0bjvm\u542f\u52a8\u53c2\u6570\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e\uff1a</li> </ul> <pre><code>-agentlib:jdwp=transport=dt_socket,server=n,address=DESKTOP-39BEHUR:5005,suspend=y,onthrow=&lt;FQ exception class name&gt;,onuncaught=&lt;y/n&gt;\n</code></pre>"},{"location":"languages/java/cmd_tools.html#outputmemory","title":"OutputMemory\u6392\u67e5","text":"<pre><code>// \u5185\u5b58\u6cc4\u9732\u4ee3\u7801\nimport java.util.ArrayList;\nimport java.util.List;\n\npublic class HeapDumpDemo {\n\n    static class OOMHeapDumpObject {\n        String str = \"1234567890\";\n    }\n\n    public static void main(String[] args) {\n        List&lt;OOMHeapDumpObject&gt; ooms = new ArrayList&lt;&gt;();\n        while (true) {\n            ooms.add(new OOMHeapDumpObject());\n        }\n    }\n}\n</code></pre> <p>\u5982\u4e0b\u542f\u52a8\uff1a</p> <pre><code>java -XX:+HeapDumpOnOutOfMemoryError -Xmx20m HeapDumpDemo\n</code></pre> <p>\u5c06\u5806\u5b58\u50a8hprof\u6587\u4ef6\uff0c\u901a\u8fc7jvisualvm/idea\u7b49\u5de5\u5177\u6253\u5f00\uff0c\u53ef\u4ee5\u67e5\u770b\u5230\u5bf9\u5e94\u7684\u5927\u91cf\u7684\u5bf9\u8c61\u3002</p>"},{"location":"languages/java/collections.html","title":"\u7ebf\u7a0b\u96c6\u5408","text":"<p>JDK 1.8 \u4e2d\u7684 Java \u96c6\u5408\u6846\u67b6\u56fe\uff08List/Queue/Set/Map\uff09\uff1a</p> <ul> <li>\u7ea2\u8272\u4ee3\u8868\u63a5\u53e3\uff1b\u84dd\u8272\u4ee3\u8868\u62bd\u8c61\u7c7b\uff1b\u7eff\u8272\u4ee3\u8868\u5e76\u53d1\u7c7b\uff1b\u7070\u8272\u4ee3\u8868\u65e9\u671f\u7ebf\u7a0b\u5b89\u5168\u7c7b\uff08\u5df2\u5e9f\u5f03\uff09\u3002</li> </ul> <p></p>"},{"location":"languages/java/collections.html#map","title":"Map","text":"<p>TreeMap \u5b9e\u73b0\u539f\u7406\uff08TODO\uff09 </p> <p>HashMap \u5b9e\u73b0\u539f\u7406\uff08TODO\uff09</p>"},{"location":"languages/java/collections.html#_2","title":"\u540c\u6b65\u5bb9\u5668\u7c7b\uff08\u5e9f\u5f03)","text":""},{"location":"languages/java/collections.html#vectorhash-tablestack","title":"Vector\u3001Hash Table\u3001Stack","text":"<p>Vector\u662fArrayList\u7684\u6240\u6709\u64cd\u4f5c\u52a0\u9501\uff0cHash Table\u662fHashMap\u7684\u6240\u6709\u64cd\u4f5c\u52a0\u9501</p>"},{"location":"languages/java/collections.html#_3","title":"\u5e76\u53d1\u5bb9\u5668","text":"<ol> <li>\u901a\u8fc7\u5e76\u53d1\u5bb9\u5668\u6765\u66ff\u4ee3\u540c\u6b65\u5bb9\u5668\uff0c\u53ef\u4ee5\u6781\u5927\u63d0\u9ad8\u4f38\u7f29\u6027\u5e76\u964d\u4f4e\u98ce\u9669\u3002</li> <li>\u8fed\u4ee3\u5668\u4e0d\u4f1a\u629b\u51faConcurrentModificationException\uff0c\u4e0d\u9700\u8981\u518d\u8fed\u4ee3\u65f6\u5bf9\u5bb9\u5668\u52a0\u9501\uff1b</li> </ol>"},{"location":"languages/java/collections.html#map_1","title":"Map","text":""},{"location":"languages/java/collections.html#concurrenthashmap","title":"ConcurrentHashMap","text":"<p>\u66ff\u4ee3\u540c\u6b65\u4e14\u57fa\u4e8e\u6563\u5217\u7684Map\u3002</p> <ul> <li>\u91c7\u7528\u5206\u6bb5\u9501\uff08Lock Striping\uff09\uff1b</li> <li>\u5f31\u4e00\u81f4\u6027\u7684\u8fed\u4ee3\u5668\uff1b</li> <li><code>size</code>\u548c<code>empty</code>\u64cd\u4f5c\u88ab\u5f31\u5316\uff0c\u53ea\u662f\u4e2a\u4f30\u8ba1\u503c\uff1b</li> </ul> <p>\u5b9e\u73b0\u539f\u7406\uff08TODO\uff09\uff1a</p>"},{"location":"languages/java/collections.html#concurrentskiplistmap","title":"ConcurrentSkipListMap","text":"<p>\u540c\u6b65\u7684SortedMap\u3002</p>"},{"location":"languages/java/collections.html#set","title":"Set","text":""},{"location":"languages/java/collections.html#copyonwritearrayset","title":"CopyOnWriteArraySet","text":"<p>\u540c\u6b65\u7684Set\u3002</p> <ul> <li>\u5f53\u8fed\u4ee3\u64cd\u4f5c\u8fdc\u8fdc\u591a\u4e8e\u4fee\u6539\u64cd\u4f5c\u65f6\u4f7f\u7528\uff0c\u590d\u5236\u5e95\u5c42\u6570\u7ec4\u9700\u8981\u4e00\u5b9a\u5f00\u9500\uff0c\u5982\u4e8b\u4ef6\u901a\u77e5\u7cfb\u7edf\uff1b</li> </ul>"},{"location":"languages/java/collections.html#concurrentskiplistset","title":"ConcurrentSkipListSet","text":"<p>\u540c\u6b65\u7684SortedSet\u3002</p>"},{"location":"languages/java/collections.html#list","title":"List","text":""},{"location":"languages/java/collections.html#copyonwritearraylist","title":"CopyOnWriteArrayList","text":"<p>\u7528\u4e8e\u5728\u904d\u5386\u65f6\u66ff\u4ee3\u540c\u6b65\u7684List\u3002</p>"},{"location":"languages/java/collections.html#transferqueue","title":"TransferQueue","text":""},{"location":"languages/java/collections.html#blockingqueue","title":"BlockingQueue","text":"<ol> <li>\u963b\u585e\u7684take\u548cput\u65b9\u6cd5\uff0c\u4ee5\u53ca\u652f\u6301\u5b9a\u65f6\u7684offer\u548cpoll\u65b9\u6cd5\uff1b</li> <li>\u652f\u6301\u4efb\u610f\u6570\u91cf\u7684\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\uff1b</li> <li>\u5728\u6784\u5efa\u9ad8\u53ef\u7528\u5e94\u7528\u65f6\uff0c\u6709\u754c\u961f\u5217\u662f\u79cd\u5f3a\u5927\u7684\u8d44\u6e90\u7ba1\u7406\u5de5\u5177\uff0c\u9632\u6b62\u5185\u5b58\u79fb\u9664\uff0c\u4ee3\u7801\u66f4\u52a0\u5065\u58ee\uff1b</li> </ol>"},{"location":"languages/java/collections.html#linkedblockingqueue","title":"LinkedBlockingQueue","text":"<ul> <li>\u57fa\u4e8e\u94fe\u8868\u5b9e\u73b0\u7684\u963b\u585e\u961f\u5217\uff0cFIFO\uff1b</li> <li>\u8bfb\u53d6\u548c\u63d2\u5165\u64cd\u4f5c\u6240\u4f7f\u7528\u7684\u9501\u662f\u4e24\u4e2a\u4e0d\u540c\u7684lock\uff0c\u5b83\u4eec\u4e4b\u95f4\u7684\u64cd\u4f5c\u4e92\u76f8\u4e0d\u53d7\u5e72\u6270\uff0c\u56e0\u6b64\u4e24\u79cd\u64cd\u4f5c\u53ef\u4ee5\u5e76\u884c\u5b8c\u6210\uff0c\u56e0\u6b64\u5176\u541e\u5410\u91cf\u8f83\u9ad8\uff1b</li> </ul>"},{"location":"languages/java/collections.html#arrayblockingqueue","title":"ArrayBlockingQueue","text":"<ul> <li>\u57fa\u4e8e\u6570\u7ec4\u5b9e\u73b0\u7684\u963b\u585e\u961f\u5217\uff0cFIFO\uff1b</li> </ul>"},{"location":"languages/java/collections.html#priorityblockqueue","title":"PriorityBlockQueue","text":"<ul> <li>\u4f18\u5148\u7ea7\u6392\u5e8f\u7684Queue\uff0c\u652f\u6301\u81ea\u5b9a\u4e49\u7684\u6bd4\u8f83\u89c4\u5219\uff1b</li> </ul>"},{"location":"languages/java/collections.html#synchronousqueue","title":"SynchronousQueue","text":"<ul> <li>\u4e0d\u4e3a\u961f\u5217\u4e2d\u5143\u7d20\u7ef4\u62a4\u5b58\u50a8\u7a7a\u95f4\uff0c\u800c\u662f\u7ef4\u62a4\u4e00\u7ec4\u7ebf\u7a0b\u7b49\u5f85\u7740\u5c06\u5143\u7d20\u52a0\u5165\u6216\u79fb\u9664\u961f\u5217\uff1b</li> <li>put\u548ctake\u4f1a\u4e00\u76f4\u963b\u585e\uff0c\u77e5\u9053\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u51c6\u5907\u597d\u53c2\u4e0e\u5230\u4ea4\u4ed8\u79cd\uff1b</li> <li>\u4ec5\u5f53\u6709\u8db3\u591f\u591a\u7684\u6d88\u8d39\u8005\uff0c\u4e14\u603b\u6709\u4e00\u4e2a\u6d88\u8d39\u8005\u51c6\u5907\u597d\u83b7\u53d6\u4ea4\u4ed8\u7684\u5de5\u4f5c\u65f6\uff0c\u624d\u4f7f\u7528\uff1b</li> </ul>"},{"location":"languages/java/collections.html#linkedtransferqueue","title":"LinkedTransferQueue","text":"<ul> <li>\u57fa\u4e8eCAS\u64cd\u4f5c\u7684\u65e0\u9501\uff1b</li> <li>\u8ba9\u751f\u4ea7\u8005\u76f4\u63a5\u7ed9\u7b49\u5f85\u7684\u6d88\u8d39\u8005\u4f20\u9012\u4fe1\u606f\uff0c\u4e0d\u7528\u5c06\u5143\u7d20\u5b58\u50a8\u5230\u961f\u5217\uff1b</li> </ul>"},{"location":"languages/java/collections.html#blockingdeque","title":"BlockingDeque","text":"<ol> <li>\u53cc\u7aef\u963b\u585e\u961f\u5217\uff0c\u5728\u961f\u5217\u5934\u548c\u5c3e\u8fdb\u884c\u6570\u636e\u63d2\u5165\u548c\u79fb\u9664\uff1b</li> <li>\u9002\u7528\u4e8e\u201d\u5de5\u4f5c\u5bc6\u53d6\u201c\uff08work stealing\uff09\uff0c\u65e2\u662f\u751f\u4ea7\u8005\u53c8\u662f\u6d88\u8d39\u8005\u7684\u573a\u666f\uff1b</li> </ol> <p>\u5728 \u5de5\u4f5c\u5bc6\u53d6 \u6a21\u5f0f\u4e2d\uff0c\u6bcf\u4e2a\u6d88\u8d39\u8005\u6709\u5176\u5355\u72ec\u7684\u5de5\u4f5c\u961f\u5217\uff0c\u5982\u679c\u5b83\u5b8c\u6210\u4e86\u81ea\u5df1\u53cc\u7aef\u961f\u5217\u4e2d\u7684\u5168\u90e8\u5de5\u4f5c\uff0c\u90a3\u4e48\u5b83\u5c31\u53ef\u4ee5\u4ece\u5176\u4ed6\u6d88\u8d39\u8005\u7684\u53cc\u7aef\u961f\u5217\u672b\u5c3e\u79d8\u5bc6\u5730\u83b7\u53d6\u5de5\u4f5c\u3002</p> <ul> <li>\u591a\u4e2a\u7ebf\u7a0b\u4e0d\u4f1a\u56e0\u4e3a\u5728\u540c\u4e00\u4e2a\u5de5\u4f5c\u961f\u5217\u4e2d\u62a2\u5360\u5185\u5bb9\u53d1\u751f\u7ade\u4e89\uff1b</li> <li>\u5927\u591a\u6570\u65f6\u5019\uff0c\u53ea\u662f\u8bbf\u95ee\u81ea\u5df1\u7684\u53cc\u7aef\u961f\u5217\u3002\u5373\u4f7f\u8981\u8bbf\u95ee\u53e6\u4e00\u4e2a\u961f\u5217\u65f6\uff0c\u4e5f\u662f\u4ece\u961f\u5217\u7684\u5c3e\u90e8\u83b7\u53d6\u5de5\u4f5c\uff0c\u964d\u4f4e\u4e86\u961f\u5217\u4e0a\u7684\u7ade\u4e89\u7a0b\u5ea6\u3002</li> </ul>"},{"location":"languages/java/collections.html#linkedblockingdeque","title":"LinkedBlockingDeque","text":""},{"location":"languages/java/collections.html#concurrentlinkeddeque","title":"ConcurrentLinkedDeque","text":"<ul> <li>\u65e0\u754c\u7684\u53cc\u7aef\u961f\u5217\uff1b</li> </ul>"},{"location":"languages/java/effective_java.html","title":"Effective Java","text":"<p>\u82f1\u6587\u4e66\u7c4dPDF\u94fe\u63a5: Effective Java_3rd_2018.pdf</p>"},{"location":"languages/java/effective_java.html#_1","title":"\u521b\u5efa\u548c\u9500\u6bc1\u5bf9\u8c61","text":"<ul> <li>\u8003\u8651\u7528\u9759\u6001\u5de5\u5382\u65b9\u6cd5\u66ff\u6362\u6784\u9020\u5668</li> <li>\u5f53\u9047\u5230\u591a\u4e2a\u6784\u9020\u5668\u53c2\u6570\u65f6\u8003\u8651\u7528Builder\u66ff\u6362</li> <li>\u7528\u79c1\u6709\u6784\u9020\u5668\u6216\u8005\u679a\u4e3e\u7c7b\u578b\u5f3a\u5316\u5355\u4f8b\u5c5e\u6027</li> <li>\u901a\u8fc7\u79c1\u6709\u6784\u9020\u5668\u5f3a\u5316\u4e0d\u53ef\u5b9e\u4f8b\u5316\u7684\u80fd\u529b </li> <li>\u4f9d\u8d56\u6ce8\u5165\u4f18\u5148\u786c\u8fde\u63a5\u8d44\u6e90</li> <li>\u907f\u514d\u521b\u5efa\u4e0d\u5fc5\u8981\u7684\u5bf9\u8c61</li> <li>\u6d88\u9664\u8fc7\u671f\u7684\u5bf9\u8c61\u5f15\u7528</li> <li>\u907f\u514d\u4f7f\u7528\u7ec8\u7ed3\u65b9\u6cd5\u548c\u6e05\u7406\u5668</li> <li>try-with-resources\u4f18\u5148try-finally</li> </ul>"},{"location":"languages/java/effective_java.html#_2","title":"\u6240\u6709\u5bf9\u8c61\u901a\u7528\u7684\u65b9\u6cd5","text":"<ul> <li> <p>\u8986\u5199equals\u65f6\u5019\u9075\u5b88\u901a\u7528\u89c4\u5b9a</p> </li> <li> <p>\u8986\u5199equals\u65f6\u5019\u603b\u8981\u8986\u5199hashCode</p> </li> <li> <p>\u59cb\u7ec8\u8986\u5199toString</p> </li> <li> <p>\u5c0f\u5fc3\u8986\u5199clone</p> </li> <li> <p>\u8003\u8651\u5b9e\u73b0Comparable\u63a5\u53e3</p> </li> </ul>"},{"location":"languages/java/effective_java.html#_3","title":"\u7c7b\u548c\u63a5\u53e3","text":"<ul> <li> <p>\u4f7f\u7c7b\u548c\u6210\u5458\u53ef\u89c1\u6027\u6700\u5c0f</p> </li> <li> <p>\u516c\u6709\u7c7b\u4e2d\u4f7f\u7528\u8bbf\u95ee\u65b9\u6cd5\u800c\u975e\u516c\u6709\u57df</p> </li> <li> <p>\u4f7f\u53ef\u53d8\u6027\u6700\u5c0f</p> </li> <li> <p>\u7ec4\u5408\u4f18\u4e8e\u7ee7\u627f </p> </li> <li> <p>\u8981\u4e48\u4e3a\u7ee7\u627f\u800c\u8bbe\u8ba1\u5e76\u63d0\u4f9b\u6587\u6863\uff0c\u8981\u4e48\u7981\u6b62\u7ee7\u627f</p> </li> <li> <p>\u63a5\u53e3\u4f18\u4e8e\u62bd\u8c61\u7c7b</p> </li> <li> <p>\u4e3a\u540e\u4ee3(posterity)\u8bbe\u8ba1\u63a5\u53e3</p> </li> <li> <p>\u63a5\u53e3\u53ea\u7528\u4e8e\u5b9a\u4e49\u7c7b\u578b</p> </li> <li> <p>\u7c7b\u7ee7\u627f\u4f18\u4e8e\u6807\u7b7e\u7c7b</p> </li> <li> <p>\u4f18\u5148\u8003\u8651\u9759\u6001\u7c7b\u800c\u4e0d\u662f\u975e\u9759\u6001</p> </li> <li> <p>\u5c06\u6e90\u6587\u4ef6\u9650\u5236\u4e3a\u5355\u4e2a\u9876\u7ea7\u7c7b</p> </li> </ul>"},{"location":"languages/java/effective_java.html#_4","title":"\u6cdb\u578b","text":"<ul> <li> <p>\u4e0d\u8981\u4f7f\u7528\u539f\u751f\u7c7b\u578b</p> </li> <li> <p>\u6d88\u9664\u975e\u53d7\u68c0\u8b66\u544a</p> </li> <li> <p>list\u4f18\u4e8e\u6570\u7ec4</p> </li> <li> <p>\u4f18\u5148\u8003\u8651\u6cdb\u578b</p> </li> <li> <p>\u4f18\u5148\u8003\u8651\u6cdb\u578b\u65b9\u6cd5</p> </li> <li> <p>\u4f7f\u7528\u6709\u754c\u901a\u914d\u7b26\u63d0\u5347API\u7684\u7075\u6d3b\u6027</p> </li> <li> <p>\u5c0f\u5fc3\u7ec4\u5408\u6cdb\u578b\u548c\u53ef\u53d8\u53c2\u6570  @</p> </li> <li> <p>\u4f18\u5148\u8003\u8651\u7c7b\u578b\u5b89\u5168\u7684\u5f02\u6784\u5bb9\u5668\u7b2c</p> </li> </ul>"},{"location":"languages/java/effective_java.html#_5","title":"\u679a\u4e3e\u548c\u6ce8\u89e3","text":"<ul> <li> <p>\u7528enum\u4ee3\u66ffint\u5e38\u91cf</p> </li> <li> <p>\u7528\u5b9e\u4f8b\u57df\u4ee3\u66ff\u5e8f\u6570</p> </li> <li> <p>\u7528EnumSet\u4ee3\u66ff\u4f4d\u57df</p> </li> <li> <p>\u7528EnumMap\u4ee3\u66ff\u5e8f\u6570\u7d22\u5f15</p> </li> <li> <p>\u7528\u63a5\u53e3\u6a21\u62df\u53ef\u6269\u5c55\u7684\u679a\u4e3e</p> </li> <li> <p>\u6ce8\u89e3\u4f18\u4e8e\u547d\u540d\u6a21\u5f0f</p> </li> <li> <p>\u7edf\u4e00\u4f7f\u7528Override\u6ce8\u89e3</p> </li> <li> <p>\u7528\u6807\u8bb0\u63a5\u53e3\u5b9a\u4e49\u7c7b\u578b</p> </li> </ul>"},{"location":"languages/java/effective_java.html#lambda","title":"Lambda\u8868\u8fbe\u5f0f\u548c\u6d41 @","text":"<ul> <li>Lambda\u8868\u8fbe\u5f0f\u4f18\u4e8e\u533f\u540d\u7c7b</li> <li>lambda\u7684\u5e8f\u5217\u5316</li> <li>\u65b9\u6cd5\u5f15\u7528\u4f18\u4e8eLambda\u8868\u8fbe\u5f0f</li> <li>\u4f18\u5148\u4f7f\u7528\u6807\u51c6\u7684\u51fd\u6570\u5f0f\u63a5\u53e3</li> <li>\u5c0f\u5fc3\u4f7f\u7528\u6d41</li> <li>\u6d41\u4e2d\u4f18\u5148\u4f7f\u7528\u65e0\u526f\u4f5c\u7528\u7684\u51fd\u6570</li> <li>Collection\u4f18\u5148\u6d41\u4f5c\u4e3a\u8fd4\u56de\u7c7b\u578b</li> <li>\u5f53\u521b\u5efa\u5e76\u884c\u6d41\u7684\u65f6\u5019\u5c0f\u5fc3\u4e9b</li> </ul>"},{"location":"languages/java/effective_java.html#_6","title":"\u65b9\u6cd5","text":"<ul> <li>\u68c0\u67e5\u53c2\u6570\u7684\u6709\u6548\u6027</li> <li>\u9700\u8981\u65f6\u8fdb\u884c\u4fdd\u62a4\u6027\u62f7\u8d1d</li> <li>\u5c0f\u5fc3\u8bbe\u8ba1\u65b9\u6cd5\u7b7e\u540d</li> <li>\u8c28\u614e\u4f7f\u7528\u91cd\u8f7d</li> <li>\u8c28\u614e\u53ef\u53d8\u53c2\u6570</li> <li>\u8fd4\u56de\u7a7a\u96c6\u5408\u6216\u8005\u6570\u7ec4\uff0c\u800c\u4e0d\u662fnull</li> <li>\u8c28\u614e\u8fd4\u56deOptionals  @ </li> <li>\u4e3a\u6240\u6709\u5bfc\u51fa\u7684API\u5143\u7d20\u5199\u6587\u6863\u6ce8\u91ca</li> </ul>"},{"location":"languages/java/effective_java.html#_7","title":"\u901a\u7528\u7a0b\u5e8f\u8bbe\u8ba1","text":"<ul> <li>\u6700\u5c0f\u5316\u5c40\u90e8\u53d8\u91cf\u4f5c\u7528\u57df</li> <li>for each\u4f18\u4e8e\u4f20\u7edffor\u5faa\u73af</li> <li>\u4e86\u89e3\u548c\u4f7f\u7528\u7c7b\u5e93</li> <li>\u5982\u679c\u9700\u8981\u7cbe\u786e\u7b54\u6848\uff0c\u907f\u514d\u4f7f\u7528float\u548cdouble</li> <li>\u57fa\u672c\u7c7b\u578b\u4f18\u4e8e\u88c5\u7bb1\u7c7b\u578b</li> <li>\u5982\u679c\u5176\u4ed6\u7c7b\u578b\u66f4\u5408\u9002\uff0c\u907f\u514d\u4f7f\u7528String</li> <li>\u5c0f\u5fc3String\u8fde\u63a5\u6027\u80fd</li> <li>\u901a\u8fc7\u63a5\u53e3\u5f15\u7528\u5bf9\u8c61</li> <li>\u63a5\u53e3\u4f18\u4e8e\u53cd\u5c04</li> <li>\u8c28\u614e\u4f7f\u7528\u672c\u5730\u65b9\u6cd5</li> <li>\u8c28\u614e\u4f18\u5316</li> <li>\u9075\u5b88\u666e\u904d\u7684\u547d\u540d\u89c4\u8303</li> </ul>"},{"location":"languages/java/effective_java.html#_8","title":"\u5f02\u5e38","text":"<ul> <li>\u53ea\u9488\u5bf9\u5f02\u5e38\u60c5\u51b5\u624d\u4f7f\u7528\u5f02\u5e38</li> <li>\u5bf9\u53ef\u6062\u590d\u7684\u60c5\u51b5\u4f7f\u7528\u53d7\u68c0\u5f02\u5e38\uff0c\u5bf9\u7f16\u7a0b\u9519\u8bef\u4f7f\u7528\u8fd0\u884c\u65f6\u5f02\u5e38</li> <li>\u907f\u514d\u4e0d\u5fc5\u8981\u4f7f\u7528\u53d7\u68c0\u5f02\u5e38</li> <li>\u4f18\u5148\u4f7f\u7528\u6807\u51c6\u5f02\u5e38</li> <li>\u629b\u51fa\u4e0e\u62bd\u8c61\u5bf9\u5e94\u7684\u5f02\u5e38</li> <li>\u6bcf\u4e2a\u65b9\u6cd5\u629b\u51fa\u5f02\u5e38\u8981\u6709\u6587\u6863</li> <li>\u5728\u7ec6\u8282\u4fe1\u606f\u4e2d\u5305\u542b\u6355\u83b7\u5931\u8d25\u7684\u4fe1\u606f</li> <li>\u52aa\u529b\u4f7f\u5931\u8d25\u4fdd\u6301\u539f\u5b50\u6027</li> <li>\u4e0d\u8981\u5ffd\u7565\u5f02\u5e38</li> </ul>"},{"location":"languages/java/effective_java.html#_9","title":"\u5e76\u53d1","text":"<ul> <li> <p>\u540c\u6b65\u8bbf\u95ee\u5171\u4eab\u53ef\u53d8\u6570\u636e</p> </li> <li> <p>\u907f\u514d\u8fc7\u5ea6\u540c\u6b65</p> </li> <li>executors\uff0ctask\uff0cstream\u4f18\u4e8e\u7ebf\u7a0b  @</li> <li>\u5e76\u53d1\u5de5\u5177\u4f18\u4e8ewait\u548cnotify</li> <li>\u7ebf\u7a0b\u5b89\u5168\u6587\u6863\u5316</li> <li>\u614e\u7528\u5ef6\u8fdf\u521d\u59cb\u5316</li> <li>\u4e0d\u8981\u4f9d\u8d56\u7ebf\u7a0b\u8c03\u5ea6\u5668</li> </ul>"},{"location":"languages/java/effective_java.html#_10","title":"\u5e8f\u5217\u5316","text":"<ul> <li> <p>\u8003\u8651\u5176\u4ed6\u53ef\u9009\u62e9\u4f18\u4e8eJava\u5e8f\u5217\u5316  @</p> </li> <li> <p>\u8003\u8651\u4f7f\u7528\u81ea\u5b9a\u4e49\u5e8f\u5217\u5316\u5f62\u5f0f</p> </li> <li> <p>\u8c28\u614e\u5b9e\u73b0Serializable\u63a5\u53e3</p> </li> <li> <p>\u4fdd\u62a4\u6027\u7f16\u5199readObject\u65b9\u6cd5</p> </li> <li> <p>\u5bf9\u4e8e\u5b9e\u4f8b\u63a7\u5236\uff0c\u679a\u4e3e\u4f18\u4e8ereadResolve</p> </li> <li> <p>\u8003\u8651\u5e8f\u5217\u5316\u4ee3\u7406\u66ff\u6362\u5e8f\u5217\u5316\u5b9e\u4f8b</p> </li> </ul>"},{"location":"languages/java/effective_java.html#_11","title":"\u8bfb\u4e66\u8bb0\u5f55","text":"<ul> <li> <p>\u6d88\u9664\u8fc7\u671f\u7684\u5f15\u7528\u5bf9\u8c61**\uff1a\u9632\u6b62\u5185\u5b58\u6cc4\u9732\uff08\u5f53\u81ea\u884c\u7ba1\u7406\u7f13\u5b58\u65f6\uff09</p> </li> <li> <ul> <li>\u5b9e\u4f8b\uff1a\u6570\u7ec4\u5b9e\u73b0\u6808\uff0cpop\u7684\u65f6\u5019\uff0c\u5220\u9664\u7684\u4f4d\u7f6e\u6ca1\u6709\u91cd\u65b0\u8d4b\u503c\u4e3anull\uff1b</li> </ul> </li> <li> <p>\u5bf9\u4e8e\u7f13\u5b58(\u7f13\u5b58\u9879\u751f\u547d\u5468\u671f\u7531\u952e\u7684\u5916\u90e8\u5f15\u7528\u51b3\u5b9a\u65f6)\uff0c\u53ef\u4e0e\u4f7f\u7528<code>WeakHashMap</code>\u89e3\u51b3\uff1b</p> </li> <li> <p>Equals\u65b9\u6cd5\u8986\u76d6\uff1a\u81ea\u53cd\u6027\u3001\u5bf9\u79f0\u6027\u3001\u4f20\u9012\u6027\u3001\u4e00\u81f4\u6027\uff0c\u4e14\u9700\u8981\u91cd\u8f7d<code>hashCode</code>\u65b9\u6cd5\uff1b</p> </li> </ul> <p>\u65e0\u6cd5\u5728\u6269\u5c55\u53ef\u5b9e\u4f8b\u5316\u7684\u7c7b\u7684\u540c\u65f6\uff0c\u65e2\u589e\u52a0\u65b0\u7684\u503c\u7ec4\u4ef6\uff0c\u540c\u65f6\u4fdd\u7559equals\u7ea6\u5b9a</p> <ul> <li>\u4f20\u9012\u6027(ColorPoint\u548cPoint)\u548c\u91cc\u6c0f\u66ff\u6362\u539f\u5219\u65e0\u6cd5\u540c\u65f6\u6ee1\u8db3\uff1b</li> <li>\u53ef\u4ee5\u901a\u8fc7\u7ec4\u5408\u800c\u4e0d\u662f\u7ee7\u627f\u7684\u65b9\u5f0f\u8fdb\u884c\u6269\u5c55\uff1b</li> <li> <p>\u53ef\u4ee5\u5728\u62bd\u8c61\u7684\u5b50\u7c7b\u4e2d\u6dfb\u52a0\u65b0\u7684\u503c\u7ec4\u4ef6\uff1b</p> </li> <li> <p>CompareTo\uff1a</p> </li> <li> <p>\u4f7f\u7528<code>Float.compare</code>\u548c<code>Double.compare</code>\u8fdb\u884c\u6570\u503c\u6bd4\u8f83\uff1b</p> </li> <li> <p>\u5efa\u8bae\u5b9e\u73b0<code>x.compareTo(y) == x.equals(y)</code></p> </li> <li> <p>\u5728\u516c\u6709\u7c7b\u65b9\u6cd5\u4e2d\u4f7f\u7528\u516c\u6709\u65b9\u6cd5\u800c\u4e0d\u662f\u516c\u6709\u57df</p> </li> <li> <p>\u7c7b\u662f\u5916\u90e8\u53ef\u4ee5\u8bbf\u95ee\u7684\uff0c\u5fc5\u987b\u4f7f\u7528\u516c\u6709\u65b9\u6cd5\uff0c\u4e0d\u80fd\u5bf9\u5916\u63d0\u4f9b\u5171\u6709\u57df\uff1b</p> </li> <li> <p>\u5982\u679c\u7c7b\u662f\u5185\u90e8\u79c1\u6709\uff0c\u6216\u8005\u79c1\u6709\u7684\u5185\u90e8\u7c7b\uff0c\u53ef\u4ee5\u76f4\u63a5\u66b4\u9732\u5176\u6570\u636e\u57df\uff08\u5982\u679c\u8fd9\u4e9b\u6570\u636e\u57df\u786e\u5b9e\u63cf\u8ff0\u8be5\u7c7b\u63d0\u4f9b\u7684\u62bd\u8c61\uff09</p> </li> <li> <p>\u590d\u5408\u4f18\u5148\u7ee7\u627f</p> </li> <li> <p>\u5728\u5305\u7684\u5185\u90e8\u4f7f\u7528\u7ee7\u627f\u662f\u5b89\u5168\u7684\uff0c\u53ea\u6709\u5f53\u5b50\u7c7b\u771f\u6b63\u662f\u8d85\u7c7b\u7684\u5b50\u7c7b\u578b\u65f6\uff1b</p> </li> <li> <p>\u4f7f\u7528\u7b2c\u4e09\u65b9\u5305\u63d0\u4f9b\u670d\u52a1\uff0c\u4f7f\u7528\u7ec4\u5408\uff1b</p> </li> <li> <p>\u63a5\u53e3\u4f18\u4e8e\u62bd\u8c61\u7c7b</p> </li> </ul>"},{"location":"languages/java/effective_java.html#_12","title":"\u6cdb\u578b","text":"<ul> <li>? \u8868\u793a\u4efb\u610f\u7c7b\u578b</li> <li>Set\\"},{"location":"languages/java/effective_java.html#_13","title":"Effective Java","text":""},{"location":"languages/java/effective_java.html#_14","title":"Effective Java","text":""},{"location":"languages/java/effective_java.html#_15","title":"Effective Java","text":""},{"location":"languages/java/effective_java.html#_16","title":"Effective Java","text":""},{"location":"languages/java/effective_java.html#_17","title":"Effective Java","text":""},{"location":"languages/java/effective_java.html#_18","title":"Effective Java","text":""},{"location":"languages/java/gc.html","title":"GC\u4e0e\u5185\u5b58","text":""},{"location":"languages/java/gc.html#_1","title":"\u5f15\u7528\u7c7b\u578b","text":""},{"location":"languages/java/gc.html#_2","title":"\u5f3a\u5f15\u7528","text":"<p>\u666e\u901a\u5bf9\u8c61\u5f15\u7528\uff0c\u6709\u5f3a\u5f15\u7528\u6307\u5411\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5c31\u8868\u660e\u6b64\u5bf9\u8c61\u8fd8\u201c\u6d3b\u7740\u201d\uff0c\u65e0\u6cd5\u88ab GC\u3002</p>"},{"location":"languages/java/gc.html#_3","title":"\u8f6f\u5f15\u7528","text":"<p>\u63cf\u8ff0\u4e00\u4e9b\u8fd8\u6709\u7528\u4f46\u5e76\u975e\u5fc5\u9700\u7684\u5bf9\u8c61</p> <p>\u5f53JVM\u8ba4\u5b9a\u5185\u5b58\u7a7a\u95f4\u4e0d\u8db3\u65f6\u624d\u4f1a\u53bb\u56de\u6536\u8f6f\u5f15\u7528\u6307\u5411\u7684\u5bf9\u8c61</p> <ul> <li>\u4f7f\u7528\u8f6f\u5f15\u7528\u7684\u65f6\u5019\u5fc5\u987b\u68c0\u67e5\u5f15\u7528\u662f\u5426\u4e3anull\uff1b</li> </ul> <pre><code>Object obj = new Object();\nSoftReference&lt;Object&gt; sf = new SoftReference&lt;Object&gt;(obj);\nobj = null;\n// \u6709\u65f6\u5019\u4f1a\u8fd4\u56denull\nsf.get();\u3000\n</code></pre>"},{"location":"languages/java/gc.html#_4","title":"\u5f31\u5f15\u7528","text":"<p>\u5f31\u5f15\u7528\u4e0e\u8f6f\u5f15\u7528\u6700\u5927\u7684\u533a\u522b\u5c31\u662f\u5f31\u5f15\u7528\u6bd4\u8f6f\u5f15\u7528\u7684\u751f\u547d\u5468\u671f\u66f4\u77ed\u6682\u3002</p> <p>\u5783\u573e\u56de\u6536\u5668\u4f1a\u626b\u63cf\u5b83\u6240\u7ba1\u8f96\u7684\u5185\u5b58\u533a\u57df\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53ea\u8981\u53d1\u73b0\u5f31\u5f15\u7528\u7684\u5bf9\u8c61\uff0c\u4e0d\u7ba1\u5185\u5b58\u7a7a\u95f4\u662f\u5426\u6709\u7a7a\u95f2\uff0c\u90fd\u4f1a\u7acb\u523b\u56de\u6536\u5b83\u3002</p> <pre><code>Object obj = new Object();\nWeakReference&lt;Object&gt; wf = new WeakReference&lt;Object&gt;(obj);\nobj = null;\n//\u6709\u65f6\u5019\u4f1a\u8fd4\u56denull\nwf.get();\n//\u8fd4\u56de\u662f\u5426\u88ab\u5783\u573e\u56de\u6536\u5668\u6807\u8bb0\u4e3a\u5373\u5c06\u56de\u6536\u7684\u5783\u573e\nwf.isEnQueued();\n</code></pre>"},{"location":"languages/java/gc.html#_5","title":"\u5e7b\u8c61\u5f15\u7528","text":"<p>\u5e7b\u8c61\u5f15\u7528\u5e76\u4e0d\u4f1a\u51b3\u5b9a\u5bf9\u8c61\u7684\u751f\u547d\u5468\u671f\u3002\u5373\u5982\u679c\u4e00\u4e2a\u5bf9\u8c61\u4ec5\u6301\u6709\u865a\u5f15\u7528\uff0c\u5c31\u76f8\u5f53\u4e8e\u6ca1\u6709\u4efb\u4f55\u5f15\u7528\u4e00\u6837\uff0c\u5728\u4efb\u4f55\u65f6\u5019\u90fd\u53ef\u80fd\u88ab\u5783\u573e\u56de\u6536\u5668\u56de\u6536\u3002</p> <ul> <li>\u4e0d\u80fd\u901a\u8fc7\u5b83\u8bbf\u95ee\u5bf9\u8c61</li> </ul> <pre><code>Object obj = new Object();\nPhantomReference&lt;Object&gt; pf = new PhantomReference&lt;Object&gt;(obj);\nobj=null;\n//\u6c38\u8fdc\u8fd4\u56denull\npf.get();\n//\u8fd4\u56de\u662f\u5426\u4ece\u5185\u5b58\u4e2d\u5df2\u7ecf\u5220\u9664\npf.isEnQueued();\u3000\n</code></pre>"},{"location":"languages/java/gc.html#_6","title":"\u5185\u5b58\u5e03\u5c40","text":"<ul> <li>\u7a0b\u5e8f\u8ba1\u6570\u5668</li> <li>\u5f53\u524d\u7ebf\u7a0b\u6240\u6267\u884c\u7684\u5b57\u8282\u7801\u7684\u884c\u53f7\u6307\u793a\u5668\uff0c\u7ebf\u7a0b\u79c1\u6709\uff1b</li> <li>Java\u865a\u62df\u673a\u6808</li> <li>\u7ebf\u7a0b\u79c1\u6709\uff0c\u63cf\u8ff0Java\u65b9\u6cd5\u6267\u884c\u7684\u5185\u5b58\u6a21\u578b\uff1b</li> <li>\u4e3a\u65b9\u6cd5\u521b\u5efa\u6808\u5e27(Stack Frame)\uff0c\u65b9\u6cd5\u6240\u9700\u7684\u6808\u5e27\u7684\u5c40\u90e8\u53d8\u91cf\u7a7a\u95f4\u5b8c\u5168\u786e\u5b9a\uff1b</li> <li>\u6808\u6df1\u5ea6\u8fc7\u6df1\uff0cStackOverFlowError\u5f02\u5e38\uff1bJVM\u53ef\u4ee5\u52a8\u6001\u6269\u5c55\u6808\uff0c\u5219\u62a5OutofMemoryError\u5f02\u5e38\uff1b</li> <li>\u672c\u5730\u65b9\u6cd5\u6808</li> <li>\u4e3aNative\u65b9\u6cd5\u521b\u5efa\u6808\u5e27\uff0cStackOverFlowError\u548cOutOfMemoryError\u5f02\u5e38\uff1b</li> <li>\u672a\u5bf9\u5176\u4f7f\u7528\u8bed\u8a00\u3001\u65b9\u5f0f\u3001\u6570\u636e\u7ed3\u6784\u5f3a\u5236\u89c4\u5b9a\uff0c\u5982Sun     HotSpot\u865a\u62df\u673a\u76f4\u63a5\u628a\u672c\u5730\u65b9\u6cd5\u6808\u548c\u865a\u62df\u673a\u6808\u5408\u4e8c\u4e3a\u4e00\uff1b</li> <li>\u5806\uff08heap\u533a\uff09\uff1a<code>-Xmx, -Xms</code>\u63a7\u5236\u6700\u5927\u5185\u5b58\u548c\u521d\u59cb\u5185\u5b58</li> <li>\u65b9\u6cd5\u533a</li> <li>\u4fdd\u5b58\u865a\u62df\u673a\u52a0\u8f7d\u7684\u7c7b\u4fe1\u606f\u3001\u5e38\u91cf\u3001\u9759\u6001\u53d8\u91cf\u3001\u5373\u65f6\u7f16\u8bd1\u5668\u7f16\u8bd1\u540e\u4ee3\u7801\u7b49\uff1b</li> <li>\u5783\u573e\u56de\u6536\u4e3b\u8981\u9488\u5bf9\u5e38\u91cf\u6c60\u56de\u6536\u548c\u5bf9\u7c7b\u578b\u5378\u8f7d\uff1b</li> <li>\u76f4\u63a5\u5185\u5b58</li> <li>\u4e0d\u5c5e\u4e8e\u865a\u62df\u673a\u8fd0\u884c\u65f6\u6570\u636e\u533a\uff0c\u4e0d\u662fJava\u865a\u62df\u673a\u89c4\u8303\u4e2d\u5b9a\u4e49\u7684\u5185\u5b58\u533a\u57df\uff1b</li> <li><code>-XX:MaxDirectMemorySize</code>\uff0c\u9ed8\u8ba4\u4e0eJava\u5806\u6700\u5927\u503c\u4e00\u6837\uff1b</li> <li>\u907f\u514d\u5728Java\u5806\u548cNative\u5806\u6765\u56de\u590d\u5236\u6570\u636e\uff1b</li> </ul>"},{"location":"languages/java/gc.html#gc_1","title":"GC \u7b56\u7565","text":""},{"location":"languages/java/gc.html#jdkgc","title":"\u67e5\u770bJDK\u9ed8\u8ba4\u7684GC\u7b56\u7565","text":"<pre><code>$ java -XX:+PrintCommandLineFlags -version\n</code></pre>"},{"location":"languages/java/gc.html#serial","title":"Serial\uff08\u5355\u7ebf\u7a0b\uff09","text":"<p>\u590d\u5236\u7b97\u6cd5</p> <ul> <li> <p>JDK1.3.1\u4e4b\u524d\u7684\u65b0\u751f\u4ee3\u6536\u96c6\u5668\uff1b</p> </li> <li> <p>\u5355\u7ebf\u7a0b\u6536\u96c6\u5668\uff0cStop-the-world\uff1b</p> </li> <li> <p>Client \u6a21\u5f0f\u65b0\u751f\u4ee3\u9ed8\u8ba4\u6536\u96c6\u5668\uff1b</p> </li> </ul>"},{"location":"languages/java/gc.html#parnew","title":"ParNew(\u5e76\u884c\u56de\u6536)","text":"<p>-XX:UseParNewGC</p> <p>Serial \u7684\u591a\u7ebf\u7a0b\u7248</p> <ul> <li>Server \u6a21\u5f0f\u4e0b\u7684 \u65b0\u751f\u4ee3\u7684\u9ed8\u8ba4\u5783\u573e\u6536\u96c6\u5668</li> </ul>"},{"location":"languages/java/gc.html#parallel-scavengejdk-8","title":"Parallel Scavenge(\u541e\u5410\u91cf\u4f18\u5148\uff0cJDK 8\u9ed8\u8ba4)","text":"<p>-XX:+UseParallelGC</p> <p>\u590d\u5236\u7b97\u6cd5\uff1a</p> <ul> <li>\u5173\u6ce8\u541e\u5410\u91cf=\u8fd0\u884c\u4ee3\u7801\u65f6\u95f4 /\uff08\u8fd0\u884c\u4ee3\u7801\u65f6\u95f4 +\u5783\u573e\u6536\u96c6\u65f6\u95f4\uff09\uff0c\u540e\u53f0\u5e94\u7528\uff1b</li> <li><code>-XX:MaxGCPauseMills\uff0c-XX:GCTimeRatio</code>\u8bbe\u7f6eGC\u65f6\u95f4\u548c\u541e\u5410\u91cf\uff1b</li> <li>\u81ea\u9002\u5e94\u8c03\u8282\u7b56\u7565\uff1a<code>-XX:+UseAdaptiveSizePolicy</code></li> </ul>"},{"location":"languages/java/gc.html#serial-old","title":"Serial Old","text":"<p>\u6807\u8bb0-\u6574\u7406\u7b97\u6cd5</p> <ul> <li> <p>\u5355\u7ebf\u7a0b\u6536\u96c6\u5668\uff0cClient\u6a21\u5f0f\u4f7f\u7528\uff1b</p> </li> <li> <p>Server\u6a21\u5f0f\uff0c1\uff09JDK1.5\u4e4b\u524d\u4e0eParallel Scavenge\u4f7f\u7528\uff1b2\uff09\u4f5c\u4e3aCMS\u540e\u5907\u9884\u6848\uff0c\u5e76\u53d1\u6536\u96c6\u5668\u5931\u8d25\u65f6\u4f7f\u7528\uff1b</p> </li> </ul>"},{"location":"languages/java/gc.html#parallel-old","title":"Parallel Old","text":"<p>\u6807\u8bb0-\u6574\u7406\u7b97\u6cd5</p> <ul> <li> <p>\u591a\u7ebf\u7a0b\uff0cJDK1.6\u4e4b\u540e\uff08\u6765\u6e90\u4e8eParallel Scavenge\u5bf9\u8001\u5e74\u4ee3\u5e76\u884c\u56de\u6536\u7684\u9700\u8981\uff09\uff1b</p> </li> <li> <p>\u6ce8\u91cd\u541e\u5410\u91cf\u548cCPU\u8d44\u6e90\u654f\u611f\uff0c\u4f7f\u7528Parallel Scavenge + Parallel Old\uff1b</p> </li> </ul>"},{"location":"languages/java/gc.html#concurrent-mark-sweepjdk9","title":"Concurrent-Mark-Sweep(\u4f4e\u5ef6\u8fdf\uff0cJDK9\u5e9f\u5f03)","text":"<p>CMS \u662f\u4e00\u79cd\u9ad8\u5ea6\u53ef\u914d\u7f6e\u7684\u590d\u6742\u7b97\u6cd5\uff0c\u56e0\u6b64\u7ed9 JDK \u4e2d\u7684 GC\u4ee3\u7801\u5e93\u5e26\u6765\u4e86\u5f88\u591a\u590d\u6742\u6027\u3002</p> <p>\u6807\u8bb0-\u6e05\u9664\u7b97\u6cd5</p> <ul> <li> <p>\u6700\u77ed\u56de\u6536\u505c\u987f\u65f6\u95f4\uff0c\u4ea4\u4e92\u5f0f\u5e94\u7528\uff1b</p> </li> <li> <p>\u521d\u59cb\u6807\u8bb0 -&gt; \u5e76\u53d1\u6807\u8bb0 -&gt; \u91cd\u65b0\u6807\u8bb0 -&gt; \u5e76\u53d1\u6e05\u9664\uff1a</p> </li> <li> <ul> <li>\u521d\u59cb\u6807\u8bb0\u548c\u91cd\u65b0\u6807\u8bb0\u9700\u8981Stop-The-World\uff1b</li> </ul> </li> <li>\u521d\u59cb\u6807\u8bb0\uff1a\u6807\u8bb0GC Roots\u80fd\u76f4\u63a5\u5173\u8054\u7684\u5bf9\u8c61\uff1b\u5355\u7ebf\u7a0b</li> <li>\u5e76\u53d1\u6807\u8bb0\uff1a\u8fdb\u884cGC Roots Tracing\u7684\u8fc7\u7a0b\uff1b\u591a\u7ebf\u7a0b</li> <li>\u91cd\u65b0\u6807\u8bb0\uff1a\u4fee\u6b63\u5e76\u53d1\u6807\u8bb0\u671f\u95f4\u56e0\u7528\u6237\u7a0b\u5e8f\u7ee7\u7eed\u8fd0\u884c\u9020\u6210\u6807\u8bb0\u53d8\u52a8\u7684\u5bf9\u8c61\u7684\u6807\u8bb0\u8bb0\u5f55\uff1b</li> </ul> <p>\u7f3a\u70b9\uff1a</p> <ul> <li>\u5bf9CPU\u8d44\u6e90\u654f\u611f\uff1b</li> <li>\u65e0\u6cd5\u5904\u7406\u6d6e\u52a8\u5783\u573e\uff08CMS\u8fd0\u884c\u671f\u95f4\u8001\u5e74\u4ee3\u9884\u7559\u5185\u5b58\u4e0d\u591f\uff0c\u5bfc\u81f4Seria Old\u8fdb\u884c\u8001\u5e74\u4ee3\u6536\u96c6\uff09\uff1b</li> <li>\u6807\u8bb0-\u6e05\u9664\u7b97\u6cd5\u5e26\u6765\u788e\u7247\uff0c<code>-XX:+UseCMSCompactAtFullCollection</code> \u5728CMS\u8981\u8fdb\u884cFull GC\u65f6\u5f00\u542f\u5185\u5b58\u788e\u7247\u6574\u7406\uff1b</li> </ul>"},{"location":"languages/java/gc.html#garbage-firstg1jdk-9","title":"Garbage First\uff08G1\uff0cJDK 9\u9ed8\u8ba4\uff09","text":"<p>\u548c\u4e4b\u524d\u7684\u5404\u7c7b\u56de\u6536\u5668\u4e0d\u540c\uff0c\u5b83\u540c\u65f6<code>\u517c\u987e\u5e74\u8f7b\u4ee3\u548c\u8001\u5e74\u4ee3</code>\u3002\u5bf9\u6bd4\u5176\u4ed6\u56de\u6536\u5668\uff0c\u6216\u8005\u5de5\u4f5c\u5728\u5e74\u8f7b\u4ee3\uff0c\u6216\u8005\u5de5\u4f5c\u5728\u8001\u5e74\u4ee3\u3002</p> <p><code>G1\u4f9d\u7136\u5c5e\u4e8e\u5206\u4ee3\u578b\u5783\u573e\u56de\u6536\u5668</code>\uff0c\u5b83\u4f1a\u533a\u5206\u5e74\u8f7b\u4ee3\u548c\u8001\u5e74\u4ee3\uff0c\u5e74\u8f7b\u4ee3\u4f9d\u7136\u6709Eden\u533a\u548cSurvivor\u533a\u3002\u4f46\u4ece\u5806\u7684\u7ed3\u6784\u4e0a\u770b\uff0c\u5b83\u4e0d\u8981\u6c42\u6574\u4e2aEden\u533a\u3001\u5e74\u8f7b\u4ee3\u6216\u8005\u8001\u5e74\u4ee3\u90fd\u662f\u8fde\u7eed\u7684\uff0c\u4e5f\u4e0d\u518d\u575a\u6301\u56fa\u5b9a\u5927\u5c0f\u548c\u56fa\u5b9a\u6570\u91cf\u3002</p> <p></p> <ul> <li>\u5e76\u884c\u4e0e\u5e76\u53d1\u3001\u5206\u4ee3\u6536\u6536\u96c6\u3001\u7a7a\u95f4\u6574\u5408\uff08\u65e0\u788e\u7247\uff09\u3001\u53ef\u9884\u6d4b\u7684\u505c\u987f\uff08\u65f6\u95f4\u6a21\u578b\uff09\uff1b</li> <li>\u5c06\u5806\u5212\u5206\u4e3a\u5927\u5c0f\u76f8\u7b49\u7684\u591a\u4e2a Region\uff0c\u6bcf\u6b21\u56de\u6536\u4ef7\u503c\u6700\u5927\u7684Region\uff08\u56de\u6536\u7a7a\u95f4\u5927\u5c0f\u4ee5\u53ca\u6240\u9700\u65f6\u95f4\u7ecf\u9a8c\u503c\uff09\uff1b</li> <li>\u6bcf\u4e2aRegion\u6709\u5bf9\u5e94\u7684Remembered     Set\uff08\u907f\u514d\u5168\u5806\u626b\u63cf\uff09\uff0c\u5f53\u7a0b\u5e8f\u5bf9\u5f15\u7528\u7c7b\u578b\u6570\u636e\u5199\u64cd\u4f5c\u65f6\uff0c\u4ea7\u751fWrite Barrier\u4e2d\u65ad\u5199\u64cd\u4f5c\uff0c\u68c0\u67e5\u5f15\u7528\u5bf9\u8c61\u662f\u5426\u5904\u4e8e\u4e0d\u540cRegion\uff08\u5206\u4ee3\u4e2d\u5c31\u662f\u68c0\u67e5\u662f\u5426\u8001\u5e74\u4ee3\u5bf9\u8c61\u5f15\u7528\u65b0\u751f\u4ee3\u5bf9\u8c61\uff09\uff0c\u662f\u5219\u6709CardTable\u5c06\u5f15\u7528\u4fe1\u606f\u52a0\u5165\u88ab\u5f15\u7528\u5bf9\u8c61\u6240\u5c5eRegion\u7684Remembered     Set\u4e2d\u3002GC\u6839\u8282\u70b9\u679a\u4e3e\u65f6\u52a0\u5165Remembered Set\u907f\u514d\u5168\u5806\u626b\u63cf\uff1b</li> </ul>"},{"location":"languages/java/gc.html#zgcgc","title":"ZGC(\u4f4e\u5ef6\u8fdfGC)","text":""},{"location":"languages/java/gc.html#jvmgc","title":"JVM\u7684GC\u7ebf\u7a0b\u6570\u7684\u8ba1\u7b97","text":""},{"location":"languages/java/gc.html#gc_2","title":"GC \u7b97\u6cd5","text":""},{"location":"languages/java/gc.html#_7","title":"\u5f15\u7528\u8ba1\u6570\u6cd5","text":"<p>\u5faa\u73af\u5f15\u7528\u95ee\u9898\uff1a\u53ef\u8fbe\u6027\u5206\u6790\uff1a</p> <ul> <li> <p>\u4eceGC Roots\u6cbf\u7740\u5f15\u7528\u94fe\uff0c\u5224\u65ad\u5bf9\u8c61\u53ef\u8fbe\u4e0e\u5426\uff1b</p> </li> <li> <p>GC Roots \uff1a</p> </li> <li>\u865a\u62df\u673a\u6808\uff08\u6808\u5e27\u4e2d\u7684\u672c\u5730\u53d8\u91cf\u8868\uff09\u4e2d\u5f15\u7528\u7684\u5bf9\u8c61\uff1b</li> <li>\u65b9\u6cd5\u533a\u4e2d\u7c7b\u9759\u6001\u5c5e\u6027\u5f15\u7528\u7684\u5bf9\u8c61\uff1b</li> <li>\u65b9\u6cd5\u533a\u4e2d\u5e38\u91cf\u5f15\u7528\u7684\u5bf9\u8c61\uff1b</li> <li>\u672c\u5730\u65b9\u6cd5\u6808\u4e2dJNI\uff08Native\u65b9\u6cd5\uff09\u5f15\u7528\u7684\u5bf9\u8c61\uff1b</li> </ul>"},{"location":"languages/java/gc.html#-","title":"\u6807\u8bb0-\u6e05\u7406\u7b97\u6cd5","text":"<p>\u6807\u8bb0\u56de\u6536\u7684\u5bf9\u8c61\uff0c\u6e05\u7406\u8fd9\u4e9b\u5bf9\u8c61\uff1b</p> <ul> <li>\u6807\u8bb0\u3001\u6e05\u7406\u6548\u7387\u4e0d\u9ad8\uff1b\u4ea7\u751f\u5185\u5b58\u788e\u7247\uff1b</li> </ul>"},{"location":"languages/java/gc.html#_8","title":"\u590d\u5236\u7b97\u6cd5","text":"<p>\u9002\u7528\u4e8e\u65b0\u751f\u4ee3\uff0c\u9891\u7e41\u7533\u8bf7\u548c\u91ca\u653e</p> <p>\u5185\u5b58\u5206\u6210\u76f8\u7b49\u4e24\u5757\uff0c\u5f53\u4e00\u5757\u5185\u5b58\u4f7f\u7528\u5b8c\u65f6\uff0c\u5c06\u5b58\u6d3b\u7684\u5bf9\u8c61\u590d\u5236\u5230\u53e6\u4e00\u5757\u5185\u5b58\u4e0a\uff0c\u5e76\u6e05\u7406\u4e4b\u524d\u4e00\u5757\u5185\u5b58\uff1b</p> <ul> <li>\u5185\u5b58\u5206\u6210\u4e00\u5757\u8f83\u5927\u7684 Eden \u7a7a\u95f4\u548c\u4e24\u5757\u8f83\u5c0f\u7684 Survivor \u7a7a\u95f4</li> <li>\u56de\u6536\u65f6\uff0c\u5c06 Eden \u548c Survivor \u4e2d\u5b58\u6d3b\u7684\u5bf9\u8c61\u4e00\u6b21\u6027\u590d\u5236\u5230\u53e6\u4e00\u4e2aSurvivor\u7a7a\u95f4\u4e0a\uff0c\u6e05\u7406\u4e4b\u524d\u7684Eden\u548cSurvivor\u7a7a\u95f4\uff1b</li> <li>\u5f53 Survivor \u7a7a\u95f4\u4e0d\u591f\u65f6\uff0c\u9700\u8981\u4f9d\u9760\u8001\u5e74\u4ee3\u8fdb\u884c\u5206\u914d\u62c5\u4fdd\uff0c\u5373\u591a\u4f59\u7684\u5b58\u6d3b\u5bf9\u8c61\u653e\u5165\u8001\u5e74\u4ee3\u4e2d\uff1b</li> </ul>"},{"location":"languages/java/gc.html#-_1","title":"\u6807\u8bb0-\u6574\u7406\u7b97\u6cd5","text":"<p>\u6807\u8bb0\u56de\u6536\u5bf9\u8c61\uff0c\u5b58\u6d3b\u7684\u5bf9\u8c61\u5411\u4e00\u7aef\u79fb\uff0c\u6e05\u9664\u8fb9\u754c\u4ee5\u5916\u5185\u5b58\uff0c\u6d88\u9664\u5185\u5b58\u788e\u7247\uff1b</p>"},{"location":"languages/java/gc.html#_9","title":"\u5185\u5b58\u56de\u6536\u7b97\u6cd5\u5b9e\u73b0","text":"<p>\u679a\u4e3e\u6839\u8282\u70b9</p> <ul> <li> <p>Stop The World</p> </li> <li> <p>\u51c6\u786e\u5f0fGC\uff0c\u865a\u62df\u673a\u76f4\u63a5\u5f97\u77e5\u54ea\u4e9b\u5730\u65b9\u5b58\u653e\u7740\u5bf9\u8c61\u5f15\u7528\uff0c\u901a\u8fc7OopMap\u6570\u636e\u7ed3\u6784\uff0cJIT\u7f16\u8bd1\u8fc7\u7a0b\u4f1a\u5728\u7279\u5b9a\u4f4d\u7f6e\u8bb0\u5f55\u6808\u548c\u5bc4\u5b58\u5668\u4e2d\u54ea\u4e9b\u4f4d\u7f6e\u6709\u5f15\u7528\uff1b</p> </li> <li> <p>SafePoint\uff1a\u7a0b\u5e8f\u6267\u884c\u65f6\u5e76\u975e\u5728\u6240\u6709\u5730\u65b9\u90fd\u80fd\u505c\u987f\u4e0b\u6765\u5f00\u59cbGC\uff0c\u53ea\u6709\u5230\u8fbe\u5b89\u5168\u70b9\u65f6\u624d\u80fd\u6682\u505c\uff1b</p> </li> <li> <p>\u5b89\u5168\u70b9\u7684\u9009\u53d6\u4ee5\u7a0b\u5e8f\u201c\u662f\u5426\u6709\u8ba9\u7a0b\u5e8f\u957f\u65f6\u95f4\u6267\u884c\u7684\u7279\u5f81\u201d\u5373\u6307\u4ee4\u5e8f\u5217\u590d\u7528\uff0c\u5982\u65b9\u6cd5\u8c03\u7528\u3001\u8df3\u8f6c\u7b49\uff1b</p> </li> <li> <p>\u62a2\u5360\u5f0f\u4e2d\u65ad\uff1aGC\u65f6\uff0c\u4e2d\u65ad\u6240\u6709\u7ebf\u7a0b\uff0c\u82e5\u7ebf\u7a0b\u4e2d\u65ad\u5730\u65b9\u4e0d\u662f\u5b89\u5168\u70b9\uff0c\u5219\u6062\u590d\u7ebf\u7a0b\u8dd1\u5230\u5b89\u5168\u70b9\uff0c\u5f88\u5c11\u4f7f\u7528\uff1b</p> </li> <li> <p>\u4e3b\u52a8\u5f0f\u4e2d\u65ad\uff1aGC\u9700\u8981\u4e2d\u65ad\u7ebf\u7a0b\u65f6\uff0c\u4ec5\u8bbe\u7f6e\u6807\u5fd7\uff0c\u5404\u7ebf\u7a0b\u6267\u884c\u65f6\u4e3b\u52a8\u8f6e\u8be2\u8be5\u6807\u5fd7\uff08\u5230\u8fbe\u5b89\u5168\u70b9\u65f6\u6216\u521b\u5efa\u5bf9\u8c61\u9700\u8981\u5206\u914d\u5185\u5b58\u65f6\u8f6e\u8be2\uff09\uff0c\u53d1\u73b0\u4e2d\u65ad\u6807\u5fd7\u4e3a\u771f\u65f6\u5c31\u81ea\u5df1\u4e2d\u65ad\u6302\u8d77\uff1b</p> </li> <li> <p>\u5b89\u5168\u533a\u57df\uff1a\u5f53\u7a0b\u5e8f\u201c\u4e0d\u6267\u884c\u201d\uff08Sleep\u6216Blocked\u72b6\u6001\uff09\u65f6\uff0c\u7ebf\u7a0b\u5982\u4f55\u8fdb\u5165GC\uff1f</p> </li> <li> <p>\u5b89\u5168\u533a\u57df\u6307\u5728\u4e00\u6bb5\u4ee3\u7801\u4e2d\uff0c\u5f15\u7528\u5173\u7cfb\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\uff0c\u5728\u8fd9\u4e2a\u533a\u57df\u4e2d\u7684\u4efb\u610f\u5730\u65b9\u5f00\u59cbGC\u90fd\u5b89\u5168\uff1b</p> </li> <li>\u5c06\u7ebf\u7a0bSleep\u8fd9\u4e9b\u52a0\u5165Safe Region\u4e2d\uff0c\u7ebf\u7a0b\u8fdb\u5165Safe Region\u4ee3\u7801\u65f6\u505a\u6807\u8bc6\uff0c\u5728\u6b64\u671f\u95f4JVM\u53d1\u8d77GC\u65f6\uff0c\u4e0d\u9700\u7ba1\u81ea\u5df1\u4e3aSafe Region\u72b6\u6001\u7684\u7ebf\u7a0b\uff1b\u7ebf\u7a0b\u79bb\u5f00Safe Region\u65f6\uff0c\u68c0\u67e5\u7cfb\u7edf\u662f\u5426\u5df2\u7ecf\u5b8c\u6210\u4e86\u6839\u8282\u70b9\u679a\u4e3e\uff08\u6216\u6574\u4e2aGC\u8fc7\u7a0b\uff09\uff0c\u5b8c\u6210\u5219\u7ebf\u7a0b\u7ee7\u7eed\u6267\u884c\uff0c\u5426\u5219\u7b49\u5f85\u77e5\u9053\u6536\u5230\u53ef\u4ee5\u5b89\u5168\u79bb\u5f00Safe       Region\u7684\u4fe1\u53f7\uff1b</li> </ul>"},{"location":"languages/java/jit.html","title":"JIT","text":"<p>Just In Time \u7f16\u8bd1\u5668\u3002</p> <p>\u5185\u5bb9\u6765\u81ea\u4e8e\uff1a\u300a\u57fa\u672c\u529f | Java\u5373\u65f6\u7f16\u8bd1\u5668\u539f\u7406\u89e3\u6790\u53ca\u5b9e\u8df5\u300b</p>"},{"location":"languages/java/jit.html#_1","title":"\u539f\u7406","text":"<p>\u5f53\u65b9\u6cd5\u6216\u8005\u4ee3\u7801\u5757\u7684\u5728\u4e00\u5b9a\u65f6\u95f4\u5185\u7684\u8c03\u7528\u6b21\u6570\u8d85\u8fc7\u8fd9\u4e2a\u9608\u503c\u65f6\u5c31\u4f1a\u88ab\u7f16\u8bd1\uff0c\u5b58\u5165codeCache\u4e2d\u3002\u5f53\u4e0b\u6b21\u6267\u884c\u65f6\uff0c\u518d\u9047\u5230\u8fd9\u6bb5\u4ee3\u7801\uff0c\u5c31\u4f1a\u4ececodeCache\u4e2d\u8bfb\u53d6\u673a\u5668\u7801\uff0c\u76f4\u63a5\u6267\u884c\uff0c\u4ee5\u6b64\u6765\u63d0\u5347\u7a0b\u5e8f\u8fd0\u884c\u7684\u6027\u80fd\u3002</p> <p></p>"},{"location":"languages/java/jit.html#_2","title":"\u7f16\u8bd1\u5668","text":"<p>JVM\u4e2d\u96c6\u6210\u4e86\u4e24\u79cd\u7f16\u8bd1\u5668\uff0cClient Compiler\u548cServer Compiler\uff0c\u5b83\u4eec\u7684\u4f5c\u7528\u4e5f\u4e0d\u540c\u3002Client Compiler\u6ce8\u91cd\u542f\u52a8\u901f\u5ea6\u548c\u5c40\u90e8\u7684\u4f18\u5316\uff0cServer Compiler\u5219\u66f4\u52a0\u5173\u6ce8\u5168\u5c40\u7684\u4f18\u5316\uff0c\u6027\u80fd\u4f1a\u66f4\u597d\uff0c\u4f46\u7531\u4e8e\u4f1a\u8fdb\u884c\u66f4\u591a\u7684\u5168\u5c40\u5206\u6790\uff0c\u6240\u4ee5\u542f\u52a8\u901f\u5ea6\u4f1a\u53d8\u6162\u3002</p>"},{"location":"languages/java/jit.html#client-compiler","title":"Client Compiler","text":"<ul> <li>\u5c40\u90e8\u7b80\u5355\u53ef\u9760\u7684\u4f18\u5316\uff0c\u6bd4\u5982\u5b57\u8282\u7801\u4e0a\u8fdb\u884c\u7684\u4e00\u4e9b\u57fa\u7840\u4f18\u5316\uff0c\u65b9\u6cd5\u5185\u8054\u3001\u5e38\u91cf\u4f20\u64ad\u7b49\uff0c\u653e\u5f03\u8bb8\u591a\u8017\u65f6\u8f83\u957f\u7684\u5168\u5c40\u4f18\u5316\u3002</li> <li>\u5c06\u5b57\u8282\u7801\u6784\u9020\u6210\u9ad8\u7ea7\u4e2d\u95f4\u8868\u793a\uff08High-level Intermediate Representation\uff0c\u4ee5\u4e0b\u79f0\u4e3aHIR\uff09\uff0cHIR\u4e0e\u5e73\u53f0\u65e0\u5173\uff0c\u901a\u5e38\u91c7\u7528\u56fe\u7ed3\u6784\uff0c\u66f4\u9002\u5408JVM\u5bf9\u7a0b\u5e8f\u8fdb\u884c\u4f18\u5316\u3002</li> <li>\u6700\u540e\u5c06HIR\u8f6c\u6362\u6210\u4f4e\u7ea7\u4e2d\u95f4\u8868\u793a\uff08Low-level Intermediate Representation\uff0c\u4ee5\u4e0b\u79f0\u4e3aLIR\uff09\uff0c\u5728LIR\u7684\u57fa\u7840\u4e0a\u4f1a\u8fdb\u884c\u5bc4\u5b58\u5668\u5206\u914d\u3001\u7aa5\u5b54\u4f18\u5316\uff08\u5c40\u90e8\u7684\u4f18\u5316\u65b9\u5f0f\uff0c\u7f16\u8bd1\u5668\u5728\u4e00\u4e2a\u57fa\u672c\u5757\u6216\u8005\u591a\u4e2a\u57fa\u672c\u5757\u4e2d\uff0c\u9488\u5bf9\u5df2\u7ecf\u751f\u6210\u7684\u4ee3\u7801\uff0c\u7ed3\u5408CPU\u81ea\u5df1\u6307\u4ee4\u7684\u7279\u70b9\uff0c\u901a\u8fc7\u4e00\u4e9b\u8ba4\u4e3a\u53ef\u80fd\u5e26\u6765\u6027\u80fd\u63d0\u5347\u7684\u8f6c\u6362\u89c4\u5219\u6216\u8005\u901a\u8fc7\u6574\u4f53\u7684\u5206\u6790\uff0c\u8fdb\u884c\u6307\u4ee4\u8f6c\u6362\uff0c\u6765\u63d0\u5347\u4ee3\u7801\u6027\u80fd\uff09\u7b49\u64cd\u4f5c\uff0c\u6700\u7ec8\u751f\u6210\u673a\u5668\u7801\u3002</li> </ul>"},{"location":"languages/java/jit.html#server-compiler","title":"Server Compiler","text":"<p>Server Compiler\u4e3b\u8981\u5173\u6ce8\u4e00\u4e9b\u7f16\u8bd1\u8017\u65f6\u8f83\u957f\u7684\u5168\u5c40\u4f18\u5316\uff0c\u751a\u81f3\u4f1a\u8fd8\u4f1a\u6839\u636e\u7a0b\u5e8f\u8fd0\u884c\u7684\u4fe1\u606f\u8fdb\u884c\u4e00\u4e9b\u4e0d\u53ef\u9760\u7684\u6fc0\u8fdb\u4f18\u5316\u3002</p> <p>\u76ee\u524d\uff0cHotspot\u865a\u62df\u673a\u4e2d\u4f7f\u7528\u7684Server Compiler\u6709\u4e24\u79cd\uff1aC2\u548cGraal\u3002</p>"},{"location":"languages/java/jit.html#c2-compiler","title":"C2 Compiler","text":"<p>\u5728Hotspot VM\u4e2d\uff0c\u9ed8\u8ba4\u7684Server Compiler\u662fC2\u7f16\u8bd1\u5668\u3002</p> <p></p>"},{"location":"languages/java/jit.html#graal-compiler","title":"Graal Compiler","text":"<p>\u4eceJDK 9\u5f00\u59cb\uff0cHotspot VM\u4e2d\u96c6\u6210\u4e86\u4e00\u79cd\u65b0\u7684Server Compiler\uff0cGraal\u7f16\u8bd1\u5668\uff1a</p> <ul> <li>\u4f7f\u7528Java\u7f16\u5199\uff0c\u5bf9\u4e8eJava\u8bed\u8a00\uff0c\u5c24\u5176\u662f\u65b0\u7279\u6027\uff0c\u6bd4\u5982Lambda\u3001Stream\u7b49\u66f4\u52a0\u53cb\u597d\u3002</li> <li>\u66f4\u6df1\u5c42\u6b21\u7684\u4f18\u5316\uff0c\u6bd4\u5982\u865a\u51fd\u6570\u7684\u5185\u8054\u3001\u90e8\u5206\u9003\u9038\u5206\u6790\u7b49\u3002</li> </ul> <p>\u914d\u7f6e\u53c2\u6570\uff1a<code>-XX:+UnlockExperimentalVMOptions -XX:+UseJVMCICompiler</code></p>"},{"location":"languages/java/jit.html#_3","title":"\u5206\u5c42\u7f16\u8bd1","text":"<p>\u4eceJDK 8\u5f00\u59cb\uff0cJVM\u9ed8\u8ba4\u5f00\u542f\u5206\u5c42\u7f16\u8bd1\uff0c\u5bfb\u627e\u5f53\u524d\u670d\u52a1\u7684\u6700\u4f73\u5e73\u8861\u70b9\u3002\u5206\u5c42\u7f16\u8bd1\u5c06JVM\u7684\u6267\u884c\u72b6\u6001\u5206\u4e3a\u4e86\u4e94\u4e2a\u5c42\u6b21\u3002\u4e94\u4e2a\u5c42\u7ea7\u5206\u522b\u662f\uff1a</p> <ul> <li>\u89e3\u91ca\u6267\u884c\u3002</li> <li>\u6267\u884c\u4e0d\u5e26profiling\u7684C1\u4ee3\u7801\u3002</li> <li>\u6267\u884c\u4ec5\u5e26\u65b9\u6cd5\u8c03\u7528\u6b21\u6570\u4ee5\u53ca\u5faa\u73af\u56de\u8fb9\u6267\u884c\u6b21\u6570profiling\u7684C1\u4ee3\u7801\u3002</li> <li>\u6267\u884c\u5e26\u6240\u6709profiling\u7684C1\u4ee3\u7801\u3002</li> <li>\u6267\u884cC2\u4ee3\u7801\u3002</li> </ul> <p></p> <ul> <li>\u56fe\u4e2d\u7b2c\u2460\u6761\u8def\u5f84\uff0c\u4ee3\u8868\u7f16\u8bd1\u7684\u4e00\u822c\u60c5\u51b5\uff0c\u70ed\u70b9\u65b9\u6cd5\u4ece\u89e3\u91ca\u6267\u884c\u5230\u88ab3\u5c42\u7684C1\u7f16\u8bd1\uff0c\u6700\u540e\u88ab4\u5c42\u7684C2\u7f16\u8bd1\u3002</li> <li>\u5982\u679c\u65b9\u6cd5\u6bd4\u8f83\u5c0f\uff08\u6bd4\u5982Java\u670d\u52a1\u4e2d\u5e38\u89c1\u7684getter/setter\u65b9\u6cd5\uff09\uff0c3\u5c42\u7684profiling\u6ca1\u6709\u6536\u96c6\u5230\u6709\u4ef7\u503c\u7684\u6570\u636e\uff0cJVM\u5c31\u4f1a\u65ad\u5b9a\u8be5\u65b9\u6cd5\u5bf9\u4e8eC1\u4ee3\u7801\u548cC2\u4ee3\u7801\u7684\u6267\u884c\u6548\u7387\u76f8\u540c\uff0c\u5c31\u4f1a\u6267\u884c\u56fe\u4e2d\u7b2c\u2461\u6761\u8def\u5f84\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cJVM\u4f1a\u57283\u5c42\u7f16\u8bd1\u4e4b\u540e\uff0c\u653e\u5f03\u8fdb\u5165C2\u7f16\u8bd1\uff0c\u76f4\u63a5\u9009\u62e9\u75281\u5c42\u7684C1\u7f16\u8bd1\u8fd0\u884c\u3002</li> <li>\u5728C1\u5fd9\u788c\u7684\u60c5\u51b5\u4e0b\uff0c\u6267\u884c\u56fe\u4e2d\u7b2c\u2462\u6761\u8def\u5f84\uff0c\u5728\u89e3\u91ca\u6267\u884c\u8fc7\u7a0b\u4e2d\u5bf9\u7a0b\u5e8f\u8fdb\u884cprofiling \uff0c\u6839\u636e\u4fe1\u606f\u76f4\u63a5\u7531\u7b2c4\u5c42\u7684C2\u7f16\u8bd1\u3002</li> <li>\u524d\u6587\u63d0\u5230C1\u4e2d\u7684\u6267\u884c\u6548\u7387\u662f1\u5c42&gt;2\u5c42&gt;3\u5c42\uff0c\u7b2c3\u5c42\u4e00\u822c\u8981\u6bd4\u7b2c2\u5c42\u616235%\u4ee5\u4e0a\uff0c\u6240\u4ee5\u5728C2\u5fd9\u788c\u7684\u60c5\u51b5\u4e0b\uff0c\u6267\u884c\u56fe\u4e2d\u7b2c\u2463\u6761\u8def\u5f84\u3002\u8fd9\u65f6\u65b9\u6cd5\u4f1a\u88ab2\u5c42\u7684C1\u7f16\u8bd1\uff0c\u7136\u540e\u518d\u88ab3\u5c42\u7684C1\u7f16\u8bd1\uff0c\u4ee5\u51cf\u5c11\u65b9\u6cd5\u57283\u5c42\u7684\u6267\u884c\u65f6\u95f4\u3002</li> <li>\u5982\u679c\u7f16\u8bd1\u5668\u505a\u4e86\u4e00\u4e9b\u6bd4\u8f83\u6fc0\u8fdb\u7684\u4f18\u5316\uff0c\u6bd4\u5982\u5206\u652f\u9884\u6d4b\uff0c\u5728\u5b9e\u9645\u8fd0\u884c\u65f6\u53d1\u73b0\u9884\u6d4b\u51fa\u9519\uff0c\u8fd9\u65f6\u5c31\u4f1a\u8fdb\u884c\u53cd\u4f18\u5316\uff0c\u91cd\u65b0\u8fdb\u5165\u89e3\u91ca\u6267\u884c\uff0c\u56fe\u4e2d\u7b2c\u2464\u6761\u6267\u884c\u8def\u5f84\u4ee3\u8868\u7684\u5c31\u662f\u53cd\u4f18\u5316\u3002</li> </ul>"},{"location":"languages/java/jit.html#_4","title":"\u5373\u65f6\u7f16\u8bd1\u7684\u89e6\u53d1","text":"<p>Java\u865a\u62df\u673a\u6839\u636e\u65b9\u6cd5\u7684\u8c03\u7528\u6b21\u6570\u4ee5\u53ca\u5faa\u73af\u56de\u8fb9\u7684\u6267\u884c\u6b21\u6570\u6765\u89e6\u53d1\u5373\u65f6\u7f16\u8bd1\u3002</p> <p>\u5f53\u65b9\u6cd5\u7684\u8c03\u7528\u6b21\u6570\u548c\u5faa\u73af\u56de\u8fb9\u7684\u6b21\u6570\u7684\u548c\uff0c\u8d85\u8fc7\u7531\u53c2\u6570<code>-XX:CompileThreshold</code>\u6307\u5b9a\u7684\u9608\u503c\u65f6\uff08\u4f7f\u7528C1\u65f6\uff0c\u9ed8\u8ba4\u503c\u4e3a1500\uff1b\u4f7f\u7528C2\u65f6\uff0c\u9ed8\u8ba4\u503c\u4e3a10000\uff09\uff0c\u5c31\u4f1a\u89e6\u53d1\u5373\u65f6\u7f16\u8bd1\u3002</p> <p>\u5f00\u542f\u5206\u5c42\u7f16\u8bd1\u7684\u60c5\u51b5\u4e0b\uff0c<code>-XX:CompileThreshold</code>\u53c2\u6570\u8bbe\u7f6e\u7684\u9608\u503c\u5c06\u4f1a\u5931\u6548\uff0c\u89e6\u53d1\u7f16\u8bd1\u4f1a\u7531\u4ee5\u4e0b\u7684\u6761\u4ef6\u6765\u5224\u65ad\uff1a</p> <ul> <li>\u65b9\u6cd5\u8c03\u7528\u6b21\u6570\u5927\u4e8e\u7531\u53c2\u6570<code>-XX:TierXInvocationThreshold</code>\u6307\u5b9a\u7684\u9608\u503c\u4e58\u4ee5\u7cfb\u6570\u3002</li> <li>\u65b9\u6cd5\u8c03\u7528\u6b21\u6570\u5927\u4e8e\u7531\u53c2\u6570<code>-XX:TierXMINInvocationThreshold</code>\u6307\u5b9a\u7684\u9608\u503c\u4e58\u4ee5\u7cfb\u6570\uff0c\u5e76\u4e14\u65b9\u6cd5\u8c03\u7528\u6b21\u6570\u548c\u5faa\u73af\u56de\u8fb9\u6b21\u6570\u4e4b\u548c\u5927\u4e8e\u7531\u53c2\u6570<code>-XX:TierXCompileThreshold</code>\u6307\u5b9a\u7684\u9608\u503c\u4e58\u4ee5\u7cfb\u6570\u65f6\u3002</li> </ul> <p>\u5206\u5c42\u7f16\u8bd1\u89e6\u53d1\u6761\u4ef6\u516c\u5f0f\uff1aJVM\u4f1a\u6839\u636e\u5f53\u524d\u7684\u7f16\u8bd1\u65b9\u6cd5\u6570\u4ee5\u53ca\u7f16\u8bd1\u7ebf\u7a0b\u6570\u52a8\u6001\u8c03\u6574\u7cfb\u6570s\u3002</p> <pre><code>// i\u4e3a\u8c03\u7528\u6b21\u6570\uff0cb\u662f\u5faa\u73af\u56de\u8fb9\u6b21\u6570\ni &gt; TierXInvocationThreshold * s || (i &gt; TierXMinInvocationThreshold * s  &amp;&amp; i + b &gt; TierXCompileThreshold * s) \n</code></pre>"},{"location":"languages/java/jit.html#_5","title":"\u7f16\u8bd1\u4f18\u5316","text":""},{"location":"languages/java/jit.html#_6","title":"\u4e2d\u95f4\u8868\u8fbe\u5f0f","text":"<p>\u5728\u7f16\u8bd1\u539f\u7406\u4e2d\uff0c\u901a\u5e38\u628a\u7f16\u8bd1\u5668\u5206\u4e3a\u524d\u7aef\u548c\u540e\u7aef\uff0c\u524d\u7aef\u7f16\u8bd1\u7ecf\u8fc7\u8bcd\u6cd5\u5206\u6790\u3001\u8bed\u6cd5\u5206\u6790\u3001\u8bed\u4e49\u5206\u6790\u751f\u6210\u4e2d\u95f4\u8868\u8fbe\u5f62\u5f0f\uff08Intermediate Representation\uff0c\u4ee5\u4e0b\u79f0\u4e3aIR\uff09\uff0c\u540e\u7aef\u4f1a\u5bf9IR\u8fdb\u884c\u4f18\u5316\uff0c\u751f\u6210\u76ee\u6807\u4ee3\u7801\u3002</p> <p>\u73b0\u4ee3\u7f16\u8bd1\u5668\u4e00\u822c\u91c7\u7528\u56fe\u7ed3\u6784\u7684IR\uff0c\u9759\u6001\u5355\u8d4b\u503c\uff08Static Single Assignment\uff0cSSA\uff09IR\u662f\u76ee\u524d\u6bd4\u8f83\u5e38\u7528\u7684\u4e00\u79cd\u3002</p> <ul> <li>\u6bcf\u4e2a\u53d8\u91cf\u53ea\u80fd\u88ab\u8d4b\u503c\u4e00\u6b21\uff0c\u800c\u4e14\u53ea\u6709\u5f53\u53d8\u91cf\u88ab\u8d4b\u503c\u4e4b\u540e\u624d\u80fd\u4f7f\u7528\uff1b</li> <li>\u5bb9\u6613\u8bc6\u522b\u5197\u4f59\u8d4b\u503c\uff0c\u548c\u6b7b\u4ee3\u7801\u5220\u9664\uff1b</li> </ul> <p>Phi And Region Nodes\u3001Global Value Numbering\uff08GVN\uff09</p>"},{"location":"languages/java/jit.html#_7","title":"\u65b9\u6cd5\u5185\u8054","text":"<p>\u65b9\u6cd5\u5185\u8054\uff0c\u662f\u6307\u5728\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u9047\u5230\u65b9\u6cd5\u8c03\u7528\u65f6\uff0c\u5c06\u76ee\u6807\u65b9\u6cd5\u7684\u65b9\u6cd5\u4f53\u7eb3\u5165\u7f16\u8bd1\u8303\u56f4\u4e4b\u4e2d\uff0c\u5e76\u53d6\u4ee3\u539f\u65b9\u6cd5\u8c03\u7528\u7684\u4f18\u5316\u624b\u6bb5\u3002</p> <ul> <li>\u51cf\u5c11\u5165\u6808\u3001\u51fa\u6808\u7684\u8c03\u7528\u5f00\u9500\uff1b</li> </ul>"},{"location":"languages/java/jit.html#_8","title":"\u865a\u51fd\u6570\u5185\u8054","text":"<p>Java\u4e2d\u6240\u6709\u975e\u79c1\u6709\u7684\u6210\u5458\u51fd\u6570\u7684\u8c03\u7528\u90fd\u662f\u865a\u8c03\u7528\uff0c\u865a\u51fd\u6570\u4f7f\u5f97\u5185\u8054\u662f\u5f88\u96be\u7684\uff0c\u56e0\u4e3a\u5728\u5185\u8054\u9636\u6bb5\u5e76\u4e0d\u77e5\u9053\u4ed6\u4eec\u4f1a\u8c03\u7528\u54ea\u4e2a\u65b9\u6cd5\u3002</p> <p>JVM\u662f\u901a\u8fc7\u4fdd\u5b58\u865a\u51fd\u6570\u8868Virtual Method Table\uff08\u4ee5\u4e0b\u79f0\u4e3aVMT\uff09\u5b58\u50a8class\u5bf9\u8c61\u4e2d\u6240\u6709\u7684\u865a\u51fd\u6570\uff0cclass\u7684\u5b9e\u4f8b\u5bf9\u8c61\u4fdd\u5b58\u7740\u4e00\u4e2aVMT\u7684\u6307\u9488\uff0c\u7a0b\u5e8f\u8fd0\u884c\u65f6\u9996\u5148\u52a0\u8f7d\u5b9e\u4f8b\u5bf9\u8c61\uff0c\u7136\u540e\u901a\u8fc7\u5b9e\u4f8b\u5bf9\u8c61\u627e\u5230VMT\uff0c\u901a\u8fc7VMT\u627e\u5230\u5bf9\u5e94\u65b9\u6cd5\u7684\u5730\u5740\uff0c\u6240\u4ee5\u865a\u51fd\u6570\u7684\u8c03\u7528\u6bd4\u76f4\u63a5\u6307\u5411\u65b9\u6cd5\u5730\u5740\u7684classic call\u6027\u80fd\u4e0a\u4f1a\u5dee\u4e00\u4e9b\u3002</p>"},{"location":"languages/java/jit.html#_9","title":"\u9003\u9038\u5206\u6790","text":"<p>\u9003\u9038\u5206\u6790\u662f\u201c\u4e00\u79cd\u786e\u5b9a\u6307\u9488\u52a8\u6001\u8303\u56f4\u7684\u9759\u6001\u5206\u6790\uff0c\u5b83\u53ef\u4ee5\u5206\u6790\u5728\u7a0b\u5e8f\u7684\u54ea\u4e9b\u5730\u65b9\u53ef\u4ee5\u8bbf\u95ee\u5230\u6307\u9488\u201d\u3002</p> <p>\u9003\u9038\u5206\u6790\u901a\u5e38\u662f\u5728\u65b9\u6cd5\u5185\u8054\u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u7684\uff0c\u5373\u65f6\u7f16\u8bd1\u5668\u53ef\u4ee5\u6839\u636e\u9003\u9038\u5206\u6790\u7684\u7ed3\u679c\u8fdb\u884c\u8bf8\u5982\u9501\u6d88\u9664\u3001\u6808\u4e0a\u5206\u914d\u4ee5\u53ca\u6807\u91cf\u66ff\u6362\u7684\u4f18\u5316\u3002</p>"},{"location":"languages/java/jit.html#loop-transformations","title":"Loop Transformations","text":"<p>\u5faa\u73af\u7684\u8f6c\u6362\uff0c\u6700\u91cd\u8981\u7684\u4e24\u79cd\u8f6c\u6362\u5c31\u662f\u5faa\u73af\u5c55\u5f00\u548c\u5faa\u73af\u5206\u79bb\u3002</p> <ul> <li>\u5faa\u73af\u5c55\u5f00\u4ee5\u727a\u7272\u7a0b\u5e8f\u4e8c\u8fdb\u5236\u7801\u5927\u5c0f\u4e3a\u4ee3\u4ef7\u6765\u4f18\u5316\u7a0b\u5e8f\u7684\u6267\u884c\u901f\u5ea6\uff0c\u662f\u4e00\u79cd\u7528\u7a7a\u95f4\u6362\u65f6\u95f4\u7684\u4f18\u5316\u624b\u6bb5\uff1b</li> <li>\u5faa\u73af\u5206\u79bb\u628a\u5faa\u73af\u4e2d\u4e00\u6b21\u6216\u591a\u6b21\u7684\u7279\u6b8a\u8fed\u4ee3\u5206\u79bb\u51fa\u6765\uff0c\u5728\u5faa\u73af\u5916\u6267\u884c\uff08\u51cf\u5c11\u91cd\u590d\u6027\u5f00\u9500\uff09\u3002</li> </ul>"},{"location":"languages/java/jit.html#_10","title":"\u7aa5\u5b54\u4f18\u5316\u4e0e\u5bc4\u5b58\u5668\u5206\u914d","text":"<p>\u7aa5\u5b54\u4f18\u5316\u5c31\u662f\u5c06\u7f16\u8bd1\u5668\u6240\u751f\u6210\u7684\u4e2d\u95f4\u4ee3\u7801\uff08\u6216\u76ee\u6807\u4ee3\u7801\uff09\u4e2d\u76f8\u90bb\u6307\u4ee4\uff0c\u5c06\u5176\u4e2d\u7684\u67d0\u4e9b\u7ec4\u5408\u66ff\u6362\u4e3a\u6548\u7387\u66f4\u9ad8\u7684\u6307\u4ee4\u7ec4\uff0c\u5e38\u89c1\u7684\u6bd4\u5982\u5f3a\u5ea6\u524a\u51cf\uff08\u5982\u4f4d\u8fd0\u7b97\u66ff\u4ee3\u4e58\u6cd5\uff09\u3001\u5e38\u6570\u5408\u5e76\u7b49\uff1b</p> <p>\u5bc4\u5b58\u5668\u5206\u914d\u4e5f\u662f\u4e00\u79cd\u7f16\u8bd1\u7684\u4f18\u5316\u624b\u6bb5\uff0c\u5728C2\u7f16\u8bd1\u5668\u4e2d\u666e\u904d\u7684\u4f7f\u7528\u3002\u5b83\u662f\u901a\u8fc7\u628a\u9891\u7e41\u4f7f\u7528\u7684\u53d8\u91cf\u4fdd\u5b58\u5728\u5bc4\u5b58\u5668\u4e2d\uff0cCPU\u8bbf\u95ee\u5bc4\u5b58\u5668\u7684\u901f\u5ea6\u6bd4\u5185\u5b58\u5feb\u5f97\u591a\uff0c\u53ef\u4ee5\u63d0\u5347\u7a0b\u5e8f\u7684\u8fd0\u884c\u901f\u5ea6\u3002</p>"},{"location":"languages/java/jit.html#_11","title":"\u914d\u7f6e","text":"<p>\u53c2\u6570</p> <ul> <li>-XX:+TieredCompilation\uff1a\u5f00\u542f\u5206\u5c42\u7f16\u8bd1\uff0cJDK8\u4e4b\u540e\u9ed8\u8ba4\u5f00\u542f</li> <li>-XX:+CICompilerCount=N\uff1a\u7f16\u8bd1\u7ebf\u7a0b\u6570\uff0c\u8bbe\u7f6e\u6570\u91cf\u540e\uff0cJVM\u4f1a\u81ea\u52a8\u5206\u914d\u7ebf\u7a0b\u6570\uff0cC1:C2 = 1:2</li> <li>-XX:TierXBackEdgeThreshold\uff1aOSR\u7f16\u8bd1\u7684\u9608\u503c</li> <li>-XX:TierXMinInvocationThreshold\uff1a\u5f00\u542f\u5206\u5c42\u7f16\u8bd1\u540e\u5404\u5c42\u8c03\u7528\u7684\u9608\u503c</li> <li>-XX:TierXCompileThreshold\uff1a\u5f00\u542f\u5206\u5c42\u7f16\u8bd1\u540e\u7684\u7f16\u8bd1\u9608\u503c</li> <li>-XX:ReservedCodeCacheSize\uff1acodeCache\u6700\u5927\u5927\u5c0f</li> <li>-XX:InitialCodeCacheSize\uff1acodeCache\u521d\u59cb\u5927\u5c0f</li> </ul> <p>\u901a\u8fc7JITwatch\u5206\u6790\u7f16\u8bd1\u65e5\u5fd7</p> <p>\u8f93\u51fa\u7f16\u8bd1\u3001\u5185\u8054\u3001codeCache\u4fe1\u606f\u5230\u6587\u4ef6\uff1a</p> <p><code>-XX:+UnlockDiagnosticVMOptions -XX:+PrintCompilation -XX:+PrintInlining -XX:+PrintCodeCache -XX:+PrintCodeCacheOnCompilation -XX:+TraceClassLoading -XX:+LogCompilation -XX:LogFile=LogPath</code></p>"},{"location":"languages/java/jmx.html","title":"JMX","text":"<p>JMX(Java Management Extensions)\u662f\u4e00\u4e2a\u4e3a\u5e94\u7528\u7a0b\u5e8f\u690d\u5165\u7ba1\u7406\u529f\u80fd\u7684\u6846\u67b6\u3002JMX\u662f\u4e00\u5957\u6807\u51c6\u7684\u4ee3\u7406\u548c\u670d\u52a1\uff0c\u4e3b\u8981\u7528\u4e8e\u5bf9JAVA\u5e94\u7528\u7a0b\u5e8f\u548cJVM\u8fdb\u884c\u76d1\u63a7\u548c\u7ba1\u7406\u3002</p> <p>JConsole \u548c JVisualVM \u4e2d\u80fd\u591f\u76d1\u63a7\u5230JAVA\u5e94\u7528\u7a0b\u5e8f\u548cJVM\u7684\u76f8\u5173\u4fe1\u606f\u90fd\u662f\u901a\u8fc7JMX\u5b9e\u73b0\u7684\u3002</p> <p></p>"},{"location":"languages/java/jmx.html#_1","title":"\u8fde\u63a5","text":""},{"location":"languages/java/jmx.html#mbean","title":"MBean\u672c\u5730\u8fde\u63a5","text":"<p>jps\uff0cjinfo\uff0cjmap\uff0cjstat\u7b49jdk\u81ea\u5e26\u7684\u547d\u4ee4\u53bb\u67e5\u8be2\u8fdb\u7a0b\u7684\u72b6\u6001\uff0c\u8fd9\u5176\u4e2d\u7684\u539f\u7406\u5c31\u662f\uff0c\u5f53java\u8fdb\u7a0b\u542f\u52a8\u540e\uff0c\u4f1a\u521b\u5efa\u4e00\u4e2a\u7528\u4e8e\u672c\u673a\u8fde\u63a5\u7684\u201clocalConnectorAddress\u201d\u653e\u5230\u5f53\u524d\u7528\u6237\u76ee\u5f55\u4e0b\uff0c\u5f53\u4f7f\u7528jps\u7b49\u8fde\u63a5\u65f6\uff0c\u4f1a\u5230\u5f53\u524d\u7528\u6237\u76ee\u5f55\u4e0b\u53d6\u5230\u201clocalConnectorAddress\u201d\u8fd9\u4e2aJMX\u8fde\u63a5\u5730\u5740\u5e76\u8fde\u63a5\u3002</p>"},{"location":"languages/java/jmx.html#mbean_1","title":"MBean\u8fdc\u7a0b\u8fde\u63a5","text":"<p>\u82e5\u60f3\u8fdc\u7a0b\u8fde\u63a5\u8bbf\u95ee\uff0c\u9700\u8981\u628ambean\u6ce8\u518c\u5230platformMBeanServer\u91cc\u9762\uff0c\u5e76\u5728\u542f\u52a8\u8fdb\u7a0b\u65f6\u52a0jmx\u53c2\u6570\u6307\u5b9a\uff0c\u53ef\u4ee5\u901a\u8fc7jconsole\uff0cjvisualvm\u8fdc\u7a0b\u8bbf\u95ee\u3002</p> <pre><code>-Dcom.sun.management.jmxremote=true                   \u76f8\u5173 JMX \u4ee3\u7406\u4fa6\u542c\u5f00\u5173\n-Djava.rmi.server.hostname=192.168.1.2                \u670d\u52a1\u5668\u7aef\u7684IP\n-Dcom.sun.management.jmxremote.port=29094             \u76f8\u5173 JMX \u4ee3\u7406\u4fa6\u542c\u8bf7\u6c42\u7684\u7aef\u53e3\n-Dcom.sun.management.jmxremote.ssl=false              \u6307\u5b9a\u662f\u5426\u4f7f\u7528 SSL \u901a\u8baf\n-Dcom.sun.management.jmxremote.authenticate=false     \u6307\u5b9a\u662f\u5426\u9700\u8981\u5bc6\u7801\u9a8c\u8bc1\n</code></pre>"},{"location":"languages/java/jmx.html#mxbean","title":"MXBean","text":"<p>JDK\u63d0\u4f9b\u4e86\u4e00\u4e9bJVM\u68c0\u6d4b\u7684API\uff0cjava.lang.management \u5305\uff0c\u63d0\u4f9b\u4e86\u8bb8\u591aMXBean\u7684\u63a5\u53e3\u7c7b\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u83b7\u53d6\u5230JVM\u7684\u5185\u5b58\u3001GC\u3001\u7ebf\u7a0b\u3001\u9501\u3001class\u3001\u751a\u81f3\u64cd\u4f5c\u7cfb\u7edf\u5c42\u9762\u7684\u5404\u79cd\u4fe1\u606f\u3002</p>"},{"location":"languages/java/jmx.html#operatingsystemmxbean","title":"OperatingSystemMXBean","text":"<pre><code>import com.sun.management.OperatingSystemMXBean;\n\nOperatingSystemMXBean osBean = ManagementFactory.getPlatformMXBean(OperatingSystemMXBean.class);\n\nosBean.getProcessCpuLoad();  // \u8fdb\u7a0b\u7684CPU\u8d1f\u8f7d\nosBean.getSystemCpuLoad();   // \u7cfb\u7edf\u7684CPU\u8d1f\u8f7d\n</code></pre>"},{"location":"languages/java/jmx.html#memorymxbean","title":"MemoryMXBean","text":"<p>\u53ef\u4ee5\u83b7\u53d6\u5f53\u524dHeap\u548cNonHeap\u7684\u5185\u5b58\u4f7f\u7528\u72b6\u51b5\uff08\u521d\u59cb\u503c\uff0c\u4f7f\u7528\u503c\uff0c\u63d0\u4ea4\u503c\uff0c\u6700\u5927\u503c\uff09\u3002</p>"},{"location":"languages/java/jmx.html#memorymanagermxbean","title":"MemoryManagerMXBean","text":"<p>\u5185\u5b58\u7ba1\u7406\u5668\u7684\u7ba1\u7406\u63a5\u53e3\u3002\u5185\u5b58\u7ba1\u7406\u5668\u7ba1\u7406 Java \u865a\u62df\u673a\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u5185\u5b58\u6c60\u3002Java \u865a\u62df\u673a\u5177\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u5185\u5b58\u7ba1\u7406\u5668\u3002</p> <ul> <li>getMemoryPoolNames() \uff1a\u8fd4\u56de\u6b64\u5185\u5b58\u7ba1\u7406\u5668\u7ba1\u7406\u7684\u5185\u5b58\u6c60\u540d\u79f0</li> <li>getName() \uff1a\u8fd4\u56de\u8868\u793a\u6b64\u5185\u5b58\u7ba1\u7406\u5668\u7684\u540d\u79f0</li> </ul> <p>\u770b\u51fa\u5f53\u524d\u5e94\u7528\u4f7f\u7528\u7684\u5783\u573e\u56de\u6536\u7b97\u6cd5\u53ca\u5176\u5e94\u7528\u7684\u5806\u5185\u5b58\u5206\u533a\u3002</p>"},{"location":"languages/java/jmx.html#memorypoolmxbean","title":"MemoryPoolMXBean","text":"<p>\u83b7\u53d6\u5185\u5b58\u6c60\u7684\u5f53\u524d\u4f7f\u7528\u91cf\uff08\u4f30\u8ba1\u503c\uff09\u548c\u5cf0\u503c\u4f7f\u7528\u91cf\u3002</p> <ul> <li>getName()\uff1a\u5185\u5b58\u6c60\u7684\u540d\u79f0\uff0c\u5982Code Cache, Metaspace, PS Eden Space\u7b49\uff1b</li> <li>getType()\uff1a\u5806\u5185\u8fd8\u662f\u5806\u5916\u5185\u5b58\uff1b</li> <li>getUsage() \u548c getPeakUsage()</li> </ul>"},{"location":"languages/java/jmx.html#garbagecollectormxbean","title":"GarbageCollectorMXBean","text":"<p>\u53ef\u4ee5\u83b7\u53d6GC\u7684\u6b21\u6570\u548c\u65f6\u95f4\u3002</p>"},{"location":"languages/java/jmx.html#bufferpoolmxbean","title":"BufferPoolMXBean","text":"<p>\u83b7\u53d6\u7f13\u51b2\u6c60\u7684\u5bb9\u91cf\u548c\u5df2\u4f7f\u7528\u91cf\u3002</p>"},{"location":"languages/java/jmx.html#threadmxbean","title":"ThreadMXBean","text":"<ul> <li><code>ThreadInfo[] dumpAllThreads(boolean lockedMonitors, boolean lockedSynchronizers)</code></li> </ul>"},{"location":"languages/java/jvm.html","title":"JVM","text":""},{"location":"languages/java/jvm.html#class","title":"class\u5b9a\u4e49","text":""},{"location":"languages/java/jvm.html#_1","title":"\u5bf9\u8c61\u5360\u636e\u7a7a\u95f4","text":"<ul> <li>\u5bf9\u8c61\u5934\uff0812\u4e2a\u5b57\u8282\uff09\uff1a</li> <li>\u5bf9\u8c61\u6807\u8bb0\uff08Mark Word\uff0c8\u5b57\u8282\uff09\uff1a\u54c8\u5e0c\u7801\u3001GC\u6807\u8bb0\u3001\u9501\u4fe1\u606f\u7b49\uff1b</li> <li> <p>\u7c7b\u5143\u4fe1\u606f\uff1a\u7c7b\u5143\u6570\u636e\uff08KClass\uff09\u7684\u9996\u5730\u5740\uff1b</p> </li> <li> <p>\u5b9e\u4f8b\u6570\u636e\uff1a\u672c\u7c7b\u5bf9\u8c61\u7684\u5b9e\u4f8b\u6210\u5458\u53d8\u91cf\u548c\u6240\u6709\u53ef\u89c1\u7684\u7236\u7c7b\u6210\u5458\u53d8\u91cf\uff1b</p> </li> <li>\u5bf9\u9f50\u586b\u5145\uff08padding\uff09\uff1a8\u5b57\u8282\u7684\u6574\u6570\u500d\uff1b</li> </ul>"},{"location":"languages/java/jvm.html#_2","title":"\u89c4\u8303","text":"<ul> <li>Java\u4e2d\u521b\u5efa\u5bf9\u8c61\u548c\u8d4b\u503c\u662f\u5206\u5f00\u7684\uff0c\u4e0d\u4fdd\u8bc1\u6267\u884c\u987a\u5e8f\uff1b</li> </ul> <p>\u7ebf\u7a0b\u7684\u5de5\u4f5c\u5185\u5b58\u548c\u4e3b\u5185\u5b58\uff1fTODO</p>"},{"location":"languages/java/jvm.html#_3","title":"\u53ef\u89c1\u6027","text":"<ul> <li>volatile \u5bf9\u57fa\u672c\u7c7b\u578b\u6216\u5bf9\u8c61\u5b9e\u4f8b\u8fdb\u884c\u4fee\u9970\uff0c\u786e\u4fdd\u4fee\u6539\u540e\u6240\u6709\u7ebf\u7a0b\u7acb\u5373\u53ef\u89c1\uff1b</li> <li>volatile \u5c4f\u853d\u6307\u4ee4\u91cd\u6392\u5e8f\u7684\u8bed\u4e49\uff08JDK 5\u540e\uff09\uff1b</li> <li>synchronized \u548c Lock \u4e5f\u80fd\u591f\u4fdd\u8bc1\u53ef\u89c1\u6027\uff0c\u540c\u4e00\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u83b7\u53d6\u9501\u7136\u540e\u6267\u884c\u540c\u6b65\u4ee3\u7801\uff1a</li> <li>\u7ebf\u7a0b\u89e3\u9501\u524d\uff0c\u91ca\u653e\u9501\u4e4b\u524d\u4f1a\u5c06\u5bf9\u53d8\u91cf\u7684\u4fee\u6539\u5237\u65b0\u5230\u4e3b\u5b58\u5f53\u4e2d\uff1b</li> <li>\u7ebf\u7a0b\u52a0\u9501\u65f6\uff0c\u5c06\u6e05\u7a7a\u5de5\u4f5c\u5185\u5b58\u4e2d\uff0c\u4ece\u800c\u4f7f\u7528\u5171\u4eab\u53d8\u91cf\u65f6\u9700\u8981\u4ece\u4e3b\u5185\u5b58\u4e2d\u91cd\u65b0\u8bfb\u53d6\u6700\u65b0\u7684\u503c\uff1b</li> </ul>"},{"location":"languages/java/jvm.html#happens-before","title":"happens-before \u539f\u5219","text":"<p>happens-before \u539f\u5219\uff1aJava\u5185\u5b58\u6a21\u578b\u5177\u6709\u4e00\u5b9a\u6709\u5e8f\u6027\uff0c\u4e0d\u9700\u8981\u901a\u8fc7\u4efb\u4f55\u624b\u6bb5\u5c31\u80fd\u591f\u5f97\u5230\u4fdd\u8bc1\u7684\u6709\u5e8f \u3002</p> <ul> <li>\u7a0b\u5e8f\u6b21\u5e8f\u89c4\u5219\uff1a\u4e00\u4e2a\u7ebf\u7a0b\u5185\uff0c\u6309\u7167\u4ee3\u7801\u987a\u5e8f\uff0c\u4e66\u5199\u5728\u524d\u9762\u7684\u64cd\u4f5c\u5148\u884c\u53d1\u751f\u4e8e\u4e66\u5199\u5728\u540e\u9762\u7684\u64cd\u4f5c\uff1b\u7528\u6765\u4fdd\u8bc1\u7a0b\u5e8f\u5728\u5355\u7ebf\u7a0b\u4e2d\u6267\u884c\u7ed3\u679c\u7684\u6b63\u786e\u6027\uff0c\u4f46\u65e0\u6cd5\u4fdd\u8bc1\u7a0b\u5e8f\u5728\u591a\u7ebf\u7a0b\u4e2d\u6267\u884c\u7684\u6b63\u786e\u6027\u3002</li> <li>\u9501\u89c4\u5219\uff1a\u4e00\u4e2aunLock\u64cd\u4f5c\u5148\u884c\u53d1\u751f\u4e8e\u540e\u9762\u5bf9\u540c\u4e00\u4e2a\u9501\u7684lock\u64cd\u4f5c</li> <li>volatile\u53d8\u91cf\u89c4\u5219\uff1a\u5bf9\u4e00\u4e2a\u53d8\u91cf\u7684\u5199\u64cd\u4f5c\u5148\u884c\u53d1\u751f\u4e8e\u540e\u9762\u5bf9\u8fd9\u4e2a\u53d8\u91cf\u7684\u8bfb\u64cd\u4f5c\uff1b</li> <li>\u4f20\u9012\u89c4\u5219\uff1a\u5982\u679c\u64cd\u4f5cA\u5148\u884c\u53d1\u751f\u4e8e\u64cd\u4f5cB\uff0c\u800c\u64cd\u4f5cB\u53c8\u5148\u884c\u53d1\u751f\u4e8e\u64cd\u4f5cC\uff0c\u5219\u53ef\u4ee5\u5f97\u51fa\u64cd\u4f5cA\u5148\u884c\u53d1\u751f\u4e8e\u64cd\u4f5cC\uff1b</li> <li>\u7ebf\u7a0b\u542f\u52a8\u89c4\u5219\uff1aThread\u5bf9\u8c61\u7684start()\u65b9\u6cd5\u5148\u884c\u53d1\u751f\u4e8e\u6b64\u7ebf\u7a0b\u7684\u6bcf\u4e2a\u4e00\u4e2a\u52a8\u4f5c\uff1b</li> <li>\u7ebf\u7a0b\u4e2d\u65ad\u89c4\u5219\uff1a\u5bf9\u7ebf\u7a0binterrupt()\u65b9\u6cd5\u7684\u8c03\u7528\u5148\u884c\u53d1\u751f\u4e8e\u88ab\u4e2d\u65ad\u7ebf\u7a0b\u7684\u4ee3\u7801\u68c0\u6d4b\u5230\u4e2d\u65ad\u4e8b\u4ef6\u7684\u53d1\u751f\uff1b</li> <li>\u7ebf\u7a0b\u7ec8\u7ed3\u89c4\u5219\uff1a\u7ebf\u7a0b\u4e2d\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u5148\u884c\u53d1\u751f\u4e8e\u7ebf\u7a0b\u7684\u7ec8\u6b62\u68c0\u6d4b\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7Thread.join()\u65b9\u6cd5\u7ed3\u675f\u3001Thread.isAlive()\u7684\u8fd4\u56de\u503c\u624b\u6bb5\u68c0\u6d4b\u5230\u7ebf\u7a0b\u5df2\u7ecf\u7ec8\u6b62\u6267\u884c\uff1b</li> <li>\u5bf9\u8c61\u7ec8\u7ed3\u89c4\u5219\uff1a\u4e00\u4e2a\u5bf9\u8c61\u7684\u521d\u59cb\u5316\u5b8c\u6210\u5148\u884c\u53d1\u751f\u4e8e\u4ed6\u7684finalize()\u65b9\u6cd5\u7684\u5f00\u59cb\uff1b</li> </ul> <p>\u5982\u679c\u4e24\u4e2a\u64cd\u4f5c\u7684\u6267\u884c\u6b21\u5e8f\u65e0\u6cd5\u4ecehappens-before\u539f\u5219\u63a8\u5bfc\u51fa\u6765\uff0c\u90a3\u4e48\u5b83\u4eec\u5c31\u4e0d\u80fd\u4fdd\u8bc1\u5b83\u4eec\u7684\u6709\u5e8f\u6027\uff0c\u865a\u62df\u673a\u53ef\u4ee5\u968f\u610f\u5730\u5bf9\u5b83\u4eec\u8fdb\u884c\u91cd\u6392\u5e8f\u3002</p> <p>A Happens-Before B\uff0c\u4e0d\u662f\u8bf4A\u8981\u53d1\u751f\u5728B\u4e4b\u524d\uff0c\u800c\u662f\u8bf4\u5982\u679c\u5728\u65f6\u95f4\u987a\u5e8f\u4e0aA\u53d1\u751f\u5728B\u4e4b\u524d\uff0c\u90a3\u4e48A\u4e2d\u7684\u64cd\u4f5c\u5bf9B\u4e2d\u7684\u64cd\u4f5c\u53ef\u89c1</p>"},{"location":"languages/java/jvm.html#lock","title":"lock\u524d\u7f00","text":"<p>\u89c2\u5bdf\u52a0\u5165volatile\u5173\u952e\u5b57\u548c\u6ca1\u6709\u52a0\u5165volatile\u5173\u952e\u5b57\u65f6\u6240\u751f\u6210\u7684\u6c47\u7f16\u4ee3\u7801\u53d1\u73b0\uff0c\u52a0\u5165volatile\u5173\u952e\u5b57\u65f6\uff0c\u4f1a\u591a\u51fa\u4e00\u4e2alock\u524d\u7f00\u6307\u4ee4\uff0c\u5b9e\u9645\u4e0a\u76f8\u5f53\u4e8e\u4e00\u4e2a\u5185\u5b58\u5c4f\u969c\uff08\u4e5f\u6210\u5185\u5b58\u6805\u680f\uff09\uff0c\u5185\u5b58\u5c4f\u969c\u4f1a\u63d0\u4f9b3\u4e2a\u529f\u80fd\uff1a</p> <p>1\uff09\u5b83\u786e\u4fdd\u6307\u4ee4\u91cd\u6392\u5e8f\u65f6\u4e0d\u4f1a\u628a\u5176\u540e\u9762\u7684\u6307\u4ee4\u6392\u5230\u5185\u5b58\u5c4f\u969c\u4e4b\u524d\u7684\u4f4d\u7f6e\uff0c\u4e5f\u4e0d\u4f1a\u628a\u524d\u9762\u7684\u6307\u4ee4\u6392\u5230\u5185\u5b58\u5c4f\u969c\u7684\u540e\u9762\uff1b\u5373\u5728\u6267\u884c\u5230\u5185\u5b58\u5c4f\u969c\u8fd9\u53e5\u6307\u4ee4\u65f6\uff0c\u5728\u5b83\u524d\u9762\u7684\u64cd\u4f5c\u5df2\u7ecf\u5168\u90e8\u5b8c\u6210\uff1b</p> <p>2\uff09\u5b83\u4f1a\u5f3a\u5236\u5c06\u5bf9\u7f13\u5b58\u7684\u4fee\u6539\u64cd\u4f5c\u7acb\u5373\u5199\u5165\u4e3b\u5b58\uff1b</p> <p>3\uff09\u5982\u679c\u662f\u5199\u64cd\u4f5c\uff0c\u5b83\u4f1a\u5bfc\u81f4\u5176\u4ed6CPU\u4e2d\u5bf9\u5e94\u7684\u7f13\u5b58\u884c\u65e0\u6548\u3002</p>"},{"location":"languages/java/jvm.html#_4","title":"\u5b9e\u73b0","text":""},{"location":"languages/java/jvm.html#hotspot","title":"HotSpot","text":""},{"location":"languages/java/jvm.html#openj9","title":"OpenJ9","text":""},{"location":"languages/java/nio.html","title":"Java NIO","text":"<p>Java\u4e2d\u8ddfzero copy\u76f8\u5173\u7684\u4e3b\u8981\u96c6\u4e2d\u5728FileChannel\u548cMappedByteBuffer\u4e2d\u3002</p> <p>\u7f51\u7edc\u901a\u8baf\u6846\u67b6Netty4\u4e2d\u8ddfzero copy\u76f8\u5173\u7684\u5219\u4e3b\u8981\u96c6\u4e2d\u5728FileRegion\u548cCompositeByteBuf\u4e2d\u3002</p>"},{"location":"languages/java/nio.html#buffer","title":"\u7f13\u51b2\u533a Buffer","text":"<p>\u7ecd\u7f13\u51b2\u533a\uff08Buffer\uff09 \u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5b83\u5305\u542b\u4e00\u4e9b\u8981\u5199\u5165\u6216\u8005\u8981\u8bfb\u51fa\u7684\u6570\u636e\u3002</p> <pre><code>ByteBuffer buf = ByteBuffer.allocate(1024);\n</code></pre> <ul> <li>\u5206\u914d\u7684\u662fHeapByteBuffer\uff0c\u88abJVM\u7ba1\u7406\uff0c\u5f53GC\u65f6\u5176 buf \u5728\u5185\u5b58\u4e2d\u7684\u5b9e\u9645\u5730\u5740\u4f1a\u53d1\u751f\u53d8\u5316\uff1b</li> <li>\u5f53\u8fdb\u884c IO \u64cd\u4f5c\u65f6\uff0c\u9700\u8981\u8f6c\u6362\u4e3a DirectByteBuffer\uff0c\u9632\u6b62\u51fa\u73b0GC\u65f6 JVM \u5bf9\u5176\u5185\u5b58\u5730\u5740\u53d1\u751f\u53d8\u5316\uff1b</li> </ul>"},{"location":"languages/java/nio.html#mappedbytebuffer","title":"MappedByteBuffer","text":"<p>java nio\u63d0\u4f9b\u7684FileChannel\u63d0\u4f9b<code>map()</code>\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u53ef\u4ee5\u5728\u4e00\u4e2a<code>\u6253\u5f00\u7684\u6587\u4ef6\u548cMappedByteBuffer</code>\u4e4b\u95f4\u5efa\u7acb\u4e00\u4e2a\u865a\u62df\u5185\u5b58\u6620\u5c04\uff0c<code>MappedByteBuffer</code>\u7ee7\u627f\u4e8e<code>ByteBuffer</code>\uff0c\u7c7b\u4f3c\u4e8e\u4e00\u4e2a\u57fa\u4e8e\u5185\u5b58\u7684\u7f13\u51b2\u533a\uff0c\u53ea\u4e0d\u8fc7\u8be5\u5bf9\u8c61\u7684\u6570\u636e\u5143\u7d20\u5b58\u50a8\u5728\u78c1\u76d8\u7684\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff1b</p> <p>\u793a\u4f8b\u4ee3\u7801</p> <pre><code>public class MappedByteBufferTest {\n    public static void main(String[] args) throws Exception {\n        File file = new File(\"D://db.txt\");\n        long len = file.length();\n        byte[] ds = new byte[(int) len];\n        MappedByteBuffer mappedByteBuffer = new FileInputStream(file).getChannel().map(FileChannel.MapMode.READ_ONLY, 0, len);\n        for (int offset = 0; offset &lt; len; offset++) {\n            byte b = mappedByteBuffer.get();\n            ds[offset] = b;\n        }\n        Scanner scan = new Scanner(new ByteArrayInputStream(ds)).useDelimiter(\" \");\n        while (scan.hasNext()) {\n            System.out.print(scan.next() + \" \");\n        }\n    }\n}\n</code></pre> <p>MappedByteBuffer\u672c\u8eab\u662f\u4e00\u4e2a\u62bd\u8c61\u7c7b\uff0c\u5176\u5b9e\u8fd9\u91cc\u771f\u6b63\u5b9e\u4f8b\u662fDirectByteBuffer\u3002</p>"},{"location":"languages/java/nio.html#directbytebuffer","title":"DirectByteBuffer","text":"<p><code>unsafe.allocateMemory(size)</code> native\u65b9\u6cd5\uff0c\u901a\u8fc7C\u7684malloc\u6765\u8fdb\u884c\u5206\u914d\uff08<code>brk</code>\u7cfb\u7edf\u8c03\u7528\uff09\uff1b</p> <p><code>DirectByteBuffer</code>\uff1a\u5806\u5916\u5185\u5b58\uff0c\u7ee7\u627f\u4e8eMappedByteBuffer\uff0c\u4e0d\u662fJVM\u5806\u5185\u5b58</p> <ul> <li>\u76f4\u63a5\u7684\u6587\u4ef6\u62f7\u8d1d\u64cd\u4f5c\uff0c\u6216\u8005I/O\u64cd\u4f5c\u3002\u76f4\u63a5\u4f7f\u7528\u5806\u5916\u5185\u5b58\u5c31\u80fd\u5c11\u53bb\u5185\u5b58\u4ece\u7528\u6237\u5185\u5b58\u62f7\u8d1d\u5230\u7cfb\u7edf\u5185\u5b58\u7684\u64cd\u4f5c</li> </ul> <pre><code>ByteBuffer directByteBuffer = ByteBuffer.allocateDirect(100);\n</code></pre> <p>C \u548c Java\u4e2d\u8fdb\u884c DirectBuffer \u5171\u4eab\u4f7f\u7528\uff1a</p> <p>\u793a\u4f8b\u4ee3\u7801\uff1adirect memory\u5728C/Java\u5171\u4eab</p> <pre><code>import java.nio.ByteBuffer;\n\npublic class DirectBufferExample {\n    public static native void processBuffer(ByteBuffer buffer);\n\n    public static void main(String[] args) {\n        ByteBuffer buffer = ByteBuffer.allocateDirect(1024);\n        processBuffer(buffer);\n    }\n\n    static {\n        System.loadLibrary(\"example\");\n    }\n}\n</code></pre> <pre><code>#include &lt;jni.h&gt;\n\nJNIEXPORT void JNICALL Java_DirectBufferExample_processBuffer(JNIEnv *env, jobject obj, jobject buffer) {\n    char* data = (char*) (*env)-&gt;GetDirectBufferAddress(env, buffer);\n    jint capacity = (*env)-&gt;GetDirectBufferCapacity(env, buffer);\n\n    // \u8bbf\u95ee\u7f13\u51b2\u533a\u5e76\u8fdb\u884c\u5904\u7406\n    for (int i = 0; i &lt; capacity; i++) {\n        data[i] = (char) (i % 256);\n    }\n}\n</code></pre>"},{"location":"languages/java/nio.html#channel","title":"\u901a\u9053 Channel","text":"<p>Channel \u662f\u4e00\u4e2a\u901a\u9053\uff0c\u53ef\u4ee5\u901a\u8fc7\u5b83\u8bfb\u53d6\u548c\u5199\u5165\u6570\u636e\u3002</p> <p>\u901a\u9053\u4e0e\u6d41\u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u901a\u9053\u662f\u53cc\u5411\u7684\uff0c\u6d41\u53ea\u662f\u5728\u4e00\u4e2a\u65b9\u5411\u4e0a\u79fb\u52a8\uff0c\u800c\u4e14\u901a\u9053\u53ef\u4ee5\u7528\u4e8e\u8bfb\u3001\u5199\u6216\u8005\u540c\u65f6\u7528\u4e8e\u8bfb\u5199\u3002</p>"},{"location":"languages/java/nio.html#channel-to-channel","title":"Channel-to-Channel\u4f20\u8f93","text":"<p>\u7ecf\u5e38\u9700\u8981\u4ece\u4e00\u4e2a\u4f4d\u7f6e\u5c06\u6587\u4ef6\u4f20\u8f93\u5230\u53e6\u5916\u4e00\u4e2a\u4f4d\u7f6e\uff0cFileChannel\u63d0\u4f9b\u4e86transferTo()\u65b9\u6cd5\u7528\u6765\u63d0\u9ad8\u4f20\u8f93\u7684\u6548\u7387\uff1a</p> <ul> <li>\u907f\u514d\u6570\u636e\u5728\u7f13\u51b2\u533a\u7684\u62f7\u8d1d\u5f00\u9500\uff1b</li> </ul> <pre><code>public class ChannelTransfer {\n    public static void main(String[] argv) throws Exception {\n        String files[]=new String[1];\n        files[0]=\"D://db.txt\";\n        catFiles(Channels.newChannel(System.out), files);\n    }\n\n    private static void catFiles(WritableByteChannel target, String[] files)\n            throws Exception {\n        for (int i = 0; i &lt; files.length; i++) {\n            FileInputStream fis = new FileInputStream(files[i]);\n            FileChannel channel = fis.getChannel();\n            // \u91cd\u70b9\n            channel.transferTo(0, channel.size(), target);\n            channel.close();\n            fis.close();\n        }\n    }\n}\n</code></pre>"},{"location":"languages/java/nio.html#selector","title":"\u591a\u8def\u590d\u7528\u5668 Selector","text":"<p>Selector \u4f1a\u4e0d\u65ad\u5730\u8f6e\u8be2\u6ce8\u518c\u5728\u5176\u4e0a\u7684 Channel\uff0c\u5982\u679c\u67d0\u4e2a Channel \u4e0a\u9762\u6709\u65b0\u7684 TCP \u8fde\u63a5\u63a5\u5165\u3001\u8bfb\u548c\u5199\u4e8b\u4ef6\uff0c\u8fd9\u4e2a Channel \u5c31\u5904\u4e8e\u5c31\u7eea\u72b6\u6001\uff0c\u4f1a\u88ab Selector \u8f6e\u8be2\u51fa\u6765\uff0c\u7136\u540e\u901a\u8fc7 SelectionKey \u53ef\u4ee5\u83b7\u53d6\u5c31\u7eea Channel \u7684\u96c6\u5408\uff0c\u8fdb\u884c\u540e\u7eed\u7684 I/O \u64cd\u4f5c\u3002</p>"},{"location":"languages/java/nio.html#netty","title":"Netty\u4e2d\u96f6\u62f7\u8d1d","text":"<p>Zero\u62f7\u8d1d\u7684\u7ec6\u8282\uff0c\u89c1\u8be5\u6587\u6863\u3002</p>"},{"location":"languages/java/nio.html#_1","title":"\u907f\u514d\u6570\u636e\u6d41\u7ecf\u7528\u6237\u7a7a\u95f4","text":"<p>\u5373OS\u4e2d\u7684\u96f6\u62f7\u8d1d\uff1a</p> <ul> <li>Netty\u7684\u6587\u4ef6\u4f20\u8f93\u8c03\u7528FileRegion\u5305\u88c5\u7684transferTo\u65b9\u6cd5\uff0c\u53ef\u4ee5\u76f4\u63a5\u5c06\u6587\u4ef6\u7f13\u51b2\u533a\u7684\u6570\u636e\u53d1\u9001\u5230\u76ee\u6807Channel\uff0c\u907f\u514d\u901a\u8fc7\u5faa\u73afwrite\u65b9\u5f0f\u5bfc\u81f4\u7684\u5185\u5b58\u62f7\u8d1d\u95ee\u9898\uff0cFileRegion\u5e95\u5c42\u8c03\u7528NIO FileChannel\u7684transferTo\u51fd\u6570\uff1b</li> </ul>"},{"location":"languages/java/nio.html#jvm-heapc-heap","title":"\u907f\u514d\u6570\u636e\u4eceJVM Heap\u5230C Heap\u7684\u62f7\u8d1d","text":"<p>\u5728JVM\u5c42\u9762\uff0c\u6bcf\u5f53\u7a0b\u5e8f\u9700\u8981\u6267\u884c\u4e00\u4e2aI/O\u64cd\u4f5c\u65f6\uff0c\u90fd\u9700\u8981\u5c06\u6570\u636e\u5148\u4eceJVM\u7ba1\u7406\u7684\u5806\u5185\u5b58\u590d\u5236\u5230\u4f7f\u7528C malloc()\u6216\u7c7b\u4f3c\u51fd\u6570\u5206\u914d\u7684Heap\u5185\u5b58\u4e2d\u624d\u80fd\u591f\u89e6\u53d1\u7cfb\u7edf\u8c03\u7528\u5b8c\u6210\u64cd\u4f5c\uff0c\u8fd9\u90e8\u5206\u5185\u5b58\u7ad9\u5728Java\u7a0b\u5e8f\u7684\u89c6\u89d2\u6765\u770b\u5c31\u662f\u5806\u5916\u5185\u5b58\uff0c\u4f46\u662f\u4ee5\u64cd\u4f5c\u7cfb\u7edf\u7684\u89c6\u89d2\u6765\u770b\u5176\u5b9e\u90fd\u5c5e\u4e8e\u8fdb\u7a0b\u7684\u5806\u533a</p> <ul> <li>Netty\u7684\u63a5\u6536\u548c\u53d1\u9001ByteBuffer\u4f7f\u7528\u76f4\u63a5\u5185\u5b58\u8fdb\u884cSocket\u8bfb\u5199\uff0c\u4e0d\u9700\u8981\u8fdb\u884c\u5b57\u8282\u7f13\u51b2\u533a\u7684\u4e8c\u6b21\u62f7\u8d1d\u3002</li> <li>\u5982\u679c\u4f7f\u7528JVM\u7684\u5806\u5185\u5b58\u8fdb\u884cSocket\u8bfb\u5199\uff0cJVM\u4f1a\u5c06\u5806\u5185\u5b58Buffer\u62f7\u8d1d\u4e00\u4efd\u5230\u76f4\u63a5\u5185\u5b58\u4e2d\uff0c\u7136\u540e\u624d\u5199\u5165Socket\u4e2d\u3002\u76f8\u6bd4\u4e8e\u4f7f\u7528\u76f4\u63a5\u5185\u5b58\uff0c\u6d88\u606f\u5728\u53d1\u9001\u8fc7\u7a0b\u4e2d\u591a\u4e86\u4e00\u6b21\u7f13\u51b2\u533a\u7684\u5185\u5b58\u62f7\u8d1d\uff1b</li> </ul>"},{"location":"languages/java/nio.html#_2","title":"\u51cf\u5c11\u6570\u636e\u5728\u7528\u6237\u7a7a\u95f4\u7684\u591a\u6b21\u62f7\u8d1d","text":"<ul> <li>Netty\u63d0\u4f9bCompositeByteBuf\u7c7b\uff0c\u53ef\u4ee5\u5c06\u591a\u4e2aByteBuf\u5408\u5e76\u4e3a\u4e00\u4e2a\u903b\u8f91\u4e0a\u7684ByteBuf, \u907f\u514d\u4e86\u5404\u4e2aByteBuf\u4e4b\u95f4\u7684\u62f7\u8d1d\uff1b</li> <li>\u901a\u8fc7wrap\u64cd\u4f5c, \u6211\u4eec\u53ef\u4ee5\u5c06byte[]\u6570\u7ec4\u3001ByteBuf\u3001ByteBuffer\u7b49\u5305\u88c5\u6210\u4e00\u4e2aNetty ByteBuf\u5bf9\u8c61, \u8fdb\u800c\u907f\u514d\u62f7\u8d1d\u64cd\u4f5c\uff1b</li> <li>ByteBuf\u652f\u6301slice\u64cd\u4f5c\uff0c\u53ef\u4ee5\u5c06ByteBuf\u5206\u89e3\u4e3a\u591a\u4e2a\u5171\u4eab\u540c\u4e00\u4e2a\u5b58\u50a8\u533a\u57df\u7684ByteBuf\uff0c\u907f\u514d\u5185\u5b58\u7684\u62f7\u8d1d\u3002</li> </ul>"},{"location":"languages/java/process.html","title":"\u8fdb\u7a0b","text":"<p>\u6d4b\u8bd5\u4ee3\u7801\u89c1\u4ee3\u7801\u5e93</p>"},{"location":"languages/java/process.html#_2","title":"\u5b50\u8fdb\u7a0b","text":"<p>Process blocking reason: The input stream and the error stream are separated, and if they are not processed, blocking will occur.</p> <ul> <li>\u521b\u5efa\u7684\u5b50\u8fdb\u7a0b\u7684\u6240\u6709\u6807\u51c6 io\uff08\u5373 stdin\uff0cstdout\uff0cstderr\uff09\u64cd\u4f5c\u901a\u8fc7\u4e09\u4e2a\u6d41 (getOutputStream()\uff0cgetInputStream()\uff0cgetErrorStream()) \u91cd\u5b9a\u5411\u5230\u7236\u8fdb\u7a0b\uff1b</li> <li>\u6709\u4e9b\u672c\u673a\u5e73\u53f0\u4ec5\u9488\u5bf9\u6807\u51c6\u8f93\u5165\u548c\u8f93\u51fa\u6d41\u63d0\u4f9b\u6709\u9650\u7684\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u5982\u679c\u8bfb\u5199\u5b50\u8fdb\u7a0b\u7684\u8f93\u51fa\u6d41\u6216\u8f93\u5165\u6d41\u8fc5\u901f\u51fa\u73b0\u5931\u8d25\uff0c\u5219\u53ef\u80fd\u5bfc\u81f4\u5b50\u8fdb\u7a0b\u963b\u585e\uff0c\u751a\u81f3\u4ea7\u751f\u6b7b\u9501\uff1b</li> <li>\u6807\u51c6\u8f93\u51fa\u6d41\u548c\u9519\u8bef\u6d41\u5982\u679c\u5904\u7406\u4e0d\u5f53\uff0c\u5176\u7f13\u51b2\u533a\u4e0d\u80fd\u88ab\u53ca\u65f6\u6e05\u9664\u800c\u88ab\u585e\u6ee1\uff0c\u5219\u8fdb\u7a0b\u88ab\u963b\u585e\uff0c\u5373\u4f7f\u8c03\u7528Process.destory()\u4e5f\u672a\u5fc5\u80fd\u9500\u6bc1\u88ab\u963b\u585e\u7684\u5b50\u8fdb\u7a0b</li> </ul> <p>\u89e3\u51b3\u65b9\u6848\uff1a</p> <ul> <li>\u5e76\u53d1\u83b7\u53d6Process\u7684\u8f93\u51fa\u6d41\u548c\u9519\u8bef\u6d41\uff1b</li> <li>\u5c06\u9519\u8bef\u6d41\u91cd\u5b9a\u5411\u5230\u8f93\u51fa\u6d41\uff1b</li> </ul>"},{"location":"languages/java/process.html#_3","title":"\u73af\u5883\u53d8\u91cf","text":"<p>\u9ed8\u8ba4\u662f\u7ee7\u627f Java \u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\uff08\u7b49\u4ef7\u4e8e System.getEnv\uff09</p>"},{"location":"languages/java/process.html#kill","title":"\u7236\u8fdb\u7a0b\u9000\u51fa\u65f6Kill\u5b50\u8fdb\u7a0b","text":"<p>\u901a\u8fc7ProcessBuilder\u542f\u52a8JVM\uff0c\u5e76\u6ce8\u518ckill\u7236\u8fdb\u7a0b\u65f6\u6267\u884c\u7684\u7ebf\u7a0b(kill\u5b50\u7ebf\u7a0b)\uff1b</p> <p>\u901a\u8fc7ProcessBuilder\u6267\u884cshell\u547d\u4ee4(\u5982\u518d\u542f\u52a8java\u8fdb\u7a0b\uff09\uff0c\u6b64\u65f6\u901a\u8fc7jps\u67e5\u770b\u4f1a\u770b\u5230\u4e24\u4e2ajava\u8fdb\u7a0b\uff1b\u5982\u679ckill\u6389\u7236\u8fdb\u7a0b\uff0c\u5b50\u8fdb\u7a0b\u4e0d\u4f1a\u968f\u4e4b\u6d88\u4ea1\uff0c\u82e5\u9700\u8981\uff0c\u9700\u6ce8\u518c\uff08\u89c1\u4e0b\u9762\u4ee3\u7801\uff09\uff1b</p> <pre><code>public class TestRunJVM {\n    public static void main(String[] args) {\n        ProcessBuilder pb = new ProcessBuilder(\"jvisualvm\");\n        try {\n            final Process process = pb.start();\n            // destroy child process\uff0c\u5bf9\u4e8e kill -9 \u4e0d\u751f\u6548\n            Runtime.getRuntime().addShutdownHook(new Thread() {\n                public void run() {\n                    if (process != null) {\n                        process.destroy();\n                        try {\n                            process.waitFor();\n                        } catch (Exception e){\n                            System.out.println(\"ERROR2\" + e.toString());\n                        }\n                    }\n                }\n            });\n            process.waitFor();\n        } catch (Exception e) {\n            System.out.println(\"ERROR\" + e.toString());\n        }\n    }\n}\n</code></pre>"},{"location":"languages/java/security.html","title":"\u5b89\u5168","text":""},{"location":"languages/java/security.html#accesscontroller","title":"AccessController","text":"<p>\u7c7bjava.security.AccessController\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9ed8\u8ba4\u7684\u5b89\u5168\u7b56\u7565\u6267\u884c\u673a\u5236\uff0c\u5b83\u4f7f\u7528\u6808\u68c0\u67e5\u6765\u51b3\u5b9a\u6f5c\u5728\u4e0d\u5b89\u5168\u7684\u64cd\u4f5c\u662f\u5426\u88ab\u5141\u8bb8\u3002</p> <p>\u6bcf\u4e00\u4e2a\u6808\u5e27\u4ee3\u8868\u4e86\u7531\u5f53\u524d\u7ebf\u7a0b\u8c03\u7528\u7684\u67d0\u4e2a\u65b9\u6cd5\uff0c\u6bcf\u4e00\u4e2a\u65b9\u6cd5\u662f\u5728\u67d0\u4e2a\u7c7b\u4e2d\u5b9a\u4e49\u7684\uff0c\u6bcf\u4e00\u4e2a\u7c7b\u53c8\u5c5e\u4e8e\u67d0\u4e2a\u4fdd\u62a4\u57df\uff0c\u6bcf\u4e2a\u4fdd\u62a4\u57df\u5305\u542b\u4e00\u4e9b\u6743\u9650\u3002\u56e0\u6b64\uff0c\u6bcf\u4e2a\u6808\u5e27\u95f4\u63a5\u5730\u548c\u4e00\u4e9b\u6743\u9650\u76f8\u5173\u3002</p> <p>Java\u9ed8\u8ba4\u4e0d\u6253\u5f00\u5b89\u5168\u68c0\u67e5\uff0c\u5982\u679c\u4e0d\u6253\u5f00\uff0c\u672c\u5730\u7a0b\u5e8f\u62e5\u6709\u6240\u6709\u6743\u9650\uff1a</p> <p>\u4f8b\u5982\u5bf9\u4e8eFile::createNewFile\uff0c\u83b7\u53d6SecurityManager\uff0c\u68c0\u67e5\u662f\u5426\u6709\u5bf9\u6587\u4ef6\u7684\u5199\u6743\u9650\uff0c\u6700\u7ec8\u901a\u8fc7AccessController::checkPermission\u68c0\u67e5\uff1b</p> <ul> <li> <p>\u9759\u6001\u65b9\u6cd5checkPermission()\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u51b3\u5b9a\u4e00\u4e2a\u7279\u5b9a\u7684\u64cd\u4f5c\u80fd\u5426\u88ab\u5141\u8bb8\u3002</p> </li> <li> <p>Java SDK \u7ed9\u57df\u63d0\u4f9b\u4e86 doPrivileged \u65b9\u6cd5\uff0c\u8ba9\u7a0b\u5e8f\u7a81\u7834\u5f53\u524d\u57df\u6743\u9650\u9650\u5236\uff0c\u4e34\u65f6\u6269\u5927\u8bbf\u95ee\u6743\u9650\u3002</p> </li> </ul> <pre><code>AccessController.doPrivileged(new PrivilegedAction() {\n    public Object run() {\n      try {\n        Method getCleanerMethod = buffer.getClass().getMethod(\"cleaner\", new Class[0]);\n        getCleanerMethod.setAccessible(true);\n        sun.misc.Cleaner cleaner = (sun.misc.Cleaner)\n        getCleanerMethod.invoke(byteBuffer, new Object[0]);\n        cleaner.clean();\n      } catch (Exception e) {\n        e.printStackTrace();\n      }\n      return null;\n    }\n});\n</code></pre>"},{"location":"languages/java/security.html#jaas","title":"JAAS","text":"<p>JAAS\u662fJava Authentication and Authorization Service\u7684\u7f29\u5199\uff0c\u63d0\u4f9b\u4e86\u8ba4\u8bc1\u4e0e\u6388\u6743\u76f8\u5173\u7684\u670d\u52a1\u6846\u67b6\u4e0e\u63a5\u53e3\u5b9a\u4e49:</p> <ul> <li>\u8ba4\u8bc1\uff1a\u8ba4\u8bc1\u4e3b\u8981\u662f\u9a8c\u8bc1\u4e00\u4e2a\u7528\u6237\u7684\u8eab\u4efd\u3002</li> <li>\u6388\u6743\uff1a\u6388\u6743\u7528\u6237\u8bbf\u95ee\u6216\u64cd\u4f5c\u67d0\u4e9b\u654f\u611f\u7684\u8d44\u6e90\u3002</li> </ul>"},{"location":"languages/java/security.html#subject","title":"Subject","text":"<p>Subject\u6765\u63cf\u8ff0\u8fd9\u4e2a\u8d44\u6e90\u8bf7\u6c42\u4e3b\u4f53\u4e0e\u5b89\u5168\u8bbf\u95ee\u76f8\u5173\u7684\u4fe1\u606f\uff0cSubject\u901a\u5e38\u662f\u6307\u4e00\u4e2a\u5bf9\u8c61\u5b9e\u4f53\uff0c\u6216\u8005\u4e00\u4e2a\u670d\u52a1\u3002 Subject\u4e2d\u6240\u5173\u8054\u7684\u4fe1\u606f\uff1a</p> <ul> <li>\u8eab\u4efd\u4fe1\u606f</li> <li>\u5bc6\u7801\u4fe1\u606f</li> <li>\u52a0\u5bc6\u5bc6\u94a5/\u51ed\u636e\u4fe1\u606f</li> </ul> <p>\u4e00\u4e2aSubject\u53ef\u80fd\u62e5\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u8eab\u4efd\uff0c\u4e00\u4e2a\u8eab\u4efd\u88ab\u79f0\u4e4b\u4e3aPrincipal\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u4e2aSubject\u53ef\u80fd\u5173\u8054\u4e00\u4e2a\u6216\u591a\u4e2aPrincipals\u3002</p> <p>\u4e00\u4e2aSubject\u53ef\u80fd\u6d89\u53ca\u4e0e\u5b89\u5168\u6709\u5173\u7684\u51ed\u636e\u4fe1\u606f(\u5bc6\u94a5/\u7968\u636e)\uff0c\u79f0\u4e4b\u4e3aCredentials\u3002</p>"},{"location":"languages/java/security.html#logincontext","title":"LoginContext","text":"<p>\u8ba4\u8bc1\u4e0a\u4e0b\u6587\u4fe1\u606f\uff0c\u63d0\u4f9b\u4e86\u9488\u5bf9Subject\u5bf9\u8c61\u8fdb\u884c\u8ba4\u8bc1\u7684\u57fa\u7840\u65b9\u6cd5\uff0c\u6bcf\u4e00\u4e2aLoginContext\u90fd\u5173\u8054\u4e00\u4e2aContext Name\u3002</p> <ul> <li> <p>login \u767b\u5f55/\u8ba4\u8bc1\uff0c\u8be5\u8fc7\u7a0b\u7531\u5177\u4f53\u7684LoginModule\u4ee3\u7406\u5b8c\u6210\u3002</p> </li> <li> <p>logout \u767b\u51fa</p> </li> <li> <p>getSubject \u83b7\u53d6\u8ba4\u8bc1\u4e4b\u540e\u6240\u521b\u5efa\u7684Subject\u5bf9\u8c61\u4fe1\u606f</p> </li> </ul> <p>\u521d\u59cb\u5316\u4e00\u4e2aLoginContext\u5bf9\u8c61\u65f6\uff0c\u53ef\u4ee5\u4f20\u5165\u5982\u4e0b\u4e00\u4e9b\u53c2\u6570\uff1a</p> <ul> <li>Context Name[\u5fc5\u9009]</li> <li>Subject[\u53ef\u9009]</li> <li>CallbackHandler[\u53ef\u9009]</li> <li>Configuration[\u53ef\u9009]</li> </ul>"},{"location":"languages/java/security.html#loginmodule","title":"LoginModule","text":"<p>LoginModule\u63d0\u4f9b\u4e86\u767b\u5f55/\u8ba4\u8bc1\u7684\u57fa\u7840\u63a5\u53e3\u5b9a\u4e49\uff0c\u6240\u6709\u7684\u8ba4\u8bc1\u670d\u52a1\u90fd\u9700\u8981\u5b9e\u73b0\u8be5\u63a5\u53e3\u3002\u4e00\u4e9b\u5178\u578b\u7684\u5b9e\u73b0\u6a21\u5757\u5305\u62ec\uff1a</p> <ul> <li> <p><code>Krb5LoginModule</code> \u57fa\u4e8eKerberos\u7684\u767b\u5f55/\u8ba4\u8bc1\u670d\u52a1\u6a21\u5757</p> </li> <li> <p><code>JndiLoginModule</code> \u57fa\u4e8e\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684\u767b\u5f55/\u8ba4\u8bc1\u670d\u52a1\u6a21\u5757</p> </li> <li> <p><code>KeyStoreLoginModule</code> \u57fa\u4e8eKeyStore\u7684\u767b\u5f55/\u8ba4\u8bc1\u670d\u52a1\u6a21\u5757</p> </li> </ul> <p>\u4e3b\u8981\u65b9\u6cd5\u4e3a<code>login</code>\u4e0e<code>commit</code>\uff1a</p>"},{"location":"languages/java/security.html#login","title":"login","text":"<p>\u5bf9Subject\u8fdb\u884c\u8ba4\u8bc1\u3002</p> <p>\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u4e3b\u8981\u6d89\u53ca\u5230\u7528\u6237\u540d\u548c\u5bc6\u7801\u4fe1\u606f\u63d0\u793a\uff0c\u6821\u9a8c\u7528\u6237\u5bc6\u7801\u3002\u8ba4\u8bc1\u7ed3\u679c\u5c06\u4f1a\u5728LoginModule\u5c42\u9762\u6682\u65f6\u4fdd\u5b58\u3002</p>"},{"location":"languages/java/security.html#commit","title":"commit","text":"<p>Commit\u8fc7\u7a0b\u9996\u5148\u786e\u8ba4LoginModule\u4e2d\u4fdd\u5b58\u7684\u8ba4\u8bc1\u7ed3\u679c\u3002\u8ba4\u8bc1\u6210\u529f\u4e4b\u540e\uff0cCommit\u65b9\u6cd5\u5c06Subject\u5185\u5bf9\u5e94\u7684Principals\u4ee5\u53caCredentials\u5173\u8054\u8d77\u6765\u3002\u5982\u679cLogin\u65b9\u6cd5\u8ba4\u8bc1\u5931\u8d25\u7684\u8bdd\uff0c\u5219\u8be5\u65b9\u6cd5\u5c06\u4f1a\u6e05\u7406\u5728LoginModule\u4e2d\u4fdd\u5b58\u7684\u8ba4\u8bc1\u7ed3\u679c\u4fe1\u606f\u3002</p>"},{"location":"languages/java/serialize.html","title":"\u5e8f\u5217\u5316","text":"<p>\u793a\u4f8b\u9879\u76ee</p> <p>\u5e8f\u5217\u5316 (Serialization)\u662f\u5c06\u5bf9\u8c61\u7684\u72b6\u6001\u4fe1\u606f\u8f6c\u6362\u4e3a\u53ef\u4ee5\u5b58\u50a8\u6216\u4f20\u8f93\u7684\u5f62\u5f0f\u7684\u8fc7\u7a0b\u3002</p> <ul> <li>\u7279\u5b9a\u8bed\u8a00\uff1a\u5982 JDK \u5e8f\u5217\u5316\uff0cKryo \u5e8f\u5217\u5316\uff1b</li> <li>\u8de8\u8bed\u8a00\uff1a\u5982 Hessian, Protobuf, Thrift, Avro, Json \u7b49\uff1b</li> </ul>"},{"location":"languages/java/serialize.html#jdk","title":"JDK","text":"<p>\u5e8f\u5217\u7248\u672cUID\uff08serial version UID\uff09\uff0c\u6d41\u7684\u552f\u4e00\u6807\u8bc6\u7b26\uff1a</p> <ul> <li>\u9ed8\u8ba4\u6839\u636e\u7c7b\u540d\u79f0\u3001\u5b9e\u73b0\u63a5\u53e3\u3001\u6210\u5458\u7b49\u4fe1\u606f\u81ea\u52a8\u751f\u6210\uff0c\u56e0\u6b64\u5f88\u5bb9\u6613\u51fa\u73b0\u517c\u5bb9\u6027\u95ee\u9898\uff1b</li> <li><code>transient</code>\u4fee\u9970\u7684\u53d8\u91cf\uff0c\u9ed8\u8ba4\u5e8f\u5217\u5316\u4e0d\u4f1a\u8fdb\u884c\u5e8f\u5217\u5316\uff1b</li> </ul>"},{"location":"languages/java/serialize.html#_2","title":"\u81ea\u5b9a\u4e49\u5e8f\u5217\u5316","text":""},{"location":"languages/java/serialize.html#readobject-writeobject","title":"readObject &amp; writeObject","text":"<p>Java\u5b9e\u73b0\u5e8f\u5217\u5316\uff0c\u5b9e\u73b0<code>Serializable</code>\u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u4e2d\u6ca1\u6709\u4efb\u4f55\u7684\u65b9\u6cd5\uff0c\u4f46\u662f\u8981\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684\u5e8f\u5217\u5316\u65b9\u6cd5\u65f6\uff0c\u9700\u8981\u91cd\u8f7d<code>readObject</code>, <code>writeObject</code>\u4e14\u90fd\u662fprivate</p> <ul> <li>\u5f53<code>ObjectOutputStream</code>\u8c03\u7528<code>writeObject</code>\u65f6\uff0c\u4f1a\u6839\u636e<code>instanceof Serializable</code>\uff0c\u4ee5\u53ca\u7c7b\u7684<code>ObjectStreamClass</code>\uff08\u786c\u7f16\u7801\u8bfb\u53d6\u8be5\u4e09\u4e2a\u65b9\u6cd5\uff09\uff0c\u5224\u65ad\u662f\u5426\u8c03\u7528\u7528\u6237\u5b9e\u73b0\u7684\u65b9\u6cd5\u8fd8\u662f\u9ed8\u8ba4\u7684\u5e8f\u5217\u5316\u65b9\u6cd5\uff1b</li> </ul> <pre><code>private void writeObject(java.io.ObjectOutputStream out) throws IOException\nprivate void readObject(java.io.ObjectInputStream in) throws IOException, ClassNotFoundException;\n</code></pre> <p>\u9664\u4e86\u57fa\u672c\u7684<code>writeObject</code>\u548c<code>readObject</code>\u4e4b\u5916\uff0c\u4ee5\u4e0b\u4e09\u4e2a\u51fd\u6570\u4e5f\u53ef\u4ee5\u63a7\u5236\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\uff1a</p> <pre><code>// readObjectNoData is used in an unusual case where the serializer (writer) is working with a version of a class with no base class, whereas the deserializer (reader) of the class has a version of the class that IS based on a subclass. The subclass can say \"it's ok if my base class isn't in the serialized data - just make an empty one\" by implementing readObjectNoData.\n// \u5e8f\u5217\u5316\u65f6\u7528\u65e7\u7c7b\uff0c\u53cd\u5e8f\u5217\u5316\u7528\u65b0\u7248\u672c\u7c7b\uff08\u4e14\u53d8\u6210\u5b50\u7c7b\uff09\uff0c\u53ef\u4ee5\u5728\u7236\u7c7b\u4e0a\u5b9a\u4e49\u8be5\u65b9\u6cd5\uff0c\u751f\u6210\u9ed8\u8ba4\u7684\u7236\u5bf9\u8c61\u7684\u6210\u5458\u503c\nprivate void readObjectNoData() throws ObjectStreamException;\n\n// \u5b9e\u9645\u5e8f\u5217\u5316\u7684\u5bf9\u8c61\u5c06\u662f\u4f5c\u4e3awriteReplace\u65b9\u6cd5\u8fd4\u56de\u503c\u7684\u5bf9\u8c61\uff0c\u800c\u4e14\u5e8f\u5217\u5316\u8fc7\u7a0b\u7684\u4f9d\u636e\u662f\u5b9e\u9645\u88ab\u5e8f\u5217\u5316\u5bf9\u8c61\u7684\u5e8f\u5217\u5316\u5b9e\u73b0\nprivate Object writeReplace()\n\n// \u518dreadObject()\u8c03\u7528\u4e4b\u540e\u81ea\u52a8\u8c03\u7528\uff0c \u5c06\u53cd\u5e8f\u5217\u5316\u4e4b\u540e\u7684\u5bf9\u8c61\u66ff\u6362\u6389\uff08\u53ef\u7528\u4e8e\u5355\u4f8b/\u679a\u4e3e\u7b49\u573a\u666f\uff09\nObject readResolve() throws ObjectStreamException;\n</code></pre>"},{"location":"languages/java/serialize.html#writereplace-readresolve","title":"writeReplace &amp; readResolve","text":"<p>Serializable\u8fd8\u6709\u4e24\u4e2a\u6807\u8bb0\u63a5\u53e3\u65b9\u6cd5\u53ef\u4ee5\u5b9e\u73b0\u5e8f\u5217\u5316\u5bf9\u8c61\u7684\u66ff\u6362\uff0c\u5373<code>writeReplace</code>\u548c<code>readResolve</code>:</p> <ul> <li><code>Object writeReplace() throws ObjectStreamException</code></li> <li>\u5e8f\u5217\u5316\u65f6\u4f1a\u5148\u8c03\u7528<code>writeReplace</code>\u65b9\u6cd5\u5c06\u5f53\u524d\u5bf9\u8c61\u66ff\u6362\u6210\u53e6\u4e00\u4e2a\u5bf9\u8c61\uff08\u8be5\u65b9\u6cd5\u4f1a\u8fd4\u56de\u66ff\u6362\u540e\u7684\u5bf9\u8c61\uff0c\u66ff\u6362\u540e\u7684\u5bf9\u8c61\u5fc5\u987b\u53ef\u5e8f\u5217\u5316\uff09\u5e76\u5c06\u5176\u5199\u5165\u6d41\u4e2d\uff0c\u8c03\u7528\u8fc7\u7a0b\u4e3a <code>writeObject(writeReplace())</code></li> <li><code>Object readResolve() throws ObjectStreamException</code></li> <li><code>readResolve</code>\u4f1a\u5728<code>readObject</code>\u8c03\u7528\u4e4b\u540e\u81ea\u52a8\u8c03\u7528\uff0c<code>readResolve</code>\u91cc\u518d\u5bf9\u8be5\u5bf9\u8c61\u8fdb\u884c\u4e00\u5b9a\u7684\u4fee\u6539\uff0c\u800c\u6700\u7ec8\u4fee\u6539\u540e\u7684\u7ed3\u679c\u5c06\u4f5c\u4e3a<code>readObject</code>\u7684\u8fd4\u56de\u7ed3\u679c\uff1b</li> <li>\u5e94\u7528\u5c31\u662f\u4fdd\u62a4\u6027\u6062\u590d\u5355\u4f8b\u7684\u5bf9\u8c61</li> <li>\u5bf9\u5355\u4f8b\u5bf9\u8c61\uff0c\u91cd\u5199<code>readResolve</code>\u65b9\u6cd5\uff0c\u4fdd\u8bc1\u8fd4\u56de\u7684\u662f\u7cfb\u7edf\u4e2d\u552f\u4e00\u7684\u5355\u4f8b\u3002</li> </ul>"},{"location":"languages/java/serialize.html#_3","title":"\u679a\u4e3e\u7c7b\u578b\u7684\u5e8f\u5217\u5316","text":"<p>\u5728\u679a\u4e3e\u7c7b\u578b\u7684\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u4e0a\uff0cJava\u505a\u4e86\u7279\u6b8a\u7684\u89c4\u5b9a\uff0c\u5373\u5728\u5e8f\u5217\u5316\u7684\u65f6\u5019Java\u4ec5\u4ec5\u662f\u5c06\u679a\u4e3e\u5bf9\u8c61\u7684name\u5c5e\u6027\u8f93\u51fa\u5230\u7ed3\u679c\u4e2d\uff0c\u53cd\u5e8f\u5217\u5316\u7684\u65f6\u5019\u5219\u662f\u901a\u8fc7java.lang.Enum\u7684valueOf\u65b9\u6cd5\u6765\u6839\u636e\u540d\u5b57\u67e5\u627e\u679a\u4e3e\u5bf9\u8c61\u3002</p> <p>\u540c\u65f6\uff0c\u7f16\u8bd1\u5668\u662f\u4e0d\u5141\u8bb8\u4efb\u4f55\u5bf9\u8fd9\u79cd\u5e8f\u5217\u5316\u673a\u5236\u7684\u5b9a\u5236\uff0c\u56e0\u6b64\u7981\u7528\u4e86writeObject\u3001readObject\u3001readObjectNoData\u3001writeReplace\u548creadResolve\u7b49\u65b9\u6cd5\u3002</p>"},{"location":"languages/java/serialize.html#lambda-todo","title":"Lambda \u8868\u8fbe\u5f0f\u7684\u5e8f\u5217\u5316\uff08TODO\uff09","text":"<pre><code>val writeReplace = closure.getClass.getDeclaredMethod(\"writeReplace\")\nwriteReplace.setAccessible(true)\nwriteReplace.invoke(closure).asInstanceOf[java.lang.invoke.SerializedLambda]\n</code></pre> <p>lambda \u4f1a\u751f\u6210\u5982\u4e0b\u5b57\u8282\u7801</p> <pre><code>// lambda\u751f\u6210\u7684\u5b57\u8282\u7801\n@FunctionalInterface\ninterface Print&lt;T&gt; {\n    public void print(T x);\n}\npublic class Lambda {  \n    public static void PrintString(String s, Print&lt;String&gt; print) {\n        print.print(s);\n    }\n    private static void lambda$0(String x) {\n        System.out.println(x);\n    }\n    final class $Lambda$1 implements Print{\n        @Override\n        public void print(Object x) {\n            lambda$0((String)x);\n        }\n    }\n    public static void main(String[] args) {\n        PrintString(\"test\", new Lambda().new $Lambda$1());\n    }\n}\n</code></pre>"},{"location":"languages/java/serialize.html#kryo","title":"Kryo","text":"<p>Java \u4e3b\u6d41\u7684\u5e8f\u5217\u5316\u6846\u67b6\u3002</p>"},{"location":"languages/java/serialize.html#_4","title":"\u7ebf\u7a0b","text":"<p>\u975e\u7ebf\u7a0b\u5b89\u5168\uff0c<code>Each thread should have its own Kryo, Input, and Output instances.</code></p> <p>\u4f7f\u7528  ThreadLocal \u6216\u8005 Pool \u3002</p>"},{"location":"languages/java/serialize.html#hessian","title":"Hessian","text":"<p>\u8de8\u8bed\u8a00\uff0c\u4e00\u79cd\u52a8\u6001\u7c7b\u578b\u3001\u4e8c\u8fdb\u5236\u5e8f\u5217\u5316\u548c Web \u670d\u52a1\u534f\u8bae\uff0c\u4e13\u4e3a\u9762\u5411\u5bf9\u8c61\u7684\u4f20\u8f93\u800c\u8bbe\u8ba1</p> <p>\u6ce8\u610f\u5b50\u7c7b\u548c\u7236\u7c7b\u4e0d\u80fd\u6709\u540c\u540d\u5b57\u6bb5\uff0c\u5b50\u7c7b\u7684\u5c5e\u6027\u603b\u662f\u4f1a\u88ab\u7236\u7c7b\u7684\u8986\u76d6\uff1a</p> <ul> <li>\u5f53\u5e8f\u5217\u5316\u5bf9\u8c61\u662f\u4e00\u4e2a\u5bf9\u8c61\u7ee7\u627f\u53e6\u5916\u4e00\u4e2a\u5bf9\u8c61\u7684\u65f6\u5019\uff0c\u5f53\u4e00\u4e2a\u5c5e\u6027\u5728\u5b50\u7c7b\u548c\u6709\u4e00\u4e2a\u76f8\u540c\u5c5e\u6027\u7684\u65f6\u5019\uff0c\u53cd\u5e8f\u5217\u5316\u540e\u5b50\u7c7b\u5c5e\u6027\u603b\u662f\u4e3anull\u3002</li> </ul>"},{"location":"languages/java/spi.html","title":"SPI","text":"<p>SPI \u5168\u79f0\u4e3a (Service Provider Interface) \uff0c\u662fJDK\u5185\u7f6e\u7684\u4e00\u79cd\u670d\u52a1\u63d0\u4f9b\u53d1\u73b0\u673a\u5236\uff0c\u5728\u8fd0\u884c\u7684\u65f6\u5019\u52a8\u6001\u5bfb\u627e\u5b9e\u73b0\u7c7b\u3002</p> <p>SPI\u673a\u5236\u7684\u7ea6\u5b9a\uff1a</p> <ul> <li>\u5728META-INF/services/\u76ee\u5f55\u4e2d\u521b\u5efa\u4ee5\u63a5\u53e3\u5168\u9650\u5b9a\u540d\u547d\u540d\u7684\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u5185\u5bb9\u4e3aApi\u5177\u4f53\u5b9e\u73b0\u7c7b\u7684\u5168\u9650\u5b9a\u540d\uff1b</li> <li>\u4f7f\u7528ServiceLoader\u7c7b\u52a8\u6001\u52a0\u8f7dMETA-INF\u4e2d\u7684\u5b9e\u73b0\u7c7b\uff1b</li> <li>\u82e5SPI\u7684\u5b9e\u73b0\u7c7b\u4e3aJar\u5219\u9700\u8981\u653e\u5728\u4e3b\u7a0b\u5e8fclassPath\u4e2d\uff1b</li> <li>Api\u5177\u4f53\u5b9e\u73b0\u7c7b\u5fc5\u987b\u6709\u4e00\u4e2a\u4e0d\u5e26\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\uff1b</li> </ul> <p>\u57fa\u4e8e\u63a5\u53e3\u7684\u7f16\u7a0b\uff0b\u7b56\u7565\u6a21\u5f0f\uff0b\u914d\u7f6e\u6587\u4ef6\u7ec4\u5408\u5b9e\u73b0\u7684\u52a8\u6001\u52a0\u8f7d\u673a\u5236\u3002</p> <p>\u6848\u4f8b\uff1a</p> <ul> <li>\u6570\u636e\u5e93\u9a71\u52a8\u52a0\u8f7d\uff1b</li> <li>Slf4j\u5177\u4f53\u7684\u65e5\u5fd7\u5b9e\u73b0\u52a0\u8f7d\uff1b</li> <li>Spring\uff0cDubbo\u7b49\u3002</li> </ul> <p>\u867d\u7136ServiceLoader\u4e5f\u7b97\u662f\u4f7f\u7528\u7684\u5ef6\u8fdf\u52a0\u8f7d\uff0c\u4f46\u662f\u57fa\u672c\u53ea\u80fd\u901a\u8fc7\u904d\u5386\u5168\u90e8\u83b7\u53d6\uff0c\u4e5f\u5c31\u662f\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u5168\u90e8\u52a0\u8f7d\u5e76\u5b9e\u4f8b\u5316\u4e00\u904d\u3002</p> <p>\u5982\u679c\u591a\u4e2a\u5b9e\u73b0\u7c7b\uff0c\u9700\u8981\u81ea\u884c\u9009\u62e9\u54ea\u79cd\u5b9e\u73b0\uff08\u4e00\u822c\u662f\u5728\u63a5\u53e3\u4e2d\u5b9a\u4e49\u51fd\u6570\uff0c\u53ef\u4ee5\u63a5\u53d7\u54ea\u79cd\u7684schema\uff09\u3002</p>"},{"location":"languages/java/spi.html#_1","title":"\u4f7f\u7528","text":"<pre><code>// \u9ed8\u8ba4\u4f7f\u7528 \u7ebf\u7a0b\u7684 classloader\nfinal Iterator&lt;T&gt; iterator uploadCDN = ServiceLoader.load(UploadCDN.class).iterator();\n// \u53ef\u4ee5\u5b9a\u4e49\u591a\u4e2a\u5b9e\u73b0\uff0c\u5982\u679c\u67d0\u4e2a\u5b9e\u73b0\u7684\u7c7b\u7684\u4f9d\u8d56\u672a\u5f15\u5165\uff08\u4f1a\u62a5\u9519\uff09\uff0c\u5219\u7ee7\u7eed\u4e0b\u4e00\u4e2a\nwhile (iterator.hasNext()) {\n    try {\n        return iterator.next();\n    } catch (ServiceConfigurationError ignore) {\n        // ignore\n    }\n}\nreturn null;\n</code></pre>"},{"location":"languages/java/test.html","title":"Java \u4ee3\u7801\u6d4b\u8bd5","text":""},{"location":"languages/java/test.html#junit","title":"JUnit","text":"<p>Java \u5355\u5143\u6d4b\u8bd5\u3002Junit 5\uff0c\u6ce8\u91ca\u800c\u4e0d\u9700\u7ee7\u627f\u901a\u8fc7\u53cd\u5c04\u673a\u5236</p>"},{"location":"languages/java/test.html#_1","title":"\u547d\u4ee4\u8fd0\u884c","text":"<ul> <li>Java\uff1a<code>$ /path/to/java \u2013cp /path/to/junit.jar:. [classes to test]</code></li> <li>MVN\uff1a<code>mvn test \u2013Dtest=*SystemTest</code> \uff0c\u652f\u6301\u901a\u914d\u7b26    </li> </ul>"},{"location":"languages/java/test.html#_2","title":"\u6ce8\u89e3","text":"<p>\u6267\u884c\u987a\u5e8f\uff0cBeforeClass -&gt; constructor -&gt; Before -&gt; Test -&gt; After -&gt; AfterClass</p> <ul> <li> <p>@BeforeClass</p> </li> <li> <p>static\uff0c\u7c7b\u4f7f\u7528\u4e4b\u524d\uff0c\u53ea\u6267\u884c\u4e00\u6b21</p> </li> <li> <p>@Before</p> </li> <li> <p>\u5728\u5bf9\u8c61constructor\u8c03\u7528\u4e4b\u540e\uff0c\u591a\u5c11\u4e2aTest\uff0c\u6267\u884c\u591a\u5c11\u6b21</p> </li> <li> <p>@Test</p> </li> <li> <p>Test\u51fd\u6570\u4e4b\u95f4\u662f\u4e92\u76f8\u72ec\u7acb\u7684\uff0c\u4e0d\u4fdd\u8bc1\u6267\u884c\u987a\u5e8f\uff1b\u6bcf\u4e2aTest\u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\u7684\u5b9e\u4f8b\uff1b</p> </li> <li> <p>@Timeout(value = 10)\uff0c\u8868\u660e\u5982\u679cTest\u51fd\u6570\u4e0d\u572810 s\u5185\u5b8c\u6210\uff0c\u5219\u6d4b\u8bd5\u5931\u8d25\uff1b</p> </li> <li> <p>@After</p> </li> <li> <p>\u5728\u5bf9\u8c61\u6790\u6784\u4e4b\u524d\uff0c\u591a\u5c11\u4e2aTest\uff0c\u6267\u884c\u591a\u5c11\u6b21</p> </li> <li> <p>@AfterClass</p> </li> <li> <p>public static void\uff1b\u7c7b\u6790\u6784\u4e4b\u524d\uff0c\u53ea\u6267\u884c\u4e00\u6b21</p> </li> <li> <p>@Ignore</p> </li> <li> <p>\u5bf9\u4e8e@Test\u7684\u51fd\u6570\uff0c\u8868\u660e\u8be5\u51fd\u6570\u4e0d\u8fdb\u884c\u6d4b\u8bd5</p> </li> <li>@Runwith(Parameterized.class)\uff0c\u9ed8\u8ba4\u662fJunit4</li> <li>\u4f7f\u7528RunWith\u6ce8\u89e3\u6539\u53d8JUnit\u7684\u9ed8\u8ba4\u6267\u884c\u7c7b\uff0c\u5e76\u5b9e\u73b0\u81ea\u5df2\u7684Listener\u5728\u5e73\u65f6\u7684\u5355\u5143\u6d4b\u8bd5;JUnit\u5141\u8bb8\u7528\u6237\u6307\u5b9a\u5176\u5b83\u7684\u5355\u5143\u6d4b\u8bd5\u6267\u884c\u7c7b\uff0c\u53ea\u9700\u8981\u6211\u4eec\u7684\u6d4b\u8bd5\u6267\u884c\u7c7b\u7ee7\u627f\u7c7borg.junit.runners.BlockJUnit4ClassRunner\uff08\u7ee7\u627f\u57fa\u7840\u7c7bRunner\u4e5f\u53ef\uff09\uff0c\u5982Spring\u7684\u6267\u884c\u7c7bSpringJUnit4ClassRunner</li> <li>@FixMethodOrder\uff0c\u6307\u5b9aTest\u7684\u6267\u884c\u987a\u5e8f\uff1b</li> <li>@Tag \u6d4b\u8bd5\u7528\u4f8b\u5206\u7ec4\uff1b</li> <li>@TestFactory \uff1a\u8ddf DynamicTest \u7ed3\u5408\u7528\u4f5c\u5bf9\u751f\u6210\u52a8\u6001\u6d4b\u8bd5\u7528\u4f8b\uff0c\u7528\u4e8e\u5c06\u6570\u636e\u7684\u8f93\u5165\u548c\u8f93\u51fa\u548c\u6d4b\u8bd5\u903b\u8f91\u5206\u5f00\uff1b</li> </ul>"},{"location":"languages/java/test.html#_3","title":"\u65ad\u8a00","text":"<p>org.junit.Assert\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u53ef\u4ee5\u662f\u51fa\u9519\u65f6\u6253\u5370\u5230\u4fe1\u606f\uff08ErrorMessage, say what shoule happen\uff09</p> <ul> <li>assertTrue\uff0cassertEquals\uff0cassertNotNull\uff0cassertArrayEquals\uff0cfail</li> <li>assertThrows\uff1a\u65ad\u8a00\u5e94\u8be5\u629b\u51fa\u4ec0\u4e48\u5f02\u5e38\uff1b</li> </ul>"},{"location":"languages/java/test.html#assertj","title":"AssertJ","text":"<p>AssertJ - Fluent Assertions for Java</p> <pre><code>assertThat(frodo.getAge()).as(\"check %s's age\", frodo.getName()).isEqualTo(33);\n</code></pre>"},{"location":"languages/java/test.html#jbehave","title":"JBehave","text":"<p>BDD\uff1aBehavior-Driven Development\uff0c\u884c\u4e3a\u9a71\u52a8\u5f00\u53d1\uff0cGiven-&gt;When-&gt;Then\uff0cJBehave\uff1b</p>"},{"location":"languages/java/test.html#mock","title":"Mock","text":"<p>\u5355\u5143\u6d4b\u8bd5\u65f6\uff0c\u53d1\u73b0\u6d4b\u8bd5\u65b9\u6cd5\u4f1a\u5f15\u7528\u5916\u90e8\u4f9d\u8d56\u5bf9\u8c61\uff0c\u901a\u8fc7Mock\u6a21\u62df\u5916\u90e8\u4f9d\u8d56\u7684\u5bf9\u8c61\uff1b\u6a21\u62df\u5bf9\u8c61(Mock Object)</p> <p>Mockito \u662f \u3002</p> <pre><code>Mockito.when(mock(ClassA.class).method()).thenReturn().thenReturn();\n</code></pre> <p>Mockito\uff1aJava \u7684\u4e00\u79cdMock\u5b9e\u73b0\uff0c\u4e0d\u80fd\u6a21\u62df\u9759\u6001\u65b9\u6cd5\u3001\u6784\u9020\u51fd\u6570\u3001\u79c1\u6709\u51fd\u6570\u548cfinal\u7c7b</p> <ul> <li><code>ClassA a = mock(ClassA.class)</code>\u6216\u8005 \u901a\u8fc7@Mock\u6ce8\u89e3\uff08\u6ce8\u89e3\u9700\u8981@RunWith(MockitoJunitRunner.class)\u6216\u5728setUp()\u4e2d\u8c03\u7528MockitoAnnotations.initMocks()\uff09</li> <li><code>Mockito.when(mock.method()).thenReturn(value)</code>\uff1a\u8bbe\u5b9amock\u5bf9\u8c61\u67d0\u4e2a\u65b9\u6cd5\u8c03\u7528\u65f6\u7684\u8fd4\u56de\u503c\uff0c\u53ef\u4ee5\u591a\u4e2athenReturn</li> <li><code>when(mock.method()).thenThrow(new     RuntimeException())</code></li> <li><code>thenCallRealMethod()\uff1b</code></li> <li>\u5bf9void\u65b9\u6cd5\u9884\u8bbe\uff0cdoNothing().when(mock.method)\u6216\u8005doThrow\uff0c\u6216doNohting().doThrow()\uff1b</li> <li>\u65b9\u6cd5\u7684\u53c2\u6570\u53ef\u4ee5\u4f7f\u7528\u53c2\u6570\u6a21\u62df\u5668\uff0c\u5982anyInt()\u5339\u914d\u4efb\u610fint\u7c7b\u578b\u53c2\u6570\uff0canyString()\uff0canySet()\uff0c\u4f7f\u7528\u4e86\u53c2\u6570\u5339\u914d\u5668\uff0c\u6240\u6709\u7684\u53c2\u6570\u90fd\u9700\u8981\u7531\u5339\u914d\u5668\u63d0\u4f9b\uff1b</li> <li>mock\u5bf9\u8c61\u53ea\u80fd\u8c03\u7528\u8bbe\u5b9a\u7684\u65b9\u6cd5\uff0c\u800cspy\u662f\u5bf9\u771f\u6b63\u5bf9\u8c61\u76d1\u63a7\uff0c\u53ef\u4ee5\u4f7f\u7528\u8bbe\u5b9a\u7684\u65b9\u6cd5\u4ee5\u53ca\u5bf9\u8c61\u539f\u751f\u7684\u65b9\u6cd5\uff1b</li> <li>@injectMock\u4f1a\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u5e76\u5c06@Mock\u7684\u5bf9\u8c61\u4f20\u5165\u8be5\u5b9e\u4f8b\u4e2d\u4f5c\u6210\u5458\u53d8\u91cf\uff1b</li> </ul> <p>PowerMock\uff1a\u5bf9 Mockito \u652f\u6301\u4ee5\u53ca\u901a\u8fc7\u6539\u5b57\u8282\u7801\u652f\u6301\u6a21\u62df\u9759\u6001\u65b9\u6cd5\u3001\u6784\u9020\u51fd\u6570\u3001\u79c1\u6709\u51fd\u6570\u548cfinal\u7c7b</p> <ul> <li>\u4f7f\u7528\u9759\u6001\u65b9\u6cd5\u7b49\u65f6\uff0c@RunWith(PowerMockRunner.class) \u548c @PrepareForTest(\u88ab\u6d4b\u8bd5\u7684\u7c7b\uff09</li> <li>\u7528\u6cd5\u548cMockito\u4e00\u81f4\uff0c\u6784\u9020\u51fd\u6570 whenNew()</li> <li>\u6d4b\u8bd5\u65f6\u7684\u5b57\u8282\u7801\u548c\u5e73\u65f6\u7f16\u8bd1\u51fa\u6765\u7684\u5b57\u8282\u7801\u4e0d\u4e00\u81f4</li> </ul>"},{"location":"languages/java/test.html#_4","title":"\u4ee3\u7801\u8986\u76d6\u7387","text":""},{"location":"languages/java/version.html","title":"Java\u7248\u672c\u7279\u6027\uff08TODO\uff09","text":"\u7248\u672c \u5f00\u59cb\u65e5\u671f \u7ed3\u675f\u65e5\u671f \u5ef6\u671f\u7ed3\u675f\u65e5\u671f 8\uff08LTS\uff09 2014\u5e743\u6708 2022\u5e743\u6708 2030\u5e7412\u6708 11\uff08LTS\uff09 2018\u5e749\u6708 2023\u5e749\u6708 2026\u5e749\u6708 17\uff08LTS\uff09 2021\u5e749\u6708 2026\u5e749\u6708 2029\u5e749\u6708 21\uff08LTS\uff09 2023\u5e749\u6708 2028\u5e749\u6708 2031\u5e749\u6708 <p>Open JDK\u53d1\u884c\u7248\u53ef\u9009</p> <p>Open JDK \u867d\u7136\u6ca1\u6709\u5b98\u65b9\u7684LTS\u7248\u672c\uff0c\u4f46\u662f\u5f00\u6e90\u793e\u533a\u6709\u652f\u6301\u3002\u4f1a\u6709\u4e00\u4e9b\u516c\u53f8\u6216\u7ec4\u7ec7\u57fa\u4e8eOpen JDK\u505a\u53d1\u884c\u7248\uff0c\u63d0\u4f9bLTS\uff0c\u5efa\u8baeAdoptOpenJDK\u3002\u3002</p> \u540d\u79f0 \u652f\u6301\u56e2\u961f \u5b98\u7f51 AdoptOpenJDK Amazon\uff0cMicrosoft\uff0cIBM\uff0cRed Hat\uff0cPivotal(EMC\u548cVMware) AdoptOpenJDK - \u5f00\u6e90\uff0c\u9884\u5efaOpenJDK\u4e8c\u8fdb\u5236\u6587\u4ef6 Alibaba Dragonwell \uff08\u9f99\u4e95\uff09 \u963f\u91cc\u5df4\u5df4 Dragonwell (dragonwell-jdk.io) Tencent Kona \u817e\u8baf Home \u00b7 Tencent/TencentKona-8 Wiki \u00b7 GitHub Microsoft JDK Microsoft\u5fae\u8f6f Microsoft Build of OpenJDK \u6bd5\u6607JDK \u534e\u4e3a \u6bd5\u6607JDK-\u9cb2\u9e4f\u793e\u533a (hikunpeng.com) Amazon Corretto Amazon\u4e9a\u9a6c\u900a Amazon Corretto"},{"location":"languages/java/version.html#java-17","title":"Java 17","text":"<p>\u7b2c\u4e00\u4e2a\u652f\u6301ZGC\u7684LTS\u7248\u672c\u3002</p> <ol> <li>\u8bd5\u9a8cZGC\uff0c\u9700\u8981\u5728JVM\u914d\u7f6e\uff08jdk11\uff09</li> <li>\u6587\u672c\u5757\u5347\u7ea7\u3002\uff08jdk13\uff09</li> <li>switch\u652f\u6301lambda\uff08jdk13\u9884\u89c8\uff0cjdk14\uff09</li> <li>ZGC \u53ef\u7528\u4e8e\u751f\u4ea7\u73af\u5883\uff08jdk15\uff09</li> <li>record\uff08jdk14,15\u9884\u89c8\uff0cjdk16\uff09</li> <li>Realed class\u5bc6\u5c01\u7c7b\uff08jdk15,16\u9884\u89c8\uff0cjdk17\uff09</li> <li>\u7edf\u4e00\u65e5\u5fd7\u652f\u6301\u5f02\u6b65\u65e5\u5fd7\u5237\u65b0\uff08jdk17\uff09</li> </ol>"},{"location":"languages/java/version.html#java-11","title":"Java 11","text":""},{"location":"languages/java/version.html#_1","title":"\u6a21\u5757\u5316","text":"<p>module\uff0copen\uff0cexports\uff1b   http://www.cnblogs.com/IcanFixIt/p/7144366.html </p>"},{"location":"languages/java/version.html#jshell","title":"jshell","text":""},{"location":"languages/java/version.html#reactive-streams","title":"\u53cd\u5e94\u5f0f\u6d41 \uff08 Reactive Streams \uff09","text":"<p><code>java.util.concurrent.Flow</code> \u7c7b\uff0cFlow.Publisher\u3001Flow.Subscriber\u3001Flow.Subscription \u548c Flow.Processor \u7b49 4 \u4e2a\u6838\u5fc3\u63a5</p>"},{"location":"languages/java/version.html#_2","title":"\u53d8\u91cf\u53e5\u67c4","text":"<p><code>VarHandle</code> \u7c7b\uff0c\u53d8\u91cf\u53e5\u67c4\u662f\u4e00\u4e2a\u53d8\u91cf\u6216\u4e00\u7ec4\u53d8\u91cf\u7684\u5f15\u7528\uff0c\u5305\u62ec\u9759\u6001\u57df\uff0c\u975e\u9759\u6001\u57df\uff0c\u6570\u7ec4\u5143\u7d20\u548c\u5806\u5916\u6570\u636e\u7ed3\u6784\u4e2d\u7684\u7ec4\u6210\u90e8\u5206\u7b49</p> <ul> <li> <ul> <li>\u53d6\u4ee3 <code>java.util.concurrent.atomic</code> \u5305\u4ee5\u53ca <code>sun.misc.Unsafe</code> \u7c7b\u7684\u529f\u80fd\uff1b</li> </ul> </li> </ul>"},{"location":"languages/java/version.html#methodhandles","title":"MethodHandles","text":"<p>\u6539\u8fdb\u65b9\u6cd5\u53e5\u67c4\uff0c\u6dfb\u52a0\u66f4\u591a\u9759\u6001\u65b9\u6cd5\u521b\u5efa\u4e0d\u540c\u7c7b\u578b\u65b9\u6cd5\u53e5\u67c4</p> <ul> <li> <p>arrayConstructor\uff1a\u521b\u5efa\u6307\u5b9a\u7c7b\u578b\u7684\u6570\u7ec4\u3002</p> </li> <li> <p>arrayLength\uff1a\u83b7\u53d6\u6307\u5b9a\u7c7b\u578b\u7684\u6570\u7ec4\u7684\u5927\u5c0f\u3002</p> </li> <li>varHandleInvoker \u548c varHandleExactInvoker\uff1a\u8c03\u7528 VarHandle \u4e2d\u7684\u8bbf\u95ee\u6a21\u5f0f\u65b9\u6cd5\u3002</li> <li>zero\uff1a\u8fd4\u56de\u4e00\u4e2a\u7c7b\u578b\u7684\u9ed8\u8ba4\u503c\u3002</li> <li>empty\uff1a\u8fd4 \u56de MethodType \u7684\u8fd4\u56de\u503c\u7c7b\u578b\u7684\u9ed8\u8ba4\u503c\u3002</li> <li>loop\u3001countedLoop\u3001iteratedLoop\u3001whileLoop \u548c doWhileLoop\uff1a\u521b\u5efa\u4e0d\u540c\u7c7b\u578b\u7684\u5faa\u73af\uff0c\u5305\u62ec for \u5faa\u73af\u3001while \u5faa\u73af \u548c do-while \u5faa\u73af\u3002</li> <li>tryFinally\uff1a\u628a\u5bf9\u65b9\u6cd5\u53e5\u67c4\u7684\u8c03\u7528\u5c01\u88c5\u5728 try-finally \u8bed\u53e5\u4e2d\u3002</li> </ul>"},{"location":"languages/java/version.html#_3","title":"\u5c40\u90e8\u53d8\u91cf\u7c7b\u578b\u63a8\u65ad","text":"<pre><code>var list = new ArrayList&lt;String&gt;(); \n</code></pre>"},{"location":"languages/java/version.html#_4","title":"\u5e94\u7528\u7a0b\u5e8f\u7c7b\u6570\u636e\u5171\u4eab","text":"<p>Class Data Sharing\u7279\u6027\u5728\u539f\u6765\u7684 bootstrap \u7c7b\u57fa\u7840\u4e4b\u4e0a\uff0c\u6269\u5c55\u52a0\u5165\u4e86\u5e94\u7528\u7c7b\u7684 CDS (Application Class-Data Sharing) \u652f\u6301\uff1b\u5f53\u591a\u4e2a Java \u865a\u62df\u673a\uff08JVM\uff09\u5171\u4eab\u76f8\u540c\u7684\u5f52\u6863\u6587\u4ef6\u65f6\uff0c\u8fd8\u53ef\u4ee5\u51cf\u5c11\u52a8\u6001\u5185\u5b58\u7684\u5360\u7528\u91cf\uff0c\u540c\u65f6\u51cf\u5c11\u591a\u4e2a\u865a\u62df\u673a\u5728\u540c\u4e00\u4e2a\u7269\u7406\u6216\u865a\u62df\u7684\u673a\u5668\u4e0a\u8fd0\u884c\u65f6\u7684\u8d44\u6e90\u5360\u7528\u3002</p>"},{"location":"languages/java/version.html#_5","title":"\u8fdb\u7a0b","text":""},{"location":"languages/java/version.html#process-api","title":"Process API","text":"<p>\u975e\u5e38\u9002\u5408\u8017\u65f6\u8f83\u957f\u7684\u8fdb\u7a0b\u8c03\u7528\u3002</p> <p><code>ProcessHandle</code> \u63d0\u4f9b\u4e86\u5bf9\u672c\u5730\u8fdb\u7a0b\u7684\u63a7\u5236\uff0c\u53ef\u4ee5\u76d1\u63a7\u5176\u5b58\u6d3b\uff0c\u67e5\u627e\u5176\u5b50\u8fdb\u7a0b\uff0c\u67e5\u770b\u5176\u4fe1\u606f\uff0c\u751a\u81f3\u9500\u6bc1\u5b83\u3002</p>"},{"location":"languages/java/version.html#stack-walking-api","title":"Stack-Walking API","text":"<p>\u4e00\u4e2a\u6807\u51c6API\u7528\u4e8e\u8bbf\u95ee\u5f53\u524d\u7ebf\u7a0b\u6808\u3002</p>"},{"location":"languages/java/version.html#-","title":"\u7ebf\u7a0b-\u5c40\u90e8\u7ba1\u63a7","text":"<p>\u5c06\u5141\u8bb8\u5728\u4e0d\u8fd0\u884c\u5168\u5c40 JVM \u5b89\u5168\u70b9\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u7ebf\u7a0b\u56de\u8c03\uff0c\u7531\u7ebf\u7a0b\u672c\u8eab\u6216\u8005 JVM \u7ebf\u7a0b\u6765\u6267\u884c\uff0c\u540c\u65f6\u4fdd\u6301\u7ebf\u7a0b\u5904\u4e8e\u963b\u585e\u72b6\u6001\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4f7f\u5f97\u505c\u6b62\u5355\u4e2a\u7ebf\u7a0b\u53d8\u6210\u53ef\u80fd\uff0c\u800c\u4e0d\u662f\u53ea\u80fd\u542f\u7528\u6216\u505c\u6b62\u6240\u6709\u7ebf\u7a0b\u3002</p>"},{"location":"languages/java/version.html#jni-native-header","title":"JNI Native Header","text":"<p>\u5408\u5e76javac\u548cjava\u547d\u4ee4\uff08jdk11\uff09</p> <ul> <li> <p>\u751f\u6210 Native-Header \u76f4\u63a5\u7528 java \u547d\u4ee4\uff1b</p> </li> <li> <p>\u7b80\u5316\u542f\u52a8\u5355\u4e2a\u6e90\u4ee3\u7801\u6587\u4ef6\uff0cjava     HelloWorld.java\uff1b</p> </li> </ul>"},{"location":"languages/java/version.html#http-client","title":"\u5f02\u6b65\u975e\u963b\u585e\u7684Http Client","text":"<ul> <li>\u652f\u6301\u5f02\u6b65\u975e\u963b\u585e\u7684Http Client\uff0c\u652f\u6301HTTP/1.1\u548cHTTP/2\uff1b</li> </ul>"},{"location":"languages/java/version.html#gc","title":"GC","text":"<p>\u9ed8\u8ba4 G1 \u5783\u573e\u56de\u6536\u5668\uff1a\u5e9f\u5f03CMS</p> <p>\u5e76\u884c\u5168\u5783\u573e\u56de\u6536\u5668 G1\uff1a\u4e4b\u524d Java \u7248\u672c\u4e2d\u7684 G1 \u5783\u573e\u56de\u6536\u5668\u6267\u884c GC \u65f6\u91c7\u7528\u7684\u662f\u57fa\u4e8e\u5355\u7ebf\u7a0b\u6807\u8bb0\u626b\u63cf\u538b\u7f29\u7b97\u6cd5\uff08mark-sweep-compact\uff09\uff0c\u91c7\u7528\u5e76\u884c\u5316 mark-sweep-compact \u7b97\u6cd5\uff0c\u5e76\u4f7f\u7528\u4e0e\u5e74\u8f7b\u4ee3\u56de\u6536\u7684\u76f8\u540c\u6570\u91cf\u7684\u7ebf\u7a0b\uff08-XX\uff1aParallelGCThread\uff09\uff1b</p> <p>\u5b9e\u9a8c\u6027\u8d28\uff1a</p> <ul> <li> <p>Epsilon\uff1a\u4f4e\u5f00\u9500\u5783\u573e\u56de\u6536\u5668\uff0c-XX:+UseEpsilonGC\uff1b</p> </li> <li> <p>ZGC\uff1a\u53ef\u4f38\u7f29\u4f4e\u5ef6\u8fdf\u5783\u573e\u6536\u96c6\u5668\uff0c--with-jvm-features=zgc\uff1b</p> </li> </ul>"},{"location":"languages/java/version.html#incurator-http2","title":"incurator  HTTP/2\uff1f","text":"<p>\u652f\u6301\u5f02\u6b65\u975e\u963b\u585e\u7684Http Client\uff0c\u652f\u6301HTTP/1.1\u548cHTTP/2\uff1b</p>"},{"location":"languages/java/version.html#flightrecording","title":"FlightRecording","text":"<p>\u98de\u884c\u8bb0\u5f55\u5668\uff08JDK8\u65f6\u4e3a\u5546\u4e1a\u7248\uff09\uff1a\u4f4e\u5f00\u9500\u7684\u4e8b\u4ef6\u4fe1\u606f\u6536\u96c6\u6846\u67b6\uff0c\u4e3b\u8981\u7528\u4e8e\u5bf9\u5e94\u7528\u7a0b\u5e8f\u548c JVM \u8fdb\u884c\u6545\u969c\u68c0\u67e5\u3001\u5206\u6790\uff0c-XX:StartFlightRecording\uff1b</p>"},{"location":"languages/java/concurrency/index.html","title":"Java\u5e76\u53d1\u5b9e\u6218","text":"<p>\u53c2\u8003 [1] Java\u5e76\u53d1\u7f16\u7a0b\u5b9e\u6218, 2011\u3002</p>"},{"location":"languages/java/concurrency/index.html#_1","title":"\u57fa\u7840","text":""},{"location":"languages/java/concurrency/index.html#_2","title":"\u8fdb\u7a0b\u4e0e\u7ebf\u7a0b\u7684\u5173\u7cfb","text":"<ul> <li>\u8fdb\u7a0b\u662f\u8d44\u6e90\u5206\u914d\u7684\u57fa\u672c\u5355\u4f4d\uff1b</li> <li>\u7ebf\u7a0b\u662f\u8c03\u5ea6\u7684\u57fa\u672c\u5355\u4f4d\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_3","title":"\u7ebf\u7a0b\u7684\u4f18\u52bf","text":"<ul> <li>\u5145\u5206\u5229\u7528\u591a\u6838\u8d44\u6e90\uff0c\u66f4\u4f18\u7684\u6027\u80fd\uff1a</li> <li> <p>\u5355\u6838\uff1a\u53ef\u4ee5\u901a\u8fc7CPU\u548cIO\u5e76\u884c\u65b9\u5f0f\uff0c\u5728IO\u963b\u585e\u65f6\uff0c\u53e6\u4e00\u7ebf\u7a0b\u6267\u884c\u8ba1\u7b97\uff0c\u83b7\u53d6\u66f4\u9ad8\u7684\u541e\u5410\u7387\u3002</p> </li> <li> <p>\u5efa\u6a21\u7684\u7b80\u5355\u6027\uff1a</p> </li> <li>\u5c06\u590d\u6742\u4e14\u5f02\u6b65\u7684\u5de5\u4f5c\u6d41\u8fdb\u4e00\u6b65\u5206\u89e3\u4e3a\u4e00\u7ec4\u7b80\u5355\u5e76\u4e14\u540c\u6b65\u7684\u5de5\u4f5c\u6d41\uff1b</li> <li>\u5f02\u6b65\u4e8b\u4ef6\u7684\u7b80\u5316\u5904\u7406\uff1a</li> </ul>"},{"location":"languages/java/concurrency/index.html#_4","title":"\u7ebf\u7a0b\u7684\u98ce\u9669","text":"<ul> <li>\u5b89\u5168\u6027\u95ee\u9898\uff0c\u5982\u591a\u7ebf\u7a0b\u9012\u589e\uff1b</li> <li>\u6d3b\u8dc3\u6027\u95ee\u9898\uff0c\u5982\u6b7b\u9501\u3001\u9965\u997f\u3001\u6d3b\u9501\uff1b</li> <li>\u6027\u80fd\u95ee\u9898\uff0c\u5982\u7ebf\u7a0b\u8c03\u5ea6\u7684\u5f00\u9500\uff08\u9891\u7e41\u7684\u4e0a\u4e0b\u6587\u5207\u6362\uff09\uff0c\u4fdd\u5b58\u548c\u6062\u590d\u6267\u884c\u4e0a\u4e0b\u6587\u65f6\u4e22\u5931\u5c40\u90e8\u6027\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_5","title":"\u7ebf\u7a0b\u5b89\u5168\u6027","text":"<p>\u65e0\u72b6\u6001\u5bf9\u8c61\u4e00\u5b9a\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u3002</p> <p>\u8981\u4fdd\u8bc1\u72b6\u6001\u7684\u4e00\u81f4\u6027\uff0c\u5c31\u9700\u8981\u5728\u5355\u4e2a\u539f\u5b50\u64cd\u4f5c\u4e2d\u66f4\u65b0\u6240\u6709\u76f8\u5173\u7684\u72b6\u6001\u53d8\u91cf\u3002</p>"},{"location":"languages/java/concurrency/index.html#_6","title":"\u7ade\u6001\u6761\u4ef6","text":"<p>\u7ade\u6001\u6761\u4ef6\uff1a\u4e0d\u6070\u5f53\u7684\u6267\u884c\u65f6\u5e8f\u800c\u51fa\u73b0\u4e0d\u6b63\u786e\u7684\u7ed3\u679c\u3002</p> <ul> <li>\u5148\u68c0\u67e5\u540e\u6267\u884c\uff08Check-Then-Act\uff09\uff1b</li> </ul> <p>\u6570\u636e\u7ade\u4e89\uff1a\u5728\u8bbf\u95ee\u5171\u4eab\u7684\u975efinal\u7c7b\u578b\u7684\u57df\u65f6\u6ca1\u6709\u91c7\u7528\u540c\u6b65\u6765\u8fdb\u884c\u534f\u540c\uff1b</p>"},{"location":"languages/java/concurrency/index.html#_7","title":"\u5185\u7f6e\u9501","text":"<p>\u6bcf\u4e2aJava\u5bf9\u8c61\u53ef\u4ee5\u7528\u4f5c\u4e00\u4e2a\u5b9e\u73b0\u540c\u6b65\u7684\u9501\uff0c\u79f0\u4e3a\u5185\u7f6e\u9501\uff08Intrinsic Lock\uff09\u6216\u76d1\u89c6\u5668\u9501\uff08Monitor Lock\uff09\u3002</p> <pre><code>// \u7236\u7c7b\u7684synchronized\u65b9\u6cd5\u548c\u5b50\u7c7b\u7684synchronized\u65b9\u6cd5\uff0c\u9501\u7684\u662f\u540c\u4e00\u4e2a\u5bf9\u8c61\uff1b\npublic class Widget {\n    public synchronized void doSomething() {...}\n}\npublic class LoggingWidget extends Widget {\n    public synchronized void doSomething() {\n        System.out.println();\n        super.doSomething();\n    }\n}\n</code></pre> <p>\u91cd\u5165\u610f\u5473\u7740\u83b7\u53d6\u9501\u7684\u7c92\u5ea6\u662f\u201d\u7ebf\u7a0b\u201c\uff0c\u800c\u4e0d\u662f\u201d\u8c03\u7528\u201c\u3002</p> <ul> <li>\u533a\u522b\u4e8ePOSIX\u7ebf\u7a0bpthread\u4e92\u65a5\u4f53\u7684\u9ed8\u8ba4\u52a0\u9501\u884c\u4e3a\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_8","title":"\u5bf9\u8c61\u7684\u5171\u4eab","text":"<p>JSR-133/Java\u5185\u5b58\u6a21\u578b(JMM)\u89c4\u8303</p>"},{"location":"languages/java/concurrency/index.html#_9","title":"\u53ef\u89c1\u6027","text":""},{"location":"languages/java/concurrency/index.html#_10","title":"\u6307\u4ee4\u91cd\u6392\u5e8f","text":"<p>\u5728\u6ca1\u6709\u540c\u6b65\u7684\u60c5\u51b5\u4e0b\uff0c\u7f16\u8bd1\u5668\u3001\u5904\u7406\u5668\u4ee5\u53ca\u8fd0\u884c\u65f6\u7b49\u90fd\u53ef\u80fd\u5bf9\u64cd\u4f5c\u7684\u6267\u884c\u987a\u5e8f\u8fdb\u884c\u8c03\u6574\u3002</p> <ul> <li>\u7531\u4e8e\u6307\u4ee4\u91cd\u6392\uff0c\u53ef\u80fd\u662f\u5148\u6267\u884c3\uff0c\u518d\u6267\u884c =&gt; holder\u6709\u503c\u4e86\uff0c\u4f46\u662fn\u8fd8\u6ca1\u6709\u88ab\u6784\u9020\u51fd\u6570\u521d\u59cb\u5316\uff1b</li> </ul> <pre><code>// \u4e0d\u5b89\u5168\u7684\u53d1\u5e03\npublic Holder holder;\npublic void initialize() {\n    // \u5b9e\u9645\u6267\u884c\u7684\u5e95\u5c42\u64cd\u4f5c\uff0c1. \u5206\u914d\u7a7a\u95f4\uff0c2.\u6267\u884c\u6784\u9020\u51fd\u6570\uff0c3. \u5f15\u7528\u8d4b\u503c\n    holder = new Holder(42);\n}\n\npublic class Holder {\n    private int n;\n    public Holder(int n){\n        this.n=n;\n    }\n    public void assertSanity(int n){\n        if(n!=this.n){\n            throw new AssertionError(\"\"); // \u7b2c\u4e00\u6b21\u8bfb\u53d6\u5230\u5931\u6548\u503c\uff0c\u7b2c\u4e8c\u6b21\u8bfb\u5230\u66f4\u65b0\u503c\n        }\n    }\n}\n</code></pre> <ul> <li> <p>\u5373\u4f7f\u67d0\u4e2a\u5bf9\u8c61\u7684\u5f15\u7528\u5bf9\u5176\u4ed6\u7ebf\u7a0b\u662f\u53ef\u89c1\u7684\uff0c\u5e76\u4e0d\u610f\u5473\u7740\u5bf9\u8c61\u72b6\u6001\u5bf9\u4e8e\u4f7f\u7528\u8be5\u5bf9\u8c61\u7684\u7ebf\u7a0b\u4e00\u5b9a\u53ef\u89c1\uff1b</p> </li> <li> <p>final\u4fee\u9970\u7684\u60c5\u51b5\uff0c\u5219\u4fdd\u8bc1n\u53ef\u4ee5\u88ab\u770b\u5230\uff1bJava\u5185\u5b58\u6a21\u578b\u5bf9\u4e0d\u53ef\u53d8\u5bf9\u8c61\u7684\u5171\u4eab\u63d0\u4f9b\u7279\u6b8a\u7684\u521d\u59cb\u5316\u5b89\u5168\u6027\u4fdd\u8bc1\uff1a</p> </li> </ul> <p>JLS 17.5</p> <p>An object is considered to be completely initialized when its constructor finishes. A thread that can only see a reference to an object after that object has been completely initialized is guaranteed to see the correctly initialized values for that object's <code>final</code> fields.</p>"},{"location":"languages/java/concurrency/index.html#synchronized","title":"synchronized","text":"<ul> <li>\u539f\u5b50\u6027\uff08\u6216\u786e\u5b9a\u4e34\u754c\u533a\uff09</li> <li>\u5185\u5b58\u53ef\u89c1\u6027\uff1b</li> </ul> <p>\u7ebf\u7a0b\u5b89\u5168\u7684\u53ef\u53d8\u6574\u6570\u7c7b\uff0c\u4ec5\u5bf9set\u65b9\u6cd5\u8fdb\u884c\u540c\u6b65\u662f\u4e0d\u591f\u7684\uff0c\u8c03\u7528get\u7684\u7ebf\u7a0b\u4ecd\u7136\u53ef\u80fd\u770b\u5230\u5931\u6548\u503c\u3002</p> <pre><code>@ThreadSafe\npublic class SynchronizedInteger {\n    @GuardedBy(\"this\") private int value;\n    public synchronized int get() { return value;}\n    public synchronized void set(int value) { this.value = value;}\n}\n</code></pre>"},{"location":"languages/java/concurrency/index.html#volatile","title":"volatile","text":"<p>\u53ea\u4fdd\u8bc1\u53ef\u89c1\u6027\uff0c\u4e0d\u4fdd\u8bc1\u539f\u5b50\u6027</p> <ul> <li>\u7f16\u8bd1\u5668\u548c\u8fd0\u884c\u65f6\u6ce8\u610f\u8be5\u53d8\u91cf\u65f6\u5171\u4eab\u7684\uff0c\u4e0d\u4f1a\u5c06\u8be5\u53d8\u91cf\u4e0a\u7684\u64cd\u4f5c\u548c\u5176\u5b83\u5185\u5b58\u64cd\u4f5c\u4e00\u8d77\u91cd\u6392\u5e8f\uff1b</li> <li>volatile\u53d8\u91cf\u4e0d\u4f1a\u88ab\u7f13\u5b58\u5728\u5bc4\u5b58\u5668\u6216\u8005\u5bf9\u5176\u5b83\u5904\u7406\u5668\u4e0d\u53ef\u89c1\u7684\u5730\u65b9\uff1b</li> <li>\u4e0d\u4f1a\u6267\u884c\u52a0\u9501\uff0c\u5373\u4e0d\u4f1a\u963b\u585e\uff0c\u56e0\u6b64\u6bd4\u5173\u952e\u5b57synchronized\u66f4\u8f7b\u91cf\u7ea7\uff1b</li> <li>\u9002\u7528\u4e8e\u4e00\u5199\u591a\u8bfb\uff0c\u6216\u8005\u5355\u7eaf\u7684\u591a\u7ebf\u7a0b\u8d4b\u503c\u7684\u60c5\u51b5\uff08\u4ec5\u9002\u7528\u4e8eJava\uff09\u3002</li> </ul>"},{"location":"languages/java/concurrency/index.html#64","title":"\u975e\u539f\u5b50\u768464\u4f4d\u64cd\u4f5c","text":"<ul> <li>Java\u5185\u5b58\u6a21\u578b\u8981\u6c42\uff0c\u53d8\u91cf\u7684\u8bfb\u53d6\u64cd\u4f5c\u548c\u5199\u5165\u64cd\u4f5c\u90fd\u5fc5\u987b\u662f\u539f\u5b50\u64cd\u4f5c\uff0c\u4f46\u5bf9\u4e8e\u975evolatile\u7c7b\u578b\u7684long\u548cdouble\u7c7b\u578b\uff0cJVM\u5141\u8bb8\u5c0664\u4f4d\u7684\u8bfb\u6216\u5199\u64cd\u4f5c\u5206\u89e3\u4e3a32\u4f4d\u7684\u64cd\u4f5c\u3002</li> </ul>"},{"location":"languages/java/concurrency/index.html#_11","title":"\u9501\u7684\u5185\u5b58\u8bed\u4e49","text":"<p>\uff1fTODO JVM How to do that ?\uff08MonitorEnter/MonitorExit\uff09</p> <ul> <li>\u5f53\u7ebf\u7a0b\u83b7\u53d6\u9501\u65f6, JMM\u4f1a\u628a\u7ebf\u7a0b\u5bf9\u5e94\u7684\u672c\u5730\u5185\u5b58\u7f6e\u4e3a\u65e0\u6548. \u4ece\u800c\u4f7f\u5f97\u88ab\u76d1\u89c6\u5668\u4fdd\u62a4\u7684\u4e34\u754c\u533a\u7684\u53d8\u91cf\u5fc5\u987b\u4ece\u4e3b\u5185\u5b58\u4e2d\u8bfb\u53d6.</li> <li>\u5f53\u7ebf\u7a0b\u91ca\u653e\u9501\u65f6, JMM\u4f1a\u628a\u8be5\u7ebf\u7a0b\u5bf9\u5e94\u7684\u672c\u5730\u5185\u5b58\u4e2d\u7684\u5171\u4eab\u53d8\u91cf\u5237\u65b0\u5230\u4e3b\u5185\u5b58\u4e2d(\u5e76\u4e0d\u662f\u4e0d\u91ca\u653e\u9501\u5c31\u4e0d\u5237\u65b0\u5230\u4e3b\u5185\u5b58, \u53ea\u662f\u91ca\u653e\u9501\u65f6\u628a\u672a\u5237\u65b0\u5230\u4e3b\u5185\u5b58\u4e2d\u7684\u6570\u636e\u5237\u65b0\u5230\u4e3b\u5185\u5b58).</li> </ul>"},{"location":"languages/java/concurrency/index.html#_12","title":"\u9038\u51fa","text":"<p>\u4e0d\u8981\u5728\u6784\u9020\u51fd\u6570\u4e2d\u4f7fthis\u5f15\u7528\u9038\u51fa\u3002</p> <ul> <li>TODO\uff1a\u5177\u4f53\u5565\u5371\u5bb3\uff1f</li> </ul>"},{"location":"languages/java/concurrency/index.html#_13","title":"\u7ebf\u7a0b\u5c01\u95ed","text":"<p>\u5c06\u6570\u636e\u8bbf\u95ee\u9650\u5b9a\u5728\u5355\u4e2a\u7ebf\u7a0b\u4e2d</p> <ul> <li>\u5c40\u90e8\u53d8\u91cf\u548cThreadLocal\uff1b</li> <li>ThreadLocal\u964d\u4f4e\u4ee3\u7801\u7684\u53ef\u91cd\u7528\u6027\uff0c\u5e76\u4e14\u5728\u7c7b\u4e4b\u95f4\u5f15\u5165\u4e86\u9690\u542b\u7684\u8026\u5408\u6027\uff0c\u5c0f\u5fc3\u4f7f\u7528\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_14","title":"\u4e0d\u53d8\u6027","text":"<p>\u4e0d\u53ef\u53d8\u5bf9\u8c61</p> <ul> <li>\u5bf9\u8c61\u521b\u5efa\u540e\u72b6\u6001\u4e0d\u80fd\u4fee\u6539\uff1b</li> <li>\u5bf9\u8c61\u6240\u6709\u57df\u90fd\u662ffinal\u7c7b\u578b\uff1b\uff08\u6216\u8005\u57fa\u4e8e\u4e0d\u53ef\u53d8\u7684\u72b6\u6001\uff09</li> <li>\u5bf9\u8c61\u6b63\u786e\u521b\u5efa\uff08\u521b\u5efa\u671f\u95f4\u6ca1\u6709this\u5f15\u7528\u6ea2\u51fa\uff09</li> </ul> <p>\u6280\u5de7\uff1avolatile\u548c\u4e0d\u53ef\u53d8\u5bf9\u8c61\u5b9e\u73b0\u7ebf\u7a0b\u5b89\u5168(TODO)</p>"},{"location":"languages/java/concurrency/index.html#_15","title":"\u5b89\u5168\u53d1\u5e03","text":"<p>\u8981\u5b89\u5168\u53d1\u5e03\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5bf9\u8c61\u7684\u5f15\u7528\u4ee5\u53ca\u5bf9\u8c61\u7684\u72b6\u6001\u5fc5\u987b\u540c\u65f6\u5bf9\u5176\u4ed6\u7ebf\u7a0b\u53ef\u89c1\uff08\u91cd\u6392\u5e8f\u5e26\u6765\u5f15\u7528\u548c\u72b6\u6001\u7684\u4e0d\u4e00\u81f4\uff09\u3002</p> <p>\u6b63\u786e\u6784\u9020\u7684\u5bf9\u8c61\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u7684\u65b9\u5f0f\u6765\u5b89\u5168\u53d1\u5e03\uff1a</p> <ul> <li>\u5728\u9759\u6001\u521d\u59cb\u5316\u51fd\u6570\u4e2d\u521d\u59cb\u5316\u4e00\u4e2a\u5bf9\u8c61\u5f15\u7528\uff1b</li> <li>\u5c06\u5bf9\u8c61\u7684\u5f15\u7528\u4fdd\u5b58\u5230volatile\u7c7b\u578b\u7684\u57df\u6216\u8005AtomicReference\u5bf9\u8c61\u4e2d\uff1b</li> <li>\u5c06\u5bf9\u8c61\u7684\u5f15\u7528\u4fdd\u5b58\u5230\u67d0\u4e2a\u6b63\u786e\u6784\u9020\u5bf9\u8c61\u7684final\u7c7b\u578b\u57df\u4e2d\uff1b</li> <li>\u5c06\u5bf9\u8c61\u7684\u5f15\u7528\u4fdd\u5b58\u5230\u4e00\u4e2a\u6709\u9501\u4fdd\u62a4\u7684\u57df\u4e2d\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_16","title":"\u5bf9\u8c61\u7684\u7ec4\u5408","text":"<p>\u4e0d\u5e0c\u671b\u5bf9\u6bcf\u4e00\u6b21\u5185\u5b58\u8bbf\u95ee\u90fd\u8fdb\u884c\u5206\u6790\u4ee5\u786e\u4fdd\u7a0b\u5e8f\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u800c\u662f\u5e0c\u671b\u5c06\u4e00\u4e9b\u73b0\u6709\u7684\u7ebf\u7a0b\u5b89\u5168\u7ec4\u4ef6\u7ec4\u5408\u4e3a\u66f4\u5927\u89c4\u6a21\u7684\u7ec4\u4ef6\u6216\u7a0b\u5e8f\u3002</p>"},{"location":"languages/java/concurrency/index.html#_17","title":"\u8bbe\u8ba1\u7ebf\u7a0b\u5b89\u5168\u7684\u7c7b","text":"<p>\u8bbe\u8ba1\u5b89\u5168\u7684\u7c7b\u8fc7\u7a0b\u4e2d\uff0c\u4e09\u5927\u8981\u7d20\uff1a</p> <ul> <li>\u627e\u51fa\u6784\u6210\u5bf9\u8c61\u72b6\u6001\u7684\u6240\u6709\u53d8\u91cf\uff1b</li> <li>\u627e\u51fa\u7ea6\u675f\u72b6\u6001\u53d8\u91cf\u7684\u4e0d\u53d8\u6027\u6761\u4ef6\uff1b</li> <li>\u5efa\u7acb\u5bf9\u8c61\u72b6\u6001\u7684\u5e76\u53d1\u8bbf\u95ee\u7ba1\u7406\u7b56\u7565\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_18","title":"\u6536\u96c6\u540c\u6b65\u9700\u6c42","text":"<p>\u5bf9\u8c61\u4e0e\u53d8\u91cf\u90fd\u6709\u4e00\u4e2a\u72b6\u6001\u7a7a\u95f4\uff08\u5373\u6240\u6709\u7684\u53ef\u80fd\u53d6\u503c\uff09\uff0c\u7ea6\u675f\u6761\u4ef6\u9700\u8981\u589e\u52a0\u989d\u5916\u7684\u540c\u6b65\u548c\u5c01\u88c5\uff1a</p> <ul> <li>\u4e0d\u53ef\u53d8\u6761\u4ef6\uff1a\u5224\u65ad\u72b6\u6001\u662f\u5426\u6709\u6548\uff0c\u6bd4\u5982\u8ba1\u6570\u5668\u4e0d\u53ef\u80fd\u662f\u8d1f\u6570\u3001\u4e0a\u4e0b\u754c\u7684\u7ea6\u675f\uff1b</li> <li>\u540e\u9a8c\u6761\u4ef6\uff1a\u4e0b\u4e00\u4e2a\u72b6\u6001\u4f9d\u8d56\u5f53\u524d\u72b6\u6001\uff0c\u6bd4\u5982\u8ba1\u6570\u5668\u7684\u81ea\u589e\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_19","title":"\u4f9d\u8d56\u72b6\u6001\u7684\u64cd\u4f5c","text":"<p>\u57fa\u4e8e\u72b6\u6001\u7684\u5148\u9a8c\u6761\u4ef6\uff1a</p> <ul> <li>\u67d0\u4e2a\u64cd\u4f5c\u4e2d\u5305\u542b\u6709\u57fa\u4e8e\u72b6\u6001\u7684\u5148\u9a8c\u6761\u4ef6\uff0c\u5982\u4e0d\u80fd\u4ece\u7a7a\u961f\u5217\u79fb\u9664\u5143\u7d20\uff1b</li> <li>\u5728\u5e76\u53d1\u7a0b\u5e8f\u4e2d\u9700\u8981\u7b49\u5230\u5148\u9a8c\u6761\u4ef6\u4e3a\u771f\uff08\u5148\u9a8c\u6761\u4ef6\u53ef\u80fd\u7531\u4e8e\u5176\u4ed6\u7ebf\u7a0b\u7684\u4fee\u6539\u800c\u4e3a\u771f\uff09\uff0c\u518d\u6267\u884c\u64cd\u4f5c\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_20","title":"\u72b6\u6001\u7684\u6240\u6709\u6743","text":"<p>\u72b6\u6001\u53d8\u91cf\u7684\u6240\u6709\u8005\u5c06\u51b3\u5b9a\u91c7\u7528\u4f55\u79cd\u52a0\u9501\u534f\u8bae\u6765\u7ef4\u6301\u53d8\u91cf\u72b6\u6001\u7684\u5b8c\u6574\u6027\u3002</p> <ul> <li>\u5982\u679c\u53d1\u5e03\u67d0\u4e2a\u53ef\u53d8\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u5219\u4e0d\u518d\u62e5\u6709\u72ec\u5360\u7684\u63a7\u5236\u6743\uff0c\u6700\u591a\u65f6\u201c\u5171\u4eab\u63a7\u5236\u6743\u201d\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_21","title":"\u5b9e\u4f8b\u5c01\u95ed","text":"<p>\u5c01\u88c5\u7b80\u5316\u4e86\u7ebf\u7a0b\u5b89\u5168\u7c7b\u7684\u5b9e\u73b0\u8fc7\u7a0b\uff0c\u63d0\u4f9b\u4e00\u79cd\u5b9e\u4f8b\u5c01\u95ed\u673a\u5236\uff08Instance Confinement\uff09\u3002</p> <ul> <li>\u5c06\u6570\u636e\u5c01\u88c5\u5728\u5bf9\u8c61\u5185\u90e8\uff0c\u5c06\u6570\u636e\u7684\u8bbf\u95ee\u9650\u5236\u5728\u5bf9\u8c61\u7684\u65b9\u6cd5\u4e0a\uff1b</li> </ul> <p>\u4f7f\u7528\u79c1\u6709\u7684\u9501\u5bf9\u8c61\u800c\u4e0d\u662f\u5bf9\u8c61\u7684\u5185\u7f6e\u9501\u6216\u8005\u53ef\u4ee5\u88ab\u516c\u6709\u65b9\u5f0f\u8bbf\u95ee\u7684\u9501\uff0c\u56e0\u4e3a\u5185\u7f6e\u9501\uff08Synchronized\uff09\u5ba2\u6237\u4ee3\u7801\u53ef\u4ee5\u83b7\u53d6\u3002</p> <p>\u5982\u679c\u4e00\u4e2a\u7c7b\u6709\u591a\u4e2a\u72ec\u7acb\u4e14\u7ebf\u7a0b\u5b89\u5168\u7684\u72b6\u6001\u53d8\u91cf\u7ec4\u6210\uff0c\u5e76\u4e14\u5728\u6240\u6709\u64cd\u4f5c\u90fd\u4e0d\u542b\u65e0\u6548\u72b6\u6001\u8f6c\u6362\uff0c\u5219\u7ebf\u7a0b\u5b89\u5168\u6027\u53ef\u4ee5\u59d4\u6258\u7ed9\u5e95\u5c42\u7684\u72b6\u6001\u53d8\u91cf\u3002</p>"},{"location":"languages/java/concurrency/index.html#_22","title":"\u7ebf\u7a0b\u5b89\u5168\u6027\u7684\u59d4\u6258","text":"<p>\u591a\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684\u5bf9\u8c61\uff0c\u7ec4\u5408\u6210\u4e00\u4e2a\u5bf9\u8c61\u65f6\uff08\u5c06\u7ebf\u7a0b\u5b89\u5168\u884c\u59d4\u6258\u4e3a\u591a\u4e2a\u72b6\u6001\u53d8\u91cf\uff09\uff0c\u5176\u7ebf\u7a0b\u5b89\u5168\u6027\uff1a</p> <ul> <li>\u591a\u4e2a\u72b6\u6001\u53d8\u91cf\u662f\u76f8\u4e92\u72ec\u7acb\u7684\uff0c\u7ec4\u5408\u7684\u7c7b\u4e0d\u4f1a\u518d\u5176\u5305\u542b\u7684\u591a\u4e2a\u72b6\u6001\u53d8\u91cf\u4e0a\u589e\u52a0\u4efb\u4f55\u4e0d\u53d8\u6027\u6761\u4ef6\uff0c\u5982\u9f20\u6807\u76d1\u542c\u5668\u548c\u952e\u76d8\u76d1\u542c\u5668\u7ec4\u6210\u7684\u76d1\u542c\u5668\uff1b</li> <li>\u72b6\u6001\u53d8\u91cf\u95f4\u5b58\u5728\u4f9d\u8d56\u5173\u7cfb\uff0c\u5219\u9700\u8981\u989d\u5916\u7684\u540c\u6b65\u673a\u5236\uff0c\u5982\u7528\u4e24\u4e2aAtomInteger\u7ec4\u6210\u7684Ranger\u7c7b\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_23","title":"\u73b0\u6709\u7684\u7ebf\u7a0b\u5b89\u5168\u7c7b\u6dfb\u52a0\u529f\u80fd","text":"<p>\u5982\u4f55\u6269\u5c55\u73b0\u6709\u7684\u7ebf\u7a0b\u5b89\u5168\u7c7b\uff0c\u6dfb\u52a0\u989d\u5916\u7684\u529f\u80fd\uff1a</p> <ul> <li>\"\u6269\u5c55\"\u65b9\u6cd5\u6bd4\u76f4\u63a5\u5c06\u4ee3\u7801\u6dfb\u52a0\u5230\u7c7b\u4e2d\u66f4\u52a0\u8106\u5f31\uff0c\u56e0\u4e3a\u4f9d\u8d56\u7684\u5e95\u5c42\u540c\u6b65\u7b56\u7565\u53ef\u80fd\u4f1a\u53d1\u751f\u53d8\u5316\uff1b</li> <li>\u4e3a\u73b0\u6709\u7684\u7c7b\u6dfb\u52a0\u539f\u5b50\u64cd\u4f5c\u65f6\uff0c\u901a\u8fc7\u7ec4\u5408\u6a21\u5f0f\u53ef\u4ee5\u8ddf\u5e95\u5c42\u89e3\u8026\uff0c\u5916\u5c42\u589e\u52a0\u4e00\u5c42\u989d\u5916\u7684\u52a0\u9501\uff08\u5e95\u5c42\u73b0\u6709\u7684\u7c7b\u4e0d\u5b58\u5728\u7ade\u4e89\uff09\u3002</li> </ul>"},{"location":"languages/java/concurrency/index.html#_24","title":"\u540c\u6b65\u7b56\u7565\u6587\u6863\u5316","text":"<p>\u5728\u6587\u6863\u4e2d\u8bf4\u660e\u5ba2\u6237\u4ee3\u7801\u9700\u8981\u4e86\u89e3\u7684\u7ebf\u7a0b\u5b89\u5168\u6027\u4fdd\u8bc1\uff0c\u4ee5\u53ca\u4ee3\u7801\u7ef4\u62a4\u4eba\u5458\u9700\u8981\u4e86\u89e3\u7684\u540c\u6b65\u7b56\u7565\uff1b</p>"},{"location":"languages/java/concurrency/index.html#todo","title":"\u57fa\u7840\u6784\u5efa\u6a21\u5757\uff08TODO\uff09","text":"<p>Java\u5e73\u53f0\u7c7b\u5e93\u4e2d\u5e76\u53d1\u57fa\u7840\u6784\u5efa\u6a21\u5757\u3002</p>"},{"location":"languages/java/concurrency/index.html#_25","title":"\u4efb\u52a1\u6267\u884c","text":"<p>\u65e0\u9650\u5236\u521b\u5efa\u7ebf\u7a0b\u7684\u4e0d\u8db3\uff1a</p> <ul> <li>\u7ebf\u7a0b\u751f\u547d\u5468\u671f\u7684\u5f00\u9500\u975e\u5e38\u9ad8\uff1aJava\u7684\u7ebf\u7a0b\u4f1a\u6620\u5c04\u5230OS\u7684\u7ebf\u7a0b\uff0c\u9700\u8981JVM\u548c\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u4e00\u4e9b\u8f85\u52a9\u64cd\u4f5c\uff1b</li> <li>\u8d44\u6e90\u6d88\u8017\uff1a\u6d3b\u8dc3\u7684\u7ebf\u7a0b\u4f1a\u6d88\u8017\u7cfb\u7edf\u8d44\u6e90\uff0c\u7279\u522b\u662f\u5185\u5b58\uff0c\u9020\u6210GC\u538b\u529b\u3002\u4e14\u5927\u91cf\u7ebf\u7a0b\u5728\u7ade\u4e89CPU\u8d44\u6e90\u65f6\u4f1a\u4ea7\u751f\u6027\u80fd\u5f00\u9500\u3002</li> </ul> <p>Leader-Follow Pattern\uff1a</p> <p></p> <p>\u4e0a\u56fe\u5c31\u662fL/F\u591a\u7ebf\u7a0b\u6a21\u578b\u7684\u72b6\u6001\u53d8\u8fc1\u56fe\uff0c\u51716\u4e2a\u5173\u952e\u70b9\uff1a</p> <p>\uff081\uff09\u7ebf\u7a0b\u67093\u79cd\u72b6\u6001\uff1a\u9886\u5bfcleading\uff0c\u5904\u7406processing\uff0c\u8ffd\u968ffollowing</p> <p>\uff082\uff09\u5047\u8bbe\u5171N\u4e2a\u7ebf\u7a0b\uff0c\u5176\u4e2d\u53ea\u67091\u4e2aleading\u7ebf\u7a0b\uff08\u7b49\u5f85\u4efb\u52a1\uff09\uff0cx\u4e2aprocessing\u7ebf\u7a0b\uff08\u5904\u7406\uff09\uff0c\u4f59\u4e0b\u6709N-1-x\u4e2afollowing\u7ebf\u7a0b\uff08\u7a7a\u95f2\uff09</p> <p>\uff083\uff09\u6709\u4e00\u628a\u9501\uff0c\u8c01\u62a2\u5230\u5c31\u662fleading</p> <p>\uff084\uff09\u4e8b\u4ef6/\u4efb\u52a1\u6765\u5230\u65f6\uff0cleading\u7ebf\u7a0b\u4f1a\u5bf9\u5176\u8fdb\u884c\u5904\u7406\uff0c\u4ece\u800c\u8f6c\u5316\u4e3aprocessing\u72b6\u6001\uff0c\u5904\u7406\u5b8c\u6210\u4e4b\u540e\uff0c\u53c8\u8f6c\u53d8\u4e3afollowing</p> <p>\uff085\uff09\u4e22\u5931leading\u540e\uff0cfollowing\u4f1a\u5c1d\u8bd5\u62a2\u9501\uff0c\u62a2\u5230\u5219\u53d8\u4e3aleading\uff0c\u5426\u5219\u4fdd\u6301following</p> <p>\uff086\uff09following\u4e0d\u5e72\u4e8b\uff0c\u5c31\u662f\u62a2\u9501\uff0c\u529b\u56fe\u6210\u4e3aleading</p> <p>DelayQueue\uff1a</p> <ul> <li>\u7ba1\u7406\u4e00\u7ec4Delayed\u5bf9\u8c61\uff0c\u6bcf\u4e2a\u5bf9\u8c61\u90fd\u6709\u4e00\u4e2a\u76f8\u5e94\u7684\u5ef6\u8fdf\u65f6\u95f4\uff1b</li> <li> <p>\u53ea\u6709\u67d0\u4e2a\u5143\u7d20\u903e\u671f\u540e\uff0cDelayQueue\u4e2d\u624d\u80fd\u6267\u884ctake\u64cd\u4f5c\uff1b</p> </li> <li> <p>Leader-Follow Pattern\u7684\u53d8\u4f53\uff0c\u7528\u4e8e\u6700\u5c0f\u5316\u4e0d\u5fc5\u8981\u7684\u5b9a\u65f6\u7b49\u5f85\u3002</p> </li> <li>\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u6210\u4e3a\u9886\u5bfc\u8005\u65f6\uff0c\u5b83\u53ea\u7b49\u5f85\u4e0b\u4e00\u4e2a\u5ef6\u8fdf\u8fc7\u53bb\uff0c\u800c\u5176\u4ed6\u7ebf\u7a0b\u5219\u65e0\u9650\u671f\u5730\u7b49\u5f85\u3002</li> <li>\u5728\u4ecetake\uff08\uff09\u6216poll\uff08\u2026\uff09\u8fd4\u56de\u4e4b\u524d\uff0c\u524d\u5bfc\u7ebf\u7a0b\u5fc5\u987b\u5411\u5176\u4ed6\u7ebf\u7a0b\u53d1\u9001\u4fe1\u53f7\uff0c\u9664\u975e\u5176\u4ed6\u7ebf\u7a0b\u5728\u6b64\u671f\u95f4\u6210\u4e3a\u9886\u5bfc\u8005\u3002</li> <li>\u6bcf\u5f53\u961f\u5217\u7684\u5934\u88ab\u4e00\u4e2a\u8fc7\u671f\u65f6\u95f4\u8f83\u65e9\u7684\u5143\u7d20\u66ff\u6362\u65f6\uff0cleader\u5b57\u6bb5\u5c31\u4f1a\u88ab\u91cd\u7f6e\u4e3anull\u800c\u5931\u6548\uff0c\u5e76\u4e14\u4e00\u4e9b\u7b49\u5f85\u7684\u7ebf\u7a0b\uff08\u4e0d\u4e00\u5b9a\u662f\u5f53\u524d\u7684leader\uff09\u4f1a\u6536\u5230\u4fe1\u53f7\u3002</li> <li>\u56e0\u6b64\uff0c\u7b49\u5f85\u7ebf\u7a0b\u5fc5\u987b\u505a\u597d\u51c6\u5907\uff0c\u5728\u7b49\u5f85\u8fc7\u7a0b\u4e2d\u83b7\u5f97\u5e76\u5931\u53bb\u9886\u5bfc\u529b\u3002</li> </ul> <p>CompletionService</p> <ul> <li><code>ExecutorCompletionService</code>\uff1a\u63d0\u4ea4\u4efb\u52a1\uff0c\u5e76\u4e14\u63d0\u4f9b<code>take</code>\u64cd\u4f5c\uff0c\u53ef\u4ee5\u83b7\u53d6\u5b8c\u6210\u7684\u4efb\u52a1\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_26","title":"\u53d6\u6d88\u4e0e\u5173\u95ed","text":""},{"location":"languages/java/concurrency/index.html#_27","title":"\u4efb\u52a1\u53d6\u6d88","text":"<ul> <li>Java\u6ca1\u6709\u63d0\u4f9b\u4efb\u4f55\u673a\u5236\u6765\u5b89\u5168\u5730\u7ec8\u6b62\u7ebf\u7a0b\uff1b</li> </ul> <p>\u4e2d\u65ad</p> <ul> <li>\u53ea\u6709\u5b9e\u73b0\u7ebf\u7a0b\u4e2d\u65ad\u7b56\u7565\u7684\u4ee3\u7801\u624d\u53ef\u4ee5\u5c4f\u853d\u4e2d\u65ad\u8bf7\u6c42\uff0c\u5728\u5e38\u89c4\u7684\u4efb\u52a1\u548c\u5e93\u4ee3\u7801\u4e2d\u90fd\u4e0d\u5e94\u8be5\u5c4f\u853d\u4e2d\u65ad\u8bf7\u6c42\uff1b</li> </ul> <p>\u4e0d\u53ef\u4e2d\u65ad\u7684\u963b\u585e\uff1a</p> <ul> <li>java.io\u4e2d\u7684\u540c\u6b65Socket I/O\uff1a\u901a\u8fc7\u5173\u95ed\u5e95\u5c42\u7684\u5957\u63a5\u5b57\uff0c<code>read/write</code>\u65b9\u6cd5\u963b\u585e\u7684\u7ebf\u7a0b\u4f1a\u629b\u51fa<code>SocketException</code>\uff1b</li> <li>\u53ef\u4ee5\u91cd\u5199<code>ThreadPoolExecutor</code>\u7684<code>newTaskFor</code>\u65b9\u6cd5\uff0c\u5b9e\u73b0Socket\u7684\u4e2d\u65ad\uff1b</li> <li>java.io\u4e2d\u540c\u6b65I/O\uff1a\u7ebf\u7a0b\u963b\u585e\u5728<code>InterruptibleChannel</code>\u7684IO\u4e0a</li> <li>\u4e2d\u65ad\u65f6\u629b\u51fa<code>ClosedByInterruptException</code>\u5f02\u5e38\uff08\u8bbe\u7f6e\u4e2d\u65ad\u72b6\u6001\uff09\uff1b</li> <li>\u5173\u95ed\u65f6\uff0c\u4f1a\u629b\u51fa<code>AsynchronousCloseException</code>\uff1b</li> <li>Selector\u4e2d\u7684I/O\uff1a<code>Selector.select</code>\u65b9\u6cd5\u963b\u585e\u65f6\uff0c\u8c03\u7528close/wakeup\u65b9\u6cd5\u4f1a\u4f7f\u7ebf\u7a0b\u629b\u51faClosedSelectorException\u5e76\u63d0\u524d\u8fd4\u56de\uff1b</li> <li>\u83b7\u53d6\u67d0\u4e2a\u9501\uff1a\u7ebf\u7a0b\u7531\u4e8e\u7b49\u5f85\u67d0\u4e2a\u5185\u7f6e\u9501\u800c\u963b\u585e\uff0c\u5219\u65e0\u6cd5\u54cd\u5e94\u4e2d\u65ad\uff0c\u53ef\u4ee5\u901a\u8fc7<code>lockInterruptibly</code>\u65b9\u6cd5\u54cd\u5e94\u4e2d\u65ad\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_28","title":"\u505c\u6b62\u57fa\u4e8e\u7ebf\u7a0b\u7684\u670d\u52a1","text":"<p>\u5e94\u7528\u62e5\u6709\u670d\u52a1\uff0c\u670d\u52a1\u62e5\u6709\u5de5\u4f5c\u8005\u7ebf\u7a0b\uff0c\u4f46\u662f\u5e94\u7528\u4e0d\u80fd\u62e5\u6709\u5de5\u4f5c\u8005\u7ebf\u7a0b\uff1a</p> <ul> <li>\u670d\u52a1\u5e94\u8be5\u63d0\u4f9b\u751f\u547d\u5468\u671f\u65b9\u6cd5\uff08Lifecycle method\uff09\u6765\u5173\u95ed\u5b83\u81ea\u5df1\u4ee5\u53ca\u5b83\u6240\u62e5\u6709\u7684\u7ebf\u7a0b\u3002</li> </ul> <p>\u201d\u6bd2\u4e38\u201c\uff08Poison Pill\uff09\uff1a\u5f53\u5f97\u5230\u8fd9\u4e2a\u5bf9\u8c61\u65f6\uff0c\u7acb\u5373\u505c\u6b62\uff1a</p> <ul> <li>\u5728\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u5df2\u77e5\u7684\u60c5\u51b5\u4e0b\uff0c\u624d\u53ef\u4ee5\u4f7f\u7528\u201d\u6bd2\u4e38\u201c\u5bf9\u8c61\uff1b</li> <li>\u53ea\u6709\u5728\u65e0\u754c\u961f\u5217\u4e2d\uff0c\u201c\u6bd2\u4e38\u201d\u5bf9\u8c61\u624d\u80fd\u53ef\u5230\u5de5\u4f5c\uff1b</li> </ul> <p><code>ExecutorService</code>\u7684<code>shutdownNow</code>\u7684\u5c40\u9650\uff1a</p> <ul> <li> <p>\u5c1d\u8bd5\u53d6\u6d88\u6b63\u5728\u6267\u884c\u7684\u4efb\u52a1\uff0c\u8fd4\u56de\u6240\u6709\u5df2\u63d0\u4ea4\u4f46\u5c1a\u672a\u5f00\u59cb\u7684\u4efb\u52a1\uff0c\u4f46\u65e0\u6cd5\u901a\u8fc7\u5e38\u89c4\u65b9\u6cd5\u627e\u51fa\u54ea\u4e9b\u4efb\u52a1\u5df2\u5f00\u59cb\u4f46\u5c1a\u672a\u7ed3\u675f\uff1b</p> </li> <li> <p>\u901a\u8fc7\u5728\u4ee3\u7801\u4e2d\u6355\u83b7\u4e2d\u65ad\u7684\u5f62\u5f0f\uff0c\u8fdb\u884c\u5df2\u5f00\u59cb\u4f46\u672a\u7ed3\u675f\u7684\u4efb\u52a1\u7684\u4fdd\u5b58\uff1b</p> </li> </ul> <pre><code>try {\n  runnable.run();\n} finally {\n    if (isShutDown &amp;&amp; Thread.currentThread().isInterrupted()) {\n        taskCancelledAtShutdown.add(runnable);\n    }\n}\n</code></pre> <ul> <li> <p>\"\u8bef\u62a5\"\uff1a\u5728\u4efb\u52a1\u6267\u884c\u6700\u540e\u4e00\u6761\u6307\u4ee4\u4ee5\u53ca\u7ebf\u7a0b\u6c60\u5c06\u4efb\u52a1\u8bb0\u5f55\u4e3a\u201c\u7ed3\u675f\u201d\u7684\u4e24\u4e2a\u65f6\u523b\u4e4b\u95f4\uff0c\u7ebf\u7a0b\u6c60\u88ab\u5173\u95ed\uff1a</p> </li> <li> <p>\u786e\u4fdd\u4efb\u52a1\u662f\u201c\u5e42\u7b49\u201d\u7684\uff0c\u53ef\u4ee5\u5b89\u5168\u5730\u91cd\u8bd5\uff1b</p> </li> </ul>"},{"location":"languages/java/concurrency/index.html#_29","title":"\u5904\u7406\u975e\u6b63\u5e38\u7ec8\u6b62\u7684\u7ebf\u7a0b","text":"<p>ExecutorService \u672a\u6355\u83b7\u5f02\u5e38\u7684\u5904\u7406\uff1a</p> <ul> <li> <p>\u7edf\u4e00\u901a\u8fc7<code>try-catch</code>\u5c01\u88c5\u8fd0\u884c\u4ee3\u7801\uff0c\u6784\u6210Runnable\u6216\u8005Callable\uff1b\u6216\u8005\u91cd\u5199afterExecute\u65b9\u6cd5\uff1b</p> </li> <li> <p><code>execute</code>\u65b9\u6cd5\uff1a</p> </li> <li>\u5c06\u629b\u51fa\u5f02\u5e38\u4ea4\u7ed9\u672a\u6355\u83b7\u5f02\u5e38\u5904\u7406\u5668\uff0c\u901a\u8fc7\u81ea\u5b9a\u4e49ThreadFactory\u521b\u5efaThreadPoolExecutor\uff1b</li> <li><code>submit</code>\u65b9\u6cd5\uff1a</li> <li>\u65e0\u8bba\u629b\u51fa\u5df2\u68c0\u67e5\u8fd8\u662f\u672a\u68c0\u5f02\u5e38\uff0c\u90fd\u4f1a\u8ba4\u4e3a\u662f\u4efb\u52a1\u8fd4\u56de\u72b6\u6001\u7684\u4e00\u90e8\u5206\uff08\u56e0\u4e3asubmit\uff0c\u901a\u8fc7<code>newTaskFor</code>\u5c01\u88c5\u6267\u884c\u903b\u8f91\uff0c\u6355\u83b7\u5f02\u5e38\uff09\uff1b</li> <li>\u4efb\u52a1\u7531\u4e8e\u5f02\u5e38\u800c\u7ed3\u675f\uff0c\u5f02\u5e38\u4f1a\u88ab\u5c01\u88c5\u5230Future.get\u5c01\u88c5\u5728ExecutionException\u4e2d\u91cd\u65b0\u629b\u51fa\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#jvm","title":"JVM\u5173\u95ed","text":""},{"location":"languages/java/concurrency/index.html#_30","title":"\u5173\u95ed\u94a9\u5b50","text":"<p>\u6b63\u5e38\u5173\u95ed</p> <ul> <li>\u5f53\u6700\u540e\u4e00\u4e2a\u201c\u6b63\u5e38\uff08\u975e\u5b88\u62a4\uff09\u201d\u7ebf\u7a0b\u7ed3\u675f\u540e\uff0c\u6216\u8005\u5f53\u8c03\u7528<code>System.exit()</code>\u65f6\uff0c\u6216\u8005\u901a\u8fc7\u5176\u5b83\u7279\u5b9a\u4e8e\u5e73\u53f0\u7684\u65b9\u6cd5\u5173\u95ed\uff08\u5982\u53d1\u9001<code>SIGINT</code>\u6216\u8005<code>CTRL-C</code>\uff09\uff1b</li> </ul> <p>\u5173\u95ed\u94a9\u5b50\uff08Shutdown Hook\uff09\uff1a<code>Runtime.addshutdownHook</code></p> <ul> <li>JVM\u4e0d\u4fdd\u8bc1\u5173\u95ed\u94a9\u5b50\u7684\u8c03\u7528\u987a\u5e8f\uff1b</li> <li>\u5f53\u5173\u95ed\u5e94\u7528\u7a0b\u5e8f\u7ebf\u7a0b\u65f6\uff0c\u5982\u679c\u6709\u7ebf\u7a0b\uff08\u5b88\u62a4/\u975e\u5b88\u62a4\uff09\u4ecd\u5728\u8fd0\u884c\uff0c\u5219\u8fd9\u4e9b\u7ebf\u7a0b\u4f1a\u8ddf\u5173\u95ed\u8fdb\u7a0b\u5e76\u53d1\u6267\u884c\uff1b</li> <li>JVM\u4e0d\u4f1a\u505c\u6b62\u6216\u8005\u4e2d\u65ad\u4efb\u4f55\u5728\u5173\u95ed\u65f6\u4ecd\u7136\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u7ebf\u7a0b\uff0c\u5f53JVM\u6700\u7ec8\u7ed3\u675f\u65f6\uff0c\u8fd9\u4e9b\u7ebf\u7a0b\u624d\u4f1a\u88ab\u5f3a\u884c\u7ed3\u675f\uff1b</li> <li>\u5173\u95ed\u94a9\u5b50\u9700\u8981\u662f\u7ebf\u7a0b\u5b89\u5168\uff1a\u8bbf\u95ee\u5171\u4eab\u6570\u636e\u5fc5\u987b\u4f7f\u7528\u540c\u6b65\u673a\u5236\uff1b</li> <li>\u5173\u95ed\u94a9\u5b50\u4e0d\u5e94\u8be5\u5bf9\u5e94\u7528\u7a0b\u5e8f\u7684\u72b6\u6001\uff08\u5982\u5176\u4ed6\u670d\u52a1\u662f\u5426\u5173\u95ed\u3001\u6240\u6709\u6b63\u5e38\u7ebf\u7a0b\u662f\u5426\u7ed3\u675f\uff09\u6216JVM\u7684\u5173\u95ed\u539f\u56e0\u505a\u51fa\u5047\u8bbe\uff1b</li> <li>\u5173\u95ed\u94a9\u5b50\u5e94\u8be5\u5c3d\u5feb\u9000\u51fa\uff1b</li> </ul> <p>\u5f3a\u884c\u5173\u95ed</p> <ul> <li>\u8c03\u7528<code>Runtime_halt</code>\u6216\u8005\u64cd\u4f5c\u7cfb\u7edfKILL\u8fdb\u7a0b\uff08\u5982\u53d1\u9001<code>SIGKILL</code>\uff09\uff1b</li> <li>\u53ea\u5173\u95edJVM\uff0c\u4e0d\u4f1a\u8fd0\u884c\u5173\u95ed\u94a9\u5b50\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_31","title":"\u5b88\u62a4\u7ebf\u7a0b","text":"<p>\u521b\u5efa\u7ebf\u7a0b\u505a\u4e9b\u8f85\u52a9\u5de5\u4f5c\uff0c\u4e0d\u963b\u788dJVM\u7684\u5173\u95ed\uff0c\u53ef\u4ee5\u4f7f\u7528\u5b88\u62a4\u7ebf\u7a0b\uff08Daemon Thread\uff09\uff1a</p> <ul> <li>JVM\u542f\u52a8\u65f6\u7684\u7ebf\u7a0b\uff0c\u9664\u4e86\u4e3b\u7ebf\u7a0b\uff0c\u5176\u5b83\u90fd\u662f\u5b88\u62a4\u7ebf\u7a0b\uff08\u5982GC\u7b49\uff09\uff1b</li> <li>\u521b\u5efa\u65b0\u7ebf\u7a0b\uff0c\u65b0\u7ebf\u7a0b\u4f1a\u7ee7\u627f\u521b\u5efa\u5b83\u7684\u7ebf\u7a0b\u7684\u5b88\u62a4\u72b6\u6001\uff1b</li> </ul> <p>\u5b88\u62a4\u7ebf\u7a0b\u548c\u666e\u901a\u7ebf\u7a0b\u7684\u5dee\u5f02\uff1a</p> <ul> <li>\u5f53\u7ebf\u7a0b\u9000\u51fa\u65f6\uff0cJVM\u4f1a\u68c0\u67e5\u5176\u5b83\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\uff0c\u5982\u679c\u8fd9\u4e9b\u7ebf\u7a0b\u90fd\u662f\u5b88\u62a4\u7ebf\u7a0b\uff0c\u5219JVM\u4f1a\u6b63\u5e38\u9000\u51fa\u64cd\u4f5c\uff1b</li> <li>\u5f53JVM\u505c\u6b62\u65f6\uff0c\u6240\u6709\u4ecd\u5728\u7684\u5b88\u62a4\u7ebf\u7a0b\u4f1a\u88ab\u629b\u5f03\uff08\u4e0d\u4f1a\u89e6\u53d1<code>finally</code>\u4ee3\u7801\u5757\uff0c\u4e0d\u4f1a\u6267\u884c\u56de\u5377\u6808\uff09\uff0cJVM\u76f4\u63a5\u9000\u51fa\uff1b</li> </ul> <p>\u5b88\u62a4\u7ebf\u7a0b\uff1a</p> <ul> <li>\u5c3d\u53ef\u80fd\u5c11\u7528\uff0c\u5927\u591a\u6570\u64cd\u4f5c\u9700\u8981\u8fdb\u884c\u6e05\u7406\u624d\u53ef\u4ee5\u629b\u5f03\uff0c\u7279\u522b\u65f6\u5b88\u62a4\u7ebf\u7a0b\u4e2d\u6267\u884c\u53ef\u80fd\u5305\u542bIO\u7684\u64cd\u4f5c\uff1b</li> <li>\u6700\u597d\u7528\u4e8e\u6267\u884c\u5185\u90e8\u4efb\u52a1\uff0c\u6bd4\u5982\u5468\u671f\u6027\u5730\u4ece\u5185\u5b58\u7684\u7f13\u5b58\u4e2d\u79fb\u9664\u903e\u671f\u7684\u6570\u636e\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_32","title":"\u7ec8\u7ed3\u5668","text":"<p>\u907f\u514d\u4f7f\u7528\u7ec8\u7ed3\u5668</p> <ul> <li>\u5927\u591a\u6570\u60c5\u51b5\uff0c\u4f7f\u7528<code>finally</code>\u4ee3\u7801\u5757\u548c\u663e\u793a<code>close</code>\u65b9\u6cd5\uff0c\u6bd4\u4f7f\u7528\u7ec8\u7ed3\u5668\u66f4\u597d\u5730\u7ba1\u7406\u8d44\u6e90\uff1b</li> <li>\u4f8b\u5916\uff1a\u7ba1\u7406\u5bf9\u8c61\uff0c\u4e14\u8be5\u5bf9\u8c61\u6301\u6709\u7684\u8d44\u6e90\u662f\u901a\u8fc7\u672c\u5730\u65b9\u6cd5\u83b7\u5f97\u7684\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_33","title":"\u7ebf\u7a0b\u6c60\u7684\u4f7f\u7528","text":"<p>\u53ea\u6709\u5f53\u4efb\u52a1\u90fd\u662f\u540c\u7c7b\u578b\u4e14\u76f8\u4e92\u72ec\u7acb\u65f6\uff0c\u7ebf\u7a0b\u6c60\u7684\u6027\u80fd\u624d\u80fd\u8fbe\u5230\u6700\u4f73\uff1a</p> <ul> <li>\u4efb\u52a1\u4f9d\u8d56\u4e8e\u5176\u5b83\u4efb\u52a1\u65f6\uff0c\u5982\u679c\u7ebf\u7a0b\u6c60\u4e0d\u591f\u5927\uff0c\u53ef\u80fd\u4f1a\u9020\u6210\u7ebf\u7a0b\u9965\u997f\u6b7b\u9501\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_34","title":"\u8bbe\u7f6e\u7ebf\u7a0b\u6c60\u7684\u5927\u5c0f","text":"<ul> <li>\u5bf9\u4e8eCPU\u5bc6\u96c6\u578b\u4efb\u52a1\uff0c\u5728N\u4e2aCPU\u7684\u7cfb\u7edf\u4e0a\uff0c\u5f53\u7ebf\u7a0b\u6c60\u7684\u5927\u5c0f\u4e3a N+1 \u65f6\uff0c\u901a\u5e38\u80fd\u5b9e\u73b0\u6700\u4f18\u7684\u5229\u7528\u7387\uff1b</li> <li>\u5bf9\u4e8eIO\u5bc6\u96c6\u578b\u64cd\u4f5c\uff0c\u7531\u4e8e\u7ebf\u7a0b\u4e0d\u4f1a\u4e00\u76f4\u6267\u884c\uff0c\u56e0\u6b64\u7ebf\u7a0b\u6c60\u7684\u89c4\u6a21\u5e94\u8be5\u66f4\u5927\u3002</li> <li>\u4f30\u7b97\u4efb\u52a1\u7684\u7b49\u5f85\u65f6\u95f4\u548c\u8ba1\u7b97\u65f6\u95f4\u7684\u6bd4\u503c\uff1a</li> <li>\u7ebf\u7a0b\u6c60\u8ba1\u7b97\u516c\u5f0f\uff1a\\(N_{thread}=N_{cpu}*U_{cpu}*(1+\\frac{W}{c})\\)</li> <li>\\(N_{cpu}\\)\uff1acpu\u7684\u4e2a\u6570\uff0c\\(U_{cpu}\\)\uff1acpu\u7684\u5229\u7528\u7387\uff0c\\(\\frac{W}{C}\\)\uff1a\u7b49\u5f85\u65f6\u95f4/\u8ba1\u7b97\u65f6\u95f4</li> </ul>"},{"location":"languages/java/concurrency/index.html#executor","title":"\u914d\u7f6eExecutor","text":"<p>\u7ebf\u7a0b\u6c60\u57fa\u672c\u53c2\u6570\uff1a</p> <ul> <li> <p>\u57fa\u672c\u5927\u5c0f\uff08core size\uff09\uff0c\u6700\u5927\u5927\u5c0f\uff08maximum size \uff09\u3001\u5b58\u6d3b\u65f6\u95f4\u3001\u6392\u961f\u7b56\u7565\u3001\u9971\u548c\u7b56\u7565\u3001\u7ebf\u7a0b\u5de5\u5382</p> </li> <li> <p>\u901a\u8fc7\u8c03\u8282\u7ebf\u7a0b\u6c60\u7684\u57fa\u672c\u5927\u5c0f\u548c\u5b58\u6d3b\u65f6\u95f4\uff0c\u53ef\u4ee5\u5e2e\u52a9\u7ebf\u7a0b\u6c60\u56de\u6536\u7a7a\u95f2\u7ebf\u7a0b\u5360\u6709\u7684\u8d44\u6e90\uff1b</p> </li> </ul> <p>\u6392\u961f\u7b56\u7565\uff1a</p> <ul> <li>\u65e0\u754c\u961f\u5217\uff1a\u7ebf\u7a0b\u6c60\u5904\u7406\u4e0d\u8fc7\u6765\u8bf7\u6c42\uff0c\u4f1a\u9020\u6210\u961f\u5217\u65e0\u9650\u5236\u589e\u52a0\uff0c\u6700\u7ec8OOM\uff1b</li> <li>\u6709\u754c\u961f\u5217\uff1a\u961f\u5217\u6ee1\u540e\u7684\u65b0\u7684\u4efb\u52a1\u8bf7\u6c42\uff0c\u5982\u4f55\u8fdb\u884c\u5904\u7406\uff1f</li> <li>\u540c\u6b65\u79fb\u4ea4\uff08Synchronous Handoff\uff09\uff1a\u5bf9\u4e8e\u5f88\u5927\u6216\u8005\u65e0\u754c\u7684\u961f\u5217\uff0c\u4f7f\u7528SynchronousQueue\u907f\u514d\u4efb\u52a1\u6392\u961f </li> <li>\u76f4\u63a5\u5c06\u4efb\u52a1\u4ece\u751f\u4ea7\u8005\u79fb\u4ea4\u7ed9\u5de5\u4f5c\u8005\u7ebf\u7a0b\uff0c\u4e0d\u9700\u8981\u5148\u653e\u5230\u961f\u5217\u4e2d\uff0c\u518d\u7531\u5de5\u4f5c\u8005\u7ebf\u7a0b\u4ece\u961f\u5217\u4e2d\u63d0\u53d6\u8be5\u4efb\u52a1\uff1b</li> <li>\u5c06\u5143\u7d20\u653e\u5230SynchronousQueue\u4e2d\uff0c\u5fc5\u987b\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u6b63\u5728\u7b49\u5f85\u63a5\u53d7\u8fd9\u4e2a\u5143\u7d20\uff0c\u5982\u679c\u7ebf\u7a0b\u6c60\u5df2\u6ee1\uff0c\u5219\u4f1a\u88ab\u76f4\u63a5\u62d2\u7edd\uff1b</li> <li>\u53ea\u6709\u5f53\u7ebf\u7a0b\u6c60\u662f\u65e0\u754c\u7684\u6216\u8005\u53ef\u4ee5\u62d2\u7edd\u4efb\u52a1\u65f6\uff0cSynchronousQueue\u624d\u6709\u5b9e\u9645\u4ef7\u503c\uff1b</li> </ul> <p>\u9971\u548c\u7b56\u7565\uff1a\u5f53\u6709\u754c\u961f\u5217\u586b\u6ee1\u540e\uff0c\u5904\u7406\u65b0\u6765\u7684\u4efb\u52a1</p> <ul> <li>\u7ec8\u6b62\u7b56\u7565(Abort)\uff1a\u9ed8\u8ba4\uff0c\u629b\u51fa\u672a\u68c0\u67e5\u7684<code>RejectExecutionException</code>\uff0c\u8c03\u7528\u8005\u53ef\u4ee5\u6355\u83b7\u5f02\u5e38\u5e76\u8fdb\u884c\u5904\u7406\uff1b</li> <li>\u629b\u5f03\uff08Discard\uff09\u7b56\u7565\uff1a\u6084\u6084\u629b\u5f03\u4efb\u52a1\uff1b</li> <li>\u629b\u5f03\u6700\u65e7\u4efb\u52a1\uff08DiscardOldestPolicy\uff09\u7b56\u7565\uff1a\u629b\u5f03\u4e0b\u4e00\u4e2a\u5c06\u88ab\u6267\u884c\u7684\u4efb\u52a1\uff0c\u5c1d\u8bd5\u91cd\u65b0\u63d0\u4ea4\u65b0\u7684\u4efb\u52a1\uff1b</li> <li>\u8c03\u7528\u8005\u8fd0\u884c\uff08Caller-Runs\uff09\uff1a\u5c06\u67d0\u4e9b\u4efb\u52a1\u56de\u9000\u5230\u8c03\u7528\u8005\u65b9\u6267\u884c\uff1b</li> </ul> <p>\u7ebf\u7a0b\u5de5\u5382\uff1a\u81ea\u5b9a\u4e49<code>ThreadFactory</code></p> <ul> <li>\u5982\u9700\u8981\u5229\u7528\u5b89\u5168\u7b56\u7565\u6765\u63a7\u5236\u5bf9\u67d0\u4e9b\u7279\u6b8a\u4ee3\u7801\u5e93\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u901a\u8fc7<code>PrivilegedThreadFactory</code>\u521b\u5efa\u51fa\u7684\u7ebf\u7a0b\uff0c\u5c06\u4e0e\u521b\u5efa\u5de5\u5382\u7684\u7ebf\u7a0b\u5177\u5907\u76f8\u540c\u7684\u8bbf\u95ee\u6743\u9650\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#threadpoolexecutor","title":"\u6269\u5c55<code>ThreadPoolExecutor</code>","text":"<ul> <li><code>ThreadPoolExecutor</code>\u7684<code>runWorker</code>\u6267\u884c\u903b\u8f91\u5982\u4e0b\uff1a</li> </ul> <pre><code>try {\n    beforeExecute(wt, task);\n    Throwable thrown = null;\n    try {\n        task.run();\n    } catch (RuntimeException x) {\n        thrown = x; throw x;\n    } catch (Error x) {\n        thrown = x; throw x;\n    } catch (Throwable x) {\n        thrown = x; throw new Error(x);\n    } finally {\n        afterExecute(task, thrown);\n    }\n} finally {\n    task = null;\n    w.completedTasks++;\n    w.unlock();\n}\n</code></pre> <ul> <li>\u53ef\u4ee5\u6269\u5c55<code>beforeExecute</code>\u3001<code>afterExecute</code>\u548c<code>terminate</code>\u65b9\u6cd5\uff0c\u5b9e\u73b0\u5bf9\u4efb\u52a1\u8ba1\u65f6\u7684\u529f\u80fd\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_35","title":"\u56fe\u5f62\u7528\u6237\u754c\u9762\u5e94\u7528\u7a0b\u5e8f","text":"<p>GUI\u90fd\u662f\u5355\u7ebf\u7a0b\u7684\uff0c \u7528\u4e13\u95e8\u7684\u4e8b\u4ef6\u5206\u53d1\u7ebf\u7a0b\uff08Event Dispatch Thread\uff0cEDT\uff09\u6765\u5904\u7406GUI\u4e8b\u4ef6\uff1a</p> <ul> <li>\u91c7\u7528\u4e00\u4e2a\u4e13\u95e8\u7684\u7ebf\u7a0b\u4ece\u961f\u5217\u4e2d\u62bd\u53d6\u4e8b\u4ef6\uff0c\u5e76\u5c06\u5b83\u4eec\u8f6c\u53d1\u5230\u5e94\u7528\u7a0b\u5e8f\u5b9a\u4e49\u7684\u4e8b\u4ef6\u5904\u7406\u5668\uff1b</li> <li>\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u4efb\u52a1\uff0c\u4f1a\u963b\u585eGUI\u54cd\u5e94\uff0c\u56e0\u6b64\u9700\u8981\u7528\u5355\u72ec\u7684\u540e\u53f0\u7ebf\u7a0b\u8fdb\u884c\u5904\u7406\uff1b</li> </ul> <p>\u5206\u89e3\u6a21\u578b\u8bbe\u8ba1\uff1a</p> <ul> <li>\u5b9a\u4e49\uff1a\u5e94\u7528\u7a0b\u5e8f\u4e2d\u65e2\u5305\u542b\u7528\u4e8e\u8868\u793a\u7684\u6570\u636e\u6a21\u578b\uff0c\u53c8\u5305\u542b\u5e94\u7528\u7a0b\u5e8f\u7279\u5b9a\u7684\u6570\u636e\u6a21\u578b\uff1b</li> <li>\u8868\u578b\u6a21\u578b\u88ab\u5c01\u95ed\u5728\u65f6\u95f4\u7ebf\u7a0b\u4e2d\uff0c\u800c\u5176\u5b83\u6a21\u578b\uff08\u5171\u4eab\u6a21\u578b\uff09\u662f\u7ebf\u7a0b\u5b89\u5168\uff0c\u53ef\u4ee5\u7531\u4e8b\u4ef6\u7ebf\u7a0b\u6216\u5e94\u7528\u7a0b\u5e8f\u8bbf\u95ee\uff1b</li> <li>\u8868\u73b0\u6a21\u578b\u4f1a\u6ce8\u518c\u5171\u4eab\u6a21\u578b\u7684\u76d1\u542c\u5668\uff0c\u5728\u66f4\u65b0\u65f6\u5f97\u5230\u901a\u77e5\uff1b</li> <li>\u8868\u73b0\u6a21\u578b\u63a5\u53d7\u66f4\u65b0\u4e8b\u4ef6\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u5171\u4eab\u6a21\u578b\u7684\u5feb\u7167\u8fdb\u884c\u66f4\u65b0\uff0c\u5982\u679c\u6570\u636e\u6bd4\u8f83\u591a\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u53d1\u9001\u589e\u91cf\u66f4\u65b0\u7684\u5f62\u5f0f\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_36","title":"\u907f\u514d\u6d3b\u8dc3\u6027\u5371\u9669","text":"<p>\u6848\u4f8b\uff1a\u54f2\u5b66\u5bb6\u8fdb\u9910\u95ee\u9898\u3002</p> <p>\u6570\u636e\u5e93\u7cfb\u7edf\u8bbe\u8ba1\u4e2d\u8003\u8651\u6b7b\u9501\u68c0\u6d4b\u548c\u6b7b\u9501\u6062\u590d\uff1b</p> <ul> <li>\u6b7b\u9501\u68c0\u6d4b\uff1a\u5728\u8868\u793a\u7b49\u5f85\u5173\u7cfb\u7684\u6709\u5411\u56fe\u4e2d\u641c\u7d22\u5faa\u73af\uff1b</li> <li>\u6b7b\u9501\u6062\u590d\uff1a\u9009\u62e9\u4e00\u4e2a\u727a\u7272\u8005\u653e\u5f03\u9501\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_37","title":"\u6b7b\u9501","text":"<p>\u4e92\u76f8\u6301\u6709\u5bf9\u65b9\u9700\u8981\u7684\u8d44\u6e90\uff08\u793a\u4f8b\uff1a\u8f6c\u8d26\u7684\u7ebf\u7a0b\u5b89\u5168\u5b9e\u73b0\uff09</p> <ul> <li>\u591a\u7ebf\u7a0b\u9700\u8981\u4ee5\u4e00\u81f4\u7684\u987a\u5e8f\u83b7\u53d6\u591a\u4e2a\u9501\uff1a</li> <li>\u53ef\u4ee5\u901a\u8fc7<code>System.identityHashCode</code>\u65b9\u6cd5\uff0c\u51b3\u5b9a\u9501\u7684\u987a\u5e8f\uff1a</li> <li>\u5f53\u4e24\u4e2a\u9501\u7684hash\u503c\u4e00\u6837\u65f6\uff0c\u901a\u8fc7\u5f15\u5165\u7b2c\u4e09\u4e2a\u9501\uff0c\u907f\u514d\u6b7b\u9501\u95ee\u9898\uff1b</li> <li>hash\u51fa\u73b0\u6563\u5217\u51b2\u7a81\u6982\u7387\u5f88\u5c0f\uff0c\u56e0\u6b64\u4e0d\u4f1a\u6210\u4e3a\u6027\u80fd\u74f6\u9888\uff1b</li> <li>\u5728\u6301\u6709\u9501\u7684\u60c5\u51b5\u4e0b\uff0c\u8c03\u7528\u67d0\u4e2a\u5916\u90e8\u65b9\u6cd5\uff0c\u9700\u8981\u8b66\u60d5\u6b7b\u9501\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_38","title":"\u6d3b\u9501","text":"<ul> <li>\u5b9a\u4e49\uff1a\u591a\u4e2a\u76f8\u4e92\u534f\u4f5c\u7684\u7ebf\u7a0b\u5bf9\u5f7c\u6b64\u8fdb\u884c\u54cd\u5e94\u4ece\u800c\u4fee\u6539\u5404\u81ea\u7684\u72b6\u6001\uff0c\u5e76\u4f7f\u4efb\u4f55\u4e00\u7ebf\u7a0b\u65e0\u6cd5\u7ee7\u7eed\u6267\u884c\uff0c\u53d1\u751f\u6d3b\u9501\uff1b</li> <li>\u6d88\u606f\u5904\u7406\u5931\u8d25\uff0c\u91cd\u65b0\u653e\u56de\u961f\u5217\u5934\u5904\u7406\uff0c\u4f1a\u4e00\u76f4\u5faa\u73af\u5931\u8d25\uff0c\u7531\u4e8e\u9519\u8bef\u7684\u6062\u590d\u673a\u5236\uff1b</li> <li>\u53d1\u9001\u5305\u51b2\u7a81\uff0c\u7b49\u5f85\u76f8\u540c\u7684\u65f6\u95f4\u91cd\u8bd5\uff0c\u4e00\u76f4\u51b2\u7a81\u4e00\u76f4\u91cd\u8bd5\uff1b</li> <li>\u89e3\u51b3\u6d3b\u9501\uff0c\u5728\u91cd\u8bd5\u673a\u5236\u4e2d\u5f15\u5165\u968f\u673a\u6027\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_39","title":"\u6027\u80fd\u4e0e\u53ef\u4f38\u7f29\u6027","text":""},{"location":"languages/java/concurrency/index.html#_40","title":"\u53ef\u4f38\u7f29\u6027","text":"<p>\u6027\u80fd = \u54cd\u5e94\u65f6\u95f4 + \u541e\u5410\u91cf</p> <p>\u53ef\u4f38\u7f29\u6027\uff1a\u5f53\u589e\u52a0\u8ba1\u7b97\u8d44\u6e90\uff08\u4f8b\u5982CPU\u3001\u5185\u5b58\u3001\u5b58\u50a8\u6216\u8005IO\u5e26\u5bbd\uff09\u65f6\uff0c\u7a0b\u5e8f\u7684\u541e\u5410\u91cf\u6216\u8005\u5904\u7406\u80fd\u529b\u76f8\u5e94\u589e\u52a0\uff1b</p> <ul> <li>\u4ee5\u6027\u80fd\u6d4b\u8bd5\u4e3a\u57fa\u51c6\uff0c\u907f\u514d\u4e0d\u6210\u719f\u7684\u4f18\u5316\uff0c\u4e0d\u8981\u731c\u6d4b\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#amdahl","title":"Amdahl\u5b9a\u5f8b","text":"<p>Amdahl\u5b9a\u5f8b\uff1a\u5728\u589e\u52a0\u8ba1\u7b97\u8d44\u6e90\u65f6\uff0c\u7a0b\u5e8f\u5728\u7406\u8bba\u4e0a\u80fd\u591f\u5b9e\u73b0\u6700\u9ad8\u7684\u52a0\u901f\u6bd4</p> <p>\\(Speedup \\le \\frac{1}{F+\\frac{1-F}{N}}\\)</p> <ul> <li>F \u8868\u793a\u4e32\u884c\u90e8\u5206\u6240\u5360\u7684\u6bd4\u4f8b\uff0cN \u8868\u793a\u5904\u7406\u5668\u7684\u4e2a\u6570\uff1b</li> </ul> <p>\u8bc4\u4f30\u4e00\u4e2a\u7b97\u6cd5\uff0c\u8003\u8651\u7b97\u6cd5\u5728\u6570\u767e\u4e2a\u6216\u8005\u6570\u5343\u4e2a\u5904\u7406\u5668\u7684\u60c5\u51b5\u4e0b\u7684\u6027\u80fd\u8868\u73b0\uff0c\u5bf9 \u53ef\u80fd\u51fa\u73b0\u7684\u53ef\u4f38\u7f29\u6027\u5c40\u9650\u6709\u4e00\u5b9a\u7684\u8ba4\u77e5\u3002</p>"},{"location":"languages/java/concurrency/index.html#_41","title":"\u7ebf\u7a0b\u7684\u5f00\u9500","text":""},{"location":"languages/java/concurrency/index.html#_42","title":"\u4e0a\u4e0b\u6587\u5207\u6362","text":"<ul> <li>\u4fdd\u5b58\u5f53\u524d\u7ebf\u7a0b\u7684\u6267\u884c\u4e0a\u4e0b\u6587\uff0c\u5c06\u8c03\u5ea6\u7684\u7ebf\u7a0b\u7684\u6267\u884c\u4e0a\u4e0b\u6587\u5207\u6362\u4e3a\u5f53\u524d\u4e0a\u4e0b\u6587\uff1b</li> <li>\u4f1a\u9020\u6210\u7f13\u5b58\u7f3a\u5931\uff0c\u7ebf\u7a0b\u9700\u8981\u7684\u6570\u636e\u4e0d\u5728\u5904\u7406\u5668\u7684\u672c\u5730\u7f13\u5b58\u4e2d\uff1b</li> <li>\u8c03\u5ea6\u5668\u4e3a\u6bcf\u4e2a\u53ef\u8fd0\u884c\u7684\u7ebf\u7a0b\u5206\u914d\u4e00\u4e2a\u6700\u5c0f\u7684\u6267\u884c\u65f6\u95f4\uff0c\u5373\u4f7f\u6709\u8bb8\u591a\u5176\u5b83\u7684\u7ebf\u7a0b\u6b63\u5728\u7b49\u5f85\u6267\u884c\uff1a</li> <li>\u5c06\u4e0a\u4e0b\u6587\u5207\u6362\u5230\u5f00\u9500\u5206\u914d\u5230\u66f4\u591a\u4e0d\u4f1a\u4e2d\u65ad\u7684\u6267\u884c\u65f6\u95f4\u4e0a\uff0c\u63d0\u9ad8\u6574\u4f53\u7684\u541e\u5410\u91cf</li> <li>\u963b\u585e\u8d8a\u591a\uff08IO\u963b\u585e\u3001\u9501\u83b7\u53d6\uff0c\u6761\u4ef6\u53d8\u91cf\u7b49\u5f85\uff09\uff0c\u4e0e\u8ba1\u7b97\u5bc6\u96c6\u578b\u7684\u7a0b\u5e8f\u53d1\u751f\u8d8a\u591a\u7684\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u589e\u52a0\u8c03\u5ea6\u5f00\u9500\uff0c\u964d\u4f4e\u541e\u5410\u91cf\uff1b</li> <li>\u5927\u591a\u6570\u7684\u901a\u7528\u7684\u5904\u7406\u5668\u4e2d\uff0c\u4e0a\u4e0b\u6587\u5207\u6362\u7684\u5f00\u9500\u76f8\u5f53\u4e8e5000~10000\u4e2a\u65f6\u949f\u5468\u671f\uff0c\u5373\u51e0\u5fae\u5999\uff1b</li> <li><code>vmstat</code>\u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u4e0a\u4e0b\u6587\u5207\u6362\u6b21\u6570\u548c\u5185\u6838\u6267\u884c\u65f6\u95f4\u6bd4\u4f8b\uff1a</li> <li>\u5185\u6838\u5360\u7528\u7387\u6bd4\u8f83\u9ad8\uff08&gt;10%\uff09\uff0c\u8868\u793a\u8c03\u5ea6\u6d3b\u52a8\u53d1\u751f\u9891\u7e41\uff0c\u53ef\u80fd\u7531\u4e8eIO\u6216\u8005\u9501\u7ade\u4e89\u5bfc\u81f4\u7684\u963b\u585e\u5f15\u8d77\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_43","title":"\u5185\u5b58\u540c\u6b65","text":"<p>\u540c\u6b65\u64cd\u4f5c\u7684\u6027\u80fd\u5f00\u9500\uff1a</p> <p>\u53ef\u89c1\u6027\u4fdd\u8bc1\uff08\u5982<code>synchronized</code>\u548c<code>volatile</code>\uff09\uff1a\u5185\u5b58\u6805\u680f</p> <ul> <li>\u5237\u65b0\u7f13\u5b58\uff0c\u4f7f\u7f13\u5b58\u65e0\u6548\uff0c\u5237\u65b0\u786c\u4ef6\u7684\u5199\u7f13\u5b58\uff0c\u4ee5\u53ca\u505c\u6b62\u6267\u884c\u7ba1\u9053\uff1b</li> <li>\u6291\u5236\u7f16\u8bd1\u5668\u4f18\u5316\u64cd\u4f5c\uff0c\u5982\u7981\u6b62\u91cd\u6392\u5e8f\u7b49\uff1b</li> </ul> <p>\u65e0\u7ade\u4e89\u7684\u540c\u6b65\uff1a\u5982<code>volatile</code> \uff0c\u6d88\u8017 20 ~ 250\u4e2a\u65f6\u949f\u5468\u671f\uff1b</p> <ul> <li>\u7f16\u8bd1\u5668\u4f18\u5316\u9501\u7ade\u4e89\uff1a\u5982\u9003\u9038\u5206\u6790\u9501\u662f\u5426\u53ea\u7531\u5f53\u524d\u7ebf\u7a0b\u83b7\u53d6\uff1b\u9501\u7c92\u5ea6\u7c97\u5316\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_44","title":"\u963b\u585e","text":"<p>\u975e\u7ade\u4e89\u7684\u540c\u6b65\u53ef\u4ee5\u5b8c\u5168\u5728JVM\u4e2d\u5b9e\u73b0\uff0c\u800c\u7ade\u4e89\u7684\u540c\u6b65\u9700\u8981\u64cd\u4f5c\u7cfb\u7edf\u7684\u4ecb\u5165\uff0c\u589e\u52a0\u5f00\u9500\u3002</p> <p>\u9501\u7ade\u4e89\u65f6\uff0c\u7ade\u4e89\u5931\u8d25\u7684\u7ebf\u7a0b\u4f1a\u963b\u585e\uff1a</p> <ul> <li>\u81ea\u65cb\u7b49\u5f85\u6216\u8005OS\u963b\u585e\u6302\u8d77\u7ebf\u7a0b\uff1a\u53d6\u51b3\u4e8e\u4e0a\u4e0b\u6587\u5207\u6362\u7684\u5f00\u9500\u4ee5\u53ca\u5728\u6210\u529f\u83b7\u53d6\u9501\u4e4b\u524d\u9700\u8981\u7b49\u5f85\u7684\u65f6\u95f4\uff1b</li> </ul>"},{"location":"languages/java/concurrency/index.html#_45","title":"\u51cf\u5c11\u9501\u7684\u7ade\u4e89","text":"<p>\u5728\u5e76\u53d1\u7a0b\u5e8f\u4e2d\uff0c\u5bf9\u53ef\u4f38\u7f29\u6027\u7684\u6700\u4e3b\u8981\u7684\u5a01\u80c1\u5c31\u662f\u72ec\u5360\u65b9\u5f0f\u7684\u8d44\u6e90\u9501\u3002</p> <p>\u964d\u4f4e\u9501\u7684\u7ade\u4e89\u7a0b\u5ea6\uff1a</p> <ul> <li>\u51cf\u5c11\u9501\u7684\u6301\u6709\u65f6\u95f4\uff1b</li> <li>\u7f29\u5c0f\u9501\u7684\u8303\u56f4</li> <li>\u964d\u4f4e\u9501\u7684\u8bf7\u6c42\u9891\u7387\uff1b</li> <li>\u9501\u5206\u89e3\uff1a\u591a\u4e2a\u76f8\u4e92\u72ec\u7acb\u7684\u9501\u4fdd\u62a4\u591a\u4e2a\u72ec\u7acb\u7684\u72b6\u6001\u53d8\u91cf\uff1b</li> <li>\u9501\u5206\u6bb5\uff1a\u5bf9\u4e00\u7ec4\u72ec\u7acb\u7684\u5bf9\u8c61\u4e0a\u7684\u9501\u8fdb\u884c\u5206\u89e3\uff0c\u5982ConcurrentHashMap\uff1b<ul> <li>\u5c06\u53cd\u590d\u8ba1\u7b97\u7ed3\u679c\u7f13\u5b58\uff0c\u5f15\u5165\u201c\u70ed\u70b9\u57df\u201d\uff0c\u6bd4\u5982Map\u7684size\u65b9\u6cd5\uff1b</li> <li>\u201c\u70ed\u70b9\u57df\u201d\u53ef\u6269\u5c55\u6027\u7684\u74f6\u9888\uff0c\u91c7\u7528\u5206\u6bb5\u679a\u4e3e\uff08\u6bcf\u4e2a\u6bb5\u90fd\u5b58\u672c\u8eab\u7684size\uff09\uff1b</li> </ul> </li> <li>\u4f7f\u7528\u5e26\u6709\u534f\u8c03\u673a\u5236\u7684\u72ec\u5360\u9501\uff0c\u5141\u8bb8\u66f4\u597d\u7684\u5e76\u53d1\u6027\uff1b</li> <li>\u4f7f\u7528\u5e76\u53d1\u5bb9\u5668\u3001\u8bfb\u5199\u9501\u3001\u4e0d\u53ef\u53d8\u5bf9\u8c61\u6216\u8005\u539f\u5b50\u5bf9\u8c61\u7b49 \uff1b</li> </ul>"},{"location":"languages/java/concurrency/asyn_mutex.html","title":"\u540c\u6b65&amp;\u4e92\u65a5","text":"<p>\u5171\u4eab\u8d44\u6e90\u7684\u4e92\u65a5\u8bbf\u95ee</p> <p>\u5171\u4eab\u8d44\u6e90\u540c\u6b65\uff08\u540c\u6b65\u662f\u8981\u4fdd\u8bc1\u4e24\u4e2a\u7ebf\u7a0b\u4e8b\u4ef6\u6267\u884c\u7684\u65f6\u5e8f\u5173\u7cfb\uff09</p>"},{"location":"languages/java/concurrency/asyn_mutex.html#synchronized","title":"synchronized","text":"<pre><code>synchronized {\n}\n</code></pre>"},{"location":"languages/java/concurrency/asyn_mutex.html#wait-notify","title":"wait &amp; notify","text":"<pre><code>synchronized {\n    while (condition is not matched) {\n        obj.wait();  // (Release lock, and reacquired on wakeup)\n    }\n}\n\nsynchronized {\n    obj.notify();\n}\n</code></pre> <ul> <li>wait \u65b9\u6cd5\u4f1a\u91ca\u653e\u9501\uff0c\u8fdb\u884c\u5bf9\u8c61\u7684\u7b49\u5f85\u6c60\uff0c\u800c Thread\u7684sleep\uff0cyield\u65b9\u6cd5\u4e0d\u4f1a\u91ca\u653e\u9501\uff1b</li> <li>notify()\u4f1a\u5728\u540c\u6b65\u65b9\u6cd5\u5757\u6267\u884c\u5b8c\u540e\uff0c\u518d\u91ca\u653e\u9501\uff1b</li> <li>\u5728\u6ca1\u6709\u901a\u77e5\u7684\u60c5\u51b5\u4e0b\uff0c\u7b49\u5f85\u7ebf\u7a0b\u4e5f\u53ef\u80fd\uff08\u4f46\u5f88\u5c11\uff09\u4f1a\u82cf\u9192\u8fc7\u6765\uff0c\u88ab\u79f0\u4e3a\u201c\u4f2a\u5524\u9192\u201d\uff08spurious wakeup\uff09\u3002</li> <li>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u4f18\u5148\u4f7f\u7528notifyAll\uff0c\u800c\u4e0d\u662fnotify\u3002</li> </ul>"},{"location":"languages/java/concurrency/asyn_mutex.html#cas","title":"CAS","text":"<p>CAS : Compare And Swap\uff0c\u4e50\u89c2\u9501\u673a\u5236</p> <p>Java\u7684\u539f\u5b50\u7c7bAtomicXXX \u548c XXXAdder \u90fd\u662f\u4f7f\u7528CAS\u4fdd\u8bc1\u4e86\u7ebf\u7a0b\u5b89\u5168\u3002</p> <ul> <li>ABA\u95ee\u9898\uff1a\u6211\u4eec\u62ff\u5230\u671f\u671b\u503cA\uff0c\u518d\u7528CAS\u5199\u65b0\u503cC\uff0c\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u539f\u5b50\u6027\u3002\u56e0\u6b64\uff0c\u5c31\u6709\u53ef\u80fd\u51fa\u73b0\u5b9e\u9645\u503c\u5df2\u7ecf\u6539\u4e3aB\uff0c\u53c8\u6539\u56deA\uff0c\u8fd9\u79cd\u60c5\u51b5\u3002\u5f53\u6267\u884cCAS\u65f6\uff0c\u4e0d\u4f1a\u8bc6\u522bABA\u95ee\u9898\uff0c\u53ea\u8981\u770b\u5b9e\u9645\u503c\u8fd8\u662fA\uff0c\u5c31\u6267\u884c\u4e86\u3002</li> <li> <p>\u901a\u8fc7\u7248\u672c\u53f7\uff0c\u5373\u4e00\u4e2a\u9012\u589e\u7684\u503c\uff0c\u53ef\u4ee5\u89e3\u51b3 ABA \u7684\u95ee\u9898</p> </li> <li> <p>\u539f\u5b50\u5316\u7684\u5bf9\u8c61\u5f15\u7528\uff1a\u5bf9\u8c61\u5f15\u7528\u90fd\u662f\u5c01\u88c5\u7c7b\u578b\uff0c\u652f\u6301CAS\u64cd\u4f5c\u3002\u76f8\u5173\u5b9e\u73b0\u5305\u62ec\uff1aAtomicReference\u3001AtomicStampedReference\u548cAtiomicMarkableReference\u3002AtomicStampedReference\u548cAtiomicMarkableReference\u89e3\u51b3\u4e86ABA\u95ee\u9898\u3002</p> </li> <li>\u539f\u5b50\u5316\u6570\u7ec4\uff1aAtomicIntegerArray\u3001AtomicLongArray\u548cAtomicReferenceArray\uff1b</li> <li>\u539f\u5b50\u5316\u5bf9\u8c61\u5c5e\u6027\u66f4\u65b0\u5668\uff1aAtomicIntegerFieldUpdater\u3001AtomicLongFiledUpdater\u548cAtomicReferenceFieldUpdater</li> <li>\u539f\u5b50\u5316\u7684\u7d2f\u52a0\u5668\uff1aDoubleAccumulator\u3001DoubleAdder\u3001LongAccumulator \u548c LongAdder</li> </ul>"},{"location":"languages/java/concurrency/asyn_mutex.html#varhandle","title":"VarHandle","text":"<p>JDK8\uff0c\u5982\u679c\u8981\u539f\u5b50\u6027\u5730\u589e\u52a0\u67d0\u4e2a\u5b57\u6bb5\u7684\u503c\uff0c\u5230\u76ee\u524d\u4e3a\u6b62\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u4e09\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li> <p>\u4f7f\u7528AtomicInteger\u6765\u8fbe\u5230\u8fd9\u79cd\u6548\u679c\uff0c\u8fd9\u79cd\u95f4\u63a5\u7ba1\u7406\u65b9\u5f0f\u589e\u52a0\u4e86\u7a7a\u95f4\u5f00\u9500\uff0c\u8fd8\u4f1a\u5bfc\u81f4\u989d\u5916\u7684\u5e76\u53d1\u95ee\u9898\uff1b</p> </li> <li> <p>\u4f7f\u7528\u539f\u5b50\u6027\u7684FieldUpdaters\uff0c\u5229\u7528\u4e86\u53cd\u5c04\u673a\u5236\uff0c\u64cd\u4f5c\u5f00\u9500\u4e5f\u4f1a\u66f4\u5927\uff1b</p> </li> <li> <p>\u4f7f\u7528sun.misc.Unsafe\u63d0\u4f9b\u7684JVM\u5185\u7f6e\u51fd\u6570API\uff0c\u867d\u7136\u8fd9\u79cd\u65b9\u5f0f\u6bd4\u8f83\u5feb\uff0c\u4f46\u5b83\u4f1a\u635f\u5bb3\u5b89\u5168\u6027\u548c\u53ef\u79fb\u690d\u6027\u3002</p> </li> </ul> <p>\u5728 VarHandle \u51fa\u73b0\u4e4b\u524d\uff0c\u8fd9\u4e9b\u6f5c\u5728\u7684\u95ee\u9898\u4f1a\u968f\u7740\u539f\u5b50API\u7684\u4e0d\u65ad\u6269\u5927\u800c\u8d8a\u6765\u8d8a\u906d\u3002</p> <p>JDK 9 \u65b0\u589e\u5b9a\u4e49\u3002</p> <p>\u53d8\u91cf\u53e5\u67c4\uff1a</p> <ul> <li>\u662f\u4e00\u4e2a\u53d8\u91cf\u6216\u4e00\u7ec4\u53d8\u91cf\u7684\u5f15\u7528\uff0c\u5305\u62ec\u9759\u6001\u57df\uff0c\u975e\u9759\u6001\u57df\uff0c\u6570\u7ec4\u5143\u7d20\u548c\u5806\u5916\u6570\u636e\u7ed3\u6784\u4e2d\u7684\u7ec4\u6210\u90e8\u5206\u7b49</li> </ul> <p>VarHandle \u7684\u51fa\u73b0\u66ff\u4ee3\u4e86 java.util.concurrent.atomic \u548c sun.misc.Unsafe \u7684\u90e8\u5206\u64cd\u4f5c\u3002\u5e76\u4e14\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u6807\u51c6\u7684\u5185\u5b58\u5c4f\u969c\u64cd\u4f5c\uff0c\u7528\u4e8e\u66f4\u52a0\u7ec6\u7c92\u5ea6\u7684\u63a7\u5236\u5185\u5b58\u6392\u5e8f\u3002\u5728\u5b89\u5168\u6027\u3001\u53ef\u7528\u6027\u3001\u6027\u80fd\u4e0a\u90fd\u8981\u4f18\u4e8e\u73b0\u6709\u7684API\u3002</p> <p>VarHandle \u53ef\u4ee5\u4e0e\u4efb\u4f55\u5b57\u6bb5\u3001\u6570\u7ec4\u5143\u7d20\u6216\u9759\u6001\u53d8\u91cf\u5173\u8054\uff0c\u652f\u6301\u5728\u4e0d\u540c\u8bbf\u95ee\u6a21\u578b\u4e0b\u5bf9\u8fd9\u4e9b\u7c7b\u578b\u53d8\u91cf\u7684\u8bbf\u95ee\uff0c\u5305\u62ec\u7b80\u5355\u7684 read/write \u8bbf\u95ee\uff0cvolatile \u7c7b\u578b\u7684 read/write \u8bbf\u95ee\uff0c\u548c CAS(compare-and-swap)\u7b49\u3002</p>"},{"location":"languages/java/concurrency/asyn_mutex.html#countdownlatch","title":"CountDownLatch","text":"<p>\u7ebf\u7a0b\u95f4\u540c\u6b65\uff0c\u591a\u7528\u4e8e\u4efb\u52a1\u5212\u5206\u573a\u666f\uff0c\u6807\u8bb0\u4efb\u52a1\u662f\u5426\u5b8c\u6210\uff1b</p> <pre><code>// ExecutorService\u7528\u4e8e\u8ba1\u65f6\u7ed3\u675f\nCountDownLatch latch = new CountDownLatch(1);\nlatch.countDown();\nlatch.wait();\n\n// \u7ebf\u7a0b\u95f4\u540c\u6b65\nclass Driver { // ...\n    void main() throws InterruptedException {\n        CountDownLatch startSignal = new CountDownLatch(1);\n        CountDownLatch doneSignal = new CountDownLatch(N);\n\n        for (int i = 0; i &lt; N; ++i) // create and start threads\n            new Thread(new Worker(startSignal, doneSignal)).start();\n\n        doSomethingElse();            // don't let run yet\n        startSignal.countDown();      // let all threads proceed\n        doSomethingElse();\n        doneSignal.await();           // wait for all to finish\n    }\n}\n\nclass Worker implements Runnable {\n    private final CountDownLatch startSignal;\n    private final CountDownLatch doneSignal;\n    Worker(CountDownLatch startSignal, CountDownLatch doneSignal) {\n        this.startSignal = startSignal;\n        this.doneSignal = doneSignal;\n    }\n    public void run() {\n        try {\n\n\n            startSignal.await();\n            doWork();\n            doneSignal.countDown();\n        } catch (InterruptedException ex) {} // return;\n    }\n\n    void doWork() { ... }\n}\n</code></pre>"},{"location":"languages/java/concurrency/asyn_mutex.html#_2","title":"\u9759\u6001\u521d\u59cb\u5316\u6b7b\u9501","text":""},{"location":"languages/java/concurrency/asyn_mutex.html#1","title":"\u793a\u4f8b1","text":"<p>\u7c7bA\u7684\u9759\u6001\u521d\u59cb\u5316\u6d89\u53ca\u5230\u591a\u4e2a\u7ebf\u7a0b\uff0c\u4e14\u591a\u4e2a\u7ebf\u7a0b\u4e2d\u53c8\u4f1a\u8c03\u7528\u7c7bA\u7684\u9759\u6001\u521d\u59cb\u5316\u6216\u9759\u6001\u65b9\u6cd5\uff1b</p> <p>(\u793a\u4f8b1\uff1alambda\u65b9\u6cd5\u88ab\u7f16\u8bd1\u6210\u7c7b\u7684\u9759\u6001\u65b9\u6cd5\uff0c\u591a\u7ebf\u7a0b\u6267\u884c\u9759\u6001\u65b9\u6cd5\u4f1a\u7b49\u5f85\u7c7b\u521d\u59cb\u5316\u5b8c\u6210\uff0c\u5bfc\u81f4\u6b7b\u9501\uff09</p> <pre><code>import java.util.stream.IntStream;\n\npublic class StaticInitialDeadLockDemo {\n    static {\n        long count = IntStream.range(0, 10000).parallel().map(i -&gt; i).count();\n        System.out.println(\"done:\" + count);\n    }\n\n    public static void main(final String[] args) {}\n}\n</code></pre>"},{"location":"languages/java/concurrency/asyn_mutex.html#2","title":"\u793a\u4f8b2","text":"<p>\u7c7bA\u7684\u9759\u6001\u521d\u59cb\u5316\u548c\u7c7bB\u7684\u9759\u6001\u521d\u59cb\u5316\u4e92\u76f8\u5f15\u7528\uff0c\u4e0d\u540c\u7684\u7ebf\u7a0b\u4e2d\u540c\u65f6\u8c03\u7528\u7c7bA\u548c\u7c7bB\u7684\u521d\u59cb\u5316\uff1b\uff08\u793a\u4f8b2\uff09</p> <pre><code>public class StaticInitialDeadLockDemo2 {\n    public static void main(String[] args) throws Exception {\n        System.out.println(\"Main begin...\");\n        new Thread(() -&gt; System.out.println(Env.EVN_STR)).start();\n        System.out.println(Constants.CONSTANTS_STR);\n        System.out.println(\"Main end\");\n    }\n\n    public static final class Env {\n        static final StringBuilder EVN_STR = new StringBuilder(\"env str\");\n\n        static {\n            System.out.println(\"Env static block begin, \" + Thread.currentThread());\n            // deadlock by Constants\n            System.out.println(\"Env refer -&gt; \" + Constants.CONSTANTS_STR);\n            System.out.println(\"Env static block end\");\n        }\n    }\n\n    public static class Constants {\n        static final StringBuilder CONSTANTS_STR = new StringBuilder(\"constants str\");\n\n        static {\n            System.out.println(\"Constants static block begin, \" + Thread.currentThread());\n            // deadlock by Env\n            System.out.println(\"Constants refer -&gt; \" + Env.EVN_STR);\n            System.out.println(\"Constants static block end\");\n        }\n    }\n}\n</code></pre>"},{"location":"languages/java/concurrency/asyn_mutex.html#_3","title":"\u539f\u7406","text":"<p>\u89c1 https://docs.oracle.com/javase/specs/jls/se8/html/jls-12.html#jls-12.4.2      </p> <p>For each class or interface C, there is a unique initialization lock LC : </p> <ol> <li>Synchronize on the initialization lock, LC, for C. This involves waiting until the current thread can acquire LC.</li> <li>If the Class object for C indicates that initialization is in progress for C by some other thread, then release LC and block the current thread until informed that the in-progress initialization has completed, at which time repeat this step.</li> <li>If the Class object for C indicates that initialization is in progress for C by the current thread, then this must be a recursive request for initialization. Release LC and complete normally.</li> <li>If the Class object for C indicates that C has already been initialized, then no further action is required. Release LC and complete normally.</li> </ol>"},{"location":"languages/java/concurrency/future.html","title":"\u5f02\u6b65\u6267\u884c","text":""},{"location":"languages/java/concurrency/future.html#future","title":"Future","text":"<p>\u5f02\u6b65\u6267\u884c\u7684\u7ed3\u679c\uff0c\u53ef\u4e0eExecutorService\u7ebf\u7a0b\u6c60\u4f7f\u7528\uff1b</p> <ul> <li>\u4e0d\u63d0\u4f9b\u56de\u8c03\u51fd\u6570</li> </ul> <pre><code>public class FutureDemo1 {\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        long l = System.currentTimeMillis();\n        ExecutorService executorService = Executors.newSingleThreadExecutor();\n        Future&lt;Integer&gt; future = executorService.submit(new Callable&lt;Integer&gt;() {\n            @Override\n            public Integer call() throws Exception {\n                System.out.println(\"\u6267\u884c\u8017\u65f6\u64cd\u4f5c...\");\n                timeConsumingOperation();\n                return 100;\n            }\n        }); //&lt;1&gt;\n        //\u5176\u4ed6\u8017\u65f6\u64cd\u4f5c..&lt;3&gt;\n        System.out.println(\"\u8ba1\u7b97\u7ed3\u679c:\" + future.get());//&lt;2&gt;\n        System.out.println(\"\u4e3b\u7ebf\u7a0b\u8fd0\u7b97\u8017\u65f6:\" + (System.currentTimeMillis() - l) + \" ms\");\n    }\n\n    static void timeConsumingOperation() {\n        try {\n            Thread.sleep(3000);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>"},{"location":"languages/java/concurrency/future.html#completablefuture","title":"CompletableFuture","text":"<p>CompletableFuture \u7528<code>then\uff0cwhen</code>\u7b49\u64cd\u4f5c\u6765\u9632\u6b62Future\u7684\u963b\u585e\u548c\u8f6e\u8be2isDone\u7684\u73b0\u8c61\u51fa\u73b0\u3002</p> <ul> <li>\u5f02\u6b65\u65b9\u6cd5\u90fd\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u7ebf\u7a0b\u6c60\u4f5c\u4e3a\u4efb\u52a1\u7684\u8fd0\u884c\u73af\u5883\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u5c31\u4f1a\u4f7f\u7528<code>ForkJoinPool</code>\u7ebf\u7a0b\u6c60\u6765\u6267\u884c\u3002</li> </ul> <pre><code>import java.util.concurrent.CompletableFuture;\nimport java.util.concurrent.CountDownLatch;\n\npublic class CompletableFutureDemo {\n\n    public static void main(String[] args) throws InterruptedException {\n        long l = System.currentTimeMillis();\n        CountDownLatch countDownLatch = new CountDownLatch(1);\n\n        CompletableFuture&lt;Integer&gt; completableFuture = CompletableFuture.supplyAsync(() -&gt; {\n            System.out.println(\"\u6267\u884c\u8017\u65f6\u64cd\u4f5c...\");\n            timeConsumingOperation();\n            return 100;\n        });\n        completableFuture.whenComplete((result, e) -&gt; {\n            System.out.println(\"\u7ed3\u679c\uff1a\" + result);\n            countDownLatch.countDown();\n        });\n        System.out.println(\"\u4e3b\u7ebf\u7a0b\u8fd0\u7b97\u8017\u65f6:\" + (System.currentTimeMillis() - l) + \" ms\");\n        countDownLatch.await();\n    }\n\n    static void timeConsumingOperation() {\n        try {\n            Thread.sleep(3000);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre> <p>\u9664\u4e86\u4e32\u884c\u6267\u884c\u5916\uff0c\u591a\u4e2a<code>CompletableFuture</code>\u8fd8\u53ef\u4ee5\u5e76\u884c\u6267\u884c\u3002</p> <ul> <li><code>anyOf()</code>\u53ef\u4ee5\u5b9e\u73b0\u201c\u4efb\u610f\u4e2a<code>CompletableFuture</code>\u53ea\u8981\u4e00\u4e2a\u6210\u529f\u201d</li> <li><code>allOf()</code>\u53ef\u4ee5\u5b9e\u73b0\u201c\u6240\u6709<code>CompletableFuture</code>\u90fd\u5fc5\u987b\u6210\u529f\u201d\uff0c\u8fd9\u4e9b\u7ec4\u5408\u64cd\u4f5c\u53ef\u4ee5\u5b9e\u73b0\u975e\u5e38\u590d\u6742\u7684\u5f02\u6b65\u6d41\u7a0b\u63a7\u5236\u3002</li> </ul> <p>\u6700\u540e\u6211\u4eec\u6ce8\u610f<code>CompletableFuture</code>\u7684\u547d\u540d\u89c4\u5219\uff1a</p> <ul> <li><code>xxx()</code>\uff1a\u8868\u793a\u8be5\u65b9\u6cd5\u5c06\u7ee7\u7eed\u5728\u5df2\u6709\u7684\u7ebf\u7a0b\u4e2d\u6267\u884c\uff1b</li> <li><code>xxxAsync()</code>\uff1a\u8868\u793a\u5c06\u5f02\u6b65\u5728\u7ebf\u7a0b\u6c60\u4e2d\u6267\u884c\u3002</li> </ul>"},{"location":"languages/java/concurrency/threads.html","title":"\u591a\u7ebf\u7a0b","text":""},{"location":"languages/java/concurrency/threads.html#thread","title":"Thread\u7c7b","text":""},{"location":"languages/java/concurrency/threads.html#_2","title":"\u4e2d\u65ad","text":"<p>\u8c03\u7528\u7ebf\u7a0b\u7684interupt\u65b9\u6cd5\u65f6\uff1a</p> <p>1\uff09\u7ebf\u7a0b\u963b\u585e\u5728wait, join, sleep\u65b9\u6cd5\u65f6\uff0c\u4f1a\u629b\u51faInterruptException\u5f02\u5e38\uff08\u4e2d\u65ad\u72b6\u6001\u4f1a\u88ab\u6e05\u9664\uff09\uff1b</p> <p>2\uff09\u7ebf\u7a0b\u963b\u585e\u5728<code>InterruptibleChannel</code>\u7684IO\u4e0a\u65f6\uff0c\u629b\u51faClosedByInterruptException\u5f02\u5e38\uff08\u8bbe\u7f6e\u4e2d\u65ad\u72b6\u6001\uff09\uff1b</p> <p>3\uff09\u7ebf\u7a0b\u963b\u585e\u5728NIO\u4e2dSelector\u4e2d\uff0c\u4f1a\u7acb\u5373\u8fd4\u56de\uff08\u8bbe\u7f6e\u4e2d\u65ad\u72b6\u6001\uff09\uff1b</p> <p>4\uff09\u5176\u4ed6\u60c5\u51b5\uff1a\u8bbe\u7f6e\u4e2d\u65ad\u72b6\u6001</p> <p>\u901a\u8fc7\u4fe1\u53f7\u53ef\u4ee5\u63a7\u5236\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u7684\u52a8\u4f5c\uff0c\u6bd4\u5982IO\u963b\u585e\u65f6\u4ecd\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528interrupt\u9000\u51fa\uff0c\u6b64\u65f6\u901a\u8fc7\u6807\u5fd7\uff08volatile boolean\uff09\u65e0\u6cd5\u8fbe\u5230\u6548\u679c\u3002</p> <ul> <li>interrupt()\uff0c\u5728\u4e00\u4e2a\u7ebf\u7a0b\u4e2d\u8c03\u7528\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u7684interrupt()\u65b9\u6cd5\uff0c\u5373\u4f1a\u5411\u90a3\u4e2a\u7ebf\u7a0b\u53d1\u51fa\u4fe1\u53f7\u2014\u2014\u7ebf\u7a0b\u4e2d\u65ad\u72b6\u6001\u5df2\u88ab\u8bbe\u7f6e\u3002\u81f3\u4e8e\u90a3\u4e2a\u7ebf\u7a0b\u4f55\u53bb\u4f55\u4ece\uff0c\u7531\u5177\u4f53\u7684\u4ee3\u7801\u5b9e\u73b0\u51b3\u5b9a\u3002</li> <li>isInterrupted()\uff0c\u7528\u6765\u5224\u65ad\u8c03\u7528\u7684\u7ebf\u7a0b\uff08this\uff09\u7684\u4e2d\u65ad\u72b6\u6001(true or false)\u3002</li> <li>interrupted()\u662f\u9759\u6001\u65b9\u6cd5\uff0c\u5224\u65ad\u5f53\u524d\u7ebf\u7a0b\uff08currentThread\uff09\u7684\u4e2d\u65ad\u72b6\u6001\u5e76\u6062\u590d\u4e2d\u65ad\u72b6\u6001\uff1b</li> </ul>"},{"location":"languages/java/concurrency/threads.html#_3","title":"\u5f02\u5e38","text":"<p>\u7ebf\u7a0b\u4e2d\u5f02\u5e38\u5e94\u8be5\u81ea\u5df1\u6355\u83b7\uff0c\u7ebf\u7a0b\u4e2d\u5f02\u5e38\u629b\u51fa\uff0c\u5219\u7ebf\u7a0b\u505c\u6b62\u8fd0\u884c\uff0c\u4f46\u662f\u4e0d\u4f1a\u5f71\u54cd\u4e3b\u7ebf\u7a0b\u548c\u5176\u5b83\u7ebf\u7a0b\uff1b</p> <p>JVM\u53d1\u73b0\u4e00\u4e2a\u7ebf\u7a0b\u56e0\u672a\u6355\u83b7\u5f02\u5e38\u800c\u9000\u51fa\uff0c\u5c31\u4f1a\u628a\u8be5\u5f02\u5e38\u4ea4\u7ed9Thread\u5bf9\u8c61\u8bbe\u7f6e\u7684UncaughtExceptionHandler\u6765\u5904\u7406\uff0c\u6bd4\u5982\u628a\u6ca1\u6709\u6293\u4f4f\u5730\u5f02\u5e38\u5199\u5165\u65e5\u5fd7\u3002</p> <ul> <li>\u5168\u5c40\u7684\u9759\u6001\u65b9\u6cd5 <code>Thread::setDefaultUncaughtExceptionHandler</code> \uff1b</li> <li>\u5b9e\u4f8b\u7ea7\u7684<code>setUncaughtExceptionHandler</code>\u7684\u65b9\u5f0f\uff0c\u5904\u7406\u5b50\u5b9e\u4f8b\u7ebf\u7a0b\u7684\u5f02\u5e38\uff08\u6267\u884c\u4ecd\u7136\u5728\u5b50\u7ebf\u7a0b\u4e2d\u6267\u884c\uff09\uff0c</li> </ul>"},{"location":"languages/java/concurrency/threads.html#_4","title":"\u7ebf\u7a0b\u72b6\u6001","text":"<p>Java\u8bed\u8a00\u4e2d\u7ebf\u7a0b\u4e00\u5171\u6709\u516d\u79cd\u72b6\u6001\uff0c\u5206\u522b\u662f\uff1a</p> <ol> <li> <p>\u521d\u59cb\u5316\u72b6\u6001 NEW;</p> </li> <li> <p>\u53ef\u8fd0\u884c/\u8fd0\u884c\u72b6\u6001 RUNNABLE\uff1b</p> </li> <li> <p>\u963b\u585e\u72b6\u6001 BLOCKED\uff1b</p> </li> <li> <p>\u65e0\u9650\u65f6\u7b49\u5f85\u72b6\u6001 WAITING;</p> </li> <li> <p>\u6709\u9650\u65f6\u7b49\u5f85\u72b6\u6001 TIMED_WAITING\uff1b</p> </li> <li> <p>\u7ec8\u6b62\u72b6\u6001 TERMINATED\uff1b</p> </li> </ol> <p>Java \u628a OS \u7684\u53ef\u8fd0\u884c\u4e0e\u8fd0\u884c\u72b6\u6001\u5408\u4e00\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u8bed\u8a00\u5c42\u9762\u4e0a\u63a7\u5236\u4e0d\u4e86\uff1b\u628a\u963b\u585e\u72b6\u6001\u62c6\u5206\u6210\u4e09\u79cd\u72b6\u6001\uff1aBLOCKED\u3001WAITING\u4e0eTIMED_WAITING\uff0c\u5bf9\u5e94\u4e0d\u540c\u963b\u585e\u573a\u666f</p> <p>RUNNABLE\u4e0e\u4e09\u79cd\u963b\u585e\u72b6\u6001\u7684\u8f6c\u6362</p> <ul> <li> <p>RUNNABLE -&gt; BLOCK</p> </li> <li> <p>\u7ebf\u7a0b\u7b49\u5f85synchronized\u65f6\uff0c\u5f53\u7b49\u5f85\u7ebf\u7a0b\u83b7\u53d6\u5230synchronized\u9690\u5f0f\u9501\u65f6\uff0c\u4f1a\u5207\u56de\u5230RUNNABLE\u72b6\u6001\u3002</p> </li> <li> <p>\u9700\u8981\u6ce8\u610f\u7684\u4e00\u4e2a\u95ee\u9898\u662f\uff0c\u8c03\u7528\u963b\u585eAPI\u65f6\uff0c\u5982IO\uff0cJava\u7ebf\u7a0b\u5bf9\u8c61\u7684\u72b6\u6001\u4e0d\u4f1a\u662fBLOCKED\u3002\u867d\u7136\u5b9e\u9645\u4e0aOS\u4f1a\u5c06\u6b64\u7ebf\u7a0b\u4f11\u7720\uff0c\u7b49\u5f85\u518d\u6b21\u8c03\u5ea6\u3002\u4f46Java\u8bed\u8a00\u5c42\u9762\u4e0a\u611f\u77e5\u4e0d\u5230\uff0c\u4e5f\u4e0d\u7528\u611f\u77e5\u3002</p> </li> <li> <p>RUNNABLE -&gt; WAITING</p> </li> </ul> <p>\u6709\u4e09\u79cd\u60c5\u51b5\u4f1a\u8ba9\u7ebf\u7a0b\u4eceRUNNABLE\u5207\u6362\u5230WAITING\u72b6\u6001\uff1a</p> <ul> <li> <p>\u7ebf\u7a0b\u83b7\u53d6synchronized\u540e\uff0c\u8c03\u7528\u4e86\u65e0\u53c2\u6570\u7684Object.wait()\u65b9\u6cd5\uff1b</p> </li> <li> <p>\u7ebf\u7a0b\u6267\u884c\u65f6\u8c03\u7528\u4e86\u5176\u4ed6\u7ebf\u7a0b\u7684thread.join()\u65b9\u6cd5\uff0c\u7b49\u5f85\u5176\u4ed6\u7ebf\u7a0b\u7ed3\u675f\uff0c\u518d\u91cd\u65b0\u53d8\u4e3aRUNABLE\u72b6\u6001\uff1b</p> </li> <li> <p>\u8c03\u7528lockSupport.park()\u65b9\u6cd5\uff1b</p> </li> <li> <p>RUNNABLE\u5230TIMED_WAITING\u72b6\u6001</p> </li> </ul> <p>\u5230TIMED_WAITING\u4e0eWAITING\u7c7b\u4f3c\uff0c\u53ea\u662f\u591a\u4e86\u4e00\u4e2atime\u53c2\u6570\u3002\u5177\u4f53\u6765\u8bf4\u6709\u56db\u79cd\u60c5\u51b5\uff1a</p> <ul> <li>\u6709\u8d85\u65f6\u53c2\u6570\u7684sleep\uff0cThread.sleep(long);</li> <li>\u6709\u8d85\u65f6\u53c2\u6570\u7684wait\uff0cObject.wait(long);</li> <li> <p>\u6709\u8d85\u65f6\u53c2\u6570\u7684join\uff0cThread.join(long);</p> </li> <li> <p>\u6709\u8d85\u65f6\u53c2\u6570\u7684LockSupport\uff08\u4e3a\u4e86\u5b8c\u6574\u6b63\u786e\uff0c\u6211\u4eec\u4e0d\u4f1a\u7528\u5230\u7684\uff09\uff1b</p> </li> </ul>"},{"location":"languages/java/concurrency/threads.html#threadlocal","title":"ThreadLocal","text":"<ul> <li>\u4e00\u4e2aThreadLocal\u5b9e\u4f8b\uff0c\u53ea\u80fd\u5b58\u50a8\u4e00\u4e2a\u5bf9\u8c61\uff0c\u901a\u8fc7Thread\u4e2d\u7684ThreadLocal.ThreadLocalMap\u4fdd\u5b58ThreadLocal \u5230 value\u7684\u6620\u5c04\uff08WeakReference key\uff09\uff1b</li> <li>\u628a\u6570\u636e\u653e\u5728Thread\u5bf9\u8c61\u5185\uff0c\u53ef\u4ee5\u4fdd\u8bc1ThreadLocal\u4e0eThread\u4e00\u8d77\u88ab\u56de\u6536\uff1b</li> <li>\u4f7f\u7528ThreadLocal\u65f6\u9700\u8981\u6ce8\u610f\u7ebf\u7a0b\u6c60\u4e2d\u8c03\u7528ThreadLocal\u8981\u624b\u52a8\u7684\u91ca\u653e\u8d44\u6e90\uff1b</li> </ul>"},{"location":"languages/java/concurrency/threads.html#_5","title":"\u7ebf\u7a0b\u6c60","text":""},{"location":"languages/java/concurrency/threads.html#executorservice","title":"ExecutorService","text":"<ul> <li>\u7ebf\u7a0b\u6c60\u7684\u5177\u4f53\u5b9e\u73b0\uff1aThreadPoolExecutor\uff0cScheduledThreadPoolExecutor</li> <li>\u5de5\u5382\u7c7b\uff1aExecutors</li> </ul> <p>shutdown \u65b9\u6cd5\u4e0d\u4f1a\u7b49\u5f85\u63d0\u4ea4\u7684\u4efb\u52a1\u7ebf\u7a0b\u7ed3\u675f\uff1b</p> <p>invokeAny\uff1a\u8fd4\u56de\u4efb\u610f\u4e00\u4e2a\u6210\u529f\u7ed3\u675f\u7684\u4efb\u52a1\uff08\u5373Task\u6ca1\u6709\u5f02\u5e38\u629b\u51fa\uff09\uff0c\u5176\u5b83\u4efb\u52a1\u4f1a\u88abcancle\u3002\u53ef\u7528\u4e8e\u5206\u5e03\u5f0f\u5224\u65ad\u5b58\u5728\u3002</p> <p>invokeAll\uff1a\u542f\u52a8\u6240\u6709\u4efb\u52a1\uff0c\u8d85\u65f6\u65f6\u95f4\u8fc7\u540e\uff0c\u4efb\u52a1\u8981\u4e48\u5b8c\u6210\uff0c\u8981\u4e48\u88ab\u53d6\u6d88\uff0c\u53ef\u4ee5\u901a\u8fc7get\u6216\u8005isCancelled\u88ab\u53d6\u6d88\uff1b</p> <p>Future <p>Future\u7684cancel\u65b9\u6cd5\uff0c\u662f\u901a\u8fc7\u8c03\u7528\u7ebf\u7a0b\u7684interrupt\u65b9\u6cd5\uff0c\u6ca1\u6709IO\u963b\u585e\u60c5\u51b5\u6216\u8005\u7ebf\u7a0b\u6355\u83b7\u4e86\u4e2d\u65ad\u5f02\u5e38\uff0c\u65e0\u6cd5\u53d6\u6d88\u3002</p> <p>Future\u7684get\u65b9\u6cd5\uff0c\u629b\u51faInterruptedException\u548cExecutionException\uff08\u5982\u679cTask\u629b\u51fa\u5f02\u5e38\uff0c\u5219\u4f1a\u88ab\u5c01\u88c5\u4e3a\u8be5\u5f02\u5e38\uff0c\u901a\u8fc7getCause\u53ef\u4ee5\u83b7\u53d6\u4efb\u52a1\u5177\u4f53\u629b\u51fa\u7684\u5f02\u5e38\uff09\u3002</p> <p>\u7ee7\u627fThreadPoolExecutor\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49</p> <ul> <li>afterExecute(Runnable r, Throwable t) \uff1b</li> <li>beforeExecute(Thread t, Runnable r)\uff1b</li> </ul>"},{"location":"languages/java/concurrency/threads.html#_6","title":"\u5982\u4f55\u7b49\u5f85\u6240\u6709\u7ebf\u7a0b\u7ed3\u675f\u540e\u518d\u9000\u51fa?","text":"<ul> <li>\u7b49\u5f85\u8db3\u591f\u957f\u7684\u65f6\u95f4\uff0cshutdown\u4e4b\u540e\u7528 awaitTermination \uff1b</li> <li>\u7528 CountdownLatch\uff08\u5df2\u77e5\u7ebf\u7a0b\u7684\u60c5\u51b5\uff09\uff0c\u4e0d\u9700\u8981shutdown\uff1b</li> <li>\u8fd0\u884c\u671f\u95f4\u4e0d\u7ed3\u675f\uff0c\u7b49\u5f85JVM\u9000\u51fa\uff1b</li> </ul>"},{"location":"languages/java/concurrency/threads.html#_7","title":"\u907f\u514d\u7ebf\u7a0b\u6c60\u6267\u884c\u8fc7\u8f7d","text":"<ul> <li>\u9632\u6b62\u56e0\u4efb\u52a1\u6570\u8fc7\u591a\u5bfc\u81f4\u961f\u5217\u4e2d\u592a\u957f\uff0c\u53ef\u4ee5\u901a\u8fc7\u5224\u65ad\u961f\u5217\u957f\u5ea6\u9608\u503c\u7684\u65b9\u5f0f\uff08&gt;1000\uff09\uff0c\u5bf9\u8c03\u7528\u7ebf\u7a0b\u8fdb\u884csleep\uff1b</li> </ul>"},{"location":"languages/java/concurrency/threads.html#_8","title":"\u5f02\u5e38\u5904\u7406","text":"<p>\u7ebf\u7a0b\u6c60\u5728\u8fd0\u884cTask\u65f6\uff0c\u4e0d\u4f1a\u5bf9\u5f02\u5e38\u505a\u5904\u7406\uff0c\u800c\u662f\u76f4\u63a5\u5411\u4e0a\u5c42\u629b\u51fa\uff1a</p> <p></p> <ul> <li> <p>\u5728Task\u4ee3\u7801\u91cc\uff0c\u663e\u793a\u8fdb\u884ctry-catch\uff1b</p> </li> <li> <p>\u53ef\u4ee5\u901a\u8fc7\u81ea\u5b9a\u4e49\u7684<code>ThreadFactory</code>\uff0c\u4e3a\u65b0\u521b\u5efa\u51fa\u6765\u7684\u7ebf\u7a0b\u8bbe\u7f6e <code>UncaughtExceptionHandler</code>\u3002</p> </li> </ul> <p>\u5982\u679cTask\u629b\u51fa\u5f02\u5e38\uff0c\u4e14\u6ca1\u6709\u6355\u83b7\uff0c\u5bf9\u4e8e\u7ebf\u7a0b\u6c60\uff0c\u4f1a\u521b\u5efa\u65b0\u7684\u7ebf\u7a0b\u8fdb\u884c\u6267\u884c\uff0c\u4e0d\u4f1a\u9020\u6210\u7ebf\u7a0b\u6c60\u5f02\u5931\u8d25\u3002</p>"},{"location":"languages/java/concurrency/threads.html#executorcompletionservice","title":"ExecutorCompletionService","text":"<p>\u5b9a\u4e49\u5b50\u7c7b\u5b9e\u73b0\u4e86FutureTask\u7684done\u65b9\u6cd5\uff0c\u5c06\u6267\u884c\u7ed3\u679c\u6dfb\u52a0\u5230BlockingQueue\u4e2d\uff0c\u63d0\u4f9bpoll\uff08\u975e\u963b\u585e\uff09\u548ctake\uff08\u963b\u585e\uff09\u65b9\u6cd5\u83b7\u53d6Future\u7ed3\u679c\u3002</p> <p>ThreadPoolExecutor\u4e2d\u7684invoke\u673a\u5236\u5c31\u662f\u901a\u8fc7\u8be5\u5b9e\u4f8b\u5b9e\u73b0\u3002</p> <p>FutureTask \u5982\u679c\u6267\u884c\u5931\u8d25\uff08cancle\u6216\u5176\u5b83\u5f02\u5e38\uff09\uff0c\u5219\u4f1a\u5728get\u65f6\u5019\uff0c\u629b\u51faExecutionException\u3002</p>"},{"location":"languages/java/concurrency/threads.html#phase","title":"Phase","text":"<p>\u7ebf\u7a0b\u95f4\u540c\u6b65\u624b\u6bb5\uff0c\u53ef\u91cd\u7528\u7684\u540c\u6b65\u969c\u3002\u4e00\u4e2a\u4efb\u52a1\u95f4\u9700\u8981\u5212\u5206\u591a\u4e2a\u9636\u6bb5\uff0c\u6bcf\u4e2a\u9636\u6bb5\u9700\u8981\u7ebf\u7a0b\u5168\u90e8\u5b8c\u6210\u624d\u7ee7\u7eed\u4e0b\u4e00\u9636\u6bb5\u3002</p> <p>Phaser\u662f\u5728\u7ebf\u7a0b\u52a8\u6001\u6570\u9700\u8981\u7ee7\u7eed\u6267\u884c\u4e4b\u524d\u7b49\u5f85\u7684\u5c4f\u969c\u3002\u5728CountDownLatch\u4e2d\uff0c\u8be5\u6570\u5b57\u65e0\u6cd5\u52a8\u6001\u914d\u7f6e\uff0c\u9700\u8981\u5728\u521b\u5efa\u5b9e\u4f8b\u65f6\u63d0\u4f9b\u3002</p> <p>arriveAndAwaitAdvance \uff1a\u5230\u8fbe\u8be5\u9636\u6bb5\uff0c\u7b49\u5f85\u5176\u5b83\u5230\u8fbe\u3002</p> <p>onAdvance\uff1a</p>"},{"location":"languages/java/concurrency/threads.html#fork-join","title":"Fork Join","text":"<p>\u901a\u8fc7\u5206\u6cbb\u7b97\u6cd5\u5c06\u95ee\u9898\u5212\u5206\u4e3a\u8f83\u5c0f\u7684\u95ee\u9898\uff0c\u5e76\u9012\u5f52\u91cd\u590d\u8be5\u8fc7\u7a0b\uff0c\u8be5\u95ee\u9898\u53ef\u4ee5\u901a\u8fc7Exeuctor\u8fdb\u884c\u89e3\u51b3\uff0c\u4f46\u4e3a\u4e86\u66f4\u9ad8\u6548\u89e3\u51b3\uff0cJava 7\u5f15\u5165Fork/Join\u6846\u67b6\u3002</p> <p>\u5de5\u4f5c\u7a83\u53d6\uff08work-stealing\uff09\u7b97\u6cd5\u662f\u6307\u67d0\u4e2a\u7ebf\u7a0b\u4ece\u5176\u4ed6\u961f\u5217\u91cc\u7a83\u53d6\u4efb\u52a1\u6765\u6267\u884c\u3002\u5f53\u4efb\u52a1\u4f7f\u7528join()\u65b9\u6cd5\u7b49\u5f85\u67d0\u4e2a\u5b50\u4efb\u52a1\u7ed3\u675f\u65f6\uff0c\u6267\u884c\u8be5\u4efb\u52a1\u7684\u7ebf\u7a0b\u4f1a\u4ece\u4efb\u52a1\u6c60\u4e2d\u9009\u53d6\u53e6\u4e00\u4e2a\u7b49\u5f85\u6267\u884c\u7684\u4efb\u52a1\u5e76\u4e14\u5f00\u59cb\u6267\u884c\u3002</p> <p>\u5f53\u5927\u91cf\u7684\u4efb\u52a1\u4ea7\u751f\u5b50\u4efb\u52a1\u7684\u65f6\u5019\uff0c\u6216\u8005\u540c\u65f6\u5f53\u6709\u8bb8\u591a\u5c0f\u4efb\u52a1\u88ab\u63d0\u4ea4\u5230\u7ebf\u7a0b\u6c60\u4e2d\u7684\u65f6\u5019\uff0c\u8fd9\u79cd\u5904\u7406\u662f\u975e\u5e38\u9ad8\u6548\u7684\u3002</p> Call from non-fork/join clients Call from within fork/join computations Arrange async execution execute(ForkJoinTask) ForkJoinTask.fork Await and obtain result invoke(ForkJoinTask) ForkJoinTask.invoke Arrange exec and obtain Future submit(ForkJoinTask) ForkJoinTask.fork (ForkJoinTasks are Futures)"},{"location":"languages/java/concurrency/threads.html#forkjointask","title":"ForkJoinTask","text":"<ul> <li>fork()   \u5c06\u5b50\u4efb\u52a1\u53d1\u9001\u7ed9Fork/Join\u6267\u884c\u5668\u3002</li> <li>join()   \u5f53\u4efb\u52a1\u5b8c\u6210\u7684\u65f6\u5019\u8fd4\u56de\u8ba1\u7b97\u7ed3\u679c\u3002</li> <li>invoke()   \u5f00\u59cb\u6267\u884c\u4efb\u52a1\uff0c\u5982\u679c\u5fc5\u8981\uff0c\u7b49\u5f85\u8ba1\u7b97\u5b8c\u6210\u3002</li> </ul> <p>\u5b50\u7c7b\uff1a</p> <ul> <li>RecursiveAction   \u4e00\u4e2a\u9012\u5f52\u65e0\u7ed3\u679c\u7684ForkJoinTask\uff08\u6ca1\u6709\u8fd4\u56de\u503c\uff09</li> <li>RecursiveTask   \u4e00\u4e2a\u9012\u5f52\u6709\u7ed3\u679c\u7684ForkJoinTask\uff08\u6709\u8fd4\u56de\u503c\uff09</li> <li>CountedCompleter \u4f5c\u4e3a\u4efb\u52a1\u5b8c\u6210\u65f6\u89e6\u53d1\u53e6\u4e00\u4efb\u52a1\u7684\u8d77\u70b9</li> </ul> <p>TODO\uff1aCounterCompleter \u4f7f\u7528\u8be6\u60c5\u4e86\u89e3</p>"},{"location":"languages/java/concurrency/threads.html#_9","title":"\u9650\u5236","text":"<ul> <li>\u57fa\u672c\u95ee\u9898\u7684\u89c4\u6a21\u4e0d\u80fd\u8fc7\u5927\uff0c\u4e5f\u4e0d\u80fd\u8fc7\u5c0f\uff1b</li> <li>\u6570\u636e\u53ef\u7528\u524d\uff0c\u4e0d\u5e94\u8be5\u4f7f\u7528\u963b\u585e\u578bIO\uff1b</li> <li>\u4e0d\u80fd\u5728\u4efb\u52a1\u5185\u629b\u51fa\u6821\u9a8c\u5f02\u5e38\uff1b</li> </ul>"},{"location":"languages/java/concurrency/varhandle.html","title":"VarHandle","text":""},{"location":"languages/java/concurrency/varhandle.html#_1","title":"\u80cc\u666f","text":"<p>JDK8\uff0c\u5982\u679c\u8981\u539f\u5b50\u6027\u5730\u589e\u52a0\u67d0\u4e2a\u5b57\u6bb5\u7684\u503c\uff0c\u5230\u76ee\u524d\u4e3a\u6b62\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u4e09\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li> <p>\u4f7f\u7528AtomicInteger\u6765\u8fbe\u5230\u8fd9\u79cd\u6548\u679c\uff0c\u8fd9\u79cd\u95f4\u63a5\u7ba1\u7406\u65b9\u5f0f\u589e\u52a0\u4e86\u7a7a\u95f4\u5f00\u9500\uff0c\u8fd8\u4f1a\u5bfc\u81f4\u989d\u5916\u7684\u5e76\u53d1\u95ee\u9898\uff1b</p> </li> <li> <p>\u4f7f\u7528\u539f\u5b50\u6027\u7684FieldUpdaters\uff0c\u5229\u7528\u4e86\u53cd\u5c04\u673a\u5236\uff0c\u64cd\u4f5c\u5f00\u9500\u4e5f\u4f1a\u66f4\u5927\uff1b</p> </li> <li> <p>\u4f7f\u7528sun.misc.Unsafe\u63d0\u4f9b\u7684JVM\u5185\u7f6e\u51fd\u6570API\uff0c\u867d\u7136\u8fd9\u79cd\u65b9\u5f0f\u6bd4\u8f83\u5feb\uff0c\u4f46\u5b83\u4f1a\u635f\u5bb3\u5b89\u5168\u6027\u548c\u53ef\u79fb\u690d\u6027\u3002</p> </li> </ul> <p>\u5728 VarHandle \u51fa\u73b0\u4e4b\u524d\uff0c\u8fd9\u4e9b\u6f5c\u5728\u7684\u95ee\u9898\u4f1a\u968f\u7740\u539f\u5b50API\u7684\u4e0d\u65ad\u6269\u5927\u800c\u8d8a\u6765\u8d8a\u906d\u3002</p> <p>JDK 9 \u65b0\u589e\u5b9a\u4e49\u3002</p> <p>\u53d8\u91cf\u53e5\u67c4\uff1a</p> <ul> <li>\u662f\u4e00\u4e2a\u53d8\u91cf\u6216\u4e00\u7ec4\u53d8\u91cf\u7684\u5f15\u7528\uff0c\u5305\u62ec\u9759\u6001\u57df\uff0c\u975e\u9759\u6001\u57df\uff0c\u6570\u7ec4\u5143\u7d20\u548c\u5806\u5916\u6570\u636e\u7ed3\u6784\u4e2d\u7684\u7ec4\u6210\u90e8\u5206\u7b49</li> </ul> <p>VarHandle \u7684\u51fa\u73b0\u66ff\u4ee3\u4e86 java.util.concurrent.atomic \u548c sun.misc.Unsafe \u7684\u90e8\u5206\u64cd\u4f5c\u3002\u5e76\u4e14\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u6807\u51c6\u7684\u5185\u5b58\u5c4f\u969c\u64cd\u4f5c\uff0c\u7528\u4e8e\u66f4\u52a0\u7ec6\u7c92\u5ea6\u7684\u63a7\u5236\u5185\u5b58\u6392\u5e8f\u3002\u5728\u5b89\u5168\u6027\u3001\u53ef\u7528\u6027\u3001\u6027\u80fd\u4e0a\u90fd\u8981\u4f18\u4e8e\u73b0\u6709\u7684API\u3002</p> <p>VarHandle \u53ef\u4ee5\u4e0e\u4efb\u4f55\u5b57\u6bb5\u3001\u6570\u7ec4\u5143\u7d20\u6216\u9759\u6001\u53d8\u91cf\u5173\u8054\uff0c\u652f\u6301\u5728\u4e0d\u540c\u8bbf\u95ee\u6a21\u578b\u4e0b\u5bf9\u8fd9\u4e9b\u7c7b\u578b\u53d8\u91cf\u7684\u8bbf\u95ee\uff0c\u5305\u62ec\u7b80\u5355\u7684 read/write \u8bbf\u95ee\uff0cvolatile \u7c7b\u578b\u7684 read/write \u8bbf\u95ee\uff0c\u548c CAS(compare-and-swap)\u7b49\u3002</p>"},{"location":"languages/java/concurrency/volatile.html","title":"Volatile","text":"<p>\u53ef\u89c1\u6027\uff1a\u5185\u5b58\u540c\u6b65\u969c</p> <ul> <li>\u5f53\u5199\u4e00\u4e2avolatile\u53d8\u91cf\u65f6\uff0cJMM\u4f1a\u628a\u8be5\u7ebf\u7a0b\u5bf9\u5e94\u7684\u672c\u5730\u5185\u5b58\u4e2d\u7684\u5171\u4eab\u53d8\u91cf\u503c\u7acb\u5373\u5237\u65b0\u56de\u4e3b\u5185\u5b58\u4e2d\u3002</li> <li>\u5f53\u8bfb\u4e00\u4e2avolatile\u53d8\u91cf\u65f6\uff0cJMM\u4f1a\u628a\u8be5\u7ebf\u7a0b\u5bf9\u5e94\u7684\u672c\u5730\u5185\u5b58\u8bbe\u7f6e\u4e3a\u65e0\u6548\uff0c\u91cd\u65b0\u56de\u5230\u4e3b\u5185\u5b58\u4e2d\u8bfb\u53d6\u6700\u65b0\u5171\u4eab\u53d8\u91cf\u3002</li> </ul> <p>\u6709\u5e8f\u6027\uff1a\u7981\u91cd\u6392\uff01</p> <p>\u4e00\u5199\u591a\u8bfb\u573a\u666f\uff0c\u53ef\u4ee5\u4e0d\u7528\u9501\uff0c\u7528volatile\u4fee\u9970\u5373\u53ef\u3002</p> <ul> <li>\u5f15\u7528\u53d8\u91cf\u7684\u8d4b\u503c\u662f\u539f\u5b50\u6027\u64cd\u4f5c</li> </ul>"},{"location":"languages/java/concurrency/volatile.html#_1","title":"\u5185\u5b58\u5c4f\u969c","text":"<p>\u901a\u8fc7\u63d2\u5165\u5185\u5b58\u5c4f\u969c\u7981\u6b62\u5728\u5185\u5b58\u5c4f\u969c\u524d\u540e\u7684\u6307\u4ee4\u6267\u884c\u91cd\u6392\u5e8f\u4f18\u5316\u3002</p> <p></p>"},{"location":"languages/java/concurrency/volatile.html#_2","title":"\u53cc\u91cd\u6821\u9a8c","text":"<p>\u6307\u4ee4\u91cd\u6392\u4e0e\u53cc\u91cd\u6821\u9a8c\u5355\u4f8b\uff0c\u901a\u8fc7volatile\u5c4f\u853d\u6307\u4ee4\u91cd\u6392</p> <pre><code>public class Singleton {\n    private static volatile Singleton instance;\n\n    public static Singleton getSingleton() {\n        if (instance == null) { // Single Checked\n            synchronized (Singleton.class) {\n                if (instance == null) { // Double Checked\n                    instance = new Singleton();\n                }\n            }\n        }\n        return instance;\n    }\n}\n</code></pre> <p>\u300aThe Java Language Specification, Java SE 7 Edition\u300b\uff08\u540e\u6587\u7b80\u79f0\u4e3a java \u8bed\u8a00\u89c4\u8303\uff09</p> <ul> <li>\u6240\u6709\u7ebf\u7a0b\u5728\u6267\u884c java \u7a0b\u5e8f\u65f6\u5fc5\u987b\u8981\u9075\u5b88 intra-thread semantics\u3002intra-thread semantics \u4fdd\u8bc1\u91cd\u6392\u5e8f\u4e0d\u4f1a\u6539\u53d8\u5355\u7ebf\u7a0b\u5185\u7684\u7a0b\u5e8f\u6267\u884c\u7ed3\u679c</li> </ul> <p>\u5982\u679c instance \u4e0d\u7528 volatile \u4fee\u9970\uff0c\u5219\u53ef\u80fd\u4f1a\u51fa\u73b0\u95ee\u9898\uff1a</p> <p>\u6b63\u5e38\u7684new\u64cd\u4f5c\u5e94\u8be5\u662f\uff1a</p> <p>1\uff09\u5206\u914d\u4e00\u5757\u5185\u5b58\uff1b</p> <p>2\uff09\u5728\u5185\u5b58\u4e0a\u5b8c\u6210Singleton\u5bf9\u8c61\u7684\u521d\u59cb\u5316\uff1b</p> <p>3\uff09\u628a\u5185\u5b58\u5730\u5740\u7ed9instance\uff1b</p> <p>\u4f46\u5b9e\u9645\u4e0a\u88ab\u4f18\u5316\u540e\u53ef\u80fd\u662f\u8fd9\u6837\u7684\uff1a</p> <p>1\uff09\u5206\u914d\u4e00\u5757\u5185\u5b58\uff1b</p> <p>2\uff09\u5c06\u5185\u5b58\u5730\u5740\u7ed9instance\uff1b</p> <p>3\uff09\u5728\u5185\u5b58\u4e0a\u5b8c\u6210Singleton\u5bf9\u8c61\u7684\u521d\u59cb\u5316\uff1b</p> <p>\u6211\u4eec\u5047\u8bbe\u6709\u4e24\u4e2a\u7ebf\u7a0bA\u3001B\uff0cA\u6267\u884cgetIntance\u5230\u6307\u4ee42\u65f6\uff0c\u7ebf\u7a0b\u5207\u6362\u5230\u7ebf\u7a0bB\uff0c\u7ebf\u7a0bB\u770b\u5230instance\u5df2\u7ecf\u4e0d\u4e3a\u7a7a\uff0c\u8ba4\u4e3a\u53ef\u7528\u4e86\u3002</p> <p>\u4f46\u8fd9\u65f6\u8fd8\u6ca1\u6709\u8fdb\u884c\u5bf9\u8c61\u7684\u521d\u59cb\u5316\uff0c\u8fd9\u65f6\u4f7f\u7528instance\uff0c\u5c31\u53ef\u80fd\u51fa\u73b0\u95ee\u9898\u3002</p> <p></p>"},{"location":"languages/java/native/index.html","title":"Java Native","text":"<p>JNI, JNA, JNR, Panama\uff1a</p> <ul> <li> <p>\u6bd4\u8f83\uff1ahttps://github.com/jnr/jnr-ffi/blob/master/docs/ComparisonToSimilarProjects.md</p> </li> <li> <p>\u6027\u80fd\u6d4b\u8bd5\uff1aJava 21 FFI \u6027\u80fd\u6d4b\u8bd5 \u2014\u2014 Panama vs JNI/JNA/JNR </p> </li> </ul> <p>Native Call Java\uff1a\u5e95\u5c42\u90fd\u662f\u57fa\u4e8e JNI.</p> <ul> <li>JNI, JavaCPP.</li> </ul>"},{"location":"languages/java/native/index.html#jnic","title":"JNI(C)","text":"<p>\u6807\u51c6\u7684 Java native\u901a\u4fe1\u5de5\u5177\uff0c\u4f46\u590d\u6742\u5ea6\u9ad8\uff0c\u9700\u8981\u5f88\u591anative code\u5230java\u7684\u56de\u8c03\u3002</p> <p>\u8be6\u89c1 JNI \u4f7f\u7528\u6587\u6863</p> <ul> <li>\u6027\u80fd\u6700\u597d\uff0c\u4f46\u662f\u4f7f\u7528\u6bd4\u8f83\u590d\u6742\uff1b</li> </ul>"},{"location":"languages/java/native/index.html#jnac","title":"JNA(C)","text":"<p>https://github.com/java-native-access/jna</p> <ul> <li>\u4e0d\u9700\u8981 JNI \u4ee3\u7801 \uff0c\u53ea\u9700\u8981\u5b9a\u4e49\u63a5\u53e3\u548c\u51fd\u6570\uff08\u5339\u914d\uff09\uff1b</li> <li>\u76f8\u8f83\u4e8eJNR\uff0c\u66f4\u4e3a\u6210\u719f\uff1b</li> </ul>"},{"location":"languages/java/native/index.html#_1","title":"\u539f\u7406","text":"<ul> <li>\u57fa\u4e8e\u53cd\u5c04\uff0c\u6570\u636e\u8f6c\u6362\u4ece\u672c\u5730\u4ee3\u7801\u8df3\u5230 Java \u4ee3\u7801\u975e\u5e38\u6602\u8d35\uff1b</li> <li>\u57fa\u4e8elibffi \u8fdb\u884c\u51fd\u6570\u8c03\u7528\u7ea6\u5b9a\uff1b</li> </ul> <p><code>Native.loadLibrary(\"c\", LibC.class)</code> \u83b7\u53d6\u4e86\u63a5\u53e3\u5b9e\u73b0</p> <ul> <li>\u901a\u8fc7\u52a8\u6001\u4ee3\u7406\uff08dynamic proxy\uff09\u5b9e\u73b0\uff0c\u6839\u636e\u8fd4\u56de\u53c2\u6570\u7684\u4e0d\u540c\uff0c\u5206\u6d3e\u5230 Native \u7c7b\u7684\uff0cinvokeXxx \u672c\u5730\u65b9\u6cd5\uff1a</li> </ul> <pre><code>/**\n * Call the native function.\n *\n * @param function  Present to prevent the GC to collect the Function object\n *                  prematurely\n * @param fp        function pointer\n * @param callFlags calling convention to be used\n * @param args      Arguments to pass to the native function\n *\n * @return The value returned by the target native function\n */\nstatic native int invokeInt(Function function, long fp, int callFlags, Object[] args);\n\nstatic native long invokeLong(Function function, long fp, int callFlags, Object[] args);\n\nstatic native Object invokeObject(Function function, long fp, int callFlags, Object[] args);\n...\n</code></pre> <p><code>invokeXxx</code> \u672c\u5730\u65b9\u6cd5\u7684\u5b9e\u73b0 dispatch.c#L2122\uff08<code>invokeInt</code> \u6216 <code>invokeLong</code> \u5b9e\u73b0\u6e90\u7801\u7c7b\u4f3c\uff09\uff1a</p> <pre><code>/*\n * Class:     com_sun_jna_Native\n * Method:    invokeInt\n * Signature: (Lcom/sun/jna/Function;JI[Ljava/lang/Object;)I\n */\nJNIEXPORT jint JNICALL\nJava_com_sun_jna_Native_invokeInt(JNIEnv *env, jclass UNUSED(cls), \n                                  jobject UNUSED(function), jlong fp, jint callconv,\n                                  jobjectArray arr)\n{\n    ffi_arg result;\n    dispatch(env, L2A(fp), callconv, arr, &amp;ffi_type_sint32, &amp;result);\n    return (jint)result;\n}\n</code></pre> <p>\u5373\uff0c\u5168\u90e8 <code>invokeXxx</code> \u672c\u5730\u65b9\u6cd5\u7edf\u4e00\u88ab\u5206\u6d3e\u5230 <code>dispatch</code> \u51fd\u6570 dispatch.c#L439\uff1a</p> <pre><code>static void\ndispatch(JNIEnv *env, void* func, jint flags, jobjectArray args,\nffi_type *return_type, void *presult)\n</code></pre> <p><code>dispatch</code> \u51fd\u6570\u662f\uff0c\u9700\u8981\u8c03\u7528\u7684\u51fd\u6570\u6307\u9488\u5730\u5740\u3001\u8f93\u5165\u53c2\u6570\u548c\u8fd4\u56de\u53c2\u6570\uff0c\u5168\u90e8\u662f\u8fd0\u884c\u65f6\u786e\u5b9a\u3002\u8981\u60f3\u5b8c\u6210\u8fd9\u4e2a\u51fd\u6570\u8c03\u7528\u903b\u8f91\uff0c\u5c31\u8981\u8fd0\u884c\u65f6\u6784\u9020\u6808\u5e27\uff0c\u751f\u6210\u53c2\u6570\u538b\u6808\u548c\u6e05\u7406\u5806\u6808\u7684\u5de5\u4f5c\u3002</p> <ul> <li> <p>JNA 3.0 \u4e4b\u524d\uff0c\u5b9e\u73b0\u8fd0\u884c\u65f6\u6784\u9020\u6808\u5e27\u7684\u903b\u8f91\u7684\u5bf9\u5e94\u4ee3\u7801 dispatch_i386.c\u3001dispatch_ppc.c \u548c dispatch_sparc.s\uff0c\u5206\u522b\u5b9e\u73b0 Intel x86\u3001PowerPC \u548c Sparc \u4e09\u79cd CPU \u67b6\u6784\u3002</p> </li> <li> <p>\u4ece JNA 3.0 \u5f00\u59cb\uff0c\u6452\u5f03\u4e86\u539f\u5148\u624b\u52a8\u6784\u9020\u6808\u5e27\u7684\u505a\u6cd5\uff0c\u628a libffi \u96c6\u6210\u8fdb\u4e86 JNA\u3002</p> </li> </ul>"},{"location":"languages/java/native/index.html#jnrc","title":"JNR(C)","text":"<p>https://github.com/jnr/jnr-ffi</p> <ul> <li>\u57fa\u4e8elibffi\uff0c\u4f46\u4f7f\u7528\u5b57\u8282\u7801\u751f\u6210\u6280\u672f\u800c\u4e0d\u662f\u53cd\u5c04\uff1b</li> <li>\u4e0d\u9700\u8981JNI\u4ee3\u7801 \uff0c\u53ea\u9700\u8981\u5b9a\u4e49\u63a5\u53e3\u548c\u51fd\u6570\uff08\u5339\u914d\uff09\uff1b</li> </ul> <p></p>"},{"location":"languages/java/native/index.html#_2","title":"\u539f\u7406","text":"<p>JNA \u4f7f\u7528\u52a8\u6001\u4ee3\u7406\u751f\u6210\u5b9e\u73b0\u7c7b\uff0c\u800c JNR \u4f7f\u7528 ASM \u5b57\u8282\u7801\u64cd\u4f5c\u5e93\u751f\u6210\u76f4\u63a5\u5b9e\u73b0\u7c7b\uff0c\u53bb\u9664\u4e86\u6bcf\u6b21\u8c03\u7528\u672c\u5730\u65b9\u6cd5\u65f6\u989d\u5916\u7684\u52a8\u6001\u4ee3\u7406\u7684\u903b\u8f91\u3002</p> <ul> <li>\u4f7f\u7528 ASM \u751f\u6210\u5b9e\u73b0\u7c7b\uff0c\u5bf9\u5e94\u7684\u4ee3\u7801\u4e3a AsmLibraryLoader.java\u3002</li> </ul> <p>\u4f46\u5176\u8c03\u7528\u6808\uff0c\u76f8\u5bf9\u4e8e\u76f4\u63a5\u4f7f\u7528 JNI\uff0c\u8fd8\u662f\u6bd4\u8f83\u7e41\u7410\u3002</p>"},{"location":"languages/java/native/index.html#project-panamac","title":"Project Panama(C)","text":"<p>JDK 19 \uff1aJEP 424: Foreign Function &amp; Memory API (Preview) (openjdk.org)</p> <p>JDK 20 \uff1aJEP 434: Foreign Function &amp; Memory API (Second Preview) (openjdk.org)</p>"},{"location":"languages/java/native/index.html#javacppc","title":"JavaCPP(C++)","text":"<p>JavaCPP provides efficient access to native C++ inside Java\uff0c also access Java from C++.</p> <p>\u5bf9\u5f88\u591aC/C++\u5e93\uff0c\u63d0\u4f9b\u76f8\u5e94\u7684\u5c01\u88c5\uff08bytedeco/javacpp-presets: The missing Java distribution of native C++ libraries\uff09\u3002</p>"},{"location":"languages/java/native/index.html#_3","title":"\u539f\u7406","text":"<p>\u6839\u636e C++ \u7684\u5934\u6587\u4ef6\uff0c\u8fdb\u884c\u89e3\u6790\uff0c\u81ea\u52a8\u751f\u6210 JNI \u7684 SO \u7684\u5c01\u88c5\u51fd\u6570\u3002</p> <p></p>"},{"location":"languages/java/native/jni.html","title":"JNI(Java Native Interface)","text":"<p>\u57fa\u4e8eJDK21\uff0c\u793a\u4f8b\u89c1 Demo\u3002</p> <p>\u4f55\u65f6\u9700\u8981\u4f7f\u7528Java\u672c\u5730\u65b9\u6cd5\uff1a</p> <ul> <li>\u6807\u51c6Java\u7c7b\u5e93\u4e0d\u652f\u6301\u5e94\u7528\u7a0b\u5e8f\u6240\u9700\u7684\u5e73\u53f0\u76f8\u5173\u529f\u80fd\u3002</li> <li>\u60a8\u5df2\u7ecf\u6709\u4e00\u4e2a\u7528\u53e6\u4e00\u79cd\u8bed\u8a00\u7f16\u5199\u7684\u5e93\uff0c\u5e76\u5e0c\u671b\u901a\u8fc7JNI\u4f7f\u5176\u53ef\u4f9bJava\u4ee3\u7801\u8bbf\u95ee\u3002</li> <li>\u60a8\u60f3\u8981\u5728\u8f83\u4f4e\u7ea7\u522b\u8bed\u8a00\uff08\u5982\u6c47\u7f16\uff09\u4e2d\u5b9e\u73b0\u4e00\u5c0f\u90e8\u5206\u65f6\u95f4\u5173\u952e\u4ee3\u7801\u3002</li> </ul> <p>JNI_OnLoad\u53ef\u4ee5\u548cJNIEnv\u7684registerNatives\u51fd\u6570\u7ed3\u5408\u8d77\u6765\uff0c\u5b9e\u73b0\u52a8\u6001\u7684\u51fd\u6570\u66ff\u6362\u3002</p>"},{"location":"languages/java/native/jni.html#_1","title":"\u8bbe\u8ba1\u6982\u8ff0","text":""},{"location":"languages/java/native/jni.html#jnijnienv","title":"JNI\u63a5\u53e3\u51fd\u6570\u548c\u6307\u9488(JNIEnv*)","text":"<p>\u672c\u5730\u4ee3\u7801\u901a\u8fc7\u8c03\u7528JNI\u51fd\u6570\u8bbf\u95eeJava\u865a\u62df\u673a\u529f\u80fd\u3002JNI\u51fd\u6570\u901a\u8fc7\u4e00\u4e2a\u63a5\u53e3\u6307\u9488\u63d0\u4f9b\u3002</p> <ul> <li>\u63a5\u53e3\u6307\u9488\u662f\u4e00\u4e2a\u6307\u5411\u6307\u9488\u7684\u6307\u9488\u3002\u8be5\u6307\u9488\u6307\u5411\u4e00\u4e2a\u6307\u9488\u6570\u7ec4\uff0c\u6bcf\u4e2a\u6307\u9488\u6307\u5411\u4e00\u4e2a\u63a5\u53e3\u51fd\u6570\u3002\u6bcf\u4e2a\u63a5\u53e3\u51fd\u6570\u90fd\u4f4d\u4e8e\u6570\u7ec4\u5185\u7684\u9884\u5b9a\u4e49\u504f\u79fb\u91cf\u5904\u3002</li> </ul> <p></p> <p>JNI\u63a5\u53e3\u6307\u9488\u4ec5\u5728\u5f53\u524d\u7ebf\u7a0b\u4e2d\u6709\u6548\u3002\u56e0\u6b64\uff0c\u672c\u5730\u65b9\u6cd5\u4e0d\u5f97\u5c06\u63a5\u53e3\u6307\u9488\u4ece\u4e00\u4e2a\u7ebf\u7a0b\u4f20\u9012\u5230\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u3002</p> <pre><code>/* \u83b7\u53d6Java\u5b57\u7b26\u4e32\u7684C\u526f\u672c */\nconst char *str = (*env)-&gt;GetStringUTFChars(env, s, 0);\n\n/** C++ \u6e90\u4ee3\u7801\u4e2d\u6d88\u5931\u4e86\u989d\u5916\u7684\u95f4\u63a5\u7ea7\u522b\u548c\u63a5\u53e3\u6307\u9488\u53c2\u6570 */\nconst char *str = env-&gt;GetStringUTFChars(s, 0);\n</code></pre>"},{"location":"languages/java/native/jni.html#_2","title":"\u7f16\u8bd1\u3001\u52a0\u8f7d\u548c\u94fe\u63a5\u672c\u5730\u65b9\u6cd5","text":"<p>\u7531\u4e8eJava\u865a\u62df\u673a\u662f\u591a\u7ebf\u7a0b\u7684\uff0c\u672c\u5730\u5e93\u4e5f\u5e94\u4f7f\u7528\u652f\u6301\u591a\u7ebf\u7a0b\u7684\u672c\u5730\u7f16\u8bd1\u5668\u8fdb\u884c\u7f16\u8bd1\u548c\u94fe\u63a5\u3002</p> <ul> <li>GCC \u7684 -D_REENTRANT</li> </ul> <p>\u672c\u5730\u65b9\u6cd5\u901a\u8fc7<code>System.loadLibrary</code>\u65b9\u6cd5\u52a0\u8f7d\u3002\u865a\u62df\u673a\u5728\u5185\u90e8\u4e3a\u6bcf\u4e2a\u7c7b\u52a0\u8f7d\u5668\u7ef4\u62a4\u4e00\u4e2a\u5df2\u52a0\u8f7d\u672c\u5730\u5e93\u7684\u5217\u8868\u3002</p> <ul> <li>Linux\u7cfb\u7edf\u5c06\u540d\u79f0<code>p_q_r_A</code>\u8f6c\u6362\u4e3a<code>libp_q_r_A.so</code>\uff0c\u800cWindows\u7cfb\u7edf\u5c06\u76f8\u540c\u7684<code>p_q_r_A</code>\u540d\u79f0\u8f6c\u6362\u4e3a<code>p_q_r_A.dll</code>\u3002</li> </ul> <pre><code>package p.q.r;\n\nclass A {\n    native double f(int i, String s);\n    static {\n        System.loadLibrary(\"p_q_r_A\");\n    }\n}\n</code></pre> <p>\u672c\u673a\u65b9\u6cd5\u548c\u63a5\u53e3API\u90fd\u9075\u5faa\u7ed9\u5b9a\u5e73\u53f0\u4e0a\u7684\u6807\u51c6\u5e93\u8c03\u7528\u7ea6\u5b9a\u3002\u4f8b\u5982\uff0cUNIX\u7cfb\u7edf\u4f7f\u7528C\u8c03\u7528\u7ea6\u5b9a\uff0c\u800cWin32\u7cfb\u7edf\u4f7f\u7528__stdcall\u3002</p>"},{"location":"languages/java/native/jni.html#_3","title":"\u672c\u673a\u65b9\u6cd5\u53c2\u6570","text":"<p>JNI\u63a5\u53e3\u6307\u9488\u662f\u672c\u673a\u65b9\u6cd5\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u3002JNI\u63a5\u53e3\u6307\u9488\u7684\u7c7b\u578b\u4e3aJNIEnv\u3002</p> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570\u53d6\u51b3\u4e8e\u672c\u673a\u65b9\u6cd5\u662f\u9759\u6001\u7684\u8fd8\u662f\u975e\u9759\u6001\u7684\u3002\u975e\u9759\u6001\u672c\u673a\u65b9\u6cd5\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u5bf9\u5bf9\u8c61\u7684\u5f15\u7528\u3002\u9759\u6001\u672c\u673a\u65b9\u6cd5\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u5bf9\u5176Java\u7c7b\u7684\u5f15\u7528\u3002</p> <p>\u5176\u4f59\u53c2\u6570\u5bf9\u5e94\u4e8e\u5e38\u89c4Java\u65b9\u6cd5\u53c2\u6570\u3002</p> <pre><code>jdouble Java_p_q_r_A_f__ILjava_lang_String_2 (\n     JNIEnv *env,        /* \u63a5\u53e3\u6307\u9488 */\n     jobject obj,        /* \"this\"\u6307\u9488 */\n     jint i,             /* \u53c2\u6570\uff031 */\n     jstring s)          /* \u53c2\u6570\uff032 */   \n</code></pre>"},{"location":"languages/java/native/jni.html#java","title":"\u5f15\u7528Java\u5bf9\u8c61","text":"<p>\u539f\u59cb\u7c7b\u578b\uff0c\u5982\u6574\u6570\u3001\u5b57\u7b26\u7b49\uff0c\u5728Java\u548c\u672c\u673a\u4ee3\u7801\u4e4b\u95f4\u8fdb\u884c\u590d\u5236\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u4efb\u610fJava\u5bf9\u8c61\u662f\u901a\u8fc7\u5f15\u7528\u4f20\u9012\u7684\u3002\u865a\u62df\u673a\u5fc5\u987b\u8ddf\u8e2a\u6240\u6709\u4f20\u9012\u7ed9\u672c\u673a\u4ee3\u7801\u7684\u5bf9\u8c61\uff0c\u4ee5\u4fbf\u8fd9\u4e9b\u5bf9\u8c61\u4e0d\u4f1a\u88ab\u5783\u573e\u56de\u6536\u5668\u91ca\u653e\u3002</p> <p>JNI \u652f\u63013\u4e2d\u4e0d\u900f\u660e\u7684\u5f15\u7528\uff1a\u5c40\u90e8(local)\u5f15\u7528\u3001\u5168\u5c40(global)\u5f15\u7528\u548c\u5f31\u5168\u5c40\u5f15\u7528\u3002</p> <ul> <li>\u5c40\u90e8\u5f15\u7528\u5728\u672c\u673a\u65b9\u6cd5\u8c03\u7528\u671f\u95f4\u6709\u6548\uff0c\u5e76\u5728\u672c\u673a\u65b9\u6cd5\u8fd4\u56de\u540e\u81ea\u52a8\u91ca\u653e\uff0c\u5c40\u90e8\u5f15\u7528\u4ec5\u5728\u521b\u5efa\u5b83\u4eec\u7684\u7ebf\u7a0b\u4e2d\u6709\u6548\u3002</li> <li>\u5168\u5c40\u5f15\u7528\u4fdd\u6301\u6709\u6548\uff0c\u76f4\u5230\u663e\u5f0f\u91ca\u653e\u4e3a\u6b62\u3002\u4ece\u5c40\u90e8\u5f15\u7528\u521b\u5efa\u5168\u5c40\u5f15\u7528\u3002</li> </ul> <p>\u5bf9\u8c61\u4f5c\u4e3a\u5c40\u90e8\u5f15\u7528\u4f20\u9012\u7ed9\u672c\u673a\u65b9\u6cd5\u3002\u6240\u6709\u7531 JNI \u51fd\u6570\u8fd4\u56de\u7684Java\u5bf9\u8c61\u90fd\u662f\u5c40\u90e8\u5f15\u7528\u3002</p> <ul> <li>\u672c\u673a\u65b9\u6cd5\u53ef\u4ee5\u5c06\u5c40\u90e8\u6216\u5168\u5c40\u5f15\u7528\u4f5c\u4e3a\u5176\u7ed3\u679c\u8fd4\u56de\u7ed9\u865a\u62df\u673a\u3002</li> </ul> <p>\u6709\u65f6\u7a0b\u5e8f\u5458\u5e94\u663e\u5f0f\u91ca\u653e\u5c40\u90e8\u5f15\u7528\uff1a</p> <ul> <li>\u5728\u5176\u4f59\u8ba1\u7b97\u4e2d\u4e0d\u518d\u4f7f\u7528\u8be5\u5bf9\u8c61\u65f6\uff0c\u5927\u7684Java\u5bf9\u8c61\u7684\u5c40\u90e8\u5f15\u7528\u5c06\u963b\u6b62\u5783\u573e\u56de\u6536\u5bf9\u8c61\uff1b</li> <li>\u672c\u673a\u65b9\u6cd5\u521b\u5efa\u5927\u91cf\u5c40\u90e8\u5f15\u7528\uff0c\u5c3d\u7ba1\u5e76\u975e\u6240\u6709\u5f15\u7528\u540c\u65f6\u4f7f\u7528\uff0c\u521b\u5efa\u592a\u591a\u5c40\u90e8\u5f15\u7528\u53ef\u80fd\u5bfc\u81f4\u7cfb\u7edf\u5185\u5b58\u4e0d\u8db3\u3002</li> </ul> <p>\u5f31\u5f15\u7528\u5bf9\u8c61</p> <ul> <li>\u4e00\u4e2a\u5c40\u90e8\u6216\u8005\u5168\u5c40\u5f15\u7528\uff0c\u4f7f\u6240\u63d0\u53ca\u7684\u5bf9\u8c61\u4e0d\u80fd\u88ab\u5783\u573e\u56de\u6536\u3002\u800c\u5f31\u5168\u5c40\u5f15\u7528\uff0c\u5219\u5141\u8bb8\u63d0\u53ca\u7684\u5bf9\u8c61\u8fdb\u884c\u5783\u573e\u56de\u6536\u3002</li> </ul> <p>\u91ca\u653e\u5f15\u7528\uff1a</p> <ul> <li>\u57fa\u672c\u6570\u636e\u7c7b\u578b\u662f\u4e0d\u9700\u8981\u91ca\u653e\uff0c\u5982 jint , jlong , jchar \u7b49\u7b49\u3002</li> <li>\u9700\u8981\u91ca\u653e\u7684\u662f\u5f15\u7528\u6570\u636e\u7c7b\u578b\uff0c\u5f53\u7136\u4e5f\u5305\u62ec\u6570\u7ec4\u3002\u5982\uff1ajstring, jobject, j***Array, jclass \u7b49\u3002</li> <li><code>jmethodID</code>\u548c<code>jfieldID</code>\u4e0d\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u4e0d\u9700\u8981\u88ab\u91ca\u653e\uff1b</li> </ul> <p>\u5c40\u90e8\u5f15\u7528\u9ed8\u8ba4\u53ea\u6709\u5f53\u672c\u5730\u51fd\u6570\u8fd4\u56deJava\uff08\u5f53Java\u8c03\u7528native\uff09\u6216\u8c03\u7528\u7ebf\u7a0bdetach JVM\uff08native\u8c03\u7528Java\uff09\u65f6\u624d\u4f1a\u88abGC\u3002</p> <p>\u5bf9\u4e8eC++ call Java\u65f6\u521b\u5efa\u7684 global reference\u548c local reference \u521b\u5efa\uff0c\u9700\u8981\u5b9a\u4e49\u5176\u91ca\u653e\u4e4b\u5904\uff1b</p> <p>\u6ce8\uff1aHotSpotVM\uff1a-XX:MaxJNILocalCapacity flag (default: 65536)\u3002\u5f53\u524d\u6ca1\u6709\u6d4b\u8bd5\u51fa\u6765\uff0cLocal references \u6ea2\u51fa\u7684\u60c5\u51b5\uff1b(JDK 8)</p>"},{"location":"languages/java/native/jni.html#java_1","title":"Java\u5f02\u5e38","text":"<p>JNI\u5141\u8bb8\u672c\u5730\u65b9\u6cd5\u5f15\u53d1\u4efb\u610fJava\u5f02\u5e38\u3002\u672c\u5730\u4ee3\u7801\u4e5f\u53ef\u4ee5\u5904\u7406\u672a\u5904\u7406\u7684Java\u5f02\u5e38\u3002\u672a\u5904\u7406\u7684Java\u5f02\u5e38\u5c06\u4f20\u64ad\u56deVM\u3002</p> <p>\u672c\u5730\u4ee3\u7801\u4e2d\u8c03\u7528\u67d0\u4e2aJNI\u63a5\u53e3\u65f6\u5982\u679c\u53d1\u751f\u4e86\u5f02\u5e38\uff0c\u540e\u7eed\u7684\u672c\u5730\u4ee3\u7801\u4e0d\u4f1a\u7acb\u5373\u505c\u6b62\u6267\u884c\uff0c\u800c\u4f1a\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\u540e\u9762\u7684\u4ee3\u7801\u3002</p> <pre><code>// \u5982\u679c\u8fd9\u91cc\u51fa\u73b0\u95ee\u9898\uff0c\u5219\u4f1a\u51fa\u73b0\u95ee\u9898\uff0c\u540e\u7eed\u6267\u884c\u5f02\u5e38\njauthority = env.newStringUTF(authority, \"authority\"); \nenv-&gt;DeleteLocalRef(jauthority);\n</code></pre>"},{"location":"languages/java/native/jni.html#_4","title":"\u5f02\u5e38\u548c\u9519\u8bef\u4ee3\u7801","text":"<p>\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0cJNI\u51fd\u6570\u901a\u8fc7\u8fd4\u56de\u9519\u8bef\u4ee3\u7801\uff08\u7279\u6b8a\u7684\u8fd4\u56de\u503c\uff0c\u5982NULL\uff09\u5e76\u629b\u51faJava\u5f02\u5e38\u6765\u62a5\u544a\u9519\u8bef\u6761\u4ef6\u3002\u56e0\u6b64\uff0c\u7a0b\u5e8f\u5458\u53ef\u4ee5\uff1a</p> <ul> <li>\u5feb\u901f\u68c0\u67e5\u6700\u540e\u4e00\u4e2aJNI\u8c03\u7528\u7684\u8fd4\u56de\u503c\uff0c\u4ee5\u786e\u5b9a\u662f\u5426\u53d1\u751f\u9519\u8bef\uff08\u4e3aNULL\uff09\uff0c\u5e76</li> <li>\u8c03\u7528\u4e00\u4e2a\u51fd\u6570<code>ExceptionOccurred()</code>\uff0c\u4ee5\u83b7\u53d6\u5305\u542b\u9519\u8bef\u6761\u4ef6\u66f4\u8be6\u7ec6\u63cf\u8ff0\u7684\u5f02\u5e38\u5bf9\u8c61\u3002</li> </ul> <p>\u6709\u4e24\u79cd\u60c5\u51b5\u9700\u8981\u7a0b\u5e8f\u5458\u5148\u68c0\u67e5\u5f02\u5e38\u800c\u4e0d\u662f\u5148\u68c0\u67e5\u8fd4\u56de\u503c\uff1a</p> <ul> <li>\u901a\u8fc7 JNI \u8c03\u7528 Java \u65b9\u6cd5\u65f6\uff08call jmethod, \u53ef\u80fd\u8fd4\u56de\u7ed3\u679c\u5c31\u662fNULL\uff09\uff1b</li> <li>JNI\u6570\u7ec4\u8bbf\u95ee\u51fd\u6570\u4e0d\u53cd\u6094\u9519\u8bef\u4ee3\u7801\uff0c\u4f46\u53ef\u80fd\u629b\u51fa<code>ArrayIndexOutOfBoundsException</code>\u6216<code>ArrayStoreException</code>\u3002</li> </ul> <p>\u5728\u6240\u6709\u5176\u4ed6\u60c5\u51b5\u4e0b\uff0c\u975e\u9519\u8bef\u8fd4\u56de\u503c\u4fdd\u8bc1\u672a\u5f15\u53d1\u5f02\u5e38\u3002</p>"},{"location":"languages/java/native/jni.html#_5","title":"\u5f02\u6b65\u5f02\u5e38","text":"<p>\u5728\u591a\u4e2a\u7ebf\u7a0b\u7684\u60c5\u51b5\u4e0b\uff0c\u5f53\u524d\u7ebf\u7a0b\u4ee5\u5916\u7684\u7ebf\u7a0b\u53ef\u80fd\u4f1a\u53d1\u5e03\u5f02\u6b65\u5f02\u5e38\u3002\u5f02\u6b65\u5f02\u5e38\u4e0d\u4f1a\u7acb\u5373\u5f71\u54cd\u5f53\u524d\u7ebf\u7a0b\u4e2d\u672c\u673a\u4ee3\u7801\u7684\u6267\u884c\uff0c\u76f4\u5230\uff1a</p> <ul> <li>\u672c\u673a\u4ee3\u7801\u8c03\u7528\u53ef\u80fd\u5f15\u53d1\u540c\u6b65\u5f02\u5e38\u7684 JNI \u51fd\u6570\uff0c\u6216\u8005</li> <li>\u673a\u4ee3\u7801\u4f7f\u7528 <code>ExceptionOccurred\uff08\uff09</code> \u663e\u5f0f\u68c0\u67e5\u540c\u6b65\u548c\u5f02\u6b65\u5f02\u5e38</li> </ul> <p>\u8bf7\u6ce8\u610f\uff0c\u53ea\u6709\u90a3\u4e9b\u53ef\u80fd\u5f15\u53d1\u540c\u6b65\u5f02\u5e38\u7684 JNI \u51fd\u6570\u624d\u4f1a\u68c0\u67e5\u5f02\u6b65\u5f02\u5e38\u3002</p>"},{"location":"languages/java/native/jni.html#_6","title":"\u5f02\u5e38\u5904\u7406","text":"<p>\u5728\u672c\u5730\u4ee3\u7801\u4e2d\u5904\u7406\u5f02\u5e38\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li>\u672c\u5730\u65b9\u6cd5\u53ef\u4ee5\u9009\u62e9\u7acb\u5373\u8fd4\u56de\uff0c\u5bfc\u81f4\u5f02\u5e38\u5728\u542f\u52a8\u672c\u5730\u65b9\u6cd5\u8c03\u7528\u7684Java\u4ee3\u7801\u4e2d\u629b\u51fa\u3002</li> <li>\u672c\u5730\u4ee3\u7801\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528<code>ExceptionClear()</code>\u6e05\u9664\u5f02\u5e38\uff0c\u7136\u540e\u6267\u884c\u81ea\u5df1\u7684\u5f02\u5e38\u5904\u7406\u4ee3\u7801\u3002</li> </ul> <p>libhdfs \u4e2d\u7684\u6807\u51c6\u7528\u6cd5 <pre><code>// \u5c01\u88c5\u4e86JNI \u51fd\u6570\uff0c\u5728\u8c03\u7528 JNI \u51fd\u6570\u540e\uff0c\u901a\u8fc7 getPendingExceptionAndClear \u8fd4\u56de\u5f02\u5e38\u3002\njthr = invokeMethod(env, &amp;jVal, STATIC, NULL,\n        JC_URI, \"create\",\n        \"(Ljava/lang/String;)Ljava/net/URI;\", jURIString);\n// \u6709\u5f02\u5e38\uff0c\u5219\u8fdb\u884c\u6253\u5370\nif (jthr) {\n    ret = printExceptionAndFree(env, jthr, PRINT_EXC_ALL,\n        \"hdfsBuilderConnect(%s)\",\n        hdfsBuilderToStr(bld, buf, sizeof(buf)));\n    goto done;\n}\n... \ndone:\n    // Release unnecessary local references\n    destroyLocalReference(env, jURI);\n    free(cURI);\n\njthrowable getPendingExceptionAndClear(JNIEnv *env) {\n    jthrowable jthr = (*env)-&gt;ExceptionOccurred(env);\n    if (!jthr)\n        return NULL;\n    (*env)-&gt;ExceptionClear(env);\n    return jthr;\n}\n</code></pre></p> <p>\u5728\u5f15\u53d1\u5f02\u5e38\u540e\uff0c\u672c\u5730\u4ee3\u7801\u5fc5\u987b\u9996\u5148\u6e05\u9664\u5f02\u5e38\uff0c\u7136\u540e\u518d\u8fdb\u884c\u5176\u4ed6JNI\u8c03\u7528\u3002\u5b58\u5728\u5f85\u5904\u7406\u5f02\u5e38\u65f6\uff0c\u53ef\u4ee5\u5b89\u5168\u8c03\u7528\u7684JNI\u51fd\u6570\u6709\uff1a</p> <pre><code>ExceptionOccurred()\nExceptionDescribe()\nExceptionClear()\nExceptionCheck()\nReleaseStringChars()\nReleaseStringUTFChars()\nReleaseStringCritical()\nRelease&lt;Type&gt;ArrayElements()\nReleasePrimitiveArrayCritical()\nDeleteLocalRef()\nDeleteGlobalRef()\nDeleteWeakGlobalRef()\nMonitorExit()\nPushLocalFrame()\nPopLocalFrame()\nDetachCurrentThread()\n</code></pre>"},{"location":"languages/java/native/jni.html#jni","title":"JNI \u7c7b\u578b\u548c\u6570\u636e\u7ed3\u6784","text":""},{"location":"languages/java/native/jni.html#_7","title":"\u57fa\u672c\u7c7b\u578b","text":"Java\u7c7b\u578b \u672c\u673a\u7c7b\u578b \u63cf\u8ff0 boolean jboolean \u65e0\u7b26\u53f78\u4f4d byte jbyte \u6709\u7b26\u53f78\u4f4d char jchar \u65e0\u7b26\u53f716\u4f4d short jshort \u6709\u7b26\u53f716\u4f4d int jint \u6709\u7b26\u53f732\u4f4d long jlong \u6709\u7b26\u53f764\u4f4d float jfloat 32\u4f4d double jdouble 64\u4f4d void void \u4e0d\u9002\u7528"},{"location":"languages/java/native/jni.html#_8","title":"\u5f15\u7528\u7c7b\u578b","text":"<p>JNI\u5305\u62ec\u4e00\u4e9b\u5f15\u7528\u7c7b\u578b\uff0c\u5bf9\u5e94\u4e0d\u540c\u7c7b\u578b\u7684Java\u5bf9\u8c61\u3002JNI\u5f15\u7528\u7c7b\u578b\u7ec4\u7ec7\u5982\u4e0b\u5c42\u6b21\u7ed3\u6784\uff1a</p> <ul> <li> <p><code>jobject</code></p> </li> <li> <p><code>jclass</code>\uff08<code>java.lang.Class</code>\u5bf9\u8c61\uff09</p> </li> <li><code>jstring</code>\uff08<code>java.lang.String</code>\u5bf9\u8c61\uff09</li> <li><code>jarray\uff08\u6570\u7ec4\uff09</code><ul> <li><code>jobjectArray</code>\uff08\u5bf9\u8c61\u6570\u7ec4\uff09</li> <li><code>jbooleanArray</code>\uff08<code>boolean</code>\u6570\u7ec4\uff09</li> <li><code>jbyteArray</code>\uff08<code>byte</code>\u6570\u7ec4\uff09</li> <li><code>jcharArray</code>\uff08<code>char</code>\u6570\u7ec4\uff09</li> <li><code>jshortArray</code>\uff08<code>short</code>\u6570\u7ec4\uff09</li> <li><code>jintArray</code>\uff08<code>int</code>\u6570\u7ec4\uff09</li> <li><code>jlongArray</code>\uff08<code>long</code>\u6570\u7ec4\uff09</li> <li><code>jfloatArray</code>\uff08<code>float</code>\u6570\u7ec4\uff09</li> <li><code>jdoubleArray</code>\uff08<code>double</code>\u6570\u7ec4\uff09</li> </ul> </li> <li><code>jthrowable</code>\uff08<code>java.lang.Throwable</code>\u5bf9\u8c61\uff09</li> </ul> <p>\u5728C\u4e2d\uff0c\u6240\u6709\u5176\u4ed6JNI\u5f15\u7528\u7c7b\u578b\u88ab\u5b9a\u4e49\u4e3a\u4e0ejobject\u76f8\u540c\u3002\u4f8b\u5982\uff1a</p> <pre><code>typedef jobject jclass;\n</code></pre> <p>\u5728C++\u4e2d\uff0cJNI\u5f15\u5165\u4e86\u4e00\u7ec4\u865a\u62df\u7c7b\u6765\u5f3a\u5236\u5b50\u7c7b\u578b\u5173\u7cfb\u3002\u4f8b\u5982\uff1a</p> <pre><code>class _jobject {};\nclass _jclass : public _jobject {};\n// ...\ntypedef _jobject *jobject;\ntypedef _jclass *jclass;\n</code></pre>"},{"location":"languages/java/native/jni.html#id","title":"\u5b57\u6bb5\u548c\u65b9\u6cd5ID","text":"<p>\u65b9\u6cd5\u548c\u5b57\u6bb5ID\u662f\u5e38\u89c4\u7684C\u6307\u9488\u7c7b\u578b\uff1a</p> <pre><code>struct _jfieldID;              /* \u4e0d\u900f\u660e\u7ed3\u6784 */\ntypedef struct _jfieldID *jfieldID;   /* \u5b57\u6bb5ID */\n\nstruct _jmethodID;              /* \u4e0d\u900f\u660e\u7ed3\u6784 */\ntypedef struct _jmethodID *jmethodID; /* \u65b9\u6cd5ID */\n</code></pre>"},{"location":"languages/java/native/jni.html#_9","title":"\u503c\u7c7b\u578b","text":"<p><code>jvalue</code>\u8054\u5408\u7c7b\u578b\u7528\u4f5c\u53c2\u6570\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u7c7b\u578b\u3002\u5b83\u58f0\u660e\u5982\u4e0b\uff1a</p> <pre><code>typedef union jvalue {\n    jboolean z;\n    jbyte    b;\n    jchar    c;\n    jshort   s;\n    jint     i;\n    jlong    j;\n    jfloat   f;\n    jdouble  d;\n    jobject  l;\n} jvalue;\n</code></pre>"},{"location":"languages/java/native/jni.html#_10","title":"\u7c7b\u578b\u7b7e\u540d","text":"\u7c7b\u578b\u7b7e\u540d Java\u7c7b\u578b <code>Z</code> boolean <code>B</code> byte <code>C</code> char <code>S</code> short <code>I</code> int <code>J</code> long <code>F</code> float <code>D</code> double <code>L</code> \u5b8c\u5168\u9650\u5b9a\u7c7b <code>;</code> \u5b8c\u5168\u9650\u5b9a\u7c7b <code>[</code> \u7c7b\u578b \u7c7b\u578b[] <code>(</code> \u53c2\u6570\u7c7b\u578b <code>)</code> \u8fd4\u56de\u7c7b\u578b \u65b9\u6cd5\u7c7b\u578b <p>\u4f8b\u5982\uff0cJava\u65b9\u6cd5\uff1a</p> <pre><code>long f (int n, String s, int[] arr);\n</code></pre> <p>\u5177\u6709\u4ee5\u4e0b\u7c7b\u578b\u7b7e\u540d\uff1a<code>(ILjava/lang/String;[I)J</code></p>"},{"location":"languages/java/native/jni.html#utf-8","title":"\u4fee\u6539\u540e\u7684UTF-8\u5b57\u7b26\u4e32","text":"<p>JNI\u4f7f\u7528\u4fee\u6539\u540e\u7684UTF-8\u5b57\u7b26\u4e32\u6765\u8868\u793a\u5404\u79cd\u5b57\u7b26\u4e32\u7c7b\u578b\u3002\u4fee\u6539\u540e\u7684UTF-8\u5b57\u7b26\u4e32\u4e0eJava\u865a\u62df\u673a\u4f7f\u7528\u7684\u76f8\u540c\u3002</p> <ul> <li>\u591a\u5b57\u8282\u5b57\u7b26\u7684\u5b57\u8282\u4ee5\u5927\u7aef\uff08\u9ad8\u5b57\u8282\u5728\u524d\uff09\u987a\u5e8f\u5b58\u50a8\u5728<code>class</code>\u6587\u4ef6\u4e2d\u3002</li> </ul> <p>\u4e0e\u6807\u51c6UTF-8\u683c\u5f0f\u4e4b\u95f4\u5b58\u5728\u4e24\u4e2a\u5dee\u5f02:</p> <ul> <li>\u7a7a\u5b57\u7b26<code>(char)0</code>\u4f7f\u7528\u4e24\u5b57\u8282\u683c\u5f0f\uff080xC0 0x80\uff09\u800c\u4e0d\u662f\u4e00\u4e2a\u5b57\u8282\u683c\u5f0f\uff080x00\uff09\u8fdb\u884c\u7f16\u7801\uff0c\u786e\u4fdd\u4e86\u7f16\u7801\u540e\u7684\u5b57\u7b26\u4e32\u4e2d\u4e0d\u4f1a\u5d4c\u5165null\u5b57\u7b26\u3002</li> <li>\u4ec5\u4f7f\u7528\u6807\u51c6UTF-8\u7684\u4e00\u4e2a\u5b57\u8282\u3001\u4e24\u5b57\u8282\u548c\u4e09\u5b57\u8282\u683c\u5f0f</li> <li>\u6807\u51c6UTF-8\u7684\u56db\u5b57\u8282\u683c\u5f0f\u88ab\u4f7f\u7528\u81ea\u5df1\u7684\u4e24\u6b21\u4e09\u5b57\u8282\u683c\u5f0f\u4ee3\u66ff</li> </ul>"},{"location":"languages/java/native/jni.html#jni_1","title":"JNI \u51fd\u6570","text":""},{"location":"languages/java/native/jni.html#_11","title":"\u5e38\u91cf","text":"<pre><code>#define JNI_FALSE 0\n#define JNI_TRUE 1\n// \u7528\u4e8eJNI\u51fd\u6570\u7684\u4e00\u822c\u8fd4\u56de\u503c\u5e38\u91cf\u3002\n#define JNI_OK           0                 /* \u6210\u529f */\n#define JNI_ERR          (-1)              /* \u672a\u77e5\u9519\u8bef */\n#define JNI_EDETACHED    (-2)              /* \u7ebf\u7a0b\u4e0eVM\u5206\u79bb */\n#define JNI_EVERSION     (-3)              /* JNI\u7248\u672c\u9519\u8bef */\n#define JNI_ENOMEM       (-4)              /* \u5185\u5b58\u4e0d\u8db3 */\n#define JNI_EEXIST       (-5)              /* VM\u5df2\u521b\u5efa */\n#define JNI_EINVAL       (-6)              /* \u65e0\u6548\u53c2\u6570 */\n</code></pre>"},{"location":"languages/java/native/jni.html#_12","title":"\u7248\u672c\u4fe1\u606f","text":"<pre><code>// JNI_VERSION_1_8, JDK 17 \u5bf9\u5e94 JNI_VERSION_10\njint GetVersion(JNIEnv *env);\n</code></pre>"},{"location":"languages/java/native/jni.html#_13","title":"\u7c7b\u64cd\u4f5c","text":"<pre><code>// \u4ece\u539f\u59cb\u7c7b\u6570\u636e\u7f13\u51b2\u533a buf \u52a0\u8f7d\u7c7b\uff0c\u8fd4\u56de\u540e\uff0cbuf \u53ef\u4ee5\u88ab\u4e22\u5f03\u3002\n// name: \u8981\u5b9a\u4e49\u7684\u7c7b\u6216\u63a5\u53e3\u7684\u540d\u79f0\u3002\u5b57\u7b26\u4e32\u4ee5\u4fee\u6539\u540e\u7684UTF-8\u7f16\u7801\u3002\u6b64\u503c\u53ef\u4ee5\u4e3aNULL\u3002\n// loader: \u5206\u914d\u7ed9\u5b9a\u4e49\u7c7b\u7684\u7c7b\u52a0\u8f7d\u5668\u3002\u6b64\u503c\u53ef\u4ee5\u4e3aNULL\uff0c\u8868\u793a\u201c\u7a7a\u7c7b\u52a0\u8f7d\u5668\u201d\uff08\u6216\u201c\u5f15\u5bfc\u7c7b\u52a0\u8f7d\u5668\u201d\uff09\u3002\njclass DefineClass(JNIEnv *env, const char *name, jobject loader, const jbyte *buf, jsize bufLen);\n\n// name: \u5b8c\u5168\u9650\u5b9a\u7684\u7c7b\u540d\uff08\u5373\u5305\u540d\uff0c\u7531\u201c/\u201d\u5206\u9694\uff0c\u540e\u8ddf\u7c7b\u540d\uff09\u3002\u5982\u679c\u540d\u79f0\u4ee5\u201c[\u201d\uff08\u6570\u7ec4\u7b7e\u540d\u5b57\u7b26\uff09\u5f00\u5934\uff0c\u5219\u8fd4\u56de\u4e00\u4e2a\u6570\u7ec4\u7c7b\u3002\u5b57\u7b26\u4e32\u4ee5\u4fee\u6539\u540e\u7684UTF-8\u7f16\u7801\n// \u4e0d\u5b58\u5728\u5f53\u524d\u672c\u5730\u65b9\u6cd5\u6216\u5176\u5173\u8054\u7684\u7c7b\u52a0\u8f7d\u5668\u65f6\uff0c\u4f7f\u7528ClassLoader.getSystemClassLoader\uff0c\u8bfb\u53d6java.class.path\u4e2d\u7684\u7c7b\uff1b\n// \u901a\u8fc7\u672c\u5730\u65b9\u6cd5\u65f6\uff0cJNI_OnLoad\u548cJNI_OnLoad_L\uff0c\u4f7f\u7528\u52a0\u8f7d\u672c\u5730\u5e93\u7684\u7c7b\u7684\u7c7b\u52a0\u8f7d\u5668\uff1bJNI_OnUnload(_L)\u4f7f\u7528SystemClassLoader\uff08\u56e0\u4e3a\u52a0\u8f7d\u65f6\u4f7f\u7528\u7684\u7c7b\u52a0\u8f7d\u5668\u53ef\u80fd\u4e0d\u5b58\u5728\uff09\njclass FindClass(JNIEnv *env, const char *name);\n\n// \u5982\u679cclazz\u8868\u793a\u9664Object\u7c7b\u4e4b\u5916\u7684\u4efb\u4f55\u7c7b\uff0c\u5219\u6b64\u51fd\u6570\u8fd4\u56de\u8868\u793aclazz\u6307\u5b9a\u7684\u7c7b\u7684\u8d85\u7c7b\u7684\u5bf9\u8c61\u3002\n// \u5982\u679cclazz\u6307\u5b9aObject\u7c7b\uff0c\u6216\u8005clazz\u8868\u793a\u4e00\u4e2a\u63a5\u53e3\uff0c\u5219\u6b64\u51fd\u6570\u8fd4\u56deNULL\u3002\njclass GetSuperclass(JNIEnv *env, jclass clazz);\n\n// \u786e\u5b9aclazz1\u7684\u5bf9\u8c61\u662f\u5426\u53ef\u4ee5\u5b89\u5168\u5730\u8f6c\u6362\u4e3aclazz2\u3002\n// \u5982\u679c\u4ee5\u4e0b\u4efb\u4e00\u60c5\u51b5\u4e3a\u771f\uff0c\u5219\u8fd4\u56deJNI_TRUE\uff1a\n//    \u7b2c\u4e00\u4e2a\u548c\u7b2c\u4e8c\u4e2a\u7c7b\u53c2\u6570\u5f15\u7528\u76f8\u540c\u7684Java\u7c7b\u3002\n//    \u7b2c\u4e00\u4e2a\u7c7b\u662f\u7b2c\u4e8c\u4e2a\u7c7b\u7684\u5b50\u7c7b\u3002\n//    \u7b2c\u4e00\u4e2a\u7c7b\u5c06\u7b2c\u4e8c\u4e2a\u7c7b\u4f5c\u4e3a\u5176\u63a5\u53e3\u4e4b\u4e00\u3002\njboolean IsAssignableFrom(JNIEnv *env, jclass clazz1, jclass clazz2);\n</code></pre>"},{"location":"languages/java/native/jni.html#_14","title":"\u6a21\u5757\u64cd\u4f5c","text":"<pre><code>// \u8fd4\u56de\u7c7b\u6240\u5c5e\u6a21\u5757\u7684java.lang.Module\u5bf9\u8c61\u3002\u5982\u679c\u7c7b\u4e0d\u5728\u547d\u540d\u6a21\u5757\u4e2d\uff0c\u5219\u8fd4\u56de\u7c7b\u52a0\u8f7d\u5668\u7684\u672a\u547d\u540d\u6a21\u5757\u3002\n// \u5982\u679c\u7c7b\u8868\u793a\u6570\u7ec4\u7c7b\u578b\uff0c\u5219\u6b64\u51fd\u6570\u8fd4\u56de\u5143\u7d20\u7c7b\u578b\u7684Module\u5bf9\u8c61\u3002\u5982\u679c\u7c7b\u8868\u793a\u539f\u59cb\u7c7b\u578b\u6216void\uff0c\u5219\u8fd4\u56dejava.base\u6a21\u5757\u7684Module\u5bf9\u8c61\u3002\njobject GetModule(JNIEnv *env, jclass clazz);\n</code></pre>"},{"location":"languages/java/native/jni.html#_15","title":"\u7ebf\u7a0b\u64cd\u4f5c","text":"<pre><code>// \u6d4b\u8bd5\u5bf9\u8c61\u662f\u5426\u4e3a\u865a\u62df\u7ebf\u7a0b\u3002\njboolean IsVirtualThread(JNIEnv *env, jobject obj);\n</code></pre>"},{"location":"languages/java/native/jni.html#_16","title":"\u5f02\u5e38","text":"<pre><code>// \u5bfc\u81f4\u629b\u51fajava.lang.Throwable\u5bf9\u8c61\u3002\njint Throw(JNIEnv *env, jthrowable obj);\n\n// \u4f7f\u7528\u7531message\u6307\u5b9a\u7684\u6d88\u606f\u4ece\u6307\u5b9a\u7c7b\u6784\u9020\u5f02\u5e38\u5bf9\u8c61\uff0c\u5e76\u5bfc\u81f4\u629b\u51fa\u8be5\u5f02\u5e38\u3002\n// clazz: java.lang.Throwable\u7684\u5b50\u7c7b\uff0c\u4e0d\u5f97\u4e3aNULL\u3002\njint ThrowNew(JNIEnv *env, jclass clazz, const char *message);\n\n// \u786e\u5b9a\u662f\u5426\u6b63\u5728\u629b\u51fa\u5f02\u5e38\u3002\u5f02\u5e38\u4fdd\u6301\u88ab\u629b\u51fa\u72b6\u6001\uff0c\u76f4\u5230\u672c\u5730\u4ee3\u7801\u8c03\u7528ExceptionClear()\uff0c\u6216Java\u4ee3\u7801\u5904\u7406\u5f02\u5e38\u3002\n// \u8fd4\u56de\u5f53\u524d\u6b63\u5728\u88ab\u629b\u51fa\u7684\u5f02\u5e38\u5bf9\u8c61\uff0c\u5982\u679c\u5f53\u524d\u6ca1\u6709\u5f02\u5e38\u88ab\u629b\u51fa\uff0c\u5219\u8fd4\u56deNULL\u3002\njthrowable ExceptionOccurred(JNIEnv *env);\n\n// \u5c06\u5f02\u5e38\u548c\u5806\u6808\u7684\u56de\u6eaf\u6253\u5370\u5230\u7cfb\u7edf\u9519\u8bef\u62a5\u544a\u901a\u9053\uff0c\u5982stderr\u3002\u8c03\u7528\u6b64\u51fd\u6570\u7684\u526f\u4f5c\u7528\u662f\u6e05\u9664\u6302\u8d77\u7684\u5f02\u5e38\u3002\u8fd9\u662f\u4e3a\u8c03\u8bd5\u63d0\u4f9b\u7684\u4fbf\u5229\u7a0b\u5e8f\u3002\nvoid ExceptionDescribe(JNIEnv *env);\n\n// \u6e05\u9664\u5f53\u524d\u6b63\u5728\u88ab\u629b\u51fa\u7684\u4efb\u4f55\u5f02\u5e38\u3002\u5982\u679c\u5f53\u524d\u6ca1\u6709\u5f02\u5e38\u88ab\u629b\u51fa\uff0c\u5219\u6b64\u4f8b\u7a0b\u4e0d\u8d77\u4f5c\u7528\u3002\nvoid ExceptionClear(JNIEnv *env);\n\n// \u5f15\u53d1\u81f4\u547d\u9519\u8bef\uff0c\u5e76\u4e14\u4e0d\u5e0c\u671b\u865a\u62df\u673a\u6062\u590d\u3002\u6b64\u51fd\u6570\u4e0d\u8fd4\u56de\u3002\nvoid FatalError(JNIEnv *env, const char *msg);\n\n// \u7528\u4e8e\u68c0\u67e5\u662f\u5426\u5b58\u5728\u672a\u51b3\u5f02\u5e38\uff0c\u800c\u4e0d\u521b\u5efa\u5f02\u5e38\u5bf9\u8c61\u7684\u672c\u5730\u5f15\u7528\u3002\njboolean ExceptionCheck(JNIEnv *env);\n</code></pre>"},{"location":"languages/java/native/jni.html#_17","title":"\u5168\u5c40\u548c\u5c40\u90e8\u5f15\u7528","text":"<pre><code>// \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5168\u5c40\u5f15\u7528\uff0c\u6307\u5411obj\u53c2\u6570\u5f15\u7528\u7684\u5bf9\u8c61\u3002 obj\u53c2\u6570\u53ef\u4ee5\u662f\u5168\u5c40\u5f15\u7528\u6216\u5c40\u90e8\u5f15\u7528\u3002 \u5fc5\u987b\u901a\u8fc7\u8c03\u7528DeleteGlobalRef()\u663e\u5f0f\u5904\u7406\u5168\u5c40\u5f15\u7528\u3002\n// \u5982\u679c\u53ef\u80fd\u8fd4\u56deNULL\u7684\u60c5\u51b5\u5305\u62ec\uff1a\n//  obj\u5f15\u7528\u4e3anull\n//  \u7cfb\u7edf\u5185\u5b58\u4e0d\u8db3\n//  obj\u662f\u5f31\u5168\u5c40\u5f15\u7528\u5e76\u4e14\u5df2\u88ab\u5783\u573e\u56de\u6536\njobject NewGlobalRef(JNIEnv *env, jobject obj);\n\n// \u5220\u9664\u7531globalRef\u6307\u5411\u7684\u5168\u5c40\u5f15\u7528\u3002\nvoid DeleteGlobalRef(JNIEnv *env, jobject globalRef);\n\n// \u5220\u9664\u7531localRef\u6307\u5411\u7684\u5c40\u90e8\u5f15\u7528\u3002\nvoid DeleteLocalRef(JNIEnv *env, jobject localRef);\n\n// \u786e\u4fdd\u5f53\u524d\u7ebf\u7a0b\u4e2d\u81f3\u5c11\u53ef\u4ee5\u521b\u5efa\u7ed9\u5b9a\u6570\u91cf\u7684\u5c40\u90e8\u5f15\u7528\u3002 \u6210\u529f\u8fd4\u56de0\uff1b\u5426\u5219\u8fd4\u56de\u8d1f\u6570\u5e76\u629b\u51faOutOfMemoryError\u3002\njint EnsureLocalCapacity(JNIEnv *env, jint capacity);\n\n// \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5c40\u90e8\u5f15\u7528\u5e27\uff0c\u5728\u5176\u4e2d\u81f3\u5c11\u53ef\u4ee5\u521b\u5efa\u7ed9\u5b9a\u6570\u91cf\u7684\u5c40\u90e8\u5f15\u7528\u3002 \u6210\u529f\u8fd4\u56de0\uff0c\u5931\u8d25\u65f6\u8fd4\u56de\u8d1f\u6570\u5e76\u6302\u8d77OutOfMemoryError\u3002\njint PushLocalFrame(JNIEnv *env, jint capacity);\n\n// \u5f39\u51fa\u5f53\u524d\u5c40\u90e8\u5f15\u7528\u5e27\uff0c\u91ca\u653e\u6240\u6709\u5c40\u90e8\u5f15\u7528\uff0c\u5e76\u4e3a\u7ed9\u5b9a\u7684result\u5bf9\u8c61\u8fd4\u56de\u4e0a\u4e00\u4e2a\u5c40\u90e8\u5f15\u7528\u5e27\u4e2d\u7684\u5c40\u90e8\u5f15\u7528\u3002\n// \u5982\u679c\u4e0d\u9700\u8981\u8fd4\u56de\u5230\u5148\u524d\u5e27\u7684\u5f15\u7528\uff0c\u5219\u5c06result\u4f20\u9012\u4e3aNULL\u3002\njobject PopLocalFrame(JNIEnv *env, jobject result);\n</code></pre>"},{"location":"languages/java/native/jni.html#_18","title":"\u5f31\u5168\u5c40\u5f15\u7528","text":"<p>\u5f31\u5168\u5c40\u5f15\u7528\u5141\u8bb8\u5e95\u5c42Java\u5bf9\u8c61\u88ab\u5783\u573e\u56de\u6536\u3002 \u5f31\u5168\u5c40\u5f15\u7528\u53ef\u4ee5\u5728\u4efb\u4f55\u9700\u8981\u5168\u5c40\u6216\u5c40\u90e8\u5f15\u7528\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u3002</p> <p><code>IsSameObject</code>\u53ef\u7528\u4e8e\u6bd4\u8f83\u5f31\u5168\u5c40\u5f15\u7528\u4e0e\u975e<code>NULL</code>\u5c40\u90e8\u6216\u5168\u5c40\u5f15\u7528\u3002 \u5982\u679c\u5bf9\u8c61\u76f8\u540c\uff0c\u5219\u53ea\u8981\u53e6\u4e00\u4e2a\u5f15\u7528\u672a\u88ab\u5220\u9664\uff0c\u5f31\u5168\u5c40\u5f15\u7528\u5c31\u4e0d\u4f1a\u53d8\u5f97\u7b49\u6548\u4e8e<code>NULL</code>\u3002</p> <ul> <li>\u4e0d\u5e94\u4f9d\u8d56<code>IsSameObject(weakObj, NULL)</code>\u6765\u786e\u5b9a\u5c06\u6765\u7684JNI\u51fd\u6570\u8c03\u7528\u4e2d\u662f\u5426\u53ef\u4ee5\u4f7f\u7528\u5f31\u5168\u5c40\u5f15\u7528\uff08\u4f5c\u4e3a\u975e<code>NULL</code>\u5f15\u7528\uff09\uff0c\u56e0\u4e3a\u4ecb\u5165\u7684\u5783\u573e\u56de\u6536\u53ef\u80fd\u4f1a\u66f4\u6539\u5f31\u5168\u5c40\u5f15\u7528\u3002</li> <li>\u4f7f\u7528JNI\u51fd\u6570<code>NewLocalRef</code>\u6216<code>NewGlobalRef</code>\u83b7\u53d6\u5bf9\u5e95\u5c42\u5bf9\u8c61\u7684\uff08\u5f3a\uff09\u5c40\u90e8\u6216\u5168\u5c40\u5f15\u7528\u3002 \u5982\u679c\u5bf9\u8c61\u5df2\u88ab\u91ca\u653e\uff0c\u8fd9\u4e9b\u51fd\u6570\u5c06\u8fd4\u56de<code>NULL</code>\u3002 \u5426\u5219\uff0c\u65b0\u5f15\u7528\u5c06\u9632\u6b62\u5e95\u5c42\u5bf9\u8c61\u88ab\u91ca\u653e\u3002</li> </ul> <pre><code>// \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5f31\u5168\u5c40\u5f15\u7528\u3002  \u53ef\u4ee5\u4f7f\u7528IsSameObject\u6765\u6d4b\u8bd5\u5f15\u7528\u7684\u5bf9\u8c61\u662f\u5426\u5df2\u88ab\u91ca\u653e\u3002 \u5982\u679cobj\u5f15\u7528\u4e3anull\uff0c\u6216\u8005\u865a\u62df\u673a\u5185\u5b58\u4e0d\u8db3\uff0c\u5219\u8fd4\u56deNULL\u3002 \u5982\u679c\u865a\u62df\u673a\u5185\u5b58\u4e0d\u8db3\uff0c\u540c\u65f6\u5c06\u629b\u51faOutOfMemoryError\u3002\njweak NewWeakGlobalRef(JNIEnv *env, jobject obj);\n\n// \u5220\u9664\u7ed9\u5b9a\u5f31\u5168\u5c40\u5f15\u7528\u6240\u9700\u7684VM\u8d44\u6e90\u3002\nvoid DeleteWeakGlobalRef(JNIEnv *env, jweak obj);\n</code></pre>"},{"location":"languages/java/native/jni.html#_19","title":"\u5bf9\u8c61\u64cd\u4f5c","text":"<pre><code>// \u5206\u914d\u4e00\u4e2a\u65b0\u7684Java\u5bf9\u8c61\u800c\u4e0d\u8c03\u7528\u5bf9\u8c61\u7684\u4efb\u4f55\u6784\u9020\u51fd\u6570\u3002\u8fd4\u56de\u5bf9\u8c61\u7684\u5f15\u7528\u3002\n// clazz\u53c2\u6570\u4e0d\u5f97\u5f15\u7528\u6570\u7ec4\u7c7b\u3002\njobject AllocObject(JNIEnv *env, jclass clazz);\n\n// \u6784\u9020\u4e00\u4e2a\u65b0\u7684Java\u5bf9\u8c61\u3002\u65b9\u6cd5ID\u6307\u793a\u8981\u8c03\u7528\u7684\u6784\u9020\u65b9\u6cd5\u3002\u6b64ID\u5fc5\u987b\u901a\u8fc7\u4f7f\u7528GetMethodID()\u5e76\u5c06&lt;init&gt;\u4f5c\u4e3a\u65b9\u6cd5\u540d\u548cvoid (V)\u4f5c\u4e3a\u8fd4\u56de\u7c7b\u578b\u6765\u83b7\u53d6\u3002\njobject NewObject(JNIEnv *env, jclass clazz, jmethodID methodID, ...);\njobject NewObjectA(JNIEnv *env, jclass clazz, jmethodID methodID, const jvalue *args);\njobject NewObjectV(JNIEnv *env, jclass clazz, jmethodID methodID, va_list args);\n\n// \u8fd4\u56de\u5bf9\u8c61\u7684\u7c7b\u3002\njclass GetObjectClass(JNIEnv *env, jobject obj);\n\n// \u8fd4\u56de\u7531obj\u53c2\u6570\u5f15\u7528\u7684\u5bf9\u8c61\u7684\u7c7b\u578b\u3002\u53c2\u6570obj\u53ef\u4ee5\u662f\u672c\u5730\u3001\u5168\u5c40\u6216\u5f31\u5168\u5c40\u5f15\u7528\uff0c\u4e5f\u53ef\u4ee5\u662fNULL\u3002\n// JNIInvalidRefType    = 0\n// JNILocalRefType      = 1\n// JNIGlobalRefType     = 2\n// JNIWeakGlobalRefType = 3\njobjectRefType GetObjectRefType(JNIEnv* env, jobject obj);\n\n// \u6d4b\u8bd5\u5bf9\u8c61\u662f\u5426\u662f\u7c7b\u7684\u5b9e\u4f8b\u3002\njboolean IsInstanceOf(JNIEnv *env, jobject obj, jclass clazz);\n\n// \u6d4b\u8bd5\u4e24\u4e2a\u5f15\u7528\u662f\u5426\u6307\u5411\u76f8\u540c\u7684Java\u5bf9\u8c61\njboolean IsSameObject(JNIEnv *env, jobject ref1, jobject ref2);\n</code></pre>"},{"location":"languages/java/native/jni.html#_20","title":"\u8bbf\u95ee\u5bf9\u8c61\u7684\u5b57\u6bb5","text":"<pre><code>// \u8fd4\u56de\u7c7b\u7684\u5b9e\u4f8b\uff08\u975e\u9759\u6001\uff09\u5b57\u6bb5\u7684\u5b57\u6bb5ID\u3002\u5b57\u6bb5\u7531\u5176\u540d\u79f0\u548c\u7b7e\u540d\u6307\u5b9a\u3002 \u5bfc\u81f4\u4e00\u4e2a\u672a\u521d\u59cb\u5316\u7684\u7c7b\u88ab\u521d\u59cb\u5316\u3002\n// GetFieldID()\u4e0d\u80fd\u7528\u4e8e\u83b7\u53d6\u6570\u7ec4\u7684\u957f\u5ea6\u5b57\u6bb5\u3002\u8bf7\u6539\u7528GetArrayLength()\u3002\njfieldID GetFieldID(JNIEnv *env, jclass clazz, const char *name, const char *sig);\n\n// \u8fd4\u56de\u5bf9\u8c61\u7684\u5b9e\u4f8b\uff08\u975e\u9759\u6001\uff09\u5b57\u6bb5\u7684\u503c\n// \u5982 jint GetIntField()\n&lt;NativeType&gt; Get&lt;type&gt;Field(JNIEnv *env, jobject obj, jfieldID fieldID);\n\n// \u8bbe\u7f6e\u5bf9\u8c61\u7684\u5b9e\u4f8b\uff08\u975e\u9759\u6001\uff09\u5b57\u6bb5\u7684\u503c\n// \u5982 SetIntField(JNIEnv *env, jobject obj, jfieldID fieldID, jint value)\nvoid Set&lt;type&gt;Field(JNIEnv *env, jobject obj, jfieldID fieldID, &lt;NativeType&gt; value);\n</code></pre>"},{"location":"languages/java/native/jni.html#_21","title":"\u8c03\u7528\u5b9e\u4f8b\u65b9\u6cd5","text":"<pre><code>// \u8fd4\u56de\u7c7b\u6216\u63a5\u53e3\u7684\u5b9e\u4f8b\uff08\u975e\u9759\u6001\uff09\u65b9\u6cd5\u7684\u65b9\u6cd5ID\uff0c\u5305\u62ec\u7236\u7c7b/\u63a5\u53e3\u4e2d\u7684\u65b9\u6cd5\u3002\u5bfc\u81f4\u4e00\u4e2a\u672a\u521d\u59cb\u5316\u7684\u7c7b\u88ab\u521d\u59cb\u5316\u3002\n// \u8981\u83b7\u53d6\u6784\u9020\u51fd\u6570\u7684\u65b9\u6cd5ID\uff0c\u8bf7\u5c06&lt;init&gt;\u4f5c\u4e3a\u65b9\u6cd5\u540d\u79f0\u5e76\u5c06void\uff08V\uff09\u4f5c\u4e3a\u8fd4\u56de\u7c7b\u578b\u3002\njmethodID GetMethodID(JNIEnv *env, jclass clazz, const char *name, const char *sig);\n\n// \u8c03\u7528Java\u5b9e\u4f8b\u65b9\u6cd5\u3002\u5b83\u4eec\u5728\u5411\u8c03\u7528\u7684\u65b9\u6cd5\u4f20\u9012\u53c2\u6570\u7684\u673a\u5236\u4e0a\u6709\u6240\u4e0d\u540c\u3002\n&lt;NativeType&gt; Call&lt;type&gt;Method(JNIEnv *env, jobject obj, jmethodID methodID, ...);\n&lt;NativeType&gt; Call&lt;type&gt;MethodA(JNIEnv *env, jobject obj, jmethodID methodID, const jvalue *args);\n&lt;NativeType&gt; Call&lt;type&gt;MethodV(JNIEnv *env, jobject obj, jmethodID methodID, va_list args);\n\n// \u591a\u4e2a clazz \u53c2\u6570\uff0c\u8c03\u7528\u6307\u5b9a\u7c7b\uff08\u81ea\u8eab\u7c7b\u6216\u8005\u5176\u8d85\u7c7b\uff09\u7684\u65b9\u6cd5\uff0c\u7528\u4e8e\u8c03\u7528\u88ab\u5b50\u7c7b\u8986\u76d6\u7684\u7236\u7c7b\u7684\u65b9\u6cd5\u3002\n&lt;NativeType&gt; CallNonvirtual&lt;type&gt;Method(JNIEnv *env, jobject obj, jclass clazz, jmethodID methodID, ...);\n&lt;NativeType&gt; CallNonvirtual&lt;type&gt;MethodA(JNIEnv *env, jobject obj, jclass clazz, jmethodID methodID, const jvalue *args);\n&lt;NativeType&gt; CallNonvirtual&lt;type&gt;MethodV(JNIEnv *env, jobject obj, jclass clazz, jmethodID methodID, va_list args);\n</code></pre>"},{"location":"languages/java/native/jni.html#_22","title":"\u8bbf\u95ee\u9759\u6001\u5b57\u6bb5","text":"<pre><code>// \u8fd4\u56de\u7c7b\u7684\u9759\u6001\u5b57\u6bb5\u7684\u5b57\u6bb5ID\u3002\njfieldID GetStaticFieldID(JNIEnv *env, jclass clazz, const char *name, const char *sig);\n\n// \u8fd4\u56de\u5bf9\u8c61\u7684\u9759\u6001\u5b57\u6bb5\u7684\u503c\n&lt;NativeType&gt; GetStatic&lt;type&gt;Field(JNIEnv *env, jclass clazz, jfieldID fieldID);\n\n// \u8bbe\u7f6e\u5bf9\u8c61\u7684\u9759\u6001\u5b57\u6bb5\u7684\u503c\nvoid SetStatic&lt;type&gt;Field(JNIEnv *env, jclass clazz, jfieldID fieldID, &lt;NativeType&gt; value);\n</code></pre>"},{"location":"languages/java/native/jni.html#_23","title":"\u8c03\u7528\u9759\u6001\u65b9\u6cd5","text":"<pre><code>// \u83b7\u53d6\u9759\u6001\u65b9\u6cd5\njmethodID GetStaticMethodID(JNIEnv *env, jclass clazz, const char *name, const char *sig);\n\n// \u8c03\u7528\u9759\u6001\u65b9\u6cd5\n&lt;NativeType&gt; CallStatic&lt;type&gt;Method(JNIEnv *env, jclass clazz, jmethodID methodID, ...);\n&lt;NativeType&gt; CallStatic&lt;type&gt;MethodA(JNIEnv *env, jclass clazz, jmethodID methodID, jvalue *args);\n&lt;NativeType&gt; CallStatic&lt;type&gt;MethodV(JNIEnv *env, jclass clazz, jmethodID methodID, va_list args);\n</code></pre>"},{"location":"languages/java/native/jni.html#_24","title":"\u5b57\u7b26\u4e32\u64cd\u4f5c","text":"<p>\u8fd9\u91cc\u7684 unicode \u8868\u793a utf 16\u7f16\u7801\u3002</p> <ul> <li>C/C++ \u4e2d\u7684\u5b57\u7b26\u4e32\u5e38\u91cf\u7684\u7f16\u7801\uff0c\u9ed8\u8ba4\u662f\u8ddf\u6587\u4ef6\u7684\u5b58\u50a8\u7f16\u7801\u76f8\u5173\u7684\u3002</li> </ul> <pre><code>// \u4eceUnicode\u5b57\u7b26\u6570\u7ec4\u6784\u9020\u4e00\u4e2a\u65b0\u7684java.lang.String\u5bf9\u8c61\u3002\njstring NewString(JNIEnv *env, const jchar *unicodeChars, jsize len);\n\n// \u8fd4\u56deJava\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\uff08Unicode\u5b57\u7b26\u6570\uff09\u3002\njsize GetStringLength(JNIEnv *env, jstring string);\n\n// \u8fd4\u56de\u5b57\u7b26\u4e32\u7684Unicode\u5b57\u7b26\u6570\u7ec4\u7684\u6307\u9488\u3002\u6b64\u6307\u9488\u6709\u6548\u76f4\u5230\u8c03\u7528ReleaseStringChars()\u3002\n// *isCopy \u8bbe\u7f6e\u4e3a JNI_TRUE\uff08\u5982\u679c\u521b\u5efa\u526f\u672c\uff09; \u6216\u8005\u5982\u679c\u672a\u521b\u5efa\u526f\u672c\uff0c\u5219\u8bbe\u7f6e\u4e3a JNI_FALSE\u3002\nconst jchar * GetStringChars(JNIEnv *env, jstring string, jboolean *isCopy);\n\n// \u901a\u77e5VM\u672c\u5730\u4ee3\u7801\u4e0d\u518d\u9700\u8981\u8bbf\u95eechars\u3002\nvoid ReleaseStringChars(JNIEnv *env, jstring string, const jchar *chars);\n\n// \u4ece\u4fee\u6539\u540e\u7684UTF-8\u7f16\u7801\u5b57\u7b26\u6570\u7ec4\u6784\u9020\u4e00\u4e2a\u65b0\u7684java.lang.String\u5bf9\u8c61\u3002\njstring NewStringUTF(JNIEnv *env, const char *bytes);\n\n// \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u4fee\u6539\u540e\u7684UTF-8\u8868\u793a\u7684\u5b57\u8282\u957f\u5ea6\u3002\njsize GetStringUTFLength(JNIEnv *env, jstring string);\n\n// \u8fd4\u56de\u4e00\u4e2a\u6307\u5411\u4ee5\u4fee\u6539\u540e\u7684UTF-8\u7f16\u7801\u8868\u793a\u7684\u5b57\u7b26\u4e32\u7684\u5b57\u8282\u6570\u7ec4\u7684\u6307\u9488\u3002\u8be5\u6570\u7ec4\u6709\u6548\u76f4\u5230\u88abReleaseStringUTFChars()\u91ca\u653e\u3002\n// *isCopy \u8bbe\u7f6e\u4e3a JNI_TRUE\uff08\u5982\u679c\u521b\u5efa\u526f\u672c\uff09; \u6216\u8005\u5982\u679c\u672a\u521b\u5efa\u526f\u672c\uff0c\u5219\u8bbe\u7f6e\u4e3a JNI_FALSE\u3002\nconst char * GetStringUTFChars(JNIEnv *env, jstring string, jboolean *isCopy);\n\n// \u901a\u77e5\u865a\u62df\u673a\u672c\u5730\u4ee3\u7801\u4e0d\u518d\u9700\u8981\u8bbf\u95eeutf\u3002\nvoid ReleaseStringUTFChars(JNIEnv *env, jstring string, const char *utf);\n\n// \u5c06\u4ece\u504f\u79fb\u91cfstart\u5f00\u59cb\u7684len\u4e2aUnicode\u5b57\u7b26\u590d\u5236\u5230\u7ed9\u5b9a\u7684\u7f13\u51b2\u533abuf\u4e2d\u3002\nvoid GetStringRegion(JNIEnv *env, jstring str, jsize start, jsize len, jchar *buf);\n\n// \u5c06\u4ece\u504f\u79fb\u91cfstart\u5f00\u59cb\u7684len\u4e2aUnicode\u5b57\u7b26\u8f6c\u6362\u4e3a\u4fee\u6539\u540e\u7684UTF-8\u7f16\u7801\uff0c\u5e76\u5c06\u7ed3\u679c\u653e\u5165\u7ed9\u5b9a\u7684\u7f13\u51b2\u533abuf\u4e2d\u3002\n// \u751f\u6210\u7684\u4fee\u6539\u540e\u7684UTF-8\u7f16\u7801\u5b57\u7b26\u6570\u53ef\u80fd\u5927\u4e8e\u7ed9\u5b9a\u7684len\u53c2\u6570\u3002\u53ef\u4ee5\u4f7f\u7528GetStringUTFLength()\u6765\u786e\u5b9a\u6240\u9700\u5b57\u7b26\u7f13\u51b2\u533a\u7684\u6700\u5927\u5927\u5c0f\u3002\n// \u7531\u4e8e\u6b64\u89c4\u8303\u4e0d\u8981\u6c42\u751f\u6210\u7684\u5b57\u7b26\u4e32\u526f\u672c\u4ee5NULL\u7ed3\u5c3e\uff0c\u5efa\u8bae\u5728\u4f7f\u7528\u6b64\u51fd\u6570\u4e4b\u524d\u6e05\u9664\u7ed9\u5b9a\u7684\u5b57\u7b26\u7f13\u51b2\u533a\uff08\u4f8b\u5982\"memset()\"\uff09\uff0c\u4ee5\u4fbf\u5b89\u5168\u5730\u6267\u884cstrlen()\u3002\nvoid GetStringUTFRegion(JNIEnv *env, jstring str, jsize start, jsize len, char *buf);\n\n// \u8bed\u4e49\u7c7b\u4f3c\u4e8e\u73b0\u6709\u7684Get/ReleaseStringChars\u51fd\u6570\u3002\u5982\u679c\u53ef\u80fd\uff0cVM \u5c06\u8fd4\u56de\u6307\u5411\u5b57\u7b26\u4e32\u5143\u7d20\u7684\u6307\u9488;\u5426\u5219\uff0c\u5c06\u521b\u5efa\u4e00\u4e2a\u526f\u672c\u3002\n// \u4f46\u662f\u8fd9\u4e9b\u529f\u80fd\u7684\u4f7f\u7528\u65b9\u5f0f\u5b58\u5728\u5f88\u5927\u9650\u5236\u3002\u5728 Get/ReleaseStringCritical \u8c03\u7528\u5305\u542b\u7684\u4ee3\u7801\u6bb5\u4e2d\uff0c\u672c\u673a\u4ee3\u7801\u4e0d\u5f97\u53d1\u51fa\u4efb\u610f JNI \u8c03\u7528\uff0c\u4e5f\u4e0d\u5f97\u5bfc\u81f4\u5f53\u524d\u7ebf\u7a0b\u963b\u585e\u3002\nconst jchar * GetStringCritical(JNIEnv *env, jstring string, jboolean *isCopy);\nvoid ReleaseStringCritical(JNIEnv *env, jstring string, const jchar *carray);    \n</code></pre>"},{"location":"languages/java/native/jni.html#_25","title":"\u6570\u7ec4\u64cd\u4f5c","text":"<pre><code>// \u8fd4\u56de\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u6570\u91cf\u3002\njsize GetArrayLength(JNIEnv *env, jarray array);\n\n// \u6784\u9020\u4e00\u4e2a\u6301\u6709elementClass\u7c7b\u4e2d\u5bf9\u8c61\u7684\u65b0\u6570\u7ec4\u3002\u6240\u6709\u5143\u7d20\u6700\u521d\u8bbe\u7f6e\u4e3ainitialElement\u3002\njobjectArray NewObjectArray(JNIEnv *env, jsize length, jclass elementClass, jobject initialElement);\n\n// \u8fd4\u56deObject\u6570\u7ec4\u7684\u4e00\u4e2a\u5143\u7d20\u3002\u7528\u4e8e\u5bf9\u8c61\u6570\u7ec4\uff0c\u6216\u8005\u591a\u7ef4\u6570\u7ec4\u3002\njobject GetObjectArrayElement(JNIEnv *env, jobjectArray array, jsize index);\n\n// \u8bbe\u7f6eObject\u6570\u7ec4\u7684\u4e00\u4e2a\u5143\u7d20\u3002\nvoid SetObjectArrayElement(JNIEnv *env, jobjectArray array, jsize index, jobject value);\n\n// \u521b\u5efa\u57fa\u672c\u7c7b\u578b\u662f\u6570\u7ec4\uff0c\u5982  jintArray NewIntArray()\n&lt;ArrayType&gt; New&lt;PrimitiveType&gt;Array(JNIEnv *env, jsize length);\n\n// \u8fd4\u56de\u539f\u59cb\u6570\u7ec4\u7684\u5185\u5bb9\u3002\u7ed3\u679c\u5728\u5bf9\u5e94\u7684Release&lt;PrimitiveType&gt;ArrayElements()\u51fd\u6570\u88ab\u8c03\u7528\u4e4b\u524d\u6709\u6548\u3002\n// \u7531\u4e8e\u8fd4\u56de\u7684\u6570\u7ec4\u53ef\u80fd\u662fJava\u6570\u7ec4\u7684\u526f\u672c\uff0c\u5bf9\u8fd4\u56de\u7684\u6570\u7ec4\u8fdb\u884c\u7684\u66f4\u6539\u4e0d\u4e00\u5b9a\u4f1a\u53cd\u6620\u5728\u539f\u59cb\u6570\u7ec4\u4e2d\uff0c\u76f4\u5230\u8c03\u7528Release&lt;PrimitiveType&gt;ArrayElements()\u4e3a\u6b62\u3002\n// \u5982\u679cJVM\u7684GC\u652f\u6301pin\u64cd\u4f5c\uff0cNULL\u3001JNIFALSE \u624d\u6709\u7528\uff0c\u8868\u793a\u76f4\u63a5\u8fd4\u56de\u6307\u5411\u539f\u59cb\u6570\u7ec4\u7684\u6307\u9488\uff0cx86\u5904\u7406\u5668\u7684\u6a21\u62df\u5668\u662f\u4e0d\u652f\u6301pin\n&lt;NativeType&gt; *Get&lt;PrimitiveType&gt;ArrayElements(JNIEnv *env, &lt;ArrayType&gt; array, jboolean *isCopy);\n\n// \u901a\u77e5\u865a\u62df\u673a\u672c\u673a\u4ee3\u7801\u4e0d\u518d\u9700\u8981\u8bbf\u95eeelems.\n// mode\u53c2\u6570(\u9ed8\u8ba4\u75280\u5373\u53ef\uff09\u63d0\u4f9b\u6709\u5173\u5982\u4f55\u91ca\u653e\u6570\u7ec4\u7f13\u51b2\u533a\u7684\u4fe1\u606f\u3002\u5982\u679celems\u4e0d\u662f\u6570\u7ec4\u4e2d\u5143\u7d20\u7684\u526f\u672c\uff0c\u5219mode\u4e0d\u8d77\u4f5c\u7528\u3002\u5426\u5219\uff0cmode\u5177\u6709\u4ee5\u4e0b\u5f71\u54cd\uff0c\u5982\u4e0b\u8868\u6240\u793a:\n// \u6a21\u5f0f          \u64cd\u4f5c\n// 0            \u590d\u5236\u56de\u5185\u5bb9\u5e76\u91ca\u653eelems\u7f13\u51b2\u533a\n// JNI_COMMIT   \u590d\u5236\u56de\u5185\u5bb9\u4f46\u4e0d\u91ca\u653eelems\u7f13\u51b2\u533a\n// JNI_ABORT    \u91ca\u653e\u7f13\u51b2\u533a\u800c\u4e0d\u590d\u5236\u56de\u53ef\u80fd\u7684\u66f4\u6539\nvoid Release&lt;PrimitiveType&gt;ArrayElements(JNIEnv *env, &lt;ArrayType&gt; array, NativeType *elems, jint mode);\n\n// \u5c06\u539f\u59cb\u6570\u7ec4\u7684\u533a\u57df\u590d\u5236\u5230\u7f13\u51b2\u533a\u4e2d\u3002\nvoid Get&lt;PrimitiveType&gt;ArrayRegion(JNIEnv *env, &lt;ArrayType&gt; array, jsize start, jsize len, &lt;NativeType&gt; *buf);\n// \u4ece\u7f13\u51b2\u533a\u4e2d\u5c06\u539f\u59cb\u6570\u7ec4\u7684\u533a\u57df\u590d\u5236\u56de\u53bb\u3002\nvoid Set&lt;PrimitiveType&gt;ArrayRegion(JNIEnv *env, ArrayType array, jsize start, jsize len, const NativeType *buf);\n</code></pre>"},{"location":"languages/java/native/jni.html#_26","title":"\u6ce8\u518c\u672c\u5730\u65b9\u6cd5","text":"<pre><code>// \u4f7f\u7528clazz\u53c2\u6570\u6307\u5b9a\u7684\u7c7b\u6ce8\u518c\u672c\u673a\u65b9\u6cd5\uff0c\u5373\u5c06 Java native \u65b9\u6cd5\u6620\u5c04\u4e3a C \u4e2d\u7684\u65b9\u6cd5\u3002\n// JNINativeMethod\u7ed3\u6784\u7684name\u548csignature\u5b57\u6bb5\u662f\u6307\u5411\u4fee\u6539\u540e\u7684UTF-8\u5b57\u7b26\u4e32\u7684\u6307\u9488\u3002 nMethods\u53c2\u6570\u6307\u5b9a\u6570\u7ec4\u4e2d\u7684\u672c\u673a\u65b9\u6cd5\u6570\u91cf\u3002 \n// typedef struct {\n//    char *name;\n//    char *signature;\n//    void *fnPtr;\n// } JNINativeMethod;\n// \u51fd\u6570\u6307\u9488\u540d\u4e49\u4e0a\u5fc5\u987b\u5177\u6709\u4ee5\u4e0b\u7b7e\u540d\uff1a\n// ReturnType (*fnPtr)(JNIEnv *env, jobject objectOrClass, ...);\nReturnType (*fnPtr)(JNIEnv *env, jobject objectOrClass, ...);\njint RegisterNatives(JNIEnv *env, jclass clazz, const JNINativeMethod *methods, jint nMethods);\n\n// \u53d6\u6d88\u6ce8\u518c\u7c7b\u7684\u672c\u673a\u65b9\u6cd5\u3002 \u7c7b\u8fd4\u56de\u5230\u94fe\u63a5\u6216\u6ce8\u518c\u5176\u672c\u673a\u65b9\u6cd5\u51fd\u6570\u4e4b\u524d\u7684\u72b6\u6001\u3002\njint UnregisterNatives(JNIEnv *env, jclass clazz);\n</code></pre>"},{"location":"languages/java/native/jni.html#_27","title":"\u76d1\u89c6\u5668\u64cd\u4f5c","text":"<p>\u6bcf\u4e2aJava\u5bf9\u8c61\u90fd\u6709\u4e00\u4e2a\u4e0e\u4e4b\u5173\u8054\u7684\u76d1\u89c6\u5668\u3002</p> <ul> <li>\u5982\u679c\u5f53\u524d\u7ebf\u7a0b\u5df2\u7ecf\u62e5\u6709\u4e0e<code>obj</code>\u5173\u8054\u7684\u76d1\u89c6\u5668\uff0c\u5219\u4f1a\u589e\u52a0\u76d1\u89c6\u5668\u4e2d\u7684\u8ba1\u6570\u5668\uff0c\u6307\u793a\u8be5\u7ebf\u7a0b\u8fdb\u5165\u76d1\u89c6\u5668\u7684\u6b21\u6570</li> <li>\u5982\u679c\u4e0e<code>obj</code>\u5173\u8054\u7684\u76d1\u89c6\u5668\u6ca1\u6709\u88ab\u4efb\u4f55\u7ebf\u7a0b\u62e5\u6709\uff0c\u5219\u5f53\u524d\u7ebf\u7a0b\u5c06\u6210\u4e3a\u76d1\u89c6\u5668\u7684\u6240\u6709\u8005\uff0c\u5c06\u8be5\u76d1\u89c6\u5668\u7684\u8fdb\u5165\u8ba1\u6570\u8bbe\u7f6e\u4e3a1\u3002</li> <li>\u5982\u679c\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u5df2\u7ecf\u62e5\u6709\u4e0e<code>obj</code>\u5173\u8054\u7684\u76d1\u89c6\u5668\uff0c\u5219\u5f53\u524d\u7ebf\u7a0b\u5c06\u7b49\u5f85\u76f4\u5230\u76d1\u89c6\u5668\u88ab\u91ca\u653e\uff0c\u7136\u540e\u518d\u6b21\u5c1d\u8bd5\u83b7\u53d6\u6240\u6709\u6743\u3002</li> </ul> <p>\u901a\u8fc7<code>MonitorEnter</code> JNI\u51fd\u6570\u8c03\u7528\u8fdb\u5165\u7684\u76d1\u89c6\u5668\u4e0d\u80fd\u4f7f\u7528<code>monitorexit</code> Java\u865a\u62df\u673a\u6307\u4ee4\u6216\u540c\u6b65\u65b9\u6cd5\u8fd4\u56de\u9000\u51fa\u3002<code>MonitorEnter</code> JNI\u51fd\u6570\u8c03\u7528\u548c<code>monitorenter</code> Java\u865a\u62df\u673a\u6307\u4ee4\u53ef\u80fd\u4f1a\u7ade\u4e89\u8fdb\u5165\u4e0e\u540c\u4e00\u5bf9\u8c61\u5173\u8054\u7684\u76d1\u89c6\u5668\u3002</p> <p>\u4e3a\u907f\u514d\u6b7b\u9501\uff0c\u901a\u8fc7<code>MonitorEnter</code> JNI\u51fd\u6570\u8c03\u7528\u8fdb\u5165\u7684\u76d1\u89c6\u5668\u5fc5\u987b\u4f7f\u7528<code>MonitorExit</code> JNI\u8c03\u7528\u9000\u51fa\uff0c\u9664\u975e\u4f7f\u7528<code>DetachCurrentThread</code>\u8c03\u7528\u9690\u5f0f\u91ca\u653eJNI\u76d1\u89c6\u5668\u3002</p> <p>\u672c\u673a\u4ee3\u7801\u4e0d\u80fd\u4f7f\u7528<code>MonitorExit</code>\u9000\u51fa\u901a\u8fc7\u540c\u6b65\u65b9\u6cd5\u6216<code>monitorenter</code> Java\u865a\u62df\u673a\u6307\u4ee4\u8fdb\u5165\u7684\u76d1\u89c6\u5668\u3002</p> <pre><code>// \u8fdb\u5165\u4e0eobj\u5f15\u7528\u7684\u5e95\u5c42Java\u5bf9\u8c61\u5173\u8054\u7684\u76d1\u89c6\u5668\u3002\njint MonitorEnter(JNIEnv *env, jobject obj);\n\n// \u5f53\u524d\u7ebf\u7a0b\u5fc5\u987b\u662f\u4e0eobj\u5f15\u7528\u7684\u5e95\u5c42Java\u5bf9\u8c61\u5173\u8054\u7684\u76d1\u89c6\u5668\u7684\u6240\u6709\u8005\u3002\u7ebf\u7a0b\u51cf\u5c11\u6307\u793a\u5b83\u8fdb\u5165\u6b64\u76d1\u89c6\u5668\u7684\u6b21\u6570\u3002\u5982\u679c\u8ba1\u6570\u5668\u7684\u503c\u53d8\u4e3a\u96f6\uff0c\u5219\u5f53\u524d\u7ebf\u7a0b\u91ca\u653e\u76d1\u89c6\u5668\u3002\njint MonitorExit(JNIEnv *env, jobject obj);\n</code></pre>"},{"location":"languages/java/native/jni.html#nio","title":"NIO \u652f\u6301","text":"<pre><code>// \u5206\u914d\u5e76\u8fd4\u56de\u4e00\u4e2a\u76f4\u63a5\u5f15\u7528\u5185\u5b58\u5730\u5740\u4e3aaddress\u3001\u957f\u5ea6\u4e3acapacity\u5b57\u8282\u7684java.nio.ByteBuffer\u3002\u8fd4\u56de\u7684\u7f13\u51b2\u533a\u7684\u5b57\u8282\u987a\u5e8f\u59cb\u7ec8\u4e3a\u5927\u7aef\u5e8f\u3002\n// capacity \u4e0d\u80fd\u4e3a\u8d1f\u6570\u6216\u5927\u4e8eInteger.MAX_VALUE\njobject NewDirectByteBuffer(JNIEnv* env, void* address, jlong capacity);\n\n// \u83b7\u53d6\u5e76\u8fd4\u56de\u7ed9\u5b9a\u76f4\u63a5java.nio.Buffer\u5f15\u7528\u7684\u5185\u5b58\u533a\u57df\u7684\u8d77\u59cb\u5730\u5740\u3002\u5141\u8bb8\u672c\u673a\u4ee3\u7801\u8bbf\u95ee\u4e0eJava\u4ee3\u7801\u901a\u8fc7\u7f13\u51b2\u533a\u5bf9\u8c61\u8bbf\u95ee\u7684\u76f8\u540c\u5185\u5b58\u533a\u57df\u3002\nvoid* GetDirectBufferAddress(JNIEnv* env, jobject buf);\n\n// \u83b7\u53d6\u5e76\u8fd4\u56de\u7ed9\u5b9a\u76f4\u63a5java.nio.Buffer\u5f15\u7528\u7684\u5185\u5b58\u533a\u57df\u7684\u5bb9\u91cf\u3002\u5bb9\u91cf\u662f\u5185\u5b58\u533a\u57df\u5305\u542b\u7684\u5143\u7d20\u6570\u91cf\u3002\njlong GetDirectBufferCapacity(JNIEnv* env, jobject buf);\n</code></pre>"},{"location":"languages/java/native/jni.html#_28","title":"\u53cd\u5c04\u652f\u6301","text":"<p>JNI\u63d0\u4f9b\u4e86\u4e00\u7ec4\u5728JNI\u4e2d\u4f7f\u7528\u7684\u5b57\u6bb5\u548c\u65b9\u6cd5ID\u4e0eJava\u6838\u5fc3\u53cd\u5c04API\u4e2d\u4f7f\u7528\u7684\u5b57\u6bb5\u548c\u65b9\u6cd5\u5bf9\u8c61\u4e4b\u95f4\u8fdb\u884c\u8f6c\u6362\u7684\u51fd\u6570\u3002</p> <pre><code>// \u5c06java.lang.reflect.Method\u6216java.lang.reflect.Constructor\u5bf9\u8c61\u8f6c\u6362\u4e3a\u65b9\u6cd5ID\u3002\n// method\uff1a\u4e00\u4e2ajava.lang.reflect.Method\u6216java.lang.reflect.Constructor\u5bf9\u8c61\uff0c\u4e0d\u5f97\u4e3aNULL\u3002\njmethodID FromReflectedMethod(JNIEnv *env, jobject method);\n\n// \u5c06java.lang.reflect.Field\u8f6c\u6362\u4e3a\u5b57\u6bb5ID\u3002\njfieldID FromReflectedField(JNIEnv *env, jobject field);\n\n// \u5c06\u4ececls\u6d3e\u751f\u7684\u65b9\u6cd5ID\u8f6c\u6362\u4e3ajava.lang.reflect.Method\u6216java.lang.reflect.Constructor\u5bf9\u8c61\u3002\n// \u8bbe\u7f6e\u4e3aJNI_TRUE\uff0c\u5982\u679c\u65b9\u6cd5ID\u5f15\u7528\u9759\u6001\u5b57\u6bb5\uff0c\u5426\u5219\u8bbe\u7f6e\u4e3aJNI_FALSE\njobject ToReflectedMethod(JNIEnv *env, jclass cls, jmethodID methodID, jboolean isStatic);\n\n// \u5c06\u4ececls\u6d3e\u751f\u7684\u5b57\u6bb5ID\u8f6c\u6362\u4e3a\u4e00\u4e2ajava.lang.reflect.Field\u5bf9\u8c61\u3002\njobject ToReflectedField(JNIEnv *env, jclass cls, jfieldID fieldID, jboolean isStatic);\n</code></pre>"},{"location":"languages/java/native/jni.html#vm","title":"VM \u63a5\u53e3","text":"<pre><code>// \u8fd4\u56de\u4e0e\u5f53\u524d\u7ebf\u7a0b\u5173\u8054\u7684Java VM\u63a5\u53e3\uff08\u5728\u8c03\u7528API\u4e2d\u4f7f\u7528\uff09\u3002\u7ed3\u679c\u653e\u7f6e\u5728\u7b2c\u4e8c\u4e2a\u53c2\u6570vm\u6307\u5411\u7684\u4f4d\u7f6e\u3002\n// \u6210\u529f\u8fd4\u56de\"0\"\uff1b\u5931\u8d25\u8fd4\u56de\u8d1f\u503c\u3002\njint GetJavaVM(JNIEnv *env, JavaVM **vm);\n</code></pre>"},{"location":"languages/java/native/jni.html#api","title":"\u8c03\u7528 API","text":"<p>\u8c03\u7528API\u5141\u8bb8\u8f6f\u4ef6\u4f9b\u5e94\u5546\u5c06Java\u865a\u62df\u673a\u52a0\u8f7d\u5230\u4efb\u610f\u672c\u673a\u5e94\u7528\u7a0b\u5e8f\u4e2d\u3002</p>"},{"location":"languages/java/native/jni.html#_29","title":"\u6982\u8ff0","text":"<p>\u793a\u4f8bC++\u4ee3\u7801\u521b\u5efa\u4e86\u4e00\u4e2aJava\u865a\u62df\u673a\uff0c\u5e76\u8c03\u7528\u4e86\u4e00\u4e2a\u540d\u4e3a<code>Main.test</code>\u7684\u9759\u6001\u65b9\u6cd5</p> <pre><code>#include &lt;jni.h&gt;       /* \u5b9a\u4e49\u6240\u6709\u5185\u5bb9\u7684\u4f4d\u7f6e */\n...\nJavaVM *jvm;       /* \u8868\u793aJava\u865a\u62df\u673a */\nJNIEnv *env;       /* \u6307\u5411\u672c\u673a\u65b9\u6cd5\u63a5\u53e3\u7684\u6307\u9488 */\nJavaVMInitArgs vm_args; /* JDK/JRE 19 VM\u521d\u59cb\u5316\u53c2\u6570 */\nJavaVMOption* options = new JavaVMOption[1];\noptions[0].optionString = \"-Djava.class.path=/usr/lib/java\";\nvm_args.version = JNI_VERSION_19;\nvm_args.nOptions = 1;\nvm_args.options = options;\nvm_args.ignoreUnrecognized = false;\n/* \u52a0\u8f7d\u548c\u521d\u59cb\u5316Java\u865a\u62df\u673a\uff0c\u8fd4\u56de\u4e00\u4e2aJNI\u63a5\u53e3\u6307\u9488\n * \u5728env\u4e2d */\nJNI_CreateJavaVM(&amp;jvm, (void**)&amp;env, &amp;vm_args);\ndelete options;\n/* \u4f7f\u7528JNI\u8c03\u7528Main.test\u65b9\u6cd5 */\njclass cls = env-&gt;FindClass(\"Main\");\njmethodID mid = env-&gt;GetStaticMethodID(cls, \"test\", \"(I)V\");\nenv-&gt;CallStaticVoidMethod(cls, mid, 100);\n/* \u5b8c\u6210\u3002 */\njvm-&gt;DestroyJavaVM();\n</code></pre>"},{"location":"languages/java/native/jni.html#_30","title":"\u521b\u5efa\u865a\u62df\u673a","text":"<p><code>JNI_CreateJavaVM()</code>\u51fd\u6570\u52a0\u8f7d\u5e76\u521d\u59cb\u5316Java\u865a\u62df\u673a\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2aJNI\u63a5\u53e3\u6307\u9488\u3002</p> <ul> <li>\u8c03\u7528<code>JNI_CreateJavaVM()</code>\u7684\u7ebf\u7a0b\u88ab\u89c6\u4e3a\u4e3b\u7ebf\u7a0b\uff0c\u5e76\u9644\u52a0\u5230Java\u865a\u62df\u673a\u3002</li> </ul>"},{"location":"languages/java/native/jni.html#_31","title":"\u9644\u52a0\u5230\u865a\u62df\u673a","text":"<p>JNI\u63a5\u53e3\u6307\u9488\uff08<code>JNIEnv</code>\uff09\u4ec5\u5728\u5f53\u524d\u7ebf\u7a0b\u4e2d\u6709\u6548\u3002\u5982\u679c\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u9700\u8981\u8bbf\u95eeJava\u865a\u62df\u673a\uff0c\u5148\u8c03\u7528<code>AttachCurrentThread()</code>\u5c06\u81ea\u5df1\u9644\u52a0\u5230\u865a\u62df\u673a\u5e76\u83b7\u53d6JNI\u63a5\u53e3\u6307\u9488\u3002</p> <ul> <li>\u9644\u52a0\u7684\u7ebf\u7a0b\u5e94\u8be5\u6709\u8db3\u591f\u7684\u5806\u6808\u7a7a\u95f4\u6765\u6267\u884c\u5408\u7406\u6570\u91cf\u7684\u5de5\u4f5c\u3002\u7528pthread\u65f6\uff0c\u5806\u6808\u5927\u5c0f\u53ef\u4ee5\u5728<code>pthread_create</code>\u7684<code>pthread_attr_t</code>\u53c2\u6570\u4e2d\u6307\u5b9a\u3002</li> </ul>"},{"location":"languages/java/native/jni.html#_32","title":"\u4ece\u865a\u62df\u673a\u5206\u79bb","text":"<p>\u9644\u52a0\u5230\u865a\u62df\u673a\u7684\u672c\u673a\u7ebf\u7a0b\u5728\u7ec8\u6b62\u4e4b\u524d\u5fc5\u987b\u8c03\u7528<code>DetachCurrentThread()</code>\u5c06\u81ea\u5df1\u5206\u79bb\u3002\u5982\u679c\u8c03\u7528\u5806\u6808\u4e0a\u6709Java\u65b9\u6cd5\uff0c\u5219\u7ebf\u7a0b\u65e0\u6cd5\u5206\u79bb\u81ea\u5df1\u3002</p>"},{"location":"languages/java/native/jni.html#_33","title":"\u7ec8\u6b62\u865a\u62df\u673a","text":"<p><code>DestroyJavaVM()</code>\u51fd\u6570\u7ec8\u6b62Java\u865a\u62df\u673a\u3002</p> <ul> <li>\u5f85\u76f4\u5230\u6ca1\u6709\u975e\u5b88\u62a4\u7ebf\u7a0b\u5728\u6267\u884c\uff0c\u7136\u540e\u624d\u5b9e\u9645\u7ec8\u6b62\u865a\u62df\u673a\uff1b\u975e\u5b88\u62a4\u7ebf\u7a0b\u5305\u62ecJava\u7ebf\u7a0b\u548c\u9644\u52a0\u7684\u672c\u673a\u7ebf\u7a0b\u3002</li> </ul>"},{"location":"languages/java/native/jni.html#_34","title":"\u5e93\u548c\u7248\u672c\u7ba1\u7406","text":"<p>\u76f8\u540c\u7684 JNI \u672c\u673a\u5e93\u4e0d\u80fd\u52a0\u8f7d\u5230\u591a\u4e2a\u7c7b\u52a0\u8f7d\u5668\u4e2d\u3002</p> <p>\u5f53\u4f7f\u7528<code>System.loadLibrary</code>\u5c06\u672c\u673a\u5e93\u52a0\u8f7d\u5230\u4e24\u4e2a\u7c7b\u52a0\u8f7d\u5668\u4e2d\u65f6\uff0c\u4f1a\u629b\u51fa<code>UnsatisfiedLinkError</code>\u3002\u8fd9\u79cd\u65b9\u6cd5\u7684\u597d\u5904\u5305\u62ec\uff1a</p> <ul> <li>\u57fa\u4e8e\u7c7b\u52a0\u8f7d\u5668\u7684\u540d\u79f0\u7a7a\u95f4\u5206\u79bb\u5728\u672c\u673a\u5e93\u4e2d\u5f97\u4ee5\u4fdd\u7559\u3002\u672c\u673a\u5e93\u4e0d\u80fd\u8f7b\u677e\u6df7\u5408\u6765\u81ea\u4e0d\u540c\u7c7b\u52a0\u8f7d\u5668\u7684\u7c7b\u3002</li> <li>\u6b64\u5916\uff0c\u5f53\u76f8\u5e94\u7684\u7c7b\u52a0\u8f7d\u5668\u88ab\u5783\u573e\u56de\u6536\u65f6\uff0c\u672c\u673a\u5e93\u53ef\u4ee5\u88ab\u5378\u8f7d\u3002</li> </ul>"},{"location":"languages/java/native/jni.html#_35","title":"\u9759\u6001\u94fe\u63a5\u5e93\u652f\u6301","text":""},{"location":"languages/java/native/jni.html#_36","title":"\u5e93\u751f\u547d\u5468\u671f\u51fd\u6570\u6302\u94a9","text":"<p>\u4e3a\u4e86\u4fbf\u4e8e\u7248\u672c\u63a7\u5236\u548c\u8d44\u6e90\u7ba1\u7406\uff0cJNI\u5e93\u53ef\u4ee5\u5b9a\u4e49\u52a0\u8f7d\u548c\u5378\u8f7d\u51fd\u6570\u6302\u94a9\u3002\u8fd9\u4e9b\u51fd\u6570\u7684\u547d\u540d\u53d6\u51b3\u4e8e\u5e93\u662f\u52a8\u6001\u94fe\u63a5\u8fd8\u662f\u9759\u6001\u94fe\u63a5\u3002</p>"},{"location":"languages/java/native/jni.html#jni_onload","title":"JNI_OnLoad","text":"<pre><code>// reserved\uff1a\u672a\u4f7f\u7528\u7684\u6307\u9488\u3002\u8fd4\u56de\u6240\u9700\u7684JNI_VERSION\u5e38\u91cf\njint JNI_OnLoad(JavaVM *vm, void *reserved);\n</code></pre> <p><code>JNI_OnLoad</code>\u5fc5\u987b\u8fd4\u56de\u81f3\u5c11\u5b9a\u4e49JNI API \u7248\u672c\u7684\u5e38\u91cf\uff1a</p> <ul> <li>\u5982\u679c\u672c\u673a\u5e93\u4e0d\u5bfc\u51fa<code>JNI_OnLoad</code>\u51fd\u6570\uff0c\u5219VM\u5047\u5b9a\u8be5\u5e93\u4ec5\u9700\u8981JNI\u7248\u672c<code>JNI_VERSION_1_1</code>\u3002</li> </ul>"},{"location":"languages/java/native/jni.html#jni_onunload","title":"JNI_OnUnload","text":"<pre><code>//\u5f53\u5305\u542b\u672c\u673a\u5e93\u7684\u7c7b\u52a0\u8f7d\u5668\u88ab\u5783\u573e\u56de\u6536\u65f6\uff0cVM\u4f1a\u8c03\u7528JNI_OnUnload\u3002\nvoid JNI_OnUnload(JavaVM *vm, void *reserved);\n</code></pre> <p>\u6b64\u51fd\u6570\u53ef\u7528\u4e8e\u6267\u884c\u6e05\u7406\u64cd\u4f5c\u3002\u7531\u4e8e\u6b64\u51fd\u6570\u5728\u672a\u77e5\u4e0a\u4e0b\u6587\u4e2d\u8c03\u7528\uff08\u4f8b\u5982\u4ece\u7ec8\u7ed3\u5668\u8c03\u7528\uff09\uff0c\u7a0b\u5e8f\u5458\u5728\u4f7f\u7528Java VM\u670d\u52a1\u65f6\u5e94\u4fdd\u5b88\uff0c\u5e76\u907f\u514d\u4efb\u610f\u7684Java\u56de\u8c03\u3002</p>"},{"location":"languages/java/native/jni.html#jni_onload_l","title":"JNI_OnLoad_L","text":"<pre><code>jint JNI_Onload_&lt;L&gt;(JavaVM *vm, void *reserved);\n</code></pre> <p>\u5982\u679c\u4e00\u4e2a\u540d\u4e3a'L'\u7684\u5e93\u662f\u9759\u6001\u94fe\u63a5\u7684\uff0c\u90a3\u4e48\u5728\u7b2c\u4e00\u6b21\u8c03\u7528<code>System.loadLibrary(\"L\")</code>\u6216\u7b49\u6548\u7684API\u65f6\uff0c\u5c06\u8c03\u7528\u4e00\u4e2a\u5177\u6709\u4e0e<code>JNI_OnLoad</code>\u51fd\u6570\u6307\u5b9a\u7684\u76f8\u540c\u53c2\u6570\u548c\u671f\u671b\u8fd4\u56de\u503c\u7684<code>JNI_OnLoad_L</code>\u51fd\u6570\u3002</p> <ul> <li>\u8fd4\u56de\u672c\u5730\u5e93\u6240\u9700\u7684JNI\u7248\u672c\uff0c\u6b64\u7248\u672c\u5fc5\u987b\u662f<code>JNI_VERSION_1_8</code>\u6216\u66f4\u9ad8\u7248\u672c\u3002</li> </ul>"},{"location":"languages/java/native/jni.html#jni_onunload_l","title":"JNI_OnUnload_L","text":"<pre><code>void JNI_OnUnload_&lt;L&gt;(JavaVM *vm, void *reserved);\n</code></pre> <p>\u5f53\u5305\u542b\u9759\u6001\u94fe\u63a5\u672c\u5730\u5e93'L'\u7684\u7c7b\u52a0\u8f7d\u5668\u88ab\u5783\u573e\u56de\u6536\u65f6\uff0c\u5982\u679c\u5bfc\u51fa\u4e86<code>JNI_OnUnload_L</code>\u51fd\u6570\uff0c\u5219VM\u5c06\u8c03\u7528\u8be5\u5e93\u7684<code>JNI_OnUnload_L</code>\u51fd\u6570\u3002</p>"},{"location":"languages/java/native/jni.html#api_1","title":"\u8c03\u7528API\u51fd\u6570","text":"<p><code>JavaVM</code>\u7c7b\u578b\u662f\u6307\u5411\u8c03\u7528API\u51fd\u6570\u8868\u7684\u6307\u9488\u3002</p> <pre><code>typedef const struct JNIInvokeInterface *JavaVM;\n\nconst struct JNIInvokeInterface ... = {\n    NULL,\n    NULL,\n    NULL,\n\n    DestroyJavaVM,\n    AttachCurrentThread,\n    DetachCurrentThread,\n\n    GetEnv,\n\n    AttachCurrentThreadAsDaemon\n};\n</code></pre>"},{"location":"languages/java/native/jni.html#jni_getdefaultjavavminitargs","title":"JNI_GetDefaultJavaVMInitArgs","text":"<pre><code>// vm_args: JavaVMInitArgs\u7ed3\u6784\u7684\u6307\u9488\uff0c\u4e0d\u80fd\u4e3aNULL\n// \u5982\u679c\u652f\u6301\u8bf7\u6c42\u7684\u7248\u672c\uff0c\u5219\u8fd4\u56deJNI_OK\uff1b\u5982\u679c\u4e0d\u652f\u6301\u8bf7\u6c42\u7684\u7248\u672c\uff0c\u5219\u8fd4\u56deJNI\u9519\u8bef\u4ee3\u7801\uff08\u8d1f\u6570\uff09\njint JNI_GetDefaultJavaVMInitArgs(void *vm_args);\n</code></pre> <p>\u8fd4\u56deJava VM\u7684\u9ed8\u8ba4\u914d\u7f6e\u3002\u5728\u8c03\u7528\u6b64\u51fd\u6570\u4e4b\u524d\uff0c\u672c\u673a\u4ee3\u7801\u5fc5\u987b\u5c06<code>vm_args-&gt;version</code>\u5b57\u6bb5\u8bbe\u7f6e\u4e3a\u5b83\u671f\u671bVM\u652f\u6301\u7684JNI\u7248\u672c\u3002</p> <ul> <li>\u6b64\u51fd\u6570\u8fd4\u56de\u540e\uff0cvm_args-&gt;version\u5c06\u8bbe\u7f6e\u4e3aVM\u652f\u6301\u7684\u5b9e\u9645JNI\u7248\u672c\u3002  </li> </ul>"},{"location":"languages/java/native/jni.html#jni_getcreatedjavavms","title":"JNI_GetCreatedJavaVMs","text":"<pre><code>// vmBuf\uff1a\u6307\u5411\u5c06\u653e\u7f6eVM\u7ed3\u6784\u7684\u7f13\u51b2\u533a\u7684\u6307\u9488\uff0c\u4e0d\u80fd\u4e3aNULL\n// \u6210\u529f\u65f6\u8fd4\u56deJNI_OK\uff1b\u5931\u8d25\u65f6\u8fd4\u56de\u9002\u5f53\u7684JNI\u9519\u8bef\u4ee3\u7801\uff08\u8d1f\u6570\uff09\u3002\njint JNI_GetCreatedJavaVMs(JavaVM **vmBuf, jsize bufLen, jsize *nVMs);\n</code></pre> <p>\u8fd4\u56de\u5df2\u521b\u5efa\u7684\u6240\u6709Java VM\u3002\u5c06VM\u6307\u9488\u6309\u521b\u5efa\u987a\u5e8f\u5199\u5165\u7f13\u51b2\u533a<code>vmBuf</code>\u3002\u6700\u591a\u5c06\u5199\u5165<code>bufLen</code>\u4e2a\u6761\u76ee\u3002\u5df2\u521b\u5efa\u7684VM\u603b\u6570\u5c06\u5728<code>\\*nVMs</code>\u4e2d\u8fd4\u56de\u3002</p> <ul> <li>\u4e0d\u652f\u6301\u5728\u5355\u4e2a\u8fdb\u7a0b\u4e2d\u521b\u5efa\u591a\u4e2aVM\u3002</li> </ul>"},{"location":"languages/java/native/jni.html#jni_createjavavm","title":"JNI_CreateJavaVM","text":"<pre><code>// p_vm\uff1a\u6307\u5411\u5c06\u653e\u7f6e\u7ed3\u679cVM\u7ed3\u6784\u7684\u4f4d\u7f6e\u7684\u6307\u9488\u3002\u4e0d\u80fd\u4e3aNULL\u3002\n// p_env\uff1a\u6307\u5411\u5c06\u653e\u7f6e\u4e3b\u7ebf\u7a0b\u7684JNI\u63a5\u53e3\u6307\u9488\u7684\u4f4d\u7f6e\u7684\u6307\u9488\u3002\u4e0d\u80fd\u4e3aNULL\u3002\n// vm_args\uff1aJava VM\u521d\u59cb\u5316\u53c2\u6570\u3002\u4e0d\u80fd\u4e3aNULL\u3002\njint JNI_CreateJavaVM(JavaVM **p_vm, void **p_env, void *vm_args);\n</code></pre> <p>\u52a0\u8f7d\u5e76\u521d\u59cb\u5316Java VM\u3002\u5f53\u524d\u7ebf\u7a0b\u5c06\u9644\u52a0\u5230Java VM\u5e76\u6210\u4e3a\u4e3b\u7ebf\u7a0b\u3002\u5c06<code>p_env</code>\u53c2\u6570\u8bbe\u7f6e\u4e3a\u4e3b\u7ebf\u7a0b\u7684JNI\u63a5\u53e3\u6307\u9488\u3002</p> <ul> <li>\u4e0d\u652f\u6301\u5728\u5355\u4e2a\u8fdb\u7a0b\u4e2d\u521b\u5efa\u591a\u4e2aVM\u3002</li> </ul> <p><code>JavaVMInitArgs</code>\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>typedef struct JavaVMInitArgs {\n    jint version;\n    jint nOptions;  // options \u6570\u7ec4\u7684\u5927\u5c0f\n    JavaVMOption *options;\n    jboolean ignoreUnrecognized; //\u4e3aJNI_TRUE\u65f6\uff0c\u5ffd\u7565\u6240\u6709\u4ee5\"-X\"\u6216\"_\"\u5f00\u5934\u7684\u672a\u8bc6\u522b\u9009\u9879\u5b57\u7b26\u4e32\n} JavaVMInitArgs;\n// options\u5b57\u6bb5\u662f\u4ee5\u4e0b\u7c7b\u578b\u7684\u6570\u7ec4\uff1a\ntypedef struct JavaVMOption {\n    char *optionString;  /* \u4ee5\u9ed8\u8ba4\u5e73\u53f0\u7f16\u7801\u7684\u5b57\u7b26\u4e32\u5f62\u5f0f\u8868\u793a\u7684\u9009\u9879 */\n    void *extraInfo;\n} JavaVMOption;\n</code></pre> <p>\u793a\u4f8b\u521b\u5efaJVM\uff1a</p> <pre><code>JavaVMInitArgs vm_args;\nJavaVMOption options[3];\n// \u521b\u5efaJVM\uff0c\u6d89\u53ca\u5230\u7b2c\u4e09\u65b9jar\u5305\u65f6\uff0c\u901a\u8fc7**\"-Djava.class.path=&lt;path_to_my_java_class&gt;\" \u6307\u5b9a\uff0c\u65e0\u8bbajar\u5305\u8fd8\u662fclass\u6587\u4ef6**\uff0c\u4e0d\u80fd\u662f\u76ee\u5f55\uff1b\noptions[0].optionString = \"-Djava.class.path=c:\\myclasses\"; /* \u7528\u6237\u7c7b */\noptions[1].optionString = \"-Djava.library.path=c:\\mylibs\";  /* \u8bbe\u7f6e\u672c\u5730\u5e93\u8def\u5f84 */\noptions[2].optionString = \"-verbose:jni\";                   /* \u6253\u5370JNI\u76f8\u5173\u6d88\u606f */\n\nvm_args.version = JNI_VERSION_1_2;\nvm_args.options = options;\nvm_args.nOptions = 3;\nvm_args.ignoreUnrecognized = TRUE;\n\n/* \u8bf7\u6ce8\u610f\uff0c\u5728JDK/JRE\u4e2d\uff0c\u4e0d\u518d\u9700\u8981\u8c03\u7528\n * JNI_GetDefaultJavaVMInitArgs\u3002\n */\nres = JNI_CreateJavaVM(&amp;vm, (void **)&amp;env, &amp;vm_args);\nif (res &lt; 0) ...\n</code></pre>"},{"location":"languages/java/native/jni.html#destroyjavavm","title":"DestroyJavaVM","text":"<p>\u4efb\u4f55\u7ebf\u7a0b\uff0c\u65e0\u8bba\u662f\u5426\u5df2\u9644\u52a0\uff0c\u90fd\u53ef\u4ee5\u8c03\u7528\u6b64\u51fd\u6570\u3002\u5982\u679c\u5f53\u524d\u7ebf\u7a0b\u672a\u9644\u52a0\uff0c\u5219\u9996\u5148\u5c06\u5176\u9644\u52a0\u3002\u5982\u679c\u5f53\u524d\u7ebf\u7a0b\u5df2\u9644\u52a0\uff0c\u5219\u5982\u679c\u5176\u8c03\u7528\u5806\u6808\u4e0a\u6709\u4efb\u4f55Java\u65b9\u6cd5\uff0c\u5219\u51fa\u73b0\u9519\u8bef\u3002\u89c1\u7ec8\u6b62\u865a\u62df\u673a\u3002</p>"},{"location":"languages/java/native/jni.html#attachcurrentthread","title":"AttachCurrentThread","text":"<pre><code>jint AttachCurrentThread(JavaVM *vm, void **p_env, void *thr_args);\n</code></pre> <p>\u5c06\u5f53\u524d\u7ebf\u7a0b\u9644\u52a0\u5230Java\u865a\u62df\u673a\u4f5c\u4e3a\u975e\u5b88\u62a4\u7ebf\u7a0b\u3002\u89c1\u9644\u52a0\u5230\u865a\u62df\u673a\u3002</p> <ul> <li>\u5df2\u7ecf\u9644\u52a0\u7684\u7ebf\u7a0b\u7684\u5b88\u62a4\u72b6\u6001\u901a\u8fc7\u8c03\u7528\u6b64\u65b9\u6cd5\u4e0d\u4f1a\u6539\u53d8\u3002</li> <li>\u5f53\u7ebf\u7a0b\u9644\u52a0\u5230VM\u65f6\uff0c\u4e0a\u4e0b\u6587\u7c7b\u52a0\u8f7d\u5668\u662f\u5f15\u5bfc\u52a0\u8f7d\u5668\u3002</li> </ul> <p><code>thr_args</code>\uff1a\u53ef\u4ee5\u4e3aNULL\u6216\u6307\u5411<code>JavaVMAttachArgs</code>\u7ed3\u6784\u7684\u6307\u9488\u4ee5\u6307\u5b9a\u9644\u52a0\u4fe1\u606f\uff1a</p> <pre><code>typedef struct JavaVMAttachArgs {\n    jint version;\n    char *name;    /* \u7ebf\u7a0b\u7684\u540d\u79f0\u4f5c\u4e3a\u4fee\u6539\u540e\u7684UTF-8\u5b57\u7b26\u4e32\uff0c\u6216\u4e3aNULL */\n    jobject group; /* ThreadGroup\u5bf9\u8c61\u7684\u5168\u5c40\u5f15\u7528\uff0c\u6216\u4e3aNULL */\n} JavaVMAttachArgs\n</code></pre>"},{"location":"languages/java/native/jni.html#attachcurrentthreadasdaemon","title":"AttachCurrentThreadAsDaemon","text":"<p>\u5c06\u5f53\u524d\u7ebf\u7a0b\u9644\u52a0\u5230Java\u865a\u62df\u673a\u4f5c\u4e3a\u5b88\u62a4\u7ebf\u7a0b\u3002</p> <ul> <li>\u5df2\u7ecf\u9644\u52a0\u7684\u7ebf\u7a0b\u7684\u5b88\u62a4\u72b6\u6001\u901a\u8fc7\u8c03\u7528\u6b64\u65b9\u6cd5\u4e0d\u4f1a\u6539\u53d8\u3002</li> <li>\u5f53\u7ebf\u7a0b\u9644\u52a0\u5230VM\u65f6\uff0c\u4e0a\u4e0b\u6587\u7c7b\u52a0\u8f7d\u5668\u662f\u5f15\u5bfc\u52a0\u8f7d\u5668\u3002</li> </ul>"},{"location":"languages/java/native/jni.html#detachcurrentthread","title":"DetachCurrentThread","text":"<p>\u5c06\u5f53\u524d\u7ebf\u7a0b\u4eceJava\u865a\u62df\u673a\u4e2d\u5206\u79bb\u3002\u5982\u679c\u8c03\u7528\u5806\u6808\u4e0a\u6709Java\u65b9\u6cd5\uff0c\u5219\u7ebf\u7a0b\u65e0\u6cd5\u5206\u79bb\u81ea\u8eab\u3002</p> <ul> <li>\u4e3b\u7ebf\u7a0b\u53ef\u4ee5\u4eceVM\u4e2d\u5206\u79bb\uff1b\u5c1d\u8bd5\u5206\u79bb\u672a\u9644\u52a0\u7684\u7ebf\u7a0b\u662f\u4e00\u4e2a\u7a7a\u64cd\u4f5c\u3002</li> <li>\u5f53\u5728\u4e00\u4e2a\u7ebf\u7a0b\u91cc\u9762\u8c03\u7528AttachCurrentThread\u540e\uff0c\u5982\u679c\u4e0d\u9700\u8981\u7528\u7684\u65f6\u5019\u4e00\u5b9a\u8981DetachCurrentThread\uff0c\u5426\u5219\u7ebf\u7a0b\u65e0\u6cd5\u6b63\u5e38\u9000\u51fa\u3002</li> </ul>"},{"location":"languages/java/native/jni.html#getenv","title":"GetEnv","text":"<pre><code>// \u5982\u679c\u5f53\u524d\u7ebf\u7a0b\u672a\u9644\u52a0\u5230VM\uff0c\u5219\u5c06*env\u8bbe\u7f6e\u4e3aNULL\uff0c\u5e76\u8fd4\u56deJNI_EDETACHED\u3002\u5982\u679c\u6307\u5b9a\u7684\u7248\u672c\u4e0d\u53d7\u652f\u6301\uff0c\u5219\u5c06*env\u8bbe\u7f6e\u4e3aNULL\uff0c\u5e76\u8fd4\u56deJNI_EVERSION\u3002\u5426\u5219\uff0c\u5c06*env\u8bbe\u7f6e\u4e3a\u9002\u5f53\u7684\u63a5\u53e3\uff0c\u5e76\u8fd4\u56deJNI_OK\u3002\njint GetEnv(JavaVM *vm, void **p_env, jint version);\n</code></pre>"},{"location":"languages/java/native/jni_demo.html","title":"JNI Demo","text":""},{"location":"languages/java/native/jni_demo.html#java-call-cc","title":"Java Call C/C++","text":"<p>\u4ee3\u7801\u5de5\u7a0b\u89c1 JNI \u793a\u4f8b</p> <ul> <li>\u6839\u636e java native \u65b9\u6cd5 \u751f\u6210 .h </li> </ul> <pre><code># JDK 10\u4ee5\u4e0b\njavah  -classpath .  -jni .\\src\\main\\java\\com\\xliu\\cs\\jvm\\jnative\\jni\\JNIDemo.java\n# JDK 10\u4e4b\u540e\uff0c\u751f\u6210 .h \u6587\u4ef6\u5728 c/ \u76ee\u5f55\u4e0b\njavac  -classpath . -encoding UTF-8 .\\src\\main\\java\\com\\xliu\\cs\\jvm\\jnative\\jni\\JNIDemo.java -h c\n</code></pre> <ul> <li>\u7f16\u8bd1\u65f6\u7684\u94fe\u63a5\u8def\u5f84</li> </ul> <pre><code># Linux\ngcc -shared -fPIC -D_REENTRANT -I${JAVA_HOME}/include/linux -I${JAVA_HOME}/include -I/home/test/jnidemo/ JNIDemo.c -o libJNIDemo.so\n</code></pre> <p>\u5173\u4e8eC\u4ee3\u7801\u4e2d\u7684jobject obj \u7684\u89e3\u91ca:</p> <ul> <li> <p>\u5982\u679cnative\u65b9\u6cd5\u4e0d\u662fstatic\u7684\u8bdd\uff0c\u8fd9\u4e2aobj\u5c31\u4ee3\u8868\u8fd9\u4e2anative\u65b9\u6cd5\u7684\u7c7b\u5b9e\u4f8b\uff1b</p> </li> <li> <p>\u5982\u679cnative\u65b9\u6cd5\u662fstatic\u7684\u8bdd\uff0c\u8fd9\u4e2aobj\u5c31\u4ee3\u8868\u8fd9\u4e2anative\u65b9\u6cd5\u7684\u7c7b\u7684class\u5bf9\u8c61\u5b9e\u4f8b(static\u65b9\u6cd5\u4e0d\u9700\u8981\u7c7b\u5b9e\u4f8b\u7684\uff0c\u6240\u4ee5\u5c31\u4ee3\u8868\u8fd9\u4e2a\u7c7b\u7684class\u5bf9\u8c61)\uff1b</p> </li> </ul>"},{"location":"languages/java/native/jni_demo.html#cc-call-java","title":"C/C++ Call Java","text":"<p>C\uff1a(*env)-&gt;FindClass(env, \"java/lang/String\")</p> <p>C++\uff1aenv-&gt;FindClass(\"java/lang/String\")</p> <ul> <li> <p>\u9700\u8981\u6307\u5b9ajni.h\u7684\u5934\u6587\u4ef6\u8def\u5f84\uff0c\u901a\u8fc7 <code>-I</code> \u9009\u9879\u52a0\u5728 gcc/g++ \u7f16\u8bd1\u65f6\uff1b</p> </li> <li> <p>\u901a\u8fc7<code>-Lpath -ljvm</code>\uff0c\u8fd0\u884c\u65f6\u8fd8\u9700\u8981\u52a0\u8f7d\u94fe\u63a5\u5e93\u8def\u5f84\uff1b</p> </li> <li> <p>\u5c06<code>$JAVA_HOME/jre/lib/amd64/server</code>\u8def\u5f84\u6dfb\u52a0\u5230PATH\uff08\u53ef\u4ee5\u641c\u7d22\u5230\u94fe\u63a5\u5e93\u7684\u5730\u5740\uff09</p> </li> </ul> <pre><code>#include&lt;jni.h&gt;\n#include &lt;stdio.h&gt;\n\n// \u521b\u5efa VM \u865a\u62df\u673a\nJNIEnv* create_vm(JavaVM** jvm, JNIEnv** env)\n{\n        JavaVMInitArgs args;\n        JavaVMOption options[1];\n        args.version = JNI_VERSION_1_6;\n        args.nOptions = 1;\n        options[0].optionString = \"-Djava.class.path=./\";\n        args.options = options;\n        args.ignoreUnrecognized = JNI_FALSE;\n        return JNI_CreateJavaVM(jvm, (void **)env, &amp;args);\n}\n\nchar* jstringtochar(JNIEnv *env, jstring jstr ) {\n  char* rtn = NULL;\n  jclass clsstring = env-&gt;FindClass(\"java/lang/String\");\n  jstring strencode = env-&gt;NewStringUTF(\"utf-8\");\n  jmethodID mid = env-&gt;GetMethodID(clsstring, \"getBytes\", \"(Ljava/lang/String;)[B\");\n  jbyteArray barr= (jbyteArray)env-&gt;CallObjectMethod(jstr, mid, strencode);\n  jsize alen = env-&gt;GetArrayLength(barr);\n  jbyte* ba = env-&gt;GetByteArrayElements(barr, JNI_FALSE);\n  if (alen &gt; 0) {\n    rtn = (char*)malloc(alen + 1);\n    memcpy(rtn, ba, alen);\n    rtn[alen] = 0;\n  }\n  env-&gt;ReleaseByteArrayElements(barr, ba, 0);\n  return rtn;\n}\n\nJNIEXPORT jintArray JNICALL Java_com_example_arrtoc_MainActivity_arrEncode\n  (JNIEnv *env, jobject obj, jintArray javaArr){\n  //\u83b7\u53d6Java\u6570\u7ec4\u957f\u5ea6\n  int lenght = (*env)-&gt;GetArrayLength(env,javaArr);\n\n  //\u6839\u636eJava\u6570\u7ec4\u521b\u5efaC\u6570\u7ec4\uff0c\u4e5f\u5c31\u662f\u628aJava\u6570\u7ec4\u8f6c\u6362\u6210C\u6570\u7ec4\n  //    jint*       (*GetIntArrayElements)(JNIEnv*, jintArray, jboolean*);\n  int* arrp =(*env)-&gt;GetIntArrayElements(env,javaArr,0);\n  //\u65b0\u5efa\u4e00\u4e2aJava\u6570\u7ec4\n  jintArray newArr = (*env)-&gt;NewIntArray(env,lenght);\n\n  //\u628a\u6570\u7ec4\u5143\u7d20\u503c\u52a010\u5904\u7406\n  int i;\n  for(i =0 ; i&lt;lenght;i++){\n      *(arrp+i) +=10;\n  }\n  //\u5c06C\u6570\u7ec4\u79cd\u7684\u5143\u7d20\u62f7\u8d1d\u5230Java\u6570\u7ec4\u4e2d\n  (*env)-&gt;SetIntArrayRegion(env,newArr,0,lenght,arrp);\n\n  return newArr;\n\n}\n\n\nint main(int argc, char **argv) {\n    JavaVM* jvm;\n    JNIEnv* env;\n\n    jclass cls;\n    int ret = 0;\n\n    jmethodID mid;\n\n    /* 1. create java virtual machine */\n    if(create_vm(&amp;jvm, &amp;env)) {\n        printf(\"can not create jvm\\n\");\n        return -1;\n    }\n\n    /* 2. get class */\n    cls = (*env)-&gt;FindClass(env, \"Hello\");\n    if(cls == NULL) {\n        printf(\"can not find hello class\\n\");\n        ret = -1;\n        goto destory;\n    }\n\n    /* 3. create object */\n\n    /* 4. call method\n     *  4.1 get method\n     *  4.2 create parameter\n     *  4.3 call method\n     */\n\n    mid = (*env)-&gt;GetStaticMethodID(env, cls, \"main\", \"([Ljava/lang/String;)V\");\n    if(mid == NULL) {\n        ret = -1;\n        printf(\"can not get method\\n\");\n        goto destory;\n    }\n\n    (*env)-&gt;CallStaticVoidMethod(env, cls, mid, NULL);\n\ndestory:\n    (*jvm)-&gt;DestroyJavaVM(jvm);\n\n    return ret;\n}\n</code></pre>"},{"location":"languages/java/native/jni_demo.html#_1","title":"\u6ce8\u610f","text":""},{"location":"languages/java/native/jni_demo.html#javacjava","title":"Java\u8c03\u7528C++\u518d\u8c03\u7528Java","text":"<p>\u5728java\u8c03\u7528C++\u4ee3\u7801\u65f6\u5728C++\u4ee3\u7801\u4e2d\u8c03\u7528\u4e86AttachCurrentThread\u65b9\u6cd5\u6765\u83b7\u53d6JNIEnv\uff0c\u6b64\u65f6JNIEnv\u5df2\u7ecf\u901a\u8fc7\u53c2\u6570\u4f20\u9012\u8fdb\u6765\uff0c\u4e0d\u9700\u8981\u518d\u6b21AttachCurrentThread\u6765\u83b7\u53d6\u3002\u5728\u91ca\u653e\u65f6\u5c31\u4f1a\u62a5\u9519\u3002 </p> <pre><code>void cpp2jni(int msg){\n    JNIEnv *env = NULL;\n    int status;\n    bool isAttached = false;\n    status = jvm-&gt;GetEnv((void**)&amp;env, JNI_VERSION_1_4);\n    if (status &lt; 0) {\n        // \u5c06\u5f53\u524d\u7ebf\u7a0b\u6ce8\u518c\u5230\u865a\u62df\u673a\u4e2d\n        if (jvm-&gt;AttachCurrentThread(&amp;env, NULL)) {\n            return;\n        }\n        isAttached = true;\n    }\n    //\u5b9e\u4f8b\u5316\u8be5\u7c7b\n    //\u5206\u914d\u65b0 Java \u5bf9\u8c61\u800c\u4e0d\u8c03\u7528\u8be5\u5bf9\u8c61\u7684\u4efb\u4f55\u6784\u9020\u51fd\u6570\u3002\u8fd4\u56de\u8be5\u5bf9\u8c61\u7684\u5f15\u7528\u3002\n    jobject jobject = env-&gt;AllocObject(global_class);\n    //\u8c03\u7528Java\u65b9\u6cd5\n    (env)-&gt;CallVoidMethod(jobject, mid_method,msg);\n\n    if (isAttached) {\n        jvm-&gt;DetachCurrentThread();\n    }\n}\n</code></pre>"},{"location":"languages/java/native/jni_demo.html#javac","title":"Java\u8c03\u7528C++\u65f6\u7684\u5f02\u5e38\u5904\u7406","text":"<p>\u6d4b\u8bd5\u573a\u666f\uff1aJava\u4f7f\u7528\u7ebf\u7a0b\u6c60\uff0c\u542f\u52a810\u4e2a\u7ebf\u7a0b\uff0c\u5176\u4e2d\u4e00\u4e2a\u7ebf\u7a0b\u901a\u8fc7JNI\u8c03\u7528c++\u7a0b\u5e8f\uff1a</p> <ul> <li>\u5982\u679cc++\u4e2d\u6ca1\u6709\u5904\u7406\u5f02\u5e38\uff0c\u90a3\u4e48\u4f1a\u5bfc\u81f4jvm\u7684\u5d29\u6e83\uff1b</li> <li>\u5982\u679cc++\u4e2d\u6b63\u786e\u5904\u7406\u4e86\u5f02\u5e38\uff0c\u5219jvm\u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c\uff1b</li> <li>c++\u4e2d\u5982\u679c\u4e0d\u662f\u5f02\u5e38\u7684\u9519\u8bef\uff0c\u5982\u6570\u7ec4\u8d8a\u754c\uff0c\u5219\u65e0\u6cd5try-catch\u6355\u83b7\uff0cJVM\u4f1a\u5d29\u6e83\u3002</li> </ul>"},{"location":"languages/java/native/jnr.html","title":"JNR-FFI","text":""},{"location":"languages/java/native/jnr.html#_1","title":"\u7c7b\u578b\u8f6c\u6362","text":""},{"location":"languages/java/native/jnr.html#_2","title":"\u57fa\u672c\u7c7b\u578b","text":"<p>\u5c06 C \u7684\u7c7b\u578b\u548cJava\u7c7b\u578b\u81ea\u52a8\u8f6c\u6362\u3002</p> C Type Java Type Size <code>char</code> <code>byte</code> 8 bit integer <code>short</code> <code>short</code> 16 bit integer <code>int</code> <code>int</code> 32 bit integer <code>long</code> <code>long</code> natural long, 32 bits on 32 bit systems, 64 bits on 64 bit systems <code>float</code> <code>float</code> 32 bit floating point <code>double</code> <code>double</code> 64 bit floating point <code>const char *</code> <code>String</code> or <code>Pointer</code> <code>void *</code> <code>Pointer</code> or <code>Buffer</code> int * IntByReference \u5176\u4ed6float*\u6709\u7c7b\u4f3c\u7684\u7c7b void ** PointerByReference C enum Mostly <code>int</code>"},{"location":"languages/java/native/jnr.html#union","title":"\u7ed3\u6784\u4f53/Union","text":"<p><code>c</code></p> <pre><code>struct timespec {\n    time_t tv_sec;\n    long int tv_nsec;\n};\n</code></pre> <p><code>Java</code></p> <pre><code>// Union\u7c7b\u4f3c\uff0c\u96c6\u6210Union\u7c7b\u5373\u53ef\npublic class Timespec extends Struct {\n    // \u7ed3\u6784\u4f53\u4f7f\u7528\u81ea\u5df1\u7684\u57fa\u672c\u7c7b\u578b\n    // Struct types can be found as inner classes of the Struct class\n    public Struct.SignedLong tv_sec = new Struct.SignedLong();\n    public Struct.SignedLong tv_nsec = new Struct.SignedLong();\n\n    // Necessary constructor that takes a Runtime\n    public Timespec(jnr.ffi.Runtime runtime) {\n        super(runtime);\n    }\n\n    // You can add your own methods of choice\n    public void setTime(long sec, long nsec) {\n        tv_sec.set(sec);\n        tv_nsec.set(nsec);\n    }\n}\n</code></pre>"},{"location":"languages/java/native/jnr.html#_3","title":"\u679a\u4e3e","text":"<p>c \u679a\u4e3e\u5b9a\u4e49\uff1a</p> <pre><code>enum fuse_buf_flags {\n    FUSE_BUF_IS_FD    = (1 &lt;&lt; 1),\n    FUSE_BUF_FD_SEEK    = (1 &lt;&lt; 2),\n    FUSE_BUF_FD_RETRY    = (1 &lt;&lt; 3),\n};\n</code></pre> <p>Java\u5bf9\u5e94\u5b9a\u4e49\uff08\u53ef\u4ee5\u81ea\u52a8\u8f6c\u6362\uff09</p> <pre><code>public enum FuseBufFlags implements EnumMapper.IntegerEnum {\n    FUSE_BUF_IS_FD(1 &lt;&lt; 1),\n    FUSE_BUF_FD_SEEK(1 &lt;&lt; 2),\n    FUSE_BUF_FD_RETRY(1 &lt;&lt; 3);\n\n    private final int value;\n\n    FuseBufFlags(int value) {\n        this.value = value;\n    }\n\n    @Override\n    public int intValue() {\n        return value;\n    }\n}\n</code></pre>"},{"location":"languages/java/native/jnr.html#_4","title":"\u51fd\u6570\u7c7b\u578b","text":"<pre><code>typedef int MyCallback(void *data);\n\nint setCallback(MyCallback *callback);\n</code></pre> <p>Java\u5bf9\u5e94\u8c03\u7528\u7684\u5199\u6cd5\uff1a</p> <pre><code>public interface ExampleLibrary {\n    public interface MyCallback { // type representing callback\n        @Delegate\n        int invoke(Pointer data); // function name doesn't matter, it just needs to be the only function and have @Delegate\n    }\n\n    int setCallback(MyCallback callback);\n\n}\n</code></pre> <p>Function pointer is valid as long as the instance stays strongly-referenced. </p> <pre><code>ObjectReferenceManager referenceManager = Runtime.getRuntime(lib).newObjectReferenceManager();\nMyCallback callback = data -&gt; 0;\nPointer key = referenceManager.add(callback);\n\nlib.setCallback(callback);     // Callback is passed internally as a function pointer \n\nreferenceManager.remove(key);  // Free the callback when no more required\n</code></pre>"},{"location":"languages/java/native/jnr.html#_5","title":"\u5185\u5b58\u7ba1\u7406","text":""},{"location":"languages/java/native/jnr.html#pointers","title":"Pointers","text":"<p>native memory \u5730\u5740\u7684\u5f15\u7528\uff1b</p>"},{"location":"languages/java/native/jnr.html#_6","title":"\u793a\u4f8b","text":"<p>maven\u4f9d\u8d56</p> <pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;com.github.jnr&lt;/groupId&gt;\n  &lt;artifactId&gt;jnr-ffi&lt;/artifactId&gt;\n  &lt;version&gt;2.2.12&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u793a\u4f8b\u4ee3\u7801\uff1a</p> <pre><code>import jnr.ffi.*;\nimport jnr.ffi.types.pid_t;\n\n/**\n * Gets the process ID of the current process, and that of its parent.\n */\npublic class Getpid {\n    public interface LibC  {\n        // \u8ddflibc.so\u7684getpid\u7684\u672c\u5730\u65b9\u6cd5\u5339\u914d\n        public @pid_t long getpid();\n        public @pid_t long getppid();\n    }\n\n    public static void main(String[] args) {\n        // load libc.so\n        LibC libc = LibraryLoader.create(LibC.class).load(\"c\");\n\n        System.out.println(\"pid=\" + libc.getpid() + \" parent pid=\" + libc.getppid());\n    }\n}\n</code></pre>"},{"location":"languages/java/performance/analysis.html","title":"\u5e38\u89c1\u95ee\u9898\u5206\u6790","text":""},{"location":"languages/java/performance/analysis.html#cpu","title":"CPU","text":""},{"location":"languages/java/performance/analysis.html#cpu_1","title":"\u67e5\u8be2\u5360\u7528cpu\u9ad8\u7684\u7ebf\u7a0b","text":"<ul> <li><code>top</code> \u67e5\u770b\u5360\u7528\u6bd4\u8f83\u9ad8\u7684\u8fdb\u7a0b\uff0c\u518d<code>top -H -p pid</code>\u6765\u627e\u5230cpu\u4f7f\u7528\u7387\u6bd4\u8f83\u9ad8\u7684\u4e00\u4e9b\u7ebf\u7a0b\uff1b</li> <li><code>printf '%x\\n' pid</code>\u5f97\u5230 nid\uff0c<code>jstack pid |grep 'nid' -C5 \u2013color</code>\u67e5\u770b\u5bf9\u5e94\u5806\u6808\u4fe1\u606f\uff1b</li> </ul>"},{"location":"languages/java/performance/analysis.html#gc","title":"\u9891\u7e41gc","text":"<p><code>jstat -gc pid 1000</code>\u547d\u4ee4\u6765\u5bf9gc\u5206\u4ee3\u53d8\u5316\u60c5\u51b5\u8fdb\u884c\u89c2\u5bdf</p> <ul> <li>1000\u8868\u793a\u91c7\u6837\u95f4\u9694(ms)\uff1b</li> <li><code>S0C/S1C\u3001S0U/S1U\u3001EC/EU\u3001OC/OU\u3001MC/MU</code>\u5206\u522b\u4ee3\u8868\u4e24\u4e2aSurvivor\u533a\u3001Eden\u533a\u3001\u8001\u5e74\u4ee3\u3001\u5143\u6570\u636e\u533a\u7684\u5bb9\u91cf\u548c\u4f7f\u7528\u91cf\uff1b</li> <li><code>YGC/YGT\u3001FGC/FGCT\u3001GCT\u5219\u4ee3\u8868YoungGc\u3001FullGc</code>\u7684\u8017\u65f6\u548c\u6b21\u6570\u4ee5\u53ca\u603b\u8017\u65f6\u3002</li> </ul>"},{"location":"languages/java/performance/analysis.html#_2","title":"\u4e0a\u4e0b\u6587\u5207\u6362","text":"<p><code>vmstat [sample_interval] [sample_nums]</code>\u547d\u4ee4\uff1a\u5c55\u73b0\u7ed9\u5b9a\u65f6\u95f4\u95f4\u9694\u7684\u670d\u52a1\u5668\u7684\u72b6\u6001\u503c,\u5305\u62ec\u670d\u52a1\u5668\u7684CPU\u4f7f\u7528\u7387\uff0c\u5185\u5b58\u4f7f\u7528\uff0c\u865a\u62df\u5185\u5b58\u4ea4\u6362\u60c5\u51b5,IO\u8bfb\u5199\u60c5\u51b5\u3002</p> <ul> <li>system\uff1a</li> <li>cs\uff08context switch\uff09\u4e00\u5217\u5219\u4ee3\u8868\u4e86\u4e0a\u4e0b\u6587\u5207\u6362\u7684\u6b21\u6570</li> <li>in\uff08interrupt\uff09\u6bcf\u79d2\u4e2d\u65ad\u6570\uff0c\u5305\u62ec\u65f6\u949f\u4e2d\u65ad</li> </ul> <p></p> <p><code>pidstat -p pid -w [interval] [samples]</code>\u5bf9\u7279\u5b9a\u7684pid\u8fdb\u884c\u76d1\u63a7</p> <p></p>"},{"location":"languages/java/performance/analysis.html#_3","title":"\u78c1\u76d8","text":"<p><code>df -hl</code>\u6765\u67e5\u770b\u6587\u4ef6\u7cfb\u7edf\u72b6\u6001\uff0c\u6bcf\u4e2a\u76d8\u7684\u603b\u91cf\u548c\u4f7f\u7528\u91cf\u7b49\u4fe1\u606f\u3002</p> <p><code>iostat -d -k -x</code>\u6765\u8fdb\u884c\u5206\u6790</p> <ul> <li>\u6700\u540e\u4e00\u5217<code>%util</code>\u53ef\u4ee5\u770b\u5230\u6bcf\u5757\u78c1\u76d8\u5199\u5165\u7684\u7a0b\u5ea6\uff0c\u800c<code>rrqpm/s</code>\u4ee5\u53ca<code>wrqm/s</code>\u5206\u522b\u8868\u793a\u8bfb\u5199\u901f\u5ea6</li> </ul> <p></p> <p><code>iotop</code>\u547d\u4ee4\u6765\u8fdb\u884c\u5b9a\u4f4d\u6587\u4ef6\u8bfb\u5199\u7684\u6765\u6e90\uff1a</p> <ul> <li> <p><code>iotop</code>\u547d\u4ee4\u62ff\u5230\u7684\u662ftid\uff0c\u901a\u8fc7<code>readlink -f /proc/*/task/$tid/../..</code> \u67e5\u770btid\u5bf9\u5e94\u7684pid\uff1b</p> </li> <li> <p><code>iotop -botq -p $pid</code> \u67e5\u770b\u5177\u4f53\u7684\u8fdb\u7a0b\u7684io\u8bfb\u5199\uff1b</p> </li> </ul> <p><code>lsof</code>\u547d\u4ee4\u6765\u786e\u5b9a\u5177\u4f53\u7684\u6587\u4ef6\u8bfb\u5199\u60c5\u51b5<code>lsof -p pid</code></p>"},{"location":"languages/java/performance/arthas.html","title":"Arthas","text":"<p>\u6765\u6e90\u4e8e\uff1ahttps://arthas.aliyun.com/doc/advanced-use.html</p> <p>Arthas\uff1aJava\u7a0b\u5e8f\u8bca\u65ad\u5229\u5668\uff0cArthas\u4e0d\u80fd\u8ddf\u8e2a native \u51fd\u6570\u3002</p>"},{"location":"languages/java/performance/arthas.html#_1","title":"\u5b89\u88c5","text":"<p>\u4e0b\u8f7d\u5e76\u6267\u884c\uff1a</p> <pre><code>curl -O https://arthas.aliyun.com/arthas-boot.jar\n# \u6267\u884c\u8be5\u7a0b\u5e8f\u7684\u7528\u6237\u9700\u8981\u548c\u76ee\u6807\u8fdb\u7a0b\u5177\u6709\u76f8\u540c\u7684\u6743\u9650\n# \u65e5\u5fd7\u5728~/logs/arthtas \u76ee\u5f55\u4e0b\u9762\njava -jar arthas-boot.jar\n</code></pre> <p>\u7b2c\u4e00\u6b21\u6267\u884c\u65f6\uff0c\u4f1a\u4e0b\u8f7darthas\u76f8\u5173\u5305\uff08https://github.com/alibaba/arthas/releases/download/arthas-all-3.5.0/arthas-bin.zip\uff09\uff0c\u5b58\u50a8\u7684\u9ed8\u8ba4\u8def\u5f84\u5728<code>.arthas/lib/3.5.0/arthas</code>\u4e0b\uff1a</p> <pre><code>-rw-rw-r--. 1 lzq lzq 12817295 May  8 17:47 arthas-3.5.0-bin.zip\n-rw-r--r--. 1 lzq lzq     8450 Sep 27  2020 arthas-agent.jar\n-rw-r--r--. 1 lzq lzq   140961 Sep 27  2020 arthas-boot.jar\n-rw-r--r--. 1 lzq lzq   430306 Sep 27  2020 arthas-client.jar\n-rw-r--r--. 1 lzq lzq 13129766 Sep 27  2020 arthas-core.jar\n-rw-r--r--. 1 lzq lzq     4497 Sep 27  2020 arthas-demo.jar\n-rw-r--r--. 1 lzq lzq      402 Sep 27  2020 arthas.properties\n-rw-r--r--. 1 lzq lzq     8903 Sep 27  2020 arthas-spy.jar\n-rwxr-xr-x. 1 lzq lzq     3091 Sep 27  2020 as.bat\n-rwxr-xr-x. 1 lzq lzq     7744 Sep 27  2020 as-service.bat\n-rwxr-xr-x. 1 lzq lzq    32805 Sep 27  2020 as.sh\ndrwxr-xr-x. 2 lzq lzq     4096 Sep 27  2020 async-profiler\n-rwxr-xr-x. 1 lzq lzq      635 Sep 27  2020 install-local.sh\n-rw-r--r--. 1 lzq lzq     2020 Sep 27  2020 logback.xml\n</code></pre>"},{"location":"languages/java/performance/arthas.html#console","title":"\u547d\u4ee4\u884c\u4f7f\u7528\uff08Console\uff09","text":""},{"location":"languages/java/performance/arthas.html#_2","title":"\u8fde\u63a5","text":"<p><code>java -jar arthas-boot.jar</code>\uff0c\u9009\u62e9<code>attach</code>\u7684Java\u8fdb\u7a0b\uff0c\u4f1a\u8fdb\u5165arthas\u7684\u7ec8\u7aef\u3002</p>"},{"location":"languages/java/performance/arthas.html#_3","title":"\u57fa\u7840\u547d\u4ee4","text":""},{"location":"languages/java/performance/arthas.html#echo","title":"echo\uff08\u6253\u5370\u53c2\u6570\uff09","text":"<p>\u548clinux\u91cc\u7684echo\u547d\u4ee4\u7c7b\u4f3c</p> <pre><code>$ echo 'hello'\n</code></pre>"},{"location":"languages/java/performance/arthas.html#cat","title":"cat\uff08\u6253\u5370\u6587\u4ef6\u5185\u5bb9\uff09","text":"<p>\u548clinux\u91cc\u7684cat\u547d\u4ee4\u7c7b\u4f3c</p> <pre><code>$ cat /tmp/a.txt\n</code></pre>"},{"location":"languages/java/performance/arthas.html#grep","title":"grep\uff08\u5339\u914d\u67e5\u627e\uff09","text":"<p>\u7c7b\u4f3c\u4f20\u7edf\u7684<code>grep</code>\u547d\u4ee4</p> <pre><code># thread | grep -m 10 -e  \"TIMED_WAITING|WAITING\"\n$ grep [-A &lt;value&gt;] [-B &lt;value&gt;] [-C &lt;value&gt;] [-h] [-i] [-v] [-n] [-m &lt;value&gt;] [-e] [--trim-end] pattern\n</code></pre>"},{"location":"languages/java/performance/arthas.html#base64base64","title":"base64\uff08base64\u7f16\u7801\u8f6c\u6362\uff09","text":"<p>\u548clinux\u91cc\u7684 base64 \u547d\u4ee4\u7c7b\u4f3c</p> <pre><code># \u5bf9\u6587\u4ef6\u8fdb\u884c base64 \u7f16\u7801\n$ base64 --input /tmp/test.txt --output /tmp/result.txt\n# \u5bf9\u6587\u4ef6\u8fdb\u884c base64 \u89e3\u7801\n$ base64 -d /tmp/result.txt --output /tmp/bbb.txt\n</code></pre>"},{"location":"languages/java/performance/arthas.html#tee","title":"tee\uff08\u590d\u5236\u6807\u51c6\u8f93\u5165\u5230\u6807\u51c6\u8f93\u51fa\u548c\u6307\u5b9a\u7684\u6587\u4ef6\uff09","text":"<p>tee\u6307\u4ee4\u4f1a\u4ece\u6807\u51c6\u8f93\u5165\u8bbe\u5907\u8bfb\u53d6\u6570\u636e\uff0c\u5c06\u5176\u5185\u5bb9\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\u8bbe\u5907\uff0c\u540c\u65f6\u4fdd\u5b58\u6210\u6587\u4ef6\u3002</p> <pre><code># sysprop | tee -a /path/to/logfile | grep java\n$ tee [-a] [-h] [file]\n</code></pre>"},{"location":"languages/java/performance/arthas.html#pwd","title":"pwd\uff08\u8fd4\u56de\u5f53\u524d\u7684\u5de5\u4f5c\u76ee\u5f55\uff09","text":"<p>\u548clinux\u547d\u4ee4pwd\u7c7b\u4f3c</p> <pre><code>$ pwd\n</code></pre>"},{"location":"languages/java/performance/arthas.html#cls","title":"cls\uff08\u6e05\u7a7a\u5f53\u524d\u5c4f\u5e55\u533a\u57df\uff09","text":"<pre><code>$ cls\n</code></pre>"},{"location":"languages/java/performance/arthas.html#session","title":"session\uff08\u67e5\u770b\u5f53\u524d\u4f1a\u8bdd\u7684\u4fe1\u606f\uff09","text":"<pre><code>$ session\n</code></pre>"},{"location":"languages/java/performance/arthas.html#reset","title":"reset\uff08\u91cd\u7f6e\u589e\u5f3a\u7c7b\uff09","text":"<p>\u91cd\u7f6e\u589e\u5f3a\u7c7b\uff0c\u5c06\u88ab Arthas \u589e\u5f3a\u8fc7\u7684\u7c7b\u5168\u90e8\u8fd8\u539f\uff0cArthas \u670d\u52a1\u7aef\u5173\u95ed\u65f6\u4f1a\u91cd\u7f6e\u6240\u6709\u589e\u5f3a\u8fc7\u7684\u7c7b</p> <pre><code># rest\n# rest Test\n# reset -E .*List\n$ reset [-E] [class-pattern]\n</code></pre>"},{"location":"languages/java/performance/arthas.html#versionarthas","title":"version\uff08Arthas\u7248\u672c\uff09","text":"<p>\u8f93\u51fa\u5f53\u524d\u76ee\u6807 Java \u8fdb\u7a0b\u6240\u52a0\u8f7d\u7684 Arthas \u7248\u672c\u53f7\u3002</p>"},{"location":"languages/java/performance/arthas.html#history","title":"history\uff08\u6253\u5370\u547d\u4ee4\u5386\u53f2\uff09","text":"<p>\u6253\u5370\u547d\u4ee4\u5386\u53f2\u3002</p>"},{"location":"languages/java/performance/arthas.html#quit-arthas-arthas","title":"quit\uff08\u9000\u51fa\u5f53\u524d Arthas \u5ba2\u6237\u7aef\uff0c\u5176\u4ed6 Arthas \u5ba2\u6237\u7aef\u4e0d\u53d7\u5f71\u54cd\uff09","text":"<p>\u9000\u51fa\u5f53\u524d\u7684\u8fde\u63a5\uff0c\u53ef\u4ee5\u7528<code>quit</code>\u6216\u8005<code>exit</code>\u547d\u4ee4\u3002Attach\u5230\u76ee\u6807\u8fdb\u7a0b\u4e0a\u7684arthas\u8fd8\u4f1a\u7ee7\u7eed\u8fd0\u884c\uff0c\u7aef\u53e3\u4f1a\u4fdd\u6301\u5f00\u653e\uff0c\u4e0b\u6b21\u8fde\u63a5\u65f6\u53ef\u4ee5\u76f4\u63a5\u8fde\u63a5\u4e0a\u3002</p>"},{"location":"languages/java/performance/arthas.html#stop-arthas-arthas","title":"stop\uff08\u5173\u95ed Arthas \u670d\u52a1\u7aef\uff0c\u6240\u6709 Arthas \u5ba2\u6237\u7aef\u5168\u90e8\u9000\u51fa\uff09","text":"<p>\u5b8c\u5168\u9000\u51faarthas\uff0c\u53ef\u4ee5\u6267\u884c<code>stop</code>\u547d\u4ee4\u3002</p>"},{"location":"languages/java/performance/arthas.html#keymaparthas","title":"keymap\uff08Arthas\u5feb\u6377\u952e\uff09","text":"<p>\u89c1\u94fe\u63a5\uff1akeymap</p>"},{"location":"languages/java/performance/arthas.html#jvm","title":"JVM\u76f8\u5173","text":""},{"location":"languages/java/performance/arthas.html#dashboard","title":"dashboard\uff08\u7cfb\u7edf\u7684\u5b9e\u65f6\u6570\u636e\u9762\u677f\uff09","text":"<p><code>dashboard</code>\u547d\u4ee4\uff0c\u5f53\u524d\u7cfb\u7edf\u7684\u5b9e\u65f6\u6570\u636e\u9762\u677f\uff0c\u67e5\u770b\u8fdb\u7a0b\u7684\u76f8\u5173\u4fe1\u606f\uff08\u5305\u62ec\u7ebf\u7a0b\u4fe1\u606f\uff0c\u5185\u5b58\u4fe1\u606f\u548c\u914d\u7f6e\u4fe1\u606f\uff09</p> <ul> <li>ID\uff1aJava\u7ea7\u522b\u7684\u7ebf\u7a0bID\uff0c\u6ce8\u610f\u8fd9\u4e2aID\u4e0d\u80fd\u8ddf<code>jstack\u4e2d</code>\u7684nativeID\u4e00\u4e00\u5bf9\u5e94\u3002</li> <li>JVM\u5185\u90e8\u7ebf\u7a0b\uff0cID\u663e\u793a\u4e3a-1\uff0c\u53ef\u4ee5\u89c2\u6d4bJVM\u7684GC\u3001JIT\u7f16\u8bd1\u7b49\u5360\u7528CPU\u7684\u4e8b\u4ef6\uff1b</li> </ul> <p></p>"},{"location":"languages/java/performance/arthas.html#thread-jvm","title":"thread\uff08 JVM \u7684\u7ebf\u7a0b\u5806\u6808\uff09","text":"<p>\u67e5\u770b\u5f53\u524d\u7ebf\u7a0b\u4fe1\u606f\uff0c\u67e5\u770b\u7ebf\u7a0b\u7684\u5806\u6808\u3002</p> <ul> <li><code>thread -i</code>, \u6307\u5b9a\u91c7\u6837\u65f6\u95f4\u95f4\u9694\uff1b</li> <li><code>thread -b</code>, \u627e\u51fa\u5f53\u524d\u963b\u585e\u5176\u4ed6\u7ebf\u7a0b\u7684\u7ebf\u7a0b\uff1b</li> <li>\u76ee\u524d\u53ea\u652f\u6301\u627e\u51fasynchronized\u5173\u952e\u5b57\u963b\u585e\u4f4f\u7684\u7ebf\u7a0b</li> </ul>"},{"location":"languages/java/performance/arthas.html#jvmjvm","title":"jvm\uff08JVM\u4fe1\u606f\uff09","text":"<ul> <li><code>COUNT</code>: JVM\u5f53\u524d\u6d3b\u8dc3\u7684\u7ebf\u7a0b\u6570</li> <li><code>DAEMON-COUNT</code>: JVM\u5f53\u524d\u6d3b\u8dc3\u7684\u5b88\u62a4\u7ebf\u7a0b\u6570</li> <li><code>PEAK-COUNT</code>: \u4eceJVM\u542f\u52a8\u5f00\u59cb\u66fe\u7ecf\u6d3b\u7740\u7684\u6700\u5927\u7ebf\u7a0b\u6570</li> <li><code>STARTED-COUNT</code>: \u4eceJVM\u542f\u52a8\u5f00\u59cb\u603b\u5171\u542f\u52a8\u8fc7\u7684\u7ebf\u7a0b\u6b21\u6570</li> <li> <p><code>DEADLOCK-COUNT</code>: JVM\u5f53\u524d\u6b7b\u9501\u7684\u7ebf\u7a0b\u6570</p> </li> <li> <p><code>MAX-FILE-DESCRIPTOR-COUNT</code>\uff1aJVM\u8fdb\u7a0b\u6700\u5927\u53ef\u4ee5\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570</p> </li> <li><code>OPEN-FILE-DESCRIPTOR-COUNT</code>\uff1aJVM\u5f53\u524d\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570</li> </ul>"},{"location":"languages/java/performance/arthas.html#syspropjvm","title":"sysprop\uff08JVM\u7684\u7cfb\u7edf\u5c5e\u6027\uff09","text":"<p>\u67e5\u770b\u6216\u8bbe\u7f6eJVM\u7cfb\u7edf\u5c5e\u6027</p> <pre><code>$ sysprop [property-name] [property-value]\n</code></pre>"},{"location":"languages/java/performance/arthas.html#sysenvjvm","title":"sysenv\uff08JVM\u7684\u73af\u5883\u53d8\u91cf\uff09","text":"<p>\u67e5\u770b\u5f53\u524dJVM\u7684\u73af\u5883\u5c5e\u6027\uff0c\u4e0d\u80fd\u4fee\u6539\u3002</p>"},{"location":"languages/java/performance/arthas.html#vmoptionjvm","title":"vmoption\uff08JVM\u53c2\u6570\uff09","text":"<p>\u67e5\u770b\uff0c\u66f4\u65b0JVM\u8bca\u65ad\u76f8\u5173\u7684\u53c2\u6570\uff0c\u6bd4\u5982\uff1a</p> <ul> <li>PrintGC \u3001PrintGCDetails\u7b49\uff1b</li> </ul>"},{"location":"languages/java/performance/arthas.html#perfcounterjvm-perf-counter","title":"perfcounter\uff08JVM\u7684 Perf Counter\u4fe1\u606f\uff09","text":"<pre><code>$ perfcounter -d\n Name                                   Variability   Units        Value\n---------------------------------------------------------------------------------\n java.ci.totalTime                      Monotonic     Ticks        3242526906\n java.cls.loadedClasses                 Monotonic     Events       3404\n java.cls.sharedLoadedClasses           Monotonic     Events       0\n java.cls.sharedUnloadedClasses         Monotonic     Events       0\n java.cls.unloadedClasses               Monotonic     Events       0\n</code></pre>"},{"location":"languages/java/performance/arthas.html#logger","title":"logger\uff08\u65e5\u5fd7\uff09","text":"<p>\u67e5\u770blogger\u4fe1\u606f\uff0c\u66f4\u65b0logger level\u3002</p> <pre><code># \u67e5\u770blogger\u4fe1\u606f\uff0c\u5305\u62eclevel\u3001appenders\u7b49\n$ logger --include-no-appender\n# \u67e5\u770b\u6307\u5b9a\u7c7b\u52a0\u8f7d\u5668\u4e0b\u7684\u6307\u5b9a\u7c7b\u540d\u7684logger\u4fe1\u606f\n$ logger -c &lt;hashcode&gt; -n org.springframework.web\n# \u66f4\u65b0logger level\n$ logger -c 2a139a55 --name ROOT --level debug\n</code></pre>"},{"location":"languages/java/performance/arthas.html#getstatic","title":"getstatic","text":"<p>\u63a8\u8350\u76f4\u63a5\u4f7f\u7528<code>ognl</code>\u547d\u4ee4\uff0c\u66f4\u52a0\u7075\u6d3b</p>"},{"location":"languages/java/performance/arthas.html#ognl","title":"ognl","text":"<p>\u6267\u884cognl\u8868\u8fbe\u5f0f</p> <ul> <li> <p>\u6536\u96c6Arthas\u91cc\u7684\u4e00\u4e9b\u7279\u6b8a\u7528\u6cd5\uff1ahttps://github.com/alibaba/arthas/issues/71</p> </li> <li> <p>OGNL\u8868\u8fbe\u5f0f\u5b98\u65b9\u6307\u5357\uff1ahttps://commons.apache.org/proper/commons-ognl/language-guide.html</p> </li> </ul> <pre><code>$ ognl '@java.lang.System@out.println(\"hello\")'\n\n# \u7c7bdemo.MathGame\u7684random\u9759\u6001\u5b57\u6bb5\n$ ognl '@demo.MathGame@random'\n\n# -c \u8868\u793a\u7528hashcode \u5b9a\u4f4d ClassLoader\uff0c \u9ed8\u8ba4\u4e0d\u6307\u5b9a\u8be5\u914d\u7f6e\u65f6\u91c7\u7528 SystemClassLoader\n$ ognl -c 7f9a81e8 @org.springframework.boot.SpringApplication@logger\n\n# \u6267\u884c\u591a\u884c\u8868\u8fbe\u5f0f\uff0c\u8d4b\u503c\u7ed9\u4e34\u65f6\u53d8\u91cf\uff0c\u8fd4\u56de\u4e00\u4e2aList\n$ ognl '#value1=@System@getProperty(\"java.home\"), #value2=@System@getProperty(\"java.runtime.name\"), {#value1, #value2}'\n</code></pre>"},{"location":"languages/java/performance/arthas.html#mbean","title":"mbean","text":"<p>\u67e5\u770b\u6216\u76d1\u63a7 Mbean \u7684\u5c5e\u6027\u4fe1\u606f</p> <pre><code># \u67e5\u770b Mbean \u7684\u5143\u4fe1\u606f\n$ mbean -m java.lang:type=Threading\n# \u67e5\u770bmbean\u5c5e\u6027\u4fe1\u606f\n$ mbean java.lang:type=Threading \n# \u5b9e\u65f6\u76d1\u63a7\n$ mbean -i 1000 java.lang:type=Threading *Count\n# \u6b63\u5219\u5339\u914d\n$ mbean -E java.lang:type=Threading PeakThreadCount|ThreadCount|DaemonThreadCount\n</code></pre>"},{"location":"languages/java/performance/arthas.html#heapdump","title":"heapdump","text":"<p>dump java heap, \u7c7b\u4f3cjmap\u547d\u4ee4\u7684heap dump\u529f\u80fd\u3002</p> <pre><code># \u53eadump live\u5bf9\u8c61\n$ heapdump --live /tmp/dump.hprof\n# dump\u5230\u6307\u5b9a\u6587\u4ef6\n$ heapdump /tmp/dump.hprof\n</code></pre>"},{"location":"languages/java/performance/arthas.html#vmtool","title":"vmtool","text":"<p><code>vmtool</code> \u5229\u7528<code>JVMTI</code>\u63a5\u53e3\uff0c\u5b9e\u73b0\u67e5\u8be2\u5185\u5b58\u5bf9\u8c61\uff0c\u5f3a\u5236GC\u7b49\u529f\u80fd\u3002</p> <pre><code># \u5f3a\u5236GC\n$ vmtool --action forceGc\n# \u83b7\u53d6\u5bf9\u8c61\uff0c-x \u6307\u5b9a\u7ed3\u679c\u7684\u5c55\u5f00\u5f62\u5f0f\uff08\u9ed8\u8ba41\uff09\n$ vmtool --action getInstances --className java.lang.String --limit 10 -x 2\n# \u6307\u5b9aClassLoader\u83b7\u53d6\u5bf9\u5e94\u5bf9\u8c61\uff0c\u6216\u8005\u53ef\u4ee5\u901a\u8fc7 -c 19469ea2 \u6307\u5b9aClassLoader\n$ vmtool --action getInstances --classLoaderClass org.springframework.boot.loader.LaunchedURLClassLoader --className org.springframework.context.ApplicationContext\n# \u83b7\u53d6bean\u5e76\u8c03\u7528\u51fd\u6570, getInstances action\u8fd4\u56de\u7ed3\u679c\u7ed1\u5b9a\u5230instances\u53d8\u91cf\u4e0a\uff0c\u5b83\u662f\u6570\u7ec4\u3002\u53ef\u4ee5\u901a\u8fc7--express\u53c2\u6570\u6267\u884c\u6307\u5b9a\u7684\u8868\u8fbe\u5f0f\u3002\n$ vmtool --action getInstances --className org.springframework.context.ApplicationContext --express 'instances[0].getBean(\"userController\").findUserById(1)'\n</code></pre>"},{"location":"languages/java/performance/arthas.html#classclassloader","title":"class/classloader\u76f8\u5173","text":""},{"location":"languages/java/performance/arthas.html#sc","title":"sc\uff08\u52a0\u8f7d\u7684\u7c7b\u4fe1\u606f\uff09","text":"<p>\u201cSearch-Class\u201d \u7684\u7b80\u5199\uff0c\u8fd9\u4e2a\u547d\u4ee4\u80fd\u641c\u7d22\u51fa\u6240\u6709\u5df2\u7ecf\u52a0\u8f7d\u5230 JVM \u4e2d\u7684 Class \u4fe1\u606f\uff0c\u8fd9\u4e2a\u547d\u4ee4\u652f\u6301\u7684\u53c2\u6570\u6709 <code>[d]</code>\u3001<code>[E]</code>\u3001<code>[f]</code> \u548c <code>[x:]</code>\u3002</p> <pre><code># -d \u7c7b\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c-f \u6210\u5458\u53d8\u91cf\u4fe1\u606f\n$ sc -c &lt;classloader-hash&gt; -d -f demo.MathGame\n</code></pre> <ul> <li><code>sc -d &lt;ClassName&gt;</code>\uff1a\u63d0\u53d6\u5bf9\u5e94\u7c7b\u7684ClassLoader\u7684hashcode</li> </ul>"},{"location":"languages/java/performance/arthas.html#sm","title":"sm\uff08\u52a0\u8f7d\u7684\u7c7b\u7684\u65b9\u6cd5\u4fe1\u606f\uff09","text":"<p>\u201cSearch-Method\u201d \u7684\u7b80\u5199\uff0c\u8fd9\u4e2a\u547d\u4ee4\u80fd\u641c\u7d22\u51fa\u6240\u6709\u5df2\u7ecf\u52a0\u8f7d\u4e86 Class \u4fe1\u606f\u7684\u65b9\u6cd5\u4fe1\u606f\u3002</p> <p><code>sm</code> \u547d\u4ee4\u53ea\u80fd\u770b\u5230\u7531\u5f53\u524d\u7c7b\u6240\u58f0\u660e (declaring) \u7684\u65b9\u6cd5\uff0c\u7236\u7c7b\u5219\u65e0\u6cd5\u770b\u5230\u3002</p> <pre><code># -d \u5c55\u793a\u6bcf\u4e2a\u65b9\u6cd5\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c-E\u6b63\u5219\u5339\u914d\n$ sm -c &lt;classloader-hash&gt; -d java.lang.String toString\n</code></pre>"},{"location":"languages/java/performance/arthas.html#jad","title":"jad\uff08\u53cd\u7f16\u8bd1\uff09","text":"<p><code>jad com.example.Test</code>\u5bf9\u5177\u4f53\u7684\u7c7b\u8fdb\u884c\u53cd\u7f16\u8bd1\u6210Java\u4ee3\u7801\u3002</p> <pre><code># --source-only\u9009\u9879\uff0c\u53ef\u4ee5\u53ea\u6253\u5370\u6e90\u4ee3\u7801\uff0c\u53cd\u7f16\u8bd1demo.MathGame\u7684main\u51fd\u6570\n$ jad -c &lt;classloader-hash&gt; --source-only demo.MathGame main\n</code></pre>"},{"location":"languages/java/performance/arthas.html#mc","title":"mc\uff08\u5185\u5b58\u7f16\u8bd1\uff09","text":"<p>Memory Compiler/\u5185\u5b58\u7f16\u8bd1\u5668\uff0c\u7f16\u8bd1<code>.java</code>\u6587\u4ef6\u751f\u6210<code>.class</code>\u3002</p> <p>\u7f16\u8bd1\u751f\u6210<code>.class</code>\u6587\u4ef6\u4e4b\u540e\uff0c\u53ef\u4ee5\u7ed3\u5408<code>retransform</code>\u547d\u4ee4\u5b9e\u73b0\u70ed\u66f4\u65b0\u4ee3\u7801\u3002</p> <pre><code># -d \u6307\u5b9a\u7f16\u8bd1\u540e\u7684\u8f93\u51fa\u76ee\u5f55\n$ mc -c 327a647b /tmp/Test.java  -d /tmp/output\n</code></pre> <p>\u6ce8\uff1amc\u547d\u4ee4\u53ef\u80fd\u5931\u8d25\u3002</p>"},{"location":"languages/java/performance/arthas.html#retransformjvm","title":"retransform\uff08\u8986\u76d6JVM\u5df2\u52a0\u8f7d\u7c7b\uff09","text":"<p>\u52a0\u8f7d\u5916\u90e8\u7684<code>.class</code>\u6587\u4ef6\uff0cretransform jvm\u5df2\u52a0\u8f7d\u7684\u7c7b\u3002</p> <ul> <li>\u5982\u679c\u4e0d\u6e05\u9664\u6389\u6240\u6709\u7684 retransform entry\uff0c\u5e76\u91cd\u65b0\u89e6\u53d1 retransform \uff0c\u5219arthas stop\u65f6\uff0cretransform\u8fc7\u7684\u7c7b\u4ecd\u7136\u751f\u6548\u3002</li> <li>\u4e0d\u5141\u8bb8\u65b0\u589e\u52a0field/method\uff1b</li> <li>\u6b63\u5728\u8dd1\u7684\u51fd\u6570\uff0c\u6ca1\u6709\u9000\u51fa\u4e0d\u80fd\u751f\u6548\uff08\u5373\u53ea\u80fd\u4e0b\u6b21\u518d\u6267\u884c\u8be5\u51fd\u6570\u65f6\uff0c\u624d\u80fd\u751f\u6548\uff09\uff1b</li> </ul> <pre><code>$ retransform /tmp/MathGame.class\n# \u67e5\u770bretransform entry\uff0cTransformCount \u7edf\u8ba1\u5728 ClassFileTransformer#transform \u51fd\u6570\u91cc\u5c1d\u8bd5\u8fd4\u56de entry\u5bf9\u5e94\u7684 .class\u6587\u4ef6\u7684\u6b21\u6570\uff0c\u4f46\u5e76\u4e0d\u8868\u660etransform\u4e00\u5b9a\u6210\u529f\u3002\n$ retransform -l\n# \u5220\u9664\u6307\u5b9a retransform entry\n$ retransform -d 1\n# \u5220\u9664\u6240\u6709 retransform entry\n$ retransform --deleteAll\n# \u663e\u5f0f\u89e6\u53d1 retransform\uff08\u5bf9\u4e8e\u540c\u4e00\u4e2a\u7c7b\uff0c\u5f53\u5b58\u5728\u591a\u4e2a retransform entry\u65f6\uff0c\u5982\u679c\u663e\u5f0f\u89e6\u53d1 retransform \uff0c\u5219\u6700\u540e\u6dfb\u52a0\u7684entry\u751f\u6548(id\u6700\u5927\u7684)\uff09\n$ retransform --classPattern demo.MathGame\n</code></pre>"},{"location":"languages/java/performance/arthas.html#dumpsh","title":"dump\uff08sh\uff09","text":"<p>dump \u5df2\u52a0\u8f7d\u7c7b\u7684 bytecode \u5230\u7279\u5b9a\u76ee\u5f55</p> <pre><code># -d \u6307\u5b9a\u8f93\u51fa\u76ee\u5f55\n$ dump -d /tmp/output demo.*\n</code></pre>"},{"location":"languages/java/performance/arthas.html#classloader","title":"classloader","text":"<p>\u67e5\u770bclassloader\u7684\u7ee7\u627f\u6811\uff0curls\uff0c\u7c7b\u52a0\u8f7d\u4fe1\u606f</p> <pre><code># \u6309\u7c7b\u52a0\u8f7d\u5b9e\u4f8b\u67e5\u770b\u7edf\u8ba1\u4fe1\u606f\uff08\u52a0\u8f7d\u7c7b\u6570\uff0chashcode\uff0c\u7236\u7c7b\u52a0\u8f7d\uff09\n$ classloader -l\n# \u67e5\u770bClassLoader\u7684\u7ee7\u627f\u6811\n$ classloader -t\n# \u4f7f\u7528ClassLoader\u53bb\u67e5\u627eresource \u6216\u8005\u7c7b\u6587\u4ef6(java/lang/String.class)\n$ classloader -c 3d4eac69  -r META-INF/MANIFEST.MF\n# \u4f7f\u7528ClassLoader\u53bb\u52a0\u8f7d\u7c7b\n$ classloader -c 3d4eac69 --load demo.MathGame\n</code></pre>"},{"location":"languages/java/performance/arthas.html#_4","title":"\u76d1\u63a7\u8ddf\u8e2a","text":""},{"location":"languages/java/performance/arthas.html#monitor","title":"monitor\uff08\u65b9\u6cd5\u6267\u884c\u76d1\u63a7\uff09","text":"<p>\u5bf9\u5339\u914d <code>class-pattern</code>\uff0f<code>method-pattern</code>\uff0f<code>condition-express</code>\u7684\u7c7b\u3001\u65b9\u6cd5\u7684\u8c03\u7528\u8fdb\u884c\u76d1\u63a7\u3002\u540e\u53f0\u670d\u52a1\uff0c\u4e00\u76f4\u76d1\u63a7\uff0c\u76f4\u5230\u624b\u52a8Ctrl+C\u3002</p> <p>\u76d1\u63a7\u7684\u7ef4\u5ea6\u8bf4\u660e\uff1a</p> \u76d1\u63a7\u9879 \u8bf4\u660e timestamp \u65f6\u95f4\u6233 class Java\u7c7b method \u65b9\u6cd5\uff08\u6784\u9020\u65b9\u6cd5\u3001\u666e\u901a\u65b9\u6cd5\uff09 total \u8c03\u7528\u6b21\u6570 success \u6210\u529f\u6b21\u6570 fail \u5931\u8d25\u6b21\u6570 rt \u5e73\u5747RT fail-rate \u5931\u8d25\u7387 <p>\u4f7f\u7528\uff1a\u5047\u8bbeprimeFactors\u51fd\u6570\u6bcf\u79d2\u751f\u6210\u4e2a\u968f\u673a\u6574\u6570\uff0c\u5e76\u8fdb\u884c\u8d28\u56e0\u6570\u5206\u89e3</p> <pre><code># \u6bcf5\u79d2\u7edf\u8ba1\u7ed3\u679c\u5e76\u8f93\u51fa\uff0c-c \u6307\u5b9a\u7edf\u8ba1\u5468\u671f\uff0c\u9ed8\u8ba4\u503c\u4e3a120\u79d2\n$ monitor -c 5 demo.MathGame primeFactors\n# \u9ed8\u8ba4\uff0c\u8ba1\u7b97\u6761\u4ef6\u8868\u8fbe\u5f0f\u8fc7\u6ee4\u7edf\u8ba1\u7ed3\u679c(\u65b9\u6cd5\u6267\u884c\u5b8c\u6bd5\u4e4b\u540e)\uff0c\u6bcf\u6b21\u90fd\u5148\u8ba1\u7b97\u5b8c\uff0c\u518d\u7b5b\u9009\u5165\u53c2&lt;=2\u7684\u7ed3\u679c\uff0cparams\u8868\u8ff0\u51fd\u6570primeFactors\u7684\u5165\u53c2\u5217\u8868\n$ monitor -c 5 demo.MathGame primeFactors \"params[0] &lt;= 2\"\n# -b \u8ba1\u7b97\u6761\u4ef6\u8868\u8fbe\u5f0f\u8fc7\u6ee4\u7edf\u8ba1\u7ed3\u679c(\u65b9\u6cd5\u6267\u884c\u5b8c\u6bd5\u4e4b\u524d)\uff0c\u5148\u7b5b\u9009\u5165\u53c2&lt;=2\uff0c\u518d\u8ba1\u7b97\u5e76\u7edf\u8ba1\u7ed3\u679c\n$ monitor -b -c 5 com.test.testes.MathGame primeFactors \"params[0] &lt;= 2\"\n</code></pre>"},{"location":"languages/java/performance/arthas.html#watch","title":"watch\uff08\u67e5\u770b\u6570\u636e\uff09","text":"<p>\u8be6\u7ec6\u7528\u6cd5\uff1a\u89c1 https://arthas.aliyun.com/doc/watch.html</p> <p>\u65b9\u6cd5\u6267\u884c\u6570\u636e\u89c2\u6d4b\uff0c\u53c2\u6570\uff1a</p> <ul> <li><code>-b</code>\uff1a\u5728\u65b9\u6cd5\u8c03\u7528\u4e4b\u524d\u89c2\u5bdf\uff1b</li> <li><code>-e</code>\uff1a\u5728\u65b9\u6cd5\u5f02\u5e38\u4e4b\u540e\u89c2\u5bdf\uff1b</li> <li><code>-s</code>\uff1a\u5728\u65b9\u6cd5\u8fd4\u56de\u4e4b\u540e\u89c2\u5bdf\uff1b</li> <li><code>-f</code>\uff1a\u5728\u65b9\u6cd5\u7ed3\u675f\u4e4b\u540e(\u6b63\u5e38\u8fd4\u56de\u548c\u5f02\u5e38\u8fd4\u56de)\u89c2\u5bdf\uff0c\u9ed8\u8ba4\u503c\uff1b</li> <li><code>-E</code>\uff1a\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff1b</li> <li><code>-x</code>\uff1a\u8f93\u51fa\u7ed3\u679c\u7684\u5c5e\u6027\u904d\u5386\u6df1\u5ea6\uff0c\u9ed8\u8ba4\u4e3a 1\uff1b</li> <li><code>-v</code>\uff1a\u4f1a\u6253\u5370<code>Condition express</code>\u7684\u5177\u4f53\u503c\u548c\u6267\u884c\u7ed3\u679c\uff0c\u65b9\u4fbf\u786e\u8ba4\u662f\u51fd\u6570\u672a\u6267\u884c\u8fd8\u662f\u6761\u4ef6\u8868\u8fbe\u5f0f\u672a\u5339\u914d\uff1b</li> </ul> <p>\u89c2\u5bdf\u65b9\u6cd5\u51fa\u53c2\u3001this\u5bf9\u8c61\u548c\u8fd4\u56de\u503c</p> <ul> <li>\u89c2\u5bdf\u8868\u8fbe\u5f0f\uff0c\u9ed8\u8ba4\u503c\u662f<code>{params, target, returnObj}</code>\uff0c\u5373\u51fd\u6570\u5165\u53c2\u3001\u5f53\u524d\u5bf9\u8c61\u7684\u5c5e\u6027\u3001\u8fd4\u56de\u7ed3\u679c</li> </ul> <pre><code>$ watch demo.MathGame primeFactors \"{params,returnObj}\" -x 2 -b\n# \u53ea\u6709\u6ee1\u8db3\u6761\u4ef6\u7684\u8c03\u7528\uff0c\u624d\u4f1a\u6709\u54cd\u5e94\n$ watch demo.MathGame primeFactors \"{params[0],target}\" \"params[0]&lt;0\"\n# \u89c2\u5bdf\u5f02\u5e38\u4fe1\u606f\uff0c\u8868\u793a\u5f02\u5e38\u4fe1\u606f\u7684\u53d8\u91cf\u662fthrowExp\n$ watch demo.MathGame primeFactors \"{params[0],throwExp}\" -e -x 2\n# \u6309\u7167\u8017\u65f6\u8fdb\u884c\u8fc7\u6ee4\uff0c\u5f53\u8017\u65f6\u5927\u4e8e200ms\u65f6\u624d\u4f1a\u8f93\u51fa\n$ watch demo.MathGame primeFactors '{params, returnObj}' '#cost&gt;200' -x 2\n# \u8bbf\u95ee\u5f53\u524d\u5bf9\u8c61\u7684illegalArgumentCount\u5c5e\u6027\n$ watch demo.MathGame primeFactors 'target.illegalArgumentCount'\n</code></pre>"},{"location":"languages/java/performance/arthas.html#trace","title":"trace\uff08\u65b9\u6cd5\u5185\u90e8\u8c03\u7528\u8def\u5f84\uff0c\u5e76\u8f93\u51fa\u65b9\u6cd5\u8def\u5f84\u4e0a\u7684\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8017\u65f6\uff09","text":"<p>\u4e3b\u52a8\u641c\u7d22 <code>class-pattern</code>\uff0f<code>method-pattern</code> \u5bf9\u5e94\u7684\u65b9\u6cd5\u8c03\u7528\u8def\u5f84\uff0c\u6e32\u67d3\u548c\u7edf\u8ba1\u6574\u4e2a\u8c03\u7528\u94fe\u8def\u4e0a\u7684\u6240\u6709\u6027\u80fd\u5f00\u9500\u548c\u8ffd\u8e2a\u8c03\u7528\u94fe\u8def\u3002</p> <ul> <li><code>-n</code>\u53c2\u6570\u6307\u5b9a\u6355\u6349\u7ed3\u679c\u7684\u6b21\u6570\uff1b</li> <li><code>--skipJDKMethod true</code>\uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0ctrace\u4e0d\u4f1a\u5305\u542bjdk\u91cc\u7684\u51fd\u6570\u8c03\u7528\uff0c\u5c06\u5176\u8bbe\u7f6e\u4e3atrue\u53ef\u4ee5\u76d1\u63a7\uff1b</li> <li><code>-v</code>\uff1a\u4f1a\u6253\u5370<code>Condition express</code>\u7684\u5177\u4f53\u503c\u548c\u6267\u884c\u7ed3\u679c\uff0c\u65b9\u4fbf\u786e\u8ba4\u662f\u51fd\u6570\u672a\u6267\u884c\u8fd8\u662f\u6761\u4ef6\u8868\u8fbe\u5f0f\u672a\u5339\u914d\uff1b</li> </ul> <pre><code># \u65b9\u6cd5\u8c03\u7528\u8def\u5f84\u7684\u8017\u65f6\uff0c\u6355\u6349\u5230\u4e00\u6b21\u8c03\u7528\u5c31\u9000\u51fa\u547d\u4ee4\n$ trace demo.MathGame run  -n 1\n# \u6839\u636e\u8c03\u7528\u8017\u65f6\u8fc7\u6ee4\n$ trace demo.MathGame run '#cost &gt; 10'\n</code></pre> <p>\u6ce8\uff1a</p> <ul> <li><code>trace</code> \u5728\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\u672c\u8eab\u662f\u4f1a\u6709\u4e00\u5b9a\u7684\u6027\u80fd\u5f00\u9500\uff0c\u5728\u7edf\u8ba1\u7684\u62a5\u544a\u4e2d\u5e76\u672a\u50cf JProfiler \u4e00\u6837\u9884\u5148\u51cf\u53bb\u5176\u81ea\u8eab\u7684\u7edf\u8ba1\u5f00\u9500\u3002</li> <li>\u6e32\u67d3\u8def\u5f84\u4e0a\u8c03\u7528\u7684\u7c7b\u3001\u65b9\u6cd5\u8d8a\u591a\uff0c\u6027\u80fd\u504f\u5dee\u8d8a\u5927\uff1b</li> </ul>"},{"location":"languages/java/performance/arthas.html#stack","title":"stack\uff08\u8f93\u51fa\u5f53\u524d\u65b9\u6cd5\u88ab\u8c03\u7528\u7684\u8c03\u7528\u8def\u5f84\uff09","text":"<pre><code>$ stack demo.MathGame primeFactors\n\n# \u6839\u636e\u6761\u4ef6\u8868\u8fbe\u5f0f\u6765\u8fc7\u6ee4\uff0c-n \u6267\u884c\u6b21\u6570\u9650\u5236\n$ stack demo.MathGame primeFactors 'params[0]&lt;0' -n 2\n\n# \u636e\u6267\u884c\u65f6\u95f4\u6765\u8fc7\u6ee4\n$ stack demo.MathGame primeFactors '#cost&gt;5'\n</code></pre>"},{"location":"languages/java/performance/arthas.html#tttimetunnel","title":"tt\uff08TimeTunnel\uff09","text":"<p>\u65b9\u6cd5\u6267\u884c\u6570\u636e\u7684\u65f6\u7a7a\u96a7\u9053\uff0c\u8bb0\u5f55\u4e0b\u6307\u5b9a\u65b9\u6cd5\u6bcf\u6b21\u8c03\u7528\u7684\u5165\u53c2\u548c\u8fd4\u56de\u4fe1\u606f\uff0c\u5e76\u80fd\u5bf9\u8fd9\u4e9b\u4e0d\u540c\u7684\u65f6\u95f4\u4e0b\u8c03\u7528\u8fdb\u884c\u89c2\u6d4b\u3002</p> <p>\u8bb0\u5f55\u4e0b\u5f53\u65f6\u65b9\u6cd5\u8c03\u7528\u7684\u6240\u6709\u5165\u53c2\u548c\u8fd4\u56de\u503c\u3001\u629b\u51fa\u7684\u5f02\u5e38\u4f1a\u5bf9\u6574\u4e2a\u95ee\u9898\u7684\u601d\u8003\u4e0e\u5224\u65ad\u975e\u5e38\u6709\u5e2e\u52a9\u3002</p> <p>\u8bb0\u5f55\u7ed3\u679c\u7684\u5b57\u6bb5\uff1a</p> \u8868\u683c\u5b57\u6bb5 \u5b57\u6bb5\u89e3\u91ca INDEX \u65f6\u95f4\u7247\u6bb5\u8bb0\u5f55\u7f16\u53f7\uff0c\u6bcf\u4e00\u4e2a\u7f16\u53f7\u4ee3\u8868\u7740\u4e00\u6b21\u8c03\u7528\uff0c\u540e\u7eedtt\u8fd8\u6709\u5f88\u591a\u547d\u4ee4\u90fd\u662f\u57fa\u4e8e\u6b64\u7f16\u53f7\u6307\u5b9a\u8bb0\u5f55\u64cd\u4f5c\uff0c\u975e\u5e38\u91cd\u8981\u3002 TIMESTAMP \u65b9\u6cd5\u6267\u884c\u7684\u672c\u673a\u65f6\u95f4\uff0c\u8bb0\u5f55\u4e86\u8fd9\u4e2a\u65f6\u95f4\u7247\u6bb5\u6240\u53d1\u751f\u7684\u672c\u673a\u65f6\u95f4 COST(ms) \u65b9\u6cd5\u6267\u884c\u7684\u8017\u65f6 IS-RET \u65b9\u6cd5\u662f\u5426\u4ee5\u6b63\u5e38\u8fd4\u56de\u7684\u5f62\u5f0f\u7ed3\u675f IS-EXP \u65b9\u6cd5\u662f\u5426\u4ee5\u629b\u5f02\u5e38\u7684\u5f62\u5f0f\u7ed3\u675f OBJECT \u6267\u884c\u5bf9\u8c61\u7684<code>hashCode()</code>\uff0c\u6ce8\u610f\uff0c\u66fe\u7ecf\u6709\u4eba\u8bef\u8ba4\u4e3a\u662f\u5bf9\u8c61\u5728JVM\u4e2d\u7684\u5185\u5b58\u5730\u5740\uff0c\u4f46\u5f88\u9057\u61be\u4ed6\u4e0d\u662f\u3002\u4f46\u4ed6\u80fd\u5e2e\u52a9\u4f60\u7b80\u5355\u7684\u6807\u8bb0\u5f53\u524d\u6267\u884c\u65b9\u6cd5\u7684\u7c7b\u5b9e\u4f53 CLASS \u6267\u884c\u7684\u7c7b\u540d METHOD \u6267\u884c\u7684\u65b9\u6cd5\u540d <p>\u547d\u4ee4\u7684\u53c2\u6570\uff1a</p> <ul> <li><code>-t</code>\uff1a\u8bb0\u5f55\u6bcf\u6b21\u6267\u884c\u60c5\u51b5\uff1b</li> <li><code>-n</code>\uff1a\u6307\u5b9a\u9700\u8981\u8bb0\u5f55\u7684\u6b21\u6570\uff1b</li> <li><code>-p</code>\uff1a\u4e3b\u52a8\u5bf9\u4e00\u4e2a <code>INDEX</code> \u7f16\u53f7\u7684\u65f6\u95f4\u7247\u81ea\u4e3b\u53d1\u8d77\u4e00\u6b21\u8c03\u7528\uff0c<code>--replay-times</code> \u6307\u5b9a \u8c03\u7528\u6b21\u6570\uff0c\u901a\u8fc7 <code>--replay-interval</code> \u6307\u5b9a\u591a\u6b21\u8c03\u7528\u95f4\u9694(\u5355\u4f4dms, \u9ed8\u8ba41000ms)\uff1b</li> <li><code>-w, --watch-express</code> \uff1a\u89c2\u5bdf\u65f6\u7a7a\u96a7\u9053\u4f7f\u7528<code>ognl</code> \u8868\u8fbe\u5f0f\uff1b</li> <li><code>-i</code>\uff1a\u6307\u5b9a\u8bb0\u5f55\u7684INDEX\uff1b</li> </ul> <pre><code># \u8bb0\u5f55\u4e0b\u5f53\u524d\u65b9\u6cd5\u7684\u6bcf\u6b21\u8c03\u7528\u73af\u5883\u73b0\u573a\u3002\n$ tt -t demo.MathGame primeFactors -n 3\n# \u89e3\u51b3\u65b9\u6cd5\u91cd\u8f7d\uff0c\u53ea\u8bb0\u5f55\u5165\u53c2\u683c\u5f0f\u4e3a1\u7684print\u51fd\u6570\n$ tt -t *Test print params.length==1\n# \u53ea\u8bb0\u5f55\u5165\u53c2\u7b2c\u4e00\u4e2a\u7c7b\u578b\u4e3aInterger\u7684print\u51fd\u6570\n$ tt -t *Test print 'params[1] instanceof Integer'\n# \u6307\u5b9a\u53c2\u6570\n$ tt -t *Test print params[0].mobile==\"13989838402\"\n\n# \u89e6\u53d1\u8c03\u7528\n$ tt -i 1004 -p\n# \u5bf9\u4e8e\u8bb0\u5f55\u7684INDEX\u4e3a1000\uff0c\u8c03\u7528\u7c7b\u7684\u9759\u6001\u65b9\u6cd5\n$ tt -w '@demo.MathGame@random.nextInt(100)'  -x 1 -i 1000\n</code></pre> <p>\u6ce8\uff1a</p> <ul> <li>ThreadLocal \u4fe1\u606f\u4e22\u5931\uff1a\u5f88\u591a\u6846\u67b6\u4f1a\u5c06\u4e00\u4e9b\u73af\u5883\u53d8\u91cf\u4fe1\u606f\u585e\u5230\u4e86\u53d1\u8d77\u8c03\u7528\u7ebf\u7a0b\u7684 ThreadLocal \u4e2d\uff0c\u7531\u4e8e\u8c03\u7528\u7ebf\u7a0b\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u8fd9\u4e9b ThreadLocal \u7ebf\u7a0b\u4fe1\u606f\u65e0\u6cd5\u901a\u8fc7 Arthas \u4fdd\u5b58\uff0c\u6240\u4ee5\u8fd9\u4e9b\u4fe1\u606f\u5c06\u4f1a\u4e22\u5931\u3002</li> </ul>"},{"location":"languages/java/performance/arthas.html#_5","title":"\u6027\u80fd\u5206\u6790","text":""},{"location":"languages/java/performance/arthas.html#profiler","title":"profiler","text":"<p><code>profiler</code> \u547d\u4ee4\u652f\u6301\u751f\u6210\u5e94\u7528\u70ed\u70b9\u7684\u706b\u7130\u56fe\u3002\u672c\u8d28\u4e0a\u662f\u901a\u8fc7\u4e0d\u65ad\u7684\u91c7\u6837\uff0c\u7136\u540e\u628a\u6536\u96c6\u5230\u7684\u91c7\u6837\u7ed3\u679c\u751f\u6210\u706b\u7130\u56fe\uff0c\u57fa\u4e8easync-profiler\u751f\u6210\u706b\u7130\u56fe</p> <ul> <li>OS\u672c\u8eab\u7684\u6743\u9650/\u914d\u7f6e\u95ee\u9898\uff0c\u7136\u540e\u7f3a\u5c11\u90e8\u5206event\uff0c\u53ef\u4ee5\u53c2\u8003<code>async-profiler</code>\u672c\u8eab\u6587\u6863\uff1aasync-profiler\uff1b</li> <li>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0carthas\u4f7f\u75283658\u7aef\u53e3\uff0c\u5219\u53ef\u4ee5\u6253\u5f00\uff1a http://localhost:3658/arthas-output/ \u67e5\u770b\u5230<code>arthas-output</code>\u76ee\u5f55\u4e0b\u9762\u7684profiler\u7ed3\u679c\uff1a</li> </ul> <pre><code># \u542f\u52a8\n$ profiler start \n# \u83b7\u53d6\u5df2\u91c7\u96c6\u7684sample\u7684\u6570\u91cf\n$ profiler getSamples\n# \u67e5\u770bprofiler\u72b6\u6001\n$ profiler status\n# \u505c\u6b62profiler\uff0c\u9ed8\u8ba4\u751f\u6210svg\u683c\u5f0f\uff0c\u53ef\u4ee5\u6307\u5b9a\u4e3a\u8f93\u51faHTML\n$ profiler stop --file /tmp/result.html\n\n# include/exclude \u6765\u8fc7\u6ee4\uff0c300\u79d2\u540e\u81ea\u52a8\u7ed3\u675f\n$ profiler start --include 'java/*' --include 'demo/*' --exclude '*Unsafe.park*' --duration 300\n</code></pre>"},{"location":"languages/java/performance/arthas.html#_6","title":"\u9274\u6743","text":""},{"location":"languages/java/performance/arthas.html#auth","title":"auth","text":"<p>\u9a8c\u8bc1\u5f53\u524d\u4f1a\u8bdd\uff1a</p> <ul> <li>attach\u65f6\uff0c\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u6307\u5b9a\u5bc6\u7801\uff0c\u5982<code>java -jar arthas-boot.jar --username arthas --password ppp</code>;</li> </ul> <p><code>arthas.properties</code>\u6587\u4ef6\uff1a</p> <pre><code># \u672c\u5730\u8fde\u63a5\u4e0d\u9274\u6743\narthas.localConnectionNonAuth=true\n</code></pre> <p>telnet console \u8fde\u63a5\u5230arthas\u540e\uff0c\u76f4\u63a5\u6267\u884c\u547d\u4ee4\u4f1a\u63d0\u793a\u9700\u8981\u9274\u6743</p> <pre><code>$ auth --username arthas ppp\n</code></pre> <p>HTTP API \u9a8c\u8bc1\uff1a</p> <ul> <li>HTTP \u6807\u51c6\u7684 Basic Authorization\uff0c\u7528\u6237\u540d\u548c\u5bc6\u7801\u901a\u8fc7\":\"\u7ec4\u5408\u5e76\u7528Base64\u52a0\u5bc6\uff0c\u7136\u540e\u8bbe\u7f6e\u5934\u57df<code>Authorization</code></li> </ul> <pre><code>curl 'http://localhost:8563/api' -H 'Authorization: Basic YWRtaW46YWRtaW4=' \\\n  --data-raw '{\"action\":\"exec\",\"command\":\"version\"}' \n</code></pre>"},{"location":"languages/java/performance/arthas.html#web-console","title":"Web Console","text":"<p>Arthas\u76ee\u524d\u652f\u6301Web Console\uff0c\u7528\u6237\u5728attach\u6210\u529f\u4e4b\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\uff1ahttp://127.0.0.1:3658/\u3002</p> <ul> <li>\u53ef\u4ee5<code>--target-ip</code>\u53c2\u6570\u6307\u5b9alisten\u7684IP\uff0c\u4fbf\u53ef\u4ee5\u901a\u8fc7\u5176\u5b83ip\u8fdb\u884c\u8bbf\u95ee\uff1b</li> <li>web console\u4e2d\u53ef\u4ee5\u8f93\u5165\u5176\u5b83ip\uff0c\u8fde\u63a5\u5230\u53e6\u5916\u7684arthas\u4e2d\uff1b</li> </ul> <p></p>"},{"location":"languages/java/performance/arthas.html#arthas-tunnel","title":"Arthas Tunnel","text":"<p>\u901a\u8fc7Arthas Tunnel Server/Client \u6765\u8fdc\u7a0b\u7ba1\u7406/\u8fde\u63a5\u591a\u4e2aAgent\u3002</p> <p>\u6bd4\u5982\uff0c\u5728\u6d41\u5f0f\u8ba1\u7b97\u91cc\uff0cJava\u8fdb\u7a0b\u53ef\u4ee5\u662f\u5728\u4e0d\u540c\u7684\u673a\u5668\u542f\u52a8\u7684\uff0c\u60f3\u8981\u4f7f\u7528Arthas\u53bb\u8bca\u65ad\u4f1a\u6bd4\u8f83\u9ebb\u70e6\uff0c\u56e0\u4e3a\u7528\u6237\u901a\u5e38\u6ca1\u6709\u673a\u5668\u7684\u6743\u9650\uff0c\u5373\u4f7f\u767b\u9646\u673a\u5668\u4e5f\u5206\u4e0d\u6e05\u662f\u54ea\u4e2aJava\u8fdb\u7a0b\u3002</p> <p>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528Arthas Tunnel Server/Client\u3002</p> <ul> <li>\u76ee\u524dtunnel server\u6ca1\u6709\u4e13\u95e8\u7684\u6743\u9650\u7ba1\u7406\uff0c\u7528\u6237\u9700\u8981\u81ea\u884c\u5f00\u53d1\uff0c\u5bf9app name\u9274\u6743\uff1b</li> <li>\u5e0c\u671b\u90e8\u7f72\u591a\u53f0 tunnel server\uff0c\u53ef\u4ee5\u901a\u8fc7nginx\u505a\u8f6c\u53d1\uff0credis\u6765\u4fdd\u5b58agent\u4fe1\u606f\uff0cnginx\u9700\u8981\u914d\u7f6esticky session\uff0c\u4fdd\u8bc1\u7528\u6237web socket\u8fde\u63a5\u5230\u540c\u4e00\u4e2a\u540e\u7aeftunnel server\uff08\u5982ip_hash\uff09\uff1b</li> </ul> <p>\u7f51\u7edc\u8fde\u63a5\u6d41\u7a0b\uff1a</p> <pre><code>browser &lt;-&gt; arthas tunnel server &lt;-&gt; arthas tunnel client &lt;-&gt; arthas agent\n</code></pre>"},{"location":"languages/java/performance/arthas.html#tunnel-server","title":"Tunnel Server","text":"<p>https://github.com/alibaba/arthas/releases/download/arthas-all-3.5.0/arthas-tunnel-server-3.5.0-fatjar.jar</p> <pre><code>java -jar  arthas-tunnel-server.jar\n</code></pre> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0carthas tunnel server\u7684web\u7aef\u53e3\u662f<code>8080</code>\uff0carthas agent\u8fde\u63a5\u7684\u7aef\u53e3\u662f<code>7777</code>\u3002</p> <p>\u542f\u52a8\u4e4b\u540e\uff0c\u53ef\u4ee5\u8bbf\u95ee http://127.0.0.1:8080/ \uff0c\u518d\u901a\u8fc7agentId\u8fde\u63a5\u5230\u5df2\u6ce8\u518c\u7684arthas agent\u4e0a\u3002</p> <ul> <li>\u67e5\u770b\u5177\u4f53\u7684\u8fde\u63a5\u4fe1\u606f\u7684url<code>/actuator/arthas</code>\uff1a\u767b\u9646\u7528\u6237\u540d\u662f<code>arthas</code>\uff0c\u5bc6\u7801\u5728arthas tunnel server\u7684\u65e5\u5fd7\u91cc\u53ef\u4ee5\u627e\u5230</li> </ul>"},{"location":"languages/java/performance/arthas.html#tunnel-client","title":"Tunnel Client","text":"<p>\u5728\u542f\u52a8arthas\uff0c\u53ef\u4ee5\u4f20\u9012<code>--tunnel-server</code>\u53c2\u6570\uff0c\u6bd4\u5982\uff1a</p> <pre><code>as.sh --tunnel-server 'ws://127.0.0.1:7777/ws' --app-name demoapp\n</code></pre> <ul> <li>attach\u6210\u529f\u4e4b\u540e\uff0c\u4f1a\u6253\u5370\u51faagentId\uff08\u6216\u901a\u8fc7session\u547d\u4ee4\u6253\u5370\u51faagentId\uff09\uff1b</li> <li>\u914d\u7f6e\u4e86 <code>appName</code>\uff0c\u5219\u751f\u6210\u7684agentId\u4f1a\u5e26\u4e0a<code>appName</code>\u7684\u524d\u7f00\uff1b</li> </ul>"},{"location":"languages/java/performance/arthas.html#http-api","title":"Http API","text":"<p>Http API\u63a5\u53e3\u5730\u5740\u4e3a\uff1ahttp://ip:port/api\uff0c\u5fc5\u987b\u4f7f\u7528POST\u65b9\u5f0f\u63d0\u4ea4\u8bf7\u6c42\u53c2\u6570\u3002\u5982POST http://127.0.0.1:8563/api \u3002</p> <ul> <li> <p>telnet\u670d\u52a1\u76843658\u7aef\u53e3\u4e0eChrome\u6d4f\u89c8\u5668\u6709\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u5efa\u8bae\u4f7f\u7528http\u7aef\u53e38563\u6765\u8bbf\u95eehttp\u63a5\u53e3\uff1b</p> </li> <li> <p>\u8bf7\u6c42\u6570\u636e\u683c\u5f0f\uff1a</p> </li> </ul> <pre><code>{\n  \"action\": \"exec\",\n  \"requestId\": \"req112\",  // \u53ef\u9009\u8bf7\u6c42ID\uff0c\u7531\u5ba2\u6237\u7aef\u751f\u6210\n  \"sessionId\": \"94766d3c-8b39-42d3-8596-98aee3ccbefb\",  // Arthas\u4f1a\u8bddID\n  \"consumerId\": \"955dbd1325334a84972b0f3ac19de4f7_2\",    // Arthas\u6d88\u8d39\u8005ID\uff0c\u7528\u4e8e\u591a\u4eba\u5171\u4eab\u4f1a\u8bdd\n  \"command\": \"version\",\n  \"execTimeout\": \"10000\"        // \u547d\u4ee4\u540c\u6b65\u6267\u884c\u7684\u8d85\u65f6\u65f6\u95f4(ms)\n}\n</code></pre> <p>Action\uff1a</p> <ul> <li><code>exec</code> : \u540c\u6b65\u6267\u884c\u547d\u4ee4\uff0c\u547d\u4ee4\u6b63\u5e38\u7ed3\u675f\u6216\u8005\u8d85\u65f6\u540e\u4e2d\u65ad\u547d\u4ee4\u6267\u884c\u540e\u8fd4\u56de\u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c\u3002</li> <li><code>async_exec</code> : \u5f02\u6b65\u6267\u884c\u547d\u4ee4\uff0c\u7acb\u5373\u8fd4\u56de\u547d\u4ee4\u7684\u8c03\u5ea6\u7ed3\u679c\uff0c\u547d\u4ee4\u6267\u884c\u7ed3\u679c\u901a\u8fc7<code>pull_results</code>\u83b7\u53d6\u3002</li> <li><code>interrupt_job</code> : \u4e2d\u65ad\u4f1a\u8bdd\u5f53\u524d\u7684\u547d\u4ee4\uff0c\u7c7b\u4f3cTelnet <code>Ctrl + c</code>\u7684\u529f\u80fd\u3002</li> <li><code>pull_results</code> : \u83b7\u53d6\u5f02\u6b65\u6267\u884c\u7684\u547d\u4ee4\u7684\u7ed3\u679c\uff0c\u4ee5http \u957f\u8f6e\u8be2\uff08long-polling\uff09\u65b9\u5f0f\u91cd\u590d\u6267\u884c</li> <li><code>init_session</code> : \u521b\u5efa\u4f1a\u8bdd</li> <li><code>join_session</code> : \u52a0\u5165\u4f1a\u8bdd\uff0c\u7528\u4e8e\u652f\u6301\u591a\u4eba\u5171\u4eab\u540c\u4e00\u4e2aArthas\u4f1a\u8bdd</li> <li><code>close_session</code> : \u5173\u95ed\u4f1a\u8bdd</li> </ul> <p>\u66f4\u8be6\u7ec6\u7684\u4f7f\u7528\u89c1\uff1ahttps://arthas.aliyun.com/doc/http-api.html</p>"},{"location":"languages/java/performance/arthas.html#_7","title":"\u5168\u5c40\u914d\u7f6e","text":"<p>options\u2014\u2014\u67e5\u770b\u6216\u8bbe\u7f6eArthas\u5168\u5c40\u5f00\u5173</p>"},{"location":"languages/java/performance/arthas.html#idea","title":"IDEA\u63d2\u4ef6","text":""},{"location":"languages/java/performance/arthas.html#_8","title":"\u6848\u4f8b","text":""},{"location":"languages/java/performance/arthas.html#_9","title":"\u6b7b\u9501\u53d1\u73b0","text":""},{"location":"languages/java/performance/cpu_profile.html","title":"CPU Profiler","text":"<p>CPU Profiling \u6709\u4e24\u79cd\u5b9e\u73b0\uff1aSampling \u548c Instrumentation</p> <ul> <li>\u57fa\u4e8e\u65e0\u4fb5\u5165\u7684\u989d\u5916\u7ebf\u7a0b\u5bf9\u6240\u6709\u7ebf\u7a0b\u7684\u8c03\u7528\u6808\u5feb\u7167\u8fdb\u884c\u56fa\u5b9a\u9891\u7387\u62bd\u6837\uff0c\u6027\u80fd\u5f00\u9500\u5f88\u4f4e\uff1b</li> <li>\u5229\u7528 Instrument API\uff0c\u5bf9\u6240\u6709\u5fc5\u8981\u7684 Class \u8fdb\u884c\u5b57\u8282\u7801\u589e\u5f3a\uff0c\u6027\u80fd\u5f00\u9500\u9ad8\uff1b</li> </ul>"},{"location":"languages/java/performance/cpu_profile.html#sampling","title":"Sampling","text":""},{"location":"languages/java/performance/cpu_profile.html#java-agent-jmx","title":"Java Agent + JMX","text":""},{"location":"languages/java/performance/cpu_profile.html#_1","title":"\u539f\u7406","text":"<p>\u57fa\u4e8e\u5bf9StackTrace\u7684\u201c\u91c7\u6837\u201d\u8fdb\u884c\u5b9e\u73b0\uff0c\u5982 JVM Profile</p> <ul> <li>\u4ee5 <code>Java Agent</code> \u4e3a\u5165\u53e3\uff0c\u8fdb\u5165\u76ee\u6807 JVM \u8fdb\u7a0b\u540e\u5f00\u542f\u4e00\u4e2a <code>ScheduledExecutorService</code>\uff0c\u5b9a\u65f6\u5229\u7528JMX\u7684<code>threadMXBean.dumpAllThreads()</code> \u6765\u5bfc\u51fa\u6240\u6709\u7ebf\u7a0b\u7684 <code>StackTrace</code>\uff0c\u6700\u7ec8\u6c47\u603b\u5e76\u5bfc\u51fa\u5373\u53ef\uff1b</li> <li><code>dumpAllThreads()</code>\u7684\u6267\u884c\u5f00\u9500\u4e0d\u5bb9\u5c0f\u89d1\uff0cInterval\u4e0d\u5b9c\u8bbe\u7f6e\u7684\u8fc7\u5c0f\uff08JVM Profile\u9ed8\u8ba4\u4e3a100ms\uff09\u3002</li> </ul> <pre><code>public void profile() {\n    ThreadInfo[] threadInfos = threadMXBean.dumpAllThreads(false, false);\n    // ...\n    for (ThreadInfo threadInfo : threadInfos) {\n        String threadName = threadInfo.getThreadName();\n        // ...\n        StackTraceElement[] stackTraceElements = threadInfo.getStackTrace();\n        // ...\n        for (int i = stackTraceElements.length - 1; i &gt;= 0; i--) {\n            StackTraceElement stackTraceElement = stackTraceElements[i];\n            // ...\n        }\n        // ...\n    }\n}\n</code></pre>"},{"location":"languages/java/performance/cpu_profile.html#_2","title":"\u4f18\u52a3\u52bf","text":"<p>\u4f18\u52bf\uff1a</p> <ul> <li>\u6027\u80fd\u5f00\u9500\u5f88\u4f4e\uff1a\u76f8\u6bd4\u4e8eInstrumentation\u4e3a\u51e0\u4e4e\u6240\u6709\u65b9\u6cd5\u6dfb\u52a0\u989d\u5916AOP\u903b\u8f91\uff1b</li> </ul> <p>\u52a3\u52bf\uff1a</p> <ul> <li> <p>JVM\u56fa\u6709\u7684\u53ea\u80fd\u5728\u5b89\u5168\u70b9\uff08Safe Point\uff09\u8fdb\u884c\u91c7\u6837\u7684\u201c\u7f3a\u9677\u201d\uff0c\u4f1a\u5bfc\u81f4\u7edf\u8ba1\u7ed3\u679c\u5b58\u5728\u4e00\u5b9a\u7684\u504f\u5dee\uff1b</p> </li> <li> <p>Java Agent\u4ee3\u7801\u4e0e\u4e1a\u52a1\u4ee3\u7801\u5171\u4eabAppClassLoader\uff0c\u88abJVM\u76f4\u63a5\u52a0\u8f7d\u7684agent.jar\u5982\u679c\u5f15\u5165\u4e86\u7b2c\u4e09\u65b9\u4f9d\u8d56\uff0c\u53ef\u80fd\u4f1a\u5bf9\u4e1a\u52a1Class\u9020\u6210\u6c61\u67d3\uff1b</p> </li> </ul>"},{"location":"languages/java/performance/cpu_profile.html#jvmti-getstacktrace","title":"JVMTI + GetStackTrace","text":"<p>\u89e3\u51b3\u5bf9\u4e1a\u52a1Class\u9020\u6210\u6c61\u67d3\u7684\u95ee\u9898\u3002</p> <ul> <li>\u5206\u79bb\u5165\u53e3\u4e0e\u6838\u5fc3\u4ee3\u7801\uff0c\u4f7f\u7528\u5b9a\u5236\u7684ClassLoader\u52a0\u8f7d\u6838\u5fc3\u4ee3\u7801\uff0c\u907f\u514d\u5f71\u54cd\u4e1a\u52a1\u4ee3\u7801\uff1b</li> <li>\u76f4\u63a5\u5bf9\u63a5JVMTI\u63a5\u53e3\uff0c\u4f7f\u7528\u539f\u751fC API\u5bf9JVM\u8fdb\u884c\u64cd\u4f5c\uff1b</li> </ul>"},{"location":"languages/java/performance/cpu_profile.html#_3","title":"\u539f\u7406","text":"<ol> <li>\u7f16\u5199Agent_OnLoad()\uff0c\u5728\u5165\u53e3\u901a\u8fc7JNI\u7684JavaVM*\u6307\u9488\u7684GetEnv()\u51fd\u6570\u62ff\u5230JVMTI\u7684jvmtiEnv\u6307\u9488\uff1a</li> </ol> <pre><code>// agent.c\n#include &lt;jvmti.h&gt;\nJNIEXPORT jint JNICALL Agent_OnLoad(JavaVM *vm, char *options, void *reserved) {\n    jvmtiEnv *jvmti;\n    (*vm)-&gt;GetEnv((void **)&amp;jvmti, JVMTI_VERSION_1_2);\n    // ...\n    return JNI_OK;\n}\n</code></pre> <ol> <li>\u5f00\u542f\u4e00\u4e2a\u7ebf\u7a0b\u5b9a\u65f6\u5faa\u73af\uff0c\u5b9a\u65f6\u4f7f\u7528 jvmtiEnv \u6307\u9488\u914d\u5408\u8c03\u7528\u5982\u4e0b\u51e0\u4e2aJVMTI\u51fd\u6570\uff1a</li> </ol> <pre><code>// \u83b7\u53d6\u6240\u6709\u7ebf\u7a0b\u7684jthread\njvmtiError GetAllThreads(jvmtiEnv *env, jint *threads_count_ptr, jthread **threads_ptr);\n\n// \u6839\u636ejthread\u83b7\u53d6\u8be5\u7ebf\u7a0b\u4fe1\u606f\uff08name\u3001daemon\u3001priority...\uff09\njvmtiError GetThreadInfo(jvmtiEnv *env, jthread thread, jvmtiThreadInfo* info_ptr);\n\n// \u6839\u636ejthread\u83b7\u53d6\u8be5\u7ebf\u7a0b\u8c03\u7528\u6808\njvmtiError GetStackTrace(jvmtiEnv *env,\n                         jthread thread,\n                         jint start_depth,\n                         jint max_frame_count,\n                         jvmtiFrameInfo *frame_buffer,\n                         jint *count_ptr);\n</code></pre>"},{"location":"languages/java/performance/cpu_profile.html#_4","title":"\u4f18\u52a3\u52bf","text":"<p>\u4f18\u52bf</p> <ul> <li>Java Agent + JMX \u7684\u4f18\u52bf\uff1b</li> <li>\u4e0d\u5bf9\u4e1a\u52a1Class\u9020\u6210\u6c61\u67d3\uff1b</li> </ul> <p>\u52a3\u52bf\uff1a</p> <ul> <li>\u5f00\u53d1\u6548\u7387\u504f\u4f4e\uff1b</li> <li>\u53ea\u80fd\u5728\u5b89\u5168\u70b9\uff08Safe Point\uff09\u8fdb\u884c\u91c7\u6837\u7684\u201c\u7f3a\u9677\u201d\uff0c\u4f1a\u5bfc\u81f4\u7edf\u8ba1\u7ed3\u679c\u5b58\u5728\u4e00\u5b9a\u7684\u504f\u5dee\uff1b</li> </ul>"},{"location":"languages/java/performance/cpu_profile.html#jvmti-asyncgetcalltrace","title":"JVMTI + AsyncGetCallTrace","text":"<p>\u89e3\u51b3\u53ea\u80fd\u91c7\u96c6\u5230\u4f4d\u4e8e\u5b89\u5168\u70b9\u65f6\u523b\u7684\u8c03\u7528\u6808\u5feb\u7167\u7684\u95ee\u9898\u3002</p> <ul> <li>JVMTI\u7684GetStackTrace()\u51fd\u6570\u4e0d\u9700\u8981\u5728Caller\u7684\u5b89\u5168\u70b9\u6267\u884c\uff0c\u4f46\u5f53\u8c03\u7528GetStackTrace()\u83b7\u53d6\u5176\u4ed6\u7ebf\u7a0b\u7684\u8c03\u7528\u6808\u65f6\uff0c\u5fc5\u987b\u7b49\u5f85\uff0c\u76f4\u5230\u76ee\u6807\u7ebf\u7a0b\u8fdb\u5165\u5b89\u5168\u70b9\uff1b</li> <li>GetStackTrace()\u4ec5\u80fd\u901a\u8fc7\u5355\u72ec\u7684\u7ebf\u7a0b\u540c\u6b65\u5b9a\u65f6\u8c03\u7528\uff0c\u4e0d\u80fd\u5728UNIX\u4fe1\u53f7\u5904\u7406\u5668\u7684Handler\u4e2d\u88ab\u5f02\u6b65\u8c03\u7528\uff1b</li> </ul> <p>\u5f00\u6e90\u5b9e\u73b0\uff1aAsync-Profiler</p>"},{"location":"languages/java/performance/cpu_profile.html#_5","title":"\u539f\u7406","text":"<p>AsyncGetCallTrace</p> <ul> <li>\u83b7\u53d6\u5f53\u524d\u7ebf\u7a0b\u7684\u8c03\u7528\u6808\u4e14\u4e0d\u53d7\u5b89\u5168\u70b9\u5e72\u6270\uff0c\u8fd8\u652f\u6301\u5728UNIX\u4fe1\u53f7\u5904\u7406\u5668\u4e2d\u88ab\u5f02\u6b65\u8c03\u7528\uff1b</li> <li>UNIX\u4fe1\u53f7\u4f1a\u88ab\u53d1\u9001\u7ed9\u8fdb\u7a0b\u7684\u968f\u673a\u4e00\u7ebf\u7a0b\u8fdb\u884c\u5904\u7406\uff0c\u56e0\u6b64\u6700\u7ec8\u4fe1\u53f7\u4f1a\u5747\u5300\u5206\u5e03\u5728\u6240\u6709\u7ebf\u7a0b\u4e0a\uff0c\u4e5f\u5c31\u5747\u5300\u83b7\u53d6\u4e86\u6240\u6709\u7ebf\u7a0b\u7684\u8c03\u7528\u6808\u6837\u672c\u3002</li> </ul> <pre><code>// \u6808\u5e27\ntypedef struct {\n jint lineno;\n jmethodID method_id;\n} AGCT_CallFrame;\n\n// \u8c03\u7528\u6808\ntypedef struct {\n    JNIEnv *env;\n    // \u6b63\u5e38\u60c5\u51b5\u4e0b\u6807\u8bc6\u4e86\u83b7\u53d6\u5230\u7684\u8c03\u7528\u6808\u6df1\u5ea6\uff0c\u4f46\u5728Native\u4ee3\u7801\u6267\u884c\u671f\u95f4\u3001GC\u671f\u95f4\u4e0b\u5b83\u5c31\u8868\u793a\u4e3a\u8d1f\u6570\uff0c\u6700\u5e38\u89c1\u7684-2\u4ee3\u8868\u6b64\u523b\u6b63\u5728GC\n    jint num_frames;\n    AGCT_CallFrame *frames;\n} AGCT_CallTrace;\n\n// \u6839\u636eucontext\u5c06\u8c03\u7528\u6808\u586b\u5145\u8fdbtrace\u6307\u9488\nvoid AsyncGetCallTrace(AGCT_CallTrace *trace, jint depth, void *ucontext);\n</code></pre> <p>AsyncGetCallTrace\u975e\u6807\u51c6JVMTI\u51fd\u6570\uff0c\u4e0d\u5728jvmti.h\u4e2d\u58f0\u660e\uff1a</p> <ul> <li>\u5728Agent_OnLoad\u5185\u901a\u8fc7glibc\u63d0\u4f9b\u7684dlsym()\u51fd\u6570\u62ff\u5230\u5f53\u524d\u5730\u5740\u7a7a\u95f4\uff08\u5373\u76ee\u6807JVM\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\uff09\u540d\u4e3a\u201cAsyncGetCallTrace\u201d\u7684\u7b26\u53f7\u5730\u5740\uff1b</li> <li>\u5bf9\u7b26\u53f7\u5730\u5740\uff08\u5373\u51fd\u6570\u6307\u9488\uff09\u6309\u7167\u51fd\u6570\u539f\u578b\u8fdb\u884c\u8f6c\u6362\u5373\u53ef\uff1b</li> </ul> <p>\u6d41\u7a0b\uff1a</p> <ul> <li>\u5165\u53e3\u62ff\u5230jvmtiEnv\u548cAsyncGetCallTrace\u6307\u9488\uff0c\u83b7\u53d6AsyncGetCallTrace\u65b9\u5f0f\u5982\u4e0b</li> </ul> <pre><code>typedef void (*AsyncGetCallTrace)(AGCT_CallTrace *traces, jint depth, void *ucontext);\n// ...\nAsyncGetCallTrace agct_ptr = (AsyncGetCallTrace)dlsym(RTLD_DEFAULT, \"AsyncGetCallTrace\");\nif (agct_ptr == NULL) {\n    void *libjvm = dlopen(\"libjvm.so\", RTLD_NOW);\n    if (!libjvm) {\n        // \u5904\u7406dlerror()...\n    }\n    agct_ptr = (AsyncGetCallTrace)dlsym(libjvm, \"AsyncGetCallTrace\");\n}\n</code></pre> <ul> <li>\u5728OnLoad\u9636\u6bb5\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u505a\u4e00\u4ef6\u4e8b\uff0c\u5373\u6ce8\u518cOnClassLoad\u548cOnClassPrepare\u8fd9\u4e24\u4e2aHook\uff0c\u539f\u56e0\u662fjmethodID\u662f\u5ef6\u8fdf\u5206\u914d\u7684\uff0c\u4f7f\u7528AGCT\u83b7\u53d6Traces\u4f9d\u8d56\u9884\u5148\u5206\u914d\u597d\u7684\u6570\u636e\u3002\u6211\u4eec\u5728OnClassPrepare\u7684CallBack\u4e2d\u5c1d\u8bd5\u83b7\u53d6\u8be5Class\u7684\u6240\u6709Methods\uff0c\u8fd9\u6837\u5c31\u4f7fJVMTI\u63d0\u524d\u5206\u914d\u4e86\u6240\u6709\u65b9\u6cd5\u7684jmethodID</li> </ul> <pre><code>void JNICALL OnClassLoad(jvmtiEnv *jvmti, JNIEnv* jni, jthread thread, jclass klass) {}\n\nvoid JNICALL OnClassPrepare(jvmtiEnv *jvmti, JNIEnv *jni, jthread thread, jclass klass) {\n    jint method_count;\n    jmethodID *methods;\n    jvmti-&gt;GetClassMethods(klass, &amp;method_count, &amp;methods);\n    delete [] methods;\n}\n\n// ...\n\njvmtiEventCallbacks callbacks = {0};\ncallbacks.ClassLoad = OnClassLoad;\ncallbacks.ClassPrepare = OnClassPrepare;\njvmti-&gt;SetEventCallbacks(&amp;callbacks, sizeof(callbacks));\njvmti-&gt;SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_CLASS_LOAD, NULL);\njvmti-&gt;SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_CLASS_PREPARE, NULL);\n</code></pre> <ul> <li>\u5229\u7528SIGPROF\u4fe1\u53f7\u6765\u8fdb\u884c\u5b9a\u65f6\u91c7\u6837\uff1a</li> </ul> <pre><code>// \u8fd9\u91cc\u4fe1\u53f7handler\u4f20\u8fdb\u6765\u7684\u7684ucontext\u5373AsyncGetCallTrace\u9700\u8981\u7684ucontext\nvoid signal_handler(int signo, siginfo_t *siginfo, void *ucontext) {\n    // \u4f7f\u7528AsyncCallTrace\u8fdb\u884c\u91c7\u6837\uff0c\u6ce8\u610f\u5904\u7406num_frames\u4e3a\u8d1f\u7684\u5f02\u5e38\u60c5\u51b5\n}\n\n// ...\n\n// \u6ce8\u518cSIGPROF\u4fe1\u53f7\u7684handler\nstruct sigaction sa;\nsigemptyset(&amp;sa.sa_mask);\nsa.sa_sigaction = signal_handler;\nsa.sa_flags = SA_RESTART | SA_SIGINFO;\nsigaction(SIGPROF, &amp;sa, NULL);\n\n// \u5b9a\u65f6\u4ea7\u751fSIGPROF\u4fe1\u53f7\n// interval\u662fnanoseconds\u8868\u793a\u7684\u91c7\u6837\u95f4\u9694\uff0cAsyncGetCallTrace\u76f8\u5bf9\u4e8e\u540c\u6b65\u91c7\u6837\u6765\u8bf4\u53ef\u4ee5\u9002\u5f53\u9ad8\u9891\u4e00\u4e9b\nlong sec = interval / 1000000000;\nlong usec = (interval % 1000000000) / 1000;\nstruct itimerval tv = {{sec, usec}, {sec, usec}};\nsetitimer(ITIMER_PROF, &amp;tv, NULL);\n</code></pre> <ul> <li>\u5728Buffer\u4e2d\u4fdd\u5b58\u6bcf\u4e00\u6b21\u7684\u91c7\u6837\u7ed3\u679c\uff0c\u6700\u7ec8\u751f\u6210\u5fc5\u8981\u7684\u7edf\u8ba1\u6570\u636e\u5373\u53ef\u3002</li> </ul>"},{"location":"languages/java/performance/cpu_profile.html#_6","title":"\u4f18\u52a3\u52bf","text":"<p>\u4f18\u52bf\uff1a</p> <ul> <li>\u793e\u533a\u4e2d\u76ee\u524d\u6027\u80fd\u5f00\u9500\u6700\u4f4e\u3001\u76f8\u5bf9\u6548\u7387\u6700\u9ad8\u7684CPU Profiler\u5b9e\u73b0\u65b9\u5f0f\uff1b</li> <li>\u7ed3\u5408perf_events\u8fd8\u80fd\u505a\u5230\u540c\u65f6\u91c7\u6837Java\u6808\u4e0eNative\u6808\uff0c\u4e5f\u5c31\u80fd\u540c\u65f6\u5206\u6790Native\u4ee3\u7801\u4e2d\u5b58\u5728\u7684\u6027\u80fd\u70ed\u70b9\uff1b</li> </ul>"},{"location":"languages/java/performance/cpu_profile.html#async-profiler","title":"Async-Profiler","text":"<ul> <li>\u652f\u6301\u57fa\u4e8e HotSpot JVM \u7684OpenJDK, Oracle JDK\uff1b</li> </ul> <p>CPU Profiling</p> <p>stack trace samples that include Java methods, native calls, JVM code and kernel functions.</p> <ul> <li>\u57fa\u4e8e<code>perf_events</code> + <code>AsyncGetCallTrace</code></li> </ul> <p>ALLOCATION profiling</p> <ul> <li>\u4e0d\u9002\u7528\u4ee3\u4ef7\u5927\u7684bytecode instrumentation \u6216\u8005 DTrace probes\uff1b</li> <li>\u4e0d\u5f71\u54cd\u9003\u9038\u5206\u6790\u548c JIT \u4f18\u5316\uff1b</li> <li>\u4f9d\u8d56\u4e8e HotSpot \u7279\u5b9a\u7684callbacks\uff0c\u57fa\u4e8e TLAB \u9a71\u52a8\u91c7\u6837\uff1b</li> </ul>"},{"location":"languages/java/performance/cpu_profile.html#agent-launching","title":"Agent Launching","text":"<pre><code>$ java -agentpath:/path/to/libasyncProfiler.so=start,event=cpu,file=profile.html ...\n</code></pre>"},{"location":"languages/java/performance/cpu_profile.html#_7","title":"\u547d\u4ee4","text":""},{"location":"languages/java/performance/cpu_profile.html#profilersh","title":"profiler.sh","text":"<pre><code>$ ./profiler.sh -o collapsed -f /tmp/traces-%t.txt 8983\n</code></pre>"},{"location":"languages/java/performance/cpu_profile.html#jattach","title":"Jattach","text":"<ul> <li>\u901a\u8fc7 Java Agent \u7684 <code>AgentMain</code>\u65b9\u6cd5\u5b9e\u73b0\u5411\u8fd0\u884c\u4e2d\u7684JVM\u8fdb\u7a0b\u6dfb\u52a0Agent\uff1b</li> <li>\u5bf9\u4e8eJVMTI\uff0c\u9700\u5b9e\u73b0\u4e00\u4e2aAgent_OnAttach()\u51fd\u6570\uff0c\u5f53\u5c06JVMTI Agent Attach\u5230\u76ee\u6807\u8fdb\u7a0b\u65f6\uff0c\u4ece\u8be5\u51fd\u6570\u5f00\u59cb\u6267\u884c\uff1b</li> </ul> <p>\u4ee5Async-Profiler\u4e2d\u7684jattach\u6e90\u7801\u4e3a\u7ebf\u7d22\uff0c\u63a2\u7a76\u4e00\u4e0b\u5982\u4f55\u5229\u7528Attach\u673a\u5236\u7ed9\u8fd0\u884c\u4e2d\u7684JVM\u8fdb\u7a0b\u53d1\u9001\u547d\u4ee4\u3002</p> <pre><code># libagent.so\u5c31\u88ab\u52a0\u8f7d\u5230ID\u4e3a1234\u7684JVM\u8fdb\u7a0b\u4e2d\u5e76\u5f00\u59cb\u6267\u884cAgent_OnAttach\u51fd\u6570\n# \u6267\u884cAttach\u7684\u8fdb\u7a0beuid\u53caegid\uff0c\u4e0e\u88abAttach\u7684\u76ee\u6807JVM\u8fdb\u7a0b\u5fc5\u987b\u76f8\u540c\n$ jattach 1234 load /absolute/path/to/agent/libagent.so true\n</code></pre> <p>\u539f\u7406\uff08\u76f8\u5173\u4ee3\u7801\uff09\uff1a</p> <ul> <li> <p>HotSpot \u63d0\u4f9b\u4e00\u79cd\u7279\u6b8a\u7684\u673a\u5236\uff0c\u53ea\u8981\u7ed9\u5b83\u53d1\u9001\u4e00\u4e2aSIGQUIT\u4fe1\u53f7\uff0c\u5e76\u9884\u5148\u51c6\u5907\u597d.attach_pid\u6587\u4ef6\uff0cHotSpot\u4f1a\u4e3b\u52a8\u521b\u5efa\u4e00\u4e2a\u5730\u5740\u4e3a\u201c/tmp/.java_pid\u201d\u7684UNIX Socket\uff0c\u63a5\u4e0b\u6765\u4e3b\u52a8Connect\u8fd9\u4e2a\u5730\u5740\u5373\u53ef\u5efa\u7acb\u8fde\u63a5\u6267\u884c\u547d\u4ee4\uff1b</p> </li> <li> <p>\u5916\u90e8\u8fdb\u7a0b\u4e0e\u76ee\u6807JVM\u8fdb\u7a0b\u4e4b\u95f4\u53d1\u9001\u7684\u6570\u636e\u683c\u5f0f\u76f8\u5f53\u7b80\u5355\uff0c\u57fa\u672c\u5982\u4e0b\u6240\u793a\uff1a</p> </li> </ul> <pre><code>&lt;PROTOCOL VERSION&gt;\\0&lt;COMMAND&gt;\\0&lt;ARG1&gt;\\0&lt;ARG2&gt;\\0&lt;ARG3&gt;\\0\n</code></pre> <p>\u4ee5\u5148\u524d\u6211\u4eec\u4f7f\u7528\u7684Load\u547d\u4ee4\u4e3a\u4f8b\uff0c\u53d1\u9001\u7ed9HotSpot\u65f6\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>1\\0load\\0/absolute/path/to/agent/libagent.so\\0true\\0\\0\n</code></pre>"},{"location":"languages/java/performance/jvm_profile.html","title":"Uber JVM Profiler","text":""},{"location":"languages/java/performance/jvm_profile.html#_1","title":"\u80cc\u666f","text":"<p>\u89c1uber\u94fe\u63a5\uff1ahttps://eng.uber.com/jvm-profiler/\uff0c2021/10/15.</p>"},{"location":"languages/java/performance/jvm_profile.html#_2","title":"\u529f\u80fd","text":"<p>Java Agent\u7684\u65b9\u5f0f\u5206\u5e03\u5f0f\u6536\u96c6Hadoop/Spark\u7684\u5ea6\u91cf\u6307\u6807\u548c\u5806\u6808\u8ddf\u8e2a\uff0c\u901a\u7528\u7684JVM\u6027\u80fd\u5206\u6790gent\u3002</p> <ul> <li>executor\u7684\u5185\u5b58\u4f7f\u7528\uff0c\u5305\u62ecJava\u5806\u5185\u5b58\uff0c\u975e\u5806\u5185\u5b58\uff0c\u672c\u5730\u5185\u5b58\uff08VmRSS, VmHWM\uff09\uff0c\u5185\u5b58\u6c60\u548c\u7f13\u51b2\u6c60\uff08directed/mapped buffer\uff09\uff1b</li> <li>executor\u7684CPU\u4f7f\u7528\u7387\u548cGC\u4fe1\u606f\uff1b</li> <li>\u4efb\u610fJava\u7c7b\u65b9\u6cd5\uff08\u8fd0\u884c\u6b21\u6570\uff0c\u8fd0\u884c\u65f6\u95f4\uff09\uff1b</li> <li>\u8c03\u8bd5\u4efb\u610fjava\u7c7b\u65b9\u6cd5\u8c03\u7528\u5e76\u8ddf\u8e2a\u5b83\u7684\u53c2\u6570\u503c\uff1b</li> <li>ClientNamenodeProtocolTranslatorPB.getBlockLocations \u6216 addBlock \u8ba1\u7b97\u8bfb\u53d6/\u5199\u5165\u7684\u6587\u4ef6</li> <li>\u5806\u6808\u5206\u6790\uff0c\u751f\u6210Spark\u5e94\u7528\u7684CPU\u65f6\u95f4\u7684\u706b\u7130\u56fe\uff1b</li> <li>\u8c03\u8bd5IO\u6307\u6807\uff08\u5e94\u7528\u7684\u78c1\u76d8\u8bfb/\u5199\u5b57\u8282\uff0cCPU\u7684iowait\uff09\u3002</li> </ul> <p>Uber JVM Profiler\u8fd8\u63d0\u4f9b\u4e86\u9ad8\u7ea7\u7684\u5206\u6790\u529f\u80fd\uff0c\u53ef\u4ee5\u8ddf\u8e2a\u7528\u6237\u4ee3\u7801\u4e0a\u7684\u4efb\u610fJava\u65b9\u6cd5\u548c\u53c2\u6570\uff0c\u800c\u4e0d\u9700\u8981\u7528\u6237\u66f4\u6539\u4ee3\u7801\u3002\u6b64\u7279\u6027\u53ef\u7528\u4e8e\u8ddf\u8e2a\u6bcf\u4e2aSpark\u5e94\u7528\u7a0b\u5e8f\u7684HDFS namenode\u8c03\u7528\u5ef6\u8fdf\uff0c\u5e76\u786e\u5b9a\u540d\u79f0\u8282\u70b9\u7684\u74f6\u9888\u3002\u5b83\u8fd8\u53ef\u4ee5\u8ddf\u8e2a\u6bcf\u4e2aSpark\u5e94\u7528\u7a0b\u5e8f\u8bfb\u53d6\u6216\u5199\u5165\u7684HDFS\u6587\u4ef6\u8def\u5f84\uff0c\u5e76\u8bc6\u522b\u70ed\u6587\u4ef6\u4ee5\u4fbf\u8fdb\u4e00\u6b65\u4f18\u5316\u3002</p> <p></p>"},{"location":"languages/java/performance/jvm_profile.html#_3","title":"\u4f7f\u7528","text":"<p>\u9ed8\u8ba4\u7684\u8f93\u51fa\u6709ConsoleOutputReporter\uff0cFileOutputReporter \u548c KafkaOutputReporter\u3002</p> <p>maven\u7f16\u8bd1\u7684\u65f6\u5019\u53ef\u4ee5\u6307\u5b9aprofile\uff0c\u652f\u6301 RedisOutputReporter \u548c InfluxDBOutputReporter \u3002</p>"},{"location":"languages/java/performance/jvm_profile.html#spark","title":"Spark\u4f7f\u7528","text":"<pre><code>--conf spark.jars=hdfs://hdfs_url/lib/jvm-profiler-1.0.0.jar\n--conf spark.executor.extraJavaOptions=-javaagent:jvm-profiler-1.0.0.jar\n</code></pre>"},{"location":"languages/java/performance/jvm_profile.html#java","title":"Java\u4f7f\u7528","text":""},{"location":"languages/java/performance/jvm_profile.html#main","title":"\u6307\u5b9aMain\u7c7b","text":"<pre><code>java -javaagent:jvm-profiler-1.0.0.jar=reporter=com.uber.profiling.reporters.ConsoleOutputReporter,tag=mytag,metricInterval=5000,durationProfiling=com.uber.profiling.examples.HelloWorldApplication.publicSleepMethod,argumentProfiling=com.uber.profiling.examples.HelloWorldApplication.publicSleepMethod.1,sampleInterval=100 -cp target/jvm-profiler-1.0.0.jar com.uber.profiling.examples.HelloWorldApplication\n</code></pre>"},{"location":"languages/java/performance/jvm_profile.html#jar","title":"\u53ef\u6267\u884c\u7684jar\u5305","text":"<pre><code>java -javaagent:/opt/jvm-profiler/target/jvm-profiler-1.0.0.jar=reporter=com.uber.profiling.reporters.ConsoleOutputReporter,metricInterval=5000,durationProfiling=foo.bar.FooAppication.barMethod,sampleInterval=5000 -jar foo-application.jar\n</code></pre>"},{"location":"languages/java/performance/jvm_profile.html#spring-boot-maven","title":"Spring Boot Maven","text":"<pre><code>mvn spring-boot:run -Dspring-boot.run.jvmArguments=\"-javaagent:/opt/jvm-profiler/target/jvm-profiler-1.0.0.jar=reporter=com.uber.profiling.reporters.ConsoleOutputReporter,metricInterval=5000,durationProfiling=foo.bar.FooController.barMethod,sampleInterval=5000\"\n</code></pre>"},{"location":"languages/java/performance/jvm_profile.html#_4","title":"\u53c2\u6570","text":"<p><code>-javaagent:agent_jar_file.jar=param1=value1,param2=value2</code></p> <ul> <li>reporter\uff1a\u7ed3\u679c\u8f93\u51fa\u7684\u7c7b\uff0c\u5982<code>com.uber.profiling.reporters.ConsoleOutputReporter</code>\uff1b</li> <li>configProvider\uff1a\u914d\u7f6e\u63d0\u4f9b\u7c7b\uff0c\u5982<code>com.uber.profiling.YamlConfigProvider</code>\uff1b</li> <li>configFile\uff1a\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff0c\u672c\u5730\u6587\u4ef6\u6216\u8005HTTP\u8def\u5f84\uff1b</li> <li>tag\uff1aplain text string which will be reported together with the metrics.</li> <li>metricInterval\uff1a\u6536\u96c6metrics\u7684\u95f4\u9694\u65f6\u95f4</li> <li>durationProfiling\uff1a\u5206\u6790\u7279\u5b9a\u7684\u7c7b\u548c\u65b9\u6cd5\uff0c\u652f\u6301\u901a\u914d\u7b26\uff0c\u5982<code>com.uber.profiling.examples.HelloWorldApplication.publicSleepMethod</code>\uff1b</li> <li>argumentProfiling\uff1a\u5206\u6790\u7279\u5b9a\u7684\u65b9\u6cd5\u53c2\u6570\uff0c\u5982<code>com.uber.profiling.examples.HelloWorldApplication.publicSleepMethod.1</code>\uff1b</li> <li>sampleInterval\uff1a\u5806\u6808\u91c7\u6837\u7684\u9891\u7387\uff08\u6beb\u79d2)\uff0c0\u8868\u793a\u7981\u7528\uff1b</li> <li>ioProfiling\uff1a\u662f\u5426\u5206\u6790IO\u6307\u6807\uff0ctrue\u6216false\uff1b</li> <li>brokerList\uff1aKafkaOutputReporter\u7684broker list\uff1b</li> <li>topicPrefix\uff1aKafkaOutputReporter\u7684topic\u524d\u7f00\uff1b</li> <li>outputDir\uff1aFileOutputReporter\u7684\u8f93\u51fa\u8def\u5f84</li> </ul>"},{"location":"languages/java/performance/jvm_profile.html#_5","title":"\u5806\u6808\u7684\u706b\u7130\u56fe","text":"<p>\u5f00\u542fsampleInterval</p> <pre><code>python stackcollapse.py -i Stacktrace.json &gt; Stacktrace.folded\nflamegraph.pl Stacktrace.folded &gt; Stacktrace.svg\n</code></pre>"},{"location":"languages/java/performance/jvm_profile.html#_6","title":"\u6307\u6807","text":""},{"location":"languages/java/performance/jvm_profile.html#1-cpu","title":"1. CPU\u548c\u5185\u5b58","text":"Name Description Sample Value Note time \u65f6\u95f4\u6233\uff08\u7528\u4e8egrafana database\uff09 1582504748538000000 \u65f6\u95f4\u6233 appId Application id of the job that is running. application_1576797426048_311346 \u4f7f\u7528Yarn\uff0c\u5219\u662fYarn App Id bufferPools-direct-count Total number of direct byte buffers used at the recorded time. 55 Depending on your application, this can be a smaller number bufferPools-direct-memoryUsed Total memory of the direct byte buffers used in bytes. 18950 An estimate. This value should be very similar to the total capacity for a healthy JVM. bufferPools-direct-name Name of the buffer pool. direct Direct buffer pools are always named direct. bufferPools-direct-totalCapacity Available capacity in bytes in the direct buffer pool. 18949 Capacity should be similar to memoryUsed for a healthy JVM. bufferPools-mapped-count Total number of mapped byte buffers used at the recorded time. 0 In general, spark applications will not require mapped buffer pools. bufferPools-mapped-memoryUsed Total memory of the mapped byte buffers used in bytes. 0 An estimate. This value should be very similar to the total capacity for a healthy JVM. bufferPools-mapped-name Name of the buffer pool. mapped Mapped buffer pools are always named mapped. bufferPools-mapped-totalCapacity Available capacity in bytes in the mapped buffer pool. 0 Capacity should be similar to memoryUsed for a healthy JVM. epochMillis System time in milliseconds when this value was recorded. 1582504781508 gc-PSMarkSweep-collectionCount Total number of collections that have occurred for PS MarkSweep. 7 -1 if collection count is undefined for this collector. gc-PSMarkSweep-collectionTime approximate accumulated collection elapsed time in milliseconds. 914 -1 if collection count is undefined for this collector. gc-PSMarkSweep-name Name of the collector. PS MarkSweep Constant value. gc-PSScavenge-collectionCount Total number of collections that have occurred for PS Scavenge. 25 -1 if collection count is undefined for this collector. gc-PSScavenge-collectionTime approximate accumulated collection elapsed time in milliseconds. 1206 -1 if collection count is undefined for this collector. gc-PSScavenge-name Name of the collector. PS Scavenge Constant value. heapMemoryCommitted Amount of memory in bytes guaranteed for the JVM to use. 375914496 heapMemoryMax Max amount of memory in bytes that can be used 11453595648 Also refer to spark.memory.fraction for the fraction managed by spark heapMemoryTotalUsed Total heap memory used in bytes 86386032 Total memory used should be less than committed and max heap memory. host Hostname of the executor uber-bigdata-datanode2.uber.com memoryPools-CodeCache-name Name of the code cache. Code Cache Constant value. memoryPools-CodeCache-peakUsageCommitted Peak committed memory of this pool since the JVM was started 2555904 memoryPools-CodeCache-peakUsageMax Peak value of usageMax of this pool since the JVM was started 251658240 memoryPools-CodeCache-peakUsageUsed Peak value of memory of this pool used since the JVM was started. 582656 memoryPools-CodeCache-type The type of this memory pool. Non-heap memory Code cache is a non-heap memory. So this value will always be constant. memoryPools-CodeCache-usageCommitted Total memory in bytes committed for this pool. 2555904 memoryPools-CodeCache-usageMax The maximum amount of memory that can be used by this pool. 251658240 -1 if undefined. Not guaranteed to be available if greater than the committed memory. memoryPools-CodeCache-usageUsed Amount of memory used by this pool. 582656 Having some code cache memory free ensures it is usable for JIT compilation. memoryPools-CompressedClassSpace-name Name of the compressed class space. Compressed Class Space Is constant. This space is allocated in native memory for class metadata. memoryPools-CompressedClassSpace-peakUsageCommitted Peak committed memory of this pool since JVM was started. 1572864 memoryPools-CompressedClassSpace-peakUsageMax Peak value of usageMax of this pool since the JVM was started. 1073741824 memoryPools-CompressedClassSpace-peakUsageUsed Peak value of usage of this pool since the JVM was started. 1389800 memoryPools-CompressedClassSpace-type Type of memory of this memory pool. Non-heap memory Compressed class space is native memory but is managed by the JVM memoryPools-CompressedClassSpace-usageCommitted Total memory in bytes committed for this pool. 1572864 memoryPools-CompressedClassSpace-usageMax The maximum amount of memory that can be used by this pool 1073741824 -1 if undefined. Not guaranteed to be available if greater than the committed memory. memoryPools-CompressedClassSpace-usageUsed Amount of memory used by this pool. 1389800 memoryPools-Metaspace-name Name of the Metaspace. Metaspace Is constant. Metaspace is always called metaspace. memoryPools-Metaspace-peakUsageCommitted Peak committed memory of this pool since JVM was started. 12320768 memoryPools-Metaspace-peakUsageMax Peak value of usageMax of this pool since the JVM was started. -1 -1 if undefined. memoryPools-Metaspace-peakUsageUsed Peak value of usage of this pool since the JVM was started. 11768752 memoryPools-Metaspace-type Type of memory of this memory pool. Non-heap memory Metaspace is native memory (since JDK 8) but is managed by the JVM memoryPools-Metaspace-usageCommitted Total memory in bytes committed for this pool. 12320768 memoryPools-Metaspace-usageMax The maximum amount of memory that can be used by this pool -1 -1 if undefined. Not guaranteed to be available if greater than the committed memory. memoryPools-Metaspace-usageUsed Amount of memory used by this pool. 11768752 The amount of space used by loaded classes. memoryPools-PSEdenSpace-name Name of the young generation heap space. PS Eden Space Is constant. PS Eden space is always called PS Eden Space. memoryPools-PSEdenSpace-peakUsageCommitted Peak committed memory of this pool since JVM was started. 98041856 memoryPools-PSEdenSpace-peakUsageMax Peak value of usageMax of this pool since the JVM was started. 4262461440 -1 if undefined. memoryPools-PSEdenSpace-peakUsageUsed Peak value of usage of this pool since the JVM was started. 92270136 memoryPools-PSEdenSpace-type Type of memory of this memory pool. Heap memory PS Eden space is a portion of the heap memory that is managed by the JVM memoryPools-PSEdenSpace-usageCommitted Total memory in bytes committed for this pool. 98041856 memoryPools-PSEdenSpace-usageMax The maximum amount of memory that can be used by this pool 8589934592 -1 if undefined. Not guaranteed to be available if greater than the committed memory. memoryPools-PSEdenSpace-usageUsed Amount of memory used by this pool (and by newly loaded classes). 92270136 A continuously increasing value indicates an unhealthy garbage collection. memoryPools-PSOldGen-name Name of the old generation heap space. PS Old Gen Is constant. PS Old Gen space is always called PS Old Gen. memoryPools-PSOldGen-peakUsageCommitted Peak committed memory of this pool since JVM was started. 261619712 memoryPools-PSOldGen-peakUsageMax Peak value of usageMax of this pool since the JVM was started. 8589934592 -1 if undefined. memoryPools-PSOldGen-peakUsageUsed Peak value of usage of this pool since the JVM was started. 0 memoryPools-PSOldGen-type Type of memory of this memory pool. Heap memory PS Old Gen space is a portion of the heap memory that is managed by the JVM memoryPools-PSOldGen-usageCommitted Total memory in bytes committed for this pool. 261619712 memoryPools-PSOldGen-usageMax The maximum amount of memory that can be used by this pool 8589934592 -1 if undefined. Not guaranteed to be available if greater than the committed memory. memoryPools-PSOldGen-usageUsed Amount of memory used by this pool (by objects beyond threshold). 0 A continuously increasing value indicates an unhealthy garbage collection. memoryPools-PSSurvivorSpace-name Name of the survivor heap space. PS Survivor Space Is constant. PS Survivor Space is always called PS Survivor Space. memoryPools-PSSurvivorSpace-peakUsageCommitted Peak committed memory of this pool since JVM was started. 16252928 memoryPools-PSSurvivorSpace-peakUsageMax Peak value of usageMax of this pool since the JVM was started. 16252928 -1 if undefined. memoryPools-PSSurvivorSpace-peakUsageUsed Peak value of usage of this pool since the JVM was started. 0 memoryPools-PSSurvivorSpace-type Type of memory of this memory pool. Heap memory PS Survivor Space is a portion of the heap memory that is managed by the JVM memoryPools-PSSurvivorSpace-usageCommitted Total memory in bytes committed for this pool. 16252928 memoryPools-PSSurvivorSpace-usageMax The maximum amount of memory that can be used by this pool 16252928 -1 if undefined. Not guaranteed to be available if greater than the committed memory. memoryPools-PSSurvivorSpace-usageUsed Amount of memory used by this pool (and by newly loaded classes). 0 A continuously increasing value indicates an unhealthy garbage collection. name Process name (number) 12345@uber-bigdata-datanode2.uber.com Also contains host name. nonHeapMemoryCommitted Amount of non heap memory in bytes committed for the JVM to use. 16187392 Total of committed of all non-heap memory pools. nonHeapMemoryMax Maximum amount of memory in bytes that can be used. -1 -1 if undefined. nonHeapMemoryTotalUsed Amount of non heap memory (metaspace, code cache) used. 13510368 Total of usage of all non-heap memory pools. processCpuLoad The recent cpu usage for the JVM process. 4.335671366438364e-9 processCpuTime CPU time used by JVM process in nanoseconds. 2340000000 processUuid UUID of the JVM process. 48abf05b-dfd4-4069-86c6-8cdbc195bd40 processUuid_1 UUID of the JVM process. 48abf05b-dfd4-4069-86c6-8cdbc195bd40 Appears to be a duplicate metric. role Role of this spark executor. executor Can be either executor or driver. systemCpuLoad The recent cpu usage for the whole system. 0.03703887412577616 vmHWM Peak resident set size (\"High Water Mark\") in bytes for the JVM. 142876672 \u8868\u793aJVM\u5728linux\u4e2d\u5b9e\u9645\u4f7f\u7528\u7684\u7269\u7406\u5185\u5b58(RAM)\u3002 vmPeak Peak of the virtual memory usage in bytes for the JVM. 15130554368 JVM\u865a\u62df\u5185\u5b58\u4f7f\u7528\u7684\u5cf0\u503c vmRSS JVM physical memory usage (resident set size) in bytes. 142876672 \u5e94\u7528\u7a0b\u5e8f\u6b63\u5728\u4f7f\u7528\u7684\u7269\u7406\u5185\u5b58\u7684\u5927\u5c0f\uff0c\u5c31\u662f\u7528ps\u547d\u4ee4\u7684\u53c2\u6570rss\u7684\u503c (rss) vmSize Virtual memory size for the JVM. 15130550272 This memory includes swap space, so a large value can imply high swap memory usage."},{"location":"languages/java/performance/jvm_profile.html#2-io","title":"2. IO","text":"Name Description Sample Value Notes time Time series value for grafana database. 1582504713009000000 appId Application id for the job that is running. application_1576797426048_311346 If using yarn, this is the yarn application id. epochMillis System time in milliseconds when this value was recorded. 1582504713001 host Hostname of the executor. uber-bigdata-datanode2.uber.com name Process name (number). 12345@uber-bigdata-datanode2.uber.com Includes the hostname as well. processUuid UUID of the JVM process. 89a256c7-96c3-4e48-b5ba-f55e886ba743 processUuid_1 UUID of the JVM process. 89a256c7-96c3-4e48-b5ba-f55e886ba743 Appears to be a duplicate metric. role Role of this spark executor. executor Can be either executor or driver. self-io-rchar-1 The number of characters read by this JVM process. 8192340 The \"-1\" is coming from the formatter for influx which was used when writting this. self-io-read_bytes-1 Attempt to count the bytes read by this JVM process from storage. 1892352 self-io-wchar-1 The number of characters written to disk by this JVM process. 51016 self-io-write_bytes-1 Attempt to count the bytes written by JVM process to storage. 86016 stat-cpu-N CPU entry found in /proc//stat. cpu, cpu0, cpu1, cpu2 ... N is the CPU number starting at cpu-1 (i.e. cpu) which aggregates all other CPU lines. stat-idle-N Time the N-th CPU spent in the idle task. 53679018 Time is in USER_HZ (1/100th of a second). stat-iowait-N Time spent by N-th CPU waiting for I/O to complete. 137645010 stat-nice-N Time spent by N-th CPU in user mode with low priority (nice). 104 Low idle time with high nice time are indications of busy background tasks running. stat-system-N Time spent by N-th CPU in system mode. 32700364 Time spent at kernel level. stat-user-N Time spent by N-th CPU at the user (application) level 279816973"},{"location":"languages/java/performance/jvm_profile.html#3-process-info","title":"3. Process Info","text":"Name Description Sample Value Notes time Time series value for grafana database. 1582504713009000000 agentVersion A constant value defined in code. 1.0.0 Agent version will always be 1.0.0. appId Application id for the job that is running. application_1576797426048_311346 If using yarn, this is the yarn application id. cmdline Contains JVM command executed and input arguments and classpath. /usr/jdk64/jdk1.8.0_112/bin/java -javaagent... epochMillis System time in milliseconds when this value was recorded. 1582504713001 host Hostname of the executor. uber-bigdata-datanode2.uber.com jvmClassPath Contains JVM classpath entries. --user-class-path .../jvm-profiler-1.0.0.jar This entry is emtpy if cmdLine is not empty. This is to avoid duplicate information. jvmInputArguments Contains JVM input arguments. metricInterval=5000,sampleInterval=5000 ... This entry is emtpy if cmdLine is not empty. This is to avoid duplicate information. name Process name (number). 12345@uber-bigdata-datanode2.uber.com Includes the hostname as well. processUuid UUID of the JVM process. 89a256c7-96c3-4e48-b5ba-f55e886ba743 processUuid_1 UUID of the JVM process. 89a256c7-96c3-4e48-b5ba-f55e886ba743 Appears to be a duplicate metric. role Role of this spark executor. executor Can be either executor or driver. xmxBytes Maximum JVM heap size in bytes. 12884901888"},{"location":"languages/java/performance/jvm_profile.html#4-stack-trace","title":"4. Stack Trace","text":"Name Description Sample Value Notes time Time series value for grafana database. 1582504713009000000 appId Application id for the job that is running. application_1576797426048_311346 If using yarn, this is the yarn application id. count Number of elements appended to the metrics buffer. 1 This value is usually 1, but not guaranteed to be constant. It is thread-safe. endEpoch System time in milliseconds after resetting the metrics buffer. 1582504712723 The metrics buffer is an internal buffer used by this profiling application. host Hostname of the executor. uber-bigdata-datanode2.uber.com name Process name (number). 12345@uber-bigdata-datanode2.uber.com Includes the hostname as well. processUuid UUID of the JVM process. 89a256c7-96c3-4e48-b5ba-f55e886ba743 processUuid_1 UUID of the JVM process. 89a256c7-96c3-4e48-b5ba-f55e886ba743 Appears to be a duplicate metric. role Role of this spark executor. executor Can be either executor or driver. stacktrace Stacktrace starting from bottom of the stacktrace. java.lang.Object.wait,java.lang.ref ... Trims the top method (most nested method) if the size is too large (800k characters) startEpoch System time in milliseconds before resetting the metrics buffer. 1582504710523 The metrics buffer is an internal buffer used by this profiling application. threadName Name of the thread for which stacktrace is displayed. Signal Dispatcher threadState State of the thread when this stacktrace was captured. NEW, RUNNABLE, BLOCKED, WAITING ..."},{"location":"languages/java/performance/jvm_profile.html#5-thread-info","title":"5. Thread Info","text":"Name Description Sample Value Notes time Time series value for grafana database. 1582504713009000000 epochMillis System time in milliseconds when this value was recorded. 1582504781508 host Hostname of the executor. uber-bigdata-datanode2.uber.com name Process name (number). 12345@uber-bigdata-datanode2.uber.com Includes the hostname as well. appId Application id for the job that is running. application_1576797426048_311346 If using yarn, this is the yarn application id. processUuid UUID of the JVM process. 89a256c7-96c3-4e48-b5ba-f55e886ba743 role Role of this spark executor. executor Can be either executor or driver. totalStartedThreadCount Total Number of Thread created so far since JVm Launch. 10 liveThreadCount Number of thread which are currently active. 8 newThreadCount Number of thread which are newly Created. 3 Derived from last Cycle Total Threads. peakThreadCount the peak live thread count since the JVM start 8"},{"location":"linux/acls.html","title":"POSIX ACLs","text":"<p>\u5728 linux\u4e0b,\u5bf9\u4e00\u4e2a\u6587\u4ef6(\u6216\u8005\u8d44\u6e90)\u53ef\u4ee5\u8fdb\u884c\u64cd\u4f5c\u7684\u5bf9\u8c61\u88ab\u5206\u4e3a\u4e09\u7c7b: </p> <ul> <li>file owner(\u6587\u4ef6\u7684\u62e5\u6709\u8005)\uff0cgroup(\u7ec4,\u6ce8\u610f\u4e0d\u4e00\u5b9a\u662f\u6587\u4ef6\u62e5\u6709\u8005\u6240\u5728\u7684\u7ec4)\uff0cother (\u5176\u4ed6)</li> <li>\u5bf9\u4e8e\u6bcf\u4e00\u7c7b\u522b\u53c8\u5206\u522b\u5b9a\u4e49\u4e86read, write and execute/search \u6743\u9650\uff08\u8fd9\u91cc\u4e0d\u8ba8\u8bbaSUID, SGID\u4ee5\u53caSticky bit\u7684\u8bbe\u7f6e\uff09\u3002</li> </ul> <p>\u8fd9\u79cd\u6743\u9650\u63a7\u5236\u7c92\u5ea6\u592a\u7c97\u3002ACL\u5c31\u662f\u53ef\u4ee5\u8bbe\u7f6e\u7279\u5b9a\u7528\u6237\u6216\u8005\u7528\u6237\u7ec4\u5bf9\u4e8e\u4e00\u4e2a\u6587\u4ef6/\u6587\u4ef6\u5939\u7684\u64cd\u4f5c\u6743\u9650\u3002</p>"},{"location":"linux/acls.html#_1","title":"\u5b89\u88c5\u8bbe\u7f6e","text":"<pre><code>yum -y install libacl acl\n</code></pre> <p>\u9700\u8981\u78c1\u76d8\u5206\u533a\u7684\u652f\u6301\u6c38\u4e45\u542f\u7528acl\uff08centos 7\u597d\u50cf\u4e0d\u9700\u8981\u4ee5\u4e0b\u7684\u64cd\u4f5c\u5c31\u53ef\u4ee5\u652f\u6301ACL\uff09\uff0c\u4ee5\u5206\u533a/data\u4e3a\u4f8b</p> <pre><code># vi /etc/fstab\nLABEL=/data /data ext3 defaults,acl 1 2\n</code></pre> <p>\u5728\u542f\u7528\u4e86acl\u53c2\u6570\u4e4b\u540e\u91cd\u65b0\u52a0\u8f7d/data\u5206\u533a</p> <pre><code>mount -o remount /data\ncat /etc/mtab | grep /data\n# /dev/sda5 /data ext3 rw,acl 0 0\n</code></pre> <p>\u51fa\u73b0\u4e0a\u9762\u7684\u4fe1\u606f\u4ee3\u8868\u5206\u533a\u7684acl\u529f\u80fd\u5df2\u7ecf\u6b63\u5e38\u52a0\u8f7d\u3002</p>"},{"location":"linux/acls.html#acl","title":"ACL\u540d\u8bcd\u89e3\u91ca","text":"<p>ACL \u662f\u7531\u4e00\u7cfb\u5217\u7684Access Entry\u6240\u7ec4\u6210\u7684. \u6bcf\u4e00\u6761Access Entry\u5b9a\u4e49\u4e86\u7279\u5b9a\u7684\u7c7b\u522b\u53ef\u4ee5\u5bf9 \u6587\u4ef6\u62e5\u6709\u7684\u64cd\u4f5c\u6743\u9650. </p> <p>Access Entry\u6709\u4e09\u4e2a\u7ec4\u6210\u90e8\u5206: Entry tag type, qualifier(optional), \u6743\u9650</p> <p>Entry tag type, \u5b83\u6709\u4ee5\u4e0b\u51e0\u4e2a\u7c7b\u578b</p> <ul> <li>ACL_USER_OBJ: \u76f8\u5f53\u4e8eLinux\u91ccfile_owner\u7684\u6743\u9650</li> <li>ACL_USER: \u5b9a\u4e49\u4e86\u989d\u5916\u7684\u7528\u6237\u53ef\u4ee5\u5bf9\u6b64\u6587\u4ef6\u62e5\u6709\u7684\u6743\u9650</li> <li>ACL_GROUP_OBJ: \u76f8\u5f53\u4e8eLinux\u91ccgroup\u7684\u6743\u9650</li> <li>ACL_GROUP: \u5b9a\u4e49\u4e86\u989d\u5916\u7684\u7ec4\u53ef\u4ee5\u5bf9\u6b64\u6587\u4ef6\u62e5\u6709\u7684\u6743\u9650</li> <li>ACL_MASK: \u5b9a\u4e49\u4e86ACL_USER, ACL_GROUP_OBJ\u548cACL_GROUP\u7684\u6700\u5927\u6743\u9650</li> <li>ACL_OTHER: \u76f8\u5f53\u4e8eLinux\u91ccother\u7684\u6743\u9650</li> </ul> <p>qualifier\uff0c\u5b9a\u4e49\u4e86\u7279\u5b9a\u7528\u6237\u548c\u7528\u6237\u7ec4\uff0c\u53ea\u6709user\u548cgroup\u624d\u6709qualifier\u3002</p> <p><code>setfacl</code>\u7528\u6765\u8bbe\u7f6e\u6587\u4ef6/\u76ee\u5f55\u7684ACL</p> <pre><code>setfacl -m u:zyq:rw test.txt\n</code></pre> <p><code>getfacl</code>\u547d\u4ee4\u6765\u67e5\u770b\u4e00\u4e2a\u5b9a\u4e49\u597d\u4e86\u7684ACL\u6587\u4ef6</p> <pre><code>[root@zyq-server data]# getfacl test.txt\n# file: test.txt\n# owner: root\n# group: family\nuser::rw-               # \u5b9a\u4e49\u4e86ACL_USER_OBJ, \u8bf4\u660efile owner\u62e5\u6709\u8bfb\u548c\u5199\u7684\u6743\u9650\nuser:zyq:rw-            # \u5b9a\u4e49\u4e86ACL_USER,\u8fd9\u6837\u7528\u6237zyq\u5c31\u62e5\u6709\u4e86\u5bf9\u6587\u4ef6\u7684\u8bfb\u5199\u6743\ngroup::rw-              # \u5b9a\u4e49\u4e86ACL_GROUP_OBJ,\u8bf4\u660e\u6587\u4ef6\u7684group\u62e5\u6709read\u548cwrite \u6743\u9650\ngroup:jackuser:rw-      # \u5b9a\u4e49\u4e86ACL_GROUP,\u4f7f\u5f97jackuser\u7ec4\u62e5\u6709\u4e86\u5bf9\u6587\u4ef6\u7684read \u548cwrite\u6743\u9650\nmask::rw-               # \u5b9a\u4e49\u4e86ACL_MASK\u7684\u6743\u9650\u4e3aread and write\nother::---              # \u5b9a\u4e49\u4e86ACL_OTHER\u7684\u6ca1\u6709\u4efb\u4f55\u6743\u9650\u64cd\u4f5c\u6b64\u6587\u4ef6\n</code></pre> <p>\u5f53\u4efb\u4f55\u4e00\u4e2a\u6587\u4ef6\u62e5\u6709\u4e86ACL_USER\u6216\u8005ACL_GROUP\u7684\u503c\u4ee5\u540e\u53ef\u4ee5\u79f0\u5b83\u4e3aACL\u6587\u4ef6\uff0c+\u53f7\u5c31\u662f\u7528\u6765\u63d0\u793a</p> <pre><code>[root@zyq-server data]# ll test.txt\n-rw-rw-r--+ 1 root root 0 12-27 22:55 test.txt  \n</code></pre>"},{"location":"linux/acls.html#acl_mask-effective","title":"ACL_MASK \u548c Effective \u6743\u9650","text":"<p>1\uff09 \u5982\u679c\u6587\u4ef6\u6709ACL_MASK\u503c,\u90a3\u4e48\u5f53\u4e2d\u90a3\u4e2arw-\u4ee3\u8868\u7684\u5c31\u662fmask\u503c\u800c\u4e0d\u518d\u662fgroup \u6743\u9650\uff1b</p> <p>2\uff09 ACL_MASK\u7684\u89c4\u5b9a\u4e86ACL_USER, ACL_GROUP_OBJ\u548cACL_GROUP\u7684\u6700\u5927\u6743\u9650\uff1b</p>"},{"location":"linux/acls.html#default-acl","title":"Default ACL","text":"<p>Default ACL\u662f\u6307\u5bf9\u4e8e\u4e00\u4e2a\u76ee\u5f55\u8fdb\u884cDefault ACL\u8bbe\u7f6e\uff0c\u5e76\u4e14\u5728\u6b64\u76ee\u5f55\u4e0b\u5efa\u7acb\u7684\u6587\u4ef6\u90fd\u5c06\u7ee7\u627f\u6b64\u76ee\u5f55\u7684ACL\u3002</p> <pre><code># d \u6307 default\n[root@zyq-server data]# setfacl -m d:smbuser:rw mydir/\n[root@zyq-server data]# getfacl mydir/\n# file: mydir/\n# owner: root\n# group: root\nuser::rwx\ngroup::r-x\nother::r-x\ndefault:user::rwx\ndefault:user:smbuser:rw-\ndefault:group::r-x\ndefault:mask::rwx\ndefault:other::r-x\n</code></pre> <p>\u521b\u5efa\u65b0\u6587\u4ef6\u6216\u5b50\u76ee\u5f55\u65f6\uff0c\u5b83\u4f1a\u81ea\u52a8\u5c06\u5176\u7236\u76ee\u5f55\u7684\u9ed8\u8ba4ACL\u590d\u5236\u5230\u81ea\u5df1\u7684\u8bbf\u95eeACL\u4e2d\u3002</p> <p>\u5bf9\u7236\u7ea7\u9ed8\u8ba4ACL\u7684\u540e\u7eed\u66f4\u6539\u4e0d\u4f1a\u66f4\u6539\u73b0\u6709\u5b50\u7ea7\u3002</p>"},{"location":"linux/bash.html","title":"Bash","text":"<p>GNU Bourne-Again SHell</p> <p>login shell \uff1a\u767b\u5f55\u7684shell</p> <p>interactive shell \uff1a\u6267\u884c\u811a\u672c\u4f1a\u53d8\u6210 non-interactive shell</p>"},{"location":"linux/bash.html#_1","title":"\u767b\u5f55\u65b9\u5f0f","text":""},{"location":"linux/bash.html#interactive-login-shell","title":"interactive + login shell","text":"<p><code>bash -l</code>\u547d\u4ee4\uff0c\u5b83\u4f1a\u6253\u5f00\u4e00\u4e2alogin shell\uff1b</p> <p><code>ssh user@remote</code> \u4e5f\u4f1a\u5f97\u5230\u4e00\u4e2alogin shell\uff1b</p> <p>shell\u9996\u5148\u52a0\u8f7d<code>/etc/profile</code>\uff0c\u7136\u540e\u518d\u5c1d\u8bd5\u4f9d\u6b21\u53bb\u52a0\u8f7d\u4e0b\u5217\u4e09\u4e2a\u914d\u7f6e\u6587\u4ef6\u4e4b\u4e00\uff0c\u4e00\u65e6\u627e\u5230\u5176\u4e2d\u4e00\u4e2a\u4fbf\u4e0d\u518d\u63a5\u7740\u5bfb\u627e\uff1a</p> <ul> <li>~/.bash_profile</li> <li>~/.bash_login</li> <li>~/.profile</li> </ul> <p><code>.bash_profile</code>\u548c<code>.profile</code>\u53ef\u4ee5\u5f88\u597d\u7684\u5904\u7406bash\u548cBourne shell\u4e4b\u95f4\u7684\u5207\u6362\u3002</p> <p>\u6700\u4f73\u5b9e\u8df5\uff1a</p> <ul> <li>\u5e94\u8be5\u5c3d\u91cf\u675c\u7edd\u4f7f\u7528<code>.bash_login</code>\uff0c\u5982\u679c\u5df2\u7ecf\u521b\u5efa\uff0c\u90a3\u4e48\u9700\u8981\u521b\u5efa<code>.bash_profile</code>\u6765\u5c4f\u853d\u5b83\u88ab\u8c03\u7528</li> <li><code>.bash_profile</code>\u9002\u5408\u653e\u7f6ebash\u7684\u4e13\u5c5e\u547d\u4ee4\uff0c\u53ef\u4ee5\u5728\u5176\u6700\u540e\u8bfb\u53d6<code>.profile</code>\uff0c\u5982\u6b64\u4e00\u6765\uff0c\u4fbf\u53ef\u4ee5\u5f88\u597d\u7684\u5728Bourne shell\u548cbash\u4e4b\u95f4\u5207\u6362\u4e86\uff1b</li> </ul>"},{"location":"linux/bash.html#non-interactive-login-shell","title":"non-interactive + login shell","text":"<p><code>bash -l script.sh</code></p> <p>-l\u53c2\u6570\u662f\u5c06shell\u4f5c\u4e3a\u4e00\u4e2alogin shell\u542f\u52a8\uff0c\u800c\u6267\u884c\u811a\u672c\u53c8\u4f7f\u5b83\u4e3anon-interactive shell\u3002</p> <p>\u914d\u7f6e\u6587\u4ef6\u7684\u52a0\u8f7d\u4e0e\u7b2c\u4e00\u79cd\u5b8c\u5168\u4e00\u6837</p>"},{"location":"linux/bash.html#interactive-non-login-shell","title":"interactive + non-login shell","text":"<p><code>bash</code> </p> <p>\u5728\u4e00\u4e2a\u5df2\u6709shell\u4e2d\u76f4\u63a5\u8fd0\u884c<code>bash</code>\uff0c\u6b64\u65f6\u4f1a\u6253\u5f00\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u7684shell\uff0c\u800c\u56e0\u4e3a\u4e0d\u518d\u9700\u8981\u767b\u9646\uff0c\u56e0\u6b64\u4e0d\u662flogin shell\u3002</p> <p>\u542f\u52a8shell\u65f6\u4f1a\u53bb\u67e5\u627e\u5e76\u52a0\u8f7d<code>~/.bashrc</code>\u6587\u4ef6\u3002</p>"},{"location":"linux/bash.html#bashrc-vs-profile","title":"bashrc vs profile","text":"<ul> <li>profile\u7c7b\u578b\u6587\u4ef6\u662f\u67d0\u4e2a\u7528\u6237\u552f\u4e00\u7684\u7528\u6765\u8bbe\u7f6e\u5168\u5c40\u73af\u5883\u53d8\u91cf\u7684\u5730\u65b9\uff0c\u7528\u6237\u53ef\u4ee5\u6709\u591a\u4e2ashell\u6bd4\u5982bash, sh, zsh\u7b49\uff0c\u542f\u52a8\u4e00\u4e2alogin shell\u4f1a\u52a0\u8f7d\u6b64\u6587\u4ef6\uff0c\u540e\u9762\u7531\u6b64shell\u4e2d\u542f\u52a8\u7684\u65b0shell\u8fdb\u7a0b\u5982bash\uff0csh\uff0czsh\u7b49\u90fd\u53ef\u4ee5\u7531login shell\u4e2d\u7ee7\u627f\u73af\u5883\u53d8\u91cf\u7b49\u914d\u7f6e\u3002</li> <li>bashrc\uff0c\u5176\u540e\u7f00<code>rc</code>\u7684\u610f\u601d\u4e3aRun Commands\uff0c\u6b64\u5904\u5b58\u653ebash\u9700\u8981\u8fd0\u884c\u7684\u547d\u4ee4\uff0c\u4f46\u6ce8\u610f\uff0c\u8fd9\u4e9b\u547d\u4ee4\u4e00\u822c\u53ea\u7528\u4e8e\u4ea4\u4e92\u5f0f\u7684shell\uff0c\u901a\u5e38\u5728\u8fd9\u91cc\u4f1a\u8bbe\u7f6e\u4ea4\u4e92\u6240\u9700\u8981\u7684\u6240\u6709\u4fe1\u606f\uff0c\u6bd4\u5982bash\u7684\u8865\u5168\u3001alias\u3001\u989c\u8272\u3001\u63d0\u793a\u7b26\u7b49\u7b49\u3002</li> </ul>"},{"location":"linux/bash.html#non-interactive-non-login-shell","title":"non-interactive + non-login shell","text":"<p><code>bash script.sh</code></p> <p>\u627e\u73af\u5883\u53d8\u91cf<code>BASH_ENV</code>\uff0c\u5c06\u53d8\u91cf\u7684\u503c\u4f5c\u4e3a\u6587\u4ef6\u540d\u8fdb\u884c\u67e5\u627e\uff0c\u5982\u679c\u627e\u5230\u4fbf\u52a0\u8f7d\u5b83\u3002</p>"},{"location":"linux/bash.html#ssh","title":"ssh \u8bf4\u660e","text":"<p><code>ssh user@remote cmd</code></p> <p>ssh man page</p> <p>If command is specified, it is executed on the remote host instead of a login shell.</p> <p>When the user's identity has been accepted by the server, the server executes the given command in a non-interactive session.</p> <p>\u5373ssh \u5e94\u8be5\u662fnon-interactive + non-login\uff0c\u4f46\u662fbash\u4e2d\u6709\u8bf4\u660e</p> <p>Bash attempts to determine when it is being run with its standard input connected to a network connection, as when executed by the remote shell daemon, usually rshd, or the  secure shell  daemon sshd.  If bash determines it is being run in this fashion, it reads and executes commands from ~/.bashrc, if that file exists and is readable.  It will not do this if invoked as sh. </p> <p>\u5373 ssh user@remote cmd \u65f6\u4f1a\u52a0\u8f7d ~/.bashrc\u3002</p> <p>\u9ed8\u8ba4Debian bashrc\u6846\u67b6\u4e2d\u7684\u89e3\u51b3\u65b9\u6cd5\u662f\u5c06\u4ee5\u4e0b\u5185\u5bb9\u653e\u5728.bashrc\u7684\u9876\u90e8\uff1a</p> <pre><code># If not running interactively, don't do anything\n[ -z \"$PS1\" ] &amp;&amp; return\n</code></pre> <p>\u8fdc\u7a0b\u6267\u884c\u811a\u672c\u65f6\uff0c\u8fdb\u884c\u767b\u5f55\uff0c\u8bfb\u53d6/etc/profile\u914d\u7f6e\u3002<code>ssh user@remote bash -l script.sh</code></p> <p>ssh connection refused</p> <pre><code># \u5148\u67e5\u770bssh\u8fdb\u7a0b\u662f\u5426\u5b58\u5728\uff0c\u4e0d\u5b58\u5728\u5219\u542f\u52a8\nps -ef | grep ssh\nsudo /etc/init.d/ssh start\n</code></pre>"},{"location":"linux/bash.html#sh","title":"Sh \u8f6f\u94fe\u63a5","text":"<p>sh \u662f bash\u7684\u8f6f\u94fe\u63a5\u3002</p> <p>\u5f53bash\u4ee5\u662fsh\u547d\u542f\u52a8\u65f6\uff0c\u5373\u6211\u4eec\u6b64\u5904\u7684\u60c5\u51b5\uff0cbash\u4f1a\u5c3d\u53ef\u80fd\u7684\u6a21\u4effsh\uff0c\u6240\u4ee5\u914d\u7f6e\u6587\u4ef6\u7684\u52a0\u8f7d\u53d8\u6210\u4e86\u4e0b\u9762\u8fd9\u6837\uff1a</p> <ul> <li>interactive + login: \u8bfb\u53d6<code>/etc/profile</code>\u548c<code>~/.profile</code></li> <li>non-interactive + login: \u540c\u4e0a</li> <li>interactive + non-login: \u8bfb\u53d6<code>ENV</code>\u73af\u5883\u53d8\u91cf\u5bf9\u5e94\u7684\u6587\u4ef6</li> <li>non-interactive + non-login: \u4e0d\u8bfb\u53d6\u4efb\u4f55\u6587\u4ef6</li> </ul>"},{"location":"linux/basic.html","title":"\u57fa\u7840","text":"<p>GNU \u8f6f\u4ef6\u5305\u5217\u8868\uff1a\u5305\u542b\u591a\u4e2a\u5305\u8f6f\u4ef6\uff1a</p> <ul> <li>binutils\uff1a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08ELF\uff09\u5206\u6790\u5de5\u5177\uff1b</li> <li>coreutils\uff1a\u57fa\u7840\u7684\u547d\u4ee4\uff08\u5982 cat, ls, chown, wc\uff09\u7b49\uff1b</li> </ul>"},{"location":"linux/basic.html#selinux","title":"SElinux","text":"<p>\u5b89\u5168\u589e\u5f3a\u578b Linux\uff08Security-Enhanced Linux\uff09\uff0c\u4e00\u4e2a Linux \u5185\u6838\u6a21\u5757\uff0c\u4e5f\u662f Linux \u7684\u4e00\u4e2a\u5b89\u5168\u5b50\u7cfb\u7edf\u3002</p> <p>SELinux \u5c5e\u4e8eMAC\uff08Mandatory Access Control \uff09\u7684\u5177\u4f53\u5b9e\u73b0\u3002MAC\u673a\u5236\u7684\u7279\u70b9\u5728\u4e8e\uff0c\u8d44\u6e90\u7684\u62e5\u6709\u8005\uff0c\u5e76\u4e0d\u80fd\u51b3\u5b9a\u8c01\u53ef\u4ee5\u63a5\u5165\u5230\u8d44\u6e90\u3002\u5177\u4f53\u51b3\u5b9a\u662f\u5426\u53ef\u4ee5\u63a5\u5165\u5230\u8d44\u6e90\uff0c\u662f\u57fa\u4e8e\u5b89\u5168\u7b56\u7565\u3002\u800c\u5b89\u5168\u7b56\u7565\u5219\u662f\u6709\u4e00\u7cfb\u5217\u7684\u63a5\u5165\u89c4\u5219\u7ec4\u6210\uff0c\u5e76\u4ec5\u6709\u7279\u5b9a\u6743\u9650\u7684\u7528\u6237\u6709\u6743\u9650\u64cd\u4f5c\u5b89\u5168\u7b56\u7565\u3002</p>"},{"location":"linux/basic.html#_2","title":"\u57fa\u672c\u4fe1\u606f","text":""},{"location":"linux/basic.html#_3","title":"\u5185\u6838\u7248\u672c","text":"<p><code>uname -r</code> \u6216 <code>cat /proc/version</code></p>"},{"location":"linux/basic.html#hostname","title":"HostName","text":"<p>\u96c6\u7fa4\u914d\u7f6e\u4e2d\u9700\u8981\u6ce8\u610f</p> <p>/etc/hosts \u914d\u7f6e\u4e3b\u673a\u540d\u5230IP\u7684\u6620\u5c04</p> <p>/etc/hostname \u914d\u7f6e\u4e3b\u673a\u540d\uff0c\u53ef\u4ee5\u901a\u8fc7hostnamectl\u4fee\u6539</p> <pre><code>sudo hostnamectl set-hostname &lt;newhostname&gt;\n</code></pre>"},{"location":"linux/basic.html#top","title":"TOP","text":"<p>\u663e\u793a\u7684\u5217\u4e2d\uff1a</p> <ul> <li>VIRT\uff08\u5373VmSize\uff09\uff1a\u8fdb\u7a0b\u4f7f\u7528\u7684\u865a\u62df\u5185\u5b58\u603b\u91cf</li> <li>RES\uff08\u5373VmRss\uff09\uff1a\u8fdb\u7a0b\u4f7f\u7528\u7684\u672a\u88ab\u6362\u51fa\u7684\u7269\u7406\u5185\u5b58\u5927\u5c0f\uff0c\u5355\u4f4dkb </li> <li>SHR\uff1a\u5171\u4eab\u5185\u5b58\u5927\u5c0f\uff0c\u5355\u4f4dkb</li> <li>%MEM\uff1a\u8fdb\u7a0b\u4f7f\u7528\u7684\u7269\u7406\u5185\u5b58\u767e\u5206\u6bd4</li> </ul>"},{"location":"linux/basic.html#mount","title":"Mount","text":""},{"location":"linux/basic.html#_4","title":"\u6302\u8f7d\u547d\u4ee4","text":"<p>\u9ed8\u8ba4\u6240\u6709\u7684\u6302\u8f7d\u72b6\u6001\u90fd\u662f\u79c1\u6709\u7684\u3002</p> <pre><code>mount -t tmpfs -o size=2048M tmpfs /mnt/ramdisk\n</code></pre> <p>mount \u547d\u4ee4\u7528\u6765\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u3002\u5176\u57fa\u672c\u547d\u4ee4\u683c\u5f0f\u4e3a\uff1a</p> <p>mount -t type [-o options] device dir</p> <p>device\uff1a\u6307\u5b9a\u8981\u6302\u8f7d\u7684\u8bbe\u5907\uff0c\u6bd4\u5982\u78c1\u76d8\u3001\u5149\u9a71\u7b49\u3002 dir\uff1a\u6307\u5b9a\u628a\u6587\u4ef6\u7cfb\u7edf\u6302\u8f7d\u5230\u54ea\u4e2a\u76ee\u5f55\u3002 type\uff1a\u6307\u5b9a\u6302\u8f7d\u7684\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\uff0c\u4e00\u822c\u4e0d\u7528\u6307\u5b9a\uff0cmount \u547d\u4ee4\u80fd\u591f\u81ea\u884c\u5224\u65ad\u3002 options\uff1a\u6307\u5b9a\u6302\u8f7d\u53c2\u6570\uff0c\u6bd4\u5982 ro \u8868\u793a\u4ee5\u53ea\u8bfb\u65b9\u5f0f\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u3002 </p>"},{"location":"linux/basic.html#_5","title":"\u7ed1\u5b9a\u6302\u8f7d","text":"<pre><code># --bind \u5c06\u4e24\u4e2a\u76ee\u5f55\u8fde\u63a5\u8d77\u6765\uff0c\u5c06/host\u6302\u8f7d\u5230/test\u4e0a\uff0c\u5bf9/test\u7684\u8bbf\u95ee\u548c\u4fee\u6539\u90fd\u662f\u5728/host\u4e0a\n$ mount --bind /host /test\n</code></pre>"},{"location":"linux/basic.html#_6","title":"\u8054\u5408\u6302\u8f7d","text":"<pre><code># \u5c06A\u548cB\u76ee\u5f55\u6302\u8f7d\u5230\u4e00\u4e2a\u516c\u5171\u7684\u76ee\u5f55C\u4e0a\n$ mount -t aufs -o dirs=./A:./B none ./C\n</code></pre>"},{"location":"linux/basic.html#_7","title":"\u81ea\u52a8\u6302\u8f7d","text":"<p><code>/etc/fstab</code>\u914d\u7f6e\u6587\u4ef6</p>"},{"location":"linux/basic.html#_8","title":"\u67e5\u770b\u5df2\u7ecf\u6302\u8f7d\u7684\u76ee\u5f55","text":"<pre><code>mount -l\n</code></pre>"},{"location":"linux/basic.html#_9","title":"\u56de\u73af\u8bbe\u5907","text":"<p>\u56de\u73af\u8bbe\u5907\uff08 'loopback device'\uff09\u5141\u8bb8\u7528\u6237\u4ee5\u4e00\u4e2a\u666e\u901a\u78c1\u76d8\u6587\u4ef6\u865a\u62df\u4e00\u4e2a\u5757\u8bbe\u5907\u3002</p> <ul> <li>\u5bf9\u5b83\u7684\u6240\u6709\u8bfb\u5199\u64cd\u4f5c\u90fd\u5c06\u88ab\u91cd\u5b9a\u5411\u5230\u8bfb\u5199\u4e00\u4e2a\u540d\u4e3a disk-image \u7684\u666e\u901a\u6587\u4ef6\u800c\u975e\u64cd\u4f5c\u5b9e\u9645\u78c1\u76d8\u6216\u5206\u533a\u7684\u8f68\u9053\u548c\u6247\u533a\u3002</li> </ul> <p>\u56de\u73af\u8bbe\u5907\u4ee5 /dev/loop0\u3001/dev/loop1 \u7b49\u547d\u540d\u3002\u6bcf\u4e2a\u8bbe\u5907\u53ef\u865a\u62df\u4e00\u4e2a\u5757\u8bbe\u5907\u3002\u6ce8\u610f\u53ea\u6709\u8d85\u7ea7\u7528\u6237\u624d\u6709\u6743\u9650\u8bbe\u7f6e\u56de\u73af\u8bbe\u5907\u3002</p>"},{"location":"linux/basic.html#_10","title":"\u865a\u5b58\u5206\u914d\u7b56\u7565","text":"<p>overcommit_memory\u662f\u4e00\u4e2a\u5185\u6838\u5bf9\u5185\u5b58\u5206\u914d\u7684\u4e00\u79cd\u7b56\u7565\u3002 \u5177\u4f53\u89c1<code>/proc/sys/vm/overcommit_memory</code>\u4e0b\u7684\u503c</p> <ul> <li> <p>0\uff0c \u8868\u793a\u5185\u6838\u5c06\u68c0\u67e5\u662f\u5426\u6709\u8db3\u591f\u7684\u53ef\u7528\u7269\u7406\u5185\u5b58\u4f9b\u5e94\u7528\u8fdb\u7a0b\u4f7f\u7528\uff1b\u5982\u679c\u6709\uff0c\u5185\u5b58\u7533\u8bf7\u5141\u8bb8\uff1b\u5426\u5219\uff0c\u5185\u5b58\u7533\u8bf7\u5931\u8d25\uff0c\u5e76\u628a\u9519\u8bef\u8fd4\u56de\u7ed9\u5e94\u7528\u8fdb\u7a0b\uff1b</p> </li> <li> <p>1\uff0c \u8868\u793a\u5185\u6838\u5141\u8bb8\u5206\u914d\u6240\u6709\u7684\u7269\u7406\u5185\u5b58\uff0c\u800c\u4e0d\u7ba1\u5f53\u524d\u7684\u5185\u5b58\u72b6\u6001\u5982\u4f55\uff1b</p> </li> <li> <p>2\uff0c \u8868\u793a\u5185\u6838\u62d2\u7edd\u7b49\u4e8e\u6216\u8005\u5927\u4e8e\u603b\u53ef\u7528 swap \u5927\u5c0f\u4ee5\u53caovercommit_ratio\u6307\u5b9a\u7684\u7269\u7406RAM\u6bd4\u4f8b\u7684\u5185\u5b58\u8bf7\u6c42</p> </li> <li> <p>overcommit_ratio\uff0c \u5f53overcommit_memory=2\u7684\u65f6\u5019\uff0c\u5b83\u4e00\u822c\u662f\u4ee3\u8868\u7684\u662f\u7cfb\u7edf\u4e2d\u603b\u7684\u5185\u5b58\u7684\u767e\u5206\u6bd4</p> </li> </ul> <pre><code># \u9ed8\u8ba4\u4e3a0\ncat /proc/sys/vm/overcommit_memory\n# \u9ed8\u8ba4\u4e3a50\ncat /proc/sys/vm/overcommit_ratio\n</code></pre>"},{"location":"linux/basic.html#_11","title":"\u865a\u62df\u5185\u5b58\u9650\u5236","text":"<p><code>CommitLimit = SwapTotal + MemTotal * overcommit_ratio</code></p> <p>\u603b\u7684\u865a\u62df\u5185\u5b58 = \u603b\u7684\u4ea4\u6362\u5206\u533a + \u603b\u7684\u7269\u7406\u5185\u5b58 * overcommit_ratio</p> <pre><code># \u67e5\u770b\u7cfb\u7edf\u7684\u5185\u5b58\u5206\u914d\u4e0a\u9650CommitLimit\u548c\u5df2\u5206\u914d\u5185\u5b58\u5927\u5c0fCommitted_As\ncat /proc/meminfo | grep Commit\n</code></pre>"},{"location":"linux/basic.html#_12","title":"\u6e05\u7a7a\u7cfb\u7edf\u7f13\u5b58","text":"<p>```shell echo 1 &gt; /proc/sys/vm/drop_caches</p>"},{"location":"linux/basic.html#free-g","title":"\u901a\u8fc7free -g \u67e5\u770b\u662f\u5426\u7f13\u5b58\u88ab\u6e05\u7a7a","text":"<p>```</p> <p>0 \u2013 \u4e0d\u91ca\u653e</p> <p>1 \u2013 \u91ca\u653e\u9875\u7f13\u5b58</p> <p>2 \u2013 \u91ca\u653e\u6587\u4ef6\u8282\u70b9\u7f13\u5b58\u548c\u76ee\u5f55\u9879\u7f13\u5b58</p> <p>3 \u2013 \u91ca\u653e\u6240\u6709\u7f13\u5b58</p>"},{"location":"linux/basic.html#_13","title":"\u7528\u6237\u5171\u4eab\u6587\u4ef6\u914d\u7f6e","text":""},{"location":"linux/basic.html#etcskel","title":"/etc/skel/\u76ee\u5f55","text":"<p>/etc/skel/\u76ee\u5f55\u662f\u7528\u6765\u5b58\u653e\u65b0\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u5f53\u6211\u4eec\u6dfb\u52a0\u65b0\u7528\u6237\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u4f1a\u81ea\u52a8\u88ab\u590d\u5236\u5230\u65b0\u6dfb\u52a0\u7684\u7528\u6237\u7684\u5bb6\u76ee\u5f55\u4e0b\u3002 </p> <ul> <li>\u521d\u59cb\u7edf\u4e00\u7684\u73af\u5883\u914d\u7f6e\uff1b</li> <li>\u6570\u636e\u5171\u4eab\u7684\u573a\u666f\uff1b</li> </ul>"},{"location":"linux/basic.html#_14","title":"\u6587\u4ef6\u548c\u8def\u5f84","text":""},{"location":"linux/basic.html#_15","title":"\u94fe\u63a5","text":"<p>\u7b26\u53f7\u94fe\u63a5\uff1a<code>ln -s src dst</code></p> <ul> <li>\u4e0d\u540c\u7684 inode\uff0c\u5220\u9664\u6e90\u6587\u4ef6\uff0c\u7b26\u53f7\u94fe\u63a5\u5931\u6548\uff1b</li> </ul> <p>\u786c\u94fe\u63a5\uff1a<code>ln src dst</code></p> <ul> <li>\u6307\u5411\u540c\u4e00\u4e2ainode\uff0c\u4e00\u4e2a\u6587\u4ef6\u6709\u591a\u4e2a\u8def\u5f84\u540d\uff08\u9632\u6b62\u8bef\u5220\uff09\uff0c\u6e90\u6587\u4ef6\u5220\u9664\u540e\uff0c\u786c\u94fe\u63a5\u4ecd\u53ef\u8bfb\u53d6\uff1b</li> </ul>"},{"location":"linux/basic.html#_16","title":"\u5185\u5bb9\u6e05\u7a7a","text":"<p><code>ls</code>\u6587\u4ef6\u5927\u5c0f\u4e3a0\uff1a</p> <p><code>cat /dev/null &gt; filename</code></p>"},{"location":"linux/basic.html#unzip","title":"Unzip","text":"<p>\u6279\u91cf\u89e3\u538b</p> <pre><code>ls *.zip | xargs -n1 unzip -o -P infected\n</code></pre>"},{"location":"linux/basic.html#find","title":"find","text":"<p>find \u7684\u7ed3\u679c\u9ed8\u8ba4\u6309\u6587\u4ef6/\u76ee\u5f55\u7684\u521b\u5efa\u987a\u5e8f\u6392\u5e8f\uff0c\u4e0d\u8981\u4f9d\u8d56find\u7684\u7ed3\u679c\u987a\u5e8f\uff0c\u9700\u8981\u987a\u5e8f\u7684\u65f6\u5019\u52a0\u4e0asort\uff1b</p> <ul> <li><code>find searchdir -name searchfilename</code></li> </ul>"},{"location":"linux/basic.html#_17","title":"\u6587\u4ef6\u5c5e\u6027","text":"<p><code>file</code> \u547d\u4ee4\u786e\u5b9a\u6240\u5904\u7406\u7684\u6587\u4ef6\u7c7b\u578b\u3002</p> <pre><code>$ file /bin/ls\n/bin/ls: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, BuildID[sha1]=94943a89d17e9d373b2794dcb1f7e38c95b66c86, stripped\n</code></pre> <p><code>stat -c %U file</code>\uff1a\u663e\u793a file \u6240\u5c5e\u7528\u6237\u7684\u540d\u79f0</p>"},{"location":"linux/basic.html#_18","title":"\u83b7\u53d6\u8def\u5f84\u7684\u6700\u540e\u6587\u4ef6\u540d","text":"<p><code>basename /root/a.tar.gz</code> \u8fd4\u56de <code>a.tar.gz</code>\u3002</p>"},{"location":"linux/basic.html#_19","title":"\u83b7\u53d6\u5f53\u524d\u811a\u672c\u7684\u7edd\u5bf9\u8def\u5f84","text":"<ul> <li> <p>\u5e38\u89c1\u9519\u8bef\u547d\u4ee4</p> </li> <li> <p>pwd : \u83b7\u53d6\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\uff0c \u4e0d\u662f\u811a\u672c\u6240\u5728\u7684\u76ee\u5f55\uff0c\u53d6\u51b3\u4e8e\u811a\u672c\u662f <code>./script.sh</code> \u8fd8\u662f<code>./a/script.sh</code>\uff1b</p> </li> <li> <p>$0 : </p> <ul> <li>\u4f7f\u7528\u4e00\u4e2a\u6587\u4ef6\u8c03\u7528bash\uff0c\u90a3$0\u7684\u503c\uff0c\u662f\u90a3\u4e2a\u6587\u4ef6\u7684\u540d\u5b57(\u6ca1\u8bf4\u662f\u7edd\u5bf9\u8def\u5f84)</li> <li>\u4f7f\u7528-c\u9009\u9879\u542f\u52a8bash\u7684\u8bdd\uff0c\u771f\u6b63\u6267\u884c\u7684\u547d\u4ee4\u4f1a\u4ece\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\u8bfb\u53d6\uff0c\u5b57\u7b26\u4e32\u540e\u9762\u5982\u679c\u8fd8\u6709\u522b\u7684\u53c2\u6570\u7684\u8bdd\uff0c\u4f7f\u7528\u4ece$0\u5f00\u59cb\u7684\u7279\u6b8a\u53d8\u91cf\u5f15\u7528(\u8ddf\u8def\u5f84\u65e0\u5173\u4e86)</li> <li>\u9664\u6b64\u4ee5\u5916\uff0c$0\u4f1a\u88ab\u8bbe\u7f6e\u6210\u8c03\u7528bash\u7684\u90a3\u4e2a\u6587\u4ef6\u7684\u540d\u5b57(\u6ca1\u8bf4\u662f\u7edd\u5bf9\u8def\u5f84)</li> </ul> </li> <li> <p>\u6b63\u786e\u547d\u4ee4</p> </li> </ul> <pre><code>basepath=$(cd `dirname $0`; pwd)\n</code></pre>"},{"location":"linux/basic.html#_20","title":"\u7528\u6237","text":"<p>Linux kernel 2.6\u4e4b\u540e\uff0c\u6700\u5927\u7684\u7528\u6237/\u7528\u6237\u7ec4\u6570\u76ee\u8d85\u8fc74 billion\uff1b</p>"},{"location":"linux/basic.html#id","title":"id","text":"<p>\u663e\u793a\u5f53\u524d\u7528\u6237\u540d\uff0c<code>/usr/bin/id -u -n</code></p>"},{"location":"linux/basic.html#useradd","title":"useradd","text":"<pre><code>$ useradd [-mMnr][-c &lt;\u5907\u6ce8&gt;][-d &lt;\u767b\u5165\u76ee\u5f55&gt;][-e &lt;\u6709\u6548\u671f\u9650&gt;][-f &lt;\u7f13\u51b2\u5929\u6570&gt;][-g &lt;\u7fa4\u7ec4&gt;][-G &lt;\u7fa4\u7ec4&gt;][-s &lt;shell&gt;][-u &lt;uid&gt;][\u7528\u6237\u5e10\u53f7]\n</code></pre> <ul> <li>-m  \u81ea\u52a8\u5efa\u7acb\u7528\u6237\u7684\u767b\u5165\u76ee\u5f55\uff08\u9ed8\u8ba4\uff09\uff1b</li> <li>-M  \u4e0d\u8981\u81ea\u52a8\u5efa\u7acb\u7528\u6237\u7684\u767b\u5165\u76ee\u5f55\uff1b</li> <li>-n   \u53d6\u6d88\u5efa\u7acb\u4ee5\u7528\u6237\u540d\u79f0\u4e3a\u540d\u7684\u7fa4\u7ec4\uff1b</li> <li>-g \u6307\u5b9a\u7528\u6237\u7684\u7fa4\u7ec4\uff1b</li> <li>-r  \u5efa\u7acb\u7cfb\u7edf\u5e10\u53f7\uff1b</li> <li>-u \u6307\u5b9a\u7528\u6237id\uff0c0~499\u9ed8\u8ba4\u662f\u4fdd\u7559\u7ed9\u7cfb\u7edf\u7528\u6237\u8d26\u53f7\u4f7f\u7528\u7684\uff0c\u6240\u4ee5\u8be5\u503c\u5fc5\u987b\u5927\u4e8e499</li> </ul>"},{"location":"linux/basic.html#userdel","title":"userdel","text":"<p>-f  \u5f3a\u5236\u5220\u9664\u7528\u6237\uff0c\u5373\u4f7f\u7528\u6237\u5f53\u524d\u5df2\u767b\u5f55</p> <p>-r  \u5220\u9664\u7528\u6237\u7684\u540c\u65f6\uff0c\u5220\u9664\u4e0e\u7528\u6237\u76f8\u5173\u7684\u6240\u6709\u6587\u4ef6</p>"},{"location":"linux/basic.html#sudo","title":"sudo\u514d\u5bc6\u7801\u6267\u884c\u6587\u4ef6","text":"<p>\u7f16\u8f91 <code>/etc/sudoers</code></p> <pre><code># userA \u53ef\u4ee5\u5728\u4efb\u4f55\u4e3b\u673a\uff08\u7531 ALL \u8868\u793a\uff09\u4e0a\u4ee5 root \u7528\u6237\uff08\u7531 (root) \u8868\u793a\uff09\u7684\u8eab\u4efd\uff0c\u4e0d\u9700\u8981\u5bc6\u7801\uff08NOPASSWD\uff09\u8fd0\u884c\u7279\u5b9a\u547d\u4ee4\nuserA ALL=(root) NOPASSWD:/opt/sudobin2/commoninstall.sh\n</code></pre>"},{"location":"linux/basic.html#_21","title":"\u7528\u6237\u7ec4","text":"<p><code>groupadd group_test</code></p> <p>\u8bbe\u7f6e\u67d0\u4e2a\u7528\u6237\u6240\u5728\u7684\u7528\u6237\u7ec4</p> <p><code>usermod -g \u7528\u6237\u7ec4 \u7528\u6237\u540d</code> </p>"},{"location":"linux/basic.html#_22","title":"\u8fdb\u5236\u8f6c\u6362","text":""},{"location":"linux/basic.html#hexdump","title":"hexdump","text":"<p>\u4e8c\u8fdb\u5236\u8f6c ASCII\u3001\u5341\u8fdb\u5236\u3001\u5341\u516d\u8fdb\u5236\u6216\u516b\u8fdb\u5236\u663e\u793a\u6587\u4ef6\u5185\u5bb9\u3002</p> <ul> <li>-n length\uff1a\u683c\u5f0f\u5316\u8f93\u51fa\u6587\u4ef6\u7684\u524dlength\u4e2a\u5b57\u8282</li> <li>-C\uff1a\u8f93\u51fa\u89c4\u8303\u7684\u5341\u516d\u8fdb\u5236\u548cASCII\u7801</li> <li>-b\uff1a\u5355\u5b57\u8282\u516b\u8fdb\u5236\u663e\u793a</li> <li>-c\uff1a\u5355\u5b57\u8282\u5b57\u7b26\u663e\u793a</li> <li>-d\uff1a\u53cc\u5b57\u8282\u5341\u8fdb\u5236\u663e\u793a</li> <li>-o\uff1a\u53cc\u5b57\u8282\u516b\u8fdb\u5236\u663e\u793a</li> <li>-x\uff1a\u53cc\u5b57\u8282\u5341\u516d\u8fdb\u5236\u663e\u793a</li> <li>-s\uff1a\u4ece\u504f\u79fb\u91cf\u5f00\u59cb\u8f93\u51fa</li> </ul> <pre><code>$ hexdump -C /bin/ls | head\n00000000  7f 45 4c 46 02 01 01 00  00 00 00 00 00 00 00 00  |.ELF............|\n00000010  02 00 3e 00 01 00 00 00  d4 42 40 00 00 00 00 00  |..&gt;......B@.....|\n00000020  40 00 00 00 00 00 00 00  f0 c3 01 00 00 00 00 00  |@...............|\n00000030  00 00 00 00 40 00 38 00  09 00 40 00 1f 00 1e 00  |....@.8...@.....|\n</code></pre>"},{"location":"linux/basic.html#printf","title":"printf","text":"<pre><code># 8\u8fdb\u5236\u8f6c16\u8fdb\u5236\n$ printf %d 089\n# 10\u8fdb\u5236\u8f6c8\u8fdb\u5236\n$ printf %o 123\n</code></pre>"},{"location":"linux/basic.html#_23","title":"\u6587\u672c\u76f8\u5173","text":""},{"location":"linux/basic.html#_24","title":"\u591a\u884c\u5b57\u7b26\u8f93\u5165","text":"<pre><code># &lt;&lt; \u77e5\u9053\u5176\u540e\u9762\u8f93\u5165\u7684\u5206\u754c\u7b26\uff0c\u5f53\u518d\u6b21\u5904\u7406\u5206\u754c\u7b26\u65f6\uff0c\u4e24\u4e2a\u5206\u754c\u7b26\u4e2d\u95f4\u7684\u90e8\u5206\u5c06\u4f5c\u4e3a\u6807\u51c6\u8f93\u5165\ncat &gt; file &lt;&lt; EOF\ncontents\nEOF\n</code></pre>"},{"location":"linux/basic.html#grep","title":"grep","text":"<ul> <li>-x\uff1a\u5339\u914d\u591a\u884c</li> <li>-v\uff1a\u4e0d\u5339\u914d\u7684\u9879</li> <li>-F\uff1a\u6307\u5b9apattern\uff0c\u6bcf\u884c\u4e00\u4e2apattern</li> </ul> <p>\u793a\u4f8b\uff1a\u5bfb\u627e\u5728\u6587\u4ef6B\u4e2d\u51fa\u73b0\u7684\uff0c\u4f46\u662f\u6587\u4ef6A\u4e2d\u672a\u51fa\u73b0\u7684\u884c</p> <pre><code># \u76f4\u63a5\u6587\u4ef6\u64cd\u4f5c\ncat B | grep -x -v -F \u201c$(cat A)\u201d\n# \u5b57\u7b26\u4e32\u53ef\u4ee5\u662f\u4ee5\u4e0b\u5f62\u5f0f\nC_A=$(cat A)\nC_B=$(cat B)\necho \"$C_B\" | grep -x -v -F echo \"$C_A\"\n</code></pre>"},{"location":"linux/basic.html#cut","title":"cut","text":"<p>cut \uff1a\u5b57\u7b26\u4e32\u5206\u5272</p> <ul> <li><code>-d</code>\uff1a\u6307\u5b9a\u5b57\u6bb5\u7684\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u7684\u5b57\u6bb5\u5206\u9694\u7b26\u4e3a\u201cTAB\u201d\uff1b </li> <li><code>-f</code>\uff1a\u663e\u793a\u6307\u5b9a\u5b57\u6bb5\u7684\u5185\u5bb9</li> </ul>"},{"location":"linux/basic.html#awk","title":"awk","text":"<pre><code>awk [-F \u5b57\u6bb5\u5206\u9694\u7b26]  'BEGIN{actions} /pattern1/{actions1} /pattern2/{actions2} END{actions}'   input_file\n# awk -F ':' '{print $2}' a.txt\n</code></pre> <ul> <li>\u82e5\u4e0d\u6307\u5b9a\u5b57\u6bb5\u5206\u9694\u7b26\uff0c\u5219\u4f7f\u7528\u73af\u5883\u53d8\u91cf\u7684IFS\u7684\u503c\uff08\u901a\u5e38\u4e3a\u7a7a\u683c\uff09</li> <li>\u5176\u4e2d <code>BEGIN{actions}</code> \u548c <code>END{actions}</code> \u662f\u53ef\u9009\u7684\uff1b</li> <li>\u76f8\u5173\u53d8\u91cf</li> <li>\u5b57\u6bb5\u53d8\u91cf\uff1a <code>$0</code>\uff0c\u200b<code>$1</code>\uff0c\u200b<code>$2</code> ...</li> <li><code>$NF</code> : \u6700\u540e\u4e00\u4e2a\u53d8\u91cf</li> <li>ARGC:\u547d\u4ee4\u884c\u53c2\u6570\u4e2a\u6570\uff1bARGV:\u547d\u4ee4\u884c\u53c2\u6570\u6570\u7ec4</li> </ul> <p>awk \u548c sed\uff1a</p> <ul> <li>awk\u9002\u5408\u6309\u5217\uff08\u57df\uff09\u64cd\u4f5c\uff0csed\u9002\u5408\u6309\u884c\u64cd\u4f5c</li> <li>awk\u9002\u5408\u5bf9\u6587\u4ef6\u7684\u62bd\u53d6\u6574\u7406\uff0csed\u9002\u5408\u5bf9\u6587\u4ef6\u7684\u7f16\u8f91</li> </ul>"},{"location":"linux/basic.html#sed","title":"sed","text":"<p>sed\u4e0d\u7ba1\u5339\u914d\u6ca1\u6709\u5339\u914d\u5230\uff0c\u72b6\u6001\u8fd4\u56de\u7801\u90fd\u662f0</p> <p>\u4e3b\u8981\u662f\u4ee5\u884c\u4e3a\u5355\u4f4d\u8fdb\u884c\u5904\u7406\uff0c\u53ef\u4ee5\u5c06\u6570\u636e\u884c\u8fdb\u884c\u66ff\u6362\u3001\u5220\u9664\u3001\u65b0\u589e\u3001\u9009\u53d6\u7b49\u7279\u5b9a\u5de5\u4f5c\uff0c\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>$ sed [-nefri] \u2018command\u2019 \u8f93\u5165\u6587\u672c   \n\n# sed -i 's/aa/bb/g' in.txt\n</code></pre> <p>\u5e38\u7528\u9009\u9879\uff1a</p> <ul> <li> <p><code>-i</code>\u2236\u76f4\u63a5\u4fee\u6539\u8bfb\u53d6\u7684\u6863\u6848\u5185\u5bb9\uff0c\u800c\u4e0d\u662f\u7531\u5c4f\u5e55\u8f93\u51fa\u3002 </p> </li> <li> <p><code>-n</code>\u2236\u5b89\u9759\u6a21\u5f0f\uff0c\u5219\u53ea\u6709\u7ecf\u8fc7sed \u7279\u6b8a\u5904\u7406\u7684\u90a3\u4e00\u884c(\u6216\u8005\u52a8\u4f5c)\u624d\u4f1a\u88ab\u5217\u51fa\u6765\u3002</p> </li> <li><code>-e</code>\u2236\u76f4\u63a5\u5728\u6307\u4ee4\u5217\u6a21\u5f0f\u4e0a\u8fdb\u884c sed \u7684\u52a8\u4f5c\u7f16\u8f91\uff1b</li> <li><code>-f filename</code>\u2236\u76f4\u63a5\u5c06 sed \u7684\u52a8\u4f5c\u5199\u5728\u4e00\u4e2a\u6587\u4ef6\u5185\uff1b</li> <li><code>-r</code>\uff1a\u652f\u6301\u6b63\u5219\u8bed\u6cd5\uff1b   </li> </ul> <p>\u5e38\u7528\u547d\u4ee4 command\uff1a</p> <ul> <li><code>a \\str</code>  \u2236\u8ffd\u52a0\u884c\uff0c\u5728\u5339\u914d\u884c\u540e\u9762\u8ffd\u52a0<code>str</code>\u5e76\u6362\u884c\uff0c<code>$</code>\u8868\u793a\u6700\u540e\u4e00\u884c\uff1b</li> <li>c<code>\\ str</code> \u2236\u66ff\u6362\u884c\uff1b</li> <li><code>d</code> \u2236\u5220\u9664\u5339\u914d\u884c\uff1b</li> <li><code>i</code>  \u2236\u63d2\u5165\u884c\uff0c\u5728\u5339\u914d\u884c\u524d\u9762\uff1b</li> <li><code>p</code> \u2236\u5217\u5370\uff0c\u4ea6\u5373\u5c06\u67d0\u4e2a\u9009\u62e9\u7684\u8d44\u6599\u5370\u51fa\u3002\u901a\u5e38 p \u4f1a\u4e0e\u53c2\u6570 sed -n \u4e00\u8d77\u8fd0\u4f5c\uff1b</li> <li><code>s</code> \u2236\u66ff\u6362\u5b57\u7b26\u4e32\uff0c\u5c06\u5339\u914d\u7684\u5b57\u7b26\u4e32\u66ff\u6362\u6389\uff1b</li> </ul> <p>\u5982\u4f55\u5339\u914d\u884c\uff1a</p> <pre><code># \u884c\u6570\u5339\u914d\uff0c\u5728\u7b2c\u4e00\u884c\u5230\u6700\u540e\u4e00\u884c\uff0c\u6bcf\u884c\u540e\u9762\u6dfb\u52a0add one\u65b0\u7684\u4e00\u884c\n$ sed '1,$a \\add one' input.txt\n# \u5b57\u7b26\u4e32\u5339\u914d\uff0c\u5305\u542bfirst\u5b57\u7b26\u4e32\u884c \u540e\u9762\u52a0\u4e0aadd one\u65b0\u7684\u4e00\u884c\n$ sed '/first/a \\add one' input.txt\n# \u6b63\u5219\u5b57\u7b26\u4e32\u5339\u914d\uff0c\u5305\u542b \u4ee5ha\u5f00\u5934,day\u7ed3\u5c3e\u7684\u884c \u540e\u9762\u52a0\u4e0aadd one\u65b0\u7684\u4e00\u884c\n$ sed '/^ha.*day$/a \\add one' input.txt\n</code></pre> <p>\u83b7\u53d6\u5339\u914d\u5185\u5bb9</p> <ul> <li><code>\\(.*\\)</code>\u5339\u914d\u7684\u5185\u5bb9\uff0c\u53ef\u7528<code>\\1</code>\u7684\u5f62\u5f0f\u8fdb\u884c\u4f7f\u7528\uff1b</li> </ul> <pre><code>cat mail.xml | sed 's/.*&lt;title&gt;\\(.*\\)&lt;\\/title.*&lt;author&gt;&lt;name&gt;\\([^&lt;]*\\)&lt;\\/name&gt;&lt;email&gt;\\([^&lt;]*\\).*/Authot: \\2 [\\3] \\nSubject: \\1\\n/' \n</code></pre>"},{"location":"linux/basic.html#_25","title":"\u78c1\u76d8","text":""},{"location":"linux/basic.html#_26","title":"\u83b7\u53d6\u6247\u533a\u5927\u5c0f","text":"<pre><code>$ fdisk -l\n</code></pre>"},{"location":"linux/basic.html#_27","title":"\u83b7\u53d6\u78c1\u76d8\u5757\u7684\u5927\u5c0f","text":"<pre><code>$ stat /boot/|grep \u201cIO Block\u201d\n</code></pre>"},{"location":"linux/basic.html#page","title":"\u64cd\u4f5c\u7cfb\u7edf\u83b7\u53d6\u9875\uff08Page\uff09\u7684\u5927\u5c0f","text":"<pre><code>$ getconf PAGE_SIZE\n</code></pre>"},{"location":"linux/basic.html#_28","title":"\u8fdb\u7a0b\u76f8\u5173","text":""},{"location":"linux/basic.html#nohup","title":"nohup","text":"<p>nohup command &gt; myout.file 2&gt;&amp;1 &amp;  </p> <p>&amp; \uff1a \u6307\u5728\u540e\u53f0\u8fd0\u884c\uff0c\u4f46\u5f53\u7528\u6237\u9000\u51fa(\u6302\u8d77)\u7684\u65f6\u5019\uff0c\u547d\u4ee4\u81ea\u52a8\u4e5f\u8ddf\u7740\u9000\u51fa</p> <p>nohup \uff1a \u4e0d\u6302\u65ad\u7684\u8fd0\u884c\uff0c\u6ce8\u610f\u5e76\u6ca1\u6709\u540e\u53f0\u8fd0\u884c\u7684\u529f\u80fd\u3002</p>"},{"location":"linux/basic.html#kill","title":"kill","text":"<p><code>kill -Signal pid</code></p> <p>kill\uff1a</p> <ul> <li>kill \u4f1a\u9ed8\u8ba4\u4f2015\u4ee3\u8868\u7684\u4fe1\u53f7\u4e3aSIGTERM\uff0c\u8fd9\u662f\u544a\u8bc9\u8fdb\u7a0b\u4f60\u9700\u8981\u88ab\u5173\u95ed\uff0c\u8bf7\u81ea\u884c\u505c\u6b62\u8fd0\u884c\u5e76\u9000\u51fa\uff0c\u8fdb\u7a0b\u53ef\u4ee5\u6e05\u7406\u7f13\u5b58\u81ea\u884c\u7ed3\u675f\uff0c\u4e5f\u53ef\u4ee5\u62d2\u7edd\u7ed3\u675f</li> </ul> <p>kill -HUP \u6216 kill -1\uff1a</p> <ul> <li>\u6839\u636e\u7ea6\u5b9a\uff0c\u5f53\u60a8\u53d1\u9001\u4e00\u4e2a\u6302\u8d77\u4fe1\u53f7\uff08\u4fe1\u53f7 1 \u6216 HUP\uff09\u65f6\uff0c\u5927\u591a\u6570\u670d\u52a1\u5668\u8fdb\u7a0b\uff08\u6240\u6709\u5e38\u7528\u7684\u8fdb\u7a0b\uff09\u90fd\u4f1a\u8fdb\u884c\u590d\u4f4d\u64cd\u4f5c\u5e76\u91cd\u65b0\u52a0\u8f7d\u5b83\u4eec\u7684\u914d\u7f6e\u6587\u4ef6</li> </ul> <p>kill -3\uff1a</p> <ul> <li>\u53ef\u4ee5\u6253\u5370\u8fdb\u7a0b\u5404\u4e2a\u7ebf\u7a0b\u7684\u5806\u6808\u4fe1\u606f\uff0c\u4e0d\u4f1a\u6740\u8fdb\u7a0b\uff0ckill -3 pid \u540e\u6587\u4ef6\u7684\u4fdd\u5b58\u8def\u5f84\u4e3a\uff1a/proc/${pid}/cwd\uff0c\u6587\u4ef6\u540d\u4e3a\uff1aantBuilderOutput.log</li> </ul> <p>kill -9\uff1a</p> <ul> <li>SIGKILL\uff0c\u8868\u793a\u8fdb\u7a0b\u88ab\u7ec8\u6b62\uff0c\u9700\u8981\u7acb\u5373\u9000\u51fa\uff0c\u5f3a\u5236\u6740\u6b7b\u8be5\u8fdb\u7a0b\uff0c\u8fd9\u4e2a\u4fe1\u53f7\u4e0d\u80fd\u88ab\u6355\u83b7\u4e5f\u4e0d\u80fd\u88ab\u5ffd\u7565</li> <li>\u5bf9\u4e8e Java \u8fdb\u7a0b\uff0c\u5176 ShutDownHook \u4e0d\u4f1a\u88ab\u6267\u884c\uff1b</li> </ul> <p>kill -0\uff1a</p> <ul> <li>\u4e0d\u53d1\u9001\u4fe1\u53f7\uff0c\u4f46\u662f\u4ecd\u7136\u8fdb\u884c\u9519\u8bef\u68c0\u67e5\uff0c\u53ef\u7528\u4f5c\u68c0\u67e5\u8fdb\u7a0bid\u662f\u5426\u5b58\u5728\uff1b</li> </ul> <p>\u7ec4\u5408\u4fe1\u606f\u6740\u8fdb\u7a0b\uff1a</p> <ul> <li> <p>\u6839\u636e\u7ebf\u7a0b\u540dkill\uff1aps -au xliu | grep gedit | awk '{print $1}' | xargs kill -9</p> </li> <li> <p>\u6839\u636ejps\u6765kill \uff1a jps | grep JobManage | awk '{print $1}' | xargs kill -9</p> </li> </ul> <p>\u6740\u6389\u8fdc\u7a0b\u7684\u8fdb\u7a0b\u4e0d\u4e00\u6837\uff0c\u4e0a\u9762\u7684awk\uff0c\u9700\u8981\u8f6c\u4e49\u3002</p> <p><code>jps | grep JobManage | awk '{print \\$1}' | xargs kill -9</code></p>"},{"location":"linux/basic.html#_29","title":"\u7236\u5b50\u8fdb\u7a0b\u9000\u51fa","text":"<p>\u8fdb\u7a0b\u610f\u5916\u9000\u51fa\u65f6\uff0c\u5982\u4f55\u5c06\u4e3b\u8fdb\u7a0b\u521b\u5efa\u7684\u5b50\u8fdb\u7a0b\u7ec8\u6b62\uff0c\u6709\u4e24\u79cd\u505a\u6cd5\u3002</p> <ul> <li>\u4e00\u79cd\u662f\u5c06\u662f\u5c06\u4e3b\u8fdb\u7a0b\u4e2d\u521b\u5efa\u7684\u5b50\u8fdb\u7a0b\u4fe1\u606f\u4fdd\u5b58\uff0c\u4f7f\u7528\u4fe1\u53f7\u5904\u7406\u673a\u5236\uff0c\u5728\u4e3b\u8fdb\u7a0b\u6536\u5230\u7ec8\u6b62\u4fe1\u53f7SIGTERM\u65f6\uff0c\u4fdd\u5b58\u7684\u5b50\u8fdb\u7a0b\u4fe1\u606fterminate\uff0c\u4e4b\u540e\u4e3b\u8fdb\u7a0b\u9000\u51fa\uff1b</li> <li>\u53e6\u4e00\u79cd\u662f\u66f4\u52a0\u76f4\u63a5\uff0c\u901a\u8fc7\u8fdb\u7a0b\u7ec4id\uff08<code>getpgid(pid)</code>)\u5c06\u6574\u4e2a\u8fdb\u7a0b\u7ec4\u4e2d\u7684\u8fdb\u7a0b\u6740\u6b7b\u3002</li> </ul>"},{"location":"linux/basic.html#_30","title":"\u5224\u65ad\u547d\u4ee4\u662f\u5426\u5b58\u5728","text":"<ul> <li> <p>which\uff0c\u975e\u5185\u7f6e\u547d\u4ee4\uff0c\u4f9d\u8d56\u4e8e\u5e73\u53f0\uff0c</p> </li> <li> <p>type\u3001hash \u6216 command\uff0c\u5185\u7f6e\u547d\u4ee4\uff1b\u518d\u5224\u65ad <code>$?</code>\u7684\u503c </p> </li> </ul> <pre><code>if command -v foo &gt;/dev/null 2&gt;&amp;1; then echo 0; else echo 1; fi\ntype foo &gt;/dev/null 2&gt;&amp;1\nhash foo 2&gt;/dev/null\n</code></pre>"},{"location":"linux/basic.html#crontab","title":"crontab","text":"<ul> <li> <p>crontab -l \u5217\u51fa\u5b9a\u65f6\u4efb\u52a1\uff0ccrontab -e \u7f16\u8f91\u5b9a\u65f6\u4efb\u52a1\uff1b</p> </li> <li> <p>\u5b9a\u65f6\u4efb\u52a1\u683c\u5f0f\uff1af1 f2 f3 f4 f5 program</p> </li> <li> <p>f1\u8868\u793a\u5206\u949f\uff0cf2\u8868\u793a\u5c0f\u65f6\uff0cf3\u8868\u793a\u4e00\u6708\u4e2d\u7b2c\u51e0\u65e5\uff0cf4\u8868\u793a\u6708\u4efd\uff0cf5\u8868\u793a\u661f\u671f\u4e2d\u7b2c\u51e0\u5929\uff1b</p> </li> <li>f1\u4e3a*/n\u8868\u793a\u6bcf\u4e2an\u5206\u949f\u6267\u884c\u4e00\u6b21\uff1b</li> </ul>"},{"location":"linux/basic.html#rsync","title":"rsync","text":"<p>\u8bed\u6cd5</p> <pre><code>rsync [OPTION]... SRC DEST\nrsync [OPTION]... SRC [USER@][host]:DEST\nrsync [OPTION]... [USER@]HOST:SRC DEST\nrsync [OPTION]... [USER@]HOST::SRC DEST\nrsync [OPTION]... SRC [USER@]HOST::DEST\nrsync [OPTION]... rsync://[USER@]HOST[:PORT]/SRC [DEST]\n</code></pre> <p>\u4f20\u8f93\u65b9\u5f0f</p> <ul> <li>\u672c\u5730\u4f20\u8f93 <code>rsync [OPTION]... SRC DEST</code></li> <li>\u4f7f\u7528\u4e00\u4e2a\u8fdc\u7a0bshell\u7a0b\u5e8f(\u5982rsh\u3001ssh)\u6765\u5b9e\u73b0\u5c06\u672c\u5730\u673a\u5668\u7684\u5185\u5bb9\u62f7\u8d1d\u5230\u8fdc\u7a0b\u673a\u5668\u3002\u5f53DST\u8def\u5f84\u5730\u5740\u5305\u542b\u5355\u4e2a\u5192\u53f7\":\"\u5206\u9694\u7b26\u65f6\u542f\u52a8\u8be5\u6a21\u5f0f\u3002\u5982\uff1a<code>rsync -avz *.c foo:src</code> </li> <li>\u4ece\u672c\u5730\u673a\u5668\u62f7\u8d1d\u6587\u4ef6\u5230\u8fdc\u7a0brsync\u670d\u52a1\u5668\u4e2d\u3002\u5f53DST\u8def\u5f84\u4fe1\u606f\u5305\u542b\"::\"\u5206\u9694\u7b26\u65f6\u542f\u52a8\u8be5\u6a21\u5f0f\u3002\u5982\uff1a</li> <li><code>rsync -av /databack root@192.168.78.192::www</code></li> </ul> <p>\u9009\u9879</p> <p>\u5e38\u7528\u7684\u662faz\uff0c\u4e0b\u9762\u662f\u5e38\u7528\u7684\u9009\u9879</p> <pre><code>-v\uff1a\u663e\u793arsync\u8fc7\u7a0b\u4e2d\u8be6\u7ec6\u4fe1\u606f\u3002\u53ef\u4ee5\u4f7f\u7528\"-vvvv\"\u83b7\u53d6\u66f4\u8be6\u7ec6\u4fe1\u606f\u3002\n-P\uff1a\u663e\u793a\u6587\u4ef6\u4f20\u8f93\u7684\u8fdb\u5ea6\u4fe1\u606f\u3002(\u5b9e\u9645\u4e0a\"-P\"=\"--partial --progress\"\uff0c\u5176\u4e2d\u7684\"--progress\"\u624d\u662f\u663e\u793a\u8fdb\u5ea6\u4fe1\u606f\u7684)\u3002\n-n --dry-run  \uff1a\u4ec5\u6d4b\u8bd5\u4f20\u8f93\uff0c\u800c\u4e0d\u5b9e\u9645\u4f20\u8f93\u3002\u5e38\u548c\"-vvvv\"\u914d\u5408\u4f7f\u7528\u6765\u67e5\u770brsync\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u3002\n-a --archive  \uff1a\u5f52\u6863\u6a21\u5f0f\uff0c\u8868\u793a\u9012\u5f52\u4f20\u8f93\u5e76\u4fdd\u6301\u6587\u4ef6\u5c5e\u6027\u3002\u7b49\u540c\u4e8e\"-rtopgDl\"\u3002\n-r --recursive\uff1a\u9012\u5f52\u5230\u76ee\u5f55\u4e2d\u53bb\u3002\n-t --times\uff1a\u4fdd\u6301mtime\u5c5e\u6027\u3002\u5f3a\u70c8\u5efa\u8bae\u4efb\u4f55\u65f6\u5019\u90fd\u52a0\u4e0a\"-t\"\uff0c\u5426\u5219\u76ee\u6807\u6587\u4ef6mtime\u4f1a\u8bbe\u7f6e\u4e3a\u7cfb\u7edf\u65f6\u95f4\uff0c\u5bfc\u81f4\u4e0b\u6b21\u66f4\u65b0\n          \uff1a\u68c0\u67e5\u51famtime\u4e0d\u540c\u4ece\u800c\u5bfc\u81f4\u589e\u91cf\u4f20\u8f93\u65e0\u6548\u3002\n-o --owner\uff1a\u4fdd\u6301owner\u5c5e\u6027(\u5c5e\u4e3b)\u3002\n-g --group\uff1a\u4fdd\u6301group\u5c5e\u6027(\u5c5e\u7ec4)\u3002\n-p --perms\uff1a\u4fdd\u6301perms\u5c5e\u6027(\u6743\u9650\uff0c\u4e0d\u5305\u62ec\u7279\u6b8a\u6743\u9650)\u3002\n-D        \uff1a\u662f\"--device --specials\"\u9009\u9879\u7684\u7ec4\u5408\uff0c\u5373\u4e5f\u62f7\u8d1d\u8bbe\u5907\u6587\u4ef6\u548c\u7279\u6b8a\u6587\u4ef6\u3002\n-l --links\uff1a\u5982\u679c\u6587\u4ef6\u662f\u8f6f\u94fe\u63a5\u6587\u4ef6\uff0c\u5219\u62f7\u8d1d\u8f6f\u94fe\u63a5\u672c\u8eab\u800c\u975e\u8f6f\u94fe\u63a5\u6240\u6307\u5411\u7684\u5bf9\u8c61\u3002\n-z        \uff1a\u4f20\u8f93\u65f6\u8fdb\u884c\u538b\u7f29\u63d0\u9ad8\u6548\u7387\u3002\n--size-only \uff1a\u9ed8\u8ba4\u7b97\u6cd5\u662f\u68c0\u67e5\u6587\u4ef6\u5927\u5c0f\u548cmtime\u4e0d\u540c\u7684\u6587\u4ef6\uff0c\u4f7f\u7528\u6b64\u9009\u9879\u5c06\u53ea\u68c0\u67e5\u6587\u4ef6\u5927\u5c0f\u3002\n-u --update \uff1a\u4ec5\u5728\u6e90mtime\u6bd4\u76ee\u6807\u5df2\u5b58\u5728\u6587\u4ef6\u7684mtime\u65b0\u65f6\u624d\u62f7\u8d1d\u3002\u6ce8\u610f\uff0c\u8be5\u9009\u9879\u662f\u63a5\u6536\u7aef\u5224\u65ad\u7684\uff0c\u4e0d\u4f1a\u5f71\u54cd\u5220\u9664\u884c\u4e3a\u3002\n-d --dirs   \uff1a\u4ee5\u4e0d\u9012\u5f52\u7684\u65b9\u5f0f\u62f7\u8d1d\u76ee\u5f55\u672c\u8eab\u3002\u9ed8\u8ba4\u9012\u5f52\u65f6\uff0c\u5982\u679c\u6e90\u4e3a\"dir1/file1\"\uff0c\u5219\u4e0d\u4f1a\u62f7\u8d1ddir1\u76ee\u5f55\uff0c\u4f7f\u7528\u8be5\u9009\u9879\u5c06\u62f7\u8d1ddir1\u4f46\u4e0d\u62f7\u8d1dfile1\u3002\n--max-size  \uff1a\u9650\u5236rsync\u4f20\u8f93\u7684\u6700\u5927\u6587\u4ef6\u5927\u5c0f\u3002\u53ef\u4ee5\u4f7f\u7528\u5355\u4f4d\u540e\u7f00\uff0c\u8fd8\u53ef\u4ee5\u662f\u4e00\u4e2a\u5c0f\u6570\u503c(\u4f8b\u5982\uff1a\"--max-size=1.5m\")\n--min-size  \uff1a\u9650\u5236rsync\u4f20\u8f93\u7684\u6700\u5c0f\u6587\u4ef6\u5927\u5c0f\u3002\u8fd9\u53ef\u4ee5\u7528\u4e8e\u7981\u6b62\u4f20\u8f93\u5c0f\u6587\u4ef6\u6216\u90a3\u4e9b\u5783\u573e\u6587\u4ef6\u3002\n--exclude   \uff1a\u6307\u5b9a\u6392\u9664\u89c4\u5219\u6765\u6392\u9664\u4e0d\u9700\u8981\u4f20\u8f93\u7684\u6587\u4ef6\u3002\n--delete    \uff1a\u4ee5SRC\u4e3a\u4e3b\uff0c\u5bf9DEST\u8fdb\u884c\u540c\u6b65\u3002\u591a\u5219\u5220\u4e4b\uff0c\u5c11\u5219\u8865\u4e4b\u3002\u6ce8\u610f\"--delete\"\u662f\u5728\u63a5\u6536\u7aef\u6267\u884c\u7684\uff0c\u6240\u4ee5\u5b83\u662f\u5728\n            \uff1aexclude/include\u89c4\u5219\u751f\u6548\u4e4b\u540e\u624d\u6267\u884c\u7684\u3002\n-b --backup \uff1a\u5bf9\u76ee\u6807\u4e0a\u5df2\u5b58\u5728\u7684\u6587\u4ef6\u505a\u4e00\u4e2a\u5907\u4efd\uff0c\u5907\u4efd\u7684\u6587\u4ef6\u540d\u540e\u9ed8\u8ba4\u4f7f\u7528\"~\"\u505a\u540e\u7f00\u3002\n--backup-dir\uff1a\u6307\u5b9a\u5907\u4efd\u6587\u4ef6\u7684\u4fdd\u5b58\u8def\u5f84\u3002\u4e0d\u6307\u5b9a\u65f6\u9ed8\u8ba4\u548c\u5f85\u5907\u4efd\u6587\u4ef6\u4fdd\u5b58\u5728\u540c\u4e00\u76ee\u5f55\u4e0b\u3002\n-e          \uff1a\u6307\u5b9a\u6240\u8981\u4f7f\u7528\u7684\u8fdc\u7a0bshell\u7a0b\u5e8f\uff0c\u9ed8\u8ba4\u4e3assh\u3002\n--port      \uff1a\u8fde\u63a5daemon\u65f6\u4f7f\u7528\u7684\u7aef\u53e3\u53f7\uff0c\u9ed8\u8ba4\u4e3a873\u7aef\u53e3\u3002\n--password-file\uff1adaemon\u6a21\u5f0f\u65f6\u7684\u5bc6\u7801\u6587\u4ef6\uff0c\u53ef\u4ee5\u4ece\u4e2d\u8bfb\u53d6\u5bc6\u7801\u5b9e\u73b0\u975e\u4ea4\u4e92\u5f0f\u3002\u6ce8\u610f\uff0c\u8fd9\u4e0d\u662f\u8fdc\u7a0bshell\u8ba4\u8bc1\u7684\u5bc6\u7801\uff0c\u800c\u662frsync\u6a21\u5757\u8ba4\u8bc1\u7684\u5bc6\u7801\u3002\n-W --whole-file\uff1arsync\u5c06\u4e0d\u518d\u4f7f\u7528\u589e\u91cf\u4f20\u8f93\uff0c\u800c\u662f\u5168\u91cf\u4f20\u8f93\u3002\u5728\u7f51\u7edc\u5e26\u5bbd\u9ad8\u4e8e\u78c1\u76d8\u5e26\u5bbd\u65f6\uff0c\u8be5\u9009\u9879\u6bd4\u589e\u91cf\u4f20\u8f93\u66f4\u9ad8\u6548\u3002\n--existing  \uff1a\u8981\u6c42\u53ea\u66f4\u65b0\u76ee\u6807\u7aef\u5df2\u5b58\u5728\u7684\u6587\u4ef6\uff0c\u76ee\u6807\u7aef\u8fd8\u4e0d\u5b58\u5728\u7684\u6587\u4ef6\u4e0d\u4f20\u8f93\u3002\u6ce8\u610f\uff0c\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\u65f6\u5982\u679c\u4e0a\u5c42\u76ee\u5f55\u4e0d\u5b58\u5728\u4e5f\u4e0d\u4f1a\u4f20\u8f93\u3002\n--ignore-existing\uff1a\u8981\u6c42\u53ea\u66f4\u65b0\u76ee\u6807\u7aef\u4e0d\u5b58\u5728\u7684\u6587\u4ef6\u3002\u548c\"--existing\"\u7ed3\u5408\u4f7f\u7528\u6709\u7279\u6b8a\u529f\u80fd\uff0c\u89c1\u4e0b\u6587\u793a\u4f8b\u3002\n--remove-source-files\uff1a\u8981\u6c42\u5220\u9664\u6e90\u7aef\u5df2\u7ecf\u6210\u529f\u4f20\u8f93\u7684\u6587\u4ef6\u3002\n</code></pre>"},{"location":"linux/basic.html#updatedbmlocate","title":"Updatedb/mlocate","text":"<p><code>updatedb</code> \u547d\u4ee4\u7528\u4e8e\u66f4\u65b0 <code>locate</code> \u547d\u4ee4\u4f7f\u7528\u7684\u6570\u636e\u5e93\u3002</p> <p><code>updatedb</code> \u4f5c\u7528\u7684\u6570\u636e\u5e93\u540d\u79f0\u7531\u914d\u7f6e\u6587\u4ef6\uff08\u4e00\u822c\u4e3a <code>/etc/updatedb.conf</code>\uff09\u6216\u547d\u4ee4\u884c\u53c2\u6570\u786e\u5b9a\uff08\u4e00\u822c\u4e3a <code>/var/lib/mlocate/mlocate.db</code>\uff09\uff0c\u7531\u7cfb\u7edf\u6bcf\u65e5\u6267\u884c <code>updatedb</code> \u66f4\u65b0\u4e00\u6b21\uff0c\u66f4\u65b0\u811a\u672c\u4e00\u822c\u4e3a <code>/etc/cron.daily/mlocate</code>\uff0c\u5728\u914d\u7f6e\u6587\u4ef6 <code>/etc/anacrontab</code> \u4e2d\u88ab\u8c03\u7528\uff0c\u7531 anacron \u6bcf\u5929\u8fd0\u884c\u4e00\u6b21\u3002</p>"},{"location":"linux/binutils.html","title":"GNU Binutils","text":"<p>The GNU Binutils are a collection of binary tools. The main ones are:</p> <ul> <li>ld - the GNU linker.</li> <li>as - the GNU assembler.</li> <li>gold - a new, faster, ELF only linker.</li> </ul> <p>But they also include:</p> <ul> <li>addr2line - Converts addresses into filenames and line numbers.</li> <li>ar - A utility for creating, modifying and extracting from archives.</li> <li>c++filt - Filter to demangle encoded C++ symbols.</li> <li>dlltool - Creates files for building and using DLLs.</li> <li>elfedit - Allows alteration of ELF format files.</li> <li>gprof - Displays profiling information.</li> <li>gprofng - Collects and displays application performance data.</li> <li>nlmconv - Converts object code into an NLM.</li> <li>nm - Lists symbols from object files.</li> <li>objcopy - Copies and translates object files.</li> <li>objdump - Displays information from object files.</li> <li>ranlib - Generates an index to the contents of an archive.</li> <li>readelf - Displays information from any ELF format object file.</li> <li>size - Lists the section sizes of an object or archive file.</li> <li>strings - Lists printable strings from files.</li> <li>strip - Discards symbols.</li> <li>windmc - A Windows compatible message compiler.</li> <li>windres - A compiler for Windows resource files.</li> </ul>"},{"location":"linux/binutils.html#addr2line","title":"addr2line","text":"<p>Converts addresses into filenames and line numbers.</p> <p>\u901a\u8fc7 <code>-g</code>\u7684debug\u4fe1\u606f\uff0c\u83b7\u53d6\u9519\u8bef\u7684\u884c\u53f7\u4fe1\u606f\u3002</p> <pre><code># \u9759\u6001\u94fe\u63a5\n$ addr2line -e backtrace 0x400a3e\n# \u8f93\u51fa\u7ed3\u679c\u7c7b\u4f3c\u5982\u4e0b\u4fe1\u606f\uff0c\u53ef\u4ee5\u770b\u51fa\u884c\u53f7\u4fe1\u606f\n/home/share/work/backtrace/add.c:13\n\n# \u52a8\u6001\u94fe\u63a5\uff0c\u8fd0\u884c\u65f6\u52a8\u6001\u52a0\u8f7d\uff0c\u5176\u52a0\u8f7d\u5730\u5740\u4e0d\u4e00\u6837\n$ addr2line -e libadd.so 0x7f85839fa5c6\n??:0\n# \u901a\u8fc7 nm \u83b7\u53d6 add \u4e2d\u51fd\u6570\u7684\u5730\u5740\u57fa\u5740\uff0c\u518d\u52a0\u4e0a\u504f\u79fb\u91cf\uff0c\u53ef\u4ee5\u83b7\u5f97\u5177\u4f53\u884c\n$ addr2line -e libadd.so 0x5c6\n/home/share/work/backtrace/add.c:13\n</code></pre>"},{"location":"linux/binutils.html#ld","title":"ld","text":"<p>ld\uff08Link eDitor\uff09\u547d\u4ee4\u662f\u4e8c\u8fdb\u5236\u5de5\u5177\u96c6 GNU Binutils \u7684\u4e00\u5458\uff0c\u662f GNU \u94fe\u63a5\u5668\uff0c\u7528\u4e8e\u5c06\u76ee\u6807\u6587\u4ef6\u4e0e\u5e93\u94fe\u63a5\u4e3a\u53ef\u6267\u884c\u6587\u4ef6\u6216\u5e93\u6587\u4ef6\u3002</p> <ul> <li><code>-e</code>\u53c2\u6570\u53ef\u4ee5\u6307\u5b9a\u5165\u53e3\uff1b</li> </ul> <pre><code># compile\uff08\u8ddf\u4e0b\u9762\u7684as\u547d\u4ee4\u4e00\u8d77 \u7b49\u4ef7\u4e8e gcc -c minimal.S)\ngcc -S minimal.S &gt; minimal.s\n# assemble\nas minimal.s -o minimal.o\n# \u94fe\u63a5\u4e3a\u53ef\u6267\u884c\nld minimal.o -o minimal\n</code></pre>"},{"location":"linux/binutils.html#as","title":"as","text":"<p>as \u547d\u4ee4\u662f\u4e8c\u8fdb\u5236\u5de5\u5177\u96c6 GNU Binutils \u7684\u4e00\u5458\uff0c\u662fGNU \u63a8\u51fa\u7684\u4e00\u6b3e\u6c47\u7f16\u8bed\u8a00\u7f16\u8bd1\u5668\u96c6\uff0c\u7528\u4e8e\u5c06\u6c47\u7f16\u4ee3\u7801\u7f16\u8bd1\u4e3a\u4e8c\u8fdb\u5236\u4ee3\u7801\uff0c\u5b83\u652f\u6301\u591a\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u5904\u7406\u5668\u3002</p>"},{"location":"linux/binutils.html#nm","title":"nm","text":"<p>\u5217\u51fa\u5bf9\u8c61\u6587\u4ef6\u4e2d\u7684\u7b26\u53f7\u548c\u5730\u5740\u4fe1\u606f\u3002</p> <pre><code>$ nm hello | tail\n0000000000600e20 d __JCR_END__\n0000000000600e20 d __JCR_LIST__\n00000000004005b0 T __libc_csu_fini\n0000000000400540 T __libc_csu_init\n                 U __libc_start_main@@GLIBC_2.2.5\n000000000040051d T main\n                 U printf@@GLIBC_2.2.5\n0000000000400490 t register_tm_clones\n0000000000400430 T _start\n0000000000601030 D __TMC_END__\n</code></pre>"},{"location":"linux/binutils.html#objdump","title":"objdump","text":"<p>Displays information from object files\uff08\u4ece\u5bf9\u8c61\u6587\u4ef6\u4e2d\u663e\u793a\u4fe1\u606f\uff09\u3002</p> <p>\u8bfb\u53d6\u4e8c\u8fdb\u5236\u6216\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u5c06\u6c47\u7f16\u8bed\u8a00\u6307\u4ee4\u8f6c\u50a8\u5230\u5c4f\u5e55\u4e0a\u3002</p> <pre><code>$ objdump -d /bin/ls | head\n\n/bin/ls:     file format elf64-x86-64\n\nDisassembly of section .init:\n\n0000000000402150 &lt;_init@@Base&gt;:\n  402150:       48 83 ec 08             sub    $0x8,%rsp\n  402154:       48 8b 05 6d 8e 21 00    mov    0x218e6d(%rip),%rax        # 61afc8 &lt;__gmon_start__&gt;\n  40215b:       48 85 c0                test   %rax,%rax\n</code></pre> <p>\u9488\u5bf9<code>symbol not found</code>\uff0c\u901a\u8fc7<code>objdump -T</code>\u67e5\u770b\u7b26\u53f7\u94fe\u63a5\uff0c\u5982</p> <pre><code>$ objdump -T /usr/lib/x86_64-linux-gnu/libdde-file-manager.so.1 | grep hasPartitionTableEv\n0000000000000000      DF *UND*  0000000000000000              _ZNK12DBlockDevice17hasPartitionTableEv\n\n# \u53ef\u4ee5\u901a\u8fc7 ldd .so + awk + xargs + objdump -T \u641c\u7d22\u5305\u542b\u8be5\u7b26\u53f7\u5b9a\u4e49\u7684so\n$ objdump -T /usr/lib/x86_64-linux-gnu/libudisks2-qt5.so | grep hasPartitionTableEv\n0000000000045cb0 g    DF .text  000000000000003d  Base        _ZNK12DBlockDevice17hasPartitionTableEv\n</code></pre>"},{"location":"linux/binutils.html#readelf","title":"readelf","text":"<p>\u663e\u793a\u6709\u5173 ELF \u6587\u4ef6\u7684\u4fe1\u606f\u3002</p> <p>ELF\uff08 \u53ef\u6267\u884c\u548c\u53ef\u94fe\u63a5\u6587\u4ef6\u683c\u5f0f(Executable and Linkable File Format)\uff09\u662f\u53ef\u6267\u884c\u6587\u4ef6\u6216\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u4e3b\u6d41\u683c\u5f0f\uff0c\u4e0d\u4ec5\u662f Linux \u7cfb\u7edf\uff0c\u4e5f\u662f\u5404\u79cd UNIX \u7cfb\u7edf\u7684\u4e3b\u6d41\u6587\u4ef6\u683c\u5f0f\u3002</p> <pre><code>$ readelf -h /bin/ls\nELF Header:\n  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00\n  Class:                             ELF64\n  Data:                              2's complement, little endian\n  Version:                           1 (current)\n  OS/ABI:                            UNIX - System V\n  ABI Version:                       0\n  Type:                              EXEC (Executable file)\n  Machine:                           Advanced Micro Devices X86-64\n  Version:                           0x1\n  Entry point address:               0x4042d4\n  Start of program headers:          64 (bytes into file)\n  Start of section headers:          115696 (bytes into file)\n  Flags:                             0x0\n  Size of this header:               64 (bytes)\n  Size of program headers:           56 (bytes)\n  Number of program headers:         9\n  Size of section headers:           64 (bytes)\n  Number of section headers:         31\n  Section header string table index: 30\n</code></pre>"},{"location":"linux/binutils.html#strings","title":"strings","text":"<p>\u6253\u5370\u6587\u4ef6\u4e2d\u7684\u53ef\u6253\u5370\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\u3002</p> <pre><code>$ strings /bin/ls\n</code></pre>"},{"location":"linux/binutils.html#ldd","title":"ldd","text":"<p>\u6253\u5370\u5171\u4eab\u5bf9\u8c61\u4f9d\u8d56\u5173\u7cfb\uff0c\u53ef\u4ee5\u663e\u793a\u4f9d\u8d56\u7684\u5e93\u7684\u8def\u5f84\uff08\u9759\u6001\u4f9d\u8d56\uff09\uff0cnot found\u7684\u4f9d\u8d56\u7531\u8fd0\u884c\u65f6\u51b3\u5b9a\uff08\u5982\u914d\u7f6eLD_LIBRARY_PATH\uff09\u3002</p> <pre><code>$ ldd /bin/ls\n        linux-vdso.so.1 =&gt;  (0x00007ffef5ba1000)\n        libselinux.so.1 =&gt; /lib64/libselinux.so.1 (0x00007fea9f854000)\n        libcap.so.2 =&gt; /lib64/libcap.so.2 (0x00007fea9f64f000)\n        libacl.so.1 =&gt; /lib64/libacl.so.1 (0x00007fea9f446000)\n        libc.so.6 =&gt; /lib64/libc.so.6 (0x00007fea9f079000)\n        libpcre.so.1 =&gt; /lib64/libpcre.so.1 (0x00007fea9ee17000)\n        libdl.so.2 =&gt; /lib64/libdl.so.2 (0x00007fea9ec13000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007fea9fa7b000)\n        libattr.so.1 =&gt; /lib64/libattr.so.1 (0x00007fea9ea0e000)\n        libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007fea9e7f2000)\n</code></pre>"},{"location":"linux/binutils.html#ltrace","title":"ltrace","text":"<p><code>ltrace</code> \u547d\u4ee4\u53ef\u4ee5\u663e\u793a\u8fd0\u884c\u65f6\u4ece\u5e93\u4e2d\u8c03\u7528\u7684\u6240\u6709\u51fd\u6570\u3002</p> <p>\u770b\u5230\u88ab\u8c03\u7528\u7684\u51fd\u6570\u540d\u79f0\uff0c\u4f20\u9012\u7ed9\u8be5\u51fd\u6570\u7684\u53c2\u6570\uff0c\u51fd\u6570\u8fd4\u56de\u7684\u5185\u5bb9\u3002</p> <pre><code>$ ltrace ls\n__libc_start_main(0x4028c0, 1, 0x7ffd94023b88, 0x412950 &lt;unfinished ...&gt;\nstrrchr(\"ls\", '/')                                                 = nil\nsetlocale(LC_ALL, \"\")                                              = \"en_US.UTF-8\"\nbindtextdomain(\"coreutils\", \"/usr/share/locale\")                   = \"/usr/share/locale\"\ntextdomain(\"coreutils\")                                            = \"coreutils\"\n__cxa_atexit(0x40a930, 0, 0, 0x736c6974756572)                     = 0\nisatty(1)                                                          = 1\ngetenv(\"QUOTING_STYLE\")                                            = nil\ngetenv(\"COLUMNS\")                                                  = nil\nioctl(1, 21523, 0x7ffd94023a50)                                    = 0\n&lt;&lt; snip &gt;&gt;\nfflush(0x7ff7baae61c0)                                             = 0\nfclose(0x7ff7baae61c0)                                             = 0\n+++ exited (status 0) +++\n</code></pre>"},{"location":"linux/binutils.html#strace","title":"strace","text":"<p>\u8ddf\u8e2a\u7cfb\u7edf\u8c03\u7528\u548c\u4fe1\u53f7\uff0c\u89c1\u4f7f\u7528\u6848\u4f8b</p> <pre><code>$ strace -f /bin/ls\nexecve(\"/bin/ls\", [\"/bin/ls\"], [/* 17 vars */]) = 0\nbrk(NULL)                               = 0x686000\nmmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f967956a000\naccess(\"/etc/ld.so.preload\", R_OK)      = -1 ENOENT (No such file or directory)\nopen(\"/etc/ld.so.cache\", O_RDONLY|O_CLOEXEC) = 3\nfstat(3, {st_mode=S_IFREG|0644, st_size=40661, ...}) = 0\nmmap(NULL, 40661, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f9679560000\nclose(3)                                = 0\n&lt;&lt; snip &gt;&gt;\nfstat(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 1), ...}) = 0\nmmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f9679569000\nwrite(1, \"R2  RH\\n\", 7R2  RH\n)                 = 7\nclose(1)                                = 0\nmunmap(0x7f9679569000, 4096)            = 0\nclose(2)                                = 0\nexit_group(0)                           = ?\n+++ exited with 0 +++\n</code></pre>"},{"location":"linux/cgroup.html","title":"CGroup","text":"<p>\u5728\u5f53\u524d\u5185\u6838\u7248\u672c\uff083.x\uff09\u4e0b\uff0c\u5f00\u542f\u4e86kmem accounting\u529f\u80fd\uff0c\u4f1a\u5bfc\u81f4 memory cgroup \u7684\u6761\u76ee\u6cc4\u6f0f\u65e0\u6cd5\u56de\u6536\uff08\u65e0\u6cd5\u6b63\u5e38\u8ba1\u6570\uff09\u3002</p> <ul> <li>\u5185\u6838\u65e5\u5fd7\u7684\u201cSLUB: Unable to allocate memory on node -1\u201d\u62a5\u9519\u3002</li> </ul> <p>cgroup\uff0c\u5176\u672c\u8eab\u7684\u4f5c\u7528\u53ea\u662f\u4efb\u52a1\u8ddf\u8e2a\u3002\u4f46\u5176\u5b83\u7cfb\u7edf\uff08\u6bd4\u5982cpusets\uff0ccpuacct\uff09\uff0c\u53ef\u4ee5\u5229\u7528cgroup\u7684\u8fd9\u4e2a\u529f\u80fd\u5b9e\u73b0\u4e00\u4e9b\u65b0\u7684\u5c5e\u6027\uff0c\u6bd4\u5982\u7edf\u8ba1\u6216\u8005\u63a7\u5236\u4e00\u4e2acgroup\u4e2d\u8fdb\u7a0b\u53ef\u4ee5\u8bbf\u95ee\u7684\u8d44\u6e90\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff0ccpusets\u5b50\u7cfb\u7edf\u53ef\u4ee5\u5c06\u8fdb\u7a0b\u7ed1\u5b9a\u5230\u7279\u5b9a\u7684cpu\u548c\u5185\u5b58\u8282\u70b9\u4e0a\u3002</p> <p>control groups \u7406\u89e3\u4e3a controller \uff08system resource\uff09\uff08for\uff09\uff08process\uff09groups\uff0c\u4ee5\u4e00\u7ec4\u8fdb\u7a0b\u4e3a\u76ee\u6807\u8fdb\u884c\u7cfb\u7edf\u8d44\u6e90\u5206\u914d\u548c\u63a7\u5236\u3002</p>"},{"location":"linux/cgroup.html#_1","title":"\u529f\u80fd","text":"<ul> <li>\u8d44\u6e90\u9650\u5236\uff1a\u4efb\u52a1\u7684\u8d44\u6e90\u603b\u989d\u8fdb\u884c\u9650\u5236\uff1b</li> <li>\u4f18\u5148\u7ea7\u5206\u914d\uff1a\u901a\u8fc7\u5206\u914d\u7684CPU\u65f6\u95f4\u7247\u6570\u91cf\u53ca\u78c1\u76d8IO\u5e26\u5bbd\u5927\u5c0f\uff0c\u76f8\u5f53\u4e8e\u63a7\u5236\u4efb\u52a1\u4f18\u5148\u7ea7\uff1b</li> <li>\u8d44\u6e90\u7edf\u8ba1\uff1a\u7edf\u8ba1\u7cfb\u7edf\u7684\u8d44\u6e90\u4f7f\u7528\u91cf\uff0c\u5982CPU\u4f7f\u7528\u65f6\u957f\u3001\u5185\u5b58\u7528\u91cf\u7b49\uff0c\u9002\u7528\u4e8e\u8ba1\u8d39\uff1b</li> <li>\u4efb\u52a1\u63a7\u5236\uff1a\u5bf9\u4efb\u52a1\u6267\u884c\u8fdb\u884c\u6302\u8d77\u3001\u6062\u590d\u7b49\u64cd\u4f5c\uff1b</li> </ul>"},{"location":"linux/cgroup.html#v1v2","title":"\u7248\u672c(v1/v2)","text":"<p>Linux \u4e2d\u6709\u4e24\u4e2a cgroup \u7248\u672c\uff1acgroup v1 \u548c cgroup v2\u3002cgroup v2 \u662f Linux <code>cgroup</code> API \u7684\u4e0b\u4e00\u4e2a\u7248\u672c\uff0cv2 \u4e0d\u517c\u5bb9 v1\u3002</p> <p>cgroup v2 \u63d0\u4f9b\u4e00\u4e2a\u5177\u6709\u589e\u5f3a\u8d44\u6e90\u7ba1\u7406\u80fd\u529b\u7684\u7edf\u4e00\u63a7\u5236\u7cfb\u7edf\u3002 cgroup v2 \u5bf9 cgroup v1 \u8fdb\u884c\u591a\u9879\u6539\u8fdb\uff1a</p> <ul> <li>API \u4e2d\u5355\u4e2a\u7edf\u4e00\u7684\u5c42\u6b21\u7ed3\u6784\u8bbe\u8ba1\uff0cv2 \u53ea\u6709\u5355\u4e2a\u5c42\u7ea7\u6811</li> <li>\u66f4\u5b89\u5168\u7684\u5b50\u6811\u59d4\u6d3e\u7ed9\u5bb9\u5668</li> <li>\u66f4\u65b0\u7684\u529f\u80fd\u7279\u6027\uff0c \u4f8b\u5982\u538b\u529b\u963b\u585e\u4fe1\u606f\uff08Pressure Stall Information\uff0cPSI\uff09</li> <li>\u8de8\u591a\u4e2a\u8d44\u6e90\u7684\u589e\u5f3a\u8d44\u6e90\u5206\u914d\u7ba1\u7406\u548c\u9694\u79bb</li> <li>\u7edf\u4e00\u6838\u7b97\u4e0d\u540c\u7c7b\u578b\u7684\u5185\u5b58\u5206\u914d\uff08\u7f51\u7edc\u5185\u5b58\u3001\u5185\u6838\u5185\u5b58\u7b49\uff09</li> <li>\u8003\u8651\u975e\u5373\u65f6\u8d44\u6e90\u53d8\u5316\uff0c\u4f8b\u5982\u9875\u9762\u7f13\u5b58\u56de\u5199</li> </ul> <p>\u4e00\u4e9b Kubernetes \u7279\u6027\u4e13\u95e8\u4f7f\u7528 cgroup v2 \u6765\u589e\u5f3a\u8d44\u6e90\u7ba1\u7406\u548c\u9694\u79bb\u3002</p> <ul> <li>Ubuntu\uff08\u4ece 21.10 \u5f00\u59cb\uff0c\u63a8\u8350 22.04+\uff09</li> </ul> <pre><code>$ mount | grep cgroup2\ncgroup2 on /sys/fs/cgroup/unified type cgroup2 (rw,nosuid,nodev,noexec,relatime)\n</code></pre> <p>\u5224\u65ad\u662f\u5426\u4f7f\u7528 cgroup v2\uff1aYes if <code>/sys/fs/cgroup/cgroup.controllers</code> is present.</p>"},{"location":"linux/cgroup.html#_2","title":"\u57fa\u672c\u6982\u5ff5","text":""},{"location":"linux/cgroup.html#task","title":"Task","text":"<p>\u7cfb\u7edf\u8fdb\u7a0b\u6216\u7ebf\u7a0b</p>"},{"location":"linux/cgroup.html#cgroup_1","title":"cgroup","text":"<p>\u63a7\u5236\u7ec4\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u5957\u673a\u5236\u7528\u4e8e\u63a7\u5236\u4e00\u7ec4\u7279\u5b9a\u8fdb\u7a0b\u5bf9\u8d44\u6e90\u7684\u4f7f\u7528\u3002</p> <p>\u5173\u8054\u4e00\u7ec4task\u548c\u4e00\u7ec4subsystem\u7684\u914d\u7f6e\u53c2\u6570\u3002\u4e00\u4e2atask\u5bf9\u5e94\u4e00\u4e2a\u8fdb\u7a0b\uff0ccgroup\u662f\u8d44\u6e90\u5206\u7247\u7684\u6700\u5c0f\u5355\u4f4d\u3002</p>"},{"location":"linux/cgroup.html#subsystem","title":"subsystem","text":"<p>\u5b50\u7cfb\u7edf\uff0c\u4e00\u4e2a\u901a\u8fc7cgroup\u63d0\u4f9b\u7684\u5de5\u5177\u548c\u63a5\u53e3\u6765\u7ba1\u7406\u8fdb\u7a0b\u96c6\u5408\u7684\u6a21\u5757\u3002\u4e00\u4e2a\u5b50\u7cfb\u7edf\u5c31\u662f\u4e00\u4e2a\u5178\u578b\u7684\u201c\u8d44\u6e90\u63a7\u5236\u5668\u201d\uff0c\u7528\u6765\u8c03\u5ea6\u8d44\u6e90\u6216\u8005\u63a7\u5236\u8d44\u6e90\u4f7f\u7528\u7684\u4e0a\u9650\u3002\u5176\u5b9e\u6bcf\u79cd\u8d44\u6e90\u5c31\u662f\u4e00\u4e2a\u5b50\u7cfb\u7edf\u3002\u5b50\u7cfb\u7edf\u53ef\u4ee5\u662f\u4ee5\u8fdb\u7a0b\u4e3a\u5355\u4f4d\u7684\u4efb\u4f55\u4e1c\u897f\uff0c\u6bd4\u5982\u865a\u62df\u5316\u5b50\u7cfb\u7edf\u3001\u5185\u5b58\u5b50\u7cfb\u7edf\u3002</p>"},{"location":"linux/cgroup.html#hierarchy","title":"hierarchy","text":"<p>\u5c42\u7ea7\u6811\uff0c\u591a\u4e2acgroup\u7684\u96c6\u5408\uff0c\u8fd9\u4e9b\u96c6\u5408\u6784\u6210\u7684\u6811\u53ebhierarchy\u3002</p> <p>\u53ef\u4ee5\u8ba4\u4e3a\u8fd9\u662f\u4e00\u4e2a\u8d44\u6e90\u6811\uff0c\u9644\u7740\u5728\u8fd9\u4e0a\u9762\u7684\u8fdb\u7a0b\u53ef\u4ee5\u4f7f\u7528\u7684\u8d44\u6e90\u4e0a\u9650\u5fc5\u987b\u53d7\u6811\u4e0a\u8282\u70b9\uff08cgroup\uff09\u7684\u63a7\u5236\u3002hierarchy\u4e0a\u7684\u5c42\u6b21\u5173\u7cfb\u901a\u8fc7cgroupfs\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\u663e\u793a\u3002</p> <p>\u7cfb\u7edf\u5141\u8bb8\u591a\u4e2ahierarchy\u540c\u65f6\u5b58\u5728\uff0c\u6bcf\u4e2ahierachy\u5305\u542b\u7cfb\u7edf\u4e2d\u7684\u90e8\u5206\u6216\u8005\u5168\u90e8\u8fdb\u7a0b\u96c6\u5408\u3002</p>"},{"location":"linux/cgroup.html#cgroupfs","title":"cgroupfs","text":"<p>\u7528\u6237\u7ba1\u7406\u64cd\u7eb5cgroup\u7684\u4e3b\u8981\u63a5\u53e3\uff1a</p> <ul> <li>\u901a\u8fc7\u5728cgroupfs\u6587\u4ef6\u7cfb\u7edf\u4e2d\u521b\u5efa\u76ee\u5f55\uff0c\u5b9e\u73b0cgroup\u7684\u521b\u5efa\uff1b</li> <li>\u901a\u8fc7\u5411\u76ee\u5f55\u4e0b\u7684\u5c5e\u6027\u6587\u4ef6\u5199\u5165\u5185\u5bb9\uff0c\u8bbe\u7f6ecgroup\u5bf9\u8d44\u6e90\u7684\u63a7\u5236\uff1b</li> <li>\u5411task\u5c5e\u6027\u6587\u4ef6\u5199\u5165\u8fdb\u7a0bID\uff0c\u53ef\u4ee5\u5c06\u8fdb\u7a0b\u7ed1\u5b9a\u5230\u67d0\u4e2acgroup\uff0c\u4ee5\u6b64\u8fbe\u5230\u63a7\u5236\u8fdb\u7a0b\u8d44\u6e90\u4f7f\u7528\u7684\u76ee\u7684\uff1b</li> <li>\u5217\u51facgroup\u5305\u542b\u7684\u8fdb\u7a0bpid\u3002</li> </ul>"},{"location":"linux/cgroup.html#subsystem_1","title":"subsystem\u914d\u7f6e\u53c2\u6570\u4ecb\u7ecd","text":""},{"location":"linux/cgroup.html#blkio-block-io","title":"blkio - BLOCK IO \u8d44\u6e90\u63a7\u5236","text":"<p>\u63a7\u5236\u5b50\u7cfb\u7edf\u53ef\u4ee5\u9650\u5236\u8fdb\u7a0b\u8bfb\u5199\u7684 IOPS \u548c\u541e\u5410\u91cf\uff0c\u4f46\u5b83\u53ea\u80fd\u5bf9 Direct I/O \u7684\u6587\u4ef6\u8bfb\u5199\u8fdb\u884c\u9650\u901f\uff0c\u5bf9 Buffered I/O \u7684\u6587\u4ef6\u8bfb\u5199\u65e0\u6cd5\u9650\u5236\u3002</p> <p>Buffered I/O \u6307\u4f1a\u7ecf\u8fc7 PageCache \u7136\u540e\u518d\u5199\u5165\u5230\u5b58\u50a8\u8bbe\u5907\u4e2d\u3002\u8fd9\u91cc\u9762\u7684 Buffered \u7684\u542b\u4e49\u8ddf\u5185\u5b58\u4e2d buffer cache \u4e0d\u540c\uff0c\u8fd9\u91cc\u7684 Buffered \u542b\u4e49\u76f8\u5f53\u4e8e\u5185\u5b58\u4e2d\u7684buffer cache+page cache\u3002</p> <p>\u5728 Linux \u4e2d\uff0c\u6587\u4ef6\u9ed8\u8ba4\u8bfb\u5199\u65b9\u5f0f\u4e3a Buffered I/O\uff0c\u5e94\u7528\u7a0b\u5e8f\u4e00\u822c\u5c06\u6587\u4ef6\u5199\u5165\u5230 PageCache \u540e\u5c31\u76f4\u63a5\u8fd4\u56de\u4e86\uff0c\u7136\u540e\u5185\u6838\u7ebf\u7a0b\u4f1a\u5f02\u6b65\u5c06\u6570\u636e\u4ece\u5185\u5b58\u540c\u6b65\u5230\u78c1\u76d8\u4e2d\u3002</p> <p>cgroup v2 \u4f7f\u7528\u4e86\u7edf\u4e00\u5c42\u7ea7\uff08unified hierarchy)\uff0c\u5404\u4e2a\u5b50\u7cfb\u7edf\u90fd\u53ef\u4ee5\u6302\u8f7d\u5728\u7edf\u4e00\u5c42\u7ea7\u4e0b\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u5c5e\u4e8e\u4e00\u4e2a\u63a7\u5236\u7ec4\uff0c\u6bcf\u4e2a\u63a7\u5236\u7ec4\u91cc\u53ef\u4ee5\u5b9a\u4e49\u81ea\u5df1\u9700\u8981\u7684\u591a\u4e2a\u5b50\u7cfb\u7edf\u3002cgroup v2 \u4e2d io \u5b50\u7cfb\u7edf\u7b49\u540c\u4e8e v1 \u4e2d\u7684 blkio \u5b50\u7cfb\u7edf\u3002</p> <p>\u9650\u989d\u7c7b\u662f\u4e3b\u8981\u6709\u4e24\u79cd\u7b56\u7565\uff1a</p> <ul> <li> <p>\u4e00\u79cd\u662f\u57fa\u4e8e\u5b8c\u5168\u516c\u5e73\u961f\u5217\u8c03\u5ea6\uff08CFQ\uff1aCompletely Fair Queuing \uff09\u7684\u6309\u6743\u91cd\u5206\u914d\u5404\u4e2a cgroup \u6240\u80fd\u5360\u7528\u603b\u4f53\u8d44\u6e90\u7684\u767e\u5206\u6bd4\uff0c\u597d\u5904\u662f\u5f53\u8d44\u6e90\u7a7a\u95f2\u65f6\u53ef\u4ee5\u5145\u5206\u5229\u7528\uff0c\u4f46\u53ea\u80fd\u7528\u4e8e\u6700\u5e95\u5c42\u8282\u70b9 cgroup \u7684\u914d\u7f6e\uff1b</p> </li> <li> <p>\u53e6\u4e00\u79cd\u5219\u662f\u8bbe\u5b9a\u8d44\u6e90\u4f7f\u7528\u4e0a\u9650\uff0c\u8fd9\u79cd\u9650\u989d\u5728\u5404\u4e2a\u5c42\u6b21\u7684 cgroup \u90fd\u53ef\u4ee5\u914d\u7f6e\uff0c\u4f46\u8fd9\u79cd\u9650\u5236\u8f83\u4e3a\u751f\u786c\uff0c\u5e76\u4e14\u5bb9\u5668\u4e4b\u95f4\u4f9d\u7136\u4f1a\u51fa\u73b0\u8d44\u6e90\u7684\u7ade\u4e89\u3002</p> </li> </ul>"},{"location":"linux/cgroup.html#cpu-cpu","title":"cpu - CPU \u8d44\u6e90\u63a7\u5236","text":"<p>CPU \u8d44\u6e90\u7684\u63a7\u5236\u4e5f\u6709\u4e24\u79cd\u7b56\u7565\uff1a</p> <ul> <li>\u4e00\u79cd\u662f\u5b8c\u5168\u516c\u5e73\u8c03\u5ea6 \uff08CFS\uff1aCompletely Fair Scheduler\uff09\u7b56\u7565\uff0c\u63d0\u4f9b\u4e86\u9650\u989d\u548c\u6309\u6bd4\u4f8b\u5206\u914d\u4e24\u79cd\u65b9\u5f0f\u8fdb\u884c\u8d44\u6e90\u63a7\u5236\uff1b</li> <li><code>cpu.cfs_period_us</code>\uff1acpu\u5206\u914d\u7684\u5468\u671f(\u5fae\u79d2\uff09\uff0c\u9ed8\u8ba4\u4e3a100000</li> <li><code>cpu.cfs_quota_us</code>\uff1a\u8be5control group\u9650\u5236\u5360\u7528\u7684\u65f6\u95f4\uff08\u5fae\u79d2\uff09\uff0c\u9ed8\u8ba4\u4e3a-1\uff0c\u8868\u793a\u4e0d\u9650\u5236\u3002\u5982\u679c\u8bbe\u4e3a50000\uff0c\u8868\u793a\u5360\u752850000/100000=50%\u7684CPU\u3002</li> <li> <p><code>cpu.shares</code>\uff1a\u5bf9\u4e8e\u63a7\u5236\u7ec4\u4e4b\u95f4\u7684 CPU \u5206\u914d\u6bd4\u4f8b\uff0c\u5b83\u7684\u7f3a\u7701\u503c\u662f 1024\uff0c\u5f53\u6240\u6709\u7684\u63a7\u5236\u7ec4\u7684CPU\u603b\u989d\u8d85\u8fc7\u8282\u70b9CPU\u65f6\u8d77\u4f5c\u7528\uff1b</p> <ul> <li>\u65e0\u8bba\u5176\u4ed6\u5bb9\u5668\u7533\u8bf7\u591a\u5c11 CPU \u8d44\u6e90\uff0c\u5373\u4f7f\u8fd0\u884c\u65f6\u6574\u4e2a\u8282\u70b9\u7684 CPU \u90fd\u88ab\u5360\u6ee1\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u7684\u8fd9\u4e2a\u5bb9\u5668\u8fd8\u662f\u53ef\u4ee5\u4fdd\u8bc1\u83b7\u5f97\u9700\u8981\u7684 CPU \u6570\u76ee</li> </ul> </li> <li> <p>\u53e6\u4e00\u79cd\u662f\u5b9e\u65f6\u8c03\u5ea6\uff08RT\uff1aReal-Time Scheduler\uff09\u7b56\u7565\uff0c\u9488\u5bf9\u5b9e\u65f6\u8fdb\u7a0b\u6309\u5468\u671f\u5206\u914d\u56fa\u5b9a\u7684\u8fd0\u884c\u65f6\u95f4\u3002\u914d\u7f6e\u65f6\u95f4\u90fd\u4ee5\u5fae\u79d2\uff08\u00b5s\uff09\u4e3a\u5355\u4f4d\uff0c\u6587\u4ef6\u540d\u4e2d\u7528us\u8868\u793a</p> </li> </ul>"},{"location":"linux/cgroup.html#cpuacct-cpu","title":"cpuacct - CPU \u8d44\u6e90\u62a5\u544a","text":""},{"location":"linux/cgroup.html#cpuset-cpu","title":"cpuset - CPU \u7ed1\u5b9a","text":""},{"location":"linux/cgroup.html#device-task-device","title":"device - \u9650\u5236 task \u5bf9 device \u7684\u4f7f\u7528","text":""},{"location":"linux/cgroup.html#freezer-cgroup-task","title":"freezer - \u6682\u505c / \u6062\u590d cgroup \u4e2d\u7684 task","text":""},{"location":"linux/cgroup.html#memory-","title":"memory - \u5185\u5b58\u8d44\u6e90\u7ba1\u7406","text":"<ul> <li><code>memory.limit_in_bytes</code>\uff1a\u7269\u7406\u5185\u5b58\u4f7f\u7528\u9650\u5236</li> <li><code>memory.soft_limit_in_bytes</code>\uff1a\u9650\u5236\u7684\u5185\u5b58\u8f6f\u989d\u5ea6</li> <li> <p><code>memory.memsw.limit_in_bytes</code>\uff1a\u9650\u5236swap+memory\u7684\u5927\u5c0f</p> </li> <li> <p><code>memory.oom_disable</code>\u7684\u503c\u6765\u8bbe\u7f6e\u5185\u5b58\u8d85\u51fa\u8bbe\u5b9a\u503c\u65f6\u662f\u64cd\u4f5c\u7cfb\u7edfkill\u8fdb\u7a0b\u8fd8\u662f\u4f11\u7720\u8fdb\u7a0b\u3002</p> </li> <li><code>memory.swappiness</code> \u6587\u4ef6\u7684\u503c\u4fee\u6539\u4e3a 0\uff0c\u8fdb\u7a0b\u4e0d\u4f7f\u7528Swap\u5206\u533a\uff08\u91cd\u542f\u5931\u6548\uff09\u3002</li> </ul>"},{"location":"linux/cgroup.html#net_prio-","title":"net_prio - \u7f51\u7edc\u8bbe\u5907\u4f18\u5148\u7ea7","text":""},{"location":"linux/cgroup.html#net_cls-tc","title":"net_cls - \u914d\u5408tc\u8fdb\u884c\u7f51\u7edc\u9650\u5236","text":""},{"location":"linux/cgroup.html#perf_event-","title":"perf_event - \u7edf\u4e00\u7684\u6027\u80fd\u6d4b\u8bd5","text":"<p>cgroup\u4e2d\u7684\u4efb\u52a1\u53ef\u4ee5\u8fdb\u884c\u7edf\u4e00\u7684\u6027\u80fd\u6d4b\u8bd5\u3002 </p>"},{"location":"linux/cgroup.html#pid-","title":"pid - \u9650\u5236\u603b\u4efb\u52a1\u6570","text":"<p>linux kernel &gt;= 4.3</p> <p>\u9650\u5236cgroup\u53ca\u5176\u6240\u6709\u5b50\u5b59cgroup\u91cc\u9762\u80fd\u521b\u5efa\u7684\u603b\u7684task\u6570\u91cf\u3002</p> <p><code>pids.current</code>: \u8868\u793a\u5f53\u524dcgroup\u53ca\u5176\u6240\u6709\u5b50\u5b59cgroup\u4e2d\u73b0\u6709\u7684\u603b\u7684\u8fdb\u7a0b\u6570\u91cf</p> <p><code>pids.max</code>: \u5f53\u524dcgroup\u53ca\u5176\u6240\u6709\u5b50\u5b59cgroup\u4e2d\u6240\u5141\u8bb8\u521b\u5efa\u7684\u603b\u7684\u6700\u5927\u8fdb\u7a0b\u6570\u91cf</p>"},{"location":"linux/cgroup.html#cgroup_2","title":"cgroup\u64cd\u4f5c\u51c6\u5219\u4e0e\u65b9\u6cd5","text":""},{"location":"linux/cgroup.html#_3","title":"\u51c6\u5219","text":""},{"location":"linux/cgroup.html#_4","title":"\u4e00\u4e2a\u5c42\u7ea7\u53ef\u4ee5\u6709\u591a\u4e2a\u5b50\u7cfb\u7edf","text":"<p>mount \u7684\u65f6\u5019hierarchy\u53ef\u4ee5attach\u591a\u4e2asubsystem\uff0c\u5982CPU\u548cMemory\u7684\u5b50\u7cfb\u7edf\u9644\u52a0\u5230\u540c\u4e00\u4e2a\u5c42\u7ea7\u3002</p>"},{"location":"linux/cgroup.html#_5","title":"\u4e00\u4e2a\u5df2\u7ecf\u88ab\u6302\u8f7d\u7684\u5b50\u7cfb\u7edf\u53ea\u80fd\u88ab\u518d\u6b21\u6302\u8f7d\u5728\u4e00\u4e2a\u7a7a\u7684\u5c42\u7ea7\u4e0a","text":"<p>\u5df2\u7ecfmount\u4e00\u4e2asubsystem\u7684hierarchy\u4e0d\u80fd\u6302\u8f7d\u4e00\u4e2a\u5df2\u7ecf\u88ab\u5176\u5b83hierarchy\u6302\u8f7d\u7684subsystem</p>"},{"location":"linux/cgroup.html#taskhierarchycgroup","title":"\u6bcf\u4e2atask\u53ea\u80fd\u5728\u540c\u4e00\u4e2ahierarchy\u7684\u552f\u4e00\u4e00\u4e2acgroup\u91cc","text":"<p>\u4e0d\u80fd\u5728\u540c\u4e00\u4e2ahierarchy\u4e0b\u6709\u8d85\u8fc7\u4e00\u4e2acgroup\u7684tasks\u91cc\u540c\u65f6\u6709\u8fd9\u4e2a\u8fdb\u7a0b\u7684pid</p>"},{"location":"linux/cgroup.html#forkcgroupforkcgroup","title":"\u5b50\u8fdb\u7a0b\u5728\u88abfork\u51fa\u65f6\u81ea\u52a8\u7ee7\u627f\u7236\u8fdb\u7a0b\u6240\u5728cgroup\uff0c\u4f46\u662ffork\u4e4b\u540e\u5c31\u53ef\u4ee5\u6309\u9700\u8c03\u6574\u5230\u5176\u4ed6cgroup","text":""},{"location":"linux/cgroup.html#_6","title":"\u65b9\u6cd5","text":""},{"location":"linux/cgroup.html#hierarchy_1","title":"\u5c42\u7ea7\uff08Hierarchy \uff09","text":"<pre><code># \u521b\u5efa\u4e86\u4e00\u4e2aHierarchy\uff08/sys/fs/cgroup \u53ea\u8bfb\uff1f\uff09\n$ mkdir /sys/fs/cgroup/cpu_and_mem \n# \u6302\u8f7d\u751f\u6548\uff0c\u5e76\u9644\u52a0\u4e86cpu\u548ccpuset\u4e24\u4e2a\u5b50\u7cfb\u7edf\u3002\n$ mount -t cgroup -o cpu,cpuset cpu_and_mem /sys/fs/cgroup/cpu_and_mem/ \n# \u9644\u52a0memory\u5b50\u7cfb\u7edf\n$ mount -t cgroup -o remount,cpu,cpuset,memory cpu_and_mem /sys/fs/cgroup/cpu_and_mem/\n# \u5265\u79bbmemory\u5b50\u7cfb\u7edf\n$ mount -t cgroup -o remount,cpu cpu_and_mem /sys/fs/cgroup/cpu_and_mem/\n# \u5220\u9664\u5c42\u7ea7\n$ umount /sys/fs/cgroup/cpu_and_mem/\n</code></pre>"},{"location":"linux/cgroup.html#control-group","title":"Control Group","text":"<p>\u521b\u5efaHierarchy\u7684\u65f6\u5019\u5176\u5b9e\u5df2\u7ecf\u521b\u5efa\u4e86\u4e00\u4e2aControl Group\u53eb\u505aroot group\uff0c\u5176\u8868\u73b0\u5f62\u5f0f\u5c31\u662f\u4e00\u4e2a\u76ee\u5f55\uff0c\u4e00\u4e2a\u76ee\u5f55\u5c31\u662f\u4e00\u4e2aControl Group\u3002</p> <pre><code># -t\u6307\u5b9a\u7684\u7528\u6237\u6216\u8005\u7ec4\u5bf9tasks\u6587\u4ef6\u7684\u62e5\u6709\u6743\n# -a\u6307\u5b9a\u7684\u7528\u6237\u6216\u8005\u7ec4\u5bf9\u5176\u5b83\u6587\u4ef6\u7684\u62e5\u6709\u6743\n# -g \u6307\u5b9a\u8981\u9644\u52a0\u7684\u5b50\u7cfb\u7edf\uff08\u5fc5\u987b\u662f\u5c42\u7ea7\u62e5\u6709\u7684\uff09\u548cControl Groups\u8def\u5f84\n$ cgcreate -t uid:gid -a uid:gid -g subsystems:path\n\n# cgcreate\u4f1a\u6839\u636e-g\u540e\u9762\u6307\u5b9a\u7684\u5b50\u7cfb\u7edf\uff0c\u627e\u5230\u5305\u542b\u8fd9\u4e9b\u5b50\u7cfb\u7edf\u7684\u6240\u6709Hierarchy\uff0c\u5e76\u4e3a\u5176\u521b\u5efacontrol group\n$ cgcreate -g cpuset:/subgroup\n\n# \u5220\u9664\u7684\u65f6\u5019\u4e5f\u8981\u6307\u5b9a\u5b50\u7cfb\u7edf\uff0c\u4f1a\u6839\u636e\u5b50\u7cfb\u7edf\u627e\u5230\u6240\u6709\u7684Hierarchy \u4e2d\u7684\u6307\u5b9aControl Group\u6765\u5220\u9664\n$ cgdelete cpuset,memory:/subgroup\n</code></pre>"},{"location":"linux/cgroup.html#seccomp","title":"seccomp","text":"<p>linuxkernel\u4ece2.6.23\u7248\u672c\u5f00\u59cb\u6240\u652f\u6301\u7684\u4e00\u79cd\u5b89\u5168\u673a\u5236\u3002</p> <p>\u5728Linux\u7cfb\u7edf\u91cc\uff0c\u5927\u91cf\u7684\u7cfb\u7edf\u8c03\u7528\uff08systemcall\uff09\u76f4\u63a5\u66b4\u9732\u7ed9\u7528\u6237\u6001\u7a0b\u5e8f\u3002\u4f46\u662f\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u7cfb\u7edf\u8c03\u7528\u90fd\u88ab\u9700\u8981\uff0c\u800c\u4e14\u4e0d\u5b89\u5168\u7684\u4ee3\u7801\u6ee5\u7528\u7cfb\u7edf\u8c03\u7528\u4f1a\u5bf9\u7cfb\u7edf\u9020\u6210\u5b89\u5168\u5a01\u80c1\u3002\u901a\u8fc7seccomp\u9650\u5236\u7a0b\u5e8f\u4f7f\u7528\u67d0\u4e9b\u7cfb\u7edf\u8c03\u7528\uff0c\u8fd9\u6837\u53ef\u4ee5\u51cf\u5c11\u7cfb\u7edf\u7684\u66b4\u9732\u9762\uff0c\u540c\u65f6\u662f\u7a0b\u5e8f\u8fdb\u5165\u4e00\u79cd\u201c\u5b89\u5168\u201d\u7684\u72b6\u6001\u3002</p> <ol> <li>\u4eceLinux3.8\u5f00\u59cb\uff0c\u53ef\u4ee5\u5229\u7528<code>/proc/[pid]/status</code>\u4e2d\u7684Seccomp\u5b57\u6bb5\u67e5\u770b\u3002\u5982\u679c\u6ca1\u6709seccomp\u5b57\u6bb5\uff0c\u8bf4\u660e\u5185\u6838\u4e0d\u652f\u6301seccomp\u3002</li> </ol>"},{"location":"linux/cgroup.html#_7","title":"\u9a71\u52a8","text":"<p>systemd\u548ccgroupfs\u90fd\u662fCGroup\u7ba1\u7406\u5668\uff0c\u800csystemd\u662f\u5927\u591a\u6570Linux\u53d1\u884c\u7248\u539f\u751f\u7684\u3002</p> <ul> <li>\u540c\u65f6\u4f7f\u7528cgroupfs\u548csystemd\u7684\u8282\u70b9\uff0c\u5728\u8d44\u6e90\u7d27\u5f20\u65f6\u4f1a\u53d8\u5f97\u4e0d\u7a33\u5b9a\u3002</li> </ul> <p>\u5f53\u9009\u62e9systemd\u4f5c\u4e3aLinux\u53d1\u884c\u7248\u7684init system\u65f6\uff0cinit proccess\u751f\u6210\u5e76\u4f7f\u7528root\u63a7\u5236\u7ec4\uff08/sys/fs/cgroup\uff09\uff0c\u5e76\u5145\u5f53CGroup\u7ba1\u7406\u5668\u3002</p>"},{"location":"linux/cgroup.html#_8","title":"\u4f7f\u7528\u793a\u4f8b","text":""},{"location":"linux/cgroup.html#linuxcgroup","title":"Linux\u662f\u5426\u542f\u7528cgroup","text":"<pre><code>$ uname -r\n# 4.18.0-24-generic\n$ cat /boot/config-4.18.0-24-generic | grep CGROUP\n# \u5bf9\u5e94\u7684CGROUP\u9879\u4e3a\u201cy\u201d\u4ee3\u8868\u5df2\u7ecf\u6253\u5f00linux cgroups\u529f\u80fd\u3002\n</code></pre> <p>Centos\u9ed8\u8ba4\u5df2\u7ecf\u4e3a\u6bcf\u4e2a\u5b50\u7cfb\u7edf\u521b\u5efa\u5355\u72ecHierarchy \uff0c\u8fdb\u884c\u67e5\u770b\uff1a</p> <pre><code>$ mount -t cgroup\ntmpfs /sys/fs/cgroup tmpfs ro,seclabel,nosuid,nodev,noexec,mode=755 0 0\ncgroup /sys/fs/cgroup/systemd cgroup rw,seclabel,nosuid,nodev,noexec,relatime,xattr,release_agent=/usr/lib/systemd/systemd-cgroups-agent,name=systemd 0 0\ncgroup /sys/fs/cgroup/hugetlb cgroup rw,seclabel,nosuid,nodev,noexec,relatime,hugetlb 0 0\ncgroup /sys/fs/cgroup/cpu,cpuacct cgroup rw,seclabel,nosuid,nodev,noexec,relatime,cpuacct,cpu 0 0\ncgroup /sys/fs/cgroup/perf_event cgroup rw,seclabel,nosuid,nodev,noexec,relatime,perf_event 0 0\ncgroup /sys/fs/cgroup/net_cls,net_prio cgroup rw,seclabel,nosuid,nodev,noexec,relatime,net_prio,net_cls 0 0\ncgroup /sys/fs/cgroup/cpuset cgroup rw,seclabel,nosuid,nodev,noexec,relatime,cpuset 0 0\ncgroup /sys/fs/cgroup/memory cgroup rw,seclabel,nosuid,nodev,noexec,relatime,memory 0 0\ncgroup /sys/fs/cgroup/blkio cgroup rw,seclabel,nosuid,nodev,noexec,relatime,blkio 0 0\ncgroup /sys/fs/cgroup/devices cgroup rw,seclabel,nosuid,nodev,noexec,relatime,devices 0 0\ncgroup /sys/fs/cgroup/pids cgroup rw,seclabel,nosuid,nodev,noexec,relatime,pids 0 0\ncgroup /sys/fs/cgroup/freezer cgroup rw,seclabel,nosuid,nodev,noexec,relatime,freezer 0 0\n</code></pre>"},{"location":"linux/cgroup.html#cpu","title":"\u663e\u793aCPU\u4f7f\u7528\u6bd4\u4f8b","text":"<p>\u5728\u76ee\u5f55<code>/sys/fs/cgroup/cpu</code>\u4e0b\u521b\u5efa\u6587\u4ef6\u5939\uff0c\u5c31\u521b\u5efa\u4e86\u4e00\u4e2acontrol group</p> <p>root \u7528\u6237\uff0c\u5199\u4e00\u4e2a\u6b7b\u5faa\u73af\u7684\u4ee3\u7801\uff0c\u5c06CPU\u4f7f\u7528\u7387\u901a\u8fc7cgroup\u9650\u5236\u5728 20%</p> <pre><code># \u5728/sys/fs/cgroup/cpu/ \u521b\u5efa\u63a7\u5236\u7ec4/\u5c42\u7ea7\n$ mkdir /sys/fs/cgroup/cpu/test\n# \u521b\u5efa\u6210\u529f\u540e\uff0c\u81ea\u52a8\u521b\u5efacpu\u914d\u7f6e\u6587\u4ef6\n$ cd /sys/fs/cgroup/cpu/test\n$ ls\n# cgroup.clone_children\u00a0 cgroup.procs\u00a0 cpuacct.stat\u00a0 cpuacct.usage\u00a0 cpuacct.usage_percpu\u00a0 # cpu.cfs_period_us\u00a0 cpu.cfs_quota_us\u00a0 cpu.shares\u00a0 cpu.stat\u00a0 notify_on_release\u00a0 tasks\n\n$ cat cpu.cfs_quota_us\n# -1\n# \u5982\u679ccgroup\u53ea\u8bfb\uff0c\u6267\u884c mount -o remount,rw /sys/fs/cgroup\n# \u9650\u5236\u8fdb\u7a0b\u53ea\u5360\u7528 20%\u7684CPU\n$ echo 100000 &gt; cpu.cfs_period_us\n$ echo 20000 &gt; cpu.cfs_quota_us\n# \u5c06\u8fdb\u7a0b\u53f7\u5199\u5165tasks\u91cc\n$ echo 30167 &gt; tasks\n\n# \u5220\u9664cgroup (\u8981\u4e48\u505c\u6b62\u8fdb\u7a0b\uff0c\u8981\u4e48\u5c06\u8fdb\u7a0b\u4ecetasks\u6587\u4ef6\u91cc\u5220\u9664)\nrmdir tasks\n</code></pre>"},{"location":"linux/cgroup.html#_9","title":"\u9650\u5236\u8fdb\u7a0b\u53ef\u521b\u5efa\u7684\u5b50\u8fdb\u7a0b\u6570","text":"<pre><code>$ mount | grep pids\ncgroup on /sys/fs/cgroup/pids type cgroup (rw,nosuid,nodev,noexec,relatime,pids)\n$ cd /sys/fs/cgroup/pids/\n$ mkdir test\n$ cd test/\n$ ls -l\ntotal 0\n-rw-r--r-- 1 root root 0 Nov 23 16:18 cgroup.clone_children\n--w--w--w- 1 root root 0 Nov 23 16:18 cgroup.event_control\n-rw-r--r-- 1 root root 0 Nov 23 16:18 cgroup.procs\n-rw-r--r-- 1 root root 0 Nov 23 16:18 notify_on_release\n-r--r--r-- 1 root root 0 Nov 23 16:18 pids.current\n-rw-r--r-- 1 root root 0 Nov 23 16:18 pids.max\n-rw-r--r-- 1 root root 0 Nov 23 16:18 tasks\n# \u5c06pids.max\u8bbe\u7f6e\u4e3a1\uff0c\u5373\u5f53\u524dcgroup\u53ea\u5141\u8bb8\u6709\u4e00\u4e2a\u8fdb\u7a0b\n$ echo 1 &gt;pids.max \n# \u5c06\u5f53\u524dbash\u8fdb\u7a0b\u52a0\u5165\u5230\u8be5cgroup\n$ echo $$ &gt; cgroup.procs\n$ /bin/echo \"Here's some processes for you.\" | cat\nbash: fork: retry: Resource temporarily unavailable\nbash: fork: retry: Resource temporarily unavailable\n</code></pre>"},{"location":"linux/cgroup.html#gpu","title":"\u5982\u4f55\u652f\u6301GPU","text":"<p>Linux\u4e2d\u6bcf\u4e2a\u8bbe\u5907\u90fd\u6709\u4e00\u4e2a\u8bbe\u5907\u53f7\uff0c\u8bbe\u5907\u53f7\u7531\u4e3b\u8bbe\u5907\u53f7\u548c\u6b21\u8bbe\u5907\u53f7\u4e24\u90e8\u5206\u7ec4\u6210\u3002</p> <pre><code>#\u663e\u793aGPU\u7684\u4e3b\u8bbe\u5907\u53f7\u548c\u6b21\u8bbe\u5907\u53f7\n$ ls -l /dev | grep nvidia \ncrw-rw-rw-   1 root root    195,   0 Nov  9 13:34 nvidia0\ncrw-rw-rw-   1 root root    195,   1 Nov  9 13:34 nvidia1\ncrw-rw-rw-   1 root root    195,   2 Nov  9 13:34 nvidia2\ncrw-rw-rw-   1 root root    195,   3 Nov  9 13:34 nvidia3\n\n#\u53ea\u663e\u793a\u4e3b\u8bbe\u5907\u53f7\n$ cat /proc/devices\n</code></pre> <p>cgroup \u7981\u7528\u8bbe\u5907\u7684\u8bbf\u95ee</p> <pre><code># the c indicates that /dev/tty is a character device, 195,0 is major and minor numbers of the device. The last w is write permission, so the above command forbids tasks to write to the /dev/tty.\n$ echo \"c 195:0 w\" &gt; devices.deny\n</code></pre> <p>\u521b\u5efa\u8fdb\u7a0b\u6b7b\u5faa\u73af<code>test.sh</code>\u6267\u884c nvidia-smi\uff0c\u8bb0\u5f55 test.sh \u7684\u8fdb\u7a0b\u53f7</p> <pre><code># test.sh\nwhile true; do\n    nvidia-smi\n    sleep 1\ndone\n</code></pre> <p>\u5c06\u8fdb\u7a0b\u53f7\u5199\u5230 tasks \u91cc\u9762\uff0c\u53ef\u4ee5\u53d1\u73b0\u4e0a\u9762\u7684\u811a\u672c\u663e\u793a\u7684GPU\u5c11\u4e86\u4e00\u4e2a</p> <pre><code>Thu May 18 19:11:30 2023       \n+-----------------------------------------------------------------------------+\n| NVIDIA-SMI 460.73.01    Driver Version: 460.73.01    CUDA Version: 11.2     |\n|-------------------------------+----------------------+----------------------+\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|                               |                      |               MIG M. |\n|===============================+======================+======================|\n|   0  Tesla T4            Off  | 00000000:3B:00.0 Off |                    0 |\n| N/A   28C    P8    10W /  70W |      0MiB / 15109MiB |      0%      Default |\n|                               |                      |                  N/A |\n+-------------------------------+----------------------+----------------------+\n\n+-----------------------------------------------------------------------------+\n| Processes:                                                                  |\n|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n|        ID   ID                                                   Usage      |\n|=============================================================================|\n|  No running processes found                                                 |\n+-----------------------------------------------------------------------------+\nNo devices were found\nNo devices were found\nNo devices were found\n</code></pre>"},{"location":"linux/cgroup.html#group","title":"\u4f7f\u7528<code>group</code>\u9650\u5236\u5355\u7528\u6237/\u591a\u7528\u6237\u8ba1\u7b97\u8d44\u6e90","text":"<p>yum install libcgroup-tools</p> <p>apt install cgroup-tools</p> <p>\u5728 <code>/etc/cgconfig.conf</code>\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff0c\u5c06\u4f1a\u5bf9\u7ec4users_mem_limit \u5185\u7684\u7528\u6237\u6240\u80fd\u7533\u8bf7\u7684\u6700\u5927\u5185\u5b58\u8fdb\u884c\u9650\u5236\u3002</p> <pre><code># template \u8868\u793a\u6a21\u677f\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u7528\u6237\u5355\u72ec\u9650\u5236\ntemplate users/%u {\n    memory {\n        memory.limit_in_bytes = 200M;\n        memory.memsw.limit_in_bytes = 0M;\n    }   \n    cpu {\n        cpu.cfs_quota_us = 200000;\n        cpu.cfs_period_us = 100000;\n    }   \n}\n# group\u662f\u7279\u6b8a\u5b57\u6bb5\uff0c`rootg`\u662f\u7ec4\u7684\u540d\u79f0\n# \u5c5e\u4e8e\u540c\u4e00\u7ec4\u7684\u662f\u5171\u4eab\u8d44\u6e90\u9650\u5236\ngroup rootg {\n    memory {\n        memory.limit_in_bytes = 500M;\n    }   \n    cpu {\n        cpu.cfs_quota_us = 400000;\n        cpu.cfs_period_us = 100000;\n    }   \n}\n</code></pre> <p><code>/etc/cgrules.conf</code>\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff0c\u5b9e\u73b0\u5c06\u67d0\u4e2a/\u67d0\u4e9b\u7528\u6237\u6dfb\u52a0\u5230\u8be5\u7ec4\u3002</p> <pre><code>#\u7528\u6237\u540d               #\u9650\u5236\u7c7b\u578b                #\u6240\u5c5e\u7ec4\nroot                cpu,memory              rootg\n*                   cpu,memory              users/%u\n</code></pre> <p>\u8bbe\u7f6e<code>cgconfig.service</code>\u5f00\u542f\u81ea\u542f\u52a8</p> <ul> <li>\u5f53\u670d\u52a1\u542f\u52a8\u4ee5\u540e\uff0c\u5728<code>/sys/fs/cgroup/cpu/</code>\u548c<code>/sys/fs/cgroup/memory/</code>\u76ee\u5f55\u4e0b\uff0c\u4f1a\u51fa\u73b0\u4ee5 <code>root</code>\u547d\u540d\u548c<code>users</code>\u547d\u540d\u7684\u76ee\u5f55\u3002</li> <li><code>root</code>\u76ee\u5f55\u4e0b\uff0c\u5373\u662f\u5bf9root\u7528\u6237\u7684\u8d44\u6e90\u9650\u5236\uff0c<code>users</code>\u76ee\u5f55\u4e0b\u662f\u767b\u9646\u5230\u6b64\u8282\u70b9\u4e0a\u666e\u901a\u7528\u6237\u7684\u8d44\u6e90\u9650\u5236\u3002</li> </ul> <pre><code>#\u5f00\u673a\u542f\u52a8\nsystemctl enable cgconfig\nsystemctl enable cgred\n#\u91cd\u542f\u670d\u52a1\nsystemctl restart cgconfig\nsystemctl restart cgred\n</code></pre>"},{"location":"linux/chmod.html","title":"Chmod","text":""},{"location":"linux/chmod.html#_1","title":"\u57fa\u7840","text":"<p>chmod \u67094\u4f4d\u6570\uff0c\u6bcf\u4f4d\u4e3a0~7\u3002</p> <p>\u7b2c\u4e00\u4f4d\uff1a\u9ed8\u8ba4\u4e3a0\uff0c4\u8868\u793a\u8bbe\u7f6euid\uff08setuid\uff09\uff0c2\u8868\u793a\u8bbe\u7f6egid\uff0c1\u8868\u793a\u8bbe\u7f6e\u7c98\u6ede\u4f4d</p> <p>\u7b2c\u4e8c\u4f4d\uff1a\u6240\u5c5e\u7528\u6237u\u7684\u6743\u9650\uff0c4\uff0c2\uff0c1</p> <p>\u7b2c\u4e09\u4f4d\uff1a\u6240\u5c5e\u7528\u6237\u7ec4g\u7684\u6743\u9650\uff0c4\uff0c2\uff0c1</p> <p>\u7b2c\u56db\u4f4d\uff1a\u5176\u5b83\u7528\u6237o\u7684\u6743\u9650\uff0c4\uff0c2\uff0c1</p>"},{"location":"linux/chmod.html#id","title":"id","text":"<p>uid(user id)</p> <ul> <li>\u7528\u6237\u7684ID</li> </ul> <p>gid(group id)</p> <ul> <li>\u7528\u6237\u7ec4id</li> </ul> <p>ruid(real user ID)</p> <ul> <li>ruid\u53ef\u4ee5\u7406\u89e3\u4e3a\u54ea\u4e2a\u7528\u6237\u6267\u884c\u4e86\u8fd9\u4e2a\u7a0b\u5e8f\u6216\u8005\u6587\u4ef6</li> </ul> <p>euid(effective user ID)</p> <ul> <li>\u5f53\u8fdb\u7a0b\u6267\u884c\u65f6\u95f4, \u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5bf9euid\u8fdb\u884c\u8bc6\u522b, \u4ee5\u6b64\u6765\u5224\u65ad\u5230\u5e95\u7528\u4ec0\u4e48\u6743\u9650\u6765\u6267\u884c\u8fd9\u4e2a\u8fdb\u7a0b\u3002</li> </ul>"},{"location":"linux/chmod.html#setuid","title":"setuid","text":"<p>\u8bbe\u7f6e\u8fdb\u7a0b\u7684<code>euid</code>\u4e3a\u7a0b\u5e8f\u7684\u62e5\u6709\u8005\u7684<code>uid</code>\uff0c\u5373\u5f53\u4e00\u4e2a\u5177\u6709\u6267\u884c\u6743\u9650\u7684\u6587\u4ef6\u8bbe\u7f6eSetUID\u6743\u9650\u540e\uff0c\u7528\u6237\u6267\u884c\u8fd9\u4e2a\u6587\u4ef6\u65f6\u5c06\u4ee5\u6587\u4ef6\u6240\u6709\u8005\u7684\u8eab\u4efd\u6267\u884c\u3002</p> <p>chmod 4750 \u8868\u793a\u6587\u4ef6\u6267\u884c\u65f6\u4ee5\u6587\u4ef6\u6240\u6709\u8005\u7684\u8eab\u4efd\u6267\u884c\u3002</p> <ul> <li>\u53ef\u4ee5\u7528\u4f5c\u666e\u901a\u7528\u6237\u6267\u884c\u6307\u5b9a\u7684\u4e00\u4e9b\u7cfb\u7edf\u547d\u4ee4\uff1f</li> </ul>"},{"location":"linux/chmod.html#sticky-bit","title":"\u7c98\u6ede\u4f4d(Sticky bit)","text":"<p>\u7c98\u6ede\u4f4d\u6743\u9650\u662f\u9488\u5bf9\u76ee\u5f55\u7684\uff0c\u5bf9\u6587\u4ef6\u65e0\u6548\u3002</p> <p>\u5f53\u2f6c\u5f55\u88ab\u8bbe\u7f6e\u4e86\u7c98\u6ede\u4f4d\u6743\u9650\u4ee5\u540e\uff0c\u5373\u4fbf\u2f64\u6237\u5bf9\u8be5\u2f6c\u5f55\u6709\u5199\u2f0a\u6743\u9650\uff0c\u4e5f\u4e0d\u80fd\u5220\u9664\u8be5\u2f6c\u5f55\u4e2d\u5176\u4ed6\u2f64\u6237\u7684\u2f42\u4ef6\u6570\u636e\uff0c\u2f7d\u662f\u53ea\u6709\u8be5\u2f42\u4ef6\u7684\u6240\u6709\u8005\u548croot\u2f64\u6237\u624d\u6709\u6743\u5c06\u5176\u5220\u9664\u3002</p> <p>chmod o+t \u7684\u65b9\u5f0f\u7ed9other\u7528\u6237\u8bbe\u7f6e\u7c98\u6ede\u4f4d</p>"},{"location":"linux/chroot.html","title":"Chroot","text":"<p>chroot\uff0c\u5373 change root directory (\u66f4\u6539 root \u76ee\u5f55)\u3002\u5728 linux \u7cfb\u7edf\u4e2d\uff0c\u7cfb\u7edf\u9ed8\u8ba4\u7684\u76ee\u5f55\u7ed3\u6784\u90fd\u662f\u4ee5 /\uff0c\u5373\u4ee5\u6839 (root) \u5f00\u59cb\u7684\u3002\u800c\u5728\u4f7f\u7528 chroot \u4e4b\u540e\uff0c\u7cfb\u7edf\u7684\u76ee\u5f55\u7ed3\u6784\u5c06\u4ee5\u6307\u5b9a\u7684\u4f4d\u7f6e\u4f5c\u4e3a / \u4f4d\u7f6e\u3002</p> <ul> <li>\u589e\u52a0\u4e86\u7cfb\u7edf\u7684\u5b89\u5168\u6027\uff0c\u9650\u5236\u4e86\u7528\u6237\u7684\u6743\u529b\uff1a</li> <li>\u5efa\u7acb\u4e00\u4e2a\u4e0e\u539f\u7cfb\u7edf\u9694\u79bb\u7684\u7cfb\u7edf\u76ee\u5f55\u7ed3\u6784\uff0c\u65b9\u4fbf\u7528\u6237\u7684\u5f00\u53d1\uff1a</li> <li>\u5207\u6362\u7cfb\u7edf\u7684\u6839\u76ee\u5f55\u4f4d\u7f6e\uff0c\u5f15\u5bfc Linux \u7cfb\u7edf\u542f\u52a8\u4ee5\u53ca\u6025\u6551\u7cfb\u7edf\u7b49\uff1a</li> </ul>"},{"location":"linux/chroot.html#_1","title":"\u793a\u4f8b\u4f7f\u7528","text":"<p>busybox \u5305\u542b\u4e86\u4e30\u5bcc\u7684\u5de5\u5177\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e9b\u5de5\u5177\u653e\u7f6e\u5728\u4e00\u4e2a\u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u901a\u8fc7 chroot \u6784\u9020\u51fa\u4e00\u4e2a mini \u7cfb\u7edf\u3002</p> <pre><code># \u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u76ee\u5f55 rootfs\n$ mkdir rootfs\n# \u628a busybox \u955c\u50cf\u4e2d\u7684\u6587\u4ef6\u89e3\u538b\u5230 rootfs \u76ee\u5f55\n$ (docker export $(docker create busybox) | tar -C rootfs -xvf -)\n# \u67e5\u770brootfs\u76ee\u5f55\u4e0b\u5185\u5bb9\uff08\u5305\u62ec\u57fa\u672c\u7684/bin,/dev,/etc\u7b49\u76ee\u5f55\uff09\n$ ls rootfs\n# \u901a\u8fc7chroot\u6267\u884c\u547d\u4ee4\n$ sudo chroot rootfs /bin/pwd\n$ sudo chroot rootfs /bin/sh\n</code></pre>"},{"location":"linux/chroot.html#_2","title":"\u539f\u7406","text":"<p>\u7b49\u4ef7\u4e8e\u8c03\u7528\u51fd\u6570<code>chroot()</code>\u548c<code>chdir()</code>\u3002</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[])\n{\n  if(argc&lt;2){\n    printf(\"Usage: chroot NEWROOT [COMMAND...] \\n\");\n    return 1;\n  }\n  if(chroot(argv[1])) {\n    perror(\"chroot\");\n    return 1;\n  }\n\n  if(chdir(\"/\")) {\n    perror(\"chdir\");\n    return 1;\n  }\n\n  if(argc == 2) {\n    // hardcode /bin/sh for my busybox tools.\n    argv[0] = (char *)\"/bin/sh\";\n\n    argv[1] = (char *) \"-i\";\n    argv[2] = NULL;\n  } else {\n    argv += 2;\n  }\n\n  execvp (argv[0], argv);\n  printf(\"chroot: cannot run command `%s`\\n\", *argv);\n\n  return 0;\n}\n</code></pre>"},{"location":"linux/firewall.html","title":"\u9632\u706b\u5899","text":"<p>\u67e5\u770bfirewall\u670d\u52a1\u72b6\u6001</p> <pre><code>systemctl status firewalld\n</code></pre> <p>\u67e5\u770bfirewall\u7684\u72b6\u6001 bash</p> <pre><code>firewall-cmd --state\n</code></pre> <p>\u5f00\u542f\u3001\u91cd\u542f\u3001\u5173\u95ed\u3001firewalld.service\u670d\u52a1</p> <pre><code># \u5f00\u542f\nservice firewalld start\n# \u91cd\u542f\nservice firewalld restart\n# \u5173\u95ed\nservice firewalld stop\n</code></pre> <p>\u67e5\u770b\u9632\u706b\u5899\u89c4\u5219</p> <pre><code>firewall-cmd --list-all \n</code></pre> <p>\u67e5\u8be2\u3001\u5f00\u653e\u3001\u5173\u95ed\u7aef\u53e3</p> <pre><code># \u67e5\u8be2\u7aef\u53e3\u662f\u5426\u5f00\u653e\nfirewall-cmd --query-port=8080/tcp\n# \u5f00\u653e80\u7aef\u53e3\nfirewall-cmd --permanent --add-port=80/tcp\n# \u79fb\u9664\u7aef\u53e3\nfirewall-cmd --permanent --remove-port=80/tcp\n#\u91cd\u542f\u9632\u706b\u5899(\u4fee\u6539\u914d\u7f6e\u540e\u8981\u91cd\u542f\u9632\u706b\u5899)firewall-cmd --reload\n# \u53c2\u6570\u89e3\u91ca\n\n1\u3001firwall-cmd\uff1a\u662fLinux\u63d0\u4f9b\u7684\u64cd\u4f5cfirewall\u7684\u4e00\u4e2a\u5de5\u5177\uff1b\n2\u3001--permanent\uff1a\u8868\u793a\u8bbe\u7f6e\u4e3a\u6301\u4e45\uff1b\n3\u3001--add-port\uff1a\u6807\u8bc6\u6dfb\u52a0\u7684\u7aef\u53e3\uff1b\n</code></pre>"},{"location":"linux/fs.html","title":"\u6587\u4ef6\u7cfb\u7edf","text":""},{"location":"linux/fs.html#bootfs","title":"Bootfs","text":"<p>\u5305\u542b bootloader\u548c Kernel\uff0cbootloader\u4e3b\u8981\u662f\u5f15\u5bfc\u52a0 kernel\uff0cLinux\u521a\u542f\u52a8\u65f6\u4f1a\u52a0bootfs\u6587\u4ef6\u7cfb\u7edf\uff0c\u5728 Docker\u955c\u50cf\u7684\u6700\u5e95\u5c42\u662fbootfs.</p> <p>\u5f53bootfs\u52a0\u8f7d\u5b8c\u6210\u4e4b\u540e\u6574\u4e2a\u5185\u6838\u5c31\u90fd\u5728\u5185\u5b58\u4e2d\uff0c\u6b64\u65f6\u5185\u5b58\u7684\u4f7f\u7528\u6743\u5df2\u7531 bootfs\u8f6c\u4ea4\u7ed9\u5185\u6838\uff0c\u6b64\u65f6\u7cfb\u7edf\u4e5f\u4f1a\u5378\u8f7dbootfs\u3002</p>"},{"location":"linux/fs.html#rootfs","title":"Rootfs","text":"<p>\u6839\u6587\u4ef6\u7cfb\u7edf\u662f\u5185\u6838\u542f\u52a8\u65f6\u6240mount\u7684\u7b2c\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\uff0c\u5185\u6838\u4ee3\u7801\u6620\u50cf\u6587\u4ef6\u4fdd\u5b58\u5728\u6839\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u800c\u7cfb\u7edf\u5f15\u5bfc\u542f\u52a8\u7a0b\u5e8f\u4f1a\u5728\u6839\u6587\u4ef6\u7cfb\u7edf\u6302\u8f7d\u4e4b\u540e\u4ece\u4e2d\u628a\u4e00\u4e9b\u57fa\u672c\u7684\u521d\u59cb\u5316\u811a\u672c\u548c\u670d\u52a1\u7b49\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u53bb\u8fd0\u884c\u3002</p> <p>\u5305\u542b\u7684\u5c31\u662f\u5178\u578b Linux\u7cfb\u7edf\u4e2d\u7684/dev\u3001/proc\u3001/bin\u3001/etc\u7b49\u6807\u51c6\u76ee\u5f55\u548c\u6587\u4ef6\uff0crootfs\u5c31\u662f\u5404\u79cd\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u53d1\u884c\u7248\uff0c\u6bd4\u5982\uff1aUbuntu,\u3001CentOS\u3002</p>"},{"location":"linux/fs.html#ramdisk","title":"RamDisk","text":"<p>\u865a\u62df\u5185\u5b58\u76d8\u662f\u901a\u8fc7\u8f6f\u4ef6\u5c06\u4e00\u90e8\u5206\u5185\u5b58\uff08RAM\uff09\u6a21\u62df\u4e3a\u786c\u76d8\u6765\u4f7f\u7528\u7684\u4e00\u79cd\u6280\u672f\uff0cAlluxio\u8f6f\u4ef6\u5c31\u662f\u5c06 RAMDisk \u4f5c\u4e3a\u5176\u5b58\u50a8\u4ecb\u8d28\u3002</p> <p>\u5206\u4e3a<code>Ramdisk</code>, <code>ramfs</code>, <code>tmpfs</code>\uff1a</p> <ul> <li> <p>Ramdisk \u662f\u4f20\u7edf\u610f\u4e49\u4e0a\u78c1\u76d8\uff0c\u53ef\u4ee5\u683c\u5f0f\u5316\uff0c\u7136\u540e\u52a0\u8f7d\uff1b</p> </li> <li> <p>Linux 2.0/2.2\u652f\u6301\uff0c\u5927\u5c0f\u56fa\u5b9a\uff0c\u4e0d\u80fd\u6539\u53d8\uff1b</p> </li> <li> <p>\u5185\u6838\u7f16\u8bd1\u65f6\u5c06Block device\u4e2dRamdisk\u652f\u6301\u9009\u4e0a\uff0c</p> </li> <li> <p><code>ramfs</code> \u548c <code>tmpfs</code> \u662fLinux\u5185\u68382.4\u652f\u6301\uff0c\u5927\u5c0f\u53ef\u4ee5\u81ea\u52a8\u589e\u52a0\u6216\u51cf\u5c11\uff1b</p> </li> <li> <p><code>ramfs</code> \u5185\u5b58\u6587\u4ef6\u7cfb\u7edf\uff0c\u5b83\u5904\u4e8e\u865a\u62df\u6587\u4ef6\u7cfb\u7edf(VFS)\u5c42\uff0c\u65e0\u9700\u683c\u5f0f\u5316\uff0c\u9ed8\u8ba4\u4e00\u534a\u5185\u5b58\u5927\u5c0f</p> </li> <li>\u53ef\u4ee5\u5728 mount \u65f6\u9650\u5b9a\u5927\u5c0f\uff0c\u4e0d\u4f1a\u81ea\u52a8\u589e\u957f</li> <li>ramfs\u4e0d\u4f1a\u7528swap\uff0ctmpfs\u4f1a\u4f7f\u7528swap</li> </ul>"},{"location":"linux/fs.html#linux","title":"Linux\u4e0b\u7684\u6302\u8f7d","text":"<pre><code>mkdir -p /media/nameme\n\nmount -t tmpfs -o size=2048M tmpfs /mnt/ramdisk\n\nmount -t ramfs -o size=2048M ramfs /mnt/ramdisk\n</code></pre>"},{"location":"linux/fs.html#_2","title":"\u6027\u80fd\u6d4b\u8bd5","text":"<pre><code># \u6d4b\u8bd5\u78c1\u76d8\u7684\u5199\u901f\u7387\n$ time dd if=/dev/zero bs=4096 count=2000000 of=./8Gb.file\n2000000+0 records in\n2000000+0 records out\n8192000000 bytes (8.2 GB) copied, 6.37105 s, 1.3 GB/s\n\nreal    0m6.374s\nuser    0m0.909s\nsys     0m5.450s\n\n# \u6d4b\u8bd5\u78c1\u76d8\u8bfb\n$ time dd if=/dev/mapper/VolGroup00-LogVol00 of=/dev/null bs=8k\n 2498560+0 records in\n 2498560+0 records out\n 247.99s real 1.92s user 48.64s system\n</code></pre>"},{"location":"linux/fs.html#proc","title":"Proc\u6587\u4ef6\u7cfb\u7edf","text":"<p>https://man7.org/linux/man-pages/man5/proc.5.html</p> <p>\u865a\u62df\u5185\u5b58\uff1a\u662f\u8fdb\u7a0b\u8fd0\u884c\u65f6\u5168\u90e8\u5185\u5b58\u7a7a\u95f4\u7684\u603b\u548c\uff0cJava\u7684-Xmx\u5206\u914d\u7684\u662f\u865a\u62df\u5185\u5b58\u7684\u7a7a\u95f4\uff1b</p>"},{"location":"linux/fs.html#procself","title":"/proc/self","text":"<p>\u5f53\u524d\u8fdb\u7a0b\u7684\u4fe1\u606f\uff0c\u4e0d\u540c\u7ebf\u7a0b\u8bbf\u95ee\u65f6\u83b7\u53d6\u7684\u5176\u7ebf\u7a0b\u7684\u4fe1\u606f\u3002</p>"},{"location":"linux/fs.html#procpidio","title":"/proc/[pid]/io","text":"<p>rchar\uff1a\u4ece\u5b58\u50a8\u5668\u8bfb\u53d6\u7684\u5b57\u8282\u6570\uff0c\u662fread(2)\u7c7b\u4f3c\u7cfb\u7edf\u8c03\u7528\u7684\u5b57\u8282\u6570\u4e4b\u548c\uff0c\u8ddf\u5b9e\u9645\u7269\u7406\u78c1\u76d8\u8bfb\u53d6\u65e0\u5173\uff1b</p> <p>wchar\uff1a\u5199\u5165\u78c1\u76d8\u7684\u5b57\u8282\u6570\uff0c\u7c7b\u4f3crchar\uff1b</p> <p>syscr\uff1a\u8bfb\u7684\u7cfb\u7edf\u8c03\u7528</p> <p>syscw\uff1a\u5199\u7684\u7cfb\u7edf\u8c03\u7528</p> <p>read_bytes\uff1a\u8fdb\u7a0b\u5b9e\u9645\u8bfb\u53d6\u4ece\u5b58\u50a8\u5668\u4e2d\u7684\u5b57\u8282\u6570</p> <p>write_bytes\uff1a\u8fdb\u7a0b\u5b9e\u9645\u5199\u5165\u4ece\u5b58\u50a8\u5668\u4e2d\u7684\u5b57\u8282\u6570</p>"},{"location":"linux/fs.html#procsat","title":"/proc/sat","text":"<pre><code># cpu   user     nice   system   idle     iowait irq softirq steal guest   guest_nice \n cpu    10132153 290696 3084719 46828483  16683   0   25195   0     175628   0\n cpu0   1393280  32966  572056  13343292  6130    0   17875   0     23933    0\n</code></pre> <p>\u65f6\u95f4\u7684\u5355\u4f4d\u662f<code>USER_HZ</code>\uff0c</p> <p>user\uff1a\u7528\u6237\u6a21\u5f0f\u4e0b\u82b1\u8d39\u7684\u65f6\u95f4\uff1b</p> <p>nice\uff1a\u7528\u6237\u6a21\u5f0f\u4e0b\u4ee5\u4f4e\u4f18\u5148\u7ea7\u82b1\u8d39\u7684\u65f6\u95f4\uff1b</p> <p>system\uff1a\u7cfb\u7edf\u6a21\u5f0f\u4e0b\u82b1\u8d39\u7684\u65f6\u95f4\uff1b</p> <p>idle\uff1a\u7a7a\u95f2\u7684\u65f6\u95f4</p> <p>iowait\uff1a\u7b49\u5f85I/O\u7684\u65f6\u95f4\uff0c\u7531\u4e8e\u4ee5\u4e0b\u539f\u56e0\uff0c\u4e0d\u662f\u5f88\u53ef\u9760</p> <ul> <li>\u4efb\u52a1\u7b49\u5f85I/O\uff0c\u800c\u4e0d\u662fCPU\u7b49\u5f85\uff0cCPU\u7a7a\u95f2\u65f6\u4f1a\u6709\u5176\u4ed6\u4efb\u52a1\u88ab\u8c03\u5ea6\u5728\u8fd9\u4e2aCPU\u4e0a\uff1b</li> <li>\u5728\u591a\u6838CPU\u4e0a\uff0c\u7b49\u5f85I/O\u7684\u4efb\u52a1\u672a\u5728\u4efb\u4f55CPU\u4e0a\u8fd0\u884c\uff0c\u56e0\u6b64\u6bcf\u4e2aCPU\u7684iowait\u662f\u5f88\u96be\u8ba1\u7b97\u7684\uff1b</li> <li>\u8be5\u5b57\u6bb5\u7684\u503c\u53ef\u80fd\u4f1a\u964d\u4f4e</li> </ul>"},{"location":"linux/fs.html#procpidstat","title":"/proc/[pid]/stat","text":"<p>\u8fdb\u7a0b\u7684\u72b6\u6001\u4fe1\u606f</p>"},{"location":"linux/fs.html#procpidstatus","title":"/proc/[pid]/status","text":"<p><code>/proc/[pid]/stat</code> \u548c<code>/proc/[pid]/statm</code>\u7684\u5927\u90e8\u5206\u4fe1\u606f\uff0c\u53ef\u9605\u8bfb\u6027\u597d\u3002</p> <p>VmPeak\uff1a\u865a\u62df\u5185\u5b58\u7684\u5cf0\u503c\uff1b</p> <p>VmSize\uff1a\u865a\u62df\u5185\u5b58\u5927\u5c0f\uff1b</p> <p>VmRss\uff1a\u5e94\u7528\u7a0b\u5e8f\u6b63\u5728\u4f7f\u7528\u7684\u7269\u7406\u5185\u5b58\u7684\u5927\u5c0f\uff0c\u4e0d\u7cbe\u786e\uff0cps\u547d\u4ee4\u7684\u53c2\u6570rss\u7684\u503c (rss)\uff1b</p> <p>VmHWM\uff1a\u5e94\u7528\u7a0b\u5e8f\u6b63\u5728\u4f7f\u7528\u7684\u7269\u7406\u5185\u5b58\u7684\u5cf0\u503c\uff0c\u4e0d\u7cbe\u786e\uff1b</p> <p>VmLck\uff1a\u9501\u5b9a\u7684\u7269\u7406\u5185\u5b58\u5927\u5c0f\uff0c\u9501\u4f4f\u7684\u7269\u7406\u5185\u5b58\u4e0d\u80fd\u4ea4\u6362\u5230\u786c\u76d8 (locked_vm)\uff1b</p> <p>VmPin\uff1aPinned\u7684\u7269\u7406\u5185\u5b58\u5927\u5c0f\uff0c\u4e0d\u80fd\u79fb\u52a8\uff1b</p> <p>VmData\uff1a\u7a0b\u5e8f\u6570\u636e\u6bb5\u7684\u5927\u5c0f\uff08\u6240\u5360\u865a\u62df\u5185\u5b58\u7684\u5927\u5c0f\uff09</p>"},{"location":"linux/limit_process.html","title":"\u8fdb\u7a0b\u7684\u9650\u5236","text":"<p>kernel.pid_max \uff1a\u7cfb\u7edf\u7684\u6700\u5927\u8fdb\u7a0b\u6570 <pre><code># \u67e5\u770bkernel.pid_max\nsysctl kernel.pid_max\n# \u4fee\u6539kernel.pid_max\nsysctl -w kernel.pid_max=&lt;new_value&gt;\n</code></pre></p> <p>kernel.threads-max \uff1a\u7cfb\u7edf\u7684\u6700\u5927\u7ebf\u7a0b\u6570</p> <pre><code># \u67e5\u770bkernel.threads-max\nsysctl kernel.threads-max\n# \u4fee\u6539kernel.threads-max\nsysctl -w kernel.threads-max=&lt;new_value&gt;\n</code></pre> <p>ulimit -u : \u7528\u6237\u7684\u6700\u5927\u8fdb\u7a0b\u6570\uff08\u548c\u7ebf\u7a0b\u6570\u6709\u5173\u7cfb\u4e48\uff1f\uff09</p> <pre><code># root\u9ed8\u8ba4\u662f\u5373\u7cfb\u7edf\u7ebf\u7a0b\u6570\uff08kernel.threads-max\uff09\u7684\u4e00\u534a\n# \u666e\u901a\u8d26\u53f7\u9ed8\u8ba4\u662f/etc/security/limits.d/20-nproc.conf\u6587\u4ef6\u4e2d\u914d\u7f6e\n</code></pre> <p>ulimit -n : \u7528\u6237\u6253\u5f00\u7684\u6700\u5927\u6587\u4ef6\u9650\u5236</p> <p>\u4fee\u6539/etc/security/limits.conf\u6587\u4ef6\uff0croot\u7528\u6237</p> <pre><code>* soft nofile 1048576\n* hard nofile 1048576\n</code></pre> <p>vm.max_map_count\uff1a\u9650\u5236\u4e00\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u62e5\u6709\u7684VMA(\u865a\u62df\u5185\u5b58\u533a\u57df)\u7684\u6570\u91cf\u3002\u865a\u62df\u5185\u5b58\u533a\u57df\u662f\u4e00\u4e2a\u8fde\u7eed\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u533a\u57df\u3002\u5728\u8fdb\u7a0b\u7684\u751f\u547d\u5468\u671f\u4e2d\uff0c\u6bcf\u5f53\u7a0b\u5e8f\u5c1d\u8bd5\u5728\u5185\u5b58\u4e2d\u6620\u5c04\u6587\u4ef6\uff0c\u94fe\u63a5\u5230\u5171\u4eab\u5185\u5b58\u6bb5\uff0c\u6216\u8005\u5206\u914d\u5806\u7a7a\u95f4\u7684\u65f6\u5019\uff0c\u8fd9\u4e9b\u533a\u57df\u5c06\u88ab\u521b\u5efa\u3002\u8c03\u4f18\u8fd9\u4e2a\u503c\u5c06\u9650\u5236\u8fdb\u7a0b\u53ef\u62e5\u6709VMA\u7684\u6570\u91cf\u3002\u9650\u5236\u4e00\u4e2a\u8fdb\u7a0b\u62e5\u6709VMA\u7684\u603b\u6570\u53ef\u80fd\u5bfc\u81f4\u5e94\u7528\u7a0b\u5e8f\u51fa\u9519\uff0c\u56e0\u4e3a\u5f53\u8fdb\u7a0b\u8fbe\u5230\u4e86VMA\u4e0a\u7ebf\u4f46\u53c8\u53ea\u80fd\u91ca\u653e\u5c11\u91cf\u7684\u5185\u5b58\u7ed9\u5176\u4ed6\u7684\u5185\u6838\u8fdb\u7a0b\u4f7f\u7528\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u629b\u51fa\u5185\u5b58\u4e0d\u8db3\u7684\u9519\u8bef\u3002\u5982\u679c\u4f60\u7684\u64cd\u4f5c\u7cfb\u7edf\u5728NORMAL\u533a\u57df\u4ec5\u5360\u7528\u5c11\u91cf\u7684\u5185\u5b58\uff0c\u90a3\u4e48\u8c03\u4f4e\u8fd9\u4e2a\u503c\u53ef\u4ee5\u5e2e\u52a9\u91ca\u653e\u5185\u5b58\u7ed9\u5185\u6838\u7528\u3002</p> <p>\u5728\u5176\u4ed6\u8d44\u6e90\u53ef\u7528\u7684\u524d\u63d0\u4e0b\uff0c\u5355\u4e2aJVM\u80fd\u5f00\u542f\u7684\u6700\u5927\u7ebf\u7a0b\u6570\u662f/proc/sys/vm/max_map_count\u7684\u8bbe\u7f6e\u6570\u7684\u4e00\u534a\u3002</p> <pre><code>sysctl -w vm.max_map_count=262144\n</code></pre>"},{"location":"linux/log_and_rotate.html","title":"Linux\u7cfb\u7edf\u4e2d\u7684\u65e5\u5fd7\u7ba1\u7406","text":"<p><code>/run</code>\uff1a\u662f\u4e00\u4e2a\u4e34\u65f6\u6587\u4ef6\u7cfb\u7edf\uff08tmpfs\uff09\uff0c\u5b58\u50a8\u7cfb\u7edf\u542f\u52a8\u4ee5\u6765\u7684\u4fe1\u606f\u3002\u5f53\u7cfb\u7edf\u91cd\u542f\u65f6\uff0c\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u5e94\u8be5\u88ab\u5220\u6389\u6216\u6e05\u9664\u3002</p>"},{"location":"linux/log_and_rotate.html#journald","title":"Journald","text":"<p>\u6536\u96c6\u6765\u81ea\u5185\u6838\u3001\u7cfb\u7edf\u65e9\u671f\u542f\u52a8\u9636\u6bb5\u7684\u65e5\u5fd7\u3001\u7cfb\u7edf\u5b88\u62a4\u8fdb\u7a0b\u5728\u542f\u52a8\u548c\u8fd0\u884c\u4e2d\u7684\u6807\u51c6\u8f93\u51fa\u548c\u9519\u8bef\u4fe1\u606f\uff0c\u8fd8\u6709 syslog \u7684\u65e5\u5fd7\u3002</p> <p>journald\u65e5\u5fd7\u5199\u5165\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</p> <p>\u5b58\u50a8\u4f4d\u7f6e\uff1a</p> <ul> <li><code>volatile</code>\u8868\u793a\u4ec5\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d\uff0c \u4e5f\u5c31\u662f\u4ec5\u4fdd\u5b58\u5728 <code>/run/log/journal</code> \u76ee\u5f55\u4e2d(\u5c06\u4f1a\u88ab\u81ea\u52a8\u6309\u9700\u521b\u5efa)\uff1b</li> <li><code>persistent</code>\u8868\u793a\u4f18\u5148\u4fdd\u5b58\u5728\u78c1\u76d8\u4e0a\uff0c \u4e5f\u5c31\u4f18\u5148\u4fdd\u5b58\u5728 <code>/var/log/journal</code> \u76ee\u5f55\u4e2d(\u5c06\u4f1a\u88ab\u81ea\u52a8\u6309\u9700\u521b\u5efa)\uff1b</li> <li>\"<code>auto</code>\"(\u9ed8\u8ba4\u503c) \u4e0e \"<code>persistent</code>\" \u7c7b\u4f3c\uff0c \u4f46\u4e0d\u81ea\u52a8\u521b\u5efa <code>/var/log/journal</code> \u76ee\u5f55\uff0c \u56e0\u6b64\u53ef\u4ee5\u6839\u636e\u8be5\u76ee\u5f55\u7684\u5b58\u5728\u4e0e\u5426\u51b3\u5b9a\u65e5\u5fd7\u7684\u4fdd\u5b58\u4f4d\u7f6e\u3002</li> </ul> <p>\u4f1a\u6839\u636e\u6587\u4ef6\u5927\u5c0f\uff0c\u8bbe\u7f6e\u6eda\u52a8\u7b56\u7565\uff0c\u4ee5\u53ca\u603b\u7684\u6587\u4ef6\u5927\u5c0f\uff0c\u8fdb\u884c\u6e05\u9664\u7b56\u7565\u3002</p>"},{"location":"linux/log_and_rotate.html#rsyslog","title":"rsyslog","text":"<p>rsyslog\u4f5c\u4e3a\u4f20\u7edf\u7684\u7cfb\u7edf\u65e5\u5fd7\u670d\u52a1\uff0c\u628a\u6240\u6709\u6536\u96c6\u5230\u7684\u65e5\u5fd7\u90fd\u8bb0\u5f55\u5230<code>/var/log/</code>\u76ee\u5f55\u4e0b\u7684\u5404\u4e2a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u3002</p>"},{"location":"linux/log_and_rotate.html#logrorate","title":"logrorate","text":"<p>Linux\u5199\u6587\u4ef6\u662f\u6839\u636einode\u7f16\u53f7\uff0c\u91cd\u547d\u540d\u6587\u4ef6\u4e0d\u5f71\u54cd\u6587\u4ef6\u7684\u8bfb\u5199\uff1b</p> <ul> <li>\u9ed8\u8ba4\uff0c\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u65e5\u5fd7\u6587\u4ef6\u7ed9\u7a0b\u5e8f\u8f93\u51fa\u65e5\u5fd7\uff0c\u901a\u8fc7\u67d0\u79cd\u673a\u5236\u901a\u77e5\u7a0b\u5e8f\uff0c\u5982 nginx \u652f\u6301 kill -USR1\uff0c\u9700\u8981\u7a0b\u5e8f\u652f\u6301\uff1b</li> <li>\u914d\u5408cron\u4f7f\u7528\uff0c\u5982\u679c logrotate \u914d\u7f6e\u4e86daily\uff0c\u5219\u4e00\u5929\u5185\u5373\u4f7fcron\u91cd\u590d\u8c03\u7528\uff0c\u4e5f\u4e0d\u4f1a\u8f93\u51fa\u4e24\u4efd\u5907\u4efd\uff1b</li> </ul> <p>\u65e5\u5fd7\u6587\u4ef6\u7ba1\u7406\u5de5\u5177\uff0c\u5220\u9664\u65e7\u65e5\u5fd7\u5e76\u521b\u5efa\u65b0\u7684\u65e5\u5fd7\uff0c\u4ee5\u53ca\u538b\u7f29\u65e5\u5fd7\u548c\u53d1\u9001\u65e5\u5fd7\u5230email\uff1b</p> <pre><code>$ logrorate -s &lt;statefile&gt; &lt;conffile&gt;\n</code></pre> <ul> <li>\u4f7f\u7528 <code>logrotate -d /etc/logrotate.d/myapp</code> \u547d\u4ee4\u6765\u6d4b\u8bd5\u4f60\u7684\u914d\u7f6e\u6587\u4ef6\u662f\u5426\u6709\u6548\uff0c\u800c\u4e0d\u5b9e\u9645\u6267\u884c\u8f6e\u8f6c\u64cd\u4f5c</li> </ul> <pre><code># \u5728`/etc/logrotate.d/`\u76ee\u5f55\u4e2d\u65b0\u589e\u5355\u72ec\u7684\u914d\u7f6e\u6587\u4ef6\uff08.d\u4e0d\u662f\u9ed8\u8ba4 daily \u7684\u610f\u601d\uff09\uff0c\u4f1a\u81ea\u52a8\u6267\u884c\n# /etc/logrotate.d/myapp\n\n/var/log/myapp/myapp.log {  # \u8def\u5f84\u652f\u6301\u6b63\u5219\u5339\u914d\n    daily               # \u6bcf\u5929\u8f6e\u8f6c\u4e00\u6b21  \n    rotate 7            # \u4fdd\u7559\u6700\u8fd1 7 \u4e2a\u8f6e\u8f6c\u540e\u7684\u5907\u4efd\u6587\u4ef6  \n    compress            # \u5bf9\u8f6e\u8f6c\u540e\u7684\u5907\u4efd\u6587\u4ef6\u8fdb\u884c\u538b\u7f29  \n    delaycompress       # \u5ef6\u8fdf\u538b\u7f29\uff0c\u76f4\u5230\u4e0b\u4e00\u6b21\u8f6e\u8f6c\u65f6\u518d\u8fdb\u884c\u538b\u7f29  \n    missingok           # \u5982\u679c\u65e5\u5fd7\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5219\u5ffd\u7565\u9519\u8bef\u7ee7\u7eed  \n    notifempty          # \u5982\u679c\u65e5\u5fd7\u6587\u4ef6\u4e3a\u7a7a\uff0c\u5219\u4e0d\u8f6e\u8f6c  \n    create 640 root adm # \u521b\u5efa\u65b0\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u6743\u9650\u4e3a 640\uff0c\u6240\u6709\u8005\u4e3a root\uff0c\u7ec4\u4e3a adm  \n    sharedscripts       # \u5982\u679c\u591a\u4e2a\u65e5\u5fd7\u6587\u4ef6\u5339\u914d\u6b64\u89c4\u5219\uff0c\u5219\u53ea\u8fd0\u884c\u4e00\u6b21 postrotate/endscript \u811a\u672c  \n\n    # \u5728\u8f6e\u8f6c\u540e\u6267\u884c\u7684\u547d\u4ee4  \n    postrotate  \n        /usr/bin/systemctl reload myapp  # \u5047\u8bbe myapp \u662f\u4e00\u4e2a systemd \u670d\u52a1\uff0c\u91cd\u65b0\u52a0\u8f7d\u5b83\u4ee5\u5e94\u7528\u65b0\u7684\u65e5\u5fd7\u6587\u4ef6  \n    endscript  \n}\n</code></pre> <p>\u53c2\u6570\u8bf4\u660e\uff1a</p> <ul> <li> <p>compress | nocompress\uff1agzip\u538b\u7f29\u8f6c\u50a8\u540e\u7684\u65e5\u5fd7\uff1b</p> </li> <li> <p>copytruncate      | nocopytruncate \uff1a \u6253\u5f00\u4e2d\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u5f53\u524d\u65e5\u5fd7\u5907\u4efd\u5e76\u622a\u65ad\uff08\u4e22\u5931\u65e5\u5fd7\u7684\u98ce\u9669\uff09\uff1b</p> </li> <li> <p>ifempty | notifemply\uff1a\u7a7a\u6587\u4ef6\u4e5f\u8f6c\u50a8\uff08\u9ed8\u8ba4\uff09\uff1b</p> </li> <li> <p>rotate N \uff1a\u65e5\u5fd7\u6587\u4ef6\u5220\u9664\u524d\u7684\u8f6c\u50a8\u6b21\u6570\uff0c0\u6307\u6ca1\u6709\u5907\u4efd\uff0c5\u6307\u4fdd\u75595\u4e2a\u5907\u4efd\uff1b</p> </li> <li> <p>create mode owner group\uff1a\u8f6c\u50a8\u6587\u4ef6\uff0c\u4f7f\u7528\u6307\u5b9a\u7684\u6587\u4ef6\u6a21\u5f0f\u521b\u5efa\u65b0\u7684\u65e5\u5fd7\u6587\u4ef6\uff1b</p> </li> <li> <p>prerotate/endscript\uff1a\u8f6c\u50a8\u524d\u9700\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u5173\u952e\u5b57\u5355\u72ec\u6210\u884c\uff1b</p> </li> <li> <p>postrotate/endscript\uff1a\u8f6c\u50a8\u540e\u9700\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u5173\u952e\u5b57\u5355\u72ec\u6210\u884c\uff1b</p> </li> <li> <p>missingok |nomissingok\uff1a\u65e5\u5fd7\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u7ee7\u7eed\u4e0b\u4e00\u4e2a\u800c\u4e0d\u62a5\u9519\uff1b</p> </li> <li> <p>daily | weekly |monthly\uff1a\u8f6c\u50a8\u5468\u671f\uff1b</p> </li> <li> <p>size=19\uff1a\u65e5\u5fd7\u6587\u4ef6\u5230\u6307\u5b9a\u5927\u5c0f\u518d\u8f6c\u50a8\uff0c\u9ed8\u8ba4bytes\uff0c\u53ef\u9009K\u548cM\uff1b</p> </li> </ul>"},{"location":"linux/namespace.html","title":"Namespace","text":"<p>\u76f8\u5173\u7684\u793a\u4f8b\u4ee3\u7801</p> <p>\u8fdb\u7a0b\u95f4\u9694\u79bb\uff0clinux\u5185\u6838\u63d0\u4f9b<code>PID\u3001Mount\u3001UTS\u3001IPC\u3001Network\u3001User</code> Namespace\u3002</p>"},{"location":"linux/namespace.html#uts-namespace","title":"UTS NameSpace\uff08\u4e3b\u673a\u57df\u540d\uff09","text":"<p>\u793a\u4f8b\uff1a<code>ns_uts.c</code></p> <p>\u4e3b\u673a/\u57df\u540d\uff08uts\uff09\uff1aUNIX Time-sharing System\uff0c\u5728\u7f51\u7edc\u4e0a\u89c6\u4f5c\u72ec\u7acb\u8282\u70b9\uff1b</p>"},{"location":"linux/namespace.html#ipc-namespace","title":"IPC NameSpace\uff08\u8fdb\u7a0b\u901a\u4fe1\uff09","text":"<p>\u793a\u4f8b\uff1a<code>ns_ipc.c</code></p> <p>\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff08ipc\uff09\uff1aInter-Process Communication\uff0c\u5305\u62ec\u4fe1\u53f7\u3001\u6d88\u606f\u961f\u5217\u548c\u5171\u4eab\u5185\u5b58\u3002</p> <ul> <li><code>ipcs/ipcmk/ipcrm</code> \u67e5\u770b/\u521b\u5efa/\u5220\u9664 \u4fe1\u53f7\u91cf\u3001\u6d88\u606f\u961f\u5217\u3001\u5171\u4eab\u5185\u5b58\uff1b</li> </ul>"},{"location":"linux/namespace.html#user-namespace","title":"User NameSpace\uff08\u7528\u6237/\u7ec4\uff09","text":"<p>\u793a\u4f8b\uff1a<code>ns_user.c</code></p> <p>Linux 3.8 \u65b0\u589e\u7684\u4e00\u79cd namespace\uff0c\u7528\u4e8e\u9694\u79bb\u5b89\u5168\u76f8\u5173\u7684\u8d44\u6e90\uff0c\u5305\u62ec user IDs and group IDs\uff0ckeys, \u548c capabilities\u3002\u540c\u6837\u4e00\u4e2a\u7528\u6237\u7684 user ID \u548c group ID \u5728\u4e0d\u540c\u7684 user namespace \u4e2d\u53ef\u4ee5\u4e0d\u4e00\u6837(\u4e0e PID nanespace \u7c7b\u4f3c)\u3002</p> <p>\u6362\u53e5\u8bdd\u8bf4\uff0c\u4e00\u4e2a\u7528\u6237\u53ef\u4ee5\u5728\u4e00\u4e2a user namespace \u4e2d\u662f\u666e\u901a\u7528\u6237\uff0c\u4f46\u5728\u53e6\u4e00\u4e2a user namespace \u4e2d\u662f\u8d85\u7ea7\u7528\u6237\u3002</p> <p>\u9694\u79bb\u5b89\u5168\u76f8\u5173\u7684\u6807\u8bc6\u7b26\uff08identifiers\uff09\u548c\u5c5e\u6027\uff08attributes\uff09\uff0c\u5305\u62ec\u7528\u6237ID\u3001\u7528\u6237\u7ec4ID\u3001root\u76ee\u5f55\u3001key\uff08\u5bc6\u94a5\uff09\u4ee5\u53ca\u7279\u6b8a\u6743\u9650\u3002</p> <ul> <li> <p>user namespace\u521b\u5efa\u540e\uff0c\u7b2c\u4e00\u4e2a\u8fdb\u7a0b\u88ab\u8d4b\u4e88\u8be5namespace\u4e0b\u7684\u6240\u6709\u6743\u9650\uff1b</p> </li> <li> <p>\u9ed8\u8ba4\u7528\u6237\u663e\u793a65534\uff0c\u8868\u793a\u5c1a\u672a\u4e0e\u5916\u90e8namespace\u7528\u6237\u6620\u5c04\uff1b</p> </li> <li> <p>\u901a\u8fc7<code>uid_map</code>\u548c<code>gid_map</code>\u5c06\u5b50\u8fdb\u7a0b\u7684<code>root(0)</code>\u548c\u5916\u90e8\u8fdb\u7a0b\u7684<code>1000</code>\u7528\u6237\u7ed1\u5b9a\uff1b</p> </li> <li> <p>\u5bb9\u5668\u5185\u7684root\u7528\u6237\u521b\u5efa\u7684\u6587\u4ef6\uff0c\u5728\u5916\u90e8\u770b\u6765\u5176\u7528\u6237\u662f1000\uff1b</p> </li> <li>\u5199<code>gid_map</code>\u524d\uff0c\u9700\u8981\u5148<code>echo deny &gt; /proc/2506/setgroups</code></li> </ul> <p>There is a specific limitation added to unprivileged users since Linux 3.19 when attempting to map the user's group(s): they have to forfeit their right to alter supplementary groups. This is usually to prevent an user to remove itself from a group which acts as a deny filter for files with ownership like <code>someuser:denygroup</code> and mode <code>u=rw,g=,o=r</code>.</p> <p>This is documented in <code>user_namespaces(7)</code>:</p> <p>Writing \"deny\" to the <code>/proc/[pid]/setgroups</code> file before writing to <code>/proc/[pid]/gid_map</code> will permanently disable <code>setgroups(2)</code> in a user namespace and allow writing to <code>/proc/[pid]/gid_map</code> without having the CAP_SETGID capability in the parent user namespace.</p>"},{"location":"linux/namespace.html#net-namespace","title":"Net NameSpace\uff08\u7f51\u7edc\uff09","text":"<p><code>network namespace</code> \u7684\u589e\u5220\u6539\u67e5\u529f\u80fd\u5df2\u7ecf\u96c6\u6210\u5230 Linux \u7684 ip \u5de5\u5177\u7684 <code>netns</code> \u5b50\u547d\u4ee4\u3002</p> <p>\u7f51\u7edc\u8d44\u6e90\u7684\u9694\u79bb\uff1a\u7f51\u7edc\u8bbe\u5907\uff0cIPV4/IPV6\uff0cIP\u8def\u7531\u8868\uff0c\u9632\u706b\u5899\uff0c/proc/net\u76ee\u5f55\uff0c/sys/class/net\u76ee\u5f55\uff0c\u5957\u63a5\u5b57\u7b49\uff1b</p> <p>\u4e00\u4e2a\u7269\u7406\u7684\u7f51\u7edc\u8bbe\u5907\u6700\u591a\u5b58\u5728\u4e00\u4e2anetwork namespace\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u521b\u5efa<code>veth pair</code>\uff08\u865a\u62df\u7f51\u7edc\u8bbe\u5907\u5bf9\uff0c\u7c7b\u4f3c\u7ba1\u9053\uff0c\u53cc\u5411\u6570\u636e\u4f20\u8f93\uff09\u5728\u4e0d\u540c\u7684network namespace\u95f4\u521b\u5efa\u901a\u9053\uff0c\u8fbe\u5230\u901a\u4fe1\u76ee\u7684\u3002</p> <ul> <li>\u5728\u5efa\u7acb<code>veth pair</code>\u524d\uff0c\u65b0\u65e7namespace\u901a\u8fc7\u7ba1\u9053\u8fdb\u884c\u901a\u4fe1\u3002</li> </ul> <p>Linux \u4e3a\u4e0d\u540c\u7a7a\u95f4\u521b\u5efa\u4e0d\u540c\u7684 struct net \u5bf9\u8c61\uff1a</p> <ul> <li> <p>\u6bcf\u4e2a struct net \u4e2d\u90fd\u6709\u72ec\u7acb\u7684\u8def\u7531\u8868\u3001iptable \u7b49\u6570\u636e\u7ed3\u6784\uff1b</p> </li> <li> <p>\u6bcf\u4e2a\u8bbe\u5907\u3001\u6bcf\u4e2a socket \u4e0a\u4e5f\u90fd\u6709\u6307\u9488\u6307\u660e\u81ea\u5df1\u5f52\u5c5e\u90a3\u4e2a netns</p> </li> </ul> <p>\u901a\u8fc7\u8fd9\u79cd\u65b9\u6cd5\u4ece\u903b\u8f91\u4e0a\u770b\u8d77\u6765\u597d\u50cf\u662f\u771f\u7684\u6709\u591a\u4e2a\u534f\u8bae\u6808\u4e00\u6837\u3002</p> <p></p>"},{"location":"linux/namespace.html#pid-namespacepid","title":"PID NameSpace\uff08PID\uff09","text":"<p>\u793a\u4f8b\uff1a<code>ns_pid.c</code></p> <p>\u4e0d\u540cNS\u4e0b\u7684\u8fdb\u7a0b\u53ef\u4ee5\u6709\u76f8\u540c\u7684PID\uff0c\u5185\u6838\u4e3a\u6240\u6709PID NS\u7ef4\u62a4\u6811\u5f62\u7ed3\u6784\uff1b</p> <ul> <li> <p>\u7236\u8282\u70b9\u53ef\u4ee5\u770b\u5230\u5b50\u8282\u70b9\u4e2d\u7684\u8fdb\u7a0b\uff0c\u901a\u8fc7\u4fe1\u53f7\u7b49\u5f62\u5f0f\u5f71\u54cd\u5b50\u8282\u70b9\u7684\u8fdb\u7a0b\uff0c\u800c\u53cd\u4e4b\u4e0d\u884c\uff1b</p> </li> <li> <p>PID\u9694\u79bb\uff0c\u9700\u8981\u914d\u5408MOUNT\u9694\u79bb\uff0c\u5c06<code>/proc</code>\u6587\u4ef6\u7cfb\u7edf\u91cd\u65b0\u6302\u8f7d\uff1b</p> </li> </ul>"},{"location":"linux/namespace.html#init","title":"Init\u8fdb\u7a0b","text":"<ul> <li>\u8fdb\u7a0b\u53f7\u4e3a1\u7684\u8fdb\u7a0b\u9700\u8981\u8d1f\u8d23\u5b64\u513f\u8fdb\u7a0b\u7684\u56de\u6536\uff0c\u56e0\u6b64Docker\u5bb9\u5668\u8fd0\u884c\u591a\u4e2a\u8fdb\u7a0b\u65f6\uff0c\u6700\u5148\u542f\u52a8\u7684\u547d\u4ee4\u8fdb\u7a0b\u5e94\u8be5\u65f6\u5177\u6709\u8d44\u6e90\u76d1\u63a7\u548c\u56de\u6536\u7b49\u7ba1\u7406\u80fd\u529b\uff0c\u5982<code>bash</code>\uff1b</li> <li>Init\u8fdb\u7a0b\u5177\u5907\u4fe1\u53f7\u5c4f\u853d\uff0c\u5982\u679c\u672a\u7f16\u5199\u5904\u7406\u67d0\u4e2a\u4fe1\u53f7\u7684\u4ee3\u7801\u903b\u8f91\uff0c\u5219\u540c\u4e00\u4e2aPid namespace\u4e0b\u7684\u8fdb\u7a0b\uff08\u5373\u4f7f\u5177\u6709\u8d85\u7ea7\u6743\u9650\uff09\u53d1\u7ed9Init\u8fdb\u7a0b\u7684\u4fe1\u53f7\u4f1a\u88ab\u5c4f\u853d\uff0c\u9632\u6b62\u88ab\u8bef\u6740\uff1b</li> <li>Namespace\u6811\u4e2d\u7236\u8282\u70b9\u8fdb\u7a0b\u53d1\u9001\u7684\u4fe1\u53f7\uff0c\u53ea\u6709<code>SIGKILL</code>\u548c<code>SIGSTOP</code>\u4f1a\u88ab\u5904\u7406\uff0c\u7236\u8282\u70b9\u8fdb\u7a0b\u6709\u6743\u7ec8\u6b62\u5b50\u8282\u70b9\u8fdb\u7a0b\uff1b</li> <li>\u4e00\u65e6init\u8fdb\u7a0b\u88ab\u9500\u6bc1\uff0c\u540c\u4e00PID namespace\u4e2d\u7684\u5176\u5b83\u8fdb\u7a0b\u90fd\u4f1a\u53d7\u5230<code>SIGKILL</code>\u4fe1\u53f7\u800c\u88ab\u9500\u6bc1\u3002</li> </ul>"},{"location":"linux/namespace.html#_1","title":"\u9694\u79bb\u7279\u6b8a\u6027","text":"<ul> <li>\u4e00\u4e2a\u8fdb\u7a0b\u7684PID\u88ab\u8ba4\u4e3a\u662f\u5e38\u91cf\uff0c\u56e0\u6b64<code>setns</code>\u548c<code>unshare</code>\u8c03\u7528\u8005\u65e0\u6cd5\u52a0\u5165\u65b0\u7684PID NS\uff0c\u968f\u540e\u521b\u5efa\u7684\u5b50\u8fdb\u7a0b\u624d\u53ef\u4ee5\u52a0\u5165\u65b0\u7684NS\u3002</li> </ul>"},{"location":"linux/namespace.html#mount-namespace","title":"Mount NameSpace\uff08\u6302\u8f7d\uff09","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5bf9\u4e8eMount\u547d\u540d\u7a7a\u95f4\u91cc\u7684\u6302\u8f7d\u70b9\u5217\u8868\u7684\u540e\u7eed\u4fee\u6539\uff0c\u5c06\u4e0d\u4f1a\u5f71\u54cd\u5230\u53e6\u5916\u547d\u540d\u7a7a\u95f4\u91cc\u770b\u5230\u7684\u6302\u8f7d\u70b9\u5217\u8868(\u9664\u4e86\u4e0b\u9762\u63d0\u5230\u7684shared subtrees\u60c5\u51b5)\u3002</p>"},{"location":"linux/namespace.html#shared-subtreee","title":"Shared Subtreee","text":"<p>\u5f15\u5165\u8be5\u673a\u5236\u662f\u4e3a\u4e86\u6d88\u9664mount ns\u5e26\u6765\u7684\u4e0d\u4fbf\uff0c\u6bd4\u5982\u7cfb\u7edf\u65b0\u589e\u4e00\u5757\u78c1\u76d8\uff0c\u5e0c\u671b\u6240\u6709\u7684NS\u90fd\u611f\u77e5\u5230\u65b0\u6302\u8f7d\u7684\u8fd9\u5757\u78c1\u76d8\uff0c\u90a3\u4e48\u5982\u679cNS \u4e4b\u95f4\u662f\u5b8c\u5168\u9694\u79bb\u7684\uff0c\u5c31\u9700\u8981\u6bcf\u4e2a\u90fd\u6267\u884c\u4e00\u6b21\u6302\u8f7d\u64cd\u4f5c\u3002</p> <p><code>cat /proc/self/mountinfo</code>\u53ef\u4ee5\u770b\u5230\uff0c\u7cfb\u7edf\u9ed8\u8ba4\u7684\u6302\u8f7d\u70b9\u90fd\u662fshared\u7684\u3002clone\u7cfb\u7edf\u8c03\u7528\u4f1a\u5b8c\u5168copy\u7236\u8fdb\u7a0b\u7684\u6302\u8f7d\u70b9\u4fe1\u606f\uff0c\u56e0\u6b64\u5b50\u8fdb\u7a0b\u7684\u6302\u8f7d\u70b9\u4e5f\u662fshared\u3002</p>"},{"location":"linux/namespace.html#peer-group","title":"peer group","text":"<p>\u8868\u793a\u4e86\u4e00\u4e2a\u6216\u591a\u4e2a\u6302\u8f7d\u70b9\u7684\u96c6\u5408\uff0c\u4e0b\u9762\u4e24\u79cd\u60c5\u51b5\u5c5e\u4e8e\u540c\u4e00group\uff1a</p> <ol> <li>\u901a\u8fc7<code>--bind</code>\u64cd\u4f5c\u6302\u8f7d\u7684\u6e90\u6302\u8f7d\u70b9\u548c\u76ee\u6807\u6302\u8f7d\u70b9\uff08\u524d\u63d0\u662f\u6e90\u76ee\u5f55\u662f\u4e2a\u6302\u8f7d\u70b9\uff09\uff1b</li> <li>\u751f\u6210\u65b0<code>mount ns</code>\u65f6\uff0c\u590d\u5236\u8fc7\u53bb\u7684\u6302\u8f7d\u70b9\u4e4b\u95f4\u540c\u5728\u4e00\u4e2agroup\u3002</li> </ol>"},{"location":"linux/namespace.html#mount-propagation","title":"\u6302\u8f7d\u4f20\u64ad\uff08Mount Propagation\uff09","text":"<p>\u6302\u8f7d\u5bf9\u8c61\u7684\u5173\u7cfb\uff1a\u5171\u4eab\u5173\u7cfb\uff0c\u4ece\u5c5e\u5173\u7cfb\uff0c\u79c1\u6709\u5173\u7cfb\uff08\u4e0d\u53ef\u7ed1\u5b9a\u6302\u8f7d\uff09</p> <ul> <li>\u5171\u4eab\u6302\u8f7d\uff1a<code>mount --make-shared &lt;mount-object&gt;</code></li> <li>\u4ece\u5c5e\u6302\u8f7d\uff1a<code>mount --make-slave &lt;mount-object&gt;</code></li> <li>\u79c1\u6709\u6302\u8f7d\uff08\u9ed8\u8ba4\uff09\uff1a<code>mount --make-private &lt;mount-object&gt;</code></li> </ul> <p>\u6302\u8f7d\u72b6\u6001\u53ea\u53ef\u80fd\u4e3a\u4ee5\u4e0b\uff1a</p> <ul> <li>\u5171\u4eab\u6302\u8f7d\uff08shared\uff09\uff1a\u53cc\u5411\u4f20\u64ad\uff0c\u4e00\u4e2a\u6302\u8f7d\u5bf9\u8c61\u7684\u6302\u8f7d\u4e8b\u4ef6\u4f1a\u4f20\u64ad\u5230\u53e6\u4e00\u4e2a\u6302\u8f7d\u5bf9\u8c61\uff1b</li> <li>\u4ece\u5c5e\u6302\u8f7d\uff08slave\uff09\uff1a\u5355\u5411\u4f20\u64ad(master-slave)\uff0c\u53cd\u4e4b\u4e0d\u884c\uff1b</li> <li>\u79c1\u6709\u6302\u8f7d\uff08private\uff09\uff1a\u5404mount namespace\u4e4b\u95f4\u76f8\u4e92\u9694\u79bb\uff1b</li> <li>\u4e0d\u53ef\u7ed1\u5b9a\u6302\u8f7d\uff08unbindable\uff09\uff1a\u4e0d\u53ef\u8ba9\u5176\u5b83mount namespace \u6302\u8f7d\uff1b</li> </ul> <p>\u6ce8\u610f\uff1a</p> <p>Mount Namespace\u8ddf\u5176\u5b83Namespace\u4f7f\u7528\u4e0d\u540c\u7684\u5730\u65b9\uff1a</p> <ul> <li>\u5bf9\u5bb9\u5668\u8fdb\u7a0b\u89c6\u56fe\u7684\u6539\u53d8\u4e00\u5b9a\u8981\u4f34\u968f\u7740\u6302\u8f7d\u64cd\u4f5c\u624d\u80fd\u751f\u6548\u3002</li> </ul> <p>\u5373\u5148clone\u6307\u5b9a<code>CLONE_NEWNS</code>\u6807\u5fd7\uff0c\u7136\u540e\u5728\u6267\u884c/bin/bash\u524d\uff0c\u5148\u6302\u8f7d\u76ee\u5f55\u3002</p>"},{"location":"linux/namespace.html#_2","title":"\u793a\u4f8b","text":"<p>\u4ee3\u7801\uff1ans_mnt.c\uff08\u9700\u8981root\u6743\u9650\u6267\u884c\uff09</p> <p>\u56e0\u6b64\u5b50\u8fdb\u7a0b\u7684\u6302\u8f7d\u70b9\u662fshared\uff0c\u5982\u679c\u5b50\u8fdb\u7a0b\u76f4\u63a5<code>mount proc</code>\u4e4b\u540e\uff0c\u7236\u8fdb\u7a0b\u7684<code>/proc</code>\u4e5f\u4f1a\u88ab\u6539\u53d8\u3002</p> <pre><code># \u5728\u5b50\u8fdb\u7a0b\u4e2d\u7684 /proc \u7684\u91cd\u65b0\u6302\u8f7d\uff0c\u4f1a\u6539\u53d8\u7236\u8fdb\u7a0b ps -ef \u770b\u5230\u7684\u4fe1\u606f\n$ mount -t proc proc /proc\n</code></pre> <ul> <li>\u6ce8\u610f\u5728\u5b50\u547d\u4ee4\u7a7a\u95f4\uff0c\u9700\u8981\u5148\u6267\u884c<code>mount --make-rprivate /</code>\u6216\u8005<code>mount --make-private /proc</code>\u4fee\u6539<code>/proc</code>\u7684\u6302\u8f7d\u5c5e\u6027\u4e3a<code>private</code>\uff1b</li> <li>\u518d\u6267\u884c<code>mount -t proc proc /proc</code>\uff1b</li> </ul>"},{"location":"linux/namespace.html#rootfs","title":"\u5bb9\u5668\u955c\u50cf\uff08rootfs\uff09","text":"<p>\u6302\u8f7d\u5728\u5bb9\u5668\u6839\u76ee\u5f55\u4e0a\u7528\u6765\u4e3a\u5bb9\u5668\u8fdb\u7a0b\u63d0\u4f9b\u9694\u79bb\u540e\u6267\u884c\u73af\u5883\u7684\u6587\u4ef6\u7cfb\u7edf\u3002</p> <p>\u4e3a\u4e86\u8ba9\u5bb9\u5668\u7684\u6839\u76ee\u5f55\u770b\u8d77\u6765\u66f4\u201c\u771f\u5b9e\u201d\uff0c\u4e00\u822c\u4f1a\u5728\u5bb9\u5668\u7684\u6839\u76ee\u5f55\u4e0b\u6302\u8f7d\u4e00\u4e2a\u5b8c\u6574\u64cd\u4f5c\u7cfb\u7edf\u7684\u6587\u4ef6\u7cfb\u7edf\u3002</p> <p>\u65b0\u7684\u5bb9\u5668\uff0c\u770b\u5230\u7684\u6587\u4ef6\u7cfb\u7edf\u662f\u72ec\u7acb\u7684\u9694\u79bb\u73af\u5883\uff0c\u800c\u4e0d\u662f\u7ee7\u627f\u5bbf\u4e3b\u673a\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u5982\u4f55\u5b9e\u73b0\uff1f</p> <ul> <li>\u5728\u5bb9\u5668\u8fdb\u7a0b\u542f\u52a8\u524d\uff0c\u6302\u8f7d\u5b83\u7684\u6574\u4e2a\u76ee\u5f55'/'\uff1b</li> <li><code>chroot</code>\uff1achange root file system\uff0c\u6539\u53d8\u8fdb\u7a0b\u7684\u6839\u76ee\u5f55\u5230\u6307\u5b9a\u4f4d\u7f6e\u3002</li> <li>Docker\u5148\u4f7f\u7528<code>pivot_root</code>\u7cfb\u7edf\u8c03\u7528\uff0c\u7cfb\u7edf\u4e0d\u652f\u6301\u518d\u4f7f\u7528<code>chroot</code>\u3002</li> </ul> <pre><code># \u6267\u884c\u547d\u4ee4\uff08/bin/bash\uff09\uff0c\u5e76\u5c06$HOME/test\u76ee\u5f55\u4f5c\u4e3a/bin/bash\u8fdb\u7a0b\u7684\u6839\u76ee\u5f55\nchroot $HOME/test /bin/bash\n</code></pre>"},{"location":"linux/namespace.html#linux-c-api","title":"Linux C API\uff08\u4f7f\u7528\uff09","text":""},{"location":"linux/namespace.html#namespace_1","title":"\u521b\u5efaNameSpace","text":""},{"location":"linux/namespace.html#clone","title":"clone","text":"<p>int clone(int (child_func)(void ), void * child_stack, int flags, void *arg);</p> <p>\u5728\u521b\u5efa\u65b0\u8fdb\u7a0b\u7684\u540c\u65f6\u521b\u5efanamespace\uff0cflags\u8ddfnamespace\u76f8\u5173\u7684\u53c2\u6570\u6709\uff1a</p> <ul> <li>CLONE_NEWIPC, CLONE_NEWNS, CLONE_NEWNET, CLONE_NEWPID, CLONE_NEWUSER, CLONE_NEWUTS</li> </ul> <p>Linux\u521b\u5efa\u65b0\u8fdb\u7a0b\u7684\u53ef\u9009\u53c2\u6570\uff0c\u6bd4\u5982<code>PID Namespace : CLONE_NEWPID</code></p> <pre><code>// \u65b0\u521b\u5efa\u7684\u8fdb\u7a0b\u4f1a\u201d\u770b\u5230\u201c\u5168\u65b0\u7684\u8fdb\u7a0b\u7a7a\u95f4\uff0c\u5728\u8fd9\u4e2a\u8fdb\u7a0b\u7a7a\u95f4\u91cc\uff0c\u5176PID\u4e3a1\uff0c\u901a\u8fc7ps\u7b49\u770b\u4e0d\u5230\u5bbf\u4e3b\u673a\u7684\u8fdb\u7a0b\u7a7a\u95f4\n// \u4f46\u662f\u5728\u5bbf\u4e3b\u673a\u91cc\uff0c\u5176PID\u8fd8\u662f\u771f\u5b9e\u7684\u6570\u503c\uff0c\u6bd4\u5982100\nint pid = clone(main_function, stack_size, CLONE_NEWPID | SIGCHLD, NULL);\n</code></pre> <p><code>unshare</code>\uff1a\u5728\u539f\u5148\u8fdb\u7a0b\u4e0a\u5b9e\u73b0\u9694\u79bb\uff0c\u4e0d\u9700\u8981\u521b\u5efa\u65b0\u7684\u8fdb\u7a0b\u3002</p> <ul> <li>PID\uff1a\u539f\u5148\u8fdb\u7a0b\u4e0d\u8fdb\u5165\u65b0\u7684PID NameSpace\uff0c\u540e\u7eed\u521b\u5efa\u7684\u5b50\u8fdb\u7a0b\u624d\u8fdb\u5165\uff08\u5373\u65b0namespace\u4e2d\u7684init\u8fdb\u7a0b\uff09\uff1b</li> <li>\u5176\u5b83\u540d\u7a7a\u95f4\uff1a\u539f\u8fdb\u7a0b\u76f4\u63a5\u8fdb\u5165\u65b0\u7684Namespace\uff1b</li> </ul>"},{"location":"linux/namespace.html#fork","title":"fork","text":"<p>fork\u7684\u8fd4\u56de\u503c\uff1a</p> <ul> <li>\u7236\u8fdb\u7a0b\u8fd4\u56de\u65b0\u521b\u5efa\u5b50\u8fdb\u7a0b\u7684\u8fdb\u7a0bPID\uff0c\u5b50\u8fdb\u7a0b\u4e2d\u8fd4\u56de0\uff1b</li> </ul> <p>fork()\u6267\u884c\u540e\uff0c\u7236\u8fdb\u7a0b\u6709\u4e49\u52a1\u76d1\u63a7\u5b50\u8fdb\u7a0b\u7684\u8fd0\u884c\u72b6\u6001\uff0c\u5e76\u5728\u5b50\u8fdb\u7a0b\u9000\u51fa\u540e\u81ea\u5df1\u624d\u80fd\u6b63\u5e38\u9000\u51fa\uff0c\u5426\u5219\u5b50\u8fdb\u7a0b\u4f1a\u53d8\u6210\u201d\u5b64\u513f\u201c\u8fdb\u7a0b\u3002</p>"},{"location":"linux/namespace.html#namespace_2","title":"\u67e5\u770bNameSpace","text":"<p>\u8fdb\u7a0b\u7684\u6bcf\u79cdLinux NameSpace\u5728\u5bf9\u5e94\u7684<code>/proc/[\u8fdb\u7a0b\u53f7]/ns</code>\u4e0b\u6709\u865a\u62df\u6587\u4ef6\uff0c\u94fe\u63a5\u5230\u771f\u5b9e\u7684NameSpace\u6587\u4ef6\u3002</p> <pre><code>lrwxrwxrwx 1 mtk mtk 0 10\u6708 30 10:55 cgroup -&gt; 'cgroup:[4026531835]'\nlrwxrwxrwx 1 mtk mtk 0 10\u6708 30 10:55 ipc -&gt; 'ipc:[4026531839]'\nlrwxrwxrwx 1 mtk mtk 0 10\u6708 30 10:55 mnt -&gt; 'mnt:[4026531840]'\nlrwxrwxrwx 1 mtk mtk 0 10\u6708 30 10:11 net -&gt; 'net:[4026532008]'\nlrwxrwxrwx 1 mtk mtk 0 10\u6708 30 10:11 pid -&gt; 'pid:[4026531836]'\nlrwxrwxrwx 1 mtk mtk 0 10\u6708 30 10:55 pid_for_children -&gt; 'pid:[4026531836]'\nlrwxrwxrwx 1 mtk mtk 0 10\u6708 30 10:55 time -&gt; 'time:[4026531834]'\nlrwxrwxrwx 1 mtk mtk 0 10\u6708 30 10:55 time_for_children -&gt; 'time:[4026531834]'\nlrwxrwxrwx 1 mtk mtk 0 10\u6708 30 10:11 user -&gt; 'user:[4026531837]'\nlrwxrwxrwx 1 mtk mtk 0 10\u6708 30 10:55 uts -&gt; 'uts:[4026531838]'\n</code></pre>"},{"location":"linux/namespace.html#namespace_3","title":"\u52a0\u5165 NameSpace","text":""},{"location":"linux/namespace.html#setns","title":"setns","text":"<p>int setns(int fd, int nstype);</p> <p>\u7cfb\u7edf\u8c03\u7528\uff0c\u4ece\u539f\u5148\u7684namespace\u52a0\u5165\u65b0\u7684namespace\u4e2d</p> <ul> <li>fd : \u52a0\u5165namespace\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u53ca<code>/proc[pid]/ns</code>\u76ee\u5f55\u4e0b\u7684\u5bf9\u5e94\u6587\u4ef6\uff1b</li> <li>\u540c<code>unshare</code>\uff0c\u4f46\u662f\u539f\u8fdb\u7a0b\u4e0d\u5165\u65b0\u7684NS\uff08\u5305\u62ecPID\uff09\uff0c\u521b\u5efa\u5b50\u8fdb\u7a0b\u624d\u5165\u65b0\u7684NS\uff08\u5305\u62ecPID\uff09\uff1b</li> </ul> <p><code>exec</code>\u65cf\u7684\u51fd\u6570(<code>execv, execvp, execl, execlp</code>)\u6267\u884c\u547d\u4ee4\u3002</p> <ul> <li><code>exec</code>\uff1aC\u7a0b\u5e8f\u7acb\u5373\u88ab\u5b9e\u9645\u547d\u4ee4\u66ff\u6362\uff0c\u5373<code>exec**</code>\u4e4b\u540e\u7684\u4ee3\u7801\u4e0d\u4f1a\u6267\u884c\uff0c\u5982\u679c\u9700\u8981\u63a7\u5236\uff0c\u53ef\u4ee5\u4f7f\u7528<code>fork-exec</code>\u673a\u5236\uff1b\u547d\u4ee4\u6267\u884c\u5931\u8d25\uff0c\u8fd4\u56de-1\uff1b</li> </ul> <p>\u793a\u4f8b\u5982\u4e0b\uff1a<code>./setns-test /proc/27342/uts /bin/bash</code></p> <pre><code>#define _GNU_SOURCE\n#include &lt;fcntl.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sched.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n\n#define errExit(msg) do { perror(msg); exit(EXIT_FAILURE); } while (0)\n\nint main(int argc, char* argv[]) {\n    int fd = open(argv[1], O_RDONLY);  /* \u83b7\u53d6namespace\u6587\u4ef6\u63cf\u8ff0\u7b26 */\n    if (setns(fd, 0) == -1) {          /* \u52a0\u5165\u65b0\u7684namespace */\n        errExit(\"setns\");\n    }\n    execvp(argv[2], &amp;argv[2]);         /* \u6267\u884c\u7a0b\u5e8f */\n    errExit(\"execvp\");                 /* \u547d\u4ee4\u6267\u884c\u6210\u529f\u65f6\uff0c\u6b64\u884c\u4e0d\u4f1a\u6267\u884c */\n}\n</code></pre>"},{"location":"linux/namespace.html#unshare","title":"unshare","text":"<p>int unshare(int flags);</p> <p>\u5728\u539f\u5148\u7684\u8fdb\u7a0b\u4e0a\u8fdb\u884cnamespace\u9694\u79bb\uff08\u4e0d\u5305\u62ecPID\uff09\u3002</p> <ul> <li>flags : namespace\u7684\u7c7b\u578b\uff08\u5373 CLONE_NEW* \uff09</li> </ul>"},{"location":"linux/network.html","title":"Network","text":""},{"location":"linux/network.html#_1","title":"\u67e5\u770b\u53ef\u7528\u7684\u7aef\u53e3\u53f7\u8303\u56f4","text":"<pre><code>$ cat /proc/sys/net/ipv4/ip_local_port_range\n</code></pre>"},{"location":"linux/network.html#_2","title":"\u67e5\u770b\u5e26\u5bbd\u5927\u5c0f","text":"<pre><code>$ etchtool em1\nSettings for em1:\n    Supported ports: [ FIBRE ]\n    # \u652f\u6301 1Gbps/10GB \u5168\u53cc\u5de5\u4ee5\u592a\u7f51\u8fde\u63a5\n    Supported link modes:   1000baseT/Full \n                            10000baseT/Full \n    Supported pause frame use: Symmetric Receive-only\n    # \u63a5\u53e3\u652f\u6301\u81ea\u52a8\u534f\u5546\u529f\u80fd\uff0c\u7528\u4e8e\u786e\u5b9a\u6700\u4f73\u7684\u8fde\u63a5\u901f\u5ea6\u548c\u53cc\u5de5\u6a21\u5f0f\u3002\n    Supports auto-negotiation: Yes\n    Supported FEC modes: Not reported\n    Advertised link modes:  1000baseT/Full \n                            10000baseT/Full \n    Advertised pause frame use: Symmetric\n    Advertised auto-negotiation: Yes\n    Advertised FEC modes: Not reported\n    # \u5f53\u524d\u63a5\u53e3\u7684\u8fd0\u884c\u901f\u5ea6\u662f 10Gbps\n    Speed: 10000Mb/s\n    Duplex: Full\n    # \u76f4\u63a5\u8fde\u63a5\u7684\u94dc\u7f06\n    Port: Direct Attach Copper\n    PHYAD: 1\n    Transceiver: internal\n    Auto-negotiation: on\n    Supports Wake-on: g\n    Wake-on: d\n    Current message level: 0x00000000 (0)\n    # \u63a5\u53e3\u4e0e\u7f51\u7edc\u8bbe\u5907\u4e4b\u95f4\u7684\u7269\u7406\u8fde\u63a5\u662f\u6d3b\u52a8            \n    Link detected: yes\n</code></pre>"},{"location":"linux/network.html#_3","title":"\u67e5\u770b\u7f51\u6865\u548c\u7aef\u53e3\u8fde\u63a5\u4fe1\u606f","text":"<p><code>brctl show</code></p>"},{"location":"linux/network.html#netstat","title":"netstat","text":"<p>\u683c\u5f0f\uff1a</p> <pre><code>$ netstat -a -p -n\n</code></pre> <ul> <li><code>-a (all)</code>\u663e\u793a\u6240\u6709\u9009\u9879\uff0c\u9ed8\u8ba4\u4e0d\u663e\u793aLISTEN\u76f8\u5173</li> <li><code>-n</code> \u62d2\u7edd\u663e\u793a\u522b\u540d\uff0c\u80fd\u663e\u793a\u6570\u5b57\u7684\u5168\u90e8\u8f6c\u5316\u6210\u6570\u5b57\u3002</li> <li><code>-p</code> \u663e\u793a\u5efa\u7acb\u76f8\u5173\u94fe\u63a5\u7684\u7a0b\u5e8f\u540d</li> <li><code>-t (tcp)</code>\u4ec5\u663e\u793atcp\u76f8\u5173\u9009\u9879</li> <li><code>-u (udp)</code>\u4ec5\u663e\u793audp\u76f8\u5173\u9009\u9879</li> <li><code>-l</code>\u4ec5\u5217\u51fa\u6709\u5728 Listen (\u76d1\u542c) \u7684\u670d\u52d9\u72b6\u6001</li> <li><code>-r</code> \u663e\u793a\u8def\u7531\u4fe1\u606f\uff0c\u8def\u7531\u8868</li> <li><code>-e</code> \u663e\u793a\u6269\u5c55\u4fe1\u606f\uff0c\u4f8b\u5982uid\u7b49</li> <li><code>-s</code> \u6309\u5404\u4e2a\u534f\u8bae\u8fdb\u884c\u7edf\u8ba1</li> <li><code>-c</code> \u6bcf\u9694\u4e00\u4e2a\u56fa\u5b9a\u65f6\u95f4\uff0c\u6267\u884c\u8be5netstat\u547d\u4ee4\u3002</li> </ul> <p>netstat\u7ed3\u679c\u4fe1\u606f\u5206\u4e24\u7c7b</p> <ul> <li>Active Internet connections\uff0c\u6709\u6e90TCP\u8fde\u63a5\uff0c</li> </ul> <pre><code>Proto Recv-Q Send-Q LocalAddress ForeignAddress State\ntcp 0 2 210.34.6.89:telnet 210.34.6.96:2873 ESTABLISHED\ntcp 296 0 210.34.6.89:1165 210.34.6.84:netbios-ssn ESTABLISHED\ntcp 0 0 localhost.localdom:9001 localhost.localdom:1162 ESTABLISHED\ntcp 0 0 localhost.localdom:1162 localhost.localdom:9001 ESTABLISHED\ntcp 0 80 210.34.6.89:1161 210.34.6.10:netbios-ssn CLOSE\n</code></pre> <ul> <li>Active Unix domain sockets\uff0c\u6709\u6e90Unix\u57df\u5957\u63a5\u53e3\uff0cRefCnt\u8868\u793a\u8fde\u63a5\u5230\u672c\u5957\u63a5\u53e3\u4e0a\u7684\u8fdb\u7a0b\u53f7</li> </ul> <pre><code>Proto RefCnt Flags Type State I-Node Path\nunix 1 [ ] STREAM CONNECTED 16178 @000000dd\nunix 1 [ ] STREAM CONNECTED 16176 @000000dc\nunix 9 [ ] DGRAM 5292 /dev/log\nunix 1 [ ] STREAM CONNECTED 16182 @000000df\n</code></pre>"},{"location":"linux/network.html#_4","title":"\u81ea\u7b7e\u540d\u8bc1\u4e66","text":"<p>\u521b\u5efa\u81ea\u7b7e\u540d\u8bc1\u4e66\uff08Generated By ChatGpt\uff09</p> <pre><code># \u751f\u6210\u79c1\u94a5\nopenssl genrsa -out mykey.key 2048\n# \u521b\u5efa\u8bc1\u4e66\u7b7e\u540d\u8bf7\u6c42\uff08CSR\uff09\nopenssl req -new -key mykey.key -out mycsr.csr -subj \"/C=CN/ST=GuangDong/L=ShenZhen/O=Huawei/OU=CBC/CN=172.16.1.129\"\n# \u81ea\u7b7e\u540d\u8bc1\u4e66\nopenssl x509 -req -days 365 -in mycsr.csr -signkey mykey.key -out mycert.crt\n# \u53ef\u9009\uff08\u5c06\u8bc1\u4e66\u548c\u79c1\u94a5\u8f6c\u6362\u4e3a\u5176\u4ed6\u683c\u5f0f\uff09\uff0c\u5982PKCS#12\uff08.pfx\u6216.p12\uff09\u6216Java KeyStore\uff08.jks\uff09\nopenssl pkcs12 -export -out mycert.pfx -inkey mykey.key -in mycert.crt\n</code></pre>"},{"location":"linux/network.html#_5","title":"\u9632\u706b\u5899","text":""},{"location":"linux/network.html#_6","title":"\u670d\u52a1\u64cd\u4f5c","text":"<pre><code># \u67e5\u770b\u72b6\u6001\nsystemctl status firewalld\n\nfirewall-cmd --state\n\n# \u5f00\u542f\nsystemctl start firewalld\n# \u91cd\u542f\nsystemctl restart firewalld\n# \u5173\u95ed\nsystemctl stop firewalld\n</code></pre>"},{"location":"linux/network.html#_7","title":"\u67e5\u770b\u9632\u706b\u5899\u89c4\u5219","text":"<pre><code>firewall-cmd --list-all \n</code></pre>"},{"location":"linux/network.html#_8","title":"\u67e5\u8be2\u3001\u5f00\u653e\u3001\u5173\u95ed\u7aef\u53e3","text":"<p>\u53c2\u6570\u89e3\u91ca</p> <ul> <li><code>firwall-cmd</code>\uff1a\u662fLinux\u63d0\u4f9b\u7684\u64cd\u4f5cfirewall\u7684\u4e00\u4e2a\u5de5\u5177\uff1b</li> <li><code>--permanent</code>\uff1a\u8868\u793a\u8bbe\u7f6e\u4e3a\u6301\u4e45\uff1b</li> <li><code>--add-port</code>\uff1a\u6807\u8bc6\u6dfb\u52a0\u7684\u7aef\u53e3\uff1b</li> </ul> <pre><code># \u67e5\u8be2\u7aef\u53e3\u662f\u5426\u5f00\u653e\nfirewall-cmd --query-port=8080/tcp\n# \u5f00\u653e80\u7aef\u53e3\nfirewall-cmd --permanent --add-port=80/tcp\n# \u79fb\u9664\u7aef\u53e3\nfirewall-cmd --permanent --remove-port=80/tcp\n#\u91cd\u542f\u9632\u706b\u5899(\u4fee\u6539\u914d\u7f6e\u540e\u8981\u91cd\u542f\u9632\u706b\u5899) \nfirewall-cmd --reload\n</code></pre>"},{"location":"linux/network.html#ip","title":"\u6d6e\u52a8 IP \u521b\u5efa","text":"<p>\u4f8b\u5982\uff1a\u4e24\u4e2a\u673a\u5668 ip \u5730\u5740\u4e3a<code>192.168.2.5/6</code>\uff1b\u8981\u8bbe\u7f6e\u7684\u6d6e\u52a8 ip \u4e3a<code>192.168.2.10</code></p> <ul> <li>\u521b\u5efa\u6d6e\u52a8ip\uff1a</li> </ul> <pre><code>ifconfig eth0:1 192.168.2.10 netmask 255.255.255.0 up   # broadcast 192.168.2.255\n</code></pre> <ul> <li>\u5c06\u6d6e\u52a8 ip \u5199\u5165\u672c\u5730\u5f00\u673a\u542f\u52a8\uff0c\u786e\u4fdd\u673a\u5668\u91cd\u542f\u4ecd\u7136\u751f\u6548</li> </ul> <pre><code>echo ifconfig eth0:1 192.168.2.10 netmask 255.255.255.0 broadcast 192.168.2.255 &gt;&gt; /etc/rc.local\n</code></pre> <ul> <li>\u505c\u6b62\u6d6e\u52a8IP</li> </ul> <pre><code>ifconfig eth0:1 down\n</code></pre> <p>\u4f7f\u7528 keepalived \u7684\u65f6\u5019\u4e3b\u673a\u6302\u4e86\uff0c\u5907\u673a\u663e\u793a\u7ed1\u5b9a\u4e86VIP\u3002\u4f46\u662f\u6b64\u65f6\u5b9e\u9645\u8fd8\u662f\u4e0d\u80fd\u8bbf\u95ee\u3002\u5176\u5b9e\u5c31\u662f\u7f51\u5173\u7684arp\u7f13\u5b58\u6ca1\u6709\u5237\u65b0\u3002</p> <p>\u5728\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4e00\u4e0b\u5c31\u884c\u4e86</p> <pre><code>arping -I eth0 -c 5 -s $VIP $GATEWAY\n# intf=${1/:*/}  #`/usr/bin/awk '/default/ {print $2}' /etc/sysconfig/network/routes`\n/sbin/arping -b -I \"$intf\" -s \"$2\" \"$route\" -c 4                 \n\n## iptable\n\n### \u7528\u6cd5\n\n```shell\n$ iptables -t \u8868\u540d &lt;-A/I/D/R&gt; \u89c4\u5219\u94fe\u540d [\u89c4\u5219\u53f7] &lt;-i/o \u7f51\u5361\u540d&gt; -p \u534f\u8bae\u540d &lt;-s \u6e90IP/\u6e90\u5b50\u7f51&gt; --sport \u6e90\u7aef\u53e3 &lt;-d \u76ee\u6807IP/\u76ee\u6807\u5b50\u7f51&gt; --dport \u76ee\u6807\u7aef\u53e3 -j \u52a8\u4f5c\n</code></pre> <p>\u9009\u9879\u53c2\u6570</p> <ul> <li><code>-t&lt;\u8868&gt;</code>\uff1a\u6307\u5b9a\u8981\u64cd\u7eb5\u7684\u8868\uff1b</li> <li><code>-A</code>\uff1a\u5411\u89c4\u5219\u94fe\u4e2d\u6dfb\u52a0\u6761\u76ee\uff1b</li> <li><code>-D</code>\uff1a\u4ece\u89c4\u5219\u94fe\u4e2d\u5220\u9664\u6761\u76ee\uff1b</li> <li><code>-I</code>\uff1a\u5411\u89c4\u5219\u94fe\u4e2d\u63d2\u5165\u6761\u76ee\uff1b</li> <li><code>-R</code>\uff1a\u66ff\u6362\u89c4\u5219\u94fe\u4e2d\u7684\u6761\u76ee\uff1b</li> <li><code>-L</code>\uff1a\u663e\u793a\u89c4\u5219\u94fe\u4e2d\u5df2\u6709\u7684\u6761\u76ee\uff1b</li> <li><code>-F</code>\uff1a\u6e05\u9664\u89c4\u5219\u94fe\u4e2d\u5df2\u6709\u7684\u6761\u76ee\uff1b</li> <li><code>-Z</code>\uff1a\u6e05\u7a7a\u89c4\u5219\u94fe\u4e2d\u7684\u6570\u636e\u5305\u8ba1\u7b97\u5668\u548c\u5b57\u8282\u8ba1\u6570\u5668\uff1b</li> <li><code>-N</code>\uff1a\u521b\u5efa\u65b0\u7684\u7528\u6237\u81ea\u5b9a\u4e49\u89c4\u5219\u94fe\uff1b</li> <li><code>-P</code>\uff1a\u5b9a\u4e49\u89c4\u5219\u94fe\u4e2d\u7684\u9ed8\u8ba4\u76ee\u6807\uff1b</li> <li><code>-p</code>\uff1a\u6307\u5b9a\u8981\u5339\u914d\u7684\u6570\u636e\u5305\u534f\u8bae\u7c7b\u578b\uff1b</li> <li><code>-s</code>\uff1a\u6307\u5b9a\u8981\u5339\u914d\u7684\u6570\u636e\u5305\u6e90 ip \u5730\u5740\uff1b</li> <li><code>-d</code>\uff1a\u6307\u5b9a\u8981\u5339\u914d\u7684\u6570\u636e\u5305\u76ee\u6807 ip \u5730\u5740\uff1b</li> <li><code>--sport num</code> \u5339\u914d\u6765\u6e90\u7aef\u53e3\u53f7\uff1b</li> <li><code>--dport num</code> \u5339\u914d\u76ee\u6807\u7aef\u53e3\u53f7\uff1b</li> <li><code>-j &lt;\u52a8\u4f5c&gt;</code>\uff1a\u6307\u5b9a\u76ee\u6807\uff08jump target\uff09\u6216\u52a8\u4f5c\uff08action\uff09\uff1b</li> <li><code>-i &lt;\u7f51\u7edc\u63a5\u53e3&gt;</code>\uff1a\u6307\u5b9a\u6570\u636e\u5305\u8fdb\u5165\u672c\u673a\u7684\u7f51\u7edc\u63a5\u53e3\uff0ceth0\uff1b</li> <li><code>-o &lt;\u7f51\u7edc\u63a5\u53e3&gt;</code>\uff1a\u6307\u5b9a\u6570\u636e\u5305\u8981\u79bb\u5f00\u672c\u673a\u6240\u4f7f\u7528\u7684\u7f51\u7edc\u63a5\u53e3\u3002</li> </ul> <p>\u8868\u540d\u5305\u62ec\uff1a</p> <ul> <li>raw\uff1a\u9ad8\u7ea7\u529f\u80fd\uff0c\u5982\uff1a\u7f51\u5740\u8fc7\u6ee4\u3002</li> <li>mangle\uff1a\u6570\u636e\u5305\u4fee\u6539\uff08QOS\uff09\uff0c\u7528\u4e8e\u5b9e\u73b0\u670d\u52a1\u8d28\u91cf\u3002</li> <li>net\uff1a\u5730\u5740\u8f6c\u6362\uff0c\u7528\u4e8e\u7f51\u5173\u8def\u7531\u5668\u3002</li> <li>filter\uff1a\u5305\u8fc7\u6ee4\uff0c\u7528\u4e8e\u9632\u706b\u5899\u89c4\u5219\u3002\uff08default\uff09</li> </ul> <p>\u89c4\u5219\u94fe\u540d\u5305\u62ec\uff1a</p> <ul> <li>INPUT\u94fe\uff1a\u5904\u7406\u8f93\u5165\u6570\u636e\u5305\u3002</li> <li>OUTPUT\u94fe\uff1a\u5904\u7406\u8f93\u51fa\u6570\u636e\u5305\u3002</li> <li>FORWARD\u94fe\uff1a\u5904\u7406\u8f6c\u53d1\u6570\u636e\u5305\u3002</li> <li>PREROUTING\u94fe\uff1a\u7528\u4e8e\u76ee\u6807\u5730\u5740\u8f6c\u6362\uff08DNAT\uff09\u3002</li> <li>POSTOUTING\u94fe\uff1a\u7528\u4e8e\u6e90\u5730\u5740\u8f6c\u6362\uff08SNAT\uff09\u3002</li> </ul> <p>\u52a8\u4f5c\u5305\u62ec\uff1a</p> <ul> <li>ACCEPT\uff1a\u63a5\u6536\u6570\u636e\u5305\u3002</li> <li>DROP\uff1a\u4e22\u5f03\u6570\u636e\u5305\u3002</li> <li>REDIRECT\uff1a\u91cd\u5b9a\u5411\u3001\u6620\u5c04\u3001\u900f\u660e\u4ee3\u7406\u3002</li> <li>SNAT\uff1a\u6e90\u5730\u5740\u8f6c\u6362\u3002</li> <li>DNAT\uff1a\u76ee\u6807\u5730\u5740\u8f6c\u6362\u3002</li> <li>MASQUERADE\uff1aIP\u4f2a\u88c5\uff08NAT\uff09\uff0c\u7528\u4e8eADSL\u3002</li> <li>LOG\uff1a\u65e5\u5fd7\u8bb0\u5f55\u3002</li> </ul>"},{"location":"linux/network.html#_9","title":"\u793a\u4f8b","text":"<pre><code># \u5c06\u6240\u6709iptables\u4ee5\u5e8f\u53f7\u6807\u8bb0\u663e\u793a\niptables -L -n --line-number\n\n# \u8981\u5220\u9664INPUT\u91cc\u5e8f\u53f7\u4e3a8\u7684\u89c4\u5219\niptables -D INPUT 8\n\n# \u8bbe\u7f6e\u9ed8\u8ba4\u94fe\u4e3aAccept\uff0c\u7136\u540e\u8bbe\u7f6e\u767d\u540d\u5355\uff08\u653e\u901a\u7684IP\uff09\uff0c\u6700\u540e\u4e00\u6761\u62d2\u7edd\u6240\u6709\u7684\u8bf7\u6c42\niptables -P INPUT ACCEPT\niptables -I INPUT -s 192.144.1.5 -p tcp --dport 7089 -j ACCEPT\niptables -A INPUT -j REJECT\n</code></pre>"},{"location":"linux/network.html#ip_1","title":"IP\u547d\u4ee4","text":""},{"location":"linux/network.html#link","title":"link","text":"<pre><code># \u542f\u52a8\u56de\u73af\u8bbe\u5907\n$ ip link set dev lo up\n</code></pre>"},{"location":"linux/network.html#netns","title":"netns","text":"<pre><code># \u521b\u5efanetwork namespace\n$ ip netns add nstest\n\n# \u5217\u51fa\u5b58\u5728\u7684network namespace\n$ ip netns list\n\n# \u5220\u9664network namespace\n$ ip netns delete nstest\n\n# \u5728network namespace\u4e2d\u6267\u884c\u547d\u4ee4\uff0c\u5f62\u5f0f ip netns exec &lt;network namespace&gt; &lt;command&gt;\n$ ip netns exec nstest ip addr\n</code></pre>"},{"location":"linux/network.html#_10","title":"\u793a\u4f8b","text":"<p>\u65b0\u5efanetwork namespace\uff0c\u521b\u5efaveth-pair\uff0c\u5206\u914dIP\uff0c\u5e76\u4e0e\u4e3b\u673a\u4e92\u901a\u3002</p> <pre><code># \u521b\u5efa nstest network namespace\n$ ip netns add nstest\n\n# \u521b\u5efanetwork namespace\u65f6\uff0c\u9ed8\u8ba4\u521b\u5efa\u4e00\u4e2a\u56de\u73af\u8bbe\u5907\uff08loopback interface : lo\uff09\uff0c\u9ed8\u8ba4\u4e0d\u542f\u52a8\n# \u542f\u52a8 nstest \u7684 lo\n$ ip netns exec nstest ip link set dev lo up\n\n# \u4e3b\u673a\u4e0a\u521b\u5efaveth-pair\u4e24\u5f20\u865a\u62df\u7f51\u5361 veth-a \u548c veth-b\n$ ip link add veth-a type veth peer name veth-b\n\n# \u5c06veth-b\u8bbe\u5907\u6dfb\u52a0\u5230nstest\uff0cveth-a\u5219\u7559\u5728\u4e3b\u673a\n$ ip link set veth-b netns nstest\n\n# \u67e5\u770bnstest\u5e94\u8be5\u5177\u5907lo\u548cveth-b\u4e24\u5f20\u7f51\u5361\n$ ip netns exec nstest ip link\n\n# \u4e3a\u4e3b\u673aveth-a\u7f51\u5361\u5206\u914dIP\u5e76\u542f\u52a8\u7f51\u5361\n$ ip addr add 10.0.0.1/24 dev veth-a\n$ ip link set dev veth-a up\n\n# \u4e3anstest\u7684veth-b\u7f51\u5361\u5206\u914dIP\u5e76\u542f\u52a8\u7f51\u5361\n$ ip netns exec nstest ip addr add 10.0.0.2/24 dev veth-b\n$ ip netns exec nstest ip link set dev veth-b up\n\n# \u4e3a\u7f51\u5361\u914d\u7f6e\u597dIP\u540e\uff0c\u5728\u5404\u81ea\u7684network namespace\u4e2d\u4f1a\u751f\u6210\u8def\u7531\uff0c\u67e5\u770b\n# \u4e3b\u673a\uff0c\u8868\u660e\u76ee\u7684\u5730\u574010.0.0.0/24\u7684IP\u5305\u4eceveth-a\u7f51\u5361\u53d1\u51fa\n$ ip route\n10.0.0.0/24 dev veth-a proto kernel scope link src 10.0.0.1 \n\n# nstest\uff0c\u8868\u660e\u76ee\u7684\u5730\u574010.0.0.0/24\u7684IP\u5305\u4eceveth-b\u7f51\u5361\u53d1\u51fa\n$ ip netns exec nstest ip route\n10.0.0.0/24 dev veth-b proto kernel scope link src 10.0.0.2\n\n# \u4e3b\u673aveth-a\u7f51\u5361ping nstest\u7684veth-b\u7f51\u5361\n$ ping 10.0.0.2\n\n# nstest\u7684veth-b\u7f51\u5361ping\u4e3b\u673aveth-a\u7f51\u5361\n$ ip netns exec nstest ping 10.0.0.1\n</code></pre>"},{"location":"linux/network.html#bridge","title":"bridge","text":"<p>\u4e0a\u9762\u7684\u793a\u4f8b\u662f\u901a\u8fc7 route \u8fdb\u884c\u901a\u4fe1\uff0c\u672c\u4f8b\u662f\u901a\u8fc7\u7f51\u6865\u5bf9 veth pair \u901a\u4fe1\uff1a</p> <pre><code># \u521b\u5efa veth pair\n$ ip link add veth1 type veth peer name veth2\n$ ip link set dev veth1 up\n$ ip link set dev veth2 up\n\n# \u521b\u5efa\u7f51\u6865br1\n$ ip link add br0 type bridge\n\n# \u5c06 veth \u52a0\u5165 br0\n$ ip link set veth1 master br0\n$ ip link set veth2 master br0\n\n# \u7f51\u6865\u7684\u5730\u5740\uff0c\u548c veth2 \u7684\u5730\u5740\n$ ip addr add 10.0.0.1/24 dev br0\n$ ip addr add 10.0.0.2/24 dev veth2\n\n# \u67e5\u770b\u6240\u6709\u7684\u7f51\u6865\u4ee5\u53ca\u5bf9\u5e94\u7684\u7f51\u5361\u4fe1\u606f\n$ ip link show type bridge\n$ bridge link\n\n# \u4ece\u7f51\u6865br1\u4e2d\u5220\u9664eth0\n$ ip link set dev eth0 nomaster\n\n# \u5220\u9664\u7f51\u6865br1\n$ ip link del br1\n</code></pre>"},{"location":"linux/network.html#pipeworklinux-container","title":"pipework(Linux Container)","text":"<p>Software-Defined Networking tools for LXC (LinuX Containers)</p>"},{"location":"linux/network.html#tcp-dump","title":"TCP Dump","text":"<pre><code>tcpdump [ -DenNqvX ] [ -c count ] [ -F file ] [ -i interface ] [ -r file ]\n        [ -s snaplen ] [ -w file ] [ expression ]\n</code></pre> <p>\u6293\u5305\u9009\u9879</p> <p>-c\uff1a\u6307\u5b9a\u8981\u6293\u53d6\u7684\u5305\u6570\u91cf\u3002</p> <p>-i interface\uff1a\u6307\u5b9atcpdump\u9700\u8981\u76d1\u542c\u7684\u63a5\u53e3\u3002\u9ed8\u8ba4\u4f1a\u6293\u53d6\u7b2c\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u3002</p> <p>-n\uff1a\u5bf9\u5730\u5740\u4ee5\u6570\u5b57\u65b9\u5f0f\u663e\u5f0f\uff0c\u5426\u5219\u663e\u5f0f\u4e3a\u4e3b\u673a\u540d\uff0c\u4e5f\u5c31\u662f\u8bf4-n\u9009\u9879\u4e0d\u505a\u4e3b\u673a\u540d\u89e3\u6790\u3002</p> <p>-nn\uff1a\u9664\u4e86-n\u7684\u4f5c\u7528\u5916\uff0c\u8fd8\u628a\u7aef\u53e3\u663e\u793a\u4e3a\u6570\u503c\uff0c\u5426\u5219\u663e\u793a\u7aef\u53e3\u670d\u52a1\u540d\u3002</p> <p>-P\uff1a\u6307\u5b9a\u8981\u6293\u53d6\u7684\u5305\u662f\u6d41\u5165\u8fd8\u662f\u6d41\u51fa\u7684\u5305\u3002\u53ef\u4ee5\u7ed9\u5b9a\u7684\u503c\u4e3a\"in\"\u3001\"out\"\u548c\"inout\"\uff0c\u9ed8\u8ba4\u4e3a\"inout\"\u3002</p> <p>-s len\uff1a\u8bbe\u7f6etcpdump\u7684\u6570\u636e\u5305\u6293\u53d6\u957f\u5ea6\u4e3alen\uff0c\u5982\u679c\u4e0d\u8bbe\u7f6e\u9ed8\u8ba4\u5c06\u4f1a\u662f65535\u5b57\u8282\u3002\u5bf9\u4e8e\u8981\u6293\u53d6\u7684\u6570\u636e\u5305\u8f83\u5927\u65f6\uff0c\u957f\u5ea6\u8bbe\u7f6e\u4e0d\u591f\u53ef\u80fd\u4f1a\u4ea7\u751f\u5305\u622a\u65ad\uff0c\u82e5\u51fa\u73b0\u5305\u622a\u65ad\uff0c\u8f93\u51fa\u884c\u4e2d\u4f1a\u51fa\u73b0\"[|proto]\"\u7684\u6807\u5fd7(proto\u5b9e\u9645\u4f1a\u663e\u793a\u4e3a\u534f\u8bae\u540d)\u3002\u4f46\u662f\u6293\u53d6len\u8d8a\u957f\uff0c\u5305\u7684\u5904\u7406\u65f6\u95f4\u8d8a\u957f\uff0c\u5e76\u4e14\u4f1a\u51cf\u5c11tcpdump\u53ef\u7f13\u5b58\u7684\u6570\u636e\u5305\u7684\u6570\u91cf\uff0c\u4ece\u800c\u4f1a\u5bfc\u81f4\u6570\u636e\u5305\u7684\u4e22\u5931\uff0c\u6240\u4ee5\u5728\u80fd\u6293\u53d6\u6211\u4eec\u60f3\u8981\u7684\u5305\u7684\u524d\u63d0\u4e0b\uff0c\u6293\u53d6\u957f\u5ea6\u8d8a\u5c0f\u8d8a\u597d\u3002</p> <p>\u8f93\u51fa\u9009\u9879</p> <p>-e\uff1a\u8f93\u51fa\u7684\u6bcf\u884c\u4e2d\u90fd\u5c06\u5305\u62ec\u6570\u636e\u94fe\u8def\u5c42\u5934\u90e8\u4fe1\u606f\uff0c\u4f8b\u5982\u6e90MAC\u548c\u76ee\u6807MAC\u3002</p> <p>-q\uff1a\u5feb\u901f\u6253\u5370\u8f93\u51fa\u3002\u5373\u6253\u5370\u5f88\u5c11\u7684\u534f\u8bae\u76f8\u5173\u4fe1\u606f\uff0c\u4ece\u800c\u8f93\u51fa\u884c\u90fd\u6bd4\u8f83\u7b80\u77ed\u3002</p> <p>-X\uff1a\u8f93\u51fa\u5305\u7684\u5934\u90e8\u6570\u636e\uff0c\u4f1a\u4ee516\u8fdb\u5236\u548cASCII\u4e24\u79cd\u65b9\u5f0f\u540c\u65f6\u8f93\u51fa\u3002</p> <p>-XX\uff1a\u8f93\u51fa\u5305\u7684\u5934\u90e8\u6570\u636e\uff0c\u4f1a\u4ee516\u8fdb\u5236\u548cASCII\u4e24\u79cd\u65b9\u5f0f\u540c\u65f6\u8f93\u51fa\uff0c\u66f4\u8be6\u7ec6\u3002</p> <p>-v\uff1a\u5f53\u5206\u6790\u548c\u6253\u5370\u7684\u65f6\u5019\uff0c\u4ea7\u751f\u8be6\u7ec6\u7684\u8f93\u51fa\u3002</p> <p>-vv\uff1a\u4ea7\u751f\u6bd4-v\u66f4\u8be6\u7ec6\u7684\u8f93\u51fa\u3002</p> <p>-vvv\uff1a\u4ea7\u751f\u6bd4-vv\u66f4\u8be6\u7ec6\u7684\u8f93\u51fa\u3002</p> <p>\u529f\u80fd\u6027\u9009\u9879</p> <p>-D\uff1a\u5217\u51fa\u53ef\u7528\u4e8e\u6293\u5305\u7684\u63a5\u53e3\u3002\u5c06\u4f1a\u5217\u51fa\u63a5\u53e3\u7684\u6570\u503c\u7f16\u53f7\u548c\u63a5\u53e3\u540d\uff0c\u5b83\u4eec\u90fd\u53ef\u4ee5\u7528\u4e8e\"-i\"\u540e\u3002</p> <p>-F\uff1a\u4ece\u6587\u4ef6\u4e2d\u8bfb\u53d6\u6293\u5305\u7684\u8868\u8fbe\u5f0f\u3002\u82e5\u4f7f\u7528\u8be5\u9009\u9879\uff0c\u5219\u547d\u4ee4\u884c\u4e2d\u7ed9\u5b9a\u7684\u5176\u4ed6\u8868\u8fbe\u5f0f\u90fd\u5c06\u5931\u6548\u3002</p> <p>-w\uff1a\u5c06\u6293\u5305\u6570\u636e\u8f93\u51fa\u5230\u6587\u4ef6\u4e2d\u800c\u4e0d\u662f\u6807\u51c6\u8f93\u51fa\u3002\u53ef\u4ee5\u540c\u65f6\u914d\u5408\"-G time\"\u9009\u9879\u4f7f\u5f97\u8f93\u51fa\u6587\u4ef6\u6bcftime\u79d2\u5c31\u81ea\u52a8\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u6587\u4ef6\u3002\u53ef\u901a\u8fc7\"-r\"\u9009\u9879\u8f7d\u5165\u8fd9\u4e9b\u6587\u4ef6\u4ee5\u8fdb\u884c\u5206\u6790\u548c\u6253\u5370\u3002</p> <p>-r\uff1a\u4ece\u7ed9\u5b9a\u7684\u6570\u636e\u5305\u6587\u4ef6\u4e2d\u8bfb\u53d6\u6570\u636e\u3002\u4f7f\u7528\"-\"\u8868\u793a\u4ece\u6807\u51c6\u8f93\u5165\u4e2d\u8bfb\u53d6\u3002</p>"},{"location":"linux/process_snapshot.html","title":"\u8fdb\u7a0b\u5feb\u7167","text":""},{"location":"linux/process_snapshot.html#_1","title":"\u8fdb\u7a0b\u68c0\u67e5\u70b9\u548c\u6062\u590d","text":""},{"location":"linux/process_snapshot.html#bclr","title":"BCLR","text":"<p>Berkeley Lab Checkpoint/Restart</p> <p>\u7528\u6237\u6001\u7684libcr\u5e93\u548ckernel module\u6765\u5b8c\u6210\u76f8\u5173\u7684Checkpoint/Restart\u5de5\u4f5c\u3002\u6700\u65b0\u7248\u672c0.8.5\uff0c2013\u5e74\u3002</p>"},{"location":"linux/process_snapshot.html#criu","title":"CRIU","text":"<p>CheckPoint/Restart in user space\uff0c\u5728\u7528\u6237\u6001\u5b9e\u73b0\u8fdb\u7a0b\u7684Checkpoint/Restart\u3002</p> <p>\u652f\u6301\u76ee\u524d\u4e91\u8ba1\u7b97\u9886\u57df\u6700\u706b\u7684docker\u5bb9\u5668\u7684c/r\uff1b</p> <p>\u51bb\u7ed3\u4e00\u4e2a\u6b63\u5728\u8fd0\u884c\u7684\u7a0b\u5e8f\uff0c\u5e76\u4e14checkpoint\u5b83\u5230\u4e00\u7cfb\u5217\u7684\u6587\u4ef6\uff0c\u7136\u540e\u4f60\u5c31\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e9b\u6587\u4ef6\u5728\u4efb\u4f55\u4e3b\u673a\u91cd\u65b0\u6062\u590d\u8fd9\u4e2a\u7a0b\u5e8f\u5230\u88ab\u51bb\u7ed3\u7684\u90a3\u4e2a\u70b9(\u767d\u8bdd\u5c31\u662f\u5b9e\u73b0\u5bf9\u5df2\u8fd0\u884c\u7a0b\u5e8f\u7684\u5907\u4efd\u548c\u6062\u590d)\u3002\u6240\u4ee5criu\u901a\u5e38\u88ab\u7528\u5728\u7a0b\u5e8f\u6216\u8005\u5bb9\u5668\u7684\u70ed\u8fc1\u79fb\u3001\u5feb\u7167\u3001\u8fdc\u7a0b\u8c03\u8bd5\u7b49\u3002</p> <ul> <li>\u70ed\u8fc1\u79fb\uff1a\u7a0b\u5e8f\u7684\u70ed\u8fc1\u79fb\uff1b</li> <li>\u4ee3\u7801\u52a8\u6001\u6ce8\u5165\uff1a\u6267\u884c\u4e00\u4e9b\u4ee3\u7801\u53bb\u6355\u83b7\u5f53\u524d\u8fdb\u7a0b\u76f8\u5173\u4fe1\u606f\uff1b</li> <li>TCP sockets checkpoint-restore\uff1a\u6709\u80fd\u529b\u5728\u4e0d\u7834\u574f\u4e00\u4e2aTCP\u94fe\u63a5\u7684\u60c5\u51b5\u4e0b\uff0c\u5907\u4efd\u548c\u6062\u590d\u5b83\u7684\u72b6\u6001\u3002</li> </ul>"},{"location":"linux/shell_programming.html","title":"Shell \u7f16\u7a0b","text":"<p>I/O\u6807\u8bc6\u4e3a\u6807\u51c6\u8f93\u51650\uff0c\u6807\u51c6\u8f93\u51fa1\uff0c\u6807\u51c6\u9519\u8bef2\uff1b &gt; \u91cd\u5b9a\u5411\u8f93\u51fa\uff0c &gt;&gt; \u9644\u52a0\u5185\u5bb9\uff1b</p>"},{"location":"linux/shell_programming.html#bashsourceexec","title":"bash\uff0csource\uff0cexec","text":"<ul> <li>bash\u6267\u884cshell\u811a\u672c\uff0c\u4ea7\u751fsub shell\uff08\u5373fork\uff0c\u6267\u884c\u4ea7\u751f\u65b0\u7684\u5b50\u8fdb\u7a0b\uff0c\u6267\u884c\u5b8c\u540e\u8fd4\u56de\u5230\u7236\u8fdb\u7a0b\uff09\u6267\u884c\uff0c\u6267\u884c\u5b8c\u540e\u4e0d\u4fdd\u7559\u5b50\u8fdb\u7a0b\u7684\u4fe1\u606f\uff1b</li> <li>source\u6267\u884cshell\u811a\u672c\uff0c\u5728\u5f53\u524dshell\u73af\u5883\u4e2d\u6267\u884c\uff1b</li> <li>exec \u6267\u884c\u4e0d\u4ea7\u751f\u65b0\u7684\u5b50\u8fdb\u7a0b\uff0c\u4f46\u662f\u4f1a\u66ff\u6362\u5f53\u524d\u7684shell\uff0c\u6267\u884c\u5b8c\u5173\u95ed\uff08\u4e00\u822c\u5c06exec\u653e\u5230shell\u811a\u672c\u4e2d\uff09\uff0c\u5373exec\u540e\u9762\u7684\u811a\u672c\u4e0d\u4f1a\u6267\u884c\uff1b</li> </ul> <p>sh \u53c2\u6570\uff1a -n \u53ea\u68c0\u67e5\u8bed\u6cd5\u9519\u8bef\uff0c\u4e0d\u6267\u884c\u811a\u672c\uff1b -v \u8fd0\u884c\u547d\u4ee4\u524d\u5148\u663e\u793a\u547d\u4ee4\uff1b -x \u5904\u7406\u547d\u4ee4\u540e\u663e\u793a\u547d\u4ee4</p> <ul> <li>-e \uff1a\u5982\u679c\u67d0\u4e2a\u6307\u4ee4\u7684\u6267\u884c\u8fd4\u56de\u975e0\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\uff0c\u4e0d\u9700\u8981\u901a\u8fc7 <code>$?</code>\u5224\u65ad\u8fd4\u56de\u503c</li> <li>\u6ce8\u610f\u8ddf grep \u7684\u914d\u5408\uff08grep\u5339\u914d\u4e0d\u5230\u5219\u8fd4\u56de\u975e0\uff09\uff0c\u53ef\u4ee5\u7528 <code>$(ps -ef | { grep \"\u8fdb\u7a0b\u6807\u8bc6\" || true; })</code></li> </ul>"},{"location":"linux/shell_programming.html#_1","title":"<code>${}, $()</code>","text":"<p>\u5728bash\u4e2d\uff0c<code>$( )</code>\u4e0e` `\uff08\u53cd\u5f15\u53f7\uff09\u90fd\u662f\u7528\u6765\u4f5c\u547d\u4ee4\u66ff\u6362\u7684\u3002</p> <p><code>$var</code>\u4e0e<code>${var}</code>\u662f\u6ca1\u6709\u533a\u522b\u7684\uff0c\u4f46\u662f\u7528<code>${ }</code>\u4f1a\u6bd4\u8f83\u7cbe\u786e\u7684\u754c\u5b9a\u53d8\u91cf\u540d\u79f0\u7684\u8303\u56f4</p> <pre><code>PKG_DIR=$(ls)\nfor apiName in ${PKG_DIR[*]} ; do echo $apiName; done\nfor apiName in ${PKG_DIR} ; do echo $apiName; done\n</code></pre>"},{"location":"linux/shell_programming.html#_2","title":"\u57fa\u672c\u8bed\u6cd5","text":""},{"location":"linux/shell_programming.html#set","title":"Set","text":"<pre><code># \u8868\u793a\u4e00\u65e6\u811a\u672c\u4e2d\u6709\u547d\u4ee4\u7684\u8fd4\u56de\u503c\u4e3a\u975e0\uff0c\u5219\u811a\u672c\u7acb\u5373\u9000\u51fa\uff0c\u540e\u7eed\u547d\u4ee4\u4e0d\u518d\u6267\u884c;\nset -e \n# \u4ee5\u8c03\u8bd5\u7684\u5f62\u5f0f\u8fd0\u884c\uff0c\u5373\u4f1a\u6253\u5370\u51fa\u6bcf\u6b21\u6267\u884c\u7684\u8bed\u53e5\nset -x\n# \u8868\u793a\u5728\u7ba1\u9053\u8fde\u63a5\u7684\u547d\u4ee4\u5e8f\u5217\u4e2d\uff0c\u53ea\u8981\u6709\u4efb\u4f55\u4e00\u4e2a\u547d\u4ee4\u8fd4\u56de\u975e0\u503c\uff0c\u5219\u6574\u4e2a\u7ba1\u9053\u8fd4\u56de\u975e0\u503c\uff0c\u5373\u4f7f\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u8fd4\u56de0.\nset -o pipefail \n</code></pre>"},{"location":"linux/shell_programming.html#_3","title":"\u53d8\u91cf","text":"<pre><code>A=\"hello world\"\n</code></pre> <ul> <li>\u7b49\u53f7\u4e24\u8fb9\u4e0d\u80fd\u6709\u7a7a\u683c\uff1b</li> <li><code>readonly</code>\u7528\u4e8e\u5b9a\u4e49\u53ea\u8bfb\u53d8\u91cf\uff1b</li> </ul>"},{"location":"linux/shell_programming.html#for","title":"for","text":"<pre><code>for var in value_list ; do\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0...\ndone\n</code></pre> <p>\u6ce8\u610f\uff1a</p> <pre><code>for line in `cat file`; do done\n</code></pre> <p>\u7528\u6cd5\uff0cfile \u4e2d\u7684\u7a7a\u683c\u4f1a\u88ab\u5f53\u6210\u884c\u5206\u9694\u7b26\uff0c\u9700\u8981\u6307\u5b9a <code>IFS=$'\\n'</code> \u624d\u53ef\u4ee5\u6b63\u5e38\u5206\u884c</p>"},{"location":"linux/shell_programming.html#while","title":"while","text":"<p>read line \u8bfb\u53d6\u65f6\uff0c\u5982\u679c\u6700\u540e\u4e00\u884c\u6ca1\u6709\u6362\u884c\u7b26\u5219\u65e0\u6cd5\u8bfb\u53d6\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u5f62\u5f0f</p> <pre><code>while read line || [ -n $line ]\ndo\ndone &lt; a.txt\n</code></pre> <pre><code>while true\ndo\n    command\ndone\n\nwhile true; do $command; done;\n\n# \u7b49\u4ef7\u4e8e\nfor (( ; ; ))\n</code></pre>"},{"location":"linux/shell_programming.html#if","title":"if","text":"<pre><code>if condition_judgement ; then \n... \nelif condition2; then \n... \nelse \n... \nfi\n</code></pre>"},{"location":"linux/shell_programming.html#case","title":"case","text":"<pre><code>case experssion in\npattern1)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0...;;\npattern2)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0...;;\n*)\n   ...;;\nesac\n</code></pre>"},{"location":"linux/shell_programming.html#_4","title":"\u6570\u7ec4","text":"<pre><code>array_name=(value1 ... valuen)\n</code></pre>"},{"location":"linux/shell_programming.html#_5","title":"\u53c2\u6570","text":"<ul> <li><code>$?</code> : \u524d\u4e00\u4e2a\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\uff0c\u6b63\u5e380\uff0c\u5f02\u5e38\u975e0\uff1b</li> <li><code>$#</code> : \u811a\u672c\u6216\u51fd\u6570\u7684\u53c2\u6570\u4e2a\u6570\uff1b $$ : Shell\u672c\u8eab\u7684PID</li> <li><code>$0</code> : \u811a\u672c\u540d\u79f0\uff1b <code>$1, $2 \u2026</code>\uff1a \u811a\u672c\u6216\u51fd\u6570\u7684\u4f4d\u7f6e\u53c2\u6570\uff1b</li> <li><code>$*</code> : \u4ee5 <code>$1 $2 \u2026</code> \u4fdd\u5b58\u7528\u6237\u4f20\u5165\u7684\u4f4d\u7f6e\u53c2\u6570\uff1b<code>$@</code> : \u4ee5 <code>$1</code> <code>$2 \u2026</code>$n` \u5f62\u5f0f\u4fdd\u5b58\u4f4d\u7f6e\u53c2\u6570</li> </ul>"},{"location":"linux/shell_programming.html#_6","title":"\u8fd0\u7b97","text":"<pre><code># \u6574\u5f62\u8fd0\u7b97\uff1a \n((a=$j+$k))  #\u6216 \nlet a+= 1 #\u6216 \na=`expr $a + 1` #\uff08\u52a0\u53f7\u4e24\u8fb9\u6709\u7a7a\u683c\uff09\uff0c\n((i=$j*$k)) #\u7b49\u4ef7 \ni=`expr $j \\* $k`  \n((i=$j\\$k))  #\u7b49\u4ef7\ni=`expr $j /$ $k`  \n\necho $(($j + $k)\n</code></pre>"},{"location":"linux/shell_programming.html#_7","title":"\u51fd\u6570","text":"<pre><code># \u5148\u5b9a\u4e49\uff0c\u518d\u4f7f\u7528\uff08\u65e0\u62ec\u53f7\uff0c\u53c2\u6570\u52a0\u7a7a\u683c\uff09  function_name arg_a arg_b\nfunction_name() { \n       ...  # \u51fd\u6570\u53c2\u6570\u540c\u811a\u672c\uff0c\u901a\u8fc7$1\uff0c$2\u8868\u793a\n}   \n# \u51fd\u6570\u7ed3\u5c3e\u53ef\u4ee5\u7528return\u8bed\u53e5\u8fd4\u56de\u6267\u884c\u72b6\u6001\uff0c0\u8868\u793a\u65e0\u9519\u8bef\uff1b\n# \u51fd\u6570\u9ed8\u8ba4\u662f\u5c06\u6807\u51c6\u8f93\u51fa\u4f20\u9012\u51fa\u6765\uff0c\u4e0d\u662f\u8fd4\u56de\u503c\uff1b\u6216\u8005\u4f7f\u7528\u5168\u5c40\u53d8\u91cf\n</code></pre>"},{"location":"linux/shell_programming.html#_8","title":"\u6bd4\u8f83","text":"<p>test\u7528\u6765\u6bd4\u8f83\u6570\u5b57\u3001\u5b57\u7b26\u4e32\u3001\u6587\u4ef6\u72b6\u6001\u68c0\u67e5\u3001\u903b\u8f91\u5224()\u65ad\u7b49\uff0ctest condition \u6216 [ condition ]\uff0c\u4e24\u8fb9\u6709\u7a7a\u683c\uff0c\u6761\u4ef6\u6210\u7acb\u8fd4\u56de0\uff0c\u5426\u5219\u975e0</p> <ul> <li>\u5b57\u7b26\u4e32\uff1a == \u6216= , != , -z (\u7a7a), -n(\u975e\u7a7a) \uff1b</li> <li>\u6574\u578b\uff1a -eq , -ne , -gt , -ge , -lt , -le \uff1b</li> <li>\u903b\u8f91\u4e0e\uff08-a)\u6216\uff08-o\uff09\u975e\uff08!\uff09\uff1b</li> <li>\u5728[]\u4e2d\u4f7f\u7528==\u662fbash\u91cc\u7684\u505a\u6cd5, \u4e0d\u7b26\u5408posix\u6807\u51c6\uff1b</li> <li>=~ \u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d</li> <li>${} \u53d8\u91cf\uff0c\u6216\u8005\u6267\u884c\u547d\u4ee4\uff1b</li> </ul> <p>\u6587\u4ef6\u76f8\u5173\u5224\u65ad\uff1a</p> <ul> <li><code>-a</code>\uff1aFILE\u662f\u6587\u4ef6\u5b58\u5728\u5219\u4e3a\u771f\uff1b</li> <li><code>-d</code>\uff1aFILE\u662f\u76ee\u5f55\u5b58\u5728\u5219\u4e3a\u771f\uff1b</li> <li><code>-e</code>\uff1aFILE\u5b58\u5728\u5219\u4e3a\u771f\uff1b</li> </ul>"},{"location":"linux/shell_programming.html#_9","title":"\u53c2\u6570\u83b7\u53d6","text":"<p>\u5173\u4e8e\u53c2\u6570\u7684\u5185\u7f6e\u53d8\u91cf</p> <ul> <li>$# : \u811a\u672c\u6216\u51fd\u6570\u7684\u53c2\u6570\u4e2a\u6570\uff1b</li> <li>$$ : Shell\u672c\u8eab\u7684PID</li> <li>\\(0** : \u811a\u672c\u540d\u79f0\uff1b **\\)1, $2 \u2026 \uff1a \u811a\u672c\u6216\u51fd\u6570\u7684\u4f4d\u7f6e\u53c2\u6570\uff1b</li> </ul> <p>\u5bf9\u4e8e\u547d\u540d\u7684\u53c2\u6570\u83b7\u53d6\uff1agetopt</p> <p>getopt\u547d\u4ee4\u4e0d\u662f\u4e00\u4e2a\u6807\u51c6\u7684unix\u547d\u4ee4\uff0c\u4f46\u5b83\u5728\u5927\u591a\u6570Linux\u7684\u53d1\u884c\u7248\u4e2d\u90fd\u81ea\u5e26\u4e86\u6709\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u4e5f\u53ef\u4ee5\u4ecegetopt\u5b98\u7f51\u4e0a\u4e0b\u8f7d\u5b89\u88c5\u3002</p> <pre><code>ARGS=`getopt -o ab:c:: --long along,blong:,clong:: -n 'example.sh' -- \"$@\"`\n</code></pre> <ul> <li> <p>-o\u6216--options\u9009\u9879\u540e\u9762\u63a5\u53ef\u63a5\u53d7\u7684\u77ed\u9009\u9879\uff0c\u5982ab:c::\uff0c\u8868\u793a\u53ef\u63a5\u53d7\u7684\u77ed\u9009\u9879\u4e3a-a -b -c\uff0c\u5176\u4e2d-a\u9009\u9879\u4e0d\u63a5\u53c2\u6570\uff0c-b\u9009\u9879\u540e\u5fc5\u987b\u63a5\u53c2\u6570\uff0c-c\u9009\u9879\u7684\u53c2\u6570\u4e3a\u53ef\u9009\u7684\uff1b</p> </li> <li> <p>-l\u6216--long\u9009\u9879\u540e\u9762\u63a5\u53ef\u63a5\u53d7\u7684\u957f\u9009\u9879\uff0c\u7528\u9017\u53f7\u5206\u5f00\uff0c\u5192\u53f7\u7684\u610f\u4e49\u540c\u77ed\u9009\u9879\u3002</p> </li> </ul> <p>\u793a\u4f8b\uff1a</p> <pre><code># /bin/bash\n\nshow_usage(){\n    msg=\"Generate git two commits diff files, echo modified file with a diff file.\\n\\\nusage: \\n\\\n-b,--begin-commit-id: begin commit id(inclusive) \\n\\\n-e,--end-comiti-d: end commit id(inclusive) \\n\\\n-h,--help\"\n    echo -e $msg\n}\n\n# \u89e3\u6790\u547d\u4ee4\nARGS=`getopt -o b:e:h -l begin-commit-id:,end-comiti-id:,help -- \"$@\"`\nif [ $? != 0 ]; then\n    echo \"Error: args is not valid, use -h to show usage help!\"\n    exit -1\nfi\n\n# \u5c06\u89c4\u8303\u5316\u540e\u7684\u547d\u4ee4\u884c\u53c2\u6570\u5206\u914d\u81f3\u4f4d\u7f6e\u53c2\u6570\uff08$1,$2,...)\neval set -- \"${ARGS}\"\n\nbegin_commit_id=\"\"\nend_commit_id=\"\"\n\nwhile [ -n \"$1\" ]\ndo\n        case \"$1\" in\n            -b|--begin-commit-id)\n                begin_commit_id=$2\n                shift 2\n                ;;\n            -e|--end-commit-id)\n                end_commit_id=$2\n                shift 2\n                ;;\n            -h|--help)\n                show_usage\n                shift\n                ;;\n            --)\n                break\n                ;;\n            *)\n                echo \"unknown args $1\"\n                exit -1\n                ;;\n        esac\ndone\n\ndiff_files=$(git diff ${begin_commit_id} ${end_commit_id} --name-only)\n\nif [[ -z $begin_commit_id || -z $end_commit_id ]]; then\n    echo $show_usage\n    exit -1\nfi\n</code></pre>"},{"location":"linux/systemctl.html","title":"Systemctl","text":""},{"location":"linux/systemctl.html#service","title":"Service","text":"<p>service\u547d\u4ee4\u5176\u5b9e\u662f\u53bb/etc/init.d\u76ee\u5f55\u4e0b\uff0c\u53bb\u6267\u884c\u76f8\u5173\u7a0b\u5e8f</p> <pre><code># service\u547d\u4ee4\u542f\u52a8redis\u811a\u672c\nservice redis start\n# \u76f4\u63a5\u542f\u52a8redis\u811a\u672c\n/etc/init.d/redis start\n# \u5f00\u673a\u81ea\u542f\u52a8\nupdate-rc.d redis defaults\n</code></pre>"},{"location":"linux/systemctl.html#systemctl_1","title":"Systemctl","text":"<p><code>systemd</code>\u662fLinux\u7cfb\u7edf\u6700\u65b0\u7684\u521d\u59cb\u5316\u7cfb\u7edf(init)\uff0c\u4f5c\u7528\u662f\u63d0\u9ad8\u7cfb\u7edf\u7684\u542f\u52a8\u901f\u5ea6\uff0c\u5c3d\u53ef\u80fd\u542f\u52a8\u8f83\u5c11\u7684\u8fdb\u7a0b\uff0c\u5c3d\u53ef\u80fd\u66f4\u591a\u8fdb\u7a0b\u5e76\u53d1\u542f\u52a8\u3002</p> <p><code>systemd</code>\u5bf9\u5e94\u7684\u8fdb\u7a0b\u7ba1\u7406\u547d\u4ee4\u662f<code>systemctl</code>\u3002</p> <ol> <li>systemctl\u547d\u4ee4\u517c\u5bb9\u4e86service</li> <li>\u5373 <code>systemctl</code> \u4e5f\u4f1a\u53bb<code>/etc/init.d</code>\u76ee\u5f55\u4e0b\uff0c\u67e5\u770b\uff0c\u6267\u884c\u76f8\u5173\u7a0b\u5e8f</li> <li>systemctl\u547d\u4ee4\u7ba1\u7406systemd\u7684\u8d44\u6e90Unit</li> </ol> <p>\u547d\u4ee4\u5f62\u5f0f\uff1a</p> <pre><code>$ systemctl [command] [unit]\n</code></pre> <p>command \u4e3b\u8981\u6709\uff1a</p> <ul> <li>start\uff1a\u7acb\u523b\u542f\u52a8\u540e\u9762\u63a5\u7684 unit\u3002</li> <li>stop\uff1a\u7acb\u523b\u5173\u95ed\u540e\u9762\u63a5\u7684 unit\u3002</li> <li>restart\uff1a\u7acb\u523b\u5173\u95ed\u540e\u542f\u52a8\u540e\u9762\u63a5\u7684 unit\uff0c\u4ea6\u5373\u6267\u884c stop \u518d start \u7684\u610f\u601d\u3002</li> <li>reload\uff1a\u4e0d\u5173\u95ed unit \u7684\u60c5\u51b5\u4e0b\uff0c\u91cd\u65b0\u8f7d\u5165\u914d\u7f6e\u6587\u4ef6\uff0c\u8ba9\u8bbe\u7f6e\u751f\u6548\u3002</li> <li>enable\uff1a\u8bbe\u7f6e\u4e0b\u6b21\u5f00\u673a\u65f6\uff0c\u540e\u9762\u63a5\u7684 unit \u4f1a\u88ab\u542f\u52a8\u3002</li> <li>disable\uff1a\u8bbe\u7f6e\u4e0b\u6b21\u5f00\u673a\u65f6\uff0c\u540e\u9762\u63a5\u7684 unit \u4e0d\u4f1a\u88ab\u542f\u52a8\u3002</li> <li>status\uff1a\u76ee\u524d\u540e\u9762\u63a5\u7684\u8fd9\u4e2a unit \u7684\u72b6\u6001\uff0c\u4f1a\u5217\u51fa\u6709\u6ca1\u6709\u6b63\u5728\u6267\u884c\u3001\u5f00\u673a\u65f6\u662f\u5426\u542f\u52a8\u7b49\u4fe1\u606f\u3002</li> <li>is-active\uff1a\u76ee\u524d\u6709\u6ca1\u6709\u6b63\u5728\u8fd0\u884c\u4e2d\u3002</li> <li>is-enable\uff1a\u5f00\u673a\u65f6\u6709\u6ca1\u6709\u9ed8\u8ba4\u8981\u542f\u7528\u8fd9\u4e2a unit\u3002</li> <li>kill \uff1a\u4e0d\u8981\u88ab kill \u8fd9\u4e2a\u540d\u5b57\u5413\u7740\u4e86\uff0c\u5b83\u5176\u5b9e\u662f\u5411\u8fd0\u884c unit \u7684\u8fdb\u7a0b\u53d1\u9001\u4fe1\u53f7\u3002</li> <li>show\uff1a\u5217\u51fa unit \u7684\u914d\u7f6e\u3002</li> <li>mask\uff1a\u6ce8\u9500 unit\uff0c\u6ce8\u9500\u540e\u4f60\u5c31\u65e0\u6cd5\u542f\u52a8\u8fd9\u4e2a unit \u4e86\u3002</li> <li>unmask\uff1a\u53d6\u6d88\u5bf9 unit \u7684\u6ce8\u9500\u3002</li> </ul>"},{"location":"linux/systemctl.html#mount","title":".mount","text":"<p>[Mount] \u8282\u70b9\u91cc\u914d\u7f6e\u4e86 What,Where,Type\uff0c\u7b49\u540c\u4e8e\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code># What=hugentlbfs WHere=/dev/hugepages Type=hugetlbfs\nmount -t hugetlbfs /dev/hugepages hugetlbfs\n</code></pre>"},{"location":"linux/systemctl.html#service_1","title":".service","text":"<pre><code>[Unit]\n# \u63cf\u8ff0\nDescription=nginx\n# \u4f9d\u8d56\u7684\u670d\u52a1\nAfter=network.target\n\n[Service]\n# \u5982\u679c\u670d\u52a1\u7a0b\u5e8f\u542f\u52a8\u540e\u4f1a\u901a\u8fc7 fork \u7cfb\u7edf\u8c03\u7528\u521b\u5efa\u5b50\u8fdb\u7a0b\uff0c\u7136\u540e\u5173\u95ed\u5e94\u7528\u7a0b\u5e8f\u672c\u8eab\u8fdb\u7a0b\u7684\u60c5\u51b5\uff0c\u5219\u5e94\u8be5\u5c06 Type \u7684\u503c\u8bbe\u7f6e\u4e3a forking\nType=forking \nExecStart=/usr/local/nginx/sbin/nginx \nExecReload=/usr/local/nginx/sbin/nginx -s reload \nExecStop=/usr/local/nginx/sbin/nginx -s quit\n# \u6307\u5b9a\u5728\u4ec0\u4e48\u60c5\u51b5\u4e0b\u9700\u8981\u91cd\u542f\u670d\u52a1\u8fdb\u7a0b\u3002\u5e38\u7528\u7684\u503c\u6709 no\uff0con-success\uff0con-failure\uff0con-abnormal\uff0con-abort \u548c always\nRestart=no\n# \u6307\u5b9a\u8fd0\u884c\u670d\u52a1\u7684\u7528\u6237\uff0c\u4f1a\u5f71\u54cd\u670d\u52a1\u5bf9\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u7684\u8bbf\u95ee\u6743\u9650\u3002\nUser=dev\n# \u662f\u5426\u7ed9\u670d\u52a1\u5206\u914d\u72ec\u7acb\u7684\u4e34\u65f6\u7a7a\u95f4\uff08true/false\uff09\nPrivateTmp=true \n\n[Install] \n# \u5f53\u7cfb\u7edf\u4ee5\u591a\u7528\u6237\u65b9\u5f0f\uff08\u9ed8\u8ba4\u7684\u8fd0\u884c\u7ea7\u522b\uff09\u542f\u52a8\u65f6\uff0c\u8fd9\u4e2a\u670d\u52a1\u9700\u8981\u88ab\u81ea\u52a8\u8fd0\u884c\u3002\nWantedBy=multi-user.target\n</code></pre>"},{"location":"linux/systemctl.html#target","title":".target","text":"<p>\u5b9a\u4e49\u4e86\u4e00\u4e9b\u57fa\u7840\u7684\u7ec4\u4ef6\uff0c\u4f9b.service\u6587\u4ef6\u8c03\u7528</p>"},{"location":"linux/systemctl.html#wants","title":".wants","text":"<p>.wants\u6587\u4ef6\u5b9a\u4e49\u4e86\u8981\u6267\u884c\u7684\u6587\u4ef6\u96c6\u5408\uff0c\u6bcf\u6b21\u6267\u884c\uff0c.wants\u6587\u4ef6\u5939\u91cc\u9762\u7684\u6587\u4ef6\u90fd\u4f1a\u6267\u884c</p>"},{"location":"linux/tuning.html","title":"\u5de5\u5177\u547d\u4ee4","text":""},{"location":"linux/tuning.html#dmesg","title":"dmesg","text":"<p>\u8f93\u51fa\u7cfb\u7edf\u65e5\u5fd7</p>"},{"location":"linux/tuning.html#vmstat","title":"vmstat","text":"<p><code>vmstat [sample_interval] [sample_nums]</code>\u547d\u4ee4\uff1a\u5c55\u73b0\u7ed9\u5b9a\u65f6\u95f4\u95f4\u9694\u7684\u670d\u52a1\u5668\u7684\u72b6\u6001\u503c,\u5305\u62ec\u670d\u52a1\u5668\u7684CPU\u4f7f\u7528\u7387\uff0c\u5185\u5b58\u4f7f\u7528\uff0c\u865a\u62df\u5185\u5b58\u4ea4\u6362\u60c5\u51b5,IO\u8bfb\u5199\u60c5\u51b5\u3002</p> <p>\u8f93\u51fa\u4e00\u4e9b\u7cfb\u7edf\u6838\u5fc3\u6307\u6807</p> <pre><code>$ vmstat 1\nprocs -----------memory------------    ---swap--   -----io---- -system-- ------cpu-----\n r  b   swpd   free   buff    cache      si   so    bi    bo   in   cs   us sy id wa st\n 0  0      0 74551216 648880 11258740    0    0     0     1    1    0    0  0  99  0  0\n</code></pre> <ul> <li>r\uff1a\u7b49\u5f85\u5728CPU\u8d44\u6e90\u7684\u8fdb\u7a0b\u6570\uff1b</li> <li>si\uff0cso\uff1a\u4ea4\u6362\u533a\u5199\u5165\u548c\u8bfb\u53d6\u7684\u6570\u91cf\u3002\u5982\u679c\u8fd9\u4e2a\u6570\u636e\u4e0d\u4e3a0\uff0c\u8bf4\u660e\u7cfb\u7edf\u5df2\u7ecf\u5728\u4f7f\u7528\u4ea4\u6362\u533a\uff08swap\uff09\uff0c\u673a\u5668\u7269\u7406\u5185\u5b58\u5df2\u7ecf\u4e0d\u8db3\uff1b</li> <li>cs\uff08context switch\uff09\u4e00\u5217\u5219\u4ee3\u8868\u4e86\u4e0a\u4e0b\u6587\u5207\u6362\u7684\u6b21\u6570\uff0cin\uff08interrupt\uff09\u6bcf\u79d2\u4e2d\u65ad\u6570\uff0c\u5305\u62ec\u65f6\u949f\u4e2d\u65ad\uff1b</li> <li>us, sy, id, wa, st\uff1a\u4ee3\u8868CPU\u65f6\u95f4\u7684\u6d88\u8017\uff0c\u5206\u522b\u8868\u793a\u7528\u6237\u65f6\u95f4\uff08user\uff09\u3001\u7cfb\u7edf\uff08\u5185\u6838\uff09\u65f6\u95f4\uff08sys\uff09\u3001\u7a7a\u95f2\u65f6\u95f4\uff08idle\uff09\u3001IO\u7b49\u5f85\u65f6\u95f4\uff08wait\uff09\u548c\u88ab\u5077\u8d70\u7684\u65f6\u95f4\uff08stolen\uff0c\u4e00\u822c\u88ab\u5176\u4ed6\u865a\u62df\u673a\u6d88\u8017\uff09\uff1b</li> </ul>"},{"location":"linux/tuning.html#sysstat","title":"sysstat\u5de5\u5177\u5305","text":""},{"location":"linux/tuning.html#pidstat","title":"pidstat","text":"<p>pidstat\u662fsysstat\u5de5\u5177\u7684\u4e00\u4e2a\u547d\u4ee4\uff0c\u7528\u4e8e\u76d1\u63a7\u5168\u90e8\u6216\u6307\u5b9a\u8fdb\u7a0b\u7684cpu\u3001\u5185\u5b58\u3001\u7ebf\u7a0b\u3001\u8bbe\u5907IO\u7b49\u7cfb\u7edf\u8d44\u6e90\u7684\u5360\u7528\u60c5\u51b5\u3002</p> <p><code>pidstat [ \u9009\u9879 ] [ &lt;\u65f6\u95f4\u95f4\u9694&gt; ] [ &lt;\u6b21\u6570&gt; ]</code></p> <ul> <li>-u\uff1a\u9ed8\u8ba4\u7684\u53c2\u6570\uff0c\u663e\u793a\u5404\u4e2a\u8fdb\u7a0b\u7684cpu\u4f7f\u7528\u7edf\u8ba1</li> <li>-r\uff1a\u663e\u793a\u5404\u4e2a\u8fdb\u7a0b\u7684\u5185\u5b58\u4f7f\u7528\u7edf\u8ba1</li> <li>-d\uff1a\u663e\u793a\u5404\u4e2a\u8fdb\u7a0b\u7684IO\u4f7f\u7528\u60c5\u51b5</li> <li>-p\uff1a\u6307\u5b9a\u8fdb\u7a0b\u53f7</li> <li>-w\uff1a\u663e\u793a\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u4e0a\u4e0b\u6587\u5207\u6362\u60c5\u51b5</li> <li>-t\uff1a\u663e\u793a\u9009\u62e9\u4efb\u52a1\u7684\u7ebf\u7a0b\u7684\u7edf\u8ba1\u4fe1\u606f\u5916\u7684\u989d\u5916\u4fe1\u606f</li> </ul>"},{"location":"linux/tuning.html#iostat","title":"iostat","text":"<p>\u67e5\u770b\u673a\u5668\u78c1\u76d8IO\u60c5\u51b5</p> <pre><code>$ iostat -xz 1\nLinux 3.10.0-862.el7.x86_64 (work02)    06/20/2022      _x86_64_        (40 CPU)\n\navg-cpu:  %user   %nice %system %iowait  %steal   %idle\n           0.23    0.00    0.36    0.01    0.00   99.40\n\nDevice:         rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util\nsdc               0.00     0.23    0.19    0.38     2.10     4.12    21.67     0.01   12.81    1.63   18.33   7.11   0.41\nsda               0.00     0.07    0.03    1.32     0.68    42.99    64.74     0.01   11.06    0.36   11.30   0.13   0.02\nsdb               0.00     0.00    0.00    0.00     0.00     0.00    33.28     0.00    0.23    0.23    0.00   0.18   0.00\nsdd               0.00     0.00    0.00    0.00     0.00     0.00    33.47     0.00    1.76    1.76    0.00   1.32   0.00\ndm-0              0.00     0.00    0.03    1.39     0.67    42.99    61.42     0.02   10.75    0.36   10.97   0.12   0.02\ndm-1              0.00     0.00    0.00    0.00     0.00     0.00    47.65     0.00    0.74    0.74    0.00   0.49   0.00\ndm-2              0.00     0.00    0.00    0.00     0.00     0.00    48.19     0.00    0.09    0.09    0.00   0.07   0.00\n</code></pre> <ul> <li>r/s, w/s, rkB/s, wkB/s\uff1a\u5206\u522b\u8868\u793a\u6bcf\u79d2\u8bfb\u5199\u6b21\u6570\u548c\u6bcf\u79d2\u8bfb\u5199\u6570\u636e\u91cf\uff08\u5343\u5b57\u8282\uff09\u3002\u8bfb\u5199\u91cf\u8fc7\u5927\uff0c\u53ef\u80fd\u4f1a\u5f15\u8d77\u6027\u80fd\u95ee\u9898\u3002</li> <li>avgqu-sz\uff1a\u5411\u8bbe\u5907\u53d1\u51fa\u7684\u8bf7\u6c42\u5e73\u5747\u6570\u91cf\u3002\u5982\u679c\u8fd9\u4e2a\u6570\u503c\u5927\u4e8e1\uff0c\u53ef\u80fd\u662f\u786c\u4ef6\u8bbe\u5907\u5df2\u7ecf\u9971\u548c\uff08\u90e8\u5206\u524d\u7aef\u786c\u4ef6\u8bbe\u5907\u652f\u6301\u5e76\u884c\u5199\u5165\uff09\u3002</li> <li>%util\uff1a\u8bbe\u5907\u5229\u7528\u7387\u3002\u8fd9\u4e2a\u6570\u503c\u8868\u793a\u8bbe\u5907\u7684\u7e41\u5fd9\u7a0b\u5ea6\uff0c\u7ecf\u9a8c\u503c\u662f\u5982\u679c\u8d85\u8fc760\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cdIO\u6027\u80fd\uff08\u53ef\u4ee5\u53c2\u7167IO\u64cd\u4f5c\u5e73\u5747\u7b49\u5f85\u65f6\u95f4\uff09\u3002\u5982\u679c\u5230\u8fbe100%\uff0c\u8bf4\u660e\u786c\u4ef6\u8bbe\u5907\u5df2\u7ecf\u9971\u548c\u3002</li> </ul>"},{"location":"linux/tuning.html#sar","title":"sar","text":"<p>\u53ef\u4ee5\u67e5\u770bCPU\uff0c\u5185\u5b58\uff0c\u7f51\u7edc\uff0c\u7f51\u53e3\uff0c\u78c1\u76d8\uff0cSWAP\u7b49\u3002</p>"},{"location":"linux/tuning.html#_2","title":"\u7f51\u53e3","text":"<p>\u67e5\u770b\u7f51\u7edc\u8bbe\u5907\u7684\u541e\u5410\u7387\u3002\u5728\u6392\u67e5\u6027\u80fd\u95ee\u9898\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u8bbe\u5907\u7684\u541e\u5410\u91cf\uff0c\u5224\u65ad\u7f51\u7edc\u8bbe\u5907\u662f\u5426\u5df2\u7ecf\u9971\u548c\u3002</p> <ul> <li>rxpck/s  \u6bcf\u79d2\u949f\u63a5\u53d7\u7684\u6570\u636e\u5305</li> <li>txpck/s  \u6bcf\u79d2\u949f\u53d1\u9001\u7684\u6570\u636e\u5e93</li> <li>rxKB/S  \u6bcf\u79d2\u949f\u63a5\u53d7\u7684\u6570\u636e\u5305\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3aKB</li> <li>txKB/S  \u6bcf\u79d2\u949f\u53d1\u9001\u7684\u6570\u636e\u5305\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3aKB</li> <li>rxcmp/s  \u6bcf\u79d2\u949f\u63a5\u53d7\u7684\u538b\u7f29\u6570\u636e\u5305</li> <li>txcmp/s  \u6bcf\u79d2\u949f\u53d1\u9001\u7684\u538b\u7f29\u5305</li> <li>rxmcst/s  \u6bcf\u79d2\u949f\u63a5\u6536\u7684\u591a\u64ad\u6570\u636e\u5305  </li> </ul> <pre><code>$ sar -n DEV 1\nLinux 3.10.0-862.el7.x86_64 (work02)    06/20/2022      _x86_64_        (40 CPU)\n\n05:00:39 PM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s\n05:00:40 PM        lo     10.00     10.00      0.79      0.79      0.00      0.00      0.00\n05:00:40 PM       em2      0.00      0.00      0.00      0.00      0.00      0.00      0.00\n05:00:40 PM       em4      0.00      0.00      0.00      0.00      0.00      0.00      0.00\n05:00:40 PM       em3     27.00     26.00      3.05      4.03      0.00      0.00      2.00\n05:00:40 PM       em1      0.00      0.00      0.00      0.00      0.00      0.00      0.00\n</code></pre>"},{"location":"linux/tuning.html#tcp","title":"TCP\u7f51\u7edc","text":"<p>\u5224\u65ad\u6027\u80fd\u95ee\u9898\u662f\u5426\u7531\u4e8e\u5efa\u7acb\u4e86\u8fc7\u591a\u7684\u8fde\u63a5\uff0c\u8fdb\u4e00\u6b65\u53ef\u4ee5\u5224\u65ad\u662f\u4e3b\u52a8\u53d1\u8d77\u7684\u8fde\u63a5\uff0c\u8fd8\u662f\u88ab\u52a8\u63a5\u53d7\u7684\u8fde\u63a5\u3002TCP\u91cd\u4f20\u53ef\u80fd\u662f\u56e0\u4e3a\u7f51\u7edc\u73af\u5883\u6076\u52a3\uff0c\u6216\u8005\u670d\u52a1\u5668\u538b\u529b\u8fc7\u5927\u5bfc\u81f4\u4e22\u5305\u3002</p> <p>\u67e5\u770bTCP\u8fde\u63a5\u72b6\u6001\uff0c\u5176\u4e2d\u5305\u62ec\uff1a</p> <ul> <li>active/s\uff1a\u6bcf\u79d2\u672c\u5730\u53d1\u8d77\u7684TCP\u8fde\u63a5\u6570\uff0c\u65e2\u901a\u8fc7connect\u8c03\u7528\u521b\u5efa\u7684TCP\u8fde\u63a5\uff1b</li> <li>passive/s\uff1a\u6bcf\u79d2\u8fdc\u7a0b\u53d1\u8d77\u7684TCP\u8fde\u63a5\u6570\uff0c\u5373\u901a\u8fc7accept\u8c03\u7528\u521b\u5efa\u7684TCP\u8fde\u63a5\uff1b</li> <li>retrans/s\uff1a\u6bcf\u79d2TCP\u91cd\u4f20\u6570\u91cf\uff1b</li> </ul> <pre><code>$ sar -n TCP,ETCP 1\nLinux 3.13.0-49-generic (titanclusters-xxxxx)  07/14/2015    _x86_64_    (32 CPU)\n\n12:17:19 AM  active/s passive/s    iseg/s    oseg/s\n12:17:20 AM      1.00      0.00  10233.00  18846.00\n12:17:19 AM  atmptf/s  estres/s retrans/s isegerr/s   orsts/s\n12:17:20 AM      0.00      0.00      0.00      0.00      0.00\n12:17:20 AM  active/s passive/s    iseg/s    oseg/s\n12:17:21 AM      1.00      0.00   8359.00   6039.00\n12:17:20 AM  atmptf/s  estres/s retrans/s isegerr/s   orsts/s\n12:17:21 AM      0.00      0.00      0.00      0.00      0.00\n</code></pre>"},{"location":"linux/tuning.html#pstack","title":"pstack","text":"<p>\u67e5\u770b\u8fdb\u7a0b\u4e0b\u6240\u6709\u7ebf\u7a0b\u7684\u5806\u6808\u4fe1\u606f</p> <p></p> <p>\u53ef\u4ee5\u67e5\u770b\u7684\u4fe1\u606f\uff1a</p> <ul> <li>\u7ebf\u7a0b\u53f7\uff0cLWP\u53f7\uff1b</li> <li>\u5806\u6808\uff08\u6808\u6df1\u5ea6\u3001\u5185\u5b58\u5730\u5740\u3001\u51fd\u6570\u540d\u3001\u5e93\u540d\uff09</li> </ul>"},{"location":"linux/tuning.html#pstackn","title":"\u901a\u8fc7pstack\u83b7\u53d6\u7b2cN\u53f7\u7ebf\u7a0b\u7684\u8c03\u7528\u6808","text":"<pre><code># \u83b7\u53d6\u7b2cN\u53f7\u7ebf\u7a0b\u5185\u5bb9\nfile=$1\nlwp=$2\necho \"$file - $lwp\"\nfound=0\n\nwhile read line\ndo\nif [[ $found -eq 1 &amp;&amp; $line =~ \"(LWP \" ]]\nthen \n    exit 0\nfi\n\nif [[ $line =~ \"LWP $lwp\" ]]\nthen\n    found=1\nfi\n\nif [[ $found -eq 1 ]]\nthen\n    echo $line\nfi\n\ndone &lt; $file\n</code></pre>"},{"location":"linux/tuning.html#strace","title":"strace","text":"<p>\u793a\u4f8b\uff1a\u8fdb\u7a0b\u4e2d\u7684171264\u7ebf\u7a0b\u8fdb\u884c\u7cfb\u7edf\u8c03\u7528\u8ddf\u8e2a\uff0c \u5c06\u8f93\u51fa\u7684\u4fe1\u606f\u4fdd\u5b58\u5728output.txt\u4e2d</p> <p><code>strace -o output.txt -T -tt -e trace=all -p 171264</code></p> <p></p> <p>\u793a\u4f8b\uff1a\u5047\u8bbe\u9891\u7e41\u7684read/write\uff0c\u5bf9\u5e94fd\u4e3a1901\uff0c\u67e5\u770b<code>/proc/$pid/fd/1901</code>\uff0c\u5982\u679c\u662f\u4e2asocket\u8fde\u63a5\uff0c</p> <pre><code>dr-x------ 2 root root 0 3\u6708 8 16:07 ./\ndr-xr-xr-x 8 root root 0 3\u6708 8 16:07 ../\nlrwx------ 1 root root 64 3\u6708 8 16:08 0 -&gt; /dev/pts/1\nlrwx------ 1 root root 64 3\u6708 8 16:08 1 -&gt; /dev/pts/1\nlrwx------ 1 root root 64 3\u6708 8 16:09 10 -&gt; socket:[21190]\nlrwx------ 1 root root 64 3\u6708 8 16:07 2 -&gt; /dev/pts/1\nlrwx------ 1 root root 64 3\u6708 8 16:08 3 -&gt; /tmp/ZCUDY7QsPB (deleted)\nlrwx------ 1 root root 64 3\u6708 8 16:08 4 -&gt; /tmp/sess_0fpvhvcpftcme834e1l4beo2i6\nlrwx------ 1 root root 64 3\u6708 8 16:08 5 -&gt; socket:[20625]\nlrwx------ 1 root root 64 3\u6708 8 16:08 6 -&gt; anon_inode:[eventpoll]\nlrwx------ 1 root root 64 3\u6708 8 16:08 7 -&gt; socket:[20626]\nlrwx------ 1 root root 64 3\u6708 8 16:08 8 -&gt; socket:[20627]\nlrwx------ 1 root root 64 3\u6708 8 16:09 1901 -&gt; socket:[21189]\n</code></pre> <p>\u5728/proc/net/tcp\u76ee\u5f55\u4e0b\u9762\u4fdd\u5b58\u4e86\u6240\u6709TCP\u94fe\u63a5\u7684\u72b6\u6001\u4fe1\u606f\uff0c\u901a\u8fc7grep\u67e5\u627e\u3002</p> <pre><code>$ grep '21189' /proc/net/tcp\n9: 8064A8C0:0929 0164A8C0:F4B5 01 00000000:00000000 02:00097B3E 00000000 0 0 21189 2 ffff88001a505b00 24 4 28 10 -1\n</code></pre> <p>\u94fe\u63a5\u7684IP\u3001PORT\u94fe\u63a5\u56db\u5143\u7ec4\u30108064A8C0:0929 0164A8C0:F4B5\u3011\u8fd9\u4e2a\u5730\u65b9\u662f\u7528\u5341\u516d\u8fdb\u5236\u4fdd\u5b58\u7684\uff0c\u6362\u7b97\u6210\u5341\u8fdb\u5236\u65b9\u5f0f\u3010192.168.100.128:2345  192.168.100.1:62645\u3011\uff0c\u53ef\u4ee5\u5bf9\u5e94\u67e5\u770b\u7aef\u53e3\u53f7\u670d\u52a1\u662f\u4ec0\u4e48\uff0c\u5224\u65ad\u5361\u987f\u70b9\u3002</p>"},{"location":"linux/tuning.html#kprobe","title":"kprobe","text":"<p>\u5185\u6838\u63d0\u4f9b\u4e86\u4e00\u7ec4\u65b9\u6cd5\uff0c\u4f7f\u7528\u8fd9\u7ec4\u65b9\u6cd5\u53ef\u4ee5\u5728\u5185\u6838\u4efb\u610f\u4e00\u4e2a\u65b9\u6cd5\u4e0a\u52a0\u4e00\u4e2a\u94a9\u5b50\uff0c\u6bcf\u5f53\u5185\u6838\u6267\u884c\u5230\u94a9\u5b50\u7684\u65f6\u5019\uff0c\u5c31\u53ef\u4ee5\u6267\u884c\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u4ee3\u7801\u3002</p> <p>\u53c2\u8003\uff1a</p> <ol> <li>Linux\u5185\u6838\u8c03\u8bd5\u6280\u672f\u2014\u2014kprobe\u4f7f\u7528\u4e0e\u5b9e\u73b0</li> </ol>"},{"location":"linux/tuning.html#_3","title":"\u539f\u7406","text":"<p>\u73b0\u5728\u8981\u5728do_fork\u4e0a\u52a0\u4e00\u4e2a\u94a9\u5b50\uff0c\u9996\u5148\u6839\u636e\u540d\u79f0\u83b7\u53d6\u8be5\u65b9\u6cd5\u5728\u5185\u6838\u4e2d\u7684\u4ee3\u7801\u5730\u5740\uff0c\u7c7b\u4f3c\u4e8e<code>cat /proc/kallsyms | grep do_fork</code>\u8fd4\u56de\u7684\u5730\u5740 <code>ffffffff81084950</code>\u5904\u7684\u4ee3\u7801\uff0c\u5e76\u5c06\u5176\u6539\u6210\u4e00\u4e2a\u8f6f\u4e2d\u65ad\u3002\u5f53\u7a0b\u5e8f\u6267\u884c\u5230\u8fd9\u6761\u6307\u4ee4\u5230\u65f6\u5019\uff0c\u5c31\u4f1a\u9677\u5165\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\uff0c\u4e2d\u65ad\u5904\u7406\u7a0b\u5e8f\u6267\u884c\u7528\u6237\u6307\u5b9a\u4ee3\u7801\uff0c\u5b9e\u73b0hook\u3002</p> <p>\u76ee\u524dkprobes\u6280\u672f\u5df2\u7ecf\u652f\u6301\u591a\u79cd\u67b6\u6784\uff0c\u5305\u62eci386\u3001x86_64\u3001ppc64\u3001ia64\u3001sparc64\u3001arm\u3001ppc\u548cmips\uff08\u6709\u4e9b\u67b6\u6784\u5b9e\u73b0\u53ef\u80fd\u5e76\u4e0d\u5b8c\u5168\uff0c\u5177\u4f53\u53ef\u53c2\u8003\u5185\u6838\u7684Documentation/kprobes.txt\uff09\u3002</p> <p></p>"},{"location":"linux/tuning.html#_4","title":"\u914d\u7f6e\u67e5\u770b","text":"<p>\u67e5\u770b\u662f\u5426\u5f00\u542fkprobe</p> <pre><code>$ cat /boot/config-3.10.0-* | grep KPROBES\nCONFIG_KPROBES=y\nCONFIG_KPROBES_ON_FTRACE=y\nCONFIG_HAVE_KPROBES=y\nCONFIG_HAVE_KPROBES_ON_FTRACE=y\n</code></pre>"},{"location":"linux/tuning.html#_5","title":"\u4f7f\u7528","text":"<pre><code>//kprobe_example.c\n#include&lt;linux/init.h&gt;\n#include&lt;linux/module.h&gt;\n#include&lt;linux/kernel.h&gt;\n#include &lt;linux/kprobes.h&gt;\n\n//\u7edf\u8ba1do_fork()\u603b\u5171\u6267\u884c\u4e86\u51e0\u6b21\nstatic int total_count = 0;\n\n//\u524d\u7f6e\u65b9\u6cd5\uff0c\u8fd9\u91cc\u53ef\u4ee5\u62ff\u5230\u65b9\u6cd5\u5165\u53c2\u548c\u6808\uff0c\u6bcf\u6b21\u6267\u884cdo_fork() total_count++\nstatic int handler_pre(struct kprobe *p, struct pt_regs *regs)\n{\n        total_count++;\n        //printk \u6253\u5370\u7684\u65e5\u5fd7 \u53ef\u4ee5\u901a\u8fc7dmesg \u547d\u4ee4\u67e5\u770b\n        printk(KERN_INFO \"\u7d2f\u8ba1\u8c03\u7528do_fork[%d]\u6b21\\n\",total_count);\n        return 0;\n}\n//\u540e\u7f6e\u65b9\u6cd5\uff0c\u8fd9\u91cc\u53ef\u4ee5\u62ff\u5230\u65b9\u6cd5\u8fd4\u56de\u503c\nstatic void handler_post(struct kprobe *p, struct pt_regs *regs,\n                                unsigned long flags)\n{\n}\n//\u65b9\u6cd5\u6267\u884c\u5931\u8d25\u7684\u56de\u8c03\u51fd\u6570\nstatic int handler_fault(struct kprobe *p, struct pt_regs *regs, int trapnr)\n{\n        printk(KERN_INFO \"fault_handler: p-&gt;addr = 0x%p, trap #%dn\",p-&gt;addr, trapnr);\n        return 0;\n}\n//\u901a\u8fc7kprobe\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\uff0c\u5b9a\u4e49\u8981hook\u7684\u5185\u6838\u65b9\u6cd5\u540d\u79f0\nstatic struct kprobe kp = {\n        .symbol_name    = \"do_fork\",\n};\n//\u901a\u8fc7register_kprobe \u65b9\u6cd5\u66f4\u6539\u5185\u6838\u5bf9\u5e94\u65b9\u6cd5\u7684\u6307\u4ee4\nstatic int kprobe_init(void){\n        int ret;\n        kp.pre_handler = handler_pre;\n        kp.post_handler = handler_post;\n        kp.fault_handler = handler_fault;\n\n        ret = register_kprobe(&amp;kp);\n        if (ret &lt; 0) {\n                printk(KERN_INFO \"register_kprobe failed, returned %d\\n\", ret);\n                return ret;\n        }\n        printk(KERN_INFO \"Planted kprobe at %p\\n\", kp.addr);\n        return 0;\n}\n//\u901a\u8fc7unregister_kprobe\u5378\u8f7dhook\nstatic void kprobe_exit(void){\n        unregister_kprobe(&amp;kp);\n        printk(KERN_INFO \"kprobe at %p unregistered\\n\", kp.addr);\n}\n\n//\u6784\u9020\u5185\u6838\u6a21\u5757\nmodule_init(kprobe_init);\nmodule_exit(kprobe_exit);\nMODULE_LICENSE(\"GPL\");\n</code></pre> <p>\u7f16\u5199makefile</p> <pre><code>// Makefile\nobj-m +=kprobe_example.o\nCURRENT_PATH:=$(shell pwd)\nLINUX_KERNEL_PATH:=/lib/modules/$(shell uname -r)/build\nall:\n        make -C $(LINUX_KERNEL_PATH) M=$(CURRENT_PATH) modules\nclean:\n        make -C $(LINUX_KERNEL_PATH) M=$(CURRENT_PATH) clean\n</code></pre> <p>\u6267\u884c<code>sudo insmod kprobe_example.ko</code>\u88c5\u8f7d\u5185\u6838\u6a21\u5757,\u7136\u540e\u4f7f\u7528dmesg\u67e5\u770b\u5185\u6838\u65e5\u5fd7</p>"},{"location":"linux/tuning.html#ebpf","title":"eBPF","text":"<p>\u53c2\u8003\uff1a</p> <ol> <li>eBPF \u7b80\u53f2</li> </ol> <p>kprobe\u7684\u6bcf\u6b21\u8c03\u8bd5\u88c5\u8f7d\u5378\u8f7d\u592a\u8fc7\u7e41\u7410\uff0c\u5982\u679c\u53ef\u4ee5\u88c5\u8f7d\u4e00\u4e2a\u901a\u7528\u7684\u6a21\u5757\uff0c\u6bcf\u6b21\u8c03\u8bd5\u901a\u8fc7\u914d\u7f6e\u8fd9\u4e2a\u6a21\u5757\u6765\u5b9e\u73b0\u4e0d\u540c\u7684\u529f\u80fd\uff0c\u8c03\u8bd5\u5c31\u66f4\u65b9\u4fbf\u4e86\u3002\u4e8e\u662f\u5c31\u5f15\u51fa\u4e86\u7b2c\u4e8c\u4e2a\u5173\u952e\u8bcd<code>eBPF</code>\u3002</p> <p>eBPF \u6e90\u4e8e\u65e9\u5e74\u95f4\u7684\u6210\u578b\u4e8e BSD \u4e4b\u4e0a\u7684\u4f20\u7edf\u6280\u672f BPF\uff08Berkeley Packet Filter\uff09\u3002</p> <p>BPF \u7684\u4e24\u5927\u6838\u5fc3\u529f\u80fd\uff1a</p> <ul> <li>\u8fc7\u6ee4Filter\uff1a\u6839\u636e\u5916\u754c\u8f93\u5165\u7684\u89c4\u5219\u8fc7\u6ee4\u62a5\u6587\uff1b</li> <li>\u590d\u5236Copy\uff1a\u5c06\u7b26\u5408\u6761\u4ef6\u7684\u62a5\u6587\u7531\u5185\u6838\u7a7a\u95f4\u590d\u5236\u5230\u7528\u6237\u7a7a\u95f4\uff1b</li> </ul> <p>eBPF\u662f\u4e00\u9879\u9769\u547d\u6027\u7684\u6280\u672f\uff0c\u53ef\u4ee5\u5728Linux\u5185\u6838\u4e2d\u8fd0\u884c\u6c99\u76d2\u7a0b\u5e8f\uff0c\u800c\u65e0\u9700\u66f4\u6539\u5185\u6838\u6e90\u4ee3\u7801\u6216\u52a0\u8f7d\u5185\u6838\u6a21\u5757\u3002</p> <p>\u5bf9\u4e8e\u4e91\u539f\u751f\u9886\u57df\uff0cCilium \u5df2\u7ecf\u4f7f\u7528eBPF \u5b9e\u73b0\u4e86\u65e0kube-proxy\u7684\u5bb9\u5668\u7f51\u7edc\u3002\u5229\u7528eBPF\u89e3\u51b3iptables\u5e26\u6765\u7684\u6027\u80fd\u95ee\u9898\u3002</p>"},{"location":"linux/tuning.html#bcc","title":"BCC","text":"<p>BPF Compiler Collection (BCC)\uff0c\u57fa\u4e8eeBPF.</p>"},{"location":"linux/tuning.html#_6","title":"\u52a8\u6001\u8ffd\u8e2a","text":"<p>\u53c2\u8003\uff1a</p> <ol> <li>\u52a8\u6001\u8ffd\u8e2a\u6280\u672f\u6f2b\u8c08</li> </ol> <p>Mac OS X / Unix : DTrace\uff1bLinux : SystemTap, perf</p> <p></p>"},{"location":"linux/tuning.html#perf","title":"Perf","text":"<p>\u57fa\u672c\u539f\u7406\u662f\uff1a\u6bcf\u9694\u4e00\u4e2a\u56fa\u5b9a\u65f6\u95f4\uff0c\u5c31\u662fCPU\u4e0a\u4ea7\u751f\u4e00\u4e2a\u4e2d\u65ad\uff0c\u770b\u5f53\u524d\u662f\u54ea\u4e2a\u8fdb\u7a0b\u3001\u54ea\u4e2a\u51fd\u6570\uff0c\u7136\u540e\u7ed9\u5bf9\u5e94\u7684\u8fdb\u7a0b\u548c\u51fd\u6570\u52a0\u4e00\u4e2a\u7edf\u8ba1\u503c\u3002</p> <ul> <li><code>-a</code>\uff1a\u8868\u793a\u5bf9\u6240\u6709CPU\u91c7\u6837</li> <li><code>--call-graph dward</code>\uff1a\u8868\u793a\u5206\u6790\u8c03\u7528\u6808\u7684\u5173\u7cfb</li> <li><code>-p</code>\uff1a\u8868\u793a\u5206\u6790\u6307\u5b9a\u7684\u8fdb\u7a0b</li> </ul>"},{"location":"linux/tuning.html#system-tap","title":"System Tap","text":"<p>\u4e00\u4e2a\u7b80\u5355\u7684\u63a2\u9488\u548c\u811a\u672c\uff0c\u8c03\u7528\u5185\u6838\u7cfb\u7edf\u8c03\u7528 sys_sync \u65f6\u89e6\u53d1</p> <pre><code>global count=0\nprobe kernel.function(\"sys_sync\") {\n count++\n printf( \"sys_sync called %d times, currently by pid %d\\n\", count, pid );\n}\n</code></pre>"},{"location":"linux/tuning.html#flamegraph","title":"\u706b\u7130\u56fe\uff08FlameGraph\uff09","text":"<p>https://github.com/brendangregg/FlameGraph</p> <p>Linux <code>perf_events</code> has a variety of capabilities, including CPU sampling. Using it to sample all CPUs and generate a flame graph:</p> <pre><code># git clone https://github.com/brendangregg/FlameGraph  # or download it from github\n# cd FlameGraph\n# perf record -F 99 -a -g -- sleep 60\n# perf script | ./stackcollapse-perf.pl &gt; out.perf-folded\n# ./flamegraph.pl out.perf-folded &gt; perf-kernel.svg\n</code></pre> <p>\u4e24\u79cd\u60c5\u51b5\u4e0b\uff0c\u65e0\u6cd5\u753b\u51fa\u706b\u7130\u56fe\uff0c\u9700\u8981\u4fee\u6b63\u7cfb\u7edf\u884c\u4e3a\u3002</p> <p>\uff081\uff09\u8c03\u7528\u6808\u4e0d\u5b8c\u6574</p> <p>\u5f53\u8c03\u7528\u6808\u8fc7\u6df1\u65f6\uff0c\u67d0\u4e9b\u7cfb\u7edf\u53ea\u8fd4\u56de\u524d\u9762\u7684\u4e00\u90e8\u5206\uff08\u6bd4\u5982\u524d10\u5c42\uff09\u3002</p> <p>\uff082\uff09\u51fd\u6570\u540d\u7f3a\u5931</p> <p>\u6709\u4e9b\u51fd\u6570\u6ca1\u6709\u540d\u5b57\uff0c\u7f16\u8bd1\u5668\u53ea\u7528\u5185\u5b58\u5730\u5740\u6765\u8868\u793a\uff08\u6bd4\u5982\u533f\u540d\u51fd\u6570\uff09\u3002</p>"},{"location":"linux/yum.html","title":"YUM","text":""},{"location":"linux/yum.html#_1","title":"\u4ee3\u7406","text":"<p>proxy=http://\u4ee3\u7406\u670d\u52a1\u5668IP\u5730\u5740:\u7aef\u53e3\u53f7</p> <p>proxy_username=\u4ee3\u7406\u670d\u52a1\u5668\u7528\u6237\u540d</p> <p>proxy_password=\u4ee3\u7406\u670d\u52a1\u5668\u5bc6\u7801</p>"},{"location":"linux/yum.html#_2","title":"\u6e90\u914d\u7f6e","text":"<p><code>CentOS-Base.repo</code></p> <pre><code>[base]\nname=CentOS-$releasever - Base - mirrors.aliyun.com\nfailovermethod=priority\nbaseurl=http://mirrors.aliyun.com/centos/$releasever/os/$basearch/\n        http://mirrors.aliyuncs.com/centos/$releasever/os/$basearch/\n        http://mirrors.cloud.aliyuncs.com/centos/$releasever/os/$basearch/\ngpgcheck=1\ngpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7\n\n#released updates\n[updates]\nname=CentOS-$releasever - Updates - mirrors.aliyun.com\nfailovermethod=priority\nbaseurl=http://mirrors.aliyun.com/centos/$releasever/updates/$basearch/\n        http://mirrors.aliyuncs.com/centos/$releasever/updates/$basearch/\n        http://mirrors.cloud.aliyuncs.com/centos/$releasever/updates/$basearch/\ngpgcheck=1\ngpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7\n\n#additional packages that may be useful\n[extras]\nname=CentOS-$releasever - Extras - mirrors.aliyun.com\nfailovermethod=priority\nbaseurl=http://mirrors.aliyun.com/centos/$releasever/extras/$basearch/\n        http://mirrors.aliyuncs.com/centos/$releasever/extras/$basearch/\n        http://mirrors.cloud.aliyuncs.com/centos/$releasever/extras/$basearch/\ngpgcheck=1\ngpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7\n\n#additional packages that extend functionality of existing packages\n[centosplus]\nname=CentOS-$releasever - Plus - mirrors.aliyun.com\nfailovermethod=priority\nbaseurl=http://mirrors.aliyun.com/centos/$releasever/centosplus/$basearch/\n        http://mirrors.aliyuncs.com/centos/$releasever/centosplus/$basearch/\n        http://mirrors.cloud.aliyuncs.com/centos/$releasever/centosplus/$basearch/\ngpgcheck=1\nenabled=0\ngpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7\n\n#contrib - packages by Centos Users\n[contrib]\nname=CentOS-$releasever - Contrib - mirrors.aliyun.com\n</code></pre>"},{"location":"linux/zero_copy.html","title":"Linux OS\u7684\u96f6\u62f7\u8d1d\uff08\u53d1\u9001\u6587\u4ef6\u4e3a\u4f8b\uff09","text":"<p>Zero Copy\uff1a\u6307\u7684\u662f\u6ca1\u6709\u4ece\u5185\u6838\u7a7a\u95f4\u62f7\u8d1d\u6570\u636e\u5230\u7528\u6237\u7a7a\u95f4</p>"},{"location":"linux/zero_copy.html#io42cpu2dma","title":"\u666e\u901aIO\uff0c4\u6b21\u4e0a\u4e0b\u6587\u5207\u6362\uff0c2\u6b21cpu\u62f7\u8d1d\uff0c2\u6b21dma\u62f7\u8d1d","text":"<pre><code>read(file, tmp_buf, len); \nwrite(socket, tmp_buf, len);\n</code></pre>"},{"location":"linux/zero_copy.html#io41cpu2dma","title":"\u5185\u5b58\u6620\u5c04\u65b9\u5f0fI/O\uff0c4\u6b21\u4e0a\u4e0b\u6587\u5207\u6362\uff0c1\u6b21cpu\u62f7\u8d1d\uff0c2\u6b21dma\u62f7\u8d1d","text":"<pre><code>// \u7528\u6237\u7f13\u51b2\u533a\uff08user buffer\uff09\u7684\u5185\u5b58\u5730\u5740\u548c\u5185\u6838\u7f13\u51b2\u533a\uff08kernel buffer\uff09\u7684\u5185\u5b58\u5730\u5740\u505a\u4e00\u4e2a\u6620\u5c04\uff0c\u4e5f\u5c31\u662f\u8bf4\u7cfb\u7edf\u5728\u7528\u6237\u6001\u53ef\u4ee5\u76f4\u63a5\u8bfb\u53d6\u5e76\u64cd\u4f5c\u5185\u6838\u7a7a\u95f4\u7684\u6570\u636e\ntmp_buf = mmap(file, len);\nwrite(socket, tmp_buf, len);\n</code></pre>"},{"location":"linux/zero_copy.html#io21cpu2dma","title":"\u5185\u6838\u7a7a\u95f4\u5185\u90e8\u4f20\u8f93I/O\uff0c2\u6b21\u4e0a\u4e0b\u6587\u5207\u6362\uff0c1\u6b21cpu\u62f7\u8d1d\uff0c2\u6b21dma\u62f7\u8d1d","text":"<pre><code>// \u7528\u6237\u7a7a\u95f4\u6b64\u65f6\u662f\u65e0\u6cd5\u770b\u5230\u6216\u4fee\u6539\u6570\u636e\u5185\u5bb9\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u662f\u4e00\u6b21\u5b8c\u5168\u610f\u4e49\u4e0a\u7684\u6570\u636e\u4f20\u8f93\u8fc7\u7a0b\nsendfile(socket, file, len);\n</code></pre> <p>\u6ce8\uff1a\u5185\u6838\u652f\u6301gather operations\u7684\u8bdd\u8fd8\u53ef\u4ee5\u8fdb\u4e00\u6b65\u4f18\u5316\uff0c\u5728\u7528\u6237\u5b9e\u73b0\u5c42\u9762\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff0c\u4f18\u5316\u90fd\u662f\u5728\u5185\u6838\u5b9e\u73b0\u4e2d\u7684\uff0c\u9996\u5148\u6570\u636e\u4ecedisk\u62f7\u8d1d\u5230\u5185\u6838buffer\uff0c\u7136\u540e\u5e76\u4e0d\u9700\u8981\u628a\u6570\u636e\u518d\u6b21\u62f7\u8d1d\u5230socket buffer\u3002</p>"},{"location":"linux/zero_copy.html#mmap","title":"MMAP","text":"<p>mmap\u662f\u4e00\u79cd\u5185\u5b58\u6620\u5c04\u6587\u4ef6\u7684\u65b9\u6cd5\uff0c\u5373\u5c06\u4e00\u4e2a\u6587\u4ef6\u6216\u8005\u5176\u5b83\u5bf9\u8c61\u6620\u5c04\u5230\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u5b9e\u73b0\u6587\u4ef6\u78c1\u76d8\u5730\u5740\u548c\u8fdb\u7a0b\u865a\u62df\u5730\u5740\u7a7a\u95f4\u4e2d\u4e00\u6bb5\u865a\u62df\u5730\u5740\u7684\u5bf9\u6620\u5173\u7cfb\u3002</p> <p></p> <p>\u4e3a\u5185\u5b58\u6620\u5c04\u670d\u52a1\u7684\u5730\u5740\u7a7a\u95f4\u5904\u5728\u5806\u6808\u4e4b\u95f4\u7684\u7a7a\u4f59\u90e8\u5206\u3002</p>"},{"location":"linux/zero_copy.html#_1","title":"\u539f\u7406","text":"<p>mmap \u8fc7\u7a0b\uff1a</p> <ul> <li>\u8fdb\u7a0b\u542f\u52a8\u6620\u5c04\u8fc7\u7a0b\uff0c\u5728\u865a\u62df\u5730\u5740\u7a7a\u95f4\u4e3a\u6620\u5c04\u521b\u5efa\u865a\u62df\u6620\u5c04\u533a\u57df\uff1b</li> <li>\u8fdb\u7a0b\u5728\u7528\u6237\u7a7a\u95f4\u8c03\u7528\u5e93\u51fd\u6570mmap\uff1b</li> <li>\u8c03\u7528\u5185\u6838\u7a7a\u95f4\u7684\u7cfb\u7edf\u8c03\u7528\u51fd\u6570mmap\uff08\u4e0d\u540c\u4e8e\u7528\u6237\u7a7a\u95f4\u51fd\u6570\uff09\uff0c\u5b9e\u73b0\u6587\u4ef6\u7269\u7406\u5730\u5740\u548c\u8fdb\u7a0b\u865a\u62df\u5730\u5740\u7684\u4e00\u4e00\u6620\u5c04\u5173\u7cfb\uff1b</li> <li>\u8fdb\u7a0b\u53d1\u8d77\u5bf9\u8fd9\u7247\u6620\u5c04\u7a7a\u95f4\u7684\u8bbf\u95ee\uff08\u865a\u62df\u5730\u5740\uff09\uff0c\u5f15\u53d1\u7f3a\u9875\u5f02\u5e38\uff0c\u5b9e\u73b0\u6587\u4ef6\u5185\u5bb9\u5230\u7269\u7406\u5185\u5b58\uff08\u4e3b\u5b58\uff09\u7684\u62f7\u8d1d\u3002</li> </ul> <p>\u6587\u4ef6\u7cfb\u7edf\u8bfb\u5199\u8fc7\u7a0b\uff1a</p> <ul> <li>\u8fdb\u7a0b\u53d1\u8d77\u8bfb\u6587\u4ef6\u8bf7\u6c42\uff1b</li> <li>\u5185\u6838\u901a\u8fc7\u67e5\u627e\u8fdb\u7a0b\u6587\u4ef6\u7b26\u8868\uff0c\u5b9a\u4f4d\u5230\u5185\u6838\u5df2\u6253\u5f00\u6587\u4ef6\u96c6\u4e0a\u7684\u6587\u4ef6\u4fe1\u606f\uff0c\u627e\u5230\u6587\u4ef6\u7684inode\uff1b</li> <li>Inode\u5728address_space\u4e0a\u67e5\u627e\u8981\u8bf7\u6c42\u7684\u6587\u4ef6\u9875\u662f\u5426\u5df2\u7ecf\u7f13\u5b58\u5728\u9875\u7f13\u5b58\u4e2d\u3002\u5b58\u5728\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\u6587\u4ef6\u9875\u7684\u5185\u5bb9\uff1b</li> <li>\u4e0d\u5b58\u5728\uff0c\u5219\u901a\u8fc7inode\u5b9a\u4f4d\u9053\u6587\u4ef6\u78c1\u76d8\u5730\u5740\uff0c\u5c06\u6570\u636e\u4ece\u78c1\u76d8\u590d\u5236\u5230\u9875\u7f13\u5b58\u3002\u4e4b\u540e\u518d\u6b21\u53d1\u8d77\u8bfb\u9875\u9762\u8fc7\u7a0b\uff0c\u8fdb\u800c\u5c06\u9875\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u53d1\u7ed9\u7528\u6237\u8fdb\u7a0b\u3002</li> </ul> <p>\u5e38\u89c4\u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c\uff0c\u4f7f\u7528\u9875\u7f13\u5b58\u673a\u5236\u63d0\u9ad8\u8bfb\u5199\u6548\u7387\u548c\u4fdd\u62a4\u78c1\u76d8\uff0c\u9700\u8981\u5c06\u78c1\u76d8\u6570\u636e\u62f7\u8d1d\u5230\u5185\u6838\u7a7a\u95f4\u7684\u9875\u7f13\u5b58\u4e2d\uff0c\u7528\u6237\u8bbf\u95ee\u65f6\uff0c\u518d\u62f7\u8d1d\u5230\u5185\u5b58\u5bf9\u5e94\u7684\u7528\u6237\u7a7a\u95f4\u4e2d\uff0c\u9700\u8981\u4e24\u6b21\u6570\u636e\u62f7\u8d1d\u8fc7\u7a0b\u3002</p> <p>mmap\u64cd\u63a7\u6587\u4ef6\uff0c\u53ea\u9700\u8981\u4ece\u78c1\u76d8\u5230\u7528\u6237\u4e3b\u5b58\u7684\u4e00\u6b21\u6570\u636e\u62f7\u8d1d\u8fc7\u7a0b\u3002</p>"},{"location":"machine_learning/deep_learning/index.html","title":"\u6df1\u5ea6\u795e\u7ecf\u7f51\u7edc","text":""},{"location":"machine_learning/deep_learning/index.html#_2","title":"\u611f\u77e5\u673a","text":"<ul> <li>\u5355\u5c42\u611f\u77e5\u673a\u65e0\u6cd5\u5206\u79bb\u7ebf\u6027\u7a7a\u95f4\uff1a\u4f8b\u5982\u65e0\u6cd5\u8868\u793a\u5f02\u6216(XOR)\u5173\u7cfb\uff1b</li> <li>\u4ec5\u901a\u8fc7\u4e0e\u975e\u95e8(NAND)\u7684\u7ec4\u5408\u5c31\u80fd\u5b9e\u73b0\u8ba1\u7b97\u673a\uff0c\u53ef\u4ee5\u53c2\u8003\u300a\u8ba1\u7b97\u673a\u7cfb\u7edf\u8981\u7d20\uff1a\u4ece\u96f6\u6784\u5efa\u73b0\u4ee3\u8ba1\u7b97\u673a\u300b\uff1b</li> <li>\u7406\u8bba\u4e0a\uff0c\u4e8c\u5c42\u611f\u77e5\u673a\uff08\u4e25\u683c\u6765\u8bf4\u662f\u6fc0\u6d3b\u51fd\u6570\u4f7f\u7528\u975e\u7ebf\u6027\u7684 sigmod \u51fd\u6570\u7684\u611f\u77e5\u673a)\u53ef\u4ee5\u8868\u793a\u4efb\u610f\u51fd\u6570\u3002</li> </ul> <p>\u611f\u77e5\u673a\u662f\u4e8c\u5206\u7c7b\u7684\u7ebf\u6027\u5206\u7c7b\u6a21\u578b\uff0c\u8f93\u5165\u4e3a\u5b9e\u4f8b\u7684\u7279\u5f81\u5411\u91cf\uff0c\u8f93\u51fa\u4e3a\u5b9e\u4f8b\u7684\u7c7b\u522b\uff0c\u53d61\u548c0\u4e8c\u503c\u3002 $$ y = \\begin{cases} 1 &amp; w^Tx + b &gt; 0 \\ 0 &amp; w^Tx + b \\leq 0 \\end{cases} $$</p>"},{"location":"machine_learning/deep_learning/index.html#_3","title":"\u795e\u7ecf\u7f51\u7edc","text":"<ul> <li>\u6734\u7d20\u611f\u77e5\u673a\uff1a\u5355\u5c42\u7f51\u7edc\uff0c\u6fc0\u6d3b\u6a21\u578b\u4f7f\u7528\u8d8a\u9636\u51fd\u6570\u7684\u6a21\u578b\uff1b</li> <li>\u591a\u5c42\u611f\u77e5\u673a\uff1a\u795e\u7ecf\u7f51\u7edc\uff0c\u4f7f\u7528sigmoid \u7b49\u5e73\u6ed1\u7684\u6fc0\u6d3b\u51fd\u6570\u7684\u591a\u5c42\u7f51\u7edc\u3002</li> </ul>"},{"location":"machine_learning/deep_learning/index.html#_4","title":"\u6fc0\u6d3b\u51fd\u6570","text":"<p>\u5c06\u8f93\u5165\u4fe1\u53f7\u7684\u603b\u548c\u8f6c\u6362\u4e3a\u8f93\u51fa\u4fe1\u53f7\uff0c\u4e0b\u5f0f\u4e2d\u7684 h\u3002 $$ a = w^Tx + b \\ y = h(a) $$</p> <pre><code>graph LR\n    classDef startend fill:#F5EBFF,stroke:#BE8FED,stroke-width:2px;\n    classDef process fill:#E5F6FF,stroke:#73A6FF,stroke-width:2px;\n\n    I1([1]):::startend\n    I2([x&lt;sub&gt;1&lt;/sub&gt;]):::startend\n    I3([x&lt;sub&gt;2&lt;/sub&gt;]):::startend\n\n    subgraph \u6fc0\u6d3b\u51fd\u6570\n        H1([\"a\"]):::process\n        H2([\"y\"]):::process\n    end\n\n    I1 --b--&gt; H1\n    I2 --w&lt;sub&gt;1&lt;/sub&gt;--&gt; H1\n    I3 --w&lt;sub&gt;2&lt;/sub&gt;--&gt; H1\n    H1 --\"h()\"--&gt; H2\n</code></pre> <p>\u795e\u7ecf\u7f51\u7edc\u7684\u6fc0\u6d3b\u51fd\u6570\u5fc5\u987b\u4f7f\u7528\u975e\u7ebf\u6027\u51fd\u6570\uff1a</p> <ul> <li>\u7ebf\u6027\u51fd\u6570\u7684\u95ee\u9898\u662f\uff1a\u4e0d\u7ba1\u5982\u4f55\u52a0\u6df1\u5c42\u6570\uff0c\u603b\u662f\u5b58\u5728\u4e0e\u4e4b\u7b49\u6548\u7684\u201c\u65e0\u9690\u85cf\u5c42\u7684\u795e\u7ecf\u7f51\u7edc\u201d\uff1b</li> </ul> <p>\u8f93\u51fa\u5c42\u7684\u6fc0\u6d3b\u51fd\u6570\uff1a\u56de\u5f52\u95ee\u9898\u4f7f\u7528\u6052\u7b49\u51fd\u6570\uff0c\u5206\u7c7b\u95ee\u9898\u4f7f\u7528 softmax \u51fd\u6570\uff1b $$ Softmax(x_i)=\\frac{exp(x_i)}{\\sum_j{exp(z_j)}} $$</p> <ul> <li>softmax \u5728\u5b9e\u73b0\u65f6\uff0c\u9700\u8981\u8003\u8651\u6ea2\u51fa\u95ee\u9898\uff08\u5373\u4e2a\u522b\u503c\u592a\u5927\u7684\u95ee\u9898\uff09\uff1b</li> <li>\u63a8\u7406\u7684\u65f6\u5019\u53ef\u4ee5\u4e0d\u8ba1\u7b97 softmax\uff1a\u5355\u8c03\u589e\u51fd\u6570\uff0c\u4e0d\u5f71\u54cd\u5206\u7c7b\u7684\u6700\u5927\u503c\u7684\u9009\u62e9\uff1b</li> </ul> <p>\u8f93\u51fa\u5c42\u7684\u795e\u7ecf\u5143\u4e2a\u6570\uff1a</p> <ul> <li>\u5206\u7c7b\u95ee\u9898\uff1a\u4e00\u822c\u8bbe\u7f6e\u4e3a\u7c7b\u522b\u7684\u6570\u91cf\uff0c\u91c7\u7528 one-hot \u7f16\u7801\uff1b                   </li> </ul>"},{"location":"machine_learning/deep_learning/index.html#_5","title":"\u635f\u5931\u51fd\u6570","text":"<p>\u4e3a\u4ec0\u4e48\u635f\u5931\u51fd\u6570\u4e0d\u80fd\u4ee5\u7cbe\u5ea6\u4f5c\u4e3a\u6307\u6807\uff1a\u5982\u679c\u4ee5\u8bc6\u522b\u7cbe\u5ea6\u4e3a\u6307\u6807\uff0c\u53c2\u6570\u7684\u5bfc\u6570\u5728\u7edd\u5927\u591a\u6570\u5730\u65b9\u90fd\u4f1a\u53d8\u4e3a0\u3002</p> <ul> <li>\u5fae\u8c03\u53c2\u6570\uff0c\u65e0\u6cd5\u6539\u5584\u8bc6\u522b\u7cbe\u5ea6\uff0c\u5e76\u4e14\u5373\u4f7f\u6539\u5584\uff0c\u7cbe\u5ea6\u7684\u503c\u662f\u79bb\u6563\u7684\u503c\u3002</li> <li>\u540c\u6837\uff0c\u4ee5\u8d8a\u9636\u51fd\u6570\u4f5c\u4e3a\u6fc0\u6d3b\u51fd\u6570\uff0c\u795e\u7ecf\u7f51\u7edc\u4e5f\u65e0\u6cd5\u5b66\u4e60\uff0c\u7edd\u5927\u591a\u6570\u5730\u65b9\u5bfc\u6570\u90fd\u4e3a0\u3002</li> </ul> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u5206\u7c7b\u95ee\u9898\u4f7f\u7528\u4ea4\u53c9\u71b5\uff08Cross-Entropy Loss\uff09\uff0c\u56de\u5f52\u95ee\u9898\u4f7f\u7528\u5747\u65b9\u8bef\u5dee\uff08Mean Squared Error)\u3002</p> <p>\u5747\u65b9\u8bef\u5dee\u6307\u7684\u5c31\u662f\u6a21\u578b\u9884\u6d4b\u503c f(x) \u4e0e\u6837\u672c\u771f\u5b9e\u503c y \u4e4b\u95f4\u8ddd\u79bb\u5e73\u65b9\u7684\u5e73\u5747\u503c\u3002 $$ MSE=\\frac{1}{N}\\sum_{i=1}^{N}{(y_i - f(x_i))^2} $$ \u4ea4\u53c9\u71b5\uff1a\u8ba1\u7b97\u5b9e\u9645\u6807\u7b7e\u4e0e\u9884\u6d4b\u6982\u7387\u4e4b\u95f4\u7684\u5dee\u5f02\u6765\u8861\u91cf\u6a21\u578b\u7684\u6027\u80fd</p> <ul> <li>\\(t_k\\)\u53ea\u6709\u6b63\u786e\u89e3\u6807\u7b7e\u7684\u7d22\u5f15\u503c\u4e3a1\uff0c\u5176\u5b83\u4e3a0\uff08one-hot\u8868\u793a\uff09\uff1b</li> <li>\u5982\u679c\u662f\u4e00\u6279\u6570\u636e\uff08mini-batch\uff09\uff0c\u5219 Loss \u9700\u8981\u6c42\u5747\u503c\uff1b</li> </ul> \\[ CSE = -\\sum{t_klog{y_k}} \\]"},{"location":"machine_learning/deep_learning/index.html#_6","title":"\u6570\u503c\u5fae\u5206","text":"<p>\u6570\u503c\u5fae\u5206\uff1a\u5229\u7528\u5fae\u5c0f\u7684\u5dee\u5206\u6c42\u5bfc\u6570\u7684\u8fc7\u7a0b\u3002\u89e3\u6790\u6027\u6c42\u89e3\uff1a\u57fa\u4e8e\u6570\u5b66\u5f0f\u7684\u63a8\u5bfc\u6c42\u5bfc\u6570\u7684\u8fc7\u7a0b\u3002</p> <p>\u4e2d\u5fc3\u5dee\u5206\uff1a\\((f(x+h)-f(x-h))/2h\\)\uff0c\u524d\u5411\u5dee\u5206\uff1a\\((f(x+h)-f(x))/h\\)</p> <p>\u504f\u5bfc\u6570\uff1a\u5c06\u5176\u5b83\u53d8\u91cf\u89c6\u4e3a\u5e38\u6570\uff0c\u5bf9\u67d0\u4e2a\u53d8\u91cf\u8fdb\u884c\u6c42\u5bfc  $$ f(x0, x1)=x_0^2+x_1^2  \\ \\frac{\\partial{f}}{\\partial{x_0}}=2x_0 \\ \\frac{\\partial{f}}{\\partial{x_1}}=2x_1 $$ \u68af\u5ea6\uff1a\u7531\u5168\u90e8\u53d8\u91cf\u7684\u504f\u5bfc\u6570\u6c47\u603b\u800c\u6210\u7684\u5411\u91cf\u3002</p> <p>\u68af\u5ea6\u6cd5\uff1a\u901a\u8fc7\u68af\u5ea6\u9010\u6e10\u51cf\u5c0f\u51fd\u6570\u503c\uff0c\u5bfb\u627e\u51fd\u6570\u7684\u6700\u5c0f\u503c\uff08\u6216\u8005\u5c3d\u53ef\u80fd\u5c0f\u7684\u503c\uff09\u7684\u65b9\u6cd5\u3002</p> <ul> <li>\u68af\u5ea6\u6cd5\u5bfb\u627e\u68af\u5ea6\u4e3a0\u7684\u5730\u65b9\uff1a\u51fd\u6570\u7684\u6781\u5c0f\u503c\u3001\u6700\u5c0f\u503c\u4ee5\u53ca\u88ab\u79f0\u4e3a\u978d\u70b9\u7684\u5730\u65b9\uff0c\u68af\u5ea6\u4e3a0\uff1b</li> </ul> <p>\u5b66\u4e60\u7387\uff08learning rate\uff09\uff1a\u8d85\u53c2\u6570</p> <ul> <li>\u4e0d\u5b9c\u8bbe\u7f6e\u8fc7\u5927\uff0c\u5426\u5219\u4f1a\u53d1\u6563\u6210\u4e00\u4e2a\u5f88\u5927\u7684\u503c\uff1b\uff08\u6b65\u5b50\u8fc8\u7684\u592a\u5927\uff09</li> <li>\u4e0d\u5b9c\u8bbe\u7f6e\u8fc7\u5c0f\uff0c\u5426\u5219\u6ca1\u600e\u4e48\u66f4\u65b0\u5c31\u4f1a\u7ed3\u675f\uff1b\uff08\u8d70\u4e0d\u52a8\uff09</li> </ul> \\[ x_0=x_0-\\eta\\frac{\\partial{f}}{\\partial{x_0}}   \\\\ x_1=x_1-\\eta\\frac{\\partial{f}}{\\partial{x_1}}   \\\\ \\] <p>epoch\u662f\u4e2a\u5355\u4f4d\uff1a\u8868\u793a\u673a\u5668\u5b66\u4e60\u4e2d\u6240\u6709\u8bad\u7ec3\u6570\u636e\u5747\u88ab\u4f7f\u7528\u8fc7\u4e00\u6b21\u7684\u66f4\u65b0\u6b21\u6570\u3002</p> <ul> <li><code>mini-batch</code>\u662f\u968f\u673a\u751f\u6210\u7684\uff0c\u4e0d\u4e00\u5b9a\u6bcf\u4e2a\u6570\u636e\u90fd\u4f1a\u88ab\u770b\u5230\u3002</li> </ul>"},{"location":"machine_learning/deep_learning/index.html#_7","title":"\u53cd\u5411\u4f20\u64ad","text":"<p>\u94fe\u5f0f\u6cd5\u5219\uff1a\u9488\u5bf9\u590d\u5408\u51fd\u6570\uff0c\u8be5\u590d\u5408\u51fd\u6570\u7684\u5bfc\u6570\u53ef\u4ee5\u7528\u6784\u6210\u590d\u5408\u51fd\u6570\u7684\u5404\u4e2a\u51fd\u6570\u7684\u5bfc\u6570\u7684\u4e58\u79ef\u8868\u793a\u3002  $$ z=t^2 \\ t = x + y \\ \\frac{\\partial{z}}{\\partial{x}} = \\frac{\\partial{z}}{\\partial{y}}\\frac{\\partial{y}}{\\partial{x}}  $$ sigmoid \u793a\u4f8b\u5982\u4e0b\uff1a $$ f(x)=\\frac{1}{1+exp(-x)} \\ \\frac{\\partial{f}}{\\partial{x}} = -(\\frac{1}{1+exp(-x)})^2 (exp(-x))(-1) \\ = f^2(\\frac{1}{f}-1)=f(1-f) $$ Affine \u5c42\u7684\u5bfc\u6570\u5982\u4e0b\uff1a</p> <p></p> <p>softmax with loss\u7684\u793a\u4f8b\u5982\u4e0b\uff1a</p> <ul> <li>\u4e3a\u4e86\u5f97\u5230\\((y_1-t_1,y_2-t_2,y_3-t_3)\\)\u6f02\u4eae\u7684\u7ed3\u679c\uff0c\u624d\u8bbe\u8ba1\u4e86\u4ea4\u53c9\u71b5\u7684\u8bef\u5dee\u51fd\u6570\u3002</li> </ul> \\[ y_i=Softmax(x_i)=\\frac{exp(x_i)}{\\sum_j{exp(z_j)}} \\\\ \\frac{\\partial{y_i}}{\\partial{x_j}}=\\begin{cases} -y_i^2+y_i &amp; i=j \\\\ -y_iy_j &amp; i \\ne j  \\end{cases}   \\\\ L(y)=CSE(y) = -\\sum{t_klog{y_k}} \\\\ \\frac{\\partial{L}}{\\partial{y_i}} = -\\frac{t_k}{y_i} \\\\ \\frac{\\partial{L}}{\\partial{x_i}}=\\sum\\frac{\\partial{L(y)}}{\\partial{y_k}}\\frac{\\partial{y_k}}{\\partial{x_i}}=-\\frac{t_i}{y_i}*y_i(1-y_i)+\\sum_{i\\ne k}\\frac{t_k}{y_i}*y_iy_k=-t_i+t_iy_i+\\sum_{i\\ne k}{t_ky_k}=y_i-t_i \\]"},{"location":"machine_learning/deep_learning/index.html#_8","title":"\u5b66\u4e60\u6280\u5de7","text":""},{"location":"machine_learning/deep_learning/index.html#_9","title":"\u4f18\u5316\u65b9\u6cd5","text":"<p>\u76ee\u524d\u5e76\u4e0d\u5b58\u5728\u5728\u6240\u6709\u95ee\u9898\u4e2d\u90fd\u8868\u73b0\u826f\u597d\u7684\u65b9\u6cd5\u3002\u4e00\u822c\u800c\u8a00\uff0c\u76f8\u8f83\u4e8eSGD\uff0c\u5176\u4ed6\u65b9\u6cd5\u6536\u655b\u66f4\u5feb\uff0c\u6709\u65f6\u7cbe\u5ea6\u66f4\u597d\u3002</p> <p>\u968f\u673a\u68af\u5ea6\u4e0b\u964d\u6cd5SGD\uff1a\u68af\u5ea6\u7684\u65b9\u5411\u5e76\u6ca1\u6709\u6307\u5411\u6700\u5c0f\u503c\u7684\u65b9\u5411\u3002\u5982\u679c\u51fd\u6570\u7684\u5f62\u72b6\u975e\u5747\u5411\uff08anisotropic\uff09\uff0c\u6bd4\u5982\u5448\u5ef6\u7533\u72b6\uff0c\u641c\u7d22\u7684\u8def\u5f84\u5c31\u4f1a\u975e\u5e38\u4f4e\u6548\u3002 $$ \\bold W \\leftarrow \\bold W-\\eta \\frac{\\partial{L}}{\\partial{W}} $$</p> <p>Momentum\uff1a\\(\\alpha{v}\\) \u8868\u793a\u7269\u4f53\u4e0d\u53d7\u529b\u65f6\uff0c\u627f\u62c5\u4f7f\u7269\u4f53\u9010\u6e10\u51cf\u901f\u7684\u4efb\u52a1\u3002</p> <ul> <li>\u4fdd\u7559\u4e4b\u524d\u7684\u65b9\u5411\uff0c\u5f15\u5165\u4e86\u52a8\u91cf\u7684\u6982\u5ff5\uff0c\u5b83\u4f1a\u7d2f\u79ef\u4e4b\u524d\u7684\u68af\u5ea6\u4fe1\u606f\uff0c\u8ba9\u53c2\u6570\u66f4\u65b0\u5177\u6709\u4e00\u5b9a\u7684\u60ef\u6027\u3002</li> </ul> \\[ \\bold{v} \\leftarrow \\alpha{\\bold{v}}-\\eta\\frac{\\partial{L}}{\\partial{W}} &amp; \\alpha=0.9\\\\ \\bold W \\leftarrow \\bold W + \\bold{v} \\] <p>AdaGrad\uff1a\u5b66\u4e60\u7387\u8870\u51cf\uff08\u5b66\u4e60\u7387\u968f\u8fed\u4ee3\u6b21\u6570\u51cf\u5c0f\uff09\u4ecd\u662f\u9488\u5bf9\u6240\u6709\u5143\u7d20\u5171\u540c\u8870\u51cf</p> <ul> <li>\u81ea\u9002\u5e94\u5730\u8c03\u6574\u6bcf\u4e2a\u53c2\u6570\u7684\u5b66\u4e60\u7387\uff0c\u5bf9\u4e8e\u9891\u7e41\u66f4\u65b0\u7684\u53c2\u6570\u5b66\u4e60\u7387\u4f1a\u53d8\u5c0f\uff1b\u5bf9\u4e8e\u4e0d\u5e38\u66f4\u65b0\u7684\u53c2\u6570\u5b66\u4e60\u7387\u4f1a\u53d8\u5927</li> <li>h \u4fdd\u5b58\u4ee5\u524d\u7684\u6240\u6709\u68af\u5ea6\u503c\u7684\u5e73\u65b9\u548c\uff0c\u610f\u5473\u7740\u53c2\u6570\u53d8\u52a8\u5927\u7684\u5143\u7d20\u7684\u5b66\u4e60\u7387\u5c06\u53d8\u5c0f\uff1b</li> <li>\u7528 RMSProp \u89e3\u51b3\u5b66\u4e60\u6b21\u6570\u591a\u540e\u66f4\u65b0\u91cf\u4e3a0\u7684\u95ee\u9898\uff1a\u9010\u6e10\u9057\u5fd8\u8fc7\u53bb\u7684\u68af\u5ea6\uff0c\u5982\u4e4b\u524d\u7684\u6743\u91cd0.9\uff0c\u73b0\u5728\u76840.1\u3002</li> </ul> \\[ \\bold h \\leftarrow \\bold h + \\frac{\\partial{L}}{\\partial{\\bold W}} \\odot \\frac{\\partial{L}}{\\partial{\\bold W}} \\\\ \\bold W \\leftarrow \\bold W - \\eta \\frac{1}{\\sqrt{\\bold h}} \\frac{\\partial{L}}{\\partial{\\bold W}} \\] <p>Adam\uff1a\u7ed3\u5408 Momentum \u548c AdaGrad</p> <ul> <li>\u4e00\u822c\u6765\u8bf4\uff0c\\(\\beta_{1}=0.9, \\beta_{2}=0.999\\)</li> </ul> \\[ m_{t}=\\beta_{1}m_{t - 1}+(1 - \\beta_{1}) \\frac{\\partial{L}}{\\partial{\\bold W}} \\\\ v_{t}=\\beta_{2}v_{t - 1}+(1 - \\beta_{2})\\frac{\\partial{L}}{\\partial{\\bold W}}\\odot\\frac{\\partial{L}}{\\partial{\\bold W}} \\\\ \\hat{m}_{t}=\\frac{m_{t}}{1 - \\beta_{1}^{t}} \\\\   \\hat{v}_{t}=\\frac{v_{t}}{1 - \\beta_{2}^{t}} \\\\ \\bold W = \\bold W - \\frac{\\eta}{\\sqrt{\\hat{v}_{t}}+\\epsilon}\\hat{m}_{t}=\\bold W -\\frac{\\eta}{\\sqrt{{v}_{t}}+\\epsilon}{m}_{t}*\\frac{\\sqrt{1 - \\beta_{2}^{t}}}{1 - \\beta_{1}^{t}} \\] <p>\u4ee5 \\(f=\\frac{1}{20}x^2+y^2\\)\u4e3a\u4f8b\uff0c\u7ed8\u5236\u4e0d\u540c\u4f18\u5316\u65b9\u6cd5\u7684\u641c\u7d22\u8def\u5f84\uff0c\u5982\u4e0b\u56fe</p> <p></p>"},{"location":"machine_learning/deep_learning/index.html#_10","title":"\u6743\u91cd\u7684\u521d\u59cb\u503c","text":"<p>Xavier \u521d\u59cb\u5316</p> <p>\u5c06\u6743\u91cd\u521d\u59cb\u5316\u8bbe\u7f6e\u4e3a0\uff0c\u5c06\u65e0\u6cd5\u8fdb\u884c\u6b63\u5e38\u5b66\u4e60\u3002\uff08\u4e25\u683c\u7684\u8bf4\uff0c\u4e0d\u80fd\u521d\u59cb\u5316\u4e3a\u540c\u6837\u7684\u503c\uff09</p> <ul> <li>\u6b63\u5411\u4f20\u64ad\u65f6\u8f93\u51fa\u662f\u76f8\u540c\u7684\u503c\uff0c\u53cd\u5411\u4f20\u64ad\u65f6\uff0c\u6743\u91cd\u4f1a\u8fdb\u884c\u76f8\u540c\u7684\u66f4\u65b0\uff0c\u9700\u8981\u74e6\u89e3\u6743\u91cd\u7684\u5bf9\u79f0\u7ed3\u6784\uff1b</li> </ul> <p>\u9690\u85cf\u5c42\u7684\u6fc0\u6d3b\u503c\u7684\u5206\u5e03\uff1a\u6fc0\u6d3b\u503c\u5728\u5206\u5e03\u4e0a\u6709\u6240\u504f\u5411\u4f1a\u51fa\u73b0\u68af\u5ea6\u6d88\u5931\u201d\u8868\u73b0\u529b\u53d7\u9650\u201d\u7684\u95ee\u9898\uff1b</p> <ul> <li>\u5982\u679c100\u4e2a\u795e\u7ecf\u5143\u90fd\u8f93\u51fa\u76f8\u540c\u7684\u503c\uff0c\u90a3\u4e48\u4e5f\u53ef\u4ee5\u75311\u4e2a\u795e\u7ecf\u5143\u6765\u8868\u8fbe\u76f8\u540c\u7684\u4e8b\u60c5\uff1b</li> <li>\u5bf9\u4e8esigmoid\u6fc0\u6d3b\u51fd\u6570\uff0c\u5982\u679c\u504f\u54110\u548c1\u7684\u5206\u5e03\uff0c\u4f1a\u5bfc\u81f4\u53cd\u5411\u4f20\u64ad\u65f6\u68af\u5ea6\u4e0d\u65ad\u53d8\u5c0f\uff0c\u6700\u540e\u6d88\u5931\u3002</li> </ul> <p>Xavier \u521d\u59cb\u503c\uff1a\u4ee5\u6fc0\u6d3b\u51fd\u6570\u662f\u7ebf\u6027\u51fd\u6570\u4e3a\u524d\u63d0\u63a8\u5bfc\u51fa\uff0c\u9002\u7528\u4e8e sigmoid \u548ctanh \u6fc0\u6d3b\u51fd\u6570\u3002</p> <ul> <li>\u5982\u679c\u524d\u4e00\u5c42\u7684\u8282\u70b9\u6570\u4e3a n\uff0c\u5219\u521d\u59cb\u5316\u4f7f\u7528\u6807\u51c6\u5dee\u4e3a\\(\\sqrt{1/n}\\)\u7684\u5206\u5e03\u3002\u8bba\u6587\u4e2d\u662f\u524d\u4e00\u5c42\u548c\u540e\u4e00\u5c42\u7684\u8282\u70b9\u6570\u5747\u503c\u7684\u5e73\u65b9\u6839\u3002</li> <li>sigmoid \u548ctanh \u6fc0\u6d3b\u51fd\u6570\u5de6\u53f3\u5bf9\u79f0\uff0c\u4e14\u4e2d\u592e\u9644\u8fd1\u53ef\u4ee5\u89c6\u4f5c\u7ebf\u6027\u51fd\u6570\u3002</li> </ul> <p>Kaiming He \u521d\u59cb\u503c\uff1a\u9488\u5bf9 RELU \u6fc0\u6d3b\u51fd\u6570\uff1a</p> <ul> <li>\u5982\u679c\u524d\u4e00\u5c42\u7684\u8282\u70b9\u6570\u4e3a n\uff0c\u5219\u521d\u59cb\u5316\u4f7f\u7528\u6807\u51c6\u5dee\u4e3a\\(2/\\sqrt{n}\\)\u7684\u5206\u5e03\u3002</li> </ul>"},{"location":"machine_learning/deep_learning/index.html#batch-normalization","title":"Batch Normalization","text":"<p>\u5f3a\u5236\u6027\u8c03\u6574\u6fc0\u6d3b\u503c\u7684\u5206\u5e03\uff0c\u4f7f\u5f97\u5404\u5c42\u6709\u9002\u5f53\u7684\u5e7f\u5ea6\u3002</p> <ul> <li>\u4f7f\u7528\u65b9\u5f0f\uff1aAffine+BatchNorm+ReLU \u8fd8\u662f Affine+ReLU+BatchNorm  \u3002</li> </ul> <p>2015\u5e74\u51fa\u73b0\uff0c\u4f46\u5df2\u5e7f\u6cdb\u4f7f\u7528\u3002\u5176\u4f18\u52bf\uff1a</p> <ul> <li>\u5b66\u4e60\u66f4\u5feb\u901f\uff08\u53ef\u4ee5\u589e\u5927\u5b66\u4e60\u7387\uff09\uff1b</li> <li>\u4e0d\u90a3\u4e48\u4f9d\u8d56\u521d\u59cb\u503c\uff1b</li> <li>\u6291\u5236\u8fc7\u62df\u5408\uff08\u964d\u4f4e Dropout\u7b49\u7684\u5fc5\u8981\u6027\uff09\uff1b</li> </ul> <p>Batch Norm\uff1a\u4ee5\u5b66\u4e60\u65f6\u7684 mini-batch \u4e3a\u5355\u4f4d\uff0c\u6309 mini-batch \u8fdb\u884c\u6b63\u89c4\u5316\uff08\u5747\u503c0\uff0c\u65b9\u5dee1\uff09\u3002</p>"},{"location":"machine_learning/deep_learning/index.html#_11","title":"\u6b63\u5219\u5316","text":"<p>\u89e3\u51b3\u8fc7\u62df\u5408\u7684\u95ee\u9898\uff0c\u4e00\u822c\u901a\u8fc7 L2 \u8303\u5f0f\u3002</p> <p>\u6743\u91cd\u8870\u51cf\u662f\u5e38\u7528\u6291\u5236\u8fc7\u62df\u5408\u7684\u65b9\u6cd5\uff0c\u5bf9\u503c\u8f83\u5927\u7684\u6743\u91cd\u8fdb\u884c\u60e9\u7f5a\uff0c\u6765\u6291\u5236\u8fc7\u62df\u5408\u3002</p> <ul> <li> <p>\u8f83\u5927\u7684\u6743\u91cd\u610f\u5473\u7740\u6a21\u578b\u5bf9\u8f93\u5165\u6570\u636e\u7684\u5fae\u5c0f\u53d8\u5316\u66f4\u654f\u611f\uff0c\u8fc7\u5ea6\u62df\u5408\u566a\u58f0\uff0c\u6cdb\u5316\u80fd\u529b\u4e0b\u964d\uff1b\u6839\u636e\u5965\u5361\u59c6\u5243\u5200\u539f\u7406\uff0c\u7b80\u5355\u6a21\u578b\u66f4\u53ef\u80fd\u6cdb\u5316\u5230\u672a\u77e5\u6570\u636e\u3002</p> </li> <li> <p>\u635f\u5931\u51fd\u6570 += \\(\\frac{1}{2}\\lambda W^2\\)\uff0c\\(L1, L2, L_\\infty\\) \u8303\u6570\u5404\u6709\u7279\u70b9\uff0c\u90fd\u53ef\u4ee5\u7528\u4f5c\u6b63\u5219\u5316\u9879\u3002</p> </li> </ul>"},{"location":"machine_learning/deep_learning/index.html#dropout","title":"Dropout","text":"<p>\u5982\u679c\u7f51\u7edc\u6a21\u578b\u53d8\u5f97\u5f88\u590d\u6742\uff0c\u53ea\u7528\u6743\u503c\u8870\u51cf\u96be\u4ee5\u5e94\u5bf9\u3002\uff08\u53ef\u4ee5\u7528 BatchNorm \u66ff\u4ee3\uff09</p> <p>Dropout \u662f\u4e00\u79cd\u5728\u5b66\u4e60\u7684\u8fc7\u7a0b\u4e2d\u968f\u673a\u5220\u9664\u795e\u7ecf\u5143\u7684\u65b9\u6cd5\u3002</p> <ul> <li>\u8bad\u7ec3\u65f6\uff1a\u6bcf\u6b21\u90fd\u968f\u673a\u9009\u51fa\u9690\u85cf\u5c42\u7684\u795e\u7ecf\u5143\uff0c\u7136\u540e\u5c06\u5176\u5220\u9664\uff0c\u88ab\u5220\u9664\u7684\u795e\u7ecf\u5143\u4e0d\u8fdb\u884c\u4fe1\u53f7\u7684\u4f20\u9012\uff1b</li> <li>\u901a\u8fc7\u5220\u9664\u6bd4\u4f8b\uff0c\u6784\u5efa\u968f\u673a\u7684\u63a9\u7801\u503c\uff0c\u7b5b\u9009\u51fa\u4f20\u9012\u7684\u795e\u7ecf\u5143\u3002\u53cd\u5411\u4f20\u64ad\u65f6\u884c\u4e3a\u8ddfReLU\u76f8\u540c\u3002</li> <li>\u6d4b\u8bd5\u65f6\uff1a\u4f20\u9012\u6240\u6709\u7684\u795e\u7ecf\u5143\u7684\u4fe1\u53f7\uff0c\u4f46\u662f\u5bf9\u4e8e\u5404\u4e2a\u795e\u7ecf\u5143\u7684\u8f93\u51fa\uff0c\u8981\u4e58\u4e0a\u8bad\u7ec3\u65f6\u7684\u5220\u9664\u6bd4\u4f8b\u540e\u518d\u8f93\u51fa\u3002</li> </ul> <p>\u53ef\u4ee5\u7406\u89e3 Dropout \u5c06\u96c6\u6210\u5b66\u4e60\u7684\u6548\u679c\uff08\u6a21\u62df\u5730\uff09\u901a\u8fc7\u4e00\u4e2a\u7f51\u7edc\u5b9e\u73b0\uff1a</p> <ul> <li>\u5b66\u4e60\u8fc7\u7a0b\u4e2d\u968f\u5373\u5220\u9664\u795e\u7ecf\u5143\uff0c\u6bcf\u6b21\u8ba9\u4e0d\u540c\u7684\u6a21\u578b\u8fdb\u884c\u5b66\u4e60\uff1b</li> <li>\u63a8\u7406\u65f6\uff0c\u5bf9\u795e\u7ecf\u5143\u7684\u8f93\u51fa\u4e58\u4ee5\u5220\u9664\u6bd4\u4f8b\uff08\u59820.5\uff09\uff0c\u53ef\u4ee5\u53d6\u5f97\u6a21\u578b\u7684\u5e73\u5747\u503c\u3002</li> </ul>"},{"location":"machine_learning/deep_learning/index.html#_12","title":"\u8d85\u53c2\u6570","text":"<p>\u8c03\u6574\u8d85\u53c2\u6570\u65f6\uff0c\u5fc5\u987b\u4f7f\u7528\u8d85\u53c2\u6570\u4e13\u7528\u7684\u786e\u8ba4\u6570\u636e\uff0c\u88ab\u79f0\u4e3a\u9a8c\u8bc1\u6570\u636e\u3002</p> <ul> <li>\u9a8c\u8bc1\u6570\u636e\u4e0d\u662f\u6d4b\u8bd5\u6570\u636e\uff0c\u4e00\u822c\u4ece\u8bad\u7ec3\u6570\u636e\u4e2d\u8fdb\u884c\u5206\u5272\uff0820%\uff09\u3002</li> </ul> <p>\u8d85\u53c2\u6700\u4f18\u5316\u65b9\u6cd5\uff1a\u7f51\u683c\u641c\u7d22\u3001\u968f\u673a\u91c7\u6837\u3001\u8d1d\u53f6\u65af\u6700\u4f18\u5316</p> <ul> <li>\u786e\u5b9a\u8d85\u53c2\u6570\uff0c\u786e\u5b9a\u5bf9\u6570\u5c3a\u5ea6\uff08\u598210e-3~10e3\uff09\uff0c\u968f\u673a\u751f\u6210\u6307\u6570 \uff1b</li> <li>\u5bf9\u6bcf\u79cd\u8d85\u53c2\u6570\u9009\u62e9\uff0c\u8fd0\u884c\u4e00\u5b9a\u7684 epoch\uff08\u4e0d\u7528\u592a\u591a &lt; 50\uff09\uff0c\u9009\u62e9\u6700\u597d\u7684\u524d\u51e0\u4e2a\uff0c\u786e\u5b9a\u8d85\u53c2\u6570\u8303\u56f4\uff1b</li> <li>\u518d\u6b21\u8fed\u4ee3\uff0c\u4f18\u5316\u8d85\u53c2\u6570\u7684\u9009\u62e9\uff0c\u9010\u6e10\u7f29\u5c0f\u201c\u597d\u503c\u201d\u5b58\u5728\u7684\u8303\u56f4\u3002</li> </ul>"},{"location":"machine_learning/deep_learning/index.html#_13","title":"\u5377\u79ef\u795e\u7ecf\u7f51\u7edc","text":"<p>\u4f7f\u7528\u65b9\u5f0f\uff1aConvolution - ReLU - (Pooling)</p> <ul> <li>\u5377\u79ef\u6838\u7684\u53c2\u6570\u521d\u59cb\u5316\u8ddf\u4e0a\u4e00\u8282\u76f8\u540c\uff0c\u53ef\u4ee5\u91c7\u7528 Xavier /  He \u521d\u59cb\u5316\u3002</li> </ul>"},{"location":"machine_learning/deep_learning/index.html#_14","title":"\u5377\u79ef\u5c42","text":"<p>\u5168\u8fde\u63a5\u5c42\u7684\u95ee\u9898\uff0c\u5728\u4e8e\u5f62\u72b6\u88ab\u5ffd\u89c6\u4e86\u3002\u56fe\u50cf\u662f3\u7ef4\u5f62\u72b6\uff0c\u5f62\u72b6\u4e2d\u542b\u6709\u91cd\u8981\u7684\u7a7a\u95f4\u4fe1\u606f\u3002</p> <ul> <li>\u5982\uff1a\u7a7a\u95f4\u4e0a\u4e34\u8fd1\u7684\u50cf\u7d20\u4e3a\u76f8\u4f3c\u7684\u503c\uff0cRGB\u7684\u5404\u4e2a\u901a\u9053\u4e4b\u95f4\u5206\u522b\u6709\u5bc6\u5207\u7684\u5173\u8054\u6027\u7b49\u3002</li> </ul> <p>\u5377\u79ef\u5c42\u901a\u8fc7\u5c40\u90e8\u611f\u77e5\u3001\u53c2\u6570\u5171\u4eab\u548c\u5e73\u79fb\u4e0d\u53d8\u6027\uff0c\u5728\u56fe\u50cf\u5904\u7406\u3001\u8bed\u97f3\u8bc6\u522b\u7b49\u9886\u57df\u5b9e\u73b0\u4e86\u9ad8\u6548\u7684\u7279\u5f81\u63d0\u53d6\u3002</p> <ul> <li>\u6bcf\u4e2a\u795e\u7ecf\u5143\u4ec5\u8fde\u63a5\u8f93\u5165\u7684\u4e00\u4e2a\u5c40\u90e8\u533a\u57df\uff08\u5982 3\u00d73 \u7684\u56fe\u50cf\u5757\uff09\uff0c\u901a\u8fc7\u6ed1\u52a8\u7a97\u53e3\u63d0\u53d6\u5c40\u90e8\u7279\u5f81\uff08\u5982\u8fb9\u7f18\u3001\u7eb9\u7406\uff09\uff1b</li> <li>\u540c\u4e00\u5377\u79ef\u6838\u7684\u53c2\u6570\u5728\u6574\u4e2a\u8f93\u5165\u4e0a\u5171\u4eab\uff0c\u5927\u5e45\u51cf\u5c11\u53c2\u6570\u91cf\uff1b</li> <li>\u5bf9\u8f93\u5165\u4e2d\u7684\u5e73\u79fb\u6a21\u5f0f\uff08\u5982\u7269\u4f53\u4f4d\u7f6e\u53d8\u5316\uff09\u5177\u6709\u5929\u7136\u7684\u9c81\u68d2\u6027\u3002</li> </ul> <p>\u5377\u79ef\u8fd0\u7b97\uff1a\u4e58\u79ef\u7d2f\u52a0\u8fd0\u7b97\u3002\u586b\u5145\uff08padding\uff09\u662f\u6307\u5728\u8f93\u5165\u9ad8\u548c\u5bbd\u7684\u4e24\u4fa7\u586b\u5145\u5143\u7d20\uff08\u901a\u5e38\u662f0\u5143\u7d20\uff09\u3002\u6bcf\u6b21\u6ed1\u52a8\u7684\u884c\u6570\u548c\u5217\u6570\u79f0\u4e3a\u6b65\u5e45\uff08stride\uff09\u3002</p> <p></p> <p>\u5047\u8bbe\u8f93\u5165\u5927\u5c0f\u662f(H, W)\uff0c\u6ee4\u6ce2\u5668\uff08\u6838\uff09\u5927\u5c0f\u4e3a(FH, FW)\uff0c\u8f93\u51fa\u5927\u5c0f\u4e3a(OH, OW)\uff0c\u586b\u5145\u4e3aP\uff0c\u6b65\u5e45\u4e3aS\u3002 $$ OH=\\frac{H+2P-FH}{S}+1 \\ OW=\\frac{W+2P-FW}{S}+1 $$ 3\u7ef4\u6570\u636e\u7684\u5377\u79ef\u4e2d\uff08\u901a\u9053\uff09\uff0c\u8f93\u5165\u6570\u636e\u548c\u6ee4\u6ce2\u5668\u7684\u901a\u9053\u6570\u8981\u4e3a\u540c\u6837\u7684\u503c\uff0c\u6bcf\u4e2a\u6ee4\u6ce2\u5668\u5927\u5c0f\u8981\u4e00\u81f4\u3002\u5377\u79ef\u8fd0\u7b97\u4e2d\u4e5f\u5b58\u5728\u504f\u7f6e\uff0c\u6bcf\u4e2a\u901a\u9053\u53ea\u6709\u4e00\u4e2a\u504f\u7f6e\u7684\u503c\u3002</p> <p>\u6279\u5904\u7406(mini-batch)\u7684\u652f\u6491\uff1a</p> <ul> <li>\u6309 (batch_num, channel, height, width) \u7684\u987a\u5e8f\u4fdd\u5b58\u6570\u636e</li> </ul> <p></p>"},{"location":"machine_learning/deep_learning/index.html#_15","title":"\u6c60\u5316\u5c42","text":"<p>\u6c60\u5316\u662f\u7f29\u5c0f\u9ad8\u3001\u957f\u65b9\u5411\u4e0a\u7684\u7a7a\u95f4\u7684\u8fd0\u7b97\u3002Max \u6c60\u5316\u662f\u4ece\u76ee\u6807\u533a\u57df\u4e2d\u53d6\u51fa\u6700\u5927\u503c\u3002Average \u6c60\u5316\u5219\u662f\u8ba1\u7b97\u76ee\u6807\u533a\u57df\u7684\u5e73\u5747\u503c\u3002\u5728\u56fe\u50cf\u8bc6\u522b\u9886\u57df\uff0c\u4e3b\u8981\u4f7f\u7528 Max \u6c60\u5316\u3002</p> <ul> <li>\u6c60\u5316\u5c42\u548c\u5377\u79ef\u5c42\u4e0d\u540c\uff0c\u6ca1\u6709\u8981\u5b66\u4e60\u7684\u53c2\u6570\u3002</li> <li>\u7ecf\u8fc7\u6c60\u5316\u8fd0\u7b97\uff0c\u8f93\u5165\u6570\u636e\u548c\u8f93\u51fa\u6570\u636e\u7684\u901a\u9053\u6570\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\uff0c\u662f\u6309\u901a\u9053\u72ec\u7acb\u8fdb\u884c\u3002</li> <li>\u5bf9\u5fae\u5c0f\u7684\u4f4d\u7f6e\u53d8\u5316\u5177\u6709\u9c81\u68d2\u6027\uff08\u5065\u58ee\uff09</li> </ul>"},{"location":"machine_learning/deep_learning/index.html#_16","title":"\u5b9e\u73b0\u7ec6\u8282","text":"<p><code>im2col</code> \u4f1a\u628a\u8f93\u5165\u6570\u636e\u5c55\u5f00\u4ee5\u9002\u5408\u6ee4\u6ce2\u5668\uff08\u6743\u91cd\uff09\uff0c\u5bf9\u4e8e\u8f93\u5165\u6570\u636e\uff0c\u5c06\u5e94\u7528\u6ee4\u6ce2\u5668\u7684\u533a\u57df\uff083 \u7ef4\u65b9\u5757\uff09\u6a2a\u5411\u5c55\u5f00\u4e3a 1 \u884c\u3002</p> <ul> <li>\u5185\u5b58\u6d88\u8017\u5927\uff0c\u5c55\u5f00\u540e\u7684\u5143\u7d20\u591a\u4f59\u539f\u65b9\u5757\u7684\u5143\u7d20\u4e2a\u6570\u3002</li> </ul> <p></p> <p>\u5c06\u5377\u79ef\u5c42\u7684\u6ee4\u6ce2\u5668\uff08\u6743\u91cd\uff09\u7eb5\u5411\u5c55\u5f00\u4e3a 1 \u5217\uff0c\u5e76\u8ba1\u7b97 2 \u4e2a\u77e9\u9635\u7684\u4e58\u79ef\u5373\u53ef\u3002</p> <p></p> <p>\u5377\u79ef\u5c42\u7684\u53cd\u5411\u4f20\u64ad\u9664\u4e86\u9700\u8981\u5b9e\u73b0col2img\u5916\uff0c\u5176\u5b83\u7684\u8ddf Affine \u5c42\u4e00\u81f4\u3002</p> <p>\u6c60\u5316\u5c42\u7684\u6570\u636e\u5c55\u5f00\uff0c\u5728\u901a\u9053\u65b9\u5411\u662f\u72ec\u7acb\u7684\u3002\u4e0b\u9762\u662f\u6c60\u5316\u5c42\u7684\u5b9e\u73b0\u6d41\u7a0b\u793a\u4f8b\uff1a\u6c60\u5316\u7684\u5e94\u7528\u533a\u57df\u5185\u7684\u6700\u5927\u503c\u5143\u7d20\u7528\u7070\u8272\u8868\u793a</p> <p></p> <p>\u6c60\u5316\u5c42\u7684\u53cd\u5411\u4f20\u64ad\uff1a</p> <ul> <li>\u6700\u5927\u6c60\u5316\uff1a\u4ec5\u5bf9\u524d\u5411\u4f20\u64ad\u4e2d\u88ab\u9009\u4e2d\u7684\u6700\u5927\u503c\u4f4d\u7f6e\u5206\u914d\u68af\u5ea6\uff0c\u5176\u4f59\u4f4d\u7f6e\u68af\u5ea6\u4e3a 0\u3002</li> </ul>"},{"location":"machine_learning/deep_learning/index.html#cnn","title":"CNN\u53ef\u89c6\u5316","text":"<p>\u5c06\u5377\u79ef\u5c42\u7684\u6ee4\u6ce2\u5668\u663e\u793a\u4e3a\u56fe\u50cf\u3002\u901a\u8fc7\u5b66\u4e60\uff0c\u6ee4\u6ce2\u5668\u88ab\u66f4\u65b0\u6210\u4e86\u6709\u89c4\u5f8b\u7684\u6ee4\u6ce2\u5668\uff0c\u6bd4\u5982\u4ece\u767d\u5230\u9ed1\u6e10\u53d8\u7684\u6ee4\u6ce2\u5668\u3001\u542b\u6709\u5757\u72b6\u533a\u57df\uff08\u79f0\u4e3a blob\uff09\u7684\u6ee4\u6ce2\u5668\u7b49\u3002</p> <p>\u5c06 mnist \u7684CNN \u7b2c 1 \u5c42\u6743\u91cd\u7684\u53ef\u89c6\u5316\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u5c06\u4e0a\u9762\u6ee4\u6ce2\u5668\u5e94\u7528\u5230 lena \u56fe\u50cf\uff0c\u53ef\u4ee5\u770b\u51fa\u4e0d\u540c\u7684\u6ee4\u6ce2\u5668\u63d0\u53d6\u4e0d\u540c\u7684\u7279\u5f81\u3002</p> <p></p> <p>\u4e0a\u9762\u7684\u7ed3\u679c\u662f\u9488\u5bf9\u7b2c 1 \u5c42\u7684\u5377\u79ef\u5c42\u5f97\u51fa\u7684\u3002\u7b2c 1 \u5c42\u7684\u5377\u79ef\u5c42\u4e2d\u63d0\u53d6\u4e86\u8fb9\u7f18\u6216\u6591\u5757\u7b49\u201c\u4f4e\u7ea7\u201d\u4fe1\u606f\uff0c\u90a3\u4e48\u5728\u5806\u53e0\u4e86\u591a\u5c42\u7684 CNN \u4e2d\uff0c\u5404\u5c42\u4e2d\u53c8\u4f1a\u63d0\u53d6\u4ec0\u4e48\u6837\u7684\u4fe1\u606f\u5462\uff1f</p> <p>\u4e0b\u56fe \u4e2d\u5c55\u793a\u4e86\u8fdb\u884c\u4e00\u822c\u7269\u4f53\u8bc6\u522b\uff08\u8f66\u6216\u72d7\u7b49\uff09\u7684 8 \u5c42 CNN\uff08AlexNet\uff09\u3002</p> <ul> <li>CNN \u7684\u5377\u79ef\u5c42\u4e2d\u63d0\u53d6\u7684\u4fe1\u606f\u3002\u7b2c 1 \u5c42\u7684\u795e\u7ecf\u5143\u5bf9\u8fb9\u7f18\u6216\u6591\u5757\u6709\u54cd\u5e94\uff0c\u7b2c 3 \u5c42\u5bf9\u7eb9\u7406\u6709\u54cd\u5e94\uff0c\u7b2c 5 \u5c42\u5bf9\u7269\u4f53\u90e8\u4ef6\u6709\u54cd\u5e94\uff0c\u6700\u540e\u7684\u5168\u8fde\u63a5\u5c42\u5bf9\u7269\u4f53\u7684\u7c7b\u522b\uff08\u72d7\u6216\u8f66\uff09\u6709\u54cd\u5e94\u3002</li> </ul> <p></p> <p>\u5177\u6709\u4ee3\u8868\u6027\u7684 CNN</p> <p>1998 \u5e74\u9996\u6b21\u88ab\u63d0\u51fa\u7684 CNN \u5143\u7956 LeNet\uff0c2012 \u5e74\u88ab\u63d0\u51fa\u7684 AlexNet\u3002AlexNet \u5bf9\u6bd4 LeNet \u7684\u533a\u522b\uff1a</p> <ul> <li>\u6fc0\u6d3b\u51fd\u6570\u4f7f\u7528 ReLU\u3002</li> <li>\u4f7f\u7528\u8fdb\u884c\u5c40\u90e8\u6b63\u89c4\u5316\u7684 LRN\uff08Local Response Normalization\uff09\u5c42\u3002</li> <li>\u4f7f\u7528 Dropout\u3002</li> </ul>"},{"location":"machine_learning/deep_learning/index.html#_17","title":"\u6df1\u5ea6\u5b66\u4e60","text":""},{"location":"machine_learning/deep_learning/index.html#_18","title":"\u52a0\u6df1\u7f51\u7edc","text":"<p>\u56fe\u50cf\u5206\u7c7b\u7684 states of art</p> <p>\u8fdb\u4e00\u6b65\u63d0\u9ad8\u7cbe\u5ea6\u8bc6\u522b\u7684\u6280\u672f\uff1a\u96c6\u6210\u5b66\u4e60\u3001\u5b66\u4e60\u7387\u8870\u51cf\u3001\u6570\u636e\u6269\u5145(Data Augmentation)</p> <ul> <li>Data Augmentation\uff1a\u201c\u4eba\u4e3a\u5730\u201d\u6269\u5145\u8bad\u7ec3\u56fe\u50cf\uff0c\u91c7\u7528\u65cb\u8f6c\u3001\u5e73\u79fb\u3001\u88c1\u526a\u3001\u7ffb\u8f6c\u3001\u4eae\u5ea6\u53d8\u5316\u7b49\u65b9\u6cd5\u3002</li> </ul> <p>\u52a0\u6df1\u5c42\u7684\u91cd\u8981\u6027\uff1a\u7406\u8bba\u7814\u7a76\u5c1a\u4e0d\u591f\u900f\u5f7b\uff08\u622a\u6b622015\u5e74\uff09</p> <ul> <li>\u4e4b\u524d\u7684\u7814\u7a76\u548c\u5b9e\u9a8c\uff08\u5982\u5377\u79ef\u5c42\u7684\u53ef\u89c6\u5316\uff09\u53ef\u4ee5\u89e3\u91ca\uff1b</li> <li>\u57fa\u4e8e\u6bd4\u8d5b\u7ed3\u679c\uff0c\u5c42\u6b21\u8d8a\u6df1\uff0c\u8bc6\u522b\u6027\u80fd\u8d8a\u9ad8\uff1b</li> </ul> <p>\u52a0\u6df1\u5c42\u7684\u597d\u5904\uff1a</p> <ul> <li>\u51cf\u5c11\u7f51\u7edc\u53c2\u6570\u6570\u91cf\uff1a\u5982\u4e00\u6b215 * 5\u7684\u5377\u79ef\u8fd0\u7b97\u7684\u533a\u57df\u7b49\u4ef7\u4e8e\u4e24\u6b213 * 3\u7684\u5377\u79ef\u8fd0\u7b97\uff1b</li> <li>\u901a\u8fc7\u52a0\u6df1\u5c42\uff0c\u53ef\u4ee5\u5206\u5c42\u6b21\u5730\u4f20\u9012\u4fe1\u606f\uff1b</li> </ul>"},{"location":"machine_learning/deep_learning/index.html#_19","title":"\u4e3b\u6d41\u7f51\u7edc\u67b6\u6784\u5386\u53f2","text":"<p>\u56fe\u50cf\u8bc6\u522b\uff1a2012\u5e74 AlexNet\uff0c2014\u5e74 VGG / GoogleNet\uff0c2015\u5e74 ResNet\u3002</p> <ul> <li>VGG \u91c7\u7528\u8fde\u7eed\u7684\u51e0\u4e2a3x3\u7684\u5377\u79ef\u6838\u4ee3\u66ffAlexNet\u4e2d\u7684\u8f83\u5927\u5377\u79ef\u6838\uff0811x11\uff0c7x7\uff0c5x5\uff09\uff0c\u6b65\u5e451\uff0cpadding1\uff0c\u56fe\u50cf\u7684\u957f\u5bbd\u4e0d\u53d8\uff1b</li> </ul> <p></p> <ul> <li> <p>GoogleNet\uff1a\u4e0d\u4ec5\u5728\u7eb5\u5411\u4e0a\u6709\u6df1\u5ea6\uff0c\u6a2a\u5411\u4e0a\u4e5f\u6709\u6df1\u5ea6\uff08\u5e7f\u5ea6\uff09\uff0c\u91c7\u7528Inception\u7ed3\u6784\uff1a</p> </li> <li> <p>1 * 1 \u7684\u5377\u79ef\u6838\u53ef\u4ee5\u51cf\u5c11\u53c2\u6570\u548c\u5b9e\u73b0\u9ad8\u5ea6\u5316\u5904\u7406\uff1b</p> </li> </ul> <p></p> <ul> <li> <p>ResNet\uff1a\u6b8b\u5dee\u795e\u7ecf\u7f51\u7edc\uff0c\u53d1\u73b0\u4e86\u201c\u9000\u5316\u73b0\u8c61\uff08Degradation\uff09\u201d\uff0c\u5e76\u9488\u5bf9\u9000\u5316\u73b0\u8c61\u53d1\u660e\u4e86 \u201c\u5feb\u6377\u8fde\u63a5\uff08Shortcut connection\uff09\u201d\uff0c\u6781\u5927\u7684\u6d88\u9664\u4e86\u6df1\u5ea6\u8fc7\u5927\u7684\u795e\u7ecf\u7f51\u7edc\u8bad\u7ec3\u56f0\u96be\u95ee\u9898</p> </li> <li> <p>\u6df1\u5c42\u795e\u7ecf\u7f51\u7edc\u96be\u4ee5\u5b9e\u73b0\u201c\u6052\u7b49\u53d8\u6362\uff08y=x\uff09\u201d\uff1a\u968f\u7740\u7f51\u7edc\u6df1\u5ea6\u7684\u4e0d\u65ad\u589e\u5927\uff0c\u6240\u5f15\u5165\u7684\u6fc0\u6d3b\u51fd\u6570\u4e5f\u8d8a\u6765\u8d8a\u591a\uff0c\u6570\u636e\u88ab\u6620\u5c04\u5230\u66f4\u52a0\u79bb\u6563\u7684\u7a7a\u95f4\uff0c\u6b64\u65f6\u5df2\u7ecf\u96be\u4ee5\u8ba9\u6570\u636e\u56de\u5230\u539f\u70b9\uff08\u6052\u7b49\u53d8\u6362\uff09\uff1b</p> </li> <li>\u63d0\u51faresidual\u7ed3\u6784\uff08\u6b8b\u5dee\u7ed3\u6784\uff09\uff0c\\(y=F(x)+x\\)\uff0c\u5e76\u642d\u5efa\u8d85\u6df1\u7684\u7f51\u7edc\u7ed3\u6784(\u7a81\u78341000\u5c42)\uff1b</li> <li>\u4f7f\u7528Batch Normalization\u52a0\u901f\u8bad\u7ec3(\u4e22\u5f03dropout)\uff1b</li> </ul> <p></p>"},{"location":"machine_learning/deep_learning/index.html#_20","title":"\u9ad8\u901f\u5316\u5b66\u4e60","text":"<p>AlexNet \u4e2d\uff0c\u5377\u79ef\u5c42\u7684\u5904\u7406\u65f6\u95f4\u5360\u636eGPU\u6574\u4f53\u65f6\u95f4 95%\uff0cCPU\u6574\u4f53\u65f6\u95f4 89%\u3002</p> <ul> <li>\u5982\u4f55\u9ad8\u901f\u3001\u9ad8\u6548\u5730\u8fdb\u884c\u5927\u91cf\u7684\u4e58\u79ef\u7d2f\u52a0\u8fd0\u7b97\u3002</li> </ul> <p>\u5206\u5e03\u5f0f\u673a\u5668\u5b66\u4e60\uff1a</p> <ul> <li>\u9700\u8981\u89e3\u51b3\u673a\u5668\u95f4\u7684\u901a\u4fe1\u3001\u6570\u636e\u540c\u6b65\u7b49\u591a\u4e2a\u96be\u9898\uff1b</li> </ul> <p>\u8fd0\u7b97\u7cbe\u5ea6\u7684\u4f4d\u6570\u7f29\u51cf\uff1a\u6df1\u5ea6\u5b66\u4e60\u4e2d\u4f7f\u752816\u4f4d\u7684\u534a\u7cbe\u5ea6\u6d6e\u70b9\u6570\u4e5f\u53ef\u4ee5\u987a\u5229\u5b66\u4e60\u3002</p> <ul> <li>\u6df1\u5ea6\u5b66\u4e60\u4e0d\u90a3\u4e48\u9700\u8981\u6570\u636e\u7cbe\u5ea6\u7684\u4f4d\u6570\uff0c\u8fd9\u662f\u57fa\u4e8e\u795e\u7ecf\u7f51\u7edc\u7684\u5065\u58ee\u6027\uff08\u5373\u4fbf\u8f93\u5165\u56fe\u50cf\u9644\u6709\u4e00\u4e9b\u5c0f\u7684\u566a\u58f0\uff0c\u8f93\u51fa\u7ed3\u679c\u4ecd\u7136\u4fdd\u6301\u4e0d\u53d8\uff09\u3002</li> </ul>"},{"location":"machine_learning/deep_learning/index.html#_21","title":"\u5e94\u7528\u6848\u4f8b","text":"<p>\u7269\u4f53\u68c0\u6d4b\uff1aR-CNN\u3001Faster R-CNN\u3002</p> <p>\u56fe\u50cf\u5206\u5272\uff1aFCN\u65b9\u6cd5\uff08Fully Convolution Network\uff0c\u5168\u90e8\u7531\u5377\u79ef\u5c42\u6784\u6210\u7684\u7f51\u7edc\uff09\uff0cFNC\u5c06\u5168\u8fde\u63a5\u5c42\u6362\u6210\u53d1\u6325\u76f8\u540c\u4f5c\u7528\u7684\u5377\u79ef\u5c42\u3002</p> <p>\u56fe\u50cf\u6807\u9898\u751f\u6210\uff1aNIC\uff08Neural Image Caption\uff09\uff0c\u7531\u6df1\u5c42\u7684CNN\u548c\u5904\u7406\u81ea\u7136\u8bed\u8a00\u7684RNN\uff08Recurrent Neural Network\uff09\u6784\u6210\u3002</p> <p>\u56fe\u50cf\u98ce\u683c\u53d8\u5316\uff1a\"A neural Algorithm f Artistic Style\".</p> <p>\u56fe\u50cf\u751f\u6210\uff1aDCGAN\uff08Deep Convolutional Generative Adversarial Network\uff09</p> <p>\u81ea\u52a8\u9a7e\u9a76\uff1a</p>"},{"location":"machine_learning/deep_learning/index.html#_22","title":"\u591a\u6a21\u6001","text":"<p>\u7ec4\u5408\u56fe\u50cf\u548c\u81ea\u7136\u8bed\u8a00\u7b49\u591a\u79cd\u4fe1\u606f\u8fdb\u884c\u7684\u5904\u7406\u6210\u4e3a\u591a\u6a21\u6001\u5904\u7406\u3002</p>"},{"location":"machine_learning/deep_learning/index.html#_23","title":"\u751f\u6210\u5bf9\u6297\u7f51\u7edc","text":""},{"location":"machine_learning/deep_learning/index.html#_24","title":"\u8fc1\u79fb\u5b66\u4e60","text":"<p>\u8fc1\u79fb\u5b66\u4e60\uff1a\u5c06\u5b66\u4e60\u5b8c\u7684\u6743\u91cd\uff08\u7684\u4e00\u90e8\u5206\uff09\u590d\u5236\u5230\u5176\u5b83\u795e\u7ecf\u7f51\u7edc\uff0c\u8fdb\u884c\u5728\u5b66\u4e60\uff08fine tuning\uff09\u3002</p> <ul> <li>\u9002\u7528\u4e8e\u624b\u5934\u6570\u636e\u96c6\u8f83\u5c11\u65f6\uff0c\u6bd4\u8f83\u6709\u6548\u679c\u3002</li> </ul>"},{"location":"machine_learning/deep_learning/index.html#_25","title":"\u5f3a\u5316\u5b66\u4e60","text":"<p>\u4ee3\u7406\uff08Agent\uff09\u6839\u636e\u73af\u5883\u9009\u62e9\u884c\u52a8\uff0c\u7136\u540e\u901a\u8fc7\u8fd9\u4e2a\u884c\u52a8\u6539\u53d8\u73af\u5883\u3002</p> <p>Deep Q-Network\uff08\u7b80\u79f0\uff1aDQN\uff09\uff0c\u57fa\u4e8e\u88ab\u79f0\u4e3aQ\u5b66\u4e60\u7684\u5f3a\u5316\u5b66\u4e60\u7b97\u6cd5\uff0c\u5728Q\u7684\u5b66\u4e60\u4e2d\uff0c\u4e3a\u786e\u5b9a\u5408\u9002\u7684\u884c\u52a8\uff0c\u9700\u8981\u786e\u5b9a\u4e00\u4e2a\u88ab\u79f0\u4e3a\u6700\u4f18\u884c\u52a8\u4ef7\u503c\u7684\u51fd\u6570\uff0c\u4e3a\u8fd1\u4f3c\u8fd9\u4e2a\u51fd\u6570\uff0c\u53c8\u4f7f\u7528\u7684\u6df1\u5ea6\u5b66\u4e60CNN\u3002</p>"},{"location":"machine_learning/deep_learning/index.html#_26","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>\u300a\u6df1\u5ea6\u5b66\u4e60\u5165\u95e8\uff1a\u57fa\u4e8ePython\u7684\u7406\u8bba\u4e0e\u5b9e\u73b0\u300b. \u658b\u85e4\u5eb7\u6bc5\uff0c\u9646\u5b87\u6770 (\u8bd1). \u4eba\u6c11\u90ae\u7535\u51fa\u7248\u793e.</li> </ol>"},{"location":"machine_learning/deep_learning/activate_functions.html","title":"\u6fc0\u6d3b\u51fd\u6570","text":"<p>\u4f5c\u4e3a\u51b3\u5b9a\u795e\u7ecf\u7f51\u7edc\u662f\u5426\u4f20\u9012\u4fe1\u606f\u7684\u300c\u5f00\u5173\u300d\uff0c\u6fc0\u6d3b\u51fd\u6570\u5bf9\u4e8e\u795e\u7ecf\u7f51\u7edc\u800c\u8a00\u81f3\u5173\u91cd\u8981\u3002</p> <ul> <li>\u8d8a\u9636\u51fd\u6570\u65e0\u6cd5\u8fdb\u884c\u53cd\u5411\u4f20\u64ad\u3002</li> <li>\u968f\u7740\u7f51\u7edc\u6df1\u5ea6\u7684\u4e0d\u65ad\u589e\u52a0\uff0c\u5229\u7528 Sigmoid \u6fc0\u6d3b\u51fd\u6570\u6765\u8bad\u7ec3\u8bc1\u5b9e\u4e0d\u5982\u975e\u5e73\u6ed1\u3001\u4f4e\u6982\u7387\u6027\u7684 ReLU \u6709\u6548\u3002</li> </ul> <p>\u5e38\u89c1\u7684\u6fc0\u6d3b\u51fd\u6570\u6709\uff1a</p> <ul> <li>Sigmod\u3001tanh\u3001RELU\u3001GELU</li> </ul> <p>\u5bf9\u6bd4\u5982\u4e0b\uff1a\u4e00\u822c\u4f7f\u7528 RELU \u53ca\u5176\u53d8\u79cd\uff1b</p> <p></p>"},{"location":"machine_learning/deep_learning/activate_functions.html#sigmoid","title":"Sigmoid","text":"<p>\u65e9\u671f\u4eba\u5de5\u795e\u7ecf\u5143\u4f7f\u7528\u4e8c\u5143\u9608\u503c\u5355\u5143\uff08Hopfield, 1982; McCulloch &amp; Pitts, 1943\uff09\u3002\u4e8c\u5143\u51b3\u7b56\u901a\u8fc7 Sigmoid \u6fc0\u6d3b\u51fd\u6570\u8fdb\u884c\u5e73\u6ed1\u5316\uff0c\u4ece\u800c\u5177\u6709\u975e\u5e38\u5feb\u7684\u89e3\u7801\u901f\u5ea6\uff0c\u5e76\u53ef\u4ee5\u5229\u7528\u53cd\u5411\u4f20\u64ad\u8fdb\u884c\u8bad\u7ec3\u3002</p> <ul> <li> <p>\u8fde\u7eed\u51fd\u6570\uff0c\u4fbf\u4e8e\u6c42\u5bfc\uff1b</p> </li> <li> <p>\u5bb9\u6613\u9020\u6210\u68af\u5ea6\u6d88\u5931\uff1a\u53d8\u91cf\u5927\u7684\u6b63\u503c\u6216\u8d1f\u503c\u65f6\u4f1a\u51fa\u73b0\u9971\u548c\u73b0\u8c61\uff0c\u5bf9\u8f93\u5165\u7684\u5fae\u5c0f\u6539\u53d8\u4f1a\u53d8\u5f97\u4e0d\u654f\u611f\uff1b</p> </li> <li>\u51fd\u6570\u7684\u8f93\u51fa\u4e0d\u662f\u96f6\u4e2d\u5fc3\uff1a\u6bcf\u5c42\u7684\u6743\u91cd\u7684\u66f4\u65b0\u65b9\u5411\u662f\u4e00\u6837\u7684\uff0c\u5bfc\u81f4Z\u578b\u8def\u7ebf\uff0c\u6a21\u578b\u6536\u655b\u901f\u5ea6\u6162\uff1b</li> <li> <p>sigmoid \u51fd\u6570\u7684\u5bfc\u6570\u662f\u6b63\u7684\uff0c\\(\u03c3\u2032(x)=\u03c3(x)(1\u2212\u03c3(x))\\)</p> </li> <li> <p>\u8ba1\u7b97\u590d\u6742\u5ea6\u9ad8\uff1a\u6307\u6570\u5f62\u5f0f\uff1b</p> </li> </ul> \\[ sigmoid(x) = \\frac{1}{1+exp(-x)} \\]"},{"location":"machine_learning/deep_learning/activate_functions.html#tanh","title":"Tanh","text":"<p>\u4ee5 0 \u4e3a\u4e2d\u5fc3\uff0c\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0ctanh\u4f1a\u6bd4sigmoid\u66f4\u597d\u4e00\u4e9b\u3002\u4f46\u662f\u5728\u9971\u548c\u795e\u7ecf\u5143\u7684\u60c5\u51b5\u4e0b\uff0ctanh\u8fd8\u662f\u6ca1\u6709\u89e3\u51b3\u68af\u5ea6\u6d88\u5931\u95ee\u9898\u3002 $$ f(x) = \\frac{e^x-e^{-x}}{e^x+e^{-x}}=2 * sigmoid(2x)-1 $$</p>"},{"location":"machine_learning/deep_learning/activate_functions.html#relu","title":"RELU","text":"<p>RELU \u6574\u6d41\u7ebf\u6027\u5355\u5143\uff08Rectified linear unit\uff09\u662f\u4eba\u5de5\u795e\u7ecf\u7f51\u7edc\u4e2d\u6700\u5e38\u7528\u7684\u6fc0\u6d3b\u51fd\u6570\uff08activation function\uff09\uff0c\u901a\u5e38\u6307\u4ee3\u4ee5\u300c\u659c\u5761\u300d\u51fd\u6570\u53ca\u5176\u53d8\u79cd\u4e3a\u4ee3\u8868\u7684\u975e\u7ebf\u6027\u51fd\u6570\u65cf\u3002</p> <ul> <li>\u53ef\u4ee5\u5bf9\u6297\u68af\u5ea6\u7206\u70b8/\u6d88\u5931\u95ee\u9898\uff0c\u8ba1\u7b97\u6548\u7387\u4e5f\u5f88\u9ad8\uff1b</li> <li>\u5728x&gt;0\u533a\u57df\u4e0a\uff0c\u4e0d\u4f1a\u51fa\u73b0\u68af\u5ea6\u9971\u548c\u3001\u68af\u5ea6\u6d88\u5931\u7684\u95ee\u9898\uff1b</li> <li>\u8f93\u51fa\u4e0d\u662f0\u5747\u503c\uff1a\u8ddf sigmoid \u73b0\u8c61\u4e00\u81f4\uff1b</li> <li>Dead ReLU Problem(\u795e\u7ecf\u5143\u574f\u6b7b\u73b0\u8c61)\uff1a\u5728x&lt;0\u65f6\uff0c\u68af\u5ea6\u4e3a0\u3002\u8fd9\u4e2a\u795e\u7ecf\u5143\u53ca\u4e4b\u540e\u7684\u795e\u7ecf\u5143\u68af\u5ea6\u6c38\u8fdc\u4e3a0\uff0c\u4e0d\u518d\u5bf9\u4efb\u4f55\u6570\u636e\u6709\u6240\u54cd\u5e94\uff0c\u5bfc\u81f4\u76f8\u5e94\u53c2\u6570\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u66f4\u65b0\u3002</li> <li>\u539f\u56e0\uff1a\u53c2\u6570\u521d\u59cb\u5316\u95ee\u9898\uff1blearning rate\u592a\u9ad8\u5bfc\u81f4\u5728\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\u53c2\u6570\u66f4\u65b0\u592a\u5927</li> <li>\u89e3\u51b3\u65b9\u6cd5\uff1a\u91c7\u7528Xavier\u521d\u59cb\u5316\u65b9\u6cd5\uff0c\u4ee5\u53ca\u907f\u514d\u5c06learning rate\u8bbe\u7f6e\u592a\u5927\u6216\u4f7f\u7528adagrad\u7b49\u81ea\u52a8\u8c03\u8282learning rate\u7684\u7b97\u6cd5\u3002</li> </ul> \\[ f(x) = max(0, x) \\]"},{"location":"machine_learning/deep_learning/activate_functions.html#leaky-relu","title":"Leaky ReLU","text":"<p>\u4e3a\u4e86\u89e3\u51b3 dead ReLU \u7684\u95ee\u9898\u3002</p> <p>\u7528\u4e00\u4e2a\u7c7b\u4f3c0.01\u7684\u5c0f\u503c\u6765\u521d\u59cb\u5316\u795ed\u7ecf\u5143\uff0c\u4ece\u800c\u4f7f\u5f97ReLU\u5728\u8d1f\u6570\u533a\u57df\u66f4\u504f\u5411\u4e8e\u6fc0\u6d3b\u800c\u4e0d\u662f\u6b7b\u6389\u3002\u8fd9\u91cc\u7684\u659c\u7387\u90fd\u662f\u786e\u5b9a\u7684\u3002</p> <ul> <li>\u7f3a\u70b9\u5c31\u662f\u5b83\u6709\u4e9b\u8fd1\u4f3c\u7ebf\u6027\uff0c\u5bfc\u81f4\u5728\u590d\u6742\u5206\u7c7b\u4e2d\u6548\u679c\u4e0d\u597d\u3002</li> </ul> \\[ f(x)=max(\\alpha{x}, x) \\]"},{"location":"machine_learning/deep_learning/activate_functions.html#prelu","title":"PRelu","text":"<p>\u89e3\u51b3 Leaky ReLU \u7684\u659c\u7387\u53c2\u6570\u662f\u56fa\u5b9a\u503c\u7684\u95ee\u9898\u3002</p> \\[ f(\\alpha, x) = \\begin{cases} \\alpha x, &amp; x &gt; 0 \\\\ x &amp; x \\leq 0 \\end{cases} \\] <p>\u6fc0\u6d3b\u51fd\u6570\u8d1f\u534a\u8f74\u7684\u659c\u7387\u53c2\u6570\u03b1 \u662f\u901a\u8fc7\u5b66\u4e60\u5f97\u5230\u7684\uff0c\u800c\u4e0d\u662f\u624b\u52a8\u8bbe\u7f6e\u7684\u6052\u5b9a\u503c\u3002</p>"},{"location":"machine_learning/deep_learning/activate_functions.html#elu","title":"ELU","text":"<ul> <li>\u6709\u8d1f\u6570\u9971\u548c\u533a\u57df\uff0c\u4ece\u800c\u5bf9\u566a\u58f0\u6709\u4e00\u4e9b\u9c81\u68d2\u6027</li> <li>\u8ba1\u7b97\u91cf\u4e0a\u66f4\u5927</li> </ul> \\[ f(x) = \\begin{cases} x &amp; x &gt; 0 \\\\  \\alpha{(e^x-1)}, &amp; x &lt;= 0 \\end{cases} \\] <p>ELU\u6fc0\u6d3b\u51fd\u6570\u7684\u8d1f\u534a\u8f74\u662f\u4e00\u4e2a\u6307\u6570\u51fd\u6570\u800c\u4e0d\u662f\u4e00\u6761\u76f4\u7ebf\u3002</p>"},{"location":"machine_learning/deep_learning/activate_functions.html#gelu","title":"GELU","text":"<p>GELU : Gaussian Error Linear Units.</p> <p>BERT\u3001RoBERTa\u3001ALBERT \u7b49\u76ee\u524d\u4e1a\u5185\u9876\u5c16\u7684 NLP \u6a21\u578b\u90fd\u4f7f\u7528\u4e86\u8fd9\u79cd\u6fc0\u6d3b\u51fd\u6570\u3002</p> <p>GELU(\u9ad8\u65af\u8bef\u5dee\u7ebf\u6027\u5355\u5143\u6fc0\u6d3b\u51fd\u6570) \u4e0e\u968f\u673a\u6b63\u5219\u5316\u6709\u5173\uff0c\u56e0\u4e3a\u5b83\u662f\u81ea\u9002\u5e94 Dropout \u7684\u4fee\u6b63\u9884\u671f\uff08Ba &amp; Frey, 2013\uff09\u3002\u8fd9\u8868\u660e\u795e\u7ecf\u5143\u8f93\u51fa\u7684\u6982\u7387\u6027\u66f4\u9ad8\u30029\u5728\u6700\u8fd1\u7684Transformer\u6a21\u578b\uff08\u8c37\u6b4c\u7684BERT\u548cOpenAI\u7684GPT-2\uff09\u4e2d\u5f97\u5230\u4e86\u5e94\u7528</p> \\[ f(x)=0.5x(1+tanh(\\sqrt{2/\\pi} * (x+0.044715x^3))) \\]"},{"location":"machine_learning/deep_learning/model_yolo.html","title":"Yolo\u6a21\u578b","text":"<p>YOLO\uff08You Only Look Once\uff09\u662f\u4e00\u7ec4\u5b9e\u65f6\u76ee\u6807\u68c0\u6d4b\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\uff0c\u5b9a\u4f4d\u548c\u5206\u7c7b\u56fe\u50cf\u4e2d\u7684\u7269\u4f53\u3002</p> <p>Yolo \u4e4b\u524dR-CNN \u548cFast R-CNN\u3002\u8fd9\u4e9b\u65b9\u6cd5\u4f7f\u7528\u4e24\u6b65\u6d41\u7a0b\uff0c\u5148\u9884\u6d4b\u8fb9\u754c\u6846\uff0c\u7136\u540e\u4f7f\u7528\u56de\u5f52\u5bf9\u8fd9\u4e9b\u6846\u4e2d\u7684\u7269\u4f53\u8fdb\u884c\u5206\u7c7b\u3002\u8fd9\u79cd\u65b9\u6cd5\u901f\u5ea6\u6162\u4e14\u8017\u8d44\u6e90\u3002</p> <p>Yolo v1-v3 \u7531Joseph Redmon\u7b49\u5f00\u53d1\uff1ahttps://pjreddie.com/darknet/yolo/</p> <p>Yolo v5/v8/v11 \u7531Ultralytics\u56e2\u961f\u7814\u53d1\uff1ahttps://github.com/ultralytics\uff0c\u6ca1\u6709\u8bba\u6587\uff0c\u6709\u7f51\u7ad9\u3002</p> <p>Yolo v6 \u7f8e\u56e2\u5f00\u53d1\uff1ahttps://github.com/meituan/YOLOv6/</p> <p>Yolo v4/v7/v9 \u7531Chien-Yao Wang\u7b49\u7814\u53d1\uff1ahttps://github.com/WongKinYiu</p> <p>Yolo v10 \u6e05\u534e\u5927\u5b66\uff1ahttps://github.com/THU-MIG/yolov10</p> <p>Yolo v12 \uff1ahttps://github.com/sunsmarterjie/yolov12</p>"},{"location":"machine_learning/deep_learning/model_yolo.html#yolo-v1-v3","title":"YOLO v1-v3","text":"<p>2016 \u5e74\uff0cJoseph Redmon \u548c Ali Farhadi \u4e24\u4f4d\u5927\u795e\u5f00\u53d1\u4e86\u7b2c\u4e00\u4e2a YOLO\uff0c\u5b83\u901a\u8fc7\u65b0\u7684\u589e\u5f3a\u67b6\u6784\u514b\u670d\u4e86\u4f20\u7edf\u76ee\u6807\u68c0\u6d4b\u7b97\u6cd5\u7684\u5927\u591a\u6570\u95ee\u9898\u3002</p> <p>\u6700\u521d\u7684 YOLO \u67b6\u6784\u7531 24 \u4e2a\u5377\u79ef\u5c42\u548c 2 \u4e2a\u5168\u8fde\u63a5\u5c42\u7ec4\u6210\u3002\u540c\u65f6\u4f7f\u7528\u4e86 \u4ee5\u4e0b\u4f18\u5316\u6280\u672f\uff1a</p> <ul> <li>Leaky ReLU \u6fc0\u6d3b\uff1aLeaky ReLU \u6709\u52a9\u4e8e\u9632\u6b62\u795e\u7ecf\u5143\u5728\u8bad\u7ec3\u671f\u95f4\u53ef\u80fd\u5361\u5728\u975e\u6d3b\u52a8\u72b6\u6001\u3002</li> <li>Dropout \u6b63\u5219\u5316\uff1aYOLOv1 \u5728\u7b2c\u4e00\u4e2a\u5168\u8fde\u63a5\u5c42\u4e4b\u540e\u5e94\u7528 Dropout \u6b63\u5219\u5316\uff0c\u4ee5\u9632\u6b62\u8fc7\u62df\u5408\u3002</li> <li>\u6570\u636e\u589e\u5f3a</li> </ul> <p></p> <p>YOLO \u6a21\u578b\u7684\u672c\u8d28\u662f\u5c06\u76ee\u6807\u68c0\u6d4b\u89c6\u4e3a\u56de\u5f52\u95ee\u9898\u3002YOLO \u65b9\u6cd5\u662f\u5c06\u5377\u79ef\u795e\u7ecf\u7f51\u7edc (CNN) \u5e94\u7528\u4e8e\u6574\u4e2a\u56fe\u50cf\u3002\u8be5\u7f51\u7edc\u5c06\u56fe\u50cf\u5212\u5206\u4e3a\u533a\u57df\u5e76\u9884\u6d4b\u6bcf\u4e2a\u533a\u57df\u7684\u8fb9\u754c\u6846\u548c\u6982\u7387\u3002</p> <ul> <li>\u5c06\u8f93\u5165\u56fe\u50cf\u5212\u5206\u4e3a\u7f51\u683c (SxS)\uff0c\u6bcf\u4e2a\u7f51\u683c\u5355\u5143\u8d1f\u8d23\u9884\u6d4b\u8fb9\u754c\u6846\u548c\u5176\u4e2d\u5bf9\u8c61\u7684\u7c7b\u522b\u6982\u7387\u3002\u6bcf\u4e2a\u8fb9\u754c\u6846\u9884\u6d4b\u90fd\u5305\u542b\u4e00\u4e2a\u7f6e\u4fe1\u5ea6score\uff0c\u8868\u793a\u76ee\u6807\u51fa\u73b0\u5728\u6846\u4e2d\u7684\u53ef\u80fd\u6027\u3002</li> <li>\u4f7f\u7528\u4ea4\u5e76\u6bd4(IOU) \u7b49\u6280\u672f\u8ba1\u7b97\u7f6e\u4fe1\u5ea6score\uff0c\u8fd9\u4e9b\u6280\u672f\u53ef\u7528\u4e8e\u8fc7\u6ee4\u90e8\u5206\u9884\u6d4b\u3002</li> </ul> <p></p> <p>\u5b58\u5728\u7684\u95ee\u9898\uff1a</p> <ul> <li>\u5f88\u96be\u51c6\u786e\u68c0\u6d4b\u8bad\u7ec3\u4e2d\u672a\u89c1\u5230\u7684\u65b0\u7269\u4f53\uff1b</li> <li>\u6bcf\u4e2a\u7f51\u683c\u5355\u5143\u4ec5\u9884\u6d4b\u4e24\u4e2a\u6846\u5e76\u4e14\u53ea\u80fd\u6709\u4e00\u4e2a\u7c7b\uff0c\u8fd9\u4f7f\u5f97\u5b83\u5f88\u96be\u5904\u7406\u6210\u7fa4\u51fa\u73b0\u7684\u5c0f\u7269\u4f53\uff0c\u4f8b\u5982\u9e1f\u7fa4\u3002</li> <li>\u635f\u5931\u51fd\u6570\u7684\u5c40\u9650\u6027\uff1aYOLOv1 \u635f\u5931\u51fd\u6570\u5bf9\u5c0f\u8fb9\u754c\u6846\u548c\u5927\u8fb9\u754c\u6846\u4e2d\u7684\u8bef\u5dee\u7684\u5904\u7406\u65b9\u5f0f\u76f8\u540c\u3002\u5927\u8fb9\u754c\u6846\u4e2d\u7684\u5c0f\u8bef\u5dee\u901a\u5e38\u6ca1\u95ee\u9898\uff0c\u4f46\u5c0f\u8bef\u5dee\u5bf9 IOU \u7684\u5f71\u54cd\u8981\u5927\u5f97\u591a\u3002</li> <li>\u5b9a\u4f4d\u9519\u8bef\uff1aYOLOv1 \u7684\u4e00\u4e2a\u4e3b\u8981\u95ee\u9898\u662f\u51c6\u786e\u6027\uff0c\u5b83\u7ecf\u5e38\u4f1a\u9519\u8bef\u5b9a\u4f4d\u56fe\u50cf\u4e2d\u7269\u4f53\u7684\u4f4d\u7f6e\u3002</li> </ul>"},{"location":"machine_learning/deep_learning/model_yolo.html#yolov5","title":"YOLOv5","text":"<p>\u57fa\u4e8ePytorch\u6784\u5efa\u3002</p>"},{"location":"machine_learning/deep_learning/model_yolo.html#_1","title":"\u53c2\u8003\u6587\u732e","text":"<ol> <li>Redmon J , Divvala S , Girshick R ,et al.You Only Look Once: Unified, Real-Time Object Detection[C]//Computer Vision &amp; Pattern Recognition.IEEE, 2016.DOI:10.1109/CVPR.2016.91.</li> <li></li> <li>Redmon J , Farhadi A .YOLOv3: An Incremental Improvement[J].arXiv e-prints, 2018.DOI:10.48550/arXiv.1804.02767.</li> </ol>"},{"location":"machine_learning/deep_learning/preprocessing.html","title":"\u6570\u636e\u9884\u5904\u7406","text":"<p>\u8003\u8651\u6570\u636e\u7684\u6574\u4f53\u5206\u5e03\uff0c\u5229\u7528\u6570\u636e\u6574\u4f53\u7684\u5747\u503c\u6216\u8005\u6807\u51c6\u5dee\uff0c\u5c06\u6570\u636e\u6574\u4f53\u4ee50\u4e3a\u4e2d\u5fc3\u5206\u5e03\uff0c\u6216\u8005\u8fdb\u884c\u6b63\u89c4\u5316\uff0c\u5c06\u6570\u636e\u7684\u5ef6\u5c55\u63a7\u5236\u5728\u4e00\u5b9a\u8303\u56f4\u5185\u3002</p> <p>\u6b63\u89c4\u5316\uff1a\u5c06\u6570\u636e\u9650\u5b9a\u5230\u67d0\u4e2a\u8303\u56f4\u5185\u7684\u5904\u7406\uff0c\u5982\u56fe\u50cf\u7684\u503c\u4ece0~255\u6b63\u89c4\u5316\u52300~1\uff1b</p>"},{"location":"paper/go_concurrency_bugs.html","title":"\u4e86\u89e3\u771f\u5b9e\u4e16\u754c\u7684GO\u5e76\u53d1Bugs","text":"<p>\u8bba\u6587\uff1a2019\u300aUnderstanding Real-World Concurrency Bugs in Go\u300b</p> <p>Go \u63a8\u8350\u4f7f\u7528\u6d88\u606f\u4f20\u9012\uff08message passing\uff09\u4f5c\u4e3a\u7ebf\u7a0b\uff08goroutine\uff09\u95f4\u901a\u4fe1\u7684\u624b\u6bb5\uff0c\u4f46\u662f\u7ebf\u7a0b\u95f4\u901a\u4fe1\u91c7\u7528\u6d88\u606f\u4f20\u9012\u8fd8\u662f\u5171\u4eab\u5185\u5b58\u540c\u6b65\u673a\u5236\uff0c\u5e76\u6ca1\u6709\u771f\u5b9e\u7684\u5bf9\u6bd4\u663e\u5f0f\u4f18\u52a3\u6027\u3002</p> <p>\u8bba\u6587\u505a\u4e86\u4ee5\u4e0b\u8d21\u732e\uff1a</p> <ul> <li>\u7b2c\u4e00\u4e2a\u7cfb\u7edf\u7814\u7a76\u771f\u5b9eGO\u7a0b\u5e8f\uff08\u5982 docker/k8s/etcd\u7b49\uff09\u7684\u5e76\u53d1bugs\uff1a</li> <li>\u6d88\u606f\u4f20\u90fd\u8ddf\u5171\u4eab\u5185\u5b58\u4e00\u6837\uff0c\u5f88\u5bb9\u6613\u51fa\u73b0\u5e76\u53d1bugs\u3002</li> </ul>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#1-go","title":"1. Go \u5e76\u53d1\u4f7f\u7528\u6a21\u5f0f\u5206\u6790","text":"","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#goroutine","title":"Goroutine \u4f7f\u7528","text":"<p>\u89c2\u5bdf\u7ed3\u8bba1\uff1aGoruntines \u7684\u751f\u547d\u5468\u671f\u66f4\u77ed\uff0c\u4f46\u662f\u6bd4 C\uff08\u7ebf\u7a0b\uff09\u521b\u5efa\u66f4\u9891\u7e41\uff08\u65e0\u8bba\u662f\u9759\u6001\u8fd8\u662f\u8fd0\u884c\u65f6\u521b\u5efa\uff09</p> <p>\u95ee\u98981\uff1aDo real Go programmers tend to write their code with many goroutines (static) ?</p> <p>\u88682\uff1a\u6bcf\u5343\u884c\u4ee3\u7801 goroutine \u7684\u521b\u5efa\u6570\uff08gRPC-C\u6307\u7684\u662f\u7ebf\u7a0b\u7684\u521b\u5efa\u6570\uff09</p> <ul> <li>\u76f8\u8f83\u4e8eC\u9879\u76ee\uff0cGo\u4e2d\u7684\u5404\u9879\u76ee\u4e2d\u90fd\u5927\u91cf\u7684\u4f7f\u7528\u4e86\u534f\u7a0b</li> </ul> <p></p> <p>\u95ee\u98982\uff1aDo real Go applications create a lot of goroutines during runtime (dynamic) ?</p> <p>\u88683\uff1aGoogle RPC Benckmarking \u4e2d\u7684Go\u548cC\u5e94\u7528\u7684\u534f\u7a0b/\u7ebf\u7a0b\u7684\u503c\uff0c\u4ee5\u53ca\u76f8\u5bf9\u4e8e\u5e94\u7528\u7a0b\u5e8f\u7684\u534f\u7a0b/\u7ebf\u7a0b\u7684\u5360\u603b\u5e94\u7528\u65f6\u95f4</p> <ul> <li>\u52a8\u6001\u521b\u5efa\u7684 Go routine \u6bd4 C \u7ebf\u7a0b\u591a\u5f88\u591a\uff0c\u4f46\u5176\u5b58\u6d3b\u65f6\u95f4\u6bd4\u4f8b\u5c0f\u4e8e C\u7ebf\u7a0b(100%\uff09</li> </ul> <p></p>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#_1","title":"\u5e76\u53d1\u539f\u8bed\u4f7f\u7528","text":"<p>\u89c2\u5bdf\u7ed3\u8bba2\uff1a\u5c3d\u7ba1\u4f20\u7edf\u7684\u5171\u4eab\u5185\u5b58\u5f62\u5f0f\u7684\u7ebf\u7a0b\u95f4\u901a\u4fe1\u88ab\u91cd\u5ea6\u4f7f\u7528\uff0c\u4f46Go\u7a0b\u5e8f\u5458\u4e5f\u4f7f\u7528\u4e86\u5927\u91cf\u7684\u6d88\u606f\u4f20\u9012\u539f\u8bed\u3002</p> <p>\u9690\u542b\u7ed3\u8bba1\uff1a\u968f\u7740 go routines\u548c\u65b0\u578b\u5e76\u53d1\u539f\u8bed\u7684\u5927\u91cf\u4f7f\u7528\uff0cGo\u7a0b\u5e8f\u53ef\u80fd\u5f15\u5165\u66f4\u591a\u5e76\u53d1\u9519\u8bef\u3002 </p> <p>\u88684\uff1a\u5404\u9879\u76ee\u4e2d\u4f7f\u7528\u7684\u5e76\u53d1\u539f\u8bed\u7684\u603b\u6570\u53ca\u5404\u81ea\u7684\u5360\u6bd4\u7edf\u8ba1</p> <ul> <li>\u5728\u5b9e\u9645\u9879\u76ee\u4e2d\uff0c\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u76f8\u5173\u539f\u8bed\u8fd8\u591a\u4e8e\u901a\u9053\u901a\u4fe1\u7684\u5e76\u53d1\u6a21\u5f0f\u3002</li> </ul> <p></p> <p>\u56fe2\uff1a2015-2018 \u5e74\u5404\u4e2a\u9879\u76ee\u7684\u5e76\u53d1\u539f\u8bed\u7684\u4f7f\u7528\u6bd4\u4f8b\u7684\u53d8\u5316\uff08\u5de6\uff1a\u5171\u4eab\u5185\u5b58\uff0c\u53f3\u6d88\u606f\u4f20\u9012\uff09</p> <p></p>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#2-bug","title":"2. Bug \u7814\u7a76\u65b9\u6cd5","text":"<p>\u88685\uff1a\u5404\u9879\u76ee\u4e2d\u5e76\u53d1Bug\u7684\u5206\u7c7b\uff08\u6839\u636e commit \u5173\u952e\u5b57\u641c\u7d22\u3001\u8fc7\u6ee4\u5e76\u5206\u6790\u5f97\u51fa 171 \u4e2a\u5e76\u53d1 Bugs\uff09</p> <ul> <li>\u963b\u585e\u6027 bug\uff1agoroutine \u610f\u5916\u5361\u4f4f\uff0c\u65e0\u6cd5\u7ee7\u7eed\u6267\u884c\uff1b</li> <li>\u975e\u963b\u585e\u6027 bug\uff1agoroutine \u6267\u884c\u5b8c\u6210\uff0c\u4f46\u662f\u7ed3\u679c\u4e0d\u5bf9\uff1b</li> </ul> <p></p>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#3-bugs","title":"3. \u963b\u585e\u6027 Bugs","text":"<p>\u89c2\u5bdf\u7ed3\u8bba3\uff1a\u7814\u7a76\u8868\u660e\u963b\u585ebugs\u66f4\u591a\u662f\u7531\u9519\u8bef\u7684\u6d88\u606f\u4f20\u9012\u5bfc\u81f4\uff0c\u800c\u4e0d\u662f\u9519\u8bef\u7684\u5171\u4eab\u5185\u5b58\u4fdd\u62a4\uff0c\u4e0e\u4eba\u7c7b\u666e\u904d\u8ba4\u77e5\u76f8\u53cd\u3002</p> <p>\u88686\uff1a\u963b\u585e\u6027Bugs\u7684\u6839\u56e0\uff08\u6d88\u606f\u4f20\u9012\u9519\u8bef58%\uff0c\u5185\u5b58\u5171\u4eab42%\uff09\uff0c\u8003\u8651\u5230\u5171\u4eab\u5185\u5b58\u7684\u4f7f\u7528\u7387\u6bd4\u6d88\u606f\u4f20\u9012\u66f4\u9891\u7e41\uff0c\u6d88\u606f\u4f20\u9012\u5e76\u53d1Bugs\u7387\u66f4\u9ad8\u3002</p> <ul> <li><code>wait</code>\u5305\u62ec <code>Cond</code>\u548c<code>WaitGroup</code>\u4e2d\u7684<code>Wait</code>\u51fd\u6570\uff1b</li> <li><code>Chan</code>\u8868\u793a channel \u64cd\u4f5c\uff0c\u800c<code>Chan w/</code>\u8868\u793achannel\u64cd\u4f5c\u4f34\u968f\u7740\u5176\u5b83\u64cd\u4f5c\uff1b</li> <li><code>Lib</code>\u8868\u793a Go \u76f8\u5173\u7684\u6d88\u606f\u4f20\u9012\u7684\u5e93\uff1b</li> </ul> <p></p>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#bugs","title":"\u963b\u585e\u6027Bugs\u6839\u56e0\u5206\u6790","text":"","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#_2","title":"\u5171\u4eab\u5185\u5b58\u7684\u9519\u8bef\u4fdd\u62a4","text":"<p>\u89c2\u5bdf\u7ed3\u8bba4\uff1a\u5927\u591a\u6570\u7531\u5171\u4eab\u5185\u5b58\u540c\u6b65\u5f15\u8d77\u7684\u963b\u585e\u9519\u8bef\u4e0e\u4f20\u7edf\u8bed\u8a00\u5177\u6709\u76f8\u540c\u7684\u539f\u56e0\u548c\u4fee\u590d\u65b9\u6cd5\u3002\u4f46\u4ecd\u5b58\u5728\u4e00\u4e9b\u4e0d\u540c\uff0c\u56e0\u4e3aGo\u5bf9\u73b0\u6709\u539f\u8bed\u7684\u65b0\u5b9e\u73b0\u6216\u65b0\u7684\u7f16\u7a0b\u8bed\u4e49\uff08\u5982\u8bfb\u5199\u9501/WaitGroup\uff09\u3002 </p> <p>Mutex \uff1a\u4f20\u7edf\u7684\u95ee\u9898\uff0c\u53ef\u7531\u6b7b\u9501\u68c0\u67e5\u7b97\u6cd5\u901a\u8fc7\u9759\u6001\u7a0b\u5e8f\u5206\u6790\u68c0\u6d4b\u51fa\u6765\uff1b</p> <ul> <li>\u5355\u4e2agoroutine \u91cd\u590d\u83b7\u53d6\u9501\uff08\u4e0d\u652f\u6301\u53ef\u91cd\u5165\uff09\uff0c\u83b7\u53d6\u9501\u7684\u987a\u5e8f\u5b58\u5728\u51b2\u7a81\uff0c\u5fd8\u8bb0\u91ca\u653e\u9501\u7b49\uff1b</li> </ul> <p>RWMutex\uff1a\u5728Go\u4e2d\u5199\u9501\u6bd4\u8bfb\u9501\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\uff0c \u8bfb\u9501\u7684\u91cd\u5165\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6b7b\u9501\uff1b</p> <ul> <li>goroutine-A \u7684\u4e24\u4e2aRLock\uff08\u65e0\u9501\u91ca\u653e\uff09 \u95f4\u6267\u884c goroutine-B \u7684 Lock\uff08\u5199\u9501\uff09\uff0c\u5bfc\u81f4\u6b7b\u9501\uff1b</li> </ul> <p>Wait\uff1a\u4e00\u822c\u662f Cond.Wait \u65f6\uff0c\u6ca1\u6709\u5176\u5b83\u534f\u7a0b\u8c03\u7528 Cond.Signal\uff1b</p>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#_3","title":"\u6d88\u606f\u4f20\u9012\u9519\u8bef","text":"<p>\u89c2\u5bdf\u7ed3\u8bba5\uff1a\u6240\u6709\u7531\u6d88\u606f\u4f20\u9012\u5f15\u8d77\u7684\u963b\u585e\u9519\u8bef\u90fd\u4e0eGo\u65b0\u7684\u6d88\u606f\u4f20\u9012\u8bed\u4e49\uff08\u5982channel\uff09\u6709\u5173\u3002\u4e14\u5f88\u96be\u68c0\u6d4b\uff0c\u5c24\u5176\u4e0e\u5176\u4ed6\u540c\u6b65\u673a\u5236\u4e00\u8d77\u4f7f\u7528\u65f6\u3002</p> <p>\u89c2\u5bdf\u7ed3\u8bba6\uff1a\u4e0e\u4eba\u4eec\u666e\u904d\u8ba4\u4e3a\u7684\u76f8\u53cd\uff0c\u6d88\u606f\u4f20\u9012\u4f1a\u5bfc\u81f4\u6bd4\u5171\u4eab\u5185\u5b58\u66f4\u591a\u7684\u963b\u585e\u9519\u8bef\u3002\u6ce8\u610f\u6d88\u606f\u4f20\u9012\u7f16\u7a0b\u4e2d\u7684\u6f5c\u5728\u5371\u9669\uff0c\u5e76\u63d0\u51fa\u8be5\u9886\u57df\u7684\u9519\u8bef\u68c0\u6d4b\u7814\u7a76\u95ee\u9898\u3002</p> <p>Channel\uff1a\u4e00\u822c\u548c\u901a\u9053\u76f8\u5173\u7684\u963b\u585ebug\u662f\u56e0\u4e3a\u6ca1\u6709\u5411\u901a\u9053\u53d1\u9001\u6d88\u606f\uff08\u6216\u4ece\u901a\u9053\u63a5\u6536\u6d88\u606f\uff09\u6216\u5173\u95ed\u901a\u9053\uff0c\u800c\u5bfc\u81f4\u6b63\u5728\u7b49\u5f85\u4ece\u901a\u9053\u63a5\u6536\u6d88\u606f\uff08\u6216\u7b49\u5f85\u5f80\u901a\u9053\u53d1\u9001\u6d88\u606f\uff09\u7684\u534f\u7a0b\u963b\u585e\u3002</p> <p>Channel\u548c\u5176\u5b83\u539f\u8bed\uff1a\u4e00\u8d77\u4f7f\u7528\u9020\u6210</p> <ul> <li>\u4e00\u4e2a\u534f\u7a0b\u56e0\u4e3a\u901a\u9053\u963b\u585e\uff0c\u53e6\u4e00\u4e2a\u534f\u7a0b\u56e0\u4e3a\u9501\u6216wait\u64cd\u4f5c\u963b\u585e\u3002</li> </ul> <p>Go\u4e2d\u7684\u6d88\u606f\u5e93\uff1a\u5982 Pipe\uff0c\u672a\u5173\u95ed\u7684 Pipe \u7684\u64cd\u4f5c\uff08\u5982\u8bfb\u5199\uff09\u65f6\u53ef\u80fd\u4f1a\u88ab\u963b\u585e\uff0c\u5982\u679c\u4f7f\u7528\u4e0d\u5f53\u4e5f\u4f1a\u5bfc\u81f4\u5e76\u53d1 bugs\uff1b</p>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#bugs_1","title":"\u963b\u585e\u6027Bugs\u7684\u4fee\u590d","text":"<p>\u89c2\u5bdf\u7ed3\u8bba6\uff1a\u7814\u7a76\u4e2d\u7684\u5927\u591a\u6570\u963b\u585e\u6027bugs \u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u7684\u65b9\u6848\u4fee\u590d\uff0c\u8bb8\u591a\u4fee\u590d\u90fd\u4e0e\u9519\u8bef\u7684\u539f\u56e0\u76f8\u5173\uff08many fixes are correlated with bug causes\uff09\u3002</p> <p>\u9690\u5f0f\u7ed3\u8bba3\uff1aGo\u963b\u585e\u9519\u8bef\u7684\u539f\u56e0\u548c\u4fee\u590d\u4e4b\u95f4\u7684\u9ad8\u5ea6\u76f8\u5173\u6027\u53ca\u5176\u4fee\u590d\u7684\u7b80\u5355\u6027\u8868\u660e\uff0c\u5f00\u53d1\u5b8c\u5168\u81ea\u52a8\u5316\u6216\u534a\u81ea\u52a8\u5316\u7684\u5de5\u5177\u6765\u4fee\u590dGo\u4e2d\u7684\u963b\u585e\u9519\u8bef\u662f\u6709\u5e0c\u671b\u7684\u3002</p> <p>\u5171\u4eab\u5185\u5b58\u5bf9\u5e94\u7684\u4fee\u590dbug\u7684\u65b9\u6cd5\u4e00\u822c\u5982\u4e0b\uff1a</p> <ul> <li>\u901a\u8fc7\u6dfb\u52a0\u7f3a\u5c11\u7684\u89e3\u9501\u64cd\u4f5c</li> <li>\u79fb\u52a8lock\u6216unlock\u64cd\u4f5c\u5230\u5408\u9002\u7684\u4f4d\u7f6e</li> <li>\u79fb\u9664\u591a\u4f59\u7684\u9501\u64cd\u4f5c</li> </ul> <p>\u6d88\u606f\u4f20\u9012\u5bf9\u5e94\u7684\u4fee\u590dbug\u7684\u65b9\u6cd5\u4e00\u822c\u5982\u4e0b\uff1a</p> <ul> <li>\u6dfb\u52a0\u4e22\u5931\u7684message \u6216\u8005 \u5173\u95ed channel\uff1b</li> <li>\u5728select\u8bed\u53e5\u4e2d\u589e\u52a0default\u5206\u652f\u6216\u5728\u4e00\u4e2a\u4e0d\u540c\u901a\u9053\u4e0a\u7684case\u64cd\u4f5c\uff1b</li> <li>\u5c06unbuffered channel\u66ff\u6362\u6210buffered chanel\uff1b</li> <li>channel \u64cd\u4f5c\u79fb\u9664\u4e34\u754c\u533a\uff0c\u7528\u5171\u4eab\u53d8\u91cf\u66ff\u4ee3 channel\uff1b</li> </ul> <p>\u88687\uff1ablocking bugs \u7684\u4fee\u590d\u7b56\u7565\u7edf\u8ba1\uff0c\u4e0b\u6807 s \u8868\u793a synchronization\u3002</p> <p></p>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#bugs_2","title":"\u963b\u585e\u6027 Bugs \u68c0\u6d4b","text":"<p>\u9690\u5f0f\u7ed3\u8bba4\uff1aGo \u5185\u7f6e\u7684\u8fd0\u884c\u65f6\u6b7b\u9501\u68c0\u6d4b\u5668\u4e0d\u80fd\u6709\u6548\u5730\u68c0\u6d4bGo\u963b\u585e\u9519\u8bef\u3002</p> <p>Go \u5185\u7f6e\u7684\u6b7b\u9501\u68c0\u6d4b\u5668\u9488\u5bf9 21 \u4e2a\u963b\u585e\u6027\u95ee\u9898\uff0c\u53ea\u68c0\u6d4b\u51fa2\u4e2a\u6b7b\u9501\u95ee\u9898\uff0c\u6709\u4ee5\u4e0b\u4e24\u70b9\u539f\u56e0\uff1a</p> <ul> <li>\u5f53\u4ecd\u7136\u6709\u4e00\u4e9bgoroutine\u5728\u8fd0\u884c\u65f6\uff0c\u5b83\u4e0d\u8ba4\u4e3a\u88ab\u76d1\u89c6\u7684\u7cfb\u7edf\u662f\u963b\u585e\u7684\uff1b</li> <li>\u53ea\u68c0\u67e5goroutine\u662f\u5426\u5728Go\u5e76\u53d1\u539f\u8bed\u4e2d\u88ab\u963b\u585e\uff0c\u800c\u4e0d\u8003\u8651\u7b49\u5f85\u5176\u4ed6\u7cfb\u7edf\u8d44\u6e90\u7684goroutine\u3002</li> </ul> <p>\u88688\uff1adeadlock detector \u7684\u68c0\u6d4b\u7ed3\u679c</p> <p></p>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#4-bugs","title":"4. \u975e\u963b\u585e\u6027 Bugs","text":"","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#_4","title":"\u6839\u56e0\u5206\u6790","text":"<p>\u88689\uff1a\u975e\u963b\u585e\u6027\u95ee\u9898\u7684\u6839\u56e0\u5206\u6790</p> <p></p>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#_5","title":"\u5171\u4eab\u5185\u5b58\u4fdd\u62a4\u5931\u8d25","text":"<p>\u89c2\u5bdf\u7ed3\u8bba7\uff1a\u5927\u7ea6\u4e09\u5206\u4e4b\u4e8c\u7684\u5171\u4eab\u5185\u5b58\u672a\u963b\u585ebugs\u662f\u7531\u4f20\u7edf\u539f\u56e0\u5f15\u8d77\u7684\uff0cGo\u7684\u65b0\u7684\u591a\u7ebf\u7a0b\u8bed\u4e49\u548c\u65b0\u7684\u5e93\u4e3a\u5176\u4f59\u90e8\u5206\u8d21\u732e\u4e86\u4e09\u5206\u4e4b\u4e00\u3002</p> <p>\u9690\u5f0f\u7ed3\u8bba5\uff1aGo\u4e3a\u7b80\u5316\u591a\u7ebf\u7a0b\u7f16\u7a0b\u5f15\u5165\u7684\u65b0\u7684\u7f16\u7a0b\u6a21\u578b\u548c\u65b0\u7684\u5e93\uff0c\u5176\u672c\u8eab\u53ef\u80fd\u662f\u5bfc\u81f4\u66f4\u591a\u5e76\u53d1\u9519\u8bef\u7684\u539f\u56e0\u3002 </p> <p>80% \u6536\u96c6\u7684\u975e\u963b\u585e\u6027bugs\u90fd\u662f\u7531\u4e8e\u672a\u4fdd\u62a4\u6216\u8005\u9519\u8bef\u4fdd\u62a4\u5171\u4eab\u5185\u5b58\u5bfc\u81f4\uff0c\u5176\u6839\u56e0\u6709\u4ee5\u4e0b\u4e09\u70b9\uff1a</p> <ul> <li>\u4f20\u7edf\u7684bugs\uff1a\u8ddf C/Java \u7c7b\u4f3c\uff0c\u5982 \u8fdd\u53cd\u539f\u5b50\u6027\u3001\u8fdd\u53cd\u987a\u5e8f\u6027\u3001\u6570\u636e\u7ade\u4e89\u7b49\uff1b</li> <li>\u533f\u540d\u51fd\u6570\uff1a\u5171\u4eab\u7684\u672c\u5730\u53d8\u91cf\u5bfc\u81f4\u7684 goroutine \u95f4\u7684\u6570\u636e\u7ade\u4e89\uff1b</li> <li><code>WaitGroup</code>\u8bef\u7528\uff1a<code>WaitGroup</code>\u8981\u6c42<code>Add</code>\u5fc5\u987b\u5728<code>Wait</code>\u524d\u8c03\u7528\uff1b</li> <li>\u7279\u6b8a\u7684\u5e93\uff1aGo\u7684\u5e93\u4e2d\u7684\u8bed\u4e49\uff08\u5982 context \u7b49\uff09\uff0c\u4f7f\u7528\u88ab\u591a\u4e2a goroutines\u9690\u5f0f\u5171\u4eab\u7684\u5bf9\u8c61\uff1b</li> </ul>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#_6","title":"\u6d88\u606f\u4f20\u9012\u9519\u8bef","text":"<p>20 %\u7684\u6536\u96c6\u95ee\u9898\u7531\u4e8e\u9519\u8bef\u4f7f\u7528\u6d88\u606f\u4f20\u9012\uff1a</p> <ul> <li>channel\u8bef\u7528\uff1a\u5982 close channel \u591a\u6b21\uff0cselect \u4e2d\u591a\u4e2a case \u540c\u65f6\u6ee1\u8db3\u65f6\u6267\u884c\u7684\u4e0d\u786e\u5b9a\u6027\uff1b</li> <li>\u7279\u5b9a\u7684\u5e93\uff1a\u6bd4\u5982 \u503c\u4e3a0 \u7684Timer.C \u7684\u8868\u73b0\uff08\u7acb\u5373signal select\uff09\uff1b</li> </ul>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#bugs_3","title":"\u975e\u963b\u585e\u6027Bugs\u7684\u4fee\u590d","text":"<p>\u89c2\u5bdf\u7ed3\u8bba9\uff1a\u4f20\u7edf\u7684\u5171\u4eab\u5185\u5b58\u540c\u6b65\u6280\u672f\u4ecd\u7136\u662fGo\u4e2d\u975e\u963b\u585e\u9519\u8bef\u7684\u4e3b\u8981\u4fee\u590d\u65b9\u6cd5\uff0c\u800c\u901a\u9053\u4e0d\u4ec5\u88ab\u5e7f\u6cdb\u7528\u4e8e\u4fee\u590d\u4e0e\u901a\u9053\u76f8\u5173\u7684\u9519\u8bef\uff0c\u8fd8\u53ef\u4ee5\u4fee\u590d\u5171\u4eab\u5185\u5b58\u9519\u8bef\u3002</p> <p>\u9690\u5f0f\u7ed3\u8bba7\uff1a\u867d\u7136Go\u7a0b\u5e8f\u5458\u7ee7\u7eed\u4f7f\u7528\u4f20\u7edf\u7684\u5171\u4eab\u5185\u5b58\u4fdd\u62a4\u673a\u5236\u6765\u4fee\u590d\u975e\u963b\u585e\u9519\u8bef\uff0c\u4f46\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4ed6\u4eec\u66f4\u559c\u6b22\u4f7f\u7528\u6d88\u606f\u4f20\u9012\u4f5c\u4e3a\u4fee\u590d\u65b9\u6cd5\uff0c\u53ef\u80fd\u662f\u56e0\u4e3a\u4ed6\u4eec\u8ba4\u4e3a\u6d88\u606f\u4f20\u9012\u662f\u8de8\u7ebf\u7a0b\u901a\u4fe1\u7684\u4e00\u79cd\u66f4\u5b89\u5168\u7684\u65b9\u5f0f\u3002</p> <p>\u886810\uff1a\u975e\u963b\u585e\u6027bugs\u7684\u4fee\u590d\u7b56\u7565\uff08\u4e0b\u6807s\u8868\u793asynchronize\uff09</p> <ul> <li>69%\u7684\u975e\u963b\u585ebug\u53ef\u4ee5\u901a\u8fc7\u4e25\u683c\u7684\u65f6\u95f4\u987a\u5e8f\u8fdb\u884c\u4fee\u590d\uff08\u5982\u589e\u52a0Mutex\u4e4b\u7c7b\u7684\u540c\u6b65\u539f\u8bed\uff0c\u6216\u8005\u79fb\u52a8\u76f8\u5173\u540c\u6b65\u539f\u8bed\uff09\uff1b</li> <li>\u79fb\u9664\u5171\u4eab\u53d8\u91cf\u8bbf\u95ee\u7684\u6307\u4ee4\uff1b</li> <li>\u5bf9\u5171\u4eab\u53d8\u91cf\u8fdb\u884c\u79c1\u6709\u5316\uff1b</li> </ul> <p></p> <p>\u886811\uff1a\u975e\u963b\u585e\u6027bugs\u7684\u4fee\u590d\u4e2d\u7684\u540c\u6b65\u539f\u8bed\u6570\u91cf</p> <p></p>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#bugs_4","title":"\u975e\u963b\u585e\u6027Bugs\u7684\u68c0\u6d4b","text":"<p>\u9690\u5f0f\u7ed3\u8bba8\uff1a\u7b80\u5355\u7684\u4f20\u7edf\u6570\u636e\u7ade\u4e89\u68c0\u6d4b\u5668\u65e0\u6cd5\u6709\u6548\u5730\u68c0\u6d4b\u6240\u6709\u7c7b\u578b\u7684Go\u975e\u963b\u585e\u9519\u8bef\u3002</p> <p>Go \u5185\u7f6e data race detector \u9488\u5bf9\u6536\u96c6\u7684 20\u4e2a \u975e\u963b\u585e\u6027bugs \u68c0\u6d4b\u51fa 10 \u4e2abugs\u3002</p> <p>\u886812\uff1adata race detector \u7684\u68c0\u6d4b\u7ed3\u679c</p> <p></p>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#5-bugs","title":"5. \u9644\uff1a\u5e76\u53d1Bugs \u793a\u4f8b","text":"<p>\u8bba\u6587\u79cd\u6d89\u53ca\u7684\u5404\u4e2a\u9879\u76ee\u7684bugs\u53ca\u4fee\u6539commit\u4fe1\u606f\u89c1 Github: go-concurrency-bugs</p> <p>\u5e76\u53d1bugs\u590d\u73b0\u9879\u76ee</p>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#_7","title":"\u533f\u540d\u51fd\u6570","text":"<p>\u672c\u5730\u53d8\u91cf\u5171\u4eab\uff08\u95ed\u5305\uff09\u7684\u95ee\u9898\uff0c\u6bcf\u4e2a goroutine \u62ff\u5230\u7684 <code>i</code> \u7684\u503c\u4e0d\u4e00\u5b9a\u662f\u5faa\u73af\u65f6\u7684 <code>i</code>\u7684\u503c\uff0c\u56e0\u6b64\u9700\u8981\u5bf9\u53d8\u91cf\u62f7\u8d1d\u5e76\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\uff1b</p> <pre><code>    for i := 17; i &lt;= 21; i++ { // write\n-       go func() { /* Create a new goroutine */\n+           go func(i int) {\n                apiVersion := fmt.Sprintf(\"v1.%d\", i) // read\n                ...\n-           }()\n+       }(i)\n    }\n</code></pre>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#waitgroup","title":"WaitGroup","text":"<p>\u65e0\u6cd5\u4fdd\u8bc1 func1 \u7684\u7b2c 8 \u884c\u7684 Add \u51fd\u6570 happens before func2 \u7684\u7b2c 5 \u884c\u7684 Wait\uff0c\u901a\u8fc7\u5c06 Add \u51fd\u6570\u79fb\u81f3\u4e34\u754c\u533a\u4e2d\u6267\u884c\uff0c\u4fdd\u8bc1 Add \u5728 Wait \u524d\u6267\u884c\u6216\u8005\u6839\u672c\u4e0d\u6267\u884c\u3002</p> <p></p>","tags":["\u8bba\u6587"]},{"location":"paper/go_concurrency_bugs.html#channel","title":"Channel","text":"<p>\u89c2\u5bdf\u7ed3\u8bba8\uff1a\u4e0e\u5171\u4eab\u5185\u5b58\u8bbf\u95ee\u76f8\u6bd4\uff0c\u7531\u6d88\u606f\u4f20\u9012\u5f15\u8d77\u7684\u975e\u963b\u585e\u9519\u8bef\u8981\u5c11\u5f97\u591a\u3002channel \u7684\u89c4\u5219\u548c\u5c06channel\u4e0e\u5176\u4ed6Go\u7279\u5b9a\u8bed\u4e49\u548c\u5e93\u4e00\u8d77\u4f7f\u7528\u7684\u590d\u6742\u6027\u662f\u53d1\u751f\u8fd9\u4e9b\u975e\u963b\u585e\u9519\u8bef\u7684\u539f\u56e0\u3002</p> <p>\u9690\u5f0f\u7ed3\u8bba6\uff1a\u5982\u679c\u4f7f\u7528\u5f97\u5f53\uff0c\u4e0e\u5171\u4eab\u5185\u5b58\u8bbf\u95ee\u76f8\u6bd4\uff0c\u6d88\u606f\u4f20\u9012\u4e0d\u592a\u5bb9\u6613\u51fa\u73b0\u975e\u963b\u585e\u9519\u8bef\u3002\u7136\u800c\uff0c\u5728\u4e00\u79cd\u8bed\u8a00\u4e2d\uff0c\u6d88\u606f\u4f20\u9012\u7684\u590d\u6742\u8bbe\u8ba1\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8fd9\u4e9b\u9519\u8bef\u5728\u4e0e\u5176\u4ed6\u7279\u5b9a\u4e8e\u8bed\u8a00\u7684\u529f\u80fd\u76f8\u7ed3\u5408\u65f6\u7279\u522b\u96be\u4ee5\u627e\u5230\u3002</p> <p>1\uff09\u591a\u4e2a goroutine \u6267\u884c\u65f6\uff0c\u5bfc\u81f4 channel \u5173\u95ed\u591a\u6b21\u3002</p> <pre><code>-   select {\n-       case &lt;- c.closed:\n-       default:\n+           Once.Do(func() {\n                close(c.closed)\n+           })\n-   }\n</code></pre> <p>2\uff09select \u4e2d\u7684\u591a\u4e2a case \u6267\u884c\u987a\u5e8f\u7684\u4e0d\u786e\u5b9a\u6027\uff0c\u5f53 \u7b2c10 \u548c12\u884c\u7684 case \u8bed\u53e5\u540c\u65f6\u6ee1\u8db3\u65f6\uff0c\u53ef\u80fd\u4f1a\u6267\u884c\u7b2c 12 \u884c\uff0c\u5bfc\u81f4 f() \u591a\u6267\u884c\u4e00\u6b21\uff1b</p> <pre><code>    ticker := time.NewTicker()\n    for {\n+       select {\n+           case &lt;- stopCh:\n+               return\n+           default:\n+       }\n        f()\n        select {\n            case &lt;- stopCh:\n                return\n            case &lt;- ticker:\n        }\n    }\n</code></pre> <p>3\uff09Timer \u5f15\u8d77\u7684\u975e\u963b\u585e\u578b Bug\uff0c\u76ee\u6807\u662f\u671f\u671b\u4ec5\u5f53 dur &gt; 0 \u6216\u8005 ctx.Done() \u65f6\u624d\u8fd4\u56de\u3002</p> <ul> <li>\u5f53 dur \u5c0f\u4e8e\u7b49\u4e8e0 \u65f6\uff0c\u5e93\u4e2d\u7684goroutine \u4f1a\u7acb\u5373 signal timer.C channel\uff0c\u5bfc\u81f4\u7528\u4e8e\u4ece\u7b2c 8 \u884c\u8fd4\u56de\uff0c\u8ddf\u7a0b\u5e8f\u671f\u671b\u4e0d\u4e00\u81f4\uff1b</li> </ul> <pre><code>-   timer := time.NewTimer(0)\n+   var timeout &lt;- chan time.Time\n    if dur &gt; 0 {\n-       timer = time.NewTimer(dur)\n+       timeout = time.NewTimer(dur).C\n    }\n    select {\n-       case &lt;- timer.C:\n+       case &lt;- timeout:\n        case &lt;- ctx.Done():\n            return nil\n    }\n</code></pre> <p>4\uff09\u4e0d\u5e26\u7f13\u51b2\u7684channel\u5bfc\u81f4goroutine \u6cc4\u9732</p> <pre><code>    func finishReq(timeout time.Duration) r ob {\n-       ch := make(chan ob)\n+       ch := make(chan ob, 1)\n        go func() {\n            result := fn()\n            ch &lt;- result // if select timeout, then this will be blocked with no capacity channel\n        } ()\n        select {\n            case result = &lt;- ch:\n                return result\n             case &lt;- time.After(timeout):\n                return nil\n        }\n    }\n</code></pre>","tags":["\u8bba\u6587"]},{"location":"paper/job_scheduling_in_hpc.html","title":"HPC\u4e2d\u7684\u4f5c\u4e1a\u8c03\u5ea6","text":"<p>Job Scheduling in High Performance Scheduling</p>"},{"location":"paper/scalability_but_at_what_cost.html","title":"\u53ef\u6269\u5c55\u6027\u7684\u4ee3\u4ef7","text":""},{"location":"paper/scalability_but_at_what_cost.html#scalability-but-at-what-cost","title":"Scalability! But at what COST?","text":"<p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u8bc4\u4ef7\u6307\u6807\uff1a\u53ef\u6269\u5c55\u6027 VS \u6027\u80fd </p>"},{"location":"paper/scalability_but_at_what_cost.html#_1","title":"\u95ee\u9898","text":"<p>\u5927\u591a\u5206\u5e03\u5f0f\u5927\u6570\u636e\u5904\u7406\u7cfb\u7edf\u7684\u5de5\u4f5c\u8fc7\u5206\u6c89\u8ff7\u4e8e\u7cfb\u7edf\u7684\u6269\u5c55\u6027\uff0c\u5374\u5f88\u5c11\u751a\u81f3\u5ffd\u7565\u4e86\u7cfb\u7edf\u7684\u5904\u7406\u6548\u7387\u4e0e\u7edd\u5bf9\u6027\u80fd\u3002</p> <ul> <li>\u5355\u673a\u7b97\u6cd5\u8003\u8651\u7684\u662f\u6548\u7387\uff0c\u6709\u5f88\u591a\u79cd\u4f18\u5316\u624b\u6bb5\uff0c\u4f46\u8fd9\u4e9b\u65b9\u6cd5\u4e0d\u4e00\u5b9a\u80fd\u5e76\u884c\uff08\u5373\u6269\u5c55\u6027\u4e0d\u597d\uff09</li> </ul> <p>\u56fe\u6570\u636e</p> name twitter rv uk-2007-05 nodes 41,652,230 105,896,555 edges 1,468,365,182 3,738,733,648 size 5.76GB 14.72GB <p>\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u6027\u80fd\u8ddf\u5355\u673a\u7b97\u6cd5\u7684\u6027\u80fd\u5bf9\u6bd4\uff1a\uff0820\u6b21 PageRank \u8fed\u4ee3\u7684\u6027\u80fd\uff09</p> scalable system cores twitter uk-2007-05 Spark 128 857s 1759s Giraph 128 596s 1235s GraphLab 128 249s 833s GraphX 128 419s 462s Single thread (SSD) 1 300s 651s Single thread (RAM) 1 275s -"},{"location":"paper/scalability_but_at_what_cost.html#_2","title":"\u65b9\u6848","text":"<p>\u8861\u91cf\u6307\u6807\u2014\u2014COST\uff08the Configuration that Outperforms a Single Thread\uff09\uff0c\u8d85\u8fc7\u5355\u7ebf\u7a0b\u7684\u6027\u80fd\u6240\u9700\u8981\u7684\u914d\u7f6e\u3002</p> <ul> <li>\u8861\u91cf\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u53ef\u6269\u5c55\u6027\u4e0e\u7cfb\u7edf\u5f15\u5165\u7684\u5f00\u9500\uff0c\u4e0d\u5956\u52b1\u5e26\u6765\u5927\u91cf\u4f46\u53ef\u5e76\u884c\u5f00\u9500\u7684\u7cfb\u7edf\uff1b</li> </ul> <p>\u4e0b\u56fe\u662f\u5355\u673a\u7684\u56fe\u8fde\u901a\u5206\u91cf\u7b97\u6cd5\uff08union find\uff09\u548c\u5206\u5e03\u5f0f\u56fe\u7b97\u6cd5\uff08Naida UF/ Slow\uff09</p> <ul> <li>\u5feb\u7684\u5206\u5e03\u5f0f\u7b97\u6cd5\u6027\u80fd\u7684 COST \u503c\u4e3a 10 cores\uff1b\u6162\u7684\u5206\u5e03\u5f0f\u7b97\u6cd5\u7684 COST \u503c\u4e3a 100 cores.</li> </ul> <p></p>"},{"location":"paper/scalability_but_at_what_cost.html#_3","title":"\u6587\u732e","text":"<ol> <li>Mcsherry F , Isard M , Murray D G .Scalability! but at what cost?[C]//Workshop on Hot Topics in Operating Systems.USENIX Association, 2015.</li> </ol>"},{"location":"2024/05/21/%E5%9F%BA%E4%BA%8Etag%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83github-release.html","title":"\u57fa\u4e8eTag\u81ea\u52a8\u53d1\u5e03Github Release","text":"<p>\u5728 Github \u4e0a\u53d1\u5e03 Release \u65f6\uff0c\u9ed8\u8ba4\u53ea\u4f1a\u53d1\u5e03\u6e90\u7801\u7684zip\u5305\uff0c\u4f46\u662f\u6709\u65f6\u5019\u4f1a\u60f3\u8981\u5c06\u4e00\u4e9b\u7f16\u8bd1\u51fa\u6765\u7684\u6587\u4ef6\u4e5f\u653e\u5728 Release \u4e2d\u3002\u867d\u7136\u53ef\u4ee5\u5728\u672c\u5730\u7f16\u8bd1\uff0c\u7136\u540e\u901a\u8fc7\u754c\u9762\u624b\u52a8\u4e0a\u4f20\u3002\u4f46\u662f\u53ef\u4ee5\u57fa\u4e8e Github Action \u5b9e\u73b0\u81ea\u52a8\u53d1\u5e03\u3002</p>"},{"location":"2024/05/21/%E5%9F%BA%E4%BA%8Etag%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83github-release.html#_1","title":"\u793a\u4f8b","text":"<p>xliuqq/javaautosshpasswordfree: Java \u81ea\u52a8\u914d\u7f6e\u514d\u5bc6\u767b\u5f55  \u4f7f\u7528 softprops/action-gh-release: GitHub Action for creating GitHub Releases</p> <p>Java \u9879\u76ee\u4e3a\u4f8b\uff0cRelease \u65f6\u53d1\u5e03 fat jar\u3002</p>"},{"location":"2024/05/21/%E5%9F%BA%E4%BA%8Etag%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83github-release.html#action-yaml","title":"\u914d\u7f6e Action Yaml","text":"<p><code>.github/workflows/release.yaml</code></p> <ul> <li>\u5f53\u63a8\u9001 tag \u65f6\uff0c\u8fdb\u884c\u7f16\u8bd1\uff0c\u751f\u6210jar\u5305\uff0c\u5e76\u65b0\u5efa Release\uff1b</li> <li>\u9ed8\u8ba4\u751f\u6210\u7684 Release Notes\uff08Body\uff09\u4ec5\u5305\u542b Commit \u4fe1\u606f\uff1b</li> <li>\u53ef\u4ee5\u901a\u8fc7\u5176\u5b83\u5de5\u5177\uff0c\u751f\u6210 ChangeLog\uff0c\u5e76\u6307\u5b9a\u8be5\u6587\u4ef6\u4e3a Release Notes\u3002</li> </ul> <pre><code>name: Release\non:\n  push:\n    tags:\n    # tag \u683c\u5f0f\u4e3a vA.B.C\n      - 'v*.*.*'\n\njobs:\n  publishGitRelease:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n      - name: Setup JDK\n        uses: actions/setup-java@v3\n        with:\n          java-version: '8'\n          distribution: 'temurin'\n          cache: maven\n      - name: Build\n        run: mvn -B package --file pom.xml\n      - name: Release\n        uses: softprops/action-gh-release@v2\n        with:\n          # name: Name of the release. defaults to tag name\n          # body_path: Path to load text communicating notable changes in this release\n          # target_commitish: Commitish value that determines where the Git tag is created from. Can be any branch or commit SHA. Defaults to repository default branch.\n          # Newline-delimited globs of paths to assets to upload for release\n          files: core/target/java-auto-ssh-password-free*.jar\n          fail_on_unmatched_files: true\n          # note you'll typically need to create a personal access token\n          # with permissions to create releases in the other repo.\n          # token: ${{ secrets.CUSTOM_GITHUB_TOKEN }}\n          # Name of a target repository in &lt;owner&gt;/&lt;repo&gt; format. Defaults to GITHUB_REPOSITORY env variable\n          # repository: &lt;another_owner&gt;/&lt;another_repo&gt;\n</code></pre>"},{"location":"2024/05/21/%E5%9F%BA%E4%BA%8Etag%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83github-release.html#_2","title":"\u914d\u7f6e\u6743\u9650","text":"<p>\u5728\u9879\u76ee<code>Settings-&gt;Action-&gt;General</code>\u4e2d\uff0c\u914d\u7f6e Workflow \u7684\u6743\u9650\uff08\u5982\u4e0b\uff09\uff0c\u8fd9\u6837\u9ed8\u8ba4\u7684<code>GITHUB_TOKEN</code>\u5c31\u5177\u5907\u521b\u5efa Release \u7684\u6743\u9650\u3002</p> <p></p>"},{"location":"2024/05/21/%E5%9F%BA%E4%BA%8Etag%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83github-release.html#tag","title":"\u6253Tag\u5e76\u63a8\u9001","text":"<p>\u53ef\u4ee5\u4f7f\u7528 GUI\uff08\u5982 Github Desktop\uff09\u5bf9 Commit \u6253 tag\uff0c\u5e76\u63a8\u9001\u3002</p> <pre><code>git tag v1.0.0\ngit push origin v1.0.0\n</code></pre>"},{"location":"2024/05/21/%E5%9F%BA%E4%BA%8Etag%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83github-release.html#_3","title":"\u67e5\u770b\u7248\u672c\u53d1\u5e03","text":"<p>\u88ab\u6807\u8bb0\u4e3a v1.0.0 \u7684 tag \u7684 commit \u6709 Action \u7684\u8fd0\u884c\u7ed3\u679c\u56fe\u6807\u3002</p> <p></p> <p>\u67e5\u770b Release\uff0c\u53ef\u4ee5\u770b\u5230\u76f8\u5e94\u7684 fat jar \u548c Release note.</p> <p></p>"},{"location":"2023/10/23/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8Bgo-once.html","title":"\u6e90\u7801\u5206\u6790\u4e4bGo Once","text":"<p>Go \u4e2d\u7684 Atomic Values \u7b49\u4ef7\u4e8e C++ \u7684\u987a\u5e8f\u4e00\u81f4\u6027 atomics\uff0c\u7b49\u4ef7\u4e8e Java \u4e2d\u7684 <code>volatile</code>\u53d8\u91cf\uff1b</p> <p>\u5728\u770b Go \u4e2d <code>sync.once</code>\u5305\u4e2d\u7684\u6e90\u7801\u5b9e\u73b0\u65f6\uff0c\u7591\u95ee\u4e3a\u4ec0\u4e48\u8981\u7528<code>atomic</code>\u7684 load \u548c store\uff0c\u800c\u4e0d\u80fd\u76f4\u63a5\u8bfb\u53d6\u548c\u8d4b\u503c\u3002</p> <pre><code>if o.done == 0 {\n    // \u4e3a\u4ec0\u4e48\u4e0d\u4f7f\u7528? defer func(){o.done == 1}()\n    defer atomic.StoreUint32(&amp;o.done, 1)\n    f()\n}\n</code></pre>"},{"location":"2023/10/23/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8Bgo-once.html#once","title":"Once \u4ee3\u7801","text":"<p>Go 1.18 \u4e2d\u7684\u6e90\u7801</p> <pre><code>type Once struct {\n    done uint32\n    m    Mutex\n}\nfunc (o *Once) Do(f func()) {\n    if atomic.LoadUint32(&amp;o.done) == 0 {\n        o.doSlow(f)\n    }\n}\nfunc (o *Once) doSlow(f func()) {\n    o.m.Lock()\n    defer o.m.Unlock()\n    if o.done == 0 {\n        // defer func(){o.done == 1}()\n        defer atomic.StoreUint32(&amp;o.done, 1)\n        f()\n    }\n}\n</code></pre> <p>Once \u7684<code>Do</code>\u4fdd\u8bc1\u53ea\u4f1a\u6267\u884c\u51fd\u6570\u4e00\u6b21\uff0c\u4e14\u5176\u5b83go routine \u4f1a\u7b49\u5f85\u76f4\u5230\u8be5\u51fd\u6570\u6267\u884c\u5b8c\u3002</p> <ul> <li>\u7b2c15\u884c\u4f7f\u7528\u539f\u5b50\u6027 Store\uff0c\u800c\u4e0d\u662f\u7b2c14\u884c\u7684\u5f62\u5f0f\uff0c\u662f\u9632\u6b62\u51fa\u73b0\u6307\u4ee4\u91cd\u6392\u5e8f\u7684\u60c5\u51b5\uff0c\u5bfc\u81f4\u5148\u6267\u884c <code>o.done == 1</code>\uff0c\u518d\u6267\u884c<code>f()</code></li> <li>\u7c7b\u6bd4\u4e8e Java \u5b9e\u73b0\u7684\u53cc\u91cd\u68c0\u67e5\u9501\uff08DCL\uff09\uff0c<code>done</code>\u8fd9\u91cc\u4f7f\u7528 atomic \u7b49\u4ef7\u4e8e <code>volatile</code>\u8bed\u4e49\uff1b</li> </ul> <p>\u4ee3\u7801\u7684\u5b98\u65b9\u89e3\u91ca\u89c1\uff1ahttps://codereview.appspot.com/4641066/#msg14</p> <p>Go \u7684\u5185\u5b58\u6a21\u578b\uff1ahttps://go.dev/ref/mem</p>"},{"location":"2023/12/18/hdfs-%E8%AF%BB%E5%86%99%E9%99%90%E9%80%9F.html","title":"HDFS \u8bfb\u5199\u9650\u901f","text":"<p>\u5f53\u78c1\u76d8\u6ee1\u8d1f\u8377\u65f6\uff0c\u5e0c\u671b\u80fd\u591f\u964d\u4f4e\u8bfb\u5199\u7684\u901f\u7387\uff0c\u907f\u514d HDFS \u8fdb\u7a0b\u5361\u4f4f\uff0c\u6574\u4e2aHDFS \u4e0d\u53ef\u7528\uff0c\u5bfc\u81f4 Client Socket \u5f02\u5e38\uff0c\u4f5c\u4e1a\u5931\u8d25\u3002</p> <p>\u5f53\u524d\uff082023.12.18\uff0cHDFS 3.4 \u7248\u672c\uff09\uff1a</p> <ul> <li>\u5bf9\u4e8e\u8bfb\u5165\u901f\u7387\uff1a\u5e76\u6ca1\u6709\u641c\u5230 HDFS \u76f8\u5173\u53ef\u4ee5\u5bf9\u8bfb\u53d6\u901f\u7387\u505a\u63a7\u5236\uff1b</li> <li>\u5bf9\u4e8e\u5199\u5165\u901f\u7387\uff1a\u53ef\u4ee5\u901a\u8fc7<code>dfs.client.congestion.backoff.mean.time</code>\u3001<code>dfs.client.congestion.backoff.max.time</code>\u63a7\u5236\u5199\u5165\u62e5\u585e\u65f6 Client \u7684\u7b49\u5f85\u65f6\u95f4\uff0c\u7528<code>dfs.pipeline.congestion.ratio</code> \u6765\u63a7\u5236 DataNode \u88ab\u5224\u65ad\u963b\u585e\u65f6\u7684\u8ddfCPU\u6838\u6570\u7684\u6bd4\u7387\u3002</li> </ul>"},{"location":"2023/12/18/hdfs-%E8%AF%BB%E5%86%99%E9%99%90%E9%80%9F.html#_1","title":"\u5199\u5165\u901f\u7387","text":"<p>\u76f8\u5173 JIRA ISSUE</p> <ul> <li> <p>HDFS-7270: Add congestion signaling capability to DataNode write protocol</p> </li> <li> <p>HDFS-8008: Support client-side back off when the datanodes are congested</p> </li> <li>HDFS-8009: Signal congestion on the DataNode</li> <li>HDFS-17171: CONGESTION_RATIO should be configurable</li> <li>HDFS-17242: Make congestion backoff time configurable</li> </ul> <p>\u5f53 DataNode \u88ab\u8ba4\u4e3a\u963b\u585e\u65f6\uff0cClient \u4f1a\u8fdb\u884c backoff \u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u518d\u8fdb\u884c\u5199\u5165\u3002</p> <p>DataStreamer \uff08\u8d1f\u8d23\u5199\uff09\u4e2d <code>backOffIfNecessary</code> \u51fd\u6570\u6839\u636e Write Pipeline Ack \u4e2d\u7684 ECN \u8868\u793a\u6765\u8fdb\u884c Sleep</p> <ul> <li>ECN \u7684\u8bbe\u7f6e\uff1aDataNode \u4e2d\u7684 <code>getECN()</code>\uff0cDataNode \u6709\u6807\u5fd7\u4f4d\u53ef\u4ee5\u8868\u793a CONGESTED\uff08\u62e5\u585e\uff09</li> </ul> <pre><code>// see https://issues.apache.org/jira/browse/HDFS-8009\npublic PipelineAck.ECN getECN() {\n    if (!pipelineSupportECN) {\n        return PipelineAck.ECN.DISABLED;\n    }\n    double load = ManagementFactory.getOperatingSystemMXBean().getSystemLoadAverage();\n    // \u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d &gt; 1.5 * \u6838\u6570\n    return load &gt; NUM_CORES * CONGESTION_RATIO ? PipelineAck.ECN.CONGESTED :\n    PipelineAck.ECN.SUPPORTED;\n}\n</code></pre>"},{"location":"2023/12/18/hdfs-%E8%AF%BB%E5%86%99%E9%99%90%E9%80%9F.html#_2","title":"\u62e5\u585e\u7684\u5224\u65ad","text":"<p><code>\u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d &gt; 1.5 * \u6838\u6570</code>(Hadoop 3.4 \u7248\u672c\u53ef\u914d\u7f6e)\uff0c\u6ce8\u610f $\u8d1f\u8f7d \\ne \u5229\u7528\u7387 $</p> <p>The v0 patch allows the datanode to signal congestion when the load of the system is over 1.5 times of the number of available cores, which means that there are at least 50% more processes are waiting to be scheduled in the OS. We found it an effective metric to signal that the DNs are undergoing massive amount of writes.</p> <p>\u4e3a\u4ec0\u4e48\u78c1\u76d8\u6162\u65f6\uff08\u5927\u91cf\u78c1\u76d8\u4f7f\u7528\u65f6\uff09\uff0cCPU \u8d1f\u8f7d\u4f1a\u98d9\u9ad8\u3002</p> <ul> <li>CPU\u8d1f\u8f7d\u663e\u793a\u7684\u662f\u5728\u4e00\u6bb5\u65f6\u95f4\u5185CPU\u6b63\u5728\u5904\u7406\u4ee5\u53ca\u7b49\u5f85CPU\u5904\u7406\u7684\u8fdb\u7a0b\u6570\u4e4b\u548c\u7684\u7edf\u8ba1\u4fe1\u606f\uff08waiting threads and tasks along with processes being executed\uff09\uff0c\u4e5f\u5c31\u662fCPU\u4f7f\u7528\u961f\u5217\u7684\u957f\u5ea6\u7684\u7edf\u8ba1\u4fe1\u606f\u3002</li> </ul> <p>LInux \u7cfb\u7edf\u4e2d\u8fd8CPU\u8d1f\u8f7d\u5305\u542b\u5904\u4e8e\u4e0d\u53ef\u4e2d\u65ad\u72b6\u6001\u7684\u4efb\u52a1\uff08<code>TASK_UNINTERRUPTIBLE</code> \u6216 <code>nr_uninterruptible</code>\uff09\uff0c\u88ab\u8ba4\u4e3a\u662f\u7cfb\u7edf\u8d1f\u8f7d\uff1a</p> <ul> <li> <p>\u72b6\u6001\u88ab\u6807\u5fd7\u4e3a\u201cD\u201d\uff1a<code>uninterruptible sleep</code></p> </li> <li> <p>\u901a\u5e38\u7b49\u5f85IO\u8bbe\u5907\u3001\u7b49\u5f85\u7f51\u7edc\u7684\u65f6\u5019\uff0c\u8fdb\u7a0b\u4f1a\u5904\u4e8e<code>uninterruptible sleep</code>\u72b6\u6001\uff1b</p> </li> </ul>"},{"location":"2023/11/05/helm-%E5%A6%82%E4%BD%95%E5%8D%87%E7%BA%A7%E6%97%B6%E4%B8%8D%E5%8D%87%E7%BA%A7%E7%89%B9%E5%AE%9A%E7%9A%84resource.html","title":"Helm \u5982\u4f55\u5347\u7ea7\u65f6\u4e0d\u5347\u7ea7\u7279\u5b9a\u7684Resource","text":"<p>Helm 3\u7684\u5e94\u7528\u5728\u5347\u7ea7\u65f6\uff0c\u4f1a\u6839\u636e\u4e09\u8def\u5408\u5e76\u7b56\u7565\u53bb\u51b3\u5b9a\u5982\u4f55\u5bf9 Resource \u8fdb\u884c\u5347\u7ea7\u3002</p> <p>\u5047\u8bbe\u67d0\u4e2a Helm Applicaion \u5b9a\u4e49\u4e86 ConfigMap\uff0c\u5728\u5b89\u88c5\u7684\u65f6\u5019\u4f1a\u5728 K8s \u521b\u5efa\u5bf9\u5e94\u8d44\u6e90\uff0c\u4f46\u662f\u540e\u7eed\u8fd0\u7ef4\u4eba\u5458\u4f1a\u6839\u636e\u751f\u4ea7\u73af\u5883\u60c5\u51b5\u53bb\u52a8\u6001\u4fee\u6539\u8be5 ConfigMap \u4e2d\u7684\u5185\u5bb9\uff0c\u5e76\u4e14\u5e0c\u671b\u5728 Application \u5347\u7ea7\u7684\u65f6\u5019\uff0c\u5bf9\u8be5 ConfigMap \u4e0d\u8fdb\u884c\u5347\u7ea7\uff08\u5373\u4e0d\u80fd\u4fee\u6539\u751f\u4ea7\u73af\u5883\u7684\u914d\u7f6e\u5185\u5bb9\uff09\uff0c\u8be5\u5982\u4f55\u914d\u7f6e Helm Application \u7684 Charts \u5185\u5bb9\u5462\uff1f</p>"},{"location":"2023/11/05/helm-%E5%A6%82%E4%BD%95%E5%8D%87%E7%BA%A7%E6%97%B6%E4%B8%8D%E5%8D%87%E7%BA%A7%E7%89%B9%E5%AE%9A%E7%9A%84resource.html#helm-2-two-way","title":"Helm 2 two-way \u5408\u5e76\u7b56\u7565","text":"<p>Helm 2 \u5728\u5347\u7ea7\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u5bf9\u6bd4\u6700\u8fd1\u4e00\u6b21\u7684chart manifest \u548c <code>helm upgrade</code>\u63d0\u4f9b\u7684 chart manifests\u3002\u5347\u7ea7\u4f1a\u5bf9\u6bd4\u4e24\u4e2a chart \u4e0d\u540c\u6765\u51b3\u5b9a\u54ea\u4e9b\u66f4\u6539\u4f1a\u5e94\u7528\u5230Kubernetes\u8d44\u6e90\u4e2d\u3002</p> <ul> <li>\u5982\u679c resource \u88ab\u975e helm \u7684\u5916\u90e8\u66f4\u6539\uff08\u5982 kubectl edit\uff09\uff0c\u8fd9\u4e9b\u53d8\u66f4\u4e0d\u4f1a\u88ab\u8003\u8651\uff08helm \u4e0d\u4f1a\u5bf9\u8fd9\u4e9b\u53d8\u66f4\u505a\u5347\u7ea7\u6216\u56de\u6eda\uff09\uff1b</li> <li>\u5373\uff1a\u53ea\u4f1a\u6839\u636e\u524d\u540e\u63d0\u4f9b\u7684 helm charts \u8fdb\u884c\u5bf9\u6bd4\uff0c\u5c06\u4e0d\u540c\u4e4b\u5904 patch \u5230 resource\uff1b</li> </ul> <p>\u5728 Helm 2 \u7684 \u573a\u666f\u4e0b\uff0c\u53ea\u8981\u4e0d\u540c\u7248\u672c\u7684 Helm Charts \u5bf9\u5e94\u7684 ConfigMap \u7684 Resource \u5185\u5bb9\u4e0d\u53d8\uff0c\u5219\u901a\u8fc7 kubectl edit \u7684\u4fee\u6539\uff0c\u4e0d\u4f1a\u88ab Helm \u5347\u7ea7\u800c\u5185\u5bb9\u88ab\u91cd\u7f6e\uff0c\u6ee1\u8db3\u9700\u6c42\u573a\u666f\u3002</p>"},{"location":"2023/11/05/helm-%E5%A6%82%E4%BD%95%E5%8D%87%E7%BA%A7%E6%97%B6%E4%B8%8D%E5%8D%87%E7%BA%A7%E7%89%B9%E5%AE%9A%E7%9A%84resource.html#helm-3-three-way","title":"Helm 3 three-way \u5408\u5e76\u7b56\u7565","text":"<p>\u8003\u8651 old manifest\uff0clive state \u548c new manifest \u4e09\u8005\uff0c\u751f\u6210 patch\u3002</p> <ul> <li>\u5982\u679c manifest \u524d\u540e\u4e0d\u53d8\uff0chelm 3 \u4f1a\u5c06\u65b0\u7684 mainfest \u8986\u76d6\uff0c\u6b64\u65f6\u5916\u90e8\u7684\u6539\u52a8\u4f1a\u4e22\u5931\uff1b</li> </ul>"},{"location":"2023/11/05/helm-%E5%A6%82%E4%BD%95%E5%8D%87%E7%BA%A7%E6%97%B6%E4%B8%8D%E5%8D%87%E7%BA%A7%E7%89%B9%E5%AE%9A%E7%9A%84resource.html#helm-3-resource","title":"Helm 3 \u914d\u7f6e\u5347\u7ea7\u65f6\u5ffd\u7565\u7279\u5b9aResource","text":"<p>Github\u94fe\u63a5\uff1aFeature request: ignore part of a resource in upgrade</p> <p>\u5b98\u7f51\u6ca1\u6709\u914d\u7f6e\u53ef\u4ee5\u89e3\u51b3\u8be5\u95ee\u9898\uff0c\u901a\u8fc7Github Issues \u641c\u7d22\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>lookup</code> \u51fd\u6570\u89e3\u51b3</p> <ul> <li>helm 3.13 \u7248\u672c\u7684 <code>--dry-run</code>\uff08\u4ec5\u67e5\u770b\u53d8\u66f4\u800c\u4e0d\u5e94\u7528\u5230\u96c6\u7fa4\uff09 \u53c2\u6570\u652f\u6301<code>client</code>\u548c<code>server</code>\uff08\u652f\u6301 <code>lookup</code>\uff09\u6a21\u5f0f</li> </ul> <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: upgrade-test\n  namespace: default\ndata:\n  content: |\n# \u67e5\u627e config map \u7684\u5f53\u524d\u5185\u5bb9\uff0c\u5e76\u5e94\u7528  \n{{ (lookup \"v1\" \"ConfigMap\" \"default\"  \"upgrade-test\").data.content | indent 4 }}\n</code></pre>"},{"location":"2024/01/15/maven-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91.html","title":"Maven \u63d2\u4ef6\u5f00\u53d1","text":"<p>\u5728\u5f00\u53d1\u901a\u8fc7\u5305/\u7c7b/\u65b9\u6cd5\u6ce8\u89e3\u81ea\u52a8\u751f\u6210README\u7684\u529f\u80fd\u65f6\uff0c\u5728\u4f7f\u7528\u65f6\uff0c\u5982\u679c\u4f7f\u7528 Jar \u4f9d\u8d56\u7684\u65b9\u5f0f\uff0c\u9700\u8981\u4e3a\u6bcf\u4e2a\u5de5\u7a0b\u5b9a\u4e49\u4e00\u4e2a Main \u65b9\u6cd5\uff0c\u5e76\u4e14\u9700\u8981\u624b\u52a8\u8c03\u7528\u3002</p> <p>\u56e0\u6b64\u60f3\u901a\u8fc7\u5f00\u53d1Maven \u63d2\u4ef6\uff0c\u5728compile\u9636\u6bb5\u81ea\u52a8\u8c03\u7528\u5e76\u751f\u6210 README\uff0c\u56e0\u6b64\u4fbf\u7814\u7a76\u5982\u4f55\u5f00\u53d1 Maven \u63d2\u4ef6\u3002</p>"},{"location":"2024/01/15/maven-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91.html#_1","title":"\u5f00\u53d1","text":"<p>\u5b98\u65b9\u53c2\u8003\u6587\u6863\uff1ahttps://maven.apache.org/plugin-developers/index.html</p> <p>pom.xml \u914d\u7f6e\uff0c\u6700\u65b0\u7248\u7684\u914d\u7f6e\u89c1\uff1a</p> <ul> <li>maven\u6838\u5fc3\u7248\u672c\uff1ahttps://mvnrepository.com/artifact/org.apache.maven/maven-plugin-api</li> <li>maven\u63d2\u4ef6\u7248\u672c\uff1ahttps://mvnrepository.com/artifact/org.apache.maven.plugin-tools/maven-plugin-tools-api</li> </ul> <pre><code>&lt;dependencies&gt;   \n    &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.maven.plugin-tools&lt;/groupId&gt;\n        &lt;artifactId&gt;maven-plugin-annotations&lt;/artifactId&gt;\n        &lt;version&gt;3.9.0&lt;/version&gt;\n        &lt;scope&gt;provided&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;!-- \u83b7\u53d6 MavenProject \u548c MavenSession \u65f6\u9700\u8981\u5f15\u7528\u7684\u5305\uff0cmaven core \u548c plugin \u5927\u7248\u672c\u4e00\u81f4\uff0c\u4f46\u5c0f\u7248\u672c\u4e0d\u5b8c\u5168\u4e00\u81f4 --&gt;\n        &lt;groupId&gt;org.apache.maven&lt;/groupId&gt;\n        &lt;artifactId&gt;maven-core&lt;/artifactId&gt;\n        &lt;version&gt;3.9.5&lt;/version&gt;\n        &lt;scope&gt;provided&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.maven&lt;/groupId&gt;\n        &lt;artifactId&gt;maven-plugin-api&lt;/artifactId&gt;\n        &lt;version&gt;3.9.5&lt;/version&gt;\n        &lt;scope&gt;provided&lt;/scope&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n\n&lt;build&gt;\n    &lt;plugins&gt;\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-plugin-plugin&lt;/artifactId&gt;\n            &lt;version&gt;3.9.0&lt;/version&gt;\n        &lt;/plugin&gt;\n    &lt;/plugins&gt;\n&lt;/build&gt;\n</code></pre>"},{"location":"2024/01/15/maven-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91.html#_2","title":"\u751f\u547d\u5468\u671f","text":"<p>\u5f00\u53d1\u63d2\u4ef6\uff0c\u9700\u8981\u7ee7\u627f <code>AbstractMojo</code> \u5e76\u5b9e\u73b0 execute \u65b9\u6cd5\uff1b</p> <ul> <li><code>@Mojo</code>\u7684<code>name</code> \u662f plugin xml\u4e2d execution \u4e2d\u7684 goal \u7684\u53ef\u9009\u9879</li> </ul> <pre><code>@Mojo(name = \"generate-doc\", defaultPhase = LifecyclePhase.COMPILE)\npublic class AnnotationMojo extends AbstractMojo {\n    public void execute() throws MojoExecutionException {\n        getLog().info(\"Hello, world.\");\n    }\n}\n</code></pre>"},{"location":"2024/01/15/maven-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91.html#_3","title":"\u53c2\u6570","text":"<p><code>@Parameter</code> \u6ce8\u89e3\u5b9a\u4e49\u53c2\u6570\uff1a</p> <ul> <li><code>defaultValue</code> \u4e3a <code>\"\"</code> \u65f6\uff0c\u5176\u5728\u8fd0\u884c\u65f6\u7684\u503c\u4e3a <code>null</code>\uff1b</li> <li>\u53c2\u6570\u76f4\u63a5\u8868\u8fbe\u5f0f\uff0c\u5982<code>${project.basedir}</code>\u8868\u793a\u9879\u76ee\u7684\u6839\u8def\u5f84</li> </ul> <pre><code>@Parameter(name = \"scanPkgPrefix\", required = true\uff0c threadSafe=true)\nprivate String scanPkgPrefix;\n\n@Parameter(name = \"outputFilePath\", defaultValue = \"./README.md\")\nprivate String outputFilePath;\n\n@Parameter(name = \"skipPkgs\", defaultValue = \"\")\nprivate String skipPkgs;\n</code></pre> <p>\u7279\u6b8a\u7684\u53c2\u6570\uff1a</p> <pre><code>// \u5f53\u524d\u63d2\u4ef6\u5904\u7406\u7684\u9879\u76ee\uff0c\u591amaven\u9879\u76ee\u65f6\uff0c\u63d2\u4ef6\u4f1a\u88ab\u8c03\u7528\u591a\u6b21\n@Parameter(defaultValue = \"${project}\", required = true, readonly = true)\nMavenProject currentProject;\n\n// maven session\uff0c\u53ef\u83b7\u53d6\u6240\u6709\u7684maven\u9879\u76ee\u4ee5\u53ca\u9879\u76ee\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\n@Parameter(defaultValue = \"${session}\", readonly = true, required = true)\nprivate MavenSession session;\n</code></pre>"},{"location":"2024/01/15/maven-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91.html#_4","title":"\u7c7b\u52a0\u8f7d\u5668","text":"<p>Maven \u2013 Guide to Maven Classloading (apache.org)</p> <p>\u901a\u8fc7\u5728\u63d2\u4ef6\u7684<code>execute</code>\u51fd\u6570\u4e2d\uff0c\u6253\u5370<code>java.class.path</code>\u5c5e\u6027\uff0c\u7c7b\u52a0\u8f7d\u5668\u662f<code>org.codehaus.plexus.classworlds.realm.ClassRealm</code></p> <ul> <li>\u7236\u7c7b\u52a0\u8f7d\u662f <code>AppClassLoader</code></li> </ul> <pre><code>java.class.path -&gt; C:\\Program Files\\JetBrains\\IntelliJ IDEA 2023.3.2\\plugins\\maven\\lib\\maven3\\boot\\plexus-classworlds-2.7.0.jar\n</code></pre>"},{"location":"2024/01/15/maven-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91.html#maven-corejar","title":"maven core\u4f9d\u8d56\u7684jar","text":"<p>\u5f00\u53d1\u63d2\u4ef6\u65f6\uff0c\u4f7f\u7528 maven core \u7684\u4f9d\u8d56\u63d2\u4ef6\u65f6\uff0c\u5982 guava\uff0ccommon-lang3\uff0c\u5728\u5b9e\u9645\u4f7f\u7528\u63d2\u4ef6\u65f6\u4f1a\u51fa\u73b0\u7c7b\u4e0d\u5b58\u5728\u7684\u60c5\u51b5\uff1a</p> <ul> <li>maven \u8f6f\u4ef6\u7684 <code>lib</code>\u76ee\u5f55\u4e0b\uff0c\u5b58\u5728\u8fd9\u4e9b\u7b2c\u4e09\u65b9\u4f9d\u8d56 jar \u5305\uff1b</li> <li>\u4f46\u5728\u63d2\u4ef6\u8fd0\u884c\u65f6\uff0c\u5176\u7c7b\u52a0\u8f7d\u5668\u6ca1\u6709\u8fd9\u4e9b jar \u5305\uff0c\u63d2\u4ef6\u9700\u8981\u663e\u793a\u6307\u5b9a\u8be5\u4f9d\u8d56\uff1b</li> </ul>"},{"location":"2024/01/15/maven-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91.html#_5","title":"\u9879\u76ee\u6e90\u7801\u83b7\u53d6","text":"<p>maven \u63d2\u4ef6\u5f00\u53d1\u65f6\uff0c\u5176\u7c7b\u52a0\u8f7d\u4e0d\u5305\u542b\u5de5\u7a0b\u4ee3\u7801\u8def\u5f84\uff0c\u56e0\u6b64\u65e0\u6cd5\u901a\u8fc7\u53cd\u5c04\u83b7\u53d6\u7c7b\u7684\u76f8\u5173\u4fe1\u606f\u3002</p> <ul> <li>\u83b7\u53d6\u9879\u76ee\u4ee3\u7801\u7684\u7c7b\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u53ef\u4ee5\u901a\u8fc7\u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u5668\u5b9e\u73b0\uff0c\u4e0b\u9762\u662f\u793a\u4f8b\uff1a</li> </ul> <pre><code>// requiresDependencyResolution \u4f1a\u5c06\u6240\u6709\u7684COMPILE\u4f9d\u8d56\uff08\u5305\u62ec\u9012\u5f52\u4f9d\u8d56\uff09\uff0c\u90fd\u653e\u5230 project \u7684 CompileClasspathElements \u4e2d\u3002\n@Mojo(name = \"generate-doc\", defaultPhase = LifecyclePhase.COMPILE, requiresDependencyResolution = ResolutionScope.COMPILE)\npublic class AnnotationMojo extends AbstractMojo {\n    @Parameter(defaultValue = \"${project}\", required = true, readonly = true)\n    MavenProject project;\n\n    public void execute() throws MojoExecutionException {\n        // \u5c06\u7f16\u8bd1\u540e\u7684class\u8def\u5f84\u52a0\u5230 classpath \u4e2d\n        List&lt;String&gt; classpathElements = project.getCompileClasspathElements();\n        urls = new URL[classpathElements.size()];\n        for (int i = 0; i &lt; classpathElements.size(); ++i) {\n            urls[i] = new File(classpathElements.get(i)).toURI().toURL();\n        }\n        // \u901a\u8fc7\u81ea\u5b9a\u4e49\u7684\u7c7b\u52a0\u8f7d\u5668\u8fdb\u884c\u7c7b\u7684\u52a0\u8f7d\n        ClassLoader classloader = new URLClassLoader(urls, getClass().getClassLoader());\n        Class.forName(\"org.xliu.cs.projects.ClassA\", true, classloader);\n    }\n}\n</code></pre>"},{"location":"2024/01/15/maven-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91.html#_6","title":"\u65e5\u5fd7","text":"<p>https://maven.apache.org/ref/current/maven-embedder/logging.html</p> <p>maven 3.5 \u4e4b\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 Slf4j \u7684 API \u8fdb\u884c\u65e5\u5fd7\u6253\u5370\uff0cmaven \u4f7f\u7528\u65f6\u5728\u63a7\u5236\u53f0\u4f1a\u8fdb\u884c\u6253\u5370\u3002</p>"},{"location":"2024/01/15/maven-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91.html#_7","title":"\u90e8\u7f72","text":"<p>maven install \u90e8\u7f72\u5230\u672c\u5730\uff1b</p> <p>maven deploy \u90e8\u7f72\u5230\u670d\u52a1\u5668\uff1b</p>"},{"location":"2024/01/15/maven-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91.html#_8","title":"\u8c03\u8bd5","text":"<p>\u5f53\u63d2\u4ef6\u540d\u79f0\u7b26\u5408 XXX-maven-plugin \u65f6\uff0cmvn \u4f7f\u7528\u65f6\uff0c\u53ea\u9700\u7528 XXX \u5373\u53ef\uff0c\u540e\u9762\u53ef\u4ee5\u7701\u7565\u3002</p> <p><code>mvnDebug</code> \u547d\u4ee4\u8c03\u8bd5\uff0c\u7a0b\u5e8f\u4f1a\u81ea\u52a8\u5206\u914d8000 Listen\u7aef\u53e3\uff0c\u4f1a\u7b49\u5f85 Remote \u8fde\u63a5\u540e\uff0c\u624d\u4f1a\u7ee7\u7eed\u6267\u884c\uff1a</p> <ul> <li> <p><code>mvnDebug</code> \u53ef\u4ee5\u7528 IDEA \u5185\u7f6e\u7684 maven\uff0c\u4e00\u822c\u4f1a\u5728<code>plugins\\maven\\lib\\maven3\\bin</code>\u76ee\u5f55\u4e0b\uff1b</p> </li> <li> <p>\u547d\u4ee4\u793a\u4f8b\uff1a<code>mvnDebug annotations-for-doc:generate-doc@{id}</code></p> </li> <li>\u5fc5\u987b\u6307\u5b9a id\uff0c\u4e0d\u7136\u547d\u4ee4\u884c\u6267\u884c\u65f6\uff0c\u4e0d\u4f1a\u8bfb\u53d6 configuration \u7684\u914d\u7f6e</li> </ul> <pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.xliu.cs.projects&lt;/groupId&gt;\n    &lt;artifactId&gt;annotations-for-doc-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;1.0.1&lt;/version&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;!-- \u53ef\u4ee5\u914d\u7f6e\u591a\u4e2a execution\uff0c\u53ea\u8981 id \u4e0d\u4e00\u6837\u5373\u53ef\uff0cid\u53ea\u662f\u6807\u8bc6\u7b26\uff08\u6ca1\u6709\u5176\u4ed6\u542b\u4e49\uff09 --&gt;\n            &lt;id&gt;generate&lt;/id&gt;\n            &lt;goals&gt;\n                &lt;!-- \u5339\u914d@Mojo \u6ce8\u89e3\u7684name --&gt;\n                &lt;goal&gt;generate-doc&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;configuration&gt;\n                &lt;scanPkgPrefix&gt;org.xliu.cs.jvm&lt;/scanPkgPrefix&gt;\n                &lt;outputFilePath&gt;${project.basedir}/README.md&lt;/outputFilePath&gt;\n            &lt;/configuration&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre> <p>\u7136\u540e IDEA \u4e2d\u6253\u5f00\u63d2\u4ef6\u6e90\u7801\uff0c\u7528 Remote \u6a21\u5f0f\u8fdb\u884c\u65ad\u70b9\u8c03\u8bd5\uff08\u672c\u5730mvn\u4ed3\u5e93\u9700\u8981\u5305\u542b\u63d2\u4ef6\u7684\u6e90\u7801\uff0c\u5426\u5219\u65e0\u6cd5 debug\uff09\uff1b</p>"},{"location":"2023/12/31/maven-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BB%93%E5%BA%93.html","title":"Maven \u81ea\u5b9a\u4e49\u4ed3\u5e93","text":"<p>\u5f53\u81ea\u5df1\u5f00\u53d1\u4e00\u4e2a\u5de5\u5177\u5305\uff0c\u7136\u540e\u53e6\u4e00\u4e2a\u9879\u76ee\u8981\u5f15\u7528\u65f6\uff0c\u56e0\u6b64\u9700\u8981\u5c06 jar \u5305\u653e\u5230\u53ef\u8bbf\u95ee\u7684\u516c\u7f51\u4e0a\uff1a</p> <ul> <li> <p>Maven \u5b98\u65b9 repo\uff0c\u5982\u4f7f\u7528 Sonatype OSSRH\uff0c\u4f46\u5176\u6ce8\u518c\u590d\u6742\uff0c\u6b64\u6b21\u4e0d\u8fdb\u884c\u4ecb\u7ecd\uff1b</p> </li> <li> <p>\u7b2c\u4e09\u65b9\u516c\u5171\u4ed3\u5e93\uff0c\u5982 JitPack, Github/Gitee\u7b49\uff0c\u540e\u9762\u8fdb\u884c\u4ecb\u7ecd\u3002</p> </li> </ul>"},{"location":"2023/12/31/maven-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BB%93%E5%BA%93.html#jitpack-maven","title":"JitPack \u4f5c\u4e3aMaven\u4ed3\u5e93","text":"<p>\u53ea\u80fd\u6839\u636e\u9879\u76ee\u5730\u5740\u81ea\u52a8\u751f\u6210 group id \u548c artificat id\uff0c\u4e0d\u4f1a\u6839\u636epom.xml\u4e2d\u5b9a\u4e49\u7684\u751f\u6210\u3002</p>"},{"location":"2023/12/31/maven-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BB%93%E5%BA%93.html#jar","title":"\u6784\u5efa jar \u5305","text":"<p>\u6839\u636e Tag / Release \u6765\uff1a</p> <ul> <li>\u8f93\u5165\u9879\u76ee\u5730\u5740\uff0c\u70b9\u51fb'Look up' \u4f1a\u81ea\u52a8\u6784\u5efa\uff1b</li> <li><code>Log</code> \u67e5\u770b\u6784\u5efa\u5386\u53f2</li> </ul> <p></p>"},{"location":"2023/12/31/maven-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BB%93%E5%BA%93.html#jar_1","title":"\u4f7f\u7528Jar\u5305","text":"<p>pom.xml \u4e2d\u914d\u7f6e</p> <pre><code>&lt;repositories&gt;\n    &lt;repository&gt;\n        &lt;id&gt;jitpack.io&lt;/id&gt;\n        &lt;url&gt;https://jitpack.io&lt;/url&gt;\n    &lt;/repository&gt;\n&lt;/repositories&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;com.gitee.cs-open-project&lt;/groupId&gt;\n    &lt;artifactId&gt;annotations-for-readme&lt;/artifactId&gt;\n    &lt;version&gt;v1.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>"},{"location":"2023/12/31/maven-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BB%93%E5%BA%93.html#github-maven","title":"Github \u9879\u76ee\u4f5c\u4e3aMaven\u4ed3\u5e93","text":"<p>Gitee \u4e5f\u53ef\u4ee5\u4f5c\u4e3a Maven \u4ed3\u5e93\uff0c\u4f46\u662f\u7b2c\u4e8c\u6b65\"\u4e0a\u4f20 Deploy \u8f93\u51fa\"\uff0c\u65e0\u6cd5\u901a\u8fc7maven\u63d2\u4ef6\u6267\u884c\uff0c\u9700\u8981\u624b\u52a8\u4e0a\u4f20\u3002</p>"},{"location":"2023/12/31/maven-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BB%93%E5%BA%93.html#deploy","title":"\u6307\u5b9a\u6784\u5efaDeploy\u7684\u8f93\u51fa\u4f4d\u7f6e","text":"<pre><code> &lt;plugin&gt;\n    &lt;!--\u7528\u4e8e\u5c06\u6784\u5efa\u4ea7\u7269\uff08\u901a\u5e38\u662fJAR\u6587\u4ef6\u3001WAR\u6587\u4ef6\u7b49\uff09\u90e8\u7f72\u5230\u8f93\u51fa\u4f4d\u7f6e--&gt;\n    &lt;artifactId&gt;maven-deploy-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.8.1&lt;/version&gt;\n    &lt;configuration&gt;\n        &lt;altDeploymentRepository&gt;internal.repo::default::file://${project.build.directory}/mvn-repo&lt;/altDeploymentRepository&gt;\n    &lt;/configuration&gt;\n&lt;/plugin&gt;\n</code></pre>"},{"location":"2023/12/31/maven-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BB%93%E5%BA%93.html#deploy_1","title":"\u4e0a\u4f20 Deploy \u8f93\u51fa","text":"<p>m2\u7684<code>settings.xml</code>\u914d\u7f6e server</p> <pre><code>&lt;servers&gt;\n  &lt;server&gt;\n    &lt;id&gt;xliuqq-github&lt;/id&gt;&lt;!-- \u81ea\u5b9a\u4e49\u7684id\u3002\u8bb0\u4f4f\u6b64id, \u540e\u7eed\u53d1\u5e03jar\u5305\u65f6\u8981\u4f7f\u7528 --&gt;\n    &lt;!-- token \u9700\u8981\u5177\u5907 repo \u7684\u8bfb\u5199\uff0c\u548c user email \u6743\u9650--&gt;\n    &lt;password&gt;your-token&lt;/password&gt;\n  &lt;/server&gt;\n&lt;/servers&gt;\n</code></pre> <p>\u5f85\u53d1\u5e03\u7684\u5de5\u7a0b\u7684 pom.xml \u4e2d\u914d\u7f6e\uff0c\u5c06\u5305\u53d1\u5e03\u5230 github \u7684\u4ed3\u5e93\u4e2d</p> <pre><code>&lt;!--\u7528\u4e8e\u53d1\u5e03\u5230Github \u6307\u5b9a\u4ed3\u5e93--&gt;\n&lt;plugin&gt;\n    &lt;groupId&gt;com.github.github&lt;/groupId&gt;\n    &lt;artifactId&gt;site-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;0.12&lt;/version&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;site&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;phase&gt;deploy&lt;/phase&gt;\n            &lt;configuration&gt;\n                &lt;!--\u670d\u52a1\u540d\uff08settings.xml\u4e2d\u914d\u7f6e\u5185\u5bb9\uff0c\u4e0a\u8ff0\u914d\u7f6e\u7684server\u7684id\uff09--&gt;\n                &lt;server&gt;xliuqq-github&lt;/server&gt;\n                &lt;!-- \u63d0\u4ea4\u6d88\u606f\uff08commit message\uff09--&gt;\n                &lt;message&gt;Maven artifacts for [${project.artifactId}-${project.version}]&lt;/message&gt;\n                &lt;!-- \u4e0a\u4f20\u7f51\u7ad9\u7684\u4f4d\u7f6e\uff08\u8fdc\u7a0b\u4ed3\u5e93\u540d\uff09 --&gt;\n                &lt;repositoryName&gt;maven-repository&lt;/repositoryName&gt;\n                &lt;!--\u7ec4\u7ec7\u6216\u7528\u6237\u540d--&gt;\n                &lt;repositoryOwner&gt;xliuqq&lt;/repositoryOwner&gt;\n                &lt;!-- \u4f7f\u7528\u5408\u5e76\u6216\u8986\u76d6\u5185\u5bb9 --&gt;\n                &lt;merge&gt;true&lt;/merge&gt;\n                &lt;!--\u5206\u652f\uff08\u56fa\u5b9a\u5199\u6cd5\uff1arefs/heads/ + \u4f60\u7684\u5206\u7ec4\uff09--&gt;\n                &lt;branch&gt;refs/heads/main&lt;/branch&gt;\n                &lt;!--\u6e90\u6587\u4ef6\u5730\u5740\uff0c\u8ddf\u4e0a\u4e00\u6b65\u7684deploy\u8f93\u51fa\u4f4d\u7f6e\u5bf9\u5e94--&gt;\n                &lt;outputDirectory&gt;${project.build.directory}/mvn-repo&lt;/outputDirectory&gt;\n                &lt;!-- \u5305\u542boutputDirectory\u6807\u7b7e\u5185\u586b\u7684\u6587\u4ef6\u5939\u4e2d\u7684\u6240\u6709\u5185\u5bb9 --&gt;\n                &lt;includes&gt;\n                    &lt;include&gt;**/*&lt;/include&gt;\n                &lt;/includes&gt;\n            &lt;/configuration&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n</code></pre>"},{"location":"2023/12/31/maven-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BB%93%E5%BA%93.html#jar_2","title":"\u4f7f\u7528 jar","text":"<p>pom.xml</p> <pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.xliu.cs.projects&lt;/groupId&gt;\n        &lt;artifactId&gt;annotations-for-doc&lt;/artifactId&gt;\n        &lt;version&gt;1.0&lt;/version&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n\n&lt;repositories&gt;\n  &lt;repository&gt;\n    &lt;id&gt;maven-github&lt;/id&gt;    &lt;!--\u6b64id\u9700\u8981\u4e0esetting.xml\u4e2d\u7684\u914d\u7f6e\uff0c\u4f46\u4e0d\u7528\u8ddf\u7b2c\u4e00\u6b65\u4e2d\u4e0a\u4f20\u7684server\u540d\u4e00\u81f4--&gt;\n    &lt;!-- github \u8bbf\u95ee\u8def\u5f84 --&gt;\n    &lt;url&gt;http://raw.github.com/xliuqq/maven-repository/main&lt;/url&gt;\n    &lt;!-- \u5982\u679c github \u65e0\u6cd5\u8bbf\u95ee\uff08\u6216\u8005\u914d\u7f6e\u4ee3\u7406\u4ecd\u51fa\u73b0`Unknown host \u8bf7\u6c42\u7684\u540d\u79f0\u6709\u6548\uff0c\u4f46\u662f\u627e\u4e0d\u5230\u8bf7\u6c42\u7684\u7c7b\u578b\u7684\u6570\u636e`\u95ee\u9898\uff0c\u53ef\u901a\u8fc7gitee\u540c\u6b65gihub\u9879\u76ee\uff0c\u7136\u540e\u4f7f\u7528 gitee \u5730\u5740 --&gt;\n    &lt;!-- &lt;url&gt;https://gitee.com/luckyQQQ/maven-repository/raw/main&lt;/url&gt; --&gt;\n  &lt;/repository&gt;\n&lt;/repositories&gt;\n</code></pre> <p>\u5982\u679c\u914d\u7f6e\u4e86 mirror *\uff0c\u5219\u9700\u8981\u5ffd\u7565\u8fd9\u4e2a repository-id\u3002</p> <pre><code>&lt;!-- \u914d\u7f6e1\uff1a\n  \u6ce8\u610f: &lt;mirrorOf&gt;*,!your-github&lt;/mirrorOf&gt;\n  \u539f\u672c: &lt;mirrorOf&gt;*&lt;/mirrorOf&gt; \n--&gt;\n&lt;mirror&gt;&lt;!--\u6b64\u5904\u4f7f\u7528\u963f\u91cc\u4e91\u955c\u50cf\uff0c\u589e\u52a0!your-repository-id\uff0c\u8ddf\u4e0a\u9762\u4fdd\u6301\u4e00\u81f4--&gt;\n  &lt;id&gt;nexus-aliyun&lt;/id&gt;\n  &lt;mirrorOf&gt;*,!maven-github&lt;/mirrorOf&gt;\n  &lt;name&gt;Nexus aliyun&lt;/name&gt;\n  &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public&lt;/url&gt;\n&lt;/mirror&gt;\n</code></pre>"},{"location":"2024/11/19/spark-accumlator-%E8%A7%A3%E6%9E%90.html","title":"Spark Accumlator \u89e3\u6790","text":"<p>\u95ee\u9898\uff1a</p> <ul> <li>Accumlator \u7684\u66f4\u65b0\u7c92\u5ea6\u662f Task \u7ea7\u522b\uff0c\u8fd8\u662f\u4ec0\u4e48\u7c92\u5ea6\uff1f</li> <li>Task \u5931\u8d25\u65f6\u7684\u7d2f\u52a0\u5668\u4fe1\u606f\uff0c\u662f\u5426\u4ecd\u4f1a\u66f4\u65b0\uff0c\u51fa\u73b0\u91cd\u590d\u7684\u60c5\u51b5\uff1f</li> <li>Action \u4e2d\u7684\u7d2f\u52a0\u5668\u5982\u4f55\u4fdd\u8bc1\u53ea\u6267\u884c\u4e00\u6b21\uff1f</li> <li>Transform \u4e2d\u7684\u7d2f\u52a0\u5668\u662f\u5426\u6709\u529e\u6cd5\u89e3\u51b3\u91cd\u7b97\u65f6\u591a\u6b21\u66f4\u65b0\u7684\u95ee\u9898\uff1f</li> </ul>"},{"location":"2024/11/19/spark-accumlator-%E8%A7%A3%E6%9E%90.html#_1","title":"\u7d2f\u52a0\u5668\u7684\u66f4\u65b0\u6d41\u7a0b","text":"<p>\u6574\u4f53\u6d41\u7a0b\u5927\u81f4\u5982\u4e0b:</p> <ul> <li>Driver \u7aef\u5e8f\u5217\u5316\u65f6\uff1a\u95ed\u5305\u4f20\u9012\u7684\u662f\u7a7a\u7684\u5bf9\u8c61\uff08<code>AccumulatorV2::writeReplace</code>\uff09\uff1b</li> <li>Executor \u7aef\u53cd\u5e8f\u5217\u5316\u65f6\uff1a\u901a\u8fc7 TaskContext \u8fdb\u884c\u6ce8\u518c\uff08<code>AccumulatorV2::readObject</code>\uff09\uff1b</li> <li>Executor \u7aef\u6267\u884c Task \u65f6\uff1a\u53cd\u5e8f\u5217\u5316\u5f97\u5230\u7684AccumulatorV2\u8fdb\u884c\u6b63\u5e38\u66f4\u65b0\uff08<code>add</code>\uff09\uff1b</li> <li>Executor \u7aefTask \u5b8c\u6210\u65f6\u5411 Driver \u53d1\u9001 DirectTaskResult\uff0c\u5305\u542b\u672cTask\u7684\u8ba1\u6570\u5668\u7684\u4fe1\u606f\uff1b</li> <li>\u5982\u679c\u7d2f\u52a0\u5668\u7684<code>countFailedValues</code>\u8bbe\u7f6e\u4e3afalse\uff0c\u5219Task\u5f02\u5e38/\u5931\u8d25\u65f6\u4e0d\u4f1a\u643a\u5e26\u8be5\u7d2f\u52a0\u5668\u3002</li> <li>Driver \u7aef\u5728\u5904\u7406<code>CompletionEvent</code>\uff08 Task \u5b8c\u6210\u65f6\uff09\u65f6\uff0c\u83b7\u53d6Task\u7684\u7d2f\u52a0\u5668\u7684\u4fe1\u606f\u5e76\u66f4\u65b0\u5230Driver\uff1b</li> </ul> <p>Driver \u7aef\u7684<code>CompletionEvent</code>\u7684\u5904\u7406\u903b\u8f91<code>handleTaskCompletion</code>\uff0c\u5bf9\u4e8e\u7d2f\u52a0\u5668\u7684\u66f4\u65b0\u6d41\u7a0b\uff1a</p> <ul> <li>Task \u6210\u529f</li> <li><code>ResultTask</code>\uff1a\u5982\u679c Task \u7684 outputId \u672a\u6807\u8bb0\u5b8c\u6210\uff0c\u5219\u6267\u884c\u7d2f\u52a0\u5668\u66f4\u65b0\uff1b\uff08\u4fdd\u8bc1\u6bcf\u4e2aTask\u4ec5\u6267\u884c\u4e00\u6b21\uff09\uff1b</li> <li>\u5176\u5b83\uff08<code>ShuffleMapTask</code>\uff09\uff0c\u66f4\u65b0\u7d2f\u52a0\u5668</li> <li>Task \u5f02\u5e38\u5931\u8d25/\u88ab\u6740\u6b7b\uff1a\u66f4\u65b0\u7d2f\u52a0\u5668</li> </ul> <p>SparkContext \u4e2d\u6ce8\u518c\u7d2f\u52a0\u5668\uff0c\u4e0d\u66b4\u9732 AccumulatorV2 \u7684<code>countFailedValues</code>\u5b57\u6bb5\uff0c\u56e0\u6b64\u90fd\u4e3a false\u3002</p> <ul> <li>\u66f4\u65b0\u7684\u7c92\u5ea6\u662f Task \u7ea7\u522b\uff0c\u5373\u4f7fTask\u5185\u90e8\u591a\u6b21\u8c03\u7528<code>add</code>\uff0c\u4e5f\u53ea\u4f1a\u5728\u5b8c\u6210\u65f6\u6574\u4f53\u66f4\u65b0\uff1b</li> <li>\u5bf9\u4e8e\u5931\u8d25\u7684 Task\uff0c\u5176\u7d2f\u52a0\u5668\u4e0d\u4f1a\u91cd\u590d\u66f4\u65b0\uff08\u5931\u8d25\u7684Task\u4e0d\u4f1a\u53d1\u9001\u5176\u7d2f\u52a0\u5668\u4fe1\u606f)\uff1b</li> <li>Action \u662f\u6839\u636e ResultTask\u7684 <code>outputId</code>\u4fdd\u8bc1\u6bcf\u4e2aTask\u4ec5\u6267\u884c\u4e00\u6b21</li> <li>a speculative task or a resubmitted task \u4f1a\u591a\u6b21\u6267\u884c\uff0cresubmit \u7684 task \u4e0d\u4f1a\u5f71\u54cd\uff08\u89c1\u7b2c\u4e8c\u70b9\uff09\u3002</li> </ul>"},{"location":"2024/11/19/spark-accumlator-%E8%A7%A3%E6%9E%90.html#_2","title":"\u7d2f\u52a0\u5668\u7684\u76f8\u5173\u7ebf\u7a0b","text":"<p>Accumulator \u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff1a[SPARK-21425] LongAccumulator, DoubleAccumulator not threadsafe - ASF JIRA</p> <ul> <li>\u539f\u751f\u7684LongAccumulator\uff0c\u5176\u5185\u90e8\u7684\u53d8\u91cf\uff0c\u5e76\u6ca1\u6709\u7528 volatile \u4fee\u9970\u6216\u8005\u4f7f\u7528Atomic \u53d8\u91cf \u3002</li> </ul> <p>Executor \u7aef\uff1a</p> <ul> <li>\u5199\u7ebf\u7a0b\uff1a\u8fd0\u884c\u4efb\u52a1\u7684\u7ebf\u7a0b\u3002</li> <li>\u8bfb\u7ebf\u7a0b\uff1a\u8fd0\u884c\u4efb\u52a1\u7684\u7ebf\u7a0b\u548c\u6267\u884c\u5668\u5fc3\u8df3\u7ebf\u7a0b\u3002</li> <li>\u5f53\u62a5\u544a\u5fc3\u8df3\u65f6\uff0cexecutor \u5c06\u6536\u96c6 Accumulator\u4e2d\u7684\u6240\u6709\u5f53\u524d\u503c\u5e76\u62a5\u544a\u7ed9\u9a71\u52a8\u7a0b\u5e8f\u3002</li> </ul> <p>Driver\u7aef\uff1a</p> <ul> <li>\u5199\u7ebf\u7a0b\uff1a</li> <li>\u4efb\u52a1\u5904\u7406\u7ebf\u7a0b\uff1a<code>DAGSchedulerEventProcessLoop</code>\uff0c<code>handleTaskCompletion</code>\u8d1f\u8d23\u7d2f\u52a0\u5668<code>merge</code></li> <li>\u8bfb\u7ebf\u7a0b\uff1a</li> <li>\u5fc3\u8df3\u5904\u7406\u7ebf\u7a0b\uff1a\u53ea\u5728UI\u4e0a\u4f7f\u7528\u5b83\u4eec\uff0c\u7528\u6237\u4ee3\u7801\u770b\u4e0d\u5230\u5b83\u4eec\u3002\u5982\u679c\u6ca1\u6709\u540c\u6b65\uff0c\u6700\u574f\u7684\u60c5\u51b5\u662f\u7528\u6237\u65e0\u6cd5\u5728UI\u4e0a\u770b\u5230\u6700\u65b0\u7684\u503c\uff0c\u4f46\u8fd9\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002</li> <li>\u4efb\u52a1\u5904\u7406\u7ebf\u7a0b\uff1a<code>handleTaskCompletion</code>\u4f1a\u8bfb\u53d6<code>value</code>\uff0c\u5c06\u770b\u5230\u6240\u6709\u6700\u65b0\u548c\u6b63\u786e\u7684\u503c\u3002</li> </ul> <p>\u56e0\u6b64\uff0c\u5982\u679c\u8981\u5728Driver\u8fdb\u7a0b\u4e2d\u7684\u5176\u5b83\u7ebf\u7a0b\u4e0d\u80fd\u76f4\u63a5\u8bfb\u53d6<code>value</code>\u7684\u503c\uff0c\u56e0\u4e3a\u4e00\u8bfb\u4e00\u5199\u7ebf\u7a0b\uff0c</p> <ul> <li>\u91c7\u7528<code>volatile</code>\u5185\u5b58\u5c4f\u969c\u4fee\u9970\u76f8\u5173\u7d2f\u52a0\u91cf\u6216\u91c7\u7528\u7ebf\u7a0b\u5b89\u5168\u7684\u5f62\u5f0f\u3002</li> <li>\u6216\u901a\u8fc7 <code>SparkListener</code>\u76d1\u542c<code>TaskEnd</code>\u4e8b\u4ef6\u4e2d\u7684<code>Accumulator</code>\u76f8\u5173\u7684\u4fe1\u606f\u3002</li> </ul>"},{"location":"2024/11/19/spark-accumlator-%E8%A7%A3%E6%9E%90.html#transform","title":"Transform \u4e2d\u7684\u7d2f\u52a0\u5668\u91cd\u7b97","text":"<p>\u5b9e\u9a8c\u4ee3\u7801\u89c1\uff1aspark/module-progress</p> <p>\u7531\u4e0a\u4e00\u8282\u53ef\u77e5\uff1a\u5373\u4f7f\u4e00\u4e2a\u5206\u533a\u4e2d\u8c03\u7528\u591a\u6b21\u7d2f\u52a0\u5668\u7684<code>add</code>\u51fd\u6570\uff0c\u4e5f\u53ea\u4f1a\u5728 Task \u5b8c\u6210\u540e\u7531 Driver\u66f4\u65b0\u3002</p> <ul> <li>\u56e0\u6b64\u4e00\u4e2a\u5206\u533a\u53ea\u8981\u89e6\u53d1\u4e00\u6b21<code>add</code>\u5373\u53ef\u3002</li> </ul> <p>Driver\u8c03\u7528\u7d2f\u52a0\u5668\u7684<code>merge</code>\u51fd\u6570\u65f6\uff0c\u5982\u4f55\u77e5\u9053\u91cd\u7b97\uff08\u662f\u4e2a\u5df2\u7ecf\u7b97\u8fc7\u7684\u5206\u533a\uff09\uff1f</p> <ul> <li>\u7528 map \u4fdd\u5b58<code>(\u5206\u533aID\uff0c\u5206\u533a\u7edf\u8ba1\u91cf)</code>\uff0c\u5f53\u53d1\u73b0\u5206\u533aID\u5df2\u7ecf\u5b58\u5728\u65f6\uff0c\u4e0d\u4f1a\u66f4\u65b0\uff1b</li> <li>\u8fdb\u4e00\u6b65\uff0c\u5206\u533a\u7684\u91cd\u7b97\u662f\u7531 Stage\u7684\u91cd\u7b97\u4ea7\u751f\u7684\uff0c\u90a3\u4e48\u4e4b\u524d\u7684 Stage \u7684\u6240\u6709\u5206\u533a\u80af\u5b9a\u90fd\u5df2\u7ecf\u8ba1\u7b97\u8fc7</li> <li>\u4e00\u79cd\u662f Shuffle \u6570\u636e\u65e0\u6cd5\u627e\u5230\uff0c\u5bfc\u81f4\u7684\u91cd\u7b97\uff0c\u6b64\u65f6\u4e4b\u524d\u7684Stage\u5df2\u7ecf\u8ba1\u7b97\u8fc7</li> <li>\u4e00\u79cd\u662f RDD \u591a\u6b21\u4f7f\u7528\u5bfc\u81f4\u7684 Stage \u91cd\u7b97\uff0c\u6b64\u65f6\uff0c\u4e4b\u524d\u7684Stage\u7684\u5206\u533a\u5df2\u7ecf\u8ba1\u7b97</li> <li>\u56e0\u6b64\uff0c\u53ea\u9700\u8981\u7edf\u8ba1\u5f53\u524d\u5206\u533a\u7684\u603b\u6570\u5373\u53ef\uff0c\u5f53\u5206\u533a\u603b\u6570\u8d85\u8fc7\u65f6\uff0c\u8868\u660e\u89e6\u53d1\u4e86\u91cd\u7b97\uff0c\u65e0\u9700\u7d2f\u52a0\u3002</li> <li>\u5931\u8d25\u7684 Task \u4e0d\u4f1a\u53d1\u9001\u7d2f\u52a0\u5668\u7684\u6570\u636e\uff08\u89c1\u4e0a\u4e00\u8282\uff09\u3002</li> </ul> <p>\u4f46\u662f\uff0c\u5982\u679c RDD \u5148\u6267\u884c\u90e8\u5206\u5206\u533a\u7684\u8ba1\u7b97\uff0c\u518d\u6267\u884c\u6574\u4f53\u7684\u8ba1\u7b97\uff0c\u5219\u65e0\u6cd5\u5f97\u5230\u6b63\u786e\u7684\u503c\u3002</p> <ul> <li>\u5982\u4e0b\u9762\u6240\u793a\u7684\u4ee3\u7801\uff0c\u5047\u8bbe\u5bf9\u4e8e<code>newRdd</code>\u5148\u6267\u884c\u4e86\u90e8\u5206\u5206\u533a\u7684\u64cd\u4f5c\uff0c\u518d\u6267\u884c\u6240\u6709\u5206\u533a\u6570\u636e\u64cd\u4f5c\uff1b</li> <li>\u4f9d\u636e\u5206\u533a\u603b\u6570\uff0c\u5c31\u4f1a\u8ba1\u7b97\u524d\u9762\u7684\u5206\u533a\u4e24\u6b21\uff0c\u5bfc\u81f4\u7ed3\u679c\u51fa\u9519\uff1b</li> <li>\u56e0\u6b64\uff0c\u4f7f\u7528scala\u539f\u751f\u7684<code>BitSet</code>\uff0c\u4f7f\u7528\u4f4d\u56fe\u7d22\u5f15\uff0c\u907f\u514d\u5206\u533a\u8ba1\u7b97\u591a\u6b21\uff0c\u540c\u65f6\u8282\u7701\u5185\u5b58\u3002</li> </ul> <pre><code>// val rdd: RDD[(K, V)]\n\nval newRdd: RDD[(Int, Array[Int])] = rdd.mapPartitionsWithIndex((index, iter)  =&gt; {\n    new Iterator[(Int, Array[Int])] {\n      private var count = 0\n\n      override def hasNext: Boolean = {\n        val flag = iter.hasNext\n        if (!flag) {\n          accum.add(index, count) // \u6bcf\u4e2a\u5206\u533a\u53ea\u5728\u5b8c\u6210\u65f6\u53d1\u9001\uff0c\u56e0\u6b64\u53ea\u9700 add \u4e00\u6b21\n        }\n        flag\n      }\n      override def next(): (Int, Array[Int]) = {\n        count += 1\n        iter.next()\n      }\n    }\n})\n\nnewRDD.take(10)\n// \u591a\u4e2a\u5206\u533a\u53d8\u6210\u4e00\u4e2a\u5206\u533a\uff0c\u56e0\u6b64\u5728 Executor \u7aef\u4f1a\u8c03\u7528\u591a\u6b21 add \u51fd\u6570\nnewRDD.coalesce(1).count()\nnewRDD.foreach()\n</code></pre> <p>\u5177\u4f53\u7684\u793a\u4f8b\uff0c\u53ef\u4ee5\u89c1\u793a\u4f8b\uff1aSpark\u4e32\u63a5\u6d41\u7edf\u8ba1\u8f93\u51fa\u6570\u636e\u884c\u6570</p>"},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html","title":"Spark \u4f7f\u7528 Yarn Rest \u63d0\u4ea4","text":"<p>https://community.cloudera.com/t5/Community-Articles/Starting-Spark-jobs-directly-via-YARN-REST-API/ta-p/245998 \u8fd9\u7bc7\u6587\u7ae0\u662fSpark 1.6\uff0c \u5df2\u7ecf\u8fc7\u65f6\uff0c\u53ea\u80fd\u4f5c\u4e3a\u57fa\u672c\u7684\u53c2\u8003\uff0c\u5177\u4f53\u8fd8\u662f\u8981\u9605\u8bfbSpark on Yarn\u7684\u63d0\u4ea4\u4ee3\u7801\u3002</p> <ul> <li>\u672c\u6587\u57fa\u4e8e Spark 2.4.8 \u548c Hadoop 3.2 \u8fdb\u884c\u9a8c\u8bc1\u3002</li> </ul> <p>\u5c06 Spark \u4f5c\u4e1a\u63d0\u4ea4\u5230 Yarn\u4e0a\u65f6\uff0c\u53ea\u80fd\u901a\u8fc7\u547d\u4ee4\u884c spark-submit \u8fdb\u884c\u64cd\u4f5c\uff0c\u672c\u6587\u901a\u8fc7\u89e3\u6790 spark-submit \u7684\u6e90\u7801\uff0c\u63a2\u7a76\u5982\u4f55\u4f7f\u7528 Yarn Rest API \u8fdb\u884c\u63d0\u4ea4 Spark \u4f5c\u4e1a\uff08\u4ec5 cluster \u6a21\u5f0f\uff0c\u56e0 client \u6a21\u5f0f driver \u8fd0\u884c\u5728 client \u4e2d\u800c\u4e0d\u662f AM \u4e2d\uff09\u3002</p> <p>\u4e00\u53e5\u8bdd\u603b\u7ed3\uff1a\u8fd8\u662f\u7528\u547d\u4ee4\u884c\u8c03\u7528<code>spark-submit</code> \uff01</p>"},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html#1-yarn-rest-api","title":"1. Yarn Rest API","text":""},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html#11-yarn","title":"1.1 \u521b\u5efaYarn \u5e94\u7528","text":"<pre><code>POST http://rm-http-address:port/ws/v1/cluster/apps/new-application\n</code></pre> <p>\u8fd4\u56de\u4f53\u793a\u4f8b\uff1a<code>application-id</code> \u548c\u5355\u4e2a\u5e94\u7528\u7533\u8bf7\u7684\u4e0d\u540c\u8d44\u6e90\u7684\u6700\u5927\u6570\u91cf</p> <pre><code>{\n    \"application-id\": \"application_1632703810135_0002\",\n    \"maximum-resource-capability\": {\n        \"memory\": 20480,\n        \"vCores\": 4,\n        \"resourceInformations\": {\n            \"resourceInformation\": [\n                {\n                    \"maximumAllocation\": 9223372036854775807,\n                    \"minimumAllocation\": 0,\n                    \"name\": \"memory-mb\",\n                    \"resourceType\": \"COUNTABLE\",\n                    \"units\": \"Mi\",\n                    \"value\": 20480\n                },\n                {\n                    \"maximumAllocation\": 9223372036854775807,\n                    \"minimumAllocation\": 0,\n                    \"name\": \"vcores\",\n                    \"resourceType\": \"COUNTABLE\",\n                    \"units\": \"\",\n                    \"value\": 4\n                },\n                {\n                    \"maximumAllocation\": 9223372036854775807,\n                    \"minimumAllocation\": 0,\n                    \"name\": \"yarn.io/gpu\",\n                    \"resourceType\": \"COUNTABLE\",\n                    \"units\": \"\",\n                    \"value\": 3\n                }\n            ]\n        }\n    }\n}\n</code></pre>"},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html#12-yarn","title":"1.2. \u63d0\u4ea4Yarn\u4f5c\u4e1a","text":"<pre><code>POST http://rm-http-address:port/ws/v1/cluster/apps\n</code></pre> <p>\u8bf7\u6c42\u4f53\u793a\u4f8b\uff1a\u5177\u4f53\u5b57\u6bb5\u89c1\uff08https://hadoop.apache.org/docs/stable/hadoop-yarn/hadoop-yarn-site/ResourceManagerRest.html#Cluster_Applications_API.28Submit_Application.29\uff09</p> <pre><code>{\n  \"application-id\": \"application_1632703810135_0002\",\n  \"application-name\": \"Spark_Yarn_Rest\",\n  \"queue\": \"default\",\n  \"priority\": 10,\n  \"am-container-spec\": {\n    // Location of the resource to be localized\n    \"local-resources\": {\n       \"entry\": [\n         {\n           \"key\":\"AppMaster.jar\",\n           \"value\": {\n             \"resource\": \"hdfs://hdfs-namenode:9000/user/testuser/DistributedShell/demo-app/AppMaster.jar\",\n             // options: \"ARCHIVE\", \"FILE\", and \"PATTERN\"\n             \"type\" : \"FILE\",\n             // options are \"PUBLIC\", \"PRIVATE\", and \"APPLICATION\"\n             \"visibility\": \"APPLICATION\",\n             // Size of the resource to be localized\n             \"size\": 43004,\n             // Timestamp of the resource to be localized\n             \"timestamp\": 1405452071209\n           }\n         }\n       ]\n    },\n    \"environment\": {\n       \"entry\": [{\n            \"key\": \"DISTRIBUTEDSHELLSCRIPTTIMESTAMP\",\n            \"value\": \"1405459400754\"\n          }, {\n            \"key\": \"CLASSPATH\",\n            \"value\": \"{{CLASSPATH}}&lt;CPS&gt;./*&lt;CPS&gt;{{HADOOP_CONF_DIR}}&lt;CPS&gt;{{HADOOP_COMMON_HOME}}/share/hadoop/common/*&lt;CPS&gt;{{HADOOP_COMMON_HOME}}/share/hadoop/common/lib/*&lt;CPS&gt;{{HADOOP_HDFS_HOME}}/share/hadoop/hdfs/*&lt;CPS&gt;{{HADOOP_HDFS_HOME}}/share/hadoop/hdfs/lib/*&lt;CPS&gt;{{HADOOP_YARN_HOME}}/share/hadoop/yarn/*&lt;CPS&gt;{{HADOOP_YARN_HOME}}/share/hadoop/yarn/lib/*&lt;CPS&gt;./log4j.properties\"\n          }, {\n            \"key\": \"DISTRIBUTEDSHELLSCRIPTLEN\",\n            \"value\": \"6\"\n          }, {\n            \"key\": \"DISTRIBUTEDSHELLSCRIPTLOCATION\",\n            \"value\": \"hdfs://hdfs-namenode:9000/user/testuser/demo-app/shellCommands\"\n          }\n        ]\n    },\n    \"commands\": {\n      \"command\": \"{{JAVA_HOME}}/bin/java -Xmx10m org.apache.hadoop.yarn.applications.distributedshell.ApplicationMaster --container_memory 10 --container_vcores 1 --num_containers 1 --priority 0 1&gt;&lt;LOG_DIR&gt;/AppMaster.stdout 2&gt;&lt;LOG_DIR&gt;/AppMaster.stderr\"\n    },\n    \"service-data\": null,\n    \"credentials\": null,\n    \"application-acls\": null\n  },\n  \"unmanaged-AM\": false,\n  \"max-app-attempts\": 3,\n  \"resource\": {\n     \"memory\":1024,\n     \"vCores\":1,\n     \"yarn.io/gpu\": 1\n  },\n  \"application-type\": \"Spark\",\n  \"keep-containers-across-application-attempts\": true,\n  \"application-tags\": {\n\n  },\n  \"log-aggregation-context\": {\n\n  },\n  \"attempt-failures-validity-interval\": 3600000,\n  \"reservation-id\": null,\n  \"am-black-listing-requests\": null  \n}\n</code></pre>"},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html#2-spark","title":"2. Spark \u63d0\u4ea4\u539f\u7406","text":"<p>\u5f53\u524d\u53ea\u8ba8\u8bba<code>Yarn Cluster</code>\u6a21\u5f0f\uff0cClient\u6a21\u5f0f\u4e0bDriver\u5728Client\u4e2d\uff0c\u65e0\u6cd5\u76f4\u63a5\u63d0\u4f9bYarn Rest\u670d\u52a1\uff1b</p> <ul> <li> <p>\u5ba2\u6237\u7aef\uff1a<code>org.apache.spark.deploy.yarn.Client</code></p> </li> <li> <p>AppMaster: <code>org.apache.spark.deploy.yarn.ApplicationMaster</code></p> </li> </ul> <p>\u4e3b\u8981\u76ee\u6807\uff1a</p> <ul> <li>\u6784\u9020AppMaster\u7684\u547d\u4ee4\u884c\u548c\u76f8\u5173\u914d\u7f6e\u53c2\u6570\uff08\u4ee5scala\u63d0\u4ea4jar\u5305\u5f62\u5f0f\uff0c\u5176\u5b83\u6a21\u5f0f\u53ef\u80fd\u542b\u6709\u4e0d\u540c\u7684\u64cd\u4f5c\uff09\uff1b</li> <li>\u5176\u5b83\u7684python\u63d0\u4ea4\uff0ckerberos\u914d\u7f6e\u7b49\uff0c\u90fd\u662f\u989d\u5916\u7684local resource\u914d\u7f6e\uff0c\u539f\u7406\u5927\u81f4\u4e00\u6837\uff1b</li> </ul>"},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html#21-spark-submitsh","title":"2.1 spark-submit.sh \u5165\u53e3","text":"<ul> <li>\u8bbe\u7f6eENV <code>SPARK_HOME</code>\uff1b</li> <li> <p>\u8bbe\u7f6eENV <code>PYTHONHASHSEED</code>\u4e3a<code>0</code>\uff1b</p> </li> <li> <p>\u6267\u884c\u5982\u4e0b\u7c7b\u4f3c\u7684\u547d\u4ee4</p> </li> </ul> <pre><code>exec /home/hadoop/workspace/spark-2.4.8-bin-hadoop2.7/bin/spark-class org.apache.spark.deploy.SparkSubmit --class org.apache.spark.examples.SparkPi --master yarn --deploy-mode cluster --supervise \\\n--executor-memory 2G --total-executor-cores 3 \\\nexamples/jars/spark-examples_2.11-2.4.8.jar 1000\n</code></pre> <ul> <li>\u5728<code>spark-class</code>\u91cc\uff0c\u6267\u884c\u7684\u64cd\u4f5c</li> <li>\u8bbe\u7f6eENV <code>SPARK_CONF_DIR</code>\uff1b</li> <li>\u5c06<code>spark-env.sh</code>\u4e2d\u8bbe\u7f6e\u7684\u53d8\u91cf\uff0c\u5168\u90e8export\uff1b</li> <li>\u8bbe\u7f6eENV <code>SPARK_SCALA_VERSION</code>\uff1b</li> <li>\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff0c\u83b7\u53d6\u542f\u52a8\u547d\u4ee4</li> </ul> <pre><code>/opt/tmp_workspace/jdk1.8.0_201/bin/java -Xmx128m -cp \\\n'/home/hadoop/workspace/spark-2.4.8-bin-hadoop2.7/jars/*' \\\norg.apache.spark.launcher.Main org.apache.spark.deploy.SparkSubmit \\\n--class org.apache.spark.examples.SparkPi --master yarn --deploy-mode cluster \\\n--supervise --executor-memory 2G --total-executor-cores 3 \\\nexamples/jars/spark-examples_2.11-2.4.8.jar 1000\n</code></pre> <ul> <li><code>Main</code>\u4e2d\uff0c\u9488\u5bf9<code>SparkSubmit</code>\uff0c\u6267\u884c\u7684\u64cd\u4f5c\uff1a</li> <li>\u6784\u5efaCLASSPATH\uff0c\u6dfb\u52a0<code>spark.driver.extraClasspath</code>\u3001<code>$SPARK_CONF_DIR</code>\u3001<code>$SPARK_HOME/jars</code>, <code>$HADOOP_CONF_DIR</code>\u3001<code>$YARN_CONF_DIR</code>\uff1b</li> <li>\u6784\u5efa\u4e4b\u540e\u7684\u6267\u884c\u547d\u4ee4\u5982\u4e0b\u6240\u793a\uff1a</li> </ul> <pre><code>exec /opt/tmp_workspace/jdk1.8.0_201/bin/java -cp '/home/hadoop/workspace/spark-2.4.8-bin-hadoop2.7/conf/:/home/hadoop/workspace/spark-2.4.8-bin-hadoop2.7/jars/*:/home/hadoop/workspace/hadoop-2.7.2/etc/hadoop/' \\\norg.apache.spark.deploy.SparkSubmit --master yarn --deploy-mode cluster \\\n--class org.apache.spark.examples.SparkPi --supervise --executor-memory 2G \\\n--total-executor-cores 3 examples/jars/spark-examples_2.11-2.4.8.jar 1000\n</code></pre>"},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html#22-sparksubmit","title":"2.2 <code>SparkSubmit</code> \u7c7b","text":"<p>\u6267\u884c\u7684\u903b\u8f91\uff1a</p> <ul> <li>\u4ee5<code>proxyUser</code>\u7684\u7528\u6237\u8eab\u4efd\uff0c\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1b</li> <li><code>YarnClusterApplication::start()</code>\u8c03\u7528<code>Client::run()</code>\uff1a</li> </ul>"},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html#23-client","title":"2.3 <code>Client</code>\u7c7b","text":"<ul> <li>\u5728 HDFS \u7684 <code>/user/${user}/.sparkStaging/${appId}</code>\u4e0b\u5efa\u7acb\u76ee\u5f55\uff0c\u7528\u4e8eYarn\u7684localResource\uff0c\u5982\u4e0b\u6240\u793a\uff1b</li> <li>\u4e0a\u4f20spark\u914d\u7f6e<code>__spark_conf__.zip</code>\u548c\u5e94\u7528\u7684jar\u5305\u5230HDFS\u7684\u8def\u5f84\uff1b</li> <li>\u5bf9\u8fd9\u4e24\u4e2a\u6587\u4ef6\uff0c\u4f5c\u4e3aYarn AM\u7684 local resource\uff1b</li> </ul> <pre><code>$ hdfs dfs -ls /user/hadoop/.sparkStaging/application_1631928041971_0067\n-rw-r--r--   2 hadoop supergroup     215195 2021-09-28 11:21 /user/hadoop/.sparkStaging/application_1631928041971_0067/__spark_conf__.zip\n-rw-r--r--   2 hadoop supergroup    2017859 2021-09-28 11:21 /user/hadoop/.sparkStaging/application_1631928041971_0067/spark-examples_2.11-2.4.8.jar\n</code></pre> <ul> <li> <p><code>__spark_conf__.zip</code>\u76ee\u5f55\u7ec4\u7ec7\u5982\u4e0b\uff1a</p> </li> <li> <p><code>__hadoop_conf__</code>\u4e2d\u5305\u542b<code>HADOOP_CONF_DIR</code>\u548c<code>YARN_CONF_DIR</code>\u4e0b\u7684\u6240\u6709\u6587\u4ef6\uff1b</p> <ul> <li>\u5305\u542b<code>SPARK_CONF_DIR</code>\u4e0b\u7684xml\u6587\u4ef6\uff1b</li> </ul> </li> <li> <p>\u5305\u542bCLASSPATH\u4e2d\u7684<code>log4j.properties</code>\u548c<code>metrics.properties</code>\u6587\u4ef6\uff1b</p> <ul> <li> <p>\u5c06Hadoop Conf \u5199\u5230<code>__spark_hadoop_conf__.xml</code>\uff1b</p> </li> <li> <p>\u5c06Spark Conf \u5199\u5230<code>__spark_conf__.properties</code>\uff1b</p> </li> </ul> </li> </ul> <pre><code>drwx------. 2 hadoop hadoop  4096 Sep 26 15:32 __hadoop_conf__\n-r-x------. 1 hadoop hadoop 33785 Sep 26 15:32 __spark_conf__.properties\n-r-x------. 1 hadoop hadoop 96226 Sep 26 15:32 __spark_hadoop_conf__.xml\n-r-x------. 1 hadoop hadoop  1523 Sep 26 15:32 log4j.properties\n-r-x------. 1 hadoop hadoop   523 Sep 26 15:32 metrics.properties\n</code></pre> <ul> <li>\u6dfb\u52a0\u7684\u989d\u5916\u7684spark\u7684\u5c5e\u6027</li> <li><code>spark.yarn.cache.confArchive</code>\uff1a<code>__spark_conf__.zip</code>\u7684\u8def\u5f84\uff08\u4f5c\u4e3a\u5176\u5b83container\u7684\u914d\u7f6e\uff09\uff1b</li> <li><code>spark.yarn.cache.filenames</code>\u3001<code>spark.yarn.cache.timestamps</code> \u3001<code>spark.yarn.cache.visibilities</code>\u3001<code>spark.yarn.cache.types</code>\u3001<code>spark.yarn.cache.sizes</code>\uff1aspark\u81ea\u8eab\u7684jar\u5305\uff0c\u6bcf\u4e00\u4e2a\u90fd\u662fYarn app\u7684localResource\u3002</li> </ul>"},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html#24-applicationmaster","title":"2.4 <code>ApplicationMaster</code>\u7c7b","text":"<p>AM\u542f\u52a8\u547d\u4ee4\uff0c\u7c7b\u4f3c\u5982\u4e0b\uff1a</p> <ul> <li><code>{{PWD}}</code>\u8fd9\u4e2a\u662fHADOOP\u5185\u7f6e\u7684\u53d8\u91cf\u7684\u4f7f\u7528\u5f62\u5f0f\uff1b</li> <li> <p><code>&lt;LOG_DIR&gt;</code>\u662f\u8ddf\u5e94\u7528\u76f8\u5173\u7684\u914d\u7f6e\uff0c\u4f1a\u88abHadoop\u81ea\u52a8\u66ff\u6362\uff1b</p> </li> <li> <p><code>--properties-file</code>\u662f\u6700\u91cd\u8981\u7684\u53c2\u6570\uff0c\u5176\u6765\u6e90\u53ef\u4ee5\u89c1 2.3 \u8282\uff1b</p> </li> </ul> <pre><code>{{JAVA_HOME}}/bin/java -server -Xmx4096m -Djava.io.tmpdir={{PWD}}/tmp \\\n-Dspark.yarn.app.container.log.dir=&lt;LOG_DIR&gt; org.apache.spark.deploy.yarn.ApplicationMaster \\\n--class 'org.apache.spark.examples.SparkPi' --jar file:/home/hadoop/workspace/spark-2.4.8-bin-hadoop2.7/examples/jars/spark-examples_2.11-2.4.8.jar --arg 1000 \\\n--properties-file {{PWD}}/__spark_conf__/__spark_conf__.properties 1&gt; &lt;LOG_DIR&gt;/stdout 2&gt; &lt;LOG_DIR&gt;/stderr\n</code></pre> <p><code>--properties-file</code>\u53ef\u4ee5\u4e0d\u6307\u5b9a\uff0c\u90a3\u4e48SparkConf\u7684\u914d\u7f6e\uff0c\u4f1a\u4eceENV\u6216\u8005Java System Properties\u4e2d\u8bfb\u53d6\uff0c\u56e0\u6b64\u53ef\u4ee5\u5c06\u6587\u4ef6\u91cc\u7684spark\u914d\u7f6e\uff0c\u4f5c\u4e3a\u547d\u4ee4\u884cJava -D\u53c2\u6570\u4f20\u5165\uff08\u4f46\u662f\u8fd9\u4e2a\u53ef\u80fd\u4f1a\u5bfc\u81f4\u547d\u4ee4\u884c\u7684\u957f\u5ea6\u975e\u5e38\u957f\uff0c\u5177\u4f53\u89c1  issue [SPARK-14602] \u548c \u89e3\u51b3 https://github.com/apache/spark/pull/12487  \uff09\u3002</p> <p>\u540c\u65f6\uff0c\u4f1a\u5c06<code>spark.yarn.cache.confArchive</code>\u4f5c\u4e3aExecutor\u7684local resource\uff08\u53ef\u4ee5\u4e0d\u9700\u8981\uff09\u3002</p>"},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html#3","title":"3 \u793a\u4f8b","text":""},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html#31-id","title":"3.1 \u521b\u5efa\u5e94\u7528\uff0c\u5e76\u83b7\u53d6\u5e94\u7528ID","text":"<pre><code>POST http://rm-http-address:port/ws/v1/cluster/apps/new-application\n</code></pre>"},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html#32","title":"3.2 \u6267\u884c\u5e94\u7528","text":"<p>\u4ee5 spark example pi \u4e3a\u4f8b\uff1a</p>"},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html#321-sparkjars","title":"3.2.1 Spark\u81ea\u8eab\u7684jars\u8bbe\u7f6e","text":"<p>AM \u8bbe\u7f6e\uff0c\u4e24\u79cd\u65b9\u6848\uff1a</p> <ul> <li>\u901a\u8fc7Yarn local resource\uff0c\u5c06jar\u5305\u4e0a\u4f20\u5230hdfs\u4e0a\uff0c\u5e76\u5728http\u8bf7\u6c42\u4f53\u4e2d\u914d\u7f6e\u6bcf\u4e00\u4e2a\u7684jar\u7684local resource\uff08\u5927\u6982226\u4e2a\uff09\uff0c\u6216\u8005\u5148\u624b\u52a8\u5408\u6210\u4e00\u4e2ajar\u5305\uff0c\u518d\u914d\u7f6e\uff08\u53ea\u9700HDFS\u4e00\u4efd\uff09\uff1b</li> <li>\u76f4\u63a5\u901a\u8fc7CLASSPATH\uff0c\u5728Yarn\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u5728\u76f8\u540c\u4f4d\u7f6e\u5b89\u88c5spark\u7684jars\u6587\u4ef6\uff0c\u7136\u540e\u5728HTTP\u8bf7\u6c42\u4f53\u4e2d\u7684CLASSPATH\u6307\u5b9a\u8be5\u8def\u5f84\uff08\u6240\u6709Yarn nodemanager\u8282\u70b9\u4e00\u4efd\uff09\uff1b</li> </ul> <p>Executor\u8bbe\u7f6e\uff0c\u4e24\u79cd\u65b9\u6848\uff1a</p> <ul> <li>\u901a\u8fc7Yarn local resource\uff0cSpark\uff08<code>spark.yarn.jar</code>\uff09 \u662f\u901a\u8fc7\u5148\u5c06Spark\u81ea\u8eab\u7684jar\u5305\u8bbe\u7f6e<code>spark.yarn.cache.filenames | timestamps | visibilities | sizes | types</code>\uff0c\u653e\u5728<code>__spark_conf__.properties</code>\u91cc\uff0c\u7136\u540e\u89e3\u6790\u5e76\u914d\u7f6e\u4e3aExecutor\u7684local resource\uff1b</li> <li>\u76f4\u63a5\u901a\u8fc7CLASSPATH\uff0c\u5728<code>__spark_conf__.properties</code>\u91cc\u8bbe\u7f6e<code>spark.executor.extraClasspath</code>\uff0c\u8def\u5f84\u4e3aspark\u7684jars\u6587\u4ef6\uff08\u6240\u6709Yarn nodemanager\u8282\u70b9\u4e00\u4efd\uff09</li> </ul>"},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html#322-sparkjar","title":"3.2.2 Spark\u5e94\u7528\u7a0b\u5ea6\u7684jar\u8bbe\u7f6e","text":"<p>\u56e0\u4e3a\u5e94\u7528\u7a0b\u5e8f\u672c\u8eab\u7684jar\u5305\uff0c\u662f\u4e0d\u80fd\u9884\u5148\u5b58\u5728\u96c6\u7fa4\u4e0a\u7684\uff0c\u4e14\u4e0a\u4f20\u5230\u5168\u90e8\u8282\u70b9\u4e5f\u4e0d\u73b0\u5b9e\uff08\u9664\u975e\u6709NFS\u7b49\uff09\uff0c\u56e0\u6b64\u5bf9\u4e8e\u5e94\u7528\u7a0b\u5e8f\u672c\u8eab\u7684jar\u5305\uff0c\u9700\u8981\u901a\u8fc7Yarn local resource\u8fdb\u884c\u914d\u7f6e\uff0c\u4ecd\u7136\u5206\u4e3aAM\u548cExecutor\u4e24\u90e8\u5206\u7684\u914d\u7f6e\u3002</p> <p>\u524d\u63d0\u51c6\u5907\uff1a</p> <ul> <li>\u5c06\u5e94\u7528\u7a0b\u5e8fjar\u5305\uff0c\u4e0a\u4f20\u5230HDFS\u4e0a\uff0c\u83b7\u53d6\u5230JDFS\u4e0a\u8be5\u6587\u4ef6\u7684\u8def\u5f84\u3001\u5927\u5c0f\u3001\u65f6\u95f4\u6233\u7b49\u4fe1\u606f\uff1b</li> </ul> <p>AM\uff1a</p> <ul> <li>\u5728HTTP\u7684\u8bf7\u6c42\u4f53\u4e2d\u6784\u5efa\uff0c\u5982\u4e0b\u5f62\u5f0f\uff0c\u5176\u4e2dresource\u3001size\u3001timestamp\u5b57\u6bb5\u9700\u8981\u6309\u7167\u771f\u5b9e\u503c\u8fdb\u884c\u4fee\u6539\uff1a</li> </ul> <pre><code>{\n  \"key\":\"__app__.jar\",\n  \"value\": {\n    \"resource\": \"hdfs://node131:9000/user/hadoop/.sparkStaging/application_1631928041971_0087/spark-examples_2.11-2.4.8.jar\",\n    \"type\" : \"FILE\",\n    \"visibility\": \"PRIVATE\",\n    \"size\": 2017859,\n    \"timestamp\": 1632823976707\n  }\n}\n</code></pre> <p>Executor\uff1a</p> <ul> <li>\u5728<code>_spark_conf__.properties</code>\uff0c\u914d\u7f6e<code>spark.yarn.cache.filenames | timestamps | visibilities | sizes | types</code>\uff0c\u5982\u4e0b\u6240\u793a</li> </ul> <pre><code>spark.yarn.cache.filenames=hdfs://node131:9000/user/hadoop/.sparkStaging/application_1631928041971_0087/spark-examples_2.11-2.4.8.jar\nspark.yarn.cache.timestamps=1632823976707\nspark.yarn.cache.visibilities=PRIVATE\nspark.yarn.cache.sizes=2017859\nspark.yarn.cache.types=FILE\n</code></pre>"},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html#322-spark","title":"3.2.2 Spark\u914d\u7f6e","text":"<p>1\uff09\u6784\u5efa<code>__spark_conf__.zip</code></p> <p>\u6839\u636e 2.3 \u8282\u5185\u5bb9\uff0c\u53ef\u77e5zip\u5305\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code># hadoop\u7684\u914d\u7f6e\u76ee\u5f55\n- __hadoop_conf__\n  - hdfs-site.xml\n  - ...\n\n# spark \u914d\u7f6e\uff0c\u6838\u5fc3\u6587\u4ef6\n- __spark_conf__.properties\n\n# hadoop \u914d\u7f6e\uff0c\u4f18\u5148\u7ea7\u6bd4__hadoop_conf__\u9ad8\n- _spark_hadoop_conf__.xml\n</code></pre> <p><code>__spark_conf__.zip</code>\u4f5c\u4e3aAM\u7684Yarn local resource\uff0c\u5728HTTP\u8bf7\u6c42\u683c\u5f0f\uff0c\u7c7b\u4f3c\u5982\u4e0b\uff1a</p> <pre><code>{\n  \"key\":\"__spark_conf__\",\n  \"value\": {\n    // resource, size, timestamp \u9700\u8981\u4fee\u6539\uff08\u6ce8\u610f\u662fARCHIVE\u7c7b\u578b\uff09\n    \"resource\": \"hdfs://node131:9000/user/hadoop/.sparkStaging/application_1631928041971_0087/__spark_conf__.zip\",\n    \"type\" : \"ARCHIVE\",\n    \"visibility\": \"APPLICATION\",\n    \"size\": 18023,\n    \"timestamp\": 1632825115975\n  }\n}\n</code></pre> <p>2\uff09\u6216 \u4f5c\u4e3a\u547d\u4ee4\u884c/\u7cfb\u7edf\u914d\u7f6e\u4f20\u9012</p> <p><code>__spark_conf__.properties</code>\u4e2d\u7684\u914d\u7f6e\uff0c\u53ef\u4ee5\u4f5c\u4e3aHTTP\u8bf7\u6c42\u4f53\u4e2d\u7684command\u7684java \u7cfb\u7edf\u914d\u7f6e\u4f20\u5165\uff08\u5f62\u5f0f<code>-Dspark.a.b.c=de</code>\u7684\u683c\u5f0f</p>"},{"location":"2024/01/15/spark-%E4%BD%BF%E7%94%A8-yarn-rest-%E6%8F%90%E4%BA%A4.html#323-restful","title":"3.2.3 \u8c03\u7528Restful","text":"<p>\u6ce8\uff1a</p> <ul> <li>\u5bf9\u4e8eSpark \u81ea\u8eab\u7684jar\u5305\uff0c\u91c7\u7528\u6240\u6709\u8282\u70b9\u76f8\u540c\u76ee\u5f55\u90e8\u7f72\u7684\u5f62\u5f0f\uff1b</li> <li>Spark\u81ea\u8eab\u5e94\u7528\u7a0b\u5e8f\u7684jar\u5305\uff0c\u91c7\u7528Yarn local resource\u7684\u5f62\u5f0f\uff1b</li> </ul> <p>Yarn RM\u63a5\u53e3\uff1a<code>POST http://rm-http-address:port/ws/v1/cluster/apps</code></p> <p>1\uff09\u53ea\u9700\u8981 <code>__spark_conf__.properties</code></p> <p>\u6ce8: \u5982\u679c\u53ea\u9700\u8981<code>__spark_conf__.properties</code> \u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u53ea\u8bbe\u7f6e\u8fd9\u4e2a\u6587\u4ef6\u7684local resource\uff0c\u4e0a\u4f20\u5230HDFS\u4e5f\u53ef\u4ee5\u53ea\u4e0a\u4f20\u8be5\u6587\u4ef6\uff0c\u800c\u4e0d\u9700\u8981\u6574\u4e2a<code>__spark_conf__.zip</code></p> <p><code>__spark_conf__.properties</code>\u793a\u4f8b\uff1a</p> <pre><code>#Spark configuration.\n#Tue Sep 28 17:09:43 CST 2021\nspark.executor.memory=2G\nspark.cores.max=3\n# \u9700\u8981\u4fee\u6539\nspark.yarn.cache.confArchive=hdfs\\://node131\\:9000/tmp/__app__.properties\nspark.eventLog.compress=true\nspark.submit.deployMode=cluster\nspark.ui.killEnabled=false\nspark.eventLog.enabled=true\nspark.yarn.jars=\nspark.yarn.historyServer.address=172.16.2.131\\:18080\nspark.master=yarn\nspark.executor.cores=1\nspark.app.name=org.apache.spark.examples.SparkPi\nspark.port.maxRetries=100\nspark.eventLog.dir=hdfs\\://node131\\:9000/history\nspark.driver.extraClassPath=/extraSparkJars\nspark.executor.extraClassPath=/home/hadoop/workspace/spark-2.4.8-bin-hadoop2.7/jars/*\n# filenames, timestamps, sizes \u9700\u8981\u4fee\u6539\nspark.yarn.cache.filenames=hdfs\\://node131\\:9000/user/hadoop/.sparkStaging/application_1631928041971_0087/spark-examples_2.11-2.4.8.jar#__app__.jar\nspark.yarn.cache.timestamps=1632823976707\nspark.yarn.cache.visibilities=PRIVATE\nspark.yarn.cache.sizes=2017859\nspark.yarn.cache.types=FILE\n</code></pre> <p>Yarn Rest \u63a5\u53e3\u7684\u8bf7\u6c42\u4f53\u793a\u4f8b\uff1a</p> <pre><code>{\n  // \u4fee\u6539\u5e94\u7528id\n  \"application-id\": \"application_1631928041971_0085\",\n  \"application-name\": \"Spark_Yarn_Rest\",\n  \"queue\": \"default\",\n  \"priority\": 10,\n  \"am-container-spec\": {\n    \"local-resources\": {\n       \"entry\": [\n         {\n           \"key\":\"__app__.properties\",\n           \"value\": {\n             // resource, size, timestamp \u9700\u8981\u4fee\u6539\n             \"resource\": \"hdfs://node131:9000/tmp/__spark_conf__.properties\",\n             \"type\" : \"FILE\",\n             \"visibility\": \"APPLICATION\",\n             \"size\": 990,\n             \"timestamp\": 1632879896059\n           }\n         }, {\n           \"key\":\"__app__.jar\",\n           \"value\": {\n             // resource, size, timestamp \u9700\u8981\u4fee\u6539\n             \"resource\": \"hdfs://node131:9000/tmp/spark-examples_2.11-2.4.8.jar\",\n             \"type\" : \"FILE\",\n             \"visibility\": \"PRIVATE\",\n             \"size\": 2017859,\n             \"timestamp\": 1632822059125\n           }\n         }\n       ]\n    },\n    \"environment\": {\n       \"entry\": [{\n            \"key\": \"CLASSPATH\",\n            \"value\": \"{{PWD}}&lt;CPS&gt;{{PWD}}/__spark_conf__&lt;CPS&gt;/home/hadoop/workspace/spark-2.4.8-bin-hadoop2.7/jars/*&lt;CPS&gt;$HADOOP_CONF_DIR&lt;CPS&gt;$HADOOP_COMMON_HOME/share/hadoop/common/*&lt;CPS&gt;$HADOOP_COMMON_HOME/share/hadoop/common/lib/*&lt;CPS&gt;$HADOOP_HDFS_HOME/share/hadoop/hdfs/*&lt;CPS&gt;$HADOOP_HDFS_HOME/share/hadoop/hdfs/lib/*&lt;CPS&gt;$HADOOP_YARN_HOME/share/hadoop/yarn/*&lt;CPS&gt;$HADOOP_YARN_HOME/share/hadoop/yarn/lib/*&lt;CPS&gt;$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/*&lt;CPS&gt;$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib/*&lt;CPS&gt;{{PWD}}/__spark_conf__/__hadoop_conf__&lt;CPS&gt;\"\n          },\n          {\n            \"key\": \"SPARK_USER\",\n            \"value\": \"hadoop\"\n          },\n          {\n            \"key\": \"PYTHONHASHSEED\",\n            \"value\": \"0\"\n          }\n        ]\n    },\n    \"commands\": {\n      \"command\": \"{{JAVA_HOME}}/bin/java -server -Xmx4096m -Djava.io.tmpdir={{PWD}}/tmp -Dspark.yarn.app.container.log.dir=&lt;LOG_DIR&gt; org.apache.spark.deploy.yarn.ApplicationMaster --class 'org.apache.spark.examples.SparkPi' --jar file:/home/hadoop/workspace/spark-2.4.8-bin-hadoop2.7/examples/jars/spark-examples_2.11-2.4.8.jar --arg 1000 --properties-file {{PWD}}/__app__.properties 1&gt; &lt;LOG_DIR&gt;/stdout 2&gt; &lt;LOG_DIR&gt;/stderr\"\n    },\n    \"service-data\": null,\n    \"credentials\": null,\n    \"application-acls\": null\n  },\n  \"unmanaged-AM\": false,\n  \"max-app-attempts\": 2,\n  \"resource\": {\n     \"memory\":1024,\n     \"vCores\":1\n  },\n  \"application-type\": \"Spark\",\n  \"keep-containers-across-application-attempts\": true,\n  \"application-tags\": {\n\n  },\n  \"log-aggregation-context\": {\n\n  },\n  \"attempt-failures-validity-interval\": 3600000,\n  \"reservation-id\": null,\n  \"am-black-listing-requests\": null  \n}\n</code></pre> <p>2\uff09\u91c7\u7528<code>__spark_conf__.zip</code>\u4f20\u9012\u914d\u7f6e</p> <p>\u5176\u4e2d\u6709\u6ce8\u91ca\u7684\u914d\u7f6e\uff0c\u9700\u8981\u8fdb\u884c\u4fee\u6539\u540e\uff0c\u5220\u9664\u6ce8\u91ca\uff0c\u518d\u8fdb\u884c\u8c03\u7528\uff1a</p> <pre><code>{\n  // \u4fee\u6539\u5e94\u7528id\n  \"application-id\": \"application_1631928041971_0085\",\n  \"application-name\": \"Spark_Yarn_Rest\",\n  \"queue\": \"default\",\n  \"priority\": 10,\n  \"am-container-spec\": {\n    \"local-resources\": {\n       \"entry\": [\n         {\n           \"key\":\"__spark_conf__\",\n           \"value\": {\n             // resource, size, timestamp \u9700\u8981\u4fee\u6539\n             \"resource\": \"hdfs://node131:9000/user/hadoop/.sparkStaging/application_1631928041971_0087/__spark_conf__.zip\",\n             \"type\" : \"ARCHIVE\",\n             \"visibility\": \"APPLICATION\",\n             \"size\": 18023,\n             \"timestamp\": 1632825115975\n           }\n         }, {\n           \"key\":\"__app__.jar\",\n           \"value\": {\n             // resource, size, timestamp \u9700\u8981\u4fee\u6539\n             \"resource\": \"hdfs://node131:9000/user/hadoop/.sparkStaging/application_1631928041971_0087/spark-examples_2.11-2.4.8.jar\",\n             \"type\" : \"FILE\",\n             \"visibility\": \"PRIVATE\",\n             \"size\": 2017859,\n             \"timestamp\": 1632823976707\n           }\n         }\n       ]\n    },\n    \"environment\": {\n       \"entry\": [{\n            \"key\": \"CLASSPATH\",\n             // resource, size, timestamp \u9700\u8981\u4fee\u6539\n            \"value\": \"/home/hadoop/workspace/spark-2.4.8-bin-hadoop2.7/jars/*&lt;CPS&gt;{{PWD}}&lt;CPS&gt;{{PWD}}/__spark_conf__&lt;CPS&gt;$HADOOP_CONF_DIR&lt;CPS&gt;$HADOOP_COMMON_HOME/share/hadoop/common/*&lt;CPS&gt;$HADOOP_COMMON_HOME/share/hadoop/common/lib/*&lt;CPS&gt;$HADOOP_HDFS_HOME/share/hadoop/hdfs/*&lt;CPS&gt;$HADOOP_HDFS_HOME/share/hadoop/hdfs/lib/*&lt;CPS&gt;$HADOOP_YARN_HOME/share/hadoop/yarn/*&lt;CPS&gt;$HADOOP_YARN_HOME/share/hadoop/yarn/lib/*&lt;CPS&gt;$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/*&lt;CPS&gt;$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib/*&lt;CPS&gt;{{PWD}}/__spark_conf__/__hadoop_conf__&lt;CPS&gt;\"\n          },\n          {\n            \"key\": \"SPARK_USER\",\n            \"value\": \"hadoop\"\n          },\n          {\n            \"key\": \"PYTHONHASHSEED\",\n            \"value\": \"0\"\n          }\n        ]\n    },\n    \"commands\": {\n      \"command\": \"{{JAVA_HOME}}/bin/java -server -Xmx4096m -Djava.io.tmpdir={{PWD}}/tmp -Dspark.yarn.app.container.log.dir=&lt;LOG_DIR&gt; org.apache.spark.deploy.yarn.ApplicationMaster --class 'org.apache.spark.examples.SparkPi' --jar file:/home/hadoop/workspace/spark-2.4.8-bin-hadoop2.7/examples/jars/spark-examples_2.11-2.4.8.jar --arg 1000 --properties-file {{PWD}}/__spark_conf__/__spark_conf__.properties 1&gt; &lt;LOG_DIR&gt;/stdout 2&gt; &lt;LOG_DIR&gt;/stderr\"\n    },\n    \"service-data\": null,\n    \"credentials\": null,\n    \"application-acls\": null\n  },\n  \"unmanaged-AM\": false,\n  \"max-app-attempts\": 2,\n  \"resource\": {\n     \"memory\":1024,\n     \"vCores\":1\n  },\n  \"application-type\": \"Spark\",\n  \"keep-containers-across-application-attempts\": true,\n  \"application-tags\": {\n\n  },\n  \"log-aggregation-context\": {\n\n  },\n  \"attempt-failures-validity-interval\": 3600000,\n  \"reservation-id\": null,\n  \"am-black-listing-requests\": null  \n}\n</code></pre>"},{"location":"2023/12/20/hadoop-yarn-mock-%E6%B5%8B%E8%AF%95.html","title":"Hadoop Yarn Mock \u6d4b\u8bd5","text":"<p>\u5f53\u7cfb\u7edf\u4e0e Yarn \u96c6\u6210\u65f6\uff0c\u4e00\u822c\u4f1a\u901a\u8fc7 YarnClient / AdminProtocol \u4ee5\u53ca Restful \u63a5\u53e3\u7b49\u65b9\u5f0f\u8ddf Yarn \u901a\u4fe1\u3002</p> <p>\u90a3\u4e48\uff0c\u5f53\u7cfb\u7edf\u5728\u8fdb\u884c\u5355\u5143\u6d4b\u8bd5\u65f6\uff0c\u5c31\u9700\u8981\u5bf9 Yarn \u8fdb\u884c Mock\uff0c\u6765\u9a8c\u8bc1\u7cfb\u7edf\u7684\u6b63\u786e\u6027\u3002</p> <p>Yarn \u63d0\u4f9b\u4e86 MiniYarnCluster \u6765\u5efa\u7acb\u5185\u5b58\u7ea7\u7684\u96c6\u7fa4\u8fdb\u884c\u6d4b\u8bd5\uff0c\u4f46\u5176\u4e5f\u6709\u4e00\u4e9b\u5c40\u9650\u6027\u3002</p>"},{"location":"2023/12/20/hadoop-yarn-mock-%E6%B5%8B%E8%AF%95.html#yarnclient-adminprotocol","title":"YarnClient / AdminProtocol \u63a5\u53e3\u6d4b\u8bd5","text":"<p>\u521b\u5efa <code>MiniYARNCluster</code>\uff0c\u5e76\u901a\u8fc7\u5176 config \u521b\u5efa YarnClient \u6216\u8005 AdminProtocol</p> <pre><code> YarnConfiguration configuration = new YarnConfiguration();\n\n// start mini yarn cluster in localhost:9188\nMiniYARNCluster miniYARNCluster = new MiniYARNCluster(\"TestCluster\", 1, 1, 1);\nminiYARNCluster.init(configuration);\nminiYARNCluster.start();\n\nYarnClient yarnClient = YarnClientFactory.initYarnClient(miniYARNCluster.getConfig());\n// ClientRMProxy.createRMProxy(miniYARNCluster.getConfig(), ResourceManagerAdministrationProtocol.class)\n\nList&lt;NodeReport&gt; nodeReports = yarnClient.getNodeReports();\n\nassertEquals(1, nodeReports.size());\n\nminiYARNCluster.close();\n</code></pre>"},{"location":"2023/12/20/hadoop-yarn-mock-%E6%B5%8B%E8%AF%95.html#restful","title":"Restful \u63a5\u53e3\u6d4b\u8bd5","text":"<p>\u5f53\u524d\u5b58\u5728\u95ee\u9898\uff0c\u63a5\u53e3\u65e0\u6cd5\u8bbf\u95ee\uff0c404\uff0c\u53ef\u89c1 JIRA: Yarn-8764</p> <ul> <li>\u5728\u540c\u4e00\u4e2a\u8fdb\u7a0b\u542f\u52a8 Node Manager \u65f6\uff0c\u4f1a\u5c06 ResourceManager \u7684 \u8def\u7531\u8986\u76d6\u6389\uff1b</li> </ul>"},{"location":"2023/12/20/hadoop-yarn-mock-%E6%B5%8B%E8%AF%95.html#windows","title":"Windows \u73af\u5883\u914d\u7f6e","text":""},{"location":"2023/12/20/hadoop-yarn-mock-%E6%B5%8B%E8%AF%95.html#hadoop-on-windows","title":"Hadoop on windows","text":"<p>\u5c06 https://github.com/cdarlint/winutils \u4e2d\u5bf9\u5e94hadoop\u7248\u672c\u4e2d\u7684bin\u4e0b\u7684winutils\u4e0b\u8f7d\u5230\u672c\u5730</p> <ul> <li>\u914d\u7f6eHADOOP_HOME</li> <li><code>path</code>\u73af\u5883\u53d8\u91cf\u6dfb\u52a0 Hadoop \u76ee\u5f55\u7684 <code>bin/</code>\uff1b</li> </ul>"},{"location":"2023/12/20/hadoop-yarn-mock-%E6%B5%8B%E8%AF%95.html#_1","title":"\u7b26\u53f7\u94fe\u63a5\u6743\u9650\u914d\u7f6e","text":"<p>\u901a\u8fc7 <code>MiniYarnCluster</code> \u8fd0\u884c\u6d4b\u8bd5\u65f6\uff0c\u51fa\u73b0\u4ee5\u4e0b\u9519\u8bef\uff1a</p> <pre><code>CreateSymbolicLink error (1314): ?????\n</code></pre> <p>\u9519\u8bef\u7801\uff08Error Code\uff09\u662f1314\uff0c\u901a\u8fc7\u67e5\u8be2\u6587\u6863\uff0c\u8fd9\u4e2aError Code\u7684\u610f\u601d\u662f\uff1aERROR_PRIVILEGE_NOT_HELD\uff0c\u7f3a\u5c11\u6743\u9650\u3002</p> <ul> <li><code>gpedit.msc</code> -&gt; \u8ba1\u7b97\u673a\u914d\u7f6e -&gt; Windows \u8bbe\u7f6e -&gt; \u5b89\u5168\u8bbe\u7f6e -&gt; \u672c\u5730\u7b56\u7565 -&gt; \u7528\u6237\u6743\u9650\u5206\u914d -&gt; \u521b\u5efa\u7b26\u53f7\u94fe\u63a5</li> <li>\u4fee\u6539\u540e\uff0c\u9700\u8981\u91cd\u542f\u7535\u8111\uff0c\u624d\u4f1a\u751f\u6548\uff1b</li> </ul> <p></p>"},{"location":"2023/12/25/k8s-configmap-%E6%8C%82%E8%BD%BD%E9%81%BF%E5%85%8D%E7%AC%A6%E5%8F%B7%E9%93%BE%E6%8E%A5.html","title":"K8s Configmap \u6302\u8f7d\u907f\u514d\u7b26\u53f7\u94fe\u63a5","text":"<p>\u5728 k8s \u4e2d\u6302\u8f7d configmap \u65f6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4f1a\u4ee5\u7b26\u53f7\u94fe\u63a5\u7684\u5f62\u5f0f\u5b58\u5728\u3002</p> <p>\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u5982 Pod \u6302\u8f7d <code>.ssh</code> \u8fdb\u884c\u514d\u5bc6\u65f6\uff0c\u7531\u4e8e<code>.ssh</code>\u7684\u7279\u6b8a\u6743\u9650\uff0c\u56e0\u6b64\u4e0d\u80fd\u4ee5\u7b26\u53f7\u94fe\u63a5\u7684\u5f62\u5f0f\u5b58\u5728\uff0c\u5426\u5219\u4e0d\u80fd ssh \u514d\u5bc6\u3002</p> <p>\u6b64\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>subpath</code> \u8fdb\u884c\u6302\u8f7d\u3002</p>"},{"location":"2023/12/25/k8s-configmap-%E6%8C%82%E8%BD%BD%E9%81%BF%E5%85%8D%E7%AC%A6%E5%8F%B7%E9%93%BE%E6%8E%A5.html#subpath","title":"\u5982\u4f55\u914d\u7f6e subpath \u907f\u514d\u7b26\u53f7\u94fe\u63a5","text":"<p>subpath \u6302\u8f7d configmap \u65f6\uff0c\u5f53 configmap \u53d8\u66f4\u65f6\uff0cpod \u5185\u7684\u6587\u4ef6\u65e0\u6cd5\u5f97\u5230\u66f4\u65b0\u3002</p> <p>configmap \u4e0d\u4f7f\u7528 subpath \u6302\u8f7d\u65f6</p> <pre><code>spec:\n  containers:\n    volumeMounts:\n    - name: ssh-config\n      mountPath: /root/.ssh\n  volumes:\n    - name: ssh-config\n    configMap:\n      name: ssh-config-cm\n      items:\n        - key: PRIVATE_KEY\n          path: id_rsa\n        - key: PUBLIC_KEY\n          path: id_rsa.pub\n        - key: AUTHORIZED_KEYS\n          path: authorized_keys\n        - key: CONFIG\n          path: config\n</code></pre> <p>\u6302\u8f7d\u7684\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\u9762\u6240\u793a\uff1a</p> <ul> <li>\u6302\u8f7d\u7684\u6587\u4ef6 <code>id_rsa</code> \u90fd\u662f\u7b26\u53f7\u94fe\u63a5\uff1b</li> <li><code>/root/.ssh</code>\u5982\u679c\u539f\u5148\u7684pod\u7684\u955c\u50cf\u4e2d\u5b58\u5728\u8be5\u8def\u5f84\uff0c\u5219\u4f1a\u88ab\u8986\u76d6\uff1b</li> </ul> <pre><code># \u901a\u8fc7 ls -all -i /root/.ssh \u547d\u4ee4\u67e5\u770b\ntotal 4\n  2273784 drwxrwxrwx 3 root root   87 Oct 31 10:25 .\n132645053 drwxr-xr-x 1 root root 4096 Oct 31 10:25 ..\n100673916 drwxr-xr-x 2 root root   34 Oct 31 10:25 ..2023_10_31_10_25_13.340959843\n  2335458 lrwxrwxrwx 1 root root   31 Oct 31 10:25 ..data -&gt; ..2023_10_31_10_25_13.340959843\n  2273789 lrwxrwxrwx 1 root root    9 Oct 31 10:25 id_rsa -&gt; ..data/id_rsa\n  2317395 lrwxrwxrwx 1 root root   17 Oct 31 10:25 id_rsa.pub -&gt; ..data/id_rsa.pub\n  ... ...\n</code></pre> <p>\u4f7f\u7528 configmap subpath \u6302\u8f7d\u65f6\uff1a</p> <pre><code>spec:\n  containers:\n    volumeMounts:\n    - name: ssh-config\n      mountPath: /root/.ssh\n      # use subpath to avoid soft link\n      subPath: .ssh\n  volumes:\n    - name: ssh-config\n    configMap:\n      name: ssh-config-cm\n      defaultMode: 0600\n      items:\n        - key: PRIVATE_KEY\n          path: .ssh/id_rsa\n        - key: PUBLIC_KEY\n          path: .ssh/id_rsa.pub\n        - key: AUTHORIZED_KEYS\n          path: .ssh/authorized_keys\n        - key: CONFIG\n          path: .ssh/config\n</code></pre> <p>\u6302\u8f7d\u7684\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\u9762\u6240\u793a\uff1a</p> <ul> <li><code>id_rsa</code>\u7b49\u4e0d\u518d\u662f\u7b26\u53f7\u94fe\u63a5\uff0c\u800c\u662f\u6587\u4ef6\uff1b</li> </ul> <pre><code># \u901a\u8fc7 ls -all -i /root/.ssh \u547d\u4ee4\u67e5\u770b\ntotal 4\n  2273784 drwxrwxrwx 3 root root   87 Oct 31 10:25 .\n132645053 drwxr-xr-x 1 root root 4096 Oct 31 10:25 ..\n  2273789 -rw------- 1 root root    9 Oct 31 10:25 id_rsa\n  2317395 -rw------- 1 root root   17 Oct 31 10:25 id_rsa.pub\n  ... ...\n</code></pre>"},{"location":"2023/11/06/kubernetes-configmap-%E5%AE%9E%E6%97%B6%E9%80%9A%E7%9F%A5-pod.html","title":"Kubernetes ConfigMap \u5b9e\u65f6\u901a\u77e5 Pod","text":"<p>\u5728 K8s \u4e2d\uff0c\u5b98\u65b9\u8bf4\u660e ConfigMap \u6574\u4f53\u4f5c\u4e3a\u5377\u88ab Pod \u6302\u8f7d\u65f6\uff0c\u4f1a\u81ea\u52a8\u66f4\u65b0\u3002\u4ece ConfigMap \u66f4\u65b0\u5230\u65b0\u952e\u6620\u5c04\u5230 Pod \u7684\u603b\u5ef6\u8fdf\u53ef\u80fd\u4e0e kubelet \u540c\u6b65\u5468\u671f\uff08\u9ed8\u8ba4\u4e3a1\u5206\u949f\uff09+ kubelet \u4e2d ConfigMap \u7f13\u5b58\u7684 TTL\uff08\u9ed8\u8ba4\u4e3a1\u5206\u949f\uff09\u4e00\u6837\u957f\u3002</p> <p>\u5b98\u65b9\u8bf4\u660e\u53ef\u4ee5\u901a\u8fc7\u66f4\u65b0 Pod \u7684\u4e00\u4e2a\u6ce8\u89e3\u6765\u89e6\u53d1\u7acb\u5373\u5237\u65b0\u3002</p>"},{"location":"2023/11/06/kubernetes-configmap-%E5%AE%9E%E6%97%B6%E9%80%9A%E7%9F%A5-pod.html#k8s-configmap","title":"K8s \u66f4\u65b0 ConfigMap \u7684\u8fc7\u7a0b","text":"<p>\u521b\u5efa ConfigMap</p> <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: test\ndata:\n  mount.info: |\n    This is a mount info.\n  aa: |\n    This is test.\n</code></pre> <p>\u5e76\u5c06\u5176\u6302\u8f7d\u5230 Pod \u4e2d</p> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: test\nspec:\n  containers:\n    - name: nginx\n      image: nginx\n      volumeMounts:\n        - mountPath: /etc/cm\n          name: test-cm\n  volumes:\n    - name: test-cm\n      configMap:\n        name: test\n</code></pre> <p>\u524d\u540e\u4e24\u6b21\u8fdb\u5165Pod\u4e2d\u67e5\u770b\u6302\u8f7d\u4fe1\u606f\uff1a</p> <ul> <li><code>aa</code>\u7b49\u6587\u4ef6\u662f\u8f6f\u94fe\u63a5\uff0c\u4e0d\u4f1a\u53d8\uff1b</li> <li>configmap \u66f4\u65b0\u65f6\u4f1a\u81ea\u52a8\u521b\u5efa\u65b0\u7684\u76ee\u5f55\uff0c\u6700\u540e\u518d\u91cd\u547d\u540d\u3002</li> </ul> <pre><code># \u901a\u8fc7 ls -all -i \u547d\u4ee4\u67e5\u770b\ntotal 4\n  2273784 drwxrwxrwx 3 root root   87 Oct 31 10:25 .\n132645053 drwxr-xr-x 1 root root 4096 Oct 31 10:25 ..\n100673916 drwxr-xr-x 2 root root   34 Oct 31 10:25 ..2023_10_31_10_25_13.340959843\n  2335458 lrwxrwxrwx 1 root root   31 Oct 31 10:25 ..data -&gt; ..2023_10_31_10_25_13.340959843\n  2273789 lrwxrwxrwx 1 root root    9 Oct 31 10:25 aa -&gt; ..data/aa\n  2317395 lrwxrwxrwx 1 root root   17 Oct 31 10:25 mount.info -&gt; ..data/mount.info\n\n# aa \u662f\u8f6f\u94fe\uff0cinode \u53f7\u4e0d\u53d8\nroot@test:/etc/cm# ll \ntotal 4\n  2273784 drwxrwxrwx 3 root root   87 Oct 31 10:26 .\n132645053 drwxr-xr-x 1 root root 4096 Oct 31 10:25 ..\n 69055409 drwxr-xr-x 2 root root   34 Oct 31 10:26 ..2023_10_31_10_26_40.305784968\n  2339165 lrwxrwxrwx 1 root root   31 Oct 31 10:26 ..data -&gt; ..2023_10_31_10_26_40.305784968\n  2273789 lrwxrwxrwx 1 root root    9 Oct 31 10:25 aa -&gt; ..data/aa\n  2317395 lrwxrwxrwx 1 root root   17 Oct 31 10:25 mount.info -&gt; ..data/mount.info\n</code></pre> <p>\u5982\u679c\u901a\u8fc7 fsnotity \u76d1\u63a7\u6574\u4e2a <code>/etc/cm</code>\u76ee\u5f55\u7684\u53d8\u5316\uff0c\u53d1\u751f\u7684\u65f6\u95f4\u5982\u4e0b\uff1a <pre><code>2023-10-31T10:23:26.098Z    INFO    filewatch/filewatch.go:49   file changed    {\"op\": \"CREATE\", \"file\": \"/etc/cm/..2023_10_31_10_23_26.701606162\"}\n2023-10-31T10:23:26.098Z    INFO    filewatch/filewatch.go:49   file changed    {\"op\": \"CHMOD\", \"file\": \"/etc/cm/..2023_10_31_10_23_26.701606162\"}\n2023-10-31T10:23:26.098Z    INFO    filewatch/filewatch.go:49   file changed    {\"op\": \"CREATE\", \"file\": \"/etc/cm/..data_tmp\"}\n2023-10-31T10:23:26.098Z    INFO    filewatch/filewatch.go:49   file changed    {\"op\": \"RENAME\", \"file\": \"/etc/cm/..data_tmp\"}\n2023-10-31T10:23:26.098Z    INFO    filewatch/filewatch.go:49   file changed    {\"op\": \"CREATE\", \"file\": \"/etc/cm/..data\"}\n2023-10-31T10:23:26.098Z    INFO    filewatch/filewatch.go:49   file changed    {\"op\": \"REMOVE\", \"file\": \"/etc/cm/..2023_10_31_10_19_52.153989162\"}\n</code></pre></p>"},{"location":"2023/11/06/kubernetes-configmap-%E5%AE%9E%E6%97%B6%E9%80%9A%E7%9F%A5-pod.html#k8s-configmap_1","title":"K8s \u66f4\u65b0 ConfigMap \u7684\u5ef6\u8fdf","text":"<p>kubelet \u662f\u7528\u4e8e\u5904\u7406 Master \u8282\u70b9\u4e0b\u53d1\u5230\u672c\u8282\u70b9\u7684\u4efb\u52a1\uff0c\u7ba1\u7406 Pod\u53caPod \u4e2d\u7684\u5bb9\u5668\u3002</p> <ul> <li>\u5bbf\u4e3b\u673a\u8fdb\u7a0b\uff1a\u6ce8\u518c\u5230<code>/etc/systemd/system/kubelet.service</code></li> <li><code>syncFrequency</code>\uff1a\u9ed8\u8ba41min\uff0c\u8868\u793a\u5728\u8fd0\u884c\u4e2d\u7684\u5bb9\u5668\u4e0e\u5176\u914d\u7f6e\u4e4b\u95f4\u6267\u884c\u540c\u6b65\u64cd\u4f5c\u7684\u6700\u957f\u65f6\u95f4\u95f4\u9694\uff1b</li> </ul> <p>kubelet \u4e2d\u901a\u8fc7\u914d\u7f6e<code>configMapAndSecretChangeDetectionStrategy</code>\u6307\u5b9a\u5185\u90e8\u7ba1\u7406\u5668\uff08ConfigMap\u3001Secret\uff09 \u7528\u6765\u53d1\u73b0\u5bf9\u8c61\u53d8\u5316\u7684\u6a21\u5f0f</p> <ul> <li>Watch\uff1a\u9ed8\u8ba4\uff0c\u4f7f\u7528 watch \u64cd\u4f5c\u6765\u89c2\u5bdf\u6240\u5173\u5fc3\u7684\u5bf9\u8c61\u7684\u53d8\u66f4\uff0c\u6700\u5927\u5ef6\u8fdf\u4e3a watch propagation delay\uff1b</li> <li> <p><code>whenever a pod is created or updated, we start individual watches for all referenced objects that aren't referenced from other registered pods</code></p> </li> <li> <p>Cache\uff1a\u4f7f\u7528 TTL \u7f13\u5b58\u6765\u7ba1\u7406\u6765\u81ea API \u670d\u52a1\u5668\u7684\u5bf9\u8c61\uff0c\u6700\u5927\u5ef6\u8fdf\u4e3a ttl of cache\uff1b</p> </li> <li>\u4f46\u5f53 pod \u521b\u5efa\u6216\u66f4\u65b0\u65f6\uff0c\u5176\u6240\u6709\u7684\u7f13\u5b58\u7684configmaps\u90fd\u4f1a\u5931\u6548\uff0c\u5373\u4fdd\u8bc1\u83b7\u53d6\u5230\u6700\u65b0\u7684 configmap\uff1b</li> <li>\u901a\u8fc7<code>node.alpha.kubernetes.io/ttl</code>\u6765\u63a7\u5236</li> <li>Get\uff1a\u4ece API \u670d\u52a1\u5668\u76f4\u63a5\u53d6\u56de\u5fc5\u8981\u7684\u5bf9\u8c61\uff0c\u5ef6\u8fdf\u4e3a 0\uff1b</li> </ul> <p>\u5f53\u89e6\u53d1 Pod \u4fee\u6539\u65f6\uff0cApi Server \u7ed9 Kubelet \u53d1\u901a\u77e5\uff0ckubelet \u4f1a reconcile pod\uff0c\u7136\u540e\u83b7\u53d6\u6700\u65b0\u7684 ConfigMap \u53bb\u6302\u8f7d\uff1b</p>"},{"location":"2023/11/06/kubernetes-configmap-%E5%AE%9E%E6%97%B6%E9%80%9A%E7%9F%A5-pod.html#podconfigmap","title":"\u901a\u8fc7\u6ce8\u89e3Pod\u5b9e\u65f6\u66f4\u65b0ConfigMap","text":"<p>\u901a\u8fc7\u6253\u5f00\u4e09\u4e2a Shell\u7a97\u53e3\uff1a</p> <ul> <li>Pod \u4e2d\u6267\u884c<code>ls -all</code>\uff0c\u901a\u8fc7\u663e\u793a\u7684\u65f6\u95f4\u67e5\u770b ConfigMap \u662f\u5426\u66f4\u65b0\uff1b</li> <li><code>kubectl edit configmap</code>\uff0c\u4fee\u6539 ConfigMap \u7684\u5185\u5bb9\uff1b</li> <li><code>kubectl edit pod</code>\uff0c\u4fee\u6539 Pod \u7684\u6ce8\u89e3\uff1b</li> </ul> <p>\u4fdd\u5b58\u5b8c ConfigMap \u7684\u4fee\u6539\u4e4b\u540e\uff0c\u7acb\u5373\u4fdd\u5b58\u5bf9 Pod \u7684\u6ce8\u89e3\uff0c\u53ef\u4ee5\u67e5\u770b\u5230 ConfigMap \u4f1a\u7acb\u5373\u66f4\u65b0\u3002</p>"},{"location":"2024/01/03/k8s--%E4%B8%AD-leader-election-%E9%80%89%E4%B8%BE%E5%8E%9F%E7%90%86.html","title":"K8s  \u4e2d leader election \u9009\u4e3e\u539f\u7406","text":"<p>\u5728\u5f00\u53d1CRD\u65f6\uff0c\u5b9a\u4e49 <code>controller</code> \u7684\u65f6\u5019\uff0c\u4f1a\u770b\u5230\u5982\u4e0b\u4ee3\u7801</p> <pre><code>mgr, err := ctrl.NewManager(ctrl.GetConfigOrDie(), ctrl.Options{\n    // \u662f\u5426\u8fdb\u884c leader \u9009\u4e3e\n    LeaderElection:          enableLeaderElection,\n    // Namespace and name\n    LeaderElectionNamespace: leaderElectionNamespace,\n    LeaderElectionID:        \"alluxio.data.fluid.io\",\n    // ...\n})\n</code></pre> <p>\u5bf9\u4e8e\u6709\u72b6\u6001\u7ec4\u4ef6\u6765\u8bf4\uff0c\u5b9e\u73b0\u9ad8\u53ef\u7528\u4e00\u822c\u6765\u8bf4\u901a\u8fc7\u9009\u4e3b\u6765\u8fbe\u5230\u540c\u4e00\u65f6\u523b\u53ea\u80fd\u6709\u4e00\u4e2a\u7ec4\u4ef6\u5728\u5904\u7406\u4e1a\u52a1\u903b\u8f91\u3002</p> <p>\u8fd9\u91cc\uff0c\u4f1a\u6bd4\u8f83\u597d\u5947\u8fd9\u4e2a\u9009\u4e3e\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff0c\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u4fbf\u4ece\u6e90\u7801\u7684\u89d2\u5ea6\u8fdb\u884c\u89e3\u8bfb\u3002</p>"},{"location":"2024/01/03/k8s--%E4%B8%AD-leader-election-%E9%80%89%E4%B8%BE%E5%8E%9F%E7%90%86.html#controller-manager","title":"Controller Manager \u4e2d\u7684\u9009\u4e3e","text":"<p>\u8ddf\u968f<code>NewManager</code>\u7684\u8c03\u7528\u94fe\uff0c\u5230</p> <pre><code>// newResourceLock \u65b9\u6cd5\u9ed8\u8ba4\u662f leaderelection.NewResourceLock \u65b9\u6cd5\nresourceLock, err := options.newResourceLock(leaderConfig, recorderProvider, leaderelection.Options{\n    LeaderElection:             options.LeaderElection,\n    LeaderElectionResourceLock: options.LeaderElectionResourceLock,\n    LeaderElectionID:           options.LeaderElectionID,\n    LeaderElectionNamespace:    options.LeaderElectionNamespace,\n})\n</code></pre> <p><code>leaderelection.NewResourceLock</code>\u65b9\u6cd5\u4e2d\uff0c\u6700\u7ec8\u8c03\u7528 client go \u5e93\u4e2d\u7684 <code>resourcelock.New</code>\u65b9\u6cd5\uff1a</p> <ul> <li><code>LeaderElectionResourceLock</code>\u9ed8\u8ba4\u4e3a <code>ConfigMapsLeasesResourceLock</code>\uff1b</li> <li><code>id</code>\u662f <code>hostname_$uuid</code>\u6784\u6210\uff1b</li> </ul> <pre><code>return resourcelock.New(options.LeaderElectionResourceLock,\n        options.LeaderElectionNamespace,\n        options.LeaderElectionID,\n        corev1Client,\n        coordinationClient,\n        resourcelock.ResourceLockConfig{\n            Identity:      id,\n            EventRecorder: recorderProvider.GetEventRecorderFor(id),\n        })\n</code></pre>"},{"location":"2024/01/03/k8s--%E4%B8%AD-leader-election-%E9%80%89%E4%B8%BE%E5%8E%9F%E7%90%86.html#client-go-leader-election","title":"Client Go \u4e2d\u7684 Leader Election","text":"<p>\u5b98\u65b9\u793a\u4f8b</p> <ul> <li>\u5b98\u65b9\u652f\u6301\u9501\u7684\u7c7b\u578b\u6709 <code>LeaseLock</code>, <code>configmapLock</code>,<code>endpointLock</code>\u548c<code>MultiLock</code>\uff1b</li> <li><code>MultiLock</code>\u662f\u7528\u6765\u5c06\u539f\u5148\u7684 <code>configmapLock</code>\u548c<code>endpointLock</code>\u8fc1\u79fb\u8fc7\u6765\u800c\u8bbe\u8ba1\uff1b</li> <li><code>configmapLock</code>-&gt;<code>multiLock(ConfigMapsLeasesResourceLock)</code>-&gt;<code>LeaseLock</code></li> <li>\u4ee5\u4e0b\u5206\u6790\uff0c\u57fa\u4e8e client-go@v0.24.17 \u7248\u672c</li> </ul> <p>\u6784\u5efa\u9501\u5b9e\u4f8b\uff1a</p> <ul> <li><code>LeaseLock</code> \u53ef\u4ee5\u76f4\u63a5\u6784\u9020\uff0c\u800c\u5176\u5b83\u7684\u9501\u8981\u901a\u8fc7<code>resourcelock.New</code>\u5de5\u5382\u65b9\u6cd5\u6784\u9020\uff1b</li> <li>\u4e00\u822c\u4f7f\u7528 <code>LeaseLock</code>\uff0c\u56e0\u4e3a\u8fd9\u79cd\u7c7b\u578b\u66f4\u4e0d\u5e38\u89c1\uff08\u7528\u6237\u4e0d\u4f1a\u4f7f\u7528\u5b83\uff09\uff0c\u5e76\u4e14\u6240\u89c2\u5bdf\u7684\u5bf9\u8c61\u4f1a\u66f4\u5c11\uff1b</li> <li>K8s\u7684\u5bf9\u8c61\uff08\u5982<code>LeaseLock</code>\uff09\u662f\u4e0d\u4f1a\u88ab\u5220\u9664\uff0c\u5373\u4f7f\u6240\u6709\u7684\u8fdb\u7a0b\u90fd\u9000\u51fa\uff0c\u4e0b\u6b21\u542f\u52a8\u540e\u4ecd\u53ef\u4ee5\u6b63\u5e38\u9009\u53d6\uff1b</li> </ul> <pre><code>lock := &amp;resourcelock.LeaseLock{\n    LeaseMeta: metav1.ObjectMeta{\n        Name:      leaseLockName,\n        Namespace: leaseLockNamespace,\n    },\n    Client: client.CoordinationV1(),\n    LockConfig: resourcelock.ResourceLockConfig{\n        Identity: leaderId,\n    },\n}\n</code></pre> <p>\u901a\u8fc7 <code>leaderelection.RunOrDie</code>\u8fdb\u884cleader election\uff0c\u5e76\u6267\u884c\u4e1a\u52a1\u903b\u8f91</p> <pre><code>// start the leader election code loop\nleaderelection.RunOrDie(ctx, leaderelection.LeaderElectionConfig{\n    // \u4e0a\u6587\u6784\u5efa\u7684 lock\n    Lock: lock,\n    // IMPORTANT: you MUST ensure that any code you have that\n    // is protected by the lease must terminate **before**\n    // you call cancel. Otherwise, you could have a background\n    // loop still running and another process could\n    // get elected before your background loop finished, violating\n    // the stated goal of the lease.\n    ReleaseOnCancel: true,\n    // \u9501\u7684\u6301\u7eed\u65f6\u95f4\uff08TTL\uff09\n    LeaseDuration:   60 * time.Second,\n    // \u9501\u7684\u7eed\u7ea6\u65f6\u6267\u884c\u7684\u8d85\u65f6\u65f6\u95f4\n    RenewDeadline:   15 * time.Second,\n    // \u7533\u8bf7\u9501/\u7eed\u7ea6\u9501\uff08acquire\uff09\u7684\u5faa\u73af\u5468\u671f\n    RetryPeriod:     5 * time.Second,\n    Callbacks: leaderelection.LeaderCallbacks{\n        OnStartedLeading: func(ctx context.Context) {\n            // we're notified when we start - this is where you would\n            // \u6267\u884c\u4e1a\u52a1\u4ee3\u7801\uff0c\u4f1a\u88ab\u5355\u72ec\u7684\u534f\u7a0b\u8c03\u7528\n            run(ctx)\n        },\n        OnStoppedLeading: func() {\n            // we can do cleanup here\n            klog.Infof(\"leader lost: %s\", leaderId)\n            os.Exit(0)\n        },\n        OnNewLeader: func(identity string) {\n            // we're notified when new leader elected\n            if identity == leaderId {\n                // I just got the lock\n                return\n            }\n            klog.Infof(\"new leader elected: %s\", identity)\n        },\n    },\n})\n</code></pre> <p><code>RunOrDie</code>\u7684\u6838\u5fc3\u903b\u8f91\u5728<code>Run</code>\u65b9\u6cd5\u8c03\u7528\u4e2d</p> <pre><code>func (le *LeaderElector) Run(ctx context.Context) {\n    // \u4ece panic \u4e2d recover \u5e76\u6253\u5370\u5806\u6808\n    defer runtime.HandleCrash()\n    // \u8c03\u7528 OnStoppedLeading \u7684 callback\n    defer func() {\n        le.config.Callbacks.OnStoppedLeading()\n    }()\n    // \u7533\u8bf7\u9501\uff0c\u5982\u679c\u7533\u8bf7\u4e0d\u5230\u5219\u4f1a\u963b\u585e\n    if !le.acquire(ctx) {\n        return // ctx signalled done\n    }\n    ctx, cancel := context.WithCancel(ctx)\n    defer cancel() \n    // \u53e6\u8d77\u534f\u7a0b\uff0c\u8c03\u7528 OnStartedLeading \u7684 callback\n    go le.config.Callbacks.OnStartedLeading(ctx)\n    // \u7eed\u7ea6\u9501\uff0c\u4e00\u76f4\u963b\u585e\uff0c\u5982\u679c\u7eed\u7ea6\u5931\u8d25\uff08\u5219\u8fdb\u7a0b\u5e94\u8be5\u76f4\u63a5\u9000\u51fa\uff0c\u5373 Die\uff09\n    le.renew(ctx)\n}\n</code></pre>"},{"location":"2024/01/03/k8s--%E4%B8%AD-leader-election-%E9%80%89%E4%B8%BE%E5%8E%9F%E7%90%86.html#_1","title":"\u7533\u8bf7\u9501","text":"<p>\u6e90\u4ee3\u7801\u5982\u4e0b</p> <pre><code>func (le *LeaderElector) acquire(ctx context.Context) bool {\n    ctx, cancel := context.WithCancel(ctx)\n    defer cancel()\n    succeeded := false\n    desc := le.config.Lock.Describe()\n    klog.Infof(\"attempting to acquire leader lease %v...\", desc)\n    // \u5faa\u73af\u6267\u884c\u51fd\u6570\u4e00\u76f4\u5230 ctx.Done() \u8fd9\u4e2a channel closed\uff0c\u5faa\u73af\u5468\u671f\u4e3a le.config.RetryPeriod\n    wait.JitterUntil(func() {\n        // \u6838\u5fc3\u4ee3\u7801\uff0c\u7533\u8bf7\u9501\u6216\u8005\u7eed\u7ea6\u9501\uff0c\u5728\u4e00\u4e2a\u51fd\u6570\u4e2d\n        succeeded = le.tryAcquireOrRenew(ctx)\n        // \u5982\u679c leader \u53d1\u751f\u53d8\u5316\uff0c\u5219\u8c03\u7528 onNewLeader \u7684 callback\n        le.maybeReportTransition()\n        // \u6ca1\u6709\u7533\u8bf7\u5230\u9501\u5219\u91cd\u8bd5\n        if !succeeded {\n            klog.V(4).Infof(\"failed to acquire lease %v\", desc)\n            return\n        }\n        le.config.Lock.RecordEvent(\"became leader\")\n        le.metrics.leaderOn(le.config.Name)\n        klog.Infof(\"successfully acquired lease %v\", desc)\n        // \u5982\u679c\u7533\u8bf7\u5230\u9501\uff0c\u8c03\u7528 cancle()\uff0c\u4f1a\u9000\u51fa wait \u5faa\u73af\n        cancel()\n    }, le.config.RetryPeriod, JitterFactor, true, ctx.Done())\n    return succeeded\n}\n</code></pre> <p>\u6838\u5fc3\u51fd\u6570<code>tryAcquireOrRenew</code>\u6e90\u7801\u5982\u4e0b\uff1a</p> <ul> <li>\u7533\u8bf7\u9501\u6216\u8005\u7eed\u7ea6\u9501\uff0c</li> </ul> <pre><code>func (le *LeaderElector) tryAcquireOrRenew(ctx context.Context) bool {\n    now := metav1.Now()\n    leaderElectionRecord := rl.LeaderElectionRecord{\n        // \u81ea\u5df1\u4e3a leader\n        HolderIdentity:       le.config.Lock.Identity(),\n        LeaseDurationSeconds: int(le.config.LeaseDuration / time.Second),\n        RenewTime:            now,\n        AcquireTime:          now,\n    }\n\n    // 1. \u83b7\u53d6\u9501\n    oldLeaderElectionRecord, oldLeaderElectionRawRecord, err := le.config.Lock.Get(ctx)\n    if err != nil {\n        // \u9501\u5b58\u5728\uff0c\u4f46\u5b58\u5728\u5176\u4ed6\u9519\u8bef\uff0c\u6267\u884c\u5931\u8d25\n        if !errors.IsNotFound(err) {\n            klog.Errorf(\"error retrieving resource lock %v: %v\", le.config.Lock.Describe(), err)\n            return false\n        }\n        // \u9501\u4e0d\u5b58\u5728\uff0c\u521b\u5efa\u9501\uff08k8s api \u4fdd\u8bc1\u53ea\u6709\u4e00\u4e2a\u80fd\u6267\u884c\u6210\u529f\uff09\n        if err = le.config.Lock.Create(ctx, leaderElectionRecord); err != nil {\n            klog.Errorf(\"error initially creating leader election record: %v\", err)\n            return false\n        }\n        // \u66f4\u65b0\u5185\u5b58\u7684\u5f53\u524d\u9501\u6301\u6709\u4fe1\u606f\n        le.setObservedRecord(&amp;leaderElectionRecord)\n        return true\n    }\n    // 2. \u66f4\u65b0\u81ea\u5df1\u7684 observedRecord\uff08\u5305\u62ec\u9501\u7684\u5f53\u524d\u6301\u6709\u8005\uff09 \u548c observedTime\n    if !bytes.Equal(le.observedRawRecord, oldLeaderElectionRawRecord) {\n        le.setObservedRecord(oldLeaderElectionRecord)\n        le.observedRawRecord = oldLeaderElectionRawRecord\n    }\n\n    // 3. \u867d\u7136\u83b7\u53d6\u5230\u9501\uff08\u4ec5\u83b7\u53d6\u5230\u5bf9\u8c61\uff09\u4e0d\u4ee3\u8868\u80fd\u591f\u6301\u6709\u8be5\u9501\u6267\u884c\u4e1a\u52a1\u903b\u8f91\uff0c\u6b64\u65f6\u9700\u8981\u5224\u65ad\u9501\u662f\u5426\u7531\u81ea\u5df1\u6301\u6709\n\n    // 3.1 \u6240\u5f97\u6301\u6709\u8005\u4e0d\u662f\u81ea\u5df1\u4e14\u9501\u8fd8\u6ca1\u8fc7\u671f\uff0c\u5219\u83b7\u53d6\u5931\u8d25\n    if len(oldLeaderElectionRecord.HolderIdentity) &gt; 0 &amp;&amp;\n        le.observedTime.Add(le.config.LeaseDuration).After(now.Time) &amp;&amp; !le.IsLeader() {\n        klog.V(4).Infof(\"lock is held by %v and has not yet expired\", oldLeaderElectionRecord.HolderIdentity)\n        return false\n    }\n\n    if le.IsLeader() {\n        // 3.2 \u9501\u7684\u6301\u6709\u8005\u662f\u81ea\u5df1\uff08\u65e0\u8bba\u9501\u662f\u5426\u8fc7\u671f\uff09\uff0c\u66f4\u65b0\u9501\u7684\u83b7\u53d6\u65f6\u95f4\n        leaderElectionRecord.AcquireTime = oldLeaderElectionRecord.AcquireTime\n        leaderElectionRecord.LeaderTransitions = oldLeaderElectionRecord.LeaderTransitions\n    } else {\n        // 3.3 \u9501\u7684\u6301\u6709\u8005\u4e0d\u662f\u81ea\u5df1\u4e14\u9501\u8fc7\u671f\u4e86\uff0c\u9501\u7684\u6240\u6709\u6743\u8f6c\u6362\u6b21\u6570+1\n        leaderElectionRecord.LeaderTransitions = oldLeaderElectionRecord.LeaderTransitions + 1\n    }\n\n    // \u66f4\u65b0\u9501\uff0c \u5373\u4f7f\u5b58\u5728\u5e76\u53d1\u7ade\u4e89\uff08\u5f53\u9501\u8fc7\u671f\u65f6\uff09\uff1a\n    // 1\uff09\u9501\u7684\u6301\u6709\u8005\u66f4\u65b0\uff0c3.2 \u903b\u8f91\uff1b\n    // 2\uff09\u9501\u7684\u975e\u6301\u6709\u8005\u7533\u8bf7\uff0c3.3 \u903b\u8f91\uff1b\n    // k8s \u7684 API \u4fdd\u8bc1\u4ec5\u6709\u4e00\u4e2a\u5ba2\u6237\u7aef\u80fd\u591f\u6267\u884c\u6210\u529f\n    if err = le.config.Lock.Update(ctx, leaderElectionRecord); err != nil {\n        klog.Errorf(\"Failed to update lock: %v\", err)\n        return false\n    }\n\n    // \u66f4\u65b0\u5185\u5b58\u7684\u5f53\u524d\u9501\u6301\u6709\u4fe1\u606f\n    le.setObservedRecord(&amp;leaderElectionRecord)\n    return true\n}\n</code></pre>"},{"location":"2024/01/03/k8s--%E4%B8%AD-leader-election-%E9%80%89%E4%B8%BE%E5%8E%9F%E7%90%86.html#_2","title":"\u7eed\u7ea6\u9501","text":"<pre><code>// \u6b64\u5904\u7684 ctx \u662f OnStartedLeading callback \u51fd\u6570\u7684\u53c2\u6570\u7684 ctx\n// \u5982\u679c callback \u4e2d ctx \u8c03\u7528 cancel \u4f1a\u6267\u884c\u6240\u6709 \u5b50 context \u7684cancel\nfunc (le *LeaderElector) renew(ctx context.Context) {\n    ctx, cancel := context.WithCancel(ctx\n    defer cancel()\n    // \u6bcf\u4e2a RetryPeriod \u7eed\u7ea6\u9501\uff0c\u76f4\u5230 ctx \u88ab cancel()\n    wait.Until(func() {\n        timeoutCtx, timeoutCancel := context.WithTimeout(ctx, le.config.RenewDeadline)\n        defer timeoutCancel()\n        // \u7eed\u7ea6\u9501\u76f4\u52301\uff09\u8fd4\u56detrue\uff0c\u5373\u7eed\u7ea6\u6210\u529f \u62162\uff09\u9501\u8d85\u65f6 \u62163\uff09\u8fd4\u56de err\uff08\u6b64\u5904\u4e00\u76f4\u4e3anil\uff0c\u4e0d\u4f1a\u53d1\u751f\uff09\n        err := wait.PollImmediateUntil(le.config.RetryPeriod, func() (bool, error) {\n            return le.tryAcquireOrRenew(timeoutCtx), nil\n        }, timeoutCtx.Done())\n\n        // \u7eed\u7ea6\u7684\u65f6\u5019\u6ca1\u62a2\u5230\u9501\uff0c\u6c47\u62a5\u9501\u7684\u72b6\u6001\u8f6c\u79fb\uff0c\u8c03\u7528 onNewLeader \u7684 callback\n        le.maybeReportTransition()\n        desc := le.config.Lock.Describe()\n        // \u7eed\u7ea6\u9501\u6210\u529f\uff0c\u5219\u7b49\u5f85\u4e0b\u6b21\u5faa\u73af\n        if err == nil {\n            klog.V(5).Infof(\"successfully renewed lease %v\", desc)\n            return\n        }\n        le.config.Lock.RecordEvent(\"stopped leading\")\n        le.metrics.leaderOff(le.config.Name)\n        klog.Infof(\"failed to renew lease %v: %v\", desc, err)\n        // \u7eed\u7ea6\u9501\u5931\u8d25\uff0c\u9000\u51fa wait\uff0c\u8fdb\u7a0b\u5e94\u8be5\u76f4\u63a5 Die\n        cancel()\n    }, le.config.RetryPeriod, ctx.Done())\n\n    // \u5982\u679c\u6b64\u65f6\u6211\u4eec\u8fd8\u6301\u6709\u9501\uff0c\u4f46\u662f\u7eed\u7ea6\u5931\u8d25\uff0c\u5219\u91ca\u653e\u8be5\u9501\n    if le.config.ReleaseOnCancel {\n        // \u51fd\u6570\u5185\u5c06 LeaseDurationSeconds \u7f6e\u4e3a 1s\uff08\u5373\u5f88\u5feb\u8fc7\u671f\uff09\uff0c\u7136\u540e Update Lock\n        // \u5373\u4f7f\u66f4\u65b0\u5931\u8d25\uff0c\u4e5f\u6ca1\u6709\u5f71\u54cd\uff0c\u7b49\u5f85\u9501\u8fc7\u671f\u5373\u53ef\n        le.release()\n    }\n}\n</code></pre>"},{"location":"2024/01/03/k8s--%E4%B8%AD-leader-election-%E9%80%89%E4%B8%BE%E5%8E%9F%E7%90%86.html#_3","title":"\u9501\u7684\u5b9e\u73b0","text":"<p><code>resourcelock.Interface</code> \u63a5\u53e3\u5b9a\u4e49\u4e86\u9501\u7684\u76f8\u5173\u63a5\u53e3</p> <pre><code>// a common interface for locking on arbitrary resources used in leader election\ntype Interface interface {\n    // Get returns the LeaderElectionRecord\n    Get(ctx context.Context) (*LeaderElectionRecord, []byte, error)\n\n    // Create attempts to create a LeaderElectionRecord\n    Create(ctx context.Context, ler LeaderElectionRecord) error\n\n    // Update will update and existing LeaderElectionRecord\n    Update(ctx context.Context, ler LeaderElectionRecord) error\n\n    // RecordEvent is used to record events\n    RecordEvent(string)\n\n    // Identity will return the locks Identity\n    Identity() string\n\n    // Describe is used to convert details on current resource lock\n    // into a string\n    Describe() string\n}\n</code></pre> <p><code>LeaseLock</code>\u7ed3\u6784\u4f53\u5bf9\u8be5\u63a5\u53e3\u8fdb\u884c\u4e86\u5b9e\u73b0\uff0c\u4e3b\u8981\u7684<code>Get</code>, <code>Create</code>\u548c <code>Update</code>\u65b9\u6cd5\uff0c\u5c31\u662f\u5bf9<code>Lease</code> Resource \u7684 <code>Get</code>, <code>Create</code>\u548c <code>Update</code>\u7684\u64cd\u4f5c\u3002</p>"},{"location":"2024/01/03/k8s--%E4%B8%AD-leader-election-%E9%80%89%E4%B8%BE%E5%8E%9F%E7%90%86.html#_4","title":"K8s \u4e2d leader election \u9009\u4e3e\u539f\u7406","text":""},{"location":"2023/12/27/k8s-pod-%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AE%E5%85%8D%E5%AF%86.html","title":"K8s Pod \u5982\u4f55\u914d\u7f6e\u514d\u5bc6","text":"<p>MPI Operator \u5728\u6267\u884c MPI \u4f5c\u4e1a\u65f6\uff0c\u901a\u8fc7 SSH \u7684\u65b9\u5f0f\uff0c\u56e0\u6b64\u9700\u8981\u5728\u4e0d\u540c\u7684 MPI Workers Pod\u95f4\u914d\u7f6e\u514d\u5bc6\u3002</p> <p>\u672c\u6587\u901a\u8fc7\u6e90\u7801\u5206\u6790\uff0c\u63a2\u7a76\u5982\u4f55\u5728 K8s Pod \u95f4\u914d\u7f6e\u514d\u5bc6\u3002</p>"},{"location":"2023/12/27/k8s-pod-%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AE%E5%85%8D%E5%AF%86.html#ssh","title":"SSH \u514d\u5bc6","text":"<p>\u4e00\u822c\u5e38\u89c4\u7684\u514d\u5bc6\u64cd\u4f5c\uff0c\u90fd\u662f\u5728\u4e0d\u540c\u7684\u8282\u70b9\u4e0a\uff0c\u901a\u8fc7 <code>ssh-keygen</code> \u751f\u6210\u516c\u94a5\u548c\u79c1\u94a5\uff0c\u7136\u540e\u5c06\u6240\u6709\u8282\u70b9\u7684\u516c\u94a5\u90fd\u5199\u5230\u5404\u4e2a\u8282\u70b9\u7684<code>authorized_keys</code>\u6587\u4ef6\u4e2d\u3002</p> <p>\u4f46\u662f\u67e5\u770b volcano mpi \u7684\u5b9e\u73b0\uff0c\u53ef\u4ee5\u77e5\u9053Pod \u4f7f\u7528\u540c\u6837\u7684\u79c1\u94a5/\u516c\u94a5\uff0c\u53ef\u4ee5\u4e92\u76f8\u514d\u5bc6\u8bbf\u95ee\u3002</p> <p>\u56e0\u6b64\uff0c\u53ea\u9700\u751f\u6210\u540c\u6837\u7684 <code>id_rsa</code>\u548c <code>id_rsa.pub</code>\uff0c\u7136\u540e\u5c06 <code>authorized_keys</code>\u7684\u5185\u5bb9\u8bbe\u4e3a<code>id_rsa.pub</code>\u4e00\u81f4\u3002</p> <p>\u6700\u540e\u914d\u7f6e\u4e0b<code>config</code>\u6587\u4ef6\uff1a</p> <pre><code># \u7b2c\u4e00\u6b21\u8bbf\u95ee\u65f6\uff0c\u65e0\u9700\u786e\u8ba4\uff0c\u76f4\u63a5\u8fde\u63a5\nStrictHostKeyChecking no\nUserKnownHostsFile /dev/null\n# pod \u95f4\u65e0\u6cd5\u901a\u8fc7 hostname \u76f4\u63a5\u8bbf\u95ee\u5bf9\u65b9\u7684\uff0c\u56e0\u6b64\u9700\u8981 service\nHost pod-hostname-1\n  HostName  pod-hostname-1.service-name\nHost pod-hostname-2\n  HostName  pod-hostname-2.service-name\n</code></pre> <p>\u5c06 <code>id_rsa,id_rsa.pub,authorized_keys,config</code>\u4f5c\u4e3a configmap\u7684\u5185\u5bb9\u3002</p>"},{"location":"2023/12/27/k8s-pod-%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AE%E5%85%8D%E5%AF%86.html#pod","title":"Pod \u4e3b\u673a\u540d\u89e3\u6790","text":"<p>pod \u95f4\u65e0\u6cd5\u901a\u8fc7 hostname \u76f4\u63a5\u8bbf\u95ee\u5bf9\u65b9\u7684\uff0c\u56e0\u6b64\u9700\u8981 service\uff1a</p> <ul> <li>\u53ef\u4ee5\u53c2\u8003 Pod \u95f4\u901a\u4fe1\uff1b</li> </ul> <p>hostname \u5fc5\u987b\u662f\u89c4\u5219\u5316\uff0c\u624d\u53ef\u4ee5\u9759\u6001\u751f\u6210\u6240\u6709\u7684\u4e3b\u673a\u540d\uff1a</p> <ul> <li>\u53ef\u4ee5\u7528 Statefulset \u6216\u8005 IndexJob \u6765\u751f\u6210\u6709\u89c4\u5219\u7684 hostname\u3002</li> </ul>"},{"location":"2023/12/27/k8s-pod-%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AE%E5%85%8D%E5%AF%86.html#pod-ssh-configmap","title":"Pod \u6302\u8f7d SSH ConfigMap","text":"<p>\u60f3\u8981\u514d\u5bc6\uff0c\u5219 Pod \u4e0a\u6302\u8f7d\u76f8\u5e94\u7684configmap \u5373\u53ef\u3002</p> <pre><code>spec:\n  containers:\n    volumeMounts:\n    - name: ssh-config\n      mountPath: /root/.ssh\n      # use subpath to avoid soft link\n      subPath: .ssh\n  volumes:\n    - name: ssh-config\n    configMap:\n      name: ssh-config-cm\n      defaultMode: 0600\n      items:\n        - key: PRIVATE_KEY\n          path: .ssh/id_rsa\n        - key: PUBLIC_KEY\n          path: .ssh/id_rsa.pub\n        - key: AUTHORIZED_KEYS\n          path: .ssh/authorized_keys\n        - key: CONFIG\n          path: .ssh/config\n</code></pre>"},{"location":"source_codes_read/juicefs/index.html","title":"JuiceFS \u6e90\u7801\u89e3\u6790\u7cfb\u5217","text":"<p>JuiceFS \u6e90\u7801\u9605\u8bfb-\u4e0a (qq.com)</p>"},{"location":"web_backend/index.html","title":"Web \u540e\u7aef\u5f00\u53d1","text":""},{"location":"web_backend/index.html#-java","title":"- \u5207\u9762\u7f16\u7a0b\uff08Java\uff09","text":""},{"location":"web_backend/aop_java.html","title":"AOP","text":"<p>AOP: Aspect Oriented Programming\uff0c\u9762\u5411\u5207\u9762\u7f16\u7a0b\u3002</p>"},{"location":"web_backend/aop_java.html#aop-alliance","title":"AOP Alliance","text":"<p>AOP \u8054\u76df\u662f java\u5bf9\u4e8eAOP\u63d0\u4f9b\u7684\u4e00\u7cfb\u5217\u6807\u51c6\u63a5\u53e3\uff0c\u9876\u5c42\u63a5\u53e3\u6709\uff1a </p> <ul> <li>Advice\u901a\u77e5\uff0c\u53ca\u5176\u7ee7\u627f\u63a5\u53e3MethodInterceptor\u65b9\u6cd5\u62e6\u622a\u5668\uff1b </li> <li>JointPoint\u8fde\u63a5\u70b9\uff0c\u53ca\u5176\u7ee7\u627f\u63a5\u53e3MethodInvocation\u3002</li> </ul> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;aopalliance&lt;/groupId&gt;\n    &lt;artifactId&gt;aopalliance&lt;/artifactId&gt;\n    &lt;version&gt;1.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>"},{"location":"web_backend/aop_java.html#java-jsr-330","title":"Java \u4f9d\u8d56\u6ce8\u5165\u6807\u51c6\uff08JSR-330\uff09","text":"<p>JSR-330 (Dependency Injection for Java)  \u8be5\u89c4\u8303\u4e3b\u8981\u662f\u9762\u5411\u4f9d\u8d56\u6ce8\u5165\u4f7f\u7528\u8005\uff0c\u800c\u5bf9\u6ce8\u5165\u5668\u5b9e\u73b0\u3001\u914d\u7f6e\u5e76\u672a\u4f5c\u8be6\u7ec6\u8981\u6c42\u3002</p> <ul> <li>@Inject - Identifies injectable constructors, methods, and fields</li> <li>@Qualifier - Identifies qualifier annotations</li> <li>@Scope - Identifies scope annotations</li> <li>@Named - String-based qualifier</li> <li>@Singleton - Identifies a type that the injector only instantiates once</li> <li>Provider - Provides instances of T. Typically implemented by an injector</li> </ul> <p>\u76ee\u524d Spring\u3001Guice \u5df2\u7ecf\u5f00\u59cb\u517c\u5bb9\u8be5\u89c4\u8303\uff0cJSR-299\uff08Contexts and Dependency Injection for Java EE platform\uff0c\u53c2\u8003\u5b9e\u73b0 Weld\uff09\u5728\u4f9d\u8d56\u6ce8\u5165\u4e0a\u4e5f\u4f7f\u7528\u8be5\u89c4\u8303\u3002</p>"},{"location":"web_backend/aop_java.html#aop_1","title":"\u5f00\u6e90AOP\u5b9e\u73b0","text":""},{"location":"web_backend/aop_java.html#hutools-aop","title":"Hutools AOP","text":"<p>\u52a8\u6001\u4ee3\u7406\uff0c\u65e0\u6cd5\u9488\u5bf9<code>new</code>\u51fa\u6765\u7684\u5bf9\u8c61\u3002</p> <p>Demo\u4ee3\u7801</p> <p>AOP\u6a21\u5757\u4e3b\u8981\u9488\u5bf9JDK\u4e2d\u52a8\u6001\u4ee3\u7406\u8fdb\u884c\u5c01\u88c5\uff0c\u62bd\u8c61\u52a8\u6001\u4ee3\u7406\u4e3a\u5207\u9762\u7c7b<code>Aspect</code>\uff0c\u901a\u8fc7<code>ProxyUtil</code>\u4ee3\u7406\u5de5\u5177\u7c7b\u5c06\u5207\u9762\u5bf9\u8c61\u4e0e\u88ab\u4ee3\u7406\u5bf9\u8c61\u878d\u5408\uff0c\u4ea7\u751f\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\uff0c\u4ece\u800c\u53ef\u4ee5\u9488\u5bf9\u6bcf\u4e2a\u65b9\u6cd5\u6267\u884c\u524d\u540e\u505a\u901a\u7528\u7684\u529f\u80fd\u3002</p> <p>\u63d0\u4f9b Aspect \u63a5\u53e3\uff0c<code>before</code>\u3001<code>after</code> \u548c <code>afterException</code>\u63a5\u53e3\uff0c\u5b9e\u73b0\u5bf9\u7c7b\u7684\u65b9\u6cd5\u8fdb\u884c\u62e6\u622a\u3002</p> <ul> <li>\u53ea\u80fd\u5bf9\u5355\u4e2a\u7c7b\u8fdb\u884c\u62e6\u622a\uff1b</li> <li>\u5bf9\u4e0d\u540c\u7684\u65b9\u6cd5\u7684\u4e0d\u540c\u5904\u7406\uff0c\u9700\u8981\u81ea\u5df1\u5199\u903b\u8f91\u5904\u7406\uff1b</li> </ul> <p>\u5b9e\u73b0\u673a\u5236\uff08\u6309\u7167\u4f18\u5148\u7ea7\u6392\u5e8f\uff09</p> <ul> <li>\u4f7f\u7528 Cglib \u5b9e\u73b0\u5207\u9762\uff08\u65e0\u9700\u5b9a\u4e49\u63a5\u53e3\u5373\u53ef\u5bf9\u5bf9\u8c61\u76f4\u63a5\u5b9e\u73b0\u5207\u9762\uff09</li> <li>\u4f7f\u7528 Spring Cglib\u5b9e\u73b0\u5207\u9762\uff08\u56e0\u4e3a Cglib \u4e0d\u518d\u7ef4\u62a4\uff09</li> <li>\u4f7f\u7528 JDK \u7684\u52a8\u6001\u4ee3\u7406\u5b9e\u73b0\u5207\u9762\uff08\u4ee3\u7406\u5bf9\u8c61\u5fc5\u987b\u5b9e\u73b0\u63a5\u53e3\uff09</li> <li>\u901a\u8fc7 <code>Proxy.newProxyInstance</code> \u521b\u5efa\u7684\u63a5\u53e3\u7684\u5b50\u7c7b</li> </ul>"},{"location":"web_backend/aop_java.html#guice-aop","title":"Guice AOP","text":"<p>\u5b9e\u73b0 AOP Alliance \u7684\u63a5\u53e3\uff0c\u652f\u6301 JSR-330 \u4f9d\u8d56\u6ce8\u5165\u6807\u51c6\u3002</p> <p>Demo\u4ee3\u7801</p> <p>\u8f7b\u91cf\u7ea7IoC\uff08\u4f9d\u8d56\u6ce8\u5165\u6846\u67b6\uff09\u5bb9\u5668\uff0c\u7c7b\u4f3cSpring-AOP\u3002Guice \u901a\u8fc7\u4ee3\u7801\u7684\u5f62\u5f0f\u6765\u6ce8\u5165\u5e76\u7ba1\u7406\u4f9d\u8d56\u3002</p> <ul> <li>Guice\uff1a\u6574\u4e2a\u6846\u67b6\u7684\u95e8\u9762</li> <li>Injector\uff1a\u4e00\u4e2a\u4f9d\u8d56\u7684\u7ba1\u7406\u4e0a\u4e0b\u6587</li> <li>Binder\uff1a\u4e00\u4e2a\u63a5\u53e3\u548c\u5b9e\u73b0\u7684\u7ed1\u5b9a</li> <li>Module\uff1a\u4e00\u7ec4 Binder</li> <li>Provider\uff1abean \u7684\u63d0\u4f9b\u8005</li> <li>Key\uff1aBinder \u4e2d\u5bf9\u5e94\u4e00\u4e2a Provider</li> <li>Scope\uff1aProvider \u7684\u4f5c\u7528\u57df</li> </ul> <p>\u4f9d\u8d56\u6ce8\u5165(bind)</p> <p>Guice\u5b98\u65b9\u63a8\u8350\u6211\u4eec\u9996\u9009JSR-330\u6807\u51c6\u7684\u6ce8\u89e3\u3002</p> JSR-330 javax.inject Guice com.google.inject @Inject @Inject \u5728\u67d0\u4e9b\u7ea6\u675f\u4e0b\u53ef\u4e92\u6362 @Named @Named \u53ef\u4e92\u6362 @Qualifier @BindingAnnotation @Scope @ScopeAnnotation \u53ef\u4e92\u6362 @Singleton @Singleton \u53ef\u4e92\u6362 Provider Provider Guice\u7684Provider\u7ee7\u627f\u4e86JSR-330\u7684Provider <p>AOP(binder)</p> <p>\u901a\u8fc7\u5bf9\u5339\u914d\u7684\u7c7b/\u5339\u914d\u7684\u65b9\u6cd5\uff0c\u6267\u884c\u5207\u9762\u51fd\u6570</p> <ul> <li>\u6ce8\u610f\uff1a\u5207\u9762\u4f9d\u8d56\u4ecd\u7136\u8d70\u5207\u9762\u7684\u8bdd\u90a3\u4e48\u7a0b\u5e8f\u5c31\u9677\u5165\u6b7b\u5faa\u73af</li> </ul> <pre><code>private static class MainModule extends AbstractModule {\n    @Override\n    protected void configure() {\n        // \u9ed8\u8ba4\u4e0d\u662f\u5355\u4f8b\u6a21\u5f0f\uff0c\u9700\u8981\u6307\u5b9a in scope \u6216\u8005\u5728\u5b9e\u73b0\u7c7b\u4e0a\u4f7f\u7528 @Singleton\n        bind(Animal.class).to(Cat.class).in(Scopes.SINGLETON);\n        // \u7ed1\u5b9a\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u6c38\u8fdc\u662f\u5355\u4f8b\n        // bind(Animal.class).toInstance(new Cat());\n        // \u6cdb\u578b\u7ed1\u5b9a\n        // bind(new TypeLiteral&lt;List&lt;Animal&gt;&gt;(){}).toInstance(Arrays.asList(new Dog(),new Cat()));\n\n        // AOP, \u5bf9\u5339\u914d\u7684\u7c7b/\u5339\u914d\u7684\u65b9\u6cd5\uff0c\u6267\u884c\u5207\u9762\u51fd\u6570\n        binder().bindInterceptor(Matchers.subclassesOf(Animal.class), Matchers.any(), new AopFunc());\n    }\n}\n</code></pre>"},{"location":"web_backend/aop_java.html#aspectj-aop","title":"AspectJ AOP","text":"<p>AspectJ \u5c5e\u4e8e\u9759\u6001AOP\u6846\u67b6\uff0c\u91c7\u7528 ajc \u7f16\u8bd1\u5668\u3002</p> <p>AspectJ \u4f5c\u4e3a Java \u4e2d\u6d41\u884c\u7684 AOP\uff08aspect-oriented programming\uff09 \u7f16\u7a0b\u6269\u5c55\u6846\u67b6\uff0c\u5176\u5185\u90e8\u4f7f\u7528\u7684\u662f BCEL\u6846\u67b6 \u6765\u5b8c\u6210\u5176\u529f\u80fd\u3002</p> <ul> <li>\u5728\u4e00\u4e9b\u56fa\u5b9a\u7684\u5207\u5165\u70b9\u6765\u8fdb\u884c\u64cd\u4f5c\uff1b</li> <li>\u5339\u914d\u89c4\u5219\u91c7\u7528\u4e86\u7c7b\u4f3c\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u89c4\u5219\uff1b</li> <li>\u5bf9\u4e8e\u8fd0\u884c\u4e2d\u7684java\u8fdb\u884c\u65e0\u6cd5\u5728\u4e0d\u91cd\u542f\u7684\u6761\u4ef6\u4e0b\u6267\u884c\u65b0\u589eMOCK\uff1b</li> <li>MOCK\u529f\u80fd\u4ee3\u7801\u5d4c\u5165\u5230\u76ee\u6807\u51fd\u6570\u4e2d\uff0c\u65e0\u6cd5\u5bf9MOCK\u529f\u80fd\u4ee3\u7801\u8fdb\u884c\u5378\u8f7d\uff0c\u53ef\u80fd\u5e26\u6765\u7a33\u5b9a\u6027\u98ce\u9669\u3002</li> </ul> <p>AspectJ\u5c5e\u4e8e\u7f16\u8bd1\u65f6\u589e\u5f3a\uff0c\u5728\u8fd0\u884c\u524d\u7ec7\u5165\u7684\uff0c\u5206\u4e3a\u4e09\u7c7b\uff1a</p> <ul> <li>\u7f16\u8bd1\u65f6\u7ec7\u5165\uff1a\u5982\u7c7b A \u4f7f\u7528 AspectJ \u6dfb\u52a0\u4e86\u4e00\u4e2a\u5c5e\u6027\uff0c\u7c7b B \u5f15\u7528\u4e86\u5b83\uff0c\u8fd9\u4e2a\u573a\u666f\u5c31\u9700\u8981\u7f16\u8bd1\u671f\u7684\u65f6\u5019\u5c31\u8fdb\u884c\u7ec7\u5165\uff0c\u5426\u5219\u6ca1\u6cd5\u7f16\u8bd1\u7c7b B\uff1b</li> <li>java\u6e90\u7801 + aspectJ\u7279\u6b8a\u8bed\u6cd5\u7684\u2018\u914d\u7f6e\u2019 \u6587\u4ef6 + aspectJ\u7279\u6b8a\u7684\u7f16\u8bd1\u5668</li> <li>\u7f16\u8bd1\u540e\u7ec7\u5165\uff1a\u751f\u6210\u4e86 .class \u540e\u9700\u8981\u589e\u5f3a\u5904\u7406\uff1b</li> <li>\u9700\u8981\u7279\u6b8a\u7684\u7f16\u8bd1\u5668</li> <li>\u52a0\u8f7d\u65f6\u7ec7\u5165\uff1a\u5728\u52a0\u8f7d\u7c7b\u7684\u65f6\u5019\u8fdb\u884c\u7ec7\u5165\uff0c\u4f7f\u7528AspectJ agent</li> </ul> <p></p>"},{"location":"web_backend/aop_java.html#spring-aop","title":"Spring AOP","text":"<p>springaop\u7684\u6e90\u7801\u4e2d\u5305\u542b\uff08\u590d\u5236\uff09\u4e86 AOP Alliance \u7684\u63a5\u53e3\u5b9a\u4e49\uff1b</p> <p>spring aop \u4ec5\u4f7f\u7528aspectJ \u6ce8\u89e3\u7684\u4e00\u5c0f\u90e8\u5206\uff08\u56e0\u6b64springboot aop starter \u4f9d\u8d56 aspectjweaver\uff09\uff1b</p> <ul> <li>spring aop \u7684\u5b9e\u73b0\u6709 JDK \u548c cglib \u4e24\u79cd\u52a8\u6001\u4ee3\u7406\u7684\u5b9e\u73b0\uff08\u9ed8\u8ba4\u91c7\u7528 cglib\uff09\uff1b</li> <li>spring aop \u7684 cglib \u4ee3\u7406\u590d\u5236\u4e86 cglib \u7684\u5b9e\u73b0\uff0c\u5e76\u5b9a\u5236\uff0c\u652f\u6301\u9ad8\u7248\u672c\u7684 JDK\uff1b</li> </ul> <p>Spring AOP \u57fa\u4e8e\u52a8\u6001\u4ee3\u7406\u6765\u5b9e\u73b0\u7684\uff0c\u5728\u5bb9\u5668\u542f\u52a8\u65f6\u9700\u8981\u751f\u6210\u4ee3\u7406\u5b9e\u4f8b\uff0c\u5728\u65b9\u6cd5\u8c03\u7528\u4e0a\u4e5f\u4f1a\u589e\u52a0\u6808\u7684\u6df1\u5ea6\uff0c\u4f7f\u5f97 Spring AOP \u7684\u6027\u80fd\u4e0d\u5982 AspectJ\uff1b</p> <ul> <li>Spring AOP\u65e0\u6cd5\u4ee3\u7406new\u51fa\u6765\u7684\u5bf9\u8c61\uff0c\u53ea\u80fd\u4ee3\u7406\u88abspring\u5bb9\u5668\u7ba1\u7406\u7684\u5bf9\u8c61</li> </ul> <p></p>"},{"location":"web_backend/cache.html","title":"\u7f13\u5b58","text":""},{"location":"web_backend/cache.html#_2","title":"\u601d\u8def","text":"<p>\u901a\u8fc7\u7f13\u5b58\u5c06\u590d\u6742\u7684\u64cd\u4f5c\u7684\u7ed3\u679c\u4e34\u65f6\u5b58\u50a8\uff0c\u63d0\u5347\u6027\u80fd\u3002</p>"},{"location":"web_backend/cache.html#_3","title":"\u529f\u80fd","text":"<ul> <li>\u652f\u6301\u5e76\u53d1\u64cd\u4f5c\uff0c\u5982\u91c7\u7528\u6570\u636e\u7ed3\u6784<code>ConcurrentHashMap</code>\uff1b</li> <li>\u652f\u6301 TTL\uff0c\u5373\u652f\u6301\u8fc7\u671f\u65f6\u95f4\uff1b</li> <li>\u652f\u6301 \u6bcf\u4e2a\u8bb0\u5f55\u7684TTL\uff0c\u5373\u4e0d\u540c\u7684\u8bb0\u5f55\u53ef\u4ee5\u8bbe\u7f6e\u4e0d\u540c\u7684\u8fc7\u671f\u65f6\u95f4\uff1b</li> <li>\u652f\u6301\u5b9a\u4e49\u7f13\u5b58\u7684\u5927\u5c0f\uff08\u8bb0\u5f55\u6570/\u5b57\u8282\u6570\uff09\uff0c\u9632\u6b62\u5185\u5b58\u6ea2\u51fa\uff1b</li> <li>\u652f\u6301\u81ea\u52a8\u7684\u6570\u636e\u52a0\u8f7d\uff08\u4e92\u65a5\uff09\uff0c\u5373\u83b7\u53d6\u4e0d\u5230\u65f6\u7684\u5904\u7406\u65b9\u6cd5\uff1b</li> </ul> <p>\u5bf9\u4e8e\u5206\u5e03\u5f0f\u573a\u666f\uff0c\u9700\u8981\u901a\u8fc7 Redis \u96c6\u4e2d\u7cfb\u7edf\u5b9e\u73b0\u5206\u5e03\u5f0f\u7f13\u5b58\u3002</p> <p>\u7f13\u5b58\u6e05\u9664\u7b56\u7565</p> <ul> <li> <p>LRU\uff1a\u6700\u8fd1\u6700\u4e45\u672a\u4f7f\u7528</p> </li> <li> <p>LFU\uff1a\u6700\u8fd1\u5c11\u9891\u7387\uff0c\u5bf9\u4e8e\u70ed\u70b9\u6570\u636e\u547d\u4e2d\u7387\u66f4\u9ad8\uff0c\u4f46\u9700\u8981\u8bb0\u5f55\u989d\u5916\u5b57\u6bb5\u4fe1\u606f\uff08\u8bbf\u95ee\u6b21\u6570\uff09\uff1b</p> </li> </ul>"},{"location":"web_backend/cache.html#_4","title":"\u4e00\u81f4\u6027\u95ee\u9898","text":"<p>\u7f13\u5b58\u6700\u597d\u8bbe\u7f6e TTL\uff0c\u81f3\u5c11\u6700\u7ec8\u4e00\u81f4\u6027\u3002</p> <p>\u7f13\u5b58\u66f4\u65b0\u7684\u5957\u8def | \u9177 \u58f3 - CoolShell</p> <p>\u66f4\u65b0\u7f13\u5b58\u7684\u7684Design Pattern\u6709\u56db\u79cd\uff1aCache aside, Read through, Write through, Write behind caching</p> <p>\u4ee5\u4e0b\u4e5f\u6ca1\u6709\u8003\u8651\u4e8b\u52a1\uff0c\u6bd4\u5982\u66f4\u65b0\u6570\u636e\u5e93\u6210\u529f\uff0c\u66f4\u65b0\u7f13\u5b58\u5931\u8d25\u5982\u4f55\u5904\u7406\uff1f</p> <p>\u66f4\u65b0\u573a\u666f\uff0c\u5982\u4f55\u4fdd\u8bc1\u7f13\u5b58\u548c\u6570\u636e\u5e93\u7684\u4e00\u81f4\u6027</p> <p>\u9519\u8bef\uff1a</p> <ul> <li>\u7f13\u5b58\u91c7\u7528\u66f4\u65b0\uff0c\u4e0d\u7ba1\u8ddf\u6570\u636e\u5e93\u7684\u5148\u540e\u987a\u5e8f\uff0c\u90fd\u4f1a\u51fa\u73b0\u5e76\u53d1\u65f6\u7f13\u5b58\u8ddf\u6570\u636e\u5e93\u7684\u4e0d\u4e00\u81f4\u95ee\u9898\uff1b</li> <li>\u7ebf\u7a0b A \u66f4\u65b0\u6570\u636e\u5e93\uff08X = 1\uff09</li> <li>\u7ebf\u7a0b B \u66f4\u65b0\u6570\u636e\u5e93\uff08X = 2\uff09</li> <li>\u7ebf\u7a0b B \u66f4\u65b0\u7f13\u5b58\uff08X = 2\uff09</li> <li> <p>\u7ebf\u7a0b A \u66f4\u65b0\u7f13\u5b58\uff08X = 1\uff09</p> </li> <li> <p>\u5148\u5220\u7f13\u5b58\uff0c\u518d\u66f4\u65b0\u6570\u636e\u5e93</p> </li> <li>\u4e24\u4e2a\u5e76\u53d1\u64cd\u4f5c\uff0c\u4e00\u4e2a\u662f\u66f4\u65b0\u64cd\u4f5c\uff0c\u53e6\u4e00\u4e2a\u662f\u67e5\u8be2\u64cd\u4f5c\uff0c\u66f4\u65b0\u64cd\u4f5c\u5220\u9664\u7f13\u5b58\u540e\uff0c\u67e5\u8be2\u64cd\u4f5c\u6ca1\u6709\u547d\u4e2d\u7f13\u5b58\uff0c\u5148\u628a\u8001\u6570\u636e\u8bfb\u51fa\u6765\u540e\u653e\u5230\u7f13\u5b58\u4e2d\uff0c\u7136\u540e\u66f4\u65b0\u64cd\u4f5c\u66f4\u65b0\u4e86\u6570\u636e\u5e93\u3002\u4e8e\u662f\uff0c\u5728\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u8fd8\u662f\u8001\u7684\u6570\u636e\u3002</li> </ul> <p>\u601d\u8def\uff1a</p> <ul> <li>Cache Aside \uff1a\u5148\u66f4\u65b0\u6570\u636e\u5e93\uff0c\u518d\u5220\u7f13\u5b58</li> <li>\u5199-\u8bfb-\u5199\u95ee\u9898\uff1a\u7b2c\u4e00\u4e2a\u5199\u5bfc\u81f4\u7f13\u5b58\u5931\u6548\uff0c\u8bfb\u64cd\u4f5c\u6ca1\u6709\u547d\u4e2d\u7f13\u5b58\uff0c\u5230\u6570\u636e\u5e93\u4e2d\u53d6\u6570\u636e\uff1b\u7b2c\u4e8c\u4e2a\u5199\u64cd\u4f5c\uff0c\u5199\u5b8c\u6570\u636e\u5e93\u540e\uff0c\u8ba9\u7f13\u5b58\u5931\u6548\uff0c\u7136\u540e\u4e4b\u524d\u7684\u90a3\u4e2a\u8bfb\u64cd\u4f5c\u518d\u628a\u8001\u7684\u6570\u636e\u653e\u8fdb\u53bb\uff0c\u6240\u4ee5\u4f1a\u9020\u6210\u810f\u6570\u636e\uff1b<ul> <li>\u6982\u7387\u6781\u4f4e\uff1a\u53d1\u751f\u5728\u8bfb\u7f13\u5b58\u65f6\u7f13\u5b58\u5931\u6548\uff0c\u800c\u4e14\u5e76\u53d1\u7740\u6709\u4e00\u4e2a\u5199\u64cd\u4f5c\uff0c\u8bfb\u64cd\u4f5c\u5fc5\u9700\u5728\u5199\u64cd\u4f5c\u524d\u8fdb\u5165\u6570\u636e\u5e93\u64cd\u4f5c\uff0c\u800c\u53c8\u8981\u665a\u4e8e\u5199\u64cd\u4f5c\u66f4\u65b0\u7f13\u5b58</li> </ul> </li> <li>\u5982\u679c\u5220\u7f13\u5b58\u5931\u8d25\uff0c\u5b58\u5728\u4e0d\u4e00\u81f4\uff1a<ul> <li>\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u7b49\u5f85\uff1b\u6216\u8005 \u91cd\u8bd5\uff1b\u6216\u8005 \u4e8b\u52a1\u56de\u6eda\u6570\u636e\u5e93</li> </ul> </li> <li>Read/Write Through\uff1a\u7f13\u5b58\u4ee3\u7406\u6570\u636e\u5e93\u7684\u66f4\u65b0\u64cd\u4f5c\uff0c\u5bf9\u5916\u8868\u73b0\u4e3a\u539f\u5b50\u6027\u64cd\u4f5c\uff08\u7f13\u5b58\u66f4\u65b0\u548c\u6570\u636e\u5e93\u66f4\u65b0\uff09</li> <li>Write behind\uff08Write back\uff09\uff1a\u540c\u6b65\u66f4\u65b0\u7f13\u5b58\uff0c\u5f02\u6b65\u66f4\u65b0\u6570\u636e\u5e93</li> <li>\u53ef\u80fd\u4f1a\u4e22\u5931\u66f4\u65b0</li> </ul> <p>\u56e0\u6b64\uff0c\u4e00\u822c\u91c7\u7528\u5148\u66f4\u65b0\u6570\u636e\u5e93\uff0c\u518d\u5220\u7f13\u5b58\u7684\u7b56\u7565\uff1a\u4e8b\u52a1\u6027\u4fdd\u8bc1\uff0c\u5982\u679c\u66f4\u65b0\u7f13\u5b58\u5931\u8d25</p> <ul> <li>\u5f02\u6b65\u91cd\u8bd5\uff08\u5f15\u5165\u6d88\u606f\u961f\u5217\uff0c\u6d88\u606f\u961f\u5217\u8ddf\u7f13\u5b58\u540c\u65f6\u5931\u8d25\u6982\u7387\u4e0d\u5927\uff09\uff1b</li> <li>\u7f13\u5b58\u8fc7\u671f\u65f6\u95f4\uff08\u4e00\u5b9a\u65f6\u95f4\u7684\u6570\u636e\u4e0d\u4e00\u81f4\u6027\uff09\uff1b</li> </ul>"},{"location":"web_backend/cache.html#_5","title":"\u7f13\u5b58\u96ea\u5d29","text":"<p>\u67d0\u4e2a\u96c6\u4e2d\u7684\u65f6\u95f4\uff0c\u7f13\u5b58\u5168\u90e8\u5931\u6548\uff0c\u67e5\u8be2\u5168\u90e8\u5230\u6570\u636e\u5e93\uff0c\u538b\u529b\u5927</p> <ul> <li>\u6839\u56e0\uff1a</li> <li> <p>\u96c6\u4e2d\u521b\u5efa\u7f13\u5b58\uff0c\u76f8\u540c\u7684\u7f13\u5b58\u5931\u6548\u65f6\u95f4\uff1b</p> </li> <li> <p>\u7f13\u5b58\u670d\u52a1\u5b95\u673a\uff0c\u5bfc\u81f4\u5168\u90e8\u8bbf\u95ee\u6570\u636e\u5e93\uff1b</p> </li> <li> <p>\u89e3\u51b3\uff1a</p> </li> <li>\u521b\u5efa\u4e0d\u540c\u7684\u7f13\u5b58\u5931\u6548\u65f6\u95f4\uff1b</li> <li>\u8bbe\u7f6e\u7194\u65ad\u673a\u5236\uff0c\u9488\u5bf9\u6570\u636e\u5e93\u6d41\u91cf\u8fdb\u884c\u9650\u5236\uff1b</li> </ul>"},{"location":"web_backend/cache.html#_6","title":"\u7f13\u5b58\u51fb\u7a7f","text":"<p>\u7f13\u5b58\u4e2d\u6ca1\u6709\u800c\u6570\u636e\u5e93\u4e2d\u6709\uff08\u4e00\u822c\u7f13\u5b58\u5230\u671f\uff09\uff0c\u8bbf\u95ee\u91cf\u5927\u7684\u60c5\u51b5\u4e0b\uff0c\u540c\u65f6\u53bb\u8bfb\u53d6\u6570\u636e\u5e93</p> <ul> <li>\u6839\u56e0\uff1a\u70ed\u70b9 Key \u7f13\u5b58\u5230\u671f\uff1b</li> <li>\u89e3\u51b3\u65b9\u6848\uff1a</li> <li>\u9488\u5bf9\u70ed\u70b9 Key\uff0c\u8bbe\u7f6e\u6c38\u4e0d\u8fc7\u671f\u6216\u8005\u81ea\u52a8\u7eed\u671f\uff1b</li> <li>\u52a0\u9501\uff0c\u5206\u5e03\u5f0f\u9501\uff1b\uff08\u6216\u8005\u6bcf\u4e2a\u5b9e\u4f8b\u52a0\u9501\uff0c\u56e0\u4e3a\u5b9e\u4f8b\u6570\uff08\u8fdb\u7a0b\u6570\uff09\u4e0d\u4f1a\u5f88\u591a\uff09</li> </ul>"},{"location":"web_backend/cache.html#_7","title":"\u7f13\u5b58\u7a7f\u900f","text":"<p>\u6570\u636e\u4e2d\u4e0d\u5b58\u5728\u7684\u6570\u636e\uff0c\u6bcf\u6b21\u8bbf\u95ee\u90fd\u4f1a\u76f4\u63a5\u8bbf\u95ee\u6570\u636e\u5e93</p> <ul> <li>\u6839\u56e0\uff1a\u65e0\u6cd5\u5bf9\u6570\u636e\u5e93\u4e0d\u5b58\u5728\u7684key\u505a\u5224\u65ad\uff1b</li> <li>\u89e3\u51b3\uff1a</li> <li> <p>\u5bf9\u4e8e\u4e0d\u5728\u6570\u636e\u5e93\u4e2d\u7684\u60c5\u51b5\uff0c\u4e5f\u8fdb\u884c\u7f13\u5b58\uff0c\u8fc7\u671f\u65f6\u95f4\u8bbe\u7f6e\u77ed\u70b9\uff1b</p> <ul> <li>\u65e0\u6cd5\u9632\u6b62\u6076\u610f\u653b\u51fb</li> </ul> </li> <li> <p>\u53c2\u6570\u6821\u9a8c\uff0c\u8fc7\u6ee4\u65e0\u6548\u503c\uff1b</p> </li> <li>\u5e03\u9686\u8fc7\u6ee4\u5668\uff1a\u5b58\u5728\u5c11\u91cf\u8bef\u5224\uff0c\u4ee5\u53ca\u66f4\u65b0\u540c\u6b65\uff08\u5206\u5e03\u5f0f\uff09\u7684\u95ee\u9898\uff1b</li> </ul>"},{"location":"web_backend/cache.html#_8","title":"\u7f13\u5b58\u7cfb\u7edf","text":"<p>\u9009\u578b</p> <ul> <li>\u5982\u679c\u53ea\u662f\u672c\u5730\u7b80\u5355\u3001\u5c11\u91cf\u7f13\u5b58\u6570\u636e\u4f7f\u7528\u7684\uff0c\u9009\u62e9<code>Caffeine</code>\uff1b</li> <li>\u5982\u679c\u672c\u5730\u7f13\u5b58\u6570\u636e\u91cf\u8f83\u5927\u3001\u5185\u5b58\u4e0d\u8db3\u9700\u8981\u4f7f\u7528\u78c1\u76d8\u7f13\u5b58\u7684\uff0c\u9009\u62e9<code>EhCache</code>\uff1b</li> <li>\u5982\u679c\u662f\u5927\u578b\u5206\u5e03\u5f0f\u591a\u8282\u70b9\u7cfb\u7edf\uff0c\u4e1a\u52a1\u5bf9\u7f13\u5b58\u4f7f\u7528\u8f83\u4e3a\u91cd\u5ea6\uff0c\u4e14\u5404\u4e2a\u8282\u70b9\u9700\u8981\u4f9d\u8d56\u5e76\u9891\u7e41\u64cd\u4f5c\u540c\u4e00\u4e2a\u7f13\u5b58\uff0c\u9009\u62e9<code>Redis</code>\u3002</li> </ul>"},{"location":"web_backend/cache.html#caffine","title":"\u5355\u673aCaffine\u5e93","text":"<p><code>W-TinyLFU</code> \u7b97\u6cd5 \u56de\u6536\u7b56\u7565\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u8fd1\u4e4e\u6700\u4f73\u7684\u547d\u4e2d\u7387</p> <ul> <li>\u652f\u6301\u57fa\u4e8e\u5bb9\u91cf\u56de\u6536\u3001\u5b9a\u65f6\u56de\u6536\u548c\u57fa\u4e8e\u5f15\u7528\u56de\u6536\u65b9\u5f0f\uff1b</li> <li>\u5b9a\u65f6\u56de\u6536\u652f\u6301\u6309\u7167\u5199\u5165\u65f6\u95f4\u6216\u8005\u6309\u7167\u8bbf\u95ee\u65f6\u95f4\u56de\u6536\uff1b</li> <li>\u76d1\u63a7\u7f13\u5b58\u52a0\u8f7d/\u547d\u4e2d\u60c5\u51b5\uff1b</li> </ul>"},{"location":"web_backend/cache.html#redis","title":"\u5206\u5e03\u5f0fRedis","text":"<p>\u5206\u5e03\u5f0f\u7f13\u5b58\uff0cRedis \u4f5c\u4e3a\u5355\u72ec\u7684\u670d\u52a1\uff1a</p> <ul> <li>\u652f\u6301\u591a\u79cd\u6570\u636e\u7ed3\u6784\uff1b</li> <li>\u4e0d\u540cKey\u8bbe\u7f6e\u4e0d\u540c\u7684\u8fc7\u671f\u65f6\u95f4\uff1b</li> </ul> <p>\u66f4\u591a\u89c1 redis \u7b80\u4ecb\u548c\u7528\u6cd5</p>"},{"location":"web_backend/cache.html#ehcache","title":"\u6df7\u5408Ehcache","text":"<ul> <li>\u652f\u6301\u5806\u5185\u3001\u5806\u5916\u3001\u78c1\u76d8\u3001\u96c6\u7fa4\u7b49\u591a\u7ea7\u7f13\u5b58\uff1b</li> <li>\u5806\u5185\u6709GC\uff0c\u5806\u5916\u6709\u5e8f\u5217\u5316/\u53cd\u5e8f\u5217\u5316\uff0c\u78c1\u76d8\u6709IO\uff1b</li> <li>\u652f\u6301\u914d\u7f6e\u7f13\u5b58\u5bb9\u91cf\uff08\u8bb0\u5f55\u6570\u3001\u5b57\u8282\u6570\uff09\uff1b</li> <li>\u652f\u6301\u4f7f\u7528\u78c1\u76d8\u6765\u5bf9\u7f13\u5b58\u5185\u5bb9\u8fdb\u884c\u6301\u4e45\u5316\u4fdd\u5b58</li> </ul> <p>\u9650\u5236\uff1a</p> <ul> <li>\u591a\u7ea7\u7f13\u5b58\uff0c\u6309\u7167<code>\u5806\u5185\u7f13\u5b58 &lt; \u5806\u5916\u7f13\u5b58 &lt; \u78c1\u76d8\u7f13\u5b58 &lt; \u96c6\u7fa4\u7f13\u5b58</code>\u7684\u987a\u5e8f\u8fdb\u884c\u7ec4\u5408\uff1b</li> <li> <p>\u591a\u7ea7\u7f13\u5b58\u4e2d\u7684\u5bb9\u91cf\u8bbe\u5b9a\u5fc5\u987b\u9075\u5faa<code>\u5806\u5185\u7f13\u5b58 &lt; \u5806\u5916\u7f13\u5b58 &lt; \u78c1\u76d8\u7f13\u5b58 &lt; \u96c6\u7fa4\u7f13\u5b58</code>\u7684\u539f\u5219\uff1b</p> </li> <li> <p>\u591a\u7ea7\u7f13\u5b58\u4e2d\u4e0d\u5141\u8bb8\u78c1\u76d8\u7f13\u5b58\u4e0e\u96c6\u7fa4\u7f13\u5b58\u540c\u65f6\u51fa\u73b0\uff1b</p> </li> </ul> <p>\u96c6\u7fa4\u6a21\u5f0f\uff1a</p> <ul> <li>\u5c06\u591a\u5b9e\u4f8b\u8282\u70b9\u4e92\u76f8\u8fde\u63a5\uff0c\u5f53\u66f4\u65b0\u65f6\u8fdb\u884c\u8282\u70b9\u95f4\u540c\u6b65\uff1b</li> <li>\u652f\u6301 RMI \u7ec4\u64ad\uff0cJMS\u6d88\u606f\uff0cCache Server\uff0cJGroup\u7b49\u65b9\u5f0f\uff1b</li> </ul>"},{"location":"web_backend/cache.html#_9","title":"\u7f13\u5b58\u5e93","text":""},{"location":"web_backend/cache.html#oschina-j2cache","title":"OSChina J2Cache(\u4e24\u7ea7\u7f13\u5b58)","text":"<p>\u7b2c\u4e00\u7ea7\u7f13\u5b58\u4f7f\u7528\u5185\u5b58(\u540c\u65f6\u652f\u6301 Ehcache 2.x\u3001Ehcache 3.x \u548c Caffeine)\uff1b</p> <p>\u7b2c\u4e8c\u7ea7\u7f13\u5b58\u4f7f\u7528 Redis(\u63a8\u8350)/Memcached\u3002</p> <p>\u6570\u636e\u8bfb\u53d6\uff1a L1 -&gt; L2 -&gt; DB</p> <p>\u6570\u636e\u66f4\u65b0</p> <ul> <li>\u4ece\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u6700\u65b0\u6570\u636e\uff0c\u4f9d\u6b21\u66f4\u65b0 L1 -&gt; L2 \uff0c\u53d1\u9001\u5e7f\u64ad\u6e05\u9664\u67d0\u4e2a\u7f13\u5b58\u4fe1\u606f</li> <li>\u63a5\u6536\u5230\u5e7f\u64ad\uff08\u624b\u5de5\u6e05\u9664\u7f13\u5b58 &amp; \u4e00\u7ea7\u7f13\u5b58\u81ea\u52a8\u5931\u6548\uff09\uff0c\u4ece L1 \u4e2d\u6e05\u9664\u6307\u5b9a\u7684\u7f13\u5b58\u4fe1\u606f</li> </ul> <p>Region: \u4e0d\u540c\u7684\u6570\u636e\u4f1a\u6709\u4e0d\u540c\u7684 TTL \u7b56\u7565\uff1a</p> <ul> <li>\u56e0\u4e3aJava \u672c\u5730\u7f13\u5b58\u4e0d\u53ef\u4ee5\u9488\u5bf9\u4e0d\u540c\u7684 key \u8bbe\u7f6e\u4e0d\u540c\u7684 TTL \u65f6\u95f4\uff1b</li> <li>\u4e0d\u540c\u7684 region \u6765\u5b58\u653e\u4e0d\u540c\u7684\u7f13\u5b58\u6570\u636e\uff0c\u6307\u5b9a\u6570\u636e\u91cf\u548cTTL\u65f6\u95f4\uff1b</li> </ul>"},{"location":"web_backend/cache.html#ali-jetcache","title":"Ali JetCache\uff08\u4e24\u7ea7\u7f13\u5b58\uff09","text":"<p>\u57fa\u4e8eJava\u7684\u7f13\u5b58\u7cfb\u7edf\u5c01\u88c5\uff0c\u63d0\u4f9b\u7edf\u4e00\u7684API\u548c\u6ce8\u89e3\u6765\u7b80\u5316\u7f13\u5b58\u7684\u4f7f\u7528\u3002</p> <p>\u539f\u751f\u7684\u652f\u6301TTL\u3001\u4e24\u7ea7\u7f13\u5b58\u3001\u5206\u5e03\u5f0f\u81ea\u52a8\u5237\u65b0\uff0c\u8fd8\u63d0\u4f9b\u4e86Cache\u63a5\u53e3\u7528\u4e8e\u624b\u5de5\u7f13\u5b58\u64cd\u4f5c\u3002 </p> <p>\u5f53\u524d\u6709\u56db\u4e2a\u5b9e\u73b0\uff1a</p> <ul> <li>\u5206\u5e03\u5f0f\uff1aRedisCache\u3001TairCache(not opensource)\uff1b</li> <li>\u5355\u673a\uff1aCaffeineCache(in memory) \uff0c LinkedHashMapCache(in memory)\uff1b</li> </ul> <p>\u652f\u6301\u5bf9\u4e00\u7ec4 Key \u8bbe\u7f6e\u4e0d\u540c\u7684\u8fc7\u671f\u65f6\u95f4\uff08\u6bcf\u4e2a @Cached \u6ce8\u89e3\u53ef\u4ee5\u8bbe\u7f6e\u4e0d\u540c\u7684 TTL\uff09\u3002</p>"},{"location":"web_backend/cache.html#spring-cachemanager","title":"Spring CacheManager","text":"<p>\u793a\u4f8b: spring cache</p> <p>\u5e95\u5c42\u7684\u7f13\u5b58\u6846\u67b6\u652f\u6301\uff1a</p> <ul> <li>redis\uff1a\u5f15\u5165 spring redis start \u9ed8\u8ba4\u96c6\u6210 lettuce \u4e0d\u9002\u7528 Jedis\uff1b</li> <li>caffine, e2cache \u7b49\uff1b</li> <li>composite cache\uff1a\u590d\u5408 cache\uff0c\u4f7f\u7528\u591a\u7ea7\u7f13\u5b58\uff1b</li> </ul> <p>CacheManager</p> <ul> <li> <p>\u6309\u7167 cache name \u533a\u5206 Cache\uff0c\u4e0d\u540c\u7684 Cache \u53ef\u4ee5\u6709\u4e0d\u540c\u7684\u914d\u7f6e\uff08\u5982 TTL \u7b49\uff09\uff1b</p> </li> <li> <p>\u4e0d\u652f\u6301\u9488\u5bf9\u6bcf\u4e2a\u8bb0\u5f55\u8bbe\u7f6e\u4e0d\u540c\u7684\u8fc7\u671f\u65f6\u95f4\uff0c\u53ef\u4ee5\u5bf9\u4e00\u7ec4\u503c\u8bbe\u7f6e\u4e0d\u540c\u7684\u8fc7\u671f\u65f6\u95f4\uff1b</p> </li> <li>\u5373\u4f7f\u7528\u76f8\u5173\u6ce8\u89e3\u65f6\uff0c\u6307\u5b9a\u4f7f\u7528\u54ea\u4e2a <code>cacheName</code>\u548c <code>cacheManager</code>\uff0c\u83b7\u53d6\u5230<code>Cache</code></li> </ul>"},{"location":"web_backend/cache.html#_10","title":"\u6ce8\u89e3","text":"<pre><code>@EnableCaching\n\n// \u7c7b\u4e0a\u6307\u5b9a\u9ed8\u8ba4\u7684 cache \n@CacheConfig(cacheNames = \"my-redis-cache1\", cacheManager = \"redisCacheManager\")\n\n// \u65b9\u6cd5\u4e0a\u5b9a\u4e49\uff0c\u7f13\u5b58\u8fd4\u56de\u7ed3\u679c\uff0c\u5982\u679c\u7f13\u5b58\u5b58\u5728\uff0c\u5219\u4e0d\u6267\u884c\u65b9\u6cd5\uff08\u4e00\u822c\u7528\u5728\u83b7\u53d6\u65b9\u6cd5\uff09\n@Cacheable\n// \u65b9\u6cd5\u4e0a\u5b9a\u4e49\uff0c\u7f13\u5b58\u8fd4\u56de\u7ed3\u679c\uff0c\u65b9\u6cd5\u603b\u4f1a\u6267\u884c\uff08\u4e00\u822c\u7528\u5728\u65b0\u589e\u65b9\u6cd5\uff09\n@CachePut\n// \u5220\u9664\u7f13\u5b58\uff08\u4e00\u822c\u7528\u4f5c\u66f4\u65b0\u6216\u5220\u9664\uff0c\u4fdd\u8bc1\u4e00\u81f4\u6027\uff09\n@CacheEvict\n</code></pre>"},{"location":"archive/2024.html","title":"2024","text":""},{"location":"archive/2023.html","title":"2023","text":""},{"location":"category/spark.html","title":"spark","text":""},{"location":"category/devops.html","title":"devops","text":""},{"location":"category/maven.html","title":"maven","text":""},{"location":"category/k8s.html","title":"K8s","text":""},{"location":"category/yarn.html","title":"Yarn","text":""},{"location":"category/hdfs.html","title":"HDFS","text":""},{"location":"category/helm.html","title":"helm","text":""},{"location":"category/%E5%B9%B6%E5%8F%91.html","title":"\u5e76\u53d1","text":""},{"location":"page/2/index.html","title":"\u535a\u5ba2","text":""}]}